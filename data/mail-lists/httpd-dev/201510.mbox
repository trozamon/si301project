From dev-return-83993-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Thu Oct  1 10:26:26 2015
Return-Path: <dev-return-83993-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 5136318E20
	for <apmail-httpd-dev-archive@www.apache.org>; Thu,  1 Oct 2015 10:26:26 +0000 (UTC)
Received: (qmail 82765 invoked by uid 500); 1 Oct 2015 10:26:19 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 82687 invoked by uid 500); 1 Oct 2015 10:26:19 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 82677 invoked by uid 99); 1 Oct 2015 10:26:19 -0000
Received: from Unknown (HELO spamd1-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 01 Oct 2015 10:26:19 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd1-us-west.apache.org (ASF Mail Server at spamd1-us-west.apache.org) with ESMTP id 347BBC7E71
	for <dev@httpd.apache.org>; Thu,  1 Oct 2015 10:26:19 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd1-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.011
X-Spam-Level:
X-Spam-Status: No, score=-0.011 tagged_above=-999 required=6.31
	tests=[SPF_PASS=-0.001, T_RP_MATCHES_RCVD=-0.01] autolearn=disabled
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd1-us-west.apache.org [10.40.0.7]) (amavisd-new, port 10024)
	with ESMTP id cj730513K5lX for <dev@httpd.apache.org>;
	Thu,  1 Oct 2015 10:26:17 +0000 (UTC)
Received: from mailserver.kippdata.de (capsella.kippdata.de [195.227.30.149])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTP id 426C3201FB
	for <dev@httpd.apache.org>; Thu,  1 Oct 2015 10:26:17 +0000 (UTC)
Received: from [195.227.30.209] (notebook-rj [195.227.30.209])
	by mailserver.kippdata.de (8.13.5/8.13.5) with ESMTP id t91AQGvs013883
	for <dev@httpd.apache.org>; Thu, 1 Oct 2015 12:26:16 +0200 (CEST)
To: "dev@httpd.apache.org" <dev@httpd.apache.org>
From: Rainer Jung <rainer.jung@kippdata.de>
Subject: Expression Parser: search and replace with
 s/PATTERN/REPLACEMENT/FLAGS
Message-ID: <560D0A3F.9010609@kippdata.de>
Date: Thu, 1 Oct 2015 12:26:07 +0200
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:38.0) Gecko/20100101
 Thunderbird/38.2.0
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8; format=flowed
Content-Transfer-Encoding: 7bit

Since it gets more common to use the expression parser for string 
operations and not only for boolean checks, I think it would be useful 
(and powerful) to support

s/PATTERN/REPLACEMENT/FLAGS

and allow back references in REPLACEMENT. The operation would not try to 
do the replacement in place but create a new string according to the 
given PATTERN and REPLACEMENT.

I had a quick look at the flex and bison files which generate lexer and 
parser but must admit that it wasn't immediately obvious to me how to do 
it. I can try harder but first wanted to ask if there are any volunteers 
who know that technology better than me. Stefan (Frisch)? Others?

Otherwise I'll try myself (and learn new stuff on the way).

Regards,

Rainer

From dev-return-83994-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Thu Oct  1 10:31:56 2015
Return-Path: <dev-return-83994-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 2A9DC18E4B
	for <apmail-httpd-dev-archive@www.apache.org>; Thu,  1 Oct 2015 10:31:56 +0000 (UTC)
Received: (qmail 90296 invoked by uid 500); 1 Oct 2015 10:31:55 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 90232 invoked by uid 500); 1 Oct 2015 10:31:55 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 90222 invoked by uid 99); 1 Oct 2015 10:31:55 -0000
Received: from Unknown (HELO spamd4-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 01 Oct 2015 10:31:55 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd4-us-west.apache.org (ASF Mail Server at spamd4-us-west.apache.org) with ESMTP id 235A1C0470
	for <dev@httpd.apache.org>; Thu,  1 Oct 2015 10:31:55 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd4-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.006
X-Spam-Level:
X-Spam-Status: No, score=-0.006 tagged_above=-999 required=6.31
	tests=[RP_MATCHES_RCVD=-0.006, SPF_PASS=-0.001, URIBL_BLOCKED=0.001]
	autolearn=disabled
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd4-us-west.apache.org [10.40.0.11]) (amavisd-new, port 10024)
	with ESMTP id UWPl322etzEN for <dev@httpd.apache.org>;
	Thu,  1 Oct 2015 10:31:49 +0000 (UTC)
Received: from monica.sharp.fm (monica.sharp.fm [80.168.143.5])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTP id 7298B20F9F
	for <dev@httpd.apache.org>; Thu,  1 Oct 2015 10:31:48 +0000 (UTC)
Received: from [192.168.220.234] (unknown [192.168.220.234])
	(using TLSv1 with cipher DHE-RSA-AES256-SHA (256/256 bits))
	(Client did not present a certificate)
	(Authenticated sender: minfrin@sharp.fm)
	by monica.sharp.fm (Postfix) with ESMTPSA id DF3A1830FC
	for <dev@httpd.apache.org>; Thu,  1 Oct 2015 11:31:41 +0100 (BST)
Content-Type: text/plain; charset=utf-8
Mime-Version: 1.0 (Mac OS X Mail 8.2 \(2104\))
Subject: Re: Expression Parser: search and replace with s/PATTERN/REPLACEMENT/FLAGS
From: Graham Leggett <minfrin@sharp.fm>
In-Reply-To: <560D0A3F.9010609@kippdata.de>
Date: Thu, 1 Oct 2015 12:31:40 +0200
Content-Transfer-Encoding: quoted-printable
Message-Id: <588DBDE2-73BA-4FF4-91CC-8F780DB88715@sharp.fm>
References: <560D0A3F.9010609@kippdata.de>
To: dev@httpd.apache.org
X-Mailer: Apple Mail (2.2104)

On 01 Oct 2015, at 12:26 PM, Rainer Jung <rainer.jung@kippdata.de> =
wrote:

> Since it gets more common to use the expression parser for string =
operations and not only for boolean checks, I think it would be useful =
(and powerful) to support
>=20
> s/PATTERN/REPLACEMENT/FLAGS
>=20
> and allow back references in REPLACEMENT. The operation would not try =
to do the replacement in place but create a new string according to the =
given PATTERN and REPLACEMENT.
>=20
> I had a quick look at the flex and bison files which generate lexer =
and parser but must admit that it wasn't immediately obvious to me how =
to do it. I can try harder but first wanted to ask if there are any =
volunteers who know that technology better than me. Stefan (Frisch)? =
Others?
>=20
> Otherwise I'll try myself (and learn new stuff on the way).

We currently support a variation of this like this:

  <LocationMatch /path/(?<PATHNAME>[^/]+)>
    SomeDirective %{env:MATCH_PATHNAME}
  </LocationMatch>

Not sure if that=E2=80=99s what you had in mind, or if you=E2=80=99re =
trying to achieve something different?

Regards,
Graham
=E2=80=94


From dev-return-83995-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Thu Oct  1 11:38:07 2015
Return-Path: <dev-return-83995-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 084F718FE8
	for <apmail-httpd-dev-archive@www.apache.org>; Thu,  1 Oct 2015 11:38:07 +0000 (UTC)
Received: (qmail 27102 invoked by uid 500); 1 Oct 2015 11:38:06 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 27025 invoked by uid 500); 1 Oct 2015 11:38:06 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 27015 invoked by uid 99); 1 Oct 2015 11:38:06 -0000
Received: from Unknown (HELO spamd4-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 01 Oct 2015 11:38:06 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd4-us-west.apache.org (ASF Mail Server at spamd4-us-west.apache.org) with ESMTP id 9D536C027E
	for <dev@httpd.apache.org>; Thu,  1 Oct 2015 11:38:05 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd4-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.008
X-Spam-Level:
X-Spam-Status: No, score=-0.008 tagged_above=-999 required=6.31
	tests=[RP_MATCHES_RCVD=-0.006, SPF_HELO_PASS=-0.001, SPF_PASS=-0.001]
	autolearn=disabled
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd4-us-west.apache.org [10.40.0.11]) (amavisd-new, port 10024)
	with ESMTP id 0kE9c6Dv-RQY for <dev@httpd.apache.org>;
	Thu,  1 Oct 2015 11:38:03 +0000 (UTC)
Received: from mail.thelounge.net (mail.thelounge.net [91.118.73.15])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id 7B6A242AB6
	for <dev@httpd.apache.org>; Thu,  1 Oct 2015 11:38:03 +0000 (UTC)
Subject: Re: SSLUseStapling: ssl handshake fails until httpd restart
To: dev@httpd.apache.org
References: <560A49E5.2090500@thelounge.net> <560AAEEC.2080500@gmail.com>
 <560ABB39.2030805@thelounge.net> <560B8452.5070800@velox.ch>
From: Reindl Harald <h.reindl@thelounge.net>
Openpgp: id=13540402D67A7F71C6E974EA866063CF7F780279;
 url=https://arrakis.thelounge.net/gpg/h.reindl_thelounge.net.pub.txt
X-Enigmail-Draft-Status: N1110
Organization: the lounge interactive design
Message-ID: <560D1B12.4060502@thelounge.net>
Date: Thu, 1 Oct 2015 13:37:54 +0200
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:38.0) Gecko/20100101
 Thunderbird/38.2.0
MIME-Version: 1.0
In-Reply-To: <560B8452.5070800@velox.ch>
Content-Type: multipart/signed; micalg=pgp-sha1;
 protocol="application/pgp-signature";
 boundary="JovwaeUnVhmXHew1NraXMmtcl6D5AbvKs"

This is an OpenPGP/MIME signed message (RFC 4880 and 3156)
--JovwaeUnVhmXHew1NraXMmtcl6D5AbvKs
Content-Type: text/plain; charset=utf-8; format=flowed
Content-Transfer-Encoding: quoted-printable



Am 30.09.2015 um 08:42 schrieb Kaspar Brand:
> On 29.09.2015 18:24, Reindl Harald wrote:
>> i just restarted the servers and disabled stapling since all our
>> servcies where unreachable (before i write the second mail 5 different=

>> hosts with several sites where affected)
>>
>> in fact the error caching does more harm than benefits - IHMO a better=

>> "could not reach OCSP server or received a error from it" caching woul=
d
>> be just temporary disable stapling for 10 minutes instead lead in
>> connections fail even from clients which have disabled OCSP completly
>>
>>>> firefox refused to open our adminpanel with the error below until i
>>>> restarted httpd
>
> The default for SSLStaplingReturnResponderErrors is relatively odd.
> Not sure why it has always defaulted to "on" (r829619), but setting it
> to off should save you further troubles with Firefox clients.

not really, i had the error message just now again in FF, the difference =

was that now a "try again" loaded the page but with=20
"SSLStaplingReturnResponderErrors" i would expect it invisible to=20
clients in general - GoDaddy seems to have massive problems with their=20
responders the last days and the defaults with stapling enabled make=20
them to a perfect DOS target

[Thu Oct 01 13:33:01.179365 2015] [ssl:error] [pid 19312] [client=20
10.0.0.99:37860] AH01980: bad response from OCSP server: (none)
[Thu Oct 01 13:33:01.179393 2015] [ssl:error] [pid 19312] AH01941:=20
stapling_renew_response: responder error

SSLStaplingCache shmcb:/var/cache/mod_ssl/ocsp_cache(1048576)
SSLStaplingStandardCacheTimeout 86400
SSLStaplingErrorCacheTimeout 300
SSLStaplingReturnResponderErrors Off


--JovwaeUnVhmXHew1NraXMmtcl6D5AbvKs
Content-Type: application/pgp-signature; name="signature.asc"
Content-Description: OpenPGP digital signature
Content-Disposition: attachment; filename="signature.asc"

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v2

iEYEARECAAYFAlYNGxIACgkQhmBjz394Anm5WgCbBTu68xNY2wiKNUF7VF/2aXzE
ug4An386SJU8WVCUyJEuG+HBxt15PnjE
=cC0p
-----END PGP SIGNATURE-----

--JovwaeUnVhmXHew1NraXMmtcl6D5AbvKs--

From dev-return-83996-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Thu Oct  1 11:55:58 2015
Return-Path: <dev-return-83996-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 470371723E
	for <apmail-httpd-dev-archive@www.apache.org>; Thu,  1 Oct 2015 11:55:58 +0000 (UTC)
Received: (qmail 66381 invoked by uid 500); 1 Oct 2015 11:55:57 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 66318 invoked by uid 500); 1 Oct 2015 11:55:57 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 66308 invoked by uid 99); 1 Oct 2015 11:55:57 -0000
Received: from Unknown (HELO spamd2-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 01 Oct 2015 11:55:57 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd2-us-west.apache.org (ASF Mail Server at spamd2-us-west.apache.org) with ESMTP id 5AA5A1A3657
	for <dev@httpd.apache.org>; Thu,  1 Oct 2015 11:55:57 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd2-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 0.001
X-Spam-Level:
X-Spam-Status: No, score=0.001 tagged_above=-999 required=6.31
	tests=[RP_MATCHES_RCVD=0.001, SPF_PASS=-0.001, URIBL_BLOCKED=0.001]
	autolearn=disabled
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd2-us-west.apache.org [10.40.0.9]) (amavisd-new, port 10024)
	with ESMTP id QyjPMc625UgV for <dev@httpd.apache.org>;
	Thu,  1 Oct 2015 11:55:50 +0000 (UTC)
Received: from mailserver.kippdata.de (capsella.kippdata.de [195.227.30.149])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTP id D135742AB6
	for <dev@httpd.apache.org>; Thu,  1 Oct 2015 11:55:49 +0000 (UTC)
Received: from [195.227.30.209] (notebook-rj [195.227.30.209])
	by mailserver.kippdata.de (8.13.5/8.13.5) with ESMTP id t91BtmDD016734
	for <dev@httpd.apache.org>; Thu, 1 Oct 2015 13:55:48 +0200 (CEST)
Subject: Re: Expression Parser: search and replace with
 s/PATTERN/REPLACEMENT/FLAGS
To: dev@httpd.apache.org
References: <560D0A3F.9010609@kippdata.de>
 <588DBDE2-73BA-4FF4-91CC-8F780DB88715@sharp.fm>
From: Rainer Jung <rainer.jung@kippdata.de>
Message-ID: <560D1F3C.301@kippdata.de>
Date: Thu, 1 Oct 2015 13:55:40 +0200
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:38.0) Gecko/20100101
 Thunderbird/38.2.0
MIME-Version: 1.0
In-Reply-To: <588DBDE2-73BA-4FF4-91CC-8F780DB88715@sharp.fm>
Content-Type: text/plain; charset=utf-8; format=flowed
Content-Transfer-Encoding: 8bit

Am 01.10.2015 um 12:31 schrieb Graham Leggett:
> On 01 Oct 2015, at 12:26 PM, Rainer Jung <rainer.jung@kippdata.de> wrote:
>
>> Since it gets more common to use the expression parser for string operations and not only for boolean checks, I think it would be useful (and powerful) to support
>>
>> s/PATTERN/REPLACEMENT/FLAGS
>>
>> and allow back references in REPLACEMENT. The operation would not try to do the replacement in place but create a new string according to the given PATTERN and REPLACEMENT.
>>
>> I had a quick look at the flex and bison files which generate lexer and parser but must admit that it wasn't immediately obvious to me how to do it. I can try harder but first wanted to ask if there are any volunteers who know that technology better than me. Stefan (Frisch)? Others?
>>
>> Otherwise I'll try myself (and learn new stuff on the way).
>
> We currently support a variation of this like this:
>
>    <LocationMatch /path/(?<PATHNAME>[^/]+)>
>      SomeDirective %{env:MATCH_PATHNAME}
>    </LocationMatch>
>
> Not sure if that’s what you had in mind, or if you’re trying to achieve something different?

Something different. Example:

Header set X-USER "expr=%{REMOTE_USER} =~ s/([^@]*)@.*/$1/"

So the string result of a s/PATTERN/REPLACEMENT/ should be the resulting 
REPLACEMENT string (if REMOTE_USER is "name@domain", the header value 
would be "name").

The example might be artificial and mod_header might support doing this 
in another way, but IMHO it would be a nice general feature for the 
expression parser which would work without cooperation from the 
modules/directives that use the expression parser.

Regards,

Rainer


From dev-return-83997-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Thu Oct  1 12:18:26 2015
Return-Path: <dev-return-83997-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 67DA81730C
	for <apmail-httpd-dev-archive@www.apache.org>; Thu,  1 Oct 2015 12:18:26 +0000 (UTC)
Received: (qmail 6325 invoked by uid 500); 1 Oct 2015 12:18:16 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 6256 invoked by uid 500); 1 Oct 2015 12:18:16 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 6246 invoked by uid 99); 1 Oct 2015 12:18:16 -0000
Received: from Unknown (HELO spamd4-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 01 Oct 2015 12:18:16 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd4-us-west.apache.org (ASF Mail Server at spamd4-us-west.apache.org) with ESMTP id 2290AC00B1
	for <dev@httpd.apache.org>; Thu,  1 Oct 2015 12:18:16 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd4-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.006
X-Spam-Level:
X-Spam-Status: No, score=-0.006 tagged_above=-999 required=6.31
	tests=[RP_MATCHES_RCVD=-0.006, SPF_PASS=-0.001, URIBL_BLOCKED=0.001]
	autolearn=disabled
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd4-us-west.apache.org [10.40.0.11]) (amavisd-new, port 10024)
	with ESMTP id p5FTsG6JjfPi for <dev@httpd.apache.org>;
	Thu,  1 Oct 2015 12:18:08 +0000 (UTC)
Received: from mail.netnea.com (gstserv.netnea.com [213.200.225.210])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id 01C7420BFB
	for <dev@httpd.apache.org>; Thu,  1 Oct 2015 12:18:07 +0000 (UTC)
Received: from localhost (localhost [127.0.0.1])
	by mail.netnea.com (Postfix) with ESMTP id 30DBB40057
	for <dev@httpd.apache.org>; Thu,  1 Oct 2015 14:18:01 +0200 (CEST)
X-Virus-Scanned: Debian amavisd-new at neanet.com
Received: from mail.netnea.com ([127.0.0.1])
	by localhost (x28.netnea.com [127.0.0.1]) (amavisd-new, port 10024)
	with ESMTP id CyEQbutWlBPn for <dev@httpd.apache.org>;
	Thu,  1 Oct 2015 14:18:01 +0200 (CEST)
Received: from elias (unknown [93.94.243.179])
	(using TLSv1.2 with cipher ECDHE-RSA-AES256-GCM-SHA384 (256/256 bits))
	(Client did not present a certificate)
	by mail.netnea.com (Postfix) with ESMTPSA id 13A6B40056
	for <dev@httpd.apache.org>; Thu,  1 Oct 2015 14:18:01 +0200 (CEST)
Received: by elias (Postfix, from userid 1000)
	id 78EE9640BAE; Thu,  1 Oct 2015 14:18:00 +0200 (CEST)
Date: Thu, 1 Oct 2015 14:18:00 +0200
From: Christian Folini <christian.folini@netnea.com>
To: dev@httpd.apache.org
Subject: Re: Expression Parser: search and replace with
 s/PATTERN/REPLACEMENT/FLAGS
Message-ID: <20151001121800.GA11155@elias>
References: <560D0A3F.9010609@kippdata.de>
 <588DBDE2-73BA-4FF4-91CC-8F780DB88715@sharp.fm>
 <560D1F3C.301@kippdata.de>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Disposition: inline
In-Reply-To: <560D1F3C.301@kippdata.de>
User-Agent: Mutt/1.5.21 (2010-09-15)

On Thu, Oct 01, 2015 at 01:55:40PM +0200, Rainer Jung wrote:
> Something different. Example:
> 
> Header set X-USER "expr=%{REMOTE_USER} =~ s/([^@]*)@.*/$1/"
> 
> ...
> 
> The example might be artificial and mod_header might support doing
> this in another way, but IMHO it would be a nice general feature for
> the expression parser which would work without cooperation from the
> modules/directives that use the expression parser.

This would be really neat. We have a few recipes where we abuse
ModSecurity or mod_rewrite to achieve this. Having it available
within the expression parser would simplify things a lot
(and get rid of timing and hook precedence issues).

Ahoj,

Christian Folini

-- 
Christian Folini - <christian.folini@netnea.com>

From dev-return-83998-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Thu Oct  1 12:32:22 2015
Return-Path: <dev-return-83998-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id EDA621737D
	for <apmail-httpd-dev-archive@www.apache.org>; Thu,  1 Oct 2015 12:32:21 +0000 (UTC)
Received: (qmail 43284 invoked by uid 500); 1 Oct 2015 12:32:21 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 43221 invoked by uid 500); 1 Oct 2015 12:32:21 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 43210 invoked by uid 99); 1 Oct 2015 12:32:21 -0000
Received: from Unknown (HELO spamd3-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 01 Oct 2015 12:32:21 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd3-us-west.apache.org (ASF Mail Server at spamd3-us-west.apache.org) with ESMTP id 152DE180970
	for <dev@httpd.apache.org>; Thu,  1 Oct 2015 12:32:21 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd3-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 0.363
X-Spam-Level:
X-Spam-Status: No, score=0.363 tagged_above=-999 required=6.31
	tests=[RDNS_DYNAMIC=0.363] autolearn=disabled
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd3-us-west.apache.org [10.40.0.10]) (amavisd-new, port 10024)
	with ESMTP id qF89g8X70hIU for <dev@httpd.apache.org>;
	Thu,  1 Oct 2015 12:32:17 +0000 (UTC)
Received: from gungnir.webthing.com (209-20-83-52.slicehost.net [209.20.83.52])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTP id F222942B5D
	for <dev@httpd.apache.org>; Thu,  1 Oct 2015 12:32:16 +0000 (UTC)
Received: from [192.168.0.127] (cpc36-newt30-2-0-cust898.19-3.cable.virginm.net [82.32.195.131])
	by gungnir.webthing.com (Postfix) with ESMTPSA id B7F73E8C51
	for <dev@httpd.apache.org>; Thu,  1 Oct 2015 12:32:09 +0000 (UTC)
Message-ID: <1443702728.2576.93.camel@mimir.webthing.com>
Subject: Re: Expression Parser: search and replace with
 s/PATTERN/REPLACEMENT/FLAGS
From: Nick Kew <nick@webthing.com>
To: dev@httpd.apache.org
Date: Thu, 01 Oct 2015 13:32:08 +0100
In-Reply-To: <560D0A3F.9010609@kippdata.de>
References: <560D0A3F.9010609@kippdata.de>
Content-Type: text/plain; charset="UTF-8"
X-Mailer: Evolution 3.4.4-3 
Mime-Version: 1.0
Content-Transfer-Encoding: 7bit

On Thu, 2015-10-01 at 12:26 +0200, Rainer Jung wrote:
> Since it gets more common to use the expression parser for string 
> operations and not only for boolean checks, I think it would be useful 
> (and powerful) to support
> 
> s/PATTERN/REPLACEMENT/FLAGS
> 
> and allow back references in REPLACEMENT. The operation would not try to 
> do the replacement in place but create a new string according to the 
> given PATTERN and REPLACEMENT.

Are you mixing two things?  That's well-established regexp syntax,
but you're looking at applying it to a different class expressions.
I think the most interesting issue is to define your behaviour.

> Header set X-USER "expr=%{REMOTE_USER} =~ s/([^@]*)@.*/$1/"

Aha!  In terms of the expression parser, that looks like
capturing a side-effect (as opposed to a true/false result).
Maybe it would work with something like C comma-list syntax?
But I expect the line of least resistance would be to use
plain regexp rather than expr.

-- 
Nick Kew


From dev-return-83999-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Thu Oct  1 12:33:19 2015
Return-Path: <dev-return-83999-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id E4A7D17384
	for <apmail-httpd-dev-archive@www.apache.org>; Thu,  1 Oct 2015 12:33:18 +0000 (UTC)
Received: (qmail 44635 invoked by uid 500); 1 Oct 2015 12:33:18 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 44562 invoked by uid 500); 1 Oct 2015 12:33:18 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 44552 invoked by uid 99); 1 Oct 2015 12:33:18 -0000
Received: from Unknown (HELO spamd1-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 01 Oct 2015 12:33:18 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd1-us-west.apache.org (ASF Mail Server at spamd1-us-west.apache.org) with ESMTP id 08F10C7B72
	for <dev@httpd.apache.org>; Thu,  1 Oct 2015 12:33:18 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd1-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.101
X-Spam-Level:
X-Spam-Status: No, score=-0.101 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RCVD_IN_MSPIKE_H2=-0.001, SPF_PASS=-0.001, URIBL_BLOCKED=0.001]
	autolearn=disabled
Authentication-Results: spamd1-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd1-us-west.apache.org [10.40.0.7]) (amavisd-new, port 10024)
	with ESMTP id guWmaPKFQMM4 for <dev@httpd.apache.org>;
	Thu,  1 Oct 2015 12:33:14 +0000 (UTC)
Received: from mail-ig0-f171.google.com (mail-ig0-f171.google.com [209.85.213.171])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id C3B9F42B5D
	for <dev@httpd.apache.org>; Thu,  1 Oct 2015 12:33:13 +0000 (UTC)
Received: by igbni9 with SMTP id ni9so13386394igb.0
        for <dev@httpd.apache.org>; Thu, 01 Oct 2015 05:33:13 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        bh=o/LJEf2o8bporZvgzuHGDDM+avgpMnp8QoGP6WK/jDQ=;
        b=HxQDYlajMFwM8UoYS08qwRXeYigc2Y3/h7ZSy937Kjty2GR52XB/erTGmfpU21ZGuN
         S5EL2Lk9vaOCbT7tAnWUIaHfF8cXZeq8/VCyor80dpK6ypQe9Ak5d+1fj8Abf297wMvo
         YPYrKTuqdY9U9sF+/cM02XTEBM3MnudtVqQ7iH/JHVMtDo7UbRv43Xs1jqWS/wJkszTY
         25AWW6vycY+41PxDVu3SZK28+JsgVvMiL/9MqA5k33+ogifbaQLadZy/Lm1MHPwjSDoN
         0IjXqWdUcEYerXiKwzVETvmMTnQy3j34IucrL0gx5e0NITVl6CMYFqh5o9V4PKXuvJrU
         w14Q==
MIME-Version: 1.0
X-Received: by 10.50.141.234 with SMTP id rr10mr2827156igb.56.1443702793284;
 Thu, 01 Oct 2015 05:33:13 -0700 (PDT)
Received: by 10.64.25.3 with HTTP; Thu, 1 Oct 2015 05:33:13 -0700 (PDT)
In-Reply-To: <560D0A3F.9010609@kippdata.de>
References: <560D0A3F.9010609@kippdata.de>
Date: Thu, 1 Oct 2015 08:33:13 -0400
Message-ID: <CALK=YjPB=xUQg2_B0p6YKocQ58GBf5YtpR1tnJnS+ua+4=G2YA@mail.gmail.com>
Subject: Re: Expression Parser: search and replace with s/PATTERN/REPLACEMENT/FLAGS
From: Eric Covener <covener@gmail.com>
To: Apache HTTP Server Development List <dev@httpd.apache.org>
Content-Type: text/plain; charset=UTF-8

On Thu, Oct 1, 2015 at 6:26 AM, Rainer Jung <rainer.jung@kippdata.de> wrote:
> Since it gets more common to use the expression parser for string operations
> and not only for boolean checks, I think it would be useful (and powerful)
> to support
>
> s/PATTERN/REPLACEMENT/FLAGS
>
> and allow back references in REPLACEMENT. The operation would not try to do
> the replacement in place but create a new string according to the given
> PATTERN and REPLACEMENT.
>
> I had a quick look at the flex and bison files which generate lexer and
> parser but must admit that it wasn't immediately obvious to me how to do it.
> I can try harder but first wanted to ask if there are any volunteers who
> know that technology better than me. Stefan (Frisch)? Others?
>
> Otherwise I'll try myself (and learn new stuff on the way).

I've tried and failed to hack the exact same thing in a few times.  I
agree it would be great to have.

From dev-return-84000-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Thu Oct  1 12:42:48 2015
Return-Path: <dev-return-84000-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 2FE56173D0
	for <apmail-httpd-dev-archive@www.apache.org>; Thu,  1 Oct 2015 12:42:48 +0000 (UTC)
Received: (qmail 63927 invoked by uid 500); 1 Oct 2015 12:42:47 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 63855 invoked by uid 500); 1 Oct 2015 12:42:47 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 63845 invoked by uid 99); 1 Oct 2015 12:42:47 -0000
Received: from Unknown (HELO spamd3-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 01 Oct 2015 12:42:47 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd3-us-west.apache.org (ASF Mail Server at spamd3-us-west.apache.org) with ESMTP id 27BAC180293
	for <dev@httpd.apache.org>; Thu,  1 Oct 2015 12:42:47 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd3-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 0.998
X-Spam-Level:
X-Spam-Status: No, score=0.998 tagged_above=-999 required=6.31
	tests=[KAM_LAZY_DOMAIN_SECURITY=1, RCVD_IN_MSPIKE_H2=-0.001,
	SPF_HELO_PASS=-0.001] autolearn=disabled
Received: from mx1-us-west.apache.org ([10.40.0.8])
	by localhost (spamd3-us-west.apache.org [10.40.0.10]) (amavisd-new, port 10024)
	with ESMTP id DMaXHXzSRbEk for <dev@httpd.apache.org>;
	Thu,  1 Oct 2015 12:42:35 +0000 (UTC)
Received: from mail1.bemta5.messagelabs.com (mail1.bemta5.messagelabs.com [195.245.231.139])
	by mx1-us-west.apache.org (ASF Mail Server at mx1-us-west.apache.org) with ESMTPS id 72F9020513
	for <dev@httpd.apache.org>; Thu,  1 Oct 2015 12:42:35 +0000 (UTC)
Received: from [85.158.136.83] by server-3.bemta-5.messagelabs.com id 3C/D2-06179-33A2D065; Thu, 01 Oct 2015 12:42:27 +0000
X-Env-Sender: ruediger.pluem@vodafone.com
X-Msg-Ref: server-14.tower-36.messagelabs.com!1443703347!26286526!1
X-Originating-IP: [195.232.244.134]
X-StarScan-Received:
X-StarScan-Version: 6.13.16; banners=-,-,-
X-VirusChecked: Checked
Received: (qmail 3290 invoked from network); 1 Oct 2015 12:42:27 -0000
Received: from mailout02.vodafone.com (HELO mailout02.vodafone.com) (195.232.244.134)
  by server-14.tower-36.messagelabs.com with DHE-RSA-AES256-SHA encrypted SMTP; 1 Oct 2015 12:42:27 -0000
Received: from mailint02.vodafone.com (mailint02.vodafone.com [195.232.244.199])
	by mailout02.vodafone.com (Postfix) with ESMTP id 3nRYxt5YkRzbdPb
	for <dev@httpd.apache.org>; Thu,  1 Oct 2015 14:42:26 +0200 (CEST)
Received: from mailint02.vodafone.com (localhost [127.0.0.1])
	by mailint02.vodafone.com (Postfix) with ESMTP id 3nRYx6001wzQqtK
	for <dev@httpd.apache.org>; Thu,  1 Oct 2015 14:41:45 +0200 (CEST)
Received: from VOEXC03W.internal.vodafone.com (voexc03w.dc-ratingen.de [145.230.101.23])
	(using TLSv1 with cipher AES128-SHA (128/128 bits))
	(No client certificate requested)
	by mailint02.vodafone.com (Postfix) with ESMTPS id 3nRYx56mGmzQl6M
	for <dev@httpd.apache.org>; Thu,  1 Oct 2015 14:41:45 +0200 (CEST)
Received: from AVOEXH04W.internal.vodafone.com (145.230.15.136) by
 VOEXC03W.internal.vodafone.com (145.230.101.23) with Microsoft SMTP Server
 (TLS) id 14.3.224.2; Thu, 1 Oct 2015 14:41:44 +0200
Received: from VOEXM10W.internal.vodafone.com ([169.254.2.132]) by
 AVOEXH04W.internal.vodafone.com ([145.230.15.136]) with mapi id
 14.03.0224.002; Thu, 1 Oct 2015 14:41:44 +0200
From: =?utf-8?B?UGzDvG0sIFLDvGRpZ2VyLCBWb2RhZm9uZSBHcm91cA==?=
	<ruediger.pluem@vodafone.com>
To: "dev@httpd.apache.org" <dev@httpd.apache.org>
Subject: AW: Expression Parser: search and replace with
 s/PATTERN/REPLACEMENT/FLAGS
Thread-Topic: Expression Parser: search and replace with
 s/PATTERN/REPLACEMENT/FLAGS
Thread-Index: AQHQ/DiNnN1qKSsBQkSYH42UVxqHf55WTr8AgAAXeACAAC5L4A==
Date: Thu, 1 Oct 2015 12:41:43 +0000
Message-ID: <AB1691BE05AE7F4992697F2A0835627AC6325B72@VOEXM10W.internal.vodafone.com>
References: <560D0A3F.9010609@kippdata.de>
 <588DBDE2-73BA-4FF4-91CC-8F780DB88715@sharp.fm> <560D1F3C.301@kippdata.de>
In-Reply-To: <560D1F3C.301@kippdata.de>
Accept-Language: en-US
Content-Language: de-DE
X-MS-Has-Attach:
X-MS-TNEF-Correlator:
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
MIME-Version: 1.0

DQoNCj4gLS0tLS1VcnNwcsO8bmdsaWNoZSBOYWNocmljaHQtLS0tLQ0KPiBWb246IFJhaW5lciBK
dW5nIA0KPiBHZXNlbmRldDogRG9ubmVyc3RhZywgMS4gT2t0b2JlciAyMDE1IDEzOjU2DQo+IEFu
OiBkZXZAaHR0cGQuYXBhY2hlLm9yZw0KPiBCZXRyZWZmOiBSZTogRXhwcmVzc2lvbiBQYXJzZXI6
IHNlYXJjaCBhbmQgcmVwbGFjZSB3aXRoDQo+IHMvUEFUVEVSTi9SRVBMQUNFTUVOVC9GTEFHUw0K
PiANCj4gDQo+IFRoZSBleGFtcGxlIG1pZ2h0IGJlIGFydGlmaWNpYWwgYW5kIG1vZF9oZWFkZXIg
bWlnaHQgc3VwcG9ydCBkb2luZyB0aGlzDQo+IGluIGFub3RoZXIgd2F5LCBidXQgSU1ITyBpdCB3
b3VsZCBiZSBhIG5pY2UgZ2VuZXJhbCBmZWF0dXJlIGZvciB0aGUNCj4gZXhwcmVzc2lvbiBwYXJz
ZXIgd2hpY2ggd291bGQgd29yayB3aXRob3V0IGNvb3BlcmF0aW9uIGZyb20gdGhlDQo+IG1vZHVs
ZXMvZGlyZWN0aXZlcyB0aGF0IHVzZSB0aGUgZXhwcmVzc2lvbiBwYXJzZXIuDQo+IA0KDQorMQ0K
DQpSZWdhcmRzDQoNClLDvGRpZ2VyDQo=

From dev-return-84001-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Thu Oct  1 12:44:30 2015
Return-Path: <dev-return-84001-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id C58A1173DD
	for <apmail-httpd-dev-archive@www.apache.org>; Thu,  1 Oct 2015 12:44:30 +0000 (UTC)
Received: (qmail 70794 invoked by uid 500); 1 Oct 2015 12:44:30 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 70731 invoked by uid 500); 1 Oct 2015 12:44:30 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 70715 invoked by uid 99); 1 Oct 2015 12:44:30 -0000
Received: from Unknown (HELO spamd3-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 01 Oct 2015 12:44:30 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd3-us-west.apache.org (ASF Mail Server at spamd3-us-west.apache.org) with ESMTP id DD09B18097C
	for <dev@httpd.apache.org>; Thu,  1 Oct 2015 12:44:29 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd3-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.005
X-Spam-Level:
X-Spam-Status: No, score=-0.005 tagged_above=-999 required=6.31
	tests=[RP_MATCHES_RCVD=-0.006, URIBL_BLOCKED=0.001] autolearn=disabled
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd3-us-west.apache.org [10.40.0.10]) (amavisd-new, port 10024)
	with ESMTP id 5eUw-hH2XOWx for <dev@httpd.apache.org>;
	Thu,  1 Oct 2015 12:44:21 +0000 (UTC)
Received: from mailserver.kippdata.de (capsella.kippdata.de [195.227.30.149])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTP id E5DD042B5D
	for <dev@httpd.apache.org>; Thu,  1 Oct 2015 12:44:20 +0000 (UTC)
Received: from [195.227.30.209] (notebook-rj [195.227.30.209])
	by mailserver.kippdata.de (8.13.5/8.13.5) with ESMTP id t91CiKqF018904
	for <dev@httpd.apache.org>; Thu, 1 Oct 2015 14:44:20 +0200 (CEST)
Subject: Re: Expression Parser: search and replace with
 s/PATTERN/REPLACEMENT/FLAGS
To: dev@httpd.apache.org
References: <560D0A3F.9010609@kippdata.de>
 <CALK=YjPB=xUQg2_B0p6YKocQ58GBf5YtpR1tnJnS+ua+4=G2YA@mail.gmail.com>
From: Rainer Jung <rainer.jung@kippdata.de>
Message-ID: <560D2A9B.1010300@kippdata.de>
Date: Thu, 1 Oct 2015 14:44:11 +0200
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:38.0) Gecko/20100101
 Thunderbird/38.2.0
MIME-Version: 1.0
In-Reply-To: <CALK=YjPB=xUQg2_B0p6YKocQ58GBf5YtpR1tnJnS+ua+4=G2YA@mail.gmail.com>
Content-Type: text/plain; charset=utf-8; format=flowed
Content-Transfer-Encoding: 7bit

Am 01.10.2015 um 14:33 schrieb Eric Covener:
> On Thu, Oct 1, 2015 at 6:26 AM, Rainer Jung <rainer.jung@kippdata.de> wrote:
>> Since it gets more common to use the expression parser for string operations
>> and not only for boolean checks, I think it would be useful (and powerful)
>> to support
>>
>> s/PATTERN/REPLACEMENT/FLAGS
>>
>> and allow back references in REPLACEMENT. The operation would not try to do
>> the replacement in place but create a new string according to the given
>> PATTERN and REPLACEMENT.
>>
>> I had a quick look at the flex and bison files which generate lexer and
>> parser but must admit that it wasn't immediately obvious to me how to do it.
>> I can try harder but first wanted to ask if there are any volunteers who
>> know that technology better than me. Stefan (Frisch)? Others?
>>
>> Otherwise I'll try myself (and learn new stuff on the way).
>
> I've tried and failed to hack the exact same thing in a few times.  I
> agree it would be great to have.

OK, at least an encouragement for me to have a closer look.

Regards,

Rainer

From dev-return-84002-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Thu Oct  1 12:52:03 2015
Return-Path: <dev-return-84002-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 17DDC17420
	for <apmail-httpd-dev-archive@www.apache.org>; Thu,  1 Oct 2015 12:52:03 +0000 (UTC)
Received: (qmail 87730 invoked by uid 500); 1 Oct 2015 12:52:02 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 87656 invoked by uid 500); 1 Oct 2015 12:52:02 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 87646 invoked by uid 99); 1 Oct 2015 12:52:02 -0000
Received: from Unknown (HELO spamd2-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 01 Oct 2015 12:52:02 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd2-us-west.apache.org (ASF Mail Server at spamd2-us-west.apache.org) with ESMTP id 31FCD1A3572
	for <dev@httpd.apache.org>; Thu,  1 Oct 2015 12:52:02 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd2-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 0
X-Spam-Level:
X-Spam-Status: No, score=0 tagged_above=-999 required=6.31
	tests=[RP_MATCHES_RCVD=0.001, SPF_PASS=-0.001] autolearn=disabled
Received: from mx1-us-west.apache.org ([10.40.0.8])
	by localhost (spamd2-us-west.apache.org [10.40.0.9]) (amavisd-new, port 10024)
	with ESMTP id JmVZcjbL3xby for <dev@httpd.apache.org>;
	Thu,  1 Oct 2015 12:52:01 +0000 (UTC)
Received: from mailserver.kippdata.de (capsella.kippdata.de [195.227.30.149])
	by mx1-us-west.apache.org (ASF Mail Server at mx1-us-west.apache.org) with ESMTP id CD00C20F7B
	for <dev@httpd.apache.org>; Thu,  1 Oct 2015 12:52:00 +0000 (UTC)
Received: from [195.227.30.209] (notebook-rj [195.227.30.209])
	by mailserver.kippdata.de (8.13.5/8.13.5) with ESMTP id t91CppmE019148
	for <dev@httpd.apache.org>; Thu, 1 Oct 2015 14:51:52 +0200 (CEST)
Subject: Re: Expression Parser: search and replace with
 s/PATTERN/REPLACEMENT/FLAGS
To: dev@httpd.apache.org
References: <560D0A3F.9010609@kippdata.de>
 <1443702728.2576.93.camel@mimir.webthing.com>
From: Rainer Jung <rainer.jung@kippdata.de>
Message-ID: <560D2C5E.3080100@kippdata.de>
Date: Thu, 1 Oct 2015 14:51:42 +0200
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:38.0) Gecko/20100101
 Thunderbird/38.2.0
MIME-Version: 1.0
In-Reply-To: <1443702728.2576.93.camel@mimir.webthing.com>
Content-Type: text/plain; charset=utf-8; format=flowed
Content-Transfer-Encoding: 7bit

Am 01.10.2015 um 14:32 schrieb Nick Kew:
> On Thu, 2015-10-01 at 12:26 +0200, Rainer Jung wrote:
>> Since it gets more common to use the expression parser for string
>> operations and not only for boolean checks, I think it would be useful
>> (and powerful) to support
>>
>> s/PATTERN/REPLACEMENT/FLAGS
>>
>> and allow back references in REPLACEMENT. The operation would not try to
>> do the replacement in place but create a new string according to the
>> given PATTERN and REPLACEMENT.
>
> Are you mixing two things?  That's well-established regexp syntax,
> but you're looking at applying it to a different class expressions.
> I think the most interesting issue is to define your behaviour.
>
>> Header set X-USER "expr=%{REMOTE_USER} =~ s/([^@]*)@.*/$1/"
>
> Aha!  In terms of the expression parser, that looks like
> capturing a side-effect (as opposed to a true/false result).
> Maybe it would work with something like C comma-list syntax?
> But I expect the line of least resistance would be to use
> plain regexp rather than expr.

I'm talking about the use of the expression parser in the string 
context, not in boolean context. Support for string context started some 
time back and we now support it in more and more places. One could 
implement the

var =~ s/PATTERN/REPLACEMENT/FLAGS

syntax also as a four argument function regexreplace(var, PATTERN, 
REPLACEMENT, FLAGS), but the notation using s/.../.../ should be 
well-known to many so IMHO is preferable.

So I want to enhance the expr syntax in string context to allow

VARIABLE =~ s/PATTERN/REPLACEMENT/FLAGS

This should return a string that is the result of the same operation in 
for example perl. VARIABLE will not be changed - unlike in perl - but 
the result string will be s/PATTERN/REPLACEMENT/FLAGS applied to VARIABLE.

I think that is currently not possible with the expression parser but I 
expect it to be useful and if noone has a recipe how to get it done with 
our flex/bison definitions I'll try to find out.

Since we don't support s/.../.../ right now, there shouldn't be to much 
compatibility hassle with existing expressions.

Regards,

Rainer

From dev-return-84003-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Thu Oct  1 12:55:00 2015
Return-Path: <dev-return-84003-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 932D01743A
	for <apmail-httpd-dev-archive@www.apache.org>; Thu,  1 Oct 2015 12:55:00 +0000 (UTC)
Received: (qmail 94774 invoked by uid 500); 1 Oct 2015 12:55:00 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 94705 invoked by uid 500); 1 Oct 2015 12:55:00 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 94694 invoked by uid 99); 1 Oct 2015 12:55:00 -0000
Received: from Unknown (HELO spamd1-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 01 Oct 2015 12:55:00 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd1-us-west.apache.org (ASF Mail Server at spamd1-us-west.apache.org) with ESMTP id A1E43C810C
	for <dev@httpd.apache.org>; Thu,  1 Oct 2015 12:54:59 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd1-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 0.998
X-Spam-Level:
X-Spam-Status: No, score=0.998 tagged_above=-999 required=6.31
	tests=[KAM_LAZY_DOMAIN_SECURITY=1, RCVD_IN_MSPIKE_H2=-0.001,
	SPF_HELO_PASS=-0.001] autolearn=disabled
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd1-us-west.apache.org [10.40.0.7]) (amavisd-new, port 10024)
	with ESMTP id xZNKJmG_BfWr for <dev@httpd.apache.org>;
	Thu,  1 Oct 2015 12:54:48 +0000 (UTC)
Received: from mail1.bemta14.messagelabs.com (mail1.bemta14.messagelabs.com [193.109.254.107])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id F323E42C69
	for <dev@httpd.apache.org>; Thu,  1 Oct 2015 12:54:47 +0000 (UTC)
Received: from [193.109.255.99] by server-3.bemta-14.messagelabs.com id E9/D5-25435-11D2D065; Thu, 01 Oct 2015 12:54:41 +0000
X-Env-Sender: ruediger.pluem@vodafone.com
X-Msg-Ref: server-6.tower-48.messagelabs.com!1443704080!20076856!1
X-Originating-IP: [195.232.244.136]
X-StarScan-Received:
X-StarScan-Version: 6.13.16; banners=-,-,-
X-VirusChecked: Checked
Received: (qmail 28265 invoked from network); 1 Oct 2015 12:54:40 -0000
Received: from mailout04.vodafone.com (HELO mailout04.vodafone.com) (195.232.244.136)
  by server-6.tower-48.messagelabs.com with DHE-RSA-AES256-SHA encrypted SMTP; 1 Oct 2015 12:54:40 -0000
Received: from mailint01.vodafone.com (mailint01.vodafone.com [195.232.244.198])
	by mailout04.vodafone.com (Postfix) with ESMTP id 3nRZD03GcgznTbM
	for <dev@httpd.apache.org>; Thu,  1 Oct 2015 14:54:40 +0200 (CEST)
Received: from mailint01.vodafone.com (localhost [127.0.0.1])
	by mailint01.vodafone.com (Postfix) with ESMTP id 3nRZBg1jgXzxRSq
	for <dev@httpd.apache.org>; Thu,  1 Oct 2015 14:53:31 +0200 (CEST)
Received: from VOEXC06W.internal.vodafone.com (voexc06w.dc-ratingen.de [145.230.101.26])
	(using TLSv1 with cipher AES128-SHA (128/128 bits))
	(No client certificate requested)
	by mailint01.vodafone.com (Postfix) with ESMTPS id 3nRZBg1fLTzxRR5
	for <dev@httpd.apache.org>; Thu,  1 Oct 2015 14:53:31 +0200 (CEST)
Received: from VOEXC24W.internal.vodafone.com (145.230.103.196) by
 VOEXC06W.internal.vodafone.com (145.230.101.26) with Microsoft SMTP Server
 (TLS) id 14.3.224.2; Thu, 1 Oct 2015 14:53:30 +0200
Received: from VOEXM10W.internal.vodafone.com ([169.254.2.132]) by voexc24w
 ([145.230.103.196]) with mapi id 14.03.0224.002; Thu, 1 Oct 2015 14:53:30
 +0200
From: =?utf-8?B?UGzDvG0sIFLDvGRpZ2VyLCBWb2RhZm9uZSBHcm91cA==?=
	<ruediger.pluem@vodafone.com>
To: "dev@httpd.apache.org" <dev@httpd.apache.org>
Subject: AW: SSLUseStapling: ssl handshake fails until httpd restart
Thread-Topic: SSLUseStapling: ssl handshake fails until httpd restart
Thread-Index: AQHQ+o/hyWTIy/sSVUe18l9/RxnDnZ5TgUsAgAAOqoCAAO+6AIAB5OIAgAA2gDA=
Date: Thu, 1 Oct 2015 12:53:29 +0000
Message-ID: <AB1691BE05AE7F4992697F2A0835627AC6325BD7@VOEXM10W.internal.vodafone.com>
References: <560A49E5.2090500@thelounge.net> <560AAEEC.2080500@gmail.com>
 <560ABB39.2030805@thelounge.net> <560B8452.5070800@velox.ch>
 <560D1B12.4060502@thelounge.net>
In-Reply-To: <560D1B12.4060502@thelounge.net>
Accept-Language: en-US
Content-Language: de-DE
X-MS-Has-Attach:
X-MS-TNEF-Correlator:
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
MIME-Version: 1.0

DQoNCj4gLS0tLS1VcnNwcsO8bmdsaWNoZSBOYWNocmljaHQtLS0tLQ0KPiBWb246IFJlaW5kbCBI
YXJhbGQgW21haWx0bzpoLnJlaW5kbEB0aGVsb3VuZ2UubmV0XQ0KPiBHZXNlbmRldDogRG9ubmVy
c3RhZywgMS4gT2t0b2JlciAyMDE1IDEzOjM4DQo+IEFuOiBkZXZAaHR0cGQuYXBhY2hlLm9yZw0K
PiBCZXRyZWZmOiBSZTogU1NMVXNlU3RhcGxpbmc6IHNzbCBoYW5kc2hha2UgZmFpbHMgdW50aWwg
aHR0cGQgcmVzdGFydA0KPiANCj4gDQo+IA0KPiBBbSAzMC4wOS4yMDE1IHVtIDA4OjQyIHNjaHJp
ZWIgS2FzcGFyIEJyYW5kOg0KPiA+IE9uIDI5LjA5LjIwMTUgMTg6MjQsIFJlaW5kbCBIYXJhbGQg
d3JvdGU6DQo+ID4+IGkganVzdCByZXN0YXJ0ZWQgdGhlIHNlcnZlcnMgYW5kIGRpc2FibGVkIHN0
YXBsaW5nIHNpbmNlIGFsbCBvdXINCj4gPj4gc2VydmNpZXMgd2hlcmUgdW5yZWFjaGFibGUgKGJl
Zm9yZSBpIHdyaXRlIHRoZSBzZWNvbmQgbWFpbCA1DQo+IGRpZmZlcmVudA0KPiA+PiBob3N0cyB3
aXRoIHNldmVyYWwgc2l0ZXMgd2hlcmUgYWZmZWN0ZWQpDQo+ID4+DQo+ID4+IGluIGZhY3QgdGhl
IGVycm9yIGNhY2hpbmcgZG9lcyBtb3JlIGhhcm0gdGhhbiBiZW5lZml0cyAtIElITU8gYQ0KPiBi
ZXR0ZXINCj4gPj4gImNvdWxkIG5vdCByZWFjaCBPQ1NQIHNlcnZlciBvciByZWNlaXZlZCBhIGVy
cm9yIGZyb20gaXQiIGNhY2hpbmcNCj4gd291bGQNCj4gPj4gYmUganVzdCB0ZW1wb3JhcnkgZGlz
YWJsZSBzdGFwbGluZyBmb3IgMTAgbWludXRlcyBpbnN0ZWFkIGxlYWQgaW4NCj4gPj4gY29ubmVj
dGlvbnMgZmFpbCBldmVuIGZyb20gY2xpZW50cyB3aGljaCBoYXZlIGRpc2FibGVkIE9DU1AgY29t
cGxldGx5DQo+ID4+DQo+ID4+Pj4gZmlyZWZveCByZWZ1c2VkIHRvIG9wZW4gb3VyIGFkbWlucGFu
ZWwgd2l0aCB0aGUgZXJyb3IgYmVsb3cgdW50aWwgaQ0KPiA+Pj4+IHJlc3RhcnRlZCBodHRwZA0K
PiA+DQo+ID4gVGhlIGRlZmF1bHQgZm9yIFNTTFN0YXBsaW5nUmV0dXJuUmVzcG9uZGVyRXJyb3Jz
IGlzIHJlbGF0aXZlbHkgb2RkLg0KPiA+IE5vdCBzdXJlIHdoeSBpdCBoYXMgYWx3YXlzIGRlZmF1
bHRlZCB0byAib24iIChyODI5NjE5KSwgYnV0IHNldHRpbmcgaXQNCj4gPiB0byBvZmYgc2hvdWxk
IHNhdmUgeW91IGZ1cnRoZXIgdHJvdWJsZXMgd2l0aCBGaXJlZm94IGNsaWVudHMuDQo+IA0KPiBu
b3QgcmVhbGx5LCBpIGhhZCB0aGUgZXJyb3IgbWVzc2FnZSBqdXN0IG5vdyBhZ2FpbiBpbiBGRiwg
dGhlIGRpZmZlcmVuY2UNCj4gd2FzIHRoYXQgbm93IGEgInRyeSBhZ2FpbiIgbG9hZGVkIHRoZSBw
YWdlIGJ1dCB3aXRoDQo+ICJTU0xTdGFwbGluZ1JldHVyblJlc3BvbmRlckVycm9ycyIgaSB3b3Vs
ZCBleHBlY3QgaXQgaW52aXNpYmxlIHRvDQo+IGNsaWVudHMgaW4gZ2VuZXJhbCAtIEdvRGFkZHkg
c2VlbXMgdG8gaGF2ZSBtYXNzaXZlIHByb2JsZW1zIHdpdGggdGhlaXINCj4gcmVzcG9uZGVycyB0
aGUgbGFzdCBkYXlzIGFuZCB0aGUgZGVmYXVsdHMgd2l0aCBzdGFwbGluZyBlbmFibGVkIG1ha2UN
Cj4gdGhlbSB0byBhIHBlcmZlY3QgRE9TIHRhcmdldA0KPiANCj4gW1RodSBPY3QgMDEgMTM6MzM6
MDEuMTc5MzY1IDIwMTVdIFtzc2w6ZXJyb3JdIFtwaWQgMTkzMTJdIFtjbGllbnQNCj4gMTAuMC4w
Ljk5OjM3ODYwXSBBSDAxOTgwOiBiYWQgcmVzcG9uc2UgZnJvbSBPQ1NQIHNlcnZlcjogKG5vbmUp
DQo+IFtUaHUgT2N0IDAxIDEzOjMzOjAxLjE3OTM5MyAyMDE1XSBbc3NsOmVycm9yXSBbcGlkIDE5
MzEyXSBBSDAxOTQxOg0KPiBzdGFwbGluZ19yZW5ld19yZXNwb25zZTogcmVzcG9uZGVyIGVycm9y
DQo+IA0KPiBTU0xTdGFwbGluZ0NhY2hlIHNobWNiOi92YXIvY2FjaGUvbW9kX3NzbC9vY3NwX2Nh
Y2hlKDEwNDg1NzYpDQo+IFNTTFN0YXBsaW5nU3RhbmRhcmRDYWNoZVRpbWVvdXQgODY0MDANCj4g
U1NMU3RhcGxpbmdFcnJvckNhY2hlVGltZW91dCAzMDANCj4gU1NMU3RhcGxpbmdSZXR1cm5SZXNw
b25kZXJFcnJvcnMgT2ZmDQoNCldoYXQgaGFwcGVucyBpZiB5b3Ugc2V0DQoNClNTTFN0YXBsaW5n
RmFrZVRyeUxhdGVyIG9mZg0KDQppbiBhZGRpdGlvbj8NCg0KUmVnYXJkcw0KDQpSw7xkaWdlcg0K
DQo=

From dev-return-84004-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Thu Oct  1 12:56:51 2015
Return-Path: <dev-return-84004-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 5948E17462
	for <apmail-httpd-dev-archive@www.apache.org>; Thu,  1 Oct 2015 12:56:51 +0000 (UTC)
Received: (qmail 2601 invoked by uid 500); 1 Oct 2015 12:56:47 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 2514 invoked by uid 500); 1 Oct 2015 12:56:47 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 2504 invoked by uid 99); 1 Oct 2015 12:56:47 -0000
Received: from Unknown (HELO spamd4-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 01 Oct 2015 12:56:47 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd4-us-west.apache.org (ASF Mail Server at spamd4-us-west.apache.org) with ESMTP id 44256C01D9
	for <dev@httpd.apache.org>; Thu,  1 Oct 2015 12:56:47 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd4-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 1.363
X-Spam-Level: *
X-Spam-Status: No, score=1.363 tagged_above=-999 required=6.31
	tests=[KAM_LAZY_DOMAIN_SECURITY=1, RDNS_DYNAMIC=0.363]
	autolearn=disabled
Received: from mx1-us-west.apache.org ([10.40.0.8])
	by localhost (spamd4-us-west.apache.org [10.40.0.11]) (amavisd-new, port 10024)
	with ESMTP id d-2kL2c7HAeH for <dev@httpd.apache.org>;
	Thu,  1 Oct 2015 12:56:46 +0000 (UTC)
Received: from gungnir.webthing.com (209-20-83-52.slicehost.net [209.20.83.52])
	by mx1-us-west.apache.org (ASF Mail Server at mx1-us-west.apache.org) with ESMTP id A6D082074F
	for <dev@httpd.apache.org>; Thu,  1 Oct 2015 12:56:46 +0000 (UTC)
Received: from [192.168.0.127] (cpc36-newt30-2-0-cust898.19-3.cable.virginm.net [82.32.195.131])
	by gungnir.webthing.com (Postfix) with ESMTPSA id E56F4E8C51
	for <dev@httpd.apache.org>; Thu,  1 Oct 2015 12:56:39 +0000 (UTC)
Message-ID: <1443704198.2576.98.camel@mimir.webthing.com>
Subject: Re: Expression Parser: search and replace with
 s/PATTERN/REPLACEMENT/FLAGS
From: Nick Kew <nick@webthing.com>
To: dev@httpd.apache.org
Date: Thu, 01 Oct 2015 13:56:38 +0100
In-Reply-To: <1443702728.2576.93.camel@mimir.webthing.com>
References: <560D0A3F.9010609@kippdata.de>
	 <1443702728.2576.93.camel@mimir.webthing.com>
Content-Type: text/plain; charset="UTF-8"
X-Mailer: Evolution 3.4.4-3 
Mime-Version: 1.0
Content-Transfer-Encoding: 7bit

On Thu, 2015-10-01 at 13:32 +0100, Nick Kew wrote:

> > Header set X-USER "expr=%{REMOTE_USER} =~ s/([^@]*)@.*/$1/"

> But I expect the line of least resistance would be to use
> plain regexp rather than expr.

Come to think of it, using regexp that looks a lot like:

<perl>
  ${REMOTE_USER} =~ s/([^@]*)@.*/$1/;
  %header{X-USER} = $_;
</perl>

I haven't tested the mod_perl syntax, but since it's
bog-standard perl, it's sure to be straightforward.

-- 
Nick Kew


From dev-return-84005-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Thu Oct  1 13:04:06 2015
Return-Path: <dev-return-84005-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id C4AA5174A5
	for <apmail-httpd-dev-archive@www.apache.org>; Thu,  1 Oct 2015 13:04:06 +0000 (UTC)
Received: (qmail 19438 invoked by uid 500); 1 Oct 2015 13:04:06 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 19364 invoked by uid 500); 1 Oct 2015 13:04:06 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 19349 invoked by uid 99); 1 Oct 2015 13:04:06 -0000
Received: from Unknown (HELO spamd2-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 01 Oct 2015 13:04:06 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd2-us-west.apache.org (ASF Mail Server at spamd2-us-west.apache.org) with ESMTP id B69D91A3715
	for <dev@httpd.apache.org>; Thu,  1 Oct 2015 13:04:05 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd2-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 0.653
X-Spam-Level:
X-Spam-Status: No, score=0.653 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, SPF_NEUTRAL=0.652,
	URIBL_BLOCKED=0.001] autolearn=disabled
Authentication-Results: spamd2-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=comcast.net
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd2-us-west.apache.org [10.40.0.9]) (amavisd-new, port 10024)
	with ESMTP id nPs7ccyaQr22 for <dev@httpd.apache.org>;
	Thu,  1 Oct 2015 13:03:59 +0000 (UTC)
Received: from resqmta-ch2-06v.sys.comcast.net (resqmta-ch2-06v.sys.comcast.net [69.252.207.38])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id 8086E20592
	for <dev@httpd.apache.org>; Thu,  1 Oct 2015 13:03:58 +0000 (UTC)
Received: from resomta-ch2-04v.sys.comcast.net ([69.252.207.100])
	by resqmta-ch2-06v.sys.comcast.net with comcast
	id Pp351r0042AWL2D01p3r6Q; Thu, 01 Oct 2015 13:03:51 +0000
Received: from [192.168.199.10] ([69.251.84.114])
	by resomta-ch2-04v.sys.comcast.net with comcast
	id Pp3q1r00Z2U0RYt01p3rEx; Thu, 01 Oct 2015 13:03:51 +0000
Content-Type: text/plain; charset=us-ascii
Mime-Version: 1.0 (Mac OS X Mail 8.2 \(2104\))
Subject: Re: Expression Parser: search and replace with s/PATTERN/REPLACEMENT/FLAGS
From: Jim Jagielski <jim@jaguNET.com>
In-Reply-To: <560D2C5E.3080100@kippdata.de>
Date: Thu, 1 Oct 2015 09:03:50 -0400
Content-Transfer-Encoding: quoted-printable
Message-Id: <CD674D2E-A51A-4352-96B3-A3D8598CF286@jaguNET.com>
References: <560D0A3F.9010609@kippdata.de> <1443702728.2576.93.camel@mimir.webthing.com> <560D2C5E.3080100@kippdata.de>
To: dev@httpd.apache.org
X-Mailer: Apple Mail (2.2104)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=comcast.net;
	s=q20140121; t=1443704631;
	bh=12G8ACo4KnlwY2Rt81Hcgmqh3OVX5QtRdSnPUwCdChY=;
	h=Received:Received:Content-Type:Mime-Version:Subject:From:Date:
	 Message-Id:To;
	b=OL7QMO6mOwoe3rLL9CFbOmjBGDNxjDXjrfRtv7m7zroNa6u/WVzJDQ57arY0CS6Wc
	 fKG7tCMi/w/1Xh31exazt3A3jWVP3+2114y++wOjc4w9TXckWg5gE/DZ65caFHdZAz
	 Yc9ad52tH5y2Z93tKJ5/Lq5lPbgLnFUsUYizrVIh5S7Vy9NCDSmDATBeb9MYzmyKOE
	 on2uyioG1av3VYyZ+ytyOCMKxk7AxEBX9sywKlxAeTAHo4DUBQ1sk7x4N9Xque68v6
	 qDKu1hCkLtoSwl1HEc8lc8YrwKdikM8x5dAv1KM25frbB6isq7yXHjVIQWgE8nYWwM
	 b5plg06jwQKig==

Doesn't mod_lua do this for you?

> On Oct 1, 2015, at 8:51 AM, Rainer Jung <rainer.jung@kippdata.de> =
wrote:
>=20
> Am 01.10.2015 um 14:32 schrieb Nick Kew:
>> On Thu, 2015-10-01 at 12:26 +0200, Rainer Jung wrote:
>>> Since it gets more common to use the expression parser for string
>>> operations and not only for boolean checks, I think it would be =
useful
>>> (and powerful) to support
>>>=20
>>> s/PATTERN/REPLACEMENT/FLAGS
>>>=20
>>> and allow back references in REPLACEMENT. The operation would not =
try to
>>> do the replacement in place but create a new string according to the
>>> given PATTERN and REPLACEMENT.
>>=20
>> Are you mixing two things?  That's well-established regexp syntax,
>> but you're looking at applying it to a different class expressions.
>> I think the most interesting issue is to define your behaviour.
>>=20
>>> Header set X-USER "expr=3D%{REMOTE_USER} =3D~ s/([^@]*)@.*/$1/"
>>=20
>> Aha!  In terms of the expression parser, that looks like
>> capturing a side-effect (as opposed to a true/false result).
>> Maybe it would work with something like C comma-list syntax?
>> But I expect the line of least resistance would be to use
>> plain regexp rather than expr.
>=20
> I'm talking about the use of the expression parser in the string =
context, not in boolean context. Support for string context started some =
time back and we now support it in more and more places. One could =
implement the
>=20
> var =3D~ s/PATTERN/REPLACEMENT/FLAGS
>=20
> syntax also as a four argument function regexreplace(var, PATTERN, =
REPLACEMENT, FLAGS), but the notation using s/.../.../ should be =
well-known to many so IMHO is preferable.
>=20
> So I want to enhance the expr syntax in string context to allow
>=20
> VARIABLE =3D~ s/PATTERN/REPLACEMENT/FLAGS
>=20
> This should return a string that is the result of the same operation =
in for example perl. VARIABLE will not be changed - unlike in perl - but =
the result string will be s/PATTERN/REPLACEMENT/FLAGS applied to =
VARIABLE.
>=20
> I think that is currently not possible with the expression parser but =
I expect it to be useful and if noone has a recipe how to get it done =
with our flex/bison definitions I'll try to find out.
>=20
> Since we don't support s/.../.../ right now, there shouldn't be to =
much compatibility hassle with existing expressions.
>=20
> Regards,
>=20
> Rainer


From dev-return-84006-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Thu Oct  1 13:08:23 2015
Return-Path: <dev-return-84006-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 467DD174BD
	for <apmail-httpd-dev-archive@www.apache.org>; Thu,  1 Oct 2015 13:08:23 +0000 (UTC)
Received: (qmail 24137 invoked by uid 500); 1 Oct 2015 13:08:22 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 24070 invoked by uid 500); 1 Oct 2015 13:08:22 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 24060 invoked by uid 99); 1 Oct 2015 13:08:22 -0000
Received: from Unknown (HELO spamd3-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 01 Oct 2015 13:08:22 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd3-us-west.apache.org (ASF Mail Server at spamd3-us-west.apache.org) with ESMTP id 399F318097C
	for <dev@httpd.apache.org>; Thu,  1 Oct 2015 13:08:22 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd3-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.008
X-Spam-Level:
X-Spam-Status: No, score=-0.008 tagged_above=-999 required=6.31
	tests=[RP_MATCHES_RCVD=-0.006, SPF_HELO_PASS=-0.001, SPF_PASS=-0.001]
	autolearn=disabled
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd3-us-west.apache.org [10.40.0.10]) (amavisd-new, port 10024)
	with ESMTP id YWapd1ogquMI for <dev@httpd.apache.org>;
	Thu,  1 Oct 2015 13:08:20 +0000 (UTC)
Received: from mail.thelounge.net (mail.thelounge.net [91.118.73.15])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id 3CEF242B36
	for <dev@httpd.apache.org>; Thu,  1 Oct 2015 13:08:20 +0000 (UTC)
Subject: Re: SSLUseStapling: ssl handshake fails until httpd restart
To: dev@httpd.apache.org
References: <560A49E5.2090500@thelounge.net> <560AAEEC.2080500@gmail.com>
 <560ABB39.2030805@thelounge.net> <560B8452.5070800@velox.ch>
 <560D1B12.4060502@thelounge.net>
 <AB1691BE05AE7F4992697F2A0835627AC6325BD7@VOEXM10W.internal.vodafone.com>
From: Reindl Harald <h.reindl@thelounge.net>
Openpgp: id=13540402D67A7F71C6E974EA866063CF7F780279;
 url=https://arrakis.thelounge.net/gpg/h.reindl_thelounge.net.pub.txt
X-Enigmail-Draft-Status: N1110
Organization: the lounge interactive design
Message-ID: <560D3041.2060300@thelounge.net>
Date: Thu, 1 Oct 2015 15:08:17 +0200
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:38.0) Gecko/20100101
 Thunderbird/38.2.0
MIME-Version: 1.0
In-Reply-To: <AB1691BE05AE7F4992697F2A0835627AC6325BD7@VOEXM10W.internal.vodafone.com>
Content-Type: multipart/signed; micalg=pgp-sha1;
 protocol="application/pgp-signature";
 boundary="Q9xNFrkW65eq6QMjTVFp7mIAAXKD65rAa"

This is an OpenPGP/MIME signed message (RFC 4880 and 3156)
--Q9xNFrkW65eq6QMjTVFp7mIAAXKD65rAa
Content-Type: text/plain; charset=utf-8; format=flowed
Content-Transfer-Encoding: quoted-printable


Am 01.10.2015 um 14:53 schrieb Pl=C3=BCm, R=C3=BCdiger, Vodafone Group:
>> -----Urspr=C3=BCngliche Nachricht-----
>> Von: Reindl Harald [mailto:h.reindl@thelounge.net]
>>> The default for SSLStaplingReturnResponderErrors is relatively odd.
>>> Not sure why it has always defaulted to "on" (r829619), but setting i=
t
>>> to off should save you further troubles with Firefox clients.
>>
>> not really, i had the error message just now again in FF, the differen=
ce
>> was that now a "try again" loaded the page but with
>> "SSLStaplingReturnResponderErrors" i would expect it invisible to
>> clients in general - GoDaddy seems to have massive problems with their=

>> responders the last days and the defaults with stapling enabled make
>> them to a perfect DOS target
>>
>> [Thu Oct 01 13:33:01.179365 2015] [ssl:error] [pid 19312] [client
>> 10.0.0.99:37860] AH01980: bad response from OCSP server: (none)
>> [Thu Oct 01 13:33:01.179393 2015] [ssl:error] [pid 19312] AH01941:
>> stapling_renew_response: responder error
>>
>> SSLStaplingCache shmcb:/var/cache/mod_ssl/ocsp_cache(1048576)
>> SSLStaplingStandardCacheTimeout 86400
>> SSLStaplingErrorCacheTimeout 300
>> SSLStaplingReturnResponderErrors Off
>
> What happens if you set
>
> SSLStaplingFakeTryLater off
>
> in addition?

i added that now and will have a look over the serverlogs, it's not=20
happening all the time but very often and so if the logs are clear=20
within 24 hours the problem is likely solved

thanks!


--Q9xNFrkW65eq6QMjTVFp7mIAAXKD65rAa
Content-Type: application/pgp-signature; name="signature.asc"
Content-Description: OpenPGP digital signature
Content-Disposition: attachment; filename="signature.asc"

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v2

iEYEARECAAYFAlYNMEEACgkQhmBjz394AnlQigCfc4INFD8uTRo6ZdnHKAH6TvJb
+VMAnjuFqJvN5j1sxUqgUXZEbaMNnRlI
=qFlO
-----END PGP SIGNATURE-----

--Q9xNFrkW65eq6QMjTVFp7mIAAXKD65rAa--

From dev-return-84007-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Thu Oct  1 13:18:31 2015
Return-Path: <dev-return-84007-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id BD02917529
	for <apmail-httpd-dev-archive@www.apache.org>; Thu,  1 Oct 2015 13:18:31 +0000 (UTC)
Received: (qmail 53272 invoked by uid 500); 1 Oct 2015 13:18:31 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 53189 invoked by uid 500); 1 Oct 2015 13:18:31 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 53179 invoked by uid 99); 1 Oct 2015 13:18:31 -0000
Received: from Unknown (HELO spamd3-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 01 Oct 2015 13:18:31 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd3-us-west.apache.org (ASF Mail Server at spamd3-us-west.apache.org) with ESMTP id B016A180970
	for <dev@httpd.apache.org>; Thu,  1 Oct 2015 13:18:30 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd3-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.008
X-Spam-Level:
X-Spam-Status: No, score=-0.008 tagged_above=-999 required=6.31
	tests=[RP_MATCHES_RCVD=-0.006, SPF_HELO_PASS=-0.001, SPF_PASS=-0.001]
	autolearn=disabled
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd3-us-west.apache.org [10.40.0.10]) (amavisd-new, port 10024)
	with ESMTP id MZLBcyuBR5WJ for <dev@httpd.apache.org>;
	Thu,  1 Oct 2015 13:18:29 +0000 (UTC)
Received: from mail.thelounge.net (mail.thelounge.net [91.118.73.15])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id 4FC5442B32
	for <dev@httpd.apache.org>; Thu,  1 Oct 2015 13:18:29 +0000 (UTC)
Subject: Re: SSLUseStapling: ssl handshake fails until httpd restart
To: dev@httpd.apache.org
References: <560A49E5.2090500@thelounge.net> <560AAEEC.2080500@gmail.com>
 <560ABB39.2030805@thelounge.net> <560B8452.5070800@velox.ch>
 <560D1B12.4060502@thelounge.net>
 <AB1691BE05AE7F4992697F2A0835627AC6325BD7@VOEXM10W.internal.vodafone.com>
 <560D3041.2060300@thelounge.net>
From: Reindl Harald <h.reindl@thelounge.net>
Openpgp: id=13540402D67A7F71C6E974EA866063CF7F780279;
 url=https://arrakis.thelounge.net/gpg/h.reindl_thelounge.net.pub.txt
X-Enigmail-Draft-Status: N1110
Organization: the lounge interactive design
Message-ID: <560D32A3.6080800@thelounge.net>
Date: Thu, 1 Oct 2015 15:18:27 +0200
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:38.0) Gecko/20100101
 Thunderbird/38.2.0
MIME-Version: 1.0
In-Reply-To: <560D3041.2060300@thelounge.net>
Content-Type: multipart/signed; micalg=pgp-sha1;
 protocol="application/pgp-signature";
 boundary="46WU3N3gIlkAsqkucipesvQ4QP2fs8M06"

This is an OpenPGP/MIME signed message (RFC 4880 and 3156)
--46WU3N3gIlkAsqkucipesvQ4QP2fs8M06
Content-Type: text/plain; charset=utf-8; format=flowed
Content-Transfer-Encoding: quoted-printable



Am 01.10.2015 um 15:08 schrieb Reindl Harald:
> Am 01.10.2015 um 14:53 schrieb Pl=C3=BCm, R=C3=BCdiger, Vodafone Group:=

>>> not really, i had the error message just now again in FF, the differe=
nce
>>> was that now a "try again" loaded the page but with
>>> "SSLStaplingReturnResponderErrors" i would expect it invisible to
>>> clients in general - GoDaddy seems to have massive problems with thei=
r
>>> responders the last days and the defaults with stapling enabled make
>>> them to a perfect DOS target
>>>
>>> [Thu Oct 01 13:33:01.179365 2015] [ssl:error] [pid 19312] [client
>>> 10.0.0.99:37860] AH01980: bad response from OCSP server: (none)
>>> [Thu Oct 01 13:33:01.179393 2015] [ssl:error] [pid 19312] AH01941:
>>> stapling_renew_response: responder error
>>>
>>> SSLStaplingCache shmcb:/var/cache/mod_ssl/ocsp_cache(1048576)
>>> SSLStaplingStandardCacheTimeout 86400
>>> SSLStaplingErrorCacheTimeout 300
>>> SSLStaplingReturnResponderErrors Off
>>
>> What happens if you set
>>
>> SSLStaplingFakeTryLater off
>>
>> in addition?
>
> i added that now and will have a look over the serverlogs, it's not
> happening all the time but very often and so if the logs are clear
> within 24 hours the problem is likely solved

looks not that good - "Connection reset by peer" indicates a failed=20
client request, the other lines could be just internal

[Thu Oct 01 15:15:01.495986 2015] [ssl:error] [pid 17468]=20
(104)Connection reset by peer: [client 81.223.20.5:55156] AH01977:=20
failed reading line from OCSP server
[Thu Oct 01 15:15:01.496037 2015] [ssl:error] [pid 17468] [client=20
81.223.20.5:55156] AH01980: bad response from OCSP server: (none)
[Thu Oct 01 15:15:01.496057 2015] [ssl:error] [pid 17468] AH01941:=20
stapling_renew_response: responder error


--46WU3N3gIlkAsqkucipesvQ4QP2fs8M06
Content-Type: application/pgp-signature; name="signature.asc"
Content-Description: OpenPGP digital signature
Content-Disposition: attachment; filename="signature.asc"

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v2

iEYEARECAAYFAlYNMqMACgkQhmBjz394Anm0bwCeIzSx2y9zHr4YtN0OaFuU9xGn
Z1cAn2CPBTXMbJ7mZxCfm4faiGcPy4j/
=IvFw
-----END PGP SIGNATURE-----

--46WU3N3gIlkAsqkucipesvQ4QP2fs8M06--

From dev-return-84008-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Thu Oct  1 13:26:01 2015
Return-Path: <dev-return-84008-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id A127B17566
	for <apmail-httpd-dev-archive@www.apache.org>; Thu,  1 Oct 2015 13:26:01 +0000 (UTC)
Received: (qmail 61293 invoked by uid 500); 1 Oct 2015 13:25:56 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 61213 invoked by uid 500); 1 Oct 2015 13:25:56 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 61203 invoked by uid 99); 1 Oct 2015 13:25:56 -0000
Received: from Unknown (HELO spamd1-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 01 Oct 2015 13:25:56 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd1-us-west.apache.org (ASF Mail Server at spamd1-us-west.apache.org) with ESMTP id 99D1EC8120
	for <dev@httpd.apache.org>; Thu,  1 Oct 2015 13:25:55 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd1-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.01
X-Spam-Level:
X-Spam-Status: No, score=-0.01 tagged_above=-999 required=6.31
	tests=[SPF_PASS=-0.001, T_RP_MATCHES_RCVD=-0.01, URIBL_BLOCKED=0.001]
	autolearn=disabled
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd1-us-west.apache.org [10.40.0.7]) (amavisd-new, port 10024)
	with ESMTP id U8yUVDVvCgTe for <dev@httpd.apache.org>;
	Thu,  1 Oct 2015 13:25:48 +0000 (UTC)
Received: from mailserver.kippdata.de (capsella.kippdata.de [195.227.30.149])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTP id B7B68206E3
	for <dev@httpd.apache.org>; Thu,  1 Oct 2015 13:25:47 +0000 (UTC)
Received: from [195.227.30.209] (notebook-rj [195.227.30.209])
	by mailserver.kippdata.de (8.13.5/8.13.5) with ESMTP id t91DPlOq019858
	for <dev@httpd.apache.org>; Thu, 1 Oct 2015 15:25:47 +0200 (CEST)
Subject: Re: Expression Parser: search and replace with
 s/PATTERN/REPLACEMENT/FLAGS
To: dev@httpd.apache.org
References: <560D0A3F.9010609@kippdata.de>
 <1443702728.2576.93.camel@mimir.webthing.com> <560D2C5E.3080100@kippdata.de>
 <CD674D2E-A51A-4352-96B3-A3D8598CF286@jaguNET.com>
From: Rainer Jung <rainer.jung@kippdata.de>
Message-ID: <560D3452.2060303@kippdata.de>
Date: Thu, 1 Oct 2015 15:25:38 +0200
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:38.0) Gecko/20100101
 Thunderbird/38.2.0
MIME-Version: 1.0
In-Reply-To: <CD674D2E-A51A-4352-96B3-A3D8598CF286@jaguNET.com>
Content-Type: text/plain; charset=utf-8; format=flowed
Content-Transfer-Encoding: 7bit

Am 01.10.2015 um 15:03 schrieb Jim Jagielski:
> Doesn't mod_lua do this for you?

But would it be the right tool to use whenever you want to apply a 
s/.../.../? I think the entry bar for mod_lua is higher than to get used 
with s/.../.../ syntax in the expression parser - though the docs for 
expr could be better (have that on my list), especially concerning the 
different syntaxes in boolean and string mode.

>> On Oct 1, 2015, at 8:51 AM, Rainer Jung <rainer.jung@kippdata.de> wrote:
>>
>> Am 01.10.2015 um 14:32 schrieb Nick Kew:
>>> On Thu, 2015-10-01 at 12:26 +0200, Rainer Jung wrote:
>>>> Since it gets more common to use the expression parser for string
>>>> operations and not only for boolean checks, I think it would be useful
>>>> (and powerful) to support
>>>>
>>>> s/PATTERN/REPLACEMENT/FLAGS
>>>>
>>>> and allow back references in REPLACEMENT. The operation would not try to
>>>> do the replacement in place but create a new string according to the
>>>> given PATTERN and REPLACEMENT.
>>>
>>> Are you mixing two things?  That's well-established regexp syntax,
>>> but you're looking at applying it to a different class expressions.
>>> I think the most interesting issue is to define your behaviour.
>>>
>>>> Header set X-USER "expr=%{REMOTE_USER} =~ s/([^@]*)@.*/$1/"
>>>
>>> Aha!  In terms of the expression parser, that looks like
>>> capturing a side-effect (as opposed to a true/false result).
>>> Maybe it would work with something like C comma-list syntax?
>>> But I expect the line of least resistance would be to use
>>> plain regexp rather than expr.
>>
>> I'm talking about the use of the expression parser in the string context, not in boolean context. Support for string context started some time back and we now support it in more and more places. One could implement the
>>
>> var =~ s/PATTERN/REPLACEMENT/FLAGS
>>
>> syntax also as a four argument function regexreplace(var, PATTERN, REPLACEMENT, FLAGS), but the notation using s/.../.../ should be well-known to many so IMHO is preferable.
>>
>> So I want to enhance the expr syntax in string context to allow
>>
>> VARIABLE =~ s/PATTERN/REPLACEMENT/FLAGS
>>
>> This should return a string that is the result of the same operation in for example perl. VARIABLE will not be changed - unlike in perl - but the result string will be s/PATTERN/REPLACEMENT/FLAGS applied to VARIABLE.
>>
>> I think that is currently not possible with the expression parser but I expect it to be useful and if noone has a recipe how to get it done with our flex/bison definitions I'll try to find out.
>>
>> Since we don't support s/.../.../ right now, there shouldn't be to much compatibility hassle with existing expressions.

Regards,

Rainer


From dev-return-84009-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Thu Oct  1 13:55:11 2015
Return-Path: <dev-return-84009-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 04C4E1769D
	for <apmail-httpd-dev-archive@www.apache.org>; Thu,  1 Oct 2015 13:55:11 +0000 (UTC)
Received: (qmail 40159 invoked by uid 500); 1 Oct 2015 13:55:07 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 40087 invoked by uid 500); 1 Oct 2015 13:55:07 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 40077 invoked by uid 99); 1 Oct 2015 13:55:07 -0000
Received: from Unknown (HELO spamd2-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 01 Oct 2015 13:55:07 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd2-us-west.apache.org (ASF Mail Server at spamd2-us-west.apache.org) with ESMTP id 161081A3718
	for <dev@httpd.apache.org>; Thu,  1 Oct 2015 13:55:07 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd2-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 1.799
X-Spam-Level: *
X-Spam-Status: No, score=1.799 tagged_above=-999 required=6.31
	tests=[KAM_ASCII_DIVIDERS=0.8, KAM_LAZY_DOMAIN_SECURITY=1,
	SPF_HELO_PASS=-0.001] autolearn=disabled
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd2-us-west.apache.org [10.40.0.9]) (amavisd-new, port 10024)
	with ESMTP id HhkRxdW3S03s for <dev@httpd.apache.org>;
	Thu,  1 Oct 2015 13:54:56 +0000 (UTC)
Received: from mail1.bemta3.messagelabs.com (mail1.bemta3.messagelabs.com [195.245.230.166])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id EE0BE201FB
	for <dev@httpd.apache.org>; Thu,  1 Oct 2015 13:54:55 +0000 (UTC)
Received: from [85.158.138.179] by server-6.bemta-3.messagelabs.com id 30/9F-29649-92B3D065; Thu, 01 Oct 2015 13:54:49 +0000
X-Env-Sender: ruediger.pluem@vodafone.com
X-Msg-Ref: server-5.tower-169.messagelabs.com!1443707689!32093621!1
X-Originating-IP: [195.232.244.136]
X-StarScan-Received:
X-StarScan-Version: 6.13.16; banners=-,-,-
X-VirusChecked: Checked
Received: (qmail 28683 invoked from network); 1 Oct 2015 13:54:49 -0000
Received: from mailout04.vodafone.com (HELO mailout04.vodafone.com) (195.232.244.136)
  by server-5.tower-169.messagelabs.com with DHE-RSA-AES256-SHA encrypted SMTP; 1 Oct 2015 13:54:49 -0000
Received: from mailint04.vodafone.com (mailint04.vodafone.com [195.232.244.201])
	by mailout04.vodafone.com (Postfix) with ESMTP id 3nRbYP08NpznTYm
	for <dev@httpd.apache.org>; Thu,  1 Oct 2015 15:54:49 +0200 (CEST)
Received: from mailint04.vodafone.com (localhost [127.0.0.1])
	by mailint04.vodafone.com (Postfix) with ESMTP id 3nRbYN6JBczfZPW
	for <dev@httpd.apache.org>; Thu,  1 Oct 2015 15:54:48 +0200 (CEST)
Received: from VOEXC04W.internal.vodafone.com (voexc04w.dc-ratingen.de [145.230.101.24])
	(using TLSv1 with cipher AES128-SHA (128/128 bits))
	(No client certificate requested)
	by mailint04.vodafone.com (Postfix) with ESMTPS id 3nRbYN5xhdzfZSy
	for <dev@httpd.apache.org>; Thu,  1 Oct 2015 15:54:48 +0200 (CEST)
Received: from VOEXM10W.internal.vodafone.com ([169.254.2.132]) by
 VOEXC04W.internal.vodafone.com ([145.230.101.24]) with mapi id
 14.03.0224.002; Thu, 1 Oct 2015 15:54:48 +0200
From: =?utf-8?B?UGzDvG0sIFLDvGRpZ2VyLCBWb2RhZm9uZSBHcm91cA==?=
	<ruediger.pluem@vodafone.com>
To: "dev@httpd.apache.org" <dev@httpd.apache.org>
Subject: AW: svn commit: r1705823 -
 /httpd/httpd/trunk/modules/ssl/ssl_engine_io.c
Thread-Topic: svn commit: r1705823 -
 /httpd/httpd/trunk/modules/ssl/ssl_engine_io.c
Thread-Index: AQHQ+65fZ1aJNxXPZUK4h9Y8sB0e+p5VXPWAgAFMyNA=
Date: Thu, 1 Oct 2015 13:54:47 +0000
Message-ID: <AB1691BE05AE7F4992697F2A0835627AC6325C45@VOEXM10W.internal.vodafone.com>
References: <20150929094257.1DAB53A01DC@svn01-us-west.apache.org>
 <560C2A63.1000800@apache.org> <560C3FD1.7000002@apache.org>
In-Reply-To: <560C3FD1.7000002@apache.org>
Accept-Language: en-US
Content-Language: de-DE
X-MS-Has-Attach:
X-MS-TNEF-Correlator:
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
MIME-Version: 1.0

DQoNCj4gLS0tLS1VcnNwcsO8bmdsaWNoZSBOYWNocmljaHQtLS0tLQ0KPiBWb246IFJ1ZWRpZ2Vy
IFBsdWVtIFttYWlsdG86cnBsdWVtQGFwYWNoZS5vcmddDQo+IEdlc2VuZGV0OiBNaXR0d29jaCwg
MzAuIFNlcHRlbWJlciAyMDE1IDIyOjAyDQo+IEFuOiBkZXZAaHR0cGQuYXBhY2hlLm9yZw0KPiBC
ZXRyZWZmOiBSZTogc3ZuIGNvbW1pdDogcjE3MDU4MjMgLQ0KPiAvaHR0cGQvaHR0cGQvdHJ1bmsv
bW9kdWxlcy9zc2wvc3NsX2VuZ2luZV9pby5jDQo+IA0KPiBPbiAwOS8zMC8yMDE1IDA4OjMwIFBN
LCBSdWVkaWdlciBQbHVlbSB3cm90ZToNCj4gPg0KPiA+DQo+ID4gT24gMDkvMjkvMjAxNSAxMTo0
MiBBTSwgeWxhdmljQGFwYWNoZS5vcmcgd3JvdGU6DQo+ID4+IEF1dGhvcjogeWxhdmljDQo+ID4+
IERhdGU6IFR1ZSBTZXAgMjkgMDk6NDI6NTYgMjAxNQ0KPiA+PiBOZXcgUmV2aXNpb246IDE3MDU4
MjMNCj4gPj4NCj4gPj4gVVJMOiBodHRwOi8vc3ZuLmFwYWNoZS5vcmcvdmlld3ZjP3Jldj0xNzA1
ODIzJnZpZXc9cmV2DQo+ID4+IExvZzoNCj4gPj4gbW9kX3NzbDogZG9uJ3QgRkxVU0ggb3V0cHV0
IChibG9ja2luZykgb24gcmVhZC4NCj4gPj4gVGhpcyBkZWZlYXRzIGRlZmVycmVkIHdyaXRlIChh
bmQgcGlwZWxpbmluZyksIGVnLiBjaGVja19waXBlbGluZSgpIGlzDQo+IG5vdA0KPiA+PiBleHBl
Y3RpbmcgdGhlIHBpcGUgdG8gYmUgZmx1c2hlZCB1bmRlciBpdC4NCj4gPj4gU28gbGV0IE9wZW5T
U0wgPj0gMC45LjhtIGlzc3VlIHRoZSBmbHVzaCB3aGVuIG5lY2Vzc2FyeSAoZWFybGllcg0KPiB2
ZXJzaW9ucw0KPiA+PiBhcmUga25vd24gdG8gbm90IGhhbmRsZSBhbGwgdGhlIGNhc2VzLCBzbyB3
ZSBrZWVwIGZsdXNoaW5nIHdpdGgNCj4gdGhvc2UpLg0KPiA+Pg0KPiA+PiBNb2RpZmllZDoNCj4g
Pj4gICAgIGh0dHBkL2h0dHBkL3RydW5rL21vZHVsZXMvc3NsL3NzbF9lbmdpbmVfaW8uYw0KPiA+
Pg0KPiA+PiBNb2RpZmllZDogaHR0cGQvaHR0cGQvdHJ1bmsvbW9kdWxlcy9zc2wvc3NsX2VuZ2lu
ZV9pby5jDQo+ID4+IFVSTDoNCj4gaHR0cDovL3N2bi5hcGFjaGUub3JnL3ZpZXd2Yy9odHRwZC9o
dHRwZC90cnVuay9tb2R1bGVzL3NzbC9zc2xfZW5naW5lX2lvDQo+IC5jP3Jldj0xNzA1ODIzJnIx
PTE3MDU4MjImcjI9MTcwNTgyMyZ2aWV3PWRpZmYNCj4gPj4NCj4gPT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09DQo+
ID09PT09PQ0KPiA+PiAtLS0gaHR0cGQvaHR0cGQvdHJ1bmsvbW9kdWxlcy9zc2wvc3NsX2VuZ2lu
ZV9pby5jIChvcmlnaW5hbCkNCj4gPj4gKysrIGh0dHBkL2h0dHBkL3RydW5rL21vZHVsZXMvc3Ns
L3NzbF9lbmdpbmVfaW8uYyBUdWUgU2VwIDI5IDA5OjQyOjU2DQo+IDIwMTUNCj4gPj4gQEAgLTQ2
Niw5ICs0NjYsMTAgQEAgc3RhdGljIGludCBiaW9fZmlsdGVyX2luX3JlYWQoQklPICpiaW8sDQo+
ID4+ICAgICAgfQ0KPiA+Pg0KPiA+PiAgICAgIC8qIEluIHRoZW9yeSwgT3BlblNTTCBzaG91bGQg
Zmx1c2ggYXMgbmVjZXNzYXJ5LCBidXQgaXQgaXMga25vd24NCj4gPj4gLSAgICAgKiBub3QgdG8g
ZG8gc28gY29ycmVjdGx5IGluIHNvbWUgY2FzZXM7IHNlZSBQUiA0Njk1Mi4NCj4gPj4gLSAgICAg
Kg0KPiA+PiAtICAgICAqIEhpc3RvcmljYWxseSwgdGhpcyBmbHVzaCBjYWxsIHdhcyBwZXJmb3Jt
ZWQgb25seSBmb3IgYW4gU1NMdjINCj4gPj4gKyAgICAgKiBub3QgdG8gZG8gc28gY29ycmVjdGx5
IGluIHNvbWUgY2FzZXMgKDwgMC45LjhtKTsgc2VlIFBSDQo+IDQ2OTUyLg0KPiA+PiArICAgICAq
Lw0KPiA+PiArI2lmIE9QRU5TU0xfVkVSU0lPTl9OVU1CRVIgPCAweDAwMDkwODBkZg0KPiA+PiAr
ICAgIC8qIEhpc3RvcmljYWxseSwgdGhpcyBmbHVzaCBjYWxsIHdhcyBwZXJmb3JtZWQgb25seSBm
b3IgYW4gU1NMdjINCj4gPj4gICAgICAgKiBjb25uZWN0aW9uIG9yIGZvciBhIHByb3h5IGNvbm5l
Y3Rpb24uICBDYWxsaW5nIF9vdXRfZmx1c2gNCj4gPj4gICAgICAgKiBzaG91bGQgYmUgdmVyeSBj
aGVhcCBpbiBjYXNlcyB3aGVyZSBpdCBpcyB1bm5lY2Vzc2FyeSAoYW5kIG5vDQo+ID4+ICAgICAg
ICogb3V0cHV0IGlzIGJ1ZmZlcmVkKSBzbyB0aGUgcGVyZm9ybWFuY2UgaW1wYWN0IG9mIGRvaW5n
IGl0DQo+ID4+DQo+ID4+DQo+ID4+DQo+ID4NCj4gPg0KPiA+IFRoaXMgYW5kIHRoZSBmb2xsb3cg
dXAgcjE3MDU4MjYgZG8gY2F1c2UgdC9zc2wvcHJveHkudCB0byBoYW5nIGFuZA0KPiB1bHRpbWF0
ZWx5IGZhaWwgd2l0aCB0aW1lb3V0cy4NCj4gPiBJIGFtIHJ1bm5pbmcgb24gQ2VudG9zIDYgd2l0
aCBPcGVuc3NsIDEuMC4xLg0KPiA+IEN1cnJlbnRseSBubyBpZGVhIHdoeS4gSnVzdCBhIGhlYWRz
IHVwLg0KPiA+DQo+ID4gUmVnYXJkcw0KPiA+DQo+ID4gUsO8ZGlnZXINCj4gPg0KPiANCj4gDQo+
IEl0IGlzIGhhbmdpbmcgaGVyZToNCj4gDQo+IDB4MDAwMDdmMWE4MTBmMDExMyBpbiBfX3BvbGwg
KGZkcz08dmFsdWUgb3B0aW1pemVkIG91dD4sIG5mZHM9PHZhbHVlDQo+IG9wdGltaXplZCBvdXQ+
LCB0aW1lb3V0PTx2YWx1ZSBvcHRpbWl6ZWQgb3V0PikgYXQNCj4gLi4vc3lzZGVwcy91bml4L3N5
c3YvbGludXgvcG9sbC5jOjg3DQo+ICMxICAweDAwMDA3ZjFhODFjNmNkZjcgaW4gYXByX3dhaXRf
Zm9yX2lvX29yX3RpbWVvdXQgKGY9PHZhbHVlIG9wdGltaXplZA0KPiBvdXQ+LCBzPTx2YWx1ZSBv
cHRpbWl6ZWQgb3V0PiwgZm9yX3JlYWQ9MSkgYXQNCj4gc3VwcG9ydC91bml4L3dhaXRpby5jOjUx
DQo+ICMyICAweDAwMDA3ZjFhODFjNjZjM2EgaW4gYXByX3NvY2tldF9yZWN2IChzb2NrPTB4N2Yx
YTU0MDBhYmIwLA0KPiBidWY9MHg3ZjFhNTQwMmEwZTggIiIsIGxlbj0weDdmMWE2ZTc4MTRiMCkg
YXQNCj4gbmV0d29ya19pby91bml4L3NlbmRyZWN2LmM6ODcNCj4gIzMgIDB4MDAwMDdmMWE4MWMz
ZjllNSBpbiBzb2NrZXRfYnVja2V0X3JlYWQgKGE9MHg3ZjFhNTQwMGNiYjgsDQo+IHN0cj0weDdm
MWE2ZTc4MTRiOCwgbGVuPTB4N2YxYTZlNzgxNGIwLCBibG9jaz08dmFsdWUNCj4gb3B0aW1pemVk
IG91dD4pIGF0IGJ1Y2tldHMvYXByX2J1Y2tldHNfc29ja2V0LmM6MzYNCj4gIzQgIDB4MDAwMDAw
MDAwMDQ0ZjMwZSBpbiBhcF9jb3JlX2lucHV0X2ZpbHRlciAoZj0weDdmMWE1NDAxMzUwMCwNCj4g
Yj0weDdmMWE1NDAxMzQ4MCwgbW9kZT08dmFsdWUgb3B0aW1pemVkIG91dD4sDQo+IGJsb2NrPUFQ
Ul9CTE9DS19SRUFELCByZWFkYnl0ZXM9NykgYXQgY29yZV9maWx0ZXJzLmM6MjM1DQo+ICM1ICAw
eDAwMDA3ZjFhNzk3NDFmMTkgaW4gbG9naW9faW5fZmlsdGVyIChmPTx2YWx1ZSBvcHRpbWl6ZWQg
b3V0PiwNCj4gYmI9MHg3ZjFhNTQwMTM0ODAsIG1vZGU9PHZhbHVlIG9wdGltaXplZCBvdXQ+LA0K
PiBibG9jaz08dmFsdWUgb3B0aW1pemVkIG91dD4sIHJlYWRieXRlcz08dmFsdWUgb3B0aW1pemVk
IG91dD4pIGF0DQo+IG1vZF9sb2dpby5jOjE2NQ0KPiAjNiAgMHgwMDAwN2YxYTc1ZTQ4MzM5IGlu
IGJpb19maWx0ZXJfaW5fcmVhZCAoYmlvPTB4N2YxYTU0MDE0M2YwLA0KPiBpbj0weDdmMWE1NDAx
OWNlMCAiIiwgaW5sZW49NykgYXQgc3NsX2VuZ2luZV9pby5jOjQ5NA0KPiAjNyAgMHgwMDAwN2Yx
YTc1OGJmMzA5IGluIEJJT19yZWFkIChiPTB4N2YxYTU0MDE0M2YwLA0KPiBvdXQ9MHg3ZjFhNTQw
MTljZTAsIG91dGw9NykgYXQgYmlvX2xpYi5jOjIxMg0KPiAjOCAgMHgwMDAwN2YxYTc1YmY3ODcz
IGluIHNzbDIzX3JlYWRfYnl0ZXMgKHM9MHg3ZjFhNTQwMTBhMzAsIG49NykgYXQNCj4gczIzX3Br
dC5jOjEwNQ0KPiAjOSAgMHgwMDAwN2YxYTc1YmY2N2JlIGluIHNzbDIzX2dldF9zZXJ2ZXJfaGVs
bG8gKHM9MHg3ZjFhNTQwMTBhMzApIGF0DQo+IHMyM19jbG50LmM6NTk1DQo+ICMxMCBzc2wyM19j
b25uZWN0IChzPTB4N2YxYTU0MDEwYTMwKSBhdCBzMjNfY2xudC5jOjIyNg0KPiAjMTEgMHgwMDAw
N2YxYTc1ZTQ4YjQxIGluIHNzbF9pb19maWx0ZXJfaGFuZHNoYWtlDQo+IChmaWx0ZXJfY3R4PTB4
N2YxYTU0MDBmMjg4KSBhdCBzc2xfZW5naW5lX2lvLmM6MTE2Mg0KPiAjMTIgMHgwMDAwN2YxYTc1
ZTQ5YTZiIGluIHNzbF9pb19maWx0ZXJfb3V0cHV0IChmPTB4N2YxYTU0MDBmMmUwLA0KPiBiYj0w
eDdmMWE1NDAwOGJmOCkgYXQgc3NsX2VuZ2luZV9pby5jOjE3MDINCj4gIzEzIDB4MDAwMDdmMWE3
NWU0NzRjNSBpbiBzc2xfaW9fZmlsdGVyX2NvYWxlc2NlIChmPTB4N2YxYTU0MDBmMmI4LA0KPiBi
Yj0weDdmMWE1NDAwOGJmOCkgYXQgc3NsX2VuZ2luZV9pby5jOjE2NzANCj4gIzE0IDB4MDAwMDdm
MWE3N2VjZTc2NyBpbiBhcF9wcm94eV9wYXNzX2JyaWdhZGUgKGJ1Y2tldF9hbGxvYz08dmFsdWUN
Cj4gb3B0aW1pemVkIG91dD4sIHI9MHg3ZjFhNTQwMDQ5ODAsIHBfY29ubj0weDFhYzEyMTAsDQo+
IG9yaWdpbj0weDdmMWE1NDAwYWRhMCwgYmI9MHg3ZjFhNTQwMDhiZjgsIGZsdXNoPTx2YWx1ZSBv
cHRpbWl6ZWQgb3V0PikNCj4gICAgIGF0IHByb3h5X3V0aWwuYzozNjQwDQo+ICMxNSAweDAwMDA3
ZjFhNzc4YTk5ZWUgaW4gc3RyZWFtX3JlcWJvZHlfY2wgKHI9MHg3ZjFhNTQwMDQ5ODAsDQo+IHdv
cmtlcj08dmFsdWUgb3B0aW1pemVkIG91dD4sIGNvbmY9MHgxYTNmZDUwLA0KPiB1cmw9MHg3ZjFh
NTQwMDY4MDYgImh0dHBzOi8vbG9jYWxob3N0Ojg1MzIvIiwgcHJveHluYW1lPTB4MCwNCj4gcHJv
eHlwb3J0PTM1ODMyKSBhdCBtb2RfcHJveHlfaHR0cC5jOjUyMQ0KPiAjMTYgYXBfcHJveHlfaHR0
cF9yZXF1ZXN0IChyPTB4N2YxYTU0MDA0OTgwLCB3b3JrZXI9PHZhbHVlIG9wdGltaXplZA0KPiBv
dXQ+LCBjb25mPTB4MWEzZmQ1MCwgdXJsPTB4N2YxYTU0MDA2ODA2DQo+ICJodHRwczovL2xvY2Fs
aG9zdDo4NTMyLyIsIHByb3h5bmFtZT0weDAsIHByb3h5cG9ydD0zNTgzMikgYXQNCj4gbW9kX3By
b3h5X2h0dHAuYzoxMDA3DQo+ICMxNyBwcm94eV9odHRwX2hhbmRsZXIgKHI9MHg3ZjFhNTQwMDQ5
ODAsIHdvcmtlcj08dmFsdWUgb3B0aW1pemVkIG91dD4sDQo+IGNvbmY9MHgxYTNmZDUwLCB1cmw9
MHg3ZjFhNTQwMDY4MDYNCj4gImh0dHBzOi8vbG9jYWxob3N0Ojg1MzIvIiwgcHJveHluYW1lPTB4
MCwgcHJveHlwb3J0PTM1ODMyKSBhdA0KPiBtb2RfcHJveHlfaHR0cC5jOjIxODANCj4gIzE4IDB4
MDAwMDdmMWE3N2VjMTAwMiBpbiBwcm94eV9ydW5fc2NoZW1lX2hhbmRsZXIgKHI9MHg3ZjFhNTQw
MDQ5ODAsDQo+IHdvcmtlcj0weDFhM2ZmNTgsIGNvbmY9MHgxYTNmZDUwLA0KPiB1cmw9MHg3ZjFh
NTQwMDY4MDYgImh0dHBzOi8vbG9jYWxob3N0Ojg1MzIvIiwgcHJveHlob3N0PTB4MCwNCj4gcHJv
eHlwb3J0PTApIGF0IG1vZF9wcm94eS5jOjI5MzgNCj4gIzE5IDB4MDAwMDdmMWE3N2VjNjc5MyBp
biBwcm94eV9oYW5kbGVyIChyPTB4N2YxYTU0MDA0OTgwKSBhdA0KPiBtb2RfcHJveHkuYzoxMTcw
DQo+ICMyMCAweDAwMDAwMDAwMDA0NTlmMTAgaW4gYXBfcnVuX2hhbmRsZXIgKHI9MHg3ZjFhNTQw
MDQ5ODApIGF0DQo+IGNvbmZpZy5jOjE3MA0KPiAjMjEgMHgwMDAwMDAwMDAwNDVlMGRlIGluIGFw
X2ludm9rZV9oYW5kbGVyIChyPTB4N2YxYTU0MDA0OTgwKSBhdA0KPiBjb25maWcuYzo0MzMNCj4g
IzIyIDB4MDAwMDAwMDAwMDQ3MjJhYSBpbiBhcF9wcm9jZXNzX2FzeW5jX3JlcXVlc3QgKHI9MHg3
ZjFhNTQwMDQ5ODApIGF0DQo+IGh0dHBfcmVxdWVzdC5jOjMzOA0KPiAjMjMgMHgwMDAwMDAwMDAw
NDZlNzEwIGluIGFwX3Byb2Nlc3NfaHR0cF9hc3luY19jb25uZWN0aW9uDQo+IChjPTB4N2YxYTY4
MDI5NTc4KSBhdCBodHRwX2NvcmUuYzoxNTQNCj4gIzI0IGFwX3Byb2Nlc3NfaHR0cF9jb25uZWN0
aW9uIChjPTB4N2YxYTY4MDI5NTc4KSBhdCBodHRwX2NvcmUuYzoyNDgNCj4gIzI1IDB4MDAwMDAw
MDAwMDQ2NGY4MCBpbiBhcF9ydW5fcHJvY2Vzc19jb25uZWN0aW9uIChjPTB4N2YxYTY4MDI5NTc4
KQ0KPiBhdCBjb25uZWN0aW9uLmM6NDENCj4gIzI2IDB4MDAwMDdmMWE3M2EzMDkxMCBpbiBwcm9j
ZXNzX3NvY2tldCAodGhkPTB4MThkYTAzMCwgZHVtbXk9PHZhbHVlDQo+IG9wdGltaXplZCBvdXQ+
KSBhdCBldmVudC5jOjExMzcNCj4gIzI3IHdvcmtlcl90aHJlYWQgKHRoZD0weDE4ZGEwMzAsIGR1
bW15PTx2YWx1ZSBvcHRpbWl6ZWQgb3V0PikgYXQNCj4gZXZlbnQuYzoyMjI5DQo+ICMyOCAweDAw
MDA3ZjFhODFjNmUyOTggaW4gZHVtbXlfd29ya2VyIChvcGFxdWU9MHgxOGRhMDMwKSBhdA0KPiB0
aHJlYWRwcm9jL3VuaXgvdGhyZWFkLmM6MTQ1DQo+ICMyOSAweDAwMDA3ZjFhODE1ZDRhNTEgaW4g
c3RhcnRfdGhyZWFkIChhcmc9MHg3ZjFhNmU3ODI3MDApIGF0DQo+IHB0aHJlYWRfY3JlYXRlLmM6
MzAxDQo+ICMzMCAweDAwMDA3ZjFhODEwZjk5M2QgaW4gY2xvbmUgKCkgYXQNCj4gLi4vc3lzZGVw
cy91bml4L3N5c3YvbGludXgveDg2XzY0L2Nsb25lLlM6MTE1DQo+IA0KPiANCj4gQW5kIHRoZXJl
IGlzIGEgSEVBUCBidWNrZXQgaW4gdGhlIGJ1ZmZlcmVkX2JiIG9mIHRoZSBjb3JlIG91dHB1dCBm
aWx0ZXIuDQo+IEkgd291bGQgZ3Vlc3MgdGhhdCBpdCBpcyB0aGUgQ2xpZW50IEhlbGxvOg0KPiAN
Cj4gZHVtcCBvZiBicmlnYWRlIDB4N2YxYTU0MDEzZGI4DQo+ICAgIHwgdHlwZSAgICAgKGFkZHJl
c3MpICAgIHwgbGVuZ3RoIHwgZGF0YSBhZGRyICB8IGNvbnRlbnRzDQo+IHwgcmMNCj4gLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tDQo+IC0tLS0tLS0tDQo+ICAwIHwgSEVBUCAgICAgKDB4N2YxYTU0MDBjYTc4KSB8
IDI3MyAgICB8IDB4N2YxYTU0MDBjYjE4IHwNCj4gW35+fn5+fn5+fn5+Vn4yfk5PLi4uXSB8IDEN
Cj4gDQo+IENvbnRlbnQgaXM6DQo+IA0KPiB4LzcweCAweDdmMWE1NDAwY2IxOA0KPiAweDdmMWE1
NDAwY2IxODogMHgwMDAwMDAwMSAgICAgIDB4MDAwMDAwMDAgICAgICAweDU0MDI4MGQ4DQo+IDB4
MDAwMDdmMWENCj4gMHg3ZjFhNTQwMGNiMjg6IDB4MDAwMDAxMTEgICAgICAweDAwMDAwMDAwICAg
ICAgMHgwMDQyYjVhMA0KPiAweDAwMDAwMDAwDQo+IDB4N2YxYTU0MDBjYjM4OiAweDAwMDAwMDAw
ICAgICAgMHgwMDAwMDAwMCAgICAgIDB4MDAwMDAwMDANCj4gMHgwMDAwMDAwMA0KPiAweDdmMWE1
NDAwY2I0ODogMHgwMDAwMDAwMCAgICAgIDB4MDAwMDAwMDAgICAgICAweDAwMDAwMDAwDQo+IDB4
MDAwMDAwMDANCj4gMHg3ZjFhNTQwMGNiNTg6IDB4MDAwMDAwMDAgICAgICAweDAwMDAwMDAwICAg
ICAgMHgwMDAwMDAwMA0KPiAweDAwMDAwMDAwDQo+IDB4N2YxYTU0MDBjYjY4OiAweDAwMDAwMDAw
ICAgICAgMHgwMDAwMDAwMCAgICAgIDB4MDAwMDAwMDANCj4gMHgwMDAwMDAwMA0KPiAweDdmMWE1
NDAwY2I3ODogMHgwMDAwMDAwMCAgICAgIDB4MDAwMDAwMDAgICAgICAweDAwMDAwMDAwDQo+IDB4
MDAwMDAwMDANCj4gMHg3ZjFhNTQwMGNiODg6IDB4MDAwMDAwMDAgICAgICAweDAwMDAwMDAwICAg
ICAgMHgwMDAwMDAwMA0KPiAweDAwMDAwMDAwDQo+IDB4N2YxYTU0MDBjYjk4OiAweDAwMDAwMGEw
ICAgICAgMHgwMDAwMDAwMCAgICAgIDB4NTQwMGNhMzgNCj4gMHgwMDAwN2YxYQ0KPiAweDdmMWE1
NDAwY2JhODogMHg1NDAwY2ExMCAgICAgIDB4MDAwMDdmMWEgICAgICAweDAwMDAwMDAwDQo+IDB4
MDAwMDAwMDANCj4gMHg3ZjFhNTQwMGNiYjg6IDB4NTQwMTNlMTAgICAgICAweDAwMDA3ZjFhICAg
ICAgMHg1NDAxM2UxMA0KPiAweDAwMDA3ZjFhDQo+IDB4N2YxYTU0MDBjYmM4OiAweDgxZTdlZWMw
ICAgICAgMHgwMDAwN2YxYSAgICAgIDB4ZmZmZmZmZmYNCj4gMHhmZmZmZmZmZg0KPiAweDdmMWE1
NDAwY2JkODogMHhmZmZmZmZmZiAgICAgIDB4ZmZmZmZmZmYgICAgICAweDU0MDBhYmIwDQo+IDB4
MDAwMDdmMWENCj4gMHg3ZjFhNTQwMGNiZTg6IDB4MDA0MmI1YTAgICAgICAweDAwMDAwMDAwICAg
ICAgMHg1NDAwY2EzOA0KPiAweDAwMDA3ZjFhDQo+IDB4N2YxYTU0MDBjYmY4OiAweDAwMDE2NDEx
ICAgICAgMHgwMDAwMDAwMCAgICAgIDB4MDAwMDAwMDANCj4gMHgwMDAwMDAwMA0KPiAweDdmMWE1
NDAwY2MwODogMHgwMDAwMDAwMCAgICAgIDB4MDAwMDAwMDAgICAgICAweDAwMDAwMDAwDQo+IDB4
MDAwMDAwMDANCj4gMHg3ZjFhNTQwMGNjMTg6IDB4MDAwMDAwMDAgICAgICAweDAwMDAwMDAwICAg
ICAgMHgwMDAwMDAwMA0KPiAweDAwMDAwMDAwDQo+IDB4N2YxYTU0MDBjYzI4OiAweDAwMDAwMDAw
ICAgICAgMHgwMDAwMDAwMA0KPiANCj4gDQo+IA0KPiBMb29rcyBsaWtlIGFzIG5laXRoZXIgc3Ns
MjNfY2xpZW50X2hlbGxvIG5vciBzc2wyM193cml0ZV9ieXRlcyBjYXVzZQ0KPiBCSU9fZmx1c2gg
dG8gYmUgY2FsbGVkLg0KDQpEdW1wZWQgdGhlIHdyb25nIG1lbW9yeSBzZWN0aW9uIGZvciBhIEhF
QVAgYnVja2V0LiBUaGUgY29udGVudHMgb2YgdGhlIGhlYXAgYnVja2V0IGlzIGFjdHVhbGx5IChu
b3cgYSBkaWZmZXJlbnQgc2Vzc2lvbik6DQoNCmdkYikgeC83MHggMHg3ZjAzYTgwMWMwZTgNCjB4
N2YwM2E4MDFjMGU4OiAweDAxMDEwMzE2ICAgICAgMHgwMTAwMDEwYyAgICAgIDB4NTYwMzAzMDgg
ICAgICAweGNiZWUyZTBkDQoweDdmMDNhODAxYzBmODogMHgwOGI4MzNiYSAgICAgIDB4ZmM5NmFl
MmIgICAgICAweGJhMmI5YTliICAgICAgMHhhNjdlYThkMg0KMHg3ZjAzYTgwMWMxMDg6IDB4MGVm
NzVjZTkgICAgICAweGIzOThmYmE3ICAgICAgMHgwMDRmZTA5MiAgICAgIDB4MzBjMDhhMDANCjB4
N2YwM2E4MDFjMTE4OiAweDI4YzAyY2MwICAgICAgMHgxNGMwMjRjMCAgICAgIDB4YTMwMDBhYzAg
ICAgICAweDZiMDA5ZjAwDQoweDdmMDNhODAxYzEyODogMHgzOTAwNmEwMCAgICAgIDB4ODgwMDM4
MDAgICAgICAweDMyYzA4NzAwICAgICAgMHgyYWMwMmVjMA0KMHg3ZjAzYTgwMWMxMzg6IDB4MGZj
MDI2YzAgICAgICAweDlkMDAwNWMwICAgICAgMHgzNTAwM2QwMCAgICAgIDB4MmZjMDg0MDANCjB4
N2YwM2E4MDFjMTQ4OiAweDI3YzAyYmMwICAgICAgMHgxM2MwMjNjMCAgICAgIDB4YTIwMDA5YzAg
ICAgICAweDY3MDA5ZTAwDQoweDdmMDNhODAxYzE1ODogMHgzMzAwNDAwMCAgICAgIDB4MTJjMDMy
MDAgICAgICAweDQ1MDAwOGMwICAgICAgMHgxNjAwNDQwMA0KMHg3ZjAzYTgwMWMxNjg6IDB4MzFj
MDEzMDAgICAgICAweDI5YzAyZGMwICAgICAgMHgwZWMwMjVjMCAgICAgIDB4MGRjMDA0YzANCjB4
N2YwM2E4MDFjMTc4OiAweDljMDAwM2MwICAgICAgMHgyZjAwM2MwMCAgICAgIDB4MGEwMDQxMDAg
ICAgICAweDk5MDA5YTAwDQoweDdmMDNhODAxYzE4ODogMHgwNzAwOTYwMCAgICAgIDB4MDdjMDEx
YzAgICAgICAweDAyYzAwY2MwICAgICAgMHgwNDAwMDUwMA0KMHg3ZjAzYTgwMWMxOTg6IDB4MTIw
MDE1MDAgICAgICAweGZmMDAwOTAwICAgICAgMHg1NTAwMDAwMSAgICAgIDB4MGUwMDAwMDANCjB4
N2YwM2E4MDFjMWE4OiAweDAwMDAwYzAwICAgICAgMHg2MzZmNmMwOSAgICAgIDB4NmY2ODZjNjEg
ICAgICAweDBiMDA3NDczDQoweDdmMDNhODAxYzFiODogMHgwMDAzMDQwMCAgICAgIDB4MGEwMDAy
MDEgICAgICAweDA2MDAwODAwICAgICAgMHgxODAwMTkwMA0KMHg3ZjAzYTgwMWMxYzg6IDB4MjMw
MDE3MDAgICAgICAweDBkMDAwMDAwICAgICAgMHgyMDAwMjIwMCAgICAgIDB4MDIwNjAxMDYNCjB4
N2YwM2E4MDFjMWQ4OiAweDAxMDUwMzA2ICAgICAgMHgwMzA1MDIwNSAgICAgIDB4MDIwNDAxMDQg
ICAgICAweDAxMDMwMzA0DQoweDdmMDNhODAxYzFlODogMHgwMzAzMDIwMyAgICAgIDB4MDIwMjAx
MDIgICAgICAweDAxMDEwMzAyICAgICAgMHgwMTAwMGYwMA0KMHg3ZjAzYTgwMWMxZjg6IDB4MDAw
MDAwMDEgICAgICAweDAwMDAwMDAwDQoNCkFuZCB0aGlzIGlzIGluZGVlZCBhIGNsaWVudCBoZWxs
by4NCg0KUmVnYXJkcw0KDQpSw7xkaWdlcg0K

From dev-return-84010-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Thu Oct  1 14:29:50 2015
Return-Path: <dev-return-84010-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 54826178E4
	for <apmail-httpd-dev-archive@www.apache.org>; Thu,  1 Oct 2015 14:29:50 +0000 (UTC)
Received: (qmail 79766 invoked by uid 500); 1 Oct 2015 14:29:37 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 79686 invoked by uid 500); 1 Oct 2015 14:29:37 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 79676 invoked by uid 99); 1 Oct 2015 14:29:37 -0000
Received: from Unknown (HELO spamd2-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 01 Oct 2015 14:29:37 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd2-us-west.apache.org (ASF Mail Server at spamd2-us-west.apache.org) with ESMTP id C47E91A371F
	for <dev@httpd.apache.org>; Thu,  1 Oct 2015 14:29:36 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd2-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 0.999
X-Spam-Level:
X-Spam-Status: No, score=0.999 tagged_above=-999 required=6.31
	tests=[KAM_LAZY_DOMAIN_SECURITY=1, SPF_HELO_PASS=-0.001]
	autolearn=disabled
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd2-us-west.apache.org [10.40.0.9]) (amavisd-new, port 10024)
	with ESMTP id XwvrXRwT979h for <dev@httpd.apache.org>;
	Thu,  1 Oct 2015 14:29:26 +0000 (UTC)
Received: from mail1.bemta3.messagelabs.com (mail1.bemta3.messagelabs.com [195.245.230.171])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id AF943206E3
	for <dev@httpd.apache.org>; Thu,  1 Oct 2015 14:29:25 +0000 (UTC)
Received: from [195.245.230.51] by server-11.bemta-3.messagelabs.com id 0A/F4-32641-F334D065; Thu, 01 Oct 2015 14:29:19 +0000
X-Env-Sender: ruediger.pluem@vodafone.com
X-Msg-Ref: server-12.tower-33.messagelabs.com!1443709758!27322360!1
X-Originating-IP: [195.232.244.133]
X-StarScan-Received:
X-StarScan-Version: 6.13.16; banners=-,-,-
X-VirusChecked: Checked
Received: (qmail 26791 invoked from network); 1 Oct 2015 14:29:19 -0000
Received: from mailout01.vodafone.com (HELO mailout01.vodafone.com) (195.232.244.133)
  by server-12.tower-33.messagelabs.com with DHE-RSA-AES256-SHA encrypted SMTP; 1 Oct 2015 14:29:19 -0000
Received: from mailint03.vodafone.com (mailint03.vodafone.com [195.232.244.200])
	by mailout01.vodafone.com (Postfix) with ESMTP id 3nRcKB5FLkz1yHj
	for <dev@httpd.apache.org>; Thu,  1 Oct 2015 16:29:18 +0200 (CEST)
Received: from mailint03.vodafone.com (localhost [127.0.0.1])
	by mailint03.vodafone.com (Postfix) with ESMTP id 3nRcKB3Bfsz16KRr
	for <dev@httpd.apache.org>; Thu,  1 Oct 2015 16:29:18 +0200 (CEST)
Received: from VOEXC02W.internal.vodafone.com (voexc02w.dc-ratingen.de [145.230.101.22])
	(using TLSv1 with cipher AES128-SHA (128/128 bits))
	(No client certificate requested)
	by mailint03.vodafone.com (Postfix) with ESMTPS id 3nRcKB3765z16KFD
	for <dev@httpd.apache.org>; Thu,  1 Oct 2015 16:29:18 +0200 (CEST)
Received: from VOEXM10W.internal.vodafone.com ([169.254.2.132]) by
 VOEXC02W.internal.vodafone.com ([145.230.101.22]) with mapi id
 14.03.0224.002; Thu, 1 Oct 2015 16:29:17 +0200
From: =?utf-8?B?UGzDvG0sIFLDvGRpZ2VyLCBWb2RhZm9uZSBHcm91cA==?=
	<ruediger.pluem@vodafone.com>
To: "dev@httpd.apache.org" <dev@httpd.apache.org>
Subject: AW: SSLUseStapling: ssl handshake fails until httpd restart
Thread-Topic: SSLUseStapling: ssl handshake fails until httpd restart
Thread-Index: AQHQ+o/hyWTIy/sSVUe18l9/RxnDnZ5TgUsAgAAOqoCAAO+6AIAB5OIAgAA2gDD//+LBgIAAAteAgAA1A4A=
Date: Thu, 1 Oct 2015 14:29:17 +0000
Message-ID: <AB1691BE05AE7F4992697F2A0835627AC6325C6F@VOEXM10W.internal.vodafone.com>
References: <560A49E5.2090500@thelounge.net> <560AAEEC.2080500@gmail.com>
 <560ABB39.2030805@thelounge.net> <560B8452.5070800@velox.ch>
 <560D1B12.4060502@thelounge.net>
 <AB1691BE05AE7F4992697F2A0835627AC6325BD7@VOEXM10W.internal.vodafone.com>
 <560D3041.2060300@thelounge.net> <560D32A3.6080800@thelounge.net>
In-Reply-To: <560D32A3.6080800@thelounge.net>
Accept-Language: en-US
Content-Language: de-DE
X-MS-Has-Attach:
X-MS-TNEF-Correlator:
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
MIME-Version: 1.0

DQoNCj4gLS0tLS1VcnNwcsO8bmdsaWNoZSBOYWNocmljaHQtLS0tLQ0KPiBWb246IFJlaW5kbCBI
YXJhbGQgW21haWx0bzpoLnJlaW5kbEB0aGVsb3VuZ2UubmV0XQ0KPiBHZXNlbmRldDogRG9ubmVy
c3RhZywgMS4gT2t0b2JlciAyMDE1IDE1OjE4DQo+IEFuOiBkZXZAaHR0cGQuYXBhY2hlLm9yZw0K
PiBCZXRyZWZmOiBSZTogU1NMVXNlU3RhcGxpbmc6IHNzbCBoYW5kc2hha2UgZmFpbHMgdW50aWwg
aHR0cGQgcmVzdGFydA0KPiANCj4gDQo+IA0KPiBBbSAwMS4xMC4yMDE1IHVtIDE1OjA4IHNjaHJp
ZWIgUmVpbmRsIEhhcmFsZDoNCj4gPiBBbSAwMS4xMC4yMDE1IHVtIDE0OjUzIHNjaHJpZWIgUGzD
vG0sIFLDvGRpZ2VyLCBWb2RhZm9uZSBHcm91cDoNCj4gPj4+IG5vdCByZWFsbHksIGkgaGFkIHRo
ZSBlcnJvciBtZXNzYWdlIGp1c3Qgbm93IGFnYWluIGluIEZGLCB0aGUNCj4gZGlmZmVyZW5jZQ0K
PiA+Pj4gd2FzIHRoYXQgbm93IGEgInRyeSBhZ2FpbiIgbG9hZGVkIHRoZSBwYWdlIGJ1dCB3aXRo
DQo+ID4+PiAiU1NMU3RhcGxpbmdSZXR1cm5SZXNwb25kZXJFcnJvcnMiIGkgd291bGQgZXhwZWN0
IGl0IGludmlzaWJsZSB0bw0KPiA+Pj4gY2xpZW50cyBpbiBnZW5lcmFsIC0gR29EYWRkeSBzZWVt
cyB0byBoYXZlIG1hc3NpdmUgcHJvYmxlbXMgd2l0aA0KPiB0aGVpcg0KPiA+Pj4gcmVzcG9uZGVy
cyB0aGUgbGFzdCBkYXlzIGFuZCB0aGUgZGVmYXVsdHMgd2l0aCBzdGFwbGluZyBlbmFibGVkIG1h
a2UNCj4gPj4+IHRoZW0gdG8gYSBwZXJmZWN0IERPUyB0YXJnZXQNCj4gPj4+DQo+ID4+PiBbVGh1
IE9jdCAwMSAxMzozMzowMS4xNzkzNjUgMjAxNV0gW3NzbDplcnJvcl0gW3BpZCAxOTMxMl0gW2Ns
aWVudA0KPiA+Pj4gMTAuMC4wLjk5OjM3ODYwXSBBSDAxOTgwOiBiYWQgcmVzcG9uc2UgZnJvbSBP
Q1NQIHNlcnZlcjogKG5vbmUpDQo+ID4+PiBbVGh1IE9jdCAwMSAxMzozMzowMS4xNzkzOTMgMjAx
NV0gW3NzbDplcnJvcl0gW3BpZCAxOTMxMl0gQUgwMTk0MToNCj4gPj4+IHN0YXBsaW5nX3JlbmV3
X3Jlc3BvbnNlOiByZXNwb25kZXIgZXJyb3INCj4gPj4+DQo+ID4+PiBTU0xTdGFwbGluZ0NhY2hl
IHNobWNiOi92YXIvY2FjaGUvbW9kX3NzbC9vY3NwX2NhY2hlKDEwNDg1NzYpDQo+ID4+PiBTU0xT
dGFwbGluZ1N0YW5kYXJkQ2FjaGVUaW1lb3V0IDg2NDAwDQo+ID4+PiBTU0xTdGFwbGluZ0Vycm9y
Q2FjaGVUaW1lb3V0IDMwMA0KPiA+Pj4gU1NMU3RhcGxpbmdSZXR1cm5SZXNwb25kZXJFcnJvcnMg
T2ZmDQo+ID4+DQo+ID4+IFdoYXQgaGFwcGVucyBpZiB5b3Ugc2V0DQo+ID4+DQo+ID4+IFNTTFN0
YXBsaW5nRmFrZVRyeUxhdGVyIG9mZg0KPiA+Pg0KPiA+PiBpbiBhZGRpdGlvbj8NCj4gPg0KPiA+
IGkgYWRkZWQgdGhhdCBub3cgYW5kIHdpbGwgaGF2ZSBhIGxvb2sgb3ZlciB0aGUgc2VydmVybG9n
cywgaXQncyBub3QNCj4gPiBoYXBwZW5pbmcgYWxsIHRoZSB0aW1lIGJ1dCB2ZXJ5IG9mdGVuIGFu
ZCBzbyBpZiB0aGUgbG9ncyBhcmUgY2xlYXINCj4gPiB3aXRoaW4gMjQgaG91cnMgdGhlIHByb2Js
ZW0gaXMgbGlrZWx5IHNvbHZlZA0KPiANCj4gbG9va3Mgbm90IHRoYXQgZ29vZCAtICJDb25uZWN0
aW9uIHJlc2V0IGJ5IHBlZXIiIGluZGljYXRlcyBhIGZhaWxlZA0KPiBjbGllbnQgcmVxdWVzdCwg
dGhlIG90aGVyIGxpbmVzIGNvdWxkIGJlIGp1c3QgaW50ZXJuYWwNCj4gDQo+IFtUaHUgT2N0IDAx
IDE1OjE1OjAxLjQ5NTk4NiAyMDE1XSBbc3NsOmVycm9yXSBbcGlkIDE3NDY4XQ0KPiAoMTA0KUNv
bm5lY3Rpb24gcmVzZXQgYnkgcGVlcjogW2NsaWVudCA4MS4yMjMuMjAuNTo1NTE1Nl0gQUgwMTk3
NzoNCj4gZmFpbGVkIHJlYWRpbmcgbGluZSBmcm9tIE9DU1Agc2VydmVyDQo+IFtUaHUgT2N0IDAx
IDE1OjE1OjAxLjQ5NjAzNyAyMDE1XSBbc3NsOmVycm9yXSBbcGlkIDE3NDY4XSBbY2xpZW50DQo+
IDgxLjIyMy4yMC41OjU1MTU2XSBBSDAxOTgwOiBiYWQgcmVzcG9uc2UgZnJvbSBPQ1NQIHNlcnZl
cjogKG5vbmUpDQo+IFtUaHUgT2N0IDAxIDE1OjE1OjAxLjQ5NjA1NyAyMDE1XSBbc3NsOmVycm9y
XSBbcGlkIDE3NDY4XSBBSDAxOTQxOg0KPiBzdGFwbGluZ19yZW5ld19yZXNwb25zZTogcmVzcG9u
ZGVyIGVycm9yDQoNCg0KVGhlIHF1ZXN0aW9uIGlzOiBXaGF0IGhhcHBlbnMgb24gRmlyZWZveCBz
aWRlLiBPZiBjb3Vyc2UgaXQgc3RpbGwgdHJpZXMgdG8gZ2V0IHRvIHRoZSBPQ1NQIHNlcnZlciwg
YnV0IGl0IHNob3VsZCBub3QgY2F1c2UgYW4gZXJyb3Igb24gRmlyZWZveCBzaWRlIGlmIHRoaXMg
ZG9lcyBub3Qgd29yay4NCg0KUmVnYXJkcw0KDQpSw7xkaWdlcg0KDQo=

From dev-return-84011-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Thu Oct  1 14:32:10 2015
Return-Path: <dev-return-84011-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 4305A178F7
	for <apmail-httpd-dev-archive@www.apache.org>; Thu,  1 Oct 2015 14:32:10 +0000 (UTC)
Received: (qmail 82082 invoked by uid 500); 1 Oct 2015 14:31:35 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 82005 invoked by uid 500); 1 Oct 2015 14:31:35 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 81995 invoked by uid 99); 1 Oct 2015 14:31:35 -0000
Received: from Unknown (HELO spamd2-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 01 Oct 2015 14:31:35 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd2-us-west.apache.org (ASF Mail Server at spamd2-us-west.apache.org) with ESMTP id 1F0461A371F
	for <dev@httpd.apache.org>; Thu,  1 Oct 2015 14:31:35 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd2-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 1.366
X-Spam-Level: *
X-Spam-Status: No, score=1.366 tagged_above=-999 required=6.31
	tests=[FSL_HELO_NON_FQDN_1=0.001, KAM_LAZY_DOMAIN_SECURITY=1,
	RCVD_IN_SORBS_DUL=0.001, RDNS_DYNAMIC=0.363, URIBL_BLOCKED=0.001]
	autolearn=disabled
Received: from mx1-us-west.apache.org ([10.40.0.8])
	by localhost (spamd2-us-west.apache.org [10.40.0.9]) (amavisd-new, port 10024)
	with ESMTP id 59q6NyV6BN-j for <dev@httpd.apache.org>;
	Thu,  1 Oct 2015 14:31:34 +0000 (UTC)
Received: from baldur (cpc36-newt30-2-0-cust898.19-3.cable.virginm.net [82.32.195.131])
	by mx1-us-west.apache.org (ASF Mail Server at mx1-us-west.apache.org) with ESMTP id 0713520513
	for <dev@httpd.apache.org>; Thu,  1 Oct 2015 14:31:34 +0000 (UTC)
Received: from baldur (localhost [127.0.0.1])
	by baldur (Postfix) with ESMTP id D6FB6C151DCB
	for <dev@httpd.apache.org>; Thu,  1 Oct 2015 15:31:26 +0100 (BST)
Date: Thu, 1 Oct 2015 15:31:25 +0100
From: Nick Kew <nick@webthing.com>
To: dev@httpd.apache.org
Subject: Re: Expression Parser: search and replace with
 s/PATTERN/REPLACEMENT/FLAGS
Message-ID: <20151001153125.2feaba85@baldur>
In-Reply-To: <560D3452.2060303@kippdata.de>
References: <560D0A3F.9010609@kippdata.de>
	<1443702728.2576.93.camel@mimir.webthing.com>
	<560D2C5E.3080100@kippdata.de>
	<CD674D2E-A51A-4352-96B3-A3D8598CF286@jaguNET.com>
	<560D3452.2060303@kippdata.de>
X-Mailer: Claws Mail 3.7.4 (GTK+ 2.20.1; i486-pc-linux-gnu)
Mime-Version: 1.0
Content-Type: text/plain; charset=US-ASCII
Content-Transfer-Encoding: 7bit

On Thu, 1 Oct 2015 15:25:38 +0200
Rainer Jung <rainer.jung@kippdata.de> wrote:

> Am 01.10.2015 um 15:03 schrieb Jim Jagielski:
> > Doesn't mod_lua do this for you?
> 
> But would it be the right tool to use whenever you want to apply a 
> s/.../.../?

Some might say so (as some might say mod_perl or mod_rewrite).

> >>>> Header set X-USER "expr=%{REMOTE_USER} =~ s/([^@]*)@.*/$1/"

One further thought there that might be easier to work,
or a staging post on the way to your goal:

<If "expr=%{REMOTE_USER} =~ s/([^@]*)@.*/$1/">
    X-USER = $_
# (or whatever backref syntax you prefer).
</If>


-- 
Nick Kew

From dev-return-84012-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Thu Oct  1 14:32:15 2015
Return-Path: <dev-return-84012-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 9789A178FB
	for <apmail-httpd-dev-archive@www.apache.org>; Thu,  1 Oct 2015 14:32:15 +0000 (UTC)
Received: (qmail 85019 invoked by uid 500); 1 Oct 2015 14:32:15 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 84951 invoked by uid 500); 1 Oct 2015 14:32:15 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 84941 invoked by uid 99); 1 Oct 2015 14:32:14 -0000
Received: from Unknown (HELO spamd1-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 01 Oct 2015 14:32:14 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd1-us-west.apache.org (ASF Mail Server at spamd1-us-west.apache.org) with ESMTP id 73A37C816E
	for <dev@httpd.apache.org>; Thu,  1 Oct 2015 14:32:14 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd1-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.012
X-Spam-Level:
X-Spam-Status: No, score=-0.012 tagged_above=-999 required=6.31
	tests=[SPF_HELO_PASS=-0.001, SPF_PASS=-0.001, T_RP_MATCHES_RCVD=-0.01]
	autolearn=disabled
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd1-us-west.apache.org [10.40.0.7]) (amavisd-new, port 10024)
	with ESMTP id n4LgkUfZWB3L for <dev@httpd.apache.org>;
	Thu,  1 Oct 2015 14:32:13 +0000 (UTC)
Received: from mail.thelounge.net (mail.thelounge.net [91.118.73.15])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id 901FC42B2F
	for <dev@httpd.apache.org>; Thu,  1 Oct 2015 14:32:12 +0000 (UTC)
Subject: Re: SSLUseStapling: ssl handshake fails until httpd restart
To: dev@httpd.apache.org
References: <560A49E5.2090500@thelounge.net> <560AAEEC.2080500@gmail.com>
 <560ABB39.2030805@thelounge.net> <560B8452.5070800@velox.ch>
 <560D1B12.4060502@thelounge.net>
 <AB1691BE05AE7F4992697F2A0835627AC6325BD7@VOEXM10W.internal.vodafone.com>
 <560D3041.2060300@thelounge.net> <560D32A3.6080800@thelounge.net>
 <AB1691BE05AE7F4992697F2A0835627AC6325C6F@VOEXM10W.internal.vodafone.com>
From: Reindl Harald <h.reindl@thelounge.net>
Openpgp: id=13540402D67A7F71C6E974EA866063CF7F780279;
 url=https://arrakis.thelounge.net/gpg/h.reindl_thelounge.net.pub.txt
X-Enigmail-Draft-Status: N1110
Organization: the lounge interactive design
Message-ID: <560D43E9.4020809@thelounge.net>
Date: Thu, 1 Oct 2015 16:32:09 +0200
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:38.0) Gecko/20100101
 Thunderbird/38.3.0
MIME-Version: 1.0
In-Reply-To: <AB1691BE05AE7F4992697F2A0835627AC6325C6F@VOEXM10W.internal.vodafone.com>
Content-Type: multipart/signed; micalg=pgp-sha1;
 protocol="application/pgp-signature";
 boundary="aG76CU9URJV2nVrqlGCXPgurgCrB9UvmA"

This is an OpenPGP/MIME signed message (RFC 4880 and 3156)
--aG76CU9URJV2nVrqlGCXPgurgCrB9UvmA
Content-Type: text/plain; charset=utf-8; format=flowed
Content-Transfer-Encoding: quoted-printable



Am 01.10.2015 um 16:29 schrieb Pl=C3=BCm, R=C3=BCdiger, Vodafone Group:
>
>
>> -----Urspr=C3=BCngliche Nachricht-----
>> Von: Reindl Harald [mailto:h.reindl@thelounge.net]
>> Gesendet: Donnerstag, 1. Oktober 2015 15:18
>> An: dev@httpd.apache.org
>> Betreff: Re: SSLUseStapling: ssl handshake fails until httpd restart
>>
>>
>>
>> Am 01.10.2015 um 15:08 schrieb Reindl Harald:
>>> Am 01.10.2015 um 14:53 schrieb Pl=C3=BCm, R=C3=BCdiger, Vodafone Grou=
p:
>>>>> not really, i had the error message just now again in FF, the
>> difference
>>>>> was that now a "try again" loaded the page but with
>>>>> "SSLStaplingReturnResponderErrors" i would expect it invisible to
>>>>> clients in general - GoDaddy seems to have massive problems with
>> their
>>>>> responders the last days and the defaults with stapling enabled mak=
e
>>>>> them to a perfect DOS target
>>>>>
>>>>> [Thu Oct 01 13:33:01.179365 2015] [ssl:error] [pid 19312] [client
>>>>> 10.0.0.99:37860] AH01980: bad response from OCSP server: (none)
>>>>> [Thu Oct 01 13:33:01.179393 2015] [ssl:error] [pid 19312] AH01941:
>>>>> stapling_renew_response: responder error
>>>>>
>>>>> SSLStaplingCache shmcb:/var/cache/mod_ssl/ocsp_cache(1048576)
>>>>> SSLStaplingStandardCacheTimeout 86400
>>>>> SSLStaplingErrorCacheTimeout 300
>>>>> SSLStaplingReturnResponderErrors Off
>>>>
>>>> What happens if you set
>>>>
>>>> SSLStaplingFakeTryLater off
>>>>
>>>> in addition?
>>>
>>> i added that now and will have a look over the serverlogs, it's not
>>> happening all the time but very often and so if the logs are clear
>>> within 24 hours the problem is likely solved
>>
>> looks not that good - "Connection reset by peer" indicates a failed
>> client request, the other lines could be just internal
>>
>> [Thu Oct 01 15:15:01.495986 2015] [ssl:error] [pid 17468]
>> (104)Connection reset by peer: [client 81.223.20.5:55156] AH01977:
>> failed reading line from OCSP server
>> [Thu Oct 01 15:15:01.496037 2015] [ssl:error] [pid 17468] [client
>> 81.223.20.5:55156] AH01980: bad response from OCSP server: (none)
>> [Thu Oct 01 15:15:01.496057 2015] [ssl:error] [pid 17468] AH01941:
>> stapling_renew_response: responder error
>
> The question is: What happens on Firefox side. Of course it still tries=
 to get to the OCSP server, but it should not cause an error on Firefox s=
ide if this does not work.

no, it does not because "security.OCSP.enabled =3D 0" and i saw at least =

two requests to different servers failing with my Firefox with the=20
responder error from the webserver


--aG76CU9URJV2nVrqlGCXPgurgCrB9UvmA
Content-Type: application/pgp-signature; name="signature.asc"
Content-Description: OpenPGP digital signature
Content-Disposition: attachment; filename="signature.asc"

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v2

iEYEARECAAYFAlYNQ+kACgkQhmBjz394AnmergCfYLgGtXH2arJfE/aml8Se4T4T
qf8AnibLKFozGbN0Emb3gNYg4pj8pqb4
=X4/Y
-----END PGP SIGNATURE-----

--aG76CU9URJV2nVrqlGCXPgurgCrB9UvmA--

From dev-return-84013-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Thu Oct  1 14:42:21 2015
Return-Path: <dev-return-84013-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 7EBD71798E
	for <apmail-httpd-dev-archive@www.apache.org>; Thu,  1 Oct 2015 14:42:21 +0000 (UTC)
Received: (qmail 22015 invoked by uid 500); 1 Oct 2015 14:42:21 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 21933 invoked by uid 500); 1 Oct 2015 14:42:20 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 21923 invoked by uid 99); 1 Oct 2015 14:42:20 -0000
Received: from Unknown (HELO spamd3-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 01 Oct 2015 14:42:20 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd3-us-west.apache.org (ASF Mail Server at spamd3-us-west.apache.org) with ESMTP id 89016180234
	for <dev@httpd.apache.org>; Thu,  1 Oct 2015 14:42:20 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd3-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.006
X-Spam-Level:
X-Spam-Status: No, score=-0.006 tagged_above=-999 required=6.31
	tests=[RP_MATCHES_RCVD=-0.006, SPF_PASS=-0.001, URIBL_BLOCKED=0.001]
	autolearn=disabled
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd3-us-west.apache.org [10.40.0.10]) (amavisd-new, port 10024)
	with ESMTP id XgkuVW6W3KBp for <dev@httpd.apache.org>;
	Thu,  1 Oct 2015 14:42:11 +0000 (UTC)
Received: from monica.sharp.fm (monica.sharp.fm [80.168.143.5])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTP id D02D8201FB
	for <dev@httpd.apache.org>; Thu,  1 Oct 2015 14:42:10 +0000 (UTC)
Received: from [192.168.220.234] (unknown [192.168.220.234])
	(using TLSv1 with cipher DHE-RSA-AES256-SHA (256/256 bits))
	(Client did not present a certificate)
	(Authenticated sender: minfrin@sharp.fm)
	by monica.sharp.fm (Postfix) with ESMTPSA id 7533A830FC
	for <dev@httpd.apache.org>; Thu,  1 Oct 2015 15:42:10 +0100 (BST)
Content-Type: text/plain; charset=utf-8
Mime-Version: 1.0 (Mac OS X Mail 8.2 \(2104\))
Subject: Re: Expression Parser: search and replace with s/PATTERN/REPLACEMENT/FLAGS
From: Graham Leggett <minfrin@sharp.fm>
In-Reply-To: <20151001153125.2feaba85@baldur>
Date: Thu, 1 Oct 2015 16:42:09 +0200
Content-Transfer-Encoding: quoted-printable
Message-Id: <7B398AE7-118C-4F3F-9C13-87909592F0A4@sharp.fm>
References: <560D0A3F.9010609@kippdata.de> <1443702728.2576.93.camel@mimir.webthing.com> <560D2C5E.3080100@kippdata.de> <CD674D2E-A51A-4352-96B3-A3D8598CF286@jaguNET.com> <560D3452.2060303@kippdata.de> <20151001153125.2feaba85@baldur>
To: dev@httpd.apache.org
X-Mailer: Apple Mail (2.2104)

On 01 Oct 2015, at 4:31 PM, Nick Kew <nick@webthing.com> wrote:

>>>>>> Header set X-USER "expr=3D%{REMOTE_USER} =3D~ s/([^@]*)@.*/$1/"
>=20
> One further thought there that might be easier to work,
> or a staging post on the way to your goal:
>=20
> <If "expr=3D%{REMOTE_USER} =3D~ s/([^@]*)@.*/$1/">
>    X-USER =3D $_
> # (or whatever backref syntax you prefer).
> </If>

The reason I went with the named backref syntax only was the confusion =
generated by nesting or duplicating the sections.

I would avoid any auto-numbered variables that leak outside the scope of =
a single string expression so as to avoid side effects when two parts of =
the config generate the same variable.

Regards,
Graham
=E2=80=94


From dev-return-84014-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Thu Oct  1 14:46:41 2015
Return-Path: <dev-return-84014-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 059CA179B8
	for <apmail-httpd-dev-archive@www.apache.org>; Thu,  1 Oct 2015 14:46:41 +0000 (UTC)
Received: (qmail 34886 invoked by uid 500); 1 Oct 2015 14:46:40 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 34820 invoked by uid 500); 1 Oct 2015 14:46:40 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 34810 invoked by uid 99); 1 Oct 2015 14:46:40 -0000
Received: from Unknown (HELO spamd1-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 01 Oct 2015 14:46:40 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd1-us-west.apache.org (ASF Mail Server at spamd1-us-west.apache.org) with ESMTP id 178E5C815A
	for <dev@httpd.apache.org>; Thu,  1 Oct 2015 14:46:40 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd1-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.101
X-Spam-Level:
X-Spam-Status: No, score=-0.101 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RCVD_IN_MSPIKE_H2=-0.001, SPF_PASS=-0.001, URIBL_BLOCKED=0.001]
	autolearn=disabled
Authentication-Results: spamd1-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-us-west.apache.org ([10.40.0.8])
	by localhost (spamd1-us-west.apache.org [10.40.0.7]) (amavisd-new, port 10024)
	with ESMTP id vcE4RY9H2HTc for <dev@httpd.apache.org>;
	Thu,  1 Oct 2015 14:46:34 +0000 (UTC)
Received: from mail-qg0-f47.google.com (mail-qg0-f47.google.com [209.85.192.47])
	by mx1-us-west.apache.org (ASF Mail Server at mx1-us-west.apache.org) with ESMTPS id B7F1120513
	for <dev@httpd.apache.org>; Thu,  1 Oct 2015 14:46:33 +0000 (UTC)
Received: by qgez77 with SMTP id z77so68612541qge.1
        for <dev@httpd.apache.org>; Thu, 01 Oct 2015 07:46:33 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type:content-transfer-encoding;
        bh=68kQUCXIi/4mePDtwEaDVdZ6cNFy6Fr9EWivlIV+xmg=;
        b=v5J0ywCJib6dzeG1BT/Px3iTuykOmjvRto8xdT69vxvFR4q6mFWiVh46/kOfgduuur
         oOhpdK3YKviig3yY7NkCKK0uR8S9MEIt/07nC2lqSwsxiDmybJ5TglSxb1UBPWNzFu6l
         oc7RzqgptwSF8uQFZJfsbHviihbXkcDsB19ZRaEOjonMtFtDGJ1xnStlr4l6FnmCGFNe
         96UK/doIHlx3pgbby+K8t7J8pKfkLqnEfUJCpA5B6jMkEqW8LemHFjWyLfhVHVunANba
         s7UnT+9fnqPWB5aeSCyQPUphjI+RqjY6Yxrmw6u8eBCPDAX/gnFzTAe520K2+kG0/Jge
         hTUQ==
MIME-Version: 1.0
X-Received: by 10.140.101.119 with SMTP id t110mr13173241qge.71.1443710792469;
 Thu, 01 Oct 2015 07:46:32 -0700 (PDT)
Received: by 10.55.72.20 with HTTP; Thu, 1 Oct 2015 07:46:32 -0700 (PDT)
In-Reply-To: <AB1691BE05AE7F4992697F2A0835627AC6325C45@VOEXM10W.internal.vodafone.com>
References: <20150929094257.1DAB53A01DC@svn01-us-west.apache.org>
	<560C2A63.1000800@apache.org>
	<560C3FD1.7000002@apache.org>
	<AB1691BE05AE7F4992697F2A0835627AC6325C45@VOEXM10W.internal.vodafone.com>
Date: Thu, 1 Oct 2015 16:46:32 +0200
Message-ID: <CAKQ1sVNFTp-MEr_2iO6GxK3iqA=oze-Vkfx14=BxTaoTGcNTzg@mail.gmail.com>
Subject: Re: svn commit: r1705823 - /httpd/httpd/trunk/modules/ssl/ssl_engine_io.c
From: Yann Ylavic <ylavic.dev@gmail.com>
To: dev@httpd.apache.org
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: quoted-printable

On Thu, Oct 1, 2015 at 3:54 PM, Pl=C3=BCm, R=C3=BCdiger, Vodafone Group
<ruediger.pluem@vodafone.com> wrote:
>>
>> Looks like as neither ssl23_client_hello nor ssl23_write_bytes cause
>> BIO_flush to be called.
>
> Dumped the wrong memory section for a HEAP bucket. The contents of the he=
ap bucket is actually (now a different session):
>
> gdb) x/70x 0x7f03a801c0e8
> 0x7f03a801c0e8: 0x01010316      0x0100010c      0x56030308      0xcbee2e0=
d
> 0x7f03a801c0f8: 0x08b833ba      0xfc96ae2b      0xba2b9a9b      0xa67ea8d=
2
> 0x7f03a801c108: 0x0ef75ce9      0xb398fba7      0x004fe092      0x30c08a0=
0
> 0x7f03a801c118: 0x28c02cc0      0x14c024c0      0xa3000ac0      0x6b009f0=
0
> 0x7f03a801c128: 0x39006a00      0x88003800      0x32c08700      0x2ac02ec=
0
> 0x7f03a801c138: 0x0fc026c0      0x9d0005c0      0x35003d00      0x2fc0840=
0
> 0x7f03a801c148: 0x27c02bc0      0x13c023c0      0xa20009c0      0x67009e0=
0
> 0x7f03a801c158: 0x33004000      0x12c03200      0x450008c0      0x1600440=
0
> 0x7f03a801c168: 0x31c01300      0x29c02dc0      0x0ec025c0      0x0dc004c=
0
> 0x7f03a801c178: 0x9c0003c0      0x2f003c00      0x0a004100      0x99009a0=
0
> 0x7f03a801c188: 0x07009600      0x07c011c0      0x02c00cc0      0x0400050=
0
> 0x7f03a801c198: 0x12001500      0xff000900      0x55000001      0x0e00000=
0
> 0x7f03a801c1a8: 0x00000c00      0x636f6c09      0x6f686c61      0x0b00747=
3
> 0x7f03a801c1b8: 0x00030400      0x0a000201      0x06000800      0x1800190=
0
> 0x7f03a801c1c8: 0x23001700      0x0d000000      0x20002200      0x0206010=
6
> 0x7f03a801c1d8: 0x01050306      0x03050205      0x02040104      0x0103030=
4
> 0x7f03a801c1e8: 0x03030203      0x02020102      0x01010302      0x01000f0=
0
> 0x7f03a801c1f8: 0x00000001      0x00000000
>
> And this is indeed a client hello.

Yes, I checked openssl's ssl23_client_hello() and indeed there is no
flush from there...

Actually I don't see any flush in any SSL_method*() during handshake
but at the end of it...

So we probably should go for something like:

Index: modules/ssl/ssl_engine_io.c
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D
--- modules/ssl/ssl_engine_io.c    (revision 1706228)
+++ modules/ssl/ssl_engine_io.c    (working copy)
@@ -452,6 +452,7 @@ static int bio_filter_in_read(BIO *bio, char *in,
     apr_size_t inl =3D inlen;
     bio_filter_in_ctx_t *inctx =3D (bio_filter_in_ctx_t *)(bio->ptr);
     apr_read_type_e block =3D inctx->block;
+    int do_flush;

     inctx->rc =3D APR_SUCCESS;

@@ -466,21 +467,25 @@ static int bio_filter_in_read(BIO *bio, char *in,
     }

     /* In theory, OpenSSL should flush as necessary, but it is known
-     * not to do so correctly in some cases (< 0.9.8m); see PR 46952.
+     * not to do so correctly in some cases (< 0.9.8m; see PR 46952),
+     * or on the proxy/client side (after ssl23_client_hello(), eg.
+     * ssl/proxy.t test suite).
+     *
+     * Historically, this flush call was performed only for an SSLv2
+     * connection or for a proxy connection.  Calling _out_flush can
+     * be expensive in cases where requests/reponses are pipelined,
+     * so limit the performance impact to handshake time.
      */
 #if OPENSSL_VERSION_NUMBER < 0x0009080df
-    /* Historically, this flush call was performed only for an SSLv2
-     * connection or for a proxy connection.  Calling _out_flush
-     * should be very cheap in cases where it is unnecessary (and no
-     * output is buffered) so the performance impact of doing it
-     * unconditionally should be minimal.
-     */
-    if (bio_filter_out_flush(inctx->bio_out) < 0) {
+    do_flush =3D 1;
+#else
+    do_flush =3D !SSL_is_init_finished(inctx->ssl);
+#endif
+    if (do_flush && bio_filter_out_flush(inctx->bio_out) < 0) {
         bio_filter_out_ctx_t *outctx =3D inctx->bio_out->ptr;
         inctx->rc =3D outctx->rc;
         return -1;
     }
-#endif

     BIO_clear_retry_flags(bio);

--

This makes the tests work for me...

Regards,
Yann.

From dev-return-84015-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Thu Oct  1 14:59:55 2015
Return-Path: <dev-return-84015-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 4AFA717A5B
	for <apmail-httpd-dev-archive@www.apache.org>; Thu,  1 Oct 2015 14:59:55 +0000 (UTC)
Received: (qmail 70308 invoked by uid 500); 1 Oct 2015 14:59:51 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 70222 invoked by uid 500); 1 Oct 2015 14:59:51 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 70212 invoked by uid 99); 1 Oct 2015 14:59:51 -0000
Received: from Unknown (HELO spamd3-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 01 Oct 2015 14:59:51 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd3-us-west.apache.org (ASF Mail Server at spamd3-us-west.apache.org) with ESMTP id 48994180964
	for <dev@httpd.apache.org>; Thu,  1 Oct 2015 14:59:51 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd3-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 1.999
X-Spam-Level: *
X-Spam-Status: No, score=1.999 tagged_above=-999 required=6.31
	tests=[FREEMAIL_REPLY=1, KAM_LAZY_DOMAIN_SECURITY=1,
	RCVD_IN_MSPIKE_H2=-0.001, SPF_HELO_PASS=-0.001, URIBL_BLOCKED=0.001]
	autolearn=disabled
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd3-us-west.apache.org [10.40.0.10]) (amavisd-new, port 10024)
	with ESMTP id Ds8Tcvh3x2Wp for <dev@httpd.apache.org>;
	Thu,  1 Oct 2015 14:59:38 +0000 (UTC)
Received: from mail1.bemta3.messagelabs.com (mail1.bemta3.messagelabs.com [195.245.230.170])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id E41EB42B2F
	for <dev@httpd.apache.org>; Thu,  1 Oct 2015 14:59:37 +0000 (UTC)
Received: from [195.245.230.51] by server-10.bemta-3.messagelabs.com id EE/E7-23203-35A4D065; Thu, 01 Oct 2015 14:59:31 +0000
X-Env-Sender: ruediger.pluem@vodafone.com
X-Msg-Ref: server-10.tower-33.messagelabs.com!1443711571!13435280!1
X-Originating-IP: [195.232.244.136]
X-StarScan-Received:
X-StarScan-Version: 6.13.16; banners=-,-,-
X-VirusChecked: Checked
Received: (qmail 30544 invoked from network); 1 Oct 2015 14:59:31 -0000
Received: from mailout04.vodafone.com (HELO mailout04.vodafone.com) (195.232.244.136)
  by server-10.tower-33.messagelabs.com with DHE-RSA-AES256-SHA encrypted SMTP; 1 Oct 2015 14:59:31 -0000
Received: from mailint03.vodafone.com (mailint03.vodafone.com [195.232.244.200])
	by mailout04.vodafone.com (Postfix) with ESMTP id 3nRd030kmVznTYc
	for <dev@httpd.apache.org>; Thu,  1 Oct 2015 16:59:31 +0200 (CEST)
Received: from mailint03.vodafone.com (localhost [127.0.0.1])
	by mailint03.vodafone.com (Postfix) with ESMTP id 3nRd026fQ9z16KZG
	for <dev@httpd.apache.org>; Thu,  1 Oct 2015 16:59:30 +0200 (CEST)
Received: from VOEXC02W.internal.vodafone.com (voexc02w.dc-ratingen.de [145.230.101.22])
	(using TLSv1 with cipher AES128-SHA (128/128 bits))
	(No client certificate requested)
	by mailint03.vodafone.com (Postfix) with ESMTPS id 3nRd026Jwrz16KXx
	for <dev@httpd.apache.org>; Thu,  1 Oct 2015 16:59:30 +0200 (CEST)
Received: from VOEXM10W.internal.vodafone.com ([169.254.2.132]) by
 VOEXC02W.internal.vodafone.com ([145.230.101.22]) with mapi id
 14.03.0224.002; Thu, 1 Oct 2015 16:59:30 +0200
From: =?utf-8?B?UGzDvG0sIFLDvGRpZ2VyLCBWb2RhZm9uZSBHcm91cA==?=
	<ruediger.pluem@vodafone.com>
To: "dev@httpd.apache.org" <dev@httpd.apache.org>
Subject: AW: svn commit: r1705823 -
 /httpd/httpd/trunk/modules/ssl/ssl_engine_io.c
Thread-Topic: svn commit: r1705823 -
 /httpd/httpd/trunk/modules/ssl/ssl_engine_io.c
Thread-Index: AQHQ+65fZ1aJNxXPZUK4h9Y8sB0e+p5VXPWAgAFMyND//+1LAIAAJQDg
Date: Thu, 1 Oct 2015 14:59:29 +0000
Message-ID: <AB1691BE05AE7F4992697F2A0835627AC6325CD5@VOEXM10W.internal.vodafone.com>
References: <20150929094257.1DAB53A01DC@svn01-us-west.apache.org>
	<560C2A63.1000800@apache.org>	<560C3FD1.7000002@apache.org>
	<AB1691BE05AE7F4992697F2A0835627AC6325C45@VOEXM10W.internal.vodafone.com>
 <CAKQ1sVNFTp-MEr_2iO6GxK3iqA=oze-Vkfx14=BxTaoTGcNTzg@mail.gmail.com>
In-Reply-To: <CAKQ1sVNFTp-MEr_2iO6GxK3iqA=oze-Vkfx14=BxTaoTGcNTzg@mail.gmail.com>
Accept-Language: en-US
Content-Language: de-DE
X-MS-Has-Attach:
X-MS-TNEF-Correlator:
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
MIME-Version: 1.0

DQoNCj4gLS0tLS1VcnNwcsO8bmdsaWNoZSBOYWNocmljaHQtLS0tLQ0KPiBWb246IFlhbm4gWWxh
dmljIFttYWlsdG86eWxhdmljLmRldkBnbWFpbC5jb21dDQo+IEdlc2VuZGV0OiBEb25uZXJzdGFn
LCAxLiBPa3RvYmVyIDIwMTUgMTY6NDcNCj4gQW46IGRldkBodHRwZC5hcGFjaGUub3JnDQo+IEJl
dHJlZmY6IFJlOiBzdm4gY29tbWl0OiByMTcwNTgyMyAtDQo+IC9odHRwZC9odHRwZC90cnVuay9t
b2R1bGVzL3NzbC9zc2xfZW5naW5lX2lvLmMNCj4gDQo+IE9uIFRodSwgT2N0IDEsIDIwMTUgYXQg
Mzo1NCBQTSwgUGzDvG0sIFLDvGRpZ2VyLCBWb2RhZm9uZSBHcm91cA0KPiA8cnVlZGlnZXIucGx1
ZW1Adm9kYWZvbmUuY29tPiB3cm90ZToNCj4gPj4NCj4gPj4gTG9va3MgbGlrZSBhcyBuZWl0aGVy
IHNzbDIzX2NsaWVudF9oZWxsbyBub3Igc3NsMjNfd3JpdGVfYnl0ZXMgY2F1c2UNCj4gPj4gQklP
X2ZsdXNoIHRvIGJlIGNhbGxlZC4NCj4gPg0KPiA+IER1bXBlZCB0aGUgd3JvbmcgbWVtb3J5IHNl
Y3Rpb24gZm9yIGEgSEVBUCBidWNrZXQuIFRoZSBjb250ZW50cyBvZiB0aGUNCj4gaGVhcCBidWNr
ZXQgaXMgYWN0dWFsbHkgKG5vdyBhIGRpZmZlcmVudCBzZXNzaW9uKToNCj4gPg0KPiA+IGdkYikg
eC83MHggMHg3ZjAzYTgwMWMwZTgNCj4gPiAweDdmMDNhODAxYzBlODogMHgwMTAxMDMxNiAgICAg
IDB4MDEwMDAxMGMgICAgICAweDU2MDMwMzA4DQo+IDB4Y2JlZTJlMGQNCj4gPiAweDdmMDNhODAx
YzBmODogMHgwOGI4MzNiYSAgICAgIDB4ZmM5NmFlMmIgICAgICAweGJhMmI5YTliDQo+IDB4YTY3
ZWE4ZDINCj4gPiAweDdmMDNhODAxYzEwODogMHgwZWY3NWNlOSAgICAgIDB4YjM5OGZiYTcgICAg
ICAweDAwNGZlMDkyDQo+IDB4MzBjMDhhMDANCj4gPiAweDdmMDNhODAxYzExODogMHgyOGMwMmNj
MCAgICAgIDB4MTRjMDI0YzAgICAgICAweGEzMDAwYWMwDQo+IDB4NmIwMDlmMDANCj4gPiAweDdm
MDNhODAxYzEyODogMHgzOTAwNmEwMCAgICAgIDB4ODgwMDM4MDAgICAgICAweDMyYzA4NzAwDQo+
IDB4MmFjMDJlYzANCj4gPiAweDdmMDNhODAxYzEzODogMHgwZmMwMjZjMCAgICAgIDB4OWQwMDA1
YzAgICAgICAweDM1MDAzZDAwDQo+IDB4MmZjMDg0MDANCj4gPiAweDdmMDNhODAxYzE0ODogMHgy
N2MwMmJjMCAgICAgIDB4MTNjMDIzYzAgICAgICAweGEyMDAwOWMwDQo+IDB4NjcwMDllMDANCj4g
PiAweDdmMDNhODAxYzE1ODogMHgzMzAwNDAwMCAgICAgIDB4MTJjMDMyMDAgICAgICAweDQ1MDAw
OGMwDQo+IDB4MTYwMDQ0MDANCj4gPiAweDdmMDNhODAxYzE2ODogMHgzMWMwMTMwMCAgICAgIDB4
MjljMDJkYzAgICAgICAweDBlYzAyNWMwDQo+IDB4MGRjMDA0YzANCj4gPiAweDdmMDNhODAxYzE3
ODogMHg5YzAwMDNjMCAgICAgIDB4MmYwMDNjMDAgICAgICAweDBhMDA0MTAwDQo+IDB4OTkwMDlh
MDANCj4gPiAweDdmMDNhODAxYzE4ODogMHgwNzAwOTYwMCAgICAgIDB4MDdjMDExYzAgICAgICAw
eDAyYzAwY2MwDQo+IDB4MDQwMDA1MDANCj4gPiAweDdmMDNhODAxYzE5ODogMHgxMjAwMTUwMCAg
ICAgIDB4ZmYwMDA5MDAgICAgICAweDU1MDAwMDAxDQo+IDB4MGUwMDAwMDANCj4gPiAweDdmMDNh
ODAxYzFhODogMHgwMDAwMGMwMCAgICAgIDB4NjM2ZjZjMDkgICAgICAweDZmNjg2YzYxDQo+IDB4
MGIwMDc0NzMNCj4gPiAweDdmMDNhODAxYzFiODogMHgwMDAzMDQwMCAgICAgIDB4MGEwMDAyMDEg
ICAgICAweDA2MDAwODAwDQo+IDB4MTgwMDE5MDANCj4gPiAweDdmMDNhODAxYzFjODogMHgyMzAw
MTcwMCAgICAgIDB4MGQwMDAwMDAgICAgICAweDIwMDAyMjAwDQo+IDB4MDIwNjAxMDYNCj4gPiAw
eDdmMDNhODAxYzFkODogMHgwMTA1MDMwNiAgICAgIDB4MDMwNTAyMDUgICAgICAweDAyMDQwMTA0
DQo+IDB4MDEwMzAzMDQNCj4gPiAweDdmMDNhODAxYzFlODogMHgwMzAzMDIwMyAgICAgIDB4MDIw
MjAxMDIgICAgICAweDAxMDEwMzAyDQo+IDB4MDEwMDBmMDANCj4gPiAweDdmMDNhODAxYzFmODog
MHgwMDAwMDAwMSAgICAgIDB4MDAwMDAwMDANCj4gPg0KPiA+IEFuZCB0aGlzIGlzIGluZGVlZCBh
IGNsaWVudCBoZWxsby4NCj4gDQo+IFllcywgSSBjaGVja2VkIG9wZW5zc2wncyBzc2wyM19jbGll
bnRfaGVsbG8oKSBhbmQgaW5kZWVkIHRoZXJlIGlzIG5vDQo+IGZsdXNoIGZyb20gdGhlcmUuLi4N
Cj4gDQo+IEFjdHVhbGx5IEkgZG9uJ3Qgc2VlIGFueSBmbHVzaCBpbiBhbnkgU1NMX21ldGhvZCoo
KSBkdXJpbmcgaGFuZHNoYWtlDQo+IGJ1dCBhdCB0aGUgZW5kIG9mIGl0Li4uDQo+IA0KPiBTbyB3
ZSBwcm9iYWJseSBzaG91bGQgZ28gZm9yIHNvbWV0aGluZyBsaWtlOg0KPiANCj4gSW5kZXg6IG1v
ZHVsZXMvc3NsL3NzbF9lbmdpbmVfaW8uYw0KPiA9PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09DQo+IC0tLSBtb2R1bGVzL3Nz
bC9zc2xfZW5naW5lX2lvLmMgICAgKHJldmlzaW9uIDE3MDYyMjgpDQo+ICsrKyBtb2R1bGVzL3Nz
bC9zc2xfZW5naW5lX2lvLmMgICAgKHdvcmtpbmcgY29weSkNCj4gQEAgLTQ1Miw2ICs0NTIsNyBA
QCBzdGF0aWMgaW50IGJpb19maWx0ZXJfaW5fcmVhZChCSU8gKmJpbywgY2hhciAqaW4sDQo+ICAg
ICAgYXByX3NpemVfdCBpbmwgPSBpbmxlbjsNCj4gICAgICBiaW9fZmlsdGVyX2luX2N0eF90ICpp
bmN0eCA9IChiaW9fZmlsdGVyX2luX2N0eF90ICopKGJpby0+cHRyKTsNCj4gICAgICBhcHJfcmVh
ZF90eXBlX2UgYmxvY2sgPSBpbmN0eC0+YmxvY2s7DQo+ICsgICAgaW50IGRvX2ZsdXNoOw0KPiAN
Cj4gICAgICBpbmN0eC0+cmMgPSBBUFJfU1VDQ0VTUzsNCj4gDQo+IEBAIC00NjYsMjEgKzQ2Nywy
NSBAQCBzdGF0aWMgaW50IGJpb19maWx0ZXJfaW5fcmVhZChCSU8gKmJpbywgY2hhciAqaW4sDQo+
ICAgICAgfQ0KPiANCj4gICAgICAvKiBJbiB0aGVvcnksIE9wZW5TU0wgc2hvdWxkIGZsdXNoIGFz
IG5lY2Vzc2FyeSwgYnV0IGl0IGlzIGtub3duDQo+IC0gICAgICogbm90IHRvIGRvIHNvIGNvcnJl
Y3RseSBpbiBzb21lIGNhc2VzICg8IDAuOS44bSk7IHNlZSBQUiA0Njk1Mi4NCj4gKyAgICAgKiBu
b3QgdG8gZG8gc28gY29ycmVjdGx5IGluIHNvbWUgY2FzZXMgKDwgMC45LjhtOyBzZWUgUFIgNDY5
NTIpLA0KPiArICAgICAqIG9yIG9uIHRoZSBwcm94eS9jbGllbnQgc2lkZSAoYWZ0ZXIgc3NsMjNf
Y2xpZW50X2hlbGxvKCksIGVnLg0KPiArICAgICAqIHNzbC9wcm94eS50IHRlc3Qgc3VpdGUpLg0K
PiArICAgICAqDQo+ICsgICAgICogSGlzdG9yaWNhbGx5LCB0aGlzIGZsdXNoIGNhbGwgd2FzIHBl
cmZvcm1lZCBvbmx5IGZvciBhbiBTU0x2Mg0KPiArICAgICAqIGNvbm5lY3Rpb24gb3IgZm9yIGEg
cHJveHkgY29ubmVjdGlvbi4gIENhbGxpbmcgX291dF9mbHVzaCBjYW4NCj4gKyAgICAgKiBiZSBl
eHBlbnNpdmUgaW4gY2FzZXMgd2hlcmUgcmVxdWVzdHMvcmVwb25zZXMgYXJlIHBpcGVsaW5lZCwN
Cj4gKyAgICAgKiBzbyBsaW1pdCB0aGUgcGVyZm9ybWFuY2UgaW1wYWN0IHRvIGhhbmRzaGFrZSB0
aW1lLg0KPiAgICAgICAqLw0KPiAgI2lmIE9QRU5TU0xfVkVSU0lPTl9OVU1CRVIgPCAweDAwMDkw
ODBkZg0KPiAtICAgIC8qIEhpc3RvcmljYWxseSwgdGhpcyBmbHVzaCBjYWxsIHdhcyBwZXJmb3Jt
ZWQgb25seSBmb3IgYW4gU1NMdjINCj4gLSAgICAgKiBjb25uZWN0aW9uIG9yIGZvciBhIHByb3h5
IGNvbm5lY3Rpb24uICBDYWxsaW5nIF9vdXRfZmx1c2gNCj4gLSAgICAgKiBzaG91bGQgYmUgdmVy
eSBjaGVhcCBpbiBjYXNlcyB3aGVyZSBpdCBpcyB1bm5lY2Vzc2FyeSAoYW5kIG5vDQo+IC0gICAg
ICogb3V0cHV0IGlzIGJ1ZmZlcmVkKSBzbyB0aGUgcGVyZm9ybWFuY2UgaW1wYWN0IG9mIGRvaW5n
IGl0DQo+IC0gICAgICogdW5jb25kaXRpb25hbGx5IHNob3VsZCBiZSBtaW5pbWFsLg0KPiAtICAg
ICAqLw0KPiAtICAgIGlmIChiaW9fZmlsdGVyX291dF9mbHVzaChpbmN0eC0+YmlvX291dCkgPCAw
KSB7DQo+ICsgICAgZG9fZmx1c2ggPSAxOw0KPiArI2Vsc2UNCj4gKyAgICBkb19mbHVzaCA9ICFT
U0xfaXNfaW5pdF9maW5pc2hlZChpbmN0eC0+c3NsKTsNCj4gKyNlbmRpZg0KPiArICAgIGlmIChk
b19mbHVzaCAmJiBiaW9fZmlsdGVyX291dF9mbHVzaChpbmN0eC0+YmlvX291dCkgPCAwKSB7DQo+
ICAgICAgICAgIGJpb19maWx0ZXJfb3V0X2N0eF90ICpvdXRjdHggPSBpbmN0eC0+YmlvX291dC0+
cHRyOw0KPiAgICAgICAgICBpbmN0eC0+cmMgPSBvdXRjdHgtPnJjOw0KPiAgICAgICAgICByZXR1
cm4gLTE7DQo+ICAgICAgfQ0KPiAtI2VuZGlmDQo+IA0KPiAgICAgIEJJT19jbGVhcl9yZXRyeV9m
bGFncyhiaW8pOw0KPiANCj4gLS0NCj4gDQo+IFRoaXMgbWFrZXMgdGhlIHRlc3RzIHdvcmsgZm9y
IG1lLi4uDQoNCg0KTG9va3Mgc2Vuc2libGUuICsxLg0KDQpSZWdhcmRzDQoNClLDvGRpZ2VyDQoN
Cg==

From dev-return-84016-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Thu Oct  1 16:59:40 2015
Return-Path: <dev-return-84016-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 21BC917F21
	for <apmail-httpd-dev-archive@www.apache.org>; Thu,  1 Oct 2015 16:59:40 +0000 (UTC)
Received: (qmail 44212 invoked by uid 500); 1 Oct 2015 16:59:39 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 44152 invoked by uid 500); 1 Oct 2015 16:59:39 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 44139 invoked by uid 99); 1 Oct 2015 16:59:39 -0000
Received: from Unknown (HELO spamd3-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 01 Oct 2015 16:59:39 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd3-us-west.apache.org (ASF Mail Server at spamd3-us-west.apache.org) with ESMTP id 3637A180964;
	Thu,  1 Oct 2015 16:59:39 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd3-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.007
X-Spam-Level:
X-Spam-Status: No, score=-0.007 tagged_above=-999 required=6.31
	tests=[RP_MATCHES_RCVD=-0.006, SPF_PASS=-0.001] autolearn=disabled
Received: from mx1-us-west.apache.org ([10.40.0.8])
	by localhost (spamd3-us-west.apache.org [10.40.0.10]) (amavisd-new, port 10024)
	with ESMTP id LAeKx3bDCLjK; Thu,  1 Oct 2015 16:59:38 +0000 (UTC)
Received: from monica.sharp.fm (monica.sharp.fm [80.168.143.5])
	by mx1-us-west.apache.org (ASF Mail Server at mx1-us-west.apache.org) with ESMTP id 168E123031;
	Thu,  1 Oct 2015 16:59:38 +0000 (UTC)
Received: from [192.168.220.234] (unknown [192.168.220.234])
	(using TLSv1 with cipher DHE-RSA-AES256-SHA (256/256 bits))
	(Client did not present a certificate)
	(Authenticated sender: minfrin@sharp.fm)
	by monica.sharp.fm (Postfix) with ESMTPSA id 8CE1B83127;
	Thu,  1 Oct 2015 17:59:30 +0100 (BST)
Content-Type: text/plain; charset=utf-8
Mime-Version: 1.0 (Mac OS X Mail 8.2 \(2104\))
Subject: Re: svn commit: r1706275 - /httpd/httpd/trunk/modules/ssl/ssl_engine_io.c
From: Graham Leggett <minfrin@sharp.fm>
In-Reply-To: <20151001154324.0CBD73A01DC@svn01-us-west.apache.org>
Date: Thu, 1 Oct 2015 18:59:29 +0200
Cc: cvs@httpd.apache.org
Content-Transfer-Encoding: quoted-printable
Message-Id: <34694C4B-0561-441D-B7DC-6321A1ECE7E5@sharp.fm>
References: <20151001154324.0CBD73A01DC@svn01-us-west.apache.org>
To: dev@httpd.apache.org
X-Mailer: Apple Mail (2.2104)

On 01 Oct 2015, at 5:43 PM, ylavic@apache.org wrote:

> URL: http://svn.apache.org/viewvc?rev=3D1706275&view=3Drev
> Log:
> mod_ssl: follow up to r1705823.
> We still need to flush in the middle of a SSL/TLS handshake.

Can you confirm why the flushing is necessary?

In theory mod_ssl should be switching the sense of any reads/writes as =
necessary without any need for flushing.

Regards,
Graham
=E2=80=94


From dev-return-84017-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Thu Oct  1 18:03:14 2015
Return-Path: <dev-return-84017-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 10EC718188
	for <apmail-httpd-dev-archive@www.apache.org>; Thu,  1 Oct 2015 18:03:14 +0000 (UTC)
Received: (qmail 3177 invoked by uid 500); 1 Oct 2015 18:02:51 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 3102 invoked by uid 500); 1 Oct 2015 18:02:51 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 3092 invoked by uid 99); 1 Oct 2015 18:02:51 -0000
Received: from Unknown (HELO spamd4-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 01 Oct 2015 18:02:51 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd4-us-west.apache.org (ASF Mail Server at spamd4-us-west.apache.org) with ESMTP id 05FE5C027E
	for <dev@httpd.apache.org>; Thu,  1 Oct 2015 18:02:51 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd4-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 0.652
X-Spam-Level:
X-Spam-Status: No, score=0.652 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, SPF_NEUTRAL=0.652]
	autolearn=disabled
Authentication-Results: spamd4-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=comcast.net
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd4-us-west.apache.org [10.40.0.11]) (amavisd-new, port 10024)
	with ESMTP id SgitWD4X2R2u for <dev@httpd.apache.org>;
	Thu,  1 Oct 2015 18:02:44 +0000 (UTC)
Received: from resqmta-ch2-11v.sys.comcast.net (resqmta-ch2-11v.sys.comcast.net [69.252.207.43])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id EC46C42F38
	for <dev@httpd.apache.org>; Thu,  1 Oct 2015 18:02:43 +0000 (UTC)
Received: from resomta-ch2-12v.sys.comcast.net ([69.252.207.108])
	by resqmta-ch2-11v.sys.comcast.net with comcast
	id Pu2M1r0022LrikM01u2dcZ; Thu, 01 Oct 2015 18:02:37 +0000
Received: from [192.168.199.10] ([69.251.84.114])
	by resomta-ch2-12v.sys.comcast.net with comcast
	id Pu2c1r00X2U0RYt01u2cpk; Thu, 01 Oct 2015 18:02:37 +0000
Content-Type: text/plain; charset=utf-8
Mime-Version: 1.0 (Mac OS X Mail 8.2 \(2104\))
Subject: Re: svn commit: r1705823 - /httpd/httpd/trunk/modules/ssl/ssl_engine_io.c
From: Jim Jagielski <jim@jaguNET.com>
In-Reply-To: <560C2A63.1000800@apache.org>
Date: Thu, 1 Oct 2015 14:02:36 -0400
Content-Transfer-Encoding: quoted-printable
Message-Id: <4928918A-A20F-4668-8A79-EA51D6BFAD11@jaguNET.com>
References: <20150929094257.1DAB53A01DC@svn01-us-west.apache.org> <560C2A63.1000800@apache.org>
To: dev@httpd.apache.org
X-Mailer: Apple Mail (2.2104)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=comcast.net;
	s=q20140121; t=1443722557;
	bh=48LW0IdrbKDNgBgrNqdc83SNm5npomgDzLqKej2BzSs=;
	h=Received:Received:Content-Type:Mime-Version:Subject:From:Date:
	 Message-Id:To;
	b=jmrOUloqykMm5Hwoa4hMzUKitNfGZJtkoyEVQCpA10/h1LvLNx61gt8vsA+Dkbi9a
	 S9GYK59MsYRVXhn7YZcMbld4c6L+bBOqvOYITBGrbB2UfKHpkGuQq7DhAC7SwXOHZO
	 J3mKN02H9j++dHprVsYasof50bnScNi0S1BznaUdQG3a4eggDPdKLLag2lagY1oiMi
	 bL+kbvorx9ZxMeBs1XyhvfazrMVH3FmbuTB1Us77eXpkiqV5I1vT5zhcjNw0TwPMka
	 isGJ41S57SDS4z0Cd+PcwMzSW1a0GF7nVdWw0poZRiPGB7HGzgTiuUf9e277KcswIM
	 HsjoDC6q//lfw==

I am still unclear on why this flushing is even necessary... :/


> On Sep 30, 2015, at 2:30 PM, Ruediger Pluem <rpluem@apache.org> wrote:
>=20
>=20
>=20
> On 09/29/2015 11:42 AM, ylavic@apache.org wrote:
>> Author: ylavic
>> Date: Tue Sep 29 09:42:56 2015
>> New Revision: 1705823
>>=20
>> URL: http://svn.apache.org/viewvc?rev=3D1705823&view=3Drev
>> Log:
>> mod_ssl: don't FLUSH output (blocking) on read.
>> This defeats deferred write (and pipelining), eg. check_pipeline() is =
not
>> expecting the pipe to be flushed under it.
>> So let OpenSSL >=3D 0.9.8m issue the flush when necessary (earlier =
versions
>> are known to not handle all the cases, so we keep flushing with =
those).
>>=20
>> Modified:
>>    httpd/httpd/trunk/modules/ssl/ssl_engine_io.c
>>=20
>> Modified: httpd/httpd/trunk/modules/ssl/ssl_engine_io.c
>> URL: =
http://svn.apache.org/viewvc/httpd/httpd/trunk/modules/ssl/ssl_engine_io.c=
?rev=3D1705823&r1=3D1705822&r2=3D1705823&view=3Ddiff
>> =
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
>> --- httpd/httpd/trunk/modules/ssl/ssl_engine_io.c (original)
>> +++ httpd/httpd/trunk/modules/ssl/ssl_engine_io.c Tue Sep 29 09:42:56 =
2015
>> @@ -466,9 +466,10 @@ static int bio_filter_in_read(BIO *bio,
>>     }
>>=20
>>     /* In theory, OpenSSL should flush as necessary, but it is known
>> -     * not to do so correctly in some cases; see PR 46952.
>> -     *
>> -     * Historically, this flush call was performed only for an SSLv2
>> +     * not to do so correctly in some cases (< 0.9.8m); see PR =
46952.
>> +     */
>> +#if OPENSSL_VERSION_NUMBER < 0x0009080df
>> +    /* Historically, this flush call was performed only for an SSLv2
>>      * connection or for a proxy connection.  Calling _out_flush
>>      * should be very cheap in cases where it is unnecessary (and no
>>      * output is buffered) so the performance impact of doing it
>>=20
>>=20
>>=20
>=20
>=20
> This and the follow up r1705826 do cause t/ssl/proxy.t to hang and =
ultimately fail with timeouts.
> I am running on Centos 6 with Openssl 1.0.1.
> Currently no idea why. Just a heads up.
>=20
> Regards
>=20
> R=C3=BCdiger


From dev-return-84018-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Thu Oct  1 18:22:40 2015
Return-Path: <dev-return-84018-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id DA99018217
	for <apmail-httpd-dev-archive@www.apache.org>; Thu,  1 Oct 2015 18:22:40 +0000 (UTC)
Received: (qmail 48956 invoked by uid 500); 1 Oct 2015 18:22:40 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 48889 invoked by uid 500); 1 Oct 2015 18:22:40 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 48880 invoked by uid 99); 1 Oct 2015 18:22:40 -0000
Received: from mail-relay.apache.org (HELO mail-relay.apache.org) (140.211.11.15)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 01 Oct 2015 18:22:40 +0000
Received: from gauss.localdomain (v4-861345e7.pool.vitroconnect.de [134.19.69.231])
	by mail-relay.apache.org (ASF Mail Server at mail-relay.apache.org) with ESMTPSA id C08731A022D
	for <dev@httpd.apache.org>; Thu,  1 Oct 2015 18:22:39 +0000 (UTC)
Received: from [IPv6:::1] (localhost [IPv6:::1])
	by gauss.localdomain (Postfix) with ESMTP id D3E3F497
	for <dev@httpd.apache.org>; Thu,  1 Oct 2015 20:22:39 +0200 (CEST)
Subject: Re: svn commit: r1706275 -
 /httpd/httpd/trunk/modules/ssl/ssl_engine_io.c
To: dev@httpd.apache.org
References: <20151001154324.0CBD73A01DC@svn01-us-west.apache.org>
 <34694C4B-0561-441D-B7DC-6321A1ECE7E5@sharp.fm>
From: Ruediger Pluem <rpluem@apache.org>
X-Enigmail-Draft-Status: N1110
Message-ID: <560D79EF.80201@apache.org>
Date: Thu, 1 Oct 2015 20:22:39 +0200
User-Agent: Mozilla/5.0 (X11; Linux i686 on x86_64; rv:41.0) Gecko/20100101
 Firefox/41.0 SeaMonkey/2.38
MIME-Version: 1.0
In-Reply-To: <34694C4B-0561-441D-B7DC-6321A1ECE7E5@sharp.fm>
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 8bit



On 10/01/2015 06:59 PM, Graham Leggett wrote:
> On 01 Oct 2015, at 5:43 PM, ylavic@apache.org wrote:
> 
>> URL: http://svn.apache.org/viewvc?rev=1706275&view=rev
>> Log:
>> mod_ssl: follow up to r1705823.
>> We still need to flush in the middle of a SSL/TLS handshake.
> 
> Can you confirm why the flushing is necessary?
> 
> In theory mod_ssl should be switching the sense of any reads/writes as necessary without any need for flushing.
> 

The issue is that openssl during the connect handshake to a clieent does not tell httpd to flush. Hence the CLIENT_HELLO
remains in the core output filter buffer and openssl waits for the SERVER_HELLO from the remote server which of course
does not happen without the CLIENT_HELLO having been sent there.

The whole game of reading and writing during the handshake happens inside openssl while SSL_connect is running.
Apache code only gets back into this via bio_filter_out_write and bio_filter_in_read.


Regards

Rüdiger

From dev-return-84019-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Thu Oct  1 18:32:23 2015
Return-Path: <dev-return-84019-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 07C4C1825C
	for <apmail-httpd-dev-archive@www.apache.org>; Thu,  1 Oct 2015 18:32:23 +0000 (UTC)
Received: (qmail 70390 invoked by uid 500); 1 Oct 2015 18:32:22 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 70324 invoked by uid 500); 1 Oct 2015 18:32:22 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 70315 invoked by uid 99); 1 Oct 2015 18:32:22 -0000
Received: from mail-relay.apache.org (HELO mail-relay.apache.org) (140.211.11.15)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 01 Oct 2015 18:32:22 +0000
Received: from gauss.localdomain (v4-861345e7.pool.vitroconnect.de [134.19.69.231])
	by mail-relay.apache.org (ASF Mail Server at mail-relay.apache.org) with ESMTPSA id 054471A022D
	for <dev@httpd.apache.org>; Thu,  1 Oct 2015 18:32:22 +0000 (UTC)
Received: from [IPv6:::1] (localhost [IPv6:::1])
	by gauss.localdomain (Postfix) with ESMTP id 771BD497
	for <dev@httpd.apache.org>; Thu,  1 Oct 2015 20:32:22 +0200 (CEST)
Subject: Re: svn commit: r1703305 -
 /httpd/httpd/trunk/modules/aaa/mod_auth_digest.c
To: dev@httpd.apache.org
References: <20150915222046.152F4AC0181@hades.apache.org>
From: Ruediger Pluem <rpluem@apache.org>
Message-ID: <560D7C36.7010607@apache.org>
Date: Thu, 1 Oct 2015 20:32:22 +0200
User-Agent: Mozilla/5.0 (X11; Linux i686 on x86_64; rv:41.0) Gecko/20100101
 Firefox/41.0 SeaMonkey/2.38
MIME-Version: 1.0
In-Reply-To: <20150915222046.152F4AC0181@hades.apache.org>
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 8bit



On 09/16/2015 12:20 AM, jailletc36@apache.org wrote:
> Author: jailletc36
> Date: Tue Sep 15 22:20:45 2015
> New Revision: 1703305
> 
> URL: http://svn.apache.org/r1703305
> Log:
> Remove code related to 'AuthDigestEnableQueryStringHack'
> 
> This has been undocumented for about 3 years now (see r1415960)
> 
> Modified:
>     httpd/httpd/trunk/modules/aaa/mod_auth_digest.c

Could this cause

t/modules/digest.t

test 9 to fail?

As we removed the code for good reason we should also remove the test if this is the case then.

Regards

Rüdiger


From dev-return-84020-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Thu Oct  1 18:59:59 2015
Return-Path: <dev-return-84020-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id B88A01835D
	for <apmail-httpd-dev-archive@www.apache.org>; Thu,  1 Oct 2015 18:59:59 +0000 (UTC)
Received: (qmail 58569 invoked by uid 500); 1 Oct 2015 18:59:59 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 58466 invoked by uid 500); 1 Oct 2015 18:59:59 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 58450 invoked by uid 99); 1 Oct 2015 18:59:59 -0000
Received: from Unknown (HELO spamd2-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 01 Oct 2015 18:59:59 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd2-us-west.apache.org (ASF Mail Server at spamd2-us-west.apache.org) with ESMTP id A83D61A370E
	for <dev@httpd.apache.org>; Thu,  1 Oct 2015 18:59:58 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd2-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.102
X-Spam-Level:
X-Spam-Status: No, score=-0.102 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RCVD_IN_MSPIKE_H2=-0.001, SPF_PASS=-0.001] autolearn=disabled
Authentication-Results: spamd2-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-us-west.apache.org ([10.40.0.8])
	by localhost (spamd2-us-west.apache.org [10.40.0.9]) (amavisd-new, port 10024)
	with ESMTP id nYKSBSDti5dg for <dev@httpd.apache.org>;
	Thu,  1 Oct 2015 18:59:57 +0000 (UTC)
Received: from mail-pa0-f44.google.com (mail-pa0-f44.google.com [209.85.220.44])
	by mx1-us-west.apache.org (ASF Mail Server at mx1-us-west.apache.org) with ESMTPS id A0610203BA
	for <dev@httpd.apache.org>; Thu,  1 Oct 2015 18:59:57 +0000 (UTC)
Received: by pablk4 with SMTP id lk4so81794537pab.3
        for <dev@httpd.apache.org>; Thu, 01 Oct 2015 11:59:57 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=subject:to:references:from:message-id:date:user-agent:mime-version
         :in-reply-to:content-type:content-transfer-encoding;
        bh=GZxkQp1ymQEijoHVz/ZhA7dxM/TNxNS5jDng/hSdp9U=;
        b=EG2BKrJk7K1bPgfAPZ5gPItH5cEM0CDkDF5E1jlscJSofqIgc/eYeejHTt84wdFNhG
         1Enprax0h3/CE8vYGYJAPOy8YkofVPAUp9eckKYvARs2ml7Rvj9llwz18FW47FhSLId3
         Uw7NKm/5eymMMHjm7Tt1bHN8jeCWpRwl8B1KYanSh4WCXR3gM4ZfQoaQnx0lZpgoNHB8
         ak4MocI1Qm4M9I8ioNl8P8PUN5Q15pRQ65/IsFWt/ux+CGBB1sM7Eagat/RewPn7Nyxj
         mkZ0AjblkkDxVv2EmtVJ4jPSlNlinbQ8cpLQcRe6HOcskvJ77cCvPMgRnRGV+w6AdXxk
         //ig==
X-Received: by 10.68.134.73 with SMTP id pi9mr1881188pbb.55.1443725997355;
        Thu, 01 Oct 2015 11:59:57 -0700 (PDT)
Received: from [192.168.1.4] (static-50-43-55-221.bvtn.or.frontiernet.net. [50.43.55.221])
        by smtp.gmail.com with ESMTPSA id ux7sm8162431pac.10.2015.10.01.11.59.56
        for <dev@httpd.apache.org>
        (version=TLSv1.2 cipher=ECDHE-RSA-AES128-GCM-SHA256 bits=128/128);
        Thu, 01 Oct 2015 11:59:56 -0700 (PDT)
Subject: Re: svn commit: r1705681 - in
 /httpd/httpd/branches/2.4.17-protocols-http2: ./ docs/manual/mod/
 docs/manual/rewrite/ modules/filters/ modules/loggers/ modules/ssl/ server/
To: dev@httpd.apache.org
References: <20150928130059.DCB433A04DA@svn01-us-west.apache.org>
From: Jacob Champion <champion.p@gmail.com>
Message-ID: <560D82AB.4090807@gmail.com>
Date: Thu, 1 Oct 2015 11:59:55 -0700
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:38.0) Gecko/20100101
 Thunderbird/38.2.0
MIME-Version: 1.0
In-Reply-To: <20150928130059.DCB433A04DA@svn01-us-west.apache.org>
Content-Type: text/plain; charset=utf-8; format=flowed
Content-Transfer-Encoding: 7bit

On 09/28/2015 06:00 AM, jim@apache.org wrote:
> Author: jim
> Date: Mon Sep 28 13:00:59 2015
> New Revision: 1705681
>
> URL: http://svn.apache.org/viewvc?rev=1705681&view=rev
> Log:
> Sync
> [...]
> Modified: httpd/httpd/branches/2.4.17-protocols-http2/modules/ssl/ssl_engine_kernel.c
> URL: http://svn.apache.org/viewvc/httpd/httpd/branches/2.4.17-protocols-http2/modules/ssl/ssl_engine_kernel.c?rev=1705681&r1=1705680&r2=1705681&view=diff
> ==============================================================================
> --- httpd/httpd/branches/2.4.17-protocols-http2/modules/ssl/ssl_engine_kernel.c (original)
> +++ httpd/httpd/branches/2.4.17-protocols-http2/modules/ssl/ssl_engine_kernel.c Mon Sep 28 13:00:59 2015
> @@ -29,6 +29,7 @@
>                                     time I was too famous.''
>                                               -- Unknown                */
>   #include "ssl_private.h"
> +#include "mod_ssl.h"
>   #include "util_md5.h"
>
>   static void ssl_configure_env(request_rec *r, SSLConnRec *sslconn);
> @@ -201,10 +202,12 @@ int ssl_hook_ReadReq(request_rec *r)
>                    * selected by the SNI.
>                    */
>                   ap_log_error(APLOG_MARK, APLOG_ERR, 0, r->server, APLOGNO(02032)
> -                             "Hostname %s provided via SNI and hostname %s provided"
> -                             " via HTTP select a different server",
> -                             servername, r->hostname);
> -                return HTTP_MISDIRECTED_REQUEST;
> +                            "Hostname %s provided via SNI and hostname %s provided"
> +                            " via HTTP are different", servername, host);
> +                if (r->connection->keepalives > 0) {
> +                    return HTTP_MISDIRECTED_REQUEST;
> +                }
> +                return HTTP_BAD_REQUEST;
>               }
>           }
>           else if (((sc->strict_sni_vhost_check == SSL_ENABLED_TRUE)
>

This change breaks me:

     ssl_engine_kernel.c:206:68: error: 'host' undeclared

Possibly a mismerge? Changing 'host' back to 'r->hostname' works for me, 
but I don't know the original goal of the change.

--Jacob

From dev-return-84021-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Sat Oct  3 09:17:07 2015
Return-Path: <dev-return-84021-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id AB1FC1890D
	for <apmail-httpd-dev-archive@www.apache.org>; Sat,  3 Oct 2015 09:17:07 +0000 (UTC)
Received: (qmail 93771 invoked by uid 500); 3 Oct 2015 09:17:07 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 93697 invoked by uid 500); 3 Oct 2015 09:17:07 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 93680 invoked by uid 99); 3 Oct 2015 09:17:07 -0000
Received: from Unknown (HELO spamd1-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 03 Oct 2015 09:17:07 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd1-us-west.apache.org (ASF Mail Server at spamd1-us-west.apache.org) with ESMTP id 994CAC1E6F
	for <dev@httpd.apache.org>; Sat,  3 Oct 2015 09:17:06 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd1-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.109
X-Spam-Level:
X-Spam-Status: No, score=-0.109 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	T_RP_MATCHES_RCVD=-0.01, URIBL_BLOCKED=0.001] autolearn=disabled
Authentication-Results: spamd1-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=velox.ch header.b=5ZicLQ+E;
	dkim=pass (2048-bit key) header.d=velox.ch header.b=v3+7L4dU
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd1-us-west.apache.org [10.40.0.7]) (amavisd-new, port 10024)
	with ESMTP id aOaP-ZIU2sBN for <dev@httpd.apache.org>;
	Sat,  3 Oct 2015 09:16:56 +0000 (UTC)
Received: from fornix.velox.ch (fornix.velox.ch [85.25.46.13])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id 342BB42B59
	for <dev@httpd.apache.org>; Sat,  3 Oct 2015 09:16:56 +0000 (UTC)
Received: from cortex.velox.ch (77-57-164-164.dclient.hispeed.ch [77.57.164.164])
	(authenticated bits=0)
	by fornix.velox.ch (8.14.9/8.14.9/2.2) with ESMTP id t939Gm07019424
	(version=TLSv1/SSLv3 cipher=DHE-RSA-AES256-GCM-SHA384 bits=256 verify=OK)
	for <dev@httpd.apache.org>; Sat, 3 Oct 2015 11:16:49 +0200
DKIM-Signature: v=1; a=rsa-sha256; c=simple/simple; d=velox.ch;
	s=fornix-727e; t=1443863809;
	bh=narC3/l/VrEGfAekmCeoCpBkEMtoiqX+N49NPyZsg24=;
	h=Subject:To:References:From:Date:In-Reply-To;
	b=5ZicLQ+EZ35RZirPq3kuRHw+TO7Cx8nFaMOj5DBwKmjk1FyQOqAho7Z0c1RZZ+M/7
	 RqylTeE20yre5Jkh6VCZ1PnWJs6ZTnoOE/g/FUqcRwG4doylYQmbkA/42VfPpOozF1
	 NRNnSROWx6T1P7CikO+xj8R4JkmzUnnS35sHJTN2rGbbrT9g8y4x2LkYM4CGSGc0iE
	 rT0DjOEnoJDfHhh8x0UirXLSQkQyePyj5mIu/e4kwXMrbhisU2YQute4FkLK571D3A
	 nfJ8WSnA4QOXzhupL5DmO8kaT2ILxZZa/zbNziRqZVuEjJnxGamZtJIFr/a9UVx9tK
	 1OdkQbvEsWEiw==
Subject: Re: SSLUseStapling: ssl handshake fails until httpd restart
DKIM-Signature: v=1; a=rsa-sha256; c=simple/simple; d=velox.ch;
	s=cortex-8a58; t=1443863807;
	bh=narC3/l/VrEGfAekmCeoCpBkEMtoiqX+N49NPyZsg24=;
	h=Subject:To:References:From:Date:In-Reply-To;
	b=v3+7L4dUvB1fpH/m3odm0eHtkq8gZO91RPdKUYbGsoghXBoU0+o/xDhraMiE+mlVL
	 VRW//hrgCQuvTD74I5R+WscWdsOqjn4dGxxODstr2AXlHyg36TSOrjvo8rg9EA9wKr
	 o9VYpASJA5uIJDm5taPeWFFIMOXJ8sCLa13TD7bSZoLjkaM55J5K+PPBb90+z5pjwt
	 dnJ9ezKIC46nCEHp4LsUK+8f3p4SM68M5OOYxbXNLFPTDFOh++OclVU+8k8UgeVB/m
	 ecd572TI4Fz0z/3+kGALudnW3jK/htq6uoWF8JqEJtnUgoOPRY1LOREn+tXPTntzPK
	 QkDMtiQ/0Pu4g==
To: dev@httpd.apache.org
References: <560A49E5.2090500@thelounge.net> <560AAEEC.2080500@gmail.com>
 <560ABB39.2030805@thelounge.net> <560B8452.5070800@velox.ch>
 <560D1B12.4060502@thelounge.net>
 <AB1691BE05AE7F4992697F2A0835627AC6325BD7@VOEXM10W.internal.vodafone.com>
 <560D3041.2060300@thelounge.net> <560D32A3.6080800@thelounge.net>
 <AB1691BE05AE7F4992697F2A0835627AC6325C6F@VOEXM10W.internal.vodafone.com>
 <560D43E9.4020809@thelounge.net>
From: Kaspar Brand <httpd-dev.2014@velox.ch>
Message-ID: <560F9D02.8070905@velox.ch>
Date: Sat, 3 Oct 2015 11:16:50 +0200
MIME-Version: 1.0
In-Reply-To: <560D43E9.4020809@thelounge.net>
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 8bit

On 01.10.2015 16:32, Reindl Harald wrote:
> Am 01.10.2015 um 16:29 schrieb Plüm, Rüdiger, Vodafone Group:
>> The question is: What happens on Firefox side. Of course it still tries to get to the OCSP server, but it should not cause an error on Firefox side if this does not work.
> 
> no, it does not because "security.OCSP.enabled = 0" and i saw at least 
> two requests to different servers failing with my Firefox with the 
> responder error from the webserver

What do you have security.OCSP.require set to? If it's "true" (a setting
no longer configurable through the UI, BTW, see
https://bugzilla.mozilla.org/show_bug.cgi?id=1034360), then Firefox
shows a fairly peculiar behavior: even when OCSP checking is disabled
(by setting security.OCSP.enabled to "0", through the "Query OCSP
responder servers to confirm the current validity of certificates"
preference in the UI under Advanced -> Certificates), it still includes
a status_request extension in the TLS handshake, and will subsequently
fail when it receives a stapled tryLater OCSP response, as long as
security.OCSP.require=true.

Kaspar

From dev-return-84022-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Sat Oct  3 10:08:07 2015
Return-Path: <dev-return-84022-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 6487D189D5
	for <apmail-httpd-dev-archive@www.apache.org>; Sat,  3 Oct 2015 10:08:07 +0000 (UTC)
Received: (qmail 38343 invoked by uid 500); 3 Oct 2015 10:08:06 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 38255 invoked by uid 500); 3 Oct 2015 10:08:06 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 38245 invoked by uid 99); 3 Oct 2015 10:08:06 -0000
Received: from Unknown (HELO spamd3-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 03 Oct 2015 10:08:06 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd3-us-west.apache.org (ASF Mail Server at spamd3-us-west.apache.org) with ESMTP id 7A3431809C5
	for <dev@httpd.apache.org>; Sat,  3 Oct 2015 10:08:06 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd3-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.006
X-Spam-Level:
X-Spam-Status: No, score=-0.006 tagged_above=-999 required=6.31
	tests=[RP_MATCHES_RCVD=-0.006, SPF_HELO_PASS=-0.001,
	URIBL_BLOCKED=0.001] autolearn=disabled
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd3-us-west.apache.org [10.40.0.10]) (amavisd-new, port 10024)
	with ESMTP id 0l58PKYsdMzK for <dev@httpd.apache.org>;
	Sat,  3 Oct 2015 10:08:01 +0000 (UTC)
Received: from mail.thelounge.net (mail.thelounge.net [91.118.73.15])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id 5E11120773
	for <dev@httpd.apache.org>; Sat,  3 Oct 2015 10:08:00 +0000 (UTC)
Subject: Re: SSLUseStapling: ssl handshake fails until httpd restart
To: dev@httpd.apache.org
References: <560A49E5.2090500@thelounge.net> <560AAEEC.2080500@gmail.com>
 <560ABB39.2030805@thelounge.net> <560B8452.5070800@velox.ch>
 <560D1B12.4060502@thelounge.net>
 <AB1691BE05AE7F4992697F2A0835627AC6325BD7@VOEXM10W.internal.vodafone.com>
 <560D3041.2060300@thelounge.net> <560D32A3.6080800@thelounge.net>
 <AB1691BE05AE7F4992697F2A0835627AC6325C6F@VOEXM10W.internal.vodafone.com>
 <560D43E9.4020809@thelounge.net> <560F9D02.8070905@velox.ch>
From: Reindl Harald <h.reindl@thelounge.net>
Openpgp: id=13540402D67A7F71C6E974EA866063CF7F780279;
 url=https://arrakis.thelounge.net/gpg/h.reindl_thelounge.net.pub.txt
X-Enigmail-Draft-Status: N1110
Organization: the lounge interactive design
Message-ID: <560FA8F8.2010003@thelounge.net>
Date: Sat, 3 Oct 2015 12:07:52 +0200
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:38.0) Gecko/20100101
 Thunderbird/38.3.0
MIME-Version: 1.0
In-Reply-To: <560F9D02.8070905@velox.ch>
Content-Type: multipart/signed; micalg=pgp-sha1;
 protocol="application/pgp-signature";
 boundary="q2tb8hWPbAOSa4U6fxE0cxVtvHvGtxdCH"

This is an OpenPGP/MIME signed message (RFC 4880 and 3156)
--q2tb8hWPbAOSa4U6fxE0cxVtvHvGtxdCH
Content-Type: text/plain; charset=utf-8; format=flowed
Content-Transfer-Encoding: quoted-printable



Am 03.10.2015 um 11:16 schrieb Kaspar Brand:
> On 01.10.2015 16:32, Reindl Harald wrote:
>> Am 01.10.2015 um 16:29 schrieb Pl=C3=BCm, R=C3=BCdiger, Vodafone Group=
:
>>> The question is: What happens on Firefox side. Of course it still tri=
es to get to the OCSP server, but it should not cause an error on Firefox=
 side if this does not work.
>>
>> no, it does not because "security.OCSP.enabled =3D 0" and i saw at lea=
st
>> two requests to different servers failing with my Firefox with the
>> responder error from the webserver
>
> What do you have security.OCSP.require set to? If it's "true" (a settin=
g
> no longer configurable through the UI, BTW, see
> https://bugzilla.mozilla.org/show_bug.cgi?id=3D1034360), then Firefox
> shows a fairly peculiar behavior: even when OCSP checking is disabled
> (by setting security.OCSP.enabled to "0", through the "Query OCSP
> responder servers to confirm the current validity of certificates"
> preference in the UI under Advanced -> Certificates), it still includes=

> a status_request extension in the TLS handshake, and will subsequently
> fail when it receives a stapled tryLater OCSP response, as long as
> security.OCSP.require=3Dtrue

security.OCSP.require=3Dfalse is the default
but it's not only my client with random failed connections

[Sat Oct 03 00:15:01.478741 2015] [ssl:error] [pid 27458]=20
(104)Connection reset by peer: [client 81.223.20.5:59844] AH01977:=20
failed reading line from OCSP server
[Sat Oct 03 00:45:01.618792 2015] [ssl:error] [pid 4965] (104)Connection =

reset by peer: [client 81.223.20.5:33566] AH01977: failed reading line=20
from OCSP server
[Sat Oct 03 01:15:01.589643 2015] [ssl:error] [pid 5599] (104)Connection =

reset by peer: [client 81.223.20.5:36218] AH01977: failed reading line=20
from OCSP server
[Sat Oct 03 01:45:01.816132 2015] [ssl:error] [pid 4965] (104)Connection =

reset by peer: [client 81.223.20.5:38762] AH01977: failed reading line=20
from OCSP server
[Sat Oct 03 02:15:01.187187 2015] [ssl:error] [pid 14361]=20
(104)Connection reset by peer: [client 81.223.20.5:41043] AH01977:=20
failed reading line from OCSP server
[Sat Oct 03 02:45:01.292205 2015] [ssl:error] [pid 14366]=20
(104)Connection reset by peer: [client 81.223.20.5:42999] AH01977:=20
failed reading line from OCSP server
[Sat Oct 03 03:15:01.353077 2015] [ssl:error] [pid 14364]=20
(104)Connection reset by peer: [client 81.223.20.5:45180] AH01977:=20
failed reading line from OCSP server
[Sat Oct 03 03:45:01.428090 2015] [ssl:error] [pid 14364]=20
(104)Connection reset by peer: [client 81.223.20.5:46857] AH01977:=20
failed reading line from OCSP server
[Sat Oct 03 04:15:02.019261 2015] [ssl:error] [pid 26399]=20
(104)Connection reset by peer: [client 81.223.20.5:49007] AH01977:=20
failed reading line from OCSP server


--q2tb8hWPbAOSa4U6fxE0cxVtvHvGtxdCH
Content-Type: application/pgp-signature; name="signature.asc"
Content-Description: OpenPGP digital signature
Content-Disposition: attachment; filename="signature.asc"

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v2

iEYEARECAAYFAlYPqPgACgkQhmBjz394AnkPIgCeNAcrkexUgY9qogh3U895KWwB
qAYAnA5iio/v4PlQUc+FTGNQB+Zjf8LI
=0Pm7
-----END PGP SIGNATURE-----

--q2tb8hWPbAOSa4U6fxE0cxVtvHvGtxdCH--

From dev-return-84023-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Sat Oct  3 16:20:21 2015
Return-Path: <dev-return-84023-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 00C8117A21
	for <apmail-httpd-dev-archive@www.apache.org>; Sat,  3 Oct 2015 16:20:21 +0000 (UTC)
Received: (qmail 80020 invoked by uid 500); 3 Oct 2015 16:20:20 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 79950 invoked by uid 500); 3 Oct 2015 16:20:20 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 79938 invoked by uid 99); 3 Oct 2015 16:20:20 -0000
Received: from Unknown (HELO spamd3-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 03 Oct 2015 16:20:20 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd3-us-west.apache.org (ASF Mail Server at spamd3-us-west.apache.org) with ESMTP id 8022518098D
	for <dev@httpd.apache.org>; Sat,  3 Oct 2015 16:20:19 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd3-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.005
X-Spam-Level:
X-Spam-Status: No, score=-0.005 tagged_above=-999 required=6.31
	tests=[RP_MATCHES_RCVD=-0.006, URIBL_BLOCKED=0.001] autolearn=disabled
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd3-us-west.apache.org [10.40.0.10]) (amavisd-new, port 10024)
	with ESMTP id 4btYcnWGeesN for <dev@httpd.apache.org>;
	Sat,  3 Oct 2015 16:20:13 +0000 (UTC)
Received: from monica.sharp.fm (monica.sharp.fm [80.168.143.5])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTP id C2CD42085F
	for <dev@httpd.apache.org>; Sat,  3 Oct 2015 16:20:12 +0000 (UTC)
Received: from [192.168.220.234] (unknown [192.168.220.234])
	(using TLSv1 with cipher DHE-RSA-AES256-SHA (256/256 bits))
	(Client did not present a certificate)
	(Authenticated sender: minfrin@sharp.fm)
	by monica.sharp.fm (Postfix) with ESMTPSA id 32CB28314D
	for <dev@httpd.apache.org>; Sat,  3 Oct 2015 17:20:06 +0100 (BST)
From: Graham Leggett <minfrin@sharp.fm>
Content-Type: multipart/mixed; boundary="Apple-Mail=_3D123FDA-24B4-406C-A0EB-823CE8626494"
Message-Id: <A9BD8DA4-040E-4868-BC05-90466413CCC7@sharp.fm>
Mime-Version: 1.0 (Mac OS X Mail 8.2 \(2104\))
Subject: Re: [Patch] Async write completion for the full connection filter stack
Date: Sat, 3 Oct 2015 18:20:05 +0200
References: <A57B894B-50DA-4252-8FFF-C3DEF8473A61@sharp.fm> <D4B68B53-592F-4EEC-B39F-EFC9887F60D5@jaguNET.com> <715A3AE8-8015-4537-943F-A34E0E2A76F7@sharp.fm> <D7EA895A-9C37-4387-AE89-C1B7DF9B0706@jaguNET.com> <540DFB30.6050700@apache.org> <2F3B060C-E383-407F-A24C-7F026AD3CA81@sharp.fm> <AB1691BE05AE7F4992697F2A0835627AC5D859AB@VOEXM10W.internal.vodafone.com> <AA9FAD6C-8E83-4F5F-8F18-BC3BECF8B0A1@sharp.fm> <CAKQ1sVPFJk9-Y=JwDLvJcYT7ZCQ=xbuBRS9fu8Me_T-3f2fVXg@mail.gmail.com> <C6246136-6B10-4F7B-8261-6723ABD26817@sharp.fm> <CAKQ1sVMw0-=LsqPEkWYs1QP8daMYv=eaxhRT8gsnrppooVzuMg@mail.gmail.com> <7A74676C-AA9D-40E1-A434-9280C297217D@sharp.fm> <54128B11.9080803@apache.org> <496E8EFA-7A10-4D91-8C7E-434A9A3B09C5@sharp.fm> <541499A9.5050408@apache.org> <4D9E72F8-4918-49AD-8DC4-E3594C9ED43D@sharp.fm> <04776F50-0A53-4C1D-AA1C-9F57B60BC0AC@sharp.fm> <38C56976-E693-4EEE-88BA-85DE3328FED3@sharp.fm> <F45B55F1-2A26-4F1E-A79A-4E1CC6DB8BDC@sharp.fm>
To: dev@httpd.apache.org
In-Reply-To: <F45B55F1-2A26-4F1E-A79A-4E1CC6DB8BDC@sharp.fm>
X-Mailer: Apple Mail (2.2104)


--Apple-Mail=_3D123FDA-24B4-406C-A0EB-823CE8626494
Content-Transfer-Encoding: quoted-printable
Content-Type: text/plain;
	charset=windows-1252

On 28 Sep 2015, at 12:18 PM, Graham Leggett <minfrin@sharp.fm> wrote:

> Well, cracked the async problem for all file buckets and non-morphing =
buckets, morphing buckets will currently still be flushed.
>=20
> The solution to that seems to be to try keep a morphing bucket from =
reaching the connection filters. A morphing bucket can safely be set =
aside in a request filter without any problems with pools. If a filter =
existed at the end of the request filters that detected morphing buckets =
and read them before sending them downstream, that filter could safely =
set aside the rest of the morphing bucket without being forced to read =
the whole thing in (and thus block). If the filter received a flush the =
whole thing gets sent and we block, but that=92s what flush means so =
that=92s fine.
>=20
> Patch to follow.

Here is is.

Regards,
Graham
--

--Apple-Mail=_3D123FDA-24B4-406C-A0EB-823CE8626494
Content-Disposition: attachment;
	filename=httpd-async-fullstack-ssl7.patch
Content-Type: application/octet-stream;
	name="httpd-async-fullstack-ssl7.patch"
Content-Transfer-Encoding: 7bit

Index: include/http_core.h
===================================================================
--- include/http_core.h	(revision 1706008)
+++ include/http_core.h	(working copy)
@@ -792,6 +792,7 @@
 AP_DECLARE_DATA extern ap_filter_rec_t *ap_core_output_filter_handle;
 AP_DECLARE_DATA extern ap_filter_rec_t *ap_content_length_filter_handle;
 AP_DECLARE_DATA extern ap_filter_rec_t *ap_core_input_filter_handle;
+AP_DECLARE_DATA extern ap_filter_rec_t *ap_request_core_filter_handle;
 
 /**
  * This hook provdes a way for modules to provide metrics/statistics about
Index: include/http_request.h
===================================================================
--- include/http_request.h	(revision 1706008)
+++ include/http_request.h	(working copy)
@@ -149,6 +149,17 @@
  */
 AP_DECLARE(void) ap_destroy_sub_req(request_rec *r);
 
+/**
+ * An output filter to ensure that we avoid passing morphing buckets to
+ * connection filters and in so doing defeat async write completion. This always
+ * has to be inserted at the end of a request filter stack.
+ * @param f The current filter
+ * @param bb The brigade to filter
+ * @return status code
+ */
+AP_CORE_DECLARE_NONSTD(apr_status_t) ap_request_core_filter(ap_filter_t *f,
+                                                            apr_bucket_brigade *bb);
+
 /*
  * Then there's the case that you want some other request to be served
  * as the top-level request INSTEAD of what the client requested directly.
Index: include/httpd.h
===================================================================
--- include/httpd.h	(revision 1706008)
+++ include/httpd.h	(working copy)
@@ -55,6 +55,7 @@
 #include "apr_buckets.h"
 #include "apr_poll.h"
 #include "apr_thread_proc.h"
+#include "apr_hash.h"
 
 #include "os.h"
 
@@ -1191,6 +1192,12 @@
 
     /** Array of requests being handled under this connection. */
     apr_array_header_t *requests;
+
+    /** Empty bucket brigade */
+    apr_bucket_brigade *empty;
+
+    /** Hashtable of filters with setaside buckets for write completion */
+    apr_hash_t *filters;
 };
 
 struct conn_slave_rec {
Index: include/util_filter.h
===================================================================
--- include/util_filter.h	(revision 1706008)
+++ include/util_filter.h	(working copy)
@@ -278,6 +278,13 @@
      *  to the request_rec, except that it is used for connection filters.
      */
     conn_rec *c;
+
+    /** Buffered data associated with the current filter. */
+    apr_bucket_brigade *bb;
+
+    /** Dedicated pool to use for deferred writes. */
+    apr_pool_t *deferred_pool;
+
 };
 
 /**
@@ -519,8 +526,11 @@
  */
 
 /**
- * prepare a bucket brigade to be setaside.  If a different brigade was
+ * Prepare a bucket brigade to be setaside.  If a different brigade was
  * set-aside earlier, then the two brigades are concatenated together.
+ *
+ * If *save_to is NULL, the brigade will be created, and a cleanup registered
+ * to clear the brigade address when the pool is destroyed.
  * @param f The current filter
  * @param save_to The brigade that was previously set-aside.  Regardless, the
  *             new bucket brigade is returned in this location.
@@ -533,6 +543,52 @@
                                          apr_bucket_brigade **b, apr_pool_t *p);
 
 /**
+ * Prepare a bucket brigade to be setaside, creating a dedicated pool within
+ * the filter to handle the lifetime of the setaside brigade. If a non-empty
+ * amount of data was set aside, the counter indicating whether data exists
+ * in the output chain is incremented.
+ * @param f The current filter
+ * @param bb The bucket brigade to set aside.  This brigade is always empty
+ *          on return
+ */
+AP_DECLARE(apr_status_t) ap_filter_setaside_brigade(ap_filter_t *f,
+                                                    apr_bucket_brigade *bb);
+
+/**
+ * Reinstate a brigade setaside earlier, and calculate the amount of data we
+ * should write based on the presence of flush buckets, size limits on in
+ * memory buckets, and the number of outstanding requests in the pipeline. If
+ * data was previously set aside, the counter indicating whether data exists
+ * in the output chain is decremented.
+ *
+ * If the brigade passed in is empty, we reinstate the brigade and return
+ * immediately on the assumption that any buckets needing to be flushed were
+ * flushed before being passed to ap_filter_setaside_brigade().
+ *
+ * @param f The current filter
+ * @param bb The bucket brigade to restore to.
+ * @param flush_upto Work out the bucket we need to flush up to, based on the
+ *                   presence of a flush bucket, size limits on in-memory
+ *                   buckets, size limits on the number of requests outstanding
+ *                   in the pipeline.
+ * @return APR_SUCCESS.
+ */
+AP_DECLARE(apr_status_t) ap_filter_reinstate_brigade(ap_filter_t *f,
+                                                     apr_bucket_brigade *bb,
+                                                     apr_bucket **flush_upto);
+
+/**
+ * This function calculates whether there are any as yet unsent
+ * buffered brigades in downstream filters, and returns non zero
+ * if so.
+ *
+ * A filter can use this to determine whether the passing of data
+ * downstream might block, and so defer the passing of brigades
+ * downstream.
+ */
+AP_DECLARE(int) ap_filter_should_yield(ap_filter_t *f);
+
+/**
  * Flush function for apr_brigade_* calls.  This calls ap_pass_brigade
  * to flush the brigade if the brigade buffer overflows.
  * @param bb The brigade to flush
Index: modules/http/http_core.c
===================================================================
--- modules/http/http_core.c	(revision 1706008)
+++ modules/http/http_core.c	(working copy)
@@ -263,6 +263,8 @@
                                     NULL, r, r->connection);
         ap_add_output_filter_handle(ap_http_outerror_filter_handle,
                                     NULL, r, r->connection);
+        ap_add_output_filter_handle(ap_request_core_filter_handle,
+                                    NULL, r, r->connection);
     }
 
     return OK;
Index: modules/http/http_request.c
===================================================================
--- modules/http/http_request.c	(revision 1706008)
+++ modules/http/http_request.c	(working copy)
@@ -256,6 +256,14 @@
     apr_bucket *b;
     conn_rec *c = r->connection;
 
+    /* Find the last request, taking into account internal
+     * redirects. We want to send the EOR bucket at the end of
+     * all the buckets so it does not jump the queue.
+     */
+    while (r->next) {
+        r = r->next;
+    }
+
     /* Send an EOR bucket through the output filter chain.  When
      * this bucket is destroyed, the request will be logged and
      * its pool will be freed
@@ -264,8 +272,8 @@
     b = ap_bucket_eor_create(c->bucket_alloc, r);
     APR_BRIGADE_INSERT_HEAD(bb, b);
 
-    ap_pass_brigade(c->output_filters, bb);
-    
+    ap_pass_brigade(r->output_filters, bb);
+
     /* The EOR bucket has either been handled by an output filter (eg.
      * deleted or moved to a buffered_bb => no more in bb), or an error
      * occured before that (eg. c->aborted => still in bb) and we ought
Index: modules/ssl/ssl_engine_io.c
===================================================================
--- modules/ssl/ssl_engine_io.c	(revision 1706008)
+++ modules/ssl/ssl_engine_io.c	(working copy)
@@ -1677,6 +1677,7 @@
     ssl_filter_ctx_t *filter_ctx = f->ctx;
     bio_filter_in_ctx_t *inctx;
     bio_filter_out_ctx_t *outctx;
+    apr_bucket *flush_upto = NULL;
     apr_read_type_e rblock = APR_NONBLOCK_READ;
 
     if (f->c->aborted) {
@@ -1684,6 +1685,9 @@
         return APR_ECONNABORTED;
     }
 
+    /* Reinstate any buffered content */
+    ap_filter_reinstate_brigade(f, bb, &flush_upto);
+
     if (!filter_ctx->pssl) {
         /* ssl_filter_io_shutdown was called */
         return ap_pass_brigade(f->next, bb);
@@ -1706,6 +1710,16 @@
     while (!APR_BRIGADE_EMPTY(bb) && status == APR_SUCCESS) {
         apr_bucket *bucket = APR_BRIGADE_FIRST(bb);
 
+        /* if the core has set aside data, back off and try later */
+        if (!flush_upto) {
+            if (ap_filter_should_yield(f)) {
+                break;
+            }
+        }
+        else if (flush_upto == bucket) {
+            flush_upto = NULL;
+        }
+
         if (APR_BUCKET_IS_METADATA(bucket)) {
             /* Pass through metadata buckets untouched.  EOC is
              * special; terminate the SSL layer first. */
@@ -1757,6 +1771,10 @@
 
     }
 
+    if (APR_STATUS_IS_EOF(status) || (status == APR_SUCCESS)) {
+        return ap_filter_setaside_brigade(f, bb);
+    }
+
     return status;
 }
 
Index: server/core.c
===================================================================
--- server/core.c	(revision 1706008)
+++ server/core.c	(working copy)
@@ -112,6 +112,7 @@
 
 /* Handles for core filters */
 AP_DECLARE_DATA ap_filter_rec_t *ap_subreq_core_filter_handle;
+AP_DECLARE_DATA ap_filter_rec_t *ap_request_core_filter_handle;
 AP_DECLARE_DATA ap_filter_rec_t *ap_core_output_filter_handle;
 AP_DECLARE_DATA ap_filter_rec_t *ap_content_length_filter_handle;
 AP_DECLARE_DATA ap_filter_rec_t *ap_core_input_filter_handle;
@@ -5007,6 +5008,8 @@
 
     c->id = id;
     c->bucket_alloc = alloc;
+    c->empty = apr_brigade_create(c->pool, c->bucket_alloc);
+    c->filters = apr_hash_make(c->pool);
 
     c->clogging_input_filters = 0;
 
@@ -5395,6 +5398,9 @@
     ap_core_output_filter_handle =
         ap_register_output_filter("CORE", ap_core_output_filter,
                                   NULL, AP_FTYPE_NETWORK);
+    ap_request_core_filter_handle =
+        ap_register_output_filter("REQ_CORE", ap_request_core_filter,
+                                  NULL, AP_FTYPE_TRANSCODE);
     ap_subreq_core_filter_handle =
         ap_register_output_filter("SUBREQ_CORE", ap_sub_req_output_filter,
                                   NULL, AP_FTYPE_CONTENT_SET);
Index: server/core_filters.c
===================================================================
--- server/core_filters.c	(revision 1706008)
+++ server/core_filters.c	(working copy)
@@ -78,9 +78,7 @@
 #define APLOG_MODULE_INDEX AP_CORE_MODULE_INDEX
 
 struct core_output_filter_ctx {
-    apr_bucket_brigade *buffered_bb;
     apr_bucket_brigade *tmp_flush_bb;
-    apr_pool_t *deferred_write_pool;
     apr_size_t bytes_written;
 };
 
@@ -328,11 +326,6 @@
     return APR_SUCCESS;
 }
 
-static void setaside_remaining_output(ap_filter_t *f,
-                                      core_output_filter_ctx_t *ctx,
-                                      apr_bucket_brigade *bb,
-                                      conn_rec *c);
-
 static apr_status_t send_brigade_nonblocking(apr_socket_t *s,
                                              apr_bucket_brigade *bb,
                                              apr_size_t *bytes_written,
@@ -358,33 +351,23 @@
                                          conn_rec *c);
 #endif
 
-/* XXX: Should these be configurable parameters? */
-#define THRESHOLD_MIN_WRITE 4096
-#define THRESHOLD_MAX_BUFFER 65536
-#define MAX_REQUESTS_IN_PIPELINE 5
-
 /* Optional function coming from mod_logio, used for logging of output
  * traffic
  */
 extern APR_OPTIONAL_FN_TYPE(ap_logio_add_bytes_out) *ap__logio_add_bytes_out;
 
-apr_status_t ap_core_output_filter(ap_filter_t *f, apr_bucket_brigade *new_bb)
+apr_status_t ap_core_output_filter(ap_filter_t *f, apr_bucket_brigade *bb)
 {
     conn_rec *c = f->c;
     core_net_rec *net = f->ctx;
     core_output_filter_ctx_t *ctx = net->out_ctx;
-    apr_bucket_brigade *bb = NULL;
-    apr_bucket *bucket, *next, *flush_upto = NULL;
-    apr_size_t bytes_in_brigade, non_file_bytes_in_brigade;
-    int eor_buckets_in_brigade, morphing_bucket_in_brigade;
+    apr_bucket *flush_upto = NULL;
     apr_status_t rv;
     int loglevel = ap_get_conn_module_loglevel(c, APLOG_MODULE_INDEX);
 
     /* Fail quickly if the connection has already been aborted. */
     if (c->aborted) {
-        if (new_bb != NULL) {
-            apr_brigade_cleanup(new_bb);
-        }
+        apr_brigade_cleanup(bb);
         return APR_ECONNABORTED;
     }
 
@@ -397,33 +380,14 @@
          * allocated from bb->pool which might be wrong.
          */
         ctx->tmp_flush_bb = apr_brigade_create(c->pool, c->bucket_alloc);
-        /* same for buffered_bb and ap_save_brigade */
-        ctx->buffered_bb = apr_brigade_create(c->pool, c->bucket_alloc);
     }
 
-    if (new_bb != NULL)
-        bb = new_bb;
-
-    if ((ctx->buffered_bb != NULL) &&
-        !APR_BRIGADE_EMPTY(ctx->buffered_bb)) {
-        if (new_bb != NULL) {
-            APR_BRIGADE_PREPEND(bb, ctx->buffered_bb);
-        }
-        else {
-            bb = ctx->buffered_bb;
-        }
-        c->data_in_output_filters = 0;
-    }
-    else if (new_bb == NULL) {
-        return APR_SUCCESS;
-    }
-
     /* Scan through the brigade and decide whether to attempt a write,
      * and how much to write, based on the following rules:
      *
-     *  1) The new_bb is null: Do a nonblocking write of as much as
+     *  1) The bb is empty: Do a nonblocking write of as much as
      *     possible: do a nonblocking write of as much data as possible,
-     *     then save the rest in ctx->buffered_bb.  (If new_bb == NULL,
+     *     then save the rest in ctx->buffered_bb.  (If bb is empty,
      *     it probably means that the MPM is doing asynchronous write
      *     completion and has just determined that this connection
      *     is writable.)
@@ -459,93 +423,14 @@
      *  3) Actually do the blocking write up to the last bucket determined
      *     by rules 2a-d. The point of doing only one flush is to make as
      *     few calls to writev() as possible.
-     *
-     *  4) If the brigade contains at least THRESHOLD_MIN_WRITE
-     *     bytes: Do a nonblocking write of as much data as possible,
-     *     then save the rest in ctx->buffered_bb.
      */
 
-    if (new_bb == NULL) {
-        rv = send_brigade_nonblocking(net->client_socket, bb,
-                                      &(ctx->bytes_written), c);
-        if (rv != APR_SUCCESS && !APR_STATUS_IS_EAGAIN(rv)) {
-            /* The client has aborted the connection */
-            ap_log_cerror(APLOG_MARK, APLOG_TRACE1, rv, c,
-                          "core_output_filter: writing data to the network");
-            apr_brigade_cleanup(bb);
-            c->aborted = 1;
-            return rv;
-        }
-        setaside_remaining_output(f, ctx, bb, c);
+    ap_filter_reinstate_brigade(f, bb, &flush_upto);
+
+    if (APR_BRIGADE_EMPTY(bb)) {
         return APR_SUCCESS;
     }
 
-    bytes_in_brigade = 0;
-    non_file_bytes_in_brigade = 0;
-    eor_buckets_in_brigade = 0;
-    morphing_bucket_in_brigade = 0;
-
-    for (bucket = APR_BRIGADE_FIRST(bb); bucket != APR_BRIGADE_SENTINEL(bb);
-         bucket = next) {
-        next = APR_BUCKET_NEXT(bucket);
-
-        if (!APR_BUCKET_IS_METADATA(bucket)) {
-            if (bucket->length == (apr_size_t)-1) {
-                /*
-                 * A setaside of morphing buckets would read everything into
-                 * memory. Instead, we will flush everything up to and
-                 * including this bucket.
-                 */
-                morphing_bucket_in_brigade = 1;
-            }
-            else {
-                bytes_in_brigade += bucket->length;
-                if (!APR_BUCKET_IS_FILE(bucket))
-                    non_file_bytes_in_brigade += bucket->length;
-            }
-        }
-        else if (AP_BUCKET_IS_EOR(bucket)) {
-            eor_buckets_in_brigade++;
-        }
-
-        if (APR_BUCKET_IS_FLUSH(bucket)
-            || non_file_bytes_in_brigade >= THRESHOLD_MAX_BUFFER
-            || morphing_bucket_in_brigade
-            || eor_buckets_in_brigade > MAX_REQUESTS_IN_PIPELINE) {
-            /* this segment of the brigade MUST be sent before returning. */
-
-            if (loglevel >= APLOG_TRACE6) {
-                char *reason = APR_BUCKET_IS_FLUSH(bucket) ?
-                               "FLUSH bucket" :
-                               (non_file_bytes_in_brigade >= THRESHOLD_MAX_BUFFER) ?
-                               "THRESHOLD_MAX_BUFFER" :
-                               morphing_bucket_in_brigade ? "morphing bucket" :
-                               "MAX_REQUESTS_IN_PIPELINE";
-                ap_log_cerror(APLOG_MARK, APLOG_TRACE6, 0, c,
-                              "will flush because of %s", reason);
-                ap_log_cerror(APLOG_MARK, APLOG_TRACE8, 0, c,
-                              "seen in brigade%s: bytes: %" APR_SIZE_T_FMT
-                              ", non-file bytes: %" APR_SIZE_T_FMT ", eor "
-                              "buckets: %d, morphing buckets: %d",
-                              flush_upto == NULL ? " so far"
-                                                 : " since last flush point",
-                              bytes_in_brigade,
-                              non_file_bytes_in_brigade,
-                              eor_buckets_in_brigade,
-                              morphing_bucket_in_brigade);
-            }
-            /*
-             * Defer the actual blocking write to avoid doing many writes.
-             */
-            flush_upto = next;
-
-            bytes_in_brigade = 0;
-            non_file_bytes_in_brigade = 0;
-            eor_buckets_in_brigade = 0;
-            morphing_bucket_in_brigade = 0;
-        }
-    }
-
     if (flush_upto != NULL) {
         ctx->tmp_flush_bb = apr_brigade_split_ex(bb, flush_upto,
                                                  ctx->tmp_flush_bb);
@@ -571,71 +456,30 @@
         APR_BRIGADE_CONCAT(bb, ctx->tmp_flush_bb);
     }
 
+    rv = send_brigade_nonblocking(net->client_socket, bb, &(ctx->bytes_written),
+            c);
+    if ((rv != APR_SUCCESS) && (!APR_STATUS_IS_EAGAIN(rv))) {
+        /* The client has aborted the connection */
+        ap_log_cerror(
+                APLOG_MARK, APLOG_TRACE1, rv, c,
+                "core_output_filter: writing data to the network");
+        apr_brigade_cleanup(bb);
+        c->aborted = 1;
+        return rv;
+    }
     if (loglevel >= APLOG_TRACE8) {
-        ap_log_cerror(APLOG_MARK, APLOG_TRACE8, 0, c,
-                      "brigade contains: bytes: %" APR_SIZE_T_FMT
-                      ", non-file bytes: %" APR_SIZE_T_FMT
-                      ", eor buckets: %d, morphing buckets: %d",
-                      bytes_in_brigade, non_file_bytes_in_brigade,
-                      eor_buckets_in_brigade, morphing_bucket_in_brigade);
+        ap_log_cerror(
+                APLOG_MARK, APLOG_TRACE8, 0, c,
+                "tried nonblocking write, total bytes "
+                "written: %" APR_SIZE_T_FMT, ctx->bytes_written);
     }
 
-    if (bytes_in_brigade >= THRESHOLD_MIN_WRITE) {
-        rv = send_brigade_nonblocking(net->client_socket, bb,
-                                      &(ctx->bytes_written), c);
-        if ((rv != APR_SUCCESS) && (!APR_STATUS_IS_EAGAIN(rv))) {
-            /* The client has aborted the connection */
-            ap_log_cerror(APLOG_MARK, APLOG_TRACE1, rv, c,
-                          "core_output_filter: writing data to the network");
-            apr_brigade_cleanup(bb);
-            c->aborted = 1;
-            return rv;
-        }
-        if (loglevel >= APLOG_TRACE8) {
-                ap_log_cerror(APLOG_MARK, APLOG_TRACE8, 0, c,
-                              "tried nonblocking write, total bytes "
-                              "written: %" APR_SIZE_T_FMT,
-                              ctx->bytes_written);
-        }
-    }
+    remove_empty_buckets(bb);
+    ap_filter_setaside_brigade(f, bb);
 
-    setaside_remaining_output(f, ctx, bb, c);
     return APR_SUCCESS;
 }
 
-/*
- * This function assumes that either ctx->buffered_bb == NULL, or
- * ctx->buffered_bb is empty, or ctx->buffered_bb == bb
- */
-static void setaside_remaining_output(ap_filter_t *f,
-                                      core_output_filter_ctx_t *ctx,
-                                      apr_bucket_brigade *bb,
-                                      conn_rec *c)
-{
-    if (bb == NULL) {
-        return;
-    }
-    remove_empty_buckets(bb);
-    if (!APR_BRIGADE_EMPTY(bb)) {
-        c->data_in_output_filters = 1;
-        if (bb != ctx->buffered_bb) {
-            if (!ctx->deferred_write_pool) {
-                apr_pool_create(&ctx->deferred_write_pool, c->pool);
-                apr_pool_tag(ctx->deferred_write_pool, "deferred_write");
-            }
-            ap_save_brigade(f, &(ctx->buffered_bb), &bb,
-                            ctx->deferred_write_pool);
-        }
-    }
-    else if (ctx->deferred_write_pool) {
-        /*
-         * There are no more requests in the pipeline. We can just clear the
-         * pool.
-         */
-        apr_pool_clear(ctx->deferred_write_pool);
-    }
-}
-
 #ifndef APR_MAX_IOVEC_SIZE
 #define MAX_IOVEC_TO_WRITE 16
 #else
Index: server/mpm/event/event.c
===================================================================
--- server/mpm/event/event.c	(revision 1706008)
+++ server/mpm/event/event.c	(working copy)
@@ -1147,19 +1147,38 @@
     }
 
     if (cs->pub.state == CONN_STATE_WRITE_COMPLETION) {
-        ap_filter_t *output_filter = c->output_filters;
-        apr_status_t rv;
+        apr_hash_index_t *rindex;
+        apr_status_t rv = APR_SUCCESS;
+        int data_in_output_filters = 0;
         ap_update_child_status_from_conn(sbh, SERVER_BUSY_WRITE, c);
-        while (output_filter->next != NULL) {
-            output_filter = output_filter->next;
+
+        rindex = apr_hash_first(NULL, c->filters);
+        while (rindex) {
+            ap_filter_t *f = apr_hash_this_val(rindex);
+
+            if (!APR_BRIGADE_EMPTY(f->bb)) {
+
+                rv = ap_pass_brigade(f, c->empty);
+                apr_brigade_cleanup(c->empty);
+                if (APR_SUCCESS != rv) {
+                    ap_log_cerror(
+                            APLOG_MARK, APLOG_DEBUG, rv, c, APLOGNO(00470)
+                            "write failure in '%s' output filter", f->frec->name);
+                    break;
+                }
+
+                if (ap_filter_should_yield(f)) {
+                    data_in_output_filters = 1;
+                }
+            }
+
+            rindex = apr_hash_next(rindex);
         }
-        rv = output_filter->frec->filter_func.out_func(output_filter, NULL);
+
         if (rv != APR_SUCCESS) {
-            ap_log_cerror(APLOG_MARK, APLOG_DEBUG, rv, c, APLOGNO(00470)
-                          "network write failure in core output filter");
             cs->pub.state = CONN_STATE_LINGER;
         }
-        else if (c->data_in_output_filters) {
+        else if (data_in_output_filters) {
             /* Still in WRITE_COMPLETION_STATE:
              * Set a write timeout for this connection, and let the
              * event thread poll for writeability.
Index: server/mpm/motorz/motorz.c
===================================================================
--- server/mpm/motorz/motorz.c	(revision 1706008)
+++ server/mpm/motorz/motorz.c	(working copy)
@@ -364,21 +364,38 @@
         }
 
         if (scon->cs.state == CONN_STATE_WRITE_COMPLETION) {
-            ap_filter_t *output_filter = c->output_filters;
-            ap_update_child_status_from_conn(scon->sbh, SERVER_BUSY_WRITE, c);
-            while (output_filter->next != NULL) {
-                output_filter = output_filter->next;
+            apr_hash_index_t *rindex;
+            apr_status_t rv = APR_SUCCESS;
+            int data_in_output_filters = 0;
+            ap_update_child_status_from_conn(sbh, SERVER_BUSY_WRITE, c);
+
+            rindex = apr_hash_first(NULL, c->filters);
+            while (rindex) {
+                ap_filter_t *f = apr_hash_this_val(rindex);
+
+                if (!APR_BRIGADE_EMPTY(f->bb)) {
+
+                    rv = ap_pass_brigade(f, c->empty);
+                    apr_brigade_cleanup(c->empty);
+                    if (APR_SUCCESS != rv) {
+                        ap_log_cerror(
+                                APLOG_MARK, APLOG_DEBUG, rv, c, APLOGNO(02848)
+                                "write failure in '%s' output filter", f->frec->name);
+                        break;
+                    }
+
+                    if (ap_filter_should_yield(f)) {
+                        data_in_output_filters = 1;
+                    }
+                }
+
+                rindex = apr_hash_next(rindex);
             }
 
-            rv = output_filter->frec->filter_func.out_func(output_filter,
-                                                           NULL);
-
             if (rv != APR_SUCCESS) {
-                ap_log_error(APLOG_MARK, APLOG_WARNING, rv, ap_server_conf, APLOGNO(02848)
-                             "network write failure in core output filter");
                 scon->cs.state = CONN_STATE_LINGER;
             }
-            else if (c->data_in_output_filters) {
+            else if (data_in_output_filters) {
                 /* Still in WRITE_COMPLETION_STATE:
                  * Set a write timeout for this connection, and let the
                  * event thread poll for writeability.
Index: server/mpm/simple/simple_io.c
===================================================================
--- server/mpm/simple/simple_io.c	(revision 1706008)
+++ server/mpm/simple/simple_io.c	(working copy)
@@ -92,20 +92,37 @@
         }
 
         if (scon->cs.state == CONN_STATE_WRITE_COMPLETION) {
-            ap_filter_t *output_filter = c->output_filters;
-            while (output_filter->next != NULL) {
-                output_filter = output_filter->next;
+            apr_hash_index_t *rindex;
+            apr_status_t rv = APR_SUCCESS;
+            int data_in_output_filters = 0;
+
+            rindex = apr_hash_first(NULL, c->filters);
+            while (rindex) {
+                ap_filter_t *f = apr_hash_this_val(rindex);
+
+                if (!APR_BRIGADE_EMPTY(f->bb)) {
+
+                    rv = ap_pass_brigade(f, c->empty);
+                    apr_brigade_cleanup(c->empty);
+                    if (APR_SUCCESS != rv) {
+                        ap_log_cerror(
+                                APLOG_MARK, APLOG_DEBUG, rv, c, APLOGNO(00249)
+                                "write failure in '%s' output filter", f->frec->name);
+                        break;
+                    }
+
+                    if (ap_filter_should_yield(f)) {
+                        data_in_output_filters = 1;
+                    }
+                }
+
+                rindex = apr_hash_next(rindex);
             }
 
-            rv = output_filter->frec->filter_func.out_func(output_filter,
-                                                           NULL);
-
             if (rv != APR_SUCCESS) {
-                ap_log_error(APLOG_MARK, APLOG_WARNING, rv, ap_server_conf, APLOGNO(00249)
-                             "network write failure in core output filter");
                 scon->cs.state = CONN_STATE_LINGER;
             }
-            else if (c->data_in_output_filters) {
+            else if (data_in_output_filters) {
                 /* Still in WRITE_COMPLETION_STATE:
                  * Set a write timeout for this connection, and let the
                  * event thread poll for writeability.
Index: server/request.c
===================================================================
--- server/request.c	(revision 1706008)
+++ server/request.c	(working copy)
@@ -2036,6 +2036,64 @@
     return APR_SUCCESS;
 }
 
+AP_CORE_DECLARE_NONSTD(apr_status_t) ap_request_core_filter(ap_filter_t *f,
+                                                            apr_bucket_brigade *bb)
+{
+    apr_bucket *flush_upto = NULL;
+    apr_status_t status = APR_SUCCESS;
+    apr_bucket_brigade *tmp_bb = f->ctx;
+
+    if (!tmp_bb) {
+        tmp_bb = f->ctx = apr_brigade_create(f->r->pool, f->c->bucket_alloc);
+    }
+
+    /* Reinstate any buffered content */
+    ap_filter_reinstate_brigade(f, bb, &flush_upto);
+
+    while (!APR_BRIGADE_EMPTY(bb)) {
+        apr_bucket *bucket = APR_BRIGADE_FIRST(bb);
+
+        /* if the core has set aside data, back off and try later */
+        if (!flush_upto) {
+            if (ap_filter_should_yield(f)) {
+                break;
+            }
+        }
+        else if (flush_upto == bucket) {
+            flush_upto = NULL;
+        }
+
+        /* have we found a morphing bucket? if so, force it to morph into something
+         * safe to pass down to the connection filters without needing to be set
+         * aside.
+         */
+        if (!APR_BUCKET_IS_METADATA(bucket)) {
+            if (bucket->length == (apr_size_t) - 1) {
+                const char *data;
+                apr_size_t size;
+                if (APR_SUCCESS
+                        != (status = apr_bucket_read(bucket, &data, &size,
+                                APR_BLOCK_READ))) {
+                    return status;
+                }
+            }
+        }
+
+        /* pass each bucket down the chain */
+        APR_BUCKET_REMOVE(bucket);
+        APR_BRIGADE_INSERT_TAIL(tmp_bb, bucket);
+
+        status = ap_pass_brigade(f->next, tmp_bb);
+        if (!APR_STATUS_IS_EOF(status) && (status != APR_SUCCESS)) {
+            return status;
+        }
+
+    }
+
+    ap_filter_setaside_brigade(f, bb);
+    return status;
+}
+
 extern APR_OPTIONAL_FN_TYPE(authz_some_auth_required) *ap__authz_ap_some_auth_required;
 
 AP_DECLARE(int) ap_some_auth_required(request_rec *r)
Index: server/util_filter.c
===================================================================
--- server/util_filter.c	(revision 1706008)
+++ server/util_filter.c	(working copy)
@@ -24,6 +24,7 @@
 #include "http_config.h"
 #include "http_core.h"
 #include "http_log.h"
+#include "http_request.h"
 #include "util_filter.h"
 
 /* NOTE: Apache's current design doesn't allow a pool to be passed thru,
@@ -32,6 +33,10 @@
 #define FILTER_POOL     apr_hook_global_pool
 #include "ap_hooks.h"   /* for apr_hook_global_pool */
 
+/* XXX: Should these be configurable parameters? */
+#define THRESHOLD_MAX_BUFFER 65536
+#define MAX_REQUESTS_IN_PIPELINE 5
+
 /*
 ** This macro returns true/false if a given filter should be inserted BEFORE
 ** another filter. This will happen when one of: 1) there isn't another
@@ -319,6 +324,8 @@
     f->r = frec->ftype < AP_FTYPE_CONNECTION ? r : NULL;
     f->c = c;
     f->next = NULL;
+    f->bb = NULL;
+    f->deferred_pool = NULL;
 
     if (INSERT_BEFORE(f, *outf)) {
         f->next = *outf;
@@ -474,6 +481,16 @@
 
 AP_DECLARE(void) ap_remove_output_filter(ap_filter_t *f)
 {
+
+    if ((f->bb) && !APR_BRIGADE_EMPTY(f->bb)) {
+        apr_brigade_cleanup(f->bb);
+    }
+
+    if (f->deferred_pool) {
+        apr_pool_destroy(f->deferred_pool);
+        f->deferred_pool = NULL;
+    }
+
     remove_any_filter(f, f->r ? &f->r->output_filters : NULL,
                       f->r ? &f->r->proto_output_filters : NULL,
                       &f->c->output_filters);
@@ -566,6 +583,7 @@
 {
     if (next) {
         apr_bucket *e;
+
         if ((e = APR_BRIGADE_LAST(bb)) && APR_BUCKET_IS_EOS(e) && next->r) {
             /* This is only safe because HTTP_HEADER filter is always in
              * the filter stack.   This ensures that there is ALWAYS a
@@ -635,7 +653,8 @@
     apr_status_t rv, srv = APR_SUCCESS;
 
     /* If have never stored any data in the filter, then we had better
-     * create an empty bucket brigade so that we can concat.
+     * create an empty bucket brigade so that we can concat. Register
+     * a cleanup to zero out the pointer if the pool is cleared.
      */
     if (!(*saveto)) {
         *saveto = apr_brigade_create(p, f->c->bucket_alloc);
@@ -673,6 +692,248 @@
     return srv;
 }
 
+static apr_status_t filters_cleanup(void *data)
+{
+    ap_filter_t **key = data;
+
+    apr_hash_set((*key)->c->filters, key, sizeof(ap_filter_t **), NULL);
+
+    return APR_SUCCESS;
+}
+
+AP_DECLARE(apr_status_t) ap_filter_setaside_brigade(ap_filter_t *f,
+        apr_bucket_brigade *bb)
+{
+    int loglevel = ap_get_conn_module_loglevel(f->c, APLOG_MODULE_INDEX);
+
+    if (loglevel >= APLOG_TRACE6) {
+        ap_log_cerror(
+            APLOG_MARK, APLOG_TRACE6, 0, f->c,
+            "setaside %s brigade to %s brigade in '%s' output filter",
+            (APR_BRIGADE_EMPTY(bb) ? "empty" : "full"),
+            (!f->bb || APR_BRIGADE_EMPTY(f->bb) ? "empty" : "full"), f->frec->name);
+    }
+
+    if (!APR_BRIGADE_EMPTY(bb)) {
+        apr_pool_t *pool;
+        /*
+         * Set aside the brigade bb within f->bb.
+         */
+        if (!f->bb) {
+            ap_filter_t **key;
+
+            pool = f->r ? f->r->pool : f->c->pool;
+
+            key = apr_palloc(pool, sizeof(ap_filter_t **));
+            *key = f;
+            apr_hash_set(f->c->filters, key, sizeof(ap_filter_t **), f);
+
+            f->bb = apr_brigade_create(pool, f->c->bucket_alloc);
+
+            apr_pool_pre_cleanup_register(pool, key, filters_cleanup);
+
+        }
+
+        /* decide what pool we setaside to, request pool or deferred pool? */
+        if (f->r) {
+            pool = f->r->pool;
+            APR_BRIGADE_CONCAT(f->bb, bb);
+        }
+        else {
+            if (!f->deferred_pool) {
+                apr_pool_create(&f->deferred_pool, f->c->pool);
+                apr_pool_tag(f->deferred_pool, "deferred_pool");
+            }
+            pool = f->deferred_pool;
+            return ap_save_brigade(f, &f->bb, &bb, pool);
+        }
+
+    }
+    else if (f->deferred_pool) {
+        /*
+         * There are no more requests in the pipeline. We can just clear the
+         * pool.
+         */
+        apr_brigade_cleanup(f->bb);
+        apr_pool_clear(f->deferred_pool);
+    }
+    return APR_SUCCESS;
+}
+
+AP_DECLARE(apr_status_t) ap_filter_reinstate_brigade(ap_filter_t *f,
+                                                     apr_bucket_brigade *bb,
+                                                     apr_bucket **flush_upto)
+{
+    apr_bucket *bucket, *next;
+    apr_size_t bytes_in_brigade, non_file_bytes_in_brigade;
+    int eor_buckets_in_brigade, morphing_bucket_in_brigade;
+    int loglevel = ap_get_conn_module_loglevel(f->c, APLOG_MODULE_INDEX);
+
+    if (loglevel >= APLOG_TRACE6) {
+        ap_log_cerror(
+            APLOG_MARK, APLOG_TRACE6, 0, f->c,
+            "reinstate %s brigade to %s brigade in '%s' output filter",
+            (!f->bb || APR_BRIGADE_EMPTY(f->bb) ? "empty" : "full"),
+            (APR_BRIGADE_EMPTY(bb) ? "empty" : "full"), f->frec->name);
+    }
+
+    if (f->bb && !APR_BRIGADE_EMPTY(f->bb)) {
+        APR_BRIGADE_PREPEND(bb, f->bb);
+    }
+
+    /*
+     * Determine if and up to which bucket we need to do a blocking write:
+     *
+     *  a) The brigade contains a flush bucket: Do a blocking write
+     *     of everything up that point.
+     *
+     *  b) The request is in CONN_STATE_HANDLER state, and the brigade
+     *     contains at least THRESHOLD_MAX_BUFFER bytes in non-file
+     *     buckets: Do blocking writes until the amount of data in the
+     *     buffer is less than THRESHOLD_MAX_BUFFER.  (The point of this
+     *     rule is to provide flow control, in case a handler is
+     *     streaming out lots of data faster than the data can be
+     *     sent to the client.)
+     *
+     *  c) The request is in CONN_STATE_HANDLER state, and the brigade
+     *     contains at least MAX_REQUESTS_IN_PIPELINE EOR buckets:
+     *     Do blocking writes until less than MAX_REQUESTS_IN_PIPELINE EOR
+     *     buckets are left. (The point of this rule is to prevent too many
+     *     FDs being kept open by pipelined requests, possibly allowing a
+     *     DoS).
+     *
+     *  d) The request is being served by a connection filter and the
+     *     brigade contains a morphing bucket: If there was no other
+     *     reason to do a blocking write yet, try reading the bucket. If its
+     *     contents fit into memory before THRESHOLD_MAX_BUFFER is reached,
+     *     everything is fine. Otherwise we need to do a blocking write the
+     *     up to and including the morphing bucket, because ap_save_brigade()
+     *     would read the whole bucket into memory later on.
+     */
+
+    *flush_upto = NULL;
+
+    bytes_in_brigade = 0;
+    non_file_bytes_in_brigade = 0;
+    eor_buckets_in_brigade = 0;
+    morphing_bucket_in_brigade = 0;
+
+    for (bucket = APR_BRIGADE_FIRST(bb); bucket != APR_BRIGADE_SENTINEL(bb);
+         bucket = next) {
+        next = APR_BUCKET_NEXT(bucket);
+
+        if (!APR_BUCKET_IS_METADATA(bucket)) {
+            if (bucket->length == (apr_size_t)-1) {
+                /*
+                 * A setaside of morphing buckets would read everything into
+                 * memory. Instead, we will flush everything up to and
+                 * including this bucket.
+                 */
+                morphing_bucket_in_brigade = 1;
+            }
+            else {
+                bytes_in_brigade += bucket->length;
+                if (!APR_BUCKET_IS_FILE(bucket))
+                    non_file_bytes_in_brigade += bucket->length;
+            }
+        }
+        else if (AP_BUCKET_IS_EOR(bucket)) {
+            eor_buckets_in_brigade++;
+        }
+
+        if (APR_BUCKET_IS_FLUSH(bucket)
+            || non_file_bytes_in_brigade >= THRESHOLD_MAX_BUFFER
+            || (!f->r && morphing_bucket_in_brigade)
+            || eor_buckets_in_brigade > MAX_REQUESTS_IN_PIPELINE) {
+            /* this segment of the brigade MUST be sent before returning. */
+
+            if (loglevel >= APLOG_TRACE6) {
+                char *reason = APR_BUCKET_IS_FLUSH(bucket) ?
+                               "FLUSH bucket" :
+                               (non_file_bytes_in_brigade >= THRESHOLD_MAX_BUFFER) ?
+                               "THRESHOLD_MAX_BUFFER" :
+                               (!f->r && morphing_bucket_in_brigade) ? "morphing bucket" :
+                               "MAX_REQUESTS_IN_PIPELINE";
+                ap_log_cerror(APLOG_MARK, APLOG_TRACE6, 0, f->c,
+                              "will flush because of %s", reason);
+                ap_log_cerror(APLOG_MARK, APLOG_TRACE8, 0, f->c,
+                              "seen in brigade%s: bytes: %" APR_SIZE_T_FMT
+                              ", non-file bytes: %" APR_SIZE_T_FMT ", eor "
+                              "buckets: %d, morphing buckets: %d",
+                              flush_upto == NULL ? " so far"
+                                                 : " since last flush point",
+                              bytes_in_brigade,
+                              non_file_bytes_in_brigade,
+                              eor_buckets_in_brigade,
+                              morphing_bucket_in_brigade);
+            }
+            /*
+             * Defer the actual blocking write to avoid doing many writes.
+             */
+            *flush_upto = next;
+
+            bytes_in_brigade = 0;
+            non_file_bytes_in_brigade = 0;
+            eor_buckets_in_brigade = 0;
+            morphing_bucket_in_brigade = 0;
+        }
+    }
+
+    if (loglevel >= APLOG_TRACE8) {
+        ap_log_cerror(APLOG_MARK, APLOG_TRACE8, 0, f->c,
+                      "brigade contains: bytes: %" APR_SIZE_T_FMT
+                      ", non-file bytes: %" APR_SIZE_T_FMT
+                      ", eor buckets: %d, morphing buckets: %d",
+                      bytes_in_brigade, non_file_bytes_in_brigade,
+                      eor_buckets_in_brigade, morphing_bucket_in_brigade);
+    }
+
+    return APR_SUCCESS;
+}
+
+AP_DECLARE(int) ap_filter_should_yield(ap_filter_t *f)
+{
+    /*
+     * This function decides whether a filter should yield due to buffered
+     * data in a downstream filter. If a downstream filter buffers we
+     * must back off so we don't overwhelm the server. If this function
+     * returns true, the filter should call ap_filter_setaside_brigade()
+     * to save unprocessed buckets, and then reinstate those buckets on
+     * the next call with ap_filter_reinstate_brigade() and continue
+     * where it left off.
+     *
+     * If this function is forced to return zero, we return back to
+     * synchronous filter behaviour.
+     *
+     * Subrequests present us with a problem - we don't know how much data
+     * they will produce and therefore how much buffering we'll need, and
+     * if a subrequest had to trigger buffering, but next subrequest wouldn't
+     * know when the previous one had finished sending data and buckets
+     * could be sent out of order.
+     *
+     * In the case of subrequests, deny the ability to yield. When the data
+     * reaches the filters from the main request, they will be setaside
+     * there in the right order and the request will be given the
+     * opportunity to yield.
+     */
+    if (f->r && f->r->main) {
+        return 0;
+    }
+
+    /*
+     * This is either a main request or internal redirect, or it is a
+     * connection filter. Yield if there is any buffered data downstream
+     * from us.
+     */
+    while (f) {
+        if (f->bb && !APR_BRIGADE_EMPTY(f->bb)) {
+            return 1;
+        }
+        f = f->next;
+    }
+    return 0;
+}
+
 AP_DECLARE_NONSTD(apr_status_t) ap_filter_flush(apr_bucket_brigade *bb,
                                                 void *ctx)
 {

--Apple-Mail=_3D123FDA-24B4-406C-A0EB-823CE8626494
Content-Transfer-Encoding: 7bit
Content-Type: text/plain;
	charset=windows-1252




--Apple-Mail=_3D123FDA-24B4-406C-A0EB-823CE8626494--


From dev-return-84024-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Sat Oct  3 19:10:39 2015
Return-Path: <dev-return-84024-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 64FCE17D27
	for <apmail-httpd-dev-archive@www.apache.org>; Sat,  3 Oct 2015 19:10:39 +0000 (UTC)
Received: (qmail 3892 invoked by uid 500); 3 Oct 2015 19:10:34 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 3811 invoked by uid 500); 3 Oct 2015 19:10:33 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 3801 invoked by uid 99); 3 Oct 2015 19:10:33 -0000
Received: from Unknown (HELO spamd1-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 03 Oct 2015 19:10:33 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd1-us-west.apache.org (ASF Mail Server at spamd1-us-west.apache.org) with ESMTP id 70B64C2035
	for <dev@httpd.apache.org>; Sat,  3 Oct 2015 19:10:28 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd1-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.011
X-Spam-Level:
X-Spam-Status: No, score=-0.011 tagged_above=-999 required=6.31
	tests=[SPF_PASS=-0.001, T_RP_MATCHES_RCVD=-0.01] autolearn=disabled
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd1-us-west.apache.org [10.40.0.7]) (amavisd-new, port 10024)
	with ESMTP id 30cpiFYoDENv for <dev@httpd.apache.org>;
	Sat,  3 Oct 2015 19:10:27 +0000 (UTC)
Received: from monica.sharp.fm (monica.sharp.fm [80.168.143.5])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTP id 04236204DF
	for <dev@httpd.apache.org>; Sat,  3 Oct 2015 19:10:27 +0000 (UTC)
Received: from [192.168.220.234] (unknown [192.168.220.234])
	(using TLSv1 with cipher DHE-RSA-AES256-SHA (256/256 bits))
	(Client did not present a certificate)
	(Authenticated sender: minfrin@sharp.fm)
	by monica.sharp.fm (Postfix) with ESMTPSA id 9CB0D83138
	for <dev@httpd.apache.org>; Sat,  3 Oct 2015 20:10:26 +0100 (BST)
Content-Type: text/plain; charset=utf-8
Mime-Version: 1.0 (Mac OS X Mail 8.2 \(2104\))
Subject: Re: svn commit: r1706275 - /httpd/httpd/trunk/modules/ssl/ssl_engine_io.c
From: Graham Leggett <minfrin@sharp.fm>
In-Reply-To: <560D79EF.80201@apache.org>
Date: Sat, 3 Oct 2015 21:10:25 +0200
Content-Transfer-Encoding: quoted-printable
Message-Id: <599EAFD6-AFFA-4623-A02A-83E88DAD4744@sharp.fm>
References: <20151001154324.0CBD73A01DC@svn01-us-west.apache.org> <34694C4B-0561-441D-B7DC-6321A1ECE7E5@sharp.fm> <560D79EF.80201@apache.org>
To: dev@httpd.apache.org
X-Mailer: Apple Mail (2.2104)

On 01 Oct 2015, at 8:22 PM, Ruediger Pluem <rpluem@apache.org> wrote:

> The issue is that openssl during the connect handshake to a clieent =
does not tell httpd to flush. Hence the CLIENT_HELLO
> remains in the core output filter buffer and openssl waits for the =
SERVER_HELLO from the remote server which of course
> does not happen without the CLIENT_HELLO having been sent there.
>=20
> The whole game of reading and writing during the handshake happens =
inside openssl while SSL_connect is running.
> Apache code only gets back into this via bio_filter_out_write and =
bio_filter_in_read.

While working on the async write completion patch I was having all sorts =
of headaches with incomplete requests, and eventually reached the point =
where I removed THRESHOLD_MIN_WRITE completely and suddenly sanity =
returned across the board.

In the async code there is no way to assume you can not-write when =
you=E2=80=99ve been asked to write, because there is no way to tell =
whether more data is coming after this data. If you skip the write in =
the hope that more data comes but no data does come, you hang.

I get that THRESHOLD_MIN_WRITE was trying to prevent the sending of =
small packets, but really that should be solved by the filters =
themselves.

Regards,
Graham
=E2=80=94


From dev-return-84025-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Sat Oct  3 19:44:07 2015
Return-Path: <dev-return-84025-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 453F617D74
	for <apmail-httpd-dev-archive@www.apache.org>; Sat,  3 Oct 2015 19:44:07 +0000 (UTC)
Received: (qmail 20386 invoked by uid 500); 3 Oct 2015 19:44:06 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 20316 invoked by uid 500); 3 Oct 2015 19:44:06 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 20306 invoked by uid 99); 3 Oct 2015 19:44:06 -0000
Received: from Unknown (HELO spamd1-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 03 Oct 2015 19:44:06 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd1-us-west.apache.org (ASF Mail Server at spamd1-us-west.apache.org) with ESMTP id 5DA22C2036
	for <dev@httpd.apache.org>; Sat,  3 Oct 2015 19:44:06 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd1-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.12
X-Spam-Level:
X-Spam-Status: No, score=-0.12 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RCVD_IN_MSPIKE_H3=-0.01, RCVD_IN_MSPIKE_WL=-0.01, SPF_PASS=-0.001,
	URIBL_BLOCKED=0.001] autolearn=disabled
Authentication-Results: spamd1-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-us-west.apache.org ([10.40.0.8])
	by localhost (spamd1-us-west.apache.org [10.40.0.7]) (amavisd-new, port 10024)
	with ESMTP id ARfamq39YUT3 for <dev@httpd.apache.org>;
	Sat,  3 Oct 2015 19:43:59 +0000 (UTC)
Received: from mail-qk0-f177.google.com (mail-qk0-f177.google.com [209.85.220.177])
	by mx1-us-west.apache.org (ASF Mail Server at mx1-us-west.apache.org) with ESMTPS id 62178210B9
	for <dev@httpd.apache.org>; Sat,  3 Oct 2015 19:43:59 +0000 (UTC)
Received: by qkcf65 with SMTP id f65so55821101qkc.3
        for <dev@httpd.apache.org>; Sat, 03 Oct 2015 12:43:52 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        bh=1nw4j+0CxgTqm/DzKLaJFyoX7U8GrPHkFlXAnolCDCU=;
        b=qYm/eQnzDncqZuEM/eZJm+vckorCCarUE9jwspegAvsyhMjIyAt7nPiJhs1TdOFVR9
         DTdCUZ4xhCfw+2ra9wAbwSUDS1CdGu1T7icMlJK5uLXZ2zHFPXCR1jZcvD1nYZgbbHEj
         9jhGyqhEGcsQaaiznTHh5iW8GzWe4utbX+CT3OXRP5zRVWInNIOTQ3o4yG0kCLtbdkQx
         vY+nIjclH5z++MaHAP2DPvZJM0xbsrdGaRJ0O24a+7ELqgSnaZ/BskU+HrwFrDtgkZBA
         6jUXhnsWTFvWN+lGMxLz+DtvQKUEHd2x2uUjHX7idA3rQXUg0iAn5CXo+BVdTLIL8Vzh
         Uzig==
MIME-Version: 1.0
X-Received: by 10.55.217.70 with SMTP id u67mr28395404qki.38.1443901431913;
 Sat, 03 Oct 2015 12:43:51 -0700 (PDT)
Received: by 10.55.72.20 with HTTP; Sat, 3 Oct 2015 12:43:51 -0700 (PDT)
In-Reply-To: <560D2A9B.1010300@kippdata.de>
References: <560D0A3F.9010609@kippdata.de>
	<CALK=YjPB=xUQg2_B0p6YKocQ58GBf5YtpR1tnJnS+ua+4=G2YA@mail.gmail.com>
	<560D2A9B.1010300@kippdata.de>
Date: Sat, 3 Oct 2015 21:43:51 +0200
Message-ID: <CAKQ1sVPvsPjpjY5mPQ0YRGHzbeX2i9VoUh-WYE3Qr9b6CCuo9Q@mail.gmail.com>
Subject: Re: Expression Parser: search and replace with s/PATTERN/REPLACEMENT/FLAGS
From: Yann Ylavic <ylavic.dev@gmail.com>
To: dev@httpd.apache.org
Content-Type: text/plain; charset=UTF-8

On Thu, Oct 1, 2015 at 2:44 PM, Rainer Jung <rainer.jung@kippdata.de> wrote:
>
> OK, at least an encouragement for me to have a closer look.

+1!

From dev-return-84026-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Sat Oct  3 19:56:41 2015
Return-Path: <dev-return-84026-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 3FB3E17DBF
	for <apmail-httpd-dev-archive@www.apache.org>; Sat,  3 Oct 2015 19:56:41 +0000 (UTC)
Received: (qmail 33288 invoked by uid 500); 3 Oct 2015 19:56:40 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 33199 invoked by uid 500); 3 Oct 2015 19:56:40 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 33181 invoked by uid 99); 3 Oct 2015 19:56:40 -0000
Received: from Unknown (HELO spamd1-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 03 Oct 2015 19:56:40 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd1-us-west.apache.org (ASF Mail Server at spamd1-us-west.apache.org) with ESMTP id 53796C2004
	for <dev@httpd.apache.org>; Sat,  3 Oct 2015 19:56:40 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd1-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 0.999
X-Spam-Level:
X-Spam-Status: No, score=0.999 tagged_above=-999 required=6.31
	tests=[KAM_LAZY_DOMAIN_SECURITY=1, RCVD_IN_MSPIKE_H2=-0.001]
	autolearn=disabled
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd1-us-west.apache.org [10.40.0.7]) (amavisd-new, port 10024)
	with ESMTP id Sn2Kn_Rlu2ZI for <dev@httpd.apache.org>;
	Sat,  3 Oct 2015 19:56:39 +0000 (UTC)
Received: from smtp.smtpout.orange.fr (smtp04.smtpout.orange.fr [80.12.242.126])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id D583420773
	for <dev@httpd.apache.org>; Sat,  3 Oct 2015 19:56:38 +0000 (UTC)
Received: from [127.0.0.1] ([92.140.228.92])
	by mwinf5d27 with ME
	id QjwX1r00B20FBgC03jwXJ8; Sat, 03 Oct 2015 21:56:32 +0200
X-ME-Helo: [127.0.0.1]
X-ME-Date: Sat, 03 Oct 2015 21:56:32 +0200
X-ME-IP: 92.140.228.92
Subject: Re: svn commit: r1703305 -
 /httpd/httpd/trunk/modules/aaa/mod_auth_digest.c
To: dev@httpd.apache.org
References: <20150915222046.152F4AC0181@hades.apache.org>
 <560D7C36.7010607@apache.org>
From: Marion & Christophe JAILLET <christophe.jaillet@wanadoo.fr>
Message-ID: <561032EF.9090401@wanadoo.fr>
Date: Sat, 3 Oct 2015 21:56:31 +0200
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:38.0) Gecko/20100101
 Thunderbird/38.3.0
MIME-Version: 1.0
In-Reply-To: <560D7C36.7010607@apache.org>
Content-Type: text/plain; charset=utf-8; format=flowed
Content-Transfer-Encoding: 8bit
X-Antivirus: avast! (VPS 151003-1, 03/10/2015), Outbound message
X-Antivirus-Status: Clean


Le 01/10/2015 20:32, Ruediger Pluem a écrit :
> On 09/16/2015 12:20 AM, jailletc36@apache.org wrote:
>> Author: jailletc36
>> Date: Tue Sep 15 22:20:45 2015
>> New Revision: 1703305
>>
>> URL: http://svn.apache.org/r1703305
>> Log:
>> Remove code related to 'AuthDigestEnableQueryStringHack'
>>
>> This has been undocumented for about 3 years now (see r1415960)
>>
>> Modified:
>>      httpd/httpd/trunk/modules/aaa/mod_auth_digest.c
> Could this cause
>
> t/modules/digest.t
>
> test 9 to fail?
>
> As we removed the code for good reason we should also remove the test if this is the case then.
>
> Regards
>
> Rüdiger

Hi,
yes, you are right.

I would proposed the below patch:


Index: t/modules/digest.t
===================================================================
--- t/modules/digest.t    (révision 1706466)
+++ t/modules/digest.t    (copie de travail)
@@ -111,14 +111,20 @@
  # finally, the MSIE tests

  {
-  # fake current MSIE behavior - this should work as of 2.0.51
-  my $response = GET "$url?$query",
-                   Authorization => $no_query_auth,
-                   'X-Browser'   => 'MSIE';
-
-  ok t_cmp($response->code,
-           200,
-           'manual Authorization with no query string in header + MSIE');
+  if (have_min_apache_version("2.5.0")) {
+    skip "'AuthDigestEnableQueryStringHack' has been removed in r1703305";
+  }
+  else
+  {
+    # fake current MSIE behavior - this should work as of 2.0.51
+    my $response = GET "$url?$query",
+                     Authorization => $no_query_auth,
+                     'X-Browser'   => 'MSIE';
+
+    ok t_cmp($response->code,
+             200,
+             'manual Authorization with no query string in header + MSIE');
+  }
  }

  {



This way, the test would still be done on 2.4.x where 
AuthDigestEnableQueryStringHack is still present, but not on trunk where 
I've removed it.

As I've never modified the test framework itself, please let me know if 
it is the correct way to do?

Best regards,
CJ

From dev-return-84027-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Sun Oct  4 07:15:20 2015
Return-Path: <dev-return-84027-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id DCB091862E
	for <apmail-httpd-dev-archive@www.apache.org>; Sun,  4 Oct 2015 07:15:20 +0000 (UTC)
Received: (qmail 56395 invoked by uid 500); 4 Oct 2015 07:15:20 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 56316 invoked by uid 500); 4 Oct 2015 07:15:20 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 56307 invoked by uid 99); 4 Oct 2015 07:15:20 -0000
Received: from mail-relay.apache.org (HELO mail-relay.apache.org) (140.211.11.15)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 04 Oct 2015 07:15:20 +0000
Received: from asf-bz1-us-mid.priv.apache.org (nat1-us-mid.apache.org [23.253.172.122])
	by mail-relay.apache.org (ASF Mail Server at mail-relay.apache.org) with ESMTPS id E46211A003F
	for <dev@httpd.apache.org>; Sun,  4 Oct 2015 07:15:19 +0000 (UTC)
Received: by asf-bz1-us-mid.priv.apache.org (ASF Mail Server at asf-bz1-us-mid.priv.apache.org, from userid 0)
	id 6DD96600AA; Sun,  4 Oct 2015 07:15:19 +0000 (UTC)
From: bugzilla@apache.org
To: dev@httpd.apache.org
Subject: Bug report for Apache httpd-2 [2015/10/04]
Message-Id: <20151004071519.6DD96600AA@asf-bz1-us-mid.priv.apache.org>
Date: Sun,  4 Oct 2015 07:15:06 +0000 (UTC)

+---------------------------------------------------------------------------+
| Bugzilla Bug ID                                                           |
|     +---------------------------------------------------------------------+
|     | Status: UNC=Unconfirmed NEW=New         ASS=Assigned                |
|     |         OPN=Reopened    VER=Verified    (Skipped Closed/Resolved)   |
|     |   +-----------------------------------------------------------------+
|     |   | Severity: BLK=Blocker CRI=Critical  REG=Regression  MAJ=Major   |
|     |   |           MIN=Minor   NOR=Normal    ENH=Enhancement TRV=Trivial |
|     |   |   +-------------------------------------------------------------+
|     |   |   | Date Posted                                                 |
|     |   |   |          +--------------------------------------------------+
|     |   |   |          | Description                                      |
|     |   |   |          |                                                  |
| 7483|Ass|Enh|2002-03-26|Add FileAction directive to assign a cgi interpret|
| 8713|Inf|Min|2002-05-01|No Errorlog on PROPFIND/Depth:Infinity            |
| 8867|Opn|Cri|2002-05-07|exports.c generation fails when using a symlink to|
|10747|New|Maj|2002-07-12|ftp SIZE command and 'smart' ftp servers results i|
|11294|New|Enh|2002-07-30|desired vhost_alias option                        |
|11580|Opn|Enh|2002-08-09|generate Content-Location headers                 |
|12033|Opn|Nor|2002-08-26|Graceful restart immediately result in [warn] long|
|12680|New|Enh|2002-09-16|Digest authentication with integrity protection   |
|13599|Inf|Nor|2002-10-14|autoindex formating broken for multibyte sequences|
|13661|Ass|Enh|2002-10-15|Apache cannot not handle dynamic IP reallocation  |
|14104|Opn|Enh|2002-10-30|not documented: must restart server to load new CR|
|14496|New|Enh|2002-11-13|Cannot upgrade any version on Windows. Must uninst|
|14922|Inf|Enh|2002-11-28|<target> is currently hardcoded to 'apache2'      |
|15719|Inf|Nor|2002-12-30|WebDAV MOVE to destination URI which is content-ne|
|16761|Inf|Nor|2003-02-04|CustomLog with pipe spawns process during config  |
|16802|New|Enh|2003-02-05|Additional AllowOverride directive "Restrict"     |
|16811|Ass|Maj|2003-02-05|mod_autoindex always return webpages in UTF-8.    |
|17107|New|Min|2003-02-16|Windows should not install printenv               |
|17114|New|Enh|2003-02-17|Please add strip and install-strip targets to Make|
|17244|Ass|Nor|2003-02-20|./configure --help gives false information regardi|
|17497|Opn|Nor|2003-02-27|mod_mime_magic generates incorrect response header|
|18325|New|Enh|2003-03-25|PAM support for suEXEC                            |
|18334|Inf|Cri|2003-03-25|Server crashes when authenticating users against L|
|18497|New|Min|2003-03-30|configure --help gives wrong default for sysconfdi|
|19043|New|Min|2003-04-15|Interesting interaction between cern_meta module a|
|19670|New|Enh|2003-05-05|content type header supplied upon PUT is thrown aw|
|20036|Ass|Nor|2003-05-19|Trailing Dots stripped from PATH_INFO environment |
|21253|New|Nor|2003-07-01|Mime magic doesn't continue if type is specifed fo|
|21260|New|Nor|2003-07-02|CacheMaxExpire directive not enforced !           |
|21533|Ass|Cri|2003-07-11|Multiple levels of htacces files can cause mod_aut|
|22138|Inf|Cri|2003-08-05|Webdav is not preccessing special chars right.    |
|22237|New|Enh|2003-08-08|option to disable ServerSignature on index pages  |
|22484|Opn|Maj|2003-08-16|semaphore problem takes httpd down                |
|22686|Opn|Nor|2003-08-25|ab: apr_poll: The timeout specified has expired (7|
|22898|Opn|Nor|2003-09-02|nph scripts with two HTTP header                  |
|23167|Inf|Cri|2003-09-14|--enable-layout never goes to apr apr-util        |
|23181|New|Nor|2003-09-15|Status 304 (Not modified) and chunking leads to an|
|23238|New|Cri|2003-09-18|non-async-signal-safe operations from signal handl|
|23330|New|Enh|2003-09-22|Enhance ApacheMonitor to view and control Tomcat s|
|23911|Opn|Cri|2003-10-18|CGI processes left defunct/zombie under 2.0.54    |
|24031|New|Enh|2003-10-23|Passphrase protected private key in SSLProxyMachin|
|24095|Opn|Cri|2003-10-24|ERROR "Parent: child process exited with status 32|
|24437|Opn|Nor|2003-11-05|mod_auth_ldap doubly-escapes backslash (\) charact|
|24890|Opn|Nor|2003-11-21|Apache config parser should not be local aware ( g|
|25014|New|Enh|2003-11-26|A flexible interface for mod_log_config           |
|25201|New|Enh|2003-12-04|Provide Cache Purge operation                     |
|25240|Inf|Enh|2003-12-05|SSL Library Error: 336105671 logged as information|
|25435|New|Enh|2003-12-11|sethandler and directoryindex not playing nice    |
|25469|Opn|Enh|2003-12-12|create AuthRoot for defining paths to auth files  |
|25484|Ass|Nor|2003-12-12|Non-service Apache cannot be stopped in WinXP     |
|25543|Inf|Nor|2003-12-15|mod_proxy_ajp overwrites existing response headers|
|25667|New|Nor|2003-12-19|Memory leak in function ssl_scache_dbm_retrieve().|
|25863|New|Enh|2004-01-02|new per-host initialization hooks                 |
|26005|New|Nor|2004-01-08|SERVER_NAME incorrect when using IPv6 address in U|
|26142|New|Maj|2004-01-14|EnableSendFile Off for Windows XP Home            |
|26153|Opn|Cri|2004-01-15|Apache cygwin directory traversal vulnerability   |
|26368|New|Min|2004-01-23|File extensions in AddDescription treated as part |
|26446|New|Nor|2004-01-26|flush buckets followed by eos bucket emit multiple|
|26478|New|Enh|2004-01-28|mod_dav does not expose a method for setting the D|
|26835|New|Enh|2004-02-10|[PATCH] Mod_status Readability & Browser Side Tabl|
|27257|Ass|Enh|2004-02-26|rotatelogs with getopt and setuid                 |
|27578|New|Enh|2004-03-10|made getlastmodified a writable property          |
|27715|Ass|Enh|2004-03-16|Client sending misformed Range "bytes = 0-100" ins|
|27791|Inf|Nor|2004-03-18|mod_cache doesn't re-cache expired content        |
|27835|New|Enh|2004-03-22|When proxying FTP, all errors turns into 404      |
|27869|New|Enh|2004-03-23|stopping and starting httpd again immediately caus|
|28854|Inf|Nor|2004-05-09|Build fails with missing library call on Solaris i|
|28903|New|Enh|2004-05-11|Hooks to add environment variables to CGI and othe|
|29090|Ass|Enh|2004-05-19|MultiviewsMatch NegotiatedOnly extensions not resp|
|29165|New|Nor|2004-05-24|Parent directory icon not correct                 |
|29446|New|Enh|2004-06-08|want directive for setting content negotiation qua|
|29449|New|Enh|2004-06-09|Limit length of specified fields in LogFormat     |
|29450|New|Enh|2004-06-09|Improved logging for mod_access                   |
|29510|Ass|Enh|2004-06-10|ab does not support multiple cookies              |
|29644|Ver|Nor|2004-06-17|mod_proxy keeps downloading even after the client |
|29755|Opn|Nor|2004-06-23|mod_usertrack should use err_headers_out          |
|29822|New|Enh|2004-06-26|implement FTP 'PUT' support in proxy_ftp.c        |
|29941|Ass|Enh|2004-07-06|log files are not tested for availability on confi|
|30259|Ass|Enh|2004-07-22|When proxy connects to backend, a DNS lookup is do|
|30505|Ass|Enh|2004-08-05|Apache uses 'Error', and not lower level event typ|
|30730|Inf|Nor|2004-08-18|[PatchAvailable] mod_actions and Server-Status    |
|30865|Inf|Maj|2004-08-26|mod_disk_cache leaves many temporary files slowing|
|31302|Opn|Cri|2004-09-19|suexec doesn't execute commands if they're not in |
|31311|New|Enh|2004-09-20|Remote user not logged in reverse proxy scenario  |
|31352|Ass|Enh|2004-09-21|RFE, Bind to LDAP server with browser supplier use|
|31418|Opn|Nor|2004-09-25|SSLUserName is not usable by other modules        |
|31484|New|Maj|2004-09-30|Custom environment variables not passed to content|
|31490|New|Nor|2004-09-30|mod_proxy_ftp renders filenames with spaces badly |
|31565|New|Enh|2004-10-06|Won't start correctly if parent closed stdin, stdo|
|31679|New|Enh|2004-10-12|If the argument of a CGI has two or more consecuti|
|31709|Inf|Nor|2004-10-13|Raises an error on SSL name based virtualhosts (wi|
|31712|New|Enh|2004-10-14|config_file is NULL at ap_walk_config etc         |
|31952|New|Enh|2004-10-29|mod_proxy and RealPlayer: audio content streaming |
|32051|Opn|Nor|2004-11-04|mod_example is not thread safe                    |
|32328|Opn|Enh|2004-11-19|Make mod_rewrite escaping optional / expose intern|
|32346|New|Enh|2004-11-22|mod_include/include virtual checks content-type is|
|32524|New|Enh|2004-12-03|ab: add an option to specify a source address     |
|32703|Inf|Enh|2004-12-14|Cannot determine that Apache is frozen if /var fil|
|32750|Ass|Maj|2004-12-17|mod_proxy + Win32DisableAcceptEx = memory leak    |
|32877|New|Enh|2004-12-29|wrong utf-8 encoding/escaping in a href for umlaut|
|33084|New|Enh|2005-01-13|Optional certificate validity period check on SSLV|
|33089|New|Nor|2005-01-13|mod_include: Options +Includes (or IncludesNoExec)|
|33207|New|Nor|2005-01-23|Results of my suexec.c code audit                 |
|33215|New|Nor|2005-01-24|Cygwin build/install.sh fix (OSTYPE => ext=.exe)  |
|33512|Inf|Maj|2005-02-11|mod_mem_cache and possibly mod_deflate            |
|33627|New|Nor|2005-02-18|Bite-sized changes making progress towards compila|
|33685|New|Maj|2005-02-22|Unable to install in the path containing non engli|
|34270|Inf|Nor|2005-04-01|Large POSTs over SSL from Internet Explorer do not|
|34375|New|Enh|2005-04-08|enhancements for mod_include                      |
|34377|New|Enh|2005-04-08|Allow the overriding of 401 Unauthorized returns f|
|34405|New|Enh|2005-04-11|adds DOCUMENT_NAME_WITHOUT_SUFFIX to mod_include  |
|34508|New|Nor|2005-04-19|Randomly slow graceful restart, not accepting new |
|34519|New|Enh|2005-04-19|Directory index should emit valid XHTML           |
|35049|New|Nor|2005-05-24|let AddDefaultCharset apply to text/css and applic|
|35077|New|Nor|2005-05-26|mod_dav passes incorrect paths with LocationMatch |
|35083|Inf|Enh|2005-05-26|Certificate validation problems trapping          |
|35098|Ver|Maj|2005-05-27|Install fails using --prefix                      |
|35154|New|Nor|2005-06-01|Support for NID_serialNumber, etc. in SSLUserName |
|35245|New|Nor|2005-06-06|cache ignores max-age cache-directive in requests |
|35250|New|Enh|2005-06-07|[PatchAvailable] add logging to mod_proxy_connect |
|35280|New|Nor|2005-06-09|FTP proxy breaks RFC 2428 when trying to fall back|
|35556|Inf|Nor|2005-06-30|CRL files not re-read by HUP                      |
|35652|Opn|Min|2005-07-07|Improve error message: "pcfg_openfile: unable to c|
|35702|New|Nor|2005-07-12|Using with https URL, ab freezes or gets SIGSEGV o|
|35781|New|Nor|2005-07-18|ap_sub_req_method_uri() bypasses Limit security co|
|35981|Inf|Maj|2005-08-02|mod_dav overrides dav_fs response on PUT failure  |
|36286|New|Enh|2005-08-20|configtest doesn't check SSL certificates         |
|36492|New|Nor|2005-09-04|split-logfile script dies when splitting log of ma|
|36495|Inf|Nor|2005-09-05|mod_proxy_ajp: ajp_check_msg_header() got bad sign|
|36564|New|Enh|2005-09-08|make mod_ldap really universal                    |
|36636|New|Maj|2005-09-13|database write lock taken for PROPFIND operations |
|36676|New|Nor|2005-09-15|time() bug in httpd/os/win32/util_win32.c:wait_for|
|36710|Opn|Blk|2005-09-19|CGI output not captured                           |
|36724|New|Nor|2005-09-20|Don't install Apache Monitor by default           |
|37110|New|Nor|2005-10-17|Build fails when source tree is read-only         |
|37196|Inf|Min|2005-10-21|Wrong "Parent directory" link                     |
|37201|New|Enh|2005-10-21|Add <IfInterface IP> syntax to apache configuratio|
|37290|Opn|Min|2005-10-28|DirectoryIndex don't work in scriptaliased directo|
|37307|New|Enh|2005-10-31|Can't suppress error messages                     |
|37355|New|Enh|2005-11-04|Allow to specify Proxy-Authorization in ProxyRemot|
|37360|New|Maj|2005-11-04|Install fails on Windows XP x64 when program files|
|37402|New|Nor|2005-11-08|mod_proxy has stopped allowing POST sub-requests  |
|37514|Inf|Nor|2005-11-15|mod_proxy buffers chunked data.                   |
|37564|New|Enh|2005-11-19|Suggestion: mod_suexec SuexecUserGroup directive i|
|37587|Inf|Min|2005-11-22|mod_status Total Traffic value goes up then down? |
|37823|Inf|Nor|2005-12-07|The openssl library linked is different between ht|
|37920|New|Maj|2005-12-15|mod_proxy does not flush data on POST requests fro|
|38116|New|Enh|2006-01-04|Chroot-Patch for SuExec                           |
|38164|New|Nor|2006-01-06|wrong status code for failed COPY/MOVE            |
|38182|New|Nor|2006-01-08|COPY ignores authority in Destination header      |
|38218|New|Enh|2006-01-10|Multiline Comments for *.conf files               |
|38240|Inf|Nor|2006-01-12|apache restart segfault with mutliple Include dire|
|38325|Opn|Nor|2006-01-20|impossible to determine AUTH_TYPE of interpreted r|
|38355|Unc|Enh|2006-01-23|DSO support for mod_rewrite                       |
|38369|New|Enh|2006-01-24|mod_proxy keeps alive connections that should be b|
|38408|New|Nor|2006-01-27|SSI environment vars not set in spawned processes |
|38419|New|Nor|2006-01-27|Problems with large WebDAV properties             |
|38478|New|Maj|2006-02-01|A client starting a SSL renegotiation can crash th|
|38515|New|Enh|2006-02-05|Dynamic LDAP Group Support                        |
|38550|New|Enh|2006-02-07|Setting headers based on proxied data             |
|38571|New|Enh|2006-02-08|CustomLog directive checked by apachectl configtes|
|38756|Inf|Nor|2006-02-22|errors with running make                          |
|38786|New|Nor|2006-02-26|"IndexOption VersionSort" has problems with traili|
|38827|New|Reg|2006-03-02|mod_disk_cache trying to rename locked tempfile on|
|38864|Inf|Enh|2006-03-06|ProxyPassReverse fails in <Location>              |
|38903|New|Maj|2006-03-09|r->allowed does not affect Allow response header  |
|38923|New|Min|2006-03-10|mod_speling incorrectly escapes linked URLs       |
|38928|New|Min|2006-03-11|propose removing "VARIANTS" feature               |
|38995|New|Nor|2006-03-16|httpd tries to communicate with the CGI daemon eve|
|39111|New|Nor|2006-03-27|Potential bug brought by mmapfile (mod_file_cache)|
|39128|Inf|Maj|2006-03-28|Apache 2.2 will not compile mod_ssl library's corr|
|39185|Inf|Nor|2006-04-03|Approximately in 1-2 weeks of work the server hang|
|39216|New|Maj|2006-04-05|mod_disk_cache trying to rename locked file, decre|
|39238|New|Nor|2006-04-07|mod_auth_dbm requires mod_auth or "no groups file?|
|39275|Opn|Nor|2006-04-11|slow child_init causes MaxClients warning         |
|39287|New|Nor|2006-04-12|Incorrect If-Modified-Since validation (due to syn|
|39299|New|Nor|2006-04-13|Internal Server Error (500) on COPY               |
|39329|Inf|Nor|2006-04-17|mod_dbd reconnection and prepared statements      |
|39370|New|Nor|2006-04-20|SSL session will be removed if the client is sendi|
|39380|Inf|Nor|2006-04-21|mod_disk_cache eats memory, has no LFS support, et|
|39418|New|Nor|2006-04-26|CacheMaxExpire directive not enforced             |
|39448|New|Min|2006-04-29|old-style <directory proxy:*> doesn't give any war|
|39498|New|Nor|2006-05-06|accept_filter in apr assumes if found in sys/socke|
|39517|New|Nor|2006-05-08|Corrupt chunked transfer-encoding with Content Neg|
|39658|Opn|Nor|2006-05-25|mod_proxy_ajp SSL Key Size Bug                    |
|39673|New|Nor|2006-05-29|mod_proxy opens connections that disturb NTLM     |
|39692|New|Nor|2006-05-31|mod_proxy_balancer doesn't retry a failed request |
|39723|Inf|Enh|2006-06-05|Forward proxy does not work in tranparent mode    |
|39727|Ass|Nor|2006-06-05|Incorrect ETag on gzip:ed content                 |
|39730|New|Nor|2006-06-06|LanguagePriority and DefaultLanguage are Case Sens|
|39737|New|Nor|2006-06-06|LogFormat "%{tid}P" reports wrong thread id on Win|
|39748|New|Enh|2006-06-07|Header and POST support for mod_include           |
|39753|New|Nor|2006-06-07|incorrect source for LOCALE Decimal Symbol in Win2|
|39785|Inf|Nor|2006-06-12|Status code 408 (Request Timeout) is not logged   |
|39807|Opn|Enh|2006-06-13|large files / filesystem corruption can cause apac|
|39902|New|Nor|2006-06-27|HeaderName directive breaks mod_filter somehow    |
|39904|New|Nor|2006-06-27|graceful restart error and cpu load               |
|39913|Ass|Blk|2006-06-27|detection of static OpenSSL libraries requiring li|
|39916|New|Nor|2006-06-28|Core Filters & non-blocking Sendfile              |
|39923|New|Nor|2006-06-28|AddDescription doesn't work in server config with |
|39928|New|Nor|2006-06-28|port no detected when file name not in URL        |
|39935|New|Nor|2006-06-29|AddDescription does not do literal comparisons on |
|39973|Ass|Enh|2006-07-06|apache software folder should be movable          |
|40035|New|Cri|2006-07-13|Windows Server 2003 "("R2")" 64-Bit Edition no cgi|
|40060|New|Nor|2006-07-17|AuthGroupFile should accept /etc/group syntax     |
|40075|New|Enh|2006-07-19|unable to use ldap groups that contain DNs and use|
|40102|Opn|Nor|2006-07-24|SCRIPT_NAME set incorrectly with mod_rewrite      |
|40146|New|Nor|2006-07-31|mod_ssl info in server_info is blank              |
|40174|New|Min|2006-08-03|Unable to get IndexOptionis ScanHTMLTitles to work|
|40180|Inf|Maj|2006-08-03|Mod_dav and remove folder doesn't work with Micros|
|40190|New|Nor|2006-08-05|translate file                                    |
|40196|New|Nor|2006-08-06|EILSEQ handling, NoImplicitAdd should work, and so|
|40217|Opn|Nor|2006-08-08|mod_dav PROPFIND ignores access restrictions on it|
|40266|Inf|Blk|2006-08-16|berkeley db support in httpd is screwed           |
|40312|New|Nor|2006-08-24|ssl_engine_init.c, ssl_init_ctx_verify contains a |
|40373|New|Nor|2006-08-31|mod_dir adds trailing slash after internal redirec|
|40408|New|Blk|2006-09-04|Apache 2.2.3 is not starting                      |
|40416|New|Maj|2006-09-05|mod_proxy_ftp cannot connect under http load in fo|
|40441|New|Enh|2006-09-08|intelligently handling dynamic subdomains         |
|40453|New|Nor|2006-09-09|lexicographic compare in RewriteCond isn't lexicog|
|40463|New|Nor|2006-09-11|piped logging causes some weird kill()ing         |
|40513|Opn|Maj|2006-09-14|Seeding PRNG with 0 bytes of entropy              |
|40514|New|Nor|2006-09-14|would like GracefulShutdownTimeout to work for gra|
|40540|Inf|Nor|2006-09-19|Bad interaction between MultiViews and SetOutputFi|
|40541|New|Nor|2006-09-19|Action rewrites URI used by Location?             |
|40571|New|Nor|2006-09-21|mod_proxy_ajp don't works with mod_usertrack      |
|40586|New|Enh|2006-09-22|Add option to supress default '-' output          |
|40746|New|Enh|2006-10-12|Feature request: ProxyAllow directive             |
|40749|New|Min|2006-10-12|magic file with string and "%n" causes Apache chil|
|40781|New|Nor|2006-10-17|PATH_TRANSLATED: 'redirect:/~jablko/gallery2/main.|
|40808|New|Enh|2006-10-23|ProxyRemote with optional proxy authentication    |
|40859|New|Enh|2006-11-01|[PATCH] Support -F force option to 'ab' support to|
|40917|New|Nor|2006-11-07|configure does not detect OpenSSL shared lib on HP|
|40953|New|Min|2006-11-12|Should not send any data in 1xx/204/304 reply from|
|40984|Inf|Enh|2006-11-16|AddIcon, AddIconByType for OpenDocument format    |
|40987|Opn|Enh|2006-11-16|ProxyVia Block doesn't remove Via: header for reve|
|41000|New|Nor|2006-11-19|mod_authn_dbd have an error, in function 'authn_db|
|41025|New|Nor|2006-11-23|ROBOTS META-Tag directive needed in mod_autoindex |
|41088|New|Nor|2006-11-30|installation backcolor is wrong (white)           |
|41111|New|Enh|2006-12-05|New option for filters: run only if there are spar|
|41114|New|Blk|2006-12-06|ACL HTTP method is rejected by mod_proxy_ajp      |
|41130|New|Nor|2006-12-07|mod_mime and mod_negotiation type-map both clobber|
|41143|Opn|Nor|2006-12-10|Incorrect ap_getline assumption in mod_proxy_http |
|41195|New|Nor|2006-12-17|properly set the parent pid on shutdown           |
|41196|New|Nor|2006-12-17|worker mpm usage of apr's memory pools is not thre|
|41200|Inf|Maj|2006-12-18|SSI include, prevent client from receiving full ou|
|41240|Inf|Enh|2006-12-25|BRF files support                                 |
|41262|Inf|Nor|2006-12-29|Embedded pcre causes runtime segfault             |
|41362|Inf|Maj|2007-01-14|mod_disk_cache and mod_include conflict generating|
|41375|Inf|Min|2007-01-15|Using same SSL Certificate with different ServerNa|
|41391|New|Min|2007-01-17|too long period setting makes max-age overflow    |
|41412|New|Enh|2007-01-19|RewriteRule Skip should take negative arguments   |
|41435|New|Nor|2007-01-22|Authentication fails with 500 Server Error        |
|41450|Inf|Cri|2007-01-24|Empty page (200 OK) while max-age is empty        |
|41485|New|Nor|2007-01-28|LDAP client certificates not usable in 2.2.x/trunk|
|41529|New|Enh|2007-02-02|Accept BOM in .htaccess                           |
|41556|New|Enh|2007-02-07|Feature Request: format string for masking ip addr|
|41621|New|Maj|2007-02-15|Apache 2.2.4 backend problem with Apache 2.0.59 Re|
|41646|New|Nor|2007-02-16|wrong headers are sent for HEAD requests when Prox|
|41676|Opn|Enh|2007-02-22|Refactor mod_proxy_ftp                            |
|41685|New|Enh|2007-02-22|Implement optional HTTP Authentication in a standa|
|41712|Inf|Nor|2007-02-26|threads locked at logging state                   |
|41729|New|Maj|2007-02-28|error message: ap_get_scoreboard_lb(130) failed in|
|41744|Inf|Maj|2007-03-01|SSI resolves includes but removes original HTML   |
|41763|Opn|Nor|2007-03-05|mod_disk_cache ignores CacheDirLevels and CacheDir|
|41764|New|Nor|2007-03-05|error state and conf                              |
|41771|Inf|Nor|2007-03-06|Erro with mod_proxy_ajp or mod_prox_balancer      |
|41867|New|Nor|2007-03-16|<DirectoryMatch> Matches Files                    |
|41925|New|Nor|2007-03-21|trivial patch to add automatic crypting to 'dbmman|
|41929|New|Nor|2007-03-22|ISAPI ssl variables                               |
|41953|New|Nor|2007-03-26|pidfile remains when 2nd pass of post-config retur|
|41962|New|Min|2007-03-27|Need mod_auth_ldap to authenticate with Active Dir|
|42001|New|Cri|2007-03-30|LINUX : Could not set LDAP_OPT_X_TLS to LDAP_OPT_X|
|42027|Inf|Nor|2007-04-02|FileETag directive appears to be ignored          |
|42054|New|Nor|2007-04-04|service name and parameter issues                 |
|42079|New|Nor|2007-04-10|SSLRequire: Additional access in sub-directoies   |
|42082|New|Nor|2007-04-10|filter_init is called multiple times after an INCL|
|42182|Inf|Nor|2007-04-22|Mime types for cached proxied content             |
|42216|New|Enh|2007-04-24|RFE -- external overload procedure                |
|42262|Inf|Nor|2007-04-26|mod_dav /  worker fails to allocate memory and seg|
|42287|Inf|Nor|2007-04-28|chunked encoded response to POST request to cgi sc|
|42368|Inf|Nor|2007-05-09|httpd is crashing if conf/extra/httpd-manual.conf |
|42373|Inf|Maj|2007-05-09|REPORT request fails over mod_proxy               |
|42404|New|Enh|2007-05-13|Filename/info for disk-cached proxied remote URLs |
|42425|Inf|Nor|2007-05-15|Additional freshness checks in mod_cache.c cause m|
|42471|Inf|Nor|2007-05-21|clients with IE7 take 3megs per page load. httpd.e|
|42492|Inf|Nor|2007-05-22|mod_proxy_ajp with SSL front end: data corruption |
|42499|Inf|Nor|2007-05-23|Backslash produces a 404 error instead of going to|
|42548|New|Nor|2007-05-30|INCLUDE negotiating language aborts with APR_POOL_|
|42561|New|Enh|2007-05-31|[PATCH] AuthLDAPRemoteUserAttribute only applies i|
|42633|New|Min|2007-06-11|mod_info gives wrong information about actual conf|
|42665|New|Nor|2007-06-14|spurious attempt to open ".../file.html/.htaccess"|
|42666|New|Nor|2007-06-14|code & docs corrections for FollowSymLinks and Sym|
|42667|New|Nor|2007-06-14|mod_proxy_balancer not reporting when workers are |
|42668|Inf|Nor|2007-06-14|balancer_manager shows Ok status for the workers t|
|42687|New|Nor|2007-06-18|Fully delegate certificate & key semantics to the |
|42688|New|Enh|2007-06-18|engine managed keys: per process openssl context  |
|42690|New|Nor|2007-06-18|realm is not set for each configured directory whe|
|42695|Opn|Cri|2007-06-18|mod_proxy balancer problem                        |
|42699|New|Enh|2007-06-20|share mod_logio data with other modules           |
|42711|New|Enh|2007-06-20|format string for whole log entries not just id   |
|42732|Opn|Maj|2007-06-25|Authentication against database issue.            |
|42763|New|Nor|2007-06-28|graceful-stop/restart loops go loop too far       |
|42923|Inf|Maj|2007-07-17|vhost certificate NOT overriding cert from the _de|
|42972|Inf|Nor|2007-07-25|Certificate list in mod_ssl module context are not|
|42977|New|Nor|2007-07-25|DAV locking is busted when apr-util is built with |
|42987|New|Nor|2007-07-27|Weak Etags in Apache are useless and violate RFC 2|
|43012|New|Nor|2007-08-02|AIX instdso.sh libphp5.so                         |
|43027|New|Enh|2007-08-03|Header in default language                        |
|43033|New|Nor|2007-08-04|apxs does not correctly detect module name (w/o -n|
|43177|New|Nor|2007-08-21|child pid xxxxx exit signal Segmentation fault    |
|43218|New|Nor|2007-08-27|Wrong cert used for vhost if ServerName is same   |
|43220|Opn|Cri|2007-08-27|mod_proxy truncating ajp output                   |
|43249|Inf|Maj|2007-08-30|ldap_simple_bind_s failed when using SUN LDAP Libs|
|43275|New|Enh|2007-08-31|Remove avoidable network transactions in mod_proxy|
|43289|New|Nor|2007-09-02|XBitHack full g+x returns zero sized response on I|
|43308|New|Nor|2007-09-04|Persistent backend connections not supported for R|
|43352|New|Nor|2007-09-11|Apache2: out of memory during heavy webdav files c|
|43441|New|Nor|2007-09-20|Incorrect HTTP status for pre-commit-blocked autov|
|43471|New|Min|2007-09-25|no need to create a global pool on open_scoreboard|
|43481|New|Cri|2007-09-26|AuthLDAPURL must contain a final path of branch?(l|
|43494|New|Nor|2007-09-26|mod_cgid does not kill never ending scripts       |
|43502|New|Enh|2007-09-28|httpd fails to start if log directory does not exi|
|43513|New|Nor|2007-09-29|Persistent backend connections for ProxyPassMatch |
|43532|Inf|Cri|2007-10-02|Error while compiling Apache 2.2.3 on HPUX        |
|43533|Opn|Nor|2007-10-02|Frequent crashes in mod_include's bndm()          |
|43561|New|Nor|2007-10-05|apxs -q anomaly                                   |
|43577|Inf|Blk|2007-10-09|mod_authnz_ldap not working under WLDAP32 (novell/|
|43607|New|Nor|2007-10-11|mod_proxy sends data on closed connections without|
|43649|Opn|Trv|2007-10-18|mod_autoindex is generating invalid XHTML markup  |
|43652|New|Enh|2007-10-18|Suggest small change for big fix with SuExec & Vir|
|43666|New|Nor|2007-10-20|CGI works, but client denied error messages in err|
|43679|New|Enh|2007-10-23|Contributed tests for checking that subrequests ta|
|43723|Inf|Cri|2007-10-29|Apache 2.2.6 segfault when using mod_dbd          |
|43724|New|Cri|2007-10-29|Apache 2.2.6 segfault on url wich not in cache    |
|43755|New|Enh|2007-10-31|Add a SSLOptions to don't fill SSL_CLIENT_VERIFY  |
|43762|New|Enh|2007-10-31|Misleading tips in an error message about internal|
|43777|New|Nor|2007-11-01|Wrong encoding of <href> element in response      |
|43778|New|Nor|2007-11-01|Wrong responses if httpd has not access to some el|
|43785|New|Enh|2007-11-02|Tracking the per-hit impact of mod_include        |
|43792|New|Enh|2007-11-04|Feature proposal - bind phase                     |
|43818|New|Nor|2007-11-08|PROPFIND on -w- collections returns 207 MULTI-STAT|
|43838|New|Enh|2007-11-11|If-Modified-Since request and htcacheclean conflic|
|43895|New|Nor|2007-11-18|mod_mbox improvements                             |
|43897|Inf|Cri|2007-11-18|Huge memory consumption httpd 2.2.6, mod_proxy - m|
|43931|New|Enh|2007-11-21|OpenSSL autoconfig support for mod_ssl            |
|43943|New|Nor|2007-11-22|SHMCB crash due to misalignment and GCC 4 optimiza|
|43958|Inf|Maj|2007-11-26|mod_proxy_balancer not balancing correct in combin|
|43997|Opn|Min|2007-11-29|Only issue "Init: SSL server IP/Port conflict" if |
|44025|Inf|Nor|2007-12-05|Apache 2.2.6 fails to configure on OpenBSD 4.1    |
|44027|Ass|Enh|2007-12-05|Internationalized Domain Name (IDN) support       |
|44031|Opn|Maj|2007-12-06|RemoveHandler inside subdir location              |
|44034|Ass|Enh|2007-12-06|mpm_winnt doesn't call monitor hook               |
|44105|New|Nor|2007-12-19|Core dumps when using Proxy Keepalive             |
|44155|New|Enh|2007-12-31|smarter retry for LDAP_UNAVAILABLE, LDAP_BUSY, etc|
|44181|Opn|Enh|2008-01-07|add UnAlias                                       |
|44188|Inf|Cri|2008-01-08|Empty response for certain requests (mod_proxy as |
|44218|New|Min|2008-01-13|mod_autoindex shows the default icon for files wit|
|44221|Opn|Cri|2008-01-14|CheckCaseOnly On does not stop Multiple Choices ba|
|44250|New|Nor|2008-01-16|OSX 10.5: __THE_PROCESS_HAS_FORKED_AND_YOU_CANNOT_|
|44279|New|Enh|2008-01-22|Add "iterate" flag to apply rule in a loop while p|
|44302|New|Nor|2008-01-27|AuthLDAPURL does not accept ldapi:// urls         |
|44305|New|Nor|2008-01-28|Inconsistent configuration for suexec path        |
|44316|New|Nor|2008-01-28|httpd 2.0 does not follow ScriptAliases when invok|
|44322|New|Enh|2008-01-29|mod_proxy ProxyPassReverseCookieDomain with no dom|
|44351|New|Nor|2008-02-04|File descriptor leak when using prg RewriteMap    |
|44363|Inf|Maj|2008-02-05|Slow file transfers                               |
|44384|Ass|Nor|2008-02-09|mod_ssl on MacOS X 10.5.1 does not work because of|
|44453|New|Nor|2008-02-19|list_hooks.pl doesn't parse declarations that span|
|44476|New|Maj|2008-02-23|Apache service fails to start due to missing depen|
|44503|Inf|Blk|2008-02-27|Errors during SSL handshake                       |
|44518|New|Enh|2008-03-02|Don't set expires header on HTTP redirect.        |
|44578|New|Enh|2008-03-11|mod_authn_dbd option to let database validate pass|
|44601|New|Trv|2008-03-13|Add a lowercase value to Vary header for consisten|
|44602|New|Enh|2008-03-13|Options for modfying Content-Location (relative OR|
|44622|Inf|Nor|2008-03-17|POST fails to SSL vhost with proxy to HTTP backend|
|44631|New|Nor|2008-03-18|with-included-apr fails to work when using a separ|
|44638|New|Nor|2008-03-19|sed error in httpd.spec.in                        |
|44656|New|Nor|2008-03-22|Tries to retrive error document 404 instead of 406|
|44657|New|Enh|2008-03-22|prefer-type, -encoding, and -charset cookie? (as p|
|44670|New|Min|2008-03-25|Apache httpd 2.2.8 : Cannot ./configure when curre|
|44696|Inf|Nor|2008-03-27|mod_cache sometimes serves old content despite hav|
|44730|New|Nor|2008-04-01|duplicate query string in remote server url when u|
|44752|New|Nor|2008-04-03|Suexec does not correctly check that scripts are i|
|44757|New|Enh|2008-04-04|adding stderr buckets to mod_cgi                  |
|44758|New|Enh|2008-04-04|LimitRequestBody undocumented behaviour with proxi|
|44779|New|Enh|2008-04-08|Using commas and semicolons for content negotiatio|
|44855|New|Nor|2008-04-22|irregular balancing with sticky-session after re-e|
|44865|Ass|Nor|2008-04-23|mod_dav's lock database becomes consistently corru|
|44870|Inf|Nor|2008-04-24|process spinning on 100% cpu                      |
|44923|Inf|Min|2008-05-02|consequences of multiple LDAPTrustedGlobalCert    |
|44924|New|Enh|2008-05-02|allow 'CACERTDIR' in mod_ldap                     |
|44940|New|Maj|2008-05-06|Httpd randomly breaks when verifying client certif|
|44981|New|Enh|2008-05-12|Digital Certificates (CN Based) for Authorization |
|45022|New|Nor|2008-05-16|Processing of escaped glob patterns in "Include" d|
|45023|Opn|Reg|2008-05-16|DEFLATE preventing 304 NOT MODIFIED response      |
|45049|Opn|Nor|2008-05-20|mod_mem_cache caches partial content when client c|
|45054|New|Nor|2008-05-21|SSLVerifyClient optional_no_ca is broken          |
|45058|New|Nor|2008-05-21|Mod_SSL does not set AUTH_TYPE with client certifi|
|45078|New|Nor|2008-05-27|mod_proxy stalls when uploading files             |
|45103|Ass|Min|2008-05-30|apachectl should do config test before reload/rest|
|45111|New|Enh|2008-06-01|make mod_usertrack use mod_unique_id if available |
|45116|New|Nor|2008-06-02|fail to check return value of apr_file_dup2() in /|
|45148|New|Enh|2008-06-06|The actual host of the request will be more helpfu|
|45184|New|Enh|2008-06-11|Regular Expression in directive ServerAlias       |
|45187|New|Maj|2008-06-11|Long File name requests gives FORBIDDEN response  |
|45225|New|Nor|2008-06-17|XBitHack breaks DirectoryIndex + MultiViews conten|
|45253|New|Nor|2008-06-23|Unable to build httpd 2.2.9 on Solaris/SPARC      |
|45257|New|Enh|2008-06-23|add (en)force option for UseCanonicalName         |
|45259|New|Enh|2008-06-23|Add /home/[a-z]/* scheme to UserDir conf          |
|45275|New|Maj|2008-06-25|Locked files during expired page renew in disk cac|
|45281|New|Enh|2008-06-25|SITE CHMOD/SEARCH                                 |
|45287|Inf|Min|2008-06-26|build failure because of difference between BSD an|
|45297|New|Min|2008-06-27|mod_dir does not manage correctly the user (r->use|
|45302|New|Enh|2008-06-28|ServerRoot directive                              |
|45355|New|Nor|2008-07-07|ab text and html output jumbo unification         |
|45356|New|Nor|2008-07-07|ab: optionally reduce resource usage (qsort and me|
|45371|New|Nor|2008-07-10|MSI installer requires uninstall of previous versi|
|45374|New|Blk|2008-07-10|Shared memory error on starting httpd with mod_lda|
|45379|Inf|Nor|2008-07-11|[Bug] svn merge, apache and trailing slashes      |
|45385|Inf|Nor|2008-07-11|unable to compile/make 2.2.9 with --enable-ldap   |
|45393|New|Nor|2008-07-14|Apache returns 500 Error when no LDAP credentials |
|45402|New|Nor|2008-07-15|mod_autoindex incorrectly fails to list files     |
|45405|New|Enh|2008-07-16|Allow binding port to be set for individual worker|
|45449|New|Nor|2008-07-21|[PATCH] Add support to WebDav to MOVE/COPY to remo|
|45456|New|Enh|2008-07-22|mod_dbd don't allow more then one database pool   |
|45487|New|Trv|2008-07-27|broken log messages on startup in win32 version   |
|45497|New|Nor|2008-07-29|Scoreboard slot leaked using MaxRequestsPerChild a|
|45512|Ass|Maj|2008-07-31|Bad Performance of mod_proxy with SSL on Solaris 1|
|45524|New|Enh|2008-08-01|Specifying multiple vhost aliases                 |
|45525|New|Enh|2008-08-01|Switch mod_autoindex to Tango icons               |
|45579|New|Nor|2008-08-06|unknown URI scheme in request-URI ignored         |
|45674|New|Enh|2008-08-22|Allow to change error code returned by "Require ld|
|45726|New|Enh|2008-09-02|Build in a maintenance functionallity             |
|45736|New|Nor|2008-09-03|mod_dav needs a directory for its locks and one sh|
|45754|New|Enh|2008-09-06|autoconf macros                                   |
|45763|New|Nor|2008-09-08|No openssl.cnf defined by default causes OpenSSL c|
|45773|New|Nor|2008-09-09|pcre build generates sources to srcdir rather than|
|45788|New|Nor|2008-09-11|mod_log_forensic output shouldn't be buffered when|
|45801|Opn|Nor|2008-09-13|SSLRequireSSL with strictrequire and satisfy any d|
|45838|New|Nor|2008-09-18|mod_authz_owner & directories                     |
|45868|New|Nor|2008-09-23|mod_mem_cache update of headers in cache object is|
|45900|New|Nor|2008-09-26|"make install" fails from read-only filesystem    |
|45905|New|Enh|2008-09-26|ErrorDocument and default URL                     |
|45922|New|Enh|2008-09-30|Expand the conditions under which "SSLVerifyClient|
|45923|New|Nor|2008-09-30|htpasswd tries to open(file, O_RDONLY | O_APPEND) |
|45926|Inf|Nor|2008-10-01|Unable to start apache 2.2.9                      |
|45986|New|Nor|2008-10-10|[info]...Invalid argument: core_output_filter: wri|
|46024|Opn|Nor|2008-10-16|--enable-static is not available in apache's confi|
|46037|Inf|Nor|2008-10-18|Configuration of trusted OCSP responder certificat|
|46040|New|Enh|2008-10-20|Check for existing version of Apache while install|
|46054|New|Nor|2008-10-21|Running httpd returns the error "bad user name nob|
|46070|New|Nor|2008-10-22|MSI installer does not validate custom installatio|
|46071|New|Enh|2008-10-22|Allowing space in between comma and last option in|
|46074|New|Enh|2008-10-23|Need of friendly and easy to use configuration gra|
|46139|New|Nor|2008-11-02|Apache Restart option is not working              |
|46140|New|Enh|2008-11-03|Change error state in balancer manager            |
|46188|Inf|Nor|2008-11-11|Core dumps in apache 2.0.59                       |
|46195|Opn|Nor|2008-11-12|ProxyPass fails with literal IPv6 address         |
|46215|New|Nor|2008-11-14|Race condition in bybusyness algorithm            |
|46231|New|Maj|2008-11-18|Connection Pooling with ajp depends on syntax ?   |
|46241|New|Enh|2008-11-19|mod_expires - ExpiresByPattern or ExpiresIf       |
|46267|New|Nor|2008-11-22|No shared modules build if use --with-apr and --wi|
|46270|New|Enh|2008-11-23|Add FIPS 140-2 mode for mod_ssl for FIPS 1.2 modul|
|46282|New|Nor|2008-11-24|apache2.2 reverse proxy causing full memory and sw|
|46316|New|Maj|2008-12-01|Proxied SSI ProxyTimeout render failure           |
|46317|Inf|Nor|2008-12-01|mod_authnz_ldap.c(373)  seg fault                 |
|46412|New|Nor|2008-12-17|make_child return value not checked               |
|46417|New|Cri|2008-12-19|[notice] Parent: child process exited with status |
|46428|Opn|Nor|2008-12-21|Spaces in URI doesn't encode in proxy-requests    |
|46442|New|Nor|2008-12-29|Semicolon in allow/deny all rules cause reverse lo|
|46449|New|Maj|2008-12-30|Output out of order from SSI include virtual      |
|46454|New|Min|2008-12-30|escaping wildcards in AddIcon filename matching   |
|46475|New|Nor|2009-01-04|build warnings.                                   |
|46499|New|Maj|2009-01-09|httpd accept() return EAGAIN error                |
|46521|New|Nor|2009-01-13|mod_dav doesn't show symlinks                     |
|46529|Ass|Nor|2009-01-14|Child httpd processes crash with Segmentation faul|
|46534|New|Nor|2009-01-14|mod_proxy_ajp scheme and port do not follow UseCan|
|46578|New|Nor|2009-01-21|Flawed header                                     |
|46582|Ver|Min|2009-01-22|RewriteMap internal functions are not well documen|
|46604|New|Nor|2009-01-26|Error thrown when trying to rpmbuild -tb httpd sou|
|46629|New|Maj|2009-01-29|Apache hanging on system calls for php and perl   |
|46634|Ass|Nor|2009-01-30|Requests sometimes take too long, wrong time taken|
|46644|New|Enh|2009-01-31|Clean way to pass custom environment variables to |
|46646|Ass|Nor|2009-02-01|check group membership is sometimes case sensitive|
|46650|Opn|Nor|2009-02-02|CustomLog enviroment condition SCRIPT_FILENAME    |
|46656|New|Enh|2009-02-03|ProxyErrorOverride inside location                |
|46669|New|Enh|2009-02-06|rotatelogs doesn't autocreate directories         |
|46671|Opn|Cri|2009-02-07|Apache periodicaly crashes .                      |
|46678|New|Nor|2009-02-09|Fixed Content-Length using mod_ext_filter with mod|
|46682|New|Nor|2009-02-09|mod_proxy EAI_AGAIN DNS failure                   |
|46685|Opn|Nor|2009-02-09|401 sent without WWW-Authenticate header when requ|
|46709|Opn|Reg|2009-02-12|Expect: 100-continue to an HTTP/1.0 server change |
|46724|Inf|Cri|2009-02-17|WinXP SP3 - Apache crashes on startup in libapr-1.|
|46743|New|Nor|2009-02-19|Inconsistent behavior of "RewriteOptions inherit" |
|46745|New|Maj|2009-02-20|ab.c error :  undefined reference to `BIO_set_call|
|46751|New|Nor|2009-02-21|Can passenv variables who's name contain '(' or ')|
|46762|New|Nor|2009-02-24|Error, SSL/TLS libraries were missing or unusable |
|46765|Opn|Nor|2009-02-25|doubled HTTP header leads to error (Redmine)      |
|46785|Inf|Nor|2009-03-02|Child process increases to 100% (CPU)             |
|46788|New|Nor|2009-03-02|Set resource limits to avoid denial of service att|
|46810|New|Nor|2009-03-05|apxs / apu-1-config outputting erroneous include p|
|46824|New|Nor|2009-03-09|RemoveOutputFilter will not work for Filters added|
|46845|Inf|Cri|2009-03-12|Apache crashes in Windows when using subversion(pr|
|46847|New|Nor|2009-03-13|WebDAV methods with encoding other than "identity"|
|46873|New|Nor|2009-03-18|feature request: connection count on balancer-mana|
|46884|New|Min|2009-03-20|Call to apu_dso_load Fails In apr_ldap_stub.c On O|
|46946|Inf|Nor|2009-03-31|mod_mbox shows email addresses in plain text      |
|46963|New|Nor|2009-04-03|KeepAliveTimout prevents child process from exitin|
|46969|New|Nor|2009-04-05|CustomLog format %m always GET on errors with loca|
|46970|New|Nor|2009-04-05|CustomLog %X does not record aborted connections w|
|47011|New|Reg|2009-04-09|mod_proxy/mod_proxy_balancer hot-standby BalancerM|
|47055|New|Blk|2009-04-20|SSLVerifyClient + Directory doesn't use cache sess|
|47063|New|Nor|2009-04-21|mod_proxy doesn't call post_request handler when t|
|47134|New|Nor|2009-05-01|Last resolve handling when sending client certific|
|47138|New|Nor|2009-05-01|Reverse Proxy & Balancer generate error fault when|
|47152|New|Maj|2009-05-04|Apache is only serving the first character in the |
|47159|New|Nor|2009-05-06|2.2.x logresolve doesn't support ipv6             |
|47167|New|Nor|2009-05-07|Authenticated sessions being switched by reverse p|
|47170|New|Enh|2009-05-08|rotatelogs ring buffer option                     |
|47180|New|Nor|2009-05-11|DBM ssl_scache setting can cause extreme performan|
|47220|Opn|Enh|2009-05-19|Access to environment variables                   |
|47241|New|Min|2009-05-22|Error in rewriting with character ':'             |
|47256|New|Enh|2009-05-23|Enable SSL on a per-port basis                    |
|47289|New|Nor|2009-05-30|Can't build with dynamic libraries on Mac OS 10.4 |
|47295|New|Nor|2009-06-01|AuthDBDUserPWQueryFmt/AuthDBDUserRealmQueryFmt in |
|47329|New|Nor|2009-06-07|SSLCADNRequest* & SSLCACertificate* silently do no|
|47340|New|Nor|2009-06-09|uldap_cache_comparedn() called without a lock     |
|47344|New|Enh|2009-06-10|[FEATURE REQUEST] RedirectCanonicalName           |
|47345|New|Enh|2009-06-10|rotatelogs timeout patch                          |
|47346|New|Maj|2009-06-10|mod_cache doesn't re-cache expired content when La|
|47387|Inf|Nor|2009-06-18|SSL_CLIENT_I_DN and SSL_CLIENT_S_DN use Email inst|
|47392|Opn|Nor|2009-06-18|<FilesMatch> is using the wrong directory         |
|47435|New|Nor|2009-06-26|mod_authz_host does reading of /etc/hosts on each |
|47438|Inf|Enh|2009-06-27|how to create a non-html "listing generated by the|
|47447|New|Enh|2009-06-29|Add possibility to use client IP as a value in Req|
|47484|New|Nor|2009-07-06|Spurious RewriteLock warning when using external m|
|47485|New|Enh|2009-07-06|HTML5 Websocket implementation                    |
|47514|New|Enh|2009-07-12|Personal data and restrictions based on subject di|
|47528|New|Maj|2009-07-14|Worker process won't restart more than once using |
|47542|New|Nor|2009-07-16|Piped logging processes killed before other proces|
|47562|Inf|Nor|2009-07-23|Apache/2.2.3 (Win32) mod_perl/2.0.3-rc1           |
|47578|New|Nor|2009-07-24|compile ERROR with ssl                            |
|47580|Opn|Nor|2009-07-25|mod_cache sends 200 response instead of 304       |
|47586|New|Nor|2009-07-27|httpd -k start doesn't start service when rotatelo|
|47591|New|Min|2009-07-27|show current HTTP_HOST in mod_status scoreboard   |
|47601|New|Enh|2009-07-29|Support X-Forwarded-For in forward proxy requests |
|47625|New|Nor|2009-08-02|2.2.12 win32 msi installer missing                |
|47634|New|Maj|2009-08-04|mod_ldap connection pool session keepalive not imp|
|47643|New|Enh|2009-08-04|added meta tags to xhtml output for ease of search|
|47650|Opn|Trv|2009-08-05|httxt2dbm calculates value size incorrectly       |
|47657|New|Nor|2009-08-06|Make WebDAV MOVE atomic when replacing files on sa|
|47659|New|Nor|2009-08-07|makefile.win needs check for DBM_LIST, dies on bui|
|47664|New|Nor|2009-08-07|ap_proxy_canonenc: does not recode all high-byte c|
|47665|Inf|Blk|2009-08-09|Apache service well launched but blank Screen     |
|47691|New|Enh|2009-08-12|libtool invocations should use --tag              |
|47693|Opn|Nor|2009-08-13|GET request has race condition w.r.t. replacement |
|47706|Inf|Nor|2009-08-19|(20014)Internal error: proxy: error reading status|
|47716|New|Min|2009-08-20|LimitRequestFieldSize and friends not merged well |
|47719|Opn|Enh|2009-08-20|Broken symbolic link (symlink) causes wrong ErrorD|
|47723|New|Nor|2009-08-22|suEXEC and low RLimitMem gives "crit: invalid uid"|
|47743|Inf|Nor|2009-08-26|mod_so segfaults at server startup in ap_find_load|
|47753|New|Nor|2009-08-27|output and error channels not explicitly passed fo|
|47778|Opn|Enh|2009-09-03|wrong exit value on graceful restart              |
|47780|New|Nor|2009-09-03|Critical errors should be marked by time and level|
|47807|Inf|Nor|2009-09-09|Proxy dialog error with Apache 2.2.13             |
|47808|New|Maj|2009-09-09|Child process core dumps when enabling CRL        |
|47814|Inf|Maj|2009-09-10|openssl_pkcs7_sign error                          |
|47838|New|Enh|2009-09-14|Ability to Dynamically Inject Current Time Into a |
|47874|New|Nor|2009-09-18|mod_fcgid crashes if added during restart         |
|47895|New|Maj|2009-09-24|Incorrect 413 error handling                      |
|47908|New|Min|2009-09-27|'invalid result code' in error_log                |
|47981|New|Nor|2009-10-12|allow language specific html-versions (index.html.|
|47982|New|Nor|2009-10-12|correctly interprete non-standard HTTP_ACCEPT_LANG|
|47988|New|Nor|2009-10-12|Segmentation fault                                |
|47989|New|Nor|2009-10-13|Junk string appended to compressed dynamic content|
|47994|New|Enh|2009-10-14|ScriptInterpreterSource apparently broken in Windo|
|48020|New|Nor|2009-10-17|KCP+ Opera support for mod_auth_digest            |
|48037|Inf|Nor|2009-10-21|mod_proxy_http does not handle asynchronous keepal|
|48045|New|Nor|2009-10-23|Apache 2 initgroups alert, Max OS X, abnormal exit|
|48057|New|Nor|2009-10-26|mod_fcgid creates 1 more process then allowed     |
|48094|New|Nor|2009-11-01|Avoid a race condition in close_worker_sockets()  |
|48107|New|Maj|2009-11-02|Mutual Authentication: Order in ca-bundle influenc|
|48115|New|Enh|2009-11-03|Duration to receive the request, generate response|
|48130|New|Maj|2009-11-04|DAV operations on large filesets consume all the O|
|48154|New|Nor|2009-11-06|Requests through mod_isapi are not parsed by HTTP_|
|48164|New|Enh|2009-11-09|add new parameters to rotatelogs                  |
|48219|New|Nor|2009-11-17|Retrying the worker for seems to omit POST variabl|
|48228|New|Nor|2009-11-18|Renegocation requires multiple client authenticati|
|48246|New|Enh|2009-11-19|Check permissions on file/directory specified for |
|48254|New|Trv|2009-11-20|Bogus "DocumentRoot does not exist" warning when s|
|48283|New|Nor|2009-11-25|Proxy errors since httpd 2.2.12 with Tomcat 6.0.20|
|48291|New|Maj|2009-11-26|mod_substitute loops                              |
|48295|Opn|Nor|2009-11-27|ProxyPassReverseCookiePath: Not changing path corr|
|48301|New|Enh|2009-11-30|Feature request: improved connection status report|
|48309|New|Maj|2009-11-30|libapreq2-2.12: "make test" fails at request.t and|
|48312|Opn|Nor|2009-11-30|ProxyPassReverseCookiePath: Not changing path corr|
|48316|Inf|Nor|2009-12-01|ap_run_insert_filter doesn't work in cache_url_han|
|48354|New|Enh|2009-12-08|void ap_custom_response is not supporting the bina|
|48360|New|Enh|2009-12-09|provide sample configuration file for inclusion in|
|48361|New|Enh|2009-12-09|Add global server option for specifying desired DS|
|48364|Opn|Nor|2009-12-10|PHP-generated pages are not cached in spite of per|
|48369|New|Enh|2009-12-10|add option to automatically restart if a script is|
|48431|New|Nor|2009-12-22|Error logging doesn't work when configured to use |
|48440|Inf|Cri|2009-12-23|Segmentation Fault                                |
|48449|Inf|Nor|2009-12-28|make distclean removes core.c and core_filters.c  |
|48465|Opn|Enh|2009-12-30|Support TCP to connect to backends                |
|48499|New|Nor|2010-01-06|mod_rewrite can't redirect to files with ? in them|
|48500|New|Nor|2010-01-06|mod_mbox mishandles right-click to open msg in new|
|48508|New|Nor|2010-01-07|BalancerMember doesn't accept nocanon directive   |
|48549|New|Enh|2010-01-14|Add Cache-Control s-maxage support                |
|48576|New|Nor|2010-01-19|MOVE or COPY in WebDAV fails with 404 when file ex|
|48585|New|Enh|2010-01-20|mod_cache no longer caches expired content        |
|48602|New|Enh|2010-01-23|use asynch ldap_compare so LDAPTimeout applies    |
|48623|New|Maj|2010-01-26|AuthLDAPURL syntax is not RFC-compliant, prevents |
|48639|New|Enh|2010-01-29|Add htcacheclean as a core monitored process      |
|48652|New|Maj|2010-02-01|"AuthType form" fails if a password contains  '&' |
|48659|New|Maj|2010-02-02|Problem with accents in filename and byte serving |
|48687|New|Nor|2010-02-05|mod_rewrite ignores trailing dot in request URI on|
|48705|New|Enh|2010-02-08|flag to allow newlines in the error log as opposed|
|48712|New|Enh|2010-02-09|Add UID and GID to status page                    |
|48719|New|Nor|2010-02-09|[BUG] mod_proxy_ajp return wrong error message whe|
|48721|New|Nor|2010-02-10|[Patch] Add ProxyAllow to mod_proxy               |
|48731|New|Maj|2010-02-11|Prefork not creating processes after 10 servers ar|
|48732|New|Nor|2010-02-12|[BUG] environment variable SCRIPT_NAME output erro|
|48769|New|Nor|2010-02-18|[PATCH] Processes in the busy list should not be k|
|48777|New|Maj|2010-02-19|proxy balancer not detecting correctly when host (|
|48780|New|Enh|2010-02-19|Enable mod_authnz_ldap to accept valid client cert|
|48792|New|Enh|2010-02-22|httpd util apachectl returns wrong status informat|
|48805|New|Nor|2010-02-23|Corrupted response for HTTPS + KEEPALIVE=ON       |
|48808|New|Enh|2010-02-24|mod_authz_owner support for POSIX access control l|
|48819|Inf|Nor|2010-02-25|After users login on the web page, the page does n|
|48842|Inf|Nor|2010-03-02|mod_log_config logs the full size of the file inst|
|48880|Opn|Nor|2010-03-09|error on make                                     |
|48888|New|Nor|2010-03-10|DOCTYPE definitions nearly 11 years out-of-date   |
|48920|New|Enh|2010-03-15|Breadcrumbs on mod_autoindex path                 |
|48921|Inf|Nor|2010-03-16|mod_mem_cache crash, version 2.2.15.0             |
|48937|New|Enh|2010-03-18|Feature proposal - support sasl_bind              |
|48949|Inf|Cri|2010-03-20|fcgid processes never get killed after graceful re|
|48958|New|Nor|2010-03-22|mod_ldap, ldap credential cache & graceful restart|
|48987|New|Trv|2010-03-25|typo in polish translation of HTTP_UNAUTHORIZED.ht|
|49037|New|Enh|2010-04-02|SSLVerifyClient require_no_ca                     |
|49043|New|Maj|2010-04-04|Using ssi include directive overwrites QUERY_STRIN|
|49058|New|Nor|2010-04-06|Prefork MPM tries to accept on closed listener soc|
|49067|New|Nor|2010-04-08|FTPOptions ShowUnAuthorizedFiles does not work    |
|49068|New|Nor|2010-04-08|UTF-8 URL Encode error                            |
|49087|New|Maj|2010-04-11|MSI installation reports "interrupted installation|
|49114|New|Maj|2010-04-13|NTFS junction directories missing from directory l|
|49123|New|Nor|2010-04-14|mod_proxy_ajp does not send the client's SSL chain|
|49131|New|Nor|2010-04-15|Very long URLs cause 404 or 403 errors with SetAct|
|49133|New|Maj|2010-04-16|Windows service recovery options do not work for A|
|49157|New|Nor|2010-04-20|Issues with xml interface for balancer manager    |
|49187|New|Nor|2010-04-26|Crash mod_mem_cache and mod_svn                   |
|49199|New|Enh|2010-04-27|Implement LDAP scope-aware caching in mod_ldap    |
|49220|New|Nor|2010-04-29|feature request for being able to disable FcgidWra|
|49239|New|Blk|2010-05-01|Apache mod_ssl gives coredump with openssl 0.9.8  |
|49277|New|Nor|2010-05-12|Expose a variable to identify SSL Session renegoti|
|49283|New|Nor|2010-05-12|Language of dates on SSI                          |
|49285|New|Enh|2010-05-13|Relative (local to current directory) URLs do not |
|49348|New|Enh|2010-05-27|[mod_log_config] Output log file name format capab|
|49385|New|Maj|2010-06-03|mod_disk_cache server side included files are inte|
|49387|Inf|Cri|2010-06-03|Unable to modify default charset setting to UTF-8 |
|49391|New|Nor|2010-06-05|mod_disk_cache needs to register a cleanup to kill|
|49396|New|Enh|2010-06-06|PATH_INFO normalization, especially relating to vo|
|49427|New|Nor|2010-06-11|mod_cgid and mod_cgi do not return proper value wh|
|49433|New|Enh|2010-06-13|improving info in server status                   |
|49439|New|Nor|2010-06-14|Bug in mod_userdir which prevents suexec from runn|
|49504|New|Nor|2010-06-25|Solaris 10/x64 worker graceful restart problem    |
|49532|New|Nor|2010-06-30|mod_cache: Set-Cookie headers are appended to cach|
|49553|New|Min|2010-07-05|Set QoS bits via APR2 API instead                 |
|49568|New|Maj|2010-07-07|Apache mod_authnz_ldap built with the MS LDAPSDK d|
|49632|Inf|Nor|2010-07-21|mod_authnz_ldap denies users when search is perfor|
|49633|New|Enh|2010-07-21|Handle AD primary groups in mod_authnz_ldap       |
|49642|New|Nor|2010-07-23|mod_rewrite mistakes encoded question mark as path|
|49643|New|Nor|2010-07-23|WebDav plus mod Negotiation causes directory creat|
|49676|New|Nor|2010-07-30|directory with german umlauts are indented by one |
|49680|New|Maj|2010-07-30|Perl script are not running on Win32, Apache 2.2.1|
|49684|New|Enh|2010-08-01|enhancement for ipv6 implementation               |
|49699|New|Nor|2010-08-03|Inconsistent Keep-alive from proxy to the origin s|
|49715|New|Maj|2010-08-06|ProxyPassMatch Url Encoder Problem                |
|49717|New|Enh|2010-08-06|PATCH: Enable SSL Timeout                         |
|49737|Inf|Nor|2010-08-10|order allow,deny does not work on IPv6            |
|49743|New|Maj|2010-08-12|SSI 'echo encoding="(url/none)"' bug              |
|49746|Opn|Enh|2010-08-12|mod_rewrite urlencode option                      |
|49766|New|Maj|2010-08-17|POST request on CGI script generating empty body c|
|49771|New|Nor|2010-08-17|After graceful restart using mod_proxy_ajp, couldn|
|49772|New|Nor|2010-08-18|mod_deflate kicks itself out on Content-Range resp|
|49798|Opn|Nor|2010-08-22|[mod_log_config] Piped Log scripts process cause w|
|49807|New|Enh|2010-08-23|hard to force Content-Type header for non static f|
|49810|New|Nor|2010-08-23|Mod_autoindex output of header/body/footer scrambl|
|49815|New|Enh|2010-08-24|Enable caching for HTTP Range requests / 206 respo|
|49829|New|Trv|2010-08-26|CGI index command line arguments excessively escap|
|49832|New|Enh|2010-08-26|void ap_custom_response is not supporting the bina|
|49859|Opn|Nor|2010-09-01|url with additional filepath generates bad environ|
|49921|New|Nor|2010-09-13|Trailers in chunked http requests are not handled |
|49926|New|Enh|2010-09-14|New option for mod_log_forensics or mod_log_config|
|49980|New|Nor|2010-09-22|can't use a FIFO for SSL key file; mod_ssl checks |
|49981|New|Enh|2010-09-22|Requesting SSLCertificateKeyFile Dialog functional|
|49990|New|Nor|2010-09-23|Feature request: implement ExpiresActive reset    |
|49996|New|Nor|2010-09-24|Proxied ErrorDocument returns 200 OK response code|
|49997|New|Nor|2010-09-24|wrowe promised me...                              |
|50004|New|Nor|2010-09-26|per-dir rewrite without DocumentRoot or RewriteBas|
|50011|New|Cri|2010-09-27|error running apache, and installing apache as a s|
|50024|New|Min|2010-09-29|Mod_cache/mod_mem_cache and mod_security combinati|
|50038|New|Enh|2010-10-01|What Directives apply to a file/directory? Resulta|
|50041|New|Min|2010-10-04|(9)Bad file descriptor: apr_socket_accept: (client|
|50051|New|Nor|2010-10-07|Log PID in first entry logged for each request    |
|50061|New|Nor|2010-10-08|Semicolon character '%3B' seems to be decoded to '|
|50082|New|Nor|2010-10-12|apachectl status returns incorrect exit code      |
|50112|New|Nor|2010-10-18|buildconf broken in two places                    |
|50116|New|Nor|2010-10-19|Apache fragments packets unnecessarily            |
|50151|New|Nor|2010-10-25|Software caused connection abort and apache proces|
|50155|Inf|Nor|2010-10-25|httpd -s attempts to read SSL certificates        |
|50172|Inf|Nor|2010-10-28|Digest allows access bypassing secuity            |
|50227|New|Enh|2010-11-07|Option to fail SSL handshake for diverted SNI conn|
|50237|Inf|Nor|2010-11-08|webdav LOCK access with multiple threads to same f|
|50261|New|Nor|2010-11-12|graceful restart with multiple listeners using pre|
|50262|New|Nor|2010-11-12|mod_rewrite log ip address vs hostname            |
|50274|New|Nor|2010-11-15|always pass CONTENT_LENGTH to the application     |
|50278|New|Nor|2010-11-16|-DFOREGROUND and ap_unixd_killpg()/ap_os_killpg() |
|50290|Inf|Nor|2010-11-18|vanilla apache 2.2.17 installation crashes (lib-ap|
|50296|New|Nor|2010-11-18|LDAPVerifyServerCert and possibly LDAPTrustedMode |
|50317|New|Nor|2010-11-22|Possible error in mod_cache's "Avoiding the Thunde|
|50336|New|Min|2010-11-25|PUT failures do not emit Allow:                   |
|50344|New|Nor|2010-11-26|ProxyPass does not handle different protocols when|
|50357|New|Enh|2010-11-28|improve matching mechanisms for mime type and enco|
|50372|New|Enh|2010-11-29|any reason for allowing ModMimeUsePathInfo only in|
|50390|New|Nor|2010-11-30|WARNING: Unrecognized options : --disable-ipv6    |
|50402|New|Nor|2010-12-02|SetEnv proxy-sendchunks is ignored for small amoun|
|50412|New|Nor|2010-12-04|if IndexOptions +XHTML, the correct MIME type shou|
|50423|Inf|Nor|2010-12-06|Apache is terminated with signal 11, Segmentation |
|50427|New|Nor|2010-12-07|Windows>=Vista+mod_auth_digest+command line=proble|
|50432|New|Enh|2010-12-08|add PCRE-mode for file based matches              |
|50436|New|Enh|2010-12-08|VirtualHost could behave like people expect it to |
|50444|New|Enh|2010-12-09|Pre-close logging handles in cgid agent           |
|50456|Inf|Nor|2010-12-10|Invalid Error 413 crash Apache                    |
|50464|New|Blk|2010-12-13|undefined reference to `BIO_set_callback' `BIO_set|
|50466|Inf|Maj|2010-12-13|httpd process doesn't recycle                     |
|50473|New|Maj|2010-12-14|zlib.dll Problem                                  |
|50521|New|Nor|2010-12-25|Comment at top of sample main config file is wrong|
|50525|New|Nor|2010-12-28|Header directive won't edit Location header from P|
|50530|New|Enh|2010-12-29|Provide rate limiting for failed authentication at|
|50532|New|Enh|2010-12-30|Mail protection                                   |
|50551|New|Nor|2011-01-06|Some proxied connections ignore ttl setting       |
|50562|Opn|Cri|2011-01-09|wrong PATH_INFO CGI environment with non-ASCII UTF|
|50584|New|Enh|2011-01-14|Add error message when RequestReadTimeout triggere|
|50592|New|Maj|2011-01-15|httpd dumps core on an IPv6 only system           |
|50602|New|Nor|2011-01-17|non thread safe functions used in apache httpd pro|
|50619|New|Min|2011-01-19|After changing resolv.conf signaling httpd doesn't|
|50628|New|Blk|2011-01-21|Core dump happens with Apache 2.2.15 using openssl|
|50630|New|Nor|2011-01-21|Apache return 500 error with authentication by LDA|
|50644|New|Enh|2011-01-24|Add support for maximum number of requests per Kee|
|50654|New|Nor|2011-01-25|FileETag ContentMD5 & Filename, optimisation to Co|
|50693|New|Nor|2011-01-31|AllowOverride Options=(not Foo) should permit no-o|
|50704|Inf|Nor|2011-02-01|mod_cache doesn't cache MultiViews                |
|50712|New|Maj|2011-02-02|Restart button only stops the server ...and do not|
|50727|New|Nor|2011-02-07|ISAPI EXTENSION_CONTROL_BLOCK Missing PostData wit|
|50765|New|Enh|2011-02-11|Runtime Backend Pinning via balancer-manager      |
|50770|New|Nor|2011-02-14|a rotatelogs issue, if time changed               |
|50773|Inf|Nor|2011-02-14|Dav lock database corruption                      |
|50774|New|Enh|2011-02-14|Have a way to invalidate cache without other reque|
|50777|New|Nor|2011-02-14|Back port buildconf specifies AC_PREREQ(2.13) fix |
|50796|New|Enh|2011-02-16|record time between keepalives in access log      |
|50807|New|Maj|2011-02-18|mod_proxy fails to send FIN response when a FIN is|
|50814|New|Nor|2011-02-21|SSI exec not working on Windows (Apache 2.x)      |
|50848|New|Enh|2011-03-01|Content Negotiation type map file precedence could|
|50869|New|Enh|2011-03-04|Need directive to control use and timeout of sessi|
|50873|New|Nor|2011-03-04|httpd does not start properly when built from sour|
|50878|New|Nor|2011-03-05|redundant operation when calling apr_stat         |
|50891|New|Nor|2011-03-08|Apache rewrites WWW-Authenticate headers from CGI |
|50902|Inf|Maj|2011-03-09|on major load on the server, poll() hangs         |
|50916|New|Nor|2011-03-11|RewriteMap program: mod_rewrite sends request but |
|50926|New|Nor|2011-03-14|unexpected <Directory> file-matching behavior     |
|50942|New|Maj|2011-03-17|Apache 2.2.16 forward proxy is 5x times slower tha|
|50945|Opn|Nor|2011-03-18|AJP: Missing support for ErrorOverride            |
|50948|Opn|Nor|2011-03-19|Connection not closed when CGI dies waiting for PO|
|50954|New|Nor|2011-03-21|ProxyRemote doesnt use CONNECT method with https s|
|50959|New|Enh|2011-03-23|Add cache-manifest to the mime type list          |
|50976|New|Nor|2011-03-26|Apache losts client's ip (%a or %h) sometimes.    |
|50999|Opn|Nor|2011-03-30|it seems the configure wrong detect my apr-util ve|
|51001|New|Nor|2011-03-31|patch for hook ap_lua_run_lua_open                |
|51005|New|Enh|2011-04-01|Allow to use username in LDAP filter              |
|51006|New|Blk|2011-04-01|Apache consume all memory and swap when setup as r|
|51019|New|Enh|2011-04-04|[PATCH] Implementation of Asynchronous processing |
|51020|Opn|Nor|2011-04-04|[PATCH] Apache/mod_fcgid.so does not start in comp|
|51022|New|Nor|2011-04-05|Segmentation fault on PUT request                 |
|51030|New|Enh|2011-04-06|Way to terminate CGI immediatly after closing conn|
|51078|Inf|Nor|2011-04-18|[PATCH] mod_fcgid spawned CGI Processes gets orpha|
|51079|New|Enh|2011-04-18|[PATCH] mod_fcgid spawned CGI Process cannot imper|
|51080|New|Nor|2011-04-18|[PATCH] mod_isapi does not support Except:100-Cont|
|51103|Opn|Nor|2011-04-21|mod_reqtimeout does not drop connection and return|
|51107|New|Min|2011-04-22|SetOutputFilter and SetInputFilter should allow "n|
|51118|New|Nor|2011-04-26|LDAP cache is cleared after graceful/restart and o|
|51127|New|Nor|2011-04-27|Make ProxyPassReverseCookiePath work as expected  |
|51168|New|Nor|2011-05-08|mod_status Total Traffic won't take account of int|
|51170|New|Nor|2011-05-09|I/O errors when using keep-alive + mod_ssl        |
|51174|New|Min|2011-05-09|SSLRequire predicates using OIDs unknown to openss|
|51186|New|Blk|2011-05-11|NEw Openssl 1.0.1 with new FIPS                   |
|51190|New|Min|2011-05-12|::/0 does not work with allow from and deny from  |
|51194|New|Nor|2011-05-13|FcgidWrapper does not support paths containing a s|
|51201|Inf|Nor|2011-05-15|Strange behavior REQUEST_METHOD & GET in mod_rewri|
|51223|New|Nor|2011-05-18|304 HTTP Not Modified strips out CORS headers     |
|51224|New|Nor|2011-05-18|mod_dav_fs should respect FileETag                |
|51239|New|Nor|2011-05-21|ap_get_client_block may block continuously sometim|
|51257|New|Nor|2011-05-24|Build failed when cross-compiling: ./gen_test_char|
|51258|New|Enh|2011-05-24|new features for mod_substitute                   |
|51296|New|Enh|2011-05-31|Dynamic engine support using SSLCryptoDevice suppo|
|51297|New|Nor|2011-05-31|Improve error handling during "UNLOCK"            |
|51303|New|Nor|2011-05-31|TraceEnable 500 error                             |
|51312|New|Nor|2011-06-01|mod_filter should support adding to the Vary heade|
|51322|New|Enh|2011-06-04|Prepend and append string to LDAP search parameter|
|51359|Inf|Enh|2011-06-11|Added shebang check for //! so that .js scripts wo|
|51365|New|Nor|2011-06-13|Mod_proxy mangles query string with mod_security  |
|51402|New|Nor|2011-06-21|"ForceLanguagePriority Fallback" not working as im|
|51406|New|Maj|2011-06-21|When listing files in subdirectories, the path is |
|51409|New|Nor|2011-06-21|Sorting options accepted by ls, but ignored       |
|51471|New|Nor|2011-07-04|<DirectoryMatch>ed IndexIgnore doesn't            |
|51479|New|Enh|2011-07-05|[PATCH] AB feature to optionally read in a reusabl|
|51491|New|Nor|2011-07-08|mod_dir breaks POSTs to URLs not ending in /      |
|51495|New|Nor|2011-07-11|mod_substitute cpu and memory limit               |
|51517|New|Maj|2011-07-16|mod_proxy_fcgi is not RFC 3875 compliant (SCRIPT_F|
|51522|Ver|Trv|2011-07-18|Wrong French translation in mpm.html ("Certains Mo|
|51542|New|Nor|2011-07-22|Apache HTTP Server vs PVS-Studio                  |
|51543|New|Nor|2011-07-22|Space in username not properly escaped in log file|
|51552|Inf|Cri|2011-07-25|Apache is not starting (2.2.15)                   |
|51573|New|Enh|2011-07-28|Easy way to erase log files                       |
|51576|Inf|Nor|2011-07-28|mod_rewrite rule stopped working                  |
|51600|New|Enh|2011-08-02|Loading the same certificate in multiple virtual h|
|51603|Inf|Maj|2011-08-02|Apache accepts completely bogus HTTP requests (pos|
|51607|Inf|Nor|2011-08-03|DBDPrepareSQL ( ap_dbd_prepare ) does not work cor|
|51629|New|Nor|2011-08-05|DocumentRoot check incorrect when running under ch|
|51674|New|Blk|2011-08-18|AJP Module Bad Request                            |
|51679|New|Min|2011-08-18|Code signature key expired                        |
|51689|New|Trv|2011-08-19|Cross compiling causes multiple Listen directives |
|51695|New|Trv|2011-08-20|Code clean up (ap_rputs merge)                    |
|51707|New|Nor|2011-08-22|ProxyPassReverse issues within <Location> (differe|
|51709|New|Nor|2011-08-23|ServerName/ServerAlias don't work if Host: header |
|51711|New|Nor|2011-08-23|mod_auth_digest have broken shared mem (nonce) cod|
|51718|New|Enh|2011-08-24|Feature Request: Add shorthand to redirect any Ser|
|51725|New|Nor|2011-08-26|Multiple Range: request accepted as "Range: n-m"  |
|51732|New|Nor|2011-08-29|Inconsistencies in log messages' verbosity levels |
|51747|New|Blk|2011-08-31|mod_fcgid loads entire request into memory while p|
|51757|Inf|Enh|2011-09-02|Add support for SASL auth in LDAP                 |
|51778|Inf|Cri|2011-09-07|while buliding(make) a unix source "httpd-2.2.20.t|
|51797|Inf|Maj|2011-09-10|Crash HTTPD(Windows)                              |
|51814|New|Enh|2011-09-14|mod_proxy in Apache HTTP 2.2 FIN_WAIT2 in server s|
|51858|Inf|Nor|2011-09-21|weird error for mod_rewrite with more then 3 param|
|51864|New|Nor|2011-09-22|mod_cache returns entire entity from origin server|
|51904|New|Nor|2011-09-28|output to stderr from cgi script causes script to |
|51951|New|Nor|2011-10-04|mod_mbox hang on some e-mails on press@a.o - was I|
|51964|Ver|Nor|2011-10-05|Documentation of RewriteRule flag skip unclear    |
|51965|New|Nor|2011-10-05|--with-z=DIR not being honored                    |
|51982|Opn|Nor|2011-10-06|ProxyPassReverse / balancer://cluster/ adds slash |
|51987|Inf|Nor|2011-10-07|RewriteRule doesn't work correctly with apache 2.3|
|51994|New|Enh|2011-10-07|Mod_authn_socache should have some way to flush th|
|52004|Ver|Trv|2011-10-10|Typo "indexe" in French translation of mpm.html   |
|52007|New|Nor|2011-10-10|Content-Length: 0 not set on proxy response       |
|52038|New|Nor|2011-10-16|NameWidth works incorrectly together with Charset=|
|52039|Inf|Nor|2011-10-16|Browser mode does not always work                 |
|52043|New|Nor|2011-10-17|Directories ".", "..", and "/" do not work correct|
|52081|New|Nor|2011-10-24|segfault if mbox files have unexpected names      |
|52090|New|Maj|2011-10-26|Apache thread hangs with error 500 when sending a |
|52120|Opn|Nor|2011-11-01|mod_cache edge case: uncacheable 304 sends cached |
|52123|New|Maj|2011-11-02|DoS: High memory usage in propfind                |
|52132|New|Nor|2011-11-03|[PATCH] process activity score calculated incorrec|
|52139|New|Nor|2011-11-05|Never Syntax Error on non-existent DocumentRoot   |
|52171|Ver|Nor|2011-11-13|confusing documentation of request phases         |
|52174|New|Enh|2011-11-13|Allow hard lower-limits on the number of fcgi serv|
|52178|New|Nor|2011-11-14|IPv6 IPs as ServerName not allowed                |
|52181|Ver|Nor|2011-11-14|mod_rewrite Technical Details Ruleset Processing d|
|52195|Inf|Nor|2011-11-16|Japanese texts are garbled on mailing list archive|
|52196|Inf|Nor|2011-11-16|winnt mpm, others mpm also have this bug. pool sha|
|52207|Inf|Maj|2011-11-18|Upgrade apache version from 2.0.59 to 2.2.12 or ab|
|52222|New|Nor|2011-11-21|IndexIgnore ignores parent directories in argument|
|52247|New|Nor|2011-11-26|mod_mbox gives up on unexpected message format    |
|52248|New|Nor|2011-11-26|Bugzilla version drop-down list does not offer "un|
|52252|New|Nor|2011-11-27|luajit support broken for (at least) luajit 2.0   |
|52253|Inf|Nor|2011-11-28|Timeout doesn't work. mod_proxy_balancer strongly |
|52264|New|Enh|2011-11-30|Update and complete balancer-manager XML output   |
|52269|Inf|Nor|2011-12-01|[mod_proxy] Apache reverse proxy status code trans|
|52275|New|Nor|2011-12-02|memory leak in proxy_ajp_handler                  |
|52298|Inf|Nor|2011-12-07|Can't enter website with client certificate on an |
|52301|New|Enh|2011-12-07|Error message "RSA server certificate ... CN ... d|
|52302|New|Enh|2011-12-07|Better documentation of how server name is determi|
|52304|New|Nor|2011-12-08|<Limit> Does Not Apply When URI Is Folder         |
|52313|New|Enh|2011-12-09|htdbm enhancement: options for colon-in-username, |
|52322|Inf|Enh|2011-12-13|Providing BBC developed httpd modules for inclusio|
|52342|New|Nor|2011-12-15|ap_internal_redirect dropping filters means incons|
|52370|New|Nor|2011-12-19|apreq_decode/url_decode length miscalculation     |
|52377|New|Enh|2011-12-20|Add Directives to assert user, group, and permissi|
|52383|New|Trv|2011-12-24|Instllation log typo                              |
|52391|New|Cri|2011-12-27|100% CPU usage while using Forward Proxy          |
|52395|New|Nor|2011-12-29|reload results in different end environment to res|
|52403|New|Nor|2011-12-31|FallbackResource doesn't work for non-existent PHP|
|52408|New|Nor|2012-01-01|Directoryindex matching automatically redirects   |
|52415|New|Nor|2012-01-03|LockFile placed inappropriately                   |
|52417|New|Nor|2012-01-03|HEADERS information in the file                   |
|52435|New|Nor|2012-01-06|Apache shutdown automatically                     |
|52439|New|Enh|2012-01-09|It should be possible to treat errors in .htaccess|
|52453|New|Enh|2012-01-11|Ability to configure --logfiledir                 |
|52465|New|Nor|2012-01-13|mod_dir is allowed to redirect proxy requests     |
|52481|New|Nor|2012-01-18|Rotatelog.exe crashes Apache after setting 256MB r|
|52485|New|Nor|2012-01-19|CPU load 100%                                     |
|52494|New|Enh|2012-01-22|allow the Action directive to point in the filesys|
|52495|New|Enh|2012-01-22|CACertificate, CADNCertificate, CARevocation, Cert|
|52501|New|Cri|2012-01-23|child pid 10824 exit signal Segmentation fault (11|
|52505|New|Nor|2012-01-23|Include with directory wildcards gives errors for |
|52509|New|Nor|2012-01-23|Resources protected by .htaccess file may not be a|
|52510|New|Cri|2012-01-23|Segmentation Fault 11                             |
|52520|New|Nor|2012-01-24|ProxyRemote & NoProxy directive can not take IPv6 |
|52532|New|Trv|2012-01-26|VirtualHost added TWICE to name-virtual-host list |
|52539|New|Nor|2012-01-26|Apache mod_dav 400 Bad Request for non-existent co|
|52546|New|Nor|2012-01-27|overwrite SERVER_PROTOCOL environment             |
|52573|New|Nor|2012-02-01|mod_speling case correction fails when URI has dou|
|52578|Opn|Enh|2012-02-02|Wrong "bytes sent" logged when connection is close|
|52594|New|Nor|2012-02-03|rpmbuild -ba errors out with "File not found by gl|
|52595|New|Nor|2012-02-03|requests with gzip+chunked encoded body don't prox|
|52605|Inf|Min|2012-02-05|Please allow request lines longer than 8k         |
|52612|New|Nor|2012-02-06|Default Service Account                           |
|52616|Opn|Enh|2012-02-07|SSLUserName uses SSL_CLIENT_S_DN insted of SSL_CLI|
|52617|New|Maj|2012-02-07|Visit the rewrite page from ServerAlias domain vho|
|52623|New|Nor|2012-02-08|does not build with pcre-8.30                     |
|52644|New|Nor|2012-02-12|document how SSL FakeBasicAuth works with strange |
|52668|New|Trv|2012-02-14|More future safe patch for old MSIE ssl-unclean-sh|
|52670|New|Trv|2012-02-15|please clarify the effect of SSLStrictSNIVHostChec|
|52683|New|Enh|2012-02-16|add a symlink option that rechecks the access perm|
|52700|Inf|Blk|2012-02-17|Not rendering html content instead displaying clie|
|52703|Inf|Maj|2012-02-18|SSL+SNI+client-auth "lost" after some time        |
|52710|New|Nor|2012-02-19|mod_fcgid should set PATH_INFO when configured in |
|52756|Inf|Trv|2012-02-24|proxy_html_module LoadModule line not created in h|
|52759|New|Cri|2012-02-24|Apache httpd child process consuming high CPU Util|
|52790|New|Nor|2012-02-28|ldap caching not sufficient                       |
|52795|Opn|Nor|2012-02-29|mod_fcgid fails to spawn process in C:\Program Fil|
|52806|New|Nor|2012-03-01|configure: --with-included-apr is not supported in|
|52807|New|Nor|2012-03-01|some random strings are accepted by "configure" as|
|52816|New|Nor|2012-03-03|Potential segfault in socache_shmcb_create        |
|52817|New|Nor|2012-03-03|Long directory path sucks (but it's really a valid|
|52822|New|Nor|2012-03-04|Quiet installation not fully quiet                |
|52824|Inf|Nor|2012-03-04|Conflicts between AllowOverride and AllowOverrideL|
|52828|New|Maj|2012-03-05|Child process is not replaced in Windows, after a |
|52832|New|Nor|2012-03-05|numerical configuration entry can be mistakenly in|
|52841|Opn|Nor|2012-03-06|[proxy_balancer:emerg] [pid 25593] AH01177: Failed|
|52851|New|Nor|2012-03-07|Core TimeOut directive doesn't work               |
|52860|New|Enh|2012-03-08|Support Transfer-Encoding: gzip                   |
|52865|New|Nor|2012-03-09|Crash by segmentation fault in mod_authn_core in A|
|52870|New|Cri|2012-03-09|100% CPU usage while using Forward Proxy          |
|52874|New|Enh|2012-03-09|Support Use TrustedFirst checking when verifying c|
|52884|New|Nor|2012-03-12|"localhost" leads to start failure                |
|52890|Inf|Nor|2012-03-12|--with-included-apr doesn't work when srclib/apr a|
|52891|New|Nor|2012-03-12|2.2 doesn't perform as well as 1.3                |
|52894|Inf|Nor|2012-03-13|Apache aborts abnormally when ChrootDir is set    |
|52927|Inf|Nor|2012-03-16|[Bug in httpd 2.2.4] [error] (70014)End of file fo|
|52933|New|Nor|2012-03-17|Child survives '-k stop', consuming lots of CPU   |
|52950|New|Nor|2012-03-20|Error when set AuthType to None with valid-user   |
|52963|New|Nor|2012-03-21|Typo in AuthLDAPURL RFC 2255 error message        |
|52975|New|Nor|2012-03-23|Receiving files is suboptimal                     |
|52976|New|Min|2012-03-23|Gratuitous string-duplication in module-configurat|
|52978|New|Enh|2012-03-23|Binding to an interface instead of an address     |
|52995|New|Nor|2012-03-28|httpd -V does not print the default Mutex         |
|53002|New|Nor|2012-03-29|<Location> and auth_form (trailing slash problem?)|
|53015|New|Nor|2012-03-31|missing apr_socket_close                          |
|53016|New|Nor|2012-03-31|missing apr_brigade_destroy                       |
|53023|New|Nor|2012-04-02|mod_rewrite RewriteCond parser error and documenta|
|53037|New|Enh|2012-04-05|clarify mod_ssl documentation on the UID/GID conte|
|53059|New|Nor|2012-04-10|Make httpd easier relocatable by using a variable |
|53098|New|Nor|2012-04-18|mod_proxy_ajp: patch to set worker secret passed t|
|53099|New|Enh|2012-04-18|feature request for mod_remoteip                  |
|53108|New|Enh|2012-04-19|clarification on url-path vs full filesystem path |
|53111|New|Nor|2012-04-20|1% of CMS sites expose database passwords         |
|53121|New|Nor|2012-04-22|Confusing documentation, gzip and deflate         |
|53149|New|Enh|2012-04-25|mod_ldap should/could use mod_socache             |
|53152|Opn|Nor|2012-04-26|RewriteRule documentation: Error about per-directo|
|53156|New|Enh|2012-04-27|CRL validation fails if CRL is missing            |
|53160|New|Cri|2012-04-29|Reverse Proxy mod_deflate doesn't zip back content|
|53183|New|Min|2012-05-03|mod_apreq2 entry point is apreq_module and not apr|
|53193|New|Nor|2012-05-04|SLVerifyClient optional_no_ca + SSLSessionCache = |
|53218|New|Blk|2012-05-11|ProxyPass worker name　(http://localhost:3128/...|
|53233|New|Maj|2012-05-15|Internal error: proxy: error reading status line f|
|53239|New|Maj|2012-05-16|Httpd has problems delivering data on rate-limited|
|53253|New|Maj|2012-05-17|TCP_NOPUSH used with sendfile(2), cause transfers |
|53284|New|Nor|2012-05-24|crash                                             |
|53290|New|Maj|2012-05-24|memory usage                                      |
|53292|New|Min|2012-05-25|add support for HTTP status code 308              |
|53305|New|Nor|2012-05-28|404 errors when adding query string in a balancer |
|53313|New|Nor|2012-05-28|SSI #echo VAR fails (#include OK) if URI/URL has f|
|53319|New|Nor|2012-05-29|Multiple DirectoryIndex statements in the same con|
|53332|New|Nor|2012-05-30|Requests with chunked encoding have no body availa|
|53350|New|Nor|2012-06-01|mod_cache caching 403 responses Apahce 2.2.22     |
|53351|New|Nor|2012-06-02|make fails if layout begins on first line of confi|
|53388|Opn|Nor|2012-06-08|mod_proxy_balanser generates 503 when proxying to |
|53402|New|Trv|2012-06-12|Incorrect error message for mod_ldap params       |
|53461|Inf|Cri|2012-06-23|Compilation problems                              |
|53462|New|Nor|2012-06-25|mod_rewrite does not remove trailing slash when as|
|53479|New|Nor|2012-06-27|mod_rewrite [B] flag should percent-encode the spa|
|53483|New|Enh|2012-06-29|dangerous PCRE patterns in *Match directives      |
|53539|New|Maj|2012-07-12|content type and character set are changing when t|
|53554|New|Nor|2012-07-16|Wrong case for hexadecimal percent encoding [patch|
|53555|New|Maj|2012-07-17|Scoreboard full error with event/ssl              |
|53579|New|Cri|2012-07-20|httpd looping writing on a pipe and unresponsive (|
|53581|New|Blk|2012-07-21|FollowSymlinks doesn't work with DirectoryMatch an|
|53594|New|Enh|2012-07-24|ipad as webserver                                 |
|53595|New|Nor|2012-07-24|Media type qs parameters for MultiViews sent in Co|
|53612|Inf|Nor|2012-07-27|Reverse Proxy causing 500 error SSL proxy 1.0.1c O|
|53618|New|Nor|2012-07-29|proxy_worker_shared fields not maintained in threa|
|53634|New|Nor|2012-08-01|mod_cache returning HTTP 200 for nonexistent resou|
|53638|New|Nor|2012-08-02|Problem with shortcuts to bugzilla in http://httpd|
|53640|Inf|Maj|2012-08-02|make: Fatal error: Command failed for target `htpa|
|53643|New|Cri|2012-08-02|apache segfaults with mod_authn_dbd when dbd_min i|
|53646|New|Nor|2012-08-02|Invalid uniformly distributed balancing of request|
|53651|New|Nor|2012-08-03|Worker failure doesn't have same behaviour as work|
|53667|New|Enh|2012-08-07|Add an equivalent option to "JkOptions ForwardLoca|
|53669|New|Nor|2012-08-07|IndexOptions Incremental IndexOptions documentatio|
|53686|New|Enh|2012-08-09|Status "501 Not Implemented" sent very late       |
|53690|New|Nor|2012-08-09|Calls to semctl() trigger "uninitialized memory" w|
|53692|New|Nor|2012-08-10|mod_auth_form loses request body before login page|
|53693|Opn|Nor|2012-08-10|mod_fcgid performance suffers under increase in re|
|53704|New|Enh|2012-08-13|True online configuration is needed - via LDAP?   |
|53705|New|Nor|2012-08-13|Align server-status balancer display to balancer-m|
|53706|New|Enh|2012-08-13|Include a status display for mod_ldap when present|
|53722|New|Nor|2012-08-15|when -D NO_DETACH is used, no PID file should be c|
|53736|New|Nor|2012-08-17|/balancer-manager doesn't save runtime adjusted se|
|53757|New|Enh|2012-08-21|RewriteMap of type txt should allow specifying col|
|53767|New|Nor|2012-08-23|htcacheclean deletes stale "vary" header files eve|
|53772|New|Nor|2012-08-24|REDIRECT_URL not accessible in mod_proxy          |
|53787|New|Reg|2012-08-28|In forward proxy, doesn't cache disk anymore      |
|53823|New|Nor|2012-09-03|[patch] pure IPv6 only host fix (server/config.c) |
|53835|New|Cri|2012-09-06|mod_proxy_ajp truncate output when using deflate i|
|53870|New|Maj|2012-09-13|Deadlock in CRYPTO_add_lock with Apache 2.2.22 wor|
|53886|New|Nor|2012-09-18|can't start apache control in Redhat Linux 3 X64  |
|53899|New|Nor|2012-09-19|SSL_OP_ALL disables the mitigation code for CVE-20|
|53915|New|Nor|2012-09-21|Colon lost when :port is used in CacheKeyBaseURL  |
|53919|Inf|Enh|2012-09-21|DEFAULT_LOG_FORMAT is not RFC6302 compliant       |
|53923|New|Min|2012-09-23|Overriding CustomLog directive seems impossible   |
|53932|New|Nor|2012-09-25|PROPFIND doesn't support If, If-Match ETag predica|
|53947|New|Enh|2012-09-29|Feature Request, RewriteRule - ProxyPreserveHost f|
|53961|New|Nor|2012-10-04|Null sessions to the default vhost                |
|53970|New|Nor|2012-10-05|Network control directives affects internal subreq|
|53981|New|Nor|2012-10-08|move def of log_request_state from mod_log_config.|
|53988|New|Enh|2012-10-10|Missing FCGIWrapper script should not be a critica|
|53999|Opn|Nor|2012-10-13|Deadlock between procmgr_send_spawn_cmd()/proctabl|
|54030|New|Enh|2012-10-19|Support subjectAltName when (reverse-)proxying    |
|54033|New|Enh|2012-10-21|Parent languages are not ordered according to Acce|
|54072|New|Reg|2012-10-30|Syntax error front-end virtual-path too long      |
|54102|New|Enh|2012-11-05|new feature: automatic route detection            |
|54118|New|Nor|2012-11-08|Handle leak on parent httpd process when rotatelog|
|54126|New|Maj|2012-11-09|Mod_rewrite failing because of url in query string|
|54134|New|Enh|2012-11-11|new feature: ability to use multiple routes in sti|
|54136|New|Min|2012-11-11|balancer-handler shows xml not, when only xml para|
|54158|New|Nor|2012-11-16|Suggestion regarding 2.0 to 2.2 Upgrade Documentat|
|54183|Inf|Nor|2012-11-21|PROPFIND doesn't report getcontenttype property   |
|54215|New|Maj|2012-11-27|configure fails for httpd 2.2.3 with openssl 1.0.1|
|54221|Opn|Nor|2012-11-28|no ErrorLog prefix on CGI errors                  |
|54222|New|Min|2012-11-28|ServerTokens checking is not complete             |
|54223|New|Nor|2012-11-29|AH00554 error when runtime configuration Includes |
|54252|New|Nor|2012-12-05|acinclude.m4 requires -lz when linking with ssl st|
|54253|New|Nor|2012-12-05|mod_proxy_ftp doesn't handle/log partial or cancel|
|54255|New|Nor|2012-12-06|mod_deflate adjusts the headers "too late", should|
|54269|New|Maj|2012-12-09|mod_proxy_html documentation misses several things|
|54276|New|Nor|2012-12-10|rotatelogs not getting killed on graceful restart |
|54280|New|Nor|2012-12-11|mod_auth_form inline login not working with traili|
|54281|New|Nor|2012-12-11|Stick use Partial parameters from query string    |
|54289|New|Nor|2012-12-13|"ap_get_brigade" api is failing in "AP_MODE_SPECUL|
|54306|New|Enh|2012-12-15|add regexp versions of ProxyPassReverse, ProxyPass|
|54309|New|Trv|2012-12-15|clarification on the <Location> directive when use|
|54310|Opn|Nor|2012-12-15|mod_proxy_html drops meta elements with http-equiv|
|54319|New|Reg|2012-12-17|ProxyPass has no effect in <Location> if rewrite o|
|54339|New|Nor|2012-12-21|piped log entries > PIPE_BUF can be interleaved   |
|54342|New|Nor|2012-12-22|AuthnCacheSOCache can't pass args to socache provi|
|54343|New|Maj|2012-12-22|Add sanity checks for malloc() in mpm_winnt.c and |
|54358|New|Nor|2012-12-29|Status 500 when using ldap on Solaris because apr_|
|54363|New|Nor|2012-12-31|make time conversion caching functions thread-safe|
|54364|New|Nor|2012-12-31|Add ref to mod_fcgid docs                         |
|54365|New|Nor|2013-01-02|Connection closed by server during file transfer  |
|54366|New|Nor|2013-01-02|$sysconfdir/extra/httpd-dav.conf is not built base|
|54367|Opn|Maj|2013-01-02|Location header in response to PUT is not %-escape|
|54385|New|Enh|2013-01-08|SSL configuration independent from virtual hosts, |
|54401|New|Nor|2013-01-10|Suggest to make ProxyPassReverseCookieDomain accep|
|54415|New|Enh|2013-01-14|Please tell the root cause of mutex and scoreboard|
|54431|Inf|Blk|2013-01-16|Unable to start the Apache 2.4.3 windows service. |
|54498|New|Nor|2013-01-28|apache crash on any cgi request with certain http |
|54502|New|Nor|2013-01-29|Apache deadlock on epoll_ctl error (1000 process l|
|54512|Inf|Cri|2013-01-31|Apache hung                                       |
|54517|New|Nor|2013-02-01|proxy balancer: timeout or partial failure of back|
|54518|New|Nor|2013-02-01|mod_rewrite not adding Vary header                |
|54519|New|Nor|2013-02-02|httpd already running                             |
|54526|New|Nor|2013-02-05|mod_proxy_http ignores request abortion           |
|54543|New|Enh|2013-02-10|Compile regex only when need                      |
|54546|New|Nor|2013-02-11|httpd crashes on first HUP after change Listen dir|
|54549|New|Nor|2013-02-11|mod_mime AddEncoding and mod_negotiation fix_encod|
|54556|New|Enh|2013-02-13|New flag to add default rule in rule chain        |
|54560|New|Nor|2013-02-13|Potential segfault on return from ap_server_root_r|
|54563|New|Maj|2013-02-15|mod_webdav ignores quota                          |
|54578|New|Nor|2013-02-18|Bad docs or unchecked code for "LimitRequestFields|
|54605|New|Enh|2013-02-24|mod_negotiation should cache the info it generates|
|54608|New|Enh|2013-02-25|Support an option to allow page caching when using|
|54622|New|Nor|2013-02-28|shared memory cleanup                             |
|54626|New|Nor|2013-03-01|mod_authnz_ldap through util_ldap.c does not suppo|
|54633|New|Nor|2013-03-04|Invalid % encoding not rejected                   |
|54637|New|Nor|2013-03-05|Digest: secret not used                           |
|54640|New|Nor|2013-03-05|Slow transaction on a balance member is holding su|
|54649|New|Nor|2013-03-06|Incorrect PIDFILE prevent httpd restart           |
|54653|New|Min|2013-03-08|Suggestion to add https example for forward proxy |
|54656|New|Maj|2013-03-09|SNI and SSLProxyCheckPeerCN based on "connection" |
|54657|New|Nor|2013-03-09|DNS lookup failure for load balancer member does n|
|54683|New|Min|2013-03-13|Ignor directive ErrorDocument with null byte      |
|54699|Opn|Enh|2013-03-15|[feature request] cli webaccess tester            |
|54701|New|Cri|2013-03-15|Apache 2.4.3 Migration Issue Not loading the pages|
|54704|New|Nor|2013-03-15|Web Services stalling on it's own                 |
|54719|New|Nor|2013-03-18|httpd should check for and eventually create pid f|
|54752|New|Nor|2013-03-25|mod_ssl should not use uninitialized memory as ran|
|54782|New|Nor|2013-04-02|Memory Corruption errors - mpm_worker mod_perl    |
|54785|New|Nor|2013-04-02|Random crash when httpd server is stopped         |
|54793|New|Nor|2013-04-03|Socket timeout handler can delete uploaded files P|
|54794|New|Reg|2013-04-03|mod_wsgi|fcgid and subversion >= 1.7 issues       |
|54795|New|Nor|2013-04-03|'apxs -g -n' should be self-referring             |
|54796|Inf|Enh|2013-04-03|CustomLog should be able to use syslog as ErrorLog|
|54804|New|Nor|2013-04-05|mod_fcgid sends a Continue 100 response automatica|
|54813|New|Nor|2013-04-08|documnt the Require args used by authz_dbm includi|
|54816|Inf|Nor|2013-04-08|AH00566: request failed: invalid characters in URI|
|54817|New|Nor|2013-04-09|if prefix and sysconfdir are the same then http.co|
|54820|Inf|Cri|2013-04-09|REwriterule stops working                         |
|54824|New|Nor|2013-04-10|Spec file is missing libuuid-devel requirement    |
|54830|New|Enh|2013-04-11|Make SSLPProxyMachineCertificateFile configurable |
|54848|New|Nor|2013-04-15|Client field too short for IPv6 addresses         |
|54856|Inf|Enh|2013-04-17|NSCreateObjectFileImageFromFile                   |
|54858|New|Nor|2013-04-17|ld duplicate                                      |
|54861|New|Blk|2013-04-18|The number of connections with mysql is more      |
|54869|Inf|Nor|2013-04-19|Non-breaking space characters cause httpd to choke|
|54875|New|Nor|2013-04-23|Conditional request predicated on another URL's ET|
|54878|New|Nor|2013-04-23|Multiple Listen directives prevent server to start|
|54905|Inf|Cri|2013-04-29|Apache2 loops in child Segfaults                  |
|54910|New|Enh|2013-04-30|Format %{Foobar}o cannot be used to log Date and S|
|54911|New|Enh|2013-04-30|Allow logging of fields set by a backend server in|
|54914|New|Nor|2013-04-30|mod_dir DirectoryIndex breaks WebDAV PROPFIND / DE|
|54915|New|Nor|2013-04-30|GET on a WebDAV-enabled collection, with Directory|
|54918|New|Enh|2013-05-02|Implement RFC 6797 HTTP Strict Transport Security |
|54919|Inf|Nor|2013-05-02|*** glibc detected *** /usr/sbin/httpd: double fre|
|54930|New|Nor|2013-05-06|Allow empty message in ErrorDocument directive    |
|54934|Inf|Cri|2013-05-07|Apache is crashing intermittently with a message "|
|54936|New|Nor|2013-05-08|Some potential bugs reported by static analysis to|
|54949|New|Nor|2013-05-10|[PATCH] mod_cache: fix uninitialized tmppath varia|
|54952|Inf|Cri|2013-05-10|[Fri May 10 17:39:01 2013] [error] proxy: CLUSTER:|
|54953|New|Nor|2013-05-11|<VirtualHost 0.0.0.0:80> matches IPv6             |
|54958|New|Nor|2013-05-13|mod_deflate + mod_mime with SSI gives mixed compre|
|54962|New|Maj|2013-05-14|Apache will set incorrect Content-Length header an|
|54965|New|Enh|2013-05-14|Allow ProxyPassMatch in Directory context         |
|54976|New|Nor|2013-05-15|ProxyPass parameter "acquire" and "ttl" ignored in|
|54986|New|Maj|2013-05-16|httpd hanging on large form submit in ap_run_handl|
|54989|New|Nor|2013-05-17|Apache Segfaults on OS X at random - how can I dia|
|54993|New|Nor|2013-05-20|Critical error: File descriptor in bad state: apr_|
|54998|Ver|Nor|2013-05-21|Apache 2.4 terminates all SSL connections using an|
|55000|New|Nor|2013-05-21|Memory usage per process doubles when Apache is co|
|55021|New|Enh|2013-05-28|Support arbitrary sql to authentication username/p|
|55022|Inf|Cri|2013-05-28|child pid 3123 exit signal Bus error (10) - Apache|
|55034|Inf|Maj|2013-05-31|Apache 2.4.4 won't open more that 32k VH file hand|
|55039|New|Enh|2013-05-31|"RequestHeader edit" can't access environment vari|
|55045|New|Nor|2013-06-01|calls to gets() in test_find.c and test_parser.c  |
|55068|New|Enh|2013-06-06|root permissions when writing to per vhosts errorl|
|55069|New|Min|2013-06-06|notice message in error_log even when LogLevel err|
|55070|Opn|Enh|2013-06-06|mod_fcgid stderr always goes to main error log    |
|55072|New|Nor|2013-06-07|ErrorLog doesn't work well when apache shutdown   |
|55093|New|Nor|2013-06-12|[PATCH] mod_fcgid 2.3.7 truncates large posts on R|
|55096|New|Nor|2013-06-12|Make not running on httpd configure Solaris       |
|55098|New|Nor|2013-06-13|does not listen to IP4 when both IP4 address and I|
|55106|New|Enh|2013-06-17|ProxyErrorOverride considers response codes >= 400|
|55117|New|Nor|2013-06-18|GracefullTimeout for worker threads               |
|55148|Inf|Nor|2013-06-26|Error during SSL Handshake with remote server     |
|55152|New|Nor|2013-06-28|graceful restart adjusts to new balancer members, |
|55156|New|Nor|2013-06-28|mod_cache not respecting s-maxage cache-control he|
|55178|New|Nor|2013-07-01|[PATCH] mod_authnz_ldap SASL authentication suppor|
|55192|New|Trv|2013-07-03|htaccess error messages missing request context   |
|55193|New|Min|2013-07-03|ErrorLogFormat is ignored by some modules         |
|55226|New|Enh|2013-07-09|Request for "domain cluster" feature for mod_proxy|
|55234|New|Maj|2013-07-10|Working of attribute "protocol" attribute "protoco|
|55276|Inf|Enh|2013-07-17|Add REST API for load balancer for dynamic registr|
|55278|New|Nor|2013-07-18|mod_session's cookie may be empty, is repeated twi|
|55284|New|Nor|2013-07-20|repeatable segv                                   |
|55286|New|Nor|2013-07-21|Floating point exception (8) in mod_auth_digest   |
|55293|New|Nor|2013-07-22|Incorrect default MIME type for .woff fonts       |
|55306|New|Nor|2013-07-25|Error when copying svn repository, which contains |
|55323|New|Nor|2013-07-29|Double unescaped uri in sub request handler       |
|55327|New|Nor|2013-07-30|Segmentation fault when stopping Apache 2.4.6 norm|
|55340|New|Maj|2013-08-01|Listen for valid, unconfigured IP address passes c|
|55344|New|Nor|2013-08-02|missing ap_hook_monitor on windows                |
|55346|New|Nor|2013-08-02|When on filled quota filesystem, mod_fcgid init in|
|55348|New|Nor|2013-08-02|%h is not changed in logging, only %a             |
|55351|New|Enh|2013-08-04|allow ProxyPassReverseCookieDomain to automaticall|
|55362|New|Nor|2013-08-05|Apache httpd sends "400 Bad Request" to client due|
|55379|New|Min|2013-08-07|htdigest -c doesn't behave as described anymore   |
|55394|New|Nor|2013-08-09|apache 2.4 randomy crashes with signal 6          |
|55401|New|Enh|2013-08-11|document that force-proxy-request-1.0 implies prox|
|55415|New|Maj|2013-08-14|Proxy loop caused by ProxyErrorOverride and ErrorD|
|55431|New|Nor|2013-08-16|mod_negotation does not force the mime type listed|
|55433|New|Nor|2013-08-16|mod_proxy ignores final status code for aborted re|
|55443|Inf|Maj|2013-08-17|never gives 300 multiple choices                  |
|55445|New|Maj|2013-08-18|mod_socache_memcache ignores expiry, creating eter|
|55447|New|Enh|2013-08-18|make type-maps usable again, by making them access|
|55448|New|Nor|2013-08-19|segfault in set_max_workers at event.c:3194 on SIG|
|55449|New|Maj|2013-08-19|AH01185: worker slotmem_create failed --> slotmem |
|55452|New|Maj|2013-08-19|Redirect                                          |
|55458|New|Enh|2013-08-20|allow to configure what mod_ssl responds when one |
|55460|New|Enh|2013-08-21|allow service names to be used in the Listen direc|
|55467|New|Nor|2013-08-21|Support for OpenSSL custom TLS extensions and supp|
|55523|New|Trv|2013-09-04|auth_groupfile error log on access even though suc|
|55535|Inf|Nor|2013-09-08|incorrect check state parametr                    |
|55540|New|Cri|2013-09-09|mod_proxy gzip chunked issue (sample site provided|
|55549|New|Min|2013-09-11|AuthLDAPSubGroupAttribute doesn't do anything     |
|55550|New|Nor|2013-09-11|AuthLDAPSubGroupClass checking is very inefficient|
|55556|New|Nor|2013-09-13|apachebench (ab) doesn't use so_reuseaddr         |
|55557|New|Nor|2013-09-14|Some cppcheck reports                             |
|55573|New|Enh|2013-09-19|FileETag needs MTimeSeconds, MTime with granularit|
|55581|New|Enh|2013-09-22|Support concurrent connections to same FastCGI pro|
|55590|Inf|Maj|2013-09-24|second commit is failing if space is in file name |
|55596|New|Enh|2013-09-25|Add date format used by Expires header            |
|55607|New|Enh|2013-09-28|Re-set HOME environment variable to directory from|
|55615|New|Nor|2013-09-30|Connections are starved and not balanced when conc|
|55619|New|Nor|2013-10-02|Apache httpd reported 500 internal error when uplo|
|55627|New|Min|2013-10-04|Remove unnecessary APLOGNO() for trace logging per|
|55636|Inf|Cri|2013-10-07|long lost child came home - Apache is not respondi|
|55646|Inf|Nor|2013-10-10|non-2xx responses are not considered errors       |
|55654|New|Nor|2013-10-15|Extract variables from configuration without start|
|55670|New|Min|2013-10-18|Startup may fail silently at post_config          |
|55673|New|Nor|2013-10-18|httpd fails to start with SSLProxyMachineCertifica|
|55680|New|Enh|2013-10-20|online manual directory option doesn't exist      |
|55698|New|Maj|2013-10-24|Apache 2.2 + mod_fcgid 2.3.7 (CentOS 6.4) graceful|
|55700|New|Enh|2013-10-24|add something like RewriteOptions InheritDown     |
|55707|New|Nor|2013-10-25|SSLProtocol directive seem to be ignored over diff|
|55708|New|Nor|2013-10-25|Access violation in msvcrt.dll when calling getenv|
|55711|New|Min|2013-10-28|--enable-foo doesn't enable foo                   |
|55712|New|Nor|2013-10-28|Relative <!--#include virtual="../file.shtml"--> g|
|55720|New|Enh|2013-10-29|separate LDAP Bind timeout from LDAPTimeout       |
|55738|New|Nor|2013-11-03|PVS-Studio: few issues                            |
|55763|New|Nor|2013-11-09|raise roots soft RLIMIT_NPROC on linux for high ma|
|55774|New|Nor|2013-11-13|ab: optionally accept tls client certificate      |
|55781|New|Nor|2013-11-15|ajp_read_header: ajp_ilink_receive failed; 120006)|
|55786|New|Maj|2013-11-16|SSLVerifyClient and OptRenegotiate result in a 403|
|55787|New|Maj|2013-11-16|Chroot fails with "Cannot chroot when not started |
|55790|New|Maj|2013-11-17|mod_fcgid lockfile hardcoded to be in /tmp        |
|55793|New|Enh|2013-11-18|DTrace/SystemTap support                          |
|55808|New|Nor|2013-11-21|File integrity verification using MD5 and SHA1    |
|55819|Inf|Nor|2013-11-27|Closing connection behaviour                      |
|55828|New|Cri|2013-11-28|Httpd not start if use ProxyPass balancer://      |
|55834|New|Maj|2013-12-02|Apache does not honor the openssl library path giv|
|55838|New|Nor|2013-12-03|PHP files are being executed instead of downloaded|
|55841|New|Nor|2013-12-04|Misleading news items on bugfix releases ("This ve|
|55856|New|Nor|2013-12-08|YYEMPTY (-2) used as index into yytname (const arr|
|55866|New|Nor|2013-12-11|When ProxyPreserveHost is on, SSL expects the wron|
|55878|New|Nor|2013-12-12|mod_fcgid kills spawned processes too early       |
|55881|New|Nor|2013-12-13|segmentation fault at proxy_util.c:1546           |
|55883|New|Enh|2013-12-14|string callers of ap_expr should be able to transf|
|55887|New|Maj|2013-12-16|In Windows apache, when user access to /con, apach|
|55898|New|Enh|2013-12-17|[RFE] listen on unix socket?                      |
|55914|New|Reg|2013-12-20|child exit segmentation fault after apache gracefu|
|55919|New|Nor|2013-12-22|EPREFIX and dynamic modules                       |
|55942|New|Nor|2014-01-01|400 - Bad Request on POST (Windows Server 2012 Hyp|
|55952|New|Nor|2014-01-05|ab: SSL keep-alive fails with apr_pollset_poll: Th|
|55962|New|Enh|2014-01-06|mod_remoteip should not allow an external proxy to|
|55963|New|Nor|2014-01-07|Add application/ld+json to mime.types             |
|55981|Opn|Nor|2014-01-09|mod_mbox hang on some e-mails on user@openoffice.a|
|55985|Opn|Nor|2014-01-10|apache does not reopen logs when multiple graceful|
|55989|Opn|Enh|2014-01-11|write to error log upon RewriteRule [F]orbidden   |
|55991|New|Nor|2014-01-12|mod_charset_lite doesn't bail out on non-identity |
|56009|Inf|Cri|2014-01-14|Memory leak in httpd 2.4.3 over time with persista|
|56014|New|Nor|2014-01-15|MOd rewrite CO Cookie method the lifetime flag not|
|56028|New|Enh|2014-01-17|Add http/1.0, http/1.1 NPN advertisement to enable|
|56034|New|Nor|2014-01-20|CPU consumption due to circular linked list in ap_|
|56040|New|Enh|2014-01-21|should be able to remove Max-Age cookie parameter |
|56041|New|Enh|2014-01-21|should be able to disable session expiry increment|
|56052|New|Nor|2014-01-22|ap_session_load called multiple times for expired |
|56055|New|Nor|2014-01-23|Route is not extracted properly when a session coo|
|56064|New|Enh|2014-01-25|Optimize PNGs                                     |
|56067|New|Nor|2014-01-27|FallbackResource doesn't work if directory exists |
|56081|New|Maj|2014-01-28|Apache 2.2.26 SIGSEGVs when POST'ing data         |
|56091|Inf|Nor|2014-01-30|SSL handshake error when httpd compiled on Oracle |
|56098|New|Nor|2014-02-01|duplicate cookie                                  |
|56101|New|Cri|2014-02-03|Apache 2.4.6 ceases processing requests (scoreboar|
|56102|New|Nor|2014-02-03|SSL_CLIENT_S_DN_x509_0 is undefined in the environ|
|56109|New|Nor|2014-02-05|Cannot increase the read limit                    |
|56113|New|Nor|2014-02-06|dist commit messages missing from mail-archives di|
|56131|New|Nor|2014-02-12|ProxyPassReverse / zealously replaces Location hea|
|56135|New|Nor|2014-02-13|Add DC to list of x509 components                 |
|56152|New|Nor|2014-02-18|ProxyBlock does not accept network addresses      |
|56176|New|Nor|2014-02-21|mod_substitute truncates the response body if the |
|56188|New|Nor|2014-02-25|mod_proxy_fcgi does not send FCGI_ABORT_REQUEST on|
|56209|New|Nor|2014-03-03|Uninitialised variables in os/win32/ap_regkey.c   |
|56226|Ver|Nor|2014-03-06|per VirtualHost KeepAliveTimeout is not recognized|
|56229|New|Enh|2014-03-06|ocsp ProxyHost and ProxyPort support              |
|56230|New|Nor|2014-03-07|mod_access_compat can log a bogus client denied me|
|56235|New|Nor|2014-03-07|quotes should be optional around expr             |
|56247|New|Cri|2014-03-12|semaphore creation for proxypass                  |
|56250|New|Nor|2014-03-12|sbindir in config.layout for Apache has bin instea|
|56251|New|Nor|2014-03-12|Increase maximum length of FcgidInitialEnv string |
|56252|New|Enh|2014-03-12|make install as privileged user creates files not |
|56262|New|Nor|2014-03-14|ab does not work with extremely long cookies      |
|56264|New|Trv|2014-03-14|Confusing error with .htaccess rewrite to proxy wh|
|56270|New|Enh|2014-03-15|--with-ssl=/foo w/o pkgconfig needs help on AIX 64|
|56288|New|Enh|2014-03-19|rewrite URLs in style attributes                  |
|56289|New|Nor|2014-03-19|Buffer overflow in mod_proxy_html's string replace|
|56308|New|Nor|2014-03-24|1 second delay in handle request kills performance|
|56312|New|Nor|2014-03-25|Can't configure different balancing workers that c|
|56314|New|Nor|2014-03-25|exiting from MPM-worker child caused assert in apr|
|56326|New|Nor|2014-03-27|cache_quick_handler does not serve responses with |
|56331|New|Nor|2014-03-29|windows 'access denied' during revalidaton of reso|
|56333|New|Enh|2014-03-31|API to resume a SUSPENDED connection              |
|56362|New|Maj|2014-04-08|ldaps only works with port 636. Non-standard port |
|56379|New|Nor|2014-04-09|Number of columns in the results returned from pgs|
|56395|New|Enh|2014-04-11|Allow SERVER_ADDR environment variable to be optio|
|56404|New|Nor|2014-04-12|endless loop  when connect to a website(https)  wh|
|56413|New|Blk|2014-04-15|can not restart httpd on centos 5.10 64bit        |
|56422|New|Nor|2014-04-17|authnz_ldap with other forms of authn can fail req|
|56457|New|Nor|2014-04-25|mod_proxy_html.c: 2 * cut'n'paste errors          |
|56473|New|Nor|2014-04-30|ETags don't change when headers do                |
|56475|New|Enh|2014-04-30|Allow TLS record size to be configured            |
|56483|New|Enh|2014-05-02|add disableKeepAlivePercentage similar to tomcat h|
|56493|New|Min|2014-05-06|mod_expires should not set expires in future for s|
|56495|New|Nor|2014-05-06|Application behind mod_proxy does not get SessionH|
|56500|Opn|Enh|2014-05-07|vhosts priority order with wildcard               |
|56504|New|Nor|2014-05-08|cannot build static support binaries              |
|56508|New|Nor|2014-05-09|Requiring SNI - SSLStrictSNIVHostCheck semantics  |
|56517|New|Enh|2014-05-12|Virtualhosts cannot inherit parent CustomLog      |
|56528|New|Enh|2014-05-15|"bad flags delimiter" - improve helpfulness       |
|56541|New|Nor|2014-05-18|Proxy 502's on large file post requests           |
|56559|New|Nor|2014-05-25|multiple unix sockets in one virtualhost fails    |
|56569|New|Nor|2014-05-27|Null CRC in gzip footer with mod_cgid and ErrorDoc|
|56587|New|Nor|2014-06-03|Many VirtualHost's with SSLEngine On              |
|56590|New|Enh|2014-06-04|(REST-) API for configuring balancer manager remot|
|56594|Inf|Nor|2014-06-05|mod_authn_dbd, mod_dbd and mod_ssl                |
|56598|New|Nor|2014-06-06|Content-Length header should be always interpreted|
|56621|New|Nor|2014-06-13|Rotatelogs.exe first start                        |
|56622|New|Nor|2014-06-13|mod_reqtimeout incorrectly applies timeouts to CON|
|56626|New|Nor|2014-06-15|Add info about rotatelogs to log rotation document|
|56633|New|Nor|2014-06-16|mod_auth_basic breaks mod_autoindex               |
|56645|New|Maj|2014-06-19|socket callback with timeout callback causes infin|
|56664|New|Nor|2014-06-24|Proxy retry timeout does not cope with system time|
|56687|New|Nor|2014-07-01|ProxySourceAddress failed to bind socket to local |
|56697|New|Maj|2014-07-04|status page still shown while blocked             |
|56718|New|Nor|2014-07-14|Cleanup request Host headers when absolute URI are|
|56719|New|Nor|2014-07-14|parallel requests get served with delays          |
|56738|New|Enh|2014-07-17|Ability to extract route from cookie with regexp  |
|56740|New|Nor|2014-07-18|suspended_count not maintained properly with wstun|
|56750|New|Enh|2014-07-20|SuexecUserGroup replacement                       |
|56751|New|Maj|2014-07-20|Fails to properly mitigate Slow Post DoS attack   |
|56753|New|Nor|2014-07-21|mod_lua.so: symbol luaL_openlib: referenced symbol|
|56778|New|Nor|2014-07-28|while running make command i got this error       |
|56794|New|Nor|2014-07-31|Added AuthDBDFullAuthQuery option                 |
|56795|Inf|Nor|2014-07-31|Apache 2.4.10 Program received signal SIGPIPE, Bro|
|56818|Inf|Nor|2014-08-05|SetEnvIf may set invalid string length on empty st|
|56843|New|Enh|2014-08-12|Support different OCSP stapling max ages          |
|56868|New|Nor|2014-08-18|relative LuaRoot broken                           |
|56879|New|Nor|2014-08-22|Information disclosure                            |
|56889|New|Nor|2014-08-26|Close state never dies                            |
|56918|Opn|Blk|2014-09-06|error: 'ap_copy_scoreboard_worker' undeclared here|
|56926|New|Nor|2014-09-08|Filename causes AH02599 slotmem issue             |
|56933|New|Min|2014-09-09|not sure it's an appache bug : some browser want t|
|56942|New|Reg|2014-09-10|Unable to implement TRANSFER-CHUNKED:ENCODING with|
|56943|New|Nor|2014-09-10|mod_proxy_connect - AH02447: err/hup on backconn  |
|56977|New|Maj|2014-09-12|segfaults when using mod_mem_cache + mod_disk_cach|
|56986|New|Blk|2014-09-17|chunked Transfer-Encoding forbidden: /test/test.dl|
|57014|New|Cri|2014-09-24|Incorrect test for CC_FOR_BUILD prevents build (on|
|57023|New|Nor|2014-09-26|Socache shmcb don't cache file bigger than 11k    |
|57028|New|Enh|2014-09-27|mod_spdy - support Apache 2.4                     |
|57044|New|Nor|2014-09-29|[PatchAvailable] Use base64url in mod_unique_id ('|
|57045|New|Nor|2014-09-30|dumpio output strings are missing                 |
|57046|New|Enh|2014-09-30|Add additional parameter to enable check URL befor|
|57056|New|Maj|2014-10-03|Rewrite port is taken into hostname               |
|57067|New|Nor|2014-10-08|A proxy worker both standalone and balancer member|
|57069|New|Nor|2014-10-08|apache ssl timeout during chunked request in rever|
|57073|New|Cri|2014-10-09|Intermittent Connection Issues using default httpd|
|57085|New|Enh|2014-10-14|Implement Proxy Protocol in httpd                 |
|57087|New|Nor|2014-10-14|mod_proxy_fcgi doesn't send cgi CONTENT_LENGTH var|
|57100|Ver|Nor|2014-10-16|"SSLProtocol ALL" is ignored for virtual hosts    |
|57101|New|Enh|2014-10-16|[PATCH] Better error reporting when child spawn fa|
|57109|New|Nor|2014-10-17|GPG verification examples are wrong               |
|57119|Opn|Enh|2014-10-20|Suppress address reuse / DNS cache in mod_proxy   |
|57121|New|Nor|2014-10-21|ocsp stapling should not pass temporary server out|
|57131|New|Nor|2014-10-22|OCSP Stapling scalability concern                 |
|57159|New|Min|2014-10-28|mod_ssl OCSP Stapling directives don't support per|
|57160|New|Nor|2014-10-29|httxt2dbm doesn't generate files on NAS           |
|57174|New|Nor|2014-10-31|Update windows visual studio build                |
|57210|New|Nor|2014-11-14|LuaHookMapToStorage not firing in per-directory co|
|57211|New|Enh|2014-11-14|Config-time options                               |
|57212|Opn|Nor|2014-11-14|Headers returned by scripts are limited to 8190 by|
|57218|New|Nor|2014-11-15|[Feature Request] Apache Bench (AB) to output a cs|
|57219|New|Nor|2014-11-15|ApacheBench quits unexpectedly with high concurren|
|57220|New|Nor|2014-11-15|[Feature Request] Add option to ApacheBench to giv|
|57228|New|Nor|2014-11-17|glibc detected *** httpd: double free or corruptio|
|57229|New|Maj|2014-11-17|mod_sed dies on long lines                        |
|57286|New|Nor|2014-11-29|Symbolic links are not honoured                   |
|57298|New|Min|2014-12-02|RewriteBase inside FilesMatch behaves oddly       |
|57299|New|Enh|2014-12-02|mod_session_dbd should not make a database call pe|
|57300|New|Enh|2014-12-02|mod_session_dbd should not save the session at eac|
|57301|New|Enh|2014-12-02|Add SessionMaxAgeAbsolute Directive               |
|57304|Inf|Nor|2014-12-03|MySQL DBD Authentication Incompatible with SSL    |
|57311|New|Nor|2014-12-04|BalancerMember enclosed by <If> gives syntax error|
|57313|New|Nor|2014-12-05|The DefaultType directive has been removed        |
|57327|New|Nor|2014-12-08|mod_ssl seg fault on exit                         |
|57334|Ver|Maj|2014-12-09|Segmentation fault in SSL_renegotiate at ssl_lib.c|
|57337|New|Nor|2014-12-10|Content negotiation fails with conditional Redirec|
|57339|New|Enh|2014-12-10|ErrorLogFormat doesn't allow logging in Internet d|
|57360|New|Nor|2014-12-17|Fail gracefully on certificate/key mismatch       |
|57372|New|Nor|2014-12-19|httpd will lookup every home directory while start|
|57374|Ver|Nor|2014-12-19|Event MPM: Wrong KeepAliveTimeout when system cloc|
|57379|New|Nor|2014-12-20|[patch] Makefile.in  with mpm-shared, cgi and cgid|
|57383|New|Cri|2014-12-21|Error retrieving Report: An Existing connection wa|
|57386|New|Blk|2014-12-22|html5 lost some comments                          |
|57398|New|Maj|2014-12-26|AH01075: Error dispatching request to : (passing b|
|57399|New|Nor|2014-12-28|Many unnecessary CPU wakeups per second           |
|57406|New|Nor|2014-12-31|cgi-bin script is not executing                   |
|57412|New|Maj|2015-01-04|rewrite rules causes duplicate requests           |
|57416|New|Nor|2015-01-06|htcacheclean thinks the cache is smaller than it a|
|57424|Opn|Nor|2015-01-07|mod_rewrite not using ap_context_document_root    |
|57436|New|Enh|2015-01-12|Option to strip extra data after websocket request|
|57439|New|Enh|2015-01-13|Allow to change body timeout per location         |
|57448|New|Nor|2015-01-16|SSI <!--#set --> cannot capture backreferences fro|
|57453|New|Maj|2015-01-17|403 error when virtualhost configured with non-exi|
|57471|New|Nor|2015-01-20|Apache 2.4.10 Compilation fails when compiling aga|
|57477|New|Nor|2015-01-21|mod_auth_digest AH00052: child pid $pid exit signa|
|57483|New|Nor|2015-01-22|Omit "Keep-Alive" header on 1.1 connections       |
|57492|New|Nor|2015-01-24|incomplete chunked-transfered request body is not |
|57506|New|Nor|2015-01-27|<If> directive doesn't work within a <Location> se|
|57510|New|Enh|2015-01-28|Engine keyform support for private keys           |
|57511|New|Maj|2015-01-28|Opening plain TCP Socket on SSL port causes denial|
|57515|New|Nor|2015-01-30|Define/Undefine don't work reasonably outside of g|
|57519|New|Nor|2015-02-01|change SSLv2 to SSLv3 or remove SSLv2 support allt|
|57526|Opn|Maj|2015-02-03|Apache 2.2.29_openssl-1.0.1k_x86_64 Error creating|
|57529|Opn|Nor|2015-02-03|htcacheclean doesn't show the cached URL with '-a'|
|57585|New|Nor|2015-02-13|httpd fails to start if there is an IncludeOptiona|
|57590|New|Nor|2015-02-18|loading mod_proxy_http makes rewriteRule's [proxy]|
|57591|New|Nor|2015-02-18|DirectoryIndex directive cannot be overwritten    |
|57616|New|Maj|2015-02-23|AB - DNS roundrobin support                       |
|57624|New|Enh|2015-02-23|Provide support for http/2.0                      |
|57631|New|Nor|2015-02-24|Useless test in acinclude.m4                      |
|57632|New|Nor|2015-02-24|mod_systemd passes invalid default to APACHE_MODUL|
|57635|New|Nor|2015-02-25|meta-refresh is not rewritten by mod_proxy_html   |
|57636|New|Nor|2015-02-25|URLs without protocol are not rewriten by mod_prox|
|57641|New|Maj|2015-02-27|mod_substitute: Invalid merge order               |
|57646|New|Enh|2015-02-27|SSLEngine inside If directive                     |
|57660|New|Trv|2015-03-04|AB - free memory allocated by xmalloc and xcalloc |
|57680|New|Nor|2015-03-09|SSLSessionCacheTimeout has no effect              |
|57685|New|Nor|2015-03-10|Requests are denied while the mod_cgid daemon star|
|57691|New|Nor|2015-03-12|mod_proxy/proxy_util confuses UDS scheme with HTTP|
|57695|New|Nor|2015-03-12|[core:warn] [pid 1120] (101)Network is unreachable|
|57710|New|Nor|2015-03-15|Wildcard matching for logging headers             |
|57725|New|Enh|2015-03-18|ApacheBench: include http status code in gnuplot o|
|57742|New|Nor|2015-03-23|"reliable piped logging" doesn't work for ErrorLog|
|57745|New|Nor|2015-03-23|httpd exits 1 with no stderr when proxy_balancer_m|
|57746|New|Nor|2015-03-23|Apache hangs on startup using MPM event           |
|57751|Inf|Maj|2015-03-24|Problems with proxy reverse to websockets         |
|57756|New|Enh|2015-03-25|Config options for handling of pipelined request  |
|57757|New|Cri|2015-03-25|extern apr_xlate_t *ap_locale_to_ascii variable gi|
|57771|New|Nor|2015-03-27|cleanup_script uses incorrect connection ID       |
|57774|Inf|Nor|2015-03-28|httpd.conf <IfModule proxy_html_module> content er|
|57777|New|Nor|2015-03-30|Security concerns with documentation of AddHandler|
|57781|New|Nor|2015-03-31|disable reconnection after connection error       |
|57784|New|Enh|2015-03-31|[RFE] Multiple ErrorLog directives                |
|57795|Opn|Maj|2015-04-07|mod_proxy_wstunnel sometimes does not connect and |
|57800|New|Nor|2015-04-09|High CPU usage in ap_core_output_filter           |
|57807|New|Enh|2015-04-13|Build-configurable environment variable length    |
|57810|New|Nor|2015-04-13|Should apache ignore difference in trailing dot be|
|57813|New|Nor|2015-04-14|Rewrite 'pre-compressed content' recipe using 2.4 |
|57814|New|Nor|2015-04-14|Teach mod_deflate how to serve pre-comressed conte|
|57819|New|Nor|2015-04-15|Need a conventions document                       |
|57832|New|Enh|2015-04-19|Reduction of response splitting attacks consequenc|
|57853|Inf|Nor|2015-04-24|mod_proxy_http sends request with header 'Expect: |
|57868|New|Nor|2015-04-28|SIGSEV when lacking correct DB access permissions |
|57876|New|Reg|2015-04-30|logresolve.exe on any Windows immediately crashes |
|57878|New|Nor|2015-04-30|Using UTF-8 for all languages, and avoiding html-e|
|57895|New|Min|2015-05-05|missing m4a mimeType in mime.types                |
|57911|New|Min|2015-05-09|Rewrite documentation unclear or wrong about what |
|57927|New|Maj|2015-05-13|Segmentation Fault at proxy_util.c:994            |
|57933|New|Min|2015-05-18|apr_port_t returns constant                       |
|57941|New|Nor|2015-05-21|config.status: line 331: syntax error near unexpec|
|57949|New|Enh|2015-05-25|new mod_ssl environment variable SSL_{CLIENT|SERVE|
|57950|New|Nor|2015-05-26|[patch] buildconf change hint in build to newer ap|
|57960|New|Nor|2015-05-27|PUT truncates response body; status_line appears t|
|57976|New|Cri|2015-05-30|Server threads stale when sending 500 status with |
|57978|New|Nor|2015-06-01|unix:/ works with any number of / slashes  except |
|57979|New|Nor|2015-06-01|can not turn change log level for mod_filter      |
|57996|New|Nor|2015-06-03|Symlinks erroneously not followed when target inod|
|57997|New|Nor|2015-06-03|Threads started during child_init don't block sign|
|57999|New|Nor|2015-06-04|ap_getparents() may remove start slash of uri     |
|58001|New|Enh|2015-06-04|Implement Forwarded header (RFC 7239) to mod_proxy|
|58007|New|Nor|2015-06-06|400 Bad Request with fully qualified domain name o|
|58025|New|Enh|2015-06-11|mod_authz_dbd : new dbd-query and AuthzDBDQuery op|
|58026|New|Nor|2015-06-11|return 421 status code when SNI and Host: header d|
|58044|New|Cri|2015-06-16|Error sintax 'lua_dump'                           |
|58050|New|Nor|2015-06-17|ErrorDocument does not always work                |
|58073|New|Nor|2015-06-24|Extremely long time for graceful restart          |
|58089|New|Nor|2015-07-01|mod_authz_host uses proxy IP even when mod_remotei|
|58091|New|Nor|2015-07-02|mod_socache_memcache does not reuse memcache conne|
|58097|New|Enh|2015-07-03|[feat] Preserve original connecting IP            |
|58101|New|Nor|2015-07-05|DeflateCompressionLevel inside vhost resets logfor|
|58107|New|Blk|2015-07-06|Httpd crashes on startup every time, dump file att|
|58109|New|Nor|2015-07-06|Apache on windows cannot handle the hash symbol (#|
|58118|Inf|Min|2015-07-09|mod_proxy_fcgi logs 503 when user aborts connectio|
|58120|New|Nor|2015-07-10|ProxyPassInherit does not work as expect          |
|58121|New|Nor|2015-07-10|ProxyHTMLMeta seems to ignore all <meta http-equiv|
|58126|New|Nor|2015-07-11|[patch] acinclude.m4 fix "warning: underquoted def|
|58129|New|Nor|2015-07-12|man pages are not generated correctly             |
|58132|New|Nor|2015-07-12|non-standard, non-traditional man page layout make|
|58135|New|Nor|2015-07-14|mod_cache sends client "if-Modified-Since" to back|
|58141|New|Nor|2015-07-15|Apache Service doesn't start when rotatlogs.exe pa|
|58142|New|Nor|2015-07-15|authz_core ignores loglevel                       |
|58158|New|Nor|2015-07-21|Not honoring HTTP spec with regard to Accept-Encod|
|58168|New|Enh|2015-07-21|Would like full request evaluation support in Rewr|
|58171|New|Nor|2015-07-22|ap_session_save saves the wrong session after a de|
|58177|New|Enh|2015-07-24|Mod Proxy forward trailers in http chunked request|
|58180|New|Enh|2015-07-24|ErrorDocument original URL in subsequent <Location|
|58181|New|Enh|2015-07-25|mod_expire should allow "minus" keyword same like |
|58188|New|Nor|2015-07-28|http2 mod_lua: support build with lua 5.2+        |
|58197|New|Nor|2015-07-31|apr-util-1.5.4 build against openldap - "could not|
|58202|New|Enh|2015-07-31|apxs -q += HTTPD_MAJOR , HTTPD_MMN variables      |
|58225|New|Reg|2015-08-08|intermitant segfault 11 in session_identity_encode|
|58226|New|Nor|2015-08-08|XSS in Error Page                                 |
|58231|New|Nor|2015-08-11|RewriteCond can add "Host" to the Vary-Header     |
|58235|New|Enh|2015-08-12|Ability to allow from domain but with using forwar|
|58243|New|Nor|2015-08-14|rotatelogs goes infinite at startup               |
|58248|New|Nor|2015-08-17|Error 404 in use some characters of utf8 in url   |
|58257|New|Nor|2015-08-18|require ldap-group does not work if account-fullna|
|58278|New|Nor|2015-08-24|apache - mod_security Issue : apache no releasing |
|58280|New|Nor|2015-08-24|Backend connection not closed until timeout if cli|
|58288|New|Blk|2015-08-27|Semaphore amount increase until crash when enablin|
|58292|New|Nor|2015-08-27|FallbackResource breaks chunked encoding sometimes|
|58304|New|Nor|2015-08-30|Unexpected Warnings from Macro Use in 2.4         |
|58305|New|Nor|2015-08-30|mod_cgi documentation not clear about what is pass|
|58306|New|Nor|2015-08-30|documentation needs to make it clear which directi|
|58307|New|Nor|2015-08-31|Segmentation fault in child in "read(__nbytes, __b|
|58317|New|Min|2015-09-02|Error message AH01630 is missing file name on deny|
|58334|New|Min|2015-09-06|WebDAV HTTP access does not include meta tag for c|
|58335|New|Nor|2015-09-07|mod_authnz_ldap mismatch                          |
|58343|New|Nor|2015-09-08|The pdf files come up as a blank page.            |
|58354|New|Maj|2015-09-10|(20014)Internal error (specific information not av|
|58356|New|Blk|2015-09-10|Session jumping due to incorrect route            |
|58364|New|Reg|2015-09-11|Apache Server is restarted time to time (Release 2|
|58417|New|Min|2015-09-16|ApacheBench (ab) won't display Server Software of |
|58419|New|Nor|2015-09-16|ApacheBench (ab) doesn't work with keep-alives aga|
|58423|New|Reg|2015-09-17|Apache >= 2.4.8 PCRE_DUPNAMES causes build failure|
|58454|New|Nor|2015-09-24|Invalid FB (first byte) logging when using SSL/TLS|
|58467|New|Maj|2015-09-29|Environment Variables in ProxyHTMLURLMap produces |
|58475|New|Nor|2015-10-03|Support append/merge with semicolon-separated head|
+-----+---+---+----------+--------------------------------------------------+
| Total 1540 bugs                                                           |
+---------------------------------------------------------------------------+

From dev-return-84028-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Sun Oct  4 08:24:14 2015
Return-Path: <dev-return-84028-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 74EE918700
	for <apmail-httpd-dev-archive@www.apache.org>; Sun,  4 Oct 2015 08:24:14 +0000 (UTC)
Received: (qmail 92594 invoked by uid 500); 4 Oct 2015 08:24:14 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 92534 invoked by uid 500); 4 Oct 2015 08:24:14 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 92524 invoked by uid 99); 4 Oct 2015 08:24:13 -0000
Received: from Unknown (HELO spamd1-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 04 Oct 2015 08:24:13 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd1-us-west.apache.org (ASF Mail Server at spamd1-us-west.apache.org) with ESMTP id 92309C22B2
	for <dev@httpd.apache.org>; Sun,  4 Oct 2015 08:24:13 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd1-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 0.991
X-Spam-Level:
X-Spam-Status: No, score=0.991 tagged_above=-999 required=6.31
	tests=[KAM_LAZY_DOMAIN_SECURITY=1, T_RP_MATCHES_RCVD=-0.01,
	URIBL_BLOCKED=0.001] autolearn=disabled
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd1-us-west.apache.org [10.40.0.7]) (amavisd-new, port 10024)
	with ESMTP id SnBas4gCBjVG for <dev@httpd.apache.org>;
	Sun,  4 Oct 2015 08:24:07 +0000 (UTC)
Received: from eru.sfritsch.de (eru.sfritsch.de [188.40.99.202])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id D841F201F9
	for <dev@httpd.apache.org>; Sun,  4 Oct 2015 08:24:06 +0000 (UTC)
From: Stefan Fritsch <sf@sfritsch.de>
To: Rainer Jung <rainer.jung@kippdata.de>
Cc: dev@httpd.apache.org
Subject: Re: Expression Parser: search and replace with s/PATTERN/REPLACEMENT/FLAGS
Date: Sun, 04 Oct 2015 10:23:53 +0200
Message-ID: <5292464.4mj4i1Z6JG@k>
User-Agent: KMail/4.14.10 (Linux/4.2.0-1-amd64; KDE/4.14.12; x86_64; ; )
In-Reply-To: <560D1F3C.301@kippdata.de>
References: <560D0A3F.9010609@kippdata.de> <588DBDE2-73BA-4FF4-91CC-8F780DB88715@sharp.fm> <560D1F3C.301@kippdata.de>
MIME-Version: 1.0
Content-Transfer-Encoding: quoted-printable
Content-Type: text/plain; charset="utf-8"

On Thursday 01 October 2015 13:55:40, Rainer Jung wrote:
> Am 01.10.2015 um 12:31 schrieb Graham Leggett:
> > On 01 Oct 2015, at 12:26 PM, Rainer Jung <rainer.jung@kippdata.de>=20=

wrote:
> >> Since it gets more common to use the expression parser for string
> >> operations and not only for boolean checks, I think it would be
> >> useful (and powerful) to support
> >>=20
> >> s/PATTERN/REPLACEMENT/FLAGS
> >>=20
> >> and allow back references in REPLACEMENT. The operation would not
> >> try to do the replacement in place but create a new string
> >> according to the given PATTERN and REPLACEMENT.
> >>=20
> >> I had a quick look at the flex and bison files which generate
> >> lexer and parser but must admit that it wasn't immediately
> >> obvious to me how to do it. I can try harder but first wanted to
> >> ask if there are any volunteers who know that technology better
> >> than me. Stefan (Frisch)? Others?

I don't have much time for hacking httpd. But I will take a look.

> >> Otherwise I'll try myself (and learn new stuff on the way).
> >=20
> > We currently support a variation of this like this:
> >    <LocationMatch /path/(?<PATHNAME>[^/]+)>
> >   =20
> >      SomeDirective %{env:MATCH_PATHNAME}
> >   =20
> >    </LocationMatch>
> >=20
> > Not sure if that=E2=80=99s what you had in mind, or if you=E2=80=99=
re trying to
> > achieve something different?
> Something different. Example:
>=20
> Header set X-USER "expr=3D%{REMOTE_USER} =3D~ s/([^@]*)@.*/$1/"
>=20
> So the string result of a s/PATTERN/REPLACEMENT/ should be the
> resulting REPLACEMENT string (if REMOTE_USER is "name@domain", the
> header value would be "name").

This is a bit complicated because you would probably not want this to=20=

be a general part of the syntax of a string but rather a special case=20=

in the "whole expression returns string" mode. Currently there is not=20=

much infrastructure for behaving differently in both cases.

It may be a bit easier to implement if there was something at the=20
beginning of the expression to let the lexer recognize that this is=20
not your normal string expression and that the " =3D~ " is a special=20=

token and not a normal substring.

Maybe like "expr=3D%! %{REMOTE_USER} =3D~ s/([^@]*)@.*/$1/"

But it must not be too complicated. We don't want an unreadable mess=20=

like the sh/bash string manipulation functions.

Cheers,
Stefan



From dev-return-84029-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Sun Oct  4 10:39:09 2015
Return-Path: <dev-return-84029-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id A962718A71
	for <apmail-httpd-dev-archive@www.apache.org>; Sun,  4 Oct 2015 10:39:09 +0000 (UTC)
Received: (qmail 19742 invoked by uid 500); 4 Oct 2015 10:39:09 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 19664 invoked by uid 500); 4 Oct 2015 10:39:09 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 19654 invoked by uid 99); 4 Oct 2015 10:39:08 -0000
Received: from Unknown (HELO spamd1-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 04 Oct 2015 10:39:08 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd1-us-west.apache.org (ASF Mail Server at spamd1-us-west.apache.org) with ESMTP id 8528DC2305
	for <dev@httpd.apache.org>; Sun,  4 Oct 2015 10:39:08 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd1-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 1.892
X-Spam-Level: *
X-Spam-Status: No, score=1.892 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	KAM_BADIPHTTP=2, NORMAL_HTTP_TO_IP=0.001, T_RP_MATCHES_RCVD=-0.01,
	URIBL_BLOCKED=0.001] autolearn=disabled
Authentication-Results: spamd1-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=velox.ch header.b=Xo0jqaJd;
	dkim=pass (2048-bit key) header.d=velox.ch header.b=ELwk5Fgd
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd1-us-west.apache.org [10.40.0.7]) (amavisd-new, port 10024)
	with ESMTP id cGmCDjnUmf38 for <dev@httpd.apache.org>;
	Sun,  4 Oct 2015 10:38:54 +0000 (UTC)
Received: from fornix.velox.ch (fornix.velox.ch [85.25.46.13])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id CBF5342AB6
	for <dev@httpd.apache.org>; Sun,  4 Oct 2015 10:38:53 +0000 (UTC)
Received: from cortex.velox.ch (77-57-164-164.dclient.hispeed.ch [77.57.164.164])
	(authenticated bits=0)
	by fornix.velox.ch (8.14.9/8.14.9/2.2) with ESMTP id t94AckOQ030136
	(version=TLSv1/SSLv3 cipher=DHE-RSA-AES256-GCM-SHA384 bits=256 verify=OK)
	for <dev@httpd.apache.org>; Sun, 4 Oct 2015 12:38:47 +0200
DKIM-Signature: v=1; a=rsa-sha256; c=simple/simple; d=velox.ch;
	s=fornix-727e; t=1443955127;
	bh=elJ4WHYWQ6L2MI1N+98sl2hpDzS81bWuGVoeMC6iEOo=;
	h=From:Subject:To:References:Date:In-Reply-To;
	b=Xo0jqaJdXIEY9HP7s08XT+9+hVAMCdvZE2R36914ELEHyrb2JO2LkmKW1x6/C26r+
	 YdJ0xFOKf8Cy3pVRo3R9ndaOI/d+mmLRSE8iZhKCX7b2IK2153Rc0qlx3mS8ZrUW6s
	 7WFXEDVsPFjCAmx1KEf8PYJdu/QnquRPVRG0Jb+olXhu9tPDMXvka0k2OsMcDzXZcY
	 0g+/0cKKtw9gmeqHTh5AwMWbKfDJe0jGUIaN8jGgcMxWypZ6Gq+b3Pg8vLAZBdr4Iq
	 XdwChJpl5/NPK75VY89kooKjVcHEQFM7sFwwjYaiahHnQdmh18TPNQ5chN3RTQUkXg
	 d1/ByqXQyz3BA==
From: Kaspar Brand <httpd-dev.2014@velox.ch>
DKIM-Signature: v=1; a=rsa-sha256; c=simple/simple; d=velox.ch;
	s=cortex-8a58; t=1443955099;
	bh=elJ4WHYWQ6L2MI1N+98sl2hpDzS81bWuGVoeMC6iEOo=;
	h=From:Subject:To:References:Date:In-Reply-To;
	b=ELwk5FgdjY8DIVWfmVxVzZaUoVHF0kMf9Wl1Jvf90H0AOCDUneuJrBoIDsUh9Uv+R
	 tP0UMjaWzYqlmYNCwPmoyYcFR4Kn+DJ4+0A9hTT15+MkznVx+XGwqntB6s+Ag2pMLK
	 VfDASeNQxGyW4JVtstre9wWHZuQoJHv1gpJtbiqMDhCkjes0HQZZoCsH//VaADwk6I
	 4aovrf9iXgbN3IM2OroICAtVRaQlBDs+IE/TPDZUtQd3rUtZNihMK1U5bpT6SX66s0
	 kRinXNdRhF7Ls1LlmgVgov46YFHYm6JZtrsmKmvdnMxsdGRLHhdyUmdtn5lsMBGJ0V
	 Zv/S3NI55wCng==
Subject: Re: SSLUseStapling: ssl handshake fails until httpd restart
To: dev@httpd.apache.org
References: <560A49E5.2090500@thelounge.net> <560AAEEC.2080500@gmail.com>
 <560ABB39.2030805@thelounge.net> <560B8452.5070800@velox.ch>
 <560D1B12.4060502@thelounge.net>
 <AB1691BE05AE7F4992697F2A0835627AC6325BD7@VOEXM10W.internal.vodafone.com>
 <560D3041.2060300@thelounge.net> <560D32A3.6080800@thelounge.net>
 <AB1691BE05AE7F4992697F2A0835627AC6325C6F@VOEXM10W.internal.vodafone.com>
 <560D43E9.4020809@thelounge.net> <560F9D02.8070905@velox.ch>
 <560FA8F8.2010003@thelounge.net>
Message-ID: <5611019E.9020106@velox.ch>
Date: Sun, 4 Oct 2015 12:38:22 +0200
MIME-Version: 1.0
In-Reply-To: <560FA8F8.2010003@thelounge.net>
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit

On 03.10.2015 12:07, Reindl Harald wrote:
> Am 03.10.2015 um 11:16 schrieb Kaspar Brand:
>> What do you have security.OCSP.require set to? If it's "true" (a setting
>> no longer configurable through the UI, BTW, see
>> https://bugzilla.mozilla.org/show_bug.cgi?id=1034360), then Firefox
>> shows a fairly peculiar behavior: even when OCSP checking is disabled
>> (by setting security.OCSP.enabled to "0", through the "Query OCSP
>> responder servers to confirm the current validity of certificates"
>> preference in the UI under Advanced -> Certificates), it still includes
>> a status_request extension in the TLS handshake, and will subsequently
>> fail when it receives a stapled tryLater OCSP response, as long as
>> security.OCSP.require=true
> 
> security.OCSP.require=false is the default

Oh, looks like Firefox does sort of a "hard fail" when receiving a
stapled tryLater response - not what I would expect when
security.OCSP.require=false (and also security.OCSP.enabled=0), but
apparently, the security.ssl.enable_ocsp_stapling pref has precedence
over those.

As far as the mod_ssl side is related, it seems to me that for the
"SSLStaplingReturnResponderErrors off" case, we should make sure
that we only staple responses with status "good" (i.e.
OCSP_RESPONSE_STATUS_SUCCESSFUL and V_OCSP_CERTSTATUS_GOOD for the cert).

> but it's not only my client with random failed connections

This is really due to a very weird effect with ocsp.godaddy.com, as
further examination shows. GoDaddy is making use of Akamai's Global
Traffic Management service for "load balancing", i.e., depending on
where the client is located, you're getting one of the following
addresses back when querying for ocsp.godaddy.com.akadns.net (the CNAME
for ocsp.godaddy.com):

72.167.18.239
50.63.243.230
72.167.239.239
188.121.36.239
(the list might be incomplete, but it illustrates Akamai's GTM mechanism)

For Central Europe, you get back 188.121.36.239 (from GoDaddy's
Amsterdam data center), and from what I can tell, this site has a pretty
quirky behavior when handling new connections on port 80: the first
connection is instantaneously torn down with a TCP reset... but if you
immediately try again, the OCSP request is properly handled (for your
*.thelounge.net cert e.g., try [1]). Then, after some idle timeout, the
same effect kicks in again. I haven't been able to determine how long
the timeout is exactly, but judging from your log extracts, it seems to
be less than 30 minutes). Strangely enough, the other (US-based) sites
don't seem to exhibit this effect.

Kaspar


[1] http://188.121.36.239/MEgwRjBEMEIwQDAJBgUrDgMCGgUABBS2CA1fbGt26xPkOKX4ZguoUjM0TgQUQMK9J47MNIMwojPX+2yz8LQsgM4CByr+BC4coss=

From dev-return-84030-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Sun Oct  4 10:46:41 2015
Return-Path: <dev-return-84030-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 4C6A818A89
	for <apmail-httpd-dev-archive@www.apache.org>; Sun,  4 Oct 2015 10:46:41 +0000 (UTC)
Received: (qmail 22713 invoked by uid 500); 4 Oct 2015 10:46:40 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 22635 invoked by uid 500); 4 Oct 2015 10:46:40 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 22625 invoked by uid 99); 4 Oct 2015 10:46:40 -0000
Received: from Unknown (HELO spamd3-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 04 Oct 2015 10:46:40 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd3-us-west.apache.org (ASF Mail Server at spamd3-us-west.apache.org) with ESMTP id 4CB36180990
	for <dev@httpd.apache.org>; Sun,  4 Oct 2015 10:46:40 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd3-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.005
X-Spam-Level:
X-Spam-Status: No, score=-0.005 tagged_above=-999 required=6.31
	tests=[RP_MATCHES_RCVD=-0.006, URIBL_BLOCKED=0.001] autolearn=disabled
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd3-us-west.apache.org [10.40.0.10]) (amavisd-new, port 10024)
	with ESMTP id BBcAZHApiTxN for <dev@httpd.apache.org>;
	Sun,  4 Oct 2015 10:46:34 +0000 (UTC)
Received: from mailserver.kippdata.de (capsella.kippdata.de [195.227.30.149])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTP id E21C620381
	for <dev@httpd.apache.org>; Sun,  4 Oct 2015 10:46:33 +0000 (UTC)
Received: from [10.0.110.6] ([192.168.2.104])
	by mailserver.kippdata.de (8.13.5/8.13.5) with ESMTP id t94AkKh2022962;
	Sun, 4 Oct 2015 12:46:22 +0200 (CEST)
Subject: Re: Expression Parser: search and replace with
 s/PATTERN/REPLACEMENT/FLAGS
To: dev@httpd.apache.org
References: <560D0A3F.9010609@kippdata.de>
 <588DBDE2-73BA-4FF4-91CC-8F780DB88715@sharp.fm> <560D1F3C.301@kippdata.de>
 <5292464.4mj4i1Z6JG@k>
From: Rainer Jung <rainer.jung@kippdata.de>
Cc: Stefan Fritsch <sf@sfritsch.de>
Message-ID: <56110376.7090807@kippdata.de>
Date: Sun, 4 Oct 2015 12:46:14 +0200
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:38.0) Gecko/20100101
 Thunderbird/38.2.0
MIME-Version: 1.0
In-Reply-To: <5292464.4mj4i1Z6JG@k>
Content-Type: text/plain; charset=utf-8; format=flowed
Content-Transfer-Encoding: 8bit

Am 04.10.2015 um 10:23 schrieb Stefan Fritsch:
> On Thursday 01 October 2015 13:55:40, Rainer Jung wrote:
>> Am 01.10.2015 um 12:31 schrieb Graham Leggett:
>>> On 01 Oct 2015, at 12:26 PM, Rainer Jung <rainer.jung@kippdata.de>
> wrote:
>>>> Since it gets more common to use the expression parser for string
>>>> operations and not only for boolean checks, I think it would be
>>>> useful (and powerful) to support
>>>>
>>>> s/PATTERN/REPLACEMENT/FLAGS
>>>>
>>>> and allow back references in REPLACEMENT. The operation would not
>>>> try to do the replacement in place but create a new string
>>>> according to the given PATTERN and REPLACEMENT.
>>>>
>>>> I had a quick look at the flex and bison files which generate
>>>> lexer and parser but must admit that it wasn't immediately
>>>> obvious to me how to do it. I can try harder but first wanted to
>>>> ask if there are any volunteers who know that technology better
>>>> than me. Stefan (Frisch)? Others?
>
> I don't have much time for hacking httpd. But I will take a look.
>
>>>> Otherwise I'll try myself (and learn new stuff on the way).
>>>
>>> We currently support a variation of this like this:
>>>     <LocationMatch /path/(?<PATHNAME>[^/]+)>
>>>
>>>       SomeDirective %{env:MATCH_PATHNAME}
>>>
>>>     </LocationMatch>
>>>
>>> Not sure if that’s what you had in mind, or if you’re trying to
>>> achieve something different?
>> Something different. Example:
>>
>> Header set X-USER "expr=%{REMOTE_USER} =~ s/([^@]*)@.*/$1/"
>>
>> So the string result of a s/PATTERN/REPLACEMENT/ should be the
>> resulting REPLACEMENT string (if REMOTE_USER is "name@domain", the
>> header value would be "name").
>
> This is a bit complicated because you would probably not want this to
> be a general part of the syntax of a string but rather a special case
> in the "whole expression returns string" mode. Currently there is not
> much infrastructure for behaving differently in both cases.
>
> It may be a bit easier to implement if there was something at the
> beginning of the expression to let the lexer recognize that this is
> not your normal string expression and that the " =~ " is a special
> token and not a normal substring.
>
> Maybe like "expr=%! %{REMOTE_USER} =~ s/([^@]*)@.*/$1/"
>
> But it must not be too complicated. We don't want an unreadable mess
> like the sh/bash string manipulation functions.

Yes, I agree. When starting to think closer, I noticed that the string 
mode currently only supports a syntax that is pretty different from the 
boolean mode and is much more limited. In that mode everything is a 
string except it is marked via %{XXX}, in which case XXX is a variable 
name, except XXX is AAA:BBB in which case it is AAA("BBB").

So AFAIK we don't support functions with more than one argument in 
string mode and my naive idea of using "STRING =~ 
s/PATTERN/REPLACEMENT/FLAGS" runs into the problem, that we currently 
don't support operators like "=~" etc. in string mode.

So I wonder whether it would be useful to allow for a more general mode 
which would depending on operators or functions handle the argument and 
result as strings or booleans using auto conversion between them where 
needed. Of course in that mode verbatim strings would need proper 
quoting (unlike pure string mode in which everything by default is a 
verbatim string). We could then even support

     BOOLEXPR ? STRINGEXPR1 : STRINGEXPR 2

For compatibility that generalized mode would probably need a mode 
differentiator syntax for compatibility reasons in 2.4 but could be the 
default mode in trunk. Something like your "%!" prefix.

Regards,

Rainer

From dev-return-84031-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Sun Oct  4 10:47:00 2015
Return-Path: <dev-return-84031-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id A45A818A8F
	for <apmail-httpd-dev-archive@www.apache.org>; Sun,  4 Oct 2015 10:47:00 +0000 (UTC)
Received: (qmail 23798 invoked by uid 500); 4 Oct 2015 10:47:00 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 23717 invoked by uid 500); 4 Oct 2015 10:47:00 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 23703 invoked by uid 99); 4 Oct 2015 10:47:00 -0000
Received: from Unknown (HELO spamd3-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 04 Oct 2015 10:47:00 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd3-us-west.apache.org (ASF Mail Server at spamd3-us-west.apache.org) with ESMTP id AC4C5180990
	for <dev@httpd.apache.org>; Sun,  4 Oct 2015 10:46:59 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd3-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 1.357
X-Spam-Level: *
X-Spam-Status: No, score=1.357 tagged_above=-999 required=6.31
	tests=[KAM_LAZY_DOMAIN_SECURITY=1, RDNS_DYNAMIC=0.363,
	RP_MATCHES_RCVD=-0.006, SPF_HELO_PASS=-0.001, URIBL_BLOCKED=0.001]
	autolearn=disabled
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd3-us-west.apache.org [10.40.0.10]) (amavisd-new, port 10024)
	with ESMTP id mBY-3qfc-b9q for <dev@httpd.apache.org>;
	Sun,  4 Oct 2015 10:46:52 +0000 (UTC)
Received: from nebula.c8h10n4o2.org.uk (nebula.c8h10n4o2.org.uk [80.68.88.207])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id AA8B220381
	for <dev@httpd.apache.org>; Sun,  4 Oct 2015 10:46:51 +0000 (UTC)
Received: from consume.c8h10n4o2.org.uk ([81.2.91.98])
	by nebula.c8h10n4o2.org.uk with esmtpsa (TLS1.0:ECDHE_RSA_AES_256_CBC_SHA384:256)
	(Exim 4.84)
	(envelope-from <isoma@c8h10n4o2.org.uk>)
	id 1ZigoV-0004pW-KM
	for dev@httpd.apache.org; Sun, 04 Oct 2015 11:46:44 +0100
Content-Type: text/plain; charset=utf-8
Mime-Version: 1.0 (Mac OS X Mail 8.2 \(2104\))
Subject: Re: SSLUseStapling: ssl handshake fails until httpd restart
From: Tim Bannister <isoma@c8h10n4o2.org.uk>
In-Reply-To: <5611019E.9020106@velox.ch>
Date: Sun, 4 Oct 2015 11:46:43 +0100
Content-Transfer-Encoding: quoted-printable
Message-Id: <F1CC21C5-C052-4EC9-B50E-5CFB8CBCB6C6@c8h10n4o2.org.uk>
References: <560A49E5.2090500@thelounge.net> <560AAEEC.2080500@gmail.com> <560ABB39.2030805@thelounge.net> <560B8452.5070800@velox.ch> <560D1B12.4060502@thelounge.net> <AB1691BE05AE7F4992697F2A0835627AC6325BD7@VOEXM10W.internal.vodafone.com> <560D3041.2060300@thelounge.net> <560D32A3.6080800@thelounge.net> <AB1691BE05AE7F4992697F2A0835627AC6325C6F@VOEXM10W.internal.vodafone.com> <560D43E9.4020809@thelounge.net> <560F9D02.8070905@velox.ch> <560FA8F8.2010003@thelounge.net> <5611019E.9020106@velox.ch>
To: dev@httpd.apache.org
X-Mailer: Apple Mail (2.2104)

On 4 Oct 2015, at 11:38, Kaspar Brand wrote:
>=20
> As far as the mod_ssl side is related, it seems to me that for the =
"SSLStaplingReturnResponderErrors off" case, we should make sure that we =
only staple responses with status "good" (i.e. =
OCSP_RESPONSE_STATUS_SUCCESSFUL and V_OCSP_CERTSTATUS_GOOD for the =
cert).

If the OCSP response is successful but the status isn't =
V_OCSP_CERTSTATUS_GOOD, I'd want httpd to at least log a warning (as =
well as not stapling the OCSP information). Maybe even add a Warning: =
header for any client that's interested.

I can attempt a patch for this if other people think it'd be useful.


--=20
Tim Bannister =E2=80=93 isoma@c8h10n4o2.org.uk


From dev-return-84032-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Sun Oct  4 10:51:20 2015
Return-Path: <dev-return-84032-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id AFD7418A98
	for <apmail-httpd-dev-archive@www.apache.org>; Sun,  4 Oct 2015 10:51:20 +0000 (UTC)
Received: (qmail 27086 invoked by uid 500); 4 Oct 2015 10:51:20 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 27010 invoked by uid 500); 4 Oct 2015 10:51:20 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 26999 invoked by uid 99); 4 Oct 2015 10:51:20 -0000
Received: from Unknown (HELO spamd4-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 04 Oct 2015 10:51:20 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd4-us-west.apache.org (ASF Mail Server at spamd4-us-west.apache.org) with ESMTP id C3173C096F
	for <dev@httpd.apache.org>; Sun,  4 Oct 2015 10:51:19 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd4-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.006
X-Spam-Level:
X-Spam-Status: No, score=-0.006 tagged_above=-999 required=6.31
	tests=[RP_MATCHES_RCVD=-0.006, SPF_PASS=-0.001, URIBL_BLOCKED=0.001]
	autolearn=disabled
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd4-us-west.apache.org [10.40.0.11]) (amavisd-new, port 10024)
	with ESMTP id 7AOkhVNGmn7w for <dev@httpd.apache.org>;
	Sun,  4 Oct 2015 10:51:15 +0000 (UTC)
Received: from monica.sharp.fm (monica.sharp.fm [80.168.143.5])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTP id 3DA142095A
	for <dev@httpd.apache.org>; Sun,  4 Oct 2015 10:51:15 +0000 (UTC)
Received: from [192.168.220.234] (unknown [192.168.220.234])
	(using TLSv1 with cipher DHE-RSA-AES256-SHA (256/256 bits))
	(Client did not present a certificate)
	(Authenticated sender: minfrin@sharp.fm)
	by monica.sharp.fm (Postfix) with ESMTPSA id 7774C8314D;
	Sun,  4 Oct 2015 11:51:14 +0100 (BST)
Content-Type: text/plain; charset=utf-8
Mime-Version: 1.0 (Mac OS X Mail 8.2 \(2104\))
Subject: Re: Expression Parser: search and replace with s/PATTERN/REPLACEMENT/FLAGS
From: Graham Leggett <minfrin@sharp.fm>
In-Reply-To: <56110376.7090807@kippdata.de>
Date: Sun, 4 Oct 2015 12:51:13 +0200
Cc: Stefan Fritsch <sf@sfritsch.de>
Content-Transfer-Encoding: quoted-printable
Message-Id: <6AA47FB6-EA08-4A4D-9E93-640B4882EB96@sharp.fm>
References: <560D0A3F.9010609@kippdata.de> <588DBDE2-73BA-4FF4-91CC-8F780DB88715@sharp.fm> <560D1F3C.301@kippdata.de> <5292464.4mj4i1Z6JG@k> <56110376.7090807@kippdata.de>
To: dev@httpd.apache.org
X-Mailer: Apple Mail (2.2104)

On 04 Oct 2015, at 12:46 PM, Rainer Jung <rainer.jung@kippdata.de> =
wrote:

>> But it must not be too complicated. We don't want an unreadable mess
>> like the sh/bash string manipulation functions.

+1.

> Yes, I agree. When starting to think closer, I noticed that the string =
mode currently only supports a syntax that is pretty different from the =
boolean mode and is much more limited. In that mode everything is a =
string except it is marked via %{XXX}, in which case XXX is a variable =
name, except XXX is AAA:BBB in which case it is AAA("BBB").
>=20
> So AFAIK we don't support functions with more than one argument in =
string mode and my naive idea of using "STRING =3D~ =
s/PATTERN/REPLACEMENT/FLAGS" runs into the problem, that we currently =
don't support operators like "=3D~" etc. in string mode.
>=20
> So I wonder whether it would be useful to allow for a more general =
mode which would depending on operators or functions handle the argument =
and result as strings or booleans using auto conversion between them =
where needed. Of course in that mode verbatim strings would need proper =
quoting (unlike pure string mode in which everything by default is a =
verbatim string). We could then even support
>=20
>    BOOLEXPR ? STRINGEXPR1 : STRINGEXPR 2
>=20
> For compatibility that generalized mode would probably need a mode =
differentiator syntax for compatibility reasons in 2.4 but could be the =
default mode in trunk. Something like your "%!" prefix.

How about a regex function?

The single argument could be =E2=80=9Cs/PATTERN/REPLACEMENT/FLAGS=E2=80=9D=
.

Regards,
Graham
=E2=80=94


From dev-return-84033-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Sun Oct  4 11:11:56 2015
Return-Path: <dev-return-84033-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id E3F4718ACF
	for <apmail-httpd-dev-archive@www.apache.org>; Sun,  4 Oct 2015 11:11:55 +0000 (UTC)
Received: (qmail 43103 invoked by uid 500); 4 Oct 2015 11:11:55 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 43031 invoked by uid 500); 4 Oct 2015 11:11:55 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 43021 invoked by uid 99); 4 Oct 2015 11:11:55 -0000
Received: from Unknown (HELO spamd3-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 04 Oct 2015 11:11:55 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd3-us-west.apache.org (ASF Mail Server at spamd3-us-west.apache.org) with ESMTP id 067A31809BF
	for <dev@httpd.apache.org>; Sun,  4 Oct 2015 11:11:55 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd3-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.006
X-Spam-Level:
X-Spam-Status: No, score=-0.006 tagged_above=-999 required=6.31
	tests=[RP_MATCHES_RCVD=-0.006, SPF_PASS=-0.001, URIBL_BLOCKED=0.001]
	autolearn=disabled
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd3-us-west.apache.org [10.40.0.10]) (amavisd-new, port 10024)
	with ESMTP id DIbyN7Uf_fJ5 for <dev@httpd.apache.org>;
	Sun,  4 Oct 2015 11:11:49 +0000 (UTC)
Received: from monica.sharp.fm (monica.sharp.fm [80.168.143.5])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTP id 0D21E439C3
	for <dev@httpd.apache.org>; Sun,  4 Oct 2015 11:11:49 +0000 (UTC)
Received: from [192.168.220.234] (unknown [192.168.220.234])
	(using TLSv1 with cipher DHE-RSA-AES256-SHA (256/256 bits))
	(Client did not present a certificate)
	(Authenticated sender: minfrin@sharp.fm)
	by monica.sharp.fm (Postfix) with ESMTPSA id 880B583146;
	Sun,  4 Oct 2015 12:11:41 +0100 (BST)
Content-Type: text/plain; charset=utf-8
Mime-Version: 1.0 (Mac OS X Mail 8.2 \(2104\))
Subject: Re: Expression Parser: search and replace with s/PATTERN/REPLACEMENT/FLAGS
From: Graham Leggett <minfrin@sharp.fm>
In-Reply-To: <6AA47FB6-EA08-4A4D-9E93-640B4882EB96@sharp.fm>
Date: Sun, 4 Oct 2015 13:11:40 +0200
Cc: Stefan Fritsch <sf@sfritsch.de>
Content-Transfer-Encoding: quoted-printable
Message-Id: <26248804-5849-4678-B812-54F9710C691F@sharp.fm>
References: <560D0A3F.9010609@kippdata.de> <588DBDE2-73BA-4FF4-91CC-8F780DB88715@sharp.fm> <560D1F3C.301@kippdata.de> <5292464.4mj4i1Z6JG@k> <56110376.7090807@kippdata.de> <6AA47FB6-EA08-4A4D-9E93-640B4882EB96@sharp.fm>
To: dev@httpd.apache.org
X-Mailer: Apple Mail (2.2104)

On 04 Oct 2015, at 12:51 PM, Graham Leggett <minfrin@sharp.fm> wrote:

> How about a regex function?
>=20
> The single argument could be =E2=80=9Cs/PATTERN/REPLACEMENT/FLAGS=E2=80=9D=
.

Or more specifically:

%{regex:%{REMOTE_USER} =3D~ /([^@]*)@.*/$1/}

Or perhaps to avoid the issue of having to escape the =3D~ characters =
this:

%{regex:/([^@]*)@.*/$1/%{REMOTE_USER}}

Regards,
Graham
=E2=80=94


From dev-return-84034-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Sun Oct  4 11:40:37 2015
Return-Path: <dev-return-84034-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 1830218B43
	for <apmail-httpd-dev-archive@www.apache.org>; Sun,  4 Oct 2015 11:40:37 +0000 (UTC)
Received: (qmail 60894 invoked by uid 500); 4 Oct 2015 11:40:36 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 60825 invoked by uid 500); 4 Oct 2015 11:40:36 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 60814 invoked by uid 99); 4 Oct 2015 11:40:36 -0000
Received: from Unknown (HELO spamd4-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 04 Oct 2015 11:40:36 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd4-us-west.apache.org (ASF Mail Server at spamd4-us-west.apache.org) with ESMTP id CDC66C0470
	for <dev@httpd.apache.org>; Sun,  4 Oct 2015 11:40:35 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd4-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.006
X-Spam-Level:
X-Spam-Status: No, score=-0.006 tagged_above=-999 required=6.31
	tests=[RP_MATCHES_RCVD=-0.006, SPF_PASS=-0.001, URIBL_BLOCKED=0.001]
	autolearn=disabled
Received: from mx1-us-west.apache.org ([10.40.0.8])
	by localhost (spamd4-us-west.apache.org [10.40.0.11]) (amavisd-new, port 10024)
	with ESMTP id gB7zvEasp1pv for <dev@httpd.apache.org>;
	Sun,  4 Oct 2015 11:40:34 +0000 (UTC)
Received: from monica.sharp.fm (monica.sharp.fm [80.168.143.5])
	by mx1-us-west.apache.org (ASF Mail Server at mx1-us-west.apache.org) with ESMTP id 871F620633
	for <dev@httpd.apache.org>; Sun,  4 Oct 2015 11:40:34 +0000 (UTC)
Received: from [192.168.220.234] (unknown [192.168.220.234])
	(using TLSv1 with cipher DHE-RSA-AES256-SHA (256/256 bits))
	(Client did not present a certificate)
	(Authenticated sender: minfrin@sharp.fm)
	by monica.sharp.fm (Postfix) with ESMTPSA id 5574583146
	for <dev@httpd.apache.org>; Sun,  4 Oct 2015 12:40:27 +0100 (BST)
Content-Type: text/plain; charset=windows-1252
Mime-Version: 1.0 (Mac OS X Mail 8.2 \(2104\))
Subject: Re: [Patch] Async write completion for the full connection filter stack
From: Graham Leggett <minfrin@sharp.fm>
In-Reply-To: <7051D658-B96C-47BA-B21F-6511665DDAD8@jaguNET.com>
Date: Sun, 4 Oct 2015 13:40:26 +0200
Content-Transfer-Encoding: quoted-printable
Message-Id: <28641C04-8936-4004-BA40-C889C8B7846A@sharp.fm>
References: <A57B894B-50DA-4252-8FFF-C3DEF8473A61@sharp.fm> <D4B68B53-592F-4EEC-B39F-EFC9887F60D5@jaguNET.com> <715A3AE8-8015-4537-943F-A34E0E2A76F7@sharp.fm> <D7EA895A-9C37-4387-AE89-C1B7DF9B0706@jaguNET.com> <540DFB30.6050700@apache.org> <2F3B060C-E383-407F-A24C-7F026AD3CA81@sharp.fm> <AB1691BE05AE7F4992697F2A0835627AC5D859AB@VOEXM10W.internal.vodafone.com> <AA9FAD6C-8E83-4F5F-8F18-BC3BECF8B0A1@sharp.fm> <CAKQ1sVPFJk9-Y=JwDLvJcYT7ZCQ=xbuBRS9fu8Me_T-3f2fVXg@mail.gmail.com> <C6246136-6B10-4F7B-8261-6723ABD26817@sharp.fm> <CAKQ1sVMw0-=LsqPEkWYs1QP8daMYv=eaxhRT8gsnrppooVzuMg@mail.gmail.com> <7A74676C-AA9D-40E1-A434-9280C297217D@sharp.fm> <54128B11.9080803@apache.org> <496E8EFA-7A10-4D91-8C7E-434A9A3B09C5@sharp.fm> <541499A9.5050408@apache.org> <4D9E72F8-4918-49AD-8DC4-E3594C9ED43D@sharp.fm> <04776F50-0A53-4C1D-AA1C-9F57B60BC0AC@sharp.fm> <38C56976-E693-4EEE-88BA-85DE3328FED3@sharp.fm> <7051D658-B96C-47BA-B21F-6511665DDAD8@jaguNET.com>
To: dev@httpd.apache.org
X-Mailer: Apple Mail (2.2104)

On 28 Sep 2015, at 2:11 PM, Jim Jagielski <jim@jaguNET.com> wrote:

> This is super cool magic mojo.

The next bit of this is the ability to safely suspend a filter.

A suspended filter is a filter that is waiting for some external event, =
a callback of some kind, some timer that it might have set, and in the =
mean time doesn=92t want to be kicked. =46rom the perspective of =
ap_filter_should_yield() the filter has data in it and a well behaved =
upstream filter should wait before sending anything further.

The idea behind suspending filters over and above connections is that if =
two separate filters want to suspend a connection, what stops them from =
stomping on one another?

Patch to follow.

I am thinking of the sharp end of mod_proxy_httpd (and friends) becoming =
an async filter that suspends or not based on whether data is available =
on the other connection. In the process, mod_proxy becomes asynchronous.

Regards,
Graham
=97


From dev-return-84035-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Sun Oct  4 13:59:26 2015
Return-Path: <dev-return-84035-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id E475518C73
	for <apmail-httpd-dev-archive@www.apache.org>; Sun,  4 Oct 2015 13:59:25 +0000 (UTC)
Received: (qmail 29252 invoked by uid 500); 4 Oct 2015 13:59:20 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 29171 invoked by uid 500); 4 Oct 2015 13:59:20 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 29161 invoked by uid 99); 4 Oct 2015 13:59:20 -0000
Received: from Unknown (HELO spamd4-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 04 Oct 2015 13:59:20 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd4-us-west.apache.org (ASF Mail Server at spamd4-us-west.apache.org) with ESMTP id D8569C0479
	for <dev@httpd.apache.org>; Sun,  4 Oct 2015 13:59:19 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd4-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 3.857
X-Spam-Level: ***
X-Spam-Status: No, score=3.857 tagged_above=-999 required=6.31
	tests=[KAM_LAZY_DOMAIN_SECURITY=1, KAM_LINKBAIT=2.5,
	RDNS_DYNAMIC=0.363, RP_MATCHES_RCVD=-0.006, SPF_HELO_PASS=-0.001,
	URIBL_BLOCKED=0.001] autolearn=disabled
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd4-us-west.apache.org [10.40.0.11]) (amavisd-new, port 10024)
	with ESMTP id DlCM1giBYjDP for <dev@httpd.apache.org>;
	Sun,  4 Oct 2015 13:59:10 +0000 (UTC)
Received: from nebula.c8h10n4o2.org.uk (nebula.c8h10n4o2.org.uk [80.68.88.207])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id 3DBD720381
	for <dev@httpd.apache.org>; Sun,  4 Oct 2015 13:59:10 +0000 (UTC)
Received: from consume.c8h10n4o2.org.uk ([2001:8b0:caee:2::2])
	by nebula.c8h10n4o2.org.uk with esmtpsa (TLS1.0:ECDHE_RSA_AES_256_CBC_SHA384:256)
	(Exim 4.84)
	(envelope-from <isoma@c8h10n4o2.org.uk>)
	id 1Zijoh-0005DZ-Ed
	for dev@httpd.apache.org; Sun, 04 Oct 2015 14:59:08 +0100
Content-Type: text/plain; charset=windows-1252
Mime-Version: 1.0 (Mac OS X Mail 8.2 \(2104\))
Subject: Re: [Patch] Async write completion for the full connection filter stack
From: Tim Bannister <isoma@c8h10n4o2.org.uk>
In-Reply-To: <28641C04-8936-4004-BA40-C889C8B7846A@sharp.fm>
Date: Sun, 4 Oct 2015 14:59:07 +0100
Content-Transfer-Encoding: quoted-printable
Message-Id: <BA1BA267-72A4-4044-86DB-25552E07E67D@c8h10n4o2.org.uk>
References: <A57B894B-50DA-4252-8FFF-C3DEF8473A61@sharp.fm> <D4B68B53-592F-4EEC-B39F-EFC9887F60D5@jaguNET.com> <715A3AE8-8015-4537-943F-A34E0E2A76F7@sharp.fm> <D7EA895A-9C37-4387-AE89-C1B7DF9B0706@jaguNET.com> <540DFB30.6050700@apache.org> <2F3B060C-E383-407F-A24C-7F026AD3CA81@sharp.fm> <AB1691BE05AE7F4992697F2A0835627AC5D859AB@VOEXM10W.internal.vodafone.com> <AA9FAD6C-8E83-4F5F-8F18-BC3BECF8B0A1@sharp.fm> <CAKQ1sVPFJk9-Y=JwDLvJcYT7ZCQ=xbuBRS9fu8Me_T-3f2fVXg@mail.gmail.com> <C6246136-6B10-4F7B-8261-6723ABD26817@sharp.fm> <CAKQ1sVMw0-=LsqPEkWYs1QP8daMYv=eaxhRT8gsnrppooVzuMg@mail.gmail.com> <7A74676C-AA9D-40E1-A434-9280C297217D@sharp.fm> <54128B11.9080803@apache.org> <496E8EFA-7A10-4D91-8C7E-434A9A3B09C5@sharp.fm> <541499A9.5050408@apache.org> <4D9E72F8-4918-49AD-8DC4-E3594C9ED43D@sharp.fm> <04776F50-0A53-4C1D-AA1C-9F57B60BC0AC@sharp.fm> <38C56976-E693-4EEE-88BA-85DE3328FED3@sharp.fm> <7051D658-B96C-47BA-B21F-6511665DDAD8@jaguNET.com> <28641C04-8936-4004-BA40-C889C8B7846A@sharp.fm>
To: dev@httpd.apache.org
X-Mailer: Apple Mail (2.2104)

On 4 Oct 2015, at 12:40, Graham Leggett <minfrin@sharp.fm> wrote:
>=20
> The next bit of this is the ability to safely suspend a filter.
=85
> I am thinking of the sharp end of mod_proxy_httpd (and friends) =
becoming an async filter that suspends or not based on whether data is =
available on the other connection. In the process, mod_proxy becomes =
asynchronous.

Also super cool mojo.

--=20
Tim Bannister =96 isoma@c8h10n4o2.org.uk


From dev-return-84036-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Sun Oct  4 14:22:44 2015
Return-Path: <dev-return-84036-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id A37CE18CDD
	for <apmail-httpd-dev-archive@www.apache.org>; Sun,  4 Oct 2015 14:22:44 +0000 (UTC)
Received: (qmail 62617 invoked by uid 500); 4 Oct 2015 14:22:44 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 62542 invoked by uid 500); 4 Oct 2015 14:22:44 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 62532 invoked by uid 99); 4 Oct 2015 14:22:44 -0000
Received: from Unknown (HELO spamd2-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 04 Oct 2015 14:22:44 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd2-us-west.apache.org (ASF Mail Server at spamd2-us-west.apache.org) with ESMTP id B518D1A093D
	for <dev@httpd.apache.org>; Sun,  4 Oct 2015 14:22:43 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd2-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 2.9
X-Spam-Level: **
X-Spam-Status: No, score=2.9 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	HTML_MESSAGE=3, SPF_PASS=-0.001, URIBL_BLOCKED=0.001]
	autolearn=disabled
Authentication-Results: spamd2-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd2-us-west.apache.org [10.40.0.9]) (amavisd-new, port 10024)
	with ESMTP id spJ765hvNVqm for <dev@httpd.apache.org>;
	Sun,  4 Oct 2015 14:22:37 +0000 (UTC)
Received: from mail-io0-f171.google.com (mail-io0-f171.google.com [209.85.223.171])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id 188F520381
	for <dev@httpd.apache.org>; Sun,  4 Oct 2015 14:22:37 +0000 (UTC)
Received: by ioiz6 with SMTP id z6so162029034ioi.2
        for <dev@httpd.apache.org>; Sun, 04 Oct 2015 07:22:36 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        bh=nWcGhkqUEFK/4Xn9OtEcxIN3s15v/kVWb8qvwRrXqHw=;
        b=biWqiDnjf3YPXi+Q3yDOIRJADLf3wbgbLmESgAlCoChaupknJOcmdjZw25fI/sXzgf
         3T3XoyE+/alCoimXDQ+wa+A/N6NMXFgCgp8vsDJzSzWqRPhxH7MgJ9OoftTq0jyaiiim
         UYSd09IG8zCGZSxcSJZEo3kdE8l/rkrRxBUmo0rX2fhhY0QL1Tg6d/XaA2I+WW/LzqIP
         u0Du4AsZMA4HL1V77ZMVJqqB69CxdcoGurucCfF/VJLdIBAxLvmyC43BMMBK0IodNqla
         WrDu1SFq8eb6scVzkv68jAD8lEDrF2PufKLI1AHw7Sq4dL3QgopM/oQoC/CQODXYLqX3
         588w==
MIME-Version: 1.0
X-Received: by 10.107.3.170 with SMTP id e42mr23822400ioi.72.1443968556096;
 Sun, 04 Oct 2015 07:22:36 -0700 (PDT)
Received: by 10.36.37.18 with HTTP; Sun, 4 Oct 2015 07:22:36 -0700 (PDT)
In-Reply-To: <20151003213257.589D33A0234@svn01-us-west.apache.org>
References: <20151003213257.589D33A0234@svn01-us-west.apache.org>
Date: Sun, 4 Oct 2015 10:22:36 -0400
Message-ID: <CAKUrXK6WNtqJA6jjHoYbwa4f=9UeWniRXmNLEgKWa8JVn8SwxA@mail.gmail.com>
Subject: Re: svn commit: r1706637 - /httpd/httpd/trunk/modules/http2/config.m4
From: Jeff Trawick <trawick@gmail.com>
To: Apache HTTP Server Development List <dev@httpd.apache.org>
Content-Type: multipart/alternative; boundary=001a113ed442da6a5d052148204b

--001a113ed442da6a5d052148204b
Content-Type: text/plain; charset=UTF-8

On Sat, Oct 3, 2015 at 5:32 PM, <trawick@apache.org> wrote:

> Author: trawick
> Date: Sat Oct  3 21:32:56 2015
> New Revision: 1706637
>
> URL: http://svn.apache.org/viewvc?rev=1706637&view=rev
> Log:
> Follow-up to r1690248:
>
> Fix logic to limit exported symbols in DSO form of mod_http2.
>
> Modified:
>     httpd/httpd/trunk/modules/http2/config.m4
>
> Modified: httpd/httpd/trunk/modules/http2/config.m4
> URL:
> http://svn.apache.org/viewvc/httpd/httpd/trunk/modules/http2/config.m4?rev=1706637&r1=1706636&r2=1706637&view=diff
>
> ==============================================================================
> --- httpd/httpd/trunk/modules/http2/config.m4 (original)
> +++ httpd/httpd/trunk/modules/http2/config.m4 Sat Oct  3 21:32:56 2015
> @@ -174,7 +174,7 @@ See --with-nghttp2 on how to manage non-
>  is usually linked shared and requires loading. ], $http2_objs, , most, [
>      APACHE_CHECK_NGHTTP2
>      if test "$ac_cv_nghttp2" = "yes" ; then
> -        if test "x$enable_ssl" = "xshared"; then
> +        if test "x$enable_http2" = "xshared"; then
>             # The only symbol which needs to be exported is the module
>             # structure, so ask libtool to hide everything else:
>             APR_ADDTO(MOD_HTTP2_LDADD, [-export-symbols-regex
> http2_module])
>
>
>

This is CTR in the 2.4.x branch, right?  (i.e., can just commit it?)

-- 
Born in Roswell... married an alien...
http://emptyhammock.com/

--001a113ed442da6a5d052148204b
Content-Type: text/html; charset=UTF-8
Content-Transfer-Encoding: quoted-printable

<div dir=3D"ltr"><div class=3D"gmail_extra"><div class=3D"gmail_quote">On S=
at, Oct 3, 2015 at 5:32 PM,  <span dir=3D"ltr">&lt;<a href=3D"mailto:trawic=
k@apache.org" target=3D"_blank">trawick@apache.org</a>&gt;</span> wrote:<br=
><blockquote class=3D"gmail_quote" style=3D"margin:0 0 0 .8ex;border-left:1=
px #ccc solid;padding-left:1ex">Author: trawick<br>
Date: Sat Oct=C2=A0 3 21:32:56 2015<br>
New Revision: 1706637<br>
<br>
URL: <a href=3D"http://svn.apache.org/viewvc?rev=3D1706637&amp;view=3Drev" =
rel=3D"noreferrer" target=3D"_blank">http://svn.apache.org/viewvc?rev=3D170=
6637&amp;view=3Drev</a><br>
Log:<br>
Follow-up to r1690248:<br>
<br>
Fix logic to limit exported symbols in DSO form of mod_http2.<br>
<br>
Modified:<br>
=C2=A0 =C2=A0 httpd/httpd/trunk/modules/http2/config.m4<br>
<br>
Modified: httpd/httpd/trunk/modules/http2/config.m4<br>
URL: <a href=3D"http://svn.apache.org/viewvc/httpd/httpd/trunk/modules/http=
2/config.m4?rev=3D1706637&amp;r1=3D1706636&amp;r2=3D1706637&amp;view=3Ddiff=
" rel=3D"noreferrer" target=3D"_blank">http://svn.apache.org/viewvc/httpd/h=
ttpd/trunk/modules/http2/config.m4?rev=3D1706637&amp;r1=3D1706636&amp;r2=3D=
1706637&amp;view=3Ddiff</a><br>
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D<br>
--- httpd/httpd/trunk/modules/http2/config.m4 (original)<br>
+++ httpd/httpd/trunk/modules/http2/config.m4 Sat Oct=C2=A0 3 21:32:56 2015=
<br>
@@ -174,7 +174,7 @@ See --with-nghttp2 on how to manage non-<br>
=C2=A0is usually linked shared and requires loading. ], $http2_objs, , most=
, [<br>
=C2=A0 =C2=A0 =C2=A0APACHE_CHECK_NGHTTP2<br>
=C2=A0 =C2=A0 =C2=A0if test &quot;$ac_cv_nghttp2&quot; =3D &quot;yes&quot; =
; then<br>
-=C2=A0 =C2=A0 =C2=A0 =C2=A0 if test &quot;x$enable_ssl&quot; =3D &quot;xsh=
ared&quot;; then<br>
+=C2=A0 =C2=A0 =C2=A0 =C2=A0 if test &quot;x$enable_http2&quot; =3D &quot;x=
shared&quot;; then<br>
=C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 # The only symbol which needs to =
be exported is the module<br>
=C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 # structure, so ask libtool to hi=
de everything else:<br>
=C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 APR_ADDTO(MOD_HTTP2_LDADD, [-expo=
rt-symbols-regex http2_module])<br>
<br>
<br>
</blockquote></div><br><br clear=3D"all"><div>This is CTR in the 2.4.x bran=
ch, right? =C2=A0(i.e., can just commit it?)</div><div><br></div>-- <br><di=
v class=3D"gmail_signature"><div dir=3D"ltr">Born in Roswell... married an =
alien...<br><a href=3D"http://emptyhammock.com/" target=3D"_blank">http://e=
mptyhammock.com/</a><div><br></div></div></div>
</div></div>

--001a113ed442da6a5d052148204b--

From dev-return-84037-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Sun Oct  4 14:27:38 2015
Return-Path: <dev-return-84037-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id E143918D16
	for <apmail-httpd-dev-archive@www.apache.org>; Sun,  4 Oct 2015 14:27:37 +0000 (UTC)
Received: (qmail 67692 invoked by uid 500); 4 Oct 2015 14:27:37 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 67607 invoked by uid 500); 4 Oct 2015 14:27:37 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 67598 invoked by uid 99); 4 Oct 2015 14:27:37 -0000
Received: from mail-relay.apache.org (HELO mail-relay.apache.org) (140.211.11.15)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 04 Oct 2015 14:27:37 +0000
Received: from [192.168.1.37] (2804ds5-soeb.0.fullrate.dk [90.184.204.23])
	by mail-relay.apache.org (ASF Mail Server at mail-relay.apache.org) with ESMTPSA id 7B2981A0180
	for <dev@httpd.apache.org>; Sun,  4 Oct 2015 14:27:36 +0000 (UTC)
Subject: Re: svn commit: r1706637 - /httpd/httpd/trunk/modules/http2/config.m4
To: dev@httpd.apache.org
References: <20151003213257.589D33A0234@svn01-us-west.apache.org>
 <CAKUrXK6WNtqJA6jjHoYbwa4f=9UeWniRXmNLEgKWa8JVn8SwxA@mail.gmail.com>
From: Daniel Gruno <humbedooh@apache.org>
Message-ID: <56113755.8060902@apache.org>
Date: Sun, 4 Oct 2015 16:27:33 +0200
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:38.0) Gecko/20100101
 Thunderbird/38.2.0
MIME-Version: 1.0
In-Reply-To: <CAKUrXK6WNtqJA6jjHoYbwa4f=9UeWniRXmNLEgKWa8JVn8SwxA@mail.gmail.com>
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit

On 10/04/2015 04:22 PM, Jeff Trawick wrote:
> 
> This is CTR in the 2.4.x branch, right?  (i.e., can just commit it?)
> 

Yeah, it was informally decided (last week) to CTR the http2 stuff.

With regards,
Daniel.

From dev-return-84038-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Mon Oct  5 10:04:10 2015
Return-Path: <dev-return-84038-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id D9AA0184A5
	for <apmail-httpd-dev-archive@www.apache.org>; Mon,  5 Oct 2015 10:04:10 +0000 (UTC)
Received: (qmail 26602 invoked by uid 500); 5 Oct 2015 10:04:10 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 26543 invoked by uid 500); 5 Oct 2015 10:04:10 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 26531 invoked by uid 99); 5 Oct 2015 10:04:10 -0000
Received: from Unknown (HELO spamd4-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 05 Oct 2015 10:04:10 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd4-us-west.apache.org (ASF Mail Server at spamd4-us-west.apache.org) with ESMTP id D4B8DC0E08
	for <dev@httpd.apache.org>; Mon,  5 Oct 2015 10:04:09 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd4-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 0.998
X-Spam-Level:
X-Spam-Status: No, score=0.998 tagged_above=-999 required=6.31
	tests=[KAM_LAZY_DOMAIN_SECURITY=1, RCVD_IN_MSPIKE_H2=-0.001,
	SPF_HELO_PASS=-0.001] autolearn=disabled
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd4-us-west.apache.org [10.40.0.11]) (amavisd-new, port 10024)
	with ESMTP id YOqG7oG5Sf-T for <dev@httpd.apache.org>;
	Mon,  5 Oct 2015 10:03:58 +0000 (UTC)
Received: from mail1.bemta14.messagelabs.com (mail1.bemta14.messagelabs.com [193.109.254.108])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id C65A3201F9
	for <dev@httpd.apache.org>; Mon,  5 Oct 2015 10:03:57 +0000 (UTC)
Received: from [193.109.254.3] by server-4.bemta-14.messagelabs.com id C9/06-10715-70B42165; Mon, 05 Oct 2015 10:03:51 +0000
X-Env-Sender: ruediger.pluem@vodafone.com
X-Msg-Ref: server-4.tower-184.messagelabs.com!1444039430!18677698!1
X-Originating-IP: [195.232.244.135]
X-StarScan-Received:
X-StarScan-Version: 6.13.16; banners=-,-,-
X-VirusChecked: Checked
Received: (qmail 19318 invoked from network); 5 Oct 2015 10:03:50 -0000
Received: from mailout03.vodafone.com (HELO mailout03.vodafone.com) (195.232.244.135)
  by server-4.tower-184.messagelabs.com with DHE-RSA-AES256-SHA encrypted SMTP; 5 Oct 2015 10:03:50 -0000
Received: from mailint04.vodafone.com (mailint04.vodafone.com [195.232.244.201])
	by mailout03.vodafone.com (Postfix) with ESMTP id 3nTyF23342z17HNT
	for <dev@httpd.apache.org>; Mon,  5 Oct 2015 12:03:50 +0200 (CEST)
Received: from mailint04.vodafone.com (localhost [127.0.0.1])
	by mailint04.vodafone.com (Postfix) with ESMTP id 3nTyF21sS7zfZlQ
	for <dev@httpd.apache.org>; Mon,  5 Oct 2015 12:03:50 +0200 (CEST)
Received: from VOEXC04W.internal.vodafone.com (voexc04w.dc-ratingen.de [145.230.101.24])
	(using TLSv1 with cipher AES128-SHA (128/128 bits))
	(No client certificate requested)
	by mailint04.vodafone.com (Postfix) with ESMTPS id 3nTyF21WqrzfZ66
	for <dev@httpd.apache.org>; Mon,  5 Oct 2015 12:03:50 +0200 (CEST)
Received: from VOEXC10W.internal.vodafone.com (145.230.101.30) by
 VOEXC04W.internal.vodafone.com (145.230.101.24) with Microsoft SMTP Server
 (TLS) id 14.3.224.2; Mon, 5 Oct 2015 12:03:49 +0200
Received: from VOEXM10W.internal.vodafone.com ([169.254.2.88]) by
 VOEXC10W.internal.vodafone.com ([145.230.101.30]) with mapi id
 14.03.0224.002; Mon, 5 Oct 2015 12:03:49 +0200
From: =?utf-8?B?UGzDvG0sIFLDvGRpZ2VyLCBWb2RhZm9uZSBHcm91cA==?=
	<ruediger.pluem@vodafone.com>
To: "dev@httpd.apache.org" <dev@httpd.apache.org>
Subject: RE: svn commit: r1703305 -
 /httpd/httpd/trunk/modules/aaa/mod_auth_digest.c
Thread-Topic: svn commit: r1703305 -
 /httpd/httpd/trunk/modules/aaa/mod_auth_digest.c
Thread-Index: AQHQ/HeFVU30ve33m0aFnHNdGb7ANZ5aELyAgAKbU5A=
Date: Mon, 5 Oct 2015 10:03:48 +0000
Message-ID: <AB1691BE05AE7F4992697F2A0835627AC633CFB8@VOEXM10W.internal.vodafone.com>
References: <20150915222046.152F4AC0181@hades.apache.org>
 <560D7C36.7010607@apache.org> <561032EF.9090401@wanadoo.fr>
In-Reply-To: <561032EF.9090401@wanadoo.fr>
Accept-Language: en-US
Content-Language: en-US
X-MS-Has-Attach:
X-MS-TNEF-Correlator:
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
MIME-Version: 1.0

DQoNCj4gLS0tLS1PcmlnaW5hbCBNZXNzYWdlLS0tLS0NCj4gRnJvbTogTWFyaW9uICYgQ2hyaXN0
b3BoZSBKQUlMTEVUIFttYWlsdG86Y2hyaXN0b3BoZS5qYWlsbGV0QHdhbmFkb28uZnJdDQo+IFNl
bnQ6IFNhbXN0YWcsIDMuIE9rdG9iZXIgMjAxNSAyMTo1Nw0KPiBUbzogZGV2QGh0dHBkLmFwYWNo
ZS5vcmcNCj4gU3ViamVjdDogUmU6IHN2biBjb21taXQ6IHIxNzAzMzA1IC0NCj4gL2h0dHBkL2h0
dHBkL3RydW5rL21vZHVsZXMvYWFhL21vZF9hdXRoX2RpZ2VzdC5jDQo+IA0KPiANCj4gTGUgMDEv
MTAvMjAxNSAyMDozMiwgUnVlZGlnZXIgUGx1ZW0gYSDDqWNyaXQgOg0KPiA+IE9uIDA5LzE2LzIw
MTUgMTI6MjAgQU0sIGphaWxsZXRjMzZAYXBhY2hlLm9yZyB3cm90ZToNCj4gPj4gQXV0aG9yOiBq
YWlsbGV0YzM2DQo+ID4+IERhdGU6IFR1ZSBTZXAgMTUgMjI6MjA6NDUgMjAxNQ0KPiA+PiBOZXcg
UmV2aXNpb246IDE3MDMzMDUNCj4gPj4NCj4gPj4gVVJMOiBodHRwOi8vc3ZuLmFwYWNoZS5vcmcv
cjE3MDMzMDUNCj4gPj4gTG9nOg0KPiA+PiBSZW1vdmUgY29kZSByZWxhdGVkIHRvICdBdXRoRGln
ZXN0RW5hYmxlUXVlcnlTdHJpbmdIYWNrJw0KPiA+Pg0KPiA+PiBUaGlzIGhhcyBiZWVuIHVuZG9j
dW1lbnRlZCBmb3IgYWJvdXQgMyB5ZWFycyBub3cgKHNlZSByMTQxNTk2MCkNCj4gPj4NCj4gPj4g
TW9kaWZpZWQ6DQo+ID4+ICAgICAgaHR0cGQvaHR0cGQvdHJ1bmsvbW9kdWxlcy9hYWEvbW9kX2F1
dGhfZGlnZXN0LmMNCj4gPiBDb3VsZCB0aGlzIGNhdXNlDQo+ID4NCj4gPiB0L21vZHVsZXMvZGln
ZXN0LnQNCj4gPg0KPiA+IHRlc3QgOSB0byBmYWlsPw0KPiA+DQo+ID4gQXMgd2UgcmVtb3ZlZCB0
aGUgY29kZSBmb3IgZ29vZCByZWFzb24gd2Ugc2hvdWxkIGFsc28gcmVtb3ZlIHRoZSB0ZXN0IGlm
DQo+IHRoaXMgaXMgdGhlIGNhc2UgdGhlbi4NCj4gPg0KPiA+IFJlZ2FyZHMNCj4gPg0KPiA+IFLD
vGRpZ2VyDQo+IA0KPiBIaSwNCj4geWVzLCB5b3UgYXJlIHJpZ2h0Lg0KPiANCj4gSSB3b3VsZCBw
cm9wb3NlZCB0aGUgYmVsb3cgcGF0Y2g6DQoNCisxDQoNCg0KUmVnYXJkcw0KDQpSw7xkaWdlcg0K
DQo=

From dev-return-84039-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Mon Oct  5 11:13:08 2015
Return-Path: <dev-return-84039-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 7AFCD1874E
	for <apmail-httpd-dev-archive@www.apache.org>; Mon,  5 Oct 2015 11:13:08 +0000 (UTC)
Received: (qmail 66703 invoked by uid 500); 5 Oct 2015 11:13:07 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 66620 invoked by uid 500); 5 Oct 2015 11:13:07 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 66605 invoked by uid 99); 5 Oct 2015 11:13:07 -0000
Received: from Unknown (HELO spamd4-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 05 Oct 2015 11:13:07 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd4-us-west.apache.org (ASF Mail Server at spamd4-us-west.apache.org) with ESMTP id 17A3CC028F
	for <dev@httpd.apache.org>; Mon,  5 Oct 2015 11:13:07 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd4-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.12
X-Spam-Level:
X-Spam-Status: No, score=-0.12 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RCVD_IN_MSPIKE_H3=-0.01, RCVD_IN_MSPIKE_WL=-0.01, SPF_PASS=-0.001,
	URIBL_BLOCKED=0.001] autolearn=disabled
Authentication-Results: spamd4-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-us-west.apache.org ([10.40.0.8])
	by localhost (spamd4-us-west.apache.org [10.40.0.11]) (amavisd-new, port 10024)
	with ESMTP id DPMwim0Xez6G for <dev@httpd.apache.org>;
	Mon,  5 Oct 2015 11:13:01 +0000 (UTC)
Received: from mail-qk0-f173.google.com (mail-qk0-f173.google.com [209.85.220.173])
	by mx1-us-west.apache.org (ASF Mail Server at mx1-us-west.apache.org) with ESMTPS id 4112120F20
	for <dev@httpd.apache.org>; Mon,  5 Oct 2015 11:13:01 +0000 (UTC)
Received: by qkbi190 with SMTP id i190so46546748qkb.1
        for <dev@httpd.apache.org>; Mon, 05 Oct 2015 04:13:00 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type:content-transfer-encoding;
        bh=gPV69huueIadhZEM0XHlthnIB6AvYWIPPazTcqbsTls=;
        b=AYe3Gz5zL4ttIK9L0J++VN0lua9PzBXaRnCyvnShqmByUK7uItSRBXMAIWxGXRONac
         e8ZJKMkYcAuXHtCy1fkQA69JN0bd65r+Y/eb9W0QxG0jqpUv5lO84eKCu4nGq9wVeFmu
         JYJHJ8t0uaFcHnpj6EaqjVkywhKImsJkApOy83NuAdbfCZiG9my4VDdiavphsya9u2jz
         bSJAdY15nDQTHlx2BmBzWLp8I0nVm7RRANClPyyY9PSqsC9Le1k+0HT81RLEp2sK00lF
         9Jws5I1d5WoPl80fV5rvfTldbrYBwPtrzEktpcX/z9aK/yIfppZmG/C2Sg6EWzbtlFhT
         Dstg==
MIME-Version: 1.0
X-Received: by 10.55.215.156 with SMTP id t28mr1446306qkt.68.1444043580525;
 Mon, 05 Oct 2015 04:13:00 -0700 (PDT)
Received: by 10.55.72.20 with HTTP; Mon, 5 Oct 2015 04:13:00 -0700 (PDT)
In-Reply-To: <28641C04-8936-4004-BA40-C889C8B7846A@sharp.fm>
References: <A57B894B-50DA-4252-8FFF-C3DEF8473A61@sharp.fm>
	<D4B68B53-592F-4EEC-B39F-EFC9887F60D5@jaguNET.com>
	<715A3AE8-8015-4537-943F-A34E0E2A76F7@sharp.fm>
	<D7EA895A-9C37-4387-AE89-C1B7DF9B0706@jaguNET.com>
	<540DFB30.6050700@apache.org>
	<2F3B060C-E383-407F-A24C-7F026AD3CA81@sharp.fm>
	<AB1691BE05AE7F4992697F2A0835627AC5D859AB@VOEXM10W.internal.vodafone.com>
	<AA9FAD6C-8E83-4F5F-8F18-BC3BECF8B0A1@sharp.fm>
	<CAKQ1sVPFJk9-Y=JwDLvJcYT7ZCQ=xbuBRS9fu8Me_T-3f2fVXg@mail.gmail.com>
	<C6246136-6B10-4F7B-8261-6723ABD26817@sharp.fm>
	<CAKQ1sVMw0-=LsqPEkWYs1QP8daMYv=eaxhRT8gsnrppooVzuMg@mail.gmail.com>
	<7A74676C-AA9D-40E1-A434-9280C297217D@sharp.fm>
	<54128B11.9080803@apache.org>
	<496E8EFA-7A10-4D91-8C7E-434A9A3B09C5@sharp.fm>
	<541499A9.5050408@apache.org>
	<4D9E72F8-4918-49AD-8DC4-E3594C9ED43D@sharp.fm>
	<04776F50-0A53-4C1D-AA1C-9F57B60BC0AC@sharp.fm>
	<38C56976-E693-4EEE-88BA-85DE3328FED3@sharp.fm>
	<7051D658-B96C-47BA-B21F-6511665DDAD8@jaguNET.com>
	<28641C04-8936-4004-BA40-C889C8B7846A@sharp.fm>
Date: Mon, 5 Oct 2015 13:13:00 +0200
Message-ID: <CAKQ1sVPuOxqWbw3Uo1k7OTa+etsUJhL_9j=jfEykXJJD=-ft3Q@mail.gmail.com>
Subject: Re: [Patch] Async write completion for the full connection filter stack
From: Yann Ylavic <ylavic.dev@gmail.com>
To: dev@httpd.apache.org
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: quoted-printable

On Sun, Oct 4, 2015 at 1:40 PM, Graham Leggett <minfrin@sharp.fm> wrote:
>
> The next bit of this is the ability to safely suspend a filter.
>
> A suspended filter is a filter that is waiting for some external event, a=
 callback of some kind, some timer that it might have set, and in the mean =
time doesn=E2=80=99t want to be kicked. From the perspective of ap_filter_s=
hould_yield() the filter has data in it and a well behaved upstream filter =
should wait before sending anything further.
>
> The idea behind suspending filters over and above connections is that if =
two separate filters want to suspend a connection, what stops them from sto=
mping on one another?

Why suspend a filter rather than the calling handler (on EAGAIN/EWOULDBLOCK=
)?

>
> I am thinking of the sharp end of mod_proxy_httpd (and friends) becoming =
an async filter that suspends or not based on whether data is available on =
the other connection. In the process, mod_proxy becomes asynchronous.

It seems that suspending the handlers would avoid rewriting them as filters=
.
Or is your plan to go for something like (mod_)serf?

Regards,
Yann.

From dev-return-84040-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Mon Oct  5 13:38:26 2015
Return-Path: <dev-return-84040-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 2CFB618B90
	for <apmail-httpd-dev-archive@www.apache.org>; Mon,  5 Oct 2015 13:38:26 +0000 (UTC)
Received: (qmail 55409 invoked by uid 500); 5 Oct 2015 13:38:09 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 55343 invoked by uid 500); 5 Oct 2015 13:38:09 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 55333 invoked by uid 99); 5 Oct 2015 13:38:09 -0000
Received: from Unknown (HELO spamd4-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 05 Oct 2015 13:38:09 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd4-us-west.apache.org (ASF Mail Server at spamd4-us-west.apache.org) with ESMTP id CAF90C0952
	for <dev@httpd.apache.org>; Mon,  5 Oct 2015 13:38:08 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd4-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 0.001
X-Spam-Level:
X-Spam-Status: No, score=0.001 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, URIBL_BLOCKED=0.001]
	autolearn=disabled
Authentication-Results: spamd4-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=comcast.net
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd4-us-west.apache.org [10.40.0.11]) (amavisd-new, port 10024)
	with ESMTP id sx2mi8C42Ddv for <dev@httpd.apache.org>;
	Mon,  5 Oct 2015 13:37:55 +0000 (UTC)
Received: from resqmta-ch2-09v.sys.comcast.net (resqmta-ch2-09v.sys.comcast.net [69.252.207.41])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id D6D15201F9
	for <dev@httpd.apache.org>; Mon,  5 Oct 2015 13:37:54 +0000 (UTC)
Received: from resomta-ch2-13v.sys.comcast.net ([69.252.207.109])
	by resqmta-ch2-09v.sys.comcast.net with comcast
	id RRco1r0032N9P4d01RdmeE; Mon, 05 Oct 2015 13:37:46 +0000
Received: from [192.168.199.10] ([69.251.84.114])
	by resomta-ch2-13v.sys.comcast.net with comcast
	id RRdm1r0042U0RYt01RdmYV; Mon, 05 Oct 2015 13:37:46 +0000
Content-Type: text/plain; charset=windows-1252
Mime-Version: 1.0 (Mac OS X Mail 8.2 \(2104\))
Subject: Re: [Patch] Async write completion for the full connection filter stack
From: Jim Jagielski <jim@jaguNET.com>
In-Reply-To: <BA1BA267-72A4-4044-86DB-25552E07E67D@c8h10n4o2.org.uk>
Date: Mon, 5 Oct 2015 09:37:45 -0400
Content-Transfer-Encoding: quoted-printable
Message-Id: <E0D3E0F3-9A0A-4590-A6E5-B1E8504924B7@jaguNET.com>
References: <A57B894B-50DA-4252-8FFF-C3DEF8473A61@sharp.fm> <D4B68B53-592F-4EEC-B39F-EFC9887F60D5@jaguNET.com> <715A3AE8-8015-4537-943F-A34E0E2A76F7@sharp.fm> <D7EA895A-9C37-4387-AE89-C1B7DF9B0706@jaguNET.com> <540DFB30.6050700@apache.org> <2F3B060C-E383-407F-A24C-7F026AD3CA81@sharp.fm> <AB1691BE05AE7F4992697F2A0835627AC5D859AB@VOEXM10W.internal.vodafone.com> <AA9FAD6C-8E83-4F5F-8F18-BC3BECF8B0A1@sharp.fm> <CAKQ1sVPFJk9-Y=JwDLvJcYT7ZCQ=xbuBRS9fu8Me_T-3f2fVXg@mail.gmail.com> <C6246136-6B10-4F7B-8261-6723ABD26817@sharp.fm> <CAKQ1sVMw0-=LsqPEkWYs1QP8daMYv=eaxhRT8gsnrppooVzuMg@mail.gmail.com> <7A74676C-AA9D-40E1-A434-9280C297217D@sharp.fm> <54128B11.9080803@apache.org> <496E8EFA-7A10-4D91-8C7E-434A9A3B09C5@sharp.fm> <541499A9.5050408@apache.org> <4D9E72F8-4918-49AD-8DC4-E3594C9ED43D@sharp.fm> <04776F50-0A53-4C1D-AA1C-9F57B60BC0AC@sharp.fm> <38C56976-E693-4EEE-88BA-85DE3328FED3@sharp.fm> <7051D658-B96C-47BA-B21F-6511665DDAD8@jaguNET.com> <28641C04-8936-4004-BA40-C889C8B7846A@sharp.fm> <BA
 1BA267-72A4-4044-86DB-25552E07E67D@c8h10n4o2.org.uk>
To: dev@httpd.apache.org
X-Mailer: Apple Mail (2.2104)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=comcast.net;
	s=q20140121; t=1444052266;
	bh=QuV2oirYwoDROHiVLXfdPlofABoEawxm7IR1NNGsAO8=;
	h=Received:Received:Content-Type:Mime-Version:Subject:From:Date:
	 Message-Id:To;
	b=eCTTO6X1gxSIDBVRf/yOIfu6RhavDPRRAitgJBA5M64FjhdEHbVR30Na3UYmsIRa8
	 EkSAKhi10hMsfhMmwEKtbCHdMOuAEXvzCfzvWLDDqzNlSLDZnhxhYz0nFUoUDGtjGU
	 P5+vFD9vP5K94Yngo+xQVzo6B77fofGBqIJgaEu59w4jFp0ecFgAfBJRx1IJsz7TP2
	 cTQbqVxchJZBqRVMOIldau03nBJEiIleYeedsxSv68U3oN/dVUDmba1Amp3zZvNtNr
	 pjsEbvxZv8igj06vCLhtvJx0wgjhnxCwuHxAGFBpUNDXJriJz9VZa+5WRlPWb1TYBS
	 NJlx7ywVXG6tg==


> On Oct 4, 2015, at 9:59 AM, Tim Bannister <isoma@c8h10n4o2.org.uk> =
wrote:
>=20
> On 4 Oct 2015, at 12:40, Graham Leggett <minfrin@sharp.fm> wrote:
>>=20
>> The next bit of this is the ability to safely suspend a filter.
> =85
>> I am thinking of the sharp end of mod_proxy_httpd (and friends) =
becoming an async filter that suspends or not based on whether data is =
available on the other connection. In the process, mod_proxy becomes =
asynchronous.
>=20
> Also super cool mojo.

++1!



From dev-return-84041-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Mon Oct  5 13:41:47 2015
Return-Path: <dev-return-84041-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 77CBD18B9B
	for <apmail-httpd-dev-archive@www.apache.org>; Mon,  5 Oct 2015 13:41:47 +0000 (UTC)
Received: (qmail 62884 invoked by uid 500); 5 Oct 2015 13:41:47 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 62822 invoked by uid 500); 5 Oct 2015 13:41:47 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 62812 invoked by uid 99); 5 Oct 2015 13:41:47 -0000
Received: from Unknown (HELO spamd1-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 05 Oct 2015 13:41:47 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd1-us-west.apache.org (ASF Mail Server at spamd1-us-west.apache.org) with ESMTP id 7EB5CC291A
	for <dev@httpd.apache.org>; Mon,  5 Oct 2015 13:41:46 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd1-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 0.652
X-Spam-Level:
X-Spam-Status: No, score=0.652 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, SPF_NEUTRAL=0.652]
	autolearn=disabled
Authentication-Results: spamd1-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=comcast.net
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd1-us-west.apache.org [10.40.0.7]) (amavisd-new, port 10024)
	with ESMTP id Oy-f8lIRQ6jN for <dev@httpd.apache.org>;
	Mon,  5 Oct 2015 13:41:45 +0000 (UTC)
Received: from resqmta-ch2-05v.sys.comcast.net (resqmta-ch2-05v.sys.comcast.net [69.252.207.37])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id 020E042B36
	for <dev@httpd.apache.org>; Mon,  5 Oct 2015 13:41:44 +0000 (UTC)
Received: from resomta-ch2-15v.sys.comcast.net ([69.252.207.111])
	by resqmta-ch2-05v.sys.comcast.net with comcast
	id RRft1r0052Qkjl901RhePw; Mon, 05 Oct 2015 13:41:38 +0000
Received: from [192.168.199.10] ([69.251.84.114])
	by resomta-ch2-15v.sys.comcast.net with comcast
	id RRhd1r00P2U0RYt01RheWX; Mon, 05 Oct 2015 13:41:38 +0000
Content-Type: text/plain; charset=windows-1252
Mime-Version: 1.0 (Mac OS X Mail 8.2 \(2104\))
Subject: Serf and mod_lua and libmill (Was: Re: [Patch] Async write completion for the full connection filter stack)
From: Jim Jagielski <jim@jaguNET.com>
In-Reply-To: <BA1BA267-72A4-4044-86DB-25552E07E67D@c8h10n4o2.org.uk>
Date: Mon, 5 Oct 2015 09:41:37 -0400
Content-Transfer-Encoding: 7bit
Message-Id: <4203E8A4-546F-4DFA-977F-59C457F4580D@jaguNET.com>
References: <A57B894B-50DA-4252-8FFF-C3DEF8473A61@sharp.fm> <D4B68B53-592F-4EEC-B39F-EFC9887F60D5@jaguNET.com> <715A3AE8-8015-4537-943F-A34E0E2A76F7@sharp.fm> <D7EA895A-9C37-4387-AE89-C1B7DF9B0706@jaguNET.com> <540DFB30.6050700@apache.org> <2F3B060C-E383-407F-A24C-7F026AD3CA81@sharp.fm> <AB1691BE05AE7F4992697F2A0835627AC5D859AB@VOEXM10W.internal.vodafone.com> <AA9FAD6C-8E83-4F5F-8F18-BC3BECF8B0A1@sharp.fm> <CAKQ1sVPFJk9-Y=JwDLvJcYT7ZCQ=xbuBRS9fu8Me_T-3f2fVXg@mail.gmail.com> <C6246136-6B10-4F7B-8261-6723ABD26817@sharp.fm> <CAKQ1sVMw0-=LsqPEkWYs1QP8daMYv=eaxhRT8gsnrppooVzuMg@mail.gmail.com> <7A74676C-AA9D-40E1-A434-9280C297217D@sharp.fm> <54128B11.9080803@apache.org> <496E8EFA-7A10-4D91-8C7E-434A9A3B09C5@sharp.fm> <541499A9.5050408@apache.org> <4D9E72F8-4918-49AD-8DC4-E3594C9ED43D@sharp.fm> <04776F50-0A53-4C1D-AA1C-9F57B60BC0AC@sharp.fm> <38C56976-E693-4EEE-88BA-85DE3328FED3@sharp.fm> <7051D658-B96C-47BA-B21F-6511665DDAD8@jaguNET.com> <28641C04-8936-4004-BA40-C889C8B7846A@sharp.fm> <BA
 1BA267-72A4-4044-86DB-25552E07E67D@c8h10n4o2.org.uk>
To: dev@httpd.apache.org
X-Mailer: Apple Mail (2.2104)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=comcast.net;
	s=q20140121; t=1444052498;
	bh=8zk6OQ9ZNPkE/tEXzHNgyBGTZfm3yn0yOVwD6OORljE=;
	h=Received:Received:Content-Type:Mime-Version:Subject:From:Date:
	 Message-Id:To;
	b=orZJg7BsX2txxs9P168Lp2Rhibvr9xyt+NRguFkwdqzl8DmqIZL0TiW3eGf1Z7rcd
	 ooIgTTHWl12KpLL3q3RCB4oWCFL1gl6BfcLAkjGARFKLj0ZQ5NFtTf17SlgqLtL0tO
	 WrQxHBv3mxPoz5CZFBXvmmVZUUoP77j8ddOoQpcAPQDWmyxteHjmBrzx/sSDjL9uL7
	 70xC+kmsbV4JpJh+dp8XPOjDqGBrgdnt9lWWQG60EMD4vosXE7EvIelJDxX7FIg1q4
	 QZC1X3FVZVHbSNYvNz1BfdGt1Jc06DRr+hGfTZPxlaJiLCYqqJWhlai1JuCOhW3i49
	 T68PoIGZERssA==

I was wondering: how much of what we want to do would be easier
if we decided to make serf and/or mod_lua and/or libmill as
dependencies for 2.6/3.0? We could leverage Lua (or libmill)
as libs implementing some level of coroutines and serf for
a more organic bucket impl.

Of course, this could also result in the issue we currently
have w/ APR in which APR itself lags behind what httpd itself
needs and we end up add stuff to httpd anyway...

Hmmmm...

From dev-return-84042-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Mon Oct  5 14:25:19 2015
Return-Path: <dev-return-84042-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 34CB118CCC
	for <apmail-httpd-dev-archive@www.apache.org>; Mon,  5 Oct 2015 14:25:19 +0000 (UTC)
Received: (qmail 72766 invoked by uid 500); 5 Oct 2015 14:25:15 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 72690 invoked by uid 500); 5 Oct 2015 14:25:15 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 72680 invoked by uid 99); 5 Oct 2015 14:25:15 -0000
Received: from Unknown (HELO spamd3-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 05 Oct 2015 14:25:15 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd3-us-west.apache.org (ASF Mail Server at spamd3-us-west.apache.org) with ESMTP id 511211809A5
	for <dev@httpd.apache.org>; Mon,  5 Oct 2015 14:25:15 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd3-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.101
X-Spam-Level:
X-Spam-Status: No, score=-0.101 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RCVD_IN_MSPIKE_H2=-0.001, SPF_PASS=-0.001, URIBL_BLOCKED=0.001]
	autolearn=disabled
Authentication-Results: spamd3-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd3-us-west.apache.org [10.40.0.10]) (amavisd-new, port 10024)
	with ESMTP id iD_ZJCq1-Bwd for <dev@httpd.apache.org>;
	Mon,  5 Oct 2015 14:25:09 +0000 (UTC)
Received: from mail-ig0-f175.google.com (mail-ig0-f175.google.com [209.85.213.175])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id D8E88204C8
	for <dev@httpd.apache.org>; Mon,  5 Oct 2015 14:25:08 +0000 (UTC)
Received: by igcpe7 with SMTP id pe7so2262732igc.0
        for <dev@httpd.apache.org>; Mon, 05 Oct 2015 07:25:07 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type:content-transfer-encoding;
        bh=bwxsX8GqJU/sObqauvLZNOofnYRyT98swBawImmU/0w=;
        b=eU8R57pIpP3pivcjiPpp6hkpoWHijz6d/bp7B9+xb1R7sAVEl0EMCohNoSypEBhz/S
         P1sPYUE5X0tQEtsDJ/lRh2wkZrfFnu/tIhxy69GBxEIOIL0OA1ZqHO+PKVz0ydcPhr4q
         MU+evvZfN0kGz7sQOw3g2KUKCoX7+np8ZrnV+XoejiUgCNlWDgTHznvDgWwWJlZbqKxX
         0rCfPu28knWY8r+6u8pVSa0Fx3Y1rotgf+T+4s2gvqN5U8pMT7U9U2xDLES4c42IoWYm
         xF4PNUZ0O7RXFTfkiA+l4Z7R2aVezJYG2iQQ1nkEOYY5jvHJLaKH1K+OCBCR4Lpy/UjE
         RiWQ==
MIME-Version: 1.0
X-Received: by 10.50.141.234 with SMTP id rr10mr9107210igb.56.1444055107828;
 Mon, 05 Oct 2015 07:25:07 -0700 (PDT)
Received: by 10.64.25.3 with HTTP; Mon, 5 Oct 2015 07:25:07 -0700 (PDT)
In-Reply-To: <A57B894B-50DA-4252-8FFF-C3DEF8473A61@sharp.fm>
References: <A57B894B-50DA-4252-8FFF-C3DEF8473A61@sharp.fm>
Date: Mon, 5 Oct 2015 10:25:07 -0400
Message-ID: <CALK=YjMXYFVaZd=+7s=2H4TnhdAsDYxuR5uy+t=c=zHmcpN9Tw@mail.gmail.com>
Subject: Re: [Patch] Async write completion for the full connection filter stack
From: Eric Covener <covener@gmail.com>
To: Apache HTTP Server Development List <dev@httpd.apache.org>
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: quoted-printable

On Sun, Sep 7, 2014 at 9:31 PM, Graham Leggett <minfrin@sharp.fm> wrote:
> The test suite passes with this patch, I need some more eyeballs to verif=
y I didn=E2=80=99t miss anything.

If content/request filters will now sometimes run on a different
thread, is this a special kind of major MMN bump?

From dev-return-84043-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Mon Oct  5 14:32:26 2015
Return-Path: <dev-return-84043-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 3760718D1B
	for <apmail-httpd-dev-archive@www.apache.org>; Mon,  5 Oct 2015 14:32:26 +0000 (UTC)
Received: (qmail 7886 invoked by uid 500); 5 Oct 2015 14:32:23 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 7782 invoked by uid 500); 5 Oct 2015 14:32:23 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 7726 invoked by uid 99); 5 Oct 2015 14:32:23 -0000
Received: from Unknown (HELO spamd1-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 05 Oct 2015 14:32:23 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd1-us-west.apache.org (ASF Mail Server at spamd1-us-west.apache.org) with ESMTP id 191E7C2A5E
	for <dev@httpd.apache.org>; Mon,  5 Oct 2015 14:32:23 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd1-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.011
X-Spam-Level:
X-Spam-Status: No, score=-0.011 tagged_above=-999 required=6.31
	tests=[SPF_PASS=-0.001, T_RP_MATCHES_RCVD=-0.01] autolearn=disabled
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd1-us-west.apache.org [10.40.0.7]) (amavisd-new, port 10024)
	with ESMTP id yMpRbSU892y0 for <dev@httpd.apache.org>;
	Mon,  5 Oct 2015 14:32:21 +0000 (UTC)
Received: from monica.sharp.fm (monica.sharp.fm [80.168.143.5])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTP id 3BEFE203A3
	for <dev@httpd.apache.org>; Mon,  5 Oct 2015 14:32:21 +0000 (UTC)
Received: from [10.105.13.207] (unknown [5.56.169.82])
	(using TLSv1 with cipher DHE-RSA-AES256-SHA (256/256 bits))
	(Client did not present a certificate)
	(Authenticated sender: minfrin@sharp.fm)
	by monica.sharp.fm (Postfix) with ESMTPSA id ED90583155
	for <dev@httpd.apache.org>; Mon,  5 Oct 2015 15:32:14 +0100 (BST)
Content-Type: text/plain; charset=utf-8
Mime-Version: 1.0 (Mac OS X Mail 8.2 \(2104\))
Subject: Re: [Patch] Async write completion for the full connection filter stack
From: Graham Leggett <minfrin@sharp.fm>
In-Reply-To: <CAKQ1sVPuOxqWbw3Uo1k7OTa+etsUJhL_9j=jfEykXJJD=-ft3Q@mail.gmail.com>
Date: Mon, 5 Oct 2015 16:32:13 +0200
Content-Transfer-Encoding: quoted-printable
Message-Id: <25555B3F-EFA2-4A39-90C2-2CB1439DE679@sharp.fm>
References: <A57B894B-50DA-4252-8FFF-C3DEF8473A61@sharp.fm> <D4B68B53-592F-4EEC-B39F-EFC9887F60D5@jaguNET.com> <715A3AE8-8015-4537-943F-A34E0E2A76F7@sharp.fm> <D7EA895A-9C37-4387-AE89-C1B7DF9B0706@jaguNET.com> <540DFB30.6050700@apache.org> <2F3B060C-E383-407F-A24C-7F026AD3CA81@sharp.fm> <AB1691BE05AE7F4992697F2A0835627AC5D859AB@VOEXM10W.internal.vodafone.com> <AA9FAD6C-8E83-4F5F-8F18-BC3BECF8B0A1@sharp.fm> <CAKQ1sVPFJk9-Y=JwDLvJcYT7ZCQ=xbuBRS9fu8Me_T-3f2fVXg@mail.gmail.com> <C6246136-6B10-4F7B-8261-6723ABD26817@sharp.fm> <CAKQ1sVMw0-=LsqPEkWYs1QP8daMYv=eaxhRT8gsnrppooVzuMg@mail.gmail.com> <7A74676C-AA9D-40E1-A434-9280C297217D@sharp.fm> <54128B11.9080803@apache.org> <496E8EFA-7A10-4D91-8C7E-434A9A3B09C5@sharp.fm> <541499A9.5050408@apache.org> <4D9E72F8-4918-49AD-8DC4-E3594C9ED43D@sharp.fm> <04776F50-0A53-4C1D-AA1C-9F57B60BC0AC@sharp.fm> <38C56976-E693-4EEE-88BA-85DE3328FED3@sharp.fm> <7051D658-B96C-47BA-B21F-6511665DDAD8@jaguNET.com> <28641C04-8936-4004-BA40-C889C8B7846A@sharp
 .fm> <CAKQ1sVPuOxqWbw3Uo1k7OTa+etsUJhL_9j=jfEykXJJD=-ft3Q@mail.gmail.com>
To: dev@httpd.apache.org
X-Mailer: Apple Mail (2.2104)

On 05 Oct 2015, at 1:13 PM, Yann Ylavic <ylavic.dev@gmail.com> wrote:

> Why suspend a filter rather than the calling handler (on =
EAGAIN/EWOULDBLOCK)?

Primarily because there are many filters, but only one handler. What I =
have in mind is combining an async bandwidth-limitation filter with an =
async handler. Right now you can=E2=80=99t do that, and you should be =
able to, that=E2=80=99s the point of the filter stack.

> It seems that suspending the handlers would avoid rewriting them as =
filters.
> Or is your plan to go for something like (mod_)serf?

Suspending the handler is an option, but it=E2=80=99s less than ideal if =
the handler suspends the connection while there is data buffered in the =
filter stack. In this case data writes will be delayed until the source =
of the data pushes more data through after the connection is woken up =
again. Ideally outbound data should be pulled out the stack, not pushed =
into it.

Regards,
Graham
=E2=80=94


From dev-return-84044-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Mon Oct  5 14:38:13 2015
Return-Path: <dev-return-84044-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 0842118D4C
	for <apmail-httpd-dev-archive@www.apache.org>; Mon,  5 Oct 2015 14:38:13 +0000 (UTC)
Received: (qmail 29198 invoked by uid 500); 5 Oct 2015 14:38:12 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 29126 invoked by uid 500); 5 Oct 2015 14:38:12 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 29116 invoked by uid 99); 5 Oct 2015 14:38:12 -0000
Received: from Unknown (HELO spamd3-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 05 Oct 2015 14:38:12 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd3-us-west.apache.org (ASF Mail Server at spamd3-us-west.apache.org) with ESMTP id 1D6541809A5
	for <dev@httpd.apache.org>; Mon,  5 Oct 2015 14:38:12 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd3-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.007
X-Spam-Level:
X-Spam-Status: No, score=-0.007 tagged_above=-999 required=6.31
	tests=[RP_MATCHES_RCVD=-0.006, SPF_PASS=-0.001] autolearn=disabled
Received: from mx1-us-west.apache.org ([10.40.0.8])
	by localhost (spamd3-us-west.apache.org [10.40.0.10]) (amavisd-new, port 10024)
	with ESMTP id BHNuR6foK_Bj for <dev@httpd.apache.org>;
	Mon,  5 Oct 2015 14:37:59 +0000 (UTC)
Received: from monica.sharp.fm (monica.sharp.fm [80.168.143.5])
	by mx1-us-west.apache.org (ASF Mail Server at mx1-us-west.apache.org) with ESMTP id DB31E23045
	for <dev@httpd.apache.org>; Mon,  5 Oct 2015 14:37:56 +0000 (UTC)
Received: from [10.105.13.207] (unknown [5.56.169.82])
	(using TLSv1 with cipher DHE-RSA-AES256-SHA (256/256 bits))
	(Client did not present a certificate)
	(Authenticated sender: minfrin@sharp.fm)
	by monica.sharp.fm (Postfix) with ESMTPSA id CF73383155
	for <dev@httpd.apache.org>; Mon,  5 Oct 2015 15:37:49 +0100 (BST)
Content-Type: text/plain; charset=utf-8
Mime-Version: 1.0 (Mac OS X Mail 8.2 \(2104\))
Subject: Re: [Patch] Async write completion for the full connection filter stack
From: Graham Leggett <minfrin@sharp.fm>
In-Reply-To: <CALK=YjMXYFVaZd=+7s=2H4TnhdAsDYxuR5uy+t=c=zHmcpN9Tw@mail.gmail.com>
Date: Mon, 5 Oct 2015 16:37:49 +0200
Content-Transfer-Encoding: quoted-printable
Message-Id: <D51BFFCE-5364-4AC9-8C6F-194B3F4E6E23@sharp.fm>
References: <A57B894B-50DA-4252-8FFF-C3DEF8473A61@sharp.fm> <CALK=YjMXYFVaZd=+7s=2H4TnhdAsDYxuR5uy+t=c=zHmcpN9Tw@mail.gmail.com>
To: dev@httpd.apache.org
X-Mailer: Apple Mail (2.2104)

On 05 Oct 2015, at 4:25 PM, Eric Covener <covener@gmail.com> wrote:

> If content/request filters will now sometimes run on a different
> thread, is this a special kind of major MMN bump?


Content/request filters won=E2=80=99t run on a different thread, no.

The only filters that will do so are filters that have been updated to =
use the new async API, and right now that=E2=80=99s mod_ssl and the core =
network filter (which always had this capability).

If it were to become a problem, the whole patch can be disabled by =
forcing ap_filter_should_yield() to return false. I don=E2=80=99t =
believe we need a switch at this stage however, but it is there should =
it be needed.

Regards,
Graham
=E2=80=94


From dev-return-84045-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Mon Oct  5 14:40:22 2015
Return-Path: <dev-return-84045-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 485F418D63
	for <apmail-httpd-dev-archive@www.apache.org>; Mon,  5 Oct 2015 14:40:22 +0000 (UTC)
Received: (qmail 33511 invoked by uid 500); 5 Oct 2015 14:40:16 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 33433 invoked by uid 500); 5 Oct 2015 14:40:16 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 33423 invoked by uid 99); 5 Oct 2015 14:40:16 -0000
Received: from Unknown (HELO spamd1-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 05 Oct 2015 14:40:16 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd1-us-west.apache.org (ASF Mail Server at spamd1-us-west.apache.org) with ESMTP id 46C1BC2A6F
	for <dev@httpd.apache.org>; Mon,  5 Oct 2015 14:40:16 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd1-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.12
X-Spam-Level:
X-Spam-Status: No, score=-0.12 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RCVD_IN_MSPIKE_H3=-0.01, RCVD_IN_MSPIKE_WL=-0.01, SPF_PASS=-0.001,
	URIBL_BLOCKED=0.001] autolearn=disabled
Authentication-Results: spamd1-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd1-us-west.apache.org [10.40.0.7]) (amavisd-new, port 10024)
	with ESMTP id 3tK2l3vQmS6Q for <dev@httpd.apache.org>;
	Mon,  5 Oct 2015 14:40:09 +0000 (UTC)
Received: from mail-ig0-f177.google.com (mail-ig0-f177.google.com [209.85.213.177])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id 226D3204D9
	for <dev@httpd.apache.org>; Mon,  5 Oct 2015 14:40:09 +0000 (UTC)
Received: by igxx6 with SMTP id x6so58694792igx.1
        for <dev@httpd.apache.org>; Mon, 05 Oct 2015 07:40:02 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type:content-transfer-encoding;
        bh=pc/0xu8prrlZkupCVu2BNJlZNwEvuECHF1DHRifRdG4=;
        b=T3fUiOZ9uiC9yP0fMFEtx1C/5UNcqYKxZuw0Ero2S2Ow+K3iTtGxzcoLRmlMke+jt3
         KakQrKhEIpKlNli0F2OUGug2NLSN2ocjmpupndGKNze0H3/NHtQ1uGhwsBrKA2FdxQXM
         OIEx/Ft+7HhviabFeBhg253w3TWJu4H4961w23t29sZzQ88+ndYrA6x2acLutwnCY+uN
         Hu9eBGiWVElm5ynA0+rokpzoKNrFROnJsHMCR8pPAAYtvkKRWVNjiLSUlhaEZZkxZEan
         3uOJfGcYlHJlh2UL2ZU7feq8bI1Ly4uF8bvlgvG8jB3LQRp+P1LeGDnzBVZaGshCbwvI
         Rv0w==
MIME-Version: 1.0
X-Received: by 10.51.17.33 with SMTP id gb1mr1888964igd.36.1444056002205; Mon,
 05 Oct 2015 07:40:02 -0700 (PDT)
Received: by 10.64.25.3 with HTTP; Mon, 5 Oct 2015 07:40:02 -0700 (PDT)
In-Reply-To: <D51BFFCE-5364-4AC9-8C6F-194B3F4E6E23@sharp.fm>
References: <A57B894B-50DA-4252-8FFF-C3DEF8473A61@sharp.fm>
	<CALK=YjMXYFVaZd=+7s=2H4TnhdAsDYxuR5uy+t=c=zHmcpN9Tw@mail.gmail.com>
	<D51BFFCE-5364-4AC9-8C6F-194B3F4E6E23@sharp.fm>
Date: Mon, 5 Oct 2015 10:40:02 -0400
Message-ID: <CALK=YjP6ZWuhpDE7djXOkGX-2+ZErAF_q2w02UpmFybRNj0Wsg@mail.gmail.com>
Subject: Re: [Patch] Async write completion for the full connection filter stack
From: Eric Covener <covener@gmail.com>
To: Apache HTTP Server Development List <dev@httpd.apache.org>
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: quoted-printable

On Mon, Oct 5, 2015 at 10:37 AM, Graham Leggett <minfrin@sharp.fm> wrote:
> On 05 Oct 2015, at 4:25 PM, Eric Covener <covener@gmail.com> wrote:
>
>> If content/request filters will now sometimes run on a different
>> thread, is this a special kind of major MMN bump?
>
>
> Content/request filters won=E2=80=99t run on a different thread, no.
>
Sorry, dunno how I got turned around on that -- clear from the first email.

From dev-return-84046-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Mon Oct  5 14:57:38 2015
Return-Path: <dev-return-84046-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 8877518E4C
	for <apmail-httpd-dev-archive@www.apache.org>; Mon,  5 Oct 2015 14:57:38 +0000 (UTC)
Received: (qmail 82613 invoked by uid 500); 5 Oct 2015 14:57:38 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 82539 invoked by uid 500); 5 Oct 2015 14:57:38 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 82529 invoked by uid 99); 5 Oct 2015 14:57:38 -0000
Received: from Unknown (HELO spamd2-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 05 Oct 2015 14:57:37 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd2-us-west.apache.org (ASF Mail Server at spamd2-us-west.apache.org) with ESMTP id 741D01A0A91
	for <dev@httpd.apache.org>; Mon,  5 Oct 2015 14:57:37 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd2-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 0.001
X-Spam-Level:
X-Spam-Status: No, score=0.001 tagged_above=-999 required=6.31
	tests=[RP_MATCHES_RCVD=0.001, SPF_PASS=-0.001, URIBL_BLOCKED=0.001]
	autolearn=disabled
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd2-us-west.apache.org [10.40.0.9]) (amavisd-new, port 10024)
	with ESMTP id WMSRbXMUM3q0 for <dev@httpd.apache.org>;
	Mon,  5 Oct 2015 14:57:29 +0000 (UTC)
Received: from monica.sharp.fm (monica.sharp.fm [80.168.143.5])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTP id 4A017204DD
	for <dev@httpd.apache.org>; Mon,  5 Oct 2015 14:57:29 +0000 (UTC)
Received: from [10.105.13.207] (unknown [5.56.169.82])
	(using TLSv1 with cipher DHE-RSA-AES256-SHA (256/256 bits))
	(Client did not present a certificate)
	(Authenticated sender: minfrin@sharp.fm)
	by monica.sharp.fm (Postfix) with ESMTPSA id B050283155
	for <dev@httpd.apache.org>; Mon,  5 Oct 2015 15:57:28 +0100 (BST)
Content-Type: text/plain; charset=windows-1252
Mime-Version: 1.0 (Mac OS X Mail 8.2 \(2104\))
Subject: Re: Serf and mod_lua and libmill (Was: Re: [Patch] Async write completion for the full connection filter stack)
From: Graham Leggett <minfrin@sharp.fm>
In-Reply-To: <4203E8A4-546F-4DFA-977F-59C457F4580D@jaguNET.com>
Date: Mon, 5 Oct 2015 16:57:27 +0200
Content-Transfer-Encoding: quoted-printable
Message-Id: <BDAEAB21-3353-4E29-8D16-461437C17E35@sharp.fm>
References: <A57B894B-50DA-4252-8FFF-C3DEF8473A61@sharp.fm> <D4B68B53-592F-4EEC-B39F-EFC9887F60D5@jaguNET.com> <715A3AE8-8015-4537-943F-A34E0E2A76F7@sharp.fm> <D7EA895A-9C37-4387-AE89-C1B7DF9B0706@jaguNET.com> <540DFB30.6050700@apache.org> <2F3B060C-E383-407F-A24C-7F026AD3CA81@sharp.fm> <AB1691BE05AE7F4992697F2A0835627AC5D859AB@VOEXM10W.internal.vodafone.com> <AA9FAD6C-8E83-4F5F-8F18-BC3BECF8B0A1@sharp.fm> <CAKQ1sVPFJk9-Y=JwDLvJcYT7ZCQ=xbuBRS9fu8Me_T-3f2fVXg@mail.gmail.com> <C6246136-6B10-4F7B-8261-6723ABD26817@sharp.fm> <CAKQ1sVMw0-=LsqPEkWYs1QP8daMYv=eaxhRT8gsnrppooVzuMg@mail.gmail.com> <7A74676C-AA9D-40E1-A434-9280C297217D@sharp.fm> <54128B11.9080803@apache.org> <496E8EFA-7A10-4D91-8C7E-434A9A3B09C5@sharp.fm> <541499A9.5050408@apache.org> <4D9E72F8-4918-49AD-8DC4-E3594C9ED43D@sharp.fm> <04776F50-0A53-4C1D-AA1C-9F57B60BC0AC@sharp.fm> <38C56976-E693-4EEE-88BA-85DE3328FED3@sharp.fm> <7051D658-B96C-47BA-B21F-6511665DDAD8@jaguNET.com> <28641C04-8936-4004-BA40-C889C8B7846A@sharp
 .fm> <BA 1BA267-72A4-4044-86DB-25552E07E67D@c8h10n4o2.org.uk> <4203E8A4-546F-4DFA-977F-59C457F4580D@jaguNET.com>
To: dev@httpd.apache.org
X-Mailer: Apple Mail (2.2104)

On 05 Oct 2015, at 3:41 PM, Jim Jagielski <jim@jaguNET.com> wrote:

> Of course, this could also result in the issue we currently
> have w/ APR in which APR itself lags behind what httpd itself
> needs and we end up add stuff to httpd anyway...
>=20
> Hmmmm...

This was my approach:

I wanted the moon on a stick.

What exactly constituted a moon on a stick? I wanted all of the =
following:

- I wanted to make httpd asynchronous, and decisively allow httpd to =
join the list of servers that can support hundreds of thousands of =
concurrent requests across the board, not just as a special case for =
specific content (files).

- I didn=92t want to wait. This means I wanted whatever change I made to =
be backport-able to httpd v2.4. I don=92t care to wait 5 years for httpd =
v2.6 to finally to appear as the default version in stable OS distros.

- I wanted to work with what was already there. That meant making the =
existing ap_filter API and the existing buckets work with backwards =
compatible changes to httpd and no changes to apr/apr-util.

- I wanted a mechanism that was not brittle. This is probably the =
hardest part of async programming, how do you prevent something spinning =
or hanging? When the new mechanism is used wrong the thread just becomes =
synchronous until the data is written and eventually works anyway, which =
is existing behaviour and not the end of the world.

I am aware that some people have said that it couldn=92t be done in =
httpd=92s design. I figured let me test that hypothesis by trying =
anyway, the worst that could happen was that they were right but the =
server could at least be improved as best it could. I believe however =
that there is a good chance the moon on a stick has been achieved.

Regards,
Graham
=97


From dev-return-84047-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Mon Oct  5 15:13:14 2015
Return-Path: <dev-return-84047-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 901B318ED4
	for <apmail-httpd-dev-archive@www.apache.org>; Mon,  5 Oct 2015 15:13:14 +0000 (UTC)
Received: (qmail 18179 invoked by uid 500); 5 Oct 2015 15:13:09 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 18103 invoked by uid 500); 5 Oct 2015 15:13:09 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 18083 invoked by uid 99); 5 Oct 2015 15:13:09 -0000
Received: from Unknown (HELO spamd4-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 05 Oct 2015 15:13:08 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd4-us-west.apache.org (ASF Mail Server at spamd4-us-west.apache.org) with ESMTP id 8972AC028F
	for <dev@httpd.apache.org>; Mon,  5 Oct 2015 15:13:08 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd4-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.12
X-Spam-Level:
X-Spam-Status: No, score=-0.12 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RCVD_IN_MSPIKE_H3=-0.01, RCVD_IN_MSPIKE_WL=-0.01, SPF_PASS=-0.001,
	URIBL_BLOCKED=0.001] autolearn=disabled
Authentication-Results: spamd4-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-us-west.apache.org ([10.40.0.8])
	by localhost (spamd4-us-west.apache.org [10.40.0.11]) (amavisd-new, port 10024)
	with ESMTP id ECpXaSvC0qsu for <dev@httpd.apache.org>;
	Mon,  5 Oct 2015 15:13:03 +0000 (UTC)
Received: from mail-ig0-f181.google.com (mail-ig0-f181.google.com [209.85.213.181])
	by mx1-us-west.apache.org (ASF Mail Server at mx1-us-west.apache.org) with ESMTPS id BF2B42303E
	for <dev@httpd.apache.org>; Mon,  5 Oct 2015 15:13:01 +0000 (UTC)
Received: by igcpb10 with SMTP id pb10so65130705igc.1
        for <dev@httpd.apache.org>; Mon, 05 Oct 2015 08:13:01 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type:content-transfer-encoding;
        bh=hKTNOo3wV9Oy9/x/gWHiKDRA31kVAbOFmnnuAz7uz5M=;
        b=nwxDNt1OK1JsSZlM6pFyB5qzvASyFZTlxgbpz0E5eBnm6pykyjj8T5PnKox8P/U3zT
         i0z36r00prPkZIt7h9iyWcafSDTK/eImZt/pT/QljNQRF7GuMHtjmqCjkFmrUe0KdRHq
         cpXG30ZrOFG5mqNmPdtLCqvKhASV/BYcVI6pyeqFb/rphnIFGC80ILPMZhVxFJgWKKMR
         /ghm3NTbfv4cgMhtDj409X2M53T3xMcSdNroJtEO7xZaKKdIF9TsZnPvRUI/itcAyapV
         yAywzizJX9YVpIxZz+FsyXLeN92goUDxt+hXq7w6chDwLOTWCvaV266iVLrKk4Ghsftq
         s3tg==
MIME-Version: 1.0
X-Received: by 10.50.28.72 with SMTP id z8mr9437976igg.36.1444057981220; Mon,
 05 Oct 2015 08:13:01 -0700 (PDT)
Received: by 10.64.25.3 with HTTP; Mon, 5 Oct 2015 08:13:01 -0700 (PDT)
In-Reply-To: <BDAEAB21-3353-4E29-8D16-461437C17E35@sharp.fm>
References: <A57B894B-50DA-4252-8FFF-C3DEF8473A61@sharp.fm>
	<D4B68B53-592F-4EEC-B39F-EFC9887F60D5@jaguNET.com>
	<715A3AE8-8015-4537-943F-A34E0E2A76F7@sharp.fm>
	<D7EA895A-9C37-4387-AE89-C1B7DF9B0706@jaguNET.com>
	<540DFB30.6050700@apache.org>
	<2F3B060C-E383-407F-A24C-7F026AD3CA81@sharp.fm>
	<AB1691BE05AE7F4992697F2A0835627AC5D859AB@VOEXM10W.internal.vodafone.com>
	<AA9FAD6C-8E83-4F5F-8F18-BC3BECF8B0A1@sharp.fm>
	<CAKQ1sVPFJk9-Y=JwDLvJcYT7ZCQ=xbuBRS9fu8Me_T-3f2fVXg@mail.gmail.com>
	<C6246136-6B10-4F7B-8261-6723ABD26817@sharp.fm>
	<CAKQ1sVMw0-=LsqPEkWYs1QP8daMYv=eaxhRT8gsnrppooVzuMg@mail.gmail.com>
	<7A74676C-AA9D-40E1-A434-9280C297217D@sharp.fm>
	<54128B11.9080803@apache.org>
	<496E8EFA-7A10-4D91-8C7E-434A9A3B09C5@sharp.fm>
	<541499A9.5050408@apache.org>
	<4D9E72F8-4918-49AD-8DC4-E3594C9ED43D@sharp.fm>
	<04776F50-0A53-4C1D-AA1C-9F57B60BC0AC@sharp.fm>
	<38C56976-E693-4EEE-88BA-85DE3328FED3@sharp.fm>
	<7051D658-B96C-47BA-B21F-6511665DDAD8@jaguNET.com>
	<4203E8A4-546F-4DFA-977F-59C457F4580D@jaguNET.com>
	<BDAEAB21-3353-4E29-8D16-461437C17E35@sharp.fm>
Date: Mon, 5 Oct 2015 11:13:01 -0400
Message-ID: <CALK=YjMdLMkJPBd7Jzc3d9MHcV7PWQLA664wP+eoFvDYtH-rmw@mail.gmail.com>
Subject: Re: Serf and mod_lua and libmill (Was: Re: [Patch] Async write
 completion for the full connection filter stack)
From: Eric Covener <covener@gmail.com>
To: Apache HTTP Server Development List <dev@httpd.apache.org>
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: quoted-printable

On Mon, Oct 5, 2015 at 10:57 AM, Graham Leggett <minfrin@sharp.fm> wrote:
>
> What exactly constituted a moon on a stick? I wanted all of the following=
:
>
> - I wanted to make httpd asynchronous, and decisively allow httpd to join=
 the list of servers that can support hundreds of thousands of concurrent r=
equests across the board, not just as a special case for specific content (=
files).
>
> - I didn=E2=80=99t want to wait. This means I wanted whatever change I ma=
de to be backport-able to httpd v2.4. I don=E2=80=99t care to wait 5 years =
for httpd v2.6 to finally to appear as the default version in stable OS dis=
tros.
>
> - I wanted to work with what was already there. That meant making the exi=
sting ap_filter API and the existing buckets work with backwards compatible=
 changes to httpd and no changes to apr/apr-util.
>
> - I wanted a mechanism that was not brittle. This is probably the hardest=
 part of async programming, how do you prevent something spinning or hangin=
g? When the new mechanism is used wrong the thread just becomes synchronous=
 until the data is written and eventually works anyway, which is existing b=
ehaviour and not the end of the world.
>
> I am aware that some people have said that it couldn=E2=80=99t be done in=
 httpd=E2=80=99s design. I figured let me test that hypothesis by trying an=
yway, the worst that could happen was that they were right but the server c=
ould at least be improved as best it could. I believe however that there is=
 a good chance the moon on a stick has been achieved.

Is it that common for so much of the server to be tied up in write
completion, or just a very big problem for some systems? Most of my
experience is the opposite  problem --  slow (java!) backends rather
than clients not keeping up with the firehose.  It seems like
extending that to handlers (and implicitly, request filters) is more
the  "can't be done" part.

From dev-return-84048-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Mon Oct  5 15:49:43 2015
Return-Path: <dev-return-84048-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 2705E1811E
	for <apmail-httpd-dev-archive@www.apache.org>; Mon,  5 Oct 2015 15:49:43 +0000 (UTC)
Received: (qmail 30203 invoked by uid 500); 5 Oct 2015 15:49:42 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 30132 invoked by uid 500); 5 Oct 2015 15:49:42 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 30122 invoked by uid 99); 5 Oct 2015 15:49:42 -0000
Received: from Unknown (HELO spamd4-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 05 Oct 2015 15:49:42 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd4-us-west.apache.org (ASF Mail Server at spamd4-us-west.apache.org) with ESMTP id 1C8FBC028F
	for <dev@httpd.apache.org>; Mon,  5 Oct 2015 15:49:42 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd4-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.007
X-Spam-Level:
X-Spam-Status: No, score=-0.007 tagged_above=-999 required=6.31
	tests=[RP_MATCHES_RCVD=-0.006, SPF_PASS=-0.001] autolearn=disabled
Received: from mx1-us-west.apache.org ([10.40.0.8])
	by localhost (spamd4-us-west.apache.org [10.40.0.11]) (amavisd-new, port 10024)
	with ESMTP id dtKlB6A59nxT for <dev@httpd.apache.org>;
	Mon,  5 Oct 2015 15:49:41 +0000 (UTC)
Received: from monica.sharp.fm (monica.sharp.fm [80.168.143.5])
	by mx1-us-west.apache.org (ASF Mail Server at mx1-us-west.apache.org) with ESMTP id 8349420756
	for <dev@httpd.apache.org>; Mon,  5 Oct 2015 15:49:40 +0000 (UTC)
Received: from [10.105.13.207] (unknown [5.56.169.82])
	(using TLSv1 with cipher DHE-RSA-AES256-SHA (256/256 bits))
	(Client did not present a certificate)
	(Authenticated sender: minfrin@sharp.fm)
	by monica.sharp.fm (Postfix) with ESMTPSA id 9A3EC83151
	for <dev@httpd.apache.org>; Mon,  5 Oct 2015 16:49:39 +0100 (BST)
Content-Type: text/plain; charset=utf-8
Mime-Version: 1.0 (Mac OS X Mail 8.2 \(2104\))
Subject: Re: Serf and mod_lua and libmill (Was: Re: [Patch] Async write completion for the full connection filter stack)
From: Graham Leggett <minfrin@sharp.fm>
In-Reply-To: <CALK=YjMdLMkJPBd7Jzc3d9MHcV7PWQLA664wP+eoFvDYtH-rmw@mail.gmail.com>
Date: Mon, 5 Oct 2015 17:49:38 +0200
Content-Transfer-Encoding: quoted-printable
Message-Id: <30DBB807-99FD-43FC-AC5E-F55D4BCF679A@sharp.fm>
References: <A57B894B-50DA-4252-8FFF-C3DEF8473A61@sharp.fm> <D4B68B53-592F-4EEC-B39F-EFC9887F60D5@jaguNET.com> <715A3AE8-8015-4537-943F-A34E0E2A76F7@sharp.fm> <D7EA895A-9C37-4387-AE89-C1B7DF9B0706@jaguNET.com> <540DFB30.6050700@apache.org> <2F3B060C-E383-407F-A24C-7F026AD3CA81@sharp.fm> <AB1691BE05AE7F4992697F2A0835627AC5D859AB@VOEXM10W.internal.vodafone.com> <AA9FAD6C-8E83-4F5F-8F18-BC3BECF8B0A1@sharp.fm> <CAKQ1sVPFJk9-Y=JwDLvJcYT7ZCQ=xbuBRS9fu8Me_T-3f2fVXg@mail.gmail.com> <C6246136-6B10-4F7B-8261-6723ABD26817@sharp.fm> <CAKQ1sVMw0-=LsqPEkWYs1QP8daMYv=eaxhRT8gsnrppooVzuMg@mail.gmail.com> <7A74676C-AA9D-40E1-A434-9280C297217D@sharp.fm> <54128B11.9080803@apache.org> <496E8EFA-7A10-4D91-8C7E-434A9A3B09C5@sharp.fm> <541499A9.5050408@apache.org> <4D9E72F8-4918-49AD-8DC4-E3594C9ED43D@sharp.fm> <04776F50-0A53-4C1D-AA1C-9F57B60BC0AC@sharp.fm> <38C56976-E693-4EEE-88BA-85DE3328FED3@sharp.fm> <7051D658-B96C-47BA-B21F-6511665DDAD8@jaguNET.com> <4203E8A4-546F-4DFA-977F-59C457F4580D@jaguN
 ET.com> <BDAEAB21-3353-4E29-8D16-461437C17E35@sharp.fm> <CALK=YjMdLMkJPBd7Jzc3d9MHcV7PWQLA664wP+eoFvDYtH-rmw@mail.gmail.com>
To: dev@httpd.apache.org
X-Mailer: Apple Mail (2.2104)

On 05 Oct 2015, at 5:13 PM, Eric Covener <covener@gmail.com> wrote:

> Is it that common for so much of the server to be tied up in write
> completion, or just a very big problem for some systems? Most of my
> experience is the opposite  problem --  slow (java!) backends rather
> than clients not keeping up with the firehose.

It is not common enough for the server to be in write completion. Until =
now mod_ssl couldn=E2=80=99t enter write completion because it had no =
way to yield without writing the entire response successfully to the =
network. As soon as you added SSL the server got synchronous.

The key problem to solve was the =E2=80=9Cmod_cache problem=E2=80=9D. =
How does a backend write into mod_cache at full speed and then go away =
as soon as possible, while a slow client eventually reads the response? =
We can now (soon, when mod_cache is taught to be async like mod_ssl is) =
do that, and that is very cool.

The slow clients that become a killer are those on a dodgy mobile phone =
connection that ends up using a slot for far longer than they should. If =
that slot is tied through via the proxy to a slow java app, that sucks =
even more.

>  It seems like
> extending that to handlers (and implicitly, request filters) is more
> the  "can't be done" part.

I=E2=80=99ve been working from right to left, from the network filter =
backwards to the handlers, and the solution I=E2=80=99ve explored is =
=E2=80=9Cif it can=E2=80=99t be done in a handler, make it possible to =
be done in a filter instead=E2=80=9D.

The idea is that the handler sets up the filter stack, and then sends =
down some data to kick things off (or no data like mod_cache does). At =
that point the handler exits and we=E2=80=99re now in write completion. =
The filter now (soon) has the power to suspend the connection if we=E2=80=99=
re waiting for someone else (like a connection from the proxy, a timer =
callback, whatever), and also has the power to switch the =E2=80=9Csense=E2=
=80=9D of a connection from a write to a read. So the output filter =
might switch the sense to read and then leave, and then when the read =
event is triggered and we=E2=80=99re kicked, try do a read on the input =
filter stack.

I suspect that a handler can do the same thing right now - switch the =
sense to read and then suspend itself. On the next read, the handler =
will be woken up, and off we go, ready to read once. Rinse repeat until =
we=E2=80=99re done reading.

Regards,
Graham
=E2=80=94


From dev-return-84049-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Mon Oct  5 15:53:15 2015
Return-Path: <dev-return-84049-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 5F28518147
	for <apmail-httpd-dev-archive@www.apache.org>; Mon,  5 Oct 2015 15:53:15 +0000 (UTC)
Received: (qmail 42523 invoked by uid 500); 5 Oct 2015 15:53:14 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 42454 invoked by uid 500); 5 Oct 2015 15:53:14 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 42444 invoked by uid 99); 5 Oct 2015 15:53:14 -0000
Received: from Unknown (HELO spamd1-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 05 Oct 2015 15:53:14 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd1-us-west.apache.org (ASF Mail Server at spamd1-us-west.apache.org) with ESMTP id 25A8EC2A34
	for <dev@httpd.apache.org>; Mon,  5 Oct 2015 15:53:14 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd1-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 0.653
X-Spam-Level:
X-Spam-Status: No, score=0.653 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, SPF_NEUTRAL=0.652,
	URIBL_BLOCKED=0.001] autolearn=disabled
Authentication-Results: spamd1-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=comcast.net
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd1-us-west.apache.org [10.40.0.7]) (amavisd-new, port 10024)
	with ESMTP id nSCdAVs8qo5W for <dev@httpd.apache.org>;
	Mon,  5 Oct 2015 15:53:06 +0000 (UTC)
Received: from resqmta-ch2-12v.sys.comcast.net (resqmta-ch2-12v.sys.comcast.net [69.252.207.44])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id 9376742B59
	for <dev@httpd.apache.org>; Mon,  5 Oct 2015 15:53:05 +0000 (UTC)
Received: from resomta-ch2-08v.sys.comcast.net ([69.252.207.104])
	by resqmta-ch2-12v.sys.comcast.net with comcast
	id RTsG1r00L2Fh1PH01TszQM; Mon, 05 Oct 2015 15:52:59 +0000
Received: from [192.168.199.10] ([69.251.84.114])
	by resomta-ch2-08v.sys.comcast.net with comcast
	id RTsy1r00Y2U0RYt01TszVM; Mon, 05 Oct 2015 15:52:59 +0000
Content-Type: text/plain; charset=windows-1252
Mime-Version: 1.0 (Mac OS X Mail 8.2 \(2104\))
Subject: Re: Serf and mod_lua and libmill (Was: Re: [Patch] Async write completion for the full connection filter stack)
From: Jim Jagielski <jim@jaguNET.com>
In-Reply-To: <BDAEAB21-3353-4E29-8D16-461437C17E35@sharp.fm>
Date: Mon, 5 Oct 2015 11:52:58 -0400
Content-Transfer-Encoding: quoted-printable
Message-Id: <561C681E-0B07-4C03-B009-BEAE6E8F89AA@jaguNET.com>
References: <A57B894B-50DA-4252-8FFF-C3DEF8473A61@sharp.fm> <D4B68B53-592F-4EEC-B39F-EFC9887F60D5@jaguNET.com> <715A3AE8-8015-4537-943F-A34E0E2A76F7@sharp.fm> <D7EA895A-9C37-4387-AE89-C1B7DF9B0706@jaguNET.com> <540DFB30.6050700@apache.org> <2F3B060C-E383-407F-A24C-7F026AD3CA81@sharp.fm> <AB1691BE05AE7F4992697F2A0835627AC5D859AB@VOEXM10W.internal.vodafone.com> <AA9FAD6C-8E83-4F5F-8F18-BC3BECF8B0A1@sharp.fm> <CAKQ1sVPFJk9-Y=JwDLvJcYT7ZCQ=xbuBRS9fu8Me_T-3f2fVXg@mail.gmail.com> <C6246136-6B10-4F7B-8261-6723ABD26817@sharp.fm> <CAKQ1sVMw0-=LsqPEkWYs1QP8daMYv=eaxhRT8gsnrppooVzuMg@mail.gmail.com> <7A74676C-AA9D-40E1-A434-9280C297217D@sharp.fm> <54128B11.9080803@apache.org> <496E8EFA-7A10-4D91-8C7E-434A9A3B09C5@sharp.fm> <541499A9.5050408@apache.org> <4D9E72F8-4918-49AD-8DC4-E3594C9ED43D@sharp.fm> <04776F50-0A53-4C1D-AA1C-9F57B60BC0AC@sharp.fm> <38C56976-E693-4EEE-88BA-85DE3328FED3@sharp.fm> <7051D658-B96C-47BA-B21F-6511665DDAD8@jaguNET.com> <28641C04-8936-4004-BA40-C889C8B7846A@sharp .fm> <B
 A 1BA267-72A4-4044-86DB-25552E07E67D@c8h10n4o2.org.uk> <4203E8A4-546F-4DFA-977F-59C457F4580D@jaguNET.com> <BDAEAB21-3353-4E29-8D16-461437C17E35@sharp.fm>
To: dev@httpd.apache.org
X-Mailer: Apple Mail (2.2104)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=comcast.net;
	s=q20140121; t=1444060379;
	bh=KLC7anL5PxNZydCjaub6+dVYYIKLWrZp5Irhc0tZz6s=;
	h=Received:Received:Content-Type:Mime-Version:Subject:From:Date:
	 Message-Id:To;
	b=btr7IvJRmywqOxHRKAUEnZqdL9T92vjn2W8IFI9ukolspHrzxXONi2Wai8FCKsWHZ
	 lfCtctF1Aa4B5ndJArQChmKQ+yNb5fA6RkFjzv2fqYEpzyrdh6mwcFQlaDw3CdWZcl
	 UZDIsgr6RJODGHfyXFUGFT+M0e08311v24+nylVAXvAawQgiuVN35IHZL5kKokUU1b
	 Fqd3QOvpkHHkbAPNBnw2w4w0x5667EC2reHMbpkdSuJhr1b/NV7e1ubMqS9iS/2vf8
	 gIQWRWxUn+iWc3+qUwR/2IpEnBhFoZJBJJU8DU+a17M6pIofLw2FlQB+TU/bZ3PnTC
	 vMUdyxI7JJq0g==

Achieved!!

Once again: this is some super cool mojo!!!

> On Oct 5, 2015, at 10:57 AM, Graham Leggett <minfrin@sharp.fm> wrote:
>=20
> On 05 Oct 2015, at 3:41 PM, Jim Jagielski <jim@jaguNET.com> wrote:
>=20
>> Of course, this could also result in the issue we currently
>> have w/ APR in which APR itself lags behind what httpd itself
>> needs and we end up add stuff to httpd anyway...
>>=20
>> Hmmmm...
>=20
> This was my approach:
>=20
> I wanted the moon on a stick.
>=20
> What exactly constituted a moon on a stick? I wanted all of the =
following:
>=20
> - I wanted to make httpd asynchronous, and decisively allow httpd to =
join the list of servers that can support hundreds of thousands of =
concurrent requests across the board, not just as a special case for =
specific content (files).
>=20
> - I didn=92t want to wait. This means I wanted whatever change I made =
to be backport-able to httpd v2.4. I don=92t care to wait 5 years for =
httpd v2.6 to finally to appear as the default version in stable OS =
distros.
>=20
> - I wanted to work with what was already there. That meant making the =
existing ap_filter API and the existing buckets work with backwards =
compatible changes to httpd and no changes to apr/apr-util.
>=20
> - I wanted a mechanism that was not brittle. This is probably the =
hardest part of async programming, how do you prevent something spinning =
or hanging? When the new mechanism is used wrong the thread just becomes =
synchronous until the data is written and eventually works anyway, which =
is existing behaviour and not the end of the world.
>=20
> I am aware that some people have said that it couldn=92t be done in =
httpd=92s design. I figured let me test that hypothesis by trying =
anyway, the worst that could happen was that they were right but the =
server could at least be improved as best it could. I believe however =
that there is a good chance the moon on a stick has been achieved.
>=20
> Regards,
> Graham
> =97
>=20


From dev-return-84050-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Mon Oct  5 15:54:28 2015
Return-Path: <dev-return-84050-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 4C72318155
	for <apmail-httpd-dev-archive@www.apache.org>; Mon,  5 Oct 2015 15:54:28 +0000 (UTC)
Received: (qmail 44957 invoked by uid 500); 5 Oct 2015 15:54:27 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 44870 invoked by uid 500); 5 Oct 2015 15:54:27 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 44860 invoked by uid 99); 5 Oct 2015 15:54:27 -0000
Received: from Unknown (HELO spamd1-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 05 Oct 2015 15:54:27 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd1-us-west.apache.org (ASF Mail Server at spamd1-us-west.apache.org) with ESMTP id 5AA2FC2AB5
	for <dev@httpd.apache.org>; Mon,  5 Oct 2015 15:54:27 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd1-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 0.652
X-Spam-Level:
X-Spam-Status: No, score=0.652 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, SPF_NEUTRAL=0.652]
	autolearn=disabled
Authentication-Results: spamd1-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=comcast.net
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd1-us-west.apache.org [10.40.0.7]) (amavisd-new, port 10024)
	with ESMTP id pvw2WRkNMrfT for <dev@httpd.apache.org>;
	Mon,  5 Oct 2015 15:54:12 +0000 (UTC)
Received: from resqmta-ch2-07v.sys.comcast.net (resqmta-ch2-07v.sys.comcast.net [69.252.207.39])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id E2ECE2125A
	for <dev@httpd.apache.org>; Mon,  5 Oct 2015 15:54:11 +0000 (UTC)
Received: from resomta-ch2-05v.sys.comcast.net ([69.252.207.101])
	by resqmta-ch2-07v.sys.comcast.net with comcast
	id RTqg1r0022Bo0NV01Tu5kG; Mon, 05 Oct 2015 15:54:05 +0000
Received: from [192.168.199.10] ([69.251.84.114])
	by resomta-ch2-05v.sys.comcast.net with comcast
	id RTu41r00N2U0RYt01Tu4HG; Mon, 05 Oct 2015 15:54:05 +0000
From: Jim Jagielski <jim@jaguNET.com>
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
Subject: T&R of 2.4.17 this week
Message-Id: <9ACC24A9-B381-4C18-B1C4-8D9F62DD7DB5@jaguNET.com>
Date: Mon, 5 Oct 2015 11:54:04 -0400
To: httpd <dev@httpd.apache.org>
Mime-Version: 1.0 (Mac OS X Mail 8.2 \(2104\))
X-Mailer: Apple Mail (2.2104)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=comcast.net;
	s=q20140121; t=1444060445;
	bh=Nu0ODBWUCviMoEgRFjq9/pVROX3PCpiMg2zeisNoQwg=;
	h=Received:Received:From:Content-Type:Subject:Message-Id:Date:To:
	 Mime-Version;
	b=TTh3oBn3tzkDtMIi/y/9xVzZmQepPxhpxBcTdICuVWH425XfUmDA4xUaluHW+kIvE
	 owR3YVn0I4G5k6XWPyBRnUgBmbCGjJI0S+nc0f4S4be3V8zFCSozrpzbwG2oPJt/tv
	 BD7rBiEzu+UdZC06NT/NAiF0kWsdAJfo9EsBjdJkSZpJmjKrHhlcuIZOp2q4OO1jO7
	 hmp5HrDoUNxuA/NaDVWq9a01Qg/Pu3lMrvJ4QviFyiSUXoBuPuHyriNc+Fh9I+88tM
	 vUi8GH8297wXC/P5Sej8Q8ZdjYJdZ8NBJkxp7/9KTqqHYnlQPmxl4CFoSLSCSmBOtg
	 hV1QHfLDBfzFg==

I propose a T&R of 2.4.17 this week with a release for next. I
will RM.

Comments?

From dev-return-84051-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Mon Oct  5 16:10:56 2015
Return-Path: <dev-return-84051-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id BDBD618260
	for <apmail-httpd-dev-archive@www.apache.org>; Mon,  5 Oct 2015 16:10:56 +0000 (UTC)
Received: (qmail 4025 invoked by uid 500); 5 Oct 2015 16:10:50 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 3953 invoked by uid 500); 5 Oct 2015 16:10:50 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 3943 invoked by uid 99); 5 Oct 2015 16:10:50 -0000
Received: from Unknown (HELO spamd2-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 05 Oct 2015 16:10:50 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd2-us-west.apache.org (ASF Mail Server at spamd2-us-west.apache.org) with ESMTP id A83861A0AA3
	for <dev@httpd.apache.org>; Mon,  5 Oct 2015 16:10:49 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd2-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 0.653
X-Spam-Level:
X-Spam-Status: No, score=0.653 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, SPF_NEUTRAL=0.652,
	URIBL_BLOCKED=0.001] autolearn=disabled
Authentication-Results: spamd2-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=comcast.net
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd2-us-west.apache.org [10.40.0.9]) (amavisd-new, port 10024)
	with ESMTP id hp2gw1fFSvSc for <dev@httpd.apache.org>;
	Mon,  5 Oct 2015 16:10:40 +0000 (UTC)
Received: from resqmta-ch2-03v.sys.comcast.net (resqmta-ch2-03v.sys.comcast.net [69.252.207.35])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id A16972039F
	for <dev@httpd.apache.org>; Mon,  5 Oct 2015 16:10:39 +0000 (UTC)
Received: from resomta-ch2-07v.sys.comcast.net ([69.252.207.103])
	by resqmta-ch2-03v.sys.comcast.net with comcast
	id RU7D1r0072EPM3101UAXVs; Mon, 05 Oct 2015 16:10:31 +0000
Received: from [192.168.199.10] ([69.251.84.114])
	by resomta-ch2-07v.sys.comcast.net with comcast
	id RUAX1r0072U0RYt01UAXD8; Mon, 05 Oct 2015 16:10:31 +0000
Content-Type: text/plain; charset=windows-1252
Mime-Version: 1.0 (Mac OS X Mail 8.2 \(2104\))
Subject: Re: Serf and mod_lua and libmill (Was: Re: [Patch] Async write completion for the full connection filter stack)
From: Jim Jagielski <jim@jaguNET.com>
In-Reply-To: <561C681E-0B07-4C03-B009-BEAE6E8F89AA@jaguNET.com>
Date: Mon, 5 Oct 2015 12:10:30 -0400
Content-Transfer-Encoding: quoted-printable
Message-Id: <D4AF1DB6-B235-4C85-A703-C69E848D824B@jaguNET.com>
References: <A57B894B-50DA-4252-8FFF-C3DEF8473A61@sharp.fm> <D4B68B53-592F-4EEC-B39F-EFC9887F60D5@jaguNET.com> <715A3AE8-8015-4537-943F-A34E0E2A76F7@sharp.fm> <D7EA895A-9C37-4387-AE89-C1B7DF9B0706@jaguNET.com> <540DFB30.6050700@apache.org> <2F3B060C-E383-407F-A24C-7F026AD3CA81@sharp.fm> <AB1691BE05AE7F4992697F2A0835627AC5D859AB@VOEXM10W.internal.vodafone.com> <AA9FAD6C-8E83-4F5F-8F18-BC3BECF8B0A1@sharp.fm> <CAKQ1sVPFJk9-Y=JwDLvJcYT7ZCQ=xbuBRS9fu8Me_T-3f2fVXg@mail.gmail.com> <C6246136-6B10-4F7B-8261-6723ABD26817@sharp.fm> <CAKQ1sVMw0-=LsqPEkWYs1QP8daMYv=eaxhRT8gsnrppooVzuMg@mail.gmail.com> <7A74676C-AA9D-40E1-A434-9280C297217D@sharp.fm> <54128B11.9080803@apache.org> <496E8EFA-7A10-4D91-8C7E-434A9A3B09C5@sharp.fm> <541499A9.5050408@apache.org> <4D9E72F8-4918-49AD-8DC4-E3594C9ED43D@sharp.fm> <04776F50-0A53-4C1D-AA1C-9F57B60BC0AC@sharp.fm> <38C56976-E693-4EEE-88BA-85DE3328FED3@sharp.fm> <7051D658-B96C-47BA-B21F-6511665DDAD8@jaguNET.com> <28641C04-8936-4004-BA40-C889C8B7846A@sharp .fm> <B
  A 1BA267-72A4-4044-86DB-25552E07E67D@c8h10n4o2.org.uk> <4203E8A4-546F-4DFA-977F-59C457F4580D@jaguNET.com> <BDAEAB21-3353-4E29-8D16-461437C17E35@sharp.fm> <561C681E-0B07-4C03-B009-BEAE6E8F89AA@jaguNET.com>
To: dev@httpd.apache.org
X-Mailer: Apple Mail (2.2104)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=comcast.net;
	s=q20140121; t=1444061431;
	bh=dDyK0yyBexGmDy5qDZ/7EPi5kZK7Lg05ZP8PgBci3MI=;
	h=Received:Received:Content-Type:Mime-Version:Subject:From:Date:
	 Message-Id:To;
	b=BiH59DOeVJVIvHOFExMyIOf2V6pCJqdOy1+5qgC+fj5yJDpQDldmOKeLwLsiAJwVo
	 C6q7L98X0rG5OcBs9X1wIlDt2vnlvwRSV8PcXwFNk2O06N//pIyyKInBoIWcC/hP/P
	 sFfOO3kBTp2/UF1JBATj3NbD0Z7cJo8OVR+fqqeY5U0YkhE2VLgOZ+VWYXkvbxUIXe
	 YFvZEc3oorKCMFD96ZzRBrIUYwsW0eoJ5XOoZuJvhi8uIq95IR8J1RyoQOqMKGdwuP
	 54gf3hwrVcVztp8ZMyYshcDdSCBBbu4ZHhtCYB1oqyl1tgO2QxYKbaVv+1c/TTUbeB
	 bfI2GCMPyZEbg==

Is there any reason to not fold this into trunk and start playing
around?

> On Oct 5, 2015, at 11:52 AM, Jim Jagielski <jim@jaguNET.com> wrote:
>=20
> Achieved!!
>=20
> Once again: this is some super cool mojo!!!
>=20
>> On Oct 5, 2015, at 10:57 AM, Graham Leggett <minfrin@sharp.fm> wrote:
>>=20
>> On 05 Oct 2015, at 3:41 PM, Jim Jagielski <jim@jaguNET.com> wrote:
>>=20
>>> Of course, this could also result in the issue we currently
>>> have w/ APR in which APR itself lags behind what httpd itself
>>> needs and we end up add stuff to httpd anyway...
>>>=20
>>> Hmmmm...
>>=20
>> This was my approach:
>>=20
>> I wanted the moon on a stick.
>>=20
>> What exactly constituted a moon on a stick? I wanted all of the =
following:
>>=20
>> - I wanted to make httpd asynchronous, and decisively allow httpd to =
join the list of servers that can support hundreds of thousands of =
concurrent requests across the board, not just as a special case for =
specific content (files).
>>=20
>> - I didn=92t want to wait. This means I wanted whatever change I made =
to be backport-able to httpd v2.4. I don=92t care to wait 5 years for =
httpd v2.6 to finally to appear as the default version in stable OS =
distros.
>>=20
>> - I wanted to work with what was already there. That meant making the =
existing ap_filter API and the existing buckets work with backwards =
compatible changes to httpd and no changes to apr/apr-util.
>>=20
>> - I wanted a mechanism that was not brittle. This is probably the =
hardest part of async programming, how do you prevent something spinning =
or hanging? When the new mechanism is used wrong the thread just becomes =
synchronous until the data is written and eventually works anyway, which =
is existing behaviour and not the end of the world.
>>=20
>> I am aware that some people have said that it couldn=92t be done in =
httpd=92s design. I figured let me test that hypothesis by trying =
anyway, the worst that could happen was that they were right but the =
server could at least be improved as best it could. I believe however =
that there is a good chance the moon on a stick has been achieved.
>>=20
>> Regards,
>> Graham
>> =97
>>=20
>=20


From dev-return-84052-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Mon Oct  5 16:24:46 2015
Return-Path: <dev-return-84052-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id E23A1182E3
	for <apmail-httpd-dev-archive@www.apache.org>; Mon,  5 Oct 2015 16:24:45 +0000 (UTC)
Received: (qmail 52529 invoked by uid 500); 5 Oct 2015 16:24:45 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 52459 invoked by uid 500); 5 Oct 2015 16:24:45 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 52447 invoked by uid 99); 5 Oct 2015 16:24:45 -0000
Received: from Unknown (HELO spamd3-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 05 Oct 2015 16:24:45 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd3-us-west.apache.org (ASF Mail Server at spamd3-us-west.apache.org) with ESMTP id F0B9E1809A5
	for <dev@httpd.apache.org>; Mon,  5 Oct 2015 16:24:44 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd3-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.006
X-Spam-Level:
X-Spam-Status: No, score=-0.006 tagged_above=-999 required=6.31
	tests=[RP_MATCHES_RCVD=-0.006, SPF_PASS=-0.001, URIBL_BLOCKED=0.001]
	autolearn=disabled
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd3-us-west.apache.org [10.40.0.10]) (amavisd-new, port 10024)
	with ESMTP id 900_aCVyrNlD for <dev@httpd.apache.org>;
	Mon,  5 Oct 2015 16:24:37 +0000 (UTC)
Received: from monica.sharp.fm (monica.sharp.fm [80.168.143.5])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTP id 7C68D201F9
	for <dev@httpd.apache.org>; Mon,  5 Oct 2015 16:24:36 +0000 (UTC)
Received: from [10.105.13.207] (unknown [5.56.169.82])
	(using TLSv1 with cipher DHE-RSA-AES256-SHA (256/256 bits))
	(Client did not present a certificate)
	(Authenticated sender: minfrin@sharp.fm)
	by monica.sharp.fm (Postfix) with ESMTPSA id D0B0983125
	for <dev@httpd.apache.org>; Mon,  5 Oct 2015 17:24:35 +0100 (BST)
Content-Type: text/plain; charset=windows-1252
Mime-Version: 1.0 (Mac OS X Mail 8.2 \(2104\))
Subject: Re: Serf and mod_lua and libmill (Was: Re: [Patch] Async write completion for the full connection filter stack)
From: Graham Leggett <minfrin@sharp.fm>
In-Reply-To: <D4AF1DB6-B235-4C85-A703-C69E848D824B@jaguNET.com>
Date: Mon, 5 Oct 2015 18:24:34 +0200
Content-Transfer-Encoding: quoted-printable
Message-Id: <CFD40ACF-7CC5-4DF3-82F5-29B5EDF8BEEE@sharp.fm>
References: <A57B894B-50DA-4252-8FFF-C3DEF8473A61@sharp.fm> <D4B68B53-592F-4EEC-B39F-EFC9887F60D5@jaguNET.com> <715A3AE8-8015-4537-943F-A34E0E2A76F7@sharp.fm> <D7EA895A-9C37-4387-AE89-C1B7DF9B0706@jaguNET.com> <540DFB30.6050700@apache.org> <2F3B060C-E383-407F-A24C-7F026AD3CA81@sharp.fm> <AB1691BE05AE7F4992697F2A0835627AC5D859AB@VOEXM10W.internal.vodafone.com> <AA9FAD6C-8E83-4F5F-8F18-BC3BECF8B0A1@sharp.fm> <CAKQ1sVPFJk9-Y=JwDLvJcYT7ZCQ=xbuBRS9fu8Me_T-3f2fVXg@mail.gmail.com> <C6246136-6B10-4F7B-8261-6723ABD26817@sharp.fm> <CAKQ1sVMw0-=LsqPEkWYs1QP8daMYv=eaxhRT8gsnrppooVzuMg@mail.gmail.com> <7A74676C-AA9D-40E1-A434-9280C297217D@sharp.fm> <54128B11.9080803@apache.org> <496E8EFA-7A10-4D91-8C7E-434A9A3B09C5@sharp.fm> <541499A9.5050408@apache.org> <4D9E72F8-4918-49AD-8DC4-E3594C9ED43D@sharp.fm> <04776F50-0A53-4C1D-AA1C-9F57B60BC0AC@sharp.fm> <38C56976-E693-4EEE-88BA-85DE3328FED3@sharp.fm> <7051D658-B96C-47BA-B21F-6511665DDAD8@jaguNET.com> <28641C04-8936-4004-BA40-C889C8B7846A@sharp
  .fm> <B A 1BA267-72A4-4044-86DB-25552E07E67D@c8h10n4o2.org.uk> <4203E8A4-546F-4DFA-977F-59C457F4580D@jaguNET.com> <BDAEAB21-3353-4E29-8D16-461437C17E35@sharp.fm> <561C681E-0B07-4C03-B009-BEAE6E8F89AA@jaguNET.com> <D4AF1DB6-B235-4C85-A703-C69E848D824B@jaguNET.com>
To: dev@httpd.apache.org
X-Mailer: Apple Mail (2.2104)

On 05 Oct 2015, at 6:10 PM, Jim Jagielski <jim@jaguNET.com> wrote:

> Is there any reason to not fold this into trunk and start playing
> around?

I committed it yesterday:

http://svn.apache.org/r1706669
http://svn.apache.org/r1706670

Regards,
Graham
=97


From dev-return-84053-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Mon Oct  5 16:35:47 2015
Return-Path: <dev-return-84053-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 242F91838E
	for <apmail-httpd-dev-archive@www.apache.org>; Mon,  5 Oct 2015 16:35:47 +0000 (UTC)
Received: (qmail 92443 invoked by uid 500); 5 Oct 2015 16:35:46 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 92368 invoked by uid 500); 5 Oct 2015 16:35:46 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 92359 invoked by uid 99); 5 Oct 2015 16:35:46 -0000
Received: from Unknown (HELO spamd4-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 05 Oct 2015 16:35:46 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd4-us-west.apache.org (ASF Mail Server at spamd4-us-west.apache.org) with ESMTP id 42745C0BE6
	for <dev@httpd.apache.org>; Mon,  5 Oct 2015 16:35:46 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd4-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 4.507
X-Spam-Level: ****
X-Spam-Status: No, score=4.507 tagged_above=-999 required=6.31
	tests=[FROM_MISSPACED=0.001, FROM_MISSP_EH_MATCH=0.001,
	KAM_LAZY_DOMAIN_SECURITY=1, KAM_LINKBAIT=2.5, MSGID_MULTIPLE_AT=1,
	RP_MATCHES_RCVD=-0.006, T_FROM_MISSP_DKIM=0.01, URIBL_BLOCKED=0.001]
	autolearn=disabled
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd4-us-west.apache.org [10.40.0.11]) (amavisd-new, port 10024)
	with ESMTP id LAY9zSjWf78h for <dev@httpd.apache.org>;
	Mon,  5 Oct 2015 16:35:41 +0000 (UTC)
Received: from mailrelay1-us-west.apache.org (mailrelay1-us-west.apache.org [209.188.14.139])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTP id D3E42204C8
	for <dev@httpd.apache.org>; Mon,  5 Oct 2015 16:35:40 +0000 (UTC)
Received: from pony-poc.apache.org (pony-poc.apache.org [195.154.156.166])
	by mailrelay1-us-west.apache.org (ASF Mail Server at mailrelay1-us-west.apache.org) with ESMTP id F04FCE045B
	for <dev@httpd.apache.org>; Mon,  5 Oct 2015 16:35:39 +0000 (UTC)
Received: from localhost (localhost [127.0.0.1])
	by pony-poc.apache.org (ASF Mail Server at pony-poc.apache.org) with ESMTP id 6E21426048A
	for <dev@httpd.apache.org>; Mon,  5 Oct 2015 18:35:46 +0200 (CEST)
In-Reply-To: <9ACC24A9-B381-4C18-B1C4-8D9F62DD7DB5@jaguNET.com>
X-Mailer: LuaSocket 3.0-rc1
From: "Daniel Gruno"<humbedooh@apache.org>
Message-ID: <pony-f85cc4d67b0b00a9017135e4201b9225b5053fac-77df7fd67f3d84a95adef90a63718ce375646916@dev@httpd.apache.org>
Subject: Re: T&R of 2.4.17 this week
Content-Type: text/plain; charset="iso-8859-1"
References: <9ACC24A9-B381-4C18-B1C4-8D9F62DD7DB5@jaguNET.com> 
MIME-Version: 1.0
x-ponymail-sender: f85cc4d67b0b00a9017135e4201b9225b5053fac
Date: Mon, 05 Oct 2015 16:35:46 -0000
To: <dev@httpd.apache.org>
x-ponymail-agent: PonyMail/0.1a

+1!
There's so much new goodness we have to share! :)

On 10/5/2015, 5:54:04 PM, Jim Jagielski <jim@jaguNET.com> wrote: 
> I propose a T&R of 2.4.17 this week with a release for next. I
> will RM.
> 
> Comments?
> 

From dev-return-84054-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Mon Oct  5 16:43:56 2015
Return-Path: <dev-return-84054-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id E2F1C1844B
	for <apmail-httpd-dev-archive@www.apache.org>; Mon,  5 Oct 2015 16:43:56 +0000 (UTC)
Received: (qmail 29667 invoked by uid 500); 5 Oct 2015 16:43:53 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 29593 invoked by uid 500); 5 Oct 2015 16:43:53 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 29583 invoked by uid 99); 5 Oct 2015 16:43:53 -0000
Received: from Unknown (HELO spamd4-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 05 Oct 2015 16:43:53 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd4-us-west.apache.org (ASF Mail Server at spamd4-us-west.apache.org) with ESMTP id DCA01C0BE6
	for <dev@httpd.apache.org>; Mon,  5 Oct 2015 16:43:52 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd4-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 0.653
X-Spam-Level:
X-Spam-Status: No, score=0.653 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, SPF_NEUTRAL=0.652,
	URIBL_BLOCKED=0.001] autolearn=disabled
Authentication-Results: spamd4-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=comcast.net
Received: from mx1-us-west.apache.org ([10.40.0.8])
	by localhost (spamd4-us-west.apache.org [10.40.0.11]) (amavisd-new, port 10024)
	with ESMTP id uCJzmyktjizC for <dev@httpd.apache.org>;
	Mon,  5 Oct 2015 16:43:39 +0000 (UTC)
Received: from resqmta-ch2-01v.sys.comcast.net (resqmta-ch2-01v.sys.comcast.net [69.252.207.33])
	by mx1-us-west.apache.org (ASF Mail Server at mx1-us-west.apache.org) with ESMTPS id 7FAB420592
	for <dev@httpd.apache.org>; Mon,  5 Oct 2015 16:43:39 +0000 (UTC)
Received: from resomta-ch2-15v.sys.comcast.net ([69.252.207.111])
	by resqmta-ch2-01v.sys.comcast.net with comcast
	id RUi61r0022Qkjl901UjXEv; Mon, 05 Oct 2015 16:43:31 +0000
Received: from [192.168.199.10] ([69.251.84.114])
	by resomta-ch2-15v.sys.comcast.net with comcast
	id RUjX1r00N2U0RYt01UjXcw; Mon, 05 Oct 2015 16:43:31 +0000
Content-Type: text/plain; charset=windows-1252
Mime-Version: 1.0 (Mac OS X Mail 8.2 \(2104\))
Subject: Re: Serf and mod_lua and libmill (Was: Re: [Patch] Async write completion for the full connection filter stack)
From: Jim Jagielski <jim@jaguNET.com>
In-Reply-To: <CFD40ACF-7CC5-4DF3-82F5-29B5EDF8BEEE@sharp.fm>
Date: Mon, 5 Oct 2015 12:43:31 -0400
Content-Transfer-Encoding: quoted-printable
Message-Id: <2C247469-E39D-42B7-AFCE-65ECF2FCE008@jaguNET.com>
References: <A57B894B-50DA-4252-8FFF-C3DEF8473A61@sharp.fm> <D4B68B53-592F-4EEC-B39F-EFC9887F60D5@jaguNET.com> <715A3AE8-8015-4537-943F-A34E0E2A76F7@sharp.fm> <D7EA895A-9C37-4387-AE89-C1B7DF9B0706@jaguNET.com> <540DFB30.6050700@apache.org> <2F3B060C-E383-407F-A24C-7F026AD3CA81@sharp.fm> <AB1691BE05AE7F4992697F2A0835627AC5D859AB@VOEXM10W.internal.vodafone.com> <AA9FAD6C-8E83-4F5F-8F18-BC3BECF8B0A1@sharp.fm> <CAKQ1sVPFJk9-Y=JwDLvJcYT7ZCQ=xbuBRS9fu8Me_T-3f2fVXg@mail.gmail.com> <C6246136-6B10-4F7B-8261-6723ABD26817@sharp.fm> <CAKQ1sVMw0-=LsqPEkWYs1QP8daMYv=eaxhRT8gsnrppooVzuMg@mail.gmail.com> <7A74676C-AA9D-40E1-A434-9280C297217D@sharp.fm> <54128B11.9080803@apache.org> <496E8EFA-7A10-4D91-8C7E-434A9A3B09C5@sharp.fm> <541499A9.5050408@apache.org> <4D9E72F8-4918-49AD-8DC4-E3594C9ED43D@sharp.fm> <04776F50-0A53-4C1D-AA1C-9F57B60BC0AC@sharp.fm> <38C56976-E693-4EEE-88BA-85DE3328FED3@sharp.fm> <7051D658-B96C-47BA-B21F-6511665DDAD8@jaguNET.com> <28641C04-8936-4004-BA40-C889C8B7846A@sharp .fm> <B
  A 1BA267-72A4-4044-86DB-25552E07E67D@c8h10n4o2.org.uk> <4203E8A4-546F-4DFA-977F-59C457F4580D@jaguNET.com> <BDAEAB21-3353-4E29-8D16-461437C17E35@sharp.fm> <561C681E-0B07-4C03-B009-BEAE6E8F89AA@jaguNET.com> <D4AF1DB6-B235-4C85-A703-C69E848D824B@jaguNET.com> <CFD40ACF-7CC5-4DF3-82F5-29B5EDF8BEEE@sharp.fm>
To: dev@httpd.apache.org
X-Mailer: Apple Mail (2.2104)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=comcast.net;
	s=q20140121; t=1444063411;
	bh=yepvzjWZmKO9xKCCnFYhZb8onh+5WXzt9BvOHVFmXDI=;
	h=Received:Received:Content-Type:Mime-Version:Subject:From:Date:
	 Message-Id:To;
	b=v0q1WAO/sGzCoyMe9LITni6woPvP5+Sq6X0Zh8jCHBGjo4SuzsuY//HNomiN6zVHx
	 xlZEO4/vmfO66vAUVIUNeMfjRwWb87CtB9pMxkyjrTE45hGynKdp+VFYTht3HxQRsf
	 8SW5shZliynqmxIUFmj1FVv0mGQZdC16ea7gncAmqBCk1uNR+fk998y22/L0FZPPm9
	 mXMT6EtFLuBRvaY9hhauzfmJLlgiuMZndLptU4z+vqhy4Ns2E9wvzBS0/EJ78O+foF
	 i67XLmFk48epZTuAHT+wDB5BSCkU/bi99dInyutvrGuov0Ce9nvvE8U5w1JOQjrJBN
	 7D9u4n42NRmog==

Thx (somewhat behind) :)

> On Oct 5, 2015, at 12:24 PM, Graham Leggett <minfrin@sharp.fm> wrote:
>=20
> On 05 Oct 2015, at 6:10 PM, Jim Jagielski <jim@jaguNET.com> wrote:
>=20
>> Is there any reason to not fold this into trunk and start playing
>> around?
>=20
> I committed it yesterday:
>=20
> http://svn.apache.org/r1706669
> http://svn.apache.org/r1706670
>=20
> Regards,
> Graham
> =97
>=20


From dev-return-84055-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Mon Oct  5 18:30:14 2015
Return-Path: <dev-return-84055-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 921A3188EA
	for <apmail-httpd-dev-archive@www.apache.org>; Mon,  5 Oct 2015 18:30:14 +0000 (UTC)
Received: (qmail 45941 invoked by uid 500); 5 Oct 2015 18:30:13 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 45869 invoked by uid 500); 5 Oct 2015 18:30:13 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 45859 invoked by uid 99); 5 Oct 2015 18:30:13 -0000
Received: from Unknown (HELO spamd2-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 05 Oct 2015 18:30:13 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd2-us-west.apache.org (ASF Mail Server at spamd2-us-west.apache.org) with ESMTP id 335EA1A0ABE
	for <dev@httpd.apache.org>; Mon,  5 Oct 2015 18:30:13 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd2-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.002
X-Spam-Level:
X-Spam-Status: No, score=-0.002 tagged_above=-999 required=6.31
	tests=[RCVD_IN_MSPIKE_H2=-0.001, SPF_PASS=-0.001] autolearn=disabled
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd2-us-west.apache.org [10.40.0.9]) (amavisd-new, port 10024)
	with ESMTP id Y_MTEnFOpy8Z for <dev@httpd.apache.org>;
	Mon,  5 Oct 2015 18:30:12 +0000 (UTC)
Received: from mout.gmx.net (mout.gmx.net [212.227.17.20])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id F0760201F9
	for <dev@httpd.apache.org>; Mon,  5 Oct 2015 18:30:11 +0000 (UTC)
Received: from [192.168.0.100] ([87.139.233.65]) by mail.gmx.com (mrgmx102)
 with ESMTPSA (Nemesis) id 0M0smx-1acnW81nCh-00v9b0 for
 <dev@httpd.apache.org>; Mon, 05 Oct 2015 20:30:11 +0200
Subject: Re: T&R of 2.4.17 this week
To: dev@httpd.apache.org
References: <9ACC24A9-B381-4C18-B1C4-8D9F62DD7DB5@jaguNET.com>
From: olli hauer <ohauer@gmx.de>
X-Enigmail-Draft-Status: N1110
Message-ID: <5612C1B4.7040601@gmx.de>
Date: Mon, 5 Oct 2015 20:30:12 +0200
User-Agent: Mozilla/5.0 (Windows NT 5.1; rv:38.0) Gecko/20100101
 Thunderbird/38.3.0
MIME-Version: 1.0
In-Reply-To: <9ACC24A9-B381-4C18-B1C4-8D9F62DD7DB5@jaguNET.com>
Content-Type: text/plain; charset=windows-1252
Content-Transfer-Encoding: 8bit
X-Provags-ID: V03:K0:Xe01Q5L/1OcO2+pW5lA29kXUHtcJkFMZNekF7+LeEkzb6EGLWuh
 DKq7Psq5r5Tz+kIh//Ca8B2dGxQEsV3cyuia4i1l11AqKH9qtS1lCBxF/njHkKiFO4xNAm0
 onXX8czvwL6xLeAkeXGx6f8cy7RgL28sa0k1PypqjO4zt5XiU5d7rRcasorvU64ozA7c7yI
 jx6ck6saGR7t8LGuAqhLw==
X-UI-Out-Filterresults: notjunk:1;V01:K0:0iEvZlzFiew=:hmcbOw/10VTG7EVniYP/EL
 zbOAWW68sEU3y6gpd/EpVAq3JjN6Q4ddKnFLs7OWuOkcuoATZRI1ObYNS/+8js1PbysUhMFIf
 OkAXCfzxlzLA/DiIct3h9lQoTxc3ioepTo/lV0oLuEoDplXoTnyigpvvbC/ScnbeJbF/ATAAo
 Mn1EDBDUBroTiyjZMpPZUY9Wl/8OfK7B6lhP2Z5YiK/rwEtADjW7epGwEg0Z+Z+r+l7PYsEce
 ndKnqjx0gjCZYNLIPBaR4i9hWoc8PmVIxPEAoxmKDDiLTUA45aLcy+VNi1NPm2f1RQMM2WPZk
 23e6palXjXGW+XJcbo6WWA/RqWASht+xe5W8GrAQyoaNF5ChY1wWKYQDCIz4FLTqD9K64geSr
 zYTrTpjvDi/GUgSTCFQX/clZIllmyn05FVtl2l4FNMXaw9IIDs6oMsbb6jY/7FMSp+WSLSWoX
 5xf+VRw90yVjeJ8jpwL0AsG9nu0ACvr39TK7z9bJ05I5JO2f2+HCGEQ+fJt2+ztNCHct2oZi+
 pwHrq52RSLiZZHnEfTz7mzgL88WIykIpDrKJ12uc3e9PvWtHcmz+vi/gCCp/ab43P+N3SGr/h
 15lQ2YOBmQ0GnVUFEeldHgmZJxAOMibNgEj4bcNUcJKWhCQcsFFGxYd67nVIfJizIAVturvCL
 35+9pyh8XokRHg8PXFQ4xbJhqVck6aMVMBXXt0UeMEAwASnWB9lhi9bIOUqkLRjRBMxg82bGe
 nMOTs5ct3G1U2EI5p0pyBiFcdYz8hrkpzgMSnKMchVywV+/lVmqtQvNn5o4Dgq+cf/8hMEHse
 mWSdzql

On 2015-10-05 17:54, Jim Jagielski wrote:
> I propose a T&R of 2.4.17 this week with a release for next. I
> will RM.
> 
> Comments?
> 

Hi Jim,

would you mind to look at #58126 ?

It contains a simple patch for acinclude.m4 to suppress warnings about underquoted calls to AC_DEFUN.

-- 
Thanks,
olli

From dev-return-84056-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Mon Oct  5 18:32:28 2015
Return-Path: <dev-return-84056-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 3976A18911
	for <apmail-httpd-dev-archive@www.apache.org>; Mon,  5 Oct 2015 18:32:28 +0000 (UTC)
Received: (qmail 49334 invoked by uid 500); 5 Oct 2015 18:32:07 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 49268 invoked by uid 500); 5 Oct 2015 18:32:06 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 49258 invoked by uid 99); 5 Oct 2015 18:32:06 -0000
Received: from Unknown (HELO spamd2-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 05 Oct 2015 18:32:06 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd2-us-west.apache.org (ASF Mail Server at spamd2-us-west.apache.org) with ESMTP id 890AB1A0ABE
	for <dev@httpd.apache.org>; Mon,  5 Oct 2015 18:32:06 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd2-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.02
X-Spam-Level:
X-Spam-Status: No, score=-0.02 tagged_above=-999 required=6.31
	tests=[RCVD_IN_MSPIKE_H3=-0.01, RCVD_IN_MSPIKE_WL=-0.01,
	RP_MATCHES_RCVD=0.001, SPF_PASS=-0.001] autolearn=disabled
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd2-us-west.apache.org [10.40.0.9]) (amavisd-new, port 10024)
	with ESMTP id n3bOseYAdte2 for <dev@httpd.apache.org>;
	Mon,  5 Oct 2015 18:32:05 +0000 (UTC)
Received: from mga01.intel.com (mga01.intel.com [192.55.52.88])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTP id 8698542B59
	for <dev@httpd.apache.org>; Mon,  5 Oct 2015 18:32:05 +0000 (UTC)
Received: from orsmga001.jf.intel.com ([10.7.209.18])
  by fmsmga101.fm.intel.com with ESMTP; 05 Oct 2015 11:31:59 -0700
X-ExtLoop1: 1
X-IronPort-AV: E=Sophos;i="5.17,639,1437462000"; 
   d="scan'208";a="785033648"
Received: from orsmsx110.amr.corp.intel.com ([10.22.240.8])
  by orsmga001.jf.intel.com with ESMTP; 05 Oct 2015 11:31:59 -0700
Received: from orsmsx116.amr.corp.intel.com ([169.254.9.234]) by
 ORSMSX110.amr.corp.intel.com ([169.254.3.250]) with mapi id 14.03.0248.002;
 Mon, 5 Oct 2015 11:31:58 -0700
From: "Lu, Yingqi" <yingqi.lu@intel.com>
To: "dev@httpd.apache.org" <dev@httpd.apache.org>
Subject: RE: T&R of 2.4.17 this week
Thread-Topic: T&R of 2.4.17 this week
Thread-Index: AQHQ/4Yd8ImDJMmBG0SILdDiurgVVZ5drgoA//+K3CA=
Date: Mon, 5 Oct 2015 18:31:57 +0000
Message-ID: <9ACD5B67AAC5594CB6268234CF29CF9AA39EBF47@ORSMSX116.amr.corp.intel.com>
References: <9ACC24A9-B381-4C18-B1C4-8D9F62DD7DB5@jaguNET.com>
 <5612C1B4.7040601@gmx.de>
In-Reply-To: <5612C1B4.7040601@gmx.de>
Accept-Language: en-US
Content-Language: en-US
X-MS-Has-Attach:
X-MS-TNEF-Correlator:
x-originating-ip: [10.22.254.139]
Content-Type: text/plain; charset="us-ascii"
Content-Transfer-Encoding: quoted-printable
MIME-Version: 1.0

Hi Jim,

Can you please look and incorporate the SO_REUSEPORT patch for this release=
 as well?

Thanks,
Yingqi

-----Original Message-----
From: olli hauer [mailto:ohauer@gmx.de]=20
Sent: Monday, October 05, 2015 11:30 AM
To: dev@httpd.apache.org
Subject: Re: T&R of 2.4.17 this week

On 2015-10-05 17:54, Jim Jagielski wrote:
> I propose a T&R of 2.4.17 this week with a release for next. I will=20
> RM.
>=20
> Comments?
>=20

Hi Jim,

would you mind to look at #58126 ?

It contains a simple patch for acinclude.m4 to suppress warnings about unde=
rquoted calls to AC_DEFUN.

--
Thanks,
olli

From dev-return-84057-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Mon Oct  5 18:38:05 2015
Return-Path: <dev-return-84057-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 366F718937
	for <apmail-httpd-dev-archive@www.apache.org>; Mon,  5 Oct 2015 18:38:05 +0000 (UTC)
Received: (qmail 66276 invoked by uid 500); 5 Oct 2015 18:38:04 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 66207 invoked by uid 500); 5 Oct 2015 18:38:04 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 66197 invoked by uid 99); 5 Oct 2015 18:38:04 -0000
Received: from Unknown (HELO spamd1-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 05 Oct 2015 18:38:04 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd1-us-west.apache.org (ASF Mail Server at spamd1-us-west.apache.org) with ESMTP id EE6C0C2BAE
	for <dev@httpd.apache.org>; Mon,  5 Oct 2015 18:38:03 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd1-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.101
X-Spam-Level:
X-Spam-Status: No, score=-0.101 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RCVD_IN_MSPIKE_H2=-0.001, SPF_PASS=-0.001, URIBL_BLOCKED=0.001]
	autolearn=disabled
Authentication-Results: spamd1-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd1-us-west.apache.org [10.40.0.7]) (amavisd-new, port 10024)
	with ESMTP id P-yTQ5tGFpY6 for <dev@httpd.apache.org>;
	Mon,  5 Oct 2015 18:37:57 +0000 (UTC)
Received: from mail-qg0-f47.google.com (mail-qg0-f47.google.com [209.85.192.47])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id 796C542ABE
	for <dev@httpd.apache.org>; Mon,  5 Oct 2015 18:37:57 +0000 (UTC)
Received: by qgx61 with SMTP id 61so157860855qgx.3
        for <dev@httpd.apache.org>; Mon, 05 Oct 2015 11:37:51 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        bh=6wKmG+q9nPZlDPu76NbluX0ESaQgUv7z8PzTTiuHGLY=;
        b=dVPdG+VxtUg04C6XpWXTa3X8dpEAU7PUDDAKiibSewqrSidQBos6/Vx+tKKBv7/xW9
         XAr0SxWm2CCCkOnbFrCITf2rVO2RWVCneTu/0iD8DrkC1UOGmhGsVCi0BQRGsyIBt2eK
         HzS4F0zR0QLCh8C3kx8cfQqs5LFQ0WP9TDJ7I+iK46ElLmdDpSgcklg4UrCGmlSC687E
         k7v5KDVYRvlWFRSPE2l7rNOctm2OrY/A+aA19oyDHrI/I3o3+WWw+xeDl9EUn9DOhdlb
         kVSsoxAjMy6pUdgUDVIy/le67GjbyQYJ2myCzpjNxN4jlgF7z/2WkZuXdYmCT5KiEtTb
         rIag==
MIME-Version: 1.0
X-Received: by 10.140.236.203 with SMTP id h194mr41627830qhc.73.1444070270934;
 Mon, 05 Oct 2015 11:37:50 -0700 (PDT)
Received: by 10.55.72.20 with HTTP; Mon, 5 Oct 2015 11:37:50 -0700 (PDT)
In-Reply-To: <9ACD5B67AAC5594CB6268234CF29CF9AA39EBF47@ORSMSX116.amr.corp.intel.com>
References: <9ACC24A9-B381-4C18-B1C4-8D9F62DD7DB5@jaguNET.com>
	<5612C1B4.7040601@gmx.de>
	<9ACD5B67AAC5594CB6268234CF29CF9AA39EBF47@ORSMSX116.amr.corp.intel.com>
Date: Mon, 5 Oct 2015 20:37:50 +0200
Message-ID: <CAKQ1sVMwFbCXC3YeLdpngoki4JXn6+4c9vHLfetyaUNmwqttQQ@mail.gmail.com>
Subject: Re: T&R of 2.4.17 this week
From: Yann Ylavic <ylavic.dev@gmail.com>
To: dev@httpd.apache.org
Content-Type: text/plain; charset=UTF-8

Hi Yingqi,

this was done in r1705492, will be in 2.4.17.

Regards,
Yann.


On Mon, Oct 5, 2015 at 8:31 PM, Lu, Yingqi <yingqi.lu@intel.com> wrote:
> Hi Jim,
>
> Can you please look and incorporate the SO_REUSEPORT patch for this release as well?
>
> Thanks,
> Yingqi
>
> -----Original Message-----
> From: olli hauer [mailto:ohauer@gmx.de]
> Sent: Monday, October 05, 2015 11:30 AM
> To: dev@httpd.apache.org
> Subject: Re: T&R of 2.4.17 this week
>
> On 2015-10-05 17:54, Jim Jagielski wrote:
>> I propose a T&R of 2.4.17 this week with a release for next. I will
>> RM.
>>
>> Comments?
>>
>
> Hi Jim,
>
> would you mind to look at #58126 ?
>
> It contains a simple patch for acinclude.m4 to suppress warnings about underquoted calls to AC_DEFUN.
>
> --
> Thanks,
> olli

From dev-return-84058-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Mon Oct  5 18:39:13 2015
Return-Path: <dev-return-84058-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id E70131894B
	for <apmail-httpd-dev-archive@www.apache.org>; Mon,  5 Oct 2015 18:39:13 +0000 (UTC)
Received: (qmail 72347 invoked by uid 500); 5 Oct 2015 18:39:10 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 72270 invoked by uid 500); 5 Oct 2015 18:39:10 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 72260 invoked by uid 99); 5 Oct 2015 18:39:10 -0000
Received: from Unknown (HELO spamd2-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 05 Oct 2015 18:39:10 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd2-us-west.apache.org (ASF Mail Server at spamd2-us-west.apache.org) with ESMTP id BEB131A0ABE
	for <dev@httpd.apache.org>; Mon,  5 Oct 2015 18:39:09 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd2-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.019
X-Spam-Level:
X-Spam-Status: No, score=-0.019 tagged_above=-999 required=6.31
	tests=[RCVD_IN_MSPIKE_H3=-0.01, RCVD_IN_MSPIKE_WL=-0.01,
	RP_MATCHES_RCVD=0.001, SPF_PASS=-0.001, URIBL_BLOCKED=0.001]
	autolearn=disabled
Received: from mx1-us-west.apache.org ([10.40.0.8])
	by localhost (spamd2-us-west.apache.org [10.40.0.9]) (amavisd-new, port 10024)
	with ESMTP id Xv_HTPetKQN0 for <dev@httpd.apache.org>;
	Mon,  5 Oct 2015 18:39:04 +0000 (UTC)
Received: from mga09.intel.com (mga09.intel.com [134.134.136.24])
	by mx1-us-west.apache.org (ASF Mail Server at mx1-us-west.apache.org) with ESMTP id 9B060204CB
	for <dev@httpd.apache.org>; Mon,  5 Oct 2015 18:39:04 +0000 (UTC)
Received: from fmsmga003.fm.intel.com ([10.253.24.29])
  by orsmga102.jf.intel.com with ESMTP; 05 Oct 2015 11:38:53 -0700
X-ExtLoop1: 1
X-IronPort-AV: E=Sophos;i="5.17,640,1437462000"; 
   d="scan'208";a="574597292"
Received: from orsmsx103.amr.corp.intel.com ([10.22.225.130])
  by FMSMGA003.fm.intel.com with ESMTP; 05 Oct 2015 11:38:53 -0700
Received: from orsmsx116.amr.corp.intel.com ([169.254.9.234]) by
 ORSMSX103.amr.corp.intel.com ([169.254.2.156]) with mapi id 14.03.0248.002;
 Mon, 5 Oct 2015 11:38:53 -0700
From: "Lu, Yingqi" <yingqi.lu@intel.com>
To: "dev@httpd.apache.org" <dev@httpd.apache.org>
Subject: RE: T&R of 2.4.17 this week
Thread-Topic: T&R of 2.4.17 this week
Thread-Index: AQHQ/4Yd8ImDJMmBG0SILdDiurgVVZ5drgoA//+K3CCAAHdGAP//itrg
Date: Mon, 5 Oct 2015 18:38:52 +0000
Message-ID: <9ACD5B67AAC5594CB6268234CF29CF9AA39EC08E@ORSMSX116.amr.corp.intel.com>
References: <9ACC24A9-B381-4C18-B1C4-8D9F62DD7DB5@jaguNET.com>
	<5612C1B4.7040601@gmx.de>
	<9ACD5B67AAC5594CB6268234CF29CF9AA39EBF47@ORSMSX116.amr.corp.intel.com>
 <CAKQ1sVMwFbCXC3YeLdpngoki4JXn6+4c9vHLfetyaUNmwqttQQ@mail.gmail.com>
In-Reply-To: <CAKQ1sVMwFbCXC3YeLdpngoki4JXn6+4c9vHLfetyaUNmwqttQQ@mail.gmail.com>
Accept-Language: en-US
Content-Language: en-US
X-MS-Has-Attach:
X-MS-TNEF-Correlator:
x-originating-ip: [10.22.254.139]
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
MIME-Version: 1.0

VGhhbmsgeW91LCBZYW5uIQ0KDQpSZWdhcmRzLA0KWWluZ3FpDQoNCi0tLS0tT3JpZ2luYWwgTWVz
c2FnZS0tLS0tDQpGcm9tOiBZYW5uIFlsYXZpYyBbbWFpbHRvOnlsYXZpYy5kZXZAZ21haWwuY29t
XSANClNlbnQ6IE1vbmRheSwgT2N0b2JlciAwNSwgMjAxNSAxMTozOCBBTQ0KVG86IGRldkBodHRw
ZC5hcGFjaGUub3JnDQpTdWJqZWN0OiBSZTogVCZSIG9mIDIuNC4xNyB0aGlzIHdlZWsNCg0KSGkg
WWluZ3FpLA0KDQp0aGlzIHdhcyBkb25lIGluIHIxNzA1NDkyLCB3aWxsIGJlIGluIDIuNC4xNy4N
Cg0KUmVnYXJkcywNCllhbm4uDQoNCg0KT24gTW9uLCBPY3QgNSwgMjAxNSBhdCA4OjMxIFBNLCBM
dSwgWWluZ3FpIDx5aW5ncWkubHVAaW50ZWwuY29tPiB3cm90ZToNCj4gSGkgSmltLA0KPg0KPiBD
YW4geW91IHBsZWFzZSBsb29rIGFuZCBpbmNvcnBvcmF0ZSB0aGUgU09fUkVVU0VQT1JUIHBhdGNo
IGZvciB0aGlzIHJlbGVhc2UgYXMgd2VsbD8NCj4NCj4gVGhhbmtzLA0KPiBZaW5ncWkNCj4NCj4g
LS0tLS1PcmlnaW5hbCBNZXNzYWdlLS0tLS0NCj4gRnJvbTogb2xsaSBoYXVlciBbbWFpbHRvOm9o
YXVlckBnbXguZGVdDQo+IFNlbnQ6IE1vbmRheSwgT2N0b2JlciAwNSwgMjAxNSAxMTozMCBBTQ0K
PiBUbzogZGV2QGh0dHBkLmFwYWNoZS5vcmcNCj4gU3ViamVjdDogUmU6IFQmUiBvZiAyLjQuMTcg
dGhpcyB3ZWVrDQo+DQo+IE9uIDIwMTUtMTAtMDUgMTc6NTQsIEppbSBKYWdpZWxza2kgd3JvdGU6
DQo+PiBJIHByb3Bvc2UgYSBUJlIgb2YgMi40LjE3IHRoaXMgd2VlayB3aXRoIGEgcmVsZWFzZSBm
b3IgbmV4dC4gSSB3aWxsIA0KPj4gUk0uDQo+Pg0KPj4gQ29tbWVudHM/DQo+Pg0KPg0KPiBIaSBK
aW0sDQo+DQo+IHdvdWxkIHlvdSBtaW5kIHRvIGxvb2sgYXQgIzU4MTI2ID8NCj4NCj4gSXQgY29u
dGFpbnMgYSBzaW1wbGUgcGF0Y2ggZm9yIGFjaW5jbHVkZS5tNCB0byBzdXBwcmVzcyB3YXJuaW5n
cyBhYm91dCB1bmRlcnF1b3RlZCBjYWxscyB0byBBQ19ERUZVTi4NCj4NCj4gLS0NCj4gVGhhbmtz
LA0KPiBvbGxpDQo=

From dev-return-84059-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Mon Oct  5 21:08:02 2015
Return-Path: <dev-return-84059-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 0CC6918FC7
	for <apmail-httpd-dev-archive@www.apache.org>; Mon,  5 Oct 2015 21:08:02 +0000 (UTC)
Received: (qmail 53367 invoked by uid 500); 5 Oct 2015 21:08:01 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 53296 invoked by uid 500); 5 Oct 2015 21:08:01 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 53286 invoked by uid 99); 5 Oct 2015 21:08:01 -0000
Received: from Unknown (HELO spamd2-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 05 Oct 2015 21:08:01 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd2-us-west.apache.org (ASF Mail Server at spamd2-us-west.apache.org) with ESMTP id EC4FC1A06A1
	for <dev@httpd.apache.org>; Mon,  5 Oct 2015 21:08:00 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd2-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.101
X-Spam-Level:
X-Spam-Status: No, score=-0.101 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RCVD_IN_MSPIKE_H2=-0.001, SPF_PASS=-0.001, URIBL_BLOCKED=0.001]
	autolearn=disabled
Authentication-Results: spamd2-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd2-us-west.apache.org [10.40.0.9]) (amavisd-new, port 10024)
	with ESMTP id K9BwpEJ1pqJn for <dev@httpd.apache.org>;
	Mon,  5 Oct 2015 21:07:55 +0000 (UTC)
Received: from mail-qg0-f44.google.com (mail-qg0-f44.google.com [209.85.192.44])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id 450EE203A3
	for <dev@httpd.apache.org>; Mon,  5 Oct 2015 21:07:54 +0000 (UTC)
Received: by qgez77 with SMTP id z77so161957363qge.1
        for <dev@httpd.apache.org>; Mon, 05 Oct 2015 14:07:53 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        bh=ETVA/kuIdt4XDDHZvZnDe0fgXmOqjs7xa8az7l4n+io=;
        b=zRfNvZIWxIFN4fljXysnc0INfPc7+B914VlLl3f9qlxdtplcMKlUzNAuuLTCCX3HtT
         UVt56F7LvIyU8U+wOlKDRKaA01vIQd1WbIS3uIMHxvlxzm5oComKKVCZd65xZxBf9Sbp
         npc/zNYal5CbELaSfHoI32o6RQQBlxWdd3K4u99e9/sIk4H+0ZKjxJxWtvqWdh30Naag
         pYKMy94sXvIGrGcHosrXBfZJ1kqwTRJ9sk0jLnFc1y2CUbMKEaiyN/bPdggDFLbZZs2E
         CssuLg80+uPZF4aD6YIRb1SNzDBbMqC+a/sNjU/ryedse6yCUrQxFzyMELXRXjvxdxn1
         CBZw==
MIME-Version: 1.0
X-Received: by 10.140.237.212 with SMTP id i203mr44525563qhc.97.1444079273229;
 Mon, 05 Oct 2015 14:07:53 -0700 (PDT)
Received: by 10.55.72.20 with HTTP; Mon, 5 Oct 2015 14:07:53 -0700 (PDT)
In-Reply-To: <5612C1B4.7040601@gmx.de>
References: <9ACC24A9-B381-4C18-B1C4-8D9F62DD7DB5@jaguNET.com>
	<5612C1B4.7040601@gmx.de>
Date: Mon, 5 Oct 2015 23:07:53 +0200
Message-ID: <CAKQ1sVORKbSkXLrwkKutucXpBQr+woZjnqt=EaMgjQxR6TB65g@mail.gmail.com>
Subject: Re: T&R of 2.4.17 this week
From: Yann Ylavic <ylavic.dev@gmail.com>
To: dev@httpd.apache.org
Content-Type: text/plain; charset=UTF-8

On Mon, Oct 5, 2015 at 8:30 PM, olli hauer <ohauer@gmx.de> wrote:
>
> would you mind to look at #58126 ?
>
> It contains a simple patch for acinclude.m4 to suppress warnings about underquoted calls to AC_DEFUN.

Committed in r1706918, backport proposed in r1706923.

Regards,
Yann.

From dev-return-84060-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Mon Oct  5 22:18:09 2015
Return-Path: <dev-return-84060-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id E234318317
	for <apmail-httpd-dev-archive@www.apache.org>; Mon,  5 Oct 2015 22:18:09 +0000 (UTC)
Received: (qmail 95369 invoked by uid 500); 5 Oct 2015 22:18:09 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 95303 invoked by uid 500); 5 Oct 2015 22:18:09 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 95292 invoked by uid 99); 5 Oct 2015 22:18:09 -0000
Received: from Unknown (HELO spamd4-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 05 Oct 2015 22:18:09 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd4-us-west.apache.org (ASF Mail Server at spamd4-us-west.apache.org) with ESMTP id 09F68C028F
	for <dev@httpd.apache.org>; Mon,  5 Oct 2015 22:18:09 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd4-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 0.991
X-Spam-Level:
X-Spam-Status: No, score=0.991 tagged_above=-999 required=6.31
	tests=[KAM_LAZY_DOMAIN_SECURITY=1, T_RP_MATCHES_RCVD=-0.01,
	URIBL_BLOCKED=0.001] autolearn=disabled
Received: from mx1-us-west.apache.org ([10.40.0.8])
	by localhost (spamd4-us-west.apache.org [10.40.0.11]) (amavisd-new, port 10024)
	with ESMTP id HHKfJaFRMXl6 for <dev@httpd.apache.org>;
	Mon,  5 Oct 2015 22:18:02 +0000 (UTC)
Received: from eru.sfritsch.de (eru.sfritsch.de [188.40.99.202])
	by mx1-us-west.apache.org (ASF Mail Server at mx1-us-west.apache.org) with ESMTPS id 966A22031C
	for <dev@httpd.apache.org>; Mon,  5 Oct 2015 22:18:02 +0000 (UTC)
From: Stefan Fritsch <sf@sfritsch.de>
To: dev@httpd.apache.org
Cc: Graham Leggett <minfrin@sharp.fm>, Rainer Jung <rainer.jung@kippdata.de>
Subject: Re: Expression Parser: search and replace with s/PATTERN/REPLACEMENT/FLAGS
Date: Tue, 06 Oct 2015 00:17:47 +0200
Message-ID: <2301815.56cqMLLZDO@k>
User-Agent: KMail/4.14.10 (Linux/4.2.0-1-amd64; KDE/4.14.12; x86_64; ; )
In-Reply-To: <6AA47FB6-EA08-4A4D-9E93-640B4882EB96@sharp.fm>
References: <560D0A3F.9010609@kippdata.de> <56110376.7090807@kippdata.de> <6AA47FB6-EA08-4A4D-9E93-640B4882EB96@sharp.fm>
MIME-Version: 1.0
Content-Transfer-Encoding: quoted-printable
Content-Type: text/plain; charset="utf-8"

On Sunday 04 October 2015 12:51:13, Graham Leggett wrote:
> On 04 Oct 2015, at 12:46 PM, Rainer Jung <rainer.jung@kippdata.de>=20=

wrote:
> > Yes, I agree. When starting to think closer, I noticed that the
> > string mode currently only supports a syntax that is pretty
> > different from the boolean mode and is much more limited. In that
> > mode everything is a string except it is marked via %{XXX}, in
> > which case XXX is a variable name, except XXX is AAA:BBB in which
> > case it is AAA("BBB").
> >=20
> > So AFAIK we don't support functions with more than one argument in
> > string mode and my naive idea of using "STRING =3D~
> > s/PATTERN/REPLACEMENT/FLAGS" runs into the problem, that we
> > currently don't support operators like "=3D~" etc. in string mode.

This is correct.


> > So I wonder whether it would be useful to allow for a more general
> > mode which would depending on operators or functions handle the
> > argument and result as strings or booleans using auto conversion
> > between them where needed. Of course in that mode verbatim
> > strings would need proper quoting (unlike pure string mode in
> > which everything by default is a verbatim string). We could then
> > even support>=20
> >    BOOLEXPR ? STRINGEXPR1 : STRINGEXPR 2
> >=20
> > For compatibility that generalized mode would probably need a mode
> > differentiator syntax for compatibility reasons in 2.4 but could
> > be the default mode in trunk. Something like your "%!" prefix.

This is definitely a possible approach. I am not 100% sure that we=20
would want that mode to become the default, though, because it would=20=

always require double quoting for simple string expressions. Like

LogMessage "'Foo=3D%{HTTP_FOO}'"

Somehow I also think this approach would be quite a bit of work,=20
especially to deal with all corner cases and ambiguities introduced by=20=

auto conversion.


Another possible approach would be to implement functions with=20
multiple arguments in string mode first and worry about an easier=20
syntax second. If I remember correctly, I once planned to have
 %{FUNCTION:'arg1','arg2'} as syntax for this. But i did not get=20
around to implementing it.

Now that I think of it, maybe

    %{FUNCTION: X/arg1/arg2/arg3 }

would be another good syntax for it, where X is an (optional?) letter=20=

and the / separator could be chosen from a list of separators, just=20
like is already possible with the m/foo/i regex syntax. Or make it

    %{FUNCTION/arg1/arg2/arg3}

If we add optional whitespace at the beginning and end, and give our=20=

rexec function an alias of 's', we would get something like

    %{ s/TEXT/PATTERN/REPLACEMENT/FLAGS } or
    %{ s/PATTERN/REPLACEMENT/FLAGS/TEXT/ }

which is not perfect but maybe acceptable from a readability point of=20=

view.

> How about a regex function?
>=20
> The single argument could be =E2=80=9Cs/PATTERN/REPLACEMENT/FLAGS=E2=80=
=9D.

I think this would be easy to implement. It would require the regex to=20=

be parsed on every execution, though, which has the disadvantages that=20=

it is slower and that one would get error messages only during first=20=

execution and not during server startup. Also, it would possibly allow=20=

the admin to configure expressions where the regex pattern can contain=20=

untrusted data, which would turn a lot of libpcre problems from local=20=

into remote vulnerabilities.

If everything else fails or goes nowhere, we can do this. But I would=20=

like to try implementing a better solution, first.

From dev-return-84061-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Mon Oct  5 22:44:16 2015
Return-Path: <dev-return-84061-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 8E267183F3
	for <apmail-httpd-dev-archive@www.apache.org>; Mon,  5 Oct 2015 22:44:16 +0000 (UTC)
Received: (qmail 48928 invoked by uid 500); 5 Oct 2015 22:44:16 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 48858 invoked by uid 500); 5 Oct 2015 22:44:16 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 48848 invoked by uid 99); 5 Oct 2015 22:44:16 -0000
Received: from Unknown (HELO spamd4-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 05 Oct 2015 22:44:16 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd4-us-west.apache.org (ASF Mail Server at spamd4-us-west.apache.org) with ESMTP id A9BB4C028F
	for <dev@httpd.apache.org>; Mon,  5 Oct 2015 22:44:15 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd4-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -1.31
X-Spam-Level:
X-Spam-Status: No, score=-1.31 tagged_above=-999 required=6.31
	tests=[KAM_LAZY_DOMAIN_SECURITY=1, RCVD_IN_DNSWL_MED=-2.3,
	T_RP_MATCHES_RCVD=-0.01] autolearn=disabled
Received: from mx1-us-west.apache.org ([10.40.0.8])
	by localhost (spamd4-us-west.apache.org [10.40.0.11]) (amavisd-new, port 10024)
	with ESMTP id vZ_WAJrgxF1H for <dev@httpd.apache.org>;
	Mon,  5 Oct 2015 22:44:14 +0000 (UTC)
Received: from eru.sfritsch.de (eru.sfritsch.de [188.40.99.202])
	by mx1-us-west.apache.org (ASF Mail Server at mx1-us-west.apache.org) with ESMTPS id 310F920F4A
	for <dev@httpd.apache.org>; Mon,  5 Oct 2015 22:44:14 +0000 (UTC)
From: Stefan Fritsch <sf@sfritsch.de>
To: Rainer Jung <rainer.jung@kippdata.de>
Cc: dev@httpd.apache.org
Subject: Re: Supporting "SSL:" in the expression parser via mod_ssl
Date: Tue, 06 Oct 2015 00:44:06 +0200
Message-ID: <3128045.1Bge59dzo2@k>
User-Agent: KMail/4.14.10 (Linux/4.2.0-1-amd64; KDE/4.14.12; x86_64; ; )
In-Reply-To: <560C5386.1030700@kippdata.de>
References: <560C5386.1030700@kippdata.de>
MIME-Version: 1.0
Content-Transfer-Encoding: 7Bit
Content-Type: text/plain; charset="us-ascii"

On Wednesday 30 September 2015 23:26:30, Rainer Jung wrote:
> I noticed that currently the expression parser in 2.4/trunk does not
> support the SSL:VARIABLE lookups that mod_rewrite supports.
> 
> The expression parser uses ":" as an alternative function call
> syntax, so HTTP:VARIABLE is the same as HTTP(VARIABLE) which in
> turn executes http(VARIABLE). The same is true for ENV:VARIABLE
> which maps to env(VARIABLE) etc.
> 
> We already do support the syntax SSL_VARIABLE to look up SSL
> variables, because mod_ssl registers in the expression parser for
> variables whose name starts with "SSL_". But mod_ssl does not
> register for a function named SSL (or ssl), so the SSL: notation
> does not work.
> 
> Is that just an omission, or was that intentional? If not
> intentional, I would apply the following (yet untested) simple
> patch to trunk mod_ssl and propose for backport. It registers the
> SSL (and ssl) function in the expression parser:

I think that was just an omission. +1 to your patch.

> 
> Index: modules/ssl/ssl_engine_vars.c
> ===================================================================
> --- modules/ssl/ssl_engine_vars.c       (revision 1706155)
> +++ modules/ssl/ssl_engine_vars.c       (working copy)
> @@ -149,6 +149,15 @@
>       return sslconn ? ssl_var_lookup_ssl(ctx->p, ctx->c, ctx->r,
> var) : NULL;
>   }
> 
> +static const char *expr_func_fn(ap_expr_eval_ctx_t *ctx, const void
> *data, +                                const char *arg)
> +{
> +    char *var = (char *)arg;
> +    SSLConnRec *sslconn = myConnConfig(ctx->c);
> +
> +    return (var && sslconn) ? ssl_var_lookup_ssl(ctx->p, ctx->c,
> ctx->r, var) : NULL;
> +}
> +
>   static int ssl_expr_lookup(ap_expr_lookup_parms *parms)
>   {
>       switch (parms->type) {
> @@ -163,6 +172,15 @@
>               return OK;
>           }
>           break;
> +    case AP_EXPR_FUNC_STRING:
> +        /* Function SSL() is implemented by us.
> +         */
> +        if (strcEQ(parms->name, "SSL")) {
> +            *parms->func = expr_func_fn;
> +            *parms->data = NULL;
> +            return OK;
> +        }
> +        break;
>       case AP_EXPR_FUNC_LIST:
>           if (strcEQ(parms->name, "PeerExtList")) {
>               *parms->func = expr_peer_ext_list_fn;
> 
> 
> Regards,
> 
> Rainer


From dev-return-84062-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Mon Oct  5 22:59:31 2015
Return-Path: <dev-return-84062-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id A02C018463
	for <apmail-httpd-dev-archive@www.apache.org>; Mon,  5 Oct 2015 22:59:31 +0000 (UTC)
Received: (qmail 91301 invoked by uid 500); 5 Oct 2015 22:59:30 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 91244 invoked by uid 500); 5 Oct 2015 22:59:30 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 91234 invoked by uid 99); 5 Oct 2015 22:59:30 -0000
Received: from Unknown (HELO spamd4-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 05 Oct 2015 22:59:30 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd4-us-west.apache.org (ASF Mail Server at spamd4-us-west.apache.org) with ESMTP id BEC32C028F
	for <dev@httpd.apache.org>; Mon,  5 Oct 2015 22:59:29 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd4-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 0.99
X-Spam-Level:
X-Spam-Status: No, score=0.99 tagged_above=-999 required=6.31
	tests=[KAM_LAZY_DOMAIN_SECURITY=1, T_RP_MATCHES_RCVD=-0.01]
	autolearn=disabled
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd4-us-west.apache.org [10.40.0.11]) (amavisd-new, port 10024)
	with ESMTP id iH6zfFnG5IUh for <dev@httpd.apache.org>;
	Mon,  5 Oct 2015 22:59:28 +0000 (UTC)
Received: from eru.sfritsch.de (eru.sfritsch.de [188.40.99.202])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id 230EF439E0
	for <dev@httpd.apache.org>; Mon,  5 Oct 2015 22:59:27 +0000 (UTC)
From: Stefan Fritsch <sf@sfritsch.de>
To: dev@httpd.apache.org
Cc: Yann Ylavic <ylavic.dev@gmail.com>
Subject: Re: [Bug 53555] Scoreboard full error with event/ssl
Date: Tue, 06 Oct 2015 00:59:14 +0200
Message-ID: <1798446.mKlraB0FK5@k>
User-Agent: KMail/4.14.10 (Linux/4.2.0-1-amd64; KDE/4.14.12; x86_64; ; )
In-Reply-To: <bug-53555-38829-wRhxGYCekG@https.bz.apache.org/bugzilla/>
References: <bug-53555-38829@https.bz.apache.org/bugzilla/> <bug-53555-38829-wRhxGYCekG@https.bz.apache.org/bugzilla/>
MIME-Version: 1.0
Content-Transfer-Encoding: 7Bit
Content-Type: text/plain; charset="us-ascii"

Moving the discussion to dev@

On Monday 05 October 2015 22:40:15, bugzilla@apache.org wrote:
> https://bz.apache.org/bugzilla/show_bug.cgi?id=53555
> 
> --- Comment #25 from Yann Ylavic <ylavic.dev@gmail.com> ---
> (In reply to Stefan Fritsch from comment #24)
> 
> > (In reply to Yann Ylavic from comment #23)
> > 
> > > How about not setting SERVER_GRACEFUL in close_listeners() and
> > > worker_thread()?
> > > The old generation's state could be relevent, since the new
> > > generation does not "steal" the scoreboard now (until the old
> > > worker exits).> 
> > Yes, that would proabaly be better, I'll have to test that. But it
> > would not fix the incompleteness I was referring to: The old and
> > the new process have only one process slot in the scoreboard,
> > which makes the async overview table show sometimes the info from
> > the old and sometimes from the new process, depending on who
> > updated it last.
> 
> It seems to me that the new generation's worker threads are not
> started now unless their scoreboard slot is marked SERVER_DEAD (was
> also SERVER_GRACEFUL before attachment 33158).
> So AIUI, there shouldn't be two workers using the same slot.

There are worker slots (one for each thread) and process slots (one 
for each process). You are right about the worker slots. But the 
process slot is immediately re-used by the new process. It contains 
summary information like the number of open/async/keepalive 
connections.

BTW, there is quite a bit of code in mpm event that deals with this 
taking over of some of the worker slots of an old process before it 
has completely terminated. It seems to have been a part of the 
original design inherited from mpm worker. Does anyone know if this 
feature has been intentionally disabled in mpm event?


From dev-return-84063-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Mon Oct  5 23:24:43 2015
Return-Path: <dev-return-84063-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 117DB185AC
	for <apmail-httpd-dev-archive@www.apache.org>; Mon,  5 Oct 2015 23:24:43 +0000 (UTC)
Received: (qmail 38216 invoked by uid 500); 5 Oct 2015 23:24:39 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 38136 invoked by uid 500); 5 Oct 2015 23:24:39 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 38126 invoked by uid 99); 5 Oct 2015 23:24:39 -0000
Received: from Unknown (HELO spamd4-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 05 Oct 2015 23:24:39 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd4-us-west.apache.org (ASF Mail Server at spamd4-us-west.apache.org) with ESMTP id 29B57C0E08
	for <dev@httpd.apache.org>; Mon,  5 Oct 2015 23:24:39 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd4-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.101
X-Spam-Level:
X-Spam-Status: No, score=-0.101 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RCVD_IN_MSPIKE_H2=-0.001, SPF_PASS=-0.001, URIBL_BLOCKED=0.001]
	autolearn=disabled
Authentication-Results: spamd4-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-us-west.apache.org ([10.40.0.8])
	by localhost (spamd4-us-west.apache.org [10.40.0.11]) (amavisd-new, port 10024)
	with ESMTP id UKBKljpoRgG4 for <dev@httpd.apache.org>;
	Mon,  5 Oct 2015 23:24:32 +0000 (UTC)
Received: from mail-qk0-f171.google.com (mail-qk0-f171.google.com [209.85.220.171])
	by mx1-us-west.apache.org (ASF Mail Server at mx1-us-west.apache.org) with ESMTPS id 8C50820756
	for <dev@httpd.apache.org>; Mon,  5 Oct 2015 23:24:32 +0000 (UTC)
Received: by qkcf65 with SMTP id f65so75965622qkc.3
        for <dev@httpd.apache.org>; Mon, 05 Oct 2015 16:24:26 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :cc:content-type;
        bh=Pxc5PLGutF2cWkhaFtSQTw3BxXvviqH/lx9gwrN3MnA=;
        b=RzS/9nueyYRI9g6CPm2GmlVp0BG/D6/yYIZvp8tvOFWtRB5GqEgMOFH8tPg1cQ0QaF
         89xnVtxTClti5x9J87qFYT6CcH5XXE1/etwhq3riBujU23kpcE26xetIKjH/zYnmxd8q
         bPV2ZMv75nj52fn0iM9v4nVHlg0HvRIZGNsir58kVej4rgylJPETLkhGXRXyNYs+3utV
         gi8fIDUcIJPccltSigdNP/zrgMmIQ0ofscuAAme8ZUIY3lnuHbaA1ZpiHnkRhBdkqO2x
         xR4q+ZqjjEc6phP6zDGIL4N8pxNJwicDtdPdtkXRCIeWnBd5WFkX/J5UUTAGLQJGM/an
         A+YA==
MIME-Version: 1.0
X-Received: by 10.55.217.70 with SMTP id u67mr42334483qki.38.1444087466140;
 Mon, 05 Oct 2015 16:24:26 -0700 (PDT)
Received: by 10.55.72.20 with HTTP; Mon, 5 Oct 2015 16:24:26 -0700 (PDT)
In-Reply-To: <1798446.mKlraB0FK5@k>
References: <bug-53555-38829@https.bz.apache.org/bugzilla/>
	<bug-53555-38829-wRhxGYCekG@https.bz.apache.org/bugzilla/>
	<1798446.mKlraB0FK5@k>
Date: Tue, 6 Oct 2015 01:24:26 +0200
Message-ID: <CAKQ1sVNrAVCiW5mqMjafpuQozYZz4dEOtvaHHDiCCCsQ-=J79g@mail.gmail.com>
Subject: Re: [Bug 53555] Scoreboard full error with event/ssl
From: Yann Ylavic <ylavic.dev@gmail.com>
To: dev@httpd.apache.org
Cc: Stefan Fritsch <sf@sfritsch.de>
Content-Type: text/plain; charset=UTF-8

On Tue, Oct 6, 2015 at 12:59 AM, Stefan Fritsch <sf@sfritsch.de> wrote:
>
> There are worker slots (one for each thread) and process slots (one
> for each process). You are right about the worker slots. But the
> process slot is immediately re-used by the new process. It contains
> summary information like the number of open/async/keepalive
> connections.

Hm, you are right.

>
> BTW, there is quite a bit of code in mpm event that deals with this
> taking over of some of the worker slots of an old process before it
> has completely terminated. It seems to have been a part of the
> original design inherited from mpm worker. Does anyone know if this
> feature has been intentionally disabled in mpm event?

Dunno, but maybe we could use atomic operations for the process
scores, so that all the generations can report simultaneously...

From dev-return-84064-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Mon Oct  5 23:34:34 2015
Return-Path: <dev-return-84064-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id A5DD418609
	for <apmail-httpd-dev-archive@www.apache.org>; Mon,  5 Oct 2015 23:34:34 +0000 (UTC)
Received: (qmail 57346 invoked by uid 500); 5 Oct 2015 23:34:28 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 57279 invoked by uid 500); 5 Oct 2015 23:34:28 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 57265 invoked by uid 99); 5 Oct 2015 23:34:27 -0000
Received: from Unknown (HELO spamd3-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 05 Oct 2015 23:34:27 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd3-us-west.apache.org (ASF Mail Server at spamd3-us-west.apache.org) with ESMTP id 90A1D180992
	for <dev@httpd.apache.org>; Mon,  5 Oct 2015 23:34:27 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd3-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.01
X-Spam-Level:
X-Spam-Status: No, score=-0.01 tagged_above=-999 required=6.31
	tests=[SPF_PASS=-0.001, T_RP_MATCHES_RCVD=-0.01, URIBL_BLOCKED=0.001]
	autolearn=disabled
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd3-us-west.apache.org [10.40.0.10]) (amavisd-new, port 10024)
	with ESMTP id KX8arHTWsyQk for <dev@httpd.apache.org>;
	Mon,  5 Oct 2015 23:34:21 +0000 (UTC)
Received: from monica.sharp.fm (monica.sharp.fm [80.168.143.5])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTP id 980FE20F4F
	for <dev@httpd.apache.org>; Mon,  5 Oct 2015 23:34:20 +0000 (UTC)
Received: from [192.168.220.248] (unknown [192.168.220.248])
	(using TLSv1 with cipher DHE-RSA-AES256-SHA (256/256 bits))
	(Client did not present a certificate)
	(Authenticated sender: minfrin@sharp.fm)
	by monica.sharp.fm (Postfix) with ESMTPSA id BA0448314D;
	Tue,  6 Oct 2015 00:34:19 +0100 (BST)
Content-Type: text/plain; charset=utf-8
Mime-Version: 1.0 (Mac OS X Mail 8.2 \(2104\))
Subject: Re: Expression Parser: search and replace with s/PATTERN/REPLACEMENT/FLAGS
From: Graham Leggett <minfrin@sharp.fm>
In-Reply-To: <2301815.56cqMLLZDO@k>
Date: Tue, 6 Oct 2015 01:34:15 +0200
Cc: Rainer Jung <rainer.jung@kippdata.de>
Content-Transfer-Encoding: quoted-printable
Message-Id: <9184AE68-318D-4C05-B3EA-4C0B776B804D@sharp.fm>
References: <560D0A3F.9010609@kippdata.de> <56110376.7090807@kippdata.de> <6AA47FB6-EA08-4A4D-9E93-640B4882EB96@sharp.fm> <2301815.56cqMLLZDO@k>
To: dev@httpd.apache.org
X-Mailer: Apple Mail (2.2104)

On 06 Oct 2015, at 12:17 AM, Stefan Fritsch <sf@sfritsch.de> wrote:

>> How about a regex function?
>>=20
>> The single argument could be =E2=80=9Cs/PATTERN/REPLACEMENT/FLAGS=E2=80=
=9D.
>=20
> I think this would be easy to implement. It would require the regex to=20=

> be parsed on every execution, though, which has the disadvantages that=20=

> it is slower and that one would get error messages only during first=20=

> execution and not during server startup. Also, it would possibly allow=20=

> the admin to configure expressions where the regex pattern can contain=20=

> untrusted data, which would turn a lot of libpcre problems from local=20=

> into remote vulnerabilities.

What I had in mind was for the regex to be precompiled at startup along =
with everything else, but I see now that it would need a special syntax =
anyway to distinguish it from arbitrary string data.

Regards,
Graham
=E2=80=94


From dev-return-84065-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Mon Oct  5 23:39:43 2015
Return-Path: <dev-return-84065-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 99DC81864C
	for <apmail-httpd-dev-archive@www.apache.org>; Mon,  5 Oct 2015 23:39:43 +0000 (UTC)
Received: (qmail 77660 invoked by uid 500); 5 Oct 2015 23:39:43 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 77588 invoked by uid 500); 5 Oct 2015 23:39:43 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 77578 invoked by uid 99); 5 Oct 2015 23:39:43 -0000
Received: from Unknown (HELO spamd2-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 05 Oct 2015 23:39:43 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd2-us-west.apache.org (ASF Mail Server at spamd2-us-west.apache.org) with ESMTP id AB0D91A0AE5
	for <dev@httpd.apache.org>; Mon,  5 Oct 2015 23:39:42 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd2-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.002
X-Spam-Level:
X-Spam-Status: No, score=-0.002 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	KAM_ASCII_DIVIDERS=0.8, RCVD_IN_DNSWL_LOW=-0.7,
	RCVD_IN_MSPIKE_H2=-0.001, SPF_PASS=-0.001] autolearn=disabled
Authentication-Results: spamd2-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-us-west.apache.org ([10.40.0.8])
	by localhost (spamd2-us-west.apache.org [10.40.0.9]) (amavisd-new, port 10024)
	with ESMTP id Aay6fbj3-BwA for <dev@httpd.apache.org>;
	Mon,  5 Oct 2015 23:39:39 +0000 (UTC)
Received: from mail-qg0-f52.google.com (mail-qg0-f52.google.com [209.85.192.52])
	by mx1-us-west.apache.org (ASF Mail Server at mx1-us-west.apache.org) with ESMTPS id 70BF520513
	for <dev@httpd.apache.org>; Mon,  5 Oct 2015 23:39:39 +0000 (UTC)
Received: by qgev79 with SMTP id v79so164089757qge.0
        for <dev@httpd.apache.org>; Mon, 05 Oct 2015 16:39:33 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=mime-version:date:message-id:subject:from:to:content-type;
        bh=CMwudy1ezldqz5+FNh4RleP6uDoQAOcQQLSSpPzLDqA=;
        b=xq9MBykIOXcgb1OK+KFvgRSMGvJS9m1tqPYw+0XwQLM8lk2b0EFu7APdMDOO7SFXjT
         8vfxBekyHzAys+eg3BMaXIDHYbZlgSndlgqmN4+RFR7xTxWbFVYbqcVZEACubaO3d3bs
         evLw4TTasXwdPD0iGyMmghqHDZlmd8vz18gLcsMycb9NBdgQrVn1vI8UIPOXoDCcTOWx
         tbu6P+xCyLSI6Qt3+Q+4X3Zn6I+wiAGwfRWd6U7ULUUW6BDuAmVxAAhGxmP1LEbBaL7S
         d0PhUO94cKxjrzmYEg0NRnj9bmsTCNt1NDn44n29gw1OhtGS+5rfysF9sPYoHaRsCc3F
         jXEg==
MIME-Version: 1.0
X-Received: by 10.140.95.73 with SMTP id h67mr43575527qge.14.1444088373523;
 Mon, 05 Oct 2015 16:39:33 -0700 (PDT)
Received: by 10.55.72.20 with HTTP; Mon, 5 Oct 2015 16:39:33 -0700 (PDT)
Date: Tue, 6 Oct 2015 01:39:33 +0200
Message-ID: <CAKQ1sVMoxQe=8iAQ=oUSRJhrpy0o8RpJ=+u_CXecw8UbTj_NOg@mail.gmail.com>
Subject: Re: svn commit: r1706669 - in /httpd/httpd/trunk: ./ include/
 modules/http/ modules/ssl/ server/ server/mpm/event/ server/mpm/motorz/ server/mpm/simple/
From: Yann Ylavic <ylavic.dev@gmail.com>
To: dev@httpd.apache.org
Content-Type: text/plain; charset=UTF-8

Thanks Graham for this great patch, comments inline...

On Sun, Oct 4, 2015 at 12:10 PM,  <minfrin@apache.org> wrote:
> Author: minfrin
> Date: Sun Oct  4 10:10:51 2015
> New Revision: 1706669
>
> URL: http://svn.apache.org/viewvc?rev=1706669&view=rev
> Log:
> core: Extend support for asynchronous write completion from the
> network filter to any connection or request filter.
>
[]
>
> Modified: httpd/httpd/trunk/include/util_filter.h
> URL: http://svn.apache.org/viewvc/httpd/httpd/trunk/include/util_filter.h?rev=1706669&r1=1706668&r2=1706669&view=diff
> ==============================================================================
> --- httpd/httpd/trunk/include/util_filter.h (original)
> +++ httpd/httpd/trunk/include/util_filter.h Sun Oct  4 10:10:51 2015
> @@ -278,6 +278,13 @@ struct ap_filter_t {
>       *  to the request_rec, except that it is used for connection filters.
>       */
>      conn_rec *c;
> +
> +    /** Buffered data associated with the current filter. */
> +    apr_bucket_brigade *bb;
> +
> +    /** Dedicated pool to use for deferred writes. */
> +    apr_pool_t *deferred_pool;

Could we make these opaque, eg:

# util_filter.h:
struct ap_filter_data;
struct ap_filter_t {
    ...
    struct ap_filter_data *data;
};

# util_filter.c:
struct ap_filter_data
{
   /** Buffered data associated with the current filter. */
   apr_bucket_brigade *bb;

   /** Dedicated pool to use for deferred writes. */
   apr_pool_t *deferred_pool;
};

This would prevent them from being mangled anywhere (they are
internals to util_filter.c anyway).
It could also possibly avoid walking the brigade for every
ap_filter_reinstate_brigade() call...

> +
>  };
>
[]
>
> Modified: httpd/httpd/trunk/modules/http/http_request.c
> URL: http://svn.apache.org/viewvc/httpd/httpd/trunk/modules/http/http_request.c?rev=1706669&r1=1706668&r2=1706669&view=diff
> ==============================================================================
> --- httpd/httpd/trunk/modules/http/http_request.c (original)
> +++ httpd/httpd/trunk/modules/http/http_request.c Sun Oct  4 10:10:51 2015
> @@ -256,6 +256,14 @@ AP_DECLARE(void) ap_process_request_afte
>      apr_bucket *b;
>      conn_rec *c = r->connection;
>
> +    /* Find the last request, taking into account internal
> +     * redirects. We want to send the EOR bucket at the end of
> +     * all the buckets so it does not jump the queue.
> +     */
> +    while (r->next) {
> +        r = r->next;
> +    }
> +
>      /* Send an EOR bucket through the output filter chain.  When
>       * this bucket is destroyed, the request will be logged and
>       * its pool will be freed
> @@ -264,8 +272,8 @@ AP_DECLARE(void) ap_process_request_afte
>      b = ap_bucket_eor_create(c->bucket_alloc, r);
>      APR_BRIGADE_INSERT_HEAD(bb, b);
>
> -    ap_pass_brigade(c->output_filters, bb);
> -
> +    ap_pass_brigade(r->output_filters, bb);;;

Nit, trailing ";;"

> +
[]
> Modified: httpd/httpd/trunk/server/mpm/event/event.c
> URL: http://svn.apache.org/viewvc/httpd/httpd/trunk/server/mpm/event/event.c?rev=1706669&r1=1706668&r2=1706669&view=diff
> ==============================================================================
> --- httpd/httpd/trunk/server/mpm/event/event.c (original)
> +++ httpd/httpd/trunk/server/mpm/event/event.c Sun Oct  4 10:10:51 2015
> @@ -1146,19 +1146,38 @@ read_request:
>      }
>
[]
> +
> +        rindex = apr_hash_first(NULL, c->filters);
> +        while (rindex) {
> +            ap_filter_t *f = apr_hash_this_val(rindex);
> +
> +            if (!APR_BRIGADE_EMPTY(f->bb)) {
> +
> +                rv = ap_pass_brigade(f, c->empty);
> +                apr_brigade_cleanup(c->empty);
> +                if (APR_SUCCESS != rv) {
> +                    ap_log_cerror(
> +                            APLOG_MARK, APLOG_DEBUG, rv, c, APLOGNO(00470)
> +                            "write failure in '%s' output filter", f->frec->name);
> +                    break;
> +                }
> +
> +                if (ap_filter_should_yield(f)) {
> +                    data_in_output_filters = 1;
> +                }
> +            }
> +
> +            rindex = apr_hash_next(rindex);
>          }

This pattern looks shared by all (relevant) MPMs, couldn't we make it
a function? Maybe ap_reinstate_conn()?

Also it seems that we leak the hash iterator here (on c->pool).
Couldn't we use a (single) linked list for c->filters since
ap_filter_t already has a 'next' field?

[]
>
> Modified: httpd/httpd/trunk/server/mpm/motorz/motorz.c
> URL: http://svn.apache.org/viewvc/httpd/httpd/trunk/server/mpm/motorz/motorz.c?rev=1706669&r1=1706668&r2=1706669&view=diff
> ==============================================================================
> --- httpd/httpd/trunk/server/mpm/motorz/motorz.c (original)
> +++ httpd/httpd/trunk/server/mpm/motorz/motorz.c Sun Oct  4 10:10:51 2015
> @@ -359,21 +359,38 @@ static apr_status_t motorz_io_process(mo
[]
> +
> +            rindex = apr_hash_first(NULL, c->filters);
> +            while (rindex) {
> +                ap_filter_t *f = apr_hash_this_val(rindex);
> +
> +                if (!APR_BRIGADE_EMPTY(f->bb)) {
>
> -            rv = output_filter->frec->filter_func.out_func(output_filter,
> -                                                           NULL);
> +                    rv = ap_pass_brigade(f, c->empty);
> +                    apr_brigade_cleanup(c->empty);
> +                    if (APR_SUCCESS != rv) {
> +                        ap_log_cerror(
> +                                APLOG_MARK, APLOG_DEBUG, rv, c, APLOGNO(02848)
> +                                "write failure in '%s' output filter", f->frec->name);
> +                        break;
> +                    }
> +
> +                    if (ap_filter_should_yield(f)) {
> +                        data_in_output_filters = 1;
> +                    }
> +                }
> +
> +                rindex = apr_hash_next(rindex);
> +            }

Here.

[]
> Modified: httpd/httpd/trunk/server/mpm/simple/simple_io.c
> URL: http://svn.apache.org/viewvc/httpd/httpd/trunk/server/mpm/simple/simple_io.c?rev=1706669&r1=1706668&r2=1706669&view=diff
> ==============================================================================
> --- httpd/httpd/trunk/server/mpm/simple/simple_io.c (original)
> +++ httpd/httpd/trunk/server/mpm/simple/simple_io.c Sun Oct  4 10:10:51 2015
> @@ -92,20 +92,37 @@ static apr_status_t simple_io_process(si
[]
> +
> +            rindex = apr_hash_first(NULL, c->filters);
> +            while (rindex) {
> +                ap_filter_t *f = apr_hash_this_val(rindex);
> +
> +                if (!APR_BRIGADE_EMPTY(f->bb)) {
>
> -            rv = output_filter->frec->filter_func.out_func(output_filter,
> -                                                           NULL);
> +                    rv = ap_pass_brigade(f, c->empty);
> +                    apr_brigade_cleanup(c->empty);
> +                    if (APR_SUCCESS != rv) {
> +                        ap_log_cerror(
> +                                APLOG_MARK, APLOG_DEBUG, rv, c, APLOGNO(00249)
> +                                "write failure in '%s' output filter", f->frec->name);
> +                        break;
> +                    }
> +
> +                    if (ap_filter_should_yield(f)) {
> +                        data_in_output_filters = 1;
> +                    }
> +                }
> +
> +                rindex = apr_hash_next(rindex);
> +            }

And here.

[]
>
> Modified: httpd/httpd/trunk/server/util_filter.c
> URL: http://svn.apache.org/viewvc/httpd/httpd/trunk/server/util_filter.c?rev=1706669&r1=1706668&r2=1706669&view=diff
> ==============================================================================
> --- httpd/httpd/trunk/server/util_filter.c (original)
> +++ httpd/httpd/trunk/server/util_filter.c Sun Oct  4 10:10:51 2015
[]
> @@ -635,7 +653,8 @@ AP_DECLARE(apr_status_t) ap_save_brigade
>      apr_status_t rv, srv = APR_SUCCESS;
>
>      /* If have never stored any data in the filter, then we had better
> -     * create an empty bucket brigade so that we can concat.
> +     * create an empty bucket brigade so that we can concat. Register
> +     * a cleanup to zero out the pointer if the pool is cleared.

Maybe this comment belongs in ap_filter_setaside_brigade()?

>       */
>      if (!(*saveto)) {
>          *saveto = apr_brigade_create(p, f->c->bucket_alloc);
> @@ -673,6 +692,248 @@ AP_DECLARE(apr_status_t) ap_save_brigade
>      return srv;
>  }
>
> +static apr_status_t filters_cleanup(void *data)
> +{
> +    ap_filter_t **key = data;
> +
> +    apr_hash_set((*key)->c->filters, key, sizeof(ap_filter_t **), NULL);
> +
> +    return APR_SUCCESS;
> +}

Shouldn't we call filters_cleanup() from ap_remove_output_filter() too?

> +
> +AP_DECLARE(apr_status_t) ap_filter_setaside_brigade(ap_filter_t *f,
> +        apr_bucket_brigade *bb)
> +{
> +    int loglevel = ap_get_conn_module_loglevel(f->c, APLOG_MODULE_INDEX);
> +
> +    if (loglevel >= APLOG_TRACE6) {
> +        ap_log_cerror(
> +            APLOG_MARK, APLOG_TRACE6, 0, f->c,
> +            "setaside %s brigade to %s brigade in '%s' output filter",
> +            (APR_BRIGADE_EMPTY(bb) ? "empty" : "full"),
> +            (!f->bb || APR_BRIGADE_EMPTY(f->bb) ? "empty" : "full"), f->frec->name);
> +    }
> +
> +    if (!APR_BRIGADE_EMPTY(bb)) {
> +        apr_pool_t *pool;
> +        /*
> +         * Set aside the brigade bb within f->bb.
> +         */
> +        if (!f->bb) {
> +            ap_filter_t **key;
> +
> +            pool = f->r ? f->r->pool : f->c->pool;
> +
> +            key = apr_palloc(pool, sizeof(ap_filter_t **));
> +            *key = f;
> +            apr_hash_set(f->c->filters, key, sizeof(ap_filter_t **), f);

Why not simply use:
   key = apr_pmemdup(pool, &f, sizeof f);
   apr_hash_set(f->c->filters, &key, sizeof key, f)
here, and:
   ap_filter_t *f = data;
   apr_hash_set(f->c->filters, &f, sizeof f, NULL);
in filters_cleanup() above?

The linked list could possibly be simpler here too (using the 'next' field).
Above filters_cleanup() would have to start from the beginning of the
list each time to remove the entries, though.

> +
> +            f->bb = apr_brigade_create(pool, f->c->bucket_alloc);
> +
> +            apr_pool_pre_cleanup_register(pool, key, filters_cleanup);
> +
> +        }
> +
> +        /* decide what pool we setaside to, request pool or deferred pool? */
> +        if (f->r) {
> +            pool = f->r->pool;
> +            APR_BRIGADE_CONCAT(f->bb, bb);
> +        }
> +        else {
> +            if (!f->deferred_pool) {
> +                apr_pool_create(&f->deferred_pool, f->c->pool);
> +                apr_pool_tag(f->deferred_pool, "deferred_pool");
> +            }
> +            pool = f->deferred_pool;
> +            return ap_save_brigade(f, &f->bb, &bb, pool);
> +        }

Shouldn't ap_save_brigade() be moved below the "else"?

> +
> +    }
> +    else if (f->deferred_pool) {
> +        /*
> +         * There are no more requests in the pipeline. We can just clear the
> +         * pool.
> +         */
> +        apr_brigade_cleanup(f->bb);
> +        apr_pool_clear(f->deferred_pool);
> +    }
> +    return APR_SUCCESS;
> +}
> +
> +AP_DECLARE(apr_status_t) ap_filter_reinstate_brigade(ap_filter_t *f,
> +                                                     apr_bucket_brigade *bb,
> +                                                     apr_bucket **flush_upto)
> +{
[]
> +    apr_bucket *bucket, *next;
> +    apr_size_t bytes_in_brigade, non_file_bytes_in_brigade;
> +    int eor_buckets_in_brigade, morphing_bucket_in_brigade;
> +    int loglevel = ap_get_conn_module_loglevel(f->c, APLOG_MODULE_INDEX);
> +
> +    if (loglevel >= APLOG_TRACE6) {
> +        ap_log_cerror(
> +            APLOG_MARK, APLOG_TRACE6, 0, f->c,
> +            "reinstate %s brigade to %s brigade in '%s' output filter",
> +            (!f->bb || APR_BRIGADE_EMPTY(f->bb) ? "empty" : "full"),
> +            (APR_BRIGADE_EMPTY(bb) ? "empty" : "full"), f->frec->name);
> +    }
> +
> +    if (f->bb && !APR_BRIGADE_EMPTY(f->bb)) {
> +        APR_BRIGADE_PREPEND(bb, f->bb);
> +    }
> +
> +    /*
> +     * Determine if and up to which bucket we need to do a blocking write:
> +     *
> +     *  a) The brigade contains a flush bucket: Do a blocking write
> +     *     of everything up that point.
> +     *
> +     *  b) The request is in CONN_STATE_HANDLER state, and the brigade
> +     *     contains at least THRESHOLD_MAX_BUFFER bytes in non-file
> +     *     buckets: Do blocking writes until the amount of data in the
> +     *     buffer is less than THRESHOLD_MAX_BUFFER.  (The point of this
> +     *     rule is to provide flow control, in case a handler is
> +     *     streaming out lots of data faster than the data can be
> +     *     sent to the client.)
> +     *
> +     *  c) The request is in CONN_STATE_HANDLER state, and the brigade
> +     *     contains at least MAX_REQUESTS_IN_PIPELINE EOR buckets:
> +     *     Do blocking writes until less than MAX_REQUESTS_IN_PIPELINE EOR
> +     *     buckets are left. (The point of this rule is to prevent too many
> +     *     FDs being kept open by pipelined requests, possibly allowing a
> +     *     DoS).
> +     *
> +     *  d) The request is being served by a connection filter and the
> +     *     brigade contains a morphing bucket: If there was no other
> +     *     reason to do a blocking write yet, try reading the bucket. If its
> +     *     contents fit into memory before THRESHOLD_MAX_BUFFER is reached,
> +     *     everything is fine. Otherwise we need to do a blocking write the
> +     *     up to and including the morphing bucket, because ap_save_brigade()
> +     *     would read the whole bucket into memory later on.
> +     */
> +
> +    *flush_upto = NULL;
> +
> +    bytes_in_brigade = 0;
> +    non_file_bytes_in_brigade = 0;
> +    eor_buckets_in_brigade = 0;
> +    morphing_bucket_in_brigade = 0;

Per the ealier suggestion to make ap_filter_data opaque, these could
be part of the struct (and reentrant).
We could then PREPEND after the loop below, and avoid potentially to
walk the same buckets each time.

> +
> +    for (bucket = APR_BRIGADE_FIRST(bb); bucket != APR_BRIGADE_SENTINEL(bb);
> +         bucket = next) {
> +        next = APR_BUCKET_NEXT(bucket);
> +
> +        if (!APR_BUCKET_IS_METADATA(bucket)) {
> +            if (bucket->length == (apr_size_t)-1) {
> +                /*
> +                 * A setaside of morphing buckets would read everything into
> +                 * memory. Instead, we will flush everything up to and
> +                 * including this bucket.
> +                 */
> +                morphing_bucket_in_brigade = 1;
> +            }
> +            else {
> +                bytes_in_brigade += bucket->length;
> +                if (!APR_BUCKET_IS_FILE(bucket))
> +                    non_file_bytes_in_brigade += bucket->length;
> +            }
> +        }
> +        else if (AP_BUCKET_IS_EOR(bucket)) {
> +            eor_buckets_in_brigade++;
> +        }
> +
> +        if (APR_BUCKET_IS_FLUSH(bucket)
> +            || non_file_bytes_in_brigade >= THRESHOLD_MAX_BUFFER
> +            || (!f->r && morphing_bucket_in_brigade)
> +            || eor_buckets_in_brigade > MAX_REQUESTS_IN_PIPELINE) {
> +            /* this segment of the brigade MUST be sent before returning. */
> +
> +            if (loglevel >= APLOG_TRACE6) {
> +                char *reason = APR_BUCKET_IS_FLUSH(bucket) ?
> +                               "FLUSH bucket" :
> +                               (non_file_bytes_in_brigade >= THRESHOLD_MAX_BUFFER) ?
> +                               "THRESHOLD_MAX_BUFFER" :
> +                               (!f->r && morphing_bucket_in_brigade) ? "morphing bucket" :
> +                               "MAX_REQUESTS_IN_PIPELINE";
> +                ap_log_cerror(APLOG_MARK, APLOG_TRACE6, 0, f->c,
> +                              "will flush because of %s", reason);
> +                ap_log_cerror(APLOG_MARK, APLOG_TRACE8, 0, f->c,
> +                              "seen in brigade%s: bytes: %" APR_SIZE_T_FMT
> +                              ", non-file bytes: %" APR_SIZE_T_FMT ", eor "
> +                              "buckets: %d, morphing buckets: %d",
> +                              flush_upto == NULL ? " so far"
> +                                                 : " since last flush point",
> +                              bytes_in_brigade,
> +                              non_file_bytes_in_brigade,
> +                              eor_buckets_in_brigade,
> +                              morphing_bucket_in_brigade);
> +            }
> +            /*
> +             * Defer the actual blocking write to avoid doing many writes.
> +             */
> +            *flush_upto = next;
> +
> +            bytes_in_brigade = 0;
> +            non_file_bytes_in_brigade = 0;
> +            eor_buckets_in_brigade = 0;
> +            morphing_bucket_in_brigade = 0;
> +        }
> +    }

Regards,
Yann.

From dev-return-84066-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Tue Oct  6 06:00:01 2015
Return-Path: <dev-return-84066-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 7FAC718FEE
	for <apmail-httpd-dev-archive@www.apache.org>; Tue,  6 Oct 2015 06:00:01 +0000 (UTC)
Received: (qmail 882 invoked by uid 500); 6 Oct 2015 06:00:00 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 795 invoked by uid 500); 6 Oct 2015 06:00:00 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 766 invoked by uid 99); 6 Oct 2015 06:00:00 -0000
Received: from Unknown (HELO spamd1-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 06 Oct 2015 06:00:00 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd1-us-west.apache.org (ASF Mail Server at spamd1-us-west.apache.org) with ESMTP id 0B838C2E88
	for <dev@httpd.apache.org>; Tue,  6 Oct 2015 06:00:00 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd1-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 0.999
X-Spam-Level:
X-Spam-Status: No, score=0.999 tagged_above=-999 required=6.31
	tests=[KAM_LAZY_DOMAIN_SECURITY=1, RCVD_IN_MSPIKE_H2=-0.001]
	autolearn=disabled
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd1-us-west.apache.org [10.40.0.7]) (amavisd-new, port 10024)
	with ESMTP id TSQ5Pi_ogtSX for <dev@httpd.apache.org>;
	Tue,  6 Oct 2015 05:59:59 +0000 (UTC)
Received: from smtp.smtpout.orange.fr (smtp08.smtpout.orange.fr [80.12.242.130])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id BB80C42B36
	for <dev@httpd.apache.org>; Tue,  6 Oct 2015 05:59:58 +0000 (UTC)
Received: from [127.0.0.1] ([92.140.231.38])
	by mwinf5d43 with ME
	id Rhzq1r00G0qMo2c03hzqYw; Tue, 06 Oct 2015 07:59:51 +0200
X-ME-Helo: [127.0.0.1]
X-ME-Date: Tue, 06 Oct 2015 07:59:51 +0200
X-ME-IP: 92.140.231.38
Subject: Re: svn commit: r1703305 -
 /httpd/httpd/trunk/modules/aaa/mod_auth_digest.c
To: dev@httpd.apache.org
References: <20150915222046.152F4AC0181@hades.apache.org>
 <560D7C36.7010607@apache.org> <561032EF.9090401@wanadoo.fr>
 <AB1691BE05AE7F4992697F2A0835627AC633CFB8@VOEXM10W.internal.vodafone.com>
From: Marion & Christophe JAILLET <christophe.jaillet@wanadoo.fr>
Message-ID: <56136355.7010700@wanadoo.fr>
Date: Tue, 6 Oct 2015 07:59:49 +0200
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:38.0) Gecko/20100101
 Thunderbird/38.3.0
MIME-Version: 1.0
In-Reply-To: <AB1691BE05AE7F4992697F2A0835627AC633CFB8@VOEXM10W.internal.vodafone.com>
Content-Type: text/plain; charset=utf-8; format=flowed
Content-Transfer-Encoding: 8bit
X-Antivirus: avast! (VPS 151005-1, 05/10/2015), Outbound message
X-Antivirus-Status: Clean



Le 05/10/2015 12:03, Plüm, Rüdiger, Vodafone Group a écrit :
>
>> -----Original Message-----
>> From: Marion & Christophe JAILLET [mailto:christophe.jaillet@wanadoo.fr]
>> Sent: Samstag, 3. Oktober 2015 21:57
>> To: dev@httpd.apache.org
>> Subject: Re: svn commit: r1703305 -
>> /httpd/httpd/trunk/modules/aaa/mod_auth_digest.c
>>
>>
>> Le 01/10/2015 20:32, Ruediger Pluem a écrit :
>>> On 09/16/2015 12:20 AM, jailletc36@apache.org wrote:
>>>> Author: jailletc36
>>>> Date: Tue Sep 15 22:20:45 2015
>>>> New Revision: 1703305
>>>>
>>>> URL: http://svn.apache.org/r1703305
>>>> Log:
>>>> Remove code related to 'AuthDigestEnableQueryStringHack'
>>>>
>>>> This has been undocumented for about 3 years now (see r1415960)
>>>>
>>>> Modified:
>>>>       httpd/httpd/trunk/modules/aaa/mod_auth_digest.c
>>> Could this cause
>>>
>>> t/modules/digest.t
>>>
>>> test 9 to fail?
>>>
>>> As we removed the code for good reason we should also remove the test if
>> this is the case then.
>>> Regards
>>>
>>> Rüdiger
>> Hi,
>> yes, you are right.
>>
>> I would proposed the below patch:
> +1
>
>
> Regards
>
> Rüdiger
>

Done in r1706952

CJ

From dev-return-84067-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Tue Oct  6 07:38:41 2015
Return-Path: <dev-return-84067-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id AFEC41748F
	for <apmail-httpd-dev-archive@www.apache.org>; Tue,  6 Oct 2015 07:38:41 +0000 (UTC)
Received: (qmail 30361 invoked by uid 500); 6 Oct 2015 07:38:19 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 30274 invoked by uid 500); 6 Oct 2015 07:38:19 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 30264 invoked by uid 99); 6 Oct 2015 07:38:19 -0000
Received: from Unknown (HELO spamd2-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 06 Oct 2015 07:38:19 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd2-us-west.apache.org (ASF Mail Server at spamd2-us-west.apache.org) with ESMTP id C9DB61A1F98
	for <dev@httpd.apache.org>; Tue,  6 Oct 2015 07:38:18 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd2-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 1.799
X-Spam-Level: *
X-Spam-Status: No, score=1.799 tagged_above=-999 required=6.31
	tests=[KAM_ASCII_DIVIDERS=0.8, KAM_LAZY_DOMAIN_SECURITY=1,
	SPF_HELO_PASS=-0.001] autolearn=disabled
Received: from mx1-us-west.apache.org ([10.40.0.8])
	by localhost (spamd2-us-west.apache.org [10.40.0.9]) (amavisd-new, port 10024)
	with ESMTP id HAEkgZMcZ4jC for <dev@httpd.apache.org>;
	Tue,  6 Oct 2015 07:38:07 +0000 (UTC)
Received: from mail1.bemta3.messagelabs.com (mail1.bemta3.messagelabs.com [195.245.230.168])
	by mx1-us-west.apache.org (ASF Mail Server at mx1-us-west.apache.org) with ESMTPS id 08F7D20562
	for <dev@httpd.apache.org>; Tue,  6 Oct 2015 07:38:06 +0000 (UTC)
Received: from [195.245.230.51] by server-8.bemta-3.messagelabs.com id 89/27-31069-75A73165; Tue, 06 Oct 2015 07:37:59 +0000
X-Env-Sender: ruediger.pluem@vodafone.com
X-Msg-Ref: server-6.tower-33.messagelabs.com!1444117079!31143054!1
X-Originating-IP: [195.232.244.134]
X-StarScan-Received:
X-StarScan-Version: 6.13.16; banners=-,-,-
X-VirusChecked: Checked
Received: (qmail 18723 invoked from network); 6 Oct 2015 07:37:59 -0000
Received: from mailout02.vodafone.com (HELO mailout02.vodafone.com) (195.232.244.134)
  by server-6.tower-33.messagelabs.com with DHE-RSA-AES256-SHA encrypted SMTP; 6 Oct 2015 07:37:59 -0000
Received: from mailint03.vodafone.com (mailint03.vodafone.com [195.232.244.200])
	by mailout02.vodafone.com (Postfix) with ESMTP id 3nVVyH0dxDzbdMS
	for <dev@httpd.apache.org>; Tue,  6 Oct 2015 09:37:59 +0200 (CEST)
Received: from mailint03.vodafone.com (localhost [127.0.0.1])
	by mailint03.vodafone.com (Postfix) with ESMTP id 3nVVyG6c2rz16JBw
	for <dev@httpd.apache.org>; Tue,  6 Oct 2015 09:37:58 +0200 (CEST)
Received: from VOEXC04W.internal.vodafone.com (voexc04w.dc-ratingen.de [145.230.101.24])
	(using TLSv1 with cipher AES128-SHA (128/128 bits))
	(No client certificate requested)
	by mailint03.vodafone.com (Postfix) with ESMTPS id 3nVVyG6X3Wz16JBv
	for <dev@httpd.apache.org>; Tue,  6 Oct 2015 09:37:58 +0200 (CEST)
Received: from AVOEXH03W.internal.vodafone.com (145.230.15.141) by
 VOEXC04W.internal.vodafone.com (145.230.101.24) with Microsoft SMTP Server
 (TLS) id 14.3.224.2; Tue, 6 Oct 2015 09:37:58 +0200
Received: from VOEXM10W.internal.vodafone.com ([169.254.2.88]) by
 AVOEXH03W.internal.vodafone.com ([145.230.15.141]) with mapi id
 14.03.0224.002; Tue, 6 Oct 2015 09:37:57 +0200
From: =?utf-8?B?UGzDvG0sIFLDvGRpZ2VyLCBWb2RhZm9uZSBHcm91cA==?=
	<ruediger.pluem@vodafone.com>
To: "dev@httpd.apache.org" <dev@httpd.apache.org>
Subject: RE: svn commit: r1706669 - in /httpd/httpd/trunk: ./ include/
 modules/http/ modules/ssl/ server/ server/mpm/event/ server/mpm/motorz/
 server/mpm/simple/
Thread-Topic: svn commit: r1706669 - in /httpd/httpd/trunk: ./ include/
 modules/http/ modules/ssl/ server/ server/mpm/event/ server/mpm/motorz/
 server/mpm/simple/
Thread-Index: AQHQ/8ce27K9fyvABE+g5rr0X8c32p5eD7UQ
Date: Tue, 6 Oct 2015 07:37:56 +0000
Message-ID: <AB1691BE05AE7F4992697F2A0835627AC633D4AC@VOEXM10W.internal.vodafone.com>
References: <CAKQ1sVMoxQe=8iAQ=oUSRJhrpy0o8RpJ=+u_CXecw8UbTj_NOg@mail.gmail.com>
In-Reply-To: <CAKQ1sVMoxQe=8iAQ=oUSRJhrpy0o8RpJ=+u_CXecw8UbTj_NOg@mail.gmail.com>
Accept-Language: en-US
Content-Language: en-US
X-MS-Has-Attach:
X-MS-TNEF-Correlator:
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
MIME-Version: 1.0

DQoNCj4gLS0tLS1PcmlnaW5hbCBNZXNzYWdlLS0tLS0NCj4gRnJvbTogWWFubiBZbGF2aWMgW21h
aWx0bzp5bGF2aWMuZGV2QGdtYWlsLmNvbV0NCj4gU2VudDogRGllbnN0YWcsIDYuIE9rdG9iZXIg
MjAxNSAwMTo0MA0KPiBUbzogZGV2QGh0dHBkLmFwYWNoZS5vcmcNCj4gU3ViamVjdDogUmU6IHN2
biBjb21taXQ6IHIxNzA2NjY5IC0gaW4gL2h0dHBkL2h0dHBkL3RydW5rOiAuLyBpbmNsdWRlLw0K
PiBtb2R1bGVzL2h0dHAvIG1vZHVsZXMvc3NsLyBzZXJ2ZXIvIHNlcnZlci9tcG0vZXZlbnQvIHNl
cnZlci9tcG0vbW90b3J6Lw0KPiBzZXJ2ZXIvbXBtL3NpbXBsZS8NCj4gDQo+ID4gTW9kaWZpZWQ6
IGh0dHBkL2h0dHBkL3RydW5rL3NlcnZlci9tcG0vZXZlbnQvZXZlbnQuYw0KPiA+IFVSTDoNCj4g
aHR0cDovL3N2bi5hcGFjaGUub3JnL3ZpZXd2Yy9odHRwZC9odHRwZC90cnVuay9zZXJ2ZXIvbXBt
L2V2ZW50L2V2ZW50LmM/cmUNCj4gdj0xNzA2NjY5JnIxPTE3MDY2NjgmcjI9MTcwNjY2OSZ2aWV3
PWRpZmYNCj4gPg0KPiA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQ0KPiA9PT09DQo+ID4gLS0tIGh0dHBkL2h0
dHBkL3RydW5rL3NlcnZlci9tcG0vZXZlbnQvZXZlbnQuYyAob3JpZ2luYWwpDQo+ID4gKysrIGh0
dHBkL2h0dHBkL3RydW5rL3NlcnZlci9tcG0vZXZlbnQvZXZlbnQuYyBTdW4gT2N0ICA0IDEwOjEw
OjUxIDIwMTUNCj4gPiBAQCAtMTE0NiwxOSArMTE0NiwzOCBAQCByZWFkX3JlcXVlc3Q6DQo+ID4g
ICAgICB9DQo+ID4NCj4gW10NCj4gPiArDQo+ID4gKyAgICAgICAgcmluZGV4ID0gYXByX2hhc2hf
Zmlyc3QoTlVMTCwgYy0+ZmlsdGVycyk7DQo+ID4gKyAgICAgICAgd2hpbGUgKHJpbmRleCkgew0K
PiA+ICsgICAgICAgICAgICBhcF9maWx0ZXJfdCAqZiA9IGFwcl9oYXNoX3RoaXNfdmFsKHJpbmRl
eCk7DQo+ID4gKw0KPiA+ICsgICAgICAgICAgICBpZiAoIUFQUl9CUklHQURFX0VNUFRZKGYtPmJi
KSkgew0KPiA+ICsNCj4gPiArICAgICAgICAgICAgICAgIHJ2ID0gYXBfcGFzc19icmlnYWRlKGYs
IGMtPmVtcHR5KTsNCj4gPiArICAgICAgICAgICAgICAgIGFwcl9icmlnYWRlX2NsZWFudXAoYy0+
ZW1wdHkpOw0KPiA+ICsgICAgICAgICAgICAgICAgaWYgKEFQUl9TVUNDRVNTICE9IHJ2KSB7DQo+
ID4gKyAgICAgICAgICAgICAgICAgICAgYXBfbG9nX2NlcnJvcigNCj4gPiArICAgICAgICAgICAg
ICAgICAgICAgICAgICAgIEFQTE9HX01BUkssIEFQTE9HX0RFQlVHLCBydiwgYywNCj4gQVBMT0dO
TygwMDQ3MCkNCj4gPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICJ3cml0ZSBmYWlsdXJl
IGluICclcycgb3V0cHV0IGZpbHRlciIsIGYtDQo+ID5mcmVjLT5uYW1lKTsNCj4gPiArICAgICAg
ICAgICAgICAgICAgICBicmVhazsNCj4gPiArICAgICAgICAgICAgICAgIH0NCj4gPiArDQo+ID4g
KyAgICAgICAgICAgICAgICBpZiAoYXBfZmlsdGVyX3Nob3VsZF95aWVsZChmKSkgew0KPiA+ICsg
ICAgICAgICAgICAgICAgICAgIGRhdGFfaW5fb3V0cHV0X2ZpbHRlcnMgPSAxOw0KPiA+ICsgICAg
ICAgICAgICAgICAgfQ0KPiA+ICsgICAgICAgICAgICB9DQo+ID4gKw0KPiA+ICsgICAgICAgICAg
ICByaW5kZXggPSBhcHJfaGFzaF9uZXh0KHJpbmRleCk7DQo+ID4gICAgICAgICAgfQ0KPiANCj4g
VGhpcyBwYXR0ZXJuIGxvb2tzIHNoYXJlZCBieSBhbGwgKHJlbGV2YW50KSBNUE1zLCBjb3VsZG4n
dCB3ZSBtYWtlIGl0DQo+IGEgZnVuY3Rpb24/IE1heWJlIGFwX3JlaW5zdGF0ZV9jb25uKCk/DQoN
ClNvdW5kcyBzZW5zaWJsZS4NCg0KPiANCj4gQWxzbyBpdCBzZWVtcyB0aGF0IHdlIGxlYWsgdGhl
IGhhc2ggaXRlcmF0b3IgaGVyZSAob24gYy0+cG9vbCkuDQoNCldoeSBkbyB3ZSBsZWFrIGhlcmU/
IGFwcl9oYXNoX2ZpcnN0KE5VTEwsIGlzIHVzZWQuIFNvIG5vIG5ldyBpdGVyYXRvciBpcyBhbGxv
Y2F0ZWQuDQoNCj4gQ291bGRuJ3Qgd2UgdXNlIGEgKHNpbmdsZSkgbGlua2VkIGxpc3QgZm9yIGMt
PmZpbHRlcnMgc2luY2UNCj4gYXBfZmlsdGVyX3QgYWxyZWFkeSBoYXMgYSAnbmV4dCcgZmllbGQ/
DQo+IA0KPiA+DQo+ID4gTW9kaWZpZWQ6IGh0dHBkL2h0dHBkL3RydW5rL3NlcnZlci91dGlsX2Zp
bHRlci5jDQo+ID4gVVJMOg0KPiBodHRwOi8vc3ZuLmFwYWNoZS5vcmcvdmlld3ZjL2h0dHBkL2h0
dHBkL3RydW5rL3NlcnZlci91dGlsX2ZpbHRlci5jP3Jldj0xNw0KPiAwNjY2OSZyMT0xNzA2NjY4
JnIyPTE3MDY2Njkmdmlldz1kaWZmDQo+ID4NCj4gPT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0NCj4gPT09PQ0K
PiA+IC0tLSBodHRwZC9odHRwZC90cnVuay9zZXJ2ZXIvdXRpbF9maWx0ZXIuYyAob3JpZ2luYWwp
DQo+ID4gKysrIGh0dHBkL2h0dHBkL3RydW5rL3NlcnZlci91dGlsX2ZpbHRlci5jIFN1biBPY3Qg
IDQgMTA6MTA6NTEgMjAxNQ0KPiBbXQ0KPiA+IEBAIC02MzUsNyArNjUzLDggQEAgQVBfREVDTEFS
RShhcHJfc3RhdHVzX3QpIGFwX3NhdmVfYnJpZ2FkZQ0KPiA+ICAgICAgYXByX3N0YXR1c190IHJ2
LCBzcnYgPSBBUFJfU1VDQ0VTUzsNCj4gPg0KPiA+ICAgICAgLyogSWYgaGF2ZSBuZXZlciBzdG9y
ZWQgYW55IGRhdGEgaW4gdGhlIGZpbHRlciwgdGhlbiB3ZSBoYWQgYmV0dGVyDQo+ID4gLSAgICAg
KiBjcmVhdGUgYW4gZW1wdHkgYnVja2V0IGJyaWdhZGUgc28gdGhhdCB3ZSBjYW4gY29uY2F0Lg0K
PiA+ICsgICAgICogY3JlYXRlIGFuIGVtcHR5IGJ1Y2tldCBicmlnYWRlIHNvIHRoYXQgd2UgY2Fu
IGNvbmNhdC4gUmVnaXN0ZXINCj4gPiArICAgICAqIGEgY2xlYW51cCB0byB6ZXJvIG91dCB0aGUg
cG9pbnRlciBpZiB0aGUgcG9vbCBpcyBjbGVhcmVkLg0KPiANCj4gTWF5YmUgdGhpcyBjb21tZW50
IGJlbG9uZ3MgaW4gYXBfZmlsdGVyX3NldGFzaWRlX2JyaWdhZGUoKT8NCj4gDQo+ID4gICAgICAg
Ki8NCj4gPiAgICAgIGlmICghKCpzYXZldG8pKSB7DQo+ID4gICAgICAgICAgKnNhdmV0byA9IGFw
cl9icmlnYWRlX2NyZWF0ZShwLCBmLT5jLT5idWNrZXRfYWxsb2MpOw0KPiA+IEBAIC02NzMsNiAr
NjkyLDI0OCBAQCBBUF9ERUNMQVJFKGFwcl9zdGF0dXNfdCkgYXBfc2F2ZV9icmlnYWRlDQo+ID4g
ICAgICByZXR1cm4gc3J2Ow0KPiA+ICB9DQo+ID4NCj4gPiArc3RhdGljIGFwcl9zdGF0dXNfdCBm
aWx0ZXJzX2NsZWFudXAodm9pZCAqZGF0YSkNCj4gPiArew0KPiA+ICsgICAgYXBfZmlsdGVyX3Qg
KiprZXkgPSBkYXRhOw0KPiA+ICsNCj4gPiArICAgIGFwcl9oYXNoX3NldCgoKmtleSktPmMtPmZp
bHRlcnMsIGtleSwgc2l6ZW9mKGFwX2ZpbHRlcl90ICoqKSwNCj4gTlVMTCk7DQo+ID4gKw0KPiA+
ICsgICAgcmV0dXJuIEFQUl9TVUNDRVNTOw0KPiA+ICt9DQo+IA0KPiBTaG91bGRuJ3Qgd2UgY2Fs
bCBmaWx0ZXJzX2NsZWFudXAoKSBmcm9tIGFwX3JlbW92ZV9vdXRwdXRfZmlsdGVyKCkgdG9vPw0K
DQpJIHRoaW5rIHNvLg0KDQo+ID4gKw0KPiA+ICsgICAgICAgICAgICBmLT5iYiA9IGFwcl9icmln
YWRlX2NyZWF0ZShwb29sLCBmLT5jLT5idWNrZXRfYWxsb2MpOw0KPiA+ICsNCj4gPiArICAgICAg
ICAgICAgYXByX3Bvb2xfcHJlX2NsZWFudXBfcmVnaXN0ZXIocG9vbCwga2V5LCBmaWx0ZXJzX2Ns
ZWFudXApOw0KPiA+ICsNCj4gPiArICAgICAgICB9DQo+ID4gKw0KPiA+ICsgICAgICAgIC8qIGRl
Y2lkZSB3aGF0IHBvb2wgd2Ugc2V0YXNpZGUgdG8sIHJlcXVlc3QgcG9vbCBvciBkZWZlcnJlZA0K
PiBwb29sPyAqLw0KPiA+ICsgICAgICAgIGlmIChmLT5yKSB7DQo+ID4gKyAgICAgICAgICAgIHBv
b2wgPSBmLT5yLT5wb29sOw0KPiA+ICsgICAgICAgICAgICBBUFJfQlJJR0FERV9DT05DQVQoZi0+
YmIsIGJiKTsNCj4gPiArICAgICAgICB9DQo+ID4gKyAgICAgICAgZWxzZSB7DQo+ID4gKyAgICAg
ICAgICAgIGlmICghZi0+ZGVmZXJyZWRfcG9vbCkgew0KPiA+ICsgICAgICAgICAgICAgICAgYXBy
X3Bvb2xfY3JlYXRlKCZmLT5kZWZlcnJlZF9wb29sLCBmLT5jLT5wb29sKTsNCj4gPiArICAgICAg
ICAgICAgICAgIGFwcl9wb29sX3RhZyhmLT5kZWZlcnJlZF9wb29sLCAiZGVmZXJyZWRfcG9vbCIp
Ow0KPiA+ICsgICAgICAgICAgICB9DQo+ID4gKyAgICAgICAgICAgIHBvb2wgPSBmLT5kZWZlcnJl
ZF9wb29sOw0KPiA+ICsgICAgICAgICAgICByZXR1cm4gYXBfc2F2ZV9icmlnYWRlKGYsICZmLT5i
YiwgJmJiLCBwb29sKTsNCj4gPiArICAgICAgICB9DQo+IA0KPiBTaG91bGRuJ3QgYXBfc2F2ZV9i
cmlnYWRlKCkgYmUgbW92ZWQgYmVsb3cgdGhlICJlbHNlIj8NCg0KTG9va3MgbGlrZSBpdCBzaG91
bGQsIHBsdXMgcmVtb3ZpbmcgQVBSX0JSSUdBREVfQ09OQ0FUKGYtPmJiLCBiYik7IGFib3ZlLg0K
SSB0aGluayB3ZSBuZWVkIHRvIHNldCBhc2lkZSB0aGUgYnVja2V0cyBvZiBiYiBldmVuIGlmIHdl
IGhhdmUgZi0+ciBhcyBiYiBtYXkNCmNvbnRhaW4gdHJhbnNpZW50IGJ1Y2tldHMuDQoNClJlZ2Fy
ZHMNCg0KUsO8ZGlnZXINCg==

From dev-return-84068-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Tue Oct  6 08:59:25 2015
Return-Path: <dev-return-84068-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 96AEF17730
	for <apmail-httpd-dev-archive@www.apache.org>; Tue,  6 Oct 2015 08:59:25 +0000 (UTC)
Received: (qmail 49611 invoked by uid 500); 6 Oct 2015 08:59:22 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 49539 invoked by uid 500); 6 Oct 2015 08:59:22 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 49529 invoked by uid 99); 6 Oct 2015 08:59:22 -0000
Received: from Unknown (HELO spamd4-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 06 Oct 2015 08:59:22 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd4-us-west.apache.org (ASF Mail Server at spamd4-us-west.apache.org) with ESMTP id A2D21C0419
	for <dev@httpd.apache.org>; Tue,  6 Oct 2015 08:59:21 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd4-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.101
X-Spam-Level:
X-Spam-Status: No, score=-0.101 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RCVD_IN_MSPIKE_H2=-0.001, SPF_PASS=-0.001, URIBL_BLOCKED=0.001]
	autolearn=disabled
Authentication-Results: spamd4-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd4-us-west.apache.org [10.40.0.11]) (amavisd-new, port 10024)
	with ESMTP id k-0_EdNNSCyX for <dev@httpd.apache.org>;
	Tue,  6 Oct 2015 08:59:17 +0000 (UTC)
Received: from mail-qg0-f41.google.com (mail-qg0-f41.google.com [209.85.192.41])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id DC92D206F0
	for <dev@httpd.apache.org>; Tue,  6 Oct 2015 08:59:16 +0000 (UTC)
Received: by qgev79 with SMTP id v79so168466785qge.0
        for <dev@httpd.apache.org>; Tue, 06 Oct 2015 01:59:09 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type:content-transfer-encoding;
        bh=fj+mx3sIqbHLOWdXDURMwZlqPsFCsy9AVw3QjDq16Y4=;
        b=n4zje/kWM154kqh9LZUhYuJCZUyuvEZE1dFEtfh8HiVi8BzUqKqo8rHhK/A59sf0Ra
         CgZNF7cDbV5j//69fIMGCTp8Njk4XOn1BVmq3QkBoN1msZuxCKuw/1YTTAU0W4F4K6cE
         Asm4AbKWrAkrCq9R8I6GUeq5N87QI7cjOGzoGP+o8oDb9Zkh2oOx3xn99QsI4XUJS1XL
         SSNe4fl34gxooi7Brwed6HqIQrHxa+9GJit/yIsV0/I0R4dj9P/PwcikM0PFuhAuqme+
         plqo6093xxG7LW1cyX81CCblXyzmVDajAAmqVP+RHW/sggQOXd9uRhsPV44WV+inGPlj
         7uJw==
MIME-Version: 1.0
X-Received: by 10.140.101.119 with SMTP id t110mr46850431qge.71.1444121949663;
 Tue, 06 Oct 2015 01:59:09 -0700 (PDT)
Received: by 10.55.72.20 with HTTP; Tue, 6 Oct 2015 01:59:09 -0700 (PDT)
In-Reply-To: <AB1691BE05AE7F4992697F2A0835627AC633D4AC@VOEXM10W.internal.vodafone.com>
References: <CAKQ1sVMoxQe=8iAQ=oUSRJhrpy0o8RpJ=+u_CXecw8UbTj_NOg@mail.gmail.com>
	<AB1691BE05AE7F4992697F2A0835627AC633D4AC@VOEXM10W.internal.vodafone.com>
Date: Tue, 6 Oct 2015 10:59:09 +0200
Message-ID: <CAKQ1sVOjka43mZzaR9YWMchsOR2Ent2zEwtxVQtbzb4=Pn9T+Q@mail.gmail.com>
Subject: Re: svn commit: r1706669 - in /httpd/httpd/trunk: ./ include/
 modules/http/ modules/ssl/ server/ server/mpm/event/ server/mpm/motorz/ server/mpm/simple/
From: Yann Ylavic <ylavic.dev@gmail.com>
To: dev@httpd.apache.org
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: quoted-printable

On Tue, Oct 6, 2015 at 9:37 AM, Pl=C3=BCm, R=C3=BCdiger, Vodafone Group
<ruediger.pluem@vodafone.com> wrote:
>
>> From: Yann Ylavic [mailto:ylavic.dev@gmail.com]
>>
>> Also it seems that we leak the hash iterator here (on c->pool).
>
> Why do we leak here? apr_hash_first(NULL, is used. So no new iterator is =
allocated.

Correct, I thought apr_hash_first(NULL, ...) was implicitly using
hash->pool to allocate an iterator, but that's not the case (it's a
struct member).

>> Couldn't we use a (single) linked list for c->filters since
>> ap_filter_t already has a 'next' field?

So using an apr_hash_t is indeed better.

Regards,
Yann.

From dev-return-84069-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Tue Oct  6 09:13:46 2015
Return-Path: <dev-return-84069-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id A01C6177D0
	for <apmail-httpd-dev-archive@www.apache.org>; Tue,  6 Oct 2015 09:13:46 +0000 (UTC)
Received: (qmail 90400 invoked by uid 500); 6 Oct 2015 09:13:19 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 90327 invoked by uid 500); 6 Oct 2015 09:13:19 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 90317 invoked by uid 99); 6 Oct 2015 09:13:19 -0000
Received: from Unknown (HELO spamd2-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 06 Oct 2015 09:13:19 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd2-us-west.apache.org (ASF Mail Server at spamd2-us-west.apache.org) with ESMTP id A2CE81A20CD
	for <dev@httpd.apache.org>; Tue,  6 Oct 2015 09:13:18 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd2-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.101
X-Spam-Level:
X-Spam-Status: No, score=-0.101 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RCVD_IN_MSPIKE_H2=-0.001, SPF_PASS=-0.001, URIBL_BLOCKED=0.001]
	autolearn=disabled
Authentication-Results: spamd2-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd2-us-west.apache.org [10.40.0.9]) (amavisd-new, port 10024)
	with ESMTP id o3ggb1se0IWj for <dev@httpd.apache.org>;
	Tue,  6 Oct 2015 09:13:12 +0000 (UTC)
Received: from mail-qk0-f175.google.com (mail-qk0-f175.google.com [209.85.220.175])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id 56F78439E8
	for <dev@httpd.apache.org>; Tue,  6 Oct 2015 09:13:12 +0000 (UTC)
Received: by qkbi190 with SMTP id i190so62679517qkb.1
        for <dev@httpd.apache.org>; Tue, 06 Oct 2015 02:13:12 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type:content-transfer-encoding;
        bh=dY02N/jHuQMCjuZkjQh9sk2wrwTfd0dQfcl8qd6TU9U=;
        b=Z44fkI0u3nwlr42UO3iUoIr/LyHRHLTE7ATJ7beg55z97Xm4Qd9V9Wx5pDV4BUjm5L
         PS1CAos3K1LrCdVTA0D54hCUFZumfswTedY5vyXJuQwmTWntwenLmS5cYiQCJC7tEczP
         9jJn0Am1aBm1LyFne2rzsPXvibVVjthTf6c+s4vlzTHex4SiRMWhtZc9xy2zdL3X0MZH
         gE1spZNm37n1uQvQAXdXdivDu+GihldGAEhMSnCf1cuLnErXo3aRHq+dPXeTrJ51gFF2
         hp4OhFipXO32By07QG/5TkszhkZJzAVbAV/y5MzxnXC7Nn4bUF+QzmK/fuOkQbSElHCD
         8ebg==
MIME-Version: 1.0
X-Received: by 10.55.56.129 with SMTP id f123mr43673515qka.79.1444122792064;
 Tue, 06 Oct 2015 02:13:12 -0700 (PDT)
Received: by 10.55.72.20 with HTTP; Tue, 6 Oct 2015 02:13:12 -0700 (PDT)
In-Reply-To: <AB1691BE05AE7F4992697F2A0835627AC633D4AC@VOEXM10W.internal.vodafone.com>
References: <CAKQ1sVMoxQe=8iAQ=oUSRJhrpy0o8RpJ=+u_CXecw8UbTj_NOg@mail.gmail.com>
	<AB1691BE05AE7F4992697F2A0835627AC633D4AC@VOEXM10W.internal.vodafone.com>
Date: Tue, 6 Oct 2015 11:13:12 +0200
Message-ID: <CAKQ1sVNpMOH5R2iQxwk2S+VbtnMY8wZZbkoPk=D8cDiZhZej4g@mail.gmail.com>
Subject: Re: svn commit: r1706669 - in /httpd/httpd/trunk: ./ include/
 modules/http/ modules/ssl/ server/ server/mpm/event/ server/mpm/motorz/ server/mpm/simple/
From: Yann Ylavic <ylavic.dev@gmail.com>
To: dev@httpd.apache.org
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: quoted-printable

On Tue, Oct 6, 2015 at 9:37 AM, Pl=C3=BCm, R=C3=BCdiger, Vodafone Group
<ruediger.pluem@vodafone.com> wrote:
>
>> -----Original Message-----
>> From: Yann Ylavic [mailto:ylavic.dev@gmail.com]
>>
>> > Modified: httpd/httpd/trunk/server/mpm/event/event.c
>> > URL:
>> http://svn.apache.org/viewvc/httpd/httpd/trunk/server/mpm/event/event.c?=
re
>> v=3D1706669&r1=3D1706668&r2=3D1706669&view=3Ddiff
>> >
>> =3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D
>> =3D=3D=3D=3D
>> > --- httpd/httpd/trunk/server/mpm/event/event.c (original)
>> > +++ httpd/httpd/trunk/server/mpm/event/event.c Sun Oct  4 10:10:51 201=
5
>> > @@ -1146,19 +1146,38 @@ read_request:
>> >      }
>> >
>> []
>> > +
>> > +        rindex =3D apr_hash_first(NULL, c->filters);
>> > +        while (rindex) {
>> > +            ap_filter_t *f =3D apr_hash_this_val(rindex);
>> > +
>> > +            if (!APR_BRIGADE_EMPTY(f->bb)) {
>> > +
>> > +                rv =3D ap_pass_brigade(f, c->empty);
>> > +                apr_brigade_cleanup(c->empty);
>> > +                if (APR_SUCCESS !=3D rv) {
>> > +                    ap_log_cerror(
>> > +                            APLOG_MARK, APLOG_DEBUG, rv, c,
>> APLOGNO(00470)
>> > +                            "write failure in '%s' output filter", f-
>> >frec->name);
>> > +                    break;
>> > +                }
>> > +
>> > +                if (ap_filter_should_yield(f)) {
>> > +                    data_in_output_filters =3D 1;
>> > +                }
>> > +            }
>> > +
>> > +            rindex =3D apr_hash_next(rindex);
>> >          }
>>
>> This pattern looks shared by all (relevant) MPMs, couldn't we make it
>> a function? Maybe ap_reinstate_conn()?
>
> Sounds sensible.

By defining this function in util_filter
(ap_filter_reinstate_conn()?), we also possibly could get rid of
c->empty (which looks quite hacky), using/hidding an empty brigade per
filter (in opaque data).

Regards,
Yann.

From dev-return-84070-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Tue Oct  6 09:31:54 2015
Return-Path: <dev-return-84070-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 7BBE817857
	for <apmail-httpd-dev-archive@www.apache.org>; Tue,  6 Oct 2015 09:31:54 +0000 (UTC)
Received: (qmail 19928 invoked by uid 500); 6 Oct 2015 09:31:53 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 19863 invoked by uid 500); 6 Oct 2015 09:31:53 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 19852 invoked by uid 99); 6 Oct 2015 09:31:53 -0000
Received: from Unknown (HELO spamd4-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 06 Oct 2015 09:31:53 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd4-us-west.apache.org (ASF Mail Server at spamd4-us-west.apache.org) with ESMTP id 2575BC08D6
	for <dev@httpd.apache.org>; Tue,  6 Oct 2015 09:31:53 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd4-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 1
X-Spam-Level: *
X-Spam-Status: No, score=1 tagged_above=-999 required=6.31
	tests=[KAM_LAZY_DOMAIN_SECURITY=1, SPF_HELO_PASS=-0.001,
	URIBL_BLOCKED=0.001] autolearn=disabled
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd4-us-west.apache.org [10.40.0.11]) (amavisd-new, port 10024)
	with ESMTP id 5hDSI5a3PYw5 for <dev@httpd.apache.org>;
	Tue,  6 Oct 2015 09:31:42 +0000 (UTC)
Received: from mail1.bemta14.messagelabs.com (mail1.bemta14.messagelabs.com [193.109.254.109])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id C72BC201F9
	for <dev@httpd.apache.org>; Tue,  6 Oct 2015 09:31:41 +0000 (UTC)
Received: from [193.109.254.3] by server-5.bemta-14.messagelabs.com id 48/D9-00475-7F493165; Tue, 06 Oct 2015 09:31:35 +0000
X-Env-Sender: ruediger.pluem@vodafone.com
X-Msg-Ref: server-12.tower-184.messagelabs.com!1444123889!24815842!1
X-Originating-IP: [195.232.244.134]
X-StarScan-Received:
X-StarScan-Version: 6.13.16; banners=-,-,-
X-VirusChecked: Checked
Received: (qmail 17103 invoked from network); 6 Oct 2015 09:31:30 -0000
Received: from mailout02.vodafone.com (HELO mailout02.vodafone.com) (195.232.244.134)
  by server-12.tower-184.messagelabs.com with DHE-RSA-AES256-SHA encrypted SMTP; 6 Oct 2015 09:31:30 -0000
Received: from mailint02.vodafone.com (mailint02.vodafone.com [195.232.244.199])
	by mailout02.vodafone.com (Postfix) with ESMTP id 3nVYTF41fszbdMh
	for <dev@httpd.apache.org>; Tue,  6 Oct 2015 11:31:29 +0200 (CEST)
Received: from mailint02.vodafone.com (localhost [127.0.0.1])
	by mailint02.vodafone.com (Postfix) with ESMTP id 3nVYTF2pzGzQjWS
	for <dev@httpd.apache.org>; Tue,  6 Oct 2015 11:31:29 +0200 (CEST)
Received: from VOEXC02W.internal.vodafone.com (voexc02w.dc-ratingen.de [145.230.101.22])
	(using TLSv1 with cipher AES128-SHA (128/128 bits))
	(No client certificate requested)
	by mailint02.vodafone.com (Postfix) with ESMTPS id 3nVYTF2ls2zQnlP
	for <dev@httpd.apache.org>; Tue,  6 Oct 2015 11:31:29 +0200 (CEST)
Received: from VOEXC24W.internal.vodafone.com (145.230.103.196) by
 VOEXC02W.internal.vodafone.com (145.230.101.22) with Microsoft SMTP Server
 (TLS) id 14.3.224.2; Tue, 6 Oct 2015 11:31:28 +0200
Received: from VOEXM10W.internal.vodafone.com ([169.254.2.88]) by voexc24w
 ([145.230.103.196]) with mapi id 14.03.0224.002; Tue, 6 Oct 2015 11:31:20
 +0200
From: =?utf-8?B?UGzDvG0sIFLDvGRpZ2VyLCBWb2RhZm9uZSBHcm91cA==?=
	<ruediger.pluem@vodafone.com>
To: "dev@httpd.apache.org" <dev@httpd.apache.org>
Subject: RE: svn commit: r1706669 - in /httpd/httpd/trunk: ./ include/
 modules/http/ modules/ssl/ server/ server/mpm/event/ server/mpm/motorz/
 server/mpm/simple/
Thread-Topic: svn commit: r1706669 - in /httpd/httpd/trunk: ./ include/
 modules/http/ modules/ssl/ server/ server/mpm/event/ server/mpm/motorz/
 server/mpm/simple/
Thread-Index: AQHQ/8ce27K9fyvABE+g5rr0X8c32p5eD7UQ///9qACAACUlQA==
Date: Tue, 6 Oct 2015 09:31:19 +0000
Message-ID: <AB1691BE05AE7F4992697F2A0835627AC633D7D2@VOEXM10W.internal.vodafone.com>
References: <CAKQ1sVMoxQe=8iAQ=oUSRJhrpy0o8RpJ=+u_CXecw8UbTj_NOg@mail.gmail.com>
	<AB1691BE05AE7F4992697F2A0835627AC633D4AC@VOEXM10W.internal.vodafone.com>
 <CAKQ1sVNpMOH5R2iQxwk2S+VbtnMY8wZZbkoPk=D8cDiZhZej4g@mail.gmail.com>
In-Reply-To: <CAKQ1sVNpMOH5R2iQxwk2S+VbtnMY8wZZbkoPk=D8cDiZhZej4g@mail.gmail.com>
Accept-Language: en-US
Content-Language: en-US
X-MS-Has-Attach:
X-MS-TNEF-Correlator:
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
MIME-Version: 1.0

DQoNCj4gLS0tLS1PcmlnaW5hbCBNZXNzYWdlLS0tLS0NCj4gRnJvbTogWWFubiBZbGF2aWMgW21h
aWx0bzp5bGF2aWMuZGV2QGdtYWlsLmNvbV0NCj4gU2VudDogRGllbnN0YWcsIDYuIE9rdG9iZXIg
MjAxNSAxMToxMw0KPiBUbzogZGV2QGh0dHBkLmFwYWNoZS5vcmcNCj4gU3ViamVjdDogUmU6IHN2
biBjb21taXQ6IHIxNzA2NjY5IC0gaW4gL2h0dHBkL2h0dHBkL3RydW5rOiAuLyBpbmNsdWRlLw0K
PiBtb2R1bGVzL2h0dHAvIG1vZHVsZXMvc3NsLyBzZXJ2ZXIvIHNlcnZlci9tcG0vZXZlbnQvIHNl
cnZlci9tcG0vbW90b3J6Lw0KPiBzZXJ2ZXIvbXBtL3NpbXBsZS8NCj4gDQo+IE9uIFR1ZSwgT2N0
IDYsIDIwMTUgYXQgOTozNyBBTSwgUGzDvG0sIFLDvGRpZ2VyLCBWb2RhZm9uZSBHcm91cA0KPiA8
cnVlZGlnZXIucGx1ZW1Adm9kYWZvbmUuY29tPiB3cm90ZToNCj4gPg0KPiA+PiAtLS0tLU9yaWdp
bmFsIE1lc3NhZ2UtLS0tLQ0KPiA+PiBGcm9tOiBZYW5uIFlsYXZpYyBbbWFpbHRvOnlsYXZpYy5k
ZXZAZ21haWwuY29tXQ0KPiA+Pg0KPiA+PiA+IE1vZGlmaWVkOiBodHRwZC9odHRwZC90cnVuay9z
ZXJ2ZXIvbXBtL2V2ZW50L2V2ZW50LmMNCj4gPj4gPiBVUkw6DQo+ID4+DQo+IGh0dHA6Ly9zdm4u
YXBhY2hlLm9yZy92aWV3dmMvaHR0cGQvaHR0cGQvdHJ1bmsvc2VydmVyL21wbS9ldmVudC9ldmVu
dC5jP3JlDQo+ID4+IHY9MTcwNjY2OSZyMT0xNzA2NjY4JnIyPTE3MDY2Njkmdmlldz1kaWZmDQo+
ID4+ID4NCj4gPj4NCj4gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0NCj4gPj4gPT09PQ0KPiA+PiA+IC0tLSBo
dHRwZC9odHRwZC90cnVuay9zZXJ2ZXIvbXBtL2V2ZW50L2V2ZW50LmMgKG9yaWdpbmFsKQ0KPiA+
PiA+ICsrKyBodHRwZC9odHRwZC90cnVuay9zZXJ2ZXIvbXBtL2V2ZW50L2V2ZW50LmMgU3VuIE9j
dCAgNCAxMDoxMDo1MQ0KPiAyMDE1DQo+ID4+ID4gQEAgLTExNDYsMTkgKzExNDYsMzggQEAgcmVh
ZF9yZXF1ZXN0Og0KPiA+PiA+ICAgICAgfQ0KPiA+PiA+DQo+ID4+IFtdDQo+ID4+ID4gKw0KPiA+
PiA+ICsgICAgICAgIHJpbmRleCA9IGFwcl9oYXNoX2ZpcnN0KE5VTEwsIGMtPmZpbHRlcnMpOw0K
PiA+PiA+ICsgICAgICAgIHdoaWxlIChyaW5kZXgpIHsNCj4gPj4gPiArICAgICAgICAgICAgYXBf
ZmlsdGVyX3QgKmYgPSBhcHJfaGFzaF90aGlzX3ZhbChyaW5kZXgpOw0KPiA+PiA+ICsNCj4gPj4g
PiArICAgICAgICAgICAgaWYgKCFBUFJfQlJJR0FERV9FTVBUWShmLT5iYikpIHsNCj4gPj4gPiAr
DQo+ID4+ID4gKyAgICAgICAgICAgICAgICBydiA9IGFwX3Bhc3NfYnJpZ2FkZShmLCBjLT5lbXB0
eSk7DQo+ID4+ID4gKyAgICAgICAgICAgICAgICBhcHJfYnJpZ2FkZV9jbGVhbnVwKGMtPmVtcHR5
KTsNCj4gPj4gPiArICAgICAgICAgICAgICAgIGlmIChBUFJfU1VDQ0VTUyAhPSBydikgew0KPiA+
PiA+ICsgICAgICAgICAgICAgICAgICAgIGFwX2xvZ19jZXJyb3IoDQo+ID4+ID4gKyAgICAgICAg
ICAgICAgICAgICAgICAgICAgICBBUExPR19NQVJLLCBBUExPR19ERUJVRywgcnYsIGMsDQo+ID4+
IEFQTE9HTk8oMDA0NzApDQo+ID4+ID4gKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAid3Jp
dGUgZmFpbHVyZSBpbiAnJXMnIG91dHB1dCBmaWx0ZXIiLA0KPiBmLQ0KPiA+PiA+ZnJlYy0+bmFt
ZSk7DQo+ID4+ID4gKyAgICAgICAgICAgICAgICAgICAgYnJlYWs7DQo+ID4+ID4gKyAgICAgICAg
ICAgICAgICB9DQo+ID4+ID4gKw0KPiA+PiA+ICsgICAgICAgICAgICAgICAgaWYgKGFwX2ZpbHRl
cl9zaG91bGRfeWllbGQoZikpIHsNCj4gPj4gPiArICAgICAgICAgICAgICAgICAgICBkYXRhX2lu
X291dHB1dF9maWx0ZXJzID0gMTsNCj4gPj4gPiArICAgICAgICAgICAgICAgIH0NCj4gPj4gPiAr
ICAgICAgICAgICAgfQ0KPiA+PiA+ICsNCj4gPj4gPiArICAgICAgICAgICAgcmluZGV4ID0gYXBy
X2hhc2hfbmV4dChyaW5kZXgpOw0KPiA+PiA+ICAgICAgICAgIH0NCj4gPj4NCj4gPj4gVGhpcyBw
YXR0ZXJuIGxvb2tzIHNoYXJlZCBieSBhbGwgKHJlbGV2YW50KSBNUE1zLCBjb3VsZG4ndCB3ZSBt
YWtlIGl0DQo+ID4+IGEgZnVuY3Rpb24/IE1heWJlIGFwX3JlaW5zdGF0ZV9jb25uKCk/DQo+ID4N
Cj4gPiBTb3VuZHMgc2Vuc2libGUuDQo+IA0KPiBCeSBkZWZpbmluZyB0aGlzIGZ1bmN0aW9uIGlu
IHV0aWxfZmlsdGVyDQo+IChhcF9maWx0ZXJfcmVpbnN0YXRlX2Nvbm4oKT8pLCB3ZSBhbHNvIHBv
c3NpYmx5IGNvdWxkIGdldCByaWQgb2YNCj4gYy0+ZW1wdHkgKHdoaWNoIGxvb2tzIHF1aXRlIGhh
Y2t5KSwgdXNpbmcvaGlkZGluZyBhbiBlbXB0eSBicmlnYWRlIHBlcg0KPiBmaWx0ZXIgKGluIG9w
YXF1ZSBkYXRhKS4NCg0KQWx0aG91Z2ggdGhlIGJyaWdhZGUgaXMgZW1wdHksIGRvbid0IHdlIG5l
ZWQgdG8gcHJldmVudCB0aGUgYnJpZ2FkZSBiZWluZyB1c2VkIGJ5IG11bHRpcGxlIHRocmVhZHMg
aW4gcGFyYWxsZWw/DQpVc2luZyBvbmUgcGVyIGNvbm5lY3Rpb24gcHJldmVudHMgdGhpcy4NCg0K
UmVnYXJkcw0KDQpSw7xkaWdlcg0KDQo=

From dev-return-84071-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Tue Oct  6 09:56:22 2015
Return-Path: <dev-return-84071-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id DF93917916
	for <apmail-httpd-dev-archive@www.apache.org>; Tue,  6 Oct 2015 09:56:22 +0000 (UTC)
Received: (qmail 91911 invoked by uid 500); 6 Oct 2015 09:56:16 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 91842 invoked by uid 500); 6 Oct 2015 09:56:16 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 91828 invoked by uid 99); 6 Oct 2015 09:56:16 -0000
Received: from Unknown (HELO spamd4-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 06 Oct 2015 09:56:16 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd4-us-west.apache.org (ASF Mail Server at spamd4-us-west.apache.org) with ESMTP id A523DC0FB3
	for <dev@httpd.apache.org>; Tue,  6 Oct 2015 09:56:15 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd4-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.011
X-Spam-Level:
X-Spam-Status: No, score=-0.011 tagged_above=-999 required=6.31
	tests=[SPF_PASS=-0.001, T_RP_MATCHES_RCVD=-0.01] autolearn=disabled
Received: from mx1-us-west.apache.org ([10.40.0.8])
	by localhost (spamd4-us-west.apache.org [10.40.0.11]) (amavisd-new, port 10024)
	with ESMTP id tp5BGErxikFc for <dev@httpd.apache.org>;
	Tue,  6 Oct 2015 09:56:13 +0000 (UTC)
Received: from mailserver.kippdata.de (capsella.kippdata.de [195.227.30.149])
	by mx1-us-west.apache.org (ASF Mail Server at mx1-us-west.apache.org) with ESMTP id 42BD2210B9
	for <dev@httpd.apache.org>; Tue,  6 Oct 2015 09:56:12 +0000 (UTC)
Received: from [195.227.30.209] (notebook-rj [195.227.30.209])
	by mailserver.kippdata.de (8.13.5/8.13.5) with ESMTP id t969u5p1021511
	for <dev@httpd.apache.org>; Tue, 6 Oct 2015 11:56:05 +0200 (CEST)
Subject: Re: Supporting "SSL:" in the expression parser via mod_ssl
To: dev@httpd.apache.org
References: <560C5386.1030700@kippdata.de> <3128045.1Bge59dzo2@k>
From: Rainer Jung <rainer.jung@kippdata.de>
Message-ID: <56139AAF.3040706@kippdata.de>
Date: Tue, 6 Oct 2015 11:55:59 +0200
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:38.0) Gecko/20100101
 Thunderbird/38.3.0
MIME-Version: 1.0
In-Reply-To: <3128045.1Bge59dzo2@k>
Content-Type: text/plain; charset=utf-8; format=flowed
Content-Transfer-Encoding: 7bit

Am 06.10.2015 um 00:44 schrieb Stefan Fritsch:
> On Wednesday 30 September 2015 23:26:30, Rainer Jung wrote:
>> I noticed that currently the expression parser in 2.4/trunk does not
>> support the SSL:VARIABLE lookups that mod_rewrite supports.
>>
>> The expression parser uses ":" as an alternative function call
>> syntax, so HTTP:VARIABLE is the same as HTTP(VARIABLE) which in
>> turn executes http(VARIABLE). The same is true for ENV:VARIABLE
>> which maps to env(VARIABLE) etc.
>>
>> We already do support the syntax SSL_VARIABLE to look up SSL
>> variables, because mod_ssl registers in the expression parser for
>> variables whose name starts with "SSL_". But mod_ssl does not
>> register for a function named SSL (or ssl), so the SSL: notation
>> does not work.
>>
>> Is that just an omission, or was that intentional? If not
>> intentional, I would apply the following (yet untested) simple
>> patch to trunk mod_ssl and propose for backport. It registers the
>> SSL (and ssl) function in the expression parser:
>
> I think that was just an omission. +1 to your patch.

I tested it an it would work, but one implementation detail remains to 
discuss. The %{SSL:variable} syntax goes back to mod_rewrite. There 
"variable" is the full name of the mod_ssl variable, i.e.

    %{SSL:SSL_PROTOCOL}

mod_rewrite looked up varname by calling ssl_var_lookup() which itself 
resolves lots of variables, even many non-ssl ones. In the ssl case it 
quickly falls through and then strips the "SSL_" prefix and calls 
ssl_var_lookup_ssl().

For 2.4 and the nes %{SSL:variable} impl in the expr parser we have 
three options:

1) Support only variable name with the "SSL_" prefix already stripped 
and call ssl_var_lookup_ssl().

Example: %{SSL:PROTOCOL}

There's less redundancy in the notation, but it is incompatible with 
mod_rewrite's use of %{SSL:variable}. Therefore I'd say it is too 
confusing and would be -1 to this option.

2) Demand including the "SSL_" prefix in the variable name, strip it 
when resolving the value and call ssl_var_lookup_ssl() for the shortened 
name. Throw error if the variable name does not start with "SSL_".

Example: %{SSL:SSL_PROTOCOL}

This is compatible with mod_rewrite, but only as long as you really use 
a variable whose name begins with "SSL_". I guess mostly this will be 
the case, but people might have used e.g. %{SSL:HTTPS}, which would now 
throw an error.

3) Support any mod_ssl variable. Demand using the original full name and 
call ssl_var_lookup() with the full name.

Example: %{SSL:SSL_PROTOCOL}

This is the most compatible and complete solution. The only drawback is 
the use of ssl_var_lookup() which adds a bit of overhead for the general 
case and itself seems to be a candidate for long term replacement by 
ap_expr. At that point in the future it would bite us to let ap_expr 
base its SSL: implementation on a function, that could be replaced by 
ap_expr itself (and ssl_var_lookup_ssl()). Nevertheless I would vote for 
3) as the solution to chose.

I will commit 3) but are very open to other opinions before suggesting a 
backport.

Regards,

Rainer

From dev-return-84072-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Tue Oct  6 10:07:27 2015
Return-Path: <dev-return-84072-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 499F517988
	for <apmail-httpd-dev-archive@www.apache.org>; Tue,  6 Oct 2015 10:07:27 +0000 (UTC)
Received: (qmail 9136 invoked by uid 500); 6 Oct 2015 10:07:17 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 9058 invoked by uid 500); 6 Oct 2015 10:07:17 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 9048 invoked by uid 99); 6 Oct 2015 10:07:17 -0000
Received: from Unknown (HELO spamd2-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 06 Oct 2015 10:07:17 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd2-us-west.apache.org (ASF Mail Server at spamd2-us-west.apache.org) with ESMTP id D111C1A20BE
	for <dev@httpd.apache.org>; Tue,  6 Oct 2015 10:07:16 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd2-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.12
X-Spam-Level:
X-Spam-Status: No, score=-0.12 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RCVD_IN_MSPIKE_H3=-0.01, RCVD_IN_MSPIKE_WL=-0.01, SPF_PASS=-0.001,
	URIBL_BLOCKED=0.001] autolearn=disabled
Authentication-Results: spamd2-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd2-us-west.apache.org [10.40.0.9]) (amavisd-new, port 10024)
	with ESMTP id y_GMDp2GODnl for <dev@httpd.apache.org>;
	Tue,  6 Oct 2015 10:07:12 +0000 (UTC)
Received: from mail-qk0-f177.google.com (mail-qk0-f177.google.com [209.85.220.177])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id E7F80439ED
	for <dev@httpd.apache.org>; Tue,  6 Oct 2015 10:07:11 +0000 (UTC)
Received: by qkcf65 with SMTP id f65so83359980qkc.3
        for <dev@httpd.apache.org>; Tue, 06 Oct 2015 03:07:05 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        bh=Q76tFPML2f/fAU7NdCS8IRyZYejZMp+RhFjdqTKc5n8=;
        b=Hu0/7oX8Tc6ztgujlunEQlVej5gOu56OmI57iD+9w1KPx1D/uz2oHe9pFYWWoBwmiM
         BLW4B9/ubkai2YDl+rVTIKJbajQROpSfaCkpkvJMuQWimnq+UHqbXfPbb8oOAb2oRBfT
         R6PwPLJsey3d/TXD+n0/6dDxzohCzqupohBkWRM24lgP1iVWtg4Ng4CcWCMcmwkqevJJ
         TZh4VvQCchwElv1QrZ6CTkzyoAOzwNMBBKX2wIaqWAUUU6IhQhTHfn9AWgyRUthrl8xt
         AxD0vL7Qj+lyPv4pfc0sR5eGlNthjUAYOOqQl3TG/xGluZC04S4bV/NGgiTXjuPelzwC
         92Bg==
MIME-Version: 1.0
X-Received: by 10.55.192.15 with SMTP id o15mr23296855qki.2.1444126025694;
 Tue, 06 Oct 2015 03:07:05 -0700 (PDT)
Received: by 10.55.72.20 with HTTP; Tue, 6 Oct 2015 03:07:05 -0700 (PDT)
In-Reply-To: <56139AAF.3040706@kippdata.de>
References: <560C5386.1030700@kippdata.de>
	<3128045.1Bge59dzo2@k>
	<56139AAF.3040706@kippdata.de>
Date: Tue, 6 Oct 2015 12:07:05 +0200
Message-ID: <CAKQ1sVMQvF=hTAUzBYx_9BKpihBu+4obMiigkoPtHxAiz_8WiA@mail.gmail.com>
Subject: Re: Supporting "SSL:" in the expression parser via mod_ssl
From: Yann Ylavic <ylavic.dev@gmail.com>
To: dev@httpd.apache.org
Content-Type: text/plain; charset=UTF-8

On Tue, Oct 6, 2015 at 11:55 AM, Rainer Jung <rainer.jung@kippdata.de> wrote:
>
> I will commit 3) but are very open to other opinions before suggesting a
> backport.

+1

Regards,
Yann.

From dev-return-84073-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Tue Oct  6 10:12:57 2015
Return-Path: <dev-return-84073-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 1BB05179C7
	for <apmail-httpd-dev-archive@www.apache.org>; Tue,  6 Oct 2015 10:12:57 +0000 (UTC)
Received: (qmail 24479 invoked by uid 500); 6 Oct 2015 10:12:56 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 24393 invoked by uid 500); 6 Oct 2015 10:12:56 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 24375 invoked by uid 99); 6 Oct 2015 10:12:56 -0000
Received: from Unknown (HELO spamd2-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 06 Oct 2015 10:12:56 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd2-us-west.apache.org (ASF Mail Server at spamd2-us-west.apache.org) with ESMTP id 0C4281A2048
	for <dev@httpd.apache.org>; Tue,  6 Oct 2015 10:12:56 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd2-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 1
X-Spam-Level: *
X-Spam-Status: No, score=1 tagged_above=-999 required=6.31
	tests=[KAM_LAZY_DOMAIN_SECURITY=1, SPF_HELO_PASS=-0.001,
	URIBL_BLOCKED=0.001] autolearn=disabled
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd2-us-west.apache.org [10.40.0.9]) (amavisd-new, port 10024)
	with ESMTP id oQkubicb0VAv for <dev@httpd.apache.org>;
	Tue,  6 Oct 2015 10:12:45 +0000 (UTC)
Received: from mail1.bemta5.messagelabs.com (mail1.bemta5.messagelabs.com [195.245.231.140])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id 9E85225672
	for <dev@httpd.apache.org>; Tue,  6 Oct 2015 10:12:44 +0000 (UTC)
Received: from [85.158.136.83] by server-4.bemta-5.messagelabs.com id 3C/A6-24856-69E93165; Tue, 06 Oct 2015 10:12:38 +0000
X-Env-Sender: ruediger.pluem@vodafone.com
X-Msg-Ref: server-12.tower-36.messagelabs.com!1444126358!27010666!1
X-Originating-IP: [195.232.244.134]
X-StarScan-Received:
X-StarScan-Version: 6.13.16; banners=-,-,-
X-VirusChecked: Checked
Received: (qmail 5495 invoked from network); 6 Oct 2015 10:12:38 -0000
Received: from mailout02.vodafone.com (HELO mailout02.vodafone.com) (195.232.244.134)
  by server-12.tower-36.messagelabs.com with DHE-RSA-AES256-SHA encrypted SMTP; 6 Oct 2015 10:12:38 -0000
Received: from mailint03.vodafone.com (mailint03.vodafone.com [195.232.244.200])
	by mailout02.vodafone.com (Postfix) with ESMTP id 3nVZNk2slSzbdMX
	for <dev@httpd.apache.org>; Tue,  6 Oct 2015 12:12:38 +0200 (CEST)
Received: from mailint03.vodafone.com (localhost [127.0.0.1])
	by mailint03.vodafone.com (Postfix) with ESMTP id 3nVZNk1nL4z16LCD
	for <dev@httpd.apache.org>; Tue,  6 Oct 2015 12:12:38 +0200 (CEST)
Received: from VOEXC02W.internal.vodafone.com (voexc02w.dc-ratingen.de [145.230.101.22])
	(using TLSv1 with cipher AES128-SHA (128/128 bits))
	(No client certificate requested)
	by mailint03.vodafone.com (Postfix) with ESMTPS id 3nVZNk1S9Bz16LKH
	for <dev@httpd.apache.org>; Tue,  6 Oct 2015 12:12:38 +0200 (CEST)
Received: from AVOEXH03W.internal.vodafone.com (145.230.15.141) by
 VOEXC02W.internal.vodafone.com (145.230.101.22) with Microsoft SMTP Server
 (TLS) id 14.3.224.2; Tue, 6 Oct 2015 12:12:38 +0200
Received: from VOEXM10W.internal.vodafone.com ([169.254.2.88]) by
 AVOEXH03W.internal.vodafone.com ([145.230.15.141]) with mapi id
 14.03.0224.002; Tue, 6 Oct 2015 12:12:28 +0200
From: =?utf-8?B?UGzDvG0sIFLDvGRpZ2VyLCBWb2RhZm9uZSBHcm91cA==?=
	<ruediger.pluem@vodafone.com>
To: "dev@httpd.apache.org" <dev@httpd.apache.org>
Subject: RE: Supporting "SSL:" in the expression parser via mod_ssl
Thread-Topic: Supporting "SSL:" in the expression parser via mod_ssl
Thread-Index: AQHQ+8a2YrUN4JzlR0GZ4nmXQbuUSZ5dZZkAgAC7uYCAAAMagIAAIvsA
Date: Tue, 6 Oct 2015 10:12:27 +0000
Message-ID: <AB1691BE05AE7F4992697F2A0835627AC633D865@VOEXM10W.internal.vodafone.com>
References: <560C5386.1030700@kippdata.de>	<3128045.1Bge59dzo2@k>
	<56139AAF.3040706@kippdata.de>
 <CAKQ1sVMQvF=hTAUzBYx_9BKpihBu+4obMiigkoPtHxAiz_8WiA@mail.gmail.com>
In-Reply-To: <CAKQ1sVMQvF=hTAUzBYx_9BKpihBu+4obMiigkoPtHxAiz_8WiA@mail.gmail.com>
Accept-Language: en-US
Content-Language: en-US
X-MS-Has-Attach:
X-MS-TNEF-Correlator:
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
MIME-Version: 1.0

KzEgDQoNClJlZ2FyZHMNCg0KUsO8ZGlnZXINCg0KPiAtLS0tLU9yaWdpbmFsIE1lc3NhZ2UtLS0t
LQ0KPiBGcm9tOiBZYW5uIFlsYXZpYyBbbWFpbHRvOnlsYXZpYy5kZXZAZ21haWwuY29tXQ0KPiBT
ZW50OiBEaWVuc3RhZywgNi4gT2t0b2JlciAyMDE1IDEyOjA3DQo+IFRvOiBkZXZAaHR0cGQuYXBh
Y2hlLm9yZw0KPiBTdWJqZWN0OiBSZTogU3VwcG9ydGluZyAiU1NMOiIgaW4gdGhlIGV4cHJlc3Np
b24gcGFyc2VyIHZpYSBtb2Rfc3NsDQo+IA0KPiBPbiBUdWUsIE9jdCA2LCAyMDE1IGF0IDExOjU1
IEFNLCBSYWluZXIgSnVuZyA8cmFpbmVyLmp1bmdAa2lwcGRhdGEuZGU+DQo+IHdyb3RlOg0KPiA+
DQo+ID4gSSB3aWxsIGNvbW1pdCAzKSBidXQgYXJlIHZlcnkgb3BlbiB0byBvdGhlciBvcGluaW9u
cyBiZWZvcmUgc3VnZ2VzdGluZyBhDQo+ID4gYmFja3BvcnQuDQo+IA0KPiArMQ0KPiANCj4gUmVn
YXJkcywNCj4gWWFubi4NCg==

From dev-return-84074-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Tue Oct  6 10:16:15 2015
Return-Path: <dev-return-84074-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id F2EBA17A02
	for <apmail-httpd-dev-archive@www.apache.org>; Tue,  6 Oct 2015 10:16:15 +0000 (UTC)
Received: (qmail 37706 invoked by uid 500); 6 Oct 2015 10:15:41 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 37637 invoked by uid 500); 6 Oct 2015 10:15:41 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 37627 invoked by uid 99); 6 Oct 2015 10:15:41 -0000
Received: from Unknown (HELO spamd2-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 06 Oct 2015 10:15:41 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd2-us-west.apache.org (ASF Mail Server at spamd2-us-west.apache.org) with ESMTP id D9C831A2083
	for <dev@httpd.apache.org>; Tue,  6 Oct 2015 10:15:40 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd2-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.011
X-Spam-Level:
X-Spam-Status: No, score=-0.011 tagged_above=-999 required=6.31
	tests=[SPF_PASS=-0.001, T_RP_MATCHES_RCVD=-0.01] autolearn=disabled
Received: from mx1-us-west.apache.org ([10.40.0.8])
	by localhost (spamd2-us-west.apache.org [10.40.0.9]) (amavisd-new, port 10024)
	with ESMTP id FE8vadjs8fs9 for <dev@httpd.apache.org>;
	Tue,  6 Oct 2015 10:15:39 +0000 (UTC)
Received: from monica.sharp.fm (monica.sharp.fm [80.168.143.5])
	by mx1-us-west.apache.org (ASF Mail Server at mx1-us-west.apache.org) with ESMTP id C433121270
	for <dev@httpd.apache.org>; Tue,  6 Oct 2015 10:15:38 +0000 (UTC)
Received: from hgslapmb-h06477.hogarthww.prv (unknown [5.56.169.82])
	(using TLSv1 with cipher DHE-RSA-AES256-SHA (256/256 bits))
	(Client did not present a certificate)
	(Authenticated sender: minfrin@sharp.fm)
	by monica.sharp.fm (Postfix) with ESMTPSA id 9BCB0830F8
	for <dev@httpd.apache.org>; Tue,  6 Oct 2015 11:15:37 +0100 (BST)
Content-Type: text/plain; charset=utf-8
Mime-Version: 1.0 (Mac OS X Mail 8.2 \(2104\))
Subject: Re: svn commit: r1706669 - in /httpd/httpd/trunk: ./ include/ modules/http/ modules/ssl/ server/ server/mpm/event/ server/mpm/motorz/ server/mpm/simple/
From: Graham Leggett <minfrin@sharp.fm>
In-Reply-To: <CAKQ1sVMoxQe=8iAQ=oUSRJhrpy0o8RpJ=+u_CXecw8UbTj_NOg@mail.gmail.com>
Date: Tue, 6 Oct 2015 12:15:35 +0200
Content-Transfer-Encoding: quoted-printable
Message-Id: <2791C826-8CFB-4DC9-B6AF-566DF625B154@sharp.fm>
References: <CAKQ1sVMoxQe=8iAQ=oUSRJhrpy0o8RpJ=+u_CXecw8UbTj_NOg@mail.gmail.com>
To: dev@httpd.apache.org
X-Mailer: Apple Mail (2.2104)

On 06 Oct 2015, at 1:39 AM, Yann Ylavic <ylavic.dev@gmail.com> wrote:

>> +
>> +    /** Buffered data associated with the current filter. */
>> +    apr_bucket_brigade *bb;
>> +
>> +    /** Dedicated pool to use for deferred writes. */
>> +    apr_pool_t *deferred_pool;
>=20
> Could we make these opaque, eg:
>=20
> # util_filter.h:
> struct ap_filter_data;
> struct ap_filter_t {
>    ...
>    struct ap_filter_data *data;
> };
>=20
> # util_filter.c:
> struct ap_filter_data
> {
>   /** Buffered data associated with the current filter. */
>   apr_bucket_brigade *bb;
>=20
>   /** Dedicated pool to use for deferred writes. */
>   apr_pool_t *deferred_pool;
> };
>=20
> This would prevent them from being mangled anywhere (they are
> internals to util_filter.c anyway).

There weren=E2=80=99t originally internal to util_filter.c, it=E2=80=99s =
only subsequently turned out that way. Doing that comes at a cost of a =
further 8 bytes per filter per request through, which starts adding up.

I would rather finish the filter suspension work before doing any =
optimising like this, it=E2=80=99s too soon at this stage.

> It could also possibly avoid walking the brigade for every
> ap_filter_reinstate_brigade() call=E2=80=A6

Unfortunately you can=E2=80=99t avoid walking the brigade in the =
ap_filter_reinstate_brigade(), as this is the flow control logic that =
keeps the server safe from consuming too much data.

Fortunately this loop only really does anything at the bottleneck point =
in the filter stack, which is typically the first filter that does any =
meaningful work. After this point buckets come down the filter stack one =
bucket at a time, and the loop becomes one big if statement for =
subsequent filters.

> This pattern looks shared by all (relevant) MPMs, couldn't we make it
> a function? Maybe ap_reinstate_conn()?

Eventually yes.

For reasons I wasn=E2=80=99t sure of, each MPM was subtly different to =
the next in this loop. I want to first investigate why they work =
differently before baking this behaviour in.

I also want to solve the filter suspend problem before trying to =
optimise like this.

> Also it seems that we leak the hash iterator here (on c->pool).

We don=E2=80=99t, when you create an iterator with a NULL pool it uses =
an iterator internal to the hash. If we passed c->pool to =
apr_hash_first(), we would leak.

> Couldn't we use a (single) linked list for c->filters since
> ap_filter_t already has a 'next' field?

We can=E2=80=99t alas, as c->filters is not a linked list but rather a =
set.

Most specifically, it is the set of filters that have set aside data. =
Setting aside data is optional, some filters will elect not to do so, =
and synchronous filters will definitely not do so.

Filters in this set are eligible for being kicked. If you=E2=80=99re not =
in the set, you get left alone.

>> @@ -635,7 +653,8 @@ AP_DECLARE(apr_status_t) ap_save_brigade
>>     apr_status_t rv, srv =3D APR_SUCCESS;
>>=20
>>     /* If have never stored any data in the filter, then we had =
better
>> -     * create an empty bucket brigade so that we can concat.
>> +     * create an empty bucket brigade so that we can concat. =
Register
>> +     * a cleanup to zero out the pointer if the pool is cleared.
>=20
> Maybe this comment belongs in ap_filter_setaside_brigade()?

Will check.

>> +static apr_status_t filters_cleanup(void *data)
>> +{
>> +    ap_filter_t **key =3D data;
>> +
>> +    apr_hash_set((*key)->c->filters, key, sizeof(ap_filter_t **), =
NULL);
>> +
>> +    return APR_SUCCESS;
>> +}
>=20
> Shouldn't we call filters_cleanup() from ap_remove_output_filter() =
too?

I deliberately decided not to.

The majority of calls to ap_remove_output_filter() are made when filters =
step out the way before data starts flowing, and if we tried to run the =
cleanup we=E2=80=99d be performing an unnecessary apr_hash_set() on =
every invocation before the filter was ever added to the hash.

The point at which it would make a difference is after the EOS bucket is =
handled, but at this point it doesn=E2=80=99t matter, all we=E2=80=99re =
doing is saving one NULL check in the MPM on a loop with a handful of =
iterations, it=E2=80=99s not worth the expense.

> Why not simply use:
>   key =3D apr_pmemdup(pool, &f, sizeof f);
>   apr_hash_set(f->c->filters, &key, sizeof key, f)
> here, and:
>   ap_filter_t *f =3D data;
>   apr_hash_set(f->c->filters, &f, sizeof f, NULL);
> in filters_cleanup() above?

We could but it=E2=80=99s more expensive. The memdup part is replaced by =
simply assigning a pointer.

> The linked list could possibly be simpler here too (using the 'next' =
field).
> Above filters_cleanup() would have to start from the beginning of the
> list each time to remove the entries, though.

As described above, this is a set, not a linked list.

>> +        /* decide what pool we setaside to, request pool or deferred =
pool? */
>> +        if (f->r) {
>> +            pool =3D f->r->pool;
>> +            APR_BRIGADE_CONCAT(f->bb, bb);
>> +        }
>> +        else {
>> +            if (!f->deferred_pool) {
>> +                apr_pool_create(&f->deferred_pool, f->c->pool);
>> +                apr_pool_tag(f->deferred_pool, "deferred_pool");
>> +            }
>> +            pool =3D f->deferred_pool;
>> +            return ap_save_brigade(f, &f->bb, &bb, pool);
>> +        }
>=20
> Shouldn't ap_save_brigade() be moved below the "else=E2=80=9D?

It shouldn=E2=80=99t no.

ap_save_brigade() performs setaside, and that is precisely what we want =
to avoid for request filters. In request filters we can safely =
APR_BRIGADE_CONCAT and not worry.

If you moved ap_save_brigade() the server behaviour would become =
synchronous again for data that wasn=E2=80=99t a file.

>> +    *flush_upto =3D NULL;
>> +
>> +    bytes_in_brigade =3D 0;
>> +    non_file_bytes_in_brigade =3D 0;
>> +    eor_buckets_in_brigade =3D 0;
>> +    morphing_bucket_in_brigade =3D 0;
>=20
> Per the ealier suggestion to make ap_filter_data opaque, these could
> be part of the struct (and reentrant).
> We could then PREPEND after the loop below, and avoid potentially to
> walk the same buckets each time.

Alas as described above that=E2=80=99s not possible, as it breaks the =
flow control mechanism that prevents the server generating too much =
data.

Regards,
Graham
=E2=80=94


From dev-return-84075-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Tue Oct  6 10:20:40 2015
Return-Path: <dev-return-84075-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 9FBDF17A1D
	for <apmail-httpd-dev-archive@www.apache.org>; Tue,  6 Oct 2015 10:20:40 +0000 (UTC)
Received: (qmail 46336 invoked by uid 500); 6 Oct 2015 10:20:06 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 46274 invoked by uid 500); 6 Oct 2015 10:20:05 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 46264 invoked by uid 99); 6 Oct 2015 10:20:05 -0000
Received: from Unknown (HELO spamd1-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 06 Oct 2015 10:20:05 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd1-us-west.apache.org (ASF Mail Server at spamd1-us-west.apache.org) with ESMTP id 79005C39E8
	for <dev@httpd.apache.org>; Tue,  6 Oct 2015 10:20:05 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd1-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.011
X-Spam-Level:
X-Spam-Status: No, score=-0.011 tagged_above=-999 required=6.31
	tests=[SPF_PASS=-0.001, T_RP_MATCHES_RCVD=-0.01] autolearn=disabled
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd1-us-west.apache.org [10.40.0.7]) (amavisd-new, port 10024)
	with ESMTP id xlOrqDBeobHn for <dev@httpd.apache.org>;
	Tue,  6 Oct 2015 10:20:05 +0000 (UTC)
Received: from monica.sharp.fm (monica.sharp.fm [80.168.143.5])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTP id B3E44439E9
	for <dev@httpd.apache.org>; Tue,  6 Oct 2015 10:20:04 +0000 (UTC)
Received: from hgslapmb-h06477.hogarthww.prv (unknown [5.56.169.82])
	(using TLSv1 with cipher DHE-RSA-AES256-SHA (256/256 bits))
	(Client did not present a certificate)
	(Authenticated sender: minfrin@sharp.fm)
	by monica.sharp.fm (Postfix) with ESMTPSA id BFDF1830F8
	for <dev@httpd.apache.org>; Tue,  6 Oct 2015 11:19:57 +0100 (BST)
Content-Type: text/plain; charset=utf-8
Mime-Version: 1.0 (Mac OS X Mail 8.2 \(2104\))
Subject: Re: svn commit: r1706669 - in /httpd/httpd/trunk: ./ include/ modules/http/ modules/ssl/ server/ server/mpm/event/ server/mpm/motorz/ server/mpm/simple/
From: Graham Leggett <minfrin@sharp.fm>
In-Reply-To: <CAKQ1sVNpMOH5R2iQxwk2S+VbtnMY8wZZbkoPk=D8cDiZhZej4g@mail.gmail.com>
Date: Tue, 6 Oct 2015 12:19:56 +0200
Content-Transfer-Encoding: quoted-printable
Message-Id: <CDBA25F7-C843-48EB-A8A8-90C9E5378CD0@sharp.fm>
References: <CAKQ1sVMoxQe=8iAQ=oUSRJhrpy0o8RpJ=+u_CXecw8UbTj_NOg@mail.gmail.com> <AB1691BE05AE7F4992697F2A0835627AC633D4AC@VOEXM10W.internal.vodafone.com> <CAKQ1sVNpMOH5R2iQxwk2S+VbtnMY8wZZbkoPk=D8cDiZhZej4g@mail.gmail.com>
To: dev@httpd.apache.org
X-Mailer: Apple Mail (2.2104)

On 06 Oct 2015, at 11:13 AM, Yann Ylavic <ylavic.dev@gmail.com> wrote:

> By defining this function in util_filter
> (ap_filter_reinstate_conn()?), we also possibly could get rid of
> c->empty (which looks quite hacky), using/hidding an empty brigade per
> filter (in opaque data).

That starts multiplying the RAM really quickly, and starts getting =
expensive.

Ideally c->empty should be hidden inside an MPM-local context. Each MPM =
that then assign or not assign whatever it needs and this is hidden. If =
conn_rec had an opaque context for an MPM a lot of public stuff in the =
struct could probably be removed.

Regards,
Graham
=E2=80=94


From dev-return-84076-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Tue Oct  6 10:30:35 2015
Return-Path: <dev-return-84076-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 3DFB217A6B
	for <apmail-httpd-dev-archive@www.apache.org>; Tue,  6 Oct 2015 10:30:35 +0000 (UTC)
Received: (qmail 70421 invoked by uid 500); 6 Oct 2015 10:30:12 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 70346 invoked by uid 500); 6 Oct 2015 10:30:12 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 70336 invoked by uid 99); 6 Oct 2015 10:30:12 -0000
Received: from Unknown (HELO spamd2-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 06 Oct 2015 10:30:12 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd2-us-west.apache.org (ASF Mail Server at spamd2-us-west.apache.org) with ESMTP id 2A5971A20C0
	for <dev@httpd.apache.org>; Tue,  6 Oct 2015 10:30:12 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd2-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 0.999
X-Spam-Level:
X-Spam-Status: No, score=0.999 tagged_above=-999 required=6.31
	tests=[KAM_LAZY_DOMAIN_SECURITY=1, SPF_HELO_PASS=-0.001]
	autolearn=disabled
Received: from mx1-us-west.apache.org ([10.40.0.8])
	by localhost (spamd2-us-west.apache.org [10.40.0.9]) (amavisd-new, port 10024)
	with ESMTP id qdD1uaJ6_SMi for <dev@httpd.apache.org>;
	Tue,  6 Oct 2015 10:30:00 +0000 (UTC)
Received: from mail1.bemta14.messagelabs.com (mail1.bemta14.messagelabs.com [193.109.254.109])
	by mx1-us-west.apache.org (ASF Mail Server at mx1-us-west.apache.org) with ESMTPS id 6BDDE20F20
	for <dev@httpd.apache.org>; Tue,  6 Oct 2015 10:30:00 +0000 (UTC)
Received: from [193.109.254.3] by server-5.bemta-14.messagelabs.com id 61/27-00475-1A2A3165; Tue, 06 Oct 2015 10:29:53 +0000
X-Env-Sender: ruediger.pluem@vodafone.com
X-Msg-Ref: server-8.tower-184.messagelabs.com!1444127209!24685460!1
X-Originating-IP: [195.232.244.136]
X-StarScan-Received:
X-StarScan-Version: 6.13.16; banners=-,-,-
X-VirusChecked: Checked
Received: (qmail 32408 invoked from network); 6 Oct 2015 10:26:49 -0000
Received: from mailout04.vodafone.com (HELO mailout04.vodafone.com) (195.232.244.136)
  by server-8.tower-184.messagelabs.com with DHE-RSA-AES256-SHA encrypted SMTP; 6 Oct 2015 10:26:49 -0000
Received: from mailint01.vodafone.com (mailint01.vodafone.com [195.232.244.198])
	by mailout04.vodafone.com (Postfix) with ESMTP id 3nVZj54f8RznTYg
	for <dev@httpd.apache.org>; Tue,  6 Oct 2015 12:26:49 +0200 (CEST)
Received: from mailint01.vodafone.com (localhost [127.0.0.1])
	by mailint01.vodafone.com (Postfix) with ESMTP id 3nVZj53llrzxPTc
	for <dev@httpd.apache.org>; Tue,  6 Oct 2015 12:26:49 +0200 (CEST)
Received: from VOEXC01W.internal.vodafone.com (voexc01w.dc-ratingen.de [145.230.101.21])
	(using TLSv1 with cipher AES128-SHA (128/128 bits))
	(No client certificate requested)
	by mailint01.vodafone.com (Postfix) with ESMTPS id 3nVZj53P20zxPKw
	for <dev@httpd.apache.org>; Tue,  6 Oct 2015 12:26:49 +0200 (CEST)
Received: from VOEXC19W.internal.vodafone.com (145.230.103.124) by
 VOEXC01W.internal.vodafone.com (145.230.101.21) with Microsoft SMTP Server
 (TLS) id 14.3.224.2; Tue, 6 Oct 2015 12:26:49 +0200
Received: from VOEXM10W.internal.vodafone.com ([169.254.2.88]) by
 VOEXC19W.internal.vodafone.com ([145.230.103.124]) with mapi id
 14.03.0224.002; Tue, 6 Oct 2015 12:26:48 +0200
From: =?utf-8?B?UGzDvG0sIFLDvGRpZ2VyLCBWb2RhZm9uZSBHcm91cA==?=
	<ruediger.pluem@vodafone.com>
To: "dev@httpd.apache.org" <dev@httpd.apache.org>
Subject: RE: svn commit: r1706669 - in /httpd/httpd/trunk: ./ include/
 modules/http/ modules/ssl/ server/ server/mpm/event/ server/mpm/motorz/
 server/mpm/simple/
Thread-Topic: svn commit: r1706669 - in /httpd/httpd/trunk: ./ include/
 modules/http/ modules/ssl/ server/ server/mpm/event/ server/mpm/motorz/
 server/mpm/simple/
Thread-Index: AQHQ/8ce27K9fyvABE+g5rr0X8c32p5eHsuAgAAkFFA=
Date: Tue, 6 Oct 2015 10:26:47 +0000
Message-ID: <AB1691BE05AE7F4992697F2A0835627AC633D8A1@VOEXM10W.internal.vodafone.com>
References: <CAKQ1sVMoxQe=8iAQ=oUSRJhrpy0o8RpJ=+u_CXecw8UbTj_NOg@mail.gmail.com>
 <2791C826-8CFB-4DC9-B6AF-566DF625B154@sharp.fm>
In-Reply-To: <2791C826-8CFB-4DC9-B6AF-566DF625B154@sharp.fm>
Accept-Language: en-US
Content-Language: en-US
X-MS-Has-Attach:
X-MS-TNEF-Correlator:
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
MIME-Version: 1.0

DQoNCj4gLS0tLS1PcmlnaW5hbCBNZXNzYWdlLS0tLS0NCj4gRnJvbTogR3JhaGFtIExlZ2dldHQg
W21haWx0bzptaW5mcmluQHNoYXJwLmZtXQ0KPiBTZW50OiBEaWVuc3RhZywgNi4gT2t0b2JlciAy
MDE1IDEyOjE2DQo+IFRvOiBkZXZAaHR0cGQuYXBhY2hlLm9yZw0KPiBTdWJqZWN0OiBSZTogc3Zu
IGNvbW1pdDogcjE3MDY2NjkgLSBpbiAvaHR0cGQvaHR0cGQvdHJ1bms6IC4vIGluY2x1ZGUvDQo+
IG1vZHVsZXMvaHR0cC8gbW9kdWxlcy9zc2wvIHNlcnZlci8gc2VydmVyL21wbS9ldmVudC8gc2Vy
dmVyL21wbS9tb3RvcnovDQo+IHNlcnZlci9tcG0vc2ltcGxlLw0KPiANCj4gT24gMDYgT2N0IDIw
MTUsIGF0IDE6MzkgQU0sIFlhbm4gWWxhdmljIDx5bGF2aWMuZGV2QGdtYWlsLmNvbT4gd3JvdGU6
DQo+IA0KPiANCj4gPj4gKyAgICAgICAgLyogZGVjaWRlIHdoYXQgcG9vbCB3ZSBzZXRhc2lkZSB0
bywgcmVxdWVzdCBwb29sIG9yIGRlZmVycmVkDQo+IHBvb2w/ICovDQo+ID4+ICsgICAgICAgIGlm
IChmLT5yKSB7DQo+ID4+ICsgICAgICAgICAgICBwb29sID0gZi0+ci0+cG9vbDsNCj4gPj4gKyAg
ICAgICAgICAgIEFQUl9CUklHQURFX0NPTkNBVChmLT5iYiwgYmIpOw0KPiA+PiArICAgICAgICB9
DQo+ID4+ICsgICAgICAgIGVsc2Ugew0KPiA+PiArICAgICAgICAgICAgaWYgKCFmLT5kZWZlcnJl
ZF9wb29sKSB7DQo+ID4+ICsgICAgICAgICAgICAgICAgYXByX3Bvb2xfY3JlYXRlKCZmLT5kZWZl
cnJlZF9wb29sLCBmLT5jLT5wb29sKTsNCj4gPj4gKyAgICAgICAgICAgICAgICBhcHJfcG9vbF90
YWcoZi0+ZGVmZXJyZWRfcG9vbCwgImRlZmVycmVkX3Bvb2wiKTsNCj4gPj4gKyAgICAgICAgICAg
IH0NCj4gPj4gKyAgICAgICAgICAgIHBvb2wgPSBmLT5kZWZlcnJlZF9wb29sOw0KPiA+PiArICAg
ICAgICAgICAgcmV0dXJuIGFwX3NhdmVfYnJpZ2FkZShmLCAmZi0+YmIsICZiYiwgcG9vbCk7DQo+
ID4+ICsgICAgICAgIH0NCj4gPg0KPiA+IFNob3VsZG4ndCBhcF9zYXZlX2JyaWdhZGUoKSBiZSBt
b3ZlZCBiZWxvdyB0aGUgImVsc2XigJ0/DQo+IA0KPiBJdCBzaG91bGRu4oCZdCBuby4NCj4gDQo+
IGFwX3NhdmVfYnJpZ2FkZSgpIHBlcmZvcm1zIHNldGFzaWRlLCBhbmQgdGhhdCBpcyBwcmVjaXNl
bHkgd2hhdCB3ZSB3YW50IHRvDQo+IGF2b2lkIGZvciByZXF1ZXN0IGZpbHRlcnMuIEluIHJlcXVl
c3QgZmlsdGVycyB3ZSBjYW4gc2FmZWx5DQo+IEFQUl9CUklHQURFX0NPTkNBVCBhbmQgbm90IHdv
cnJ5Lg0KPiANCj4gSWYgeW91IG1vdmVkIGFwX3NhdmVfYnJpZ2FkZSgpIHRoZSBzZXJ2ZXIgYmVo
YXZpb3VyIHdvdWxkIGJlY29tZQ0KPiBzeW5jaHJvbm91cyBhZ2FpbiBmb3IgZGF0YSB0aGF0IHdh
c27igJl0IGEgZmlsZS4NCj4gDQoNCkhvdyBjYW4geW91IGJlIHN1cmUgdGhhdCB5b3UgZG9uJ3Qg
aGF2ZSB0cmFuc2llbnQgYnVja2V0cyBpbiB0aGUgYnJpZ2FkZSB0aGF0IHBvaW50IHRvIG1lbW9y
eSB0aGF0IGNoYW5nZWQgb3IgaXMgaW52YWxpZCwgb25jZSB5b3UgcmVpbnN0YXRlIHRoZSBicmln
YWRlPw0KDQpSZWdhcmRzDQoNClLDvGRpZ2VyDQoNCg==

From dev-return-84078-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Tue Oct  6 10:36:48 2015
Return-Path: <dev-return-84078-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 07DBE17A9C
	for <apmail-httpd-dev-archive@www.apache.org>; Tue,  6 Oct 2015 10:36:48 +0000 (UTC)
Received: (qmail 83168 invoked by uid 500); 6 Oct 2015 10:36:44 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 83094 invoked by uid 500); 6 Oct 2015 10:36:44 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 83084 invoked by uid 99); 6 Oct 2015 10:36:44 -0000
Received: from Unknown (HELO spamd1-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 06 Oct 2015 10:36:44 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd1-us-west.apache.org (ASF Mail Server at spamd1-us-west.apache.org) with ESMTP id D9E34C39B8
	for <dev@httpd.apache.org>; Tue,  6 Oct 2015 10:36:43 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd1-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.01
X-Spam-Level:
X-Spam-Status: No, score=-0.01 tagged_above=-999 required=6.31
	tests=[SPF_PASS=-0.001, T_RP_MATCHES_RCVD=-0.01, URIBL_BLOCKED=0.001]
	autolearn=disabled
Received: from mx1-us-west.apache.org ([10.40.0.8])
	by localhost (spamd1-us-west.apache.org [10.40.0.7]) (amavisd-new, port 10024)
	with ESMTP id RG3JU-sqqpiD for <dev@httpd.apache.org>;
	Tue,  6 Oct 2015 10:36:35 +0000 (UTC)
Received: from monica.sharp.fm (monica.sharp.fm [80.168.143.5])
	by mx1-us-west.apache.org (ASF Mail Server at mx1-us-west.apache.org) with ESMTP id 30B3E23053
	for <dev@httpd.apache.org>; Tue,  6 Oct 2015 10:36:35 +0000 (UTC)
Received: from hgslapmb-h06477.hogarthww.prv (unknown [5.56.169.82])
	(using TLSv1 with cipher DHE-RSA-AES256-SHA (256/256 bits))
	(Client did not present a certificate)
	(Authenticated sender: minfrin@sharp.fm)
	by monica.sharp.fm (Postfix) with ESMTPSA id 7D53F83150
	for <dev@httpd.apache.org>; Tue,  6 Oct 2015 11:36:34 +0100 (BST)
Content-Type: text/plain; charset=utf-8
Mime-Version: 1.0 (Mac OS X Mail 8.2 \(2104\))
Subject: Re: svn commit: r1706669 - in /httpd/httpd/trunk: ./ include/ modules/http/ modules/ssl/ server/ server/mpm/event/ server/mpm/motorz/ server/mpm/simple/
From: Graham Leggett <minfrin@sharp.fm>
In-Reply-To: <AB1691BE05AE7F4992697F2A0835627AC633D8A1@VOEXM10W.internal.vodafone.com>
Date: Tue, 6 Oct 2015 12:36:33 +0200
Content-Transfer-Encoding: quoted-printable
Message-Id: <B4A85802-BF21-41F1-B2DC-18FDD2AC9AE6@sharp.fm>
References: <CAKQ1sVMoxQe=8iAQ=oUSRJhrpy0o8RpJ=+u_CXecw8UbTj_NOg@mail.gmail.com> <2791C826-8CFB-4DC9-B6AF-566DF625B154@sharp.fm> <AB1691BE05AE7F4992697F2A0835627AC633D8A1@VOEXM10W.internal.vodafone.com>
To: dev@httpd.apache.org
X-Mailer: Apple Mail (2.2104)

On 06 Oct 2015, at 12:26 PM, Pl=C3=BCm, R=C3=BCdiger, Vodafone Group =
<ruediger.pluem@vodafone.com> wrote:

> How can you be sure that you don't have transient buckets in the =
brigade that point to memory that changed or is invalid, once you =
reinstate the brigade?

Because it=E2=80=99s a request filter, not a connection filter. Request =
filters set aside brigades all the time in their local contexts, this is =
normal.

Regards,
Graham
=E2=80=94


From dev-return-84077-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Tue Oct  6 10:37:03 2015
Return-Path: <dev-return-84077-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 3EF0217AA5
	for <apmail-httpd-dev-archive@www.apache.org>; Tue,  6 Oct 2015 10:37:03 +0000 (UTC)
Received: (qmail 82071 invoked by uid 500); 6 Oct 2015 10:36:42 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 82012 invoked by uid 500); 6 Oct 2015 10:36:42 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 82002 invoked by uid 99); 6 Oct 2015 10:36:42 -0000
Received: from Unknown (HELO spamd1-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 06 Oct 2015 10:36:41 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd1-us-west.apache.org (ASF Mail Server at spamd1-us-west.apache.org) with ESMTP id 8CA87C39B8
	for <dev@httpd.apache.org>; Tue,  6 Oct 2015 10:36:41 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd1-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.101
X-Spam-Level:
X-Spam-Status: No, score=-0.101 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RCVD_IN_MSPIKE_H2=-0.001, SPF_PASS=-0.001, URIBL_BLOCKED=0.001]
	autolearn=disabled
Authentication-Results: spamd1-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd1-us-west.apache.org [10.40.0.7]) (amavisd-new, port 10024)
	with ESMTP id S6c8IgtQ_ZGO for <dev@httpd.apache.org>;
	Tue,  6 Oct 2015 10:36:40 +0000 (UTC)
Received: from mail-qk0-f176.google.com (mail-qk0-f176.google.com [209.85.220.176])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id AF1AE25426
	for <dev@httpd.apache.org>; Tue,  6 Oct 2015 10:36:39 +0000 (UTC)
Received: by qkcf65 with SMTP id f65so83590272qkc.3
        for <dev@httpd.apache.org>; Tue, 06 Oct 2015 03:36:33 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type:content-transfer-encoding;
        bh=kD3IhCdFelk1RJabrs0piOnEMmZUiug/XgHwxGX2Owo=;
        b=rdMbVHUwbr6Y92tj22f3R7k7J9c8mA14yjeR1ZoS1JhGnkQoQ6tg6HLuHXNC++XYW/
         svlVTEtl8jMPR3hMAms3x1iUYnsGN1Wpz6YMAMi1TTpVl6TJCHiNhAzq2191+LHTzKsq
         kJjRBZokbkGInf3bZmR839VNOGlV7CfD9RKPBRPN9KJGenNRE5p/CfuaYqxHsfeaoWXQ
         bjfzAYjcF1UxOYQFJOjY9u0+2mhOr9jxtoRi0fdGz5glFfSaysRZ9f4cG7W9eiqG2rl1
         D5UhUHPdmaD+vz8gopYvVFyHjKvAtkmHdOPIUnI4vIqlLN97PSvx8aLdZX+cjFRaKtmJ
         tS+Q==
MIME-Version: 1.0
X-Received: by 10.55.15.134 with SMTP id 6mr173908qkp.38.1444127793032; Tue,
 06 Oct 2015 03:36:33 -0700 (PDT)
Received: by 10.55.72.20 with HTTP; Tue, 6 Oct 2015 03:36:32 -0700 (PDT)
In-Reply-To: <AB1691BE05AE7F4992697F2A0835627AC633D7D2@VOEXM10W.internal.vodafone.com>
References: <CAKQ1sVMoxQe=8iAQ=oUSRJhrpy0o8RpJ=+u_CXecw8UbTj_NOg@mail.gmail.com>
	<AB1691BE05AE7F4992697F2A0835627AC633D4AC@VOEXM10W.internal.vodafone.com>
	<CAKQ1sVNpMOH5R2iQxwk2S+VbtnMY8wZZbkoPk=D8cDiZhZej4g@mail.gmail.com>
	<AB1691BE05AE7F4992697F2A0835627AC633D7D2@VOEXM10W.internal.vodafone.com>
Date: Tue, 6 Oct 2015 12:36:32 +0200
Message-ID: <CAKQ1sVMbykeKGH9c5eEgs6mLR87K3JXpiJTevo_Ug3B1DsXX_w@mail.gmail.com>
Subject: Re: svn commit: r1706669 - in /httpd/httpd/trunk: ./ include/
 modules/http/ modules/ssl/ server/ server/mpm/event/ server/mpm/motorz/ server/mpm/simple/
From: Yann Ylavic <ylavic.dev@gmail.com>
To: dev@httpd.apache.org
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: quoted-printable

On Tue, Oct 6, 2015 at 11:31 AM, Pl=C3=BCm, R=C3=BCdiger, Vodafone Group
<ruediger.pluem@vodafone.com> wrote:
>
>
>> -----Original Message-----
>> From: Yann Ylavic [mailto:ylavic.dev@gmail.com]
>> Sent: Dienstag, 6. Oktober 2015 11:13
>> To: dev@httpd.apache.org
>> Subject: Re: svn commit: r1706669 - in /httpd/httpd/trunk: ./ include/
>> modules/http/ modules/ssl/ server/ server/mpm/event/ server/mpm/motorz/
>> server/mpm/simple/
>>
>> On Tue, Oct 6, 2015 at 9:37 AM, Pl=C3=BCm, R=C3=BCdiger, Vodafone Group
>> <ruediger.pluem@vodafone.com> wrote:
>> >
>> >> -----Original Message-----
>> >> From: Yann Ylavic [mailto:ylavic.dev@gmail.com]
>> >>
>> >> > Modified: httpd/httpd/trunk/server/mpm/event/event.c
>> >> > URL:
>> >>
>> http://svn.apache.org/viewvc/httpd/httpd/trunk/server/mpm/event/event.c?=
re
>> >> v=3D1706669&r1=3D1706668&r2=3D1706669&view=3Ddiff
>> >> >
>> >>
>> =3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D
>> >> =3D=3D=3D=3D
>> >> > --- httpd/httpd/trunk/server/mpm/event/event.c (original)
>> >> > +++ httpd/httpd/trunk/server/mpm/event/event.c Sun Oct  4 10:10:51
>> 2015
>> >> > @@ -1146,19 +1146,38 @@ read_request:
>> >> >      }
>> >> >
>> >> []
>> >> > +
>> >> > +        rindex =3D apr_hash_first(NULL, c->filters);
>> >> > +        while (rindex) {
>> >> > +            ap_filter_t *f =3D apr_hash_this_val(rindex);
>> >> > +
>> >> > +            if (!APR_BRIGADE_EMPTY(f->bb)) {
>> >> > +
>> >> > +                rv =3D ap_pass_brigade(f, c->empty);
>> >> > +                apr_brigade_cleanup(c->empty);
>> >> > +                if (APR_SUCCESS !=3D rv) {
>> >> > +                    ap_log_cerror(
>> >> > +                            APLOG_MARK, APLOG_DEBUG, rv, c,
>> >> APLOGNO(00470)
>> >> > +                            "write failure in '%s' output filter",
>> f-
>> >> >frec->name);
>> >> > +                    break;
>> >> > +                }
>> >> > +
>> >> > +                if (ap_filter_should_yield(f)) {
>> >> > +                    data_in_output_filters =3D 1;
>> >> > +                }
>> >> > +            }
>> >> > +
>> >> > +            rindex =3D apr_hash_next(rindex);
>> >> >          }
>> >>
>> >> This pattern looks shared by all (relevant) MPMs, couldn't we make it
>> >> a function? Maybe ap_reinstate_conn()?
>> >
>> > Sounds sensible.
>>
>> By defining this function in util_filter
>> (ap_filter_reinstate_conn()?), we also possibly could get rid of
>> c->empty (which looks quite hacky), using/hidding an empty brigade per
>> filter (in opaque data).
>
> Although the brigade is empty, don't we need to prevent the brigade being=
 used by multiple threads in parallel?
> Using one per connection prevents this.

Hmm, the filters are also allocated per connection/request (on
c/r->pool), and shouldn't be called concurrently right?

BTW, I wonder if we can "reinstate" the filters in arbitrary order
like in the above loop (the order seems to depend on the calls to
ap_filter_setaside_brigade() and internal apr_hash_t ordering).
Don't we need to start from r->ouput_filters down to the last filter
and call ap_pass_brigade(f, c->empty) if f is in the hashtable?

From dev-return-84079-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Tue Oct  6 10:57:09 2015
Return-Path: <dev-return-84079-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id A14B617B4B
	for <apmail-httpd-dev-archive@www.apache.org>; Tue,  6 Oct 2015 10:57:09 +0000 (UTC)
Received: (qmail 22520 invoked by uid 500); 6 Oct 2015 10:57:09 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 22447 invoked by uid 500); 6 Oct 2015 10:57:09 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 22437 invoked by uid 99); 6 Oct 2015 10:57:09 -0000
Received: from Unknown (HELO spamd2-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 06 Oct 2015 10:57:09 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd2-us-west.apache.org (ASF Mail Server at spamd2-us-west.apache.org) with ESMTP id BA3C61A20F5
	for <dev@httpd.apache.org>; Tue,  6 Oct 2015 10:57:08 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd2-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.011
X-Spam-Level:
X-Spam-Status: No, score=-0.011 tagged_above=-999 required=6.31
	tests=[SPF_PASS=-0.001, T_RP_MATCHES_RCVD=-0.01] autolearn=disabled
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd2-us-west.apache.org [10.40.0.9]) (amavisd-new, port 10024)
	with ESMTP id tMCwWZhIEMho for <dev@httpd.apache.org>;
	Tue,  6 Oct 2015 10:57:07 +0000 (UTC)
Received: from monica.sharp.fm (monica.sharp.fm [80.168.143.5])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTP id 930BB439D3
	for <dev@httpd.apache.org>; Tue,  6 Oct 2015 10:57:07 +0000 (UTC)
Received: from hgslapmb-h06477.hogarthww.prv (unknown [5.56.169.82])
	(using TLSv1 with cipher DHE-RSA-AES256-SHA (256/256 bits))
	(Client did not present a certificate)
	(Authenticated sender: minfrin@sharp.fm)
	by monica.sharp.fm (Postfix) with ESMTPSA id 18E3F8314E
	for <dev@httpd.apache.org>; Tue,  6 Oct 2015 11:57:07 +0100 (BST)
Content-Type: text/plain; charset=utf-8
Mime-Version: 1.0 (Mac OS X Mail 8.2 \(2104\))
Subject: Re: svn commit: r1706669 - in /httpd/httpd/trunk: ./ include/ modules/http/ modules/ssl/ server/ server/mpm/event/ server/mpm/motorz/ server/mpm/simple/
From: Graham Leggett <minfrin@sharp.fm>
In-Reply-To: <CAKQ1sVMbykeKGH9c5eEgs6mLR87K3JXpiJTevo_Ug3B1DsXX_w@mail.gmail.com>
Date: Tue, 6 Oct 2015 12:57:06 +0200
Content-Transfer-Encoding: quoted-printable
Message-Id: <F9DC5F6A-65FF-4429-AD74-50B84EF9F38E@sharp.fm>
References: <CAKQ1sVMoxQe=8iAQ=oUSRJhrpy0o8RpJ=+u_CXecw8UbTj_NOg@mail.gmail.com> <AB1691BE05AE7F4992697F2A0835627AC633D4AC@VOEXM10W.internal.vodafone.com> <CAKQ1sVNpMOH5R2iQxwk2S+VbtnMY8wZZbkoPk=D8cDiZhZej4g@mail.gmail.com> <AB1691BE05AE7F4992697F2A0835627AC633D7D2@VOEXM10W.internal.vodafone.com> <CAKQ1sVMbykeKGH9c5eEgs6mLR87K3JXpiJTevo_Ug3B1DsXX_w@mail.gmail.com>
To: dev@httpd.apache.org
X-Mailer: Apple Mail (2.2104)

On 06 Oct 2015, at 12:36 PM, Yann Ylavic <ylavic.dev@gmail.com> wrote:

>> Although the brigade is empty, don't we need to prevent the brigade =
being used by multiple threads in parallel?
>> Using one per connection prevents this.
>=20
> Hmm, the filters are also allocated per connection/request (on
> c/r->pool), and shouldn't be called concurrently right?

Yes.

> BTW, I wonder if we can "reinstate" the filters in arbitrary order
> like in the above loop (the order seems to depend on the calls to
> ap_filter_setaside_brigade() and internal apr_hash_t ordering).
> Don't we need to start from r->ouput_filters down to the last filter
> and call ap_pass_brigade(f, c->empty) if f is in the hashtable?

No - we don=E2=80=99t =E2=80=9Creinstate=E2=80=9D filters in any way, we =
just kick them. We kick each eligible filter exactly once on each pass, =
and the order doesn=E2=80=99t matter. Every filter with data in it gets =
a kick to ensure no filter is starved, all filters without data are =
silently ignored.

When a kick arrives and the filter has something to write, the normal =
filter stack write order is preserved by ap_pass_brigade() and =
everything happens in the right order naturally without us having to do =
anything special.

Typically only two filters at a time - the bottleneck and the network =
filter - will have data in it, all other filters will be empty. If =
mod_cache is present, then three filters are likely to have data in it =
(mod_cache, the bottleneck filter and the network filter), and three =
filters will get kicked.

When I was investigating this I was originally looking at a skiplist to =
keep the ordering, but once I analysed it it turned out to be =
unnecessary.

Regards,
Graham
=E2=80=94


From dev-return-84080-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Tue Oct  6 11:02:24 2015
Return-Path: <dev-return-84080-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id AD63917B69
	for <apmail-httpd-dev-archive@www.apache.org>; Tue,  6 Oct 2015 11:02:24 +0000 (UTC)
Received: (qmail 28516 invoked by uid 500); 6 Oct 2015 11:02:24 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 28447 invoked by uid 500); 6 Oct 2015 11:02:24 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 28437 invoked by uid 99); 6 Oct 2015 11:02:24 -0000
Received: from Unknown (HELO spamd1-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 06 Oct 2015 11:02:24 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd1-us-west.apache.org (ASF Mail Server at spamd1-us-west.apache.org) with ESMTP id C014BC39FE
	for <dev@httpd.apache.org>; Tue,  6 Oct 2015 11:02:23 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd1-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.1
X-Spam-Level:
X-Spam-Status: No, score=-0.1 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	SPF_PASS=-0.001, URIBL_BLOCKED=0.001] autolearn=disabled
Authentication-Results: spamd1-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd1-us-west.apache.org [10.40.0.7]) (amavisd-new, port 10024)
	with ESMTP id iEiFrQIiOQzh for <dev@httpd.apache.org>;
	Tue,  6 Oct 2015 11:02:18 +0000 (UTC)
Received: from mail-qg0-f44.google.com (mail-qg0-f44.google.com [209.85.192.44])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id E0AA2439E9
	for <dev@httpd.apache.org>; Tue,  6 Oct 2015 11:02:17 +0000 (UTC)
Received: by qgez77 with SMTP id z77so171019269qge.1
        for <dev@httpd.apache.org>; Tue, 06 Oct 2015 04:02:11 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type:content-transfer-encoding;
        bh=jKNc5Rw5XCXRklXA+7V63rnsbudSBBfzFgjgRgWt5aY=;
        b=CcVKdRgzk/qbiLKfKfhqBmRGqRbXDabLRMixdyZY7fCsPtVeJdtU2Put3wDSzlmVqV
         iKzqZZHxVs7+ANSXurHUH8wnTlcHlGDLapIQIwf8QsNG8ukL6a+vqAsFYEDF2Ty79JSG
         HncuVu5xTitxEVwApI68BXP+hJcXwRRIiiM+qzBwYlTfaq6FR6sFk/gh7zgixImswH2N
         h9hf7lJBPo16gY9b5GZz60nn61w5LfH+jy9TUXy07IRNxrI+T62QA6mataUqCBL6f0MV
         ap0d6lVRxcaA4xwm7GLAXv0ZOtaULh4sY7teDivluf5vN6nN1B96bmJN7bD0Iyt3UQhU
         5pwg==
MIME-Version: 1.0
X-Received: by 10.140.131.198 with SMTP id 189mr48598246qhd.83.1444129331422;
 Tue, 06 Oct 2015 04:02:11 -0700 (PDT)
Received: by 10.55.72.20 with HTTP; Tue, 6 Oct 2015 04:02:11 -0700 (PDT)
In-Reply-To: <2791C826-8CFB-4DC9-B6AF-566DF625B154@sharp.fm>
References: <CAKQ1sVMoxQe=8iAQ=oUSRJhrpy0o8RpJ=+u_CXecw8UbTj_NOg@mail.gmail.com>
	<2791C826-8CFB-4DC9-B6AF-566DF625B154@sharp.fm>
Date: Tue, 6 Oct 2015 13:02:11 +0200
Message-ID: <CAKQ1sVOCaz2BuzAAm399-Kbxz6WsncDB+uasAgq58W6e_b4+aQ@mail.gmail.com>
Subject: Re: svn commit: r1706669 - in /httpd/httpd/trunk: ./ include/
 modules/http/ modules/ssl/ server/ server/mpm/event/ server/mpm/motorz/ server/mpm/simple/
From: Yann Ylavic <ylavic.dev@gmail.com>
To: dev@httpd.apache.org
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: quoted-printable

On Tue, Oct 6, 2015 at 12:15 PM, Graham Leggett <minfrin@sharp.fm> wrote:
> On 06 Oct 2015, at 1:39 AM, Yann Ylavic <ylavic.dev@gmail.com> wrote:
>
>>> +
>>> +    /** Buffered data associated with the current filter. */
>>> +    apr_bucket_brigade *bb;
>>> +
>>> +    /** Dedicated pool to use for deferred writes. */
>>> +    apr_pool_t *deferred_pool;
>>
>> Could we make these opaque, eg:
[]
>>
>> This would prevent them from being mangled anywhere (they are
>> internals to util_filter.c anyway).
>
> There weren=E2=80=99t originally internal to util_filter.c, it=E2=80=99s =
only subsequently turned out that way. Doing that comes at a cost of a furt=
her 8 bytes per filter per request through, which starts adding up.

8 or a few more bytes is a concern, really?

>
> I would rather finish the filter suspension work before doing any optimis=
ing like this, it=E2=80=99s too soon at this stage.

Fair enough.

>
>> It could also possibly avoid walking the brigade for every
>> ap_filter_reinstate_brigade() call=E2=80=A6
>
> Unfortunately you can=E2=80=99t avoid walking the brigade in the ap_filte=
r_reinstate_brigade(), as this is the flow control logic that keeps the ser=
ver safe from consuming too much data.

Well, there are only invariants here, the loop always computes the
same values for the buffered_bb or am I missing something?

>
>> Also it seems that we leak the hash iterator here (on c->pool).
>
> We don=E2=80=99t, when you create an iterator with a NULL pool it uses an=
 iterator internal to the hash. If we passed c->pool to apr_hash_first(), w=
e would leak.

Correct, R=C3=BCdiger spotted it already, my bad.

>
>> Shouldn't we call filters_cleanup() from ap_remove_output_filter() too?
>
> I deliberately decided not to.
>
> The majority of calls to ap_remove_output_filter() are made when filters =
step out the way before data starts flowing, and if we tried to run the cle=
anup we=E2=80=99d be performing an unnecessary apr_hash_set() on every invo=
cation before the filter was ever added to the hash.
>
> The point at which it would make a difference is after the EOS bucket is =
handled, but at this point it doesn=E2=80=99t matter, all we=E2=80=99re doi=
ng is saving one NULL check in the MPM on a loop with a handful of iteratio=
ns, it=E2=80=99s not worth the expense.



>
>> Why not simply use:
>>   key =3D apr_pmemdup(pool, &f, sizeof f);
>>   apr_hash_set(f->c->filters, &key, sizeof key, f)
>> here, and:
>>   ap_filter_t *f =3D data;
>>   apr_hash_set(f->c->filters, &f, sizeof f, NULL);
>> in filters_cleanup() above?
>
> We could but it=E2=80=99s more expensive. The memdup part is replaced by =
simply assigning a pointer.

Not sure about the overhead, memcpy is optimized for small sizes anyway.
At least both "sizeof(ap_filter_t **)" here and in filters_cleanup()
should be replaced by "sizeof(ap_filter_t *)" which is syntactically
more correct (even if both are equal in C).

>
>>> +    *flush_upto =3D NULL;
>>> +
>>> +    bytes_in_brigade =3D 0;
>>> +    non_file_bytes_in_brigade =3D 0;
>>> +    eor_buckets_in_brigade =3D 0;
>>> +    morphing_bucket_in_brigade =3D 0;
>>
>> Per the ealier suggestion to make ap_filter_data opaque, these could
>> be part of the struct (and reentrant).
>> We could then PREPEND after the loop below, and avoid potentially to
>> walk the same buckets each time.
>
> Alas as described above that=E2=80=99s not possible, as it breaks the flo=
w control mechanism that prevents the server generating too much data.

Unless what's in buffered_bb is opaque (immutable between calls)...

Regards,
Yann.

From dev-return-84081-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Tue Oct  6 11:08:02 2015
Return-Path: <dev-return-84081-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 84ED217BA5
	for <apmail-httpd-dev-archive@www.apache.org>; Tue,  6 Oct 2015 11:08:02 +0000 (UTC)
Received: (qmail 33718 invoked by uid 500); 6 Oct 2015 11:08:02 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 33646 invoked by uid 500); 6 Oct 2015 11:08:02 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 33635 invoked by uid 99); 6 Oct 2015 11:08:02 -0000
Received: from Unknown (HELO spamd1-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 06 Oct 2015 11:08:02 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd1-us-west.apache.org (ASF Mail Server at spamd1-us-west.apache.org) with ESMTP id 7977FC3A1E
	for <dev@httpd.apache.org>; Tue,  6 Oct 2015 11:08:01 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd1-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.101
X-Spam-Level:
X-Spam-Status: No, score=-0.101 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RCVD_IN_MSPIKE_H2=-0.001, SPF_PASS=-0.001, URIBL_BLOCKED=0.001]
	autolearn=disabled
Authentication-Results: spamd1-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd1-us-west.apache.org [10.40.0.7]) (amavisd-new, port 10024)
	with ESMTP id 3j9WaycDkdNt for <dev@httpd.apache.org>;
	Tue,  6 Oct 2015 11:07:57 +0000 (UTC)
Received: from mail-qg0-f44.google.com (mail-qg0-f44.google.com [209.85.192.44])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id 94A21204D9
	for <dev@httpd.apache.org>; Tue,  6 Oct 2015 11:07:56 +0000 (UTC)
Received: by qgev79 with SMTP id v79so170463711qge.0
        for <dev@httpd.apache.org>; Tue, 06 Oct 2015 04:07:55 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type:content-transfer-encoding;
        bh=z+CfEY8oSRK7UR9iBZm1FGE+OKNLR2p0c0qDsiogOb0=;
        b=qCV/UyrAtcIEq79N6ClZmDFYcjfc5y/R94yqu1RA60QI3HnIm7QKSqUJR8HHGSQP67
         SR7fNuzuK+noLvLj893T7C+8IgTOtewD6khFAf80PfFtr7hbPOszPycERsMlMY2N7Mwh
         nh2klr2FqFFqwutFcPnUAOmTYZcgzchc6blMLjpIXr4dpBzX23GqkfvuKnEJdz+sje6W
         Pyhet/maMo+WskJz3oitjI8fmTYkxs27QgVyYO57/ie8YnZLjcMMqW3aE19IbRWvQcZQ
         KkpITCpzqE8KMYGchzEYveTiG4h909/E3BU2ZumXohs8S4OemUd+EvoZQ5yy9jrnFzse
         IzwQ==
MIME-Version: 1.0
X-Received: by 10.140.95.73 with SMTP id h67mr46514454qge.14.1444129675663;
 Tue, 06 Oct 2015 04:07:55 -0700 (PDT)
Received: by 10.55.72.20 with HTTP; Tue, 6 Oct 2015 04:07:55 -0700 (PDT)
In-Reply-To: <F9DC5F6A-65FF-4429-AD74-50B84EF9F38E@sharp.fm>
References: <CAKQ1sVMoxQe=8iAQ=oUSRJhrpy0o8RpJ=+u_CXecw8UbTj_NOg@mail.gmail.com>
	<AB1691BE05AE7F4992697F2A0835627AC633D4AC@VOEXM10W.internal.vodafone.com>
	<CAKQ1sVNpMOH5R2iQxwk2S+VbtnMY8wZZbkoPk=D8cDiZhZej4g@mail.gmail.com>
	<AB1691BE05AE7F4992697F2A0835627AC633D7D2@VOEXM10W.internal.vodafone.com>
	<CAKQ1sVMbykeKGH9c5eEgs6mLR87K3JXpiJTevo_Ug3B1DsXX_w@mail.gmail.com>
	<F9DC5F6A-65FF-4429-AD74-50B84EF9F38E@sharp.fm>
Date: Tue, 6 Oct 2015 13:07:55 +0200
Message-ID: <CAKQ1sVM_vd-_ETb7x-8NUBXiwNVTakn_MQ8f2krXaPwX_mbmAA@mail.gmail.com>
Subject: Re: svn commit: r1706669 - in /httpd/httpd/trunk: ./ include/
 modules/http/ modules/ssl/ server/ server/mpm/event/ server/mpm/motorz/ server/mpm/simple/
From: Yann Ylavic <ylavic.dev@gmail.com>
To: dev@httpd.apache.org
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: quoted-printable

On Tue, Oct 6, 2015 at 12:57 PM, Graham Leggett <minfrin@sharp.fm> wrote:
>
> On 06 Oct 2015, at 12:36 PM, Yann Ylavic <ylavic.dev@gmail.com> wrote:
>> BTW, I wonder if we can "reinstate" the filters in arbitrary order
>> like in the above loop (the order seems to depend on the calls to
>> ap_filter_setaside_brigade() and internal apr_hash_t ordering).
>> Don't we need to start from r->ouput_filters down to the last filter
>> and call ap_pass_brigade(f, c->empty) if f is in the hashtable?
>
> No - we don=E2=80=99t =E2=80=9Creinstate=E2=80=9D filters in any way, we =
just kick them. We kick each eligible filter exactly once on each pass, and=
 the order doesn=E2=80=99t matter. Every filter with data in it gets a kick=
 to ensure no filter is starved, all filters without data are silently igno=
red.

What I meant is that passing an empty brigade to a reinstate-able
filter may make it pass its data to the next filter, so we may want to
do this only on the first reinstate-able filter starting from
r->output_filters.

So it seems to me that order matters, but I must be missing something,
need to think more about this.


Regards,
Yann.

From dev-return-84082-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Tue Oct  6 11:15:02 2015
Return-Path: <dev-return-84082-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id C506617BF3
	for <apmail-httpd-dev-archive@www.apache.org>; Tue,  6 Oct 2015 11:15:02 +0000 (UTC)
Received: (qmail 50002 invoked by uid 500); 6 Oct 2015 11:15:01 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 49925 invoked by uid 500); 6 Oct 2015 11:15:01 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 49915 invoked by uid 99); 6 Oct 2015 11:15:01 -0000
Received: from Unknown (HELO spamd1-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 06 Oct 2015 11:15:01 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd1-us-west.apache.org (ASF Mail Server at spamd1-us-west.apache.org) with ESMTP id 67D46C3905
	for <dev@httpd.apache.org>; Tue,  6 Oct 2015 11:15:01 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd1-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.011
X-Spam-Level:
X-Spam-Status: No, score=-0.011 tagged_above=-999 required=6.31
	tests=[SPF_PASS=-0.001, T_RP_MATCHES_RCVD=-0.01] autolearn=disabled
Received: from mx1-us-west.apache.org ([10.40.0.8])
	by localhost (spamd1-us-west.apache.org [10.40.0.7]) (amavisd-new, port 10024)
	with ESMTP id fLcEdqJwdf9f for <dev@httpd.apache.org>;
	Tue,  6 Oct 2015 11:15:00 +0000 (UTC)
Received: from monica.sharp.fm (monica.sharp.fm [80.168.143.5])
	by mx1-us-west.apache.org (ASF Mail Server at mx1-us-west.apache.org) with ESMTP id 6652320562
	for <dev@httpd.apache.org>; Tue,  6 Oct 2015 11:15:00 +0000 (UTC)
Received: from hgslapmb-h06477.hogarthww.prv (unknown [5.56.169.82])
	(using TLSv1 with cipher DHE-RSA-AES256-SHA (256/256 bits))
	(Client did not present a certificate)
	(Authenticated sender: minfrin@sharp.fm)
	by monica.sharp.fm (Postfix) with ESMTPSA id 770BE8314D
	for <dev@httpd.apache.org>; Tue,  6 Oct 2015 12:14:59 +0100 (BST)
Content-Type: text/plain; charset=utf-8
Mime-Version: 1.0 (Mac OS X Mail 8.2 \(2104\))
Subject: Re: svn commit: r1706669 - in /httpd/httpd/trunk: ./ include/ modules/http/ modules/ssl/ server/ server/mpm/event/ server/mpm/motorz/ server/mpm/simple/
From: Graham Leggett <minfrin@sharp.fm>
In-Reply-To: <CAKQ1sVM_vd-_ETb7x-8NUBXiwNVTakn_MQ8f2krXaPwX_mbmAA@mail.gmail.com>
Date: Tue, 6 Oct 2015 13:14:58 +0200
Content-Transfer-Encoding: quoted-printable
Message-Id: <BA691F75-DFFB-42B5-8A1D-D784F591C09A@sharp.fm>
References: <CAKQ1sVMoxQe=8iAQ=oUSRJhrpy0o8RpJ=+u_CXecw8UbTj_NOg@mail.gmail.com> <AB1691BE05AE7F4992697F2A0835627AC633D4AC@VOEXM10W.internal.vodafone.com> <CAKQ1sVNpMOH5R2iQxwk2S+VbtnMY8wZZbkoPk=D8cDiZhZej4g@mail.gmail.com> <AB1691BE05AE7F4992697F2A0835627AC633D7D2@VOEXM10W.internal.vodafone.com> <CAKQ1sVMbykeKGH9c5eEgs6mLR87K3JXpiJTevo_Ug3B1DsXX_w@mail.gmail.com> <F9DC5F6A-65FF-4429-AD74-50B84EF9F38E@sharp.fm> <CAKQ1sVM_vd-_ETb7x-8NUBXiwNVTakn_MQ8f2krXaPwX_mbmAA@mail.gmail.com>
To: dev@httpd.apache.org
X-Mailer: Apple Mail (2.2104)

On 06 Oct 2015, at 1:07 PM, Yann Ylavic <ylavic.dev@gmail.com> wrote:

> What I meant is that passing an empty brigade to a reinstate-able
> filter may make it pass its data to the next filter, so we may want to
> do this only on the first reinstate-able filter starting from
> r->output_filters.

If we did that we create the potential for filter starvation.

The mod_cache filter is a classic case of this - it wants to call =
ap_filter_should_yield() to work out whether downstream is ready for =
more data, or whether it should just loop around and cache more data =
from the backend. But downstream is never ready for more data, because =
we stopped kicking filters when we got to mod_cache. The request hangs.

The safest course of action to ensure we never second guess what a =
filter is trying to do is to kick all the eligible ones, once.

Regards,
Graham
=E2=80=94


From dev-return-84083-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Tue Oct  6 11:19:00 2015
Return-Path: <dev-return-84083-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id F204B17C1F
	for <apmail-httpd-dev-archive@www.apache.org>; Tue,  6 Oct 2015 11:18:59 +0000 (UTC)
Received: (qmail 60414 invoked by uid 500); 6 Oct 2015 11:18:59 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 60343 invoked by uid 500); 6 Oct 2015 11:18:59 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 60332 invoked by uid 99); 6 Oct 2015 11:18:59 -0000
Received: from Unknown (HELO spamd3-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 06 Oct 2015 11:18:59 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd3-us-west.apache.org (ASF Mail Server at spamd3-us-west.apache.org) with ESMTP id 0DBC1180A5E
	for <dev@httpd.apache.org>; Tue,  6 Oct 2015 11:18:59 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd3-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.01
X-Spam-Level:
X-Spam-Status: No, score=-0.01 tagged_above=-999 required=6.31
	tests=[SPF_PASS=-0.001, T_RP_MATCHES_RCVD=-0.01, URIBL_BLOCKED=0.001]
	autolearn=disabled
Received: from mx1-us-west.apache.org ([10.40.0.8])
	by localhost (spamd3-us-west.apache.org [10.40.0.10]) (amavisd-new, port 10024)
	with ESMTP id d11o_OIm7oqB for <dev@httpd.apache.org>;
	Tue,  6 Oct 2015 11:18:52 +0000 (UTC)
Received: from monica.sharp.fm (monica.sharp.fm [80.168.143.5])
	by mx1-us-west.apache.org (ASF Mail Server at mx1-us-west.apache.org) with ESMTP id E984D20F7B
	for <dev@httpd.apache.org>; Tue,  6 Oct 2015 11:18:51 +0000 (UTC)
Received: from hgslapmb-h06477.hogarthww.prv (unknown [5.56.169.82])
	(using TLSv1 with cipher DHE-RSA-AES256-SHA (256/256 bits))
	(Client did not present a certificate)
	(Authenticated sender: minfrin@sharp.fm)
	by monica.sharp.fm (Postfix) with ESMTPSA id 271AC8314D
	for <dev@httpd.apache.org>; Tue,  6 Oct 2015 12:18:51 +0100 (BST)
Content-Type: text/plain; charset=utf-8
Mime-Version: 1.0 (Mac OS X Mail 8.2 \(2104\))
Subject: Re: svn commit: r1706669 - in /httpd/httpd/trunk: ./ include/ modules/http/ modules/ssl/ server/ server/mpm/event/ server/mpm/motorz/ server/mpm/simple/
From: Graham Leggett <minfrin@sharp.fm>
In-Reply-To: <B4A85802-BF21-41F1-B2DC-18FDD2AC9AE6@sharp.fm>
Date: Tue, 6 Oct 2015 13:18:50 +0200
Content-Transfer-Encoding: quoted-printable
Message-Id: <3D610873-CC12-4E94-AAAA-49C4998202D6@sharp.fm>
References: <CAKQ1sVMoxQe=8iAQ=oUSRJhrpy0o8RpJ=+u_CXecw8UbTj_NOg@mail.gmail.com> <2791C826-8CFB-4DC9-B6AF-566DF625B154@sharp.fm> <AB1691BE05AE7F4992697F2A0835627AC633D8A1@VOEXM10W.internal.vodafone.com> <B4A85802-BF21-41F1-B2DC-18FDD2AC9AE6@sharp.fm>
To: dev@httpd.apache.org
X-Mailer: Apple Mail (2.2104)

On 06 Oct 2015, at 12:36 PM, Graham Leggett <minfrin@sharp.fm> wrote:

>> How can you be sure that you don't have transient buckets in the =
brigade that point to memory that changed or is invalid, once you =
reinstate the brigade?
>=20
> Because it=E2=80=99s a request filter, not a connection filter. =
Request filters set aside brigades all the time in their local contexts, =
this is normal.

I see what you mean - transient buckets specifically will need to be =
setaside before the loop ends. Will take a look.

Regards,
Graham
=E2=80=94


From dev-return-84084-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Tue Oct  6 11:44:46 2015
Return-Path: <dev-return-84084-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 5AD9F17D15
	for <apmail-httpd-dev-archive@www.apache.org>; Tue,  6 Oct 2015 11:44:46 +0000 (UTC)
Received: (qmail 14370 invoked by uid 500); 6 Oct 2015 11:44:45 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 14303 invoked by uid 500); 6 Oct 2015 11:44:45 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 14294 invoked by uid 99); 6 Oct 2015 11:44:45 -0000
Received: from mail-relay.apache.org (HELO mail-relay.apache.org) (140.211.11.15)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 06 Oct 2015 11:44:45 +0000
Received: from [192.168.1.37] (2804ds5-soeb.0.fullrate.dk [90.184.204.23])
	by mail-relay.apache.org (ASF Mail Server at mail-relay.apache.org) with ESMTPSA id 5EA1F1A0180
	for <dev@httpd.apache.org>; Tue,  6 Oct 2015 11:44:45 +0000 (UTC)
Subject: Re: T&R of 2.4.17 this week
To: dev@httpd.apache.org
References: <9ACC24A9-B381-4C18-B1C4-8D9F62DD7DB5@jaguNET.com>
 <pony-f85cc4d67b0b00a9017135e4201b9225b5053fac-77df7fd67f3d84a95adef90a63718ce375646916@dev@httpd.apache.org>
From: Daniel Gruno <humbedooh@apache.org>
Message-ID: <5613B427.1050700@apache.org>
Date: Tue, 6 Oct 2015 13:44:39 +0200
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:38.0) Gecko/20100101
 Thunderbird/38.3.0
MIME-Version: 1.0
In-Reply-To: <pony-f85cc4d67b0b00a9017135e4201b9225b5053fac-77df7fd67f3d84a95adef90a63718ce375646916@dev@httpd.apache.org>
Content-Type: text/plain; charset=windows-1252
Content-Transfer-Encoding: 7bit

On 10/05/2015 06:35 PM, Daniel Gruno wrote:
> +1!
> There's so much new goodness we have to share! :)
> 
> On 10/5/2015, 5:54:04 PM, Jim Jagielski <jim@jaguNET.com> wrote: 
>> I propose a T&R of 2.4.17 this week with a release for next. I
>> will RM.
>>
>> Comments?
>>

Also, if someone could verify that the tweaks I made to mod_lua makes it
compile properly on Ubutnu 14.04 (with lua5.2-dev installed), that would
be super swell!

With regards,
Daniel.

From dev-return-84085-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Tue Oct  6 12:01:36 2015
Return-Path: <dev-return-84085-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 96BF317DC0
	for <apmail-httpd-dev-archive@www.apache.org>; Tue,  6 Oct 2015 12:01:36 +0000 (UTC)
Received: (qmail 51999 invoked by uid 500); 6 Oct 2015 12:01:36 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 51920 invoked by uid 500); 6 Oct 2015 12:01:36 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 51910 invoked by uid 99); 6 Oct 2015 12:01:36 -0000
Received: from Unknown (HELO spamd3-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 06 Oct 2015 12:01:36 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd3-us-west.apache.org (ASF Mail Server at spamd3-us-west.apache.org) with ESMTP id A349C180A21
	for <dev@httpd.apache.org>; Tue,  6 Oct 2015 12:01:35 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd3-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 2.9
X-Spam-Level: **
X-Spam-Status: No, score=2.9 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	HTML_MESSAGE=3, SPF_PASS=-0.001, URIBL_BLOCKED=0.001]
	autolearn=disabled
Authentication-Results: spamd3-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-us-west.apache.org ([10.40.0.8])
	by localhost (spamd3-us-west.apache.org [10.40.0.10]) (amavisd-new, port 10024)
	with ESMTP id lmcx5gOkBBTo for <dev@httpd.apache.org>;
	Tue,  6 Oct 2015 12:01:26 +0000 (UTC)
Received: from mail-io0-f182.google.com (mail-io0-f182.google.com [209.85.223.182])
	by mx1-us-west.apache.org (ASF Mail Server at mx1-us-west.apache.org) with ESMTPS id 504262031C
	for <dev@httpd.apache.org>; Tue,  6 Oct 2015 12:01:26 +0000 (UTC)
Received: by ioiz6 with SMTP id z6so218179255ioi.2
        for <dev@httpd.apache.org>; Tue, 06 Oct 2015 05:01:25 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        bh=+Rxki0CY7R6PjwUSHHAfH2GXtP1v2dj+qAL5UdPjW7s=;
        b=VAasxmEYrq++MLbANQCCgVs24ykm4LVbQbf6zAyV06IrXKQuiryXJEV0ITzL3/1DGO
         hlSb3epLQMHO1OnaSK4Ue0O/6UQyJe9izXYalmN7i1S8OOrJWxIkpt73jU/0amNJBghC
         HNSv0t2I1DOlWVhrBK0MoHJf7zdaer4XCEc7aubJhO6b84Mn7+QL4nNgLP6kq/rcb7aF
         URvCvrdwV0p6sxf+ZCY17AAQSCXK2tJKGhqQZNf4g2eBHalQRZqqx9JMs6XKh/EHQXIN
         poPTTLYnSJ4I9ctWOIxCLk5dnz/xLHwCe33JMbS3bvIy+dhjw//UFm+5OYI1YB50PMGp
         35Ag==
MIME-Version: 1.0
X-Received: by 10.107.6.65 with SMTP id 62mr39852984iog.147.1444132885813;
 Tue, 06 Oct 2015 05:01:25 -0700 (PDT)
Received: by 10.36.37.18 with HTTP; Tue, 6 Oct 2015 05:01:25 -0700 (PDT)
In-Reply-To: <5613B427.1050700@apache.org>
References: <9ACC24A9-B381-4C18-B1C4-8D9F62DD7DB5@jaguNET.com>
	<5613B427.1050700@apache.org>
Date: Tue, 6 Oct 2015 08:01:25 -0400
Message-ID: <CAKUrXK7k_o_VnZp6AH7Vn-fS-F0BEuTn3u5S4LY+ipOwjRKZKw@mail.gmail.com>
Subject: Re: T&R of 2.4.17 this week
From: Jeff Trawick <trawick@gmail.com>
To: Apache HTTP Server Development List <dev@httpd.apache.org>
Content-Type: multipart/alternative; boundary=001a113f8d44aae13105216e634a

--001a113f8d44aae13105216e634a
Content-Type: text/plain; charset=UTF-8

On Tue, Oct 6, 2015 at 7:44 AM, Daniel Gruno <humbedooh@apache.org> wrote:

> On 10/05/2015 06:35 PM, Daniel Gruno wrote:
> > +1!
> > There's so much new goodness we have to share! :)
> >
> > On 10/5/2015, 5:54:04 PM, Jim Jagielski <jim@jaguNET.com> wrote:
> >> I propose a T&R of 2.4.17 this week with a release for next. I
> >> will RM.
> >>
> >> Comments?
> >>
>
> Also, if someone could verify that the tweaks I made to mod_lua makes it
> compile properly on Ubutnu 14.04 (with lua5.2-dev installed), that would
> be super swell!
>
>
The build looks okay here, but I haven't tried any scripts...

VERSION="14.04.3 LTS, Trusty Tahr"

liblua5.2-0:amd64 install
liblua5.2-dev:amd64 install

checking whether to enable mod_lua... checking dependencies
checking for pow in -lm... yes
checking for sqrt in -lm... yes
checking for lua.h in ./include/lua-5.2... no
checking for lua.h in ./include/lua5.2... no
checking for lua.h in ./include/lua52... no
checking for lua.h in ./include... no
checking for lua.h in ./include/lua-5.1... no
checking for lua.h in ./include/lua5.1... no
checking for lua.h in ./include/lua51... no
checking for lua.h in /usr/local/include/lua-5.2... no
checking for lua.h in /usr/local/include/lua5.2... no
checking for lua.h in /usr/local/include/lua52... no
checking for lua.h in /usr/local/include... no
checking for lua.h in /usr/local/include/lua-5.1... no
checking for lua.h in /usr/local/include/lua5.1... no
checking for lua.h in /usr/local/include/lua51... no
checking for lua.h in /usr/include/lua-5.2... no
checking for lua.h in /usr/include/lua5.2... yes
checking for luaL_newstate in -llua5.2... yes
configure: using '-L/usr/lib -llua5.2 -lm' for Lua Library
  setting MOD_INCLUDES to "-I/usr/include/lua5.2"
  setting MOD_LUA_LDADD to "-L/usr/lib -llua5.2 -lm"
checking whether to enable mod_lua... shared
  adding "-I$(top_srcdir)/modules/lua" to INCLUDES

(no compile warnings)

$ ~/inst/24-64/bin/apachectl -M | grep lua
 lua_module (shared)


With regards,
> Daniel.
>



-- 
Born in Roswell... married an alien...
http://emptyhammock.com/

--001a113f8d44aae13105216e634a
Content-Type: text/html; charset=UTF-8
Content-Transfer-Encoding: quoted-printable

<div dir=3D"ltr"><div class=3D"gmail_extra"><div class=3D"gmail_quote">On T=
ue, Oct 6, 2015 at 7:44 AM, Daniel Gruno <span dir=3D"ltr">&lt;<a href=3D"m=
ailto:humbedooh@apache.org" target=3D"_blank">humbedooh@apache.org</a>&gt;<=
/span> wrote:<br><blockquote class=3D"gmail_quote" style=3D"margin:0px 0px =
0px 0.8ex;border-left-width:1px;border-left-color:rgb(204,204,204);border-l=
eft-style:solid;padding-left:1ex"><span class=3D"">On 10/05/2015 06:35 PM, =
Daniel Gruno wrote:<br>
&gt; +1!<br>
&gt; There&#39;s so much new goodness we have to share! :)<br>
&gt;<br>
&gt; On 10/5/2015, 5:54:04 PM, Jim Jagielski &lt;jim@jaguNET.com&gt; wrote:=
<br>
</span><div><div class=3D"h5">&gt;&gt; I propose a T&amp;R of 2.4.17 this w=
eek with a release for next. I<br>
&gt;&gt; will RM.<br>
&gt;&gt;<br>
&gt;&gt; Comments?<br>
&gt;&gt;<br>
<br>
</div></div>Also, if someone could verify that the tweaks I made to mod_lua=
 makes it<br>
compile properly on Ubutnu 14.04 (with lua5.2-dev installed), that would<br=
>
be super swell!<br>
<br></blockquote><div><br></div><div>The build looks okay here, but I haven=
&#39;t tried any scripts...</div><div><br></div><div>VERSION=3D&quot;14.04.=
3 LTS, Trusty Tahr&quot;<br></div><div><br></div><div><div>liblua5.2-0:amd6=
4<span class=3D"" style=3D"white-space:pre">				</span>install</div><div>li=
blua5.2-dev:amd64<span class=3D"" style=3D"white-space:pre">				</span>inst=
all</div></div><div><br></div><div>checking whether to enable mod_lua... ch=
ecking dependencies</div><div>checking for pow in -lm... yes</div><div>chec=
king for sqrt in -lm... yes</div><div>checking for lua.h in ./include/lua-5=
.2... no</div><div>checking for lua.h in ./include/lua5.2... no</div><div>c=
hecking for lua.h in ./include/lua52... no</div><div>checking for lua.h in =
./include... no</div><div>checking for lua.h in ./include/lua-5.1... no</di=
v><div>checking for lua.h in ./include/lua5.1... no</div><div>checking for =
lua.h in ./include/lua51... no</div><div>checking for lua.h in /usr/local/i=
nclude/lua-5.2... no</div><div>checking for lua.h in /usr/local/include/lua=
5.2... no</div><div>checking for lua.h in /usr/local/include/lua52... no</d=
iv><div>checking for lua.h in /usr/local/include... no</div><div>checking f=
or lua.h in /usr/local/include/lua-5.1... no</div><div>checking for lua.h i=
n /usr/local/include/lua5.1... no</div><div>checking for lua.h in /usr/loca=
l/include/lua51... no</div><div>checking for lua.h in /usr/include/lua-5.2.=
.. no</div><div>checking for lua.h in /usr/include/lua5.2... yes</div><div>=
checking for luaL_newstate in -llua5.2... yes</div><div>configure: using &#=
39;-L/usr/lib -llua5.2 -lm&#39; for Lua Library</div><div>=C2=A0 setting MO=
D_INCLUDES to &quot;-I/usr/include/lua5.2&quot;</div><div>=C2=A0 setting MO=
D_LUA_LDADD to &quot;-L/usr/lib -llua5.2 -lm&quot;</div><div>checking wheth=
er to enable mod_lua... shared</div><div>=C2=A0 adding &quot;-I$(top_srcdir=
)/modules/lua&quot; to INCLUDES=C2=A0</div><div><br></div><div>(no compile =
warnings)</div><div><br></div><div>$ ~/inst/24-64/bin/apachectl -M | grep l=
ua<br></div><div>=C2=A0lua_module (shared)<br></div><div><br></div><div><br=
></div><blockquote class=3D"gmail_quote" style=3D"margin:0px 0px 0px 0.8ex;=
border-left-width:1px;border-left-color:rgb(204,204,204);border-left-style:=
solid;padding-left:1ex">
With regards,<br>
Daniel.<br>
</blockquote></div><br><br clear=3D"all"><div><br></div>-- <br><div class=
=3D"gmail_signature"><div dir=3D"ltr">Born in Roswell... married an alien..=
.<br><a href=3D"http://emptyhammock.com/" target=3D"_blank">http://emptyham=
mock.com/</a><div><br></div></div></div>
</div></div>

--001a113f8d44aae13105216e634a--

From dev-return-84086-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Tue Oct  6 12:08:31 2015
Return-Path: <dev-return-84086-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 3910C17DF9
	for <apmail-httpd-dev-archive@www.apache.org>; Tue,  6 Oct 2015 12:08:31 +0000 (UTC)
Received: (qmail 64264 invoked by uid 500); 6 Oct 2015 12:08:30 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 64200 invoked by uid 500); 6 Oct 2015 12:08:30 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 64191 invoked by uid 99); 6 Oct 2015 12:08:30 -0000
Received: from mail-relay.apache.org (HELO mail-relay.apache.org) (140.211.11.15)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 06 Oct 2015 12:08:30 +0000
Received: from [192.168.1.37] (2804ds5-soeb.0.fullrate.dk [90.184.204.23])
	by mail-relay.apache.org (ASF Mail Server at mail-relay.apache.org) with ESMTPSA id 10B5E1A0163
	for <dev@httpd.apache.org>; Tue,  6 Oct 2015 12:08:29 +0000 (UTC)
Subject: Re: T&R of 2.4.17 this week
To: dev@httpd.apache.org
References: <9ACC24A9-B381-4C18-B1C4-8D9F62DD7DB5@jaguNET.com>
 <5613B427.1050700@apache.org>
 <CAKUrXK7k_o_VnZp6AH7Vn-fS-F0BEuTn3u5S4LY+ipOwjRKZKw@mail.gmail.com>
From: Daniel Gruno <humbedooh@apache.org>
Message-ID: <5613B9BB.7080101@apache.org>
Date: Tue, 6 Oct 2015 14:08:27 +0200
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:38.0) Gecko/20100101
 Thunderbird/38.3.0
MIME-Version: 1.0
In-Reply-To: <CAKUrXK7k_o_VnZp6AH7Vn-fS-F0BEuTn3u5S4LY+ipOwjRKZKw@mail.gmail.com>
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit

On 10/06/2015 02:01 PM, Jeff Trawick wrote:
> On Tue, Oct 6, 2015 at 7:44 AM, Daniel Gruno <humbedooh@apache.org
> <mailto:humbedooh@apache.org>> wrote:
> 
>     On 10/05/2015 06:35 PM, Daniel Gruno wrote:
>     > +1!
>     > There's so much new goodness we have to share! :)
>     >
>     > On 10/5/2015, 5:54:04 PM, Jim Jagielski <jim@jaguNET.com> wrote:
>     >> I propose a T&R of 2.4.17 this week with a release for next. I
>     >> will RM.
>     >>
>     >> Comments?
>     >>
> 
>     Also, if someone could verify that the tweaks I made to mod_lua makes it
>     compile properly on Ubutnu 14.04 (with lua5.2-dev installed), that would
>     be super swell!
> 
> 
> The build looks okay here, but I haven't tried any scripts...

Awesome, as long as the .so file gets built, I'm happy :)
Thanks for checking!

With regards,
Daniel.

From dev-return-84087-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Tue Oct  6 13:32:12 2015
Return-Path: <dev-return-84087-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 71AC518160
	for <apmail-httpd-dev-archive@www.apache.org>; Tue,  6 Oct 2015 13:32:12 +0000 (UTC)
Received: (qmail 58704 invoked by uid 500); 6 Oct 2015 13:32:11 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 58618 invoked by uid 500); 6 Oct 2015 13:32:11 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 58608 invoked by uid 99); 6 Oct 2015 13:32:11 -0000
Received: from Unknown (HELO spamd1-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 06 Oct 2015 13:32:11 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd1-us-west.apache.org (ASF Mail Server at spamd1-us-west.apache.org) with ESMTP id 6BF1FC3AC4
	for <dev@httpd.apache.org>; Tue,  6 Oct 2015 13:32:11 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd1-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.102
X-Spam-Level:
X-Spam-Status: No, score=-0.102 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RCVD_IN_MSPIKE_H2=-0.001, SPF_PASS=-0.001] autolearn=disabled
Authentication-Results: spamd1-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-us-west.apache.org ([10.40.0.8])
	by localhost (spamd1-us-west.apache.org [10.40.0.7]) (amavisd-new, port 10024)
	with ESMTP id PMtWil0hRerE for <dev@httpd.apache.org>;
	Tue,  6 Oct 2015 13:32:10 +0000 (UTC)
Received: from mail-qg0-f54.google.com (mail-qg0-f54.google.com [209.85.192.54])
	by mx1-us-west.apache.org (ASF Mail Server at mx1-us-west.apache.org) with ESMTPS id 680D620756
	for <dev@httpd.apache.org>; Tue,  6 Oct 2015 13:32:10 +0000 (UTC)
Received: by qgx61 with SMTP id 61so174298458qgx.3
        for <dev@httpd.apache.org>; Tue, 06 Oct 2015 06:32:09 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        bh=9zR2ScpNWYAHSYeTeUsM1QQw4lHimmlERC8/TVOhw5o=;
        b=BzoIXkEczwSgtjPNMUqZ6+zn6SSnl7oRd55e6abQ2xrMaB0TL1ByjF0P7/X/xSYstd
         Xr/Qm2wHl6Wp6QlegmwNMAMb9dv2hPWy6W4JbYLtvUAnalbd/CQEnFvdm8hhrUIEBJ0G
         BaLdC+hp+0SXnlsytuKfjkqW41OignczzsnPlp9qJrHH6CBNy/nNhhjxaAhaf4mp5Bv3
         C7F9wTIpm2mMVKDACqi8gjD0wV/gYb3nl/jvSR/NUO8/uX1W+p43voin38YRB9Li0PUE
         xJ1aBFnN6jYz+00KlhlZNx3jcnc+dTVfSplC5RXZfJ5bZhI0L3KE3cTcaVboiuDrOuse
         2sMw==
MIME-Version: 1.0
X-Received: by 10.140.131.70 with SMTP id 67mr50877570qhd.70.1444138329536;
 Tue, 06 Oct 2015 06:32:09 -0700 (PDT)
Received: by 10.55.72.20 with HTTP; Tue, 6 Oct 2015 06:32:09 -0700 (PDT)
In-Reply-To: <20151004101052.A6E193A0234@svn01-us-west.apache.org>
References: <20151004101052.A6E193A0234@svn01-us-west.apache.org>
Date: Tue, 6 Oct 2015 15:32:09 +0200
Message-ID: <CAKQ1sVNRVJqqZSmzVn86K3SbztGSBQ68D2kTJRhWU1qMWDrUYA@mail.gmail.com>
Subject: Re: svn commit: r1706669 - in /httpd/httpd/trunk: ./ include/
 modules/http/ modules/ssl/ server/ server/mpm/event/ server/mpm/motorz/ server/mpm/simple/
From: Yann Ylavic <ylavic.dev@gmail.com>
To: dev@httpd.apache.org
Content-Type: text/plain; charset=UTF-8

On Sun, Oct 4, 2015 at 12:10 PM,  <minfrin@apache.org> wrote:
> Author: minfrin
> Date: Sun Oct  4 10:10:51 2015
> New Revision: 1706669
>
> URL: http://svn.apache.org/viewvc?rev=1706669&view=rev
> Log:
> core: Extend support for asynchronous write completion from the
> network filter to any connection or request filter.

Just wanted to run the tests framework on trunk for a local change but
it seems that this commit (bisected to) makes many tests to segfault.

Here is the backtrace:

Program terminated with signal 6, Aborted.
(gdb) bt
#0  0x00007f1984bd1ed5 in *__GI_raise (sig=<optimized out>) at
../nptl/sysdeps/unix/sysv/linux/raise.c:64
#1  0x00007f1984bd4ce0 in *__GI_abort () at abort.c:92
#2  0x00007f1984c0b9db in __libc_message (do_abort=<optimized out>,
fmt=<optimized out>) at ../sysdeps/unix/sysv/linux/libc_fatal.c:189
#3  0x00007f1984c15236 in malloc_printerr (action=3,
str=0x7f1984ccce7e "corrupted double-linked list", ptr=<optimized
out>) at malloc.c:6296
#4  0x00007f1984c1566d in malloc_consolidate (av=<optimized out>) at
malloc.c:5174
#5  0x00007f1984c16b78 in _int_free (av=0x7f1984f04e40, p=0xc9f140) at
malloc.c:5047
#6  0x00007f1984c1a01c in *__GI___libc_free (mem=<optimized out>) at
malloc.c:3739
#7  0x00007f19859dad6f in allocator_free (allocator=0x9cf580,
node=0xc9f150) at memory/unix/apr_pools.c:474
#8  0x00007f19859db527 in apr_pool_destroy (pool=0xc91108) at
memory/unix/apr_pools.c:1016
#9  0x0000000000459dcf in eor_bucket_destroy (data=0xc91180) at eor_bucket.c:90
#10 0x00007f19859a6517 in apr_brigade_cleanup (data=0xc99b40) at
buckets/apr_brigade.c:51
#11 0x0000000000488c20 in ap_process_request_after_handler
(r=0xc91180) at http_request.c:283
#12 0x0000000000488f2c in ap_process_async_request (r=0xc91180) at
http_request.c:371
#13 0x0000000000488f58 in ap_process_request (r=0xc91180) at http_request.c:381
#14 0x0000000000485190 in ap_process_http_sync_connection (c=0xb21168)
at http_core.c:210
#15 0x000000000048529e in ap_process_http_connection (c=0xb21168) at
http_core.c:251
#16 0x0000000000478bf5 in ap_run_process_connection (c=0xb21168) at
connection.c:41
#17 0x00000000004790d7 in ap_process_connection (c=0xb21168,
csd=0xb20f50) at connection.c:206
#18 0x00007f197bb3b8fb in process_socket (thd=0x944940, p=0xb20ec8,
sock=0xb20f50, my_child_num=0, my_thread_num=0, bucket_alloc=0xc4aed8)
at worker.c:632
#19 0x00007f197bb3c576 in worker_thread (thd=0x944940, dummy=0x9c8b90)
at worker.c:992
#20 0x00007f19859ea6af in dummy_worker (opaque=0x944940) at
threadproc/unix/thread.c:145
#21 0x00007f198533b8ca in start_thread (arg=<optimized out>) at
pthread_create.c:300
#22 0x00007f1984c7608d in clone () at
../sysdeps/unix/sysv/linux/x86_64/clone.S:112
#23 0x0000000000000000 in ?? ()
(gdb) frame 11
#11 0x0000000000488c20 in ap_process_request_after_handler
(r=0xc91180) at http_request.c:283
283         apr_brigade_cleanup(bb);
(gdb) l 280
275         ap_pass_brigade(r->output_filters, bb);
276
277         /* The EOR bucket has either been handled by an output filter (eg.
278          * deleted or moved to a buffered_bb => no more in bb), or an error
279          * occured before that (eg. c->aborted => still in bb) and we ought
280          * to destroy it now. So cleanup any remaining bucket along with
281          * the orphan request (if any).
282          */
283         apr_brigade_cleanup(bb);
284

So it seems to relate to the EOR bucket, first not being passed
through, and second leading to a double-free or alike.

Did not investigate further...

Regards,
Yann.

From dev-return-84089-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Tue Oct  6 13:37:12 2015
Return-Path: <dev-return-84089-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id DC9A1181A5
	for <apmail-httpd-dev-archive@www.apache.org>; Tue,  6 Oct 2015 13:37:11 +0000 (UTC)
Received: (qmail 68123 invoked by uid 500); 6 Oct 2015 13:37:08 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 68050 invoked by uid 500); 6 Oct 2015 13:37:08 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 68040 invoked by uid 99); 6 Oct 2015 13:37:08 -0000
Received: from Unknown (HELO spamd4-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 06 Oct 2015 13:37:08 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd4-us-west.apache.org (ASF Mail Server at spamd4-us-west.apache.org) with ESMTP id 046B7C0419
	for <dev@httpd.apache.org>; Tue,  6 Oct 2015 13:37:08 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd4-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.01
X-Spam-Level:
X-Spam-Status: No, score=-0.01 tagged_above=-999 required=6.31
	tests=[SPF_PASS=-0.001, T_RP_MATCHES_RCVD=-0.01, URIBL_BLOCKED=0.001]
	autolearn=disabled
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd4-us-west.apache.org [10.40.0.11]) (amavisd-new, port 10024)
	with ESMTP id TL5M1dr7eDoj for <dev@httpd.apache.org>;
	Tue,  6 Oct 2015 13:37:00 +0000 (UTC)
Received: from mail.greenbytes.de (mail.greenbytes.de [217.91.35.233])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id EA63D25426
	for <dev@httpd.apache.org>; Tue,  6 Oct 2015 13:36:59 +0000 (UTC)
Received: from [192.168.1.42] (unknown [5.10.171.186])
	(using TLSv1 with cipher ECDHE-RSA-AES256-SHA (256/256 bits))
	(Client did not present a certificate)
	by mail.greenbytes.de (Postfix) with ESMTPSA id 0541515A05BC
	for <dev@httpd.apache.org>; Tue,  6 Oct 2015 15:36:52 +0200 (CEST)
Content-Type: text/plain; charset=utf-8
Mime-Version: 1.0 (Mac OS X Mail 8.2 \(2104\))
Subject: Re: svn commit: r1706669 - in /httpd/httpd/trunk: ./ include/ modules/http/ modules/ssl/ server/ server/mpm/event/ server/mpm/motorz/ server/mpm/simple/
From: Stefan Eissing <stefan.eissing@greenbytes.de>
In-Reply-To: <3D610873-CC12-4E94-AAAA-49C4998202D6@sharp.fm>
Date: Tue, 6 Oct 2015 15:36:52 +0200
Content-Transfer-Encoding: quoted-printable
Message-Id: <86D1AB4B-554E-4C37-BF67-DCFB05DF6A49@greenbytes.de>
References: <CAKQ1sVMoxQe=8iAQ=oUSRJhrpy0o8RpJ=+u_CXecw8UbTj_NOg@mail.gmail.com> <2791C826-8CFB-4DC9-B6AF-566DF625B154@sharp.fm> <AB1691BE05AE7F4992697F2A0835627AC633D8A1@VOEXM10W.internal.vodafone.com> <B4A85802-BF21-41F1-B2DC-18FDD2AC9AE6@sharp.fm> <3D610873-CC12-4E94-AAAA-49C4998202D6@sharp.fm>
To: dev@httpd.apache.org
X-Mailer: Apple Mail (2.2104)

FYI: /trunk no longer works with mod_http2. 2.4.x does. I see missing =
response data, it seems, so the most likely cause are the changes in =
filter handling. Did not find the time to investigate further.

Please be aware the mod_h2 uses pool/brigade hierarchies in new and =
unexpected ways. The request has been processed and EOR bucket has been =
handled in another thread, however data/file handles might have been =
transferred to the main thread and are being cleaned up when the main =
connection thinks a stream is done. If those data gets set aside, the =
memory might get freed/reused too early. Maybe mod_http2 needs to come =
up with its own EOR buckets on the main connection to allow for cleanup =
synchronization. Not sure...

//Stefan

> Am 06.10.2015 um 13:18 schrieb Graham Leggett <minfrin@sharp.fm>:
>=20
> On 06 Oct 2015, at 12:36 PM, Graham Leggett <minfrin@sharp.fm> wrote:
>=20
>>> How can you be sure that you don't have transient buckets in the =
brigade that point to memory that changed or is invalid, once you =
reinstate the brigade?
>>=20
>> Because it=E2=80=99s a request filter, not a connection filter. =
Request filters set aside brigades all the time in their local contexts, =
this is normal.
>=20
> I see what you mean - transient buckets specifically will need to be =
setaside before the loop ends. Will take a look.
>=20
> Regards,
> Graham
> =E2=80=94
>=20

<green/>bytes GmbH
Hafenweg 16, 48155 M=C3=BCnster, Germany
Phone: +49 251 2807760. Amtsgericht M=C3=BCnster: HRB5782




From dev-return-84088-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Tue Oct  6 13:37:18 2015
Return-Path: <dev-return-84088-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 00AF1181AD
	for <apmail-httpd-dev-archive@www.apache.org>; Tue,  6 Oct 2015 13:37:18 +0000 (UTC)
Received: (qmail 65122 invoked by uid 500); 6 Oct 2015 13:36:19 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 65061 invoked by uid 500); 6 Oct 2015 13:36:19 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 65051 invoked by uid 99); 6 Oct 2015 13:36:19 -0000
Received: from Unknown (HELO spamd3-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 06 Oct 2015 13:36:19 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd3-us-west.apache.org (ASF Mail Server at spamd3-us-west.apache.org) with ESMTP id B7963180A49
	for <dev@httpd.apache.org>; Tue,  6 Oct 2015 13:36:18 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd3-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.121
X-Spam-Level:
X-Spam-Status: No, score=-0.121 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RCVD_IN_MSPIKE_H3=-0.01, RCVD_IN_MSPIKE_WL=-0.01, SPF_PASS=-0.001]
	autolearn=disabled
Authentication-Results: spamd3-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd3-us-west.apache.org [10.40.0.10]) (amavisd-new, port 10024)
	with ESMTP id NsTwBqq3z4Sd for <dev@httpd.apache.org>;
	Tue,  6 Oct 2015 13:36:18 +0000 (UTC)
Received: from mail-qk0-f177.google.com (mail-qk0-f177.google.com [209.85.220.177])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id F3F56429AA
	for <dev@httpd.apache.org>; Tue,  6 Oct 2015 13:36:17 +0000 (UTC)
Received: by qkap81 with SMTP id p81so85869564qka.2
        for <dev@httpd.apache.org>; Tue, 06 Oct 2015 06:36:17 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        bh=Spiz5f0hP66BrSFBv2QO1o/gTzS2g7QVMlxml2qP4zc=;
        b=EIvpYntFaCImE8nuIyKEZZsnQXuJd6imk2uwcqG35hZPWurZlWS/A2D4aLyFqhDymM
         1ymg+4kWstO5IFZZSYXP1pu+Hp1u15x/pBIKjNymh7xTTBEzPmOb0/WL53ylYLaJnUIJ
         r01pJ4kPq7tgWu7uqhFUZcWU8XApKkxBrcY0Q6HBajKVpZMsgRkKUNPI95EHIwwyDxbi
         erpT+7TxfFUCpLPkLviKXbVwCeiw8PS4vrS9TrVDavLb1JHVJM0S3DZ771CoxotKdmPt
         USdx4okf9EyZC8u8DZjBc7Dgc4rOKB2DBOMBmbOuJ7pxoZMtuO9DqqED16YpN575+kZY
         He+g==
MIME-Version: 1.0
X-Received: by 10.55.215.156 with SMTP id t28mr9851193qkt.68.1444138577746;
 Tue, 06 Oct 2015 06:36:17 -0700 (PDT)
Received: by 10.55.72.20 with HTTP; Tue, 6 Oct 2015 06:36:17 -0700 (PDT)
In-Reply-To: <CAKQ1sVNRVJqqZSmzVn86K3SbztGSBQ68D2kTJRhWU1qMWDrUYA@mail.gmail.com>
References: <20151004101052.A6E193A0234@svn01-us-west.apache.org>
	<CAKQ1sVNRVJqqZSmzVn86K3SbztGSBQ68D2kTJRhWU1qMWDrUYA@mail.gmail.com>
Date: Tue, 6 Oct 2015 15:36:17 +0200
Message-ID: <CAKQ1sVNorBV4am8CCygpdYFy+ceQbqDavsJQu8nO=wB2LPOdnA@mail.gmail.com>
Subject: Re: svn commit: r1706669 - in /httpd/httpd/trunk: ./ include/
 modules/http/ modules/ssl/ server/ server/mpm/event/ server/mpm/motorz/ server/mpm/simple/
From: Yann Ylavic <ylavic.dev@gmail.com>
To: dev@httpd.apache.org
Content-Type: text/plain; charset=UTF-8

On Tue, Oct 6, 2015 at 3:32 PM, Yann Ylavic <ylavic.dev@gmail.com> wrote:
>
> Just wanted to run the tests framework on trunk for a local change but
> it seems that this commit (bisected to) makes many tests to segfault.

Forgot to mention, same thing with follow up r1706670 applied.

From dev-return-84090-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Tue Oct  6 13:41:35 2015
Return-Path: <dev-return-84090-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 5B8FE181E1
	for <apmail-httpd-dev-archive@www.apache.org>; Tue,  6 Oct 2015 13:41:35 +0000 (UTC)
Received: (qmail 89563 invoked by uid 500); 6 Oct 2015 13:41:19 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 89498 invoked by uid 500); 6 Oct 2015 13:41:19 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 89488 invoked by uid 99); 6 Oct 2015 13:41:19 -0000
Received: from Unknown (HELO spamd2-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 06 Oct 2015 13:41:19 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd2-us-west.apache.org (ASF Mail Server at spamd2-us-west.apache.org) with ESMTP id A61A01A2109
	for <dev@httpd.apache.org>; Tue,  6 Oct 2015 13:41:18 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd2-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 0.603
X-Spam-Level:
X-Spam-Status: No, score=0.603 tagged_above=-999 required=6.31
	tests=[RCVD_IN_SORBS_WEB=0.614, SPF_PASS=-0.001,
	T_RP_MATCHES_RCVD=-0.01] autolearn=disabled
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd2-us-west.apache.org [10.40.0.9]) (amavisd-new, port 10024)
	with ESMTP id gZu0MWzanqbD for <dev@httpd.apache.org>;
	Tue,  6 Oct 2015 13:41:17 +0000 (UTC)
Received: from monica.sharp.fm (monica.sharp.fm [80.168.143.5])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTP id 71EAA429AA
	for <dev@httpd.apache.org>; Tue,  6 Oct 2015 13:41:17 +0000 (UTC)
Received: from [10.1.243.57] (dab-hlw1-h-1-5.dab.02.net [82.132.233.233])
	(using TLSv1 with cipher DHE-RSA-AES256-SHA (256/256 bits))
	(Client did not present a certificate)
	(Authenticated sender: minfrin@sharp.fm)
	by monica.sharp.fm (Postfix) with ESMTPSA id 9FB9583142
	for <dev@httpd.apache.org>; Tue,  6 Oct 2015 14:41:16 +0100 (BST)
From: Graham Leggett <minfrin@sharp.fm>
Content-Type: text/plain;
	charset=us-ascii
Content-Transfer-Encoding: quoted-printable
Mime-Version: 1.0 (1.0)
Subject: Re: svn commit: r1706669 - in /httpd/httpd/trunk: ./ include/ modules/http/ modules/ssl/ server/ server/mpm/event/ server/mpm/motorz/ server/mpm/simple/
Message-Id: <9A9FBD0C-B503-4CDD-A833-74C69FF248EA@sharp.fm>
Date: Tue, 6 Oct 2015 14:41:13 +0100
References: <20151004101052.A6E193A0234@svn01-us-west.apache.org> <CAKQ1sVNRVJqqZSmzVn86K3SbztGSBQ68D2kTJRhWU1qMWDrUYA@mail.gmail.com>
In-Reply-To: <CAKQ1sVNRVJqqZSmzVn86K3SbztGSBQ68D2kTJRhWU1qMWDrUYA@mail.gmail.com>
To: "dev@httpd.apache.org" <dev@httpd.apache.org>
X-Mailer: iPhone Mail (12H321)

On 6 Oct 2015, at 14:32, Yann Ylavic <ylavic.dev@gmail.com> wrote:

> So it seems to relate to the EOR bucket, first not being passed
> through, and second leading to a double-free or alike.
>=20
> Did not investigate further...

Did you rebuild you tree completely clean before trying it out?

Whenever I got weird behavior a clean rebuild sorted it out. The full test s=
uite works fine for me using the event mpm.

Regards,
Graham
--


From dev-return-84091-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Tue Oct  6 13:51:06 2015
Return-Path: <dev-return-84091-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id D67A318244
	for <apmail-httpd-dev-archive@www.apache.org>; Tue,  6 Oct 2015 13:51:06 +0000 (UTC)
Received: (qmail 16621 invoked by uid 500); 6 Oct 2015 13:51:06 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 16528 invoked by uid 500); 6 Oct 2015 13:51:06 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 16518 invoked by uid 99); 6 Oct 2015 13:51:06 -0000
Received: from Unknown (HELO spamd4-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 06 Oct 2015 13:51:06 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd4-us-west.apache.org (ASF Mail Server at spamd4-us-west.apache.org) with ESMTP id 0487BC0419
	for <dev@httpd.apache.org>; Tue,  6 Oct 2015 13:51:06 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd4-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.12
X-Spam-Level:
X-Spam-Status: No, score=-0.12 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RCVD_IN_MSPIKE_H3=-0.01, RCVD_IN_MSPIKE_WL=-0.01, SPF_PASS=-0.001,
	URIBL_BLOCKED=0.001] autolearn=disabled
Authentication-Results: spamd4-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd4-us-west.apache.org [10.40.0.11]) (amavisd-new, port 10024)
	with ESMTP id D5DcBBiLqj2S for <dev@httpd.apache.org>;
	Tue,  6 Oct 2015 13:51:01 +0000 (UTC)
Received: from mail-qk0-f178.google.com (mail-qk0-f178.google.com [209.85.220.178])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id 224F6204C8
	for <dev@httpd.apache.org>; Tue,  6 Oct 2015 13:51:01 +0000 (UTC)
Received: by qkap81 with SMTP id p81so86081779qka.2
        for <dev@httpd.apache.org>; Tue, 06 Oct 2015 06:51:00 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        bh=0aeicLqS+QlWtfoAb0ECLrfP9AtmYqh8wU955/heZys=;
        b=HgYDHnRrOHfViDqu7eUJ31vA0z5/Y3NljJcaMo/MXNJ+MUsnNAo6idimpZ4UugvfHb
         Nf4j72QdGSKvy+7Gh73qpBWgY1oi81YerJITlIO6L5Jez4+SBBIUszc2ZgDui/q/dxna
         pT27kJLp7sBMXvw044fGX4cHromZB7BLB1VDd9A+eu8RLTJLm5Q92fxwu6SFeJ/J/XAY
         e1KQ+FL9UDJv00/QaoiWcLy6Om75pKtqzVyUtomsOWMo7QtFgqqaD2F4a2H0wAB/HU+M
         FTeIHId31Oq0lS0atFmrGeTRQ9BvwIINS45MD9/jH0EfxC58JztR3JjamxacUlTWxESD
         l5Pw==
MIME-Version: 1.0
X-Received: by 10.55.15.134 with SMTP id 6mr1399182qkp.38.1444139460165; Tue,
 06 Oct 2015 06:51:00 -0700 (PDT)
Received: by 10.55.72.20 with HTTP; Tue, 6 Oct 2015 06:51:00 -0700 (PDT)
In-Reply-To: <9A9FBD0C-B503-4CDD-A833-74C69FF248EA@sharp.fm>
References: <20151004101052.A6E193A0234@svn01-us-west.apache.org>
	<CAKQ1sVNRVJqqZSmzVn86K3SbztGSBQ68D2kTJRhWU1qMWDrUYA@mail.gmail.com>
	<9A9FBD0C-B503-4CDD-A833-74C69FF248EA@sharp.fm>
Date: Tue, 6 Oct 2015 15:51:00 +0200
Message-ID: <CAKQ1sVN2WwBhbJ26JOdm7YFnMyXtOfAbCX1eCeUse7Zh1k8O5Q@mail.gmail.com>
Subject: Re: svn commit: r1706669 - in /httpd/httpd/trunk: ./ include/
 modules/http/ modules/ssl/ server/ server/mpm/event/ server/mpm/motorz/ server/mpm/simple/
From: Yann Ylavic <ylavic.dev@gmail.com>
To: dev@httpd.apache.org
Content-Type: text/plain; charset=UTF-8

On Tue, Oct 6, 2015 at 3:41 PM, Graham Leggett <minfrin@sharp.fm> wrote:
> On 6 Oct 2015, at 14:32, Yann Ylavic <ylavic.dev@gmail.com> wrote:
>
>> So it seems to relate to the EOR bucket, first not being passed
>> through, and second leading to a double-free or alike.
>>
>> Did not investigate further...
>
> Did you rebuild you tree completely clean before trying it out?
>
> Whenever I got weird behavior a clean rebuild sorted it out. The full test suite works fine for me using the event mpm.

Just did that, same thing.
I was using mpm_worker, but now tried mpm_event with same segfaults.

From dev-return-84092-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Tue Oct  6 13:53:04 2015
Return-Path: <dev-return-84092-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id A834D18254
	for <apmail-httpd-dev-archive@www.apache.org>; Tue,  6 Oct 2015 13:53:04 +0000 (UTC)
Received: (qmail 19642 invoked by uid 500); 6 Oct 2015 13:53:04 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 19566 invoked by uid 500); 6 Oct 2015 13:53:03 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 19556 invoked by uid 99); 6 Oct 2015 13:53:03 -0000
Received: from Unknown (HELO spamd3-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 06 Oct 2015 13:53:03 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd3-us-west.apache.org (ASF Mail Server at spamd3-us-west.apache.org) with ESMTP id 90838180DC7
	for <dev@httpd.apache.org>; Tue,  6 Oct 2015 13:53:03 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd3-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.102
X-Spam-Level:
X-Spam-Status: No, score=-0.102 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RCVD_IN_MSPIKE_H2=-0.001, SPF_PASS=-0.001] autolearn=disabled
Authentication-Results: spamd3-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd3-us-west.apache.org [10.40.0.10]) (amavisd-new, port 10024)
	with ESMTP id 3O24tbiTSgdJ for <dev@httpd.apache.org>;
	Tue,  6 Oct 2015 13:53:03 +0000 (UTC)
Received: from mail-qg0-f43.google.com (mail-qg0-f43.google.com [209.85.192.43])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id A13CD25426
	for <dev@httpd.apache.org>; Tue,  6 Oct 2015 13:53:02 +0000 (UTC)
Received: by qgt47 with SMTP id 47so174701801qgt.2
        for <dev@httpd.apache.org>; Tue, 06 Oct 2015 06:53:01 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        bh=Qp+CbwA3pwrtoDeC3hLSMVi230WkQ3/Ymg2YuiQqLm8=;
        b=dTxUgkuX+uWoUwrhyLGcRWK0BvmyxDMu7B45+oTaKpne04UC1VvoTZ4dKdiYcSUEfg
         wMoP340h4cjG+4X6W7Y1EpKEBq57qhdIixdaere+dAUGxVLOA3VhnaJdpNOwDi7fvt25
         1buiF4PeYHR8IAAQo15SgZ20OXPKThShUDE1CxvtYnQulcdynIJAW/WBqhWEPBI10RUn
         TUSZF2DdzYwg6abcyI58uAtB6y4KmMhwoAwB4kORydso+dVYrsMSFDIX5pfQEb40ZLEh
         0Co8TfGU2J+SIStcb4Vvy4BbPzzB1QROBd6iJf0AoDYk8+SvmtOv9wkgtC/63/iEIdpQ
         SR2Q==
MIME-Version: 1.0
X-Received: by 10.140.107.54 with SMTP id g51mr47427280qgf.38.1444139581741;
 Tue, 06 Oct 2015 06:53:01 -0700 (PDT)
Received: by 10.55.72.20 with HTTP; Tue, 6 Oct 2015 06:53:01 -0700 (PDT)
In-Reply-To: <CAKQ1sVN2WwBhbJ26JOdm7YFnMyXtOfAbCX1eCeUse7Zh1k8O5Q@mail.gmail.com>
References: <20151004101052.A6E193A0234@svn01-us-west.apache.org>
	<CAKQ1sVNRVJqqZSmzVn86K3SbztGSBQ68D2kTJRhWU1qMWDrUYA@mail.gmail.com>
	<9A9FBD0C-B503-4CDD-A833-74C69FF248EA@sharp.fm>
	<CAKQ1sVN2WwBhbJ26JOdm7YFnMyXtOfAbCX1eCeUse7Zh1k8O5Q@mail.gmail.com>
Date: Tue, 6 Oct 2015 15:53:01 +0200
Message-ID: <CAKQ1sVNRMUxi6AO978vqL5=g_JLM_=aY1AccqJ6czjOOXqe5Zw@mail.gmail.com>
Subject: Re: svn commit: r1706669 - in /httpd/httpd/trunk: ./ include/
 modules/http/ modules/ssl/ server/ server/mpm/event/ server/mpm/motorz/ server/mpm/simple/
From: Yann Ylavic <ylavic.dev@gmail.com>
To: dev@httpd.apache.org
Content-Type: text/plain; charset=UTF-8

On Tue, Oct 6, 2015 at 3:51 PM, Yann Ylavic <ylavic.dev@gmail.com> wrote:
>
> Just did that, same thing.
> I was using mpm_worker, but now tried mpm_event with same segfaults.

FWIW, I'm running an (old) Debian 6.0.10 (squeeze, 64bit).

From dev-return-84093-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Tue Oct  6 14:06:56 2015
Return-Path: <dev-return-84093-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 43540182BB
	for <apmail-httpd-dev-archive@www.apache.org>; Tue,  6 Oct 2015 14:06:56 +0000 (UTC)
Received: (qmail 56262 invoked by uid 500); 6 Oct 2015 14:06:33 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 56189 invoked by uid 500); 6 Oct 2015 14:06:33 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 56179 invoked by uid 99); 6 Oct 2015 14:06:33 -0000
Received: from Unknown (HELO spamd4-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 06 Oct 2015 14:06:33 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd4-us-west.apache.org (ASF Mail Server at spamd4-us-west.apache.org) with ESMTP id 4C0CAC0419
	for <dev@httpd.apache.org>; Tue,  6 Oct 2015 14:06:33 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd4-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.102
X-Spam-Level:
X-Spam-Status: No, score=-0.102 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RCVD_IN_MSPIKE_H2=-0.001, SPF_PASS=-0.001] autolearn=disabled
Authentication-Results: spamd4-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd4-us-west.apache.org [10.40.0.11]) (amavisd-new, port 10024)
	with ESMTP id TW6SfyfleBK5 for <dev@httpd.apache.org>;
	Tue,  6 Oct 2015 14:06:32 +0000 (UTC)
Received: from mail-qg0-f50.google.com (mail-qg0-f50.google.com [209.85.192.50])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id 717FB201F9
	for <dev@httpd.apache.org>; Tue,  6 Oct 2015 14:06:31 +0000 (UTC)
Received: by qgev79 with SMTP id v79so174824458qge.0
        for <dev@httpd.apache.org>; Tue, 06 Oct 2015 07:06:24 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        bh=00EOrXMc5zCjpxLhOqBOy5Mxj80cX5untNW7NqiP2kI=;
        b=LZs3FvMKROZHgpDITkqJg+Mp06M07zpRgWkRUiYx8rC6EiIZiNd/uUel7wDTCqWCV4
         YSNH0iU8xwo9piwFXEYbS8E2suRQTZEj3rZUlWdeUnyU6tOwBnQXwxUBRishb487HgfZ
         fLqfmduQJDvbo+9TujTDyqXYwtYgq9dzD4N34GYXj7hEv3KyULM3PkD4j6Tpi+no25cY
         JoWehLDoyZblzg04IelHgjqe71cvH1OCv3EqRbXeB8fB6cXmsd0Tgj+FrZC2L+SAohIn
         d1JgSty1iqvpn2ou50+uCO2aBPuP/dkPgAkz1UejrcMrSL1uC4MN/Ml7rqF6/hk4I4h6
         F6iw==
MIME-Version: 1.0
X-Received: by 10.140.131.70 with SMTP id 67mr51137402qhd.70.1444140383787;
 Tue, 06 Oct 2015 07:06:23 -0700 (PDT)
Received: by 10.55.72.20 with HTTP; Tue, 6 Oct 2015 07:06:23 -0700 (PDT)
In-Reply-To: <560D79EF.80201@apache.org>
References: <20151001154324.0CBD73A01DC@svn01-us-west.apache.org>
	<34694C4B-0561-441D-B7DC-6321A1ECE7E5@sharp.fm>
	<560D79EF.80201@apache.org>
Date: Tue, 6 Oct 2015 16:06:23 +0200
Message-ID: <CAKQ1sVPEikOgObBT5uD0VEYUM3a8cOBwEVK690k5JUU2C7UmPA@mail.gmail.com>
Subject: Re: svn commit: r1706275 - /httpd/httpd/trunk/modules/ssl/ssl_engine_io.c
From: Yann Ylavic <ylavic.dev@gmail.com>
To: dev@httpd.apache.org
Content-Type: text/plain; charset=UTF-8

On Thu, Oct 1, 2015 at 8:22 PM, Ruediger Pluem <rpluem@apache.org> wrote:
>
> The issue is that openssl during the connect handshake to a clieent does not tell httpd to flush. Hence the CLIENT_HELLO
> remains in the core output filter buffer and openssl waits for the SERVER_HELLO from the remote server which of course
> does not happen without the CLIENT_HELLO having been sent there.
>

I also tried the following patch which also passes the test framework
and is maybe more straightforward since it flushes on write (during
handshake only), thus avoiding any flush (and round-trip) on read.

WDYT?

Index: modules/ssl/ssl_engine_io.c
===================================================================
--- modules/ssl/ssl_engine_io.c    (revision 1706668)
+++ modules/ssl/ssl_engine_io.c    (working copy)
@@ -214,6 +214,21 @@ static int bio_filter_out_write(BIO *bio, const ch
     e = apr_bucket_transient_create(in, inl, outctx->bb->bucket_alloc);
     APR_BRIGADE_INSERT_TAIL(outctx->bb, e);

+    /* In theory, OpenSSL should flush as necessary, but it is known
+     * not to do so correctly in some cases (< 0.9.8m; see PR 46952),
+     * or on the proxy/client side (after ssl23_client_hello(), e.g.
+     * ssl/proxy.t test suite).
+     *
+     * Historically, this flush call was performed only for an SSLv2
+     * connection or for a proxy connection.  Calling _out_flush can
+     * be expensive in cases where requests/reponses are pipelined,
+     * so limit the performance impact to handshake time.
+     */
+    if (!SSL_is_init_finished(outctx->filter_ctx->pssl)) {
+        e = apr_bucket_flush_create(outctx->bb->bucket_alloc);
+        APR_BRIGADE_INSERT_TAIL(outctx->bb, e);
+    }
+
     if (bio_filter_out_pass(outctx) < 0) {
         return -1;
     }
@@ -452,7 +467,6 @@ static int bio_filter_in_read(BIO *bio, char *in,
     apr_size_t inl = inlen;
     bio_filter_in_ctx_t *inctx = (bio_filter_in_ctx_t *)(bio->ptr);
     apr_read_type_e block = inctx->block;
-    int need_flush;

     inctx->rc = APR_SUCCESS;

@@ -466,27 +480,6 @@ static int bio_filter_in_read(BIO *bio, char *in,
         return -1;
     }

-    /* In theory, OpenSSL should flush as necessary, but it is known
-     * not to do so correctly in some cases (< 0.9.8m; see PR 46952),
-     * or on the proxy/client side (after ssl23_client_hello(), e.g.
-     * ssl/proxy.t test suite).
-     *
-     * Historically, this flush call was performed only for an SSLv2
-     * connection or for a proxy connection.  Calling _out_flush can
-     * be expensive in cases where requests/reponses are pipelined,
-     * so limit the performance impact to handshake time.
-     */
-#if OPENSSL_VERSION_NUMBER < 0x0009080df
-    need_flush = 1;
-#else
-    need_flush = !SSL_is_init_finished(inctx->ssl);
-#endif
-    if (need_flush && bio_filter_out_flush(inctx->bio_out) < 0) {
-        bio_filter_out_ctx_t *outctx = inctx->bio_out->ptr;
-        inctx->rc = outctx->rc;
-        return -1;
-    }
-
     BIO_clear_retry_flags(bio);

     if (!inctx->bb) {
--

Regards,
Yann.

From dev-return-84094-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Tue Oct  6 14:38:14 2015
Return-Path: <dev-return-84094-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 9F2F0183B3
	for <apmail-httpd-dev-archive@www.apache.org>; Tue,  6 Oct 2015 14:38:14 +0000 (UTC)
Received: (qmail 59092 invoked by uid 500); 6 Oct 2015 14:38:14 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 59022 invoked by uid 500); 6 Oct 2015 14:38:14 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 59012 invoked by uid 99); 6 Oct 2015 14:38:14 -0000
Received: from Unknown (HELO spamd2-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 06 Oct 2015 14:38:14 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd2-us-west.apache.org (ASF Mail Server at spamd2-us-west.apache.org) with ESMTP id B4E201A211D
	for <dev@httpd.apache.org>; Tue,  6 Oct 2015 14:38:13 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd2-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 1.999
X-Spam-Level: *
X-Spam-Status: No, score=1.999 tagged_above=-999 required=6.31
	tests=[FREEMAIL_REPLY=1, KAM_LAZY_DOMAIN_SECURITY=1,
	SPF_HELO_PASS=-0.001] autolearn=disabled
Received: from mx1-us-west.apache.org ([10.40.0.8])
	by localhost (spamd2-us-west.apache.org [10.40.0.9]) (amavisd-new, port 10024)
	with ESMTP id vfdn5yJCt3ls for <dev@httpd.apache.org>;
	Tue,  6 Oct 2015 14:38:02 +0000 (UTC)
Received: from mail1.bemta14.messagelabs.com (mail1.bemta14.messagelabs.com [193.109.254.119])
	by mx1-us-west.apache.org (ASF Mail Server at mx1-us-west.apache.org) with ESMTPS id 0CC1920F20
	for <dev@httpd.apache.org>; Tue,  6 Oct 2015 14:38:01 +0000 (UTC)
Received: from [193.109.254.3] by server-15.bemta-14.messagelabs.com id 4A/19-18886-2CCD3165; Tue, 06 Oct 2015 14:37:54 +0000
X-Env-Sender: ruediger.pluem@vodafone.com
X-Msg-Ref: server-7.tower-184.messagelabs.com!1444142273!34849920!1
X-Originating-IP: [195.232.244.135]
X-StarScan-Received:
X-StarScan-Version: 6.13.16; banners=-,-,-
X-VirusChecked: Checked
Received: (qmail 26081 invoked from network); 6 Oct 2015 14:37:53 -0000
Received: from mailout03.vodafone.com (HELO mailout03.vodafone.com) (195.232.244.135)
  by server-7.tower-184.messagelabs.com with DHE-RSA-AES256-SHA encrypted SMTP; 6 Oct 2015 14:37:53 -0000
Received: from mailint02.vodafone.com (mailint02.vodafone.com [195.232.244.199])
	by mailout03.vodafone.com (Postfix) with ESMTP id 3nVhGn4Nzfz17HNc
	for <dev@httpd.apache.org>; Tue,  6 Oct 2015 16:37:53 +0200 (CEST)
Received: from mailint02.vodafone.com (localhost [127.0.0.1])
	by mailint02.vodafone.com (Postfix) with ESMTP id 3nVhGn3QhVzQmSh
	for <dev@httpd.apache.org>; Tue,  6 Oct 2015 16:37:53 +0200 (CEST)
Received: from VOEXC02W.internal.vodafone.com (voexc02w.dc-ratingen.de [145.230.101.22])
	(using TLSv1 with cipher AES128-SHA (128/128 bits))
	(No client certificate requested)
	by mailint02.vodafone.com (Postfix) with ESMTPS id 3nVhGn3MbpzQlmK
	for <dev@httpd.apache.org>; Tue,  6 Oct 2015 16:37:53 +0200 (CEST)
Received: from VOEXC15W.internal.vodafone.com (145.230.101.17) by
 VOEXC02W.internal.vodafone.com (145.230.101.22) with Microsoft SMTP Server
 (TLS) id 14.3.224.2; Tue, 6 Oct 2015 16:37:52 +0200
Received: from VOEXM10W.internal.vodafone.com ([169.254.2.88]) by
 voexc15w.internal.vodafone.com ([145.230.101.17]) with mapi id
 14.03.0224.002; Tue, 6 Oct 2015 16:37:34 +0200
From: =?utf-8?B?UGzDvG0sIFLDvGRpZ2VyLCBWb2RhZm9uZSBHcm91cA==?=
	<ruediger.pluem@vodafone.com>
To: "dev@httpd.apache.org" <dev@httpd.apache.org>
Subject: AW: svn commit: r1706275 -
 /httpd/httpd/trunk/modules/ssl/ssl_engine_io.c
Thread-Topic: svn commit: r1706275 -
 /httpd/httpd/trunk/modules/ssl/ssl_engine_io.c
Thread-Index: AQHQ/GqTCIHksBuD+0iVfT9YFPy+jJ5W0fKAgAeUDoCAAClMcA==
Date: Tue, 6 Oct 2015 14:37:32 +0000
Message-ID: <AB1691BE05AE7F4992697F2A0835627AC633DE2D@VOEXM10W.internal.vodafone.com>
References: <20151001154324.0CBD73A01DC@svn01-us-west.apache.org>
	<34694C4B-0561-441D-B7DC-6321A1ECE7E5@sharp.fm>	<560D79EF.80201@apache.org>
 <CAKQ1sVPEikOgObBT5uD0VEYUM3a8cOBwEVK690k5JUU2C7UmPA@mail.gmail.com>
In-Reply-To: <CAKQ1sVPEikOgObBT5uD0VEYUM3a8cOBwEVK690k5JUU2C7UmPA@mail.gmail.com>
Accept-Language: en-US
Content-Language: de-DE
X-MS-Has-Attach:
X-MS-TNEF-Correlator:
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
MIME-Version: 1.0

DQoNCj4gLS0tLS1VcnNwcsO8bmdsaWNoZSBOYWNocmljaHQtLS0tLQ0KPiBWb246IFlhbm4gWWxh
dmljIFttYWlsdG86eWxhdmljLmRldkBnbWFpbC5jb21dDQo+IEdlc2VuZGV0OiBEaWVuc3RhZywg
Ni4gT2t0b2JlciAyMDE1IDE2OjA2DQo+IEFuOiBkZXZAaHR0cGQuYXBhY2hlLm9yZw0KPiBCZXRy
ZWZmOiBSZTogc3ZuIGNvbW1pdDogcjE3MDYyNzUgLQ0KPiAvaHR0cGQvaHR0cGQvdHJ1bmsvbW9k
dWxlcy9zc2wvc3NsX2VuZ2luZV9pby5jDQo+IA0KPiBPbiBUaHUsIE9jdCAxLCAyMDE1IGF0IDg6
MjIgUE0sIFJ1ZWRpZ2VyIFBsdWVtIDxycGx1ZW1AYXBhY2hlLm9yZz4NCj4gd3JvdGU6DQo+ID4N
Cj4gPiBUaGUgaXNzdWUgaXMgdGhhdCBvcGVuc3NsIGR1cmluZyB0aGUgY29ubmVjdCBoYW5kc2hh
a2UgdG8gYSBjbGllZW50DQo+IGRvZXMgbm90IHRlbGwgaHR0cGQgdG8gZmx1c2guIEhlbmNlIHRo
ZSBDTElFTlRfSEVMTE8NCj4gPiByZW1haW5zIGluIHRoZSBjb3JlIG91dHB1dCBmaWx0ZXIgYnVm
ZmVyIGFuZCBvcGVuc3NsIHdhaXRzIGZvciB0aGUNCj4gU0VSVkVSX0hFTExPIGZyb20gdGhlIHJl
bW90ZSBzZXJ2ZXIgd2hpY2ggb2YgY291cnNlDQo+ID4gZG9lcyBub3QgaGFwcGVuIHdpdGhvdXQg
dGhlIENMSUVOVF9IRUxMTyBoYXZpbmcgYmVlbiBzZW50IHRoZXJlLg0KPiA+DQo+IA0KPiBJIGFs
c28gdHJpZWQgdGhlIGZvbGxvd2luZyBwYXRjaCB3aGljaCBhbHNvIHBhc3NlcyB0aGUgdGVzdCBm
cmFtZXdvcmsNCj4gYW5kIGlzIG1heWJlIG1vcmUgc3RyYWlnaHRmb3J3YXJkIHNpbmNlIGl0IGZs
dXNoZXMgb24gd3JpdGUgKGR1cmluZw0KPiBoYW5kc2hha2Ugb25seSksIHRodXMgYXZvaWRpbmcg
YW55IGZsdXNoIChhbmQgcm91bmQtdHJpcCkgb24gcmVhZC4NCj4gDQo+IFdEWVQ/DQoNClRoZSBk
cmF3YmFjayBpcyB0aGF0IGl0IHdpbGwgZmx1c2ggZXZlcnkgdGltZSB0aGUgaGFuZHNoYWtlIHdy
aXRlcy4NClRoZSBoYW5kc2hha2UgbWF5IHdyaXRlIG11bHRpcGxlIHRpbWVzIGJlZm9yZSBpdCB3
YW50cyB0byByZWFkLg0KU28gdGhlIGN1cnJlbnQgYXBwcm9hY2ggcHJvYmFibHkgY2F1c2VzIGJp
Z2dlciBhbW91bnRzIG9mIGRhdGEgc2VudA0KYWNyb3NzIHRoZSB3aXJlIGF0IG9uY2UgdGhlbiB0
aGUgYXBwcm9hY2ggYmVsb3cgYW5kIHRodXMgaXMgbW9yZSBpbiBsaW5lIHdpdGggdGhlIHN0YW5k
YXJkDQphcHByb2FjaCBpbiBodHRwZCB0byBhdm9pZCBzZW5kaW5nIHNtYWxsIGNodW5rcyBpZiBu
b3QgbmVlZGVkLg0KU28gSSB3b3VsZCBrZWVwIHRoZSBjdXJyZW50IGFwcHJvYWNoLg0KDQpSZWdh
cmRzDQoNClLDvGRpZ2VyDQo=

From dev-return-84095-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Tue Oct  6 14:47:37 2015
Return-Path: <dev-return-84095-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id D43E218403
	for <apmail-httpd-dev-archive@www.apache.org>; Tue,  6 Oct 2015 14:47:37 +0000 (UTC)
Received: (qmail 94884 invoked by uid 500); 6 Oct 2015 14:47:15 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 94811 invoked by uid 500); 6 Oct 2015 14:47:15 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 94801 invoked by uid 99); 6 Oct 2015 14:47:15 -0000
Received: from Unknown (HELO spamd4-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 06 Oct 2015 14:47:15 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd4-us-west.apache.org (ASF Mail Server at spamd4-us-west.apache.org) with ESMTP id E327DC0419
	for <dev@httpd.apache.org>; Tue,  6 Oct 2015 14:47:14 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd4-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.101
X-Spam-Level:
X-Spam-Status: No, score=-0.101 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RCVD_IN_MSPIKE_H2=-0.001, SPF_PASS=-0.001, URIBL_BLOCKED=0.001]
	autolearn=disabled
Authentication-Results: spamd4-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd4-us-west.apache.org [10.40.0.11]) (amavisd-new, port 10024)
	with ESMTP id pdxgI6rCIFsD for <dev@httpd.apache.org>;
	Tue,  6 Oct 2015 14:47:08 +0000 (UTC)
Received: from mail-io0-f171.google.com (mail-io0-f171.google.com [209.85.223.171])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id 011A942B32
	for <dev@httpd.apache.org>; Tue,  6 Oct 2015 14:47:08 +0000 (UTC)
Received: by ioiz6 with SMTP id z6so223783182ioi.2
        for <dev@httpd.apache.org>; Tue, 06 Oct 2015 07:47:07 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        bh=1Nk1fIEtEIg0hl0VjU/ccgh+gkIZsjUOxxHPbxclLcU=;
        b=qnHqweBpnbYgw1VpGVPh+1nQIe5+CuEv5YwSBqmuYnYQObpA04s1ZgjN1lXLcaWSAL
         BAnGsUWqSvS/itWcoN8KzIpgD94dQygk4M0hI1vxvw5Vxmh4e6mIP/AtYsfJnM+X30yT
         AYX5xEKDF314eN60QN/gFfS/SxjqCSQsn7QKVUakG4ot2FFpJ1lvJcHanu+/qtNiF8sB
         it2Zt88vZANMSUcIec0OxVUYxhdCSIkJSV1gCu/Drak5Yj/DdFO5BoDd2prPSCzkXItQ
         +ZAOlQPoKG5ZlBxcfzc7J6Tb84IDUgrxDKzeDYz+95wmua4dMHwynKtG2H1PuEBmNvWV
         B85w==
MIME-Version: 1.0
X-Received: by 10.107.14.4 with SMTP id 4mr39232128ioo.169.1444142827594; Tue,
 06 Oct 2015 07:47:07 -0700 (PDT)
Received: by 10.64.25.3 with HTTP; Tue, 6 Oct 2015 07:47:07 -0700 (PDT)
In-Reply-To: <CACsi250knfKyt9zXKQAMeqLgS5g1=hH+HnVAcarufBgJAvOEqg@mail.gmail.com>
References: <20150922181140.18E873A0818@svn01-us-west.apache.org>
	<CALK=YjPBPR=qJ+wFx+Hf1+yYF8YUkJ-bFjCLiuPoW+pP+xaiTA@mail.gmail.com>
	<CACsi250uxMUntOT5VesBs=KQ5=r2FSma9MA0STRVGr47PXXFAA@mail.gmail.com>
	<CALK=YjOHkErODYKEFG=O0Lngd04Csm_K5uxExSFUXtNFY6igbw@mail.gmail.com>
	<CACsi250knfKyt9zXKQAMeqLgS5g1=hH+HnVAcarufBgJAvOEqg@mail.gmail.com>
Date: Tue, 6 Oct 2015 10:47:07 -0400
Message-ID: <CALK=YjPrbVXu2Cg2ke_rmGH+ZZ3=dQvEN1q4y9zhef0o0V54nA@mail.gmail.com>
Subject: Re: svn commit: r1704683 - /httpd/httpd/trunk/docs/manual/mod/mod_remoteip.xml
From: Eric Covener <covener@gmail.com>
To: Apache HTTP Server Development List <dev@httpd.apache.org>
Content-Type: text/plain; charset=UTF-8

On Tue, Sep 22, 2015 at 11:09 PM, William A Rowe Jr <wrowe@rowe-clan.net> wrote:
> On Tue, Sep 22, 2015 at 8:48 PM, Eric Covener <covener@gmail.com> wrote:
>>
>> Maybe my followup is better phrased.  No issue with handling of internal
>> IPs.
>>
>> Currently, we act like RemoteIPTrustedProxy * by default (once they've
>> named the XFF header) and warn people they'd better restrict it.
>
>
> I agree that was not the original design and we should address it with a fix
> rather than a docs fix, IMHO.  'Trusted' is the exception, not the general
> case.

bump. I don't love the idea of changing the 2.4 defaults.

Current doc already says "Unless these other directives are used,
mod_remoteip will trust all hosts presenting a RemoteIPHeader IP
value." so I thought it was wise  to reinforce this in other sections.
  Doc is not back-ported yet.

From dev-return-84096-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Tue Oct  6 15:22:35 2015
Return-Path: <dev-return-84096-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id CD45F1854B
	for <apmail-httpd-dev-archive@www.apache.org>; Tue,  6 Oct 2015 15:22:35 +0000 (UTC)
Received: (qmail 91174 invoked by uid 500); 6 Oct 2015 15:22:35 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 91091 invoked by uid 500); 6 Oct 2015 15:22:35 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 91081 invoked by uid 99); 6 Oct 2015 15:22:35 -0000
Received: from Unknown (HELO spamd3-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 06 Oct 2015 15:22:35 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd3-us-west.apache.org (ASF Mail Server at spamd3-us-west.apache.org) with ESMTP id C8175180A83
	for <dev@httpd.apache.org>; Tue,  6 Oct 2015 15:22:34 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd3-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.101
X-Spam-Level:
X-Spam-Status: No, score=-0.101 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RCVD_IN_MSPIKE_H2=-0.001, SPF_PASS=-0.001, URIBL_BLOCKED=0.001]
	autolearn=disabled
Authentication-Results: spamd3-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd3-us-west.apache.org [10.40.0.10]) (amavisd-new, port 10024)
	with ESMTP id mvhvkRtzYn5s for <dev@httpd.apache.org>;
	Tue,  6 Oct 2015 15:22:28 +0000 (UTC)
Received: from mail-qk0-f171.google.com (mail-qk0-f171.google.com [209.85.220.171])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id A3ECB204C9
	for <dev@httpd.apache.org>; Tue,  6 Oct 2015 15:22:27 +0000 (UTC)
Received: by qkbi190 with SMTP id i190so66906281qkb.1
        for <dev@httpd.apache.org>; Tue, 06 Oct 2015 08:22:26 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        bh=iO2kNDpWTx0T0RP0WKmMtXpBePOFl1cHBIohaJxyOAA=;
        b=wFmx6qbZL9SkPT2K8t+i67El53c7AftkIb4QbvrdOGIyOl9pCWtFDkaXjQ1ORDTBUv
         hORxVuN9YipB71R+NkBZHChkF1SAj5uRFO0TH1Q6pGAOJQdYXwOTXM8R20d/IAkT0JJ4
         GIm1QykexSTEzKSRtLHHWVGUHhpqdaDUTrMEpLPbjl4LcNOHVke0WuqyMzCs8mOt7G3J
         BH9rQt9trqJk42rYZiY0EvM/LbI9v+ZHAea20V5UedMegjL4vfo6h85wYoDl7TfhcL2F
         yYYwnwsdJ31/LoHfcPeYD0lJa87Ww7f+wku1QIAlXqLl1/xFHk8MeaT3y/cdBYIXHvvY
         BpmQ==
MIME-Version: 1.0
X-Received: by 10.55.192.15 with SMTP id o15mr25360559qki.2.1444144946556;
 Tue, 06 Oct 2015 08:22:26 -0700 (PDT)
Received: by 10.55.72.20 with HTTP; Tue, 6 Oct 2015 08:22:26 -0700 (PDT)
In-Reply-To: <CAKQ1sVN2WwBhbJ26JOdm7YFnMyXtOfAbCX1eCeUse7Zh1k8O5Q@mail.gmail.com>
References: <20151004101052.A6E193A0234@svn01-us-west.apache.org>
	<CAKQ1sVNRVJqqZSmzVn86K3SbztGSBQ68D2kTJRhWU1qMWDrUYA@mail.gmail.com>
	<9A9FBD0C-B503-4CDD-A833-74C69FF248EA@sharp.fm>
	<CAKQ1sVN2WwBhbJ26JOdm7YFnMyXtOfAbCX1eCeUse7Zh1k8O5Q@mail.gmail.com>
Date: Tue, 6 Oct 2015 17:22:26 +0200
Message-ID: <CAKQ1sVOA-X7CpjeJruq7wgbFi+WaBsMn-X_0Bpw+CUxmnHtYtg@mail.gmail.com>
Subject: Re: svn commit: r1706669 - in /httpd/httpd/trunk: ./ include/
 modules/http/ modules/ssl/ server/ server/mpm/event/ server/mpm/motorz/ server/mpm/simple/
From: Yann Ylavic <ylavic.dev@gmail.com>
To: dev@httpd.apache.org
Content-Type: text/plain; charset=UTF-8

On Tue, Oct 6, 2015 at 3:51 PM, Yann Ylavic <ylavic.dev@gmail.com> wrote:
> On Tue, Oct 6, 2015 at 3:41 PM, Graham Leggett <minfrin@sharp.fm> wrote:
>> On 6 Oct 2015, at 14:32, Yann Ylavic <ylavic.dev@gmail.com> wrote:
>>
>>> So it seems to relate to the EOR bucket, first not being passed
>>> through, and second leading to a double-free or alike.
>>>
>>> Did not investigate further...
>>
>> Did you rebuild you tree completely clean before trying it out?
>>
>> Whenever I got weird behavior a clean rebuild sorted it out. The full test suite works fine for me using the event mpm.
>
> Just did that, same thing.
> I was using mpm_worker, but now tried mpm_event with same segfaults.

Looks like mod_bucketeer is the culprit.
It fails to remove itself from the filter stack on EOS, and hence
makes a copy of the EOR bucket (as any METADATA bucket) for its own
brigade when it sees it.
Then the request gets destroyed twice (once per brigade it is in) on cleanup.

I fail to see where your patch comes into play here though, for now.
I also suspect EOR buckets shouldn't be copyable anyway, and bucketeer
should do the right thing, still the new filter should probably work
with the existing...

From dev-return-84097-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Tue Oct  6 15:24:47 2015
Return-Path: <dev-return-84097-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 1DF7C18567
	for <apmail-httpd-dev-archive@www.apache.org>; Tue,  6 Oct 2015 15:24:47 +0000 (UTC)
Received: (qmail 94698 invoked by uid 500); 6 Oct 2015 15:24:46 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 94640 invoked by uid 500); 6 Oct 2015 15:24:46 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 94630 invoked by uid 99); 6 Oct 2015 15:24:46 -0000
Received: from Unknown (HELO spamd1-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 06 Oct 2015 15:24:46 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd1-us-west.apache.org (ASF Mail Server at spamd1-us-west.apache.org) with ESMTP id 3909AC3B39
	for <dev@httpd.apache.org>; Tue,  6 Oct 2015 15:24:46 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd1-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.121
X-Spam-Level:
X-Spam-Status: No, score=-0.121 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RCVD_IN_MSPIKE_H3=-0.01, RCVD_IN_MSPIKE_WL=-0.01, SPF_PASS=-0.001]
	autolearn=disabled
Authentication-Results: spamd1-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd1-us-west.apache.org [10.40.0.7]) (amavisd-new, port 10024)
	with ESMTP id EWGSlCPJNNMw for <dev@httpd.apache.org>;
	Tue,  6 Oct 2015 15:24:45 +0000 (UTC)
Received: from mail-qk0-f174.google.com (mail-qk0-f174.google.com [209.85.220.174])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id E8322201F9
	for <dev@httpd.apache.org>; Tue,  6 Oct 2015 15:24:44 +0000 (UTC)
Received: by qkas79 with SMTP id s79so87100146qka.0
        for <dev@httpd.apache.org>; Tue, 06 Oct 2015 08:24:38 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        bh=rpQ9Dhq+uxWE7CnhAFBiEegBowdErPsJSJvBOKse6EM=;
        b=FDcVudxW9rXHUkev/DpgqW1opHebwZr7crWmRfrWk1MWPLDsKjAJVvWPVUT4D7rw+W
         mQ0nTrnAUzFyv93w9dLcP9xfJjy067LKIFjtC8i+Dr0gQRR6kz3P6BNO4d83JOEnt5/y
         K9k82zpGBY4ElyMVy9WIXH6lAXn2W0vkgt9CwEiL06LPIDOh3FdJc3xrJvLSO5Kg523K
         oD11E3893QMX8D7rh3MI/xMunfhiZ5/5qZog8nBcfQY4LvBKB9A3t13KczsxXLokeXJg
         csgw94H4fxMZvqTscyEZ537BcFP5/6nAzz0Y1LQehq4yizzJwIujCRPLEJz6NUebqKL6
         FIiQ==
MIME-Version: 1.0
X-Received: by 10.55.192.15 with SMTP id o15mr25376824qki.2.1444145078582;
 Tue, 06 Oct 2015 08:24:38 -0700 (PDT)
Received: by 10.55.72.20 with HTTP; Tue, 6 Oct 2015 08:24:38 -0700 (PDT)
In-Reply-To: <CAKQ1sVOA-X7CpjeJruq7wgbFi+WaBsMn-X_0Bpw+CUxmnHtYtg@mail.gmail.com>
References: <20151004101052.A6E193A0234@svn01-us-west.apache.org>
	<CAKQ1sVNRVJqqZSmzVn86K3SbztGSBQ68D2kTJRhWU1qMWDrUYA@mail.gmail.com>
	<9A9FBD0C-B503-4CDD-A833-74C69FF248EA@sharp.fm>
	<CAKQ1sVN2WwBhbJ26JOdm7YFnMyXtOfAbCX1eCeUse7Zh1k8O5Q@mail.gmail.com>
	<CAKQ1sVOA-X7CpjeJruq7wgbFi+WaBsMn-X_0Bpw+CUxmnHtYtg@mail.gmail.com>
Date: Tue, 6 Oct 2015 17:24:38 +0200
Message-ID: <CAKQ1sVPYwVVPSyJ1VRwk1okSvZ64VkjNpOWCbOrb0i8s+5gyDA@mail.gmail.com>
Subject: Re: svn commit: r1706669 - in /httpd/httpd/trunk: ./ include/
 modules/http/ modules/ssl/ server/ server/mpm/event/ server/mpm/motorz/ server/mpm/simple/
From: Yann Ylavic <ylavic.dev@gmail.com>
To: dev@httpd.apache.org
Content-Type: text/plain; charset=UTF-8

On Tue, Oct 6, 2015 at 5:22 PM, Yann Ylavic <ylavic.dev@gmail.com> wrote:
> still the new filter should probably work
> with the existing...

s/new filter/new filter stack mechanism/

From dev-return-84098-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Tue Oct  6 15:33:08 2015
Return-Path: <dev-return-84098-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id BDF3E185E0
	for <apmail-httpd-dev-archive@www.apache.org>; Tue,  6 Oct 2015 15:33:08 +0000 (UTC)
Received: (qmail 14434 invoked by uid 500); 6 Oct 2015 15:32:46 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 14359 invoked by uid 500); 6 Oct 2015 15:32:46 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 14349 invoked by uid 99); 6 Oct 2015 15:32:46 -0000
Received: from Unknown (HELO spamd3-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 06 Oct 2015 15:32:46 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd3-us-west.apache.org (ASF Mail Server at spamd3-us-west.apache.org) with ESMTP id 9276F180A83
	for <dev@httpd.apache.org>; Tue,  6 Oct 2015 15:32:45 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd3-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.01
X-Spam-Level:
X-Spam-Status: No, score=-0.01 tagged_above=-999 required=6.31
	tests=[SPF_PASS=-0.001, T_RP_MATCHES_RCVD=-0.01, URIBL_BLOCKED=0.001]
	autolearn=disabled
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd3-us-west.apache.org [10.40.0.10]) (amavisd-new, port 10024)
	with ESMTP id WtvT569f1fDW for <dev@httpd.apache.org>;
	Tue,  6 Oct 2015 15:32:41 +0000 (UTC)
Received: from monica.sharp.fm (monica.sharp.fm [80.168.143.5])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTP id 69AAF2827E
	for <dev@httpd.apache.org>; Tue,  6 Oct 2015 15:32:40 +0000 (UTC)
Received: from hgslapmb-h06477.hogarthww.prv (unknown [5.56.169.82])
	(using TLSv1 with cipher DHE-RSA-AES256-SHA (256/256 bits))
	(Client did not present a certificate)
	(Authenticated sender: minfrin@sharp.fm)
	by monica.sharp.fm (Postfix) with ESMTPSA id E753A8314D
	for <dev@httpd.apache.org>; Tue,  6 Oct 2015 16:32:33 +0100 (BST)
Content-Type: text/plain; charset=utf-8
Mime-Version: 1.0 (Mac OS X Mail 8.2 \(2104\))
Subject: Re: svn commit: r1706669 - in /httpd/httpd/trunk: ./ include/ modules/http/ modules/ssl/ server/ server/mpm/event/ server/mpm/motorz/ server/mpm/simple/
From: Graham Leggett <minfrin@sharp.fm>
In-Reply-To: <86D1AB4B-554E-4C37-BF67-DCFB05DF6A49@greenbytes.de>
Date: Tue, 6 Oct 2015 17:32:32 +0200
Content-Transfer-Encoding: quoted-printable
Message-Id: <5117EB89-4AAF-4C6A-ABDB-764A6FE3BBF2@sharp.fm>
References: <CAKQ1sVMoxQe=8iAQ=oUSRJhrpy0o8RpJ=+u_CXecw8UbTj_NOg@mail.gmail.com> <2791C826-8CFB-4DC9-B6AF-566DF625B154@sharp.fm> <AB1691BE05AE7F4992697F2A0835627AC633D8A1@VOEXM10W.internal.vodafone.com> <B4A85802-BF21-41F1-B2DC-18FDD2AC9AE6@sharp.fm> <3D610873-CC12-4E94-AAAA-49C4998202D6@sharp.fm> <86D1AB4B-554E-4C37-BF67-DCFB05DF6A49@greenbytes.de>
To: dev@httpd.apache.org
X-Mailer: Apple Mail (2.2104)

On 06 Oct 2015, at 3:36 PM, Stefan Eissing =
<stefan.eissing@greenbytes.de> wrote:

> FYI: /trunk no longer works with mod_http2. 2.4.x does. I see missing =
response data, it seems, so the most likely cause are the changes in =
filter handling. Did not find the time to investigate further.
>=20
> Please be aware the mod_h2 uses pool/brigade hierarchies in new and =
unexpected ways. The request has been processed and EOR bucket has been =
handled in another thread, however data/file handles might have been =
transferred to the main thread and are being cleaned up when the main =
connection thinks a stream is done. If those data gets set aside, the =
memory might get freed/reused too early. Maybe mod_http2 needs to come =
up with its own EOR buckets on the main connection to allow for cleanup =
synchronization. Not sure=E2=80=A6

I pulled my hair out looking for the exact same problem.

It turned out to be a bug in the core where the EOR bucket was being =
injected directly into the connection filters and thus bypassing request =
filters containing setaside data. When the EOR bucket =E2=80=9Covertakes=E2=
=80=9D other buckets, the data vanishes.

The solution is to make sure that the EOR bucket genuinely does get =
injected at the very end of the request. To do this I found the last =
internal redirected request (iterate through r->next until r->next is =
NULL) and injected the EOR bucket into that filter.

(I have found a problem where we=E2=80=99re injecting an EOR bucket made =
out of the last request instead of the main request, will fix that)

A quick scan of the modules/http2 directory shows no calls to =
ap_bucket_eor_create(), I suspect you might be relying on http1.1 =
functionality to do this in modules/http/http_request.c. Ideally =
mod_http2 should be choosing the right time to end the request based on =
the http2 protocol.

Regards,
Graham
=E2=80=94


From dev-return-84099-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Tue Oct  6 15:34:45 2015
Return-Path: <dev-return-84099-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 39CE1185F8
	for <apmail-httpd-dev-archive@www.apache.org>; Tue,  6 Oct 2015 15:34:45 +0000 (UTC)
Received: (qmail 25412 invoked by uid 500); 6 Oct 2015 15:34:44 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 25337 invoked by uid 500); 6 Oct 2015 15:34:44 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 25327 invoked by uid 99); 6 Oct 2015 15:34:44 -0000
Received: from Unknown (HELO spamd4-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 06 Oct 2015 15:34:44 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd4-us-west.apache.org (ASF Mail Server at spamd4-us-west.apache.org) with ESMTP id 4E179C08D6
	for <dev@httpd.apache.org>; Tue,  6 Oct 2015 15:34:44 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd4-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.01
X-Spam-Level:
X-Spam-Status: No, score=-0.01 tagged_above=-999 required=6.31
	tests=[T_RP_MATCHES_RCVD=-0.01] autolearn=disabled
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd4-us-west.apache.org [10.40.0.11]) (amavisd-new, port 10024)
	with ESMTP id B2ZBIBHVe9Og for <dev@httpd.apache.org>;
	Tue,  6 Oct 2015 15:34:29 +0000 (UTC)
Received: from monica.sharp.fm (monica.sharp.fm [80.168.143.5])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTP id 86595439D1
	for <dev@httpd.apache.org>; Tue,  6 Oct 2015 15:34:28 +0000 (UTC)
Received: from hgslapmb-h06477.hogarthww.prv (unknown [5.56.169.82])
	(using TLSv1 with cipher DHE-RSA-AES256-SHA (256/256 bits))
	(Client did not present a certificate)
	(Authenticated sender: minfrin@sharp.fm)
	by monica.sharp.fm (Postfix) with ESMTPSA id B30D98314D
	for <dev@httpd.apache.org>; Tue,  6 Oct 2015 16:34:27 +0100 (BST)
Content-Type: text/plain; charset=utf-8
Mime-Version: 1.0 (Mac OS X Mail 8.2 \(2104\))
Subject: Re: svn commit: r1706669 - in /httpd/httpd/trunk: ./ include/ modules/http/ modules/ssl/ server/ server/mpm/event/ server/mpm/motorz/ server/mpm/simple/
From: Graham Leggett <minfrin@sharp.fm>
In-Reply-To: <CAKQ1sVOA-X7CpjeJruq7wgbFi+WaBsMn-X_0Bpw+CUxmnHtYtg@mail.gmail.com>
Date: Tue, 6 Oct 2015 17:34:27 +0200
Content-Transfer-Encoding: quoted-printable
Message-Id: <660C359D-89D0-4951-ACEA-879BA3F4D726@sharp.fm>
References: <20151004101052.A6E193A0234@svn01-us-west.apache.org> <CAKQ1sVNRVJqqZSmzVn86K3SbztGSBQ68D2kTJRhWU1qMWDrUYA@mail.gmail.com> <9A9FBD0C-B503-4CDD-A833-74C69FF248EA@sharp.fm> <CAKQ1sVN2WwBhbJ26JOdm7YFnMyXtOfAbCX1eCeUse7Zh1k8O5Q@mail.gmail.com> <CAKQ1sVOA-X7CpjeJruq7wgbFi+WaBsMn-X_0Bpw+CUxmnHtYtg@mail.gmail.com>
To: dev@httpd.apache.org
X-Mailer: Apple Mail (2.2104)

On 06 Oct 2015, at 5:22 PM, Yann Ylavic <ylavic.dev@gmail.com> wrote:

>> Just did that, same thing.
>> I was using mpm_worker, but now tried mpm_event with same segfaults.
>=20
> Looks like mod_bucketeer is the culprit.
> It fails to remove itself from the filter stack on EOS, and hence
> makes a copy of the EOR bucket (as any METADATA bucket) for its own
> brigade when it sees it.
> Then the request gets destroyed twice (once per brigade it is in) on =
cleanup.
>=20
> I fail to see where your patch comes into play here though, for now.
> I also suspect EOR buckets shouldn't be copyable anyway, and bucketeer
> should do the right thing, still the new filter should probably work
> with the existing...

The core used to inject EOR buckets into the connection filters, =
bypassing the request filters. Now that request filters can buffer data, =
injecting EOR into the connection filters causes the end of requests to =
be chopped off, so now EOR is injected at the very end of the last =
request filter, as it should have been.

In theory none of this should matter, if EOR is copied it should set up =
the proper cleanups to clean up the second copy. A quick look at =
eor_bucket.c shows the following:

AP_DECLARE_DATA const apr_bucket_type_t ap_bucket_type_eor =3D {
    "EOR", 5, APR_BUCKET_METADATA,
    eor_bucket_destroy,
    eor_bucket_read,
    apr_bucket_setaside_noop,
    apr_bucket_split_notimpl,
    apr_bucket_simple_copy
};

apr_bucket_simple_copy() looks wrong - in theory we should have a proper =
copy function that does the right thing with the second copy, for =
example by not copying the pool. If we blindly copy the pool (or the =
request containing the pool) I see nothing that would prevent an attempt =
to free the pool twice.

Regards,
Graham
=E2=80=94


From dev-return-84100-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Tue Oct  6 15:44:24 2015
Return-Path: <dev-return-84100-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id F0D241864B
	for <apmail-httpd-dev-archive@www.apache.org>; Tue,  6 Oct 2015 15:44:24 +0000 (UTC)
Received: (qmail 55779 invoked by uid 500); 6 Oct 2015 15:44:14 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 55707 invoked by uid 500); 6 Oct 2015 15:44:14 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 55697 invoked by uid 99); 6 Oct 2015 15:44:14 -0000
Received: from Unknown (HELO spamd1-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 06 Oct 2015 15:44:14 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd1-us-west.apache.org (ASF Mail Server at spamd1-us-west.apache.org) with ESMTP id 521DCC3AB1
	for <dev@httpd.apache.org>; Tue,  6 Oct 2015 15:44:14 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd1-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.032
X-Spam-Level:
X-Spam-Status: No, score=-0.032 tagged_above=-999 required=6.31
	tests=[RCVD_IN_MSPIKE_H3=-0.01, RCVD_IN_MSPIKE_WL=-0.01,
	SPF_HELO_PASS=-0.001, SPF_PASS=-0.001, T_RP_MATCHES_RCVD=-0.01]
	autolearn=disabled
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd1-us-west.apache.org [10.40.0.7]) (amavisd-new, port 10024)
	with ESMTP id Gr4qlsjPwcW1 for <dev@httpd.apache.org>;
	Tue,  6 Oct 2015 15:44:09 +0000 (UTC)
Received: from mx1.redhat.com (mx1.redhat.com [209.132.183.28])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id BCDBA439D3
	for <dev@httpd.apache.org>; Tue,  6 Oct 2015 15:44:08 +0000 (UTC)
Received: from int-mx14.intmail.prod.int.phx2.redhat.com (int-mx14.intmail.prod.int.phx2.redhat.com [10.5.11.27])
	by mx1.redhat.com (Postfix) with ESMTPS id 1DC89C7966
	for <dev@httpd.apache.org>; Tue,  6 Oct 2015 15:44:02 +0000 (UTC)
Received: from iberis (vpn-55-65.rdu2.redhat.com [10.10.55.65])
	by int-mx14.intmail.prod.int.phx2.redhat.com (8.14.4/8.14.4) with ESMTP id t96Fi07B025597
	(version=TLSv1/SSLv3 cipher=DHE-RSA-AES256-GCM-SHA384 bits=256 verify=NO)
	for <dev@httpd.apache.org>; Tue, 6 Oct 2015 11:44:01 -0400
Received: from jorton by iberis with local (Exim 4.85)
	(envelope-from <jorton@redhat.com>)
	id 1ZjUPI-0008JO-Eo
	for dev@httpd.apache.org; Tue, 06 Oct 2015 16:44:00 +0100
Date: Tue, 6 Oct 2015 16:44:00 +0100
From: Joe Orton <jorton@redhat.com>
To: dev@httpd.apache.org
Subject: Re: svn commit: r1706275 -
 /httpd/httpd/trunk/modules/ssl/ssl_engine_io.c
Message-ID: <20151006154400.GA30252@redhat.com>
Mail-Followup-To: dev@httpd.apache.org
References: <20151001154324.0CBD73A01DC@svn01-us-west.apache.org>
 <34694C4B-0561-441D-B7DC-6321A1ECE7E5@sharp.fm>
 <560D79EF.80201@apache.org>
 <CAKQ1sVPEikOgObBT5uD0VEYUM3a8cOBwEVK690k5JUU2C7UmPA@mail.gmail.com>
 <AB1691BE05AE7F4992697F2A0835627AC633DE2D@VOEXM10W.internal.vodafone.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Disposition: inline
Content-Transfer-Encoding: 8bit
In-Reply-To: <AB1691BE05AE7F4992697F2A0835627AC633DE2D@VOEXM10W.internal.vodafone.com>
User-Agent: Mutt/1.5.24 (2015-08-30)
Organization: Registered in England and Wales under Company Registration No. 03798903
Directors: Michael Cunningham (US), Michael O'Neill (Ireland), Matt Parson (US), Charles Peters (US)
X-Scanned-By: MIMEDefang 2.68 on 10.5.11.27

On Tue, Oct 06, 2015 at 02:37:32PM +0000, Plüm, Rüdiger, Vodafone Group wrote:
> The drawback is that it will flush every time the handshake writes.
> The handshake may write multiple times before it wants to read.
> So the current approach probably causes bigger amounts of data sent
> across the wire at once then the approach below and thus is more in line with the standard
> approach in httpd to avoid sending small chunks if not needed.
> So I would keep the current approach.

Looking at 1.0.1e, the state machine loop in ssl3_accept(), the coding 
style is pretty clearly:

1. send something
2. flush
3. switch to new state.

e.g. like this....

                        ret=ssl3_send_hello_request(s);
                        if (ret <= 0) goto end;
                        s->s3->tmp.next_state=SSL3_ST_SW_HELLO_REQ_C;
                        s->state=SSL3_ST_SW_FLUSH;

...and then the SW_FLUSH mode switches to the tmp.next_state.

Hence In the server case, it seems reasonable to rely on BIO_flush() 
being called at the "right" times during the handshake.  Modulo the odd 
bug!

But ssl/s3_clnt.c is not following that coding style at all, and it only 
does a flush after completing the handshake.  So I'd say the right thing 
here is to FLUSH after every packet which comes through the write BIO 
when the SSL state machine is in the middle of a "connect", i.e. 
handshake as client.

tl;dr: I think Yann's patch should be right if the test is switched from 
"always flush if !SSL_is_init_finished(ssl)" to "always flush if 
SSL_in_connect_init(ssl)"???

Regards, Joe


From dev-return-84101-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Tue Oct  6 15:53:54 2015
Return-Path: <dev-return-84101-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id BC55A186D3
	for <apmail-httpd-dev-archive@www.apache.org>; Tue,  6 Oct 2015 15:53:54 +0000 (UTC)
Received: (qmail 85893 invoked by uid 500); 6 Oct 2015 15:53:49 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 85823 invoked by uid 500); 6 Oct 2015 15:53:49 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 85812 invoked by uid 99); 6 Oct 2015 15:53:49 -0000
Received: from Unknown (HELO spamd1-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 06 Oct 2015 15:53:49 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd1-us-west.apache.org (ASF Mail Server at spamd1-us-west.apache.org) with ESMTP id B9F11C3AB6
	for <dev@httpd.apache.org>; Tue,  6 Oct 2015 15:53:48 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd1-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.1
X-Spam-Level:
X-Spam-Status: No, score=-0.1 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RCVD_IN_MSPIKE_H2=-0.001, URIBL_BLOCKED=0.001] autolearn=disabled
Authentication-Results: spamd1-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd1-us-west.apache.org [10.40.0.7]) (amavisd-new, port 10024)
	with ESMTP id Elp6KMXFGBi0 for <dev@httpd.apache.org>;
	Tue,  6 Oct 2015 15:53:41 +0000 (UTC)
Received: from mail-qg0-f47.google.com (mail-qg0-f47.google.com [209.85.192.47])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id C97BA204C9
	for <dev@httpd.apache.org>; Tue,  6 Oct 2015 15:53:40 +0000 (UTC)
Received: by qgx61 with SMTP id 61so178444618qgx.3
        for <dev@httpd.apache.org>; Tue, 06 Oct 2015 08:53:40 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type:content-transfer-encoding;
        bh=fccRmxKlK/wMaW7CbWaV7Ipgcaa5Rc/fSbiHNgkH1Ls=;
        b=YODyHvuHIQp7l/FItOFXLxiwEgf8DLS8KXOEsMSIIsCN3zdb1ns1su1oA8DOqYQ+Tb
         15yBLPrhCOfQVLHZD42cMWEa7238WBoNe5KDkEAcymEhUppnrLlCbCc9zKvM3ayI/y2P
         pMptXjgodrhOkj5VGvpT3twTFLlwmfyVpGc4X5vIiNi68lvjwAhuUuFScZVi2RCK6GiB
         ApuQnrt+zi+LKni+DMHbr388MV+GtTOnq2fybGOw4gW61D5YGn9s4W6Im7ikhtnDz17d
         tNxWukmt4gqfCsdYcaubjEqA+bxDehOr3ytG1hN3PYtxBNUIYtDfqUEnaFQB/3PAdHX0
         giXA==
MIME-Version: 1.0
X-Received: by 10.140.101.119 with SMTP id t110mr49518823qge.71.1444146819904;
 Tue, 06 Oct 2015 08:53:39 -0700 (PDT)
Received: by 10.55.72.20 with HTTP; Tue, 6 Oct 2015 08:53:39 -0700 (PDT)
In-Reply-To: <660C359D-89D0-4951-ACEA-879BA3F4D726@sharp.fm>
References: <20151004101052.A6E193A0234@svn01-us-west.apache.org>
	<CAKQ1sVNRVJqqZSmzVn86K3SbztGSBQ68D2kTJRhWU1qMWDrUYA@mail.gmail.com>
	<9A9FBD0C-B503-4CDD-A833-74C69FF248EA@sharp.fm>
	<CAKQ1sVN2WwBhbJ26JOdm7YFnMyXtOfAbCX1eCeUse7Zh1k8O5Q@mail.gmail.com>
	<CAKQ1sVOA-X7CpjeJruq7wgbFi+WaBsMn-X_0Bpw+CUxmnHtYtg@mail.gmail.com>
	<660C359D-89D0-4951-ACEA-879BA3F4D726@sharp.fm>
Date: Tue, 6 Oct 2015 17:53:39 +0200
Message-ID: <CAKQ1sVNCADr1ojLpZ3R19q2tuyXqMGXO8OP-RWv07uQ+4qZsSQ@mail.gmail.com>
Subject: Re: svn commit: r1706669 - in /httpd/httpd/trunk: ./ include/
 modules/http/ modules/ssl/ server/ server/mpm/event/ server/mpm/motorz/ server/mpm/simple/
From: Yann Ylavic <ylavic.dev@gmail.com>
To: dev@httpd.apache.org
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: quoted-printable

On Tue, Oct 6, 2015 at 5:34 PM, Graham Leggett <minfrin@sharp.fm> wrote:
>
> apr_bucket_simple_copy() looks wrong - in theory we should have a proper =
copy function that does the right thing with the second copy, for example b=
y not copying the pool. If we blindly copy the pool (or the request contain=
ing the pool) I see nothing that would prevent an attempt to free the pool =
twice.

Agreed, we probably need something like this:

Index: server/eor_bucket.c
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D
--- server/eor_bucket.c    (revision 1707064)
+++ server/eor_bucket.c    (working copy)
@@ -91,6 +91,17 @@ static void eor_bucket_destroy(void *data)
     }
 }

+static apr_status_t eor_bucket_copy(apr_bucket *a, apr_bucket **b)
+{
+    *b =3D apr_bucket_alloc(sizeof(**b), a->list); /* XXX: check for failu=
re? */
+    **b =3D *a;
+
+    /* we don't wan't request to be destroyed twice */
+    (*b)->data =3D NULL;
+
+    return APR_SUCCESS;
+}
+
 AP_DECLARE_DATA const apr_bucket_type_t ap_bucket_type_eor =3D {
     "EOR", 5, APR_BUCKET_METADATA,
     eor_bucket_destroy,
@@ -97,6 +108,6 @@ AP_DECLARE_DATA const apr_bucket_type_t ap_bucket_
     eor_bucket_read,
     apr_bucket_setaside_noop,
     apr_bucket_split_notimpl,
-    apr_bucket_simple_copy
+    eor_bucket_copy
 };

--

Regards,
Yann.

From dev-return-84102-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Tue Oct  6 16:00:31 2015
Return-Path: <dev-return-84102-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id B263718721
	for <apmail-httpd-dev-archive@www.apache.org>; Tue,  6 Oct 2015 16:00:31 +0000 (UTC)
Received: (qmail 7153 invoked by uid 500); 6 Oct 2015 16:00:31 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 7083 invoked by uid 500); 6 Oct 2015 16:00:31 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 7073 invoked by uid 99); 6 Oct 2015 16:00:31 -0000
Received: from Unknown (HELO spamd3-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 06 Oct 2015 16:00:31 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd3-us-west.apache.org (ASF Mail Server at spamd3-us-west.apache.org) with ESMTP id 7F7DF180DCD
	for <dev@httpd.apache.org>; Tue,  6 Oct 2015 16:00:30 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd3-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.102
X-Spam-Level:
X-Spam-Status: No, score=-0.102 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RCVD_IN_MSPIKE_H2=-0.001, SPF_PASS=-0.001] autolearn=disabled
Authentication-Results: spamd3-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-us-west.apache.org ([10.40.0.8])
	by localhost (spamd3-us-west.apache.org [10.40.0.10]) (amavisd-new, port 10024)
	with ESMTP id tgF97DUADzED for <dev@httpd.apache.org>;
	Tue,  6 Oct 2015 16:00:30 +0000 (UTC)
Received: from mail-qg0-f54.google.com (mail-qg0-f54.google.com [209.85.192.54])
	by mx1-us-west.apache.org (ASF Mail Server at mx1-us-west.apache.org) with ESMTPS id A19FF20F20
	for <dev@httpd.apache.org>; Tue,  6 Oct 2015 16:00:29 +0000 (UTC)
Received: by qgt47 with SMTP id 47so178418982qgt.2
        for <dev@httpd.apache.org>; Tue, 06 Oct 2015 09:00:29 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        bh=MC/8NogJRvQfGcUipe0qVYYXt7UowAzuqYoLj1teaZQ=;
        b=P44EtmEkWyZh6cisB3x3qXTAoiONLB3ytXgJ5X8VWnE7uKJOqQI1pI66uoFMLe1eyb
         qCp6oIQUnDG9G4cwZ0ekzdwE9cg0fBiFpq07cSzTLR6EAOYZXBSbD1SX5Tc3gh+MCSmL
         kxORHNHIWnbXcJ1IF3e2o8PVrYIGxWD8aIICe/dg19bjtgxBmNqy+agEUmTZkxHGzuEa
         fnTJzw8J3kZL8PflWnZgUmFf/LcWrWfCAFhwgdI9MF4G+9bAvPLspU0SiwHrpZcUfJcy
         LP0QL/x/st0b2osKyAbQuAzSSDw1CeuScl7wWAVfoA2nqkonqKiDSPl+E8mqah7pxnrn
         fEmA==
MIME-Version: 1.0
X-Received: by 10.140.131.198 with SMTP id 189mr50749829qhd.83.1444147228976;
 Tue, 06 Oct 2015 09:00:28 -0700 (PDT)
Received: by 10.55.72.20 with HTTP; Tue, 6 Oct 2015 09:00:28 -0700 (PDT)
In-Reply-To: <20151006154400.GA30252@redhat.com>
References: <20151001154324.0CBD73A01DC@svn01-us-west.apache.org>
	<34694C4B-0561-441D-B7DC-6321A1ECE7E5@sharp.fm>
	<560D79EF.80201@apache.org>
	<CAKQ1sVPEikOgObBT5uD0VEYUM3a8cOBwEVK690k5JUU2C7UmPA@mail.gmail.com>
	<AB1691BE05AE7F4992697F2A0835627AC633DE2D@VOEXM10W.internal.vodafone.com>
	<20151006154400.GA30252@redhat.com>
Date: Tue, 6 Oct 2015 18:00:28 +0200
Message-ID: <CAKQ1sVPQYMnmKJCE8FtCetfgzVR5CggULxPM7Mx6iMexYac0RA@mail.gmail.com>
Subject: Re: svn commit: r1706275 - /httpd/httpd/trunk/modules/ssl/ssl_engine_io.c
From: Yann Ylavic <ylavic.dev@gmail.com>
To: dev@httpd.apache.org
Content-Type: text/plain; charset=UTF-8

On Tue, Oct 6, 2015 at 5:44 PM, Joe Orton <jorton@redhat.com> wrote:
>
> Hence In the server case, it seems reasonable to rely on BIO_flush()
> being called at the "right" times during the handshake.  Modulo the odd
> bug!
>
> But ssl/s3_clnt.c is not following that coding style at all, and it only
> does a flush after completing the handshake.  So I'd say the right thing
> here is to FLUSH after every packet which comes through the write BIO
> when the SSL state machine is in the middle of a "connect", i.e.
> handshake as client.
>
> tl;dr: I think Yann's patch should be right if the test is switched from
> "always flush if !SSL_is_init_finished(ssl)" to "always flush if
> SSL_in_connect_init(ssl)"???

Yes, I came to the same conclusion, but decided to use
SSL_is_init_finished(ssl) anyway because for the server case it seems
that openssl uses it own buffering mechanism to avoid writing small
chunks (after the client-hello is received), so possibly we could rely
on it (this also simplifies the logic).

From dev-return-84103-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Tue Oct  6 16:18:29 2015
Return-Path: <dev-return-84103-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 7AEE2187FE
	for <apmail-httpd-dev-archive@www.apache.org>; Tue,  6 Oct 2015 16:18:29 +0000 (UTC)
Received: (qmail 67712 invoked by uid 500); 6 Oct 2015 16:18:29 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 67635 invoked by uid 500); 6 Oct 2015 16:18:29 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 67625 invoked by uid 99); 6 Oct 2015 16:18:29 -0000
Received: from Unknown (HELO spamd1-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 06 Oct 2015 16:18:28 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd1-us-west.apache.org (ASF Mail Server at spamd1-us-west.apache.org) with ESMTP id 7A346C2E4D
	for <dev@httpd.apache.org>; Tue,  6 Oct 2015 16:18:28 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd1-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.121
X-Spam-Level:
X-Spam-Status: No, score=-0.121 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RCVD_IN_MSPIKE_H3=-0.01, RCVD_IN_MSPIKE_WL=-0.01, SPF_PASS=-0.001]
	autolearn=disabled
Authentication-Results: spamd1-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd1-us-west.apache.org [10.40.0.7]) (amavisd-new, port 10024)
	with ESMTP id K4IcOJTjc7ob for <dev@httpd.apache.org>;
	Tue,  6 Oct 2015 16:18:27 +0000 (UTC)
Received: from mail-qk0-f169.google.com (mail-qk0-f169.google.com [209.85.220.169])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id 10376204C9
	for <dev@httpd.apache.org>; Tue,  6 Oct 2015 16:18:27 +0000 (UTC)
Received: by qkht68 with SMTP id t68so3643309qkh.3
        for <dev@httpd.apache.org>; Tue, 06 Oct 2015 09:18:26 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        bh=g5tUsTUH7vOcQ8gnpTAwPGk7O6K5iT0SbzxyazBUGW4=;
        b=ncJZC5Iz7esFh0riLnhD1c8mpbDKSsnPb/zxeR7GnLuVibby6q66a36tua+wzxg3hT
         XS1oCIErLPZEXPlb9+ZAfVlS5+9PQxO2tbjM9XRCIctRavUrkZqTbqOLt2yYfeHXjerc
         4CQzREEsK+R/35zAX3VqNzqx1CfDz2bJVLeVtqA25XhJL6yTWjxiq1vPSMZigbHyjB9a
         1ULODUy3Rbc5Uxmy6mIDTNvwBb3J+mIOJ6xOYPDcyzcUrbDbPtpd82d3f1Rq0KCgWuH4
         FHf8CiB6C6rwerpHzqUwX3ndS1jaSR+glF94014fXqBQrG5jXj/ZH5kbKndQ/BlgnxGp
         F4hg==
MIME-Version: 1.0
X-Received: by 10.55.204.10 with SMTP id r10mr48739884qki.55.1444148306071;
 Tue, 06 Oct 2015 09:18:26 -0700 (PDT)
Received: by 10.55.72.20 with HTTP; Tue, 6 Oct 2015 09:18:26 -0700 (PDT)
In-Reply-To: <CAKQ1sVPQYMnmKJCE8FtCetfgzVR5CggULxPM7Mx6iMexYac0RA@mail.gmail.com>
References: <20151001154324.0CBD73A01DC@svn01-us-west.apache.org>
	<34694C4B-0561-441D-B7DC-6321A1ECE7E5@sharp.fm>
	<560D79EF.80201@apache.org>
	<CAKQ1sVPEikOgObBT5uD0VEYUM3a8cOBwEVK690k5JUU2C7UmPA@mail.gmail.com>
	<AB1691BE05AE7F4992697F2A0835627AC633DE2D@VOEXM10W.internal.vodafone.com>
	<20151006154400.GA30252@redhat.com>
	<CAKQ1sVPQYMnmKJCE8FtCetfgzVR5CggULxPM7Mx6iMexYac0RA@mail.gmail.com>
Date: Tue, 6 Oct 2015 18:18:26 +0200
Message-ID: <CAKQ1sVOw2jTDgvuXyXcUGCjZwYYOTqpiSAA26Q9cF3=2At-63w@mail.gmail.com>
Subject: Re: svn commit: r1706275 - /httpd/httpd/trunk/modules/ssl/ssl_engine_io.c
From: Yann Ylavic <ylavic.dev@gmail.com>
To: dev@httpd.apache.org
Content-Type: text/plain; charset=UTF-8

On Tue, Oct 6, 2015 at 6:00 PM, Yann Ylavic <ylavic.dev@gmail.com> wrote:
> On Tue, Oct 6, 2015 at 5:44 PM, Joe Orton <jorton@redhat.com> wrote:
>>
>> Hence In the server case, it seems reasonable to rely on BIO_flush()
>> being called at the "right" times during the handshake.  Modulo the odd
>> bug!
>>
>> But ssl/s3_clnt.c is not following that coding style at all, and it only
>> does a flush after completing the handshake.  So I'd say the right thing
>> here is to FLUSH after every packet which comes through the write BIO
>> when the SSL state machine is in the middle of a "connect", i.e.
>> handshake as client.
>>
>> tl;dr: I think Yann's patch should be right if the test is switched from
>> "always flush if !SSL_is_init_finished(ssl)" to "always flush if
>> SSL_in_connect_init(ssl)"???
>
> Yes, I came to the same conclusion, but decided to use
> SSL_is_init_finished(ssl) anyway because for the server case it seems
> that openssl uses it own buffering mechanism to avoid writing small
> chunks (after the client-hello is received), so possibly we could rely
> on it (this also simplifies the logic).

Also it seems that for the SSL_ST_RENEGOTIATE state in ssl3_accept(),
buffering is disabled by openssl (at least in 1.0.2d).
SSL_is_init_finished(ssl) should catch this case too...

Regards,
Yann.

From dev-return-84104-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Tue Oct  6 16:22:38 2015
Return-Path: <dev-return-84104-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id D9BC01882C
	for <apmail-httpd-dev-archive@www.apache.org>; Tue,  6 Oct 2015 16:22:38 +0000 (UTC)
Received: (qmail 75058 invoked by uid 500); 6 Oct 2015 16:22:29 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 74986 invoked by uid 500); 6 Oct 2015 16:22:28 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 74976 invoked by uid 99); 6 Oct 2015 16:22:28 -0000
Received: from Unknown (HELO spamd2-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 06 Oct 2015 16:22:28 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd2-us-west.apache.org (ASF Mail Server at spamd2-us-west.apache.org) with ESMTP id 867161A212B
	for <dev@httpd.apache.org>; Tue,  6 Oct 2015 16:22:28 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd2-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.001
X-Spam-Level:
X-Spam-Status: No, score=-0.001 tagged_above=-999 required=6.31
	tests=[RCVD_IN_MSPIKE_H2=-0.001, SPF_PASS=-0.001, URIBL_BLOCKED=0.001]
	autolearn=disabled
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd2-us-west.apache.org [10.40.0.9]) (amavisd-new, port 10024)
	with ESMTP id La2U-N6t8z3c for <dev@httpd.apache.org>;
	Tue,  6 Oct 2015 16:22:21 +0000 (UTC)
Received: from mout.gmx.net (mout.gmx.net [212.227.15.19])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id 0EE10204C8
	for <dev@httpd.apache.org>; Tue,  6 Oct 2015 16:22:21 +0000 (UTC)
Received: from [192.168.0.100] ([87.139.233.65]) by mail.gmx.com (mrgmx001)
 with ESMTPSA (Nemesis) id 0MIMUZ-1ZlymB2Iv9-0049yF for
 <dev@httpd.apache.org>; Tue, 06 Oct 2015 18:22:20 +0200
Subject: Re: T&R of 2.4.17 this week
To: dev@httpd.apache.org
References: <9ACC24A9-B381-4C18-B1C4-8D9F62DD7DB5@jaguNET.com>
 <5612C1B4.7040601@gmx.de>
 <CAKQ1sVORKbSkXLrwkKutucXpBQr+woZjnqt=EaMgjQxR6TB65g@mail.gmail.com>
From: olli hauer <ohauer@gmx.de>
Message-ID: <5613F53B.1080504@gmx.de>
Date: Tue, 6 Oct 2015 18:22:19 +0200
User-Agent: Mozilla/5.0 (Windows NT 5.1; rv:38.0) Gecko/20100101
 Thunderbird/38.3.0
MIME-Version: 1.0
In-Reply-To: <CAKQ1sVORKbSkXLrwkKutucXpBQr+woZjnqt=EaMgjQxR6TB65g@mail.gmail.com>
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit
X-Provags-ID: V03:K0:WnxX/Q5ZLzXEwwDzI83kGUYZAAu7Je8UrCkNrkt9ZykQhjLrDau
 GCToDI0Z13Niy/etVyNaSJGoiwNN8966r3fBkReXrgErXOyrLwnNn1GJr4SBxiVylw2h/ib
 ezQo5I/I4RB7sDAY0A9XxWFYTaODFo53ylsaSlNJym/XImR/Y3kQB2hf2uM9ef51SzwNLrl
 Vp6ZJkygU5hQai73EqmKA==
X-UI-Out-Filterresults: notjunk:1;V01:K0:RPkqCEYSKTQ=:pwwRWiHvz7KIQuJ0oYimGS
 dbnNp5dKA5OeDDPC6d2Pk1StcrecQimMW5rvZnyazXuM+LQqnihK4tOPmZhgbZA+Zwj+egmps
 H3Q3HN2+L4Gn/CzCAECsNuZQwbdw9+sWQy0A2uiDRmLwQs+LFDGKKDFjvbnG0mOQRzWk6qjGq
 HV3NrHTkQxuzlyT5X0naD/uCbyVYMVHLeexzEDLLcGj+JKjtlEfFkZQJfnCKXm+i7iMyz2ZhV
 B7sCP4bPHf0L3cdcdck2tI//NZZ76hYlWL/hWmJN2tBK4QFSYlWq4zLP7yr85q2rgdA8DTAcy
 oKgaApCAdEgZYIEh5D7LadUOnS11glG+WvuMVK3nXxYLelomDqmM2KfbPWeMdJQz6+xtuPEvn
 AAlvx84m4MeBY4oFGmE9TfTEP+SvHNLnCGNPty9w5L5RpoKYQYpsCgC52dnXqLwMyb7PhpRHr
 ZwHKwwDb2eyLOEdoYMNRQ8HrF5L0U1/F7fs4LwUx4zxMEUgZ5lV7GlAtkAha/UsVb1jYZcYUX
 77M3qsWz+aNQK1F6W7I/9tHZOHaBYETsMuq8QMYM6+t/8aKYjTGYejnEqny76NE+jrMs4JVCu
 3AYY+yF5DcoJLN2GrzYCJQW+gPGJK06E0AVNst2LtyibhTgvXQLDBmpVW3ZE351mM2H57DLe0
 6fV+yoL/SPANsShqUi6V67n62HY2OxfzXV6KmKIrPI1KzZkDF3Ps1rCxPS31kayTDe0Jwyr/6
 Ds0jgwen3xlQ7Gu6FfXtIWbpZ5SiewWvNYRM7NJkrnDg0bmxtMpQulv+QLMA5LSzPXP2ImGWA
 iDa5BAv

On 2015-10-05 23:07, Yann Ylavic wrote:
> On Mon, Oct 5, 2015 at 8:30 PM, olli hauer <ohauer@gmx.de> wrote:
>>
>> would you mind to look at #58126 ?
>>
>> It contains a simple patch for acinclude.m4 to suppress warnings about underquoted calls to AC_DEFUN.
> 
> Committed in r1706918, backport proposed in r1706923.
> 
> Regards,
> Yann.
> 

Thanks! :)

From dev-return-84105-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Tue Oct  6 16:23:26 2015
Return-Path: <dev-return-84105-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 15DC618836
	for <apmail-httpd-dev-archive@www.apache.org>; Tue,  6 Oct 2015 16:23:26 +0000 (UTC)
Received: (qmail 77629 invoked by uid 500); 6 Oct 2015 16:23:25 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 77551 invoked by uid 500); 6 Oct 2015 16:23:25 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 77541 invoked by uid 99); 6 Oct 2015 16:23:25 -0000
Received: from Unknown (HELO spamd4-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 06 Oct 2015 16:23:25 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd4-us-west.apache.org (ASF Mail Server at spamd4-us-west.apache.org) with ESMTP id 3372EC028F
	for <dev@httpd.apache.org>; Tue,  6 Oct 2015 16:23:25 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd4-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 0.653
X-Spam-Level:
X-Spam-Status: No, score=0.653 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, SPF_NEUTRAL=0.652,
	URIBL_BLOCKED=0.001] autolearn=disabled
Authentication-Results: spamd4-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=comcast.net
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd4-us-west.apache.org [10.40.0.11]) (amavisd-new, port 10024)
	with ESMTP id QaSeE7oTjhpT for <dev@httpd.apache.org>;
	Tue,  6 Oct 2015 16:23:16 +0000 (UTC)
Received: from resqmta-ch2-10v.sys.comcast.net (resqmta-ch2-10v.sys.comcast.net [69.252.207.42])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id 44287204C9
	for <dev@httpd.apache.org>; Tue,  6 Oct 2015 16:23:15 +0000 (UTC)
Received: from resomta-ch2-10v.sys.comcast.net ([69.252.207.106])
	by resqmta-ch2-10v.sys.comcast.net with comcast
	id RsNM1r00G2JGN3p01sP8ss; Tue, 06 Oct 2015 16:23:08 +0000
Received: from [192.168.199.10] ([69.251.84.114])
	by resomta-ch2-10v.sys.comcast.net with comcast
	id RsP81r0022U0RYt01sP8Yu; Tue, 06 Oct 2015 16:23:08 +0000
Content-Type: text/plain; charset=us-ascii
Mime-Version: 1.0 (Mac OS X Mail 8.2 \(2104\))
Subject: Re: svn commit: r1704683 - /httpd/httpd/trunk/docs/manual/mod/mod_remoteip.xml
From: Jim Jagielski <jim@jaguNET.com>
In-Reply-To: <CALK=YjPrbVXu2Cg2ke_rmGH+ZZ3=dQvEN1q4y9zhef0o0V54nA@mail.gmail.com>
Date: Tue, 6 Oct 2015 12:23:07 -0400
Content-Transfer-Encoding: quoted-printable
Message-Id: <C51E0B21-44CF-40D1-B7D8-A5D88A85100C@jaguNET.com>
References: <20150922181140.18E873A0818@svn01-us-west.apache.org> <CALK=YjPBPR=qJ+wFx+Hf1+yYF8YUkJ-bFjCLiuPoW+pP+xaiTA@mail.gmail.com> <CACsi250uxMUntOT5VesBs=KQ5=r2FSma9MA0STRVGr47PXXFAA@mail.gmail.com> <CALK=YjOHkErODYKEFG=O0Lngd04Csm_K5uxExSFUXtNFY6igbw@mail.gmail.com> <CACsi250knfKyt9zXKQAMeqLgS5g1=hH+HnVAcarufBgJAvOEqg@mail.gmail.com> <CALK=YjPrbVXu2Cg2ke_rmGH+ZZ3=dQvEN1q4y9zhef0o0V54nA@mail.gmail.com>
To: dev@httpd.apache.org
X-Mailer: Apple Mail (2.2104)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=comcast.net;
	s=q20140121; t=1444148588;
	bh=Ar5JLF3PgcmesHm7vx65hqFrZ5Aa+/QJJ9CP8QyL59E=;
	h=Received:Received:Content-Type:Mime-Version:Subject:From:Date:
	 Message-Id:To;
	b=wulJPKfNvmp3O2yxYIu/CkHfb5b/m+4MHQgLg93L7ks/eWLFxD4I31IL2tVKdymf8
	 LD/hDJ015P1xYXw5roCROzbrNX6Xf8z/oLf/X/EMZ/RjevvedWe70F8ScGbPto9eEW
	 Z5/11WYfGG1tJzMKPMFWeZIv6KcVIIYduGhbszvt/hQi2uhb58E+yxhqJckW4uRZKk
	 5EZ7e+KPDCq6mfc/7GhbMIatRK39MULMCDjUTFRda6XtE+ZRX+4KSTtLC54UClponl
	 GGmDqBm3bTrZ0v94E4GrX8SNLVom8fR/CfyoASEBXw8T6SZdJAPYWbi85il4/YdPAv
	 hro9u8Oe6V/bw==


> On Oct 6, 2015, at 10:47 AM, Eric Covener <covener@gmail.com> wrote:
>=20
> On Tue, Sep 22, 2015 at 11:09 PM, William A Rowe Jr =
<wrowe@rowe-clan.net> wrote:
>> On Tue, Sep 22, 2015 at 8:48 PM, Eric Covener <covener@gmail.com> =
wrote:
>>>=20
>>> Maybe my followup is better phrased.  No issue with handling of =
internal
>>> IPs.
>>>=20
>>> Currently, we act like RemoteIPTrustedProxy * by default (once =
they've
>>> named the XFF header) and warn people they'd better restrict it.
>>=20
>>=20
>> I agree that was not the original design and we should address it =
with a fix
>> rather than a docs fix, IMHO.  'Trusted' is the exception, not the =
general
>> case.
>=20
> bump. I don't love the idea of changing the 2.4 defaults.

+1

>=20
> Current doc already says "Unless these other directives are used,
> mod_remoteip will trust all hosts presenting a RemoteIPHeader IP
> value." so I thought it was wise  to reinforce this in other sections.
>  Doc is not back-ported yet.


From dev-return-84106-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Tue Oct  6 16:29:44 2015
Return-Path: <dev-return-84106-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id DEA631886D
	for <apmail-httpd-dev-archive@www.apache.org>; Tue,  6 Oct 2015 16:29:43 +0000 (UTC)
Received: (qmail 90142 invoked by uid 500); 6 Oct 2015 16:29:37 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 90067 invoked by uid 500); 6 Oct 2015 16:29:37 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 90057 invoked by uid 99); 6 Oct 2015 16:29:37 -0000
Received: from Unknown (HELO spamd2-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 06 Oct 2015 16:29:37 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd2-us-west.apache.org (ASF Mail Server at spamd2-us-west.apache.org) with ESMTP id AD9F91A212B
	for <dev@httpd.apache.org>; Tue,  6 Oct 2015 16:29:36 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd2-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.101
X-Spam-Level:
X-Spam-Status: No, score=-0.101 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RCVD_IN_MSPIKE_H2=-0.001, SPF_PASS=-0.001, URIBL_BLOCKED=0.001]
	autolearn=disabled
Authentication-Results: spamd2-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd2-us-west.apache.org [10.40.0.9]) (amavisd-new, port 10024)
	with ESMTP id FFcdX-P1c5WE for <dev@httpd.apache.org>;
	Tue,  6 Oct 2015 16:29:31 +0000 (UTC)
Received: from mail-qk0-f176.google.com (mail-qk0-f176.google.com [209.85.220.176])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id 605B527DC7
	for <dev@httpd.apache.org>; Tue,  6 Oct 2015 16:29:31 +0000 (UTC)
Received: by qkbi190 with SMTP id i190so67842817qkb.1
        for <dev@httpd.apache.org>; Tue, 06 Oct 2015 09:29:30 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type:content-transfer-encoding;
        bh=06kwepdDOKCEbHcMilAjB8AhQxtRPCo8iHG/+m+V2uA=;
        b=sV4K0gMNmJNxehb3atG5EKtapWe2KEq8xUDY8QLPD6eH7hXPz8o1M35yfWYa7AR5/p
         a1jRdACp4Y639IotHgQnNsAwO4OewEP/IAWQ4iqAlvf2O7jOjMO+ctW81dG4FfnCDKbe
         ovpQSibtVAu30GJ0fxXZQ/Fuw5gUngpwc2n18lzQmB2DmnA7FUvEC5cysLsAgDmDNEQc
         MT9wpn+blUBpjol+L50I5bTrg/NSAME+kIYRM3FXzpQPHCoa+CjXOjAWf7xyyi54CnBZ
         NIHFJCl2sylBbFABUDsQZY68hKuTkMw0q+x+pRXlizeyQM0hHMUdoImWwjzBNZg/wn7g
         3Efg==
MIME-Version: 1.0
X-Received: by 10.55.15.134 with SMTP id 6mr2503149qkp.38.1444148970463; Tue,
 06 Oct 2015 09:29:30 -0700 (PDT)
Received: by 10.55.72.20 with HTTP; Tue, 6 Oct 2015 09:29:30 -0700 (PDT)
In-Reply-To: <CAKQ1sVNCADr1ojLpZ3R19q2tuyXqMGXO8OP-RWv07uQ+4qZsSQ@mail.gmail.com>
References: <20151004101052.A6E193A0234@svn01-us-west.apache.org>
	<CAKQ1sVNRVJqqZSmzVn86K3SbztGSBQ68D2kTJRhWU1qMWDrUYA@mail.gmail.com>
	<9A9FBD0C-B503-4CDD-A833-74C69FF248EA@sharp.fm>
	<CAKQ1sVN2WwBhbJ26JOdm7YFnMyXtOfAbCX1eCeUse7Zh1k8O5Q@mail.gmail.com>
	<CAKQ1sVOA-X7CpjeJruq7wgbFi+WaBsMn-X_0Bpw+CUxmnHtYtg@mail.gmail.com>
	<660C359D-89D0-4951-ACEA-879BA3F4D726@sharp.fm>
	<CAKQ1sVNCADr1ojLpZ3R19q2tuyXqMGXO8OP-RWv07uQ+4qZsSQ@mail.gmail.com>
Date: Tue, 6 Oct 2015 18:29:30 +0200
Message-ID: <CAKQ1sVPVuYQEynjevqQyP-AFe3GFuT10-dvxY+jvWneouOYC-g@mail.gmail.com>
Subject: Re: svn commit: r1706669 - in /httpd/httpd/trunk: ./ include/
 modules/http/ modules/ssl/ server/ server/mpm/event/ server/mpm/motorz/ server/mpm/simple/
From: Yann Ylavic <ylavic.dev@gmail.com>
To: dev@httpd.apache.org
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: quoted-printable

On Tue, Oct 6, 2015 at 5:53 PM, Yann Ylavic <ylavic.dev@gmail.com> wrote:
> On Tue, Oct 6, 2015 at 5:34 PM, Graham Leggett <minfrin@sharp.fm> wrote:
>>
>> apr_bucket_simple_copy() looks wrong - in theory we should have a proper=
 copy function that does the right thing with the second copy, for example =
by not copying the pool. If we blindly copy the pool (or the request contai=
ning the pool) I see nothing that would prevent an attempt to free the pool=
 twice.
>
> Agreed, we probably need something like this:

Committed in r1707084, all tests pass now.

From dev-return-84107-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Tue Oct  6 16:49:33 2015
Return-Path: <dev-return-84107-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 7B9CB1894F
	for <apmail-httpd-dev-archive@www.apache.org>; Tue,  6 Oct 2015 16:49:33 +0000 (UTC)
Received: (qmail 56896 invoked by uid 500); 6 Oct 2015 16:49:33 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 56826 invoked by uid 500); 6 Oct 2015 16:49:33 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 56816 invoked by uid 99); 6 Oct 2015 16:49:32 -0000
Received: from Unknown (HELO spamd1-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 06 Oct 2015 16:49:32 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd1-us-west.apache.org (ASF Mail Server at spamd1-us-west.apache.org) with ESMTP id 73833C3B39
	for <dev@httpd.apache.org>; Tue,  6 Oct 2015 16:49:32 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd1-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 0.653
X-Spam-Level:
X-Spam-Status: No, score=0.653 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, SPF_NEUTRAL=0.652,
	URIBL_BLOCKED=0.001] autolearn=disabled
Authentication-Results: spamd1-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=comcast.net
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd1-us-west.apache.org [10.40.0.7]) (amavisd-new, port 10024)
	with ESMTP id B53hoXB3twEG for <dev@httpd.apache.org>;
	Tue,  6 Oct 2015 16:49:23 +0000 (UTC)
Received: from resqmta-ch2-09v.sys.comcast.net (resqmta-ch2-09v.sys.comcast.net [69.252.207.41])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id E4AC9439CB
	for <dev@httpd.apache.org>; Tue,  6 Oct 2015 16:49:22 +0000 (UTC)
Received: from resomta-ch2-09v.sys.comcast.net ([69.252.207.105])
	by resqmta-ch2-09v.sys.comcast.net with comcast
	id RspD1r0032GyhjZ01spGET; Tue, 06 Oct 2015 16:49:16 +0000
Received: from [192.168.199.10] ([69.251.84.114])
	by resomta-ch2-09v.sys.comcast.net with comcast
	id RspF1r00Z2U0RYt01spGof; Tue, 06 Oct 2015 16:49:16 +0000
Content-Type: text/plain; charset=us-ascii
Mime-Version: 1.0 (Mac OS X Mail 8.2 \(2104\))
Subject: Re: svn commit: r1706669 - in /httpd/httpd/trunk: ./ include/ modules/http/ modules/ssl/ server/ server/mpm/event/ server/mpm/motorz/ server/mpm/simple/
From: Jim Jagielski <jim@jaguNET.com>
In-Reply-To: <CAKQ1sVNCADr1ojLpZ3R19q2tuyXqMGXO8OP-RWv07uQ+4qZsSQ@mail.gmail.com>
Date: Tue, 6 Oct 2015 12:49:15 -0400
Content-Transfer-Encoding: quoted-printable
Message-Id: <8FA482FA-8375-41CE-8CEA-69B791406762@jaguNET.com>
References: <20151004101052.A6E193A0234@svn01-us-west.apache.org> <CAKQ1sVNRVJqqZSmzVn86K3SbztGSBQ68D2kTJRhWU1qMWDrUYA@mail.gmail.com> <9A9FBD0C-B503-4CDD-A833-74C69FF248EA@sharp.fm> <CAKQ1sVN2WwBhbJ26JOdm7YFnMyXtOfAbCX1eCeUse7Zh1k8O5Q@mail.gmail.com> <CAKQ1sVOA-X7CpjeJruq7wgbFi+WaBsMn-X_0Bpw+CUxmnHtYtg@mail.gmail.com> <660C359D-89D0-4951-ACEA-879BA3F4D726@sharp.fm> <CAKQ1sVNCADr1ojLpZ3R19q2tuyXqMGXO8OP-RWv07uQ+4qZsSQ@mail.gmail.com>
To: dev@httpd.apache.org
X-Mailer: Apple Mail (2.2104)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=comcast.net;
	s=q20140121; t=1444150156;
	bh=F40r2geEIVZ5FGF4Q/T9p+XTtmEwVOnGb4oLiEr5NKI=;
	h=Received:Received:Content-Type:Mime-Version:Subject:From:Date:
	 Message-Id:To;
	b=E/QSfRFQSTAdNel5b8PHGshUJyFxOvcgxLZvg5TWRw8cU+w//eqoqEEJietvIwVsH
	 5beb0Q1496TnANzt3IWrlUGlOpd4LT/0eaGwqW29lgCcGckcoIrHOmNDCnVNleD4yE
	 GtpW6XpBIM7ahttHuYfSJChU0OxCPmuaBIAUmOTZ3WOe0xk0BXv31iwDp5q5xzvt0U
	 CwLA6qWaovbLzdqQDRwGHuHGsf+cZVGuNaB9+zxe9xWtidphchAamceOluC4cyIaKs
	 wrP7tA3WbdHMDI0gf8E2O2GR+sHoi2pgMBPuoHJuY+5rSuZkgIDdxuwPEObedyifDs
	 NtJfXXQuF/O6A==

+1 (concept)

> On Oct 6, 2015, at 11:53 AM, Yann Ylavic <ylavic.dev@gmail.com> wrote:
>=20
> On Tue, Oct 6, 2015 at 5:34 PM, Graham Leggett <minfrin@sharp.fm> =
wrote:
>>=20
>> apr_bucket_simple_copy() looks wrong - in theory we should have a =
proper copy function that does the right thing with the second copy, for =
example by not copying the pool. If we blindly copy the pool (or the =
request containing the pool) I see nothing that would prevent an attempt =
to free the pool twice.
>=20
> Agreed, we probably need something like this:
>=20
> Index: server/eor_bucket.c
> =3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D
> --- server/eor_bucket.c    (revision 1707064)
> +++ server/eor_bucket.c    (working copy)
> @@ -91,6 +91,17 @@ static void eor_bucket_destroy(void *data)
>     }
> }
>=20
> +static apr_status_t eor_bucket_copy(apr_bucket *a, apr_bucket **b)
> +{
> +    *b =3D apr_bucket_alloc(sizeof(**b), a->list); /* XXX: check for =
failure? */
> +    **b =3D *a;
> +
> +    /* we don't wan't request to be destroyed twice */
> +    (*b)->data =3D NULL;
> +
> +    return APR_SUCCESS;
> +}
> +
> AP_DECLARE_DATA const apr_bucket_type_t ap_bucket_type_eor =3D {
>     "EOR", 5, APR_BUCKET_METADATA,
>     eor_bucket_destroy,
> @@ -97,6 +108,6 @@ AP_DECLARE_DATA const apr_bucket_type_t ap_bucket_
>     eor_bucket_read,
>     apr_bucket_setaside_noop,
>     apr_bucket_split_notimpl,
> -    apr_bucket_simple_copy
> +    eor_bucket_copy
> };
>=20
> --
>=20
> Regards,
> Yann.


From dev-return-84108-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Tue Oct  6 17:00:43 2015
Return-Path: <dev-return-84108-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id C1A86189F5
	for <apmail-httpd-dev-archive@www.apache.org>; Tue,  6 Oct 2015 17:00:43 +0000 (UTC)
Received: (qmail 92582 invoked by uid 500); 6 Oct 2015 17:00:36 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 92507 invoked by uid 500); 6 Oct 2015 17:00:36 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 92497 invoked by uid 99); 6 Oct 2015 17:00:36 -0000
Received: from Unknown (HELO spamd2-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 06 Oct 2015 17:00:36 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd2-us-west.apache.org (ASF Mail Server at spamd2-us-west.apache.org) with ESMTP id 48F9B1A20D8
	for <dev@httpd.apache.org>; Tue,  6 Oct 2015 17:00:36 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd2-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.102
X-Spam-Level:
X-Spam-Status: No, score=-0.102 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RCVD_IN_MSPIKE_H2=-0.001, SPF_PASS=-0.001] autolearn=disabled
Authentication-Results: spamd2-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd2-us-west.apache.org [10.40.0.9]) (amavisd-new, port 10024)
	with ESMTP id 3iCC46mnzkwI for <dev@httpd.apache.org>;
	Tue,  6 Oct 2015 17:00:35 +0000 (UTC)
Received: from mail-qg0-f50.google.com (mail-qg0-f50.google.com [209.85.192.50])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id B6EE2201F9
	for <dev@httpd.apache.org>; Tue,  6 Oct 2015 17:00:34 +0000 (UTC)
Received: by qgez77 with SMTP id z77so180454466qge.1
        for <dev@httpd.apache.org>; Tue, 06 Oct 2015 10:00:33 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        bh=tXFAKBbJj3t7KrZfzraD/ga5y0YG4/doLFMebEp8T3M=;
        b=vtYkTfAEv0BxmuQWCyWXBsXNnwoVCZADCsAIJHmnlON1bp8VsPSx/OI54rCuZwmSrQ
         IzXKehuYT0ICot1qy22040nBAIrFwDxqurV7oSL2AB64Tw7X8DVVdPbaIeVUXt1orz6J
         ahJvOyN2Uxs5FBckKCbBkxiToci531J0fcn/t+euVn1woUx3ynTlLqeiJ3hTJVcL3DFV
         JT+Q6baH0n8w2okfipXa/yoZg4Nrl8cKXIuvY9/fq6wRUJRE3Za5IUigBUUipywhsFhA
         8u6vd229BB4BsOPXCHNRb/4BasMgYlhfhz3BE2WGB/Rb3PmRFYPJKci3VG+jZIlsf0yc
         9Q3Q==
MIME-Version: 1.0
X-Received: by 10.141.23.9 with SMTP id z9mr50545180qhd.24.1444150833687; Tue,
 06 Oct 2015 10:00:33 -0700 (PDT)
Received: by 10.55.72.20 with HTTP; Tue, 6 Oct 2015 10:00:33 -0700 (PDT)
In-Reply-To: <CAKQ1sVPVuYQEynjevqQyP-AFe3GFuT10-dvxY+jvWneouOYC-g@mail.gmail.com>
References: <20151004101052.A6E193A0234@svn01-us-west.apache.org>
	<CAKQ1sVNRVJqqZSmzVn86K3SbztGSBQ68D2kTJRhWU1qMWDrUYA@mail.gmail.com>
	<9A9FBD0C-B503-4CDD-A833-74C69FF248EA@sharp.fm>
	<CAKQ1sVN2WwBhbJ26JOdm7YFnMyXtOfAbCX1eCeUse7Zh1k8O5Q@mail.gmail.com>
	<CAKQ1sVOA-X7CpjeJruq7wgbFi+WaBsMn-X_0Bpw+CUxmnHtYtg@mail.gmail.com>
	<660C359D-89D0-4951-ACEA-879BA3F4D726@sharp.fm>
	<CAKQ1sVNCADr1ojLpZ3R19q2tuyXqMGXO8OP-RWv07uQ+4qZsSQ@mail.gmail.com>
	<CAKQ1sVPVuYQEynjevqQyP-AFe3GFuT10-dvxY+jvWneouOYC-g@mail.gmail.com>
Date: Tue, 6 Oct 2015 19:00:33 +0200
Message-ID: <CAKQ1sVO5J3SBqc8w=m16R=vESgTpKqL5_E7dD9TRXMdd1KbT8A@mail.gmail.com>
Subject: Re: svn commit: r1706669 - in /httpd/httpd/trunk: ./ include/
 modules/http/ modules/ssl/ server/ server/mpm/event/ server/mpm/motorz/ server/mpm/simple/
From: Yann Ylavic <ylavic.dev@gmail.com>
To: dev@httpd.apache.org
Content-Type: text/plain; charset=UTF-8

On Tue, Oct 6, 2015 at 6:29 PM, Yann Ylavic <ylavic.dev@gmail.com> wrote:
>
> all tests pass now.

I spoke too soon...

New segfault is in mod_substitute:

Program terminated with signal 11, Segmentation fault.

(gdb) bt
#0  0x00007fa02fbaec2b in allocator_free (allocator=0x1cedcb0,
node=0x0) at memory/unix/apr_pools.c:421
#1  0x00007fa02fbaf3a2 in apr_pool_clear (pool=0x1d104e8) at
memory/unix/apr_pools.c:947
#2  0x00007fa02b2f1b79 in substitute_filter (f=0x1d0bdb8,
bb=0x1cf27e8) at mod_substitute.c:552
#3  0x000000000043ff57 in ap_pass_brigade (next=0x1d0bdb8,
bb=0x1cf27e8) at util_filter.c:608
#4  0x0000000000488ce4 in ap_process_request_after_handler
(r=0x1cf3e50) at http_request.c:275
#5  0x0000000000488ffc in ap_process_async_request (r=0x1cf3e50) at
http_request.c:371
#6  0x000000000048513d in ap_process_http_async_connection
(c=0x1cee0b8) at http_core.c:154
#7  0x0000000000485360 in ap_process_http_connection (c=0x1cee0b8) at
http_core.c:248
#8  0x0000000000478cc5 in ap_run_process_connection (c=0x1cee0b8) at
connection.c:41
#9  0x00007fa025d0b7e1 in process_socket (thd=0x1b2fcd8, p=0x1cedda8,
sock=0x1cede20, cs=0x1cee028, my_child_num=0, my_thread_num=0) at
event.c:1136
#10 0x00007fa025d0e334 in worker_thread (thd=0x1b2fcd8,
dummy=0x1c98c20) at event.c:2247
#11 0x00007fa02fbbe6af in dummy_worker (opaque=0x1b2fcd8) at
threadproc/unix/thread.c:145
#12 0x00007fa02f50f8ca in start_thread (arg=<optimized out>) at
pthread_create.c:300
#13 0x00007fa02ee4a08d in clone () at
../sysdeps/unix/sysv/linux/x86_64/clone.S:112
#14 0x0000000000000000 in ?? ()

Yet another filter which does not remove itself after the EOS, and
destroys the EOR bucket while still using *r after.

From dev-return-84109-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Tue Oct  6 17:15:14 2015
Return-Path: <dev-return-84109-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 3EC1218AF6
	for <apmail-httpd-dev-archive@www.apache.org>; Tue,  6 Oct 2015 17:15:14 +0000 (UTC)
Received: (qmail 44728 invoked by uid 500); 6 Oct 2015 17:15:13 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 44658 invoked by uid 500); 6 Oct 2015 17:15:13 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 44647 invoked by uid 99); 6 Oct 2015 17:15:13 -0000
Received: from Unknown (HELO spamd3-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 06 Oct 2015 17:15:13 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd3-us-west.apache.org (ASF Mail Server at spamd3-us-west.apache.org) with ESMTP id ECB1B180A89
	for <dev@httpd.apache.org>; Tue,  6 Oct 2015 17:15:12 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd3-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.121
X-Spam-Level:
X-Spam-Status: No, score=-0.121 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RCVD_IN_MSPIKE_H3=-0.01, RCVD_IN_MSPIKE_WL=-0.01, SPF_PASS=-0.001]
	autolearn=disabled
Authentication-Results: spamd3-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd3-us-west.apache.org [10.40.0.10]) (amavisd-new, port 10024)
	with ESMTP id ou6gXThaOpTe for <dev@httpd.apache.org>;
	Tue,  6 Oct 2015 17:15:11 +0000 (UTC)
Received: from mail-qk0-f181.google.com (mail-qk0-f181.google.com [209.85.220.181])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id C86E5201F9
	for <dev@httpd.apache.org>; Tue,  6 Oct 2015 17:15:10 +0000 (UTC)
Received: by qkbi190 with SMTP id i190so68450930qkb.1
        for <dev@httpd.apache.org>; Tue, 06 Oct 2015 10:15:10 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        bh=+tcXdQMWLaPyCUHWp09snv0FBTXsiwKDeFapTNIXfaU=;
        b=ozG3fMKKQJD5mYb1GJknVBKKoQw64ESLKwvElPEqAEvfQno8wgyyDjH/uGfpmOr4zp
         w9eU1rQVBiYRfkpQcTT9yzk6VO9uiZUaPKD8V7Roy3RUIEB08WC6PcPeRt/FrbUrgkmO
         OXM3PvwZi4kngkyI+YozT8Rpa8LEthEOhqY5KlWiraRHA9oaK79X9PjfX0X08Pyh7uG5
         xo68ZFx73NHCfrZKuA1HC6x6F4kLTd2x4Q3RJXHfFYP2OT53hzHFwINGHylSbXAf3o/3
         bbX/WKs7hERgKOZOCxXBI5T7K9gic+Et57pLRtt+BiWce+QT//QieBi+oGoYw56Pzgp0
         Ul4A==
MIME-Version: 1.0
X-Received: by 10.55.204.10 with SMTP id r10mr49116423qki.55.1444151709962;
 Tue, 06 Oct 2015 10:15:09 -0700 (PDT)
Received: by 10.55.72.20 with HTTP; Tue, 6 Oct 2015 10:15:09 -0700 (PDT)
In-Reply-To: <CAKQ1sVO5J3SBqc8w=m16R=vESgTpKqL5_E7dD9TRXMdd1KbT8A@mail.gmail.com>
References: <20151004101052.A6E193A0234@svn01-us-west.apache.org>
	<CAKQ1sVNRVJqqZSmzVn86K3SbztGSBQ68D2kTJRhWU1qMWDrUYA@mail.gmail.com>
	<9A9FBD0C-B503-4CDD-A833-74C69FF248EA@sharp.fm>
	<CAKQ1sVN2WwBhbJ26JOdm7YFnMyXtOfAbCX1eCeUse7Zh1k8O5Q@mail.gmail.com>
	<CAKQ1sVOA-X7CpjeJruq7wgbFi+WaBsMn-X_0Bpw+CUxmnHtYtg@mail.gmail.com>
	<660C359D-89D0-4951-ACEA-879BA3F4D726@sharp.fm>
	<CAKQ1sVNCADr1ojLpZ3R19q2tuyXqMGXO8OP-RWv07uQ+4qZsSQ@mail.gmail.com>
	<CAKQ1sVPVuYQEynjevqQyP-AFe3GFuT10-dvxY+jvWneouOYC-g@mail.gmail.com>
	<CAKQ1sVO5J3SBqc8w=m16R=vESgTpKqL5_E7dD9TRXMdd1KbT8A@mail.gmail.com>
Date: Tue, 6 Oct 2015 19:15:09 +0200
Message-ID: <CAKQ1sVNfF_0hpxPgQ0NWVahxsxjwRQXPJAZ+HVjCFVCHOzUnRg@mail.gmail.com>
Subject: Re: svn commit: r1706669 - in /httpd/httpd/trunk: ./ include/
 modules/http/ modules/ssl/ server/ server/mpm/event/ server/mpm/motorz/ server/mpm/simple/
From: Yann Ylavic <ylavic.dev@gmail.com>
To: dev@httpd.apache.org
Content-Type: text/plain; charset=UTF-8

On Tue, Oct 6, 2015 at 7:00 PM, Yann Ylavic <ylavic.dev@gmail.com> wrote:
> On Tue, Oct 6, 2015 at 6:29 PM, Yann Ylavic <ylavic.dev@gmail.com> wrote:
>>
>> all tests pass now.
>
> I spoke too soon...
>
> New segfault is in mod_substitute:

Fixed in r1707091.
Now all tests really pass :p

I wonder how we should address the possible (third-party-)breakage due
to ap_pass_brigade(c->ouput_filters, EOR) =>
ap_pass_brigade(r->ouput_filters, EOR) in
ap_process_request_after_handler(), should this be backported in
2.4.x...

From dev-return-84110-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Tue Oct  6 17:30:15 2015
Return-Path: <dev-return-84110-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id BC8F118BAF
	for <apmail-httpd-dev-archive@www.apache.org>; Tue,  6 Oct 2015 17:30:15 +0000 (UTC)
Received: (qmail 91759 invoked by uid 500); 6 Oct 2015 17:29:53 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 91679 invoked by uid 500); 6 Oct 2015 17:29:53 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 91669 invoked by uid 99); 6 Oct 2015 17:29:53 -0000
Received: from Unknown (HELO spamd1-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 06 Oct 2015 17:29:53 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd1-us-west.apache.org (ASF Mail Server at spamd1-us-west.apache.org) with ESMTP id 33C91C39FA
	for <dev@httpd.apache.org>; Tue,  6 Oct 2015 17:29:53 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd1-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.011
X-Spam-Level:
X-Spam-Status: No, score=-0.011 tagged_above=-999 required=6.31
	tests=[SPF_PASS=-0.001, T_RP_MATCHES_RCVD=-0.01] autolearn=disabled
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd1-us-west.apache.org [10.40.0.7]) (amavisd-new, port 10024)
	with ESMTP id qcOlfyedscun for <dev@httpd.apache.org>;
	Tue,  6 Oct 2015 17:29:52 +0000 (UTC)
Received: from monica.sharp.fm (monica.sharp.fm [80.168.143.5])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTP id AD167429AA
	for <dev@httpd.apache.org>; Tue,  6 Oct 2015 17:29:51 +0000 (UTC)
Received: from [10.105.13.221] (unknown [5.56.169.82])
	(using TLSv1 with cipher DHE-RSA-AES256-SHA (256/256 bits))
	(Client did not present a certificate)
	(Authenticated sender: minfrin@sharp.fm)
	by monica.sharp.fm (Postfix) with ESMTPSA id A380983142
	for <dev@httpd.apache.org>; Tue,  6 Oct 2015 18:29:50 +0100 (BST)
Content-Type: text/plain; charset=utf-8
Mime-Version: 1.0 (Mac OS X Mail 8.2 \(2104\))
Subject: Re: svn commit: r1706669 - in /httpd/httpd/trunk: ./ include/ modules/http/ modules/ssl/ server/ server/mpm/event/ server/mpm/motorz/ server/mpm/simple/
From: Graham Leggett <minfrin@sharp.fm>
In-Reply-To: <CAKQ1sVO5J3SBqc8w=m16R=vESgTpKqL5_E7dD9TRXMdd1KbT8A@mail.gmail.com>
Date: Tue, 6 Oct 2015 19:29:49 +0200
Content-Transfer-Encoding: quoted-printable
Message-Id: <07809A63-C0DB-44D2-86AE-1505E5F46B97@sharp.fm>
References: <20151004101052.A6E193A0234@svn01-us-west.apache.org> <CAKQ1sVNRVJqqZSmzVn86K3SbztGSBQ68D2kTJRhWU1qMWDrUYA@mail.gmail.com> <9A9FBD0C-B503-4CDD-A833-74C69FF248EA@sharp.fm> <CAKQ1sVN2WwBhbJ26JOdm7YFnMyXtOfAbCX1eCeUse7Zh1k8O5Q@mail.gmail.com> <CAKQ1sVOA-X7CpjeJruq7wgbFi+WaBsMn-X_0Bpw+CUxmnHtYtg@mail.gmail.com> <660C359D-89D0-4951-ACEA-879BA3F4D726@sharp.fm> <CAKQ1sVNCADr1ojLpZ3R19q2tuyXqMGXO8OP-RWv07uQ+4qZsSQ@mail.gmail.com> <CAKQ1sVPVuYQEynjevqQyP-AFe3GFuT10-dvxY+jvWneouOYC-g@mail.gmail.com> <CAKQ1sVO5J3SBqc8w=m16R=vESgTpKqL5_E7dD9TRXMdd1KbT8A@mail.gmail.com>
To: dev@httpd.apache.org
X-Mailer: Apple Mail (2.2104)

On 06 Oct 2015, at 7:00 PM, Yann Ylavic <ylavic.dev@gmail.com> wrote:

> Yet another filter which does not remove itself after the EOS, and
> destroys the EOR bucket while still using *r after.

I am wondering if the EOR bucket is a suboptimal way to clean up after =
ourselves.

The MPM itself is in a position to know when the filter buffers are all =
empty and it is safe to delete a request pool. I am imagining a =
=E2=80=9Cshutdown set=E2=80=9D, which contains the pools which have been =
marked as ready to shut down. If there is a pool in the shutdown set, =
walk the outstanding filters and look for any filters whose pools are =
descendants of that pool, and check if the filters are empty. If so, =
apr_pool_destroy() and we=E2=80=99re done. If the =E2=80=9Cshutdown =
set=E2=80=9D is empty, do nothing.

Instead of creating an EOR bucket, we call an MPM API that says =E2=80=9Ca=
dd this pool to the shutdown set=E2=80=9D, and then forget about it.

Legacy MPMs fall back to EOR behaviour, but we deprecate it.

I think the above is a far safer approach than assuming filters will =
=E2=80=9Cdo the right thing=E2=80=9D.

Regards,
Graham
=E2=80=94


From dev-return-84111-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Tue Oct  6 17:56:53 2015
Return-Path: <dev-return-84111-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 5ED2218CDD
	for <apmail-httpd-dev-archive@www.apache.org>; Tue,  6 Oct 2015 17:56:53 +0000 (UTC)
Received: (qmail 58517 invoked by uid 500); 6 Oct 2015 17:56:50 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 58431 invoked by uid 500); 6 Oct 2015 17:56:49 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 58421 invoked by uid 99); 6 Oct 2015 17:56:49 -0000
Received: from Unknown (HELO spamd4-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 06 Oct 2015 17:56:49 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd4-us-west.apache.org (ASF Mail Server at spamd4-us-west.apache.org) with ESMTP id 5E3D2C0419
	for <dev@httpd.apache.org>; Tue,  6 Oct 2015 17:56:49 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd4-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 0.653
X-Spam-Level:
X-Spam-Status: No, score=0.653 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, SPF_NEUTRAL=0.652,
	URIBL_BLOCKED=0.001] autolearn=disabled
Authentication-Results: spamd4-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=comcast.net
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd4-us-west.apache.org [10.40.0.11]) (amavisd-new, port 10024)
	with ESMTP id nxg6to4zo_3D for <dev@httpd.apache.org>;
	Tue,  6 Oct 2015 17:56:40 +0000 (UTC)
Received: from resqmta-ch2-12v.sys.comcast.net (resqmta-ch2-12v.sys.comcast.net [69.252.207.44])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id 6C87A20F4F
	for <dev@httpd.apache.org>; Tue,  6 Oct 2015 17:56:39 +0000 (UTC)
Received: from resomta-ch2-19v.sys.comcast.net ([69.252.207.115])
	by resqmta-ch2-12v.sys.comcast.net with comcast
	id Rtw81r00A2VvR6D01twYRT; Tue, 06 Oct 2015 17:56:32 +0000
Received: from [192.168.199.10] ([69.251.84.114])
	by resomta-ch2-19v.sys.comcast.net with comcast
	id RtwX1r00F2U0RYt01twXKr; Tue, 06 Oct 2015 17:56:32 +0000
Content-Type: text/plain; charset=utf-8
Mime-Version: 1.0 (Mac OS X Mail 8.2 \(2104\))
Subject: Re: svn commit: r1706669 - in /httpd/httpd/trunk: ./ include/ modules/http/ modules/ssl/ server/ server/mpm/event/ server/mpm/motorz/ server/mpm/simple/
From: Jim Jagielski <jim@jaguNET.com>
In-Reply-To: <07809A63-C0DB-44D2-86AE-1505E5F46B97@sharp.fm>
Date: Tue, 6 Oct 2015 13:56:31 -0400
Content-Transfer-Encoding: quoted-printable
Message-Id: <1AC4D4CB-D6D5-4517-BED3-E922526CC6E6@jaguNET.com>
References: <20151004101052.A6E193A0234@svn01-us-west.apache.org> <CAKQ1sVNRVJqqZSmzVn86K3SbztGSBQ68D2kTJRhWU1qMWDrUYA@mail.gmail.com> <9A9FBD0C-B503-4CDD-A833-74C69FF248EA@sharp.fm> <CAKQ1sVN2WwBhbJ26JOdm7YFnMyXtOfAbCX1eCeUse7Zh1k8O5Q@mail.gmail.com> <CAKQ1sVOA-X7CpjeJruq7wgbFi+WaBsMn-X_0Bpw+CUxmnHtYtg@mail.gmail.com> <660C359D-89D0-4951-ACEA-879BA3F4D726@sharp.fm> <CAKQ1sVNCADr1ojLpZ3R19q2tuyXqMGXO8OP-RWv07uQ+4qZsSQ@mail.gmail.com> <CAKQ1sVPVuYQEynjevqQyP-AFe3GFuT10-dvxY+jvWneouOYC-g@mail.gmail.com> <CAKQ1sVO5J3SBqc8w=m16R=vESgTpKqL5_E7dD9TRXMdd1KbT8A@mail.gmail.com> <07809A63-C0DB-44D2-86AE-1505E5F46B97@sharp.fm>
To: dev@httpd.apache.org
X-Mailer: Apple Mail (2.2104)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=comcast.net;
	s=q20140121; t=1444154192;
	bh=/6eXGz318CYPd4McpnhdSMD5S5nGqBzcFTdDWbiGJJo=;
	h=Received:Received:Content-Type:Mime-Version:Subject:From:Date:
	 Message-Id:To;
	b=v8K9bY9Ps91y4k8k0aIzLLpZrp05QvGY07V+UACKhahJPdCARkvnHLA3365+o7283
	 5RvaQ+jh+B53RW+zc0c5WK/SDtrty1H1TW1LIaj7PL0PiIHDyKtGD6YBxAD15vTIfP
	 lhUgNHslBo7JYD6xE0kAug/h8B3RwRp/G/hcS2Cs2r7I5OZoZPeju+3MA5OekNdpot
	 Hwy7C+uLXjFFQo5972kwCv/LSXPW26CnPrCjubsUSNuaVZt0zIZ6DzOGVqfn8kq4LY
	 f3ZLeLhtdGDqDt3pEvyaJgICQbtJAofe8y9SQujQZbpwIIIG6xw/Ek+3BZ6RXYPJFJ
	 ih40ot0dNAcfg==


> On Oct 6, 2015, at 1:29 PM, Graham Leggett <minfrin@sharp.fm> wrote:
>=20
> On 06 Oct 2015, at 7:00 PM, Yann Ylavic <ylavic.dev@gmail.com> wrote:
>=20
>> Yet another filter which does not remove itself after the EOS, and
>> destroys the EOR bucket while still using *r after.
>=20
> I am wondering if the EOR bucket is a suboptimal way to clean up after =
ourselves.
>=20
> The MPM itself is in a position to know when the filter buffers are =
all empty and it is safe to delete a request pool. I am imagining a =
=E2=80=9Cshutdown set=E2=80=9D, which contains the pools which have been =
marked as ready to shut down. If there is a pool in the shutdown set, =
walk the outstanding filters and look for any filters whose pools are =
descendants of that pool, and check if the filters are empty. If so, =
apr_pool_destroy() and we=E2=80=99re done. If the =E2=80=9Cshutdown =
set=E2=80=9D is empty, do nothing.
>=20
> Instead of creating an EOR bucket, we call an MPM API that says =E2=80=9C=
add this pool to the shutdown set=E2=80=9D, and then forget about it.
>=20
> Legacy MPMs fall back to EOR behaviour, but we deprecate it.
>=20
> I think the above is a far safer approach than assuming filters will =
=E2=80=9Cdo the right thing=E2=80=9D.
>=20

Basic idea seems sound... +1


From dev-return-84112-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Tue Oct  6 18:41:52 2015
Return-Path: <dev-return-84112-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 108A918F10
	for <apmail-httpd-dev-archive@www.apache.org>; Tue,  6 Oct 2015 18:41:52 +0000 (UTC)
Received: (qmail 87121 invoked by uid 500); 6 Oct 2015 18:41:39 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 87063 invoked by uid 500); 6 Oct 2015 18:41:39 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 87053 invoked by uid 99); 6 Oct 2015 18:41:39 -0000
Received: from Unknown (HELO spamd4-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 06 Oct 2015 18:41:39 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd4-us-west.apache.org (ASF Mail Server at spamd4-us-west.apache.org) with ESMTP id 8B9F5C0419
	for <dev@httpd.apache.org>; Tue,  6 Oct 2015 18:41:38 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd4-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 1.998
X-Spam-Level: *
X-Spam-Status: No, score=1.998 tagged_above=-999 required=6.31
	tests=[FREEMAIL_REPLY=1, KAM_LAZY_DOMAIN_SECURITY=1,
	RCVD_IN_MSPIKE_H2=-0.001, SPF_HELO_PASS=-0.001] autolearn=disabled
Received: from mx1-us-west.apache.org ([10.40.0.8])
	by localhost (spamd4-us-west.apache.org [10.40.0.11]) (amavisd-new, port 10024)
	with ESMTP id 8RcnBDdR6fcK for <dev@httpd.apache.org>;
	Tue,  6 Oct 2015 18:41:27 +0000 (UTC)
Received: from mail1.bemta14.messagelabs.com (mail1.bemta14.messagelabs.com [193.109.254.120])
	by mx1-us-west.apache.org (ASF Mail Server at mx1-us-west.apache.org) with ESMTPS id C7E0223057
	for <dev@httpd.apache.org>; Tue,  6 Oct 2015 18:41:26 +0000 (UTC)
Received: from [193.109.254.3] by server-16.bemta-14.messagelabs.com id 3F/74-05427-EC514165; Tue, 06 Oct 2015 18:41:18 +0000
X-Env-Sender: ruediger.pluem@vodafone.com
X-Msg-Ref: server-11.tower-184.messagelabs.com!1444156877!34890932!1
X-Originating-IP: [195.232.244.134]
X-StarScan-Received:
X-StarScan-Version: 6.13.16; banners=-,-,-
X-VirusChecked: Checked
Received: (qmail 19871 invoked from network); 6 Oct 2015 18:41:17 -0000
Received: from mailout02.vodafone.com (HELO mailout02.vodafone.com) (195.232.244.134)
  by server-11.tower-184.messagelabs.com with DHE-RSA-AES256-SHA encrypted SMTP; 6 Oct 2015 18:41:17 -0000
Received: from mailint04.vodafone.com (mailint04.vodafone.com [195.232.244.201])
	by mailout02.vodafone.com (Postfix) with ESMTP id 3nVngd357szbdMS
	for <dev@httpd.apache.org>; Tue,  6 Oct 2015 20:41:17 +0200 (CEST)
Received: from mailint04.vodafone.com (localhost [127.0.0.1])
	by mailint04.vodafone.com (Postfix) with ESMTP id 3nVngd25WCzfZ4c
	for <dev@httpd.apache.org>; Tue,  6 Oct 2015 20:41:17 +0200 (CEST)
Received: from VOEXC05W.internal.vodafone.com (voexc05w.dc-ratingen.de [145.230.101.25])
	(using TLSv1 with cipher AES128-SHA (128/128 bits))
	(No client certificate requested)
	by mailint04.vodafone.com (Postfix) with ESMTPS id 3nVngd1ltwzfZ8R
	for <dev@httpd.apache.org>; Tue,  6 Oct 2015 20:41:17 +0200 (CEST)
Received: from VOEXC12W.internal.vodafone.com (145.230.101.14) by
 VOEXC05W.internal.vodafone.com (145.230.101.25) with Microsoft SMTP Server
 (TLS) id 14.3.224.2; Tue, 6 Oct 2015 20:41:16 +0200
Received: from VOEXM10W.internal.vodafone.com ([169.254.2.88]) by
 voexc12w.internal.vodafone.com ([145.230.101.14]) with mapi id
 14.03.0224.002; Tue, 6 Oct 2015 20:41:16 +0200
From: =?utf-8?B?UGzDvG0sIFLDvGRpZ2VyLCBWb2RhZm9uZSBHcm91cA==?=
	<ruediger.pluem@vodafone.com>
To: "dev@httpd.apache.org" <dev@httpd.apache.org>
Subject: AW: svn commit: r1706275 -
 /httpd/httpd/trunk/modules/ssl/ssl_engine_io.c
Thread-Topic: svn commit: r1706275 -
 /httpd/httpd/trunk/modules/ssl/ssl_engine_io.c
Thread-Index: AQHQ/GqTCIHksBuD+0iVfT9YFPy+jJ5W0fKAgAeUDoCAAClMcP//8fsAgAAEmQCAAAUFAIAASJwQ
Date: Tue, 6 Oct 2015 18:41:15 +0000
Message-ID: <AB1691BE05AE7F4992697F2A0835627AC633E154@VOEXM10W.internal.vodafone.com>
References: <20151001154324.0CBD73A01DC@svn01-us-west.apache.org>
	<34694C4B-0561-441D-B7DC-6321A1ECE7E5@sharp.fm>	<560D79EF.80201@apache.org>
	<CAKQ1sVPEikOgObBT5uD0VEYUM3a8cOBwEVK690k5JUU2C7UmPA@mail.gmail.com>
	<AB1691BE05AE7F4992697F2A0835627AC633DE2D@VOEXM10W.internal.vodafone.com>
	<20151006154400.GA30252@redhat.com>
	<CAKQ1sVPQYMnmKJCE8FtCetfgzVR5CggULxPM7Mx6iMexYac0RA@mail.gmail.com>
 <CAKQ1sVOw2jTDgvuXyXcUGCjZwYYOTqpiSAA26Q9cF3=2At-63w@mail.gmail.com>
In-Reply-To: <CAKQ1sVOw2jTDgvuXyXcUGCjZwYYOTqpiSAA26Q9cF3=2At-63w@mail.gmail.com>
Accept-Language: en-US
Content-Language: de-DE
X-MS-Has-Attach:
X-MS-TNEF-Correlator:
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
MIME-Version: 1.0

DQoNCj4gLS0tLS1VcnNwcsO8bmdsaWNoZSBOYWNocmljaHQtLS0tLQ0KPiBWb246IFlhbm4gWWxh
dmljIFttYWlsdG86eWxhdmljLmRldkBnbWFpbC5jb21dDQo+IEdlc2VuZGV0OiBEaWVuc3RhZywg
Ni4gT2t0b2JlciAyMDE1IDE4OjE4DQo+IEFuOiBkZXZAaHR0cGQuYXBhY2hlLm9yZw0KPiBCZXRy
ZWZmOiBSZTogc3ZuIGNvbW1pdDogcjE3MDYyNzUgLQ0KPiAvaHR0cGQvaHR0cGQvdHJ1bmsvbW9k
dWxlcy9zc2wvc3NsX2VuZ2luZV9pby5jDQo+IA0KPiBPbiBUdWUsIE9jdCA2LCAyMDE1IGF0IDY6
MDAgUE0sIFlhbm4gWWxhdmljIDx5bGF2aWMuZGV2QGdtYWlsLmNvbT4NCj4gd3JvdGU6DQo+ID4g
T24gVHVlLCBPY3QgNiwgMjAxNSBhdCA1OjQ0IFBNLCBKb2UgT3J0b24gPGpvcnRvbkByZWRoYXQu
Y29tPiB3cm90ZToNCj4gPj4NCj4gPj4gSGVuY2UgSW4gdGhlIHNlcnZlciBjYXNlLCBpdCBzZWVt
cyByZWFzb25hYmxlIHRvIHJlbHkgb24gQklPX2ZsdXNoKCkNCj4gPj4gYmVpbmcgY2FsbGVkIGF0
IHRoZSAicmlnaHQiIHRpbWVzIGR1cmluZyB0aGUgaGFuZHNoYWtlLiAgTW9kdWxvIHRoZQ0KPiBv
ZGQNCj4gPj4gYnVnIQ0KPiA+Pg0KPiA+PiBCdXQgc3NsL3MzX2NsbnQuYyBpcyBub3QgZm9sbG93
aW5nIHRoYXQgY29kaW5nIHN0eWxlIGF0IGFsbCwgYW5kIGl0DQo+IG9ubHkNCj4gPj4gZG9lcyBh
IGZsdXNoIGFmdGVyIGNvbXBsZXRpbmcgdGhlIGhhbmRzaGFrZS4gIFNvIEknZCBzYXkgdGhlIHJp
Z2h0DQo+IHRoaW5nDQo+ID4+IGhlcmUgaXMgdG8gRkxVU0ggYWZ0ZXIgZXZlcnkgcGFja2V0IHdo
aWNoIGNvbWVzIHRocm91Z2ggdGhlIHdyaXRlIEJJTw0KPiA+PiB3aGVuIHRoZSBTU0wgc3RhdGUg
bWFjaGluZSBpcyBpbiB0aGUgbWlkZGxlIG9mIGEgImNvbm5lY3QiLCBpLmUuDQo+ID4+IGhhbmRz
aGFrZSBhcyBjbGllbnQuDQo+ID4+DQo+ID4+IHRsO2RyOiBJIHRoaW5rIFlhbm4ncyBwYXRjaCBz
aG91bGQgYmUgcmlnaHQgaWYgdGhlIHRlc3QgaXMgc3dpdGNoZWQNCj4gZnJvbQ0KPiA+PiAiYWx3
YXlzIGZsdXNoIGlmICFTU0xfaXNfaW5pdF9maW5pc2hlZChzc2wpIiB0byAiYWx3YXlzIGZsdXNo
IGlmDQo+ID4+IFNTTF9pbl9jb25uZWN0X2luaXQoc3NsKSI/Pz8NCj4gPg0KPiA+IFllcywgSSBj
YW1lIHRvIHRoZSBzYW1lIGNvbmNsdXNpb24sIGJ1dCBkZWNpZGVkIHRvIHVzZQ0KPiA+IFNTTF9p
c19pbml0X2ZpbmlzaGVkKHNzbCkgYW55d2F5IGJlY2F1c2UgZm9yIHRoZSBzZXJ2ZXIgY2FzZSBp
dCBzZWVtcw0KPiA+IHRoYXQgb3BlbnNzbCB1c2VzIGl0IG93biBidWZmZXJpbmcgbWVjaGFuaXNt
IHRvIGF2b2lkIHdyaXRpbmcgc21hbGwNCj4gPiBjaHVua3MgKGFmdGVyIHRoZSBjbGllbnQtaGVs
bG8gaXMgcmVjZWl2ZWQpLCBzbyBwb3NzaWJseSB3ZSBjb3VsZCByZWx5DQo+ID4gb24gaXQgKHRo
aXMgYWxzbyBzaW1wbGlmaWVzIHRoZSBsb2dpYykuDQo+IA0KPiBBbHNvIGl0IHNlZW1zIHRoYXQg
Zm9yIHRoZSBTU0xfU1RfUkVORUdPVElBVEUgc3RhdGUgaW4gc3NsM19hY2NlcHQoKSwNCj4gYnVm
ZmVyaW5nIGlzIGRpc2FibGVkIGJ5IG9wZW5zc2wgKGF0IGxlYXN0IGluIDEuMC4yZCkuDQo+IFNT
TF9pc19pbml0X2ZpbmlzaGVkKHNzbCkgc2hvdWxkIGNhdGNoIHRoaXMgY2FzZSB0b28uLi4NCg0K
SSBhbSBjb25mdXNlZCBub3cuIEkgdW5kZXJzdG9vZCB0aGF0IHRoZSBzdGF0ZSBtYWNoaW5lIGZv
ciB0aGUgc2VydmVyIGNhc2UgaXMgZmluZS4gSGVuY2UgdGhhdCBpdCBmbHVzaGVzIGF1dG9tYXRp
Y2FsbHkgd2hlcmUgbmVlZGVkLiBTbyB3ZSBvbmx5IHNob3VsZCBhbmQgbmVlZCB0byB0YWtlIGNh
cmUgb2YgdGhlIGNsaWVudCBjYXNlLg0KSG93IGRvZXMgdXNpbmcgIVNTTF9pc19pbml0X2Zpbmlz
aGVkKHNzbCkgc2ltcGxpZmllcyB0aGUgbG9naWM/DQoNCg0KUmVnYXJkcw0KDQpSw7xkaWdlcg0K

From dev-return-84113-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Tue Oct  6 18:59:43 2015
Return-Path: <dev-return-84113-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 960C618FE8
	for <apmail-httpd-dev-archive@www.apache.org>; Tue,  6 Oct 2015 18:59:43 +0000 (UTC)
Received: (qmail 47015 invoked by uid 500); 6 Oct 2015 18:59:43 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 46941 invoked by uid 500); 6 Oct 2015 18:59:43 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 46931 invoked by uid 99); 6 Oct 2015 18:59:43 -0000
Received: from Unknown (HELO spamd1-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 06 Oct 2015 18:59:43 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd1-us-west.apache.org (ASF Mail Server at spamd1-us-west.apache.org) with ESMTP id A1F13C3C33
	for <dev@httpd.apache.org>; Tue,  6 Oct 2015 18:59:42 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd1-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 2
X-Spam-Level: **
X-Spam-Status: No, score=2 tagged_above=-999 required=6.31
	tests=[FREEMAIL_REPLY=1, KAM_LAZY_DOMAIN_SECURITY=1,
	SPF_HELO_PASS=-0.001, URIBL_BLOCKED=0.001] autolearn=disabled
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd1-us-west.apache.org [10.40.0.7]) (amavisd-new, port 10024)
	with ESMTP id Agbd0cJr1TAH for <dev@httpd.apache.org>;
	Tue,  6 Oct 2015 18:59:30 +0000 (UTC)
Received: from mail1.bemta5.messagelabs.com (mail1.bemta5.messagelabs.com [195.245.231.137])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id 5A8FB206F0
	for <dev@httpd.apache.org>; Tue,  6 Oct 2015 18:59:30 +0000 (UTC)
Received: from [85.158.139.163] by server-1.bemta-5.messagelabs.com id FF/7D-32615-C0A14165; Tue, 06 Oct 2015 18:59:24 +0000
X-Env-Sender: ruediger.pluem@vodafone.com
X-Msg-Ref: server-6.tower-188.messagelabs.com!1444157963!12212999!1
X-Originating-IP: [195.232.244.133]
X-StarScan-Received:
X-StarScan-Version: 6.13.16; banners=-,-,-
X-VirusChecked: Checked
Received: (qmail 18849 invoked from network); 6 Oct 2015 18:59:23 -0000
Received: from mailout01.vodafone.com (HELO mailout01.vodafone.com) (195.232.244.133)
  by server-6.tower-188.messagelabs.com with DHE-RSA-AES256-SHA encrypted SMTP; 6 Oct 2015 18:59:23 -0000
Received: from mailint03.vodafone.com (mailint03.vodafone.com [195.232.244.200])
	by mailout01.vodafone.com (Postfix) with ESMTP id 3nVp4V2Smkz1yK6
	for <dev@httpd.apache.org>; Tue,  6 Oct 2015 20:59:22 +0200 (CEST)
Received: from mailint03.vodafone.com (localhost [127.0.0.1])
	by mailint03.vodafone.com (Postfix) with ESMTP id 3nVp472Bypz16LZ7
	for <dev@httpd.apache.org>; Tue,  6 Oct 2015 20:59:03 +0200 (CEST)
Received: from VOEXC06W.internal.vodafone.com (voexc06w.dc-ratingen.de [145.230.101.26])
	(using TLSv1 with cipher AES128-SHA (128/128 bits))
	(No client certificate requested)
	by mailint03.vodafone.com (Postfix) with ESMTPS id 3nVp4727Rwz16LFN
	for <dev@httpd.apache.org>; Tue,  6 Oct 2015 20:59:03 +0200 (CEST)
Received: from VOEXC14W.internal.vodafone.com (145.230.101.16) by
 VOEXC06W.internal.vodafone.com (145.230.101.26) with Microsoft SMTP Server
 (TLS) id 14.3.224.2; Tue, 6 Oct 2015 20:59:02 +0200
Received: from VOEXM10W.internal.vodafone.com ([169.254.2.88]) by
 voexc14w.internal.vodafone.com ([145.230.101.16]) with mapi id
 14.03.0224.002; Tue, 6 Oct 2015 20:59:02 +0200
From: =?utf-8?B?UGzDvG0sIFLDvGRpZ2VyLCBWb2RhZm9uZSBHcm91cA==?=
	<ruediger.pluem@vodafone.com>
To: "dev@httpd.apache.org" <dev@httpd.apache.org>
Subject: AW: svn commit: r1706669 - in /httpd/httpd/trunk: ./ include/
 modules/http/ modules/ssl/ server/ server/mpm/event/ server/mpm/motorz/
 server/mpm/simple/
Thread-Topic: svn commit: r1706669 - in /httpd/httpd/trunk: ./ include/
 modules/http/ modules/ssl/ server/ server/mpm/event/ server/mpm/motorz/
 server/mpm/simple/
Thread-Index: AQHRADtm27K9fyvABE+g5rr0X8c32p5eV1eAgAACvACAABmLAIAAA1yAgAAFXYCAAFHwQA==
Date: Tue, 6 Oct 2015 18:59:01 +0000
Message-ID: <AB1691BE05AE7F4992697F2A0835627AC633E171@VOEXM10W.internal.vodafone.com>
References: <20151004101052.A6E193A0234@svn01-us-west.apache.org>
	<CAKQ1sVNRVJqqZSmzVn86K3SbztGSBQ68D2kTJRhWU1qMWDrUYA@mail.gmail.com>
	<9A9FBD0C-B503-4CDD-A833-74C69FF248EA@sharp.fm>
	<CAKQ1sVN2WwBhbJ26JOdm7YFnMyXtOfAbCX1eCeUse7Zh1k8O5Q@mail.gmail.com>
	<CAKQ1sVOA-X7CpjeJruq7wgbFi+WaBsMn-X_0Bpw+CUxmnHtYtg@mail.gmail.com>
	<660C359D-89D0-4951-ACEA-879BA3F4D726@sharp.fm>
 <CAKQ1sVNCADr1ojLpZ3R19q2tuyXqMGXO8OP-RWv07uQ+4qZsSQ@mail.gmail.com>
In-Reply-To: <CAKQ1sVNCADr1ojLpZ3R19q2tuyXqMGXO8OP-RWv07uQ+4qZsSQ@mail.gmail.com>
Accept-Language: en-US
Content-Language: de-DE
X-MS-Has-Attach:
X-MS-TNEF-Correlator:
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
MIME-Version: 1.0

DQoNCj4gLS0tLS1VcnNwcsO8bmdsaWNoZSBOYWNocmljaHQtLS0tLQ0KPiBWb246IFlhbm4gWWxh
dmljIFttYWlsdG86eWxhdmljLmRldkBnbWFpbC5jb21dDQo+IEdlc2VuZGV0OiBEaWVuc3RhZywg
Ni4gT2t0b2JlciAyMDE1IDE3OjU0DQo+IEFuOiBkZXZAaHR0cGQuYXBhY2hlLm9yZw0KPiBCZXRy
ZWZmOiBSZTogc3ZuIGNvbW1pdDogcjE3MDY2NjkgLSBpbiAvaHR0cGQvaHR0cGQvdHJ1bms6IC4v
IGluY2x1ZGUvDQo+IG1vZHVsZXMvaHR0cC8gbW9kdWxlcy9zc2wvIHNlcnZlci8gc2VydmVyL21w
bS9ldmVudC8gc2VydmVyL21wbS9tb3RvcnovDQo+IHNlcnZlci9tcG0vc2ltcGxlLw0KPiANCj4g
T24gVHVlLCBPY3QgNiwgMjAxNSBhdCA1OjM0IFBNLCBHcmFoYW0gTGVnZ2V0dCA8bWluZnJpbkBz
aGFycC5mbT4gd3JvdGU6DQo+ID4NCj4gPiBhcHJfYnVja2V0X3NpbXBsZV9jb3B5KCkgbG9va3Mg
d3JvbmcgLSBpbiB0aGVvcnkgd2Ugc2hvdWxkIGhhdmUgYQ0KPiBwcm9wZXIgY29weSBmdW5jdGlv
biB0aGF0IGRvZXMgdGhlIHJpZ2h0IHRoaW5nIHdpdGggdGhlIHNlY29uZCBjb3B5LCBmb3INCj4g
ZXhhbXBsZSBieSBub3QgY29weWluZyB0aGUgcG9vbC4gSWYgd2UgYmxpbmRseSBjb3B5IHRoZSBw
b29sIChvciB0aGUNCj4gcmVxdWVzdCBjb250YWluaW5nIHRoZSBwb29sKSBJIHNlZSBub3RoaW5n
IHRoYXQgd291bGQgcHJldmVudCBhbiBhdHRlbXB0DQo+IHRvIGZyZWUgdGhlIHBvb2wgdHdpY2Uu
DQo+IA0KPiBBZ3JlZWQsIHdlIHByb2JhYmx5IG5lZWQgc29tZXRoaW5nIGxpa2UgdGhpczoNCj4g
DQo+IEluZGV4OiBzZXJ2ZXIvZW9yX2J1Y2tldC5jDQo+ID09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0NCj4gLS0tIHNlcnZl
ci9lb3JfYnVja2V0LmMgICAgKHJldmlzaW9uIDE3MDcwNjQpDQo+ICsrKyBzZXJ2ZXIvZW9yX2J1
Y2tldC5jICAgICh3b3JraW5nIGNvcHkpDQo+IEBAIC05MSw2ICs5MSwxNyBAQCBzdGF0aWMgdm9p
ZCBlb3JfYnVja2V0X2Rlc3Ryb3kodm9pZCAqZGF0YSkNCj4gICAgICB9DQo+ICB9DQo+IA0KPiAr
c3RhdGljIGFwcl9zdGF0dXNfdCBlb3JfYnVja2V0X2NvcHkoYXByX2J1Y2tldCAqYSwgYXByX2J1
Y2tldCAqKmIpDQo+ICt7DQo+ICsgICAgKmIgPSBhcHJfYnVja2V0X2FsbG9jKHNpemVvZigqKmIp
LCBhLT5saXN0KTsgLyogWFhYOiBjaGVjayBmb3INCj4gZmFpbHVyZT8gKi8NCj4gKyAgICAqKmIg
PSAqYTsNCj4gKw0KDQpXZSBjb3VsZCB1c2UgYXByX2J1Y2tldF9zaW1wbGVfY29weShhLCBiKSBp
bnN0ZWFkIG9mIHRoZSBhYm92ZS4NCg0KPiArICAgIC8qIHdlIGRvbid0IHdhbid0IHJlcXVlc3Qg
dG8gYmUgZGVzdHJveWVkIHR3aWNlICovDQo+ICsgICAgKCpiKS0+ZGF0YSA9IE5VTEw7DQoNCkht
LiBTaG91bGRuJ3QgdGhlIGxhc3QgRU9SIGJ1Y2tldCBvZiBhIHBhcnRpY3VsYXIgcmVxdWVzdCBk
ZXN0cm95ZWQgY2FsbA0KZW9yX2J1Y2tldF9jbGVhbnVwPyBUaGF0IHdvdWxkIHJlcXVpcmUgc29t
ZSBraW5kIG9mIGEgcmVmZXJlbmNlIGxpa2UgcmVmY291bnQgYnVja2V0cyBwcm92aWRlLg0KDQo+
ICsNCj4gKyAgICByZXR1cm4gQVBSX1NVQ0NFU1M7DQo+ICt9DQo+ICsNCj4gIEFQX0RFQ0xBUkVf
REFUQSBjb25zdCBhcHJfYnVja2V0X3R5cGVfdCBhcF9idWNrZXRfdHlwZV9lb3IgPSB7DQo+ICAg
ICAgIkVPUiIsIDUsIEFQUl9CVUNLRVRfTUVUQURBVEEsDQo+ICAgICAgZW9yX2J1Y2tldF9kZXN0
cm95LA0KPiBAQCAtOTcsNiArMTA4LDYgQEAgQVBfREVDTEFSRV9EQVRBIGNvbnN0IGFwcl9idWNr
ZXRfdHlwZV90IGFwX2J1Y2tldF8NCg0KDQpSZWdhcmRzDQoNClLDvGRpZ2VyDQo=

From dev-return-84114-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Tue Oct  6 19:52:31 2015
Return-Path: <dev-return-84114-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id BC31D174C8
	for <apmail-httpd-dev-archive@www.apache.org>; Tue,  6 Oct 2015 19:52:31 +0000 (UTC)
Received: (qmail 17466 invoked by uid 500); 6 Oct 2015 19:52:31 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 17377 invoked by uid 500); 6 Oct 2015 19:52:31 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 17367 invoked by uid 99); 6 Oct 2015 19:52:31 -0000
Received: from Unknown (HELO spamd3-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 06 Oct 2015 19:52:31 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd3-us-west.apache.org (ASF Mail Server at spamd3-us-west.apache.org) with ESMTP id C17E8180DC7
	for <dev@httpd.apache.org>; Tue,  6 Oct 2015 19:52:30 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd3-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.01
X-Spam-Level:
X-Spam-Status: No, score=-0.01 tagged_above=-999 required=6.31
	tests=[SPF_PASS=-0.001, T_RP_MATCHES_RCVD=-0.01, URIBL_BLOCKED=0.001]
	autolearn=disabled
Received: from mx1-us-west.apache.org ([10.40.0.8])
	by localhost (spamd3-us-west.apache.org [10.40.0.10]) (amavisd-new, port 10024)
	with ESMTP id dDEEJHJMdhPv for <dev@httpd.apache.org>;
	Tue,  6 Oct 2015 19:52:25 +0000 (UTC)
Received: from monica.sharp.fm (monica.sharp.fm [80.168.143.5])
	by mx1-us-west.apache.org (ASF Mail Server at mx1-us-west.apache.org) with ESMTP id BE05D21270
	for <dev@httpd.apache.org>; Tue,  6 Oct 2015 19:52:24 +0000 (UTC)
Received: from [192.168.220.248] (unknown [192.168.220.248])
	(using TLSv1 with cipher DHE-RSA-AES256-SHA (256/256 bits))
	(Client did not present a certificate)
	(Authenticated sender: minfrin@sharp.fm)
	by monica.sharp.fm (Postfix) with ESMTPSA id 76F28830F8
	for <dev@httpd.apache.org>; Tue,  6 Oct 2015 20:52:17 +0100 (BST)
Content-Type: text/plain; charset=utf-8
Mime-Version: 1.0 (Mac OS X Mail 8.2 \(2104\))
Subject: Re: svn commit: r1706669 - in /httpd/httpd/trunk: ./ include/ modules/http/ modules/ssl/ server/ server/mpm/event/ server/mpm/motorz/ server/mpm/simple/
From: Graham Leggett <minfrin@sharp.fm>
In-Reply-To: <07809A63-C0DB-44D2-86AE-1505E5F46B97@sharp.fm>
Date: Tue, 6 Oct 2015 21:52:16 +0200
Content-Transfer-Encoding: quoted-printable
Message-Id: <9B7F2741-A018-421C-BF98-FD5FEF2C049A@sharp.fm>
References: <20151004101052.A6E193A0234@svn01-us-west.apache.org> <CAKQ1sVNRVJqqZSmzVn86K3SbztGSBQ68D2kTJRhWU1qMWDrUYA@mail.gmail.com> <9A9FBD0C-B503-4CDD-A833-74C69FF248EA@sharp.fm> <CAKQ1sVN2WwBhbJ26JOdm7YFnMyXtOfAbCX1eCeUse7Zh1k8O5Q@mail.gmail.com> <CAKQ1sVOA-X7CpjeJruq7wgbFi+WaBsMn-X_0Bpw+CUxmnHtYtg@mail.gmail.com> <660C359D-89D0-4951-ACEA-879BA3F4D726@sharp.fm> <CAKQ1sVNCADr1ojLpZ3R19q2tuyXqMGXO8OP-RWv07uQ+4qZsSQ@mail.gmail.com> <CAKQ1sVPVuYQEynjevqQyP-AFe3GFuT10-dvxY+jvWneouOYC-g@mail.gmail.com> <CAKQ1sVO5J3SBqc8w=m16R=vESgTpKqL5_E7dD9TRXMdd1KbT8A@mail.gmail.com> <07809A63-C0DB-44D2-86AE-1505E5F46B97@sharp.fm>
To: dev@httpd.apache.org
X-Mailer: Apple Mail (2.2104)

On 06 Oct 2015, at 7:29 PM, Graham Leggett <minfrin@sharp.fm> wrote:

> I am wondering if the EOR bucket is a suboptimal way to clean up after =
ourselves.
>=20
> The MPM itself is in a position to know when the filter buffers are =
all empty and it is safe to delete a request pool. I am imagining a =
=E2=80=9Cshutdown set=E2=80=9D, which contains the pools which have been =
marked as ready to shut down. If there is a pool in the shutdown set, =
walk the outstanding filters and look for any filters whose pools are =
descendants of that pool, and check if the filters are empty. If so, =
apr_pool_destroy() and we=E2=80=99re done. If the =E2=80=9Cshutdown =
set=E2=80=9D is empty, do nothing.
>=20
> Instead of creating an EOR bucket, we call an MPM API that says =E2=80=9C=
add this pool to the shutdown set=E2=80=9D, and then forget about it.
>=20
> Legacy MPMs fall back to EOR behaviour, but we deprecate it.
>=20
> I think the above is a far safer approach than assuming filters will =
=E2=80=9Cdo the right thing=E2=80=9D.

Having done some further digging that isn=E2=80=99t that workable. While =
the presence of a filter with setaside data in it tells us definitely =
that we shouldn=E2=80=99t destroy the brigade yet, it is very difficult =
to determine when we should.

I think we=E2=80=99ll need to compromise and provide an async switch =
that in v2.4 defaults to =E2=80=9Cconnection=E2=80=9D (restrict async =
behaviour to connection filters only), and can be optionally set to =
=E2=80=9Crequest=E2=80=9D (async behaviour for connection and request =
filters) if the filters in use allow it.

Regards,
Graham
=E2=80=94


From dev-return-84115-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Tue Oct  6 23:35:53 2015
Return-Path: <dev-return-84115-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 8FC1E1806E
	for <apmail-httpd-dev-archive@www.apache.org>; Tue,  6 Oct 2015 23:35:53 +0000 (UTC)
Received: (qmail 27262 invoked by uid 500); 6 Oct 2015 23:35:53 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 27191 invoked by uid 500); 6 Oct 2015 23:35:52 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 27181 invoked by uid 99); 6 Oct 2015 23:35:52 -0000
Received: from Unknown (HELO spamd4-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 06 Oct 2015 23:35:52 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd4-us-west.apache.org (ASF Mail Server at spamd4-us-west.apache.org) with ESMTP id 57E96C0419
	for <dev@httpd.apache.org>; Tue,  6 Oct 2015 23:35:52 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd4-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.099
X-Spam-Level:
X-Spam-Status: No, score=-0.099 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	URIBL_BLOCKED=0.001] autolearn=disabled
Authentication-Results: spamd4-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-us-west.apache.org ([10.40.0.8])
	by localhost (spamd4-us-west.apache.org [10.40.0.11]) (amavisd-new, port 10024)
	with ESMTP id 7hEwx7pk0u-y for <dev@httpd.apache.org>;
	Tue,  6 Oct 2015 23:35:39 +0000 (UTC)
Received: from mail-qg0-f42.google.com (mail-qg0-f42.google.com [209.85.192.42])
	by mx1-us-west.apache.org (ASF Mail Server at mx1-us-west.apache.org) with ESMTPS id 3C14E20F20
	for <dev@httpd.apache.org>; Tue,  6 Oct 2015 23:35:39 +0000 (UTC)
Received: by qgt47 with SMTP id 47so865371qgt.2
        for <dev@httpd.apache.org>; Tue, 06 Oct 2015 16:35:38 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type:content-transfer-encoding;
        bh=204WDoRdUThLa5LFE5hNOWHRdbm4rUSQX2cC73cyiVw=;
        b=rmcSnkuJ6XfV4vrozTU5QJfxuofdnbEcpW1Rf0Q3+P37FfFfRZmcp1AqRzHS8dxdqU
         KVx6flTluSzYtCfhEhs3Jk5/gC87kpwWf3sq7XdNK7r6vsO/FeYFYDftytse2fEPXbeC
         kuhaiVEz+fbhTp1VEClCiB6u7sAb7/5RCjw4b+4xNmSIfR/7GlyL3zW3eRS3+X6EIkFH
         AZQmznzkLLm7gA5omRD6bKanazaibus7sMm5TaBup1zKtEk6KFvG1CiA6T292fYAmHK/
         ene6zFmiE3/iYZ5eJnsye4XiAczBmUi+qrV0i561ERUPXTl1EiMkr2bfjOIz474jDOpW
         AXVw==
MIME-Version: 1.0
X-Received: by 10.140.95.73 with SMTP id h67mr51157920qge.14.1444174538396;
 Tue, 06 Oct 2015 16:35:38 -0700 (PDT)
Received: by 10.55.72.20 with HTTP; Tue, 6 Oct 2015 16:35:38 -0700 (PDT)
In-Reply-To: <AB1691BE05AE7F4992697F2A0835627AC633E154@VOEXM10W.internal.vodafone.com>
References: <20151001154324.0CBD73A01DC@svn01-us-west.apache.org>
	<34694C4B-0561-441D-B7DC-6321A1ECE7E5@sharp.fm>
	<560D79EF.80201@apache.org>
	<CAKQ1sVPEikOgObBT5uD0VEYUM3a8cOBwEVK690k5JUU2C7UmPA@mail.gmail.com>
	<AB1691BE05AE7F4992697F2A0835627AC633DE2D@VOEXM10W.internal.vodafone.com>
	<20151006154400.GA30252@redhat.com>
	<CAKQ1sVPQYMnmKJCE8FtCetfgzVR5CggULxPM7Mx6iMexYac0RA@mail.gmail.com>
	<CAKQ1sVOw2jTDgvuXyXcUGCjZwYYOTqpiSAA26Q9cF3=2At-63w@mail.gmail.com>
	<AB1691BE05AE7F4992697F2A0835627AC633E154@VOEXM10W.internal.vodafone.com>
Date: Wed, 7 Oct 2015 01:35:38 +0200
Message-ID: <CAKQ1sVO+v5bz6Z+uv5h3fgYat_1ZztnJuQRmwJzGBxUcRfH+-w@mail.gmail.com>
Subject: Re: svn commit: r1706275 - /httpd/httpd/trunk/modules/ssl/ssl_engine_io.c
From: Yann Ylavic <ylavic.dev@gmail.com>
To: dev@httpd.apache.org
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: quoted-printable

On Tue, Oct 6, 2015 at 8:41 PM, Pl=C3=BCm, R=C3=BCdiger, Vodafone Group
<ruediger.pluem@vodafone.com> wrote:
>
>
> I am confused now. I understood that the state machine for the server cas=
e is fine. Hence that it flushes automatically where needed. So we only sho=
uld and need to take care of the client case.
> How does using !SSL_is_init_finished(ssl) simplifies the logic?

Sorry for the confusion.
What I meant is that it simplifies the logic in mod_ssl to use
SSL_is_init_finished() unconditionally, since it (obviously) addresses
all the cases: buggy openssl versions, client and server.
It is required for the former case anyway, and is identical to
SSL_in_connect_init() for the client case.
For the server case, openssl will use its own buffering mechanism
during the handshake "so that the output is sent in a way that TCP
likes", according to the comment in the code, so we shouldn't be
flushing small chunks.
Yet for the server case still, openssl will issue its own flush
appropriately, so we may introduce a spurious flush by doing this
(something I didn't think about).

Thus I agree that Joe's proposal is better: SSL_in_connect_init() but
for the buggy case (openssl < 0.9.8m) where we need the generic
SSL_is_init_finished().
Will commit this, thanks for the feedbacks.

Regards,
Yann.

From dev-return-84116-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Tue Oct  6 23:54:23 2015
Return-Path: <dev-return-84116-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id C31E218109
	for <apmail-httpd-dev-archive@www.apache.org>; Tue,  6 Oct 2015 23:54:23 +0000 (UTC)
Received: (qmail 81230 invoked by uid 500); 6 Oct 2015 23:54:23 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 81153 invoked by uid 500); 6 Oct 2015 23:54:23 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 81142 invoked by uid 99); 6 Oct 2015 23:54:23 -0000
Received: from Unknown (HELO spamd1-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 06 Oct 2015 23:54:23 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd1-us-west.apache.org (ASF Mail Server at spamd1-us-west.apache.org) with ESMTP id C1416C3D43
	for <dev@httpd.apache.org>; Tue,  6 Oct 2015 23:54:22 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd1-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.102
X-Spam-Level:
X-Spam-Status: No, score=-0.102 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RCVD_IN_MSPIKE_H2=-0.001, SPF_PASS=-0.001] autolearn=disabled
Authentication-Results: spamd1-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd1-us-west.apache.org [10.40.0.7]) (amavisd-new, port 10024)
	with ESMTP id KMypTjdPVWMW for <dev@httpd.apache.org>;
	Tue,  6 Oct 2015 23:54:22 +0000 (UTC)
Received: from mail-qg0-f47.google.com (mail-qg0-f47.google.com [209.85.192.47])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id 0EE8C439E8
	for <dev@httpd.apache.org>; Tue,  6 Oct 2015 23:54:22 +0000 (UTC)
Received: by qgx61 with SMTP id 61so1116394qgx.3
        for <dev@httpd.apache.org>; Tue, 06 Oct 2015 16:54:21 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        bh=4rDjwvRyh7eXONbkeagzipqTUrSpK2He5vUbqYe/kRU=;
        b=FULCH/P6mcQOOzxyjHkDFImjYt8SA8YoZcOCdvt/lMVC8Zo5hTlaT9TDEHQpHTaElF
         wMS6FNp5HbNSKwrwWQrkcR3FbKRKCgPD3X5Lzpw9Jv9gLIjoHeh64sHM6mYrk2YKw1Mf
         tT1XnEPtVjda5uBmLh/2lxuvR1HwGVxJ0ZC/FHRji+k+iGtfveACt5IminZIIphhFvYB
         LMnDYXA+OrrZcmGhQbTYuplKFW0IW4vYRhiHzzvCpHxk3P13xlpOQ8gcR4EH1WJ28Trz
         wKOnkHqgbPivTzxMaknAuKqNO8utSt0sgfb6bBD08fFy7yo5RafLHk0Fm0N04RguXmI+
         bVEg==
MIME-Version: 1.0
X-Received: by 10.140.96.99 with SMTP id j90mr50082568qge.92.1444175661798;
 Tue, 06 Oct 2015 16:54:21 -0700 (PDT)
Received: by 10.55.72.20 with HTTP; Tue, 6 Oct 2015 16:54:21 -0700 (PDT)
In-Reply-To: <20151006223828.AE1463A0141@svn01-us-west.apache.org>
References: <20151006223828.AE1463A0141@svn01-us-west.apache.org>
Date: Wed, 7 Oct 2015 01:54:21 +0200
Message-ID: <CAKQ1sVNqWwDyXnu=4nWw0wLqfLvt+Y0J9qKQmYek592_2TY9Jg@mail.gmail.com>
Subject: Re: svn commit: r1707163 - /httpd/httpd/trunk/server/util_filter.c
From: Yann Ylavic <ylavic.dev@gmail.com>
To: dev@httpd.apache.org
Content-Type: text/plain; charset=UTF-8

On Wed, Oct 7, 2015 at 12:38 AM,  <minfrin@apache.org> wrote:
> Author: minfrin
> Date: Tue Oct  6 22:38:28 2015
> New Revision: 1707163
>
> URL: http://svn.apache.org/viewvc?rev=1707163&view=rev
> Log:
> Make sure that transient buckets are morphed into real buckets before
> the filter returns.
>
> Modified:
>     httpd/httpd/trunk/server/util_filter.c
>
> Modified: httpd/httpd/trunk/server/util_filter.c
> URL: http://svn.apache.org/viewvc/httpd/httpd/trunk/server/util_filter.c?rev=1707163&r1=1707162&r2=1707163&view=diff
> ==============================================================================
> --- httpd/httpd/trunk/server/util_filter.c (original)
> +++ httpd/httpd/trunk/server/util_filter.c Tue Oct  6 22:38:28 2015
> @@ -736,6 +736,16 @@ AP_DECLARE(apr_status_t) ap_filter_setas
>
>          /* decide what pool we setaside to, request pool or deferred pool? */
>          if (f->r) {
> +            apr_bucket *e;
> +            for (e = APR_BRIGADE_FIRST(bb); e != APR_BRIGADE_SENTINEL(bb); e =
> +                    APR_BUCKET_NEXT(e)) {
> +                if (APR_BUCKET_IS_TRANSIENT(e)) {
> +                    int rv = apr_bucket_setaside(e, f->r->pool);
> +                    if (rv != APR_SUCCESS) {
> +                        return rv;
> +                    }
> +                }
> +            }
>              pool = f->r->pool;
>              APR_BRIGADE_CONCAT(f->bb, bb);
>          }

I don't understand this, why using ap_save_brigade() for both cases
(i.e. setting aside or reading the other types of buckets) would lead
to synchronous behaviour?
It is when r->pool gets destroyed?
If so, how is it different from the buckets currently set aside on r->pool?

We could also possibly always use the deferred_pool (moving it to
conn_rec if we don't want one per reinstate-able filter).

Regards,
Yann.

From dev-return-84117-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Wed Oct  7 07:44:54 2015
Return-Path: <dev-return-84117-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 9510518DD5
	for <apmail-httpd-dev-archive@www.apache.org>; Wed,  7 Oct 2015 07:44:54 +0000 (UTC)
Received: (qmail 60276 invoked by uid 500); 7 Oct 2015 07:44:51 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 60207 invoked by uid 500); 7 Oct 2015 07:44:50 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 60197 invoked by uid 99); 7 Oct 2015 07:44:50 -0000
Received: from Unknown (HELO spamd2-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 07 Oct 2015 07:44:50 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd2-us-west.apache.org (ASF Mail Server at spamd2-us-west.apache.org) with ESMTP id 86E711A224E
	for <dev@httpd.apache.org>; Wed,  7 Oct 2015 07:44:50 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd2-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.01
X-Spam-Level:
X-Spam-Status: No, score=-0.01 tagged_above=-999 required=6.31
	tests=[SPF_PASS=-0.001, T_RP_MATCHES_RCVD=-0.01, URIBL_BLOCKED=0.001]
	autolearn=disabled
Received: from mx1-us-west.apache.org ([10.40.0.8])
	by localhost (spamd2-us-west.apache.org [10.40.0.9]) (amavisd-new, port 10024)
	with ESMTP id gILYbo1wDLsV for <dev@httpd.apache.org>;
	Wed,  7 Oct 2015 07:44:45 +0000 (UTC)
Received: from mailserver.kippdata.de (capsella.kippdata.de [195.227.30.149])
	by mx1-us-west.apache.org (ASF Mail Server at mx1-us-west.apache.org) with ESMTP id 7F6042074F
	for <dev@httpd.apache.org>; Wed,  7 Oct 2015 07:44:43 +0000 (UTC)
Received: from [10.0.110.6] ([192.168.2.104])
	by mailserver.kippdata.de (8.13.5/8.13.5) with ESMTP id t977igVH003659
	for <dev@httpd.apache.org>; Wed, 7 Oct 2015 09:44:42 +0200 (CEST)
Subject: Re: Supporting "SSL:" in the expression parser via mod_ssl
To: dev@httpd.apache.org
References: <560C5386.1030700@kippdata.de> <3128045.1Bge59dzo2@k>
 <56139AAF.3040706@kippdata.de>
 <CAKQ1sVMQvF=hTAUzBYx_9BKpihBu+4obMiigkoPtHxAiz_8WiA@mail.gmail.com>
 <AB1691BE05AE7F4992697F2A0835627AC633D865@VOEXM10W.internal.vodafone.com>
From: Rainer Jung <rainer.jung@kippdata.de>
Message-ID: <5614CD68.2040906@kippdata.de>
Date: Wed, 7 Oct 2015 09:44:40 +0200
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:38.0) Gecko/20100101
 Thunderbird/38.3.0
MIME-Version: 1.0
In-Reply-To: <AB1691BE05AE7F4992697F2A0835627AC633D865@VOEXM10W.internal.vodafone.com>
Content-Type: text/plain; charset=utf-8; format=flowed
Content-Transfer-Encoding: 8bit

Option 3) tested and committed to trunk in r1707152, tested and proposed 
to backport for 2.4 now. Thanks for the feedback!

Regards,

Rainer

Am 06.10.2015 um 12:12 schrieb Plüm, Rüdiger, Vodafone Group:
> +1
>
> Regards
>
> Rüdiger
>
>> -----Original Message-----
>> From: Yann Ylavic [mailto:ylavic.dev@gmail.com]
>> Sent: Dienstag, 6. Oktober 2015 12:07
>> To: dev@httpd.apache.org
>> Subject: Re: Supporting "SSL:" in the expression parser via mod_ssl
>>
>> On Tue, Oct 6, 2015 at 11:55 AM, Rainer Jung <rainer.jung@kippdata.de>
>> wrote:
>>>
>>> I will commit 3) but are very open to other opinions before suggesting a
>>> backport.
>>
>> +1
>>
>> Regards,
>> Yann.

From dev-return-84118-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Wed Oct  7 08:04:43 2015
Return-Path: <dev-return-84118-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 1D8E518E67
	for <apmail-httpd-dev-archive@www.apache.org>; Wed,  7 Oct 2015 08:04:43 +0000 (UTC)
Received: (qmail 942 invoked by uid 500); 7 Oct 2015 08:04:42 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 863 invoked by uid 500); 7 Oct 2015 08:04:42 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 853 invoked by uid 99); 7 Oct 2015 08:04:42 -0000
Received: from Unknown (HELO spamd2-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 07 Oct 2015 08:04:42 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd2-us-west.apache.org (ASF Mail Server at spamd2-us-west.apache.org) with ESMTP id 12FDC1A2258
	for <dev@httpd.apache.org>; Wed,  7 Oct 2015 08:04:42 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd2-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.032
X-Spam-Level:
X-Spam-Status: No, score=-0.032 tagged_above=-999 required=6.31
	tests=[RCVD_IN_MSPIKE_H3=-0.01, RCVD_IN_MSPIKE_WL=-0.01,
	SPF_HELO_PASS=-0.001, SPF_PASS=-0.001, T_RP_MATCHES_RCVD=-0.01]
	autolearn=disabled
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd2-us-west.apache.org [10.40.0.9]) (amavisd-new, port 10024)
	with ESMTP id i1hxZ384WcPC for <dev@httpd.apache.org>;
	Wed,  7 Oct 2015 08:04:41 +0000 (UTC)
Received: from mx1.redhat.com (mx1.redhat.com [209.132.183.28])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id C72BF439B6
	for <dev@httpd.apache.org>; Wed,  7 Oct 2015 08:04:40 +0000 (UTC)
Received: from int-mx09.intmail.prod.int.phx2.redhat.com (int-mx09.intmail.prod.int.phx2.redhat.com [10.5.11.22])
	by mx1.redhat.com (Postfix) with ESMTPS id 1F7398F2E4
	for <dev@httpd.apache.org>; Wed,  7 Oct 2015 08:04:40 +0000 (UTC)
Received: from iberis (unused [10.10.50.115] (may be forged))
	by int-mx09.intmail.prod.int.phx2.redhat.com (8.14.4/8.14.4) with ESMTP id t9784cg4031912
	(version=TLSv1/SSLv3 cipher=DHE-RSA-AES256-GCM-SHA384 bits=256 verify=NO)
	for <dev@httpd.apache.org>; Wed, 7 Oct 2015 04:04:39 -0400
Received: from jorton by iberis with local (Exim 4.85)
	(envelope-from <jorton@redhat.com>)
	id 1ZjjiI-0001o9-GK
	for dev@httpd.apache.org; Wed, 07 Oct 2015 09:04:38 +0100
Date: Wed, 7 Oct 2015 09:04:38 +0100
From: Joe Orton <jorton@redhat.com>
To: dev@httpd.apache.org
Subject: Re: svn commit: r1706275 -
 /httpd/httpd/trunk/modules/ssl/ssl_engine_io.c
Message-ID: <20151007080438.GA3573@redhat.com>
Mail-Followup-To: dev@httpd.apache.org
References: <20151001154324.0CBD73A01DC@svn01-us-west.apache.org>
 <34694C4B-0561-441D-B7DC-6321A1ECE7E5@sharp.fm>
 <560D79EF.80201@apache.org>
 <CAKQ1sVPEikOgObBT5uD0VEYUM3a8cOBwEVK690k5JUU2C7UmPA@mail.gmail.com>
 <AB1691BE05AE7F4992697F2A0835627AC633DE2D@VOEXM10W.internal.vodafone.com>
 <20151006154400.GA30252@redhat.com>
 <CAKQ1sVPQYMnmKJCE8FtCetfgzVR5CggULxPM7Mx6iMexYac0RA@mail.gmail.com>
 <CAKQ1sVOw2jTDgvuXyXcUGCjZwYYOTqpiSAA26Q9cF3=2At-63w@mail.gmail.com>
 <AB1691BE05AE7F4992697F2A0835627AC633E154@VOEXM10W.internal.vodafone.com>
 <CAKQ1sVO+v5bz6Z+uv5h3fgYat_1ZztnJuQRmwJzGBxUcRfH+-w@mail.gmail.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Disposition: inline
In-Reply-To: <CAKQ1sVO+v5bz6Z+uv5h3fgYat_1ZztnJuQRmwJzGBxUcRfH+-w@mail.gmail.com>
User-Agent: Mutt/1.5.24 (2015-08-30)
Organization: Registered in England and Wales under Company Registration No. 03798903
Directors: Michael Cunningham (US), Michael O'Neill (Ireland), Matt Parson (US), Charles Peters (US)
X-Scanned-By: MIMEDefang 2.68 on 10.5.11.22

On Wed, Oct 07, 2015 at 01:35:38AM +0200, Yann Ylavic wrote:
> For the server case, openssl will use its own buffering mechanism
> during the handshake "so that the output is sent in a way that TCP
> likes", according to the comment in the code, so we shouldn't be
> flushing small chunks.
> Yet for the server case still, openssl will issue its own flush
> appropriately, so we may introduce a spurious flush by doing this
> (something I didn't think about).

That's really interesting.  That extra buffering BIO makes sense if 
OpenSSL is writing to the socket descriptor directly, as with pre-2.x 
mod_ssl, but doesn't really make sense with 2.x mod_ssl, since the core 
output filter is doing that work in the "right" place.

I guess it doesn't impact performance much because it's handshake-time 
only as you say, but still, it would be interesting to try ripping that 
out.

> Thus I agree that Joe's proposal is better: SSL_in_connect_init() but
> for the buggy case (openssl < 0.9.8m) where we need the generic
> SSL_is_init_finished().
> Will commit this, thanks for the feedbacks.

As ever, looks great Yann, thanks a lot.

Regards, Joe

From dev-return-84119-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Wed Oct  7 09:17:30 2015
Return-Path: <dev-return-84119-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id C3D4C17256
	for <apmail-httpd-dev-archive@www.apache.org>; Wed,  7 Oct 2015 09:17:30 +0000 (UTC)
Received: (qmail 52838 invoked by uid 500); 7 Oct 2015 09:17:29 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 52765 invoked by uid 500); 7 Oct 2015 09:17:29 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 52754 invoked by uid 99); 7 Oct 2015 09:17:29 -0000
Received: from Unknown (HELO spamd4-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 07 Oct 2015 09:17:29 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd4-us-west.apache.org (ASF Mail Server at spamd4-us-west.apache.org) with ESMTP id 53008C03EF
	for <dev@httpd.apache.org>; Wed,  7 Oct 2015 09:17:29 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd4-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.011
X-Spam-Level:
X-Spam-Status: No, score=-0.011 tagged_above=-999 required=6.31
	tests=[SPF_PASS=-0.001, T_RP_MATCHES_RCVD=-0.01] autolearn=disabled
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd4-us-west.apache.org [10.40.0.11]) (amavisd-new, port 10024)
	with ESMTP id CncC0qazklR5 for <dev@httpd.apache.org>;
	Wed,  7 Oct 2015 09:17:28 +0000 (UTC)
Received: from monica.sharp.fm (monica.sharp.fm [80.168.143.5])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTP id EB26642F38
	for <dev@httpd.apache.org>; Wed,  7 Oct 2015 09:17:27 +0000 (UTC)
Received: from [10.105.13.216] (unknown [5.56.169.82])
	(using TLSv1 with cipher DHE-RSA-AES256-SHA (256/256 bits))
	(Client did not present a certificate)
	(Authenticated sender: minfrin@sharp.fm)
	by monica.sharp.fm (Postfix) with ESMTPSA id 671A983142
	for <dev@httpd.apache.org>; Wed,  7 Oct 2015 10:17:27 +0100 (BST)
Content-Type: text/plain; charset=utf-8
Mime-Version: 1.0 (Mac OS X Mail 8.2 \(2104\))
Subject: Re: svn commit: r1706275 - /httpd/httpd/trunk/modules/ssl/ssl_engine_io.c
From: Graham Leggett <minfrin@sharp.fm>
In-Reply-To: <20151007080438.GA3573@redhat.com>
Date: Wed, 7 Oct 2015 11:17:26 +0200
Content-Transfer-Encoding: quoted-printable
Message-Id: <A3EC7AE8-B433-4342-8834-C71AE548AD42@sharp.fm>
References: <20151001154324.0CBD73A01DC@svn01-us-west.apache.org> <34694C4B-0561-441D-B7DC-6321A1ECE7E5@sharp.fm> <560D79EF.80201@apache.org> <CAKQ1sVPEikOgObBT5uD0VEYUM3a8cOBwEVK690k5JUU2C7UmPA@mail.gmail.com> <AB1691BE05AE7F4992697F2A0835627AC633DE2D@VOEXM10W.internal.vodafone.com> <20151006154400.GA30252@redhat.com> <CAKQ1sVPQYMnmKJCE8FtCetfgzVR5CggULxPM7Mx6iMexYac0RA@mail.gmail.com> <CAKQ1sVOw2jTDgvuXyXcUGCjZwYYOTqpiSAA26Q9cF3=2At-63w@mail.gmail.com> <AB1691BE05AE7F4992697F2A0835627AC633E154@VOEXM10W.internal.vodafone.com> <CAKQ1sVO+v5bz6Z+uv5h3fgYat_1ZztnJuQRmwJzGBxUcRfH+-w@mail.gmail.com> <20151007080438.GA3573@redhat.com>
To: dev@httpd.apache.org
X-Mailer: Apple Mail (2.2104)

On 07 Oct 2015, at 10:04 AM, Joe Orton <jorton@redhat.com> wrote:

> That's really interesting.  That extra buffering BIO makes sense if=20
> OpenSSL is writing to the socket descriptor directly, as with pre-2.x=20=

> mod_ssl, but doesn't really make sense with 2.x mod_ssl, since the =
core=20
> output filter is doing that work in the "right" place.
>=20
> I guess it doesn't impact performance much because it's handshake-time=20=

> only as you say, but still, it would be interesting to try ripping =
that=20
> out.

As I understand we=E2=80=99re using openssl in non blocking mode, which =
means that openssl will ask us permission before attempting any read or =
write.

The core will then in turn either read or write as requested by openssl =
based on the =E2=80=9Csense=E2=80=9D flags CONN_SENSE_WANT_READ or =
CONN_SENSE_WANT_WRITE.

If openssl has a bug and reads/writes without first asking permission =
we=E2=80=99ll block, but by the same token if openssl as asking us =
permission using SSL_ERROR_WANT_READ or SSL_ERROR_WANT_WRITE and we=E2=80=99=
re ignoring openssl, we=E2=80=99ll block for the same reason.

If there is some kind of buffer in between openssl and httpd, that will =
probably cause strange behaviour too, agreed that we should take that =
out.

Regards,
Graham
=E2=80=94


From dev-return-84120-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Wed Oct  7 09:33:04 2015
Return-Path: <dev-return-84120-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 879601731A
	for <apmail-httpd-dev-archive@www.apache.org>; Wed,  7 Oct 2015 09:33:04 +0000 (UTC)
Received: (qmail 88055 invoked by uid 500); 7 Oct 2015 09:32:52 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 87980 invoked by uid 500); 7 Oct 2015 09:32:52 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 87970 invoked by uid 99); 7 Oct 2015 09:32:52 -0000
Received: from Unknown (HELO spamd2-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 07 Oct 2015 09:32:52 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd2-us-west.apache.org (ASF Mail Server at spamd2-us-west.apache.org) with ESMTP id 7FCF11A227E
	for <dev@httpd.apache.org>; Wed,  7 Oct 2015 09:32:52 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd2-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.011
X-Spam-Level:
X-Spam-Status: No, score=-0.011 tagged_above=-999 required=6.31
	tests=[SPF_PASS=-0.001, T_RP_MATCHES_RCVD=-0.01] autolearn=disabled
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd2-us-west.apache.org [10.40.0.9]) (amavisd-new, port 10024)
	with ESMTP id hxr5DetDAYrS for <dev@httpd.apache.org>;
	Wed,  7 Oct 2015 09:32:51 +0000 (UTC)
Received: from monica.sharp.fm (monica.sharp.fm [80.168.143.5])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTP id 89C432827E
	for <dev@httpd.apache.org>; Wed,  7 Oct 2015 09:32:50 +0000 (UTC)
Received: from [10.105.13.216] (unknown [5.56.169.82])
	(using TLSv1 with cipher DHE-RSA-AES256-SHA (256/256 bits))
	(Client did not present a certificate)
	(Authenticated sender: minfrin@sharp.fm)
	by monica.sharp.fm (Postfix) with ESMTPSA id 30C9983142
	for <dev@httpd.apache.org>; Wed,  7 Oct 2015 10:32:50 +0100 (BST)
Content-Type: text/plain; charset=utf-8
Mime-Version: 1.0 (Mac OS X Mail 8.2 \(2104\))
Subject: Re: svn commit: r1707163 - /httpd/httpd/trunk/server/util_filter.c
From: Graham Leggett <minfrin@sharp.fm>
In-Reply-To: <CAKQ1sVNqWwDyXnu=4nWw0wLqfLvt+Y0J9qKQmYek592_2TY9Jg@mail.gmail.com>
Date: Wed, 7 Oct 2015 11:32:49 +0200
Content-Transfer-Encoding: quoted-printable
Message-Id: <5BE46E99-5767-4A57-B86B-567181A7AC62@sharp.fm>
References: <20151006223828.AE1463A0141@svn01-us-west.apache.org> <CAKQ1sVNqWwDyXnu=4nWw0wLqfLvt+Y0J9qKQmYek592_2TY9Jg@mail.gmail.com>
To: dev@httpd.apache.org
X-Mailer: Apple Mail (2.2104)

On 07 Oct 2015, at 1:54 AM, Yann Ylavic <ylavic.dev@gmail.com> wrote:

> I don't understand this, why using ap_save_brigade() for both cases
> (i.e. setting aside or reading the other types of buckets) would lead
> to synchronous behaviour?
> It is when r->pool gets destroyed?
> If so, how is it different from the buckets currently set aside on =
r->pool?
>=20
> We could also possibly always use the deferred_pool (moving it to
> conn_rec if we don't want one per reinstate-able filter).

It=E2=80=99s because of this code here:

        rv =3D apr_bucket_setaside(e, p);

        /* If the bucket type does not implement setaside, then
         * (hopefully) morph it into a bucket type which does, and set
         * *that* aside... */
        if (rv =3D=3D APR_ENOTIMPL) {
            const char *s;
            apr_size_t n;

            rv =3D apr_bucket_read(e, &s, &n, APR_BLOCK_READ);
            if (rv =3D=3D APR_SUCCESS) {
                rv =3D apr_bucket_setaside(e, p);
            }
        }

This code reads morphing buckets into RAM, and in order to not overwhelm =
the server the server is forced to block to protect itself from =
out-of-memory.

The actual block is triggered by ap_filter_reinstate_brigade(), which =
sees the morphing bucket and marks it to be flushed, unless the bucket =
belongs to a request, in which case it can safely be buffered for the =
next pass without fiddling with the bucket at all.

The problem comes in with transient buckets that refer to memory that =
stops existing when the call eventually returns. Given that transient =
buckets are memory resident by definition, moving them to the heap is =
not an issue.

In order to understand how this works you need to look at all three of =
ap_filter_reinstate_brigade(), ap_filter_should_yield() and =
ap_filter_setaside_brigade() in detail, as they work together.

These three functions were implemented in the core network filter years =
ago and the concept is well tested. All this patch does is generalise =
this concept to other filters over and over the network filter.

Regards,
Graham
=E2=80=94


From dev-return-84121-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Wed Oct  7 10:54:51 2015
Return-Path: <dev-return-84121-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 4746C175D0
	for <apmail-httpd-dev-archive@www.apache.org>; Wed,  7 Oct 2015 10:54:51 +0000 (UTC)
Received: (qmail 85220 invoked by uid 500); 7 Oct 2015 10:54:50 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 85151 invoked by uid 500); 7 Oct 2015 10:54:50 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 85141 invoked by uid 99); 7 Oct 2015 10:54:50 -0000
Received: from Unknown (HELO spamd2-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 07 Oct 2015 10:54:50 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd2-us-west.apache.org (ASF Mail Server at spamd2-us-west.apache.org) with ESMTP id 46BDF1A07F0
	for <dev@httpd.apache.org>; Wed,  7 Oct 2015 10:54:50 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd2-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.011
X-Spam-Level:
X-Spam-Status: No, score=-0.011 tagged_above=-999 required=6.31
	tests=[SPF_PASS=-0.001, T_RP_MATCHES_RCVD=-0.01] autolearn=disabled
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd2-us-west.apache.org [10.40.0.9]) (amavisd-new, port 10024)
	with ESMTP id 4FdwkwZkpAYs for <dev@httpd.apache.org>;
	Wed,  7 Oct 2015 10:54:49 +0000 (UTC)
Received: from monica.sharp.fm (monica.sharp.fm [80.168.143.5])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTP id 54FF242AB6
	for <dev@httpd.apache.org>; Wed,  7 Oct 2015 10:54:49 +0000 (UTC)
Received: from [10.105.13.216] (unknown [5.56.169.82])
	(using TLSv1 with cipher DHE-RSA-AES256-SHA (256/256 bits))
	(Client did not present a certificate)
	(Authenticated sender: minfrin@sharp.fm)
	by monica.sharp.fm (Postfix) with ESMTPSA id 6CB8C830F8
	for <dev@httpd.apache.org>; Wed,  7 Oct 2015 11:54:48 +0100 (BST)
Content-Type: text/plain; charset=utf-8
Mime-Version: 1.0 (Mac OS X Mail 8.2 \(2104\))
Subject: Re: Serf and mod_lua and libmill (Was: Re: [Patch] Async write completion for the full connection filter stack)
From: Graham Leggett <minfrin@sharp.fm>
In-Reply-To: <CALK=YjMdLMkJPBd7Jzc3d9MHcV7PWQLA664wP+eoFvDYtH-rmw@mail.gmail.com>
Date: Wed, 7 Oct 2015 12:54:47 +0200
Content-Transfer-Encoding: quoted-printable
Message-Id: <9D37CF19-6F3A-4DD0-855C-439C62AB5509@sharp.fm>
References: <A57B894B-50DA-4252-8FFF-C3DEF8473A61@sharp.fm> <D4B68B53-592F-4EEC-B39F-EFC9887F60D5@jaguNET.com> <715A3AE8-8015-4537-943F-A34E0E2A76F7@sharp.fm> <D7EA895A-9C37-4387-AE89-C1B7DF9B0706@jaguNET.com> <540DFB30.6050700@apache.org> <2F3B060C-E383-407F-A24C-7F026AD3CA81@sharp.fm> <AB1691BE05AE7F4992697F2A0835627AC5D859AB@VOEXM10W.internal.vodafone.com> <AA9FAD6C-8E83-4F5F-8F18-BC3BECF8B0A1@sharp.fm> <CAKQ1sVPFJk9-Y=JwDLvJcYT7ZCQ=xbuBRS9fu8Me_T-3f2fVXg@mail.gmail.com> <C6246136-6B10-4F7B-8261-6723ABD26817@sharp.fm> <CAKQ1sVMw0-=LsqPEkWYs1QP8daMYv=eaxhRT8gsnrppooVzuMg@mail.gmail.com> <7A74676C-AA9D-40E1-A434-9280C297217D@sharp.fm> <54128B11.9080803@apache.org> <496E8EFA-7A10-4D91-8C7E-434A9A3B09C5@sharp.fm> <541499A9.5050408@apache.org> <4D9E72F8-4918-49AD-8DC4-E3594C9ED43D@sharp.fm> <04776F50-0A53-4C1D-AA1C-9F57B60BC0AC@sharp.fm> <38C56976-E693-4EEE-88BA-85DE3328FED3@sharp.fm> <7051D658-B96C-47BA-B21F-6511665DDAD8@jaguNET.com> <4203E8A4-546F-4DFA-977F-59C457F4580D@jaguN
 ET.com> <BDAEAB21-3353-4E29-8D16-461437C17E35@sharp.fm> <CALK=YjMdLMkJPBd7Jzc3d9MHcV7PWQLA664wP+eoFvDYtH-rmw@mail.gmail.com>
To: dev@httpd.apache.org
X-Mailer: Apple Mail (2.2104)

On 05 Oct 2015, at 5:13 PM, Eric Covener <covener@gmail.com> wrote:

> It seems like
> extending that to handlers (and implicitly, request filters) is more
> the  "can't be done" part.

Having had a chance to look at the handlers in more detail, I suspect =
the problem is that async support wasn=E2=80=99t extended far enough. =
You can return SUSPENDED from a handler, but only on the main request. =
If you=E2=80=99re in an internal redirect or a subrequest, SUSPENDED is =
treated as an error.

Request filters are already asynchronous, they aren=E2=80=99t a problem. =
A caller can only take advantage of the async nature of the input =
filters if the caller itself is asynchronous.

It should be possible to use an async input filter from an async output =
filter simply by changing the sense of the connection and letting the =
core deal with it. This is next for me, I plan to fix any bugs that =
stops this being possible.

Regards,
Graham
=E2=80=94


From dev-return-84122-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Wed Oct  7 11:36:58 2015
Return-Path: <dev-return-84122-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id D105C17719
	for <apmail-httpd-dev-archive@www.apache.org>; Wed,  7 Oct 2015 11:36:58 +0000 (UTC)
Received: (qmail 79377 invoked by uid 500); 7 Oct 2015 11:36:55 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 79307 invoked by uid 500); 7 Oct 2015 11:36:55 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 79297 invoked by uid 99); 7 Oct 2015 11:36:55 -0000
Received: from Unknown (HELO spamd2-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 07 Oct 2015 11:36:55 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd2-us-west.apache.org (ASF Mail Server at spamd2-us-west.apache.org) with ESMTP id DE0E91A22CA
	for <dev@httpd.apache.org>; Wed,  7 Oct 2015 11:36:54 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd2-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.011
X-Spam-Level:
X-Spam-Status: No, score=-0.011 tagged_above=-999 required=6.31
	tests=[SPF_PASS=-0.001, T_RP_MATCHES_RCVD=-0.01] autolearn=disabled
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd2-us-west.apache.org [10.40.0.9]) (amavisd-new, port 10024)
	with ESMTP id 5O2hfygedXMH for <dev@httpd.apache.org>;
	Wed,  7 Oct 2015 11:36:53 +0000 (UTC)
Received: from mailserver.kippdata.de (capsella.kippdata.de [195.227.30.149])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTP id AAE7D204C9
	for <dev@httpd.apache.org>; Wed,  7 Oct 2015 11:36:52 +0000 (UTC)
Received: from [10.0.110.6] ([192.168.10.45])
	by mailserver.kippdata.de (8.13.5/8.13.5) with ESMTP id t97Baihr006237
	for <dev@httpd.apache.org>; Wed, 7 Oct 2015 13:36:45 +0200 (CEST)
Subject: Re: svn commit: r1707241 - /httpd/httpd/branches/2.4.x/STATUS
To: dev@httpd.apache.org
References: <20151007110323.6204F3A01E3@svn01-us-west.apache.org>
From: Rainer Jung <rainer.jung@kippdata.de>
Message-ID: <561503CB.5090501@kippdata.de>
Date: Wed, 7 Oct 2015 13:36:43 +0200
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:38.0) Gecko/20100101
 Thunderbird/38.3.0
MIME-Version: 1.0
In-Reply-To: <20151007110323.6204F3A01E3@svn01-us-west.apache.org>
Content-Type: text/plain; charset=utf-8; format=flowed
Content-Transfer-Encoding: 7bit

Am 07.10.2015 um 13:03 schrieb ylavic@apache.org:
> Author: ylavic
> Date: Wed Oct  7 11:03:22 2015
> New Revision: 1707241
>
> URL: http://svn.apache.org/viewvc?rev=1707241&view=rev
> Log:
> Fix commit revision of Rainer's proposal.

Thanks, I wonder where I got the wrong one from. I usually do copy and 
paste and the wrong one isn't from a project I work on.

Rainer

From dev-return-84123-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Wed Oct  7 12:26:15 2015
Return-Path: <dev-return-84123-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 8D87B17860
	for <apmail-httpd-dev-archive@www.apache.org>; Wed,  7 Oct 2015 12:26:15 +0000 (UTC)
Received: (qmail 56140 invoked by uid 500); 7 Oct 2015 12:26:14 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 56070 invoked by uid 500); 7 Oct 2015 12:26:14 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 56060 invoked by uid 99); 7 Oct 2015 12:26:14 -0000
Received: from Unknown (HELO spamd4-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 07 Oct 2015 12:26:14 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd4-us-west.apache.org (ASF Mail Server at spamd4-us-west.apache.org) with ESMTP id 672F1C093C
	for <dev@httpd.apache.org>; Wed,  7 Oct 2015 12:26:14 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd4-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 2.899
X-Spam-Level: **
X-Spam-Status: No, score=2.899 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	HTML_MESSAGE=3, RCVD_IN_MSPIKE_H2=-0.001, SPF_PASS=-0.001,
	URIBL_BLOCKED=0.001] autolearn=disabled
Authentication-Results: spamd4-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd4-us-west.apache.org [10.40.0.11]) (amavisd-new, port 10024)
	with ESMTP id TdvU46hznskc for <dev@httpd.apache.org>;
	Wed,  7 Oct 2015 12:26:08 +0000 (UTC)
Received: from mail-io0-f173.google.com (mail-io0-f173.google.com [209.85.223.173])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id 68CDA439BA
	for <dev@httpd.apache.org>; Wed,  7 Oct 2015 12:26:08 +0000 (UTC)
Received: by iofh134 with SMTP id h134so20082622iof.0
        for <dev@httpd.apache.org>; Wed, 07 Oct 2015 05:26:08 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        bh=IT2WNfso4i0hzo5nwFaA3lojNdVh3RNoy2FH6lqevmM=;
        b=ftcXwEpCOk6oxMMIN06FIQj1seplaIf9TCcRSMGJdEE7CKpIgkN8ZoonnHc1rrrr1e
         MPPt928SsixssleVldbF+cMrRrf8QG0RpN8NdXkXGVO7d+PwoCzHf0NU7h0Ra4ors7yc
         lTX9siRXxSHTuy6ZMkBk8KFGebySQATcdu+1rxzBTTpggp2RLU5Bm+4XIalUj+aj9JOo
         t2wxlLnTiz7UMRZ2vs4IS2NQARWMoGj3vGpw5LyO3qhvHTxh36KzBOvobCGIP7nUS+Sj
         x0OqRZWOr8g75v4bxIYFNpKWMkkPAT4kQ4cVNrYE//k9cZSg5zUm625JJrnnAyW8R20D
         Hs/w==
MIME-Version: 1.0
X-Received: by 10.107.6.65 with SMTP id 62mr1566768iog.147.1444220767968; Wed,
 07 Oct 2015 05:26:07 -0700 (PDT)
Received: by 10.36.37.18 with HTTP; Wed, 7 Oct 2015 05:26:07 -0700 (PDT)
In-Reply-To: <20151006223305.649363A0141@svn01-us-west.apache.org>
References: <20151006223305.649363A0141@svn01-us-west.apache.org>
Date: Wed, 7 Oct 2015 08:26:07 -0400
Message-ID: <CAKUrXK6W1gHb6Xab4Q=k3T3W+yaiwZOshvW21Lv7HB8KtwHaUQ@mail.gmail.com>
Subject: Re: svn commit: r1707161 - in /httpd/httpd/trunk: docs/manual/mod/core.xml
 include/ap_mmn.h include/http_core.h include/httpd.h server/core.c
 server/request.c server/util_filter.c
From: Jeff Trawick <trawick@gmail.com>
To: Apache HTTP Server Development List <dev@httpd.apache.org>
Content-Type: multipart/alternative; boundary=001a113f8d44da2462052182d904

--001a113f8d44da2462052182d904
Content-Type: text/plain; charset=UTF-8

On Tue, Oct 6, 2015 at 6:33 PM, <minfrin@apache.org> wrote:

> Author: minfrin
> Date: Tue Oct  6 22:33:03 2015
> New Revision: 1707161
>
> URL: http://svn.apache.org/viewvc?rev=1707161&view=rev
> Log:
> Add the AsyncFilter directive that allows the asynchronous filter
> functionality to be switched off for certain classes of filters.
>
> Modified:
>     httpd/httpd/trunk/docs/manual/mod/core.xml
>     httpd/httpd/trunk/include/ap_mmn.h
>     httpd/httpd/trunk/include/http_core.h
>     httpd/httpd/trunk/include/httpd.h
>     httpd/httpd/trunk/server/core.c
>     httpd/httpd/trunk/server/request.c
>     httpd/httpd/trunk/server/util_filter.c
>
> Modified: httpd/httpd/trunk/docs/manual/mod/core.xml
> URL:
> http://svn.apache.org/viewvc/httpd/httpd/trunk/docs/manual/mod/core.xml?rev=1707161&r1=1707160&r2=1707161&view=diff
>
> ==============================================================================
> --- httpd/httpd/trunk/docs/manual/mod/core.xml (original)
> +++ httpd/httpd/trunk/docs/manual/mod/core.xml Tue Oct  6 22:33:03 2015
> @@ -552,6 +552,32 @@ AllowOverrideList CookieTracking CookieN
>  </directivesynopsis>
>
>  <directivesynopsis>
> +    <name>AsyncFilter</name>
> +    <description>Set the minimum filter type eligible for asynchronous
> handling</description>
> +    <syntax>AsyncFilter request|connection|network</syntax>
> +    <default>AsyncFilter request</default>
> +    <contextlist><context>server config</context><context>virtual
> host</context></contextlist>
> +    <compatibility>Only available from Apache 2.5.0 and
> later.</compatibility>
> +
> +    <usage>
> +        <p>This directive controls the minimum filter levels that are
> eligible
> +        for asynchronous handling. This may be necessary to support
> legacy external
> +        filters that did not handle meta buckets correctly.</p>
> +
> +        <p>If set to "network", asynchronous handling will be limited to
> the network
> +        filter only. If set to "connection", all connection and network
> filters
> +        will be eligible for asynchronous handling, including
> <module>mod_ssl</module>.
> +        If set to "request", all filters will be eligible for
> asynchronous handling.</p>
> +
> +        <p>With <directive>ProtocolsHonorOrder</directive> set to
> <code>on</code>
> +            (default), the client ordering does not matter and only the
> ordering
> +            in the server settings influences the outcome of the protocol
> +            negotiation.</p>
> +
> +    </usage>
> +</directivesynopsis>
> +
> +<directivesynopsis>
>  <name>CGIMapExtension</name>
>  <description>Technique for locating the interpreter for CGI
>  scripts</description>
>
> Modified: httpd/httpd/trunk/include/ap_mmn.h
> URL:
> http://svn.apache.org/viewvc/httpd/httpd/trunk/include/ap_mmn.h?rev=1707161&r1=1707160&r2=1707161&view=diff
>
> ==============================================================================
> --- httpd/httpd/trunk/include/ap_mmn.h (original)
> +++ httpd/httpd/trunk/include/ap_mmn.h Tue Oct  6 22:33:03 2015
> @@ -494,6 +494,7 @@
>   *                         ap_filter_reinstate_brigade() and
>   *                         ap_filter_should_yield(). Add empty and
> filters to
>   *                         conn_rec.
> + * 20150222.6 (2.5.0-dev)  Add async_filter to conn_rec.
>   */
>
>  #define MODULE_MAGIC_COOKIE 0x41503235UL /* "AP25" */
> @@ -501,7 +502,7 @@
>  #ifndef MODULE_MAGIC_NUMBER_MAJOR
>  #define MODULE_MAGIC_NUMBER_MAJOR 20150222
>  #endif
> -#define MODULE_MAGIC_NUMBER_MINOR 5                 /* 0...n */
> +#define MODULE_MAGIC_NUMBER_MINOR 6                 /* 0...n */
>
>  /**
>   * Determine if the server's current MODULE_MAGIC_NUMBER is at least a
>
> Modified: httpd/httpd/trunk/include/http_core.h
> URL:
> http://svn.apache.org/viewvc/httpd/httpd/trunk/include/http_core.h?rev=1707161&r1=1707160&r2=1707161&view=diff
>
> ==============================================================================
> --- httpd/httpd/trunk/include/http_core.h (original)
> +++ httpd/httpd/trunk/include/http_core.h Tue Oct  6 22:33:03 2015
> @@ -711,6 +711,8 @@ typedef struct {
>
>      apr_array_header_t *protocols;
>      int protocols_honor_order;
> +    int async_filter;
> +    int async_filter_set:1;
>

"unsigned"  is a better choice for this; I think we fixed all of the signed
bit fields in httpd, some out of necessity IIRC

 } core_server_config;
>
>  /* for AddOutputFiltersByType in core.c */
>
> Modified: httpd/httpd/trunk/include/httpd.h
> URL:
> http://svn.apache.org/viewvc/httpd/httpd/trunk/include/httpd.h?rev=1707161&r1=1707160&r2=1707161&view=diff
>
> ==============================================================================
> --- httpd/httpd/trunk/include/httpd.h (original)
> +++ httpd/httpd/trunk/include/httpd.h Tue Oct  6 22:33:03 2015
> @@ -1198,6 +1198,9 @@ struct conn_rec {
>
>      /** Hashtable of filters with setaside buckets for write completion */
>      apr_hash_t *filters;
> +
> +    /** The minimum level of filter type to allow setaside buckets */
> +    int async_filter;
>  };
>
>  struct conn_slave_rec {
>
> Modified: httpd/httpd/trunk/server/core.c
> URL:
> http://svn.apache.org/viewvc/httpd/httpd/trunk/server/core.c?rev=1707161&r1=1707160&r2=1707161&view=diff
>
> ==============================================================================
> --- httpd/httpd/trunk/server/core.c (original)
> +++ httpd/httpd/trunk/server/core.c Tue Oct  6 22:33:03 2015
> @@ -481,7 +481,8 @@ static void *create_core_server_config(a
>
>      conf->protocols = apr_array_make(a, 5, sizeof(const char *));
>      conf->protocols_honor_order = -1;
> -
> +    conf->async_filter = 0;
> +
>      return (void *)conf;
>  }
>
> @@ -555,12 +556,16 @@ static void *merge_core_server_configs(a
>                             ? virt->merge_trailers
>                             : base->merge_trailers;
>
> -    conf->protocols = ((virt->protocols->nelts > 0)?
> +    conf->protocols = ((virt->protocols->nelts > 0) ?
>                         virt->protocols : base->protocols);
> -    conf->protocols_honor_order = ((virt->protocols_honor_order < 0)?
> +    conf->protocols_honor_order = ((virt->protocols_honor_order < 0) ?
>                                         base->protocols_honor_order :
>                                         virt->protocols_honor_order);
> -
> +    conf->async_filter = ((virt->async_filter_set) ?
> +                                       virt->async_filter :
> +                                       base->async_filter);
> +    conf->async_filter_set = base->async_filter_set ||
> virt->async_filter_set;
> +
>      return conf;
>  }
>
> @@ -3887,6 +3892,34 @@ static const char *set_http_protocol(cmd
>      return NULL;
>  }
>
> +static const char *set_async_filter(cmd_parms *cmd, void *dummy,
> +                                             const char *arg)
> +{
> +    core_server_config *conf =
> +    ap_get_core_module_config(cmd->server->module_config);
> +    const char *err = ap_check_cmd_context(cmd, NOT_IN_DIR_LOC_FILE);
> +
> +    if (err) {
> +        return err;
> +    }
> +
> +    if (strcasecmp(arg, "network") == 0) {
> +        conf->async_filter = AP_FTYPE_NETWORK;
> +    }
> +    else if (strcasecmp(arg, "connection") == 0) {
> +        conf->async_filter = AP_FTYPE_CONNECTION;
> +    }
> +    else if (strcasecmp(arg, "request") == 0) {
> +        conf->async_filter = 0;
> +    }
> +    else {
> +        return "AsyncFilter must be 'network', 'connection' or 'request'";
> +    }
> +    conf->async_filter_set = 1;
> +
> +    return NULL;
> +}
> +
>  static const char *set_http_method(cmd_parms *cmd, void *conf, const char
> *arg)
>  {
>      const char *err = ap_check_cmd_context(cmd, GLOBAL_ONLY);
> @@ -4502,6 +4535,9 @@ AP_INIT_ITERATE("Protocols", set_protoco
>  AP_INIT_TAKE1("ProtocolsHonorOrder", set_protocols_honor_order, NULL,
> RSRC_CONF,
>                "'off' (default) or 'on' to respect given order of
> protocols, "
>                "by default the client specified order determines
> selection"),
> +AP_INIT_TAKE1("AsyncFilter", set_async_filter, NULL, RSRC_CONF,
> +              "'network', 'connection' (default) or 'request' to limit
> the "
> +              "types of filters that support asynchronous handling"),
>  { NULL }
>  };
>
> @@ -5010,6 +5046,7 @@ static conn_rec *core_create_conn(apr_po
>      c->bucket_alloc = alloc;
>      c->empty = apr_brigade_create(c->pool, c->bucket_alloc);
>      c->filters = apr_hash_make(c->pool);
> +    c->async_filter = sconf->async_filter;
>
>      c->clogging_input_filters = 0;
>
>
> Modified: httpd/httpd/trunk/server/request.c
> URL:
> http://svn.apache.org/viewvc/httpd/httpd/trunk/server/request.c?rev=1707161&r1=1707160&r2=1707161&view=diff
>
> ==============================================================================
> --- httpd/httpd/trunk/server/request.c (original)
> +++ httpd/httpd/trunk/server/request.c Tue Oct  6 22:33:03 2015
> @@ -2043,6 +2043,15 @@ AP_CORE_DECLARE_NONSTD(apr_status_t) ap_
>      apr_status_t status = APR_SUCCESS;
>      apr_bucket_brigade *tmp_bb = f->ctx;
>
> +    /*
> +     * Handle the AsyncFilter directive. We limit the filters that are
> +     * eligible for asynchronous handling here.
> +     */
> +    if (f->frec->ftype < f->c->async_filter) {
> +        ap_remove_output_filter(f);
> +        return ap_pass_brigade(f->next, bb);
> +    }
> +
>      if (!tmp_bb) {
>          tmp_bb = f->ctx = apr_brigade_create(f->r->pool,
> f->c->bucket_alloc);
>      }
>
> Modified: httpd/httpd/trunk/server/util_filter.c
> URL:
> http://svn.apache.org/viewvc/httpd/httpd/trunk/server/util_filter.c?rev=1707161&r1=1707160&r2=1707161&view=diff
>
> ==============================================================================
> --- httpd/httpd/trunk/server/util_filter.c (original)
> +++ httpd/httpd/trunk/server/util_filter.c Tue Oct  6 22:33:03 2015
> @@ -894,6 +894,14 @@ AP_DECLARE(apr_status_t) ap_filter_reins
>  AP_DECLARE(int) ap_filter_should_yield(ap_filter_t *f)
>  {
>      /*
> +     * Handle the AsyncFilter directive. We limit the filters that are
> +     * eligible for asynchronous handling here.
> +     */
> +    if (f->frec->ftype < f->c->async_filter) {
> +        return 0;
> +    }
> +
> +    /*
>       * This function decides whether a filter should yield due to buffered
>       * data in a downstream filter. If a downstream filter buffers we
>       * must back off so we don't overwhelm the server. If this function
>
>
>


-- 
Born in Roswell... married an alien...
http://emptyhammock.com/

--001a113f8d44da2462052182d904
Content-Type: text/html; charset=UTF-8
Content-Transfer-Encoding: quoted-printable

<div dir=3D"ltr"><div class=3D"gmail_extra"><div class=3D"gmail_quote">On T=
ue, Oct 6, 2015 at 6:33 PM,  <span dir=3D"ltr">&lt;<a href=3D"mailto:minfri=
n@apache.org" target=3D"_blank">minfrin@apache.org</a>&gt;</span> wrote:<br=
><blockquote class=3D"gmail_quote" style=3D"margin:0 0 0 .8ex;border-left:1=
px #ccc solid;padding-left:1ex">Author: minfrin<br>
Date: Tue Oct=C2=A0 6 22:33:03 2015<br>
New Revision: 1707161<br>
<br>
URL: <a href=3D"http://svn.apache.org/viewvc?rev=3D1707161&amp;view=3Drev" =
rel=3D"noreferrer" target=3D"_blank">http://svn.apache.org/viewvc?rev=3D170=
7161&amp;view=3Drev</a><br>
Log:<br>
Add the AsyncFilter directive that allows the asynchronous filter<br>
functionality to be switched off for certain classes of filters.<br>
<br>
Modified:<br>
=C2=A0 =C2=A0 httpd/httpd/trunk/docs/manual/mod/core.xml<br>
=C2=A0 =C2=A0 httpd/httpd/trunk/include/ap_mmn.h<br>
=C2=A0 =C2=A0 httpd/httpd/trunk/include/http_core.h<br>
=C2=A0 =C2=A0 httpd/httpd/trunk/include/httpd.h<br>
=C2=A0 =C2=A0 httpd/httpd/trunk/server/core.c<br>
=C2=A0 =C2=A0 httpd/httpd/trunk/server/request.c<br>
=C2=A0 =C2=A0 httpd/httpd/trunk/server/util_filter.c<br>
<br>
Modified: httpd/httpd/trunk/docs/manual/mod/core.xml<br>
URL: <a href=3D"http://svn.apache.org/viewvc/httpd/httpd/trunk/docs/manual/=
mod/core.xml?rev=3D1707161&amp;r1=3D1707160&amp;r2=3D1707161&amp;view=3Ddif=
f" rel=3D"noreferrer" target=3D"_blank">http://svn.apache.org/viewvc/httpd/=
httpd/trunk/docs/manual/mod/core.xml?rev=3D1707161&amp;r1=3D1707160&amp;r2=
=3D1707161&amp;view=3Ddiff</a><br>
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D<br>
--- httpd/httpd/trunk/docs/manual/mod/core.xml (original)<br>
+++ httpd/httpd/trunk/docs/manual/mod/core.xml Tue Oct=C2=A0 6 22:33:03 201=
5<br>
@@ -552,6 +552,32 @@ AllowOverrideList CookieTracking CookieN<br>
=C2=A0&lt;/directivesynopsis&gt;<br>
<br>
=C2=A0&lt;directivesynopsis&gt;<br>
+=C2=A0 =C2=A0 &lt;name&gt;AsyncFilter&lt;/name&gt;<br>
+=C2=A0 =C2=A0 &lt;description&gt;Set the minimum filter type eligible for =
asynchronous handling&lt;/description&gt;<br>
+=C2=A0 =C2=A0 &lt;syntax&gt;AsyncFilter request|connection|network&lt;/syn=
tax&gt;<br>
+=C2=A0 =C2=A0 &lt;default&gt;AsyncFilter request&lt;/default&gt;<br>
+=C2=A0 =C2=A0 &lt;contextlist&gt;&lt;context&gt;server config&lt;/context&=
gt;&lt;context&gt;virtual host&lt;/context&gt;&lt;/contextlist&gt;<br>
+=C2=A0 =C2=A0 &lt;compatibility&gt;Only available from Apache 2.5.0 and la=
ter.&lt;/compatibility&gt;<br>
+<br>
+=C2=A0 =C2=A0 &lt;usage&gt;<br>
+=C2=A0 =C2=A0 =C2=A0 =C2=A0 &lt;p&gt;This directive controls the minimum f=
ilter levels that are eligible<br>
+=C2=A0 =C2=A0 =C2=A0 =C2=A0 for asynchronous handling. This may be necessa=
ry to support legacy external<br>
+=C2=A0 =C2=A0 =C2=A0 =C2=A0 filters that did not handle meta buckets corre=
ctly.&lt;/p&gt;<br>
+<br>
+=C2=A0 =C2=A0 =C2=A0 =C2=A0 &lt;p&gt;If set to &quot;network&quot;, asynch=
ronous handling will be limited to the network<br>
+=C2=A0 =C2=A0 =C2=A0 =C2=A0 filter only. If set to &quot;connection&quot;,=
 all connection and network filters<br>
+=C2=A0 =C2=A0 =C2=A0 =C2=A0 will be eligible for asynchronous handling, in=
cluding &lt;module&gt;mod_ssl&lt;/module&gt;.<br>
+=C2=A0 =C2=A0 =C2=A0 =C2=A0 If set to &quot;request&quot;, all filters wil=
l be eligible for asynchronous handling.&lt;/p&gt;<br>
+<br>
+=C2=A0 =C2=A0 =C2=A0 =C2=A0 &lt;p&gt;With &lt;directive&gt;ProtocolsHonorO=
rder&lt;/directive&gt; set to &lt;code&gt;on&lt;/code&gt;<br>
+=C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 (default), the client ordering d=
oes not matter and only the ordering<br>
+=C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 in the server settings influence=
s the outcome of the protocol<br>
+=C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 negotiation.&lt;/p&gt;<br>
+<br>
+=C2=A0 =C2=A0 &lt;/usage&gt;<br>
+&lt;/directivesynopsis&gt;<br>
+<br>
+&lt;directivesynopsis&gt;<br>
=C2=A0&lt;name&gt;CGIMapExtension&lt;/name&gt;<br>
=C2=A0&lt;description&gt;Technique for locating the interpreter for CGI<br>
=C2=A0scripts&lt;/description&gt;<br>
<br>
Modified: httpd/httpd/trunk/include/ap_mmn.h<br>
URL: <a href=3D"http://svn.apache.org/viewvc/httpd/httpd/trunk/include/ap_m=
mn.h?rev=3D1707161&amp;r1=3D1707160&amp;r2=3D1707161&amp;view=3Ddiff" rel=
=3D"noreferrer" target=3D"_blank">http://svn.apache.org/viewvc/httpd/httpd/=
trunk/include/ap_mmn.h?rev=3D1707161&amp;r1=3D1707160&amp;r2=3D1707161&amp;=
view=3Ddiff</a><br>
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D<br>
--- httpd/httpd/trunk/include/ap_mmn.h (original)<br>
+++ httpd/httpd/trunk/include/ap_mmn.h Tue Oct=C2=A0 6 22:33:03 2015<br>
@@ -494,6 +494,7 @@<br>
=C2=A0 *=C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=
=A0 =C2=A0 =C2=A0 =C2=A0ap_filter_reinstate_brigade() and<br>
=C2=A0 *=C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=
=A0 =C2=A0 =C2=A0 =C2=A0ap_filter_should_yield(). Add empty and filters to<=
br>
=C2=A0 *=C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=
=A0 =C2=A0 =C2=A0 =C2=A0conn_rec.<br>
+ * 20150222.6 (2.5.0-dev)=C2=A0 Add async_filter to conn_rec.<br>
=C2=A0 */<br>
<br>
=C2=A0#define MODULE_MAGIC_COOKIE 0x41503235UL /* &quot;AP25&quot; */<br>
@@ -501,7 +502,7 @@<br>
=C2=A0#ifndef MODULE_MAGIC_NUMBER_MAJOR<br>
=C2=A0#define MODULE_MAGIC_NUMBER_MAJOR 20150222<br>
=C2=A0#endif<br>
-#define MODULE_MAGIC_NUMBER_MINOR 5=C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=
=A0 =C2=A0 =C2=A0 =C2=A0/* 0...n */<br>
+#define MODULE_MAGIC_NUMBER_MINOR 6=C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=
=A0 =C2=A0 =C2=A0 =C2=A0/* 0...n */<br>
<br>
=C2=A0/**<br>
=C2=A0 * Determine if the server&#39;s current MODULE_MAGIC_NUMBER is at le=
ast a<br>
<br>
Modified: httpd/httpd/trunk/include/http_core.h<br>
URL: <a href=3D"http://svn.apache.org/viewvc/httpd/httpd/trunk/include/http=
_core.h?rev=3D1707161&amp;r1=3D1707160&amp;r2=3D1707161&amp;view=3Ddiff" re=
l=3D"noreferrer" target=3D"_blank">http://svn.apache.org/viewvc/httpd/httpd=
/trunk/include/http_core.h?rev=3D1707161&amp;r1=3D1707160&amp;r2=3D1707161&=
amp;view=3Ddiff</a><br>
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D<br>
--- httpd/httpd/trunk/include/http_core.h (original)<br>
+++ httpd/httpd/trunk/include/http_core.h Tue Oct=C2=A0 6 22:33:03 2015<br>
@@ -711,6 +711,8 @@ typedef struct {<br>
<br>
=C2=A0 =C2=A0 =C2=A0apr_array_header_t *protocols;<br>
=C2=A0 =C2=A0 =C2=A0int protocols_honor_order;<br>
+=C2=A0 =C2=A0 int async_filter;<br>
+=C2=A0 =C2=A0 int async_filter_set:1;<br></blockquote><div><br></div><div>=
&quot;unsigned&quot; =C2=A0is a better choice for this; I think we fixed al=
l of the signed bit fields in httpd, some out of necessity IIRC</div><div><=
br></div><blockquote class=3D"gmail_quote" style=3D"margin:0 0 0 .8ex;borde=
r-left:1px #ccc solid;padding-left:1ex">
=C2=A0} core_server_config;<br>
<br>
=C2=A0/* for AddOutputFiltersByType in core.c */<br>
<br>
Modified: httpd/httpd/trunk/include/httpd.h<br>
URL: <a href=3D"http://svn.apache.org/viewvc/httpd/httpd/trunk/include/http=
d.h?rev=3D1707161&amp;r1=3D1707160&amp;r2=3D1707161&amp;view=3Ddiff" rel=3D=
"noreferrer" target=3D"_blank">http://svn.apache.org/viewvc/httpd/httpd/tru=
nk/include/httpd.h?rev=3D1707161&amp;r1=3D1707160&amp;r2=3D1707161&amp;view=
=3Ddiff</a><br>
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D<br>
--- httpd/httpd/trunk/include/httpd.h (original)<br>
+++ httpd/httpd/trunk/include/httpd.h Tue Oct=C2=A0 6 22:33:03 2015<br>
@@ -1198,6 +1198,9 @@ struct conn_rec {<br>
<br>
=C2=A0 =C2=A0 =C2=A0/** Hashtable of filters with setaside buckets for writ=
e completion */<br>
=C2=A0 =C2=A0 =C2=A0apr_hash_t *filters;<br>
+<br>
+=C2=A0 =C2=A0 /** The minimum level of filter type to allow setaside bucke=
ts */<br>
+=C2=A0 =C2=A0 int async_filter;<br>
=C2=A0};<br>
<br>
=C2=A0struct conn_slave_rec {<br>
<br>
Modified: httpd/httpd/trunk/server/core.c<br>
URL: <a href=3D"http://svn.apache.org/viewvc/httpd/httpd/trunk/server/core.=
c?rev=3D1707161&amp;r1=3D1707160&amp;r2=3D1707161&amp;view=3Ddiff" rel=3D"n=
oreferrer" target=3D"_blank">http://svn.apache.org/viewvc/httpd/httpd/trunk=
/server/core.c?rev=3D1707161&amp;r1=3D1707160&amp;r2=3D1707161&amp;view=3Dd=
iff</a><br>
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D<br>
--- httpd/httpd/trunk/server/core.c (original)<br>
+++ httpd/httpd/trunk/server/core.c Tue Oct=C2=A0 6 22:33:03 2015<br>
@@ -481,7 +481,8 @@ static void *create_core_server_config(a<br>
<br>
=C2=A0 =C2=A0 =C2=A0conf-&gt;protocols =3D apr_array_make(a, 5, sizeof(cons=
t char *));<br>
=C2=A0 =C2=A0 =C2=A0conf-&gt;protocols_honor_order =3D -1;<br>
-<br>
+=C2=A0 =C2=A0 conf-&gt;async_filter =3D 0;<br>
+<br>
=C2=A0 =C2=A0 =C2=A0return (void *)conf;<br>
=C2=A0}<br>
<br>
@@ -555,12 +556,16 @@ static void *merge_core_server_configs(a<br>
=C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=
=A0 =C2=A0 =C2=A0 =C2=A0 ? virt-&gt;merge_trailers<br>
=C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=
=A0 =C2=A0 =C2=A0 =C2=A0 : base-&gt;merge_trailers;<br>
<br>
-=C2=A0 =C2=A0 conf-&gt;protocols =3D ((virt-&gt;protocols-&gt;nelts &gt; 0=
)?<br>
+=C2=A0 =C2=A0 conf-&gt;protocols =3D ((virt-&gt;protocols-&gt;nelts &gt; 0=
) ?<br>
=C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=
=A0 =C2=A0 virt-&gt;protocols : base-&gt;protocols);<br>
-=C2=A0 =C2=A0 conf-&gt;protocols_honor_order =3D ((virt-&gt;protocols_hono=
r_order &lt; 0)?<br>
+=C2=A0 =C2=A0 conf-&gt;protocols_honor_order =3D ((virt-&gt;protocols_hono=
r_order &lt; 0) ?<br>
=C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=
=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 base-&gt=
;protocols_honor_order :<br>
=C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=
=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 virt-&gt=
;protocols_honor_order);<br>
-<br>
+=C2=A0 =C2=A0 conf-&gt;async_filter =3D ((virt-&gt;async_filter_set) ?<br>
+=C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=
=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0virt-&gt;=
async_filter :<br>
+=C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=
=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0base-&gt;=
async_filter);<br>
+=C2=A0 =C2=A0 conf-&gt;async_filter_set =3D base-&gt;async_filter_set || v=
irt-&gt;async_filter_set;<br>
+<br>
=C2=A0 =C2=A0 =C2=A0return conf;<br>
=C2=A0}<br>
<br>
@@ -3887,6 +3892,34 @@ static const char *set_http_protocol(cmd<br>
=C2=A0 =C2=A0 =C2=A0return NULL;<br>
=C2=A0}<br>
<br>
+static const char *set_async_filter(cmd_parms *cmd, void *dummy,<br>
+=C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=
=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =
=C2=A0 =C2=A0const char *arg)<br>
+{<br>
+=C2=A0 =C2=A0 core_server_config *conf =3D<br>
+=C2=A0 =C2=A0 ap_get_core_module_config(cmd-&gt;server-&gt;module_config);=
<br>
+=C2=A0 =C2=A0 const char *err =3D ap_check_cmd_context(cmd, NOT_IN_DIR_LOC=
_FILE);<br>
+<br>
+=C2=A0 =C2=A0 if (err) {<br>
+=C2=A0 =C2=A0 =C2=A0 =C2=A0 return err;<br>
+=C2=A0 =C2=A0 }<br>
+<br>
+=C2=A0 =C2=A0 if (strcasecmp(arg, &quot;network&quot;) =3D=3D 0) {<br>
+=C2=A0 =C2=A0 =C2=A0 =C2=A0 conf-&gt;async_filter =3D AP_FTYPE_NETWORK;<br=
>
+=C2=A0 =C2=A0 }<br>
+=C2=A0 =C2=A0 else if (strcasecmp(arg, &quot;connection&quot;) =3D=3D 0) {=
<br>
+=C2=A0 =C2=A0 =C2=A0 =C2=A0 conf-&gt;async_filter =3D AP_FTYPE_CONNECTION;=
<br>
+=C2=A0 =C2=A0 }<br>
+=C2=A0 =C2=A0 else if (strcasecmp(arg, &quot;request&quot;) =3D=3D 0) {<br=
>
+=C2=A0 =C2=A0 =C2=A0 =C2=A0 conf-&gt;async_filter =3D 0;<br>
+=C2=A0 =C2=A0 }<br>
+=C2=A0 =C2=A0 else {<br>
+=C2=A0 =C2=A0 =C2=A0 =C2=A0 return &quot;AsyncFilter must be &#39;network&=
#39;, &#39;connection&#39; or &#39;request&#39;&quot;;<br>
+=C2=A0 =C2=A0 }<br>
+=C2=A0 =C2=A0 conf-&gt;async_filter_set =3D 1;<br>
+<br>
+=C2=A0 =C2=A0 return NULL;<br>
+}<br>
+<br>
=C2=A0static const char *set_http_method(cmd_parms *cmd, void *conf, const =
char *arg)<br>
=C2=A0{<br>
=C2=A0 =C2=A0 =C2=A0const char *err =3D ap_check_cmd_context(cmd, GLOBAL_ON=
LY);<br>
@@ -4502,6 +4535,9 @@ AP_INIT_ITERATE(&quot;Protocols&quot;, set_protoco<br=
>
=C2=A0AP_INIT_TAKE1(&quot;ProtocolsHonorOrder&quot;, set_protocols_honor_or=
der, NULL, RSRC_CONF,<br>
=C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0&quot;&#39;off&#39; =
(default) or &#39;on&#39; to respect given order of protocols, &quot;<br>
=C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0&quot;by default the=
 client specified order determines selection&quot;),<br>
+AP_INIT_TAKE1(&quot;AsyncFilter&quot;, set_async_filter, NULL, RSRC_CONF,<=
br>
+=C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 &quot;&#39;network&#39;, =
&#39;connection&#39; (default) or &#39;request&#39; to limit the &quot;<br>
+=C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 &quot;types of filters th=
at support asynchronous handling&quot;),<br>
=C2=A0{ NULL }<br>
=C2=A0};<br>
<br>
@@ -5010,6 +5046,7 @@ static conn_rec *core_create_conn(apr_po<br>
=C2=A0 =C2=A0 =C2=A0c-&gt;bucket_alloc =3D alloc;<br>
=C2=A0 =C2=A0 =C2=A0c-&gt;empty =3D apr_brigade_create(c-&gt;pool, c-&gt;bu=
cket_alloc);<br>
=C2=A0 =C2=A0 =C2=A0c-&gt;filters =3D apr_hash_make(c-&gt;pool);<br>
+=C2=A0 =C2=A0 c-&gt;async_filter =3D sconf-&gt;async_filter;<br>
<br>
=C2=A0 =C2=A0 =C2=A0c-&gt;clogging_input_filters =3D 0;<br>
<br>
<br>
Modified: httpd/httpd/trunk/server/request.c<br>
URL: <a href=3D"http://svn.apache.org/viewvc/httpd/httpd/trunk/server/reque=
st.c?rev=3D1707161&amp;r1=3D1707160&amp;r2=3D1707161&amp;view=3Ddiff" rel=
=3D"noreferrer" target=3D"_blank">http://svn.apache.org/viewvc/httpd/httpd/=
trunk/server/request.c?rev=3D1707161&amp;r1=3D1707160&amp;r2=3D1707161&amp;=
view=3Ddiff</a><br>
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D<br>
--- httpd/httpd/trunk/server/request.c (original)<br>
+++ httpd/httpd/trunk/server/request.c Tue Oct=C2=A0 6 22:33:03 2015<br>
@@ -2043,6 +2043,15 @@ AP_CORE_DECLARE_NONSTD(apr_status_t) ap_<br>
=C2=A0 =C2=A0 =C2=A0apr_status_t status =3D APR_SUCCESS;<br>
=C2=A0 =C2=A0 =C2=A0apr_bucket_brigade *tmp_bb =3D f-&gt;ctx;<br>
<br>
+=C2=A0 =C2=A0 /*<br>
+=C2=A0 =C2=A0 =C2=A0* Handle the AsyncFilter directive. We limit the filte=
rs that are<br>
+=C2=A0 =C2=A0 =C2=A0* eligible for asynchronous handling here.<br>
+=C2=A0 =C2=A0 =C2=A0*/<br>
+=C2=A0 =C2=A0 if (f-&gt;frec-&gt;ftype &lt; f-&gt;c-&gt;async_filter) {<br=
>
+=C2=A0 =C2=A0 =C2=A0 =C2=A0 ap_remove_output_filter(f);<br>
+=C2=A0 =C2=A0 =C2=A0 =C2=A0 return ap_pass_brigade(f-&gt;next, bb);<br>
+=C2=A0 =C2=A0 }<br>
+<br>
=C2=A0 =C2=A0 =C2=A0if (!tmp_bb) {<br>
=C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0tmp_bb =3D f-&gt;ctx =3D apr_brigade_crea=
te(f-&gt;r-&gt;pool, f-&gt;c-&gt;bucket_alloc);<br>
=C2=A0 =C2=A0 =C2=A0}<br>
<br>
Modified: httpd/httpd/trunk/server/util_filter.c<br>
URL: <a href=3D"http://svn.apache.org/viewvc/httpd/httpd/trunk/server/util_=
filter.c?rev=3D1707161&amp;r1=3D1707160&amp;r2=3D1707161&amp;view=3Ddiff" r=
el=3D"noreferrer" target=3D"_blank">http://svn.apache.org/viewvc/httpd/http=
d/trunk/server/util_filter.c?rev=3D1707161&amp;r1=3D1707160&amp;r2=3D170716=
1&amp;view=3Ddiff</a><br>
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D<br>
--- httpd/httpd/trunk/server/util_filter.c (original)<br>
+++ httpd/httpd/trunk/server/util_filter.c Tue Oct=C2=A0 6 22:33:03 2015<br=
>
@@ -894,6 +894,14 @@ AP_DECLARE(apr_status_t) ap_filter_reins<br>
=C2=A0AP_DECLARE(int) ap_filter_should_yield(ap_filter_t *f)<br>
=C2=A0{<br>
=C2=A0 =C2=A0 =C2=A0/*<br>
+=C2=A0 =C2=A0 =C2=A0* Handle the AsyncFilter directive. We limit the filte=
rs that are<br>
+=C2=A0 =C2=A0 =C2=A0* eligible for asynchronous handling here.<br>
+=C2=A0 =C2=A0 =C2=A0*/<br>
+=C2=A0 =C2=A0 if (f-&gt;frec-&gt;ftype &lt; f-&gt;c-&gt;async_filter) {<br=
>
+=C2=A0 =C2=A0 =C2=A0 =C2=A0 return 0;<br>
+=C2=A0 =C2=A0 }<br>
+<br>
+=C2=A0 =C2=A0 /*<br>
=C2=A0 =C2=A0 =C2=A0 * This function decides whether a filter should yield =
due to buffered<br>
=C2=A0 =C2=A0 =C2=A0 * data in a downstream filter. If a downstream filter =
buffers we<br>
=C2=A0 =C2=A0 =C2=A0 * must back off so we don&#39;t overwhelm the server. =
If this function<br>
<br>
<br>
</blockquote></div><br><br clear=3D"all"><div><br></div>-- <br><div class=
=3D"gmail_signature"><div dir=3D"ltr">Born in Roswell... married an alien..=
.<br><a href=3D"http://emptyhammock.com/" target=3D"_blank">http://emptyham=
mock.com/</a><div><br></div></div></div>
</div></div>

--001a113f8d44da2462052182d904--

From dev-return-84124-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Wed Oct  7 13:43:13 2015
Return-Path: <dev-return-84124-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 6E6BE17B08
	for <apmail-httpd-dev-archive@www.apache.org>; Wed,  7 Oct 2015 13:43:13 +0000 (UTC)
Received: (qmail 42850 invoked by uid 500); 7 Oct 2015 13:43:13 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 42785 invoked by uid 500); 7 Oct 2015 13:43:13 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 42775 invoked by uid 99); 7 Oct 2015 13:43:12 -0000
Received: from Unknown (HELO spamd4-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 07 Oct 2015 13:43:12 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd4-us-west.apache.org (ASF Mail Server at spamd4-us-west.apache.org) with ESMTP id 9527AC03EF
	for <dev@httpd.apache.org>; Wed,  7 Oct 2015 13:43:12 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd4-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.01
X-Spam-Level:
X-Spam-Status: No, score=-0.01 tagged_above=-999 required=6.31
	tests=[SPF_PASS=-0.001, T_RP_MATCHES_RCVD=-0.01, WEIRD_PORT=0.001]
	autolearn=disabled
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd4-us-west.apache.org [10.40.0.11]) (amavisd-new, port 10024)
	with ESMTP id R0h-5QEXS64v for <dev@httpd.apache.org>;
	Wed,  7 Oct 2015 13:43:11 +0000 (UTC)
Received: from mail.greenbytes.de (mail.greenbytes.de [217.91.35.233])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id 9C15620CB7
	for <dev@httpd.apache.org>; Wed,  7 Oct 2015 13:43:10 +0000 (UTC)
Received: from [192.168.1.42] (unknown [5.10.171.186])
	(using TLSv1 with cipher ECDHE-RSA-AES256-SHA (256/256 bits))
	(Client did not present a certificate)
	by mail.greenbytes.de (Postfix) with ESMTPSA id BC4B515A0448
	for <dev@httpd.apache.org>; Wed,  7 Oct 2015 15:43:03 +0200 (CEST)
From: Stefan Eissing <stefan.eissing@greenbytes.de>
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: quoted-printable
Subject: about those async filters
Message-Id: <114310CC-D227-4912-8651-B3B26F9330C9@greenbytes.de>
Date: Wed, 7 Oct 2015 15:43:03 +0200
To: dev@httpd.apache.org
Mime-Version: 1.0 (Mac OS X Mail 9.0 \(3094\))
X-Mailer: Apple Mail (2.3094)

Having just had time to look at which test cases fail: I see that static =
resources via HTTP/2 seem to work fine, however my tests with a proxy =
and or rewrite in between fail with high likelihood.=20

Any hint at what exactly I might have to look for, any hint about what =
actually has changed, would be appreciated.

//Stefan

PS. My setup on test.example.org:12346 is quite simple =
(https://svn.apache.org/repos/asf/httpd/test/mod_h2/trunk):

    <Location /proxy/>
        ProxyPass https://test.example.org:12346/
        ProxyPassReverse https://test.example.org:12346/
        Order allow,deny
        Allow from all
    </Location>
    RewriteRule /rewrite(.*) https://test.example.org:12346$1 [P]


From dev-return-84125-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Wed Oct  7 13:45:48 2015
Return-Path: <dev-return-84125-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 40AA917B26
	for <apmail-httpd-dev-archive@www.apache.org>; Wed,  7 Oct 2015 13:45:48 +0000 (UTC)
Received: (qmail 52111 invoked by uid 500); 7 Oct 2015 13:45:40 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 52040 invoked by uid 500); 7 Oct 2015 13:45:40 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 52030 invoked by uid 99); 7 Oct 2015 13:45:40 -0000
Received: from Unknown (HELO spamd2-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 07 Oct 2015 13:45:40 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd2-us-west.apache.org (ASF Mail Server at spamd2-us-west.apache.org) with ESMTP id 2A8381A22DE
	for <dev@httpd.apache.org>; Wed,  7 Oct 2015 13:45:40 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd2-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 0.652
X-Spam-Level:
X-Spam-Status: No, score=0.652 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, SPF_NEUTRAL=0.652]
	autolearn=disabled
Authentication-Results: spamd2-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=comcast.net
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd2-us-west.apache.org [10.40.0.9]) (amavisd-new, port 10024)
	with ESMTP id DsQCNXYTgBRr for <dev@httpd.apache.org>;
	Wed,  7 Oct 2015 13:45:33 +0000 (UTC)
Received: from resqmta-ch2-03v.sys.comcast.net (resqmta-ch2-03v.sys.comcast.net [69.252.207.35])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id C1CEA204C9
	for <dev@httpd.apache.org>; Wed,  7 Oct 2015 13:45:32 +0000 (UTC)
Received: from resomta-ch2-12v.sys.comcast.net ([69.252.207.108])
	by resqmta-ch2-03v.sys.comcast.net with comcast
	id SDke1r0022LrikM01DlQqY; Wed, 07 Oct 2015 13:45:24 +0000
Received: from [192.168.199.10] ([69.251.84.114])
	by resomta-ch2-12v.sys.comcast.net with comcast
	id SDlP1r00T2U0RYt01DlQYP; Wed, 07 Oct 2015 13:45:24 +0000
Content-Type: text/plain; charset=us-ascii
Mime-Version: 1.0 (Mac OS X Mail 8.2 \(2104\))
Subject: Re: T&R of 2.4.17 this week
From: Jim Jagielski <jim@jaguNET.com>
In-Reply-To: <9ACC24A9-B381-4C18-B1C4-8D9F62DD7DB5@jaguNET.com>
Date: Wed, 7 Oct 2015 09:45:23 -0400
Content-Transfer-Encoding: 7bit
Message-Id: <063688EF-F9E5-4A26-9636-702601760093@jaguNET.com>
References: <9ACC24A9-B381-4C18-B1C4-8D9F62DD7DB5@jaguNET.com>
To: dev@httpd.apache.org
X-Mailer: Apple Mail (2.2104)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=comcast.net;
	s=q20140121; t=1444225524;
	bh=Y1XCz+M7c+XJH6rlgDOfbnzzJMpkHlZN+d0Ckf4GePA=;
	h=Received:Received:Content-Type:Mime-Version:Subject:From:Date:
	 Message-Id:To;
	b=jf1zSO4l4uCZyDXkBeFiirwz9XErCaJL/HqqCNAppVd08vA528sPkRtb+Ol0nOUNO
	 LSWsZOipWdho40h0tw3V+PErfOfiy+vn8ygAf1GTlr9bONCOLcREBmZ0bXKSJM+4tr
	 0W+mCoEBuvH1hTAO6iUMXOnj+G7w/haUlfXWZbp8GqDy5K5e1vY+yKFkCIA/ne2+2m
	 nk/MdCJU2Asf5PY4m9MnHIBo/KU+P1HrSC0iEM7jLh4L0jWt39Qipx0WH8qeVsbaxD
	 ZdDblTdNSOF6eWJ+/X1guLddq9NhA79Bp7E68WXT4KwTGofWfUA6EgQzTzzhGPVajT
	 4OGbTx46eroLw==

So the plan is to T&R sometime tomorrow, likely
later on in the afternoon, eastern time.

From dev-return-84126-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Wed Oct  7 14:09:18 2015
Return-Path: <dev-return-84126-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id A11AD17C43
	for <apmail-httpd-dev-archive@www.apache.org>; Wed,  7 Oct 2015 14:09:18 +0000 (UTC)
Received: (qmail 19516 invoked by uid 500); 7 Oct 2015 14:09:12 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 19451 invoked by uid 500); 7 Oct 2015 14:09:12 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 19441 invoked by uid 99); 7 Oct 2015 14:09:11 -0000
Received: from Unknown (HELO spamd1-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 07 Oct 2015 14:09:11 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd1-us-west.apache.org (ASF Mail Server at spamd1-us-west.apache.org) with ESMTP id 880D7C41D6
	for <dev@httpd.apache.org>; Wed,  7 Oct 2015 14:09:11 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd1-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.01
X-Spam-Level:
X-Spam-Status: No, score=-0.01 tagged_above=-999 required=6.31
	tests=[SPF_PASS=-0.001, T_RP_MATCHES_RCVD=-0.01, URIBL_BLOCKED=0.001]
	autolearn=disabled
Received: from mx1-us-west.apache.org ([10.40.0.8])
	by localhost (spamd1-us-west.apache.org [10.40.0.7]) (amavisd-new, port 10024)
	with ESMTP id eBPgMtL-X_Uw for <dev@httpd.apache.org>;
	Wed,  7 Oct 2015 14:09:04 +0000 (UTC)
Received: from monica.sharp.fm (monica.sharp.fm [80.168.143.5])
	by mx1-us-west.apache.org (ASF Mail Server at mx1-us-west.apache.org) with ESMTP id AA0F720F7B
	for <dev@httpd.apache.org>; Wed,  7 Oct 2015 14:09:03 +0000 (UTC)
Received: from [10.105.13.216] (unknown [5.56.169.82])
	(using TLSv1 with cipher DHE-RSA-AES256-SHA (256/256 bits))
	(Client did not present a certificate)
	(Authenticated sender: minfrin@sharp.fm)
	by monica.sharp.fm (Postfix) with ESMTPSA id 80082830F8
	for <dev@httpd.apache.org>; Wed,  7 Oct 2015 15:09:02 +0100 (BST)
Content-Type: text/plain; charset=utf-8
Mime-Version: 1.0 (Mac OS X Mail 8.2 \(2104\))
Subject: Re: about those async filters
From: Graham Leggett <minfrin@sharp.fm>
In-Reply-To: <114310CC-D227-4912-8651-B3B26F9330C9@greenbytes.de>
Date: Wed, 7 Oct 2015 16:09:01 +0200
Content-Transfer-Encoding: quoted-printable
Message-Id: <7DCE371B-FFB1-4254-B599-467A7827A991@sharp.fm>
References: <114310CC-D227-4912-8651-B3B26F9330C9@greenbytes.de>
To: dev@httpd.apache.org
X-Mailer: Apple Mail (2.2104)

On 07 Oct 2015, at 3:43 PM, Stefan Eissing =
<stefan.eissing@greenbytes.de> wrote:

> Having just had time to look at which test cases fail: I see that =
static resources via HTTP/2 seem to work fine, however my tests with a =
proxy and or rewrite in between fail with high likelihood.=20
>=20
> Any hint at what exactly I might have to look for, any hint about what =
actually has changed, would be appreciated.

In terms of requests you seem to be doing the right thing. You create a =
request with h2_task_create_request(), which was in turn called from =
h2_task_process_request(), which then calls ap_process_request() which =
handles the request and then passes an EOR bucket down the end of the =
chain.

I think the problems start once the above is done - are you performing =
any sort of manual cleanup of either requests or connections or other =
pools that are parents of connections or pools? If you do you=E2=80=99re =
probably destroying the request before it is finished going over the =
network.

A request is started and you then forget about it, when the core =
processes the EOR bucket the request will disappear on it=E2=80=99s own =
sometime at a future date.

Can you describe how cleanups occur in the http2 world?

Regards,
Graham
=E2=80=94


From dev-return-84127-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Wed Oct  7 14:30:53 2015
Return-Path: <dev-return-84127-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 3D51B17D1E
	for <apmail-httpd-dev-archive@www.apache.org>; Wed,  7 Oct 2015 14:30:53 +0000 (UTC)
Received: (qmail 85663 invoked by uid 500); 7 Oct 2015 14:30:52 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 85593 invoked by uid 500); 7 Oct 2015 14:30:52 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 85583 invoked by uid 99); 7 Oct 2015 14:30:52 -0000
Received: from Unknown (HELO spamd4-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 07 Oct 2015 14:30:52 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd4-us-west.apache.org (ASF Mail Server at spamd4-us-west.apache.org) with ESMTP id 3FB98C028F
	for <dev@httpd.apache.org>; Wed,  7 Oct 2015 14:30:52 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd4-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.01
X-Spam-Level:
X-Spam-Status: No, score=-0.01 tagged_above=-999 required=6.31
	tests=[SPF_PASS=-0.001, T_RP_MATCHES_RCVD=-0.01, URIBL_BLOCKED=0.001]
	autolearn=disabled
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd4-us-west.apache.org [10.40.0.11]) (amavisd-new, port 10024)
	with ESMTP id S-1DpBCTwESW for <dev@httpd.apache.org>;
	Wed,  7 Oct 2015 14:30:42 +0000 (UTC)
Received: from mail.greenbytes.de (mail.greenbytes.de [217.91.35.233])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id 79837439B6
	for <dev@httpd.apache.org>; Wed,  7 Oct 2015 14:30:42 +0000 (UTC)
Received: from [192.168.1.42] (unknown [5.10.171.186])
	(using TLSv1 with cipher ECDHE-RSA-AES256-SHA (256/256 bits))
	(Client did not present a certificate)
	by mail.greenbytes.de (Postfix) with ESMTPSA id 469A415A0473
	for <dev@httpd.apache.org>; Wed,  7 Oct 2015 16:30:35 +0200 (CEST)
Content-Type: text/plain; charset=utf-8
Mime-Version: 1.0 (Mac OS X Mail 9.0 \(3094\))
Subject: Re: about those async filters
From: Stefan Eissing <stefan.eissing@greenbytes.de>
In-Reply-To: <7DCE371B-FFB1-4254-B599-467A7827A991@sharp.fm>
Date: Wed, 7 Oct 2015 16:30:34 +0200
Content-Transfer-Encoding: quoted-printable
Message-Id: <CE2F280D-2036-47C2-B636-A14FB0412DB2@greenbytes.de>
References: <114310CC-D227-4912-8651-B3B26F9330C9@greenbytes.de> <7DCE371B-FFB1-4254-B599-467A7827A991@sharp.fm>
To: dev@httpd.apache.org
X-Mailer: Apple Mail (2.3094)


> Am 07.10.2015 um 16:09 schrieb Graham Leggett <minfrin@sharp.fm>:
>=20
> On 07 Oct 2015, at 3:43 PM, Stefan Eissing =
<stefan.eissing@greenbytes.de> wrote:
>=20
>> Having just had time to look at which test cases fail: I see that =
static resources via HTTP/2 seem to work fine, however my tests with a =
proxy and or rewrite in between fail with high likelihood.=20
>>=20
>> Any hint at what exactly I might have to look for, any hint about =
what actually has changed, would be appreciated.
>=20
> In terms of requests you seem to be doing the right thing. You create =
a request with h2_task_create_request(), which was in turn called from =
h2_task_process_request(), which then calls ap_process_request() which =
handles the request and then passes an EOR bucket down the end of the =
chain.
>=20
> I think the problems start once the above is done - are you performing =
any sort of manual cleanup of either requests or connections or other =
pools that are parents of connections or pools? If you do you=E2=80=99re =
probably destroying the request before it is finished going over the =
network.
>=20
> A request is started and you then forget about it, when the core =
processes the EOR bucket the request will disappear on it=E2=80=99s own =
sometime at a future date.
>=20
> Can you describe how cleanups occur in the http2 world?

In http2 land, the request happen on "pseudo" connections, connections =
properly created by ap_run_create_connection(), but with own filters of =
type AP_FTYPE_PROTOCOL and AP_FTYPE_NETWORK, registered by mod_h2.=20

These filters copy the data (or move the files) across the processing =
filters thread into the h2 multiplexer (h2_mplx) where the master =
connection thread reads it and send it out to the client, properly =
framed for HTTP/2.

Memory wise, master, multiplexer and slave connections have separate =
apr_pool hierarchies, due to multi-threading issues with any other =
attempt to handle it.
- master connection, mpm assigned thread, pool provided by core
- multiplexer, everything protected by mutex, child pools for ever h2 =
stream
- slave connection, child pools of the h2_workers assigned to them

Due to the non-multithreadability of apr_buckets, no buckets are ever =
moved across threads. non-meta buckets are read, meta buckets are =
deleted. That should work fine for EOR buckets, as all data has been =
copied already when they arrive.

One special case is implemented for file buckets. If the number of =
already open files is not "too high", apr_file_setaside() is used to =
have the file handle cleanup registered at the stream pool, no longer at =
the slave connection pool, and a new file bucket is written.

So, data/files can and will live long after the slave connection has =
gone away and all its pools have been reclaimed. This is desired and =
even the ideal case, as stream out a files can be done solely from the =
main connection. This can interleave many streams using only a single =
thread.

Stream pool destruction is synched with=20
1. slave connection being done and no longer writing to it
2. h2 stream having been written out to the client or otherwise being =
closed
Only after 1+2 happened will this memory be reclaimed.

Transient buckets are used heavily on the master connection, as the way =
data buckets are being generated does not suit the coalescing ssl filter =
as it is currently designed. Instead, each master connection has a =
max-size buffer where frames are assembled and properly chunked into =
nicely sized transient buckets for passing down the network filters.

This is h2 bucket/pool handling in a nutshell.

//Stefan



From dev-return-84128-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Wed Oct  7 14:44:21 2015
Return-Path: <dev-return-84128-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 8032517D95
	for <apmail-httpd-dev-archive@www.apache.org>; Wed,  7 Oct 2015 14:44:21 +0000 (UTC)
Received: (qmail 23815 invoked by uid 500); 7 Oct 2015 14:44:21 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 23750 invoked by uid 500); 7 Oct 2015 14:44:21 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 23730 invoked by uid 99); 7 Oct 2015 14:44:21 -0000
Received: from Unknown (HELO spamd4-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 07 Oct 2015 14:44:21 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd4-us-west.apache.org (ASF Mail Server at spamd4-us-west.apache.org) with ESMTP id 94B04C03EF
	for <dev@httpd.apache.org>; Wed,  7 Oct 2015 14:44:20 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd4-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.1
X-Spam-Level:
X-Spam-Status: No, score=-0.1 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RCVD_IN_MSPIKE_H2=-0.001, SPF_PASS=-0.001, URIBL_BLOCKED=0.001,
	WEIRD_PORT=0.001] autolearn=disabled
Authentication-Results: spamd4-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd4-us-west.apache.org [10.40.0.11]) (amavisd-new, port 10024)
	with ESMTP id OE6aeBBEhSIi for <dev@httpd.apache.org>;
	Wed,  7 Oct 2015 14:44:13 +0000 (UTC)
Received: from mail-qk0-f175.google.com (mail-qk0-f175.google.com [209.85.220.175])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id 21C1221247
	for <dev@httpd.apache.org>; Wed,  7 Oct 2015 14:44:13 +0000 (UTC)
Received: by qkbi190 with SMTP id i190so6572045qkb.1
        for <dev@httpd.apache.org>; Wed, 07 Oct 2015 07:44:06 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        bh=u4QJARm6eU5kekySxGV3jgNY/xbZ+zO262aZqV/lnzw=;
        b=R95p4/ydl1WFz8Js3g6iqKSlTuKWpD/RLgAYR70YbDxIJZoPTaykVxpM0kE06mZmbF
         h4FpZXI5iskpKyCBRuCMx2eSC8gpum4iFhG5cya0A2O3K24kAsAEoS5N6lSgUcalRWuj
         3KANB0YS5PWYnX6fsGDwlnstINxnAO7vCono7TIf14YgWmBiENX/wQ2F6OsJSam3BRjF
         iidofRWYlmTMCEItEObuAgweCMfRPLtnTJ9aBscWJug3dZQZQ0v7bDt5aXY/QSCMzYtU
         xED/3q5gLDurfeIXvsW75i+wkAM/CQcy+bM1/nDa8Ebd6vP7Ga1TWIhDePNoBGya7NhT
         3MWw==
MIME-Version: 1.0
X-Received: by 10.55.209.93 with SMTP id s90mr1900902qki.55.1444229046325;
 Wed, 07 Oct 2015 07:44:06 -0700 (PDT)
Received: by 10.55.72.20 with HTTP; Wed, 7 Oct 2015 07:44:06 -0700 (PDT)
In-Reply-To: <114310CC-D227-4912-8651-B3B26F9330C9@greenbytes.de>
References: <114310CC-D227-4912-8651-B3B26F9330C9@greenbytes.de>
Date: Wed, 7 Oct 2015 16:44:06 +0200
Message-ID: <CAKQ1sVMh_yZ698NBCTbpJA94_pWZhkVO=9Sn_jRF2OcaOBsECg@mail.gmail.com>
Subject: Re: about those async filters
From: Yann Ylavic <ylavic.dev@gmail.com>
To: dev@httpd.apache.org
Content-Type: text/plain; charset=UTF-8

Hi Stefan,

On Wed, Oct 7, 2015 at 3:43 PM, Stefan Eissing
<stefan.eissing@greenbytes.de> wrote:
> Having just had time to look at which test cases fail: I see that static resources via HTTP/2 seem to work fine, however my tests with a proxy and or rewrite in between fail with high likelihood.
>
> Any hint at what exactly I might have to look for, any hint about what actually has changed, would be appreciated.

Do you have any error log?

>
> PS. My setup on test.example.org:12346 is quite simple (https://svn.apache.org/repos/asf/httpd/test/mod_h2/trunk):
>
>     <Location /proxy/>
>         ProxyPass https://test.example.org:12346/
>         ProxyPassReverse https://test.example.org:12346/
>         Order allow,deny
>         Allow from all

Order+Allow should be replaced by "Require all granted" in 2.4.

>     </Location>
>     RewriteRule /rewrite(.*) https://test.example.org:12346$1 [P]
>

Regards,
Yann.

From dev-return-84130-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Wed Oct  7 15:57:13 2015
Return-Path: <dev-return-84130-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 1893E180C8
	for <apmail-httpd-dev-archive@www.apache.org>; Wed,  7 Oct 2015 15:57:13 +0000 (UTC)
Received: (qmail 4281 invoked by uid 500); 7 Oct 2015 15:56:08 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 3147 invoked by uid 500); 7 Oct 2015 15:56:06 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 259 invoked by uid 99); 7 Oct 2015 15:53:20 -0000
Received: from Unknown (HELO spamd3-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 07 Oct 2015 15:53:20 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd3-us-west.apache.org (ASF Mail Server at spamd3-us-west.apache.org) with ESMTP id 480EC180E21
	for <dev@httpd.apache.org>; Wed,  7 Oct 2015 15:53:20 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd3-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 0.653
X-Spam-Level:
X-Spam-Status: No, score=0.653 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, SPF_NEUTRAL=0.652,
	URIBL_BLOCKED=0.001] autolearn=disabled
Authentication-Results: spamd3-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=comcast.net
Received: from mx1-us-west.apache.org ([10.40.0.8])
	by localhost (spamd3-us-west.apache.org [10.40.0.10]) (amavisd-new, port 10024)
	with ESMTP id epsZFZulYNDX for <dev@httpd.apache.org>;
	Wed,  7 Oct 2015 15:53:11 +0000 (UTC)
Received: from resqmta-ch2-05v.sys.comcast.net (resqmta-ch2-05v.sys.comcast.net [69.252.207.37])
	by mx1-us-west.apache.org (ASF Mail Server at mx1-us-west.apache.org) with ESMTPS id F317721270
	for <dev@httpd.apache.org>; Wed,  7 Oct 2015 15:53:10 +0000 (UTC)
Received: from resomta-ch2-14v.sys.comcast.net ([69.252.207.110])
	by resqmta-ch2-05v.sys.comcast.net with comcast
	id SFsa1r0032PT3Qt01Ft4Pr; Wed, 07 Oct 2015 15:53:04 +0000
Received: from [192.168.199.10] ([69.251.84.114])
	by resomta-ch2-14v.sys.comcast.net with comcast
	id SFt31r0082U0RYt01Ft3J2; Wed, 07 Oct 2015 15:53:04 +0000
Content-Type: text/plain; charset=utf-8
Mime-Version: 1.0 (Mac OS X Mail 8.2 \(2104\))
Subject: Re: svn commit: r1706275 - /httpd/httpd/trunk/modules/ssl/ssl_engine_io.c
From: Jim Jagielski <jim@jaguNET.com>
In-Reply-To: <A3EC7AE8-B433-4342-8834-C71AE548AD42@sharp.fm>
Date: Wed, 7 Oct 2015 11:53:03 -0400
Content-Transfer-Encoding: quoted-printable
Message-Id: <F3A05E49-3EDA-4DA0-8909-1B5F430641CA@jaguNET.com>
References: <20151001154324.0CBD73A01DC@svn01-us-west.apache.org> <34694C4B-0561-441D-B7DC-6321A1ECE7E5@sharp.fm> <560D79EF.80201@apache.org> <CAKQ1sVPEikOgObBT5uD0VEYUM3a8cOBwEVK690k5JUU2C7UmPA@mail.gmail.com> <AB1691BE05AE7F4992697F2A0835627AC633DE2D@VOEXM10W.internal.vodafone.com> <20151006154400.GA30252@redhat.com> <CAKQ1sVPQYMnmKJCE8FtCetfgzVR5CggULxPM7Mx6iMexYac0RA@mail.gmail.com> <CAKQ1sVOw2jTDgvuXyXcUGCjZwYYOTqpiSAA26Q9cF3=2At-63w@mail.gmail.com> <AB1691BE05AE7F4992697F2A0835627AC633E154@VOEXM10W.internal.vodafone.com> <CAKQ1sVO+v5bz6Z+uv5h3fgYat_1ZztnJuQRmwJzGBxUcRfH+-w@mail.gmail.com> <20151007080438.GA3573@redhat.com> <A3EC7AE8-B433-4342-8834-C71AE548AD42@sharp.fm>
To: dev@httpd.apache.org
X-Mailer: Apple Mail (2.2104)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=comcast.net;
	s=q20140121; t=1444233184;
	bh=YoXo+UjvdqMP8n6gIqf22w2g3SH9M/LPsmWpwqfgX7g=;
	h=Received:Received:Content-Type:Mime-Version:Subject:From:Date:
	 Message-Id:To;
	b=Qb09ti/jmAtY42YF9U90jvQmEGOqoqZtvFst/lOn1cjJWaEh3WTUUMPjrIRoOdSOX
	 jYsoSOMg30aFcVcUVN6C3vobjVHwalPO0gwyGb8RCIFgAjJ9UtLB7JygzOYZ26jMJ5
	 Rnq9Dn4rqFb1FxI4VgfdbL24SCI3S9MI19alW+lRQ2AU8w2wZdLMxxe4DJvrPqge7X
	 rYfutvSpo/eTtYz4JYCP6cUQEVJuJaiGnmVMk8KNZowujssckAjCaioqWEb8jHT9G0
	 wlyqrXRxXxbqA15pXmmqLdsfBAwDAe/e4ZuajZzvlnrIt2MuwsZ09K3lFxpOPb4YvH
	 0tR+bl7OlZHqg==


> On Oct 7, 2015, at 5:17 AM, Graham Leggett <minfrin@sharp.fm> wrote:
>=20
> On 07 Oct 2015, at 10:04 AM, Joe Orton <jorton@redhat.com> wrote:
>=20
>> That's really interesting.  That extra buffering BIO makes sense if=20=

>> OpenSSL is writing to the socket descriptor directly, as with pre-2.x=20=

>> mod_ssl, but doesn't really make sense with 2.x mod_ssl, since the =
core=20
>> output filter is doing that work in the "right" place.
>>=20
>> I guess it doesn't impact performance much because it's =
handshake-time=20
>> only as you say, but still, it would be interesting to try ripping =
that=20
>> out.
>=20
> As I understand we=E2=80=99re using openssl in non blocking mode, =
which means that openssl will ask us permission before attempting any =
read or write.
>=20
> The core will then in turn either read or write as requested by =
openssl based on the =E2=80=9Csense=E2=80=9D flags CONN_SENSE_WANT_READ =
or CONN_SENSE_WANT_WRITE.
>=20
> If openssl has a bug and reads/writes without first asking permission =
we=E2=80=99ll block, but by the same token if openssl as asking us =
permission using SSL_ERROR_WANT_READ or SSL_ERROR_WANT_WRITE and we=E2=80=99=
re ignoring openssl, we=E2=80=99ll block for the same reason.

But certainly these are situations which it's "safer" to block
in any case, right? Of course, they could also be vectors for some
sort of DDoS, but even then, that would be relying on pretty
nasty bugs.=

From dev-return-84131-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Wed Oct  7 15:59:50 2015
Return-Path: <dev-return-84131-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 767D518131
	for <apmail-httpd-dev-archive@www.apache.org>; Wed,  7 Oct 2015 15:59:50 +0000 (UTC)
Received: (qmail 58163 invoked by uid 500); 7 Oct 2015 15:59:43 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 58090 invoked by uid 500); 7 Oct 2015 15:59:43 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 58080 invoked by uid 99); 7 Oct 2015 15:59:43 -0000
Received: from Unknown (HELO spamd2-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 07 Oct 2015 15:59:43 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd2-us-west.apache.org (ASF Mail Server at spamd2-us-west.apache.org) with ESMTP id 419C51A230A
	for <dev@httpd.apache.org>; Wed,  7 Oct 2015 15:59:43 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd2-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.01
X-Spam-Level:
X-Spam-Status: No, score=-0.01 tagged_above=-999 required=6.31
	tests=[SPF_PASS=-0.001, T_RP_MATCHES_RCVD=-0.01, URIBL_BLOCKED=0.001]
	autolearn=disabled
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd2-us-west.apache.org [10.40.0.9]) (amavisd-new, port 10024)
	with ESMTP id 5S7eYtue2RQ0 for <dev@httpd.apache.org>;
	Wed,  7 Oct 2015 15:59:35 +0000 (UTC)
Received: from monica.sharp.fm (monica.sharp.fm [80.168.143.5])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTP id C1BB2204C8
	for <dev@httpd.apache.org>; Wed,  7 Oct 2015 15:59:34 +0000 (UTC)
Received: from [10.105.13.216] (unknown [5.56.169.82])
	(using TLSv1 with cipher DHE-RSA-AES256-SHA (256/256 bits))
	(Client did not present a certificate)
	(Authenticated sender: minfrin@sharp.fm)
	by monica.sharp.fm (Postfix) with ESMTPSA id D67F38314D
	for <dev@httpd.apache.org>; Wed,  7 Oct 2015 16:59:27 +0100 (BST)
Content-Type: text/plain; charset=utf-8
Mime-Version: 1.0 (Mac OS X Mail 8.2 \(2104\))
Subject: Re: svn commit: r1706275 - /httpd/httpd/trunk/modules/ssl/ssl_engine_io.c
From: Graham Leggett <minfrin@sharp.fm>
In-Reply-To: <F3A05E49-3EDA-4DA0-8909-1B5F430641CA@jaguNET.com>
Date: Wed, 7 Oct 2015 17:59:27 +0200
Content-Transfer-Encoding: quoted-printable
Message-Id: <8E7B2A94-C65A-44E5-B343-036D9D30EB37@sharp.fm>
References: <20151001154324.0CBD73A01DC@svn01-us-west.apache.org> <34694C4B-0561-441D-B7DC-6321A1ECE7E5@sharp.fm> <560D79EF.80201@apache.org> <CAKQ1sVPEikOgObBT5uD0VEYUM3a8cOBwEVK690k5JUU2C7UmPA@mail.gmail.com> <AB1691BE05AE7F4992697F2A0835627AC633DE2D@VOEXM10W.internal.vodafone.com> <20151006154400.GA30252@redhat.com> <CAKQ1sVPQYMnmKJCE8FtCetfgzVR5CggULxPM7Mx6iMexYac0RA@mail.gmail.com> <CAKQ1sVOw2jTDgvuXyXcUGCjZwYYOTqpiSAA26Q9cF3=2At-63w@mail.gmail.com> <AB1691BE05AE7F4992697F2A0835627AC633E154@VOEXM10W.internal.vodafone.com> <CAKQ1sVO+v5bz6Z+uv5h3fgYat_1ZztnJuQRmwJzGBxUcRfH+-w@mail.gmail.com> <20151007080438.GA3573@redhat.com> <A3EC7AE8-B433-4342-8834-C71AE548AD42@sharp.fm> <F3A05E49-3EDA-4DA0-8909-1B5F430641CA@jaguNET.com>
To: dev@httpd.apache.org
X-Mailer: Apple Mail (2.2104)

On 07 Oct 2015, at 5:53 PM, Jim Jagielski <jim@jaguNET.com> wrote:

>> As I understand we=E2=80=99re using openssl in non blocking mode, =
which means that openssl will ask us permission before attempting any =
read or write.
>>=20
>> The core will then in turn either read or write as requested by =
openssl based on the =E2=80=9Csense=E2=80=9D flags CONN_SENSE_WANT_READ =
or CONN_SENSE_WANT_WRITE.
>>=20
>> If openssl has a bug and reads/writes without first asking permission =
we=E2=80=99ll block, but by the same token if openssl as asking us =
permission using SSL_ERROR_WANT_READ or SSL_ERROR_WANT_WRITE and we=E2=80=99=
re ignoring openssl, we=E2=80=99ll block for the same reason.
>=20
> But certainly these are situations which it's "safer" to block
> in any case, right? Of course, they could also be vectors for some
> sort of DDoS, but even then, that would be relying on pretty
> nasty bugs.

The blocking isn=E2=80=99t really the problem, it=E2=80=99s accidentally =
waiting for a socket to be readable when openssl asked you to tell it =
when the socket is writable.

I suspect turning on the =E2=80=9Cflush=E2=80=9D is masking a bug.

Regards,
Graham
=E2=80=94


From dev-return-84129-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Wed Oct  7 16:08:19 2015
Return-Path: <dev-return-84129-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 3B85B1819E
	for <apmail-httpd-dev-archive@www.apache.org>; Wed,  7 Oct 2015 16:08:19 +0000 (UTC)
Received: (qmail 3719 invoked by uid 500); 7 Oct 2015 15:56:07 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 2266 invoked by uid 500); 7 Oct 2015 15:56:02 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 454 invoked by uid 99); 7 Oct 2015 15:55:32 -0000
Received: from Unknown (HELO spamd1-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 07 Oct 2015 15:55:32 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd1-us-west.apache.org (ASF Mail Server at spamd1-us-west.apache.org) with ESMTP id 09984C4336
	for <dev@httpd.apache.org>; Wed,  7 Oct 2015 15:55:32 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd1-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.01
X-Spam-Level:
X-Spam-Status: No, score=-0.01 tagged_above=-999 required=6.31
	tests=[SPF_PASS=-0.001, T_RP_MATCHES_RCVD=-0.01, URIBL_BLOCKED=0.001]
	autolearn=disabled
Received: from mx1-us-west.apache.org ([10.40.0.8])
	by localhost (spamd1-us-west.apache.org [10.40.0.7]) (amavisd-new, port 10024)
	with ESMTP id ZZo6n2fFvspp for <dev@httpd.apache.org>;
	Wed,  7 Oct 2015 15:55:24 +0000 (UTC)
Received: from monica.sharp.fm (monica.sharp.fm [80.168.143.5])
	by mx1-us-west.apache.org (ASF Mail Server at mx1-us-west.apache.org) with ESMTP id E0A7B20756
	for <dev@httpd.apache.org>; Wed,  7 Oct 2015 15:55:23 +0000 (UTC)
Received: from [10.105.13.216] (unknown [5.56.169.82])
	(using TLSv1 with cipher DHE-RSA-AES256-SHA (256/256 bits))
	(Client did not present a certificate)
	(Authenticated sender: minfrin@sharp.fm)
	by monica.sharp.fm (Postfix) with ESMTPSA id 0256E8314D
	for <dev@httpd.apache.org>; Wed,  7 Oct 2015 16:55:22 +0100 (BST)
Content-Type: text/plain; charset=utf-8
Mime-Version: 1.0 (Mac OS X Mail 8.2 \(2104\))
Subject: Re: about those async filters
From: Graham Leggett <minfrin@sharp.fm>
In-Reply-To: <CE2F280D-2036-47C2-B636-A14FB0412DB2@greenbytes.de>
Date: Wed, 7 Oct 2015 17:55:21 +0200
Content-Transfer-Encoding: quoted-printable
Message-Id: <E6D87931-6035-46DB-821A-D6D9C6C2A740@sharp.fm>
References: <114310CC-D227-4912-8651-B3B26F9330C9@greenbytes.de> <7DCE371B-FFB1-4254-B599-467A7827A991@sharp.fm> <CE2F280D-2036-47C2-B636-A14FB0412DB2@greenbytes.de>
To: dev@httpd.apache.org
X-Mailer: Apple Mail (2.2104)

On 07 Oct 2015, at 4:30 PM, Stefan Eissing =
<stefan.eissing@greenbytes.de> wrote:

>> Can you describe how cleanups occur in the http2 world?
>=20
> In http2 land, the request happen on "pseudo" connections, connections =
properly created by ap_run_create_connection(), but with own filters of =
type AP_FTYPE_PROTOCOL and AP_FTYPE_NETWORK, registered by mod_h2.=20

In theory, as long as these filters are async, like the network and ssl =
filters are now, the http2 stuff can use write completion and be async =
too.

> These filters copy the data (or move the files) across the processing =
filters thread into the h2 multiplexer (h2_mplx) where the master =
connection thread reads it and send it out to the client, properly =
framed for HTTP/2.
>=20
> Memory wise, master, multiplexer and slave connections have separate =
apr_pool hierarchies, due to multi-threading issues with any other =
attempt to handle it.
> - master connection, mpm assigned thread, pool provided by core
> - multiplexer, everything protected by mutex, child pools for ever h2 =
stream
> - slave connection, child pools of the h2_workers assigned to them
>=20
> Due to the non-multithreadability of apr_buckets, no buckets are ever =
moved across threads. non-meta buckets are read, meta buckets are =
deleted. That should work fine for EOR buckets, as all data has been =
copied already when they arrive.

A key part of the httpd v2.x design was to achieve zero copy - ideally =
we should be using bucket setaside to pass the bucket between pools =
rather than copying the buckets.

Can you explain "non-multithreadability of apr_buckets=E2=80=9D in more =
detail? I take it this is the problem with passing a bucket from one =
allocator to another?

If so then the copy makes more sense.

> One special case is implemented for file buckets. If the number of =
already open files is not "too high", apr_file_setaside() is used to =
have the file handle cleanup registered at the stream pool, no longer at =
the slave connection pool, and a new file bucket is written.
>=20
> So, data/files can and will live long after the slave connection has =
gone away and all its pools have been reclaimed. This is desired and =
even the ideal case, as stream out a files can be done solely from the =
main connection. This can interleave many streams using only a single =
thread.

This is what the various async MPMs do today.

What is attractive about this is releasing expensive backends early =
without them having to stick around waiting for frontends to eventually =
acknowledge a request.

> Stream pool destruction is synched with=20
> 1. slave connection being done and no longer writing to it

How do you currently know the slave connection is done?

Normally a connection is cleaned up by the MPM that spawned the =
connection, I suspect you=E2=80=99ll need to replicate the same logic =
the MPMs use to tear down the connection using the c->aborted and =
c->keepalive flags.

Crucially the slave connection needs to tell you that it=E2=80=99s done. =
If you kill a connection early, data will be lost.

I suspect part of the problem is not implementing the algorithm that =
async MPMs used to kick filters with data in them. Without this kick, =
data in the slave stacks will never be sent. In theory, when the http2 =
filter receives a kick, it should pass the kick on to all slave =
connections.

> 2. h2 stream having been written out to the client or otherwise being =
closed
> Only after 1+2 happened will this memory be reclaimed.

In the case of the h2 stream you probably need to implement the same =
mechanism with c->aborted and c->keepalive so the MPM cleans up the h2 =
stream for you.

You would need to implement cleanups on the slave connections which =
would then mark the master h2 stream for cleanup by the MPM based on =
whether the number of slave connections has reached zero.

> Transient buckets are used heavily on the master connection, as the =
way data buckets are being generated does not suit the coalescing ssl =
filter as it is currently designed. Instead, each master connection has =
a max-size buffer where frames are assembled and properly chunked into =
nicely sized transient buckets for passing down the network filters.
>=20
> This is h2 bucket/pool handling in a nutshell.

Makes sense.

Regards,
Graham
=E2=80=94


From dev-return-84132-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Wed Oct  7 16:23:33 2015
Return-Path: <dev-return-84132-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 7F46F1822E
	for <apmail-httpd-dev-archive@www.apache.org>; Wed,  7 Oct 2015 16:23:33 +0000 (UTC)
Received: (qmail 25880 invoked by uid 500); 7 Oct 2015 16:23:23 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 25811 invoked by uid 500); 7 Oct 2015 16:23:23 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 25801 invoked by uid 99); 7 Oct 2015 16:23:23 -0000
Received: from Unknown (HELO spamd3-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 07 Oct 2015 16:23:23 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd3-us-west.apache.org (ASF Mail Server at spamd3-us-west.apache.org) with ESMTP id 11555180E1A
	for <dev@httpd.apache.org>; Wed,  7 Oct 2015 16:23:23 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd3-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.099
X-Spam-Level:
X-Spam-Status: No, score=-0.099 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	URIBL_BLOCKED=0.001] autolearn=disabled
Authentication-Results: spamd3-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd3-us-west.apache.org [10.40.0.10]) (amavisd-new, port 10024)
	with ESMTP id VF78LvonA89o for <dev@httpd.apache.org>;
	Wed,  7 Oct 2015 16:23:13 +0000 (UTC)
Received: from mail-qg0-f51.google.com (mail-qg0-f51.google.com [209.85.192.51])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id 8A280429AA
	for <dev@httpd.apache.org>; Wed,  7 Oct 2015 16:23:13 +0000 (UTC)
Received: by qgt47 with SMTP id 47so19492495qgt.2
        for <dev@httpd.apache.org>; Wed, 07 Oct 2015 09:23:13 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type:content-transfer-encoding;
        bh=QSwmRH9G0cDBcgO35Fnk+MYHgNBLRhTX5ohH8S3j7Y4=;
        b=OgZLWFiZVc6KHQhmMVZ00rYxqEeLUN9bghLs9utJQZ+w+5wIfF+vf1Mz5MbtKT9dvD
         NFpzOkqDqBDKEiotfJrvNzlYmupZPc0e9DnMIh5wPwIFmjzlflSFazXnYFgGRqyRxAJS
         umjPGi2RvJ3bdtNeR/2ulLIyEIbJKXJwBQbWPlBv2XMJ6yLaQjQrMc+ST6ruQKV+6307
         hJ25aUMUtFiFVbnqEjfTpVtWQ9yijIDQ+k3jH9zTtH4gdcl0J2poUmba0e7S/j2iuQp2
         SViKXsdTSylCge1c0uMZs+lWbLv39GeGi4bxT2QLArtWEFHADgRAFGkz3qq3gzKK4wea
         MVQw==
MIME-Version: 1.0
X-Received: by 10.140.96.99 with SMTP id j90mr2553237qge.92.1444234993223;
 Wed, 07 Oct 2015 09:23:13 -0700 (PDT)
Received: by 10.55.72.20 with HTTP; Wed, 7 Oct 2015 09:23:13 -0700 (PDT)
In-Reply-To: <8E7B2A94-C65A-44E5-B343-036D9D30EB37@sharp.fm>
References: <20151001154324.0CBD73A01DC@svn01-us-west.apache.org>
	<34694C4B-0561-441D-B7DC-6321A1ECE7E5@sharp.fm>
	<560D79EF.80201@apache.org>
	<CAKQ1sVPEikOgObBT5uD0VEYUM3a8cOBwEVK690k5JUU2C7UmPA@mail.gmail.com>
	<AB1691BE05AE7F4992697F2A0835627AC633DE2D@VOEXM10W.internal.vodafone.com>
	<20151006154400.GA30252@redhat.com>
	<CAKQ1sVPQYMnmKJCE8FtCetfgzVR5CggULxPM7Mx6iMexYac0RA@mail.gmail.com>
	<CAKQ1sVOw2jTDgvuXyXcUGCjZwYYOTqpiSAA26Q9cF3=2At-63w@mail.gmail.com>
	<AB1691BE05AE7F4992697F2A0835627AC633E154@VOEXM10W.internal.vodafone.com>
	<CAKQ1sVO+v5bz6Z+uv5h3fgYat_1ZztnJuQRmwJzGBxUcRfH+-w@mail.gmail.com>
	<20151007080438.GA3573@redhat.com>
	<A3EC7AE8-B433-4342-8834-C71AE548AD42@sharp.fm>
	<F3A05E49-3EDA-4DA0-8909-1B5F430641CA@jaguNET.com>
	<8E7B2A94-C65A-44E5-B343-036D9D30EB37@sharp.fm>
Date: Wed, 7 Oct 2015 18:23:13 +0200
Message-ID: <CAKQ1sVP2zM1ZD0uBJk_rL=_ksbAvseuOEHC5hcmsu8AKyX=ygQ@mail.gmail.com>
Subject: Re: svn commit: r1706275 - /httpd/httpd/trunk/modules/ssl/ssl_engine_io.c
From: Yann Ylavic <ylavic.dev@gmail.com>
To: dev@httpd.apache.org
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: quoted-printable

On Wed, Oct 7, 2015 at 5:59 PM, Graham Leggett <minfrin@sharp.fm> wrote:
> On 07 Oct 2015, at 5:53 PM, Jim Jagielski <jim@jaguNET.com> wrote:
>
>>> As I understand we=E2=80=99re using openssl in non blocking mode, which=
 means that openssl will ask us permission before attempting any read or wr=
ite.
>>>
>>> The core will then in turn either read or write as requested by openssl=
 based on the =E2=80=9Csense=E2=80=9D flags CONN_SENSE_WANT_READ or CONN_SE=
NSE_WANT_WRITE.
>>>
>>> If openssl has a bug and reads/writes without first asking permission w=
e=E2=80=99ll block, but by the same token if openssl as asking us permissio=
n using SSL_ERROR_WANT_READ or SSL_ERROR_WANT_WRITE and we=E2=80=99re ignor=
ing openssl, we=E2=80=99ll block for the same reason.
>>
>> But certainly these are situations which it's "safer" to block
>> in any case, right? Of course, they could also be vectors for some
>> sort of DDoS, but even then, that would be relying on pretty
>> nasty bugs.
>
> The blocking isn=E2=80=99t really the problem, it=E2=80=99s accidentally =
waiting for a socket to be readable when openssl asked you to tell it when =
the socket is writable.
>
> I suspect turning on the =E2=80=9Cflush=E2=80=9D is masking a bug.

Are we talking about this particular commit or more generally about
the handling of SSL_ERROR_WANT_READ/WRITE in mod_ssl?

In the former case, the "flush" is not masking but addressing a bug in
openssl, which does not always flush its (handshake) data where it
should...

Also, AFAICT, SSL_ERROR_WANT_READ/WRITE can only happen during
(re)negotiation, it makes sense here to block rather than scheduling
small packet exchanges through the MPM (and maybe let mod_reqtimeout
handle any DOS attempt).

Regards,
Yann.

From dev-return-84133-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Wed Oct  7 16:23:42 2015
Return-Path: <dev-return-84133-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 85FE218233
	for <apmail-httpd-dev-archive@www.apache.org>; Wed,  7 Oct 2015 16:23:42 +0000 (UTC)
Received: (qmail 27017 invoked by uid 500); 7 Oct 2015 16:23:39 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 26945 invoked by uid 500); 7 Oct 2015 16:23:39 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 26933 invoked by uid 99); 7 Oct 2015 16:23:39 -0000
Received: from Unknown (HELO spamd3-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 07 Oct 2015 16:23:39 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd3-us-west.apache.org (ASF Mail Server at spamd3-us-west.apache.org) with ESMTP id 7FC8C180E1A
	for <dev@httpd.apache.org>; Wed,  7 Oct 2015 16:23:38 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd3-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.009
X-Spam-Level:
X-Spam-Status: No, score=-0.009 tagged_above=-999 required=6.31
	tests=[T_RP_MATCHES_RCVD=-0.01, URIBL_BLOCKED=0.001]
	autolearn=disabled
Received: from mx1-us-west.apache.org ([10.40.0.8])
	by localhost (spamd3-us-west.apache.org [10.40.0.10]) (amavisd-new, port 10024)
	with ESMTP id 0Xf3KSat87Kk for <dev@httpd.apache.org>;
	Wed,  7 Oct 2015 16:23:24 +0000 (UTC)
Received: from mail.greenbytes.de (mail.greenbytes.de [217.91.35.233])
	by mx1-us-west.apache.org (ASF Mail Server at mx1-us-west.apache.org) with ESMTPS id B3D7623275
	for <dev@httpd.apache.org>; Wed,  7 Oct 2015 16:23:22 +0000 (UTC)
Received: from [192.168.1.42] (unknown [5.10.171.186])
	(using TLSv1 with cipher ECDHE-RSA-AES256-SHA (256/256 bits))
	(Client did not present a certificate)
	by mail.greenbytes.de (Postfix) with ESMTPSA id 3CD5215A03EB
	for <dev@httpd.apache.org>; Wed,  7 Oct 2015 18:23:13 +0200 (CEST)
Content-Type: text/plain; charset=utf-8
Mime-Version: 1.0 (Mac OS X Mail 9.0 \(3094\))
Subject: Re: about those async filters
From: Stefan Eissing <stefan.eissing@greenbytes.de>
In-Reply-To: <E6D87931-6035-46DB-821A-D6D9C6C2A740@sharp.fm>
Date: Wed, 7 Oct 2015 18:23:12 +0200
Content-Transfer-Encoding: quoted-printable
Message-Id: <65E2281F-145B-4BF8-AAC9-4971B130F014@greenbytes.de>
References: <114310CC-D227-4912-8651-B3B26F9330C9@greenbytes.de> <7DCE371B-FFB1-4254-B599-467A7827A991@sharp.fm> <CE2F280D-2036-47C2-B636-A14FB0412DB2@greenbytes.de> <E6D87931-6035-46DB-821A-D6D9C6C2A740@sharp.fm>
To: dev@httpd.apache.org
X-Mailer: Apple Mail (2.3094)


> Am 07.10.2015 um 17:55 schrieb Graham Leggett <minfrin@sharp.fm>:
>=20
> On 07 Oct 2015, at 4:30 PM, Stefan Eissing =
<stefan.eissing@greenbytes.de> wrote:
>> [...]
>> Due to the non-multithreadability of apr_buckets, no buckets are ever =
moved across threads. non-meta buckets are read, meta buckets are =
deleted. That should work fine for EOR buckets, as all data has been =
copied already when they arrive.
>=20
> A key part of the httpd v2.x design was to achieve zero copy - ideally =
we should be using bucket setaside to pass the bucket between pools =
rather than copying the buckets.
>=20
> Can you explain "non-multithreadability of apr_buckets=E2=80=9D in =
more detail? I take it this is the problem with passing a bucket from =
one allocator to another?
>=20
> If so then the copy makes more sense.

Yes, I wrote about this on the list a while ago. When the bucket is =
destroyed, its allocator tries to put it on the free list. There is no =
protection for that.

>> Stream pool destruction is synched with=20
>> 1. slave connection being done and no longer writing to it
>=20
> How do you currently know the slave connection is done?
>=20
> Normally a connection is cleaned up by the MPM that spawned the =
connection, I suspect you=E2=80=99ll need to replicate the same logic =
the MPMs use to tear down the connection using the c->aborted and =
c->keepalive flags.
>=20
> Crucially the slave connection needs to tell you that it=E2=80=99s =
done. If you kill a connection early, data will be lost.
>=20
> I suspect part of the problem is not implementing the algorithm that =
async MPMs used to kick filters with data in them. Without this kick, =
data in the slave stacks will never be sent. In theory, when the http2 =
filter receives a kick, it should pass the kick on to all slave =
connections.

I am not sure what you mean by that "kick". I'd have to look at your =
async filter design some more...

>> 2. h2 stream having been written out to the client or otherwise being =
closed
>> Only after 1+2 happened will this memory be reclaimed.
>=20
> In the case of the h2 stream you probably need to implement the same =
mechanism with c->aborted and c->keepalive so the MPM cleans up the h2 =
stream for you.
>=20
> You would need to implement cleanups on the slave connections which =
would then mark the master h2 stream for cleanup by the MPM based on =
whether the number of slave connections has reached zero.

I think you misunderstood me. mod_h2 uses ap_process_connection() just =
like core.

Maybe this async changes just shines the light on a bug that has always =
been there, but never happened due to timing. I will look some more =
tomorrow. Originally, I planned to do something else, but I am running =
out of subversion branches where I can work...

//Stefan



From dev-return-84134-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Wed Oct  7 16:26:08 2015
Return-Path: <dev-return-84134-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 5CF531825A
	for <apmail-httpd-dev-archive@www.apache.org>; Wed,  7 Oct 2015 16:26:08 +0000 (UTC)
Received: (qmail 42337 invoked by uid 500); 7 Oct 2015 16:25:58 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 42258 invoked by uid 500); 7 Oct 2015 16:25:58 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 42248 invoked by uid 99); 7 Oct 2015 16:25:58 -0000
Received: from Unknown (HELO spamd4-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 07 Oct 2015 16:25:58 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd4-us-west.apache.org (ASF Mail Server at spamd4-us-west.apache.org) with ESMTP id DE4C4C028F
	for <dev@httpd.apache.org>; Wed,  7 Oct 2015 16:25:57 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd4-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 0.653
X-Spam-Level:
X-Spam-Status: No, score=0.653 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, SPF_NEUTRAL=0.652,
	URIBL_BLOCKED=0.001] autolearn=disabled
Authentication-Results: spamd4-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=comcast.net
Received: from mx1-us-west.apache.org ([10.40.0.8])
	by localhost (spamd4-us-west.apache.org [10.40.0.11]) (amavisd-new, port 10024)
	with ESMTP id nsEOjJ3kLW7e for <dev@httpd.apache.org>;
	Wed,  7 Oct 2015 16:25:47 +0000 (UTC)
Received: from resqmta-ch2-01v.sys.comcast.net (resqmta-ch2-01v.sys.comcast.net [69.252.207.33])
	by mx1-us-west.apache.org (ASF Mail Server at mx1-us-west.apache.org) with ESMTPS id A32DF21270
	for <dev@httpd.apache.org>; Wed,  7 Oct 2015 16:25:47 +0000 (UTC)
Received: from resomta-ch2-01v.sys.comcast.net ([69.252.207.97])
	by resqmta-ch2-01v.sys.comcast.net with comcast
	id SGR81r00826dK1R01GRhDs; Wed, 07 Oct 2015 16:25:41 +0000
Received: from [192.168.199.10] ([69.251.84.114])
	by resomta-ch2-01v.sys.comcast.net with comcast
	id SGRg1r00Z2U0RYt01GRhNk; Wed, 07 Oct 2015 16:25:41 +0000
Content-Type: text/plain; charset=utf-8
Mime-Version: 1.0 (Mac OS X Mail 8.2 \(2104\))
Subject: Re: svn commit: r1706275 - /httpd/httpd/trunk/modules/ssl/ssl_engine_io.c
From: Jim Jagielski <jim@jaguNET.com>
In-Reply-To: <8E7B2A94-C65A-44E5-B343-036D9D30EB37@sharp.fm>
Date: Wed, 7 Oct 2015 12:25:40 -0400
Content-Transfer-Encoding: quoted-printable
Message-Id: <D63B6E43-5D2A-4FE9-8341-2E5498395487@jaguNET.com>
References: <20151001154324.0CBD73A01DC@svn01-us-west.apache.org> <34694C4B-0561-441D-B7DC-6321A1ECE7E5@sharp.fm> <560D79EF.80201@apache.org> <CAKQ1sVPEikOgObBT5uD0VEYUM3a8cOBwEVK690k5JUU2C7UmPA@mail.gmail.com> <AB1691BE05AE7F4992697F2A0835627AC633DE2D@VOEXM10W.internal.vodafone.com> <20151006154400.GA30252@redhat.com> <CAKQ1sVPQYMnmKJCE8FtCetfgzVR5CggULxPM7Mx6iMexYac0RA@mail.gmail.com> <CAKQ1sVOw2jTDgvuXyXcUGCjZwYYOTqpiSAA26Q9cF3=2At-63w@mail.gmail.com> <AB1691BE05AE7F4992697F2A0835627AC633E154@VOEXM10W.internal.vodafone.com> <CAKQ1sVO+v5bz6Z+uv5h3fgYat_1ZztnJuQRmwJzGBxUcRfH+-w@mail.gmail.com> <20151007080438.GA3573@redhat.com> <A3EC7AE8-B433-4342-8834-C71AE548AD42@sharp.fm> <F3A05E49-3EDA-4DA0-8909-1B5F430641CA@jaguNET.com> <8E7B2A94-C65A-44E5-B343-036D9D30EB37@sharp.fm>
To: dev@httpd.apache.org
X-Mailer: Apple Mail (2.2104)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=comcast.net;
	s=q20140121; t=1444235141;
	bh=qnBK8ASkGvQGYlT1mw33/D+V82IFHcJHuQgXCTgFXlY=;
	h=Received:Received:Content-Type:Mime-Version:Subject:From:Date:
	 Message-Id:To;
	b=IZt+EsBasNutUEvp+/9z7c+KzJTx8TRUR1rxOXFw9FaM0Hn+GP4mZU5nXsD0OnbCk
	 xT/IkrHoiQIekgdDFddqixyPR5wRLu7mGVzSDHii/zFF4Ab5JlZFHfhblEPE+tAxk+
	 debV3HEVCemNjBhAHvy5GEf3JqxHSlulU6tnxJCL3fEU+1L++4ez5dVimM1dQxA/ng
	 9oSIc0+aVDGHL+ysyb2PYeZrsstY3VM1iFpoSlGHwG4winIIL2k0/ASSTPxs3fftda
	 xs+BAIM6XD/ajmfO8xP6tIRnQroWisD/vZH13qcZOv81t1fSH4i1tbq7L9Ak+B31/+
	 mXtUssSLJyDww==


> On Oct 7, 2015, at 11:59 AM, Graham Leggett <minfrin@sharp.fm> wrote:
>=20
> On 07 Oct 2015, at 5:53 PM, Jim Jagielski <jim@jaguNET.com> wrote:
>=20
>>> As I understand we=E2=80=99re using openssl in non blocking mode, =
which means that openssl will ask us permission before attempting any =
read or write.
>>>=20
>>> The core will then in turn either read or write as requested by =
openssl based on the =E2=80=9Csense=E2=80=9D flags CONN_SENSE_WANT_READ =
or CONN_SENSE_WANT_WRITE.
>>>=20
>>> If openssl has a bug and reads/writes without first asking =
permission we=E2=80=99ll block, but by the same token if openssl as =
asking us permission using SSL_ERROR_WANT_READ or SSL_ERROR_WANT_WRITE =
and we=E2=80=99re ignoring openssl, we=E2=80=99ll block for the same =
reason.
>>=20
>> But certainly these are situations which it's "safer" to block
>> in any case, right? Of course, they could also be vectors for some
>> sort of DDoS, but even then, that would be relying on pretty
>> nasty bugs.
>=20
> The blocking isn=E2=80=99t really the problem, it=E2=80=99s =
accidentally waiting for a socket to be readable when openssl asked you =
to tell it when the socket is writable.
>=20
> I suspect turning on the =E2=80=9Cflush=E2=80=9D is masking a bug.
>=20

Ah, I see now...

Digging into it a bit, I think your suspicion is correct, but I
can't find it.


From dev-return-84135-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Wed Oct  7 16:47:48 2015
Return-Path: <dev-return-84135-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 2E2581834A
	for <apmail-httpd-dev-archive@www.apache.org>; Wed,  7 Oct 2015 16:47:48 +0000 (UTC)
Received: (qmail 93351 invoked by uid 500); 7 Oct 2015 16:41:08 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 93273 invoked by uid 500); 7 Oct 2015 16:41:08 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 93262 invoked by uid 99); 7 Oct 2015 16:41:08 -0000
Received: from Unknown (HELO spamd2-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 07 Oct 2015 16:41:08 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd2-us-west.apache.org (ASF Mail Server at spamd2-us-west.apache.org) with ESMTP id BD2831A2322
	for <dev@httpd.apache.org>; Wed,  7 Oct 2015 16:41:07 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd2-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.01
X-Spam-Level:
X-Spam-Status: No, score=-0.01 tagged_above=-999 required=6.31
	tests=[SPF_PASS=-0.001, T_RP_MATCHES_RCVD=-0.01, URIBL_BLOCKED=0.001]
	autolearn=disabled
Received: from mx1-us-west.apache.org ([10.40.0.8])
	by localhost (spamd2-us-west.apache.org [10.40.0.9]) (amavisd-new, port 10024)
	with ESMTP id ZW2doPbV5IB8 for <dev@httpd.apache.org>;
	Wed,  7 Oct 2015 16:41:00 +0000 (UTC)
Received: from monica.sharp.fm (monica.sharp.fm [80.168.143.5])
	by mx1-us-west.apache.org (ASF Mail Server at mx1-us-west.apache.org) with ESMTP id A4AC32031C
	for <dev@httpd.apache.org>; Wed,  7 Oct 2015 16:40:59 +0000 (UTC)
Received: from [10.105.13.216] (unknown [5.56.169.82])
	(using TLSv1 with cipher DHE-RSA-AES256-SHA (256/256 bits))
	(Client did not present a certificate)
	(Authenticated sender: minfrin@sharp.fm)
	by monica.sharp.fm (Postfix) with ESMTPSA id 79834830F5
	for <dev@httpd.apache.org>; Wed,  7 Oct 2015 17:40:58 +0100 (BST)
Content-Type: text/plain; charset=utf-8
Mime-Version: 1.0 (Mac OS X Mail 8.2 \(2104\))
Subject: Re: about those async filters
From: Graham Leggett <minfrin@sharp.fm>
In-Reply-To: <65E2281F-145B-4BF8-AAC9-4971B130F014@greenbytes.de>
Date: Wed, 7 Oct 2015 18:40:57 +0200
Content-Transfer-Encoding: quoted-printable
Message-Id: <EEDE992F-2442-463B-ABC5-E44EF5DDEE59@sharp.fm>
References: <114310CC-D227-4912-8651-B3B26F9330C9@greenbytes.de> <7DCE371B-FFB1-4254-B599-467A7827A991@sharp.fm> <CE2F280D-2036-47C2-B636-A14FB0412DB2@greenbytes.de> <E6D87931-6035-46DB-821A-D6D9C6C2A740@sharp.fm> <65E2281F-145B-4BF8-AAC9-4971B130F014@greenbytes.de>
To: dev@httpd.apache.org
X-Mailer: Apple Mail (2.2104)

On 07 Oct 2015, at 6:23 PM, Stefan Eissing =
<stefan.eissing@greenbytes.de> wrote:

>> Can you explain "non-multithreadability of apr_buckets=E2=80=9D in =
more detail? I take it this is the problem with passing a bucket from =
one allocator to another?
>>=20
>> If so then the copy makes more sense.
>=20
> Yes, I wrote about this on the list a while ago. When the bucket is =
destroyed, its allocator tries to put it on the free list. There is no =
protection for that.

It would be nice to fix this for the future, but that would be an APR =
fix.

>=20
>>> Stream pool destruction is synched with=20
>>> 1. slave connection being done and no longer writing to it
>>=20
>> How do you currently know the slave connection is done?
>>=20
>> Normally a connection is cleaned up by the MPM that spawned the =
connection, I suspect you=E2=80=99ll need to replicate the same logic =
the MPMs use to tear down the connection using the c->aborted and =
c->keepalive flags.
>>=20
>> Crucially the slave connection needs to tell you that it=E2=80=99s =
done. If you kill a connection early, data will be lost.
>>=20
>> I suspect part of the problem is not implementing the algorithm that =
async MPMs used to kick filters with data in them. Without this kick, =
data in the slave stacks will never be sent. In theory, when the http2 =
filter receives a kick, it should pass the kick on to all slave =
connections.
>=20
> I am not sure what you mean by that "kick". I'd have to look at your =
async filter design some more=E2=80=A6

What the core network filter used to do was the following:

- Apply an algorithm to determine how far into the brigade we should =
write using blocking writes. Flush buckets and safety limits get applied =
here.
- Actually do the write.
- As soon as the write returns EAGAIN, setaside the brigade in a buffer =
and leave
- The MPM =E2=80=9Ckicks=E2=80=9D the core network filter by passing =
NULL to the filter and we repeat the above

We now do this for any filter:

- Apply the same safety algorithm, determine flush-to point up to which =
we must do blocking write.
- Do writes until we reach the flush-to point.
- Continue to do writes, calling ap_filter_should_yield() as a proxy for =
EAGAIN.
- Setaside remaining data in a buffer and leave, and add us to the set =
of filters that should be =E2=80=9Ckicked=E2=80=9D.
- The MPM =E2=80=9Ckicks=E2=80=9D all filters with setaside data in the =
c->filters set exactly once on each pass and we repeat the above.

Your code is effectively emulating an MPM, so would need to implement =
the =E2=80=9Ckick=E2=80=9D above.

> I think you misunderstood me. mod_h2 uses ap_process_connection() just =
like core.

I found that right at the start and confirmed you were doing so =
correctly.

> Maybe this async changes just shines the light on a bug that has =
always been there, but never happened due to timing. I will look some =
more tomorrow. Originally, I planned to do something else, but I am =
running out of subversion branches where I can work=E2=80=A6

Branches are cheap, creating more of them is not a problem.

Can you confirm what happens when things go wrong?

Do we see missing data, or do the requests hang?

Regards,
Graham
=E2=80=94


From dev-return-84136-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Wed Oct  7 17:47:11 2015
Return-Path: <dev-return-84136-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id CCD01185FA
	for <apmail-httpd-dev-archive@www.apache.org>; Wed,  7 Oct 2015 17:47:11 +0000 (UTC)
Received: (qmail 91553 invoked by uid 500); 7 Oct 2015 17:47:11 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 91473 invoked by uid 500); 7 Oct 2015 17:47:11 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 91463 invoked by uid 99); 7 Oct 2015 17:47:11 -0000
Received: from Unknown (HELO spamd4-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 07 Oct 2015 17:47:11 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd4-us-west.apache.org (ASF Mail Server at spamd4-us-west.apache.org) with ESMTP id E225EC03EF
	for <dev@httpd.apache.org>; Wed,  7 Oct 2015 17:47:10 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd4-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 1
X-Spam-Level: *
X-Spam-Status: No, score=1 tagged_above=-999 required=6.31
	tests=[KAM_LAZY_DOMAIN_SECURITY=1, SPF_HELO_PASS=-0.001,
	URIBL_BLOCKED=0.001] autolearn=disabled
Received: from mx1-us-west.apache.org ([10.40.0.8])
	by localhost (spamd4-us-west.apache.org [10.40.0.11]) (amavisd-new, port 10024)
	with ESMTP id Mpi3_B2Mfhh4 for <dev@httpd.apache.org>;
	Wed,  7 Oct 2015 17:47:00 +0000 (UTC)
Received: from mail1.bemta14.messagelabs.com (mail1.bemta14.messagelabs.com [193.109.254.111])
	by mx1-us-west.apache.org (ASF Mail Server at mx1-us-west.apache.org) with ESMTPS id B88652165B
	for <dev@httpd.apache.org>; Wed,  7 Oct 2015 17:46:59 +0000 (UTC)
Received: from [193.109.255.99] by server-7.bemta-14.messagelabs.com id 7E/E0-28221-C8A55165; Wed, 07 Oct 2015 17:46:52 +0000
X-Env-Sender: ruediger.pluem@vodafone.com
X-Msg-Ref: server-2.tower-48.messagelabs.com!1444240011!598626!1
X-Originating-IP: [195.232.244.133]
X-StarScan-Received:
X-StarScan-Version: 7.19.2; banners=-,-,-
X-VirusChecked: Checked
Received: (qmail 11496 invoked from network); 7 Oct 2015 17:46:52 -0000
Received: from mailout01.vodafone.com (HELO mailout01.vodafone.com) (195.232.244.133)
  by server-2.tower-48.messagelabs.com with AES256-SHA encrypted SMTP; 7 Oct 2015 17:46:52 -0000
Received: from mailint01.vodafone.com (mailint01.vodafone.com [195.232.244.198])
	by mailout01.vodafone.com (Postfix) with ESMTP id 3nWNQM6QF4z1yFx
	for <dev@httpd.apache.org>; Wed,  7 Oct 2015 19:46:51 +0200 (CEST)
Received: from mailint01.vodafone.com (localhost [127.0.0.1])
	by mailint01.vodafone.com (Postfix) with ESMTP id 3nWNQM5QMBzxPp0
	for <dev@httpd.apache.org>; Wed,  7 Oct 2015 19:46:51 +0200 (CEST)
Received: from VOEXC02W.internal.vodafone.com (voexc02w.dc-ratingen.de [145.230.101.22])
	(using TLSv1 with cipher AES128-SHA (128/128 bits))
	(No client certificate requested)
	by mailint01.vodafone.com (Postfix) with ESMTPS id 3nWNQM553KzxPmb
	for <dev@httpd.apache.org>; Wed,  7 Oct 2015 19:46:51 +0200 (CEST)
Received: from VOEXM10W.internal.vodafone.com ([169.254.2.88]) by
 VOEXC02W.internal.vodafone.com ([145.230.101.22]) with mapi id
 14.03.0224.002; Wed, 7 Oct 2015 19:46:50 +0200
From: =?utf-8?B?UGzDvG0sIFLDvGRpZ2VyLCBWb2RhZm9uZSBHcm91cA==?=
	<ruediger.pluem@vodafone.com>
To: "dev@httpd.apache.org" <dev@httpd.apache.org>
Subject: AW: svn commit: r1706275 -
 /httpd/httpd/trunk/modules/ssl/ssl_engine_io.c
Thread-Topic: svn commit: r1706275 -
 /httpd/httpd/trunk/modules/ssl/ssl_engine_io.c
Thread-Index: AQHQ/GqTCIHksBuD+0iVfT9YFPy+jJ5W0fKAgAeUDoCAAClMcP//8fsAgAAEmQCAAAUFAIAASJwQgAAxiwCAAI43AIAAFFcAgABuiYCAAAHJgIAAPWiw
Date: Wed, 7 Oct 2015 17:46:49 +0000
Message-ID: <AB1691BE05AE7F4992697F2A0835627AC633E81B@VOEXM10W.internal.vodafone.com>
References: <20151001154324.0CBD73A01DC@svn01-us-west.apache.org>
 <34694C4B-0561-441D-B7DC-6321A1ECE7E5@sharp.fm> <560D79EF.80201@apache.org>
 <CAKQ1sVPEikOgObBT5uD0VEYUM3a8cOBwEVK690k5JUU2C7UmPA@mail.gmail.com>
 <AB1691BE05AE7F4992697F2A0835627AC633DE2D@VOEXM10W.internal.vodafone.com>
 <20151006154400.GA30252@redhat.com>
 <CAKQ1sVPQYMnmKJCE8FtCetfgzVR5CggULxPM7Mx6iMexYac0RA@mail.gmail.com>
 <CAKQ1sVOw2jTDgvuXyXcUGCjZwYYOTqpiSAA26Q9cF3=2At-63w@mail.gmail.com>
 <AB1691BE05AE7F4992697F2A0835627AC633E154@VOEXM10W.internal.vodafone.com>
 <CAKQ1sVO+v5bz6Z+uv5h3fgYat_1ZztnJuQRmwJzGBxUcRfH+-w@mail.gmail.com>
 <20151007080438.GA3573@redhat.com>
 <A3EC7AE8-B433-4342-8834-C71AE548AD42@sharp.fm>
 <F3A05E49-3EDA-4DA0-8909-1B5F430641CA@jaguNET.com>
 <8E7B2A94-C65A-44E5-B343-036D9D30EB37@sharp.fm>
In-Reply-To: <8E7B2A94-C65A-44E5-B343-036D9D30EB37@sharp.fm>
Accept-Language: en-US
Content-Language: de-DE
X-MS-Has-Attach:
X-MS-TNEF-Correlator:
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
MIME-Version: 1.0

DQoNCj4gLS0tLS1VcnNwcsO8bmdsaWNoZSBOYWNocmljaHQtLS0tLQ0KPiBWb246IEdyYWhhbSBM
ZWdnZXR0IFttYWlsdG86bWluZnJpbkBzaGFycC5mbV0NCj4gR2VzZW5kZXQ6IE1pdHR3b2NoLCA3
LiBPa3RvYmVyIDIwMTUgMTc6NTkNCj4gQW46IGRldkBodHRwZC5hcGFjaGUub3JnDQo+IEJldHJl
ZmY6IFJlOiBzdm4gY29tbWl0OiByMTcwNjI3NSAtDQo+IC9odHRwZC9odHRwZC90cnVuay9tb2R1
bGVzL3NzbC9zc2xfZW5naW5lX2lvLmMNCj4gDQo+IE9uIDA3IE9jdCAyMDE1LCBhdCA1OjUzIFBN
LCBKaW0gSmFnaWVsc2tpIDxqaW1AamFndU5FVC5jb20+IHdyb3RlOg0KPiANCj4gPj4gQXMgSSB1
bmRlcnN0YW5kIHdl4oCZcmUgdXNpbmcgb3BlbnNzbCBpbiBub24gYmxvY2tpbmcgbW9kZSwgd2hp
Y2ggbWVhbnMNCj4gdGhhdCBvcGVuc3NsIHdpbGwgYXNrIHVzIHBlcm1pc3Npb24gYmVmb3JlIGF0
dGVtcHRpbmcgYW55IHJlYWQgb3Igd3JpdGUuDQo+ID4+DQo+ID4+IFRoZSBjb3JlIHdpbGwgdGhl
biBpbiB0dXJuIGVpdGhlciByZWFkIG9yIHdyaXRlIGFzIHJlcXVlc3RlZCBieQ0KPiBvcGVuc3Ns
IGJhc2VkIG9uIHRoZSDigJxzZW5zZeKAnSBmbGFncyBDT05OX1NFTlNFX1dBTlRfUkVBRCBvcg0K
PiBDT05OX1NFTlNFX1dBTlRfV1JJVEUuDQo+ID4+DQo+ID4+IElmIG9wZW5zc2wgaGFzIGEgYnVn
IGFuZCByZWFkcy93cml0ZXMgd2l0aG91dCBmaXJzdCBhc2tpbmcgcGVybWlzc2lvbg0KPiB3ZeKA
mWxsIGJsb2NrLCBidXQgYnkgdGhlIHNhbWUgdG9rZW4gaWYgb3BlbnNzbCBhcyBhc2tpbmcgdXMg
cGVybWlzc2lvbg0KPiB1c2luZyBTU0xfRVJST1JfV0FOVF9SRUFEIG9yIFNTTF9FUlJPUl9XQU5U
X1dSSVRFIGFuZCB3ZeKAmXJlIGlnbm9yaW5nDQo+IG9wZW5zc2wsIHdl4oCZbGwgYmxvY2sgZm9y
IHRoZSBzYW1lIHJlYXNvbi4NCj4gPg0KPiA+IEJ1dCBjZXJ0YWlubHkgdGhlc2UgYXJlIHNpdHVh
dGlvbnMgd2hpY2ggaXQncyAic2FmZXIiIHRvIGJsb2NrDQo+ID4gaW4gYW55IGNhc2UsIHJpZ2h0
PyBPZiBjb3Vyc2UsIHRoZXkgY291bGQgYWxzbyBiZSB2ZWN0b3JzIGZvciBzb21lDQo+ID4gc29y
dCBvZiBERG9TLCBidXQgZXZlbiB0aGVuLCB0aGF0IHdvdWxkIGJlIHJlbHlpbmcgb24gcHJldHR5
DQo+ID4gbmFzdHkgYnVncy4NCj4gDQo+IFRoZSBibG9ja2luZyBpc27igJl0IHJlYWxseSB0aGUg
cHJvYmxlbSwgaXTigJlzIGFjY2lkZW50YWxseSB3YWl0aW5nIGZvciBhDQo+IHNvY2tldCB0byBi
ZSByZWFkYWJsZSB3aGVuIG9wZW5zc2wgYXNrZWQgeW91IHRvIHRlbGwgaXQgd2hlbiB0aGUgc29j
a2V0DQo+IGlzIHdyaXRhYmxlLg0KPiANCj4gSSBzdXNwZWN0IHR1cm5pbmcgb24gdGhlIOKAnGZs
dXNo4oCdIGlzIG1hc2tpbmcgYSBidWcuDQoNCkkgZ3Vlc3Mgd2UgYXJlIHRhbGtpbmcgb2YgZGlm
ZmVyZW50IHRoaW5ncy4gRHVyaW5nIHRoZSBpbml0aWFsIGhhbmRzaGFrZSAoY2xpZW50IG9yIHNl
cnZlcikgd2UgbmV2ZXIgaGFuZCBiYWNrDQpjb250cm9sIHRvIHRoZSBldmVudCBwYXJ0IG9mIHRo
ZSBNUE0uIFdlIG5ldmVyIHVzZSBzc2xfZmlsdGVyX3dyaXRlIGFuZCBzc2xfaW9fZmlsdGVyX291
dHB1dCBhcyB0aGlzIGlzIG9ubHkgdXNlZCBmb3IgZGF0YSB3ZSB3YW50IHRvIGVuY3J5cHQgb24g
dGhlIGNvbm5lY3Rpb24uIER1cmluZyB0aGUgaGFuZHNoYWtlIHdlIGRlYWwgZGlyZWN0bHkgd2l0
aCB0aGUgY29yZSBvdXRwdXQgZmlsdGVyLg0KV2UgYXJlIGp1c3Qgc3luY2hyb25vdXMgaGVyZS4g
QW5kIEkgdGhpbmsgdGhpcyBpcyBub3QgYSBiaWcgZGVhbCBhcyB0aGUgYW1vdW50IG9mIGRhdGEg
dGhhdCBuZWVkcyB0byBiZSB0cmFuc2ZlcnJlZCBoZXJlIGlzIGxvdyBhbmQgYnVmZmVyZWQgYnkg
dGhlIHNvY2tldCBidWZmZXIgYW55d2F5LiBTbyB3ZSB3b3VsZCBub3QgcmVhbGx5IG5vdGljZSB0
aGUgZGlmZmVyZW5jZSBiZXR3ZWVuIHN5bmNocm9ub3VzIGFuZCBhc3luY2hyb25vdXMgc2luY2Ug
dGhlIHNvY2tldCBpcyBub3QgYmxvY2tpbmcgLyBzYXlzIGl0cyB3cml0YWJsZS4NCg0KUmVnYXJk
cw0KDQpSw7xkaWdlcg0KDQo=

From dev-return-84137-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Wed Oct  7 18:45:08 2015
Return-Path: <dev-return-84137-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 78E3118916
	for <apmail-httpd-dev-archive@www.apache.org>; Wed,  7 Oct 2015 18:45:08 +0000 (UTC)
Received: (qmail 75526 invoked by uid 500); 7 Oct 2015 18:45:07 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 75460 invoked by uid 500); 7 Oct 2015 18:45:07 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 75451 invoked by uid 99); 7 Oct 2015 18:45:07 -0000
Received: from mail-relay.apache.org (HELO mail-relay.apache.org) (140.211.11.15)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 07 Oct 2015 18:45:07 +0000
Received: from gauss.localdomain (v4-861345e7.pool.vitroconnect.de [134.19.69.231])
	by mail-relay.apache.org (ASF Mail Server at mail-relay.apache.org) with ESMTPSA id 3B7C41A0163
	for <dev@httpd.apache.org>; Wed,  7 Oct 2015 18:45:06 +0000 (UTC)
Received: from [IPv6:::1] (localhost [IPv6:::1])
	by gauss.localdomain (Postfix) with ESMTP id 9672C431
	for <dev@httpd.apache.org>; Wed,  7 Oct 2015 20:45:07 +0200 (CEST)
Subject: Re: svn commit: r1707159 - /httpd/httpd/trunk/server/eor_bucket.c
To: dev@httpd.apache.org
References: <20151006222324.D6C3B3A0141@svn01-us-west.apache.org>
From: Ruediger Pluem <rpluem@apache.org>
Message-ID: <56156833.3080806@apache.org>
Date: Wed, 7 Oct 2015 20:45:07 +0200
User-Agent: Mozilla/5.0 (X11; Linux i686 on x86_64; rv:41.0) Gecko/20100101
 Firefox/41.0 SeaMonkey/2.38
MIME-Version: 1.0
In-Reply-To: <20151006222324.D6C3B3A0141@svn01-us-west.apache.org>
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 8bit



On 10/07/2015 12:23 AM, ylavic@apache.org wrote:
> Author: ylavic
> Date: Tue Oct  6 22:23:24 2015
> New Revision: 1707159
> 
> URL: http://svn.apache.org/viewvc?rev=1707159&view=rev
> Log:
> eor_bucket: follow up to r1707084: use an inner shared bucket.
> 
> Modified:
>     httpd/httpd/trunk/server/eor_bucket.c
> 
> Modified: httpd/httpd/trunk/server/eor_bucket.c
> URL: http://svn.apache.org/viewvc/httpd/httpd/trunk/server/eor_bucket.c?rev=1707159&r1=1707158&r2=1707159&view=diff
> ==============================================================================
> --- httpd/httpd/trunk/server/eor_bucket.c (original)
> +++ httpd/httpd/trunk/server/eor_bucket.c Tue Oct  6 22:23:24 2015
> @@ -21,15 +21,15 @@
>  
>  static apr_status_t eor_bucket_cleanup(void *data)
>  {
> -    apr_bucket *b = (apr_bucket *)data;
> -    request_rec *r = (request_rec *)b->data;
> +    request_rec **rp = data;
>  
> -    if (r != NULL) {
> +    if (*rp) {
> +        request_rec *r = *rp;
>          /*
>           * If eor_bucket_destroy is called after us, this prevents
>           * eor_bucket_destroy from trying to destroy the pool again.
>           */
> -        b->data = NULL;
> +        *rp = NULL;
>          /* Update child status and log the transaction */
>          ap_update_child_status(r->connection->sbh, SERVER_BUSY_LOG, r);
>          ap_run_log_transaction(r);
> @@ -50,11 +50,13 @@ static apr_status_t eor_bucket_read(apr_
>  
>  AP_DECLARE(apr_bucket *) ap_bucket_eor_make(apr_bucket *b, request_rec *r)
>  {
> -    b->length      = 0;
> -    b->start       = 0;
> -    b->data        = r;
> -    b->type        = &ap_bucket_type_eor;
> +    apr_bucket *h;

IMHO this should be

apr_bucket_refcount *h;


>  
> +    h = apr_bucket_alloc(sizeof(*h), b->list);
> +    h->data = r;
> +
> +    b = apr_bucket_shared_make(b, h, 0, 0);
> +    b->type = &ap_bucket_type_eor;
>      return b;
>  }
>  
> @@ -66,7 +68,9 @@ AP_DECLARE(apr_bucket *) ap_bucket_eor_c
>      APR_BUCKET_INIT(b);
>      b->free = apr_bucket_free;
>      b->list = list;
> +    b = ap_bucket_eor_make(b, r);
>      if (r) {
> +        apr_bucket *h = b->data;
>          /*
>           * Register a cleanup for the request pool as the eor bucket could
>           * have been allocated from a different pool then the request pool
> @@ -76,38 +80,31 @@ AP_DECLARE(apr_bucket *) ap_bucket_eor_c
>           * We need to use a pre-cleanup here because a module may create a
>           * sub-pool which is still needed during the log_transaction hook.
>           */
> -        apr_pool_pre_cleanup_register(r->pool, (void *)b, eor_bucket_cleanup);
> +        apr_pool_pre_cleanup_register(r->pool, &h->data, eor_bucket_cleanup);
>      }
> -    return ap_bucket_eor_make(b, r);
> +    return b;
>  }
>  
>  static void eor_bucket_destroy(void *data)
>  {
> -    request_rec *r = (request_rec *)data;
> +    apr_bucket *h = data;

IMHO this should be

apr_bucket_refcount *h;

Regards

Rüdiger

From dev-return-84138-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Wed Oct  7 19:11:35 2015
Return-Path: <dev-return-84138-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 48B7718AA9
	for <apmail-httpd-dev-archive@www.apache.org>; Wed,  7 Oct 2015 19:11:35 +0000 (UTC)
Received: (qmail 60263 invoked by uid 500); 7 Oct 2015 19:11:01 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 60205 invoked by uid 500); 7 Oct 2015 19:11:00 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 60195 invoked by uid 99); 7 Oct 2015 19:11:00 -0000
Received: from Unknown (HELO spamd3-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 07 Oct 2015 19:11:00 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd3-us-west.apache.org (ASF Mail Server at spamd3-us-west.apache.org) with ESMTP id 7FB63180E21
	for <dev@httpd.apache.org>; Wed,  7 Oct 2015 19:11:00 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd3-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.121
X-Spam-Level:
X-Spam-Status: No, score=-0.121 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RCVD_IN_MSPIKE_H3=-0.01, RCVD_IN_MSPIKE_WL=-0.01, SPF_PASS=-0.001]
	autolearn=disabled
Authentication-Results: spamd3-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd3-us-west.apache.org [10.40.0.10]) (amavisd-new, port 10024)
	with ESMTP id 7Znd10RkuBR7 for <dev@httpd.apache.org>;
	Wed,  7 Oct 2015 19:10:56 +0000 (UTC)
Received: from mail-qk0-f179.google.com (mail-qk0-f179.google.com [209.85.220.179])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id 4F96920CB7
	for <dev@httpd.apache.org>; Wed,  7 Oct 2015 19:10:56 +0000 (UTC)
Received: by qkas79 with SMTP id s79so9848253qka.0
        for <dev@httpd.apache.org>; Wed, 07 Oct 2015 12:10:55 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        bh=gDLOcrRpPps+/Wgm7We63qne3Xn72StadncZD4ypDPw=;
        b=YTZBRZvDKRvfky/CmT2KrusNwsL4yK7q+y9hpj1/4xBik8dPDgnIpD6leiZ0fIfquo
         R+UKjPRPji6Q9XjLEZwQi1iAVzflIzXLkw28mp87BMx3jvxvE5qGP4dZTmW83ppzJzCd
         2Wv3LvfPH6OMIAD2x7cGIqYHKLBciFGYfYAI2wGqjIYR7deXtNPuG2i63hlc0n8uzDsP
         Y2d5xwGPOLFrqJm/bh21L3oeY0wsKfuhAKOAogV7YLg4QCfiCyFwkAw46afW//VRtqdA
         wn+I3xJ3JndlkEKBJXITFeTYhr7MJDwkWlu0REV+tXaWaOANiv3YMT/Mc/IfUmEr11Iw
         0FrQ==
MIME-Version: 1.0
X-Received: by 10.55.192.15 with SMTP id o15mr3627447qki.2.1444245055372; Wed,
 07 Oct 2015 12:10:55 -0700 (PDT)
Received: by 10.55.72.20 with HTTP; Wed, 7 Oct 2015 12:10:55 -0700 (PDT)
In-Reply-To: <56156833.3080806@apache.org>
References: <20151006222324.D6C3B3A0141@svn01-us-west.apache.org>
	<56156833.3080806@apache.org>
Date: Wed, 7 Oct 2015 21:10:55 +0200
Message-ID: <CAKQ1sVPTyDoYDMtC37J3MYm9Rnb8Zr+tNHHzDxBdfEjb7ojUSg@mail.gmail.com>
Subject: Re: svn commit: r1707159 - /httpd/httpd/trunk/server/eor_bucket.c
From: Yann Ylavic <ylavic.dev@gmail.com>
To: dev@httpd.apache.org
Content-Type: text/plain; charset=UTF-8

On Wed, Oct 7, 2015 at 8:45 PM, Ruediger Pluem <rpluem@apache.org> wrote:
>
>
> On 10/07/2015 12:23 AM, ylavic@apache.org wrote:
>>
>>  static void eor_bucket_destroy(void *data)
>>  {
>> -    request_rec *r = (request_rec *)data;
>> +    apr_bucket *h = data;
>
> IMHO this should be
>
> apr_bucket_refcount *h;

Good catch!

Actually, we even need:

typedef struct {
    apr_bucket_refcount refcount;
    request_rec *data;
} apr_bucket_eor;

and use this type everywhere for h.

Thanks,
Yann.

From dev-return-84139-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Wed Oct  7 19:18:16 2015
Return-Path: <dev-return-84139-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id D67CB18B39
	for <apmail-httpd-dev-archive@www.apache.org>; Wed,  7 Oct 2015 19:18:16 +0000 (UTC)
Received: (qmail 79681 invoked by uid 500); 7 Oct 2015 19:18:16 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 79609 invoked by uid 500); 7 Oct 2015 19:18:16 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 79599 invoked by uid 99); 7 Oct 2015 19:18:16 -0000
Received: from Unknown (HELO spamd3-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 07 Oct 2015 19:18:16 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd3-us-west.apache.org (ASF Mail Server at spamd3-us-west.apache.org) with ESMTP id E555F180E0F
	for <dev@httpd.apache.org>; Wed,  7 Oct 2015 19:18:15 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd3-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.102
X-Spam-Level:
X-Spam-Status: No, score=-0.102 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RCVD_IN_MSPIKE_H2=-0.001, SPF_PASS=-0.001] autolearn=disabled
Authentication-Results: spamd3-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd3-us-west.apache.org [10.40.0.10]) (amavisd-new, port 10024)
	with ESMTP id 8BQ6tcaYFUKU for <dev@httpd.apache.org>;
	Wed,  7 Oct 2015 19:18:15 +0000 (UTC)
Received: from mail-qg0-f41.google.com (mail-qg0-f41.google.com [209.85.192.41])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id 33ABC439D0
	for <dev@httpd.apache.org>; Wed,  7 Oct 2015 19:18:15 +0000 (UTC)
Received: by qgx61 with SMTP id 61so23475843qgx.3
        for <dev@httpd.apache.org>; Wed, 07 Oct 2015 12:18:15 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        bh=1kx348TKd+iy3nOblJ+api/igL0RUSuvDEfVycDvHSs=;
        b=waAg9Qh6dgWe0Gle/tcN5D3xsG6h+7uHVSAyRwqT/7E2qPD17Cd/NuYIfL8tUMkpTR
         J1xT4bGy+WeaI9FYd5HAMNH+DrKQNN8ULRxVJfbfW6qXaFt164HZXZINe1bgM2h5VN31
         Qo3xfSggtlxAQMzrbM0D0k9C3ZbEs0xKgggLsfNhpY0G8t8lz64gY5hbAdwIjzPtBwS4
         uGQ6gVJe9GFN3J+AgNGtuchjRhYLr2Vz9x/a7H3zz/QMU3bVB+AtZoLVk4n0p0Af4xl4
         Whf4iZflEjh/SjeumvsL8XOdDdy62I+rnQSy+F44b6gCvRZoQuKN28ePi8Tn6qiiQju4
         h3Ag==
MIME-Version: 1.0
X-Received: by 10.140.237.212 with SMTP id i203mr3719618qhc.97.1444245494968;
 Wed, 07 Oct 2015 12:18:14 -0700 (PDT)
Received: by 10.55.72.20 with HTTP; Wed, 7 Oct 2015 12:18:14 -0700 (PDT)
In-Reply-To: <CAKQ1sVPTyDoYDMtC37J3MYm9Rnb8Zr+tNHHzDxBdfEjb7ojUSg@mail.gmail.com>
References: <20151006222324.D6C3B3A0141@svn01-us-west.apache.org>
	<56156833.3080806@apache.org>
	<CAKQ1sVPTyDoYDMtC37J3MYm9Rnb8Zr+tNHHzDxBdfEjb7ojUSg@mail.gmail.com>
Date: Wed, 7 Oct 2015 21:18:14 +0200
Message-ID: <CAKQ1sVNR-ff1jaPwqPnYUogkBjMEFMD_9GY7PL66MCV+KdAKrA@mail.gmail.com>
Subject: Re: svn commit: r1707159 - /httpd/httpd/trunk/server/eor_bucket.c
From: Yann Ylavic <ylavic.dev@gmail.com>
To: dev@httpd.apache.org
Content-Type: text/plain; charset=UTF-8

On Wed, Oct 7, 2015 at 9:10 PM, Yann Ylavic <ylavic.dev@gmail.com> wrote:
> On Wed, Oct 7, 2015 at 8:45 PM, Ruediger Pluem <rpluem@apache.org> wrote:
>>
>>
>> On 10/07/2015 12:23 AM, ylavic@apache.org wrote:
>>>
>>>  static void eor_bucket_destroy(void *data)
>>>  {
>>> -    request_rec *r = (request_rec *)data;
>>> +    apr_bucket *h = data;
>>
>> IMHO this should be
>>
>> apr_bucket_refcount *h;
>
> Good catch!
>
> Actually, we even need:
>
> typedef struct {
>     apr_bucket_refcount refcount;
>     request_rec *data;
> } apr_bucket_eor;
>
> and use this type everywhere for h.

Commited in r1707362.

>
> Thanks,
> Yann.

From dev-return-84140-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Wed Oct  7 20:32:24 2015
Return-Path: <dev-return-84140-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 43D6618EDC
	for <apmail-httpd-dev-archive@www.apache.org>; Wed,  7 Oct 2015 20:32:24 +0000 (UTC)
Received: (qmail 50008 invoked by uid 500); 7 Oct 2015 20:32:20 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 49913 invoked by uid 500); 7 Oct 2015 20:32:20 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 49903 invoked by uid 99); 7 Oct 2015 20:32:20 -0000
Received: from Unknown (HELO spamd1-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 07 Oct 2015 20:32:20 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd1-us-west.apache.org (ASF Mail Server at spamd1-us-west.apache.org) with ESMTP id 4C52BC433F
	for <dev@httpd.apache.org>; Wed,  7 Oct 2015 20:32:20 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd1-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.01
X-Spam-Level:
X-Spam-Status: No, score=-0.01 tagged_above=-999 required=6.31
	tests=[SPF_PASS=-0.001, T_RP_MATCHES_RCVD=-0.01, URIBL_BLOCKED=0.001]
	autolearn=disabled
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd1-us-west.apache.org [10.40.0.7]) (amavisd-new, port 10024)
	with ESMTP id kxwlXf4TT7r3 for <dev@httpd.apache.org>;
	Wed,  7 Oct 2015 20:32:14 +0000 (UTC)
Received: from monica.sharp.fm (monica.sharp.fm [80.168.143.5])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTP id EF48C42AB6
	for <dev@httpd.apache.org>; Wed,  7 Oct 2015 20:32:13 +0000 (UTC)
Received: from [192.168.220.234] (unknown [192.168.220.234])
	(using TLSv1 with cipher DHE-RSA-AES256-SHA (256/256 bits))
	(Client did not present a certificate)
	(Authenticated sender: minfrin@sharp.fm)
	by monica.sharp.fm (Postfix) with ESMTPSA id 1F33A8314E
	for <dev@httpd.apache.org>; Wed,  7 Oct 2015 21:32:12 +0100 (BST)
Content-Type: text/plain; charset=utf-8
Mime-Version: 1.0 (Mac OS X Mail 8.2 \(2104\))
Subject: Re: svn commit: r1706275 - /httpd/httpd/trunk/modules/ssl/ssl_engine_io.c
From: Graham Leggett <minfrin@sharp.fm>
In-Reply-To: <AB1691BE05AE7F4992697F2A0835627AC633E81B@VOEXM10W.internal.vodafone.com>
Date: Wed, 7 Oct 2015 22:32:10 +0200
Content-Transfer-Encoding: quoted-printable
Message-Id: <20C36B74-E37F-46BF-B7AE-1378ED9BCDD4@sharp.fm>
References: <20151001154324.0CBD73A01DC@svn01-us-west.apache.org> <34694C4B-0561-441D-B7DC-6321A1ECE7E5@sharp.fm> <560D79EF.80201@apache.org> <CAKQ1sVPEikOgObBT5uD0VEYUM3a8cOBwEVK690k5JUU2C7UmPA@mail.gmail.com> <AB1691BE05AE7F4992697F2A0835627AC633DE2D@VOEXM10W.internal.vodafone.com> <20151006154400.GA30252@redhat.com> <CAKQ1sVPQYMnmKJCE8FtCetfgzVR5CggULxPM7Mx6iMexYac0RA@mail.gmail.com> <CAKQ1sVOw2jTDgvuXyXcUGCjZwYYOTqpiSAA26Q9cF3=2At-63w@mail.gmail.com> <AB1691BE05AE7F4992697F2A0835627AC633E154@VOEXM10W.internal.vodafone.com> <CAKQ1sVO+v5bz6Z+uv5h3fgYat_1ZztnJuQRmwJzGBxUcRfH+-w@mail.gmail.com> <20151007080438.GA3573@redhat.com> <A3EC7AE8-B433-4342-8834-C71AE548AD42@sharp.fm> <F3A05E49-3EDA-4DA0-8909-1B5F430641CA@jaguNET.com> <8E7B2A94-C65A-44E5-B343-036D9D30EB37@sharp.fm> <AB1691BE05AE7F4992697F2A0835627AC633E81B@VOEXM10W.internal.vodafone.com>
To: dev@httpd.apache.org
X-Mailer: Apple Mail (2.2104)

On 07 Oct 2015, at 7:46 PM, Pl=C3=BCm, R=C3=BCdiger, Vodafone Group =
<ruediger.pluem@vodafone.com> wrote:

> I guess we are talking of different things. During the initial =
handshake (client or server) we never hand back
> control to the event part of the MPM. We never use ssl_filter_write =
and ssl_io_filter_output as this is only used for data we want to =
encrypt on the connection. During the handshake we deal directly with =
the core output filter.
> We are just synchronous here. And I think this is not a big deal as =
the amount of data that needs to be transferred here is low and buffered =
by the socket buffer anyway. So we would not really notice the =
difference between synchronous and asynchronous since the socket is not =
blocking / says its writable.

This is probably where we=E2=80=99re going wrong.

With mod_ssl non blocking behaviour is an all-or-nothing deal. We must =
follow all of openssl=E2=80=99s instructions to the letter, otherwise =
we=E2=80=99ll hang. We can=E2=80=99t sometimes be synchronous and =
sometimes not. Accidentally waiting to be ready to write when we =
actually need to be waiting to read is easy to get away with, because =
almost always we are ready to write. The opposite however isn=E2=80=99t =
true. If we accidentally wait to be readable when openssl wanted us to =
tell when it=E2=80=99s writable we can very much hang with the client =
not sending anything to trigger that read (why would it, it=E2=80=99s =
expecting to receive something).

Regards,
Graham
=E2=80=94


From dev-return-84141-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Wed Oct  7 22:40:00 2015
Return-Path: <dev-return-84141-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id AEF95176E2
	for <apmail-httpd-dev-archive@www.apache.org>; Wed,  7 Oct 2015 22:40:00 +0000 (UTC)
Received: (qmail 79556 invoked by uid 500); 7 Oct 2015 22:40:00 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 79486 invoked by uid 500); 7 Oct 2015 22:40:00 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 79476 invoked by uid 99); 7 Oct 2015 22:40:00 -0000
Received: from Unknown (HELO spamd3-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 07 Oct 2015 22:40:00 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd3-us-west.apache.org (ASF Mail Server at spamd3-us-west.apache.org) with ESMTP id CD910180DFE
	for <dev@httpd.apache.org>; Wed,  7 Oct 2015 22:39:59 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd3-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 2.899
X-Spam-Level: **
X-Spam-Status: No, score=2.899 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	HTML_MESSAGE=3, MIME_QP_LONG_LINE=0.001, SPF_HELO_PASS=-0.001,
	SPF_PASS=-0.001] autolearn=disabled
Authentication-Results: spamd3-us-west.apache.org (amavisd-new);
	dkim=pass (1024-bit key) header.d=apachelounge.com
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd3-us-west.apache.org [10.40.0.10]) (amavisd-new, port 10024)
	with ESMTP id RvFyE5X9tg7k for <dev@httpd.apache.org>;
	Wed,  7 Oct 2015 22:39:58 +0000 (UTC)
Received: from land10web.com (land10web.com [80.101.236.247])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTP id 42A6142F38
	for <dev@httpd.apache.org>; Wed,  7 Oct 2015 22:39:58 +0000 (UTC)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=apachelounge.com;
	s=default; t=1444257661;
	bh=5pNdafl47tw2uS5ugVDLeRz0s+L170S8l2qbP1C5R8o=;
	h=From:To:Subject:Date;
	b=nzkx61hP3pN4aqvAw1ov2pB1UJrrtxZOrLCHYTxWbFIRuupOHc54XoF5M5xmt+KSl
	 vKcU8ymkhRwTR3kRwpuwOO1+yoXQjCahPWNnjz9UAYclU8SIdQ2IooanzoAKGMsbfC
	 Ru3NwdNivbkSM7caZsnSv9PtAypq9hEY3wIbw5Hw=
X-Default-Received-SPF: pass (skip=forwardok (res=PASS)) x-ip-name=127.0.0.1;
From: Steffen <info@apachelounge.com>
To:  <dev@httpd.apache.org>
Subject: Re: T&R of 2.4.17 this week
Date: Thu, 08 Oct 2015 00:40:51 +0200
Message-ID: <56159f73.568.1970.3a58@land10.nl>
MIME-Version: 1.0
Content-Type: multipart/alternative; boundary="----=_SW_19430_1444257651_mpa="
X-Originating-IP: 127.0.0.1
X-Mailer: SurgeWeb - Ajax Webmail Client

This is a multi-part message in MIME format.

------=_SW_19430_1444257651_mpa=
Content-Type: text/plain; charset=us-ascii; format=flowed


Do we need in LICENSE.txt the license of nghttp2 (MIT) ?

Also missing there libxml2.


On Wednesday 07/10/2015 at 15:46, Jim Jagielski  wrote:
> So the plan is to T&R sometime tomorrow, likely
> later on in the afternoon, eastern time.


------=_SW_19430_1444257651_mpa=
Content-Type: text/html; charset=utf-8
Content-Transfer-Encoding: quoted-printable

<html>
<head>
<style>
 .sw_message P{margin:0px;padding:0px;}
 .sw_message {FONT-SIZE: 12pt;FONT-FAMILY:Tahoma,Arial,Helvetica,sans-serif;background:white;}
 .sw_message blockquote{margin-left:5px;padding-left:5px;border-left:2px solid #144fae;color: #144fae;}
 .sw_message blockquote blockquote{border-left:2px solid #006312;color: #006312;}
 .sw_message blockquote blockquote blockquote{border-left:2px solid #8e5656;color: #8e5656;}
 .sw_message blockquote blockquote blockquote blockquote{border-left:2px solid #888;color: #888;}
</style>
</head>
<body class=3d"sw_message">
<div>Do we need in LICENSE.txt the license of nghttp2 (MIT) ?</div><div><br>=
</div><div>Also missing there libxml2.</div><div>&nbsp;</div><div id=3d"edit=
or_signature"></div><div>On Wednesday 07/10/2015 at 15:46, Jim Jagielski  wr=
ote: </div><blockquote type=3d"cite">So the plan is to T&amp;R sometime tomo=
rrow, likely<br>later on in the afternoon, eastern time.<br></blockquote><br=
> 
</body></html>

------=_SW_19430_1444257651_mpa=--


From dev-return-84142-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Thu Oct  8 10:06:10 2015
Return-Path: <dev-return-84142-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id D2A6D18C0B
	for <apmail-httpd-dev-archive@www.apache.org>; Thu,  8 Oct 2015 10:06:10 +0000 (UTC)
Received: (qmail 29387 invoked by uid 500); 8 Oct 2015 10:06:10 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 29325 invoked by uid 500); 8 Oct 2015 10:06:10 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 29313 invoked by uid 99); 8 Oct 2015 10:06:10 -0000
Received: from Unknown (HELO spamd3-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 08 Oct 2015 10:06:10 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd3-us-west.apache.org (ASF Mail Server at spamd3-us-west.apache.org) with ESMTP id DF6CD180E0D
	for <dev@httpd.apache.org>; Thu,  8 Oct 2015 10:06:09 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd3-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 0.789
X-Spam-Level:
X-Spam-Status: No, score=0.789 tagged_above=-999 required=6.31
	tests=[KAM_ASCII_DIVIDERS=0.8, SPF_PASS=-0.001,
	T_RP_MATCHES_RCVD=-0.01] autolearn=disabled
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd3-us-west.apache.org [10.40.0.10]) (amavisd-new, port 10024)
	with ESMTP id V7p6PCXlDs4v for <dev@httpd.apache.org>;
	Thu,  8 Oct 2015 10:06:06 +0000 (UTC)
Received: from mail.greenbytes.de (mail.greenbytes.de [217.91.35.233])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id 0DE67204D9
	for <dev@httpd.apache.org>; Thu,  8 Oct 2015 10:06:06 +0000 (UTC)
Received: from [192.168.1.42] (unknown [5.10.171.186])
	(using TLSv1 with cipher ECDHE-RSA-AES256-SHA (256/256 bits))
	(Client did not present a certificate)
	by mail.greenbytes.de (Postfix) with ESMTPSA id 620C315A0049
	for <dev@httpd.apache.org>; Thu,  8 Oct 2015 12:06:05 +0200 (CEST)
From: Stefan Eissing <stefan.eissing@greenbytes.de>
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: quoted-printable
Subject: stop the press!
Message-Id: <B3EE8F05-26C7-4B79-B335-B6A431571022@greenbytes.de>
Date: Thu, 8 Oct 2015 12:06:04 +0200
To: dev@httpd.apache.org
Mime-Version: 1.0 (Mac OS X Mail 9.0 \(3094\))
X-Mailer: Apple Mail (2.3094)

I need a tiny patch for mod_http2 that solves an empty response problem =
with the latest nghttp2 libraries:

Jim, can we get that still in? Commited in trunk as r1707468.

//Stefan

Index: modules/http2/h2_util.c
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D
--- modules/http2/h2_util.c	(revision 1707467)
+++ modules/http2/h2_util.c	(revision 1707468)
@@ -484,20 +484,39 @@
=20
 int h2_util_has_eos(apr_bucket_brigade *bb, apr_size_t len)
 {
-    apr_bucket *b, *end;
+    apr_bucket *b;
    =20
-    apr_status_t status =3D last_not_included(bb, len, 0, 0, &end);
-    if (status !=3D APR_SUCCESS) {
-        return status;
+    if (len =3D=3D 0) {
+        /* special case: this is only true, if there are only meta
+         * and an eos bucket in the brigade head.
+         */
+        for (b =3D APR_BRIGADE_FIRST(bb);
+             b !=3D APR_BRIGADE_SENTINEL(bb);
+             b =3D APR_BUCKET_NEXT(b))
+        {
+            if (!APR_BUCKET_IS_METADATA(b) && b->length !=3D 0) {
+                break;
+            }
+            else if (APR_BUCKET_IS_EOS(b)) {
+                return 1;
+            }
+        }
     }
-   =20
-    for (b =3D APR_BRIGADE_FIRST(bb);
-         b !=3D APR_BRIGADE_SENTINEL(bb) && b !=3D end;
-         b =3D APR_BUCKET_NEXT(b))
-    {
-        if (APR_BUCKET_IS_EOS(b)) {
-            return 1;
+    else {
+        apr_bucket *end;
+        apr_status_t status =3D last_not_included(bb, len, 0, 0, &end);
+        if (status !=3D APR_SUCCESS) {
+            return status;
         }
+       =20
+        for (b =3D APR_BRIGADE_FIRST(bb);
+             b !=3D APR_BRIGADE_SENTINEL(bb) && b !=3D end;
+             b =3D APR_BUCKET_NEXT(b))
+        {
+            if (APR_BUCKET_IS_EOS(b)) {
+                return 1;
+            }
+        }
     }
     return 0;
 }
Index: modules/http2/h2_version.h
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D
--- modules/http2/h2_version.h	(revision 1707467)
+++ modules/http2/h2_version.h	(revision 1707468)
@@ -20,7 +20,7 @@
  * @macro
  * Version number of the h2 module as c string
  */
-#define MOD_HTTP2_VERSION "0.9.9"
+#define MOD_HTTP2_VERSION "1.0.0"
=20
 /**
  * @macro
@@ -28,7 +28,7 @@
  * release. This is a 24 bit number with 8 bits for major number, 8 =
bits
  * for minor and 8 bits for patch. Version 1.2.3 becomes 0x010203.
  */
-#define MOD_HTTP2_VERSION_NUM 0x000909
+#define MOD_HTTP2_VERSION_NUM 0x010000
=20
=20
 #endif /* mod_h2_h2_version_h */


From dev-return-84143-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Thu Oct  8 10:10:49 2015
Return-Path: <dev-return-84143-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 837F218C2F
	for <apmail-httpd-dev-archive@www.apache.org>; Thu,  8 Oct 2015 10:10:49 +0000 (UTC)
Received: (qmail 40321 invoked by uid 500); 8 Oct 2015 10:10:46 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 40241 invoked by uid 500); 8 Oct 2015 10:10:46 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 40231 invoked by uid 99); 8 Oct 2015 10:10:45 -0000
Received: from Unknown (HELO spamd2-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 08 Oct 2015 10:10:45 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd2-us-west.apache.org (ASF Mail Server at spamd2-us-west.apache.org) with ESMTP id 2CCE71A24B3
	for <dev@httpd.apache.org>; Thu,  8 Oct 2015 10:10:45 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd2-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.01
X-Spam-Level:
X-Spam-Status: No, score=-0.01 tagged_above=-999 required=6.31
	tests=[SPF_PASS=-0.001, T_RP_MATCHES_RCVD=-0.01, URIBL_BLOCKED=0.001]
	autolearn=disabled
Received: from mx1-us-west.apache.org ([10.40.0.8])
	by localhost (spamd2-us-west.apache.org [10.40.0.9]) (amavisd-new, port 10024)
	with ESMTP id iCtk_vMq9CG0 for <dev@httpd.apache.org>;
	Thu,  8 Oct 2015 10:10:33 +0000 (UTC)
Received: from mail.greenbytes.de (mail.greenbytes.de [217.91.35.233])
	by mx1-us-west.apache.org (ASF Mail Server at mx1-us-west.apache.org) with ESMTPS id E34F120645
	for <dev@httpd.apache.org>; Thu,  8 Oct 2015 10:10:32 +0000 (UTC)
Received: from [192.168.1.42] (unknown [5.10.171.186])
	(using TLSv1 with cipher ECDHE-RSA-AES256-SHA (256/256 bits))
	(Client did not present a certificate)
	by mail.greenbytes.de (Postfix) with ESMTPSA id 1BAFD15A03F4
	for <dev@httpd.apache.org>; Thu,  8 Oct 2015 12:10:31 +0200 (CEST)
Content-Type: text/plain; charset=utf-8
Mime-Version: 1.0 (Mac OS X Mail 9.0 \(3094\))
Subject: Re: about those async filters
From: Stefan Eissing <stefan.eissing@greenbytes.de>
In-Reply-To: <EEDE992F-2442-463B-ABC5-E44EF5DDEE59@sharp.fm>
Date: Thu, 8 Oct 2015 12:10:30 +0200
Content-Transfer-Encoding: quoted-printable
Message-Id: <33E7E984-4F30-4608-A8D1-7B92ECC8B71B@greenbytes.de>
References: <114310CC-D227-4912-8651-B3B26F9330C9@greenbytes.de> <7DCE371B-FFB1-4254-B599-467A7827A991@sharp.fm> <CE2F280D-2036-47C2-B636-A14FB0412DB2@greenbytes.de> <E6D87931-6035-46DB-821A-D6D9C6C2A740@sharp.fm> <65E2281F-145B-4BF8-AAC9-4971B130F014@greenbytes.de> <EEDE992F-2442-463B-ABC5-E44EF5DDEE59@sharp.fm>
To: dev@httpd.apache.org
X-Mailer: Apple Mail (2.3094)

OK, found the bug. Seems an update to the lastest nghttp2 lib co-incided =
with the checkin of your async filter changes. Everything is fine now.=20=


At least I learned some more about core filters, cannot hurt. Thanks for =
the help.

//Stefan

> Am 07.10.2015 um 18:40 schrieb Graham Leggett <minfrin@sharp.fm>:
>=20
> On 07 Oct 2015, at 6:23 PM, Stefan Eissing =
<stefan.eissing@greenbytes.de> wrote:
>=20
>>> Can you explain "non-multithreadability of apr_buckets=E2=80=9D in =
more detail? I take it this is the problem with passing a bucket from =
one allocator to another?
>>>=20
>>> If so then the copy makes more sense.
>>=20
>> Yes, I wrote about this on the list a while ago. When the bucket is =
destroyed, its allocator tries to put it on the free list. There is no =
protection for that.
>=20
> It would be nice to fix this for the future, but that would be an APR =
fix.
>=20
>>=20
>>>> Stream pool destruction is synched with=20
>>>> 1. slave connection being done and no longer writing to it
>>>=20
>>> How do you currently know the slave connection is done?
>>>=20
>>> Normally a connection is cleaned up by the MPM that spawned the =
connection, I suspect you=E2=80=99ll need to replicate the same logic =
the MPMs use to tear down the connection using the c->aborted and =
c->keepalive flags.
>>>=20
>>> Crucially the slave connection needs to tell you that it=E2=80=99s =
done. If you kill a connection early, data will be lost.
>>>=20
>>> I suspect part of the problem is not implementing the algorithm that =
async MPMs used to kick filters with data in them. Without this kick, =
data in the slave stacks will never be sent. In theory, when the http2 =
filter receives a kick, it should pass the kick on to all slave =
connections.
>>=20
>> I am not sure what you mean by that "kick". I'd have to look at your =
async filter design some more=E2=80=A6
>=20
> What the core network filter used to do was the following:
>=20
> - Apply an algorithm to determine how far into the brigade we should =
write using blocking writes. Flush buckets and safety limits get applied =
here.
> - Actually do the write.
> - As soon as the write returns EAGAIN, setaside the brigade in a =
buffer and leave
> - The MPM =E2=80=9Ckicks=E2=80=9D the core network filter by passing =
NULL to the filter and we repeat the above
>=20
> We now do this for any filter:
>=20
> - Apply the same safety algorithm, determine flush-to point up to =
which we must do blocking write.
> - Do writes until we reach the flush-to point.
> - Continue to do writes, calling ap_filter_should_yield() as a proxy =
for EAGAIN.
> - Setaside remaining data in a buffer and leave, and add us to the set =
of filters that should be =E2=80=9Ckicked=E2=80=9D.
> - The MPM =E2=80=9Ckicks=E2=80=9D all filters with setaside data in =
the c->filters set exactly once on each pass and we repeat the above.
>=20
> Your code is effectively emulating an MPM, so would need to implement =
the =E2=80=9Ckick=E2=80=9D above.
>=20
>> I think you misunderstood me. mod_h2 uses ap_process_connection() =
just like core.
>=20
> I found that right at the start and confirmed you were doing so =
correctly.
>=20
>> Maybe this async changes just shines the light on a bug that has =
always been there, but never happened due to timing. I will look some =
more tomorrow. Originally, I planned to do something else, but I am =
running out of subversion branches where I can work=E2=80=A6
>=20
> Branches are cheap, creating more of them is not a problem.
>=20
> Can you confirm what happens when things go wrong?
>=20
> Do we see missing data, or do the requests hang?
>=20
> Regards,
> Graham
> =E2=80=94
>=20


From dev-return-84144-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Thu Oct  8 10:11:31 2015
Return-Path: <dev-return-84144-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 219E118C3D
	for <apmail-httpd-dev-archive@www.apache.org>; Thu,  8 Oct 2015 10:11:31 +0000 (UTC)
Received: (qmail 42184 invoked by uid 500); 8 Oct 2015 10:11:27 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 41819 invoked by uid 500); 8 Oct 2015 10:11:27 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 41679 invoked by uid 99); 8 Oct 2015 10:11:27 -0000
Received: from Unknown (HELO spamd4-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 08 Oct 2015 10:11:27 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd4-us-west.apache.org (ASF Mail Server at spamd4-us-west.apache.org) with ESMTP id C233CC0BDA
	for <dev@httpd.apache.org>; Thu,  8 Oct 2015 10:11:26 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd4-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.801
X-Spam-Level:
X-Spam-Status: No, score=-0.801 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RCVD_IN_DNSWL_LOW=-0.7, RCVD_IN_MSPIKE_H2=-0.001, SPF_PASS=-0.001,
	URIBL_BLOCKED=0.001] autolearn=disabled
Authentication-Results: spamd4-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd4-us-west.apache.org [10.40.0.11]) (amavisd-new, port 10024)
	with ESMTP id On6vuzFZktDY for <dev@httpd.apache.org>;
	Thu,  8 Oct 2015 10:11:26 +0000 (UTC)
Received: from mail-qg0-f53.google.com (mail-qg0-f53.google.com [209.85.192.53])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id 02FFF439B6
	for <dev@httpd.apache.org>; Thu,  8 Oct 2015 10:11:26 +0000 (UTC)
Received: by qgez77 with SMTP id z77so37533062qge.1
        for <dev@httpd.apache.org>; Thu, 08 Oct 2015 03:11:25 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        bh=CEimhibkyTv+Dx/3NW4XTXIs/2JCrtq0lzQXTPrYVAU=;
        b=G+xq2l9DTo4LTbxKXO+7yXyOkA7/1pyBC/D95OB+dvPIIy89fcqhDnntykN/J5WswM
         S/LOPjAshVoxeUPdWku0R6N5KHALHhjiwGIlb4WfNnWP797/POpGDJPvySIjI4O490ju
         /7lGNtxr4TaJu7cC5Yrso1yu71MaMXYCCofJemWOvyBSHPkdHjqkHa+zq6MzoJ5px80F
         TSExAFeDOZPr4tZpDAgLF4aZy2VpWiekrgv9w4TyMrgg0Wtyyo7zx9QTPh6eyk+Sp8fA
         WYIo78fWeyxIfySiTOHpwUXpLxd9kaa7nSfXM338N5gNeZPFJqUowta+KFWONvmPStw6
         HfiQ==
MIME-Version: 1.0
X-Received: by 10.140.131.70 with SMTP id 67mr7679402qhd.70.1444299085677;
 Thu, 08 Oct 2015 03:11:25 -0700 (PDT)
Received: by 10.55.72.20 with HTTP; Thu, 8 Oct 2015 03:11:25 -0700 (PDT)
In-Reply-To: <B3EE8F05-26C7-4B79-B335-B6A431571022@greenbytes.de>
References: <B3EE8F05-26C7-4B79-B335-B6A431571022@greenbytes.de>
Date: Thu, 8 Oct 2015 12:11:25 +0200
Message-ID: <CAKQ1sVM=mO43wPbOo1jtO-h0A3hkd+F8RqvDBEHtT7KQy_Fe0w@mail.gmail.com>
Subject: Re: stop the press!
From: Yann Ylavic <ylavic.dev@gmail.com>
To: dev@httpd.apache.org
Content-Type: text/plain; charset=UTF-8

Hi Stefan,

On Thu, Oct 8, 2015 at 12:06 PM, Stefan Eissing
<stefan.eissing@greenbytes.de> wrote:
>
> Index: modules/http2/h2_util.c
> ===================================================================
> --- modules/http2/h2_util.c     (revision 1707467)
> +++ modules/http2/h2_util.c     (revision 1707468)
> @@ -484,20 +484,39 @@
>
>  int h2_util_has_eos(apr_bucket_brigade *bb, apr_size_t len)
>  {
> -    apr_bucket *b, *end;
> +    apr_bucket *b;
>
> -    apr_status_t status = last_not_included(bb, len, 0, 0, &end);
> -    if (status != APR_SUCCESS) {
> -        return status;
> +    if (len == 0) {
> +        /* special case: this is only true, if there are only meta
> +         * and an eos bucket in the brigade head.
> +         */
> +        for (b = APR_BRIGADE_FIRST(bb);
> +             b != APR_BRIGADE_SENTINEL(bb);
> +             b = APR_BUCKET_NEXT(b))
> +        {
> +            if (!APR_BUCKET_IS_METADATA(b) && b->length != 0) {
> +                break;
> +            }
> +            else if (APR_BUCKET_IS_EOS(b)) {
> +                return 1;
> +            }
> +        }
>      }
> -
> -    for (b = APR_BRIGADE_FIRST(bb);
> -         b != APR_BRIGADE_SENTINEL(bb) && b != end;
> -         b = APR_BUCKET_NEXT(b))
> -    {
> -        if (APR_BUCKET_IS_EOS(b)) {
> -            return 1;
> +    else {
> +        apr_bucket *end;
> +        apr_status_t status = last_not_included(bb, len, 0, 0, &end);
> +        if (status != APR_SUCCESS) {
> +            return status;

Do we want to assume EOS when last_not_included() fails?

>          }
> +
> +        for (b = APR_BRIGADE_FIRST(bb);
> +             b != APR_BRIGADE_SENTINEL(bb) && b != end;
> +             b = APR_BUCKET_NEXT(b))
> +        {
> +            if (APR_BUCKET_IS_EOS(b)) {
> +                return 1;
> +            }
> +        }
>      }
>      return 0;
>  }

Regards,
Yann.

From dev-return-84145-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Thu Oct  8 10:17:04 2015
Return-Path: <dev-return-84145-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id D741018C5E
	for <apmail-httpd-dev-archive@www.apache.org>; Thu,  8 Oct 2015 10:17:04 +0000 (UTC)
Received: (qmail 53146 invoked by uid 500); 8 Oct 2015 10:17:04 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 53083 invoked by uid 500); 8 Oct 2015 10:17:04 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 53073 invoked by uid 99); 8 Oct 2015 10:17:04 -0000
Received: from Unknown (HELO spamd3-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 08 Oct 2015 10:17:04 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd3-us-west.apache.org (ASF Mail Server at spamd3-us-west.apache.org) with ESMTP id CD11D180E04
	for <dev@httpd.apache.org>; Thu,  8 Oct 2015 10:17:03 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd3-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.01
X-Spam-Level:
X-Spam-Status: No, score=-0.01 tagged_above=-999 required=6.31
	tests=[SPF_PASS=-0.001, T_RP_MATCHES_RCVD=-0.01, URIBL_BLOCKED=0.001]
	autolearn=disabled
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd3-us-west.apache.org [10.40.0.10]) (amavisd-new, port 10024)
	with ESMTP id p8QwFWsFV7W2 for <dev@httpd.apache.org>;
	Thu,  8 Oct 2015 10:16:56 +0000 (UTC)
Received: from mail.greenbytes.de (mail.greenbytes.de [217.91.35.233])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id 475E2439EC
	for <dev@httpd.apache.org>; Thu,  8 Oct 2015 10:16:56 +0000 (UTC)
Received: from [192.168.1.42] (unknown [5.10.171.186])
	(using TLSv1 with cipher ECDHE-RSA-AES256-SHA (256/256 bits))
	(Client did not present a certificate)
	by mail.greenbytes.de (Postfix) with ESMTPSA id A14ED15A00DB
	for <dev@httpd.apache.org>; Thu,  8 Oct 2015 12:16:54 +0200 (CEST)
Content-Type: text/plain; charset=us-ascii
Mime-Version: 1.0 (Mac OS X Mail 9.0 \(3094\))
Subject: Re: stop the press!
From: Stefan Eissing <stefan.eissing@greenbytes.de>
In-Reply-To: <CAKQ1sVM=mO43wPbOo1jtO-h0A3hkd+F8RqvDBEHtT7KQy_Fe0w@mail.gmail.com>
Date: Thu, 8 Oct 2015 12:16:54 +0200
Content-Transfer-Encoding: quoted-printable
Message-Id: <8A2CA991-4616-4922-9337-8E63EB08576E@greenbytes.de>
References: <B3EE8F05-26C7-4B79-B335-B6A431571022@greenbytes.de> <CAKQ1sVM=mO43wPbOo1jtO-h0A3hkd+F8RqvDBEHtT7KQy_Fe0w@mail.gmail.com>
To: dev@httpd.apache.org
X-Mailer: Apple Mail (2.3094)

Valid question. The failure can only happen when a bucket of =
indeterminate length fails the read.

I think the prototype of h2_util_has_eos() needs to change to return =
arp_status_t and have an int* for the flag. But that change I do not =
want to do right now for the 2.4.17...

//Stefan

> Am 08.10.2015 um 12:11 schrieb Yann Ylavic <ylavic.dev@gmail.com>:
>=20
> Hi Stefan,
>=20
> On Thu, Oct 8, 2015 at 12:06 PM, Stefan Eissing
> <stefan.eissing@greenbytes.de> wrote:
>>=20
>> Index: modules/http2/h2_util.c
>> =3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D
>> --- modules/http2/h2_util.c     (revision 1707467)
>> +++ modules/http2/h2_util.c     (revision 1707468)
>> @@ -484,20 +484,39 @@
>>=20
>> int h2_util_has_eos(apr_bucket_brigade *bb, apr_size_t len)
>> {
>> -    apr_bucket *b, *end;
>> +    apr_bucket *b;
>>=20
>> -    apr_status_t status =3D last_not_included(bb, len, 0, 0, &end);
>> -    if (status !=3D APR_SUCCESS) {
>> -        return status;
>> +    if (len =3D=3D 0) {
>> +        /* special case: this is only true, if there are only meta
>> +         * and an eos bucket in the brigade head.
>> +         */
>> +        for (b =3D APR_BRIGADE_FIRST(bb);
>> +             b !=3D APR_BRIGADE_SENTINEL(bb);
>> +             b =3D APR_BUCKET_NEXT(b))
>> +        {
>> +            if (!APR_BUCKET_IS_METADATA(b) && b->length !=3D 0) {
>> +                break;
>> +            }
>> +            else if (APR_BUCKET_IS_EOS(b)) {
>> +                return 1;
>> +            }
>> +        }
>>     }
>> -
>> -    for (b =3D APR_BRIGADE_FIRST(bb);
>> -         b !=3D APR_BRIGADE_SENTINEL(bb) && b !=3D end;
>> -         b =3D APR_BUCKET_NEXT(b))
>> -    {
>> -        if (APR_BUCKET_IS_EOS(b)) {
>> -            return 1;
>> +    else {
>> +        apr_bucket *end;
>> +        apr_status_t status =3D last_not_included(bb, len, 0, 0, =
&end);
>> +        if (status !=3D APR_SUCCESS) {
>> +            return status;
>=20
> Do we want to assume EOS when last_not_included() fails?
>=20
>>         }
>> +
>> +        for (b =3D APR_BRIGADE_FIRST(bb);
>> +             b !=3D APR_BRIGADE_SENTINEL(bb) && b !=3D end;
>> +             b =3D APR_BUCKET_NEXT(b))
>> +        {
>> +            if (APR_BUCKET_IS_EOS(b)) {
>> +                return 1;
>> +            }
>> +        }
>>     }
>>     return 0;
>> }
>=20
> Regards,
> Yann.


From dev-return-84146-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Thu Oct  8 10:18:17 2015
Return-Path: <dev-return-84146-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 73B3218C66
	for <apmail-httpd-dev-archive@www.apache.org>; Thu,  8 Oct 2015 10:18:17 +0000 (UTC)
Received: (qmail 58899 invoked by uid 500); 8 Oct 2015 10:18:17 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 58827 invoked by uid 500); 8 Oct 2015 10:18:17 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 58817 invoked by uid 99); 8 Oct 2015 10:18:16 -0000
Received: from Unknown (HELO spamd4-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 08 Oct 2015 10:18:16 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd4-us-west.apache.org (ASF Mail Server at spamd4-us-west.apache.org) with ESMTP id 659E6C0BDA
	for <dev@httpd.apache.org>; Thu,  8 Oct 2015 10:18:16 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd4-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.1
X-Spam-Level:
X-Spam-Status: No, score=-0.1 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RCVD_IN_MSPIKE_H2=-0.001, URIBL_BLOCKED=0.001] autolearn=disabled
Authentication-Results: spamd4-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-us-west.apache.org ([10.40.0.8])
	by localhost (spamd4-us-west.apache.org [10.40.0.11]) (amavisd-new, port 10024)
	with ESMTP id 2DBeFr8OYkW3 for <dev@httpd.apache.org>;
	Thu,  8 Oct 2015 10:18:08 +0000 (UTC)
Received: from mail-qg0-f47.google.com (mail-qg0-f47.google.com [209.85.192.47])
	by mx1-us-west.apache.org (ASF Mail Server at mx1-us-west.apache.org) with ESMTPS id 77D3120562
	for <dev@httpd.apache.org>; Thu,  8 Oct 2015 10:18:08 +0000 (UTC)
Received: by qgev79 with SMTP id v79so37481734qge.0
        for <dev@httpd.apache.org>; Thu, 08 Oct 2015 03:18:02 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        bh=VdXKfDw9ZfgBK1VWddPrlZ2vZ+KC5fPY2THMQT1Fm1U=;
        b=MFTUARfGrjKJoYcDvmtgnsgsoluAAw4m+VEqHrn6BpLN+cvxvexjF6LkgwtunxKOhg
         OG+9LyeJCaxzAnUSYVon6ZQDPjE8ZOxMiew6lXcB98KSlsEeEjU7R8MoZB/n+t1yuHX3
         uTI5VR9eYxdEgTFs9aWsWR0fn08mnBxczmLuZcaaK2o5LKXbFi2kMZaVXCWlnwOr5Ycd
         jr3iOwT1a81HEnATVkCRGfNdL9irPCyDYzsHMVc7SCTr9ZSgkD9TMi+OrY9hlbvxy4X7
         V9WrS1V8ChspqCZF25rBmAH6c9NJAZxzEz35DCFlSwPgghRYwx9JBX2cnhD9Rfq20GAZ
         pKIg==
MIME-Version: 1.0
X-Received: by 10.140.96.99 with SMTP id j90mr6987971qge.92.1444299482519;
 Thu, 08 Oct 2015 03:18:02 -0700 (PDT)
Received: by 10.55.72.20 with HTTP; Thu, 8 Oct 2015 03:18:02 -0700 (PDT)
In-Reply-To: <8A2CA991-4616-4922-9337-8E63EB08576E@greenbytes.de>
References: <B3EE8F05-26C7-4B79-B335-B6A431571022@greenbytes.de>
	<CAKQ1sVM=mO43wPbOo1jtO-h0A3hkd+F8RqvDBEHtT7KQy_Fe0w@mail.gmail.com>
	<8A2CA991-4616-4922-9337-8E63EB08576E@greenbytes.de>
Date: Thu, 8 Oct 2015 12:18:02 +0200
Message-ID: <CAKQ1sVOzfy0rhJs8kW7kM6Yj05tgjjHTVKuKmccKS3h0Wk0r2Q@mail.gmail.com>
Subject: Re: stop the press!
From: Yann Ylavic <ylavic.dev@gmail.com>
To: dev@httpd.apache.org
Content-Type: text/plain; charset=UTF-8

OK, fair enough.

On Thu, Oct 8, 2015 at 12:16 PM, Stefan Eissing
<stefan.eissing@greenbytes.de> wrote:
> Valid question. The failure can only happen when a bucket of indeterminate length fails the read.
>
> I think the prototype of h2_util_has_eos() needs to change to return arp_status_t and have an int* for the flag. But that change I do not want to do right now for the 2.4.17...
>
> //Stefan
>
>> Am 08.10.2015 um 12:11 schrieb Yann Ylavic <ylavic.dev@gmail.com>:
>>
>> Hi Stefan,
>>
>> On Thu, Oct 8, 2015 at 12:06 PM, Stefan Eissing
>> <stefan.eissing@greenbytes.de> wrote:
>>>
>>> Index: modules/http2/h2_util.c
>>> ===================================================================
>>> --- modules/http2/h2_util.c     (revision 1707467)
>>> +++ modules/http2/h2_util.c     (revision 1707468)
>>> @@ -484,20 +484,39 @@
>>>
>>> int h2_util_has_eos(apr_bucket_brigade *bb, apr_size_t len)
>>> {
>>> -    apr_bucket *b, *end;
>>> +    apr_bucket *b;
>>>
>>> -    apr_status_t status = last_not_included(bb, len, 0, 0, &end);
>>> -    if (status != APR_SUCCESS) {
>>> -        return status;
>>> +    if (len == 0) {
>>> +        /* special case: this is only true, if there are only meta
>>> +         * and an eos bucket in the brigade head.
>>> +         */
>>> +        for (b = APR_BRIGADE_FIRST(bb);
>>> +             b != APR_BRIGADE_SENTINEL(bb);
>>> +             b = APR_BUCKET_NEXT(b))
>>> +        {
>>> +            if (!APR_BUCKET_IS_METADATA(b) && b->length != 0) {
>>> +                break;
>>> +            }
>>> +            else if (APR_BUCKET_IS_EOS(b)) {
>>> +                return 1;
>>> +            }
>>> +        }
>>>     }
>>> -
>>> -    for (b = APR_BRIGADE_FIRST(bb);
>>> -         b != APR_BRIGADE_SENTINEL(bb) && b != end;
>>> -         b = APR_BUCKET_NEXT(b))
>>> -    {
>>> -        if (APR_BUCKET_IS_EOS(b)) {
>>> -            return 1;
>>> +    else {
>>> +        apr_bucket *end;
>>> +        apr_status_t status = last_not_included(bb, len, 0, 0, &end);
>>> +        if (status != APR_SUCCESS) {
>>> +            return status;
>>
>> Do we want to assume EOS when last_not_included() fails?
>>
>>>         }
>>> +
>>> +        for (b = APR_BRIGADE_FIRST(bb);
>>> +             b != APR_BRIGADE_SENTINEL(bb) && b != end;
>>> +             b = APR_BUCKET_NEXT(b))
>>> +        {
>>> +            if (APR_BUCKET_IS_EOS(b)) {
>>> +                return 1;
>>> +            }
>>> +        }
>>>     }
>>>     return 0;
>>> }
>>
>> Regards,
>> Yann.
>

From dev-return-84147-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Thu Oct  8 10:30:41 2015
Return-Path: <dev-return-84147-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 8DFAA18CAE
	for <apmail-httpd-dev-archive@www.apache.org>; Thu,  8 Oct 2015 10:30:41 +0000 (UTC)
Received: (qmail 77122 invoked by uid 500); 8 Oct 2015 10:30:41 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 77049 invoked by uid 500); 8 Oct 2015 10:30:41 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 77038 invoked by uid 99); 8 Oct 2015 10:30:41 -0000
Received: from Unknown (HELO spamd3-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 08 Oct 2015 10:30:41 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd3-us-west.apache.org (ASF Mail Server at spamd3-us-west.apache.org) with ESMTP id A8184180E1A
	for <dev@httpd.apache.org>; Thu,  8 Oct 2015 10:30:40 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd3-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.101
X-Spam-Level:
X-Spam-Status: No, score=-0.101 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RCVD_IN_MSPIKE_H2=-0.001, SPF_PASS=-0.001, URIBL_BLOCKED=0.001]
	autolearn=disabled
Authentication-Results: spamd3-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd3-us-west.apache.org [10.40.0.10]) (amavisd-new, port 10024)
	with ESMTP id Jr9gjwMHmh8N for <dev@httpd.apache.org>;
	Thu,  8 Oct 2015 10:30:35 +0000 (UTC)
Received: from mail-qg0-f46.google.com (mail-qg0-f46.google.com [209.85.192.46])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id C7DD042B36
	for <dev@httpd.apache.org>; Thu,  8 Oct 2015 10:30:35 +0000 (UTC)
Received: by qgev79 with SMTP id v79so37670295qge.0
        for <dev@httpd.apache.org>; Thu, 08 Oct 2015 03:30:29 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        bh=YJWDU3gaFCNTYZKZEf+k2sbdmGfwgHJ3YY0AQhcXZuE=;
        b=JrDKaoZGuVd3NrWZ7oMbzHyu8dAD4YQlgkPv7VpM9IMTkSbn6tzCwv+pAtuiDkqYoK
         Or1DVyNXzP4kco83cd8myviBMTIZJB43cvTnsn8pzlkQwN3eI0u4z4J0lrd48AGFP79u
         X1XRYgSGMz/QsMYtoObbRMFqRljOl35dG6d8SIxeRGvSFdZBrb2hknqMY3A/Dfse+m2F
         5CYtOEgL3bKUKdYjYjxJSKWmVuFrckW6uzVaCL7A0NZpKwY1YaovnOPfJCfhi5YBT3NS
         Ui4O6KN6JYwnEE0CcKl1bUdCh/NjfpTA2W2RrBoqB96eu1/bLhrUXxalJ0Xi0G7jcfcF
         PQwg==
MIME-Version: 1.0
X-Received: by 10.140.19.227 with SMTP id 90mr6979256qgh.51.1444300229559;
 Thu, 08 Oct 2015 03:30:29 -0700 (PDT)
Received: by 10.55.72.20 with HTTP; Thu, 8 Oct 2015 03:30:29 -0700 (PDT)
In-Reply-To: <B3EE8F05-26C7-4B79-B335-B6A431571022@greenbytes.de>
References: <B3EE8F05-26C7-4B79-B335-B6A431571022@greenbytes.de>
Date: Thu, 8 Oct 2015 12:30:29 +0200
Message-ID: <CAKQ1sVMThLzUCt03BJ+accZKYrnHmexY4mpwnRyXCXRbA+J-RA@mail.gmail.com>
Subject: Re: stop the press!
From: Yann Ylavic <ylavic.dev@gmail.com>
To: dev@httpd.apache.org
Content-Type: text/plain; charset=UTF-8

On Thu, Oct 8, 2015 at 12:06 PM, Stefan Eissing
<stefan.eissing@greenbytes.de> wrote:
> I need a tiny patch for mod_http2 that solves an empty response problem with the latest nghttp2 libraries:
>
> Jim, can we get that still in? Commited in trunk as r1707468.

I quickly ask (since I did not check all the h2_util_has_eos(bb, 0)
callers paths and you may know that already), what happens to the EOS
bucket it is in the brigade along with other non-empty buckets and
hence the callers consider we are not EOS?
Does it get stripped somehow or the next run will find it?

From dev-return-84148-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Thu Oct  8 10:44:38 2015
Return-Path: <dev-return-84148-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 4166318D0E
	for <apmail-httpd-dev-archive@www.apache.org>; Thu,  8 Oct 2015 10:44:38 +0000 (UTC)
Received: (qmail 5155 invoked by uid 500); 8 Oct 2015 10:44:37 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 5083 invoked by uid 500); 8 Oct 2015 10:44:37 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 5069 invoked by uid 99); 8 Oct 2015 10:44:37 -0000
Received: from Unknown (HELO spamd1-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 08 Oct 2015 10:44:37 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd1-us-west.apache.org (ASF Mail Server at spamd1-us-west.apache.org) with ESMTP id 5EA4BC4A29
	for <dev@httpd.apache.org>; Thu,  8 Oct 2015 10:44:37 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd1-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 1.452
X-Spam-Level: *
X-Spam-Status: No, score=1.452 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, KAM_ASCII_DIVIDERS=0.8,
	SPF_NEUTRAL=0.652] autolearn=disabled
Authentication-Results: spamd1-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=comcast.net
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd1-us-west.apache.org [10.40.0.7]) (amavisd-new, port 10024)
	with ESMTP id ErSbyerEOM7N for <dev@httpd.apache.org>;
	Thu,  8 Oct 2015 10:44:30 +0000 (UTC)
Received: from resqmta-ch2-07v.sys.comcast.net (resqmta-ch2-07v.sys.comcast.net [69.252.207.39])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id CAF1820F9F
	for <dev@httpd.apache.org>; Thu,  8 Oct 2015 10:44:29 +0000 (UTC)
Received: from resomta-ch2-06v.sys.comcast.net ([69.252.207.102])
	by resqmta-ch2-07v.sys.comcast.net with comcast
	id Sak61r0022D5gil01akNLh; Thu, 08 Oct 2015 10:44:22 +0000
Received: from [192.168.199.10] ([69.251.84.114])
	by resomta-ch2-06v.sys.comcast.net with comcast
	id SakM1r00B2U0RYt01akMqP; Thu, 08 Oct 2015 10:44:22 +0000
Content-Type: text/plain; charset=us-ascii
Mime-Version: 1.0 (Mac OS X Mail 8.2 \(2104\))
Subject: Re: svn commit: r1707468 - in /httpd/httpd/trunk/modules/http2: h2_util.c h2_version.h
From: Jim Jagielski <jim@jaguNET.com>
In-Reply-To: <20151008100330.D3AB63A02E5@svn01-us-west.apache.org>
Date: Thu, 8 Oct 2015 06:44:21 -0400
Cc: cvs@httpd.apache.org
Content-Transfer-Encoding: quoted-printable
Message-Id: <6CFC1A2F-1718-41D3-AC78-217469B94482@jaguNET.com>
References: <20151008100330.D3AB63A02E5@svn01-us-west.apache.org>
To: dev@httpd.apache.org
X-Mailer: Apple Mail (2.2104)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=comcast.net;
	s=q20140121; t=1444301062;
	bh=PFWmQM7umGiMcrfpjTsn+5qWfbhHTNvvwIFSw538PU4=;
	h=Received:Received:Content-Type:Mime-Version:Subject:From:Date:
	 Message-Id:To;
	b=qyS3mmC3Yh5r3clDeChmD5ChMhK4xNlMaSpytQHZUAvtzez+DJGhpDLBFQbB8y91s
	 3ZvQGUWL2ZWnsA1+TmFVXC3tiR8J6iRohlr9cLd7KmObxqiZGi/zvb7F1nGyRLCfwl
	 c9G/nwYgVO3SK50F/8nuhK/TL0DwWhVZJBuc0T+t2DQ8UeVb/oIHzxCL7OHryvocw+
	 oe/Yw1ujQEKrlQTAuRbiTI6OU9IXpeP4gH5N3Dr0I9DH6yZ2m3ohXKvl7MNrdJ95qW
	 xezZJmDmOJYPdr6YzkibbUOU6QX4UpDxksHbwcnCzgpad3N6cnvETWGt7MG4F9m5Bm
	 DBxCJ36uB9IQQ==

I am guessing this should be backported to 2.4.17, right?

> On Oct 8, 2015, at 6:03 AM, icing@apache.org wrote:
>=20
> Author: icing
> Date: Thu Oct  8 10:03:30 2015
> New Revision: 1707468
>=20
> URL: http://svn.apache.org/viewvc?rev=3D1707468&view=3Drev
> Log:
> fix for empty responses with nghttp2 v1.3.x, bump version to 1.0.0
>=20
> Modified:
>    httpd/httpd/trunk/modules/http2/h2_util.c
>    httpd/httpd/trunk/modules/http2/h2_version.h
>=20
> Modified: httpd/httpd/trunk/modules/http2/h2_util.c
> URL: =
http://svn.apache.org/viewvc/httpd/httpd/trunk/modules/http2/h2_util.c?rev=
=3D1707468&r1=3D1707467&r2=3D1707468&view=3Ddiff
> =
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
> --- httpd/httpd/trunk/modules/http2/h2_util.c (original)
> +++ httpd/httpd/trunk/modules/http2/h2_util.c Thu Oct  8 10:03:30 2015
> @@ -484,19 +484,38 @@ int h2_util_has_flush_or_eos(apr_bucket_
>=20
> int h2_util_has_eos(apr_bucket_brigade *bb, apr_size_t len)
> {
> -    apr_bucket *b, *end;
> +    apr_bucket *b;
>=20
> -    apr_status_t status =3D last_not_included(bb, len, 0, 0, &end);
> -    if (status !=3D APR_SUCCESS) {
> -        return status;
> +    if (len =3D=3D 0) {
> +        /* special case: this is only true, if there are only meta
> +         * and an eos bucket in the brigade head.
> +         */
> +        for (b =3D APR_BRIGADE_FIRST(bb);
> +             b !=3D APR_BRIGADE_SENTINEL(bb);
> +             b =3D APR_BUCKET_NEXT(b))
> +        {
> +            if (!APR_BUCKET_IS_METADATA(b) && b->length !=3D 0) {
> +                break;
> +            }
> +            else if (APR_BUCKET_IS_EOS(b)) {
> +                return 1;
> +            }
> +        }
>     }
> -   =20
> -    for (b =3D APR_BRIGADE_FIRST(bb);
> -         b !=3D APR_BRIGADE_SENTINEL(bb) && b !=3D end;
> -         b =3D APR_BUCKET_NEXT(b))
> -    {
> -        if (APR_BUCKET_IS_EOS(b)) {
> -            return 1;
> +    else {
> +        apr_bucket *end;
> +        apr_status_t status =3D last_not_included(bb, len, 0, 0, =
&end);
> +        if (status !=3D APR_SUCCESS) {
> +            return status;
> +        }
> +       =20
> +        for (b =3D APR_BRIGADE_FIRST(bb);
> +             b !=3D APR_BRIGADE_SENTINEL(bb) && b !=3D end;
> +             b =3D APR_BUCKET_NEXT(b))
> +        {
> +            if (APR_BUCKET_IS_EOS(b)) {
> +                return 1;
> +            }
>         }
>     }
>     return 0;
>=20
> Modified: httpd/httpd/trunk/modules/http2/h2_version.h
> URL: =
http://svn.apache.org/viewvc/httpd/httpd/trunk/modules/http2/h2_version.h?=
rev=3D1707468&r1=3D1707467&r2=3D1707468&view=3Ddiff
> =
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
> --- httpd/httpd/trunk/modules/http2/h2_version.h (original)
> +++ httpd/httpd/trunk/modules/http2/h2_version.h Thu Oct  8 10:03:30 =
2015
> @@ -20,7 +20,7 @@
>  * @macro
>  * Version number of the h2 module as c string
>  */
> -#define MOD_HTTP2_VERSION "0.9.9"
> +#define MOD_HTTP2_VERSION "1.0.0"
>=20
> /**
>  * @macro
> @@ -28,7 +28,7 @@
>  * release. This is a 24 bit number with 8 bits for major number, 8 =
bits
>  * for minor and 8 bits for patch. Version 1.2.3 becomes 0x010203.
>  */
> -#define MOD_HTTP2_VERSION_NUM 0x000909
> +#define MOD_HTTP2_VERSION_NUM 0x010000
>=20
>=20
> #endif /* mod_h2_h2_version_h */
>=20
>=20


From dev-return-84149-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Thu Oct  8 10:45:05 2015
Return-Path: <dev-return-84149-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 1689418D18
	for <apmail-httpd-dev-archive@www.apache.org>; Thu,  8 Oct 2015 10:45:05 +0000 (UTC)
Received: (qmail 6374 invoked by uid 500); 8 Oct 2015 10:45:01 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 6304 invoked by uid 500); 8 Oct 2015 10:45:01 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 6294 invoked by uid 99); 8 Oct 2015 10:45:01 -0000
Received: from Unknown (HELO spamd4-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 08 Oct 2015 10:45:01 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd4-us-west.apache.org (ASF Mail Server at spamd4-us-west.apache.org) with ESMTP id 37325C0BDA
	for <dev@httpd.apache.org>; Thu,  8 Oct 2015 10:45:01 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd4-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 0.001
X-Spam-Level:
X-Spam-Status: No, score=0.001 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, URIBL_BLOCKED=0.001]
	autolearn=disabled
Authentication-Results: spamd4-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=comcast.net
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd4-us-west.apache.org [10.40.0.11]) (amavisd-new, port 10024)
	with ESMTP id o7qFmx7eLOhQ for <dev@httpd.apache.org>;
	Thu,  8 Oct 2015 10:44:53 +0000 (UTC)
Received: from resqmta-ch2-06v.sys.comcast.net (resqmta-ch2-06v.sys.comcast.net [69.252.207.38])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id 35D59439EC
	for <dev@httpd.apache.org>; Thu,  8 Oct 2015 10:44:53 +0000 (UTC)
Received: from resomta-ch2-06v.sys.comcast.net ([69.252.207.102])
	by resqmta-ch2-06v.sys.comcast.net with comcast
	id Sakj1r0042D5gil01aksZb; Thu, 08 Oct 2015 10:44:52 +0000
Received: from [192.168.199.10] ([69.251.84.114])
	by resomta-ch2-06v.sys.comcast.net with comcast
	id SakM1r00B2U0RYt01akst5; Thu, 08 Oct 2015 10:44:52 +0000
Content-Type: text/plain; charset=us-ascii
Mime-Version: 1.0 (Mac OS X Mail 8.2 \(2104\))
Subject: Re: T&R of 2.4.17 this week
From: Jim Jagielski <jim@jaguNET.com>
In-Reply-To: <56159f73.568.1970.3a58@land10.nl>
Date: Thu, 8 Oct 2015 06:44:52 -0400
Content-Transfer-Encoding: 7bit
Message-Id: <A335AA83-92FD-4580-88ED-B1E37DFB2693@jaguNET.com>
References: <56159f73.568.1970.3a58@land10.nl>
To: dev@httpd.apache.org
X-Mailer: Apple Mail (2.2104)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=comcast.net;
	s=q20140121; t=1444301092;
	bh=Qmk3TFQOO3nMOcIXMsiW4UnmmvrVhBfSibYxERUu3ns=;
	h=Received:Received:Content-Type:Mime-Version:Subject:From:Date:
	 Message-Id:To;
	b=QRHoClCmLJATpDc14LYhWCydBQfUWJJLjEdHiKcnShVUhdzwD0YKkCxde9mvP6l5Z
	 a7boC69b2PuSNWyFVUjnilV8MCDX4l8r+EfAjGt4X2llhEHDTBbU9hatWssMf2NPe4
	 a/Uv1CYqPaRaBK0soX0H4fTP1jx20EN/0QTEv8cU7hTs8Zs2XI9o3IAaJwD5sGr8Jq
	 4H802nviXLiVcLLYiXsIpnYbBegLPuCM+cBusRpwkhqbtam7q4DymsPsdz4ZcKQhRJ
	 QOdpsflePpW2DNJ51cMCagKIOMdiFU0JwUOK3ZsYwuNhoGY1q3CWflXkveM7TgKVfb
	 FFSh4WLdQQdNA==

Since we are not bundling them, we don't.

> On Oct 7, 2015, at 6:40 PM, Steffen <info@apachelounge.com> wrote:
> 
> Do we need in LICENSE.txt the license of nghttp2 (MIT) ?
> 
> Also missing there libxml2.
>  
> On Wednesday 07/10/2015 at 15:46, Jim Jagielski wrote: 
>> So the plan is to T&R sometime tomorrow, likely
>> later on in the afternoon, eastern time.
> 
> 


From dev-return-84150-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Thu Oct  8 10:45:51 2015
Return-Path: <dev-return-84150-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id D160D18D20
	for <apmail-httpd-dev-archive@www.apache.org>; Thu,  8 Oct 2015 10:45:51 +0000 (UTC)
Received: (qmail 8426 invoked by uid 500); 8 Oct 2015 10:45:51 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 8363 invoked by uid 500); 8 Oct 2015 10:45:51 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 8350 invoked by uid 99); 8 Oct 2015 10:45:51 -0000
Received: from Unknown (HELO spamd1-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 08 Oct 2015 10:45:51 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd1-us-west.apache.org (ASF Mail Server at spamd1-us-west.apache.org) with ESMTP id DF40BC4A6D;
	Thu,  8 Oct 2015 10:45:50 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd1-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 0.79
X-Spam-Level:
X-Spam-Status: No, score=0.79 tagged_above=-999 required=6.31
	tests=[KAM_ASCII_DIVIDERS=0.8, SPF_PASS=-0.001,
	T_RP_MATCHES_RCVD=-0.01, URIBL_BLOCKED=0.001] autolearn=disabled
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd1-us-west.apache.org [10.40.0.7]) (amavisd-new, port 10024)
	with ESMTP id iJpC_IdO3AD9; Thu,  8 Oct 2015 10:45:44 +0000 (UTC)
Received: from mail.greenbytes.de (mail.greenbytes.de [217.91.35.233])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id E4DA42827E;
	Thu,  8 Oct 2015 10:45:43 +0000 (UTC)
Received: from [192.168.1.42] (unknown [5.10.171.186])
	(using TLSv1 with cipher ECDHE-RSA-AES256-SHA (256/256 bits))
	(Client did not present a certificate)
	by mail.greenbytes.de (Postfix) with ESMTPSA id 4DCC715A00A5;
	Thu,  8 Oct 2015 12:45:43 +0200 (CEST)
Content-Type: text/plain; charset=us-ascii
Mime-Version: 1.0 (Mac OS X Mail 9.0 \(3094\))
Subject: Re: svn commit: r1707468 - in /httpd/httpd/trunk/modules/http2: h2_util.c h2_version.h
From: Stefan Eissing <stefan.eissing@greenbytes.de>
In-Reply-To: <6CFC1A2F-1718-41D3-AC78-217469B94482@jaguNET.com>
Date: Thu, 8 Oct 2015 12:45:42 +0200
Cc: cvs@httpd.apache.org
Content-Transfer-Encoding: quoted-printable
Message-Id: <8F861099-8CCF-4223-84EB-846091A30B02@greenbytes.de>
References: <20151008100330.D3AB63A02E5@svn01-us-west.apache.org> <6CFC1A2F-1718-41D3-AC78-217469B94482@jaguNET.com>
To: dev@httpd.apache.org
X-Mailer: Apple Mail (2.3094)

Jim, give me a moment. Yann's code reviewing skill are just too good...

//Stefan

> Am 08.10.2015 um 12:44 schrieb Jim Jagielski <jim@jaguNET.com>:
>=20
> I am guessing this should be backported to 2.4.17, right?
>=20
>> On Oct 8, 2015, at 6:03 AM, icing@apache.org wrote:
>>=20
>> Author: icing
>> Date: Thu Oct  8 10:03:30 2015
>> New Revision: 1707468
>>=20
>> URL: http://svn.apache.org/viewvc?rev=3D1707468&view=3Drev
>> Log:
>> fix for empty responses with nghttp2 v1.3.x, bump version to 1.0.0
>>=20
>> Modified:
>>   httpd/httpd/trunk/modules/http2/h2_util.c
>>   httpd/httpd/trunk/modules/http2/h2_version.h
>>=20
>> Modified: httpd/httpd/trunk/modules/http2/h2_util.c
>> URL: =
http://svn.apache.org/viewvc/httpd/httpd/trunk/modules/http2/h2_util.c?rev=
=3D1707468&r1=3D1707467&r2=3D1707468&view=3Ddiff
>> =
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
>> --- httpd/httpd/trunk/modules/http2/h2_util.c (original)
>> +++ httpd/httpd/trunk/modules/http2/h2_util.c Thu Oct  8 10:03:30 =
2015
>> @@ -484,19 +484,38 @@ int h2_util_has_flush_or_eos(apr_bucket_
>>=20
>> int h2_util_has_eos(apr_bucket_brigade *bb, apr_size_t len)
>> {
>> -    apr_bucket *b, *end;
>> +    apr_bucket *b;
>>=20
>> -    apr_status_t status =3D last_not_included(bb, len, 0, 0, &end);
>> -    if (status !=3D APR_SUCCESS) {
>> -        return status;
>> +    if (len =3D=3D 0) {
>> +        /* special case: this is only true, if there are only meta
>> +         * and an eos bucket in the brigade head.
>> +         */
>> +        for (b =3D APR_BRIGADE_FIRST(bb);
>> +             b !=3D APR_BRIGADE_SENTINEL(bb);
>> +             b =3D APR_BUCKET_NEXT(b))
>> +        {
>> +            if (!APR_BUCKET_IS_METADATA(b) && b->length !=3D 0) {
>> +                break;
>> +            }
>> +            else if (APR_BUCKET_IS_EOS(b)) {
>> +                return 1;
>> +            }
>> +        }
>>    }
>> -   =20
>> -    for (b =3D APR_BRIGADE_FIRST(bb);
>> -         b !=3D APR_BRIGADE_SENTINEL(bb) && b !=3D end;
>> -         b =3D APR_BUCKET_NEXT(b))
>> -    {
>> -        if (APR_BUCKET_IS_EOS(b)) {
>> -            return 1;
>> +    else {
>> +        apr_bucket *end;
>> +        apr_status_t status =3D last_not_included(bb, len, 0, 0, =
&end);
>> +        if (status !=3D APR_SUCCESS) {
>> +            return status;
>> +        }
>> +       =20
>> +        for (b =3D APR_BRIGADE_FIRST(bb);
>> +             b !=3D APR_BRIGADE_SENTINEL(bb) && b !=3D end;
>> +             b =3D APR_BUCKET_NEXT(b))
>> +        {
>> +            if (APR_BUCKET_IS_EOS(b)) {
>> +                return 1;
>> +            }
>>        }
>>    }
>>    return 0;
>>=20
>> Modified: httpd/httpd/trunk/modules/http2/h2_version.h
>> URL: =
http://svn.apache.org/viewvc/httpd/httpd/trunk/modules/http2/h2_version.h?=
rev=3D1707468&r1=3D1707467&r2=3D1707468&view=3Ddiff
>> =
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
>> --- httpd/httpd/trunk/modules/http2/h2_version.h (original)
>> +++ httpd/httpd/trunk/modules/http2/h2_version.h Thu Oct  8 10:03:30 =
2015
>> @@ -20,7 +20,7 @@
>> * @macro
>> * Version number of the h2 module as c string
>> */
>> -#define MOD_HTTP2_VERSION "0.9.9"
>> +#define MOD_HTTP2_VERSION "1.0.0"
>>=20
>> /**
>> * @macro
>> @@ -28,7 +28,7 @@
>> * release. This is a 24 bit number with 8 bits for major number, 8 =
bits
>> * for minor and 8 bits for patch. Version 1.2.3 becomes 0x010203.
>> */
>> -#define MOD_HTTP2_VERSION_NUM 0x000909
>> +#define MOD_HTTP2_VERSION_NUM 0x010000
>>=20
>>=20
>> #endif /* mod_h2_h2_version_h */
>>=20
>>=20
>=20


From dev-return-84151-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Thu Oct  8 10:47:18 2015
Return-Path: <dev-return-84151-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 0D07D18D2D
	for <apmail-httpd-dev-archive@www.apache.org>; Thu,  8 Oct 2015 10:47:18 +0000 (UTC)
Received: (qmail 10181 invoked by uid 500); 8 Oct 2015 10:47:03 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 10104 invoked by uid 500); 8 Oct 2015 10:47:03 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 10094 invoked by uid 99); 8 Oct 2015 10:47:03 -0000
Received: from Unknown (HELO spamd1-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 08 Oct 2015 10:47:03 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd1-us-west.apache.org (ASF Mail Server at spamd1-us-west.apache.org) with ESMTP id B8E41C48C2
	for <dev@httpd.apache.org>; Thu,  8 Oct 2015 10:47:02 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd1-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 0.801
X-Spam-Level:
X-Spam-Status: No, score=0.801 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, KAM_ASCII_DIVIDERS=0.8,
	URIBL_BLOCKED=0.001] autolearn=disabled
Authentication-Results: spamd1-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=comcast.net
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd1-us-west.apache.org [10.40.0.7]) (amavisd-new, port 10024)
	with ESMTP id ocm4Y8KY8tIr for <dev@httpd.apache.org>;
	Thu,  8 Oct 2015 10:46:51 +0000 (UTC)
Received: from resqmta-ch2-02v.sys.comcast.net (resqmta-ch2-02v.sys.comcast.net [69.252.207.34])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id 91E59439BC
	for <dev@httpd.apache.org>; Thu,  8 Oct 2015 10:46:51 +0000 (UTC)
Received: from resomta-ch2-02v.sys.comcast.net ([69.252.207.98])
	by resqmta-ch2-02v.sys.comcast.net with comcast
	id SamU1r00627uzMh01amkuM; Thu, 08 Oct 2015 10:46:44 +0000
Received: from [192.168.199.10] ([69.251.84.114])
	by resomta-ch2-02v.sys.comcast.net with comcast
	id Samk1r0052U0RYt01amkpv; Thu, 08 Oct 2015 10:46:44 +0000
Content-Type: text/plain; charset=us-ascii
Mime-Version: 1.0 (Mac OS X Mail 8.2 \(2104\))
Subject: Re: stop the press!
From: Jim Jagielski <jim@jaguNET.com>
In-Reply-To: <B3EE8F05-26C7-4B79-B335-B6A431571022@greenbytes.de>
Date: Thu, 8 Oct 2015 06:46:43 -0400
Content-Transfer-Encoding: quoted-printable
Message-Id: <A7454680-1A43-46BA-9D31-43744AADCEF7@jaguNET.com>
References: <B3EE8F05-26C7-4B79-B335-B6A431571022@greenbytes.de>
To: dev@httpd.apache.org
X-Mailer: Apple Mail (2.2104)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=comcast.net;
	s=q20140121; t=1444301204;
	bh=FPri8vnfbYAwYa8ORLvntWaCNHaNNx1qVTJJP8Cazgk=;
	h=Received:Received:Content-Type:Mime-Version:Subject:From:Date:
	 Message-Id:To;
	b=MspdUV9C0vlGh8IcSDUBXHRroWPELJoKi4nNfZ54u/fWzChEiWbnUgaIIjQSTHXLI
	 nRd6D+avrK6Edzu5LcEWjTBvUZtAe4O9DOZQ6zPaa7EgNcV03InHi0TVKXFoZ45ahw
	 ORA3GvEFaL9ez5Vbh4HeMsDatxxVrkz9XVWoyvTtQEH3VThwmkgRMRLqLHIqc1by5W
	 zOqGxPyIauzgWd7fS+NqPg/pTHkG6TR+yt7Os8intJA1I+v5a+r/t3nhUGwKFIpzz+
	 1Z/5qSxRJneielisGWFKKKK6OBhCWIykTJVdyiEzxMjoG+jZOUrGU4w4+ofB2cP7Ks
	 rb0GvvI8KGvRg==

The mod_http2 stuff for 2.4.x is CTR, meaning that one does not
need to propose a backport in STATUS for it to be included; rather,
one simply patches 2.4 as required, while ensuring that one doesn't
break anything :)

> On Oct 8, 2015, at 6:06 AM, Stefan Eissing =
<stefan.eissing@greenbytes.de> wrote:
>=20
> I need a tiny patch for mod_http2 that solves an empty response =
problem with the latest nghttp2 libraries:
>=20
> Jim, can we get that still in? Commited in trunk as r1707468.
>=20
> //Stefan
>=20
> Index: modules/http2/h2_util.c
> =3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D
> --- modules/http2/h2_util.c	(revision 1707467)
> +++ modules/http2/h2_util.c	(revision 1707468)
> @@ -484,20 +484,39 @@
>=20
> int h2_util_has_eos(apr_bucket_brigade *bb, apr_size_t len)
> {
> -    apr_bucket *b, *end;
> +    apr_bucket *b;
>=20
> -    apr_status_t status =3D last_not_included(bb, len, 0, 0, &end);
> -    if (status !=3D APR_SUCCESS) {
> -        return status;
> +    if (len =3D=3D 0) {
> +        /* special case: this is only true, if there are only meta
> +         * and an eos bucket in the brigade head.
> +         */
> +        for (b =3D APR_BRIGADE_FIRST(bb);
> +             b !=3D APR_BRIGADE_SENTINEL(bb);
> +             b =3D APR_BUCKET_NEXT(b))
> +        {
> +            if (!APR_BUCKET_IS_METADATA(b) && b->length !=3D 0) {
> +                break;
> +            }
> +            else if (APR_BUCKET_IS_EOS(b)) {
> +                return 1;
> +            }
> +        }
>     }
> -   =20
> -    for (b =3D APR_BRIGADE_FIRST(bb);
> -         b !=3D APR_BRIGADE_SENTINEL(bb) && b !=3D end;
> -         b =3D APR_BUCKET_NEXT(b))
> -    {
> -        if (APR_BUCKET_IS_EOS(b)) {
> -            return 1;
> +    else {
> +        apr_bucket *end;
> +        apr_status_t status =3D last_not_included(bb, len, 0, 0, =
&end);
> +        if (status !=3D APR_SUCCESS) {
> +            return status;
>         }
> +       =20
> +        for (b =3D APR_BRIGADE_FIRST(bb);
> +             b !=3D APR_BRIGADE_SENTINEL(bb) && b !=3D end;
> +             b =3D APR_BUCKET_NEXT(b))
> +        {
> +            if (APR_BUCKET_IS_EOS(b)) {
> +                return 1;
> +            }
> +        }
>     }
>     return 0;
> }
> Index: modules/http2/h2_version.h
> =3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D
> --- modules/http2/h2_version.h	(revision 1707467)
> +++ modules/http2/h2_version.h	(revision 1707468)
> @@ -20,7 +20,7 @@
>  * @macro
>  * Version number of the h2 module as c string
>  */
> -#define MOD_HTTP2_VERSION "0.9.9"
> +#define MOD_HTTP2_VERSION "1.0.0"
>=20
> /**
>  * @macro
> @@ -28,7 +28,7 @@
>  * release. This is a 24 bit number with 8 bits for major number, 8 =
bits
>  * for minor and 8 bits for patch. Version 1.2.3 becomes 0x010203.
>  */
> -#define MOD_HTTP2_VERSION_NUM 0x000909
> +#define MOD_HTTP2_VERSION_NUM 0x010000
>=20
>=20
> #endif /* mod_h2_h2_version_h */
>=20


From dev-return-84152-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Thu Oct  8 10:48:16 2015
Return-Path: <dev-return-84152-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 9FB3B18D30
	for <apmail-httpd-dev-archive@www.apache.org>; Thu,  8 Oct 2015 10:48:16 +0000 (UTC)
Received: (qmail 12876 invoked by uid 500); 8 Oct 2015 10:48:16 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 12813 invoked by uid 500); 8 Oct 2015 10:48:16 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 12803 invoked by uid 99); 8 Oct 2015 10:48:16 -0000
Received: from Unknown (HELO spamd2-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 08 Oct 2015 10:48:16 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd2-us-west.apache.org (ASF Mail Server at spamd2-us-west.apache.org) with ESMTP id 93B781A24C4
	for <dev@httpd.apache.org>; Thu,  8 Oct 2015 10:48:15 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd2-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 0.79
X-Spam-Level:
X-Spam-Status: No, score=0.79 tagged_above=-999 required=6.31
	tests=[KAM_ASCII_DIVIDERS=0.8, SPF_PASS=-0.001,
	T_RP_MATCHES_RCVD=-0.01, URIBL_BLOCKED=0.001] autolearn=disabled
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd2-us-west.apache.org [10.40.0.9]) (amavisd-new, port 10024)
	with ESMTP id ijBqieZjbXlv for <dev@httpd.apache.org>;
	Thu,  8 Oct 2015 10:48:06 +0000 (UTC)
Received: from mail.greenbytes.de (mail.greenbytes.de [217.91.35.233])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id 9872020F9F
	for <dev@httpd.apache.org>; Thu,  8 Oct 2015 10:48:05 +0000 (UTC)
Received: from [192.168.1.42] (unknown [5.10.171.186])
	(using TLSv1 with cipher ECDHE-RSA-AES256-SHA (256/256 bits))
	(Client did not present a certificate)
	by mail.greenbytes.de (Postfix) with ESMTPSA id 2BEAF15A0096
	for <dev@httpd.apache.org>; Thu,  8 Oct 2015 12:48:05 +0200 (CEST)
Content-Type: text/plain; charset=us-ascii
Mime-Version: 1.0 (Mac OS X Mail 9.0 \(3094\))
Subject: Re: stop the press!
From: Stefan Eissing <stefan.eissing@greenbytes.de>
In-Reply-To: <A7454680-1A43-46BA-9D31-43744AADCEF7@jaguNET.com>
Date: Thu, 8 Oct 2015 12:48:04 +0200
Content-Transfer-Encoding: quoted-printable
Message-Id: <F70D14F9-CC07-4E16-BC61-91904CC46212@greenbytes.de>
References: <B3EE8F05-26C7-4B79-B335-B6A431571022@greenbytes.de> <A7454680-1A43-46BA-9D31-43744AADCEF7@jaguNET.com>
To: dev@httpd.apache.org
X-Mailer: Apple Mail (2.3094)

Ah, good and useful hint! Currently working on a better patch and =
backport that myself then. Thanks!

> Am 08.10.2015 um 12:46 schrieb Jim Jagielski <jim@jaguNET.com>:
>=20
> The mod_http2 stuff for 2.4.x is CTR, meaning that one does not
> need to propose a backport in STATUS for it to be included; rather,
> one simply patches 2.4 as required, while ensuring that one doesn't
> break anything :)
>=20
>> On Oct 8, 2015, at 6:06 AM, Stefan Eissing =
<stefan.eissing@greenbytes.de> wrote:
>>=20
>> I need a tiny patch for mod_http2 that solves an empty response =
problem with the latest nghttp2 libraries:
>>=20
>> Jim, can we get that still in? Commited in trunk as r1707468.
>>=20
>> //Stefan
>>=20
>> Index: modules/http2/h2_util.c
>> =3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D
>> --- modules/http2/h2_util.c	(revision 1707467)
>> +++ modules/http2/h2_util.c	(revision 1707468)
>> @@ -484,20 +484,39 @@
>>=20
>> int h2_util_has_eos(apr_bucket_brigade *bb, apr_size_t len)
>> {
>> -    apr_bucket *b, *end;
>> +    apr_bucket *b;
>>=20
>> -    apr_status_t status =3D last_not_included(bb, len, 0, 0, &end);
>> -    if (status !=3D APR_SUCCESS) {
>> -        return status;
>> +    if (len =3D=3D 0) {
>> +        /* special case: this is only true, if there are only meta
>> +         * and an eos bucket in the brigade head.
>> +         */
>> +        for (b =3D APR_BRIGADE_FIRST(bb);
>> +             b !=3D APR_BRIGADE_SENTINEL(bb);
>> +             b =3D APR_BUCKET_NEXT(b))
>> +        {
>> +            if (!APR_BUCKET_IS_METADATA(b) && b->length !=3D 0) {
>> +                break;
>> +            }
>> +            else if (APR_BUCKET_IS_EOS(b)) {
>> +                return 1;
>> +            }
>> +        }
>>    }
>> -   =20
>> -    for (b =3D APR_BRIGADE_FIRST(bb);
>> -         b !=3D APR_BRIGADE_SENTINEL(bb) && b !=3D end;
>> -         b =3D APR_BUCKET_NEXT(b))
>> -    {
>> -        if (APR_BUCKET_IS_EOS(b)) {
>> -            return 1;
>> +    else {
>> +        apr_bucket *end;
>> +        apr_status_t status =3D last_not_included(bb, len, 0, 0, =
&end);
>> +        if (status !=3D APR_SUCCESS) {
>> +            return status;
>>        }
>> +       =20
>> +        for (b =3D APR_BRIGADE_FIRST(bb);
>> +             b !=3D APR_BRIGADE_SENTINEL(bb) && b !=3D end;
>> +             b =3D APR_BUCKET_NEXT(b))
>> +        {
>> +            if (APR_BUCKET_IS_EOS(b)) {
>> +                return 1;
>> +            }
>> +        }
>>    }
>>    return 0;
>> }
>> Index: modules/http2/h2_version.h
>> =3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D
>> --- modules/http2/h2_version.h	(revision 1707467)
>> +++ modules/http2/h2_version.h	(revision 1707468)
>> @@ -20,7 +20,7 @@
>> * @macro
>> * Version number of the h2 module as c string
>> */
>> -#define MOD_HTTP2_VERSION "0.9.9"
>> +#define MOD_HTTP2_VERSION "1.0.0"
>>=20
>> /**
>> * @macro
>> @@ -28,7 +28,7 @@
>> * release. This is a 24 bit number with 8 bits for major number, 8 =
bits
>> * for minor and 8 bits for patch. Version 1.2.3 becomes 0x010203.
>> */
>> -#define MOD_HTTP2_VERSION_NUM 0x000909
>> +#define MOD_HTTP2_VERSION_NUM 0x010000
>>=20
>>=20
>> #endif /* mod_h2_h2_version_h */
>>=20
>=20


From dev-return-84153-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Thu Oct  8 10:50:40 2015
Return-Path: <dev-return-84153-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 3A42A18D3D
	for <apmail-httpd-dev-archive@www.apache.org>; Thu,  8 Oct 2015 10:50:40 +0000 (UTC)
Received: (qmail 15592 invoked by uid 500); 8 Oct 2015 10:50:39 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 15518 invoked by uid 500); 8 Oct 2015 10:50:39 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 15503 invoked by uid 99); 8 Oct 2015 10:50:39 -0000
Received: from Unknown (HELO spamd4-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 08 Oct 2015 10:50:39 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd4-us-west.apache.org (ASF Mail Server at spamd4-us-west.apache.org) with ESMTP id 46808C0419
	for <dev@httpd.apache.org>; Thu,  8 Oct 2015 10:50:39 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd4-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 1.453
X-Spam-Level: *
X-Spam-Status: No, score=1.453 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, KAM_ASCII_DIVIDERS=0.8,
	SPF_NEUTRAL=0.652, URIBL_BLOCKED=0.001] autolearn=disabled
Authentication-Results: spamd4-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=comcast.net
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd4-us-west.apache.org [10.40.0.11]) (amavisd-new, port 10024)
	with ESMTP id N0asYpAfTAsz for <dev@httpd.apache.org>;
	Thu,  8 Oct 2015 10:50:28 +0000 (UTC)
Received: from resqmta-ch2-10v.sys.comcast.net (resqmta-ch2-10v.sys.comcast.net [69.252.207.42])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id 39A4A206E8
	for <dev@httpd.apache.org>; Thu,  8 Oct 2015 10:50:28 +0000 (UTC)
Received: from resomta-ch2-10v.sys.comcast.net ([69.252.207.106])
	by resqmta-ch2-10v.sys.comcast.net with comcast
	id Sapv1r0022JGN3p01aqLNL; Thu, 08 Oct 2015 10:50:20 +0000
Received: from [192.168.199.10] ([69.251.84.114])
	by resomta-ch2-10v.sys.comcast.net with comcast
	id SaqL1r0042U0RYt01aqLZF; Thu, 08 Oct 2015 10:50:20 +0000
Content-Type: text/plain; charset=us-ascii
Mime-Version: 1.0 (Mac OS X Mail 8.2 \(2104\))
Subject: Re: svn commit: r1707468 - in /httpd/httpd/trunk/modules/http2: h2_util.c h2_version.h
From: Jim Jagielski <jim@jaguNET.com>
In-Reply-To: <8F861099-8CCF-4223-84EB-846091A30B02@greenbytes.de>
Date: Thu, 8 Oct 2015 06:50:20 -0400
Cc: cvs@httpd.apache.org
Content-Transfer-Encoding: quoted-printable
Message-Id: <FF583844-8C3D-44A1-96F1-352E047E89C5@jaguNET.com>
References: <20151008100330.D3AB63A02E5@svn01-us-west.apache.org> <6CFC1A2F-1718-41D3-AC78-217469B94482@jaguNET.com> <8F861099-8CCF-4223-84EB-846091A30B02@greenbytes.de>
To: dev@httpd.apache.org
X-Mailer: Apple Mail (2.2104)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=comcast.net;
	s=q20140121; t=1444301420;
	bh=gDTw3Z0CMxk/dl9RBrOGlxhCfqh4X6aszrS/AMfOYVk=;
	h=Received:Received:Content-Type:Mime-Version:Subject:From:Date:
	 Message-Id:To;
	b=OGGBUP3TTFXSnRQUwpwPRUS5iW7i521Vbih5UNz/8FmrW3stgrppgfcB8rfdHJYhk
	 7d47FbKJdIFiUWVHpivCNOUo0W5kE6RUNnTfOw16Y/ZhzLgAaTnZR7VOWDn0w+dNgO
	 sld7OcdFRZMndOOQHRdplNT1uW0rIlD0C0txhyD7yhQdSu+8D+5g0njj0iSjOUE56t
	 IKyYj79JvbWpxafrLRQ4UoFGJQYskoONfH7Zk7gvFfKnVIVm2pkj101kGvzPLwZ/oI
	 6XN97D55zjxhkABBQst7EbBohZpFCRkLJDSsXxAjLVb0iTw888pMWuOeRFXpJDRguH
	 R4nRCzsA/vtdw==

No rush... :)

> On Oct 8, 2015, at 6:45 AM, Stefan Eissing =
<stefan.eissing@greenbytes.de> wrote:
>=20
> Jim, give me a moment. Yann's code reviewing skill are just too =
good...
>=20
> //Stefan
>=20
>> Am 08.10.2015 um 12:44 schrieb Jim Jagielski <jim@jaguNET.com>:
>>=20
>> I am guessing this should be backported to 2.4.17, right?
>>=20
>>> On Oct 8, 2015, at 6:03 AM, icing@apache.org wrote:
>>>=20
>>> Author: icing
>>> Date: Thu Oct  8 10:03:30 2015
>>> New Revision: 1707468
>>>=20
>>> URL: http://svn.apache.org/viewvc?rev=3D1707468&view=3Drev
>>> Log:
>>> fix for empty responses with nghttp2 v1.3.x, bump version to 1.0.0
>>>=20
>>> Modified:
>>>  httpd/httpd/trunk/modules/http2/h2_util.c
>>>  httpd/httpd/trunk/modules/http2/h2_version.h
>>>=20
>>> Modified: httpd/httpd/trunk/modules/http2/h2_util.c
>>> URL: =
http://svn.apache.org/viewvc/httpd/httpd/trunk/modules/http2/h2_util.c?rev=
=3D1707468&r1=3D1707467&r2=3D1707468&view=3Ddiff
>>> =
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
>>> --- httpd/httpd/trunk/modules/http2/h2_util.c (original)
>>> +++ httpd/httpd/trunk/modules/http2/h2_util.c Thu Oct  8 10:03:30 =
2015
>>> @@ -484,19 +484,38 @@ int h2_util_has_flush_or_eos(apr_bucket_
>>>=20
>>> int h2_util_has_eos(apr_bucket_brigade *bb, apr_size_t len)
>>> {
>>> -    apr_bucket *b, *end;
>>> +    apr_bucket *b;
>>>=20
>>> -    apr_status_t status =3D last_not_included(bb, len, 0, 0, &end);
>>> -    if (status !=3D APR_SUCCESS) {
>>> -        return status;
>>> +    if (len =3D=3D 0) {
>>> +        /* special case: this is only true, if there are only meta
>>> +         * and an eos bucket in the brigade head.
>>> +         */
>>> +        for (b =3D APR_BRIGADE_FIRST(bb);
>>> +             b !=3D APR_BRIGADE_SENTINEL(bb);
>>> +             b =3D APR_BUCKET_NEXT(b))
>>> +        {
>>> +            if (!APR_BUCKET_IS_METADATA(b) && b->length !=3D 0) {
>>> +                break;
>>> +            }
>>> +            else if (APR_BUCKET_IS_EOS(b)) {
>>> +                return 1;
>>> +            }
>>> +        }
>>>   }
>>> -   =20
>>> -    for (b =3D APR_BRIGADE_FIRST(bb);
>>> -         b !=3D APR_BRIGADE_SENTINEL(bb) && b !=3D end;
>>> -         b =3D APR_BUCKET_NEXT(b))
>>> -    {
>>> -        if (APR_BUCKET_IS_EOS(b)) {
>>> -            return 1;
>>> +    else {
>>> +        apr_bucket *end;
>>> +        apr_status_t status =3D last_not_included(bb, len, 0, 0, =
&end);
>>> +        if (status !=3D APR_SUCCESS) {
>>> +            return status;
>>> +        }
>>> +       =20
>>> +        for (b =3D APR_BRIGADE_FIRST(bb);
>>> +             b !=3D APR_BRIGADE_SENTINEL(bb) && b !=3D end;
>>> +             b =3D APR_BUCKET_NEXT(b))
>>> +        {
>>> +            if (APR_BUCKET_IS_EOS(b)) {
>>> +                return 1;
>>> +            }
>>>       }
>>>   }
>>>   return 0;
>>>=20
>>> Modified: httpd/httpd/trunk/modules/http2/h2_version.h
>>> URL: =
http://svn.apache.org/viewvc/httpd/httpd/trunk/modules/http2/h2_version.h?=
rev=3D1707468&r1=3D1707467&r2=3D1707468&view=3Ddiff
>>> =
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
>>> --- httpd/httpd/trunk/modules/http2/h2_version.h (original)
>>> +++ httpd/httpd/trunk/modules/http2/h2_version.h Thu Oct  8 10:03:30 =
2015
>>> @@ -20,7 +20,7 @@
>>> * @macro
>>> * Version number of the h2 module as c string
>>> */
>>> -#define MOD_HTTP2_VERSION "0.9.9"
>>> +#define MOD_HTTP2_VERSION "1.0.0"
>>>=20
>>> /**
>>> * @macro
>>> @@ -28,7 +28,7 @@
>>> * release. This is a 24 bit number with 8 bits for major number, 8 =
bits
>>> * for minor and 8 bits for patch. Version 1.2.3 becomes 0x010203.
>>> */
>>> -#define MOD_HTTP2_VERSION_NUM 0x000909
>>> +#define MOD_HTTP2_VERSION_NUM 0x010000
>>>=20
>>>=20
>>> #endif /* mod_h2_h2_version_h */
>>>=20
>>>=20
>>=20
>=20


From dev-return-84154-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Thu Oct  8 10:56:44 2015
Return-Path: <dev-return-84154-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 6211418D64
	for <apmail-httpd-dev-archive@www.apache.org>; Thu,  8 Oct 2015 10:56:44 +0000 (UTC)
Received: (qmail 21358 invoked by uid 500); 8 Oct 2015 10:56:43 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 21274 invoked by uid 500); 8 Oct 2015 10:56:43 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 21264 invoked by uid 99); 8 Oct 2015 10:56:43 -0000
Received: from Unknown (HELO spamd2-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 08 Oct 2015 10:56:43 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd2-us-west.apache.org (ASF Mail Server at spamd2-us-west.apache.org) with ESMTP id 514941A24C4
	for <dev@httpd.apache.org>; Thu,  8 Oct 2015 10:56:43 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd2-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.01
X-Spam-Level:
X-Spam-Status: No, score=-0.01 tagged_above=-999 required=6.31
	tests=[SPF_PASS=-0.001, T_RP_MATCHES_RCVD=-0.01, URIBL_BLOCKED=0.001]
	autolearn=disabled
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd2-us-west.apache.org [10.40.0.9]) (amavisd-new, port 10024)
	with ESMTP id BYmXQBA4mtTg for <dev@httpd.apache.org>;
	Thu,  8 Oct 2015 10:56:33 +0000 (UTC)
Received: from monica.sharp.fm (monica.sharp.fm [80.168.143.5])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTP id 3742627DB4
	for <dev@httpd.apache.org>; Thu,  8 Oct 2015 10:56:33 +0000 (UTC)
Received: from [192.168.220.234] (unknown [192.168.220.234])
	(using TLSv1 with cipher DHE-RSA-AES256-SHA (256/256 bits))
	(Client did not present a certificate)
	(Authenticated sender: minfrin@sharp.fm)
	by monica.sharp.fm (Postfix) with ESMTPSA id D220183152
	for <dev@httpd.apache.org>; Thu,  8 Oct 2015 11:56:32 +0100 (BST)
Content-Type: text/plain; charset=utf-8
Mime-Version: 1.0 (Mac OS X Mail 8.2 \(2104\))
Subject: Re: about those async filters
From: Graham Leggett <minfrin@sharp.fm>
In-Reply-To: <CE2F280D-2036-47C2-B636-A14FB0412DB2@greenbytes.de>
Date: Thu, 8 Oct 2015 12:56:31 +0200
Content-Transfer-Encoding: quoted-printable
Message-Id: <EE293ED9-29D4-4000-9F1A-E0BD9A03D840@sharp.fm>
References: <114310CC-D227-4912-8651-B3B26F9330C9@greenbytes.de> <7DCE371B-FFB1-4254-B599-467A7827A991@sharp.fm> <CE2F280D-2036-47C2-B636-A14FB0412DB2@greenbytes.de>
To: dev@httpd.apache.org
X-Mailer: Apple Mail (2.2104)

On 07 Oct 2015, at 4:30 PM, Stefan Eissing =
<stefan.eissing@greenbytes.de> wrote:

> In http2 land, the request happen on "pseudo" connections, connections =
properly created by ap_run_create_connection(), but with own filters of =
type AP_FTYPE_PROTOCOL and AP_FTYPE_NETWORK, registered by mod_h2.=20
>=20
> These filters copy the data (or move the files) across the processing =
filters thread into the h2 multiplexer (h2_mplx) where the master =
connection thread reads it and send it out to the client, properly =
framed for HTTP/2.

Having gone through this in a bit more detail (and slept on it) I =
simultaneously see how we needed to do this to reach this point given =
the limitations of the server, but at the same time this approach causes =
a number of problems that we need to solve in the medium term (which is =
doable from what I can see).

What mod_http2 is doing is creating it=E2=80=99s own =
=E2=80=9Cmini-worker-mpm=E2=80=9D inside the module, and this creates a =
number of problems. The first is that code out there that cares about =
being single threaded (historically php, for example) suddenly finds =
itself running in a =E2=80=9Cpseudo-worker=E2=80=9D MPM when the actual =
MPM in use is prefork. This will cause unexpected breakage for people =
trying to use http2.

The second problem is that with mod_http2 being a =E2=80=9Cpseudo-mpm=E2=80=
=9D, it needs to emulate all the functions of an mpm in order to =
correctly do so. I believe the problems with async filters are a =
manifestation of mod_http2 not implementing all the capabilities of an =
MPM. We could try and make mod_http2 do so, but I think ultimately =
we=E2=80=99re making life hard for ourselves - we should really be =
leveraging the MPMs directly to make workers for us instead of trying to =
bake workers of our own.

So, bringing this down to actual practical stuff we can do to make this =
happen, the basic problems to solve are:

- The master connection currently runs under an existing MPM, and this =
works fine today.
- The slave connection needs to run under an existing MPM instead of the =
=E2=80=9Cpseudo MPM=E2=80=9D it works under today.
- In theory, we can let the master connection and slave connection talk =
to each other over two pairs of sockets otherwise created with =
socketpair() (workaround for Windows at =
http://code.activestate.com/recipes/525487-extending-socketsocketpair-to-w=
ork-on-windows/).
- We would need a mechanism to inject the just-created socket into the =
MPM=E2=80=99s worker queue (ie in event MPM, call push2worker()), that =
would be an additional call to MPMs that could support it.
- When the slave connection is accepted by the worker, the normal =
request acceptance mechanism applies. We might signal the connection is =
an HTTP2 slave connection on the request line in some way, or perhaps =
emulate HTTP/1.1 (not sure if workable), will need to come up with a =
solution.

Regards,
Graham
=E2=80=94


From dev-return-84155-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Thu Oct  8 10:59:34 2015
Return-Path: <dev-return-84155-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 76C2818D7E
	for <apmail-httpd-dev-archive@www.apache.org>; Thu,  8 Oct 2015 10:59:34 +0000 (UTC)
Received: (qmail 29640 invoked by uid 500); 8 Oct 2015 10:59:34 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 29560 invoked by uid 500); 8 Oct 2015 10:59:34 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 29550 invoked by uid 99); 8 Oct 2015 10:59:33 -0000
Received: from Unknown (HELO spamd2-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 08 Oct 2015 10:59:33 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd2-us-west.apache.org (ASF Mail Server at spamd2-us-west.apache.org) with ESMTP id 8D2711A24C6
	for <dev@httpd.apache.org>; Thu,  8 Oct 2015 10:59:33 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd2-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 0.112
X-Spam-Level:
X-Spam-Status: No, score=0.112 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	SPF_HELO_PASS=-0.001, STOX_REPLY_TYPE=0.212, URIBL_BLOCKED=0.001]
	autolearn=disabled
Authentication-Results: spamd2-us-west.apache.org (amavisd-new);
	dkim=pass (1024-bit key) header.d=apachelounge.com
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd2-us-west.apache.org [10.40.0.9]) (amavisd-new, port 10024)
	with ESMTP id ECa3I8TqoVDt for <dev@httpd.apache.org>;
	Thu,  8 Oct 2015 10:59:18 +0000 (UTC)
Received: from land10web.com (land10web.com [80.101.236.247])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTP id 1FB2124E1C
	for <dev@httpd.apache.org>; Thu,  8 Oct 2015 10:59:17 +0000 (UTC)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=apachelounge.com;
	s=default; t=1444302018;
	bh=D8Za6yrDKvvybI9l5d1NpSL5U6+3DDErNKNvpuzjTSc=;
	h=From:To:References:In-Reply-To:Subject:Date;
	b=2DVCG/h03mDICqx3ckY3txL09xOBChyC+06ZAK8WQgt9t+So4HZEhnwQg0eBwwak+
	 evkvBLbKJL0YgsqWQFOnBPHyoHpekfZivSPsXJ7X92Co5wjrmKAZ1CKOW/mpvnttrv
	 QxhItlw8RSzhacq6EpqPNlvEg3jPH2IAyYXCcOdM=
X-Default-Received-SPF: pass (skip=forwardok (res=PASS)) x-ip-name=80.101.236.247;
Message-ID: <0C6E8F63900E44D08F83CABE8F0BDDF2@father>
From: "Steffen" <info@apachelounge.com>
To: <dev@httpd.apache.org>
References: <56159f73.568.1970.3a58@land10.nl> <A335AA83-92FD-4580-88ED-B1E37DFB2693@jaguNET.com>
In-Reply-To: <A335AA83-92FD-4580-88ED-B1E37DFB2693@jaguNET.com>
Subject: Re: T&R of 2.4.17 this week
Date: Thu, 8 Oct 2015 12:57:33 +0200
MIME-Version: 1.0
Content-Type: text/plain;
	format=flowed;
	charset="iso-8859-1";
	reply-type=original
Content-Transfer-Encoding: 7bit
X-Priority: 3
X-MSMail-Priority: Normal
Importance: Normal
X-Mailer: Microsoft Windows Live Mail 16.4.3528.331
X-MimeOLE: Produced By Microsoft MimeOLE V16.4.3528.331

Jus curious, why is e.g. LUA there ?

-----Original Message----- 
From: Jim Jagielski 
Sent: Thursday, October 8, 2015 12:44 PM 
To: dev@httpd.apache.org 
Subject: ****** Re: T&R of 2.4.17 this week 

Since we are not bundling them, we don't.

> On Oct 7, 2015, at 6:40 PM, Steffen <info@apachelounge.com> wrote:
> 
> Do we need in LICENSE.txt the license of nghttp2 (MIT) ?
> 
> Also missing there libxml2.
>  
> On Wednesday 07/10/2015 at 15:46, Jim Jagielski wrote: 
>> So the plan is to T&R sometime tomorrow, likely
>> later on in the afternoon, eastern time.
> 
> 

From dev-return-84156-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Thu Oct  8 11:05:26 2015
Return-Path: <dev-return-84156-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 4971618DB1
	for <apmail-httpd-dev-archive@www.apache.org>; Thu,  8 Oct 2015 11:05:26 +0000 (UTC)
Received: (qmail 45719 invoked by uid 500); 8 Oct 2015 11:05:22 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 45639 invoked by uid 500); 8 Oct 2015 11:05:22 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 45629 invoked by uid 99); 8 Oct 2015 11:05:22 -0000
Received: from Unknown (HELO spamd1-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 08 Oct 2015 11:05:22 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd1-us-west.apache.org (ASF Mail Server at spamd1-us-west.apache.org) with ESMTP id 3BEA5C4ABE
	for <dev@httpd.apache.org>; Thu,  8 Oct 2015 11:05:22 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd1-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 0.79
X-Spam-Level:
X-Spam-Status: No, score=0.79 tagged_above=-999 required=6.31
	tests=[KAM_ASCII_DIVIDERS=0.8, SPF_PASS=-0.001,
	T_RP_MATCHES_RCVD=-0.01, URIBL_BLOCKED=0.001] autolearn=disabled
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd1-us-west.apache.org [10.40.0.7]) (amavisd-new, port 10024)
	with ESMTP id 0KLVh-liN5sX for <dev@httpd.apache.org>;
	Thu,  8 Oct 2015 11:05:11 +0000 (UTC)
Received: from mail.greenbytes.de (mail.greenbytes.de [217.91.35.233])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id 0D74A439B6
	for <dev@httpd.apache.org>; Thu,  8 Oct 2015 11:05:11 +0000 (UTC)
Received: from [192.168.1.42] (unknown [5.10.171.186])
	(using TLSv1 with cipher ECDHE-RSA-AES256-SHA (256/256 bits))
	(Client did not present a certificate)
	by mail.greenbytes.de (Postfix) with ESMTPSA id 138AB15A00DB
	for <dev@httpd.apache.org>; Thu,  8 Oct 2015 13:05:10 +0200 (CEST)
Content-Type: text/plain; charset=us-ascii
Mime-Version: 1.0 (Mac OS X Mail 9.0 \(3094\))
Subject: Re: stop the press!
From: Stefan Eissing <stefan.eissing@greenbytes.de>
In-Reply-To: <CAKQ1sVMThLzUCt03BJ+accZKYrnHmexY4mpwnRyXCXRbA+J-RA@mail.gmail.com>
Date: Thu, 8 Oct 2015 13:05:09 +0200
Content-Transfer-Encoding: quoted-printable
Message-Id: <6F5B6977-6103-4A11-868B-2F686F0B4226@greenbytes.de>
References: <B3EE8F05-26C7-4B79-B335-B6A431571022@greenbytes.de> <CAKQ1sVMThLzUCt03BJ+accZKYrnHmexY4mpwnRyXCXRbA+J-RA@mail.gmail.com>
To: dev@httpd.apache.org
X-Mailer: Apple Mail (2.3094)

Yann, care to apply your eyeballs to this one? Old one is reverted. =
Thanks!

Index: modules/http2/h2_util.c
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D
--- modules/http2/h2_util.c	(revision 1707479)
+++ modules/http2/h2_util.c	(working copy)
@@ -539,14 +539,36 @@
                               apr_size_t *plen, int *peos)
 {
     apr_status_t status;
+    apr_off_t blen =3D 0;
+
     /* test read to determine available length */
-    apr_off_t blen =3D 0;
-    status =3D apr_brigade_length(bb, 0, &blen);
-    if (blen < (apr_off_t)*plen) {
-        *plen =3D blen;
+    status =3D apr_brigade_length(bb, 1, &blen);
+    if (status !=3D APR_SUCCESS) {
+        return status;
     }
-    *peos =3D h2_util_has_eos(bb, *plen);
-    return status;
+    else if (blen =3D=3D 0) {
+        /* empty brigade, does it have an EOS bucket somwhere? */
+        *plen =3D 0;
+        *peos =3D h2_util_has_eos(bb, 0);
+    }
+    else if (blen > 0) {
+        /* data in the brigade, limit the length returned. Check for =
EOS
+         * bucket only if we indicate data. This is required since plen =
=3D=3D 0
+         * means "the whole brigade" for h2_util_hash_eos()
+         */
+        if (blen < (apr_off_t)*plen) {
+            *plen =3D blen;
+        }
+        *peos =3D (*plen > 0)? h2_util_has_eos(bb, *plen) : 0;
+    }
+    else if (blen < 0) {
+        /* famous SHOULD NOT HAPPEN, sinc we told apr_brigade_length to =
readall
+         */
+        *plen =3D 0;
+        *peos =3D h2_util_has_eos(bb, 0);
+        return APR_EINVAL;
+    }
+    return APR_SUCCESS;
 }
=20
 apr_status_t h2_util_bb_readx(apr_bucket_brigade *bb,=20
Index: modules/http2/h2_version.h
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D
--- modules/http2/h2_version.h	(revision 1707479)
+++ modules/http2/h2_version.h	(working copy)
@@ -20,7 +20,7 @@
  * @macro
  * Version number of the h2 module as c string
  */
-#define MOD_HTTP2_VERSION "0.9.9"
+#define MOD_HTTP2_VERSION "1.0.0"
=20
 /**
  * @macro
@@ -28,7 +28,7 @@
  * release. This is a 24 bit number with 8 bits for major number, 8 =
bits
  * for minor and 8 bits for patch. Version 1.2.3 becomes 0x010203.
  */
-#define MOD_HTTP2_VERSION_NUM 0x000909
+#define MOD_HTTP2_VERSION_NUM 0x010000
=20

> Am 08.10.2015 um 12:30 schrieb Yann Ylavic <ylavic.dev@gmail.com>:
>=20
> On Thu, Oct 8, 2015 at 12:06 PM, Stefan Eissing
> <stefan.eissing@greenbytes.de> wrote:
>> I need a tiny patch for mod_http2 that solves an empty response =
problem with the latest nghttp2 libraries:
>>=20
>> Jim, can we get that still in? Commited in trunk as r1707468.
>=20
> I quickly ask (since I did not check all the h2_util_has_eos(bb, 0)
> callers paths and you may know that already), what happens to the EOS
> bucket it is in the brigade along with other non-empty buckets and
> hence the callers consider we are not EOS?
> Does it get stripped somehow or the next run will find it?


From dev-return-84157-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Thu Oct  8 11:24:05 2015
Return-Path: <dev-return-84157-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 8051118E13
	for <apmail-httpd-dev-archive@www.apache.org>; Thu,  8 Oct 2015 11:24:05 +0000 (UTC)
Received: (qmail 73353 invoked by uid 500); 8 Oct 2015 11:23:48 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 73286 invoked by uid 500); 8 Oct 2015 11:23:48 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 73276 invoked by uid 99); 8 Oct 2015 11:23:48 -0000
Received: from Unknown (HELO spamd2-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 08 Oct 2015 11:23:48 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd2-us-west.apache.org (ASF Mail Server at spamd2-us-west.apache.org) with ESMTP id 612561A24CB
	for <dev@httpd.apache.org>; Thu,  8 Oct 2015 11:23:48 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd2-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.01
X-Spam-Level:
X-Spam-Status: No, score=-0.01 tagged_above=-999 required=6.31
	tests=[SPF_PASS=-0.001, T_RP_MATCHES_RCVD=-0.01, URIBL_BLOCKED=0.001]
	autolearn=disabled
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd2-us-west.apache.org [10.40.0.9]) (amavisd-new, port 10024)
	with ESMTP id SRiJDFAieQc3 for <dev@httpd.apache.org>;
	Thu,  8 Oct 2015 11:23:36 +0000 (UTC)
Received: from mail.greenbytes.de (mail.greenbytes.de [217.91.35.233])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id B5A9127DB4
	for <dev@httpd.apache.org>; Thu,  8 Oct 2015 11:23:35 +0000 (UTC)
Received: from [192.168.1.42] (unknown [5.10.171.186])
	(using TLSv1 with cipher ECDHE-RSA-AES256-SHA (256/256 bits))
	(Client did not present a certificate)
	by mail.greenbytes.de (Postfix) with ESMTPSA id 0AA7515A00A5
	for <dev@httpd.apache.org>; Thu,  8 Oct 2015 13:23:34 +0200 (CEST)
Content-Type: text/plain; charset=utf-8
Mime-Version: 1.0 (Mac OS X Mail 9.0 \(3094\))
Subject: Re: about those async filters
From: Stefan Eissing <stefan.eissing@greenbytes.de>
In-Reply-To: <EE293ED9-29D4-4000-9F1A-E0BD9A03D840@sharp.fm>
Date: Thu, 8 Oct 2015 13:23:34 +0200
Content-Transfer-Encoding: quoted-printable
Message-Id: <00F85451-CFA8-4D16-A468-038506C1EF1B@greenbytes.de>
References: <114310CC-D227-4912-8651-B3B26F9330C9@greenbytes.de> <7DCE371B-FFB1-4254-B599-467A7827A991@sharp.fm> <CE2F280D-2036-47C2-B636-A14FB0412DB2@greenbytes.de> <EE293ED9-29D4-4000-9F1A-E0BD9A03D840@sharp.fm>
To: dev@httpd.apache.org
X-Mailer: Apple Mail (2.3094)

Graham,=20

I am very happy to get such feedback and start thinking about how to =
make the http/2 integration tighter. As it is designed now, it was =
intended to fit into a 2.4.x server which limited several design =
decisions and resulted in the separate worker pool. Since HTTP/2 changes =
the processing model for a server (unless you just reverse proxy it in =
front of the http/1 engine), not all existing parts will fit unchanged.

What you are currently sketching below is that http2 workers need to =
become one with the mpms and I very much agree. What you described with =
the socket pairs however sounds much more like a in-process reverse =
proxy. That, I think, is not so fantastic.

For example, a lot of use cases serve static files and for best =
performance - I think - we need to directly write the file, chunked as =
needed by the transport, onto the outgoing connection. So, the file =
bucket (or the handle itself) should find its way from the slave to the =
master connection. This is what mod_http2 already achieves.

Jim invented the slave connections in trunk, where the relation ship =
between master and slaves is visible to all. This is nice. I could not =
use them for the 2.4 approach and I think there are some multi-threading =
issues around pool reclaiming open... But ultimately, the existence of =
slave connections will become visible to a lot of parts of the server =
and pretending that we still live in http/1 land becomes harder and =
harder (or affords more and more compromise).

HTTP/2 on https:// connections, as reported by Firefox, is currently at =
~30% of requests.

//Stefan

PS. As to the prefork compatiblity: mod_http2 has by default a single =
worker thread in this mpm. One can configure more, of course.


> Am 08.10.2015 um 12:56 schrieb Graham Leggett <minfrin@sharp.fm>:
>=20
> On 07 Oct 2015, at 4:30 PM, Stefan Eissing =
<stefan.eissing@greenbytes.de> wrote:
>=20
>> In http2 land, the request happen on "pseudo" connections, =
connections properly created by ap_run_create_connection(), but with own =
filters of type AP_FTYPE_PROTOCOL and AP_FTYPE_NETWORK, registered by =
mod_h2.=20
>>=20
>> These filters copy the data (or move the files) across the processing =
filters thread into the h2 multiplexer (h2_mplx) where the master =
connection thread reads it and send it out to the client, properly =
framed for HTTP/2.
>=20
> Having gone through this in a bit more detail (and slept on it) I =
simultaneously see how we needed to do this to reach this point given =
the limitations of the server, but at the same time this approach causes =
a number of problems that we need to solve in the medium term (which is =
doable from what I can see).
>=20
> What mod_http2 is doing is creating it=E2=80=99s own =
=E2=80=9Cmini-worker-mpm=E2=80=9D inside the module, and this creates a =
number of problems. The first is that code out there that cares about =
being single threaded (historically php, for example) suddenly finds =
itself running in a =E2=80=9Cpseudo-worker=E2=80=9D MPM when the actual =
MPM in use is prefork. This will cause unexpected breakage for people =
trying to use http2.
>=20
> The second problem is that with mod_http2 being a =E2=80=9Cpseudo-mpm=E2=
=80=9D, it needs to emulate all the functions of an mpm in order to =
correctly do so. I believe the problems with async filters are a =
manifestation of mod_http2 not implementing all the capabilities of an =
MPM. We could try and make mod_http2 do so, but I think ultimately =
we=E2=80=99re making life hard for ourselves - we should really be =
leveraging the MPMs directly to make workers for us instead of trying to =
bake workers of our own.
>=20
> So, bringing this down to actual practical stuff we can do to make =
this happen, the basic problems to solve are:
>=20
> - The master connection currently runs under an existing MPM, and this =
works fine today.
> - The slave connection needs to run under an existing MPM instead of =
the =E2=80=9Cpseudo MPM=E2=80=9D it works under today.
> - In theory, we can let the master connection and slave connection =
talk to each other over two pairs of sockets otherwise created with =
socketpair() (workaround for Windows at =
http://code.activestate.com/recipes/525487-extending-socketsocketpair-to-w=
ork-on-windows/).
> - We would need a mechanism to inject the just-created socket into the =
MPM=E2=80=99s worker queue (ie in event MPM, call push2worker()), that =
would be an additional call to MPMs that could support it.
> - When the slave connection is accepted by the worker, the normal =
request acceptance mechanism applies. We might signal the connection is =
an HTTP2 slave connection on the request line in some way, or perhaps =
emulate HTTP/1.1 (not sure if workable), will need to come up with a =
solution.
>=20
> Regards,
> Graham
> =E2=80=94
>=20


From dev-return-84158-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Thu Oct  8 11:26:57 2015
Return-Path: <dev-return-84158-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 6344F18E2D
	for <apmail-httpd-dev-archive@www.apache.org>; Thu,  8 Oct 2015 11:26:57 +0000 (UTC)
Received: (qmail 77886 invoked by uid 500); 8 Oct 2015 11:26:56 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 77804 invoked by uid 500); 8 Oct 2015 11:26:56 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 77794 invoked by uid 99); 8 Oct 2015 11:26:56 -0000
Received: from Unknown (HELO spamd1-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 08 Oct 2015 11:26:56 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd1-us-west.apache.org (ASF Mail Server at spamd1-us-west.apache.org) with ESMTP id 18C3CC48DD
	for <dev@httpd.apache.org>; Thu,  8 Oct 2015 11:26:56 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd1-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.101
X-Spam-Level:
X-Spam-Status: No, score=-0.101 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RCVD_IN_MSPIKE_H2=-0.001, SPF_PASS=-0.001, URIBL_BLOCKED=0.001]
	autolearn=disabled
Authentication-Results: spamd1-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd1-us-west.apache.org [10.40.0.7]) (amavisd-new, port 10024)
	with ESMTP id cVlQ5oC3G6sH for <dev@httpd.apache.org>;
	Thu,  8 Oct 2015 11:26:55 +0000 (UTC)
Received: from mail-qg0-f50.google.com (mail-qg0-f50.google.com [209.85.192.50])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id BEC4C28280
	for <dev@httpd.apache.org>; Thu,  8 Oct 2015 11:26:54 +0000 (UTC)
Received: by qgt47 with SMTP id 47so38636848qgt.2
        for <dev@httpd.apache.org>; Thu, 08 Oct 2015 04:26:53 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        bh=zjERchGEAEWmBYPo/a+gBXnJPrA9p6vQqMfuyp4t3yE=;
        b=iDHM73a09wzgCei1FGajW+CpnfkpvatzYuH8TTMBnNLWFfndzLSRHMX58imuDDjufo
         UBYu+1V1oC6B4Ji0D2mppkPmPwTKl067E6y6ZFxJGL2RIwqknbLYpYNHtFUzChjjS+uo
         OwlsAdOmouKWXWODzBzNFVBOQRJEhaRFJGwzTabIuAhMMXsn3LWoevszO81O8BqlbbKL
         kDVDPURSVzuTjKtN7WmXWX0rEhbItaHImJKUwJisHPAcsBVJjslKRtW2e1/wkuGDbKnI
         yjU/EkD7ZLGZ1yuYwXw1vTXChLqfyy5sR5dgZ9QKWnW/tMAgBmSzsWJaCCcGUugVwVAl
         xC6Q==
MIME-Version: 1.0
X-Received: by 10.140.101.119 with SMTP id t110mr7647490qge.71.1444303613724;
 Thu, 08 Oct 2015 04:26:53 -0700 (PDT)
Received: by 10.55.72.20 with HTTP; Thu, 8 Oct 2015 04:26:53 -0700 (PDT)
In-Reply-To: <6F5B6977-6103-4A11-868B-2F686F0B4226@greenbytes.de>
References: <B3EE8F05-26C7-4B79-B335-B6A431571022@greenbytes.de>
	<CAKQ1sVMThLzUCt03BJ+accZKYrnHmexY4mpwnRyXCXRbA+J-RA@mail.gmail.com>
	<6F5B6977-6103-4A11-868B-2F686F0B4226@greenbytes.de>
Date: Thu, 8 Oct 2015 13:26:53 +0200
Message-ID: <CAKQ1sVO7s=cTUzJsEEAQYZgPabY3RfzH+A-gqOpHLrw5HBZhsg@mail.gmail.com>
Subject: Re: stop the press!
From: Yann Ylavic <ylavic.dev@gmail.com>
To: dev@httpd.apache.org
Content-Type: text/plain; charset=UTF-8

On Thu, Oct 8, 2015 at 1:05 PM, Stefan Eissing
<stefan.eissing@greenbytes.de> wrote:
> Yann, care to apply your eyeballs to this one? Old one is reverted. Thanks!
>
> Index: modules/http2/h2_util.c
> ===================================================================
> --- modules/http2/h2_util.c     (revision 1707479)
> +++ modules/http2/h2_util.c     (working copy)
> @@ -539,14 +539,36 @@
>                                apr_size_t *plen, int *peos)
>  {
>      apr_status_t status;
> +    apr_off_t blen = 0;
> +
>      /* test read to determine available length */
> -    apr_off_t blen = 0;
> -    status = apr_brigade_length(bb, 0, &blen);
> -    if (blen < (apr_off_t)*plen) {
> -        *plen = blen;
> +    status = apr_brigade_length(bb, 1, &blen);
> +    if (status != APR_SUCCESS) {
> +        return status;
>      }
> -    *peos = h2_util_has_eos(bb, *plen);
> -    return status;
> +    else if (blen == 0) {
> +        /* empty brigade, does it have an EOS bucket somwhere? */
> +        *plen = 0;
> +        *peos = h2_util_has_eos(bb, 0);
> +    }
> +    else if (blen > 0) {
> +        /* data in the brigade, limit the length returned. Check for EOS
> +         * bucket only if we indicate data. This is required since plen == 0
> +         * means "the whole brigade" for h2_util_hash_eos()
> +         */
> +        if (blen < (apr_off_t)*plen) {
> +            *plen = blen;
> +        }
> +        *peos = (*plen > 0)? h2_util_has_eos(bb, *plen) : 0;

Maybe last_not_included() could "eat" leading metadata buckets when
called with maxlen == 0, that is remove the leading "if (maxlen > 0)"
in there.
Hence we could call h2_util_has_eos(bb, *plen) unconditionally here
and still still detect EOS.

Can't tell about the other uses of ast_not_included() though...

> +    }
> +    else if (blen < 0) {
> +        /* famous SHOULD NOT HAPPEN, sinc we told apr_brigade_length to readall
> +         */
> +        *plen = 0;
> +        *peos = h2_util_has_eos(bb, 0);
> +        return APR_EINVAL;
> +    }

This seems not needed, maybe change (blen == 0) to (blen <= 0) above
to protect from stray photons?


> +    return APR_SUCCESS;
>  }

From dev-return-84159-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Thu Oct  8 11:36:59 2015
Return-Path: <dev-return-84159-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id CFF5418E82
	for <apmail-httpd-dev-archive@www.apache.org>; Thu,  8 Oct 2015 11:36:59 +0000 (UTC)
Received: (qmail 94387 invoked by uid 500); 8 Oct 2015 11:36:59 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 94310 invoked by uid 500); 8 Oct 2015 11:36:59 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 94299 invoked by uid 99); 8 Oct 2015 11:36:59 -0000
Received: from Unknown (HELO spamd3-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 08 Oct 2015 11:36:59 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd3-us-west.apache.org (ASF Mail Server at spamd3-us-west.apache.org) with ESMTP id EB234180E1A
	for <dev@httpd.apache.org>; Thu,  8 Oct 2015 11:36:58 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd3-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.121
X-Spam-Level:
X-Spam-Status: No, score=-0.121 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RCVD_IN_MSPIKE_H3=-0.01, RCVD_IN_MSPIKE_WL=-0.01, SPF_PASS=-0.001]
	autolearn=disabled
Authentication-Results: spamd3-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd3-us-west.apache.org [10.40.0.10]) (amavisd-new, port 10024)
	with ESMTP id tTzRFr4UJq2w for <dev@httpd.apache.org>;
	Thu,  8 Oct 2015 11:36:58 +0000 (UTC)
Received: from mail-qk0-f179.google.com (mail-qk0-f179.google.com [209.85.220.179])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id B1C2A2315E
	for <dev@httpd.apache.org>; Thu,  8 Oct 2015 11:36:57 +0000 (UTC)
Received: by qkdo1 with SMTP id o1so8563092qkd.1
        for <dev@httpd.apache.org>; Thu, 08 Oct 2015 04:36:56 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        bh=RC7mPuWeLyQwlGCqCVhK5e18E9ts03hujaffEcJ2puA=;
        b=suMR/9Um01TSTIE12gQQa5Xp0pCWxo2C7ViHi7vVRE4vH6AHqsn+fNlgvWLaeTdPJZ
         F/O91A+tkVG7rnyDjd+/6feyebE8QE4PR3nBHw33vagz+9JHgAjVzrOGig9ts4ApfsTH
         c40eNz1g3wpNCN94CdP8vY5iDIGxUkIXPpx6Zfyh/m3oqnzTNUcqoRnlX8nU4pee+dWc
         BTjFF0FRqtXH4InwVxqXXJTwZeS3fegJVHj+BvijowpkU2QXQh7E7ad8shzEp95jGmrv
         Hdp07G4c4My6NglnUNYRiJNd7DXt1b8WMPuBBxgLpP807u3VNhp1NFHSzjTD85ULsfB2
         xuFw==
MIME-Version: 1.0
X-Received: by 10.55.192.15 with SMTP id o15mr7568629qki.2.1444304216864; Thu,
 08 Oct 2015 04:36:56 -0700 (PDT)
Received: by 10.55.72.20 with HTTP; Thu, 8 Oct 2015 04:36:56 -0700 (PDT)
In-Reply-To: <CAKQ1sVO7s=cTUzJsEEAQYZgPabY3RfzH+A-gqOpHLrw5HBZhsg@mail.gmail.com>
References: <B3EE8F05-26C7-4B79-B335-B6A431571022@greenbytes.de>
	<CAKQ1sVMThLzUCt03BJ+accZKYrnHmexY4mpwnRyXCXRbA+J-RA@mail.gmail.com>
	<6F5B6977-6103-4A11-868B-2F686F0B4226@greenbytes.de>
	<CAKQ1sVO7s=cTUzJsEEAQYZgPabY3RfzH+A-gqOpHLrw5HBZhsg@mail.gmail.com>
Date: Thu, 8 Oct 2015 13:36:56 +0200
Message-ID: <CAKQ1sVNbjgiXutXcu0UhWqJF_6EudNPwZv9qOwthrUSY6Z=MqQ@mail.gmail.com>
Subject: Re: stop the press!
From: Yann Ylavic <ylavic.dev@gmail.com>
To: dev@httpd.apache.org
Content-Type: text/plain; charset=UTF-8

On Thu, Oct 8, 2015 at 1:26 PM, Yann Ylavic <ylavic.dev@gmail.com> wrote:
>
> Maybe last_not_included() could "eat" leading metadata buckets when
> called with maxlen == 0, that is remove the leading "if (maxlen > 0)"
> in there.

Possibly the original code with this only change would work too...

From dev-return-84160-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Thu Oct  8 11:38:33 2015
Return-Path: <dev-return-84160-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 4049818E8F
	for <apmail-httpd-dev-archive@www.apache.org>; Thu,  8 Oct 2015 11:38:33 +0000 (UTC)
Received: (qmail 97200 invoked by uid 500); 8 Oct 2015 11:38:32 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 97126 invoked by uid 500); 8 Oct 2015 11:38:32 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 97116 invoked by uid 99); 8 Oct 2015 11:38:32 -0000
Received: from Unknown (HELO spamd1-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 08 Oct 2015 11:38:32 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd1-us-west.apache.org (ASF Mail Server at spamd1-us-west.apache.org) with ESMTP id 34FB2C4A7F
	for <dev@httpd.apache.org>; Thu,  8 Oct 2015 11:38:32 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd1-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.01
X-Spam-Level:
X-Spam-Status: No, score=-0.01 tagged_above=-999 required=6.31
	tests=[SPF_PASS=-0.001, T_RP_MATCHES_RCVD=-0.01, URIBL_BLOCKED=0.001]
	autolearn=disabled
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd1-us-west.apache.org [10.40.0.7]) (amavisd-new, port 10024)
	with ESMTP id mtQ_KklKyY0l for <dev@httpd.apache.org>;
	Thu,  8 Oct 2015 11:38:23 +0000 (UTC)
Received: from mail.greenbytes.de (mail.greenbytes.de [217.91.35.233])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id 4DF25439B6
	for <dev@httpd.apache.org>; Thu,  8 Oct 2015 11:38:23 +0000 (UTC)
Received: from [192.168.1.42] (unknown [5.10.171.186])
	(using TLSv1 with cipher ECDHE-RSA-AES256-SHA (256/256 bits))
	(Client did not present a certificate)
	by mail.greenbytes.de (Postfix) with ESMTPSA id EF31415A00DB
	for <dev@httpd.apache.org>; Thu,  8 Oct 2015 13:38:21 +0200 (CEST)
Content-Type: text/plain; charset=us-ascii
Mime-Version: 1.0 (Mac OS X Mail 9.0 \(3094\))
Subject: Re: stop the press!
From: Stefan Eissing <stefan.eissing@greenbytes.de>
In-Reply-To: <CAKQ1sVO7s=cTUzJsEEAQYZgPabY3RfzH+A-gqOpHLrw5HBZhsg@mail.gmail.com>
Date: Thu, 8 Oct 2015 13:38:21 +0200
Content-Transfer-Encoding: quoted-printable
Message-Id: <54317A51-5546-4401-B101-6FE2AF12D6C4@greenbytes.de>
References: <B3EE8F05-26C7-4B79-B335-B6A431571022@greenbytes.de> <CAKQ1sVMThLzUCt03BJ+accZKYrnHmexY4mpwnRyXCXRbA+J-RA@mail.gmail.com> <6F5B6977-6103-4A11-868B-2F686F0B4226@greenbytes.de> <CAKQ1sVO7s=cTUzJsEEAQYZgPabY3RfzH+A-gqOpHLrw5HBZhsg@mail.gmail.com>
To: dev@httpd.apache.org
X-Mailer: Apple Mail (2.3094)

Thanks for the review. Comments below.

> Am 08.10.2015 um 13:26 schrieb Yann Ylavic <ylavic.dev@gmail.com>:
>=20
> On Thu, Oct 8, 2015 at 1:05 PM, Stefan Eissing
> <stefan.eissing@greenbytes.de> wrote:
>> Yann, care to apply your eyeballs to this one? Old one is reverted. =
Thanks!
>>=20
>> Index: modules/http2/h2_util.c
>> =3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D
>> --- modules/http2/h2_util.c     (revision 1707479)
>> +++ modules/http2/h2_util.c     (working copy)
>> @@ -539,14 +539,36 @@
>>                               apr_size_t *plen, int *peos)
>> {
>>     apr_status_t status;
>> +    apr_off_t blen =3D 0;
>> +
>>     /* test read to determine available length */
>> -    apr_off_t blen =3D 0;
>> -    status =3D apr_brigade_length(bb, 0, &blen);
>> -    if (blen < (apr_off_t)*plen) {
>> -        *plen =3D blen;
>> +    status =3D apr_brigade_length(bb, 1, &blen);
>> +    if (status !=3D APR_SUCCESS) {
>> +        return status;
>>     }
>> -    *peos =3D h2_util_has_eos(bb, *plen);
>> -    return status;
>> +    else if (blen =3D=3D 0) {
>> +        /* empty brigade, does it have an EOS bucket somwhere? */
>> +        *plen =3D 0;
>> +        *peos =3D h2_util_has_eos(bb, 0);
>> +    }
>> +    else if (blen > 0) {
>> +        /* data in the brigade, limit the length returned. Check for =
EOS
>> +         * bucket only if we indicate data. This is required since =
plen =3D=3D 0
>> +         * means "the whole brigade" for h2_util_hash_eos()
>> +         */
>> +        if (blen < (apr_off_t)*plen) {
>> +            *plen =3D blen;
>> +        }
>> +        *peos =3D (*plen > 0)? h2_util_has_eos(bb, *plen) : 0;
>=20
> Maybe last_not_included() could "eat" leading metadata buckets when
> called with maxlen =3D=3D 0, that is remove the leading "if (maxlen > =
0)"
> in there.
> Hence we could call h2_util_has_eos(bb, *plen) unconditionally here
> and still still detect EOS.
>=20
> Can't tell about the other uses of ast_not_included() though...

Often, mod_http2 needs to transfer a max amount of data. Sometimes
it "moves" buckets from one brigade to another. Sometimes, it just
needs to detect how much data *can* be moved.

last_not_included is used to determine the bucket in a brigade that
will not be moved with the length limit given.

Since the brigade is already being inspected, it is useful to find
out if a read would already encounter an EOS. This prevents the transfer
from being invoked again. Since these transfer often require mutex =
locks, less
is better.

For the length limit, just data bucket lengths are counted. Meta buckets
count as zero length. So, with a brigade

(1)data[1024] -> (2)data[730] -> (3)EOS -> SENTINEL

last_not_included(100) would be bucket 2.
last_not_included(1024) would be bucket 2.
last_not_included(1025) would be bucket 3.
last_not_included(2048) would be bucket SENTINEL.

//Stefan

>> +    }
>> +    else if (blen < 0) {
>> +        /* famous SHOULD NOT HAPPEN, sinc we told apr_brigade_length =
to readall
>> +         */
>> +        *plen =3D 0;
>> +        *peos =3D h2_util_has_eos(bb, 0);
>> +        return APR_EINVAL;
>> +    }
>=20
> This seems not needed, maybe change (blen =3D=3D 0) to (blen <=3D 0) =
above
> to protect from stray photons?
>=20
>=20
>> +    return APR_SUCCESS;
>> }


From dev-return-84161-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Thu Oct  8 11:45:36 2015
Return-Path: <dev-return-84161-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id CBEC418EAD
	for <apmail-httpd-dev-archive@www.apache.org>; Thu,  8 Oct 2015 11:45:36 +0000 (UTC)
Received: (qmail 13277 invoked by uid 500); 8 Oct 2015 11:45:36 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 13199 invoked by uid 500); 8 Oct 2015 11:45:36 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 13189 invoked by uid 99); 8 Oct 2015 11:45:36 -0000
Received: from Unknown (HELO spamd3-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 08 Oct 2015 11:45:36 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd3-us-west.apache.org (ASF Mail Server at spamd3-us-west.apache.org) with ESMTP id D4754180E1A
	for <dev@httpd.apache.org>; Thu,  8 Oct 2015 11:45:35 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd3-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 0.653
X-Spam-Level:
X-Spam-Status: No, score=0.653 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, SPF_NEUTRAL=0.652,
	URIBL_BLOCKED=0.001] autolearn=disabled
Authentication-Results: spamd3-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=comcast.net
Received: from mx1-us-west.apache.org ([10.40.0.8])
	by localhost (spamd3-us-west.apache.org [10.40.0.10]) (amavisd-new, port 10024)
	with ESMTP id klOAuO134r9I for <dev@httpd.apache.org>;
	Thu,  8 Oct 2015 11:45:25 +0000 (UTC)
Received: from resqmta-ch2-09v.sys.comcast.net (resqmta-ch2-09v.sys.comcast.net [69.252.207.41])
	by mx1-us-west.apache.org (ASF Mail Server at mx1-us-west.apache.org) with ESMTPS id 0BA3A2031C
	for <dev@httpd.apache.org>; Thu,  8 Oct 2015 11:45:24 +0000 (UTC)
Received: from resomta-ch2-06v.sys.comcast.net ([69.252.207.102])
	by resqmta-ch2-09v.sys.comcast.net with comcast
	id SblG1r0022D5gil01blJ9h; Thu, 08 Oct 2015 11:45:18 +0000
Received: from [192.168.199.10] ([69.251.84.114])
	by resomta-ch2-06v.sys.comcast.net with comcast
	id SblJ1r0012U0RYt01blJyy; Thu, 08 Oct 2015 11:45:18 +0000
Content-Type: text/plain; charset=utf-8
Mime-Version: 1.0 (Mac OS X Mail 8.2 \(2104\))
Subject: Re: about those async filters
From: Jim Jagielski <jim@jaguNET.com>
In-Reply-To: <EE293ED9-29D4-4000-9F1A-E0BD9A03D840@sharp.fm>
Date: Thu, 8 Oct 2015 07:45:17 -0400
Content-Transfer-Encoding: quoted-printable
Message-Id: <F0C3BCD3-0301-4108-A09A-9BDC6E362770@jaguNET.com>
References: <114310CC-D227-4912-8651-B3B26F9330C9@greenbytes.de> <7DCE371B-FFB1-4254-B599-467A7827A991@sharp.fm> <CE2F280D-2036-47C2-B636-A14FB0412DB2@greenbytes.de> <EE293ED9-29D4-4000-9F1A-E0BD9A03D840@sharp.fm>
To: dev@httpd.apache.org
X-Mailer: Apple Mail (2.2104)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=comcast.net;
	s=q20140121; t=1444304718;
	bh=S0yoCRAspPW5moasEkjAgC4867X309kykh5MQtDskes=;
	h=Received:Received:Content-Type:Mime-Version:Subject:From:Date:
	 Message-Id:To;
	b=aOaW48UQxMg9qL1FR6ejJ+UdQAuMtWSSePyT+WLdKw4q1agAgJlM5HdlVVIzR7jau
	 yP4TrJdqhDFayELMMO4rkvR6Pr3p4dgTS2oX4FZAKofKaQKDRAVcAjHe5IpD97TQvB
	 PeVErvL4s73du3uhMFd/47mo1SOXRmyHZB4/AUVGckPSQB4SGuiRm5Qnpx0j+LnKSm
	 wLfl3lHc4ErTUU9qQ1OdxuZuNeD82SIhAZSdkSdypNyoXJvz0PZ00FTUcVib0h8tjG
	 76HSc+fDeSF300UEjz6YkBhHNoBWF9Nxzg+BkSecrwAccYQrxNIYPuD9LROba8rL/J
	 J5zcvbXDfHJ5Q==

Yeah... it was 'always' foreseen that mod_h2/mod_http2 would provide
useful clues on how to make 2.6/3.0 better, especially w/ the idea of
slave connections; basically, as you say, let the MPM make mod_http2's
job easier by abstracting out a lot of the tricks that mod_http2 needs
to do to something that the MPMs themselves provide.

At that same time, however, was/is the need/desire to support http/2
in 2.4.x (in fact, mod_h2 was *designed* w/ 2.4 in mind). So we are
in this initial stage where what's in trunk isn't perfect for trunk
(http/2-wise) but that's because it's really architectured for 2.4.

Once 2.4.17 is out, then I expect mod_http2 to start diverging between
the trunk and 2.4 variants, as the version in trunk drives the MPM
designs there, which correspondingly drives mod_http2 in trunk as well
(ala a feedback loop). My goal was/is to make motorz "ideally" suited to
support http2.

> On Oct 8, 2015, at 6:56 AM, Graham Leggett <minfrin@sharp.fm> wrote:
>=20
> On 07 Oct 2015, at 4:30 PM, Stefan Eissing =
<stefan.eissing@greenbytes.de> wrote:
>=20
>> In http2 land, the request happen on "pseudo" connections, =
connections properly created by ap_run_create_connection(), but with own =
filters of type AP_FTYPE_PROTOCOL and AP_FTYPE_NETWORK, registered by =
mod_h2.=20
>>=20
>> These filters copy the data (or move the files) across the processing =
filters thread into the h2 multiplexer (h2_mplx) where the master =
connection thread reads it and send it out to the client, properly =
framed for HTTP/2.
>=20
> Having gone through this in a bit more detail (and slept on it) I =
simultaneously see how we needed to do this to reach this point given =
the limitations of the server, but at the same time this approach causes =
a number of problems that we need to solve in the medium term (which is =
doable from what I can see).
>=20
> What mod_http2 is doing is creating it=E2=80=99s own =
=E2=80=9Cmini-worker-mpm=E2=80=9D inside the module, and this creates a =
number of problems. The first is that code out there that cares about =
being single threaded (historically php, for example) suddenly finds =
itself running in a =E2=80=9Cpseudo-worker=E2=80=9D MPM when the actual =
MPM in use is prefork. This will cause unexpected breakage for people =
trying to use http2.
>=20
> The second problem is that with mod_http2 being a =E2=80=9Cpseudo-mpm=E2=
=80=9D, it needs to emulate all the functions of an mpm in order to =
correctly do so. I believe the problems with async filters are a =
manifestation of mod_http2 not implementing all the capabilities of an =
MPM. We could try and make mod_http2 do so, but I think ultimately =
we=E2=80=99re making life hard for ourselves - we should really be =
leveraging the MPMs directly to make workers for us instead of trying to =
bake workers of our own.
>=20
> So, bringing this down to actual practical stuff we can do to make =
this happen, the basic problems to solve are:
>=20
> - The master connection currently runs under an existing MPM, and this =
works fine today.
> - The slave connection needs to run under an existing MPM instead of =
the =E2=80=9Cpseudo MPM=E2=80=9D it works under today.
> - In theory, we can let the master connection and slave connection =
talk to each other over two pairs of sockets otherwise created with =
socketpair() (workaround for Windows at =
http://code.activestate.com/recipes/525487-extending-socketsocketpair-to-w=
ork-on-windows/).
> - We would need a mechanism to inject the just-created socket into the =
MPM=E2=80=99s worker queue (ie in event MPM, call push2worker()), that =
would be an additional call to MPMs that could support it.
> - When the slave connection is accepted by the worker, the normal =
request acceptance mechanism applies. We might signal the connection is =
an HTTP2 slave connection on the request line in some way, or perhaps =
emulate HTTP/1.1 (not sure if workable), will need to come up with a =
solution.
>=20
> Regards,
> Graham
> =E2=80=94
>=20


From dev-return-84162-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Thu Oct  8 11:53:39 2015
Return-Path: <dev-return-84162-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 13C5518F08
	for <apmail-httpd-dev-archive@www.apache.org>; Thu,  8 Oct 2015 11:53:39 +0000 (UTC)
Received: (qmail 38130 invoked by uid 500); 8 Oct 2015 11:53:28 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 38059 invoked by uid 500); 8 Oct 2015 11:53:28 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 38049 invoked by uid 99); 8 Oct 2015 11:53:28 -0000
Received: from Unknown (HELO spamd1-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 08 Oct 2015 11:53:28 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd1-us-west.apache.org (ASF Mail Server at spamd1-us-west.apache.org) with ESMTP id E021DC4B0B
	for <dev@httpd.apache.org>; Thu,  8 Oct 2015 11:53:27 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd1-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.01
X-Spam-Level:
X-Spam-Status: No, score=-0.01 tagged_above=-999 required=6.31
	tests=[SPF_PASS=-0.001, T_RP_MATCHES_RCVD=-0.01, URIBL_BLOCKED=0.001]
	autolearn=disabled
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd1-us-west.apache.org [10.40.0.7]) (amavisd-new, port 10024)
	with ESMTP id qPXUo-h4qeMQ for <dev@httpd.apache.org>;
	Thu,  8 Oct 2015 11:53:21 +0000 (UTC)
Received: from monica.sharp.fm (monica.sharp.fm [80.168.143.5])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTP id 4C4902315E
	for <dev@httpd.apache.org>; Thu,  8 Oct 2015 11:53:21 +0000 (UTC)
Received: from [192.168.220.234] (unknown [192.168.220.234])
	(using TLSv1 with cipher DHE-RSA-AES256-SHA (256/256 bits))
	(Client did not present a certificate)
	(Authenticated sender: minfrin@sharp.fm)
	by monica.sharp.fm (Postfix) with ESMTPSA id A8ADF83154
	for <dev@httpd.apache.org>; Thu,  8 Oct 2015 12:53:20 +0100 (BST)
Content-Type: text/plain; charset=utf-8
Mime-Version: 1.0 (Mac OS X Mail 8.2 \(2104\))
Subject: Re: about those async filters
From: Graham Leggett <minfrin@sharp.fm>
In-Reply-To: <00F85451-CFA8-4D16-A468-038506C1EF1B@greenbytes.de>
Date: Thu, 8 Oct 2015 13:53:19 +0200
Content-Transfer-Encoding: quoted-printable
Message-Id: <DB473D61-EDA9-4403-A9C7-FDB6972DB736@sharp.fm>
References: <114310CC-D227-4912-8651-B3B26F9330C9@greenbytes.de> <7DCE371B-FFB1-4254-B599-467A7827A991@sharp.fm> <CE2F280D-2036-47C2-B636-A14FB0412DB2@greenbytes.de> <EE293ED9-29D4-4000-9F1A-E0BD9A03D840@sharp.fm> <00F85451-CFA8-4D16-A468-038506C1EF1B@greenbytes.de>
To: dev@httpd.apache.org
X-Mailer: Apple Mail (2.2104)

On 08 Oct 2015, at 1:23 PM, Stefan Eissing =
<stefan.eissing@greenbytes.de> wrote:

> I am very happy to get such feedback and start thinking about how to =
make the http/2 integration tighter. As it is designed now, it was =
intended to fit into a 2.4.x server which limited several design =
decisions and resulted in the separate worker pool. Since HTTP/2 changes =
the processing model for a server (unless you just reverse proxy it in =
front of the http/1 engine), not all existing parts will fit unchanged.

As I already pointed out, the reasons for the existing design are =
understood - however one big limitation is now lifted, and that is with =
mod_http2 being in the httpd core, mod_http2 has the opportunity to make =
the changes it needs to the core to lift whatever limitations existed =
before. Subject to our normal backport rules, we have the opportunity to =
make these changes available to the wider server in v2.4.

> What you are currently sketching below is that http2 workers need to =
become one with the mpms and I very much agree. What you described with =
the socket pairs however sounds much more like a in-process reverse =
proxy. That, I think, is not so fantastic.
>=20
> For example, a lot of use cases serve static files and for best =
performance - I think - we need to directly write the file, chunked as =
needed by the transport, onto the outgoing connection. So, the file =
bucket (or the handle itself) should find its way from the slave to the =
master connection. This is what mod_http2 already achieves.

Right now one use case - static files - is being prioritised at a =
significant detriment to the operation of the rest of the server, and =
this is far from ideal.

There are solutions to the file buckets problem, it is quite possible to =
provide a mechanism to tunnel file descriptors from the slave connection =
to the master. I don=E2=80=99t see this as a blocker.

> Jim invented the slave connections in trunk, where the relation ship =
between master and slaves is visible to all. This is nice. I could not =
use them for the 2.4 approach and I think there are some multi-threading =
issues around pool reclaiming open... But ultimately, the existence of =
slave connections will become visible to a lot of parts of the server =
and pretending that we still live in http/1 land becomes harder and =
harder (or affords more and more compromise).

As I said about the HTTP/1.1 emulation on the slave connections, I=E2=80=99=
m not sure if it=E2=80=99s workable. Either way it=E2=80=99s not =
critical, as long as the correct handler steps up to process the slave =
connections we will be fine.

> HTTP/2 on https:// connections, as reported by Firefox, is currently =
at ~30% of requests.

We need to make sure we haven=E2=80=99t made a step backwards in the =
core of the server. The event MPM solved the C10k problem for file =
handling, and the async filters generalises this to all filters (most =
critically SSL) and all types of content. We need to make sure that =
mod_http2 doesn=E2=80=99t undo that work and make requests synchronous =
again.

Regards,
Graham
=E2=80=94


From dev-return-84163-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Thu Oct  8 11:56:54 2015
Return-Path: <dev-return-84163-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id A9EAA18F26
	for <apmail-httpd-dev-archive@www.apache.org>; Thu,  8 Oct 2015 11:56:54 +0000 (UTC)
Received: (qmail 48726 invoked by uid 500); 8 Oct 2015 11:56:54 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 48651 invoked by uid 500); 8 Oct 2015 11:56:54 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 48641 invoked by uid 99); 8 Oct 2015 11:56:54 -0000
Received: from Unknown (HELO spamd1-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 08 Oct 2015 11:56:54 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd1-us-west.apache.org (ASF Mail Server at spamd1-us-west.apache.org) with ESMTP id BE3DDC4AD7
	for <dev@httpd.apache.org>; Thu,  8 Oct 2015 11:56:53 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd1-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.1
X-Spam-Level:
X-Spam-Status: No, score=-0.1 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	SPF_PASS=-0.001, URIBL_BLOCKED=0.001] autolearn=disabled
Authentication-Results: spamd1-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-us-west.apache.org ([10.40.0.8])
	by localhost (spamd1-us-west.apache.org [10.40.0.7]) (amavisd-new, port 10024)
	with ESMTP id TNEiGk1thCRp for <dev@httpd.apache.org>;
	Thu,  8 Oct 2015 11:56:48 +0000 (UTC)
Received: from mail-qg0-f51.google.com (mail-qg0-f51.google.com [209.85.192.51])
	by mx1-us-west.apache.org (ASF Mail Server at mx1-us-west.apache.org) with ESMTPS id 231772304E
	for <dev@httpd.apache.org>; Thu,  8 Oct 2015 11:56:48 +0000 (UTC)
Received: by qgez77 with SMTP id z77so39357312qge.1
        for <dev@httpd.apache.org>; Thu, 08 Oct 2015 04:56:47 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        bh=C8jPsbfTd5OjZerVYzZxNG4ZcPJFLSaEy8tM5FCjpAg=;
        b=Oqx2htRXvUC1FbGKyJSQ5iaSnmY/Um47AChTEK+XfxXh4jfQVlPPp5FDhzs1ihVM1B
         mwinqqlX4LagQqLOTvDWTU/LkyuxB0S0TCzSGYySytLi9nScFXOXyDifsLvpmGTACwnX
         cy+Au7Up6UGGFzfWXgFstwgYkDpMtys5gpHlwzSj7fAjvkQal2+QAAHLfE51ox1k4/Hf
         8BUvS8V0r8nYcI0YZZ5d/9GZue9RpfE38tnCRIP+GDLNnhJW2WAhKWAiSyiIAVpXXFps
         Ahblv2mv/a1MMq3X01Wxjmcb+qOcLv0aN4AlXMaui9fehyxwvQCxZlJretHZFpPMz4bl
         PLSA==
MIME-Version: 1.0
X-Received: by 10.140.131.70 with SMTP id 67mr8239262qhd.70.1444305407371;
 Thu, 08 Oct 2015 04:56:47 -0700 (PDT)
Received: by 10.55.72.20 with HTTP; Thu, 8 Oct 2015 04:56:47 -0700 (PDT)
In-Reply-To: <54317A51-5546-4401-B101-6FE2AF12D6C4@greenbytes.de>
References: <B3EE8F05-26C7-4B79-B335-B6A431571022@greenbytes.de>
	<CAKQ1sVMThLzUCt03BJ+accZKYrnHmexY4mpwnRyXCXRbA+J-RA@mail.gmail.com>
	<6F5B6977-6103-4A11-868B-2F686F0B4226@greenbytes.de>
	<CAKQ1sVO7s=cTUzJsEEAQYZgPabY3RfzH+A-gqOpHLrw5HBZhsg@mail.gmail.com>
	<54317A51-5546-4401-B101-6FE2AF12D6C4@greenbytes.de>
Date: Thu, 8 Oct 2015 13:56:47 +0200
Message-ID: <CAKQ1sVPTFXhJGXNBEK_yn8tP4kZdYwzJJ345JtiF3ix84msTvA@mail.gmail.com>
Subject: Re: stop the press!
From: Yann Ylavic <ylavic.dev@gmail.com>
To: dev@httpd.apache.org
Content-Type: text/plain; charset=UTF-8

On Thu, Oct 8, 2015 at 1:38 PM, Stefan Eissing
<stefan.eissing@greenbytes.de> wrote:
>>
>> Can't tell about the other uses of ast_not_included() though...
>
> Often, mod_http2 needs to transfer a max amount of data. Sometimes
> it "moves" buckets from one brigade to another. Sometimes, it just
> needs to detect how much data *can* be moved.
>
> last_not_included is used to determine the bucket in a brigade that
> will not be moved with the length limit given.
>
> Since the brigade is already being inspected, it is useful to find
> out if a read would already encounter an EOS. This prevents the transfer
> from being invoked again. Since these transfer often require mutex locks, less
> is better.
>
> For the length limit, just data bucket lengths are counted. Meta buckets
> count as zero length. So, with a brigade
>
> (1)data[1024] -> (2)data[730] -> (3)EOS -> SENTINEL
>
> last_not_included(100) would be bucket 2.
> last_not_included(1024) would be bucket 2.
> last_not_included(1025) would be bucket 3.
> last_not_included(2048) would be bucket SENTINEL.

OK, the change I proposed was only for simplification, your patch
already handles that anyway.
So we can change that later if necessary, the code looks good to me now.

Thanks Stefan.

From dev-return-84164-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Thu Oct  8 11:59:52 2015
Return-Path: <dev-return-84164-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 74F4F18F3E
	for <apmail-httpd-dev-archive@www.apache.org>; Thu,  8 Oct 2015 11:59:52 +0000 (UTC)
Received: (qmail 56802 invoked by uid 500); 8 Oct 2015 11:59:47 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 56718 invoked by uid 500); 8 Oct 2015 11:59:47 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 56707 invoked by uid 99); 8 Oct 2015 11:59:47 -0000
Received: from Unknown (HELO spamd2-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 08 Oct 2015 11:59:46 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd2-us-west.apache.org (ASF Mail Server at spamd2-us-west.apache.org) with ESMTP id 946681A24DA
	for <dev@httpd.apache.org>; Thu,  8 Oct 2015 11:59:46 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd2-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.009
X-Spam-Level:
X-Spam-Status: No, score=-0.009 tagged_above=-999 required=6.31
	tests=[T_RP_MATCHES_RCVD=-0.01, URIBL_BLOCKED=0.001]
	autolearn=disabled
Received: from mx1-us-west.apache.org ([10.40.0.8])
	by localhost (spamd2-us-west.apache.org [10.40.0.9]) (amavisd-new, port 10024)
	with ESMTP id FVphXcITBMOH for <dev@httpd.apache.org>;
	Thu,  8 Oct 2015 11:59:31 +0000 (UTC)
Received: from monica.sharp.fm (monica.sharp.fm [80.168.143.5])
	by mx1-us-west.apache.org (ASF Mail Server at mx1-us-west.apache.org) with ESMTP id B9D6F20756
	for <dev@httpd.apache.org>; Thu,  8 Oct 2015 11:59:31 +0000 (UTC)
Received: from [192.168.220.234] (unknown [192.168.220.234])
	(using TLSv1 with cipher DHE-RSA-AES256-SHA (256/256 bits))
	(Client did not present a certificate)
	(Authenticated sender: minfrin@sharp.fm)
	by monica.sharp.fm (Postfix) with ESMTPSA id 5ACCB83144
	for <dev@httpd.apache.org>; Thu,  8 Oct 2015 12:59:24 +0100 (BST)
Content-Type: text/plain; charset=utf-8
Mime-Version: 1.0 (Mac OS X Mail 8.2 \(2104\))
Subject: Re: about those async filters
From: Graham Leggett <minfrin@sharp.fm>
In-Reply-To: <F0C3BCD3-0301-4108-A09A-9BDC6E362770@jaguNET.com>
Date: Thu, 8 Oct 2015 13:59:23 +0200
Content-Transfer-Encoding: quoted-printable
Message-Id: <EFD8D90A-B8B6-419F-B963-744F3ADF3DF6@sharp.fm>
References: <114310CC-D227-4912-8651-B3B26F9330C9@greenbytes.de> <7DCE371B-FFB1-4254-B599-467A7827A991@sharp.fm> <CE2F280D-2036-47C2-B636-A14FB0412DB2@greenbytes.de> <EE293ED9-29D4-4000-9F1A-E0BD9A03D840@sharp.fm> <F0C3BCD3-0301-4108-A09A-9BDC6E362770@jaguNET.com>
To: dev@httpd.apache.org
X-Mailer: Apple Mail (2.2104)

On 08 Oct 2015, at 1:45 PM, Jim Jagielski <jim@jaguNET.com> wrote:

> Yeah... it was 'always' foreseen that mod_h2/mod_http2 would provide
> useful clues on how to make 2.6/3.0 better, especially w/ the idea of
> slave connections; basically, as you say, let the MPM make mod_http2's
> job easier by abstracting out a lot of the tricks that mod_http2 needs
> to do to something that the MPMs themselves provide.
>=20
> At that same time, however, was/is the need/desire to support http/2
> in 2.4.x (in fact, mod_h2 was *designed* w/ 2.4 in mind). So we are
> in this initial stage where what's in trunk isn't perfect for trunk
> (http/2-wise) but that's because it's really architectured for 2.4.
>=20
> Once 2.4.17 is out, then I expect mod_http2 to start diverging between
> the trunk and 2.4 variants, as the version in trunk drives the MPM
> designs there, which correspondingly drives mod_http2 in trunk as well
> (ala a feedback loop). My goal was/is to make motorz "ideally" suited =
to
> support http2.

I don=E2=80=99t yet see a big necessity for diverging. So far the =
changes required have all been backportable to the v2.4 series, and I =
believe we should continue to strive to do so until we find we really =
can=E2=80=99t.

I am sensitive to our release cycles - on purpose, we don=E2=80=99t =
release minor releases often, and that is a good thing. We want to ship =
something that is stable that people can deploy and forget about, rather =
than something that changes out from underneath you every six months.

I don=E2=80=99t want to wait till v2.6 to get async behaviour, and I =
don=E2=80=99t believe we have to. :)

Regards,
Graham
=E2=80=94


From dev-return-84165-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Thu Oct  8 12:00:05 2015
Return-Path: <dev-return-84165-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 85D3018F4D
	for <apmail-httpd-dev-archive@www.apache.org>; Thu,  8 Oct 2015 12:00:05 +0000 (UTC)
Received: (qmail 57921 invoked by uid 500); 8 Oct 2015 12:00:00 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 57855 invoked by uid 500); 8 Oct 2015 12:00:00 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 57838 invoked by uid 99); 8 Oct 2015 12:00:00 -0000
Received: from Unknown (HELO spamd2-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 08 Oct 2015 12:00:00 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd2-us-west.apache.org (ASF Mail Server at spamd2-us-west.apache.org) with ESMTP id 875891A24DA
	for <dev@httpd.apache.org>; Thu,  8 Oct 2015 11:59:59 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd2-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 2.881
X-Spam-Level: **
X-Spam-Status: No, score=2.881 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	HTML_MESSAGE=3, RCVD_IN_MSPIKE_H3=-0.01, RCVD_IN_MSPIKE_WL=-0.01,
	URIBL_BLOCKED=0.001] autolearn=disabled
Authentication-Results: spamd2-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd2-us-west.apache.org [10.40.0.9]) (amavisd-new, port 10024)
	with ESMTP id 0RgIW9YiU2t0 for <dev@httpd.apache.org>;
	Thu,  8 Oct 2015 11:59:48 +0000 (UTC)
Received: from mail-ig0-f180.google.com (mail-ig0-f180.google.com [209.85.213.180])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id 864CE2315E
	for <dev@httpd.apache.org>; Thu,  8 Oct 2015 11:59:47 +0000 (UTC)
Received: by igcpe7 with SMTP id pe7so10773947igc.0
        for <dev@httpd.apache.org>; Thu, 08 Oct 2015 04:59:46 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=mime-version:date:message-id:subject:from:to:content-type;
        bh=/PxTmhiNBI5HekD90eBZ+96SJtOMlCXwav/NDgAPdbs=;
        b=l88Xp9zvaemO2Aa69ggud0akhoyVjlucKeu6IiII71+6gr8/tje0XAn9JCdvlO3K1l
         kGtPhMpqtspmWZ07fIEyHppvs+4VFjPEWyQ8n8FJgEgqDeVaYna6qfkyBS87ffy5e1dF
         6eN0dB1hNmz4V9r+J1K2DRPX3mcQ5atL90r6G57pY998jxXvwhg3EHUJ1syShElndUBH
         LsPd9PhDezOQJEB9zl0a974vilPvb9xm7mXssx99w/idv4fJCQ/m5FqMi3AyhKRq7ZP1
         LIq+L/O74gc4/IFUCb8U6uIf0dQqR9e4/AdDfZLY2n05pKLOR67wxMabihr2Cvf7X4H/
         /kVQ==
MIME-Version: 1.0
X-Received: by 10.50.142.1 with SMTP id rs1mr3229941igb.17.1444305586433; Thu,
 08 Oct 2015 04:59:46 -0700 (PDT)
Received: by 10.36.37.18 with HTTP; Thu, 8 Oct 2015 04:59:46 -0700 (PDT)
Date: Thu, 8 Oct 2015 07:59:46 -0400
Message-ID: <CAKUrXK4xdSO3952a=8cq1ike4OdWF6=4qiQyP3B7K2Yzd6TUMg@mail.gmail.com>
Subject: mod_http2 version number
From: Jeff Trawick <trawick@gmail.com>
To: Apache HTTP Server Development List <dev@httpd.apache.org>
Content-Type: multipart/alternative; boundary=001a1130c3566d349e05219699b3

--001a1130c3566d349e05219699b3
Content-Type: text/plain; charset=UTF-8

Can we get rid of this?  The only meaningful version is the httpd version.
 (I guess mod_ssl still pretends to have a meaningful version number.)

I could see a potential use of a separate version number in the very short
term to indicate API breakages in this "experimental" component that we
couldn't with an MMN Major change, but then the version number has to be
updated following certain rules and the purpose has to be well described to
module authors, and module authors mucking with internals of this should be
following httpd dev closely anyway, at least until it is not experimental.

-- 
Born in Roswell... married an alien...
http://emptyhammock.com/

--001a1130c3566d349e05219699b3
Content-Type: text/html; charset=UTF-8
Content-Transfer-Encoding: quoted-printable

<div dir=3D"ltr">Can we get rid of this?=C2=A0 The only meaningful version =
is the httpd version. =C2=A0(I guess mod_ssl still pretends to have a meani=
ngful version number.)<div><br></div><div>I could see a potential use of a =
separate version number in the very short term to indicate API breakages in=
 this &quot;experimental&quot; component that we couldn&#39;t with an MMN M=
ajor change, but then the version number has to be updated following certai=
n rules and the purpose has to be well described to module authors, and mod=
ule authors mucking with internals of this should be following httpd dev cl=
osely anyway, at least until it is not experimental.</div><div><br>-- <br><=
div class=3D"gmail_signature"><div dir=3D"ltr">Born in Roswell... married a=
n alien...<br><a href=3D"http://emptyhammock.com/" target=3D"_blank">http:/=
/emptyhammock.com/</a><div><br></div></div></div>
</div></div>

--001a1130c3566d349e05219699b3--

From dev-return-84166-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Thu Oct  8 12:08:57 2015
Return-Path: <dev-return-84166-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id F137418F90
	for <apmail-httpd-dev-archive@www.apache.org>; Thu,  8 Oct 2015 12:08:56 +0000 (UTC)
Received: (qmail 74395 invoked by uid 500); 8 Oct 2015 12:08:39 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 74321 invoked by uid 500); 8 Oct 2015 12:08:38 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 74311 invoked by uid 99); 8 Oct 2015 12:08:38 -0000
Received: from Unknown (HELO spamd4-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 08 Oct 2015 12:08:38 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd4-us-west.apache.org (ASF Mail Server at spamd4-us-west.apache.org) with ESMTP id 8751DC0BDA
	for <dev@httpd.apache.org>; Thu,  8 Oct 2015 12:08:38 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd4-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.01
X-Spam-Level:
X-Spam-Status: No, score=-0.01 tagged_above=-999 required=6.31
	tests=[SPF_PASS=-0.001, T_RP_MATCHES_RCVD=-0.01, URIBL_BLOCKED=0.001]
	autolearn=disabled
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd4-us-west.apache.org [10.40.0.11]) (amavisd-new, port 10024)
	with ESMTP id vXYNACPZko7Q for <dev@httpd.apache.org>;
	Thu,  8 Oct 2015 12:08:30 +0000 (UTC)
Received: from mail.greenbytes.de (mail.greenbytes.de [217.91.35.233])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id 0DECC439CB
	for <dev@httpd.apache.org>; Thu,  8 Oct 2015 12:08:29 +0000 (UTC)
Received: from [192.168.1.42] (unknown [5.10.171.186])
	(using TLSv1 with cipher ECDHE-RSA-AES256-SHA (256/256 bits))
	(Client did not present a certificate)
	by mail.greenbytes.de (Postfix) with ESMTPSA id 472CC15A0309
	for <dev@httpd.apache.org>; Thu,  8 Oct 2015 14:08:28 +0200 (CEST)
Content-Type: text/plain; charset=us-ascii
Mime-Version: 1.0 (Mac OS X Mail 9.0 \(3094\))
Subject: Re: mod_http2 version number
From: Stefan Eissing <stefan.eissing@greenbytes.de>
In-Reply-To: <CAKUrXK4xdSO3952a=8cq1ike4OdWF6=4qiQyP3B7K2Yzd6TUMg@mail.gmail.com>
Date: Thu, 8 Oct 2015 14:08:27 +0200
Content-Transfer-Encoding: quoted-printable
Message-Id: <CA15E57E-064E-4A53-B358-2C62698E304A@greenbytes.de>
References: <CAKUrXK4xdSO3952a=8cq1ike4OdWF6=4qiQyP3B7K2Yzd6TUMg@mail.gmail.com>
To: dev@httpd.apache.org
X-Mailer: Apple Mail (2.3094)

Well, it is used only in one INFO log statement on startup...

There are now several people who participated in early trials if mod_h2 =
and gave really useful feedback and found bugs. Without a version number =
of the module being visible in the log somewhere, it would make this =
kind of tests much more difficult.

While the module is experimental, I'd like to continue giving the =
adventurous types early experience versions. That way we can gather =
useful feedback between release cycles.

Once we leave the experimental mode and merge all tighter to the core, =
this version number becomes meaningless and should go.

//Stefan

> Am 08.10.2015 um 13:59 schrieb Jeff Trawick <trawick@gmail.com>:
>=20
> Can we get rid of this?  The only meaningful version is the httpd =
version.  (I guess mod_ssl still pretends to have a meaningful version =
number.)
>=20
> I could see a potential use of a separate version number in the very =
short term to indicate API breakages in this "experimental" component =
that we couldn't with an MMN Major change, but then the version number =
has to be updated following certain rules and the purpose has to be well =
described to module authors, and module authors mucking with internals =
of this should be following httpd dev closely anyway, at least until it =
is not experimental.
>=20
> --=20
> Born in Roswell... married an alien...
> http://emptyhammock.com/
>=20


From dev-return-84167-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Thu Oct  8 12:12:38 2015
Return-Path: <dev-return-84167-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id D120418FAF
	for <apmail-httpd-dev-archive@www.apache.org>; Thu,  8 Oct 2015 12:12:38 +0000 (UTC)
Received: (qmail 78441 invoked by uid 500); 8 Oct 2015 12:12:22 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 78367 invoked by uid 500); 8 Oct 2015 12:12:22 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 78357 invoked by uid 99); 8 Oct 2015 12:12:22 -0000
Received: from Unknown (HELO spamd3-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 08 Oct 2015 12:12:22 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd3-us-west.apache.org (ASF Mail Server at spamd3-us-west.apache.org) with ESMTP id 1CAED180E2B
	for <dev@httpd.apache.org>; Thu,  8 Oct 2015 12:12:22 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd3-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.802
X-Spam-Level:
X-Spam-Status: No, score=-0.802 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RCVD_IN_DNSWL_LOW=-0.7, RCVD_IN_MSPIKE_H2=-0.001, SPF_PASS=-0.001]
	autolearn=disabled
Authentication-Results: spamd3-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-us-west.apache.org ([10.40.0.8])
	by localhost (spamd3-us-west.apache.org [10.40.0.10]) (amavisd-new, port 10024)
	with ESMTP id M-x6vtWA-fnX for <dev@httpd.apache.org>;
	Thu,  8 Oct 2015 12:12:21 +0000 (UTC)
Received: from mail-qg0-f41.google.com (mail-qg0-f41.google.com [209.85.192.41])
	by mx1-us-west.apache.org (ASF Mail Server at mx1-us-west.apache.org) with ESMTPS id 030C320756
	for <dev@httpd.apache.org>; Thu,  8 Oct 2015 12:12:21 +0000 (UTC)
Received: by qgx61 with SMTP id 61so39538623qgx.3
        for <dev@httpd.apache.org>; Thu, 08 Oct 2015 05:12:20 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        bh=I1KvrIJE28SbvJte5qeLyVfaPFPn0sKZySm4R7jBxME=;
        b=jvNUMcfSU8Zs1ZI5BlR0u0xYxXjZwN7LtM9DmlJL9AsZaE4nYsMUYCpQ6cLo0a+10p
         b99Zp7i0AQOq8ekXvgQFpltdwzbf1wCwNgxpcw7bzAehdXeOeJwvpXFoVD3rfmOHAEaZ
         CLcKR4Idl4+Kkjr/X7GL3xnCdkE531UBsF/+r0sPdQl810VYWxRFjN53SSbjglkvHX+3
         ls6miwvbin829HMD9Oh++MHIgmjqf0/Fmz11m52vnp1MAYs9ComL9Ze1IVq/sATl7WGj
         gGpgSo84Zyb/6i+d0UGD2gHR94ZJBklcA+iTW3f2SekdbC8VD59N7THrsycCpKksmCJm
         JKnw==
MIME-Version: 1.0
X-Received: by 10.140.107.54 with SMTP id g51mr7783938qgf.38.1444306340139;
 Thu, 08 Oct 2015 05:12:20 -0700 (PDT)
Received: by 10.55.72.20 with HTTP; Thu, 8 Oct 2015 05:12:20 -0700 (PDT)
In-Reply-To: <CAKQ1sVPTFXhJGXNBEK_yn8tP4kZdYwzJJ345JtiF3ix84msTvA@mail.gmail.com>
References: <B3EE8F05-26C7-4B79-B335-B6A431571022@greenbytes.de>
	<CAKQ1sVMThLzUCt03BJ+accZKYrnHmexY4mpwnRyXCXRbA+J-RA@mail.gmail.com>
	<6F5B6977-6103-4A11-868B-2F686F0B4226@greenbytes.de>
	<CAKQ1sVO7s=cTUzJsEEAQYZgPabY3RfzH+A-gqOpHLrw5HBZhsg@mail.gmail.com>
	<54317A51-5546-4401-B101-6FE2AF12D6C4@greenbytes.de>
	<CAKQ1sVPTFXhJGXNBEK_yn8tP4kZdYwzJJ345JtiF3ix84msTvA@mail.gmail.com>
Date: Thu, 8 Oct 2015 14:12:20 +0200
Message-ID: <CAKQ1sVOS+oUVGOSbeAVj4D7QQYDJTiF9eauc_8zcLEVJPu2qLQ@mail.gmail.com>
Subject: Re: stop the press!
From: Yann Ylavic <ylavic.dev@gmail.com>
To: dev@httpd.apache.org
Content-Type: text/plain; charset=UTF-8

On Thu, Oct 8, 2015 at 1:56 PM, Yann Ylavic <ylavic.dev@gmail.com> wrote:
>
> So we can change that later if necessary

Something like this maybe:

Index: modules/http2/h2_util.c
===================================================================
--- modules/http2/h2_util.c    (revision 1707505)
+++ modules/http2/h2_util.c    (working copy)
@@ -215,7 +215,7 @@ static const int FILE_MOVE = 1;

 static apr_status_t last_not_included(apr_bucket_brigade *bb,
                                       apr_size_t maxlen,
-                                      int same_alloc,
+                                      int same_alloc, int meta_only,
                                       int *pfile_buckets_allowed,
                                       apr_bucket **pend)
 {
@@ -223,7 +223,7 @@ static apr_status_t last_not_included(apr_bucket_b
     apr_status_t status = APR_SUCCESS;
     int files_allowed = pfile_buckets_allowed? *pfile_buckets_allowed : 0;

-    if (maxlen > 0) {
+    if (maxlen > 0 || meta_only) {
         /* Find the bucket, up to which we reach maxlen/mem bytes */
         for (b = APR_BRIGADE_FIRST(bb);
              (b != APR_BRIGADE_SENTINEL(bb));
@@ -291,7 +291,7 @@ apr_status_t h2_util_move(apr_bucket_brigade *to,
     if (!APR_BRIGADE_EMPTY(from)) {
         apr_bucket *b, *end;

-        status = last_not_included(from, maxlen, same_alloc,
+        status = last_not_included(from, maxlen, same_alloc, 0,
                                    pfile_handles_allowed, &end);
         if (status != APR_SUCCESS) {
             return status;
@@ -419,7 +419,7 @@ apr_status_t h2_util_copy(apr_bucket_brigade *to,
     if (!APR_BRIGADE_EMPTY(from)) {
         apr_bucket *b, *end, *cpy;

-        status = last_not_included(from, maxlen, 0, 0, &end);
+        status = last_not_included(from, maxlen, 0, 0, 0, &end);
         if (status != APR_SUCCESS) {
             return status;
         }
@@ -486,7 +486,7 @@ int h2_util_has_eos(apr_bucket_brigade *bb, apr_si
 {
     apr_bucket *b, *end;

-    apr_status_t status = last_not_included(bb, len, 0, 0, &end);
+    apr_status_t status = last_not_included(bb, len, 0, 1, 0, &end);
     if (status != APR_SUCCESS) {
         return status;
     }
@@ -546,28 +546,11 @@ apr_status_t h2_util_bb_avail(apr_bucket_brigade *
     if (status != APR_SUCCESS) {
         return status;
     }
-    else if (blen == 0) {
-        /* empty brigade, does it have an EOS bucket somwhere? */
-        *plen = 0;
-        *peos = h2_util_has_eos(bb, 0);
+
+    if (blen < (apr_off_t)*plen) {
+        *plen = blen;
     }
-    else if (blen > 0) {
-        /* data in the brigade, limit the length returned. Check for EOS
-         * bucket only if we indicate data. This is required since plen == 0
-         * means "the whole brigade" for h2_util_hash_eos()
-         */
-        if (blen < (apr_off_t)*plen) {
-            *plen = blen;
-        }
-        *peos = (*plen > 0)? h2_util_has_eos(bb, *plen) : 0;
-    }
-    else if (blen < 0) {
-        /* famous SHOULD NOT HAPPEN, sinc we told apr_brigade_length to readall
-         */
-        *plen = 0;
-        *peos = h2_util_has_eos(bb, 0);
-        return APR_EINVAL;
-    }
+    *peos = h2_util_has_eos(bb, *plen);
     return APR_SUCCESS;
 }

From dev-return-84168-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Thu Oct  8 12:13:11 2015
Return-Path: <dev-return-84168-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 96EC018FB4
	for <apmail-httpd-dev-archive@www.apache.org>; Thu,  8 Oct 2015 12:13:11 +0000 (UTC)
Received: (qmail 79683 invoked by uid 500); 8 Oct 2015 12:12:55 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 79611 invoked by uid 500); 8 Oct 2015 12:12:55 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 79601 invoked by uid 99); 8 Oct 2015 12:12:55 -0000
Received: from Unknown (HELO spamd1-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 08 Oct 2015 12:12:55 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd1-us-west.apache.org (ASF Mail Server at spamd1-us-west.apache.org) with ESMTP id D78E9C4B2F
	for <dev@httpd.apache.org>; Thu,  8 Oct 2015 12:12:54 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd1-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 2.9
X-Spam-Level: **
X-Spam-Status: No, score=2.9 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	HTML_MESSAGE=3, SPF_PASS=-0.001, URIBL_BLOCKED=0.001]
	autolearn=disabled
Authentication-Results: spamd1-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd1-us-west.apache.org [10.40.0.7]) (amavisd-new, port 10024)
	with ESMTP id FXUmPbGc1SOF for <dev@httpd.apache.org>;
	Thu,  8 Oct 2015 12:12:45 +0000 (UTC)
Received: from mail-ig0-f174.google.com (mail-ig0-f174.google.com [209.85.213.174])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id C287C439BC
	for <dev@httpd.apache.org>; Thu,  8 Oct 2015 12:12:44 +0000 (UTC)
Received: by igbkq10 with SMTP id kq10so13196111igb.0
        for <dev@httpd.apache.org>; Thu, 08 Oct 2015 05:12:44 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        bh=RsdPoU1DnaXRjQLdQsDD3cQTOafqNutDlbezpyDHdDg=;
        b=LsLZlRVUKp3zmmwFssASeP9012cmm+Ql6wJk4xPTh0S5ulV9xhm+FX9jBem/cfztzH
         P/JYeycA1387n5ehoAUni4BhdwGZQLolRAyB/JNxXt7xHPgyHyvgD4DEaCsiQnAxPfsg
         cW0+Li7qG0MPqnkhnpGp1O2bymOflfdX9UagkDcTal43qk3MrT4u+OhanBVRiABI7iu6
         H6O43VYJfocoj5IrzBl3GsXgvr+IiYKr3vZmwSmr7KClWJpUwJkFMNaAFcISwZybolDu
         acxWxe7cOI59fSlZQesSN+KplrMiee/J+3DaV6KMB58Kb+8bxfLlgCfFm/JzTav32r2s
         RrWg==
MIME-Version: 1.0
X-Received: by 10.50.142.1 with SMTP id rs1mr3314880igb.17.1444306364323; Thu,
 08 Oct 2015 05:12:44 -0700 (PDT)
Received: by 10.36.37.18 with HTTP; Thu, 8 Oct 2015 05:12:44 -0700 (PDT)
In-Reply-To: <CA15E57E-064E-4A53-B358-2C62698E304A@greenbytes.de>
References: <CAKUrXK4xdSO3952a=8cq1ike4OdWF6=4qiQyP3B7K2Yzd6TUMg@mail.gmail.com>
	<CA15E57E-064E-4A53-B358-2C62698E304A@greenbytes.de>
Date: Thu, 8 Oct 2015 08:12:44 -0400
Message-ID: <CAKUrXK588MCEUN956e33Bu-COns50YgV-T4JPxXsjf5DCPD8ZQ@mail.gmail.com>
Subject: Re: mod_http2 version number
From: Jeff Trawick <trawick@gmail.com>
To: Apache HTTP Server Development List <dev@httpd.apache.org>
Content-Type: multipart/alternative; boundary=001a1130c356cae2a8052196c766

--001a1130c356cae2a8052196c766
Content-Type: text/plain; charset=UTF-8

On Thu, Oct 8, 2015 at 8:08 AM, Stefan Eissing <stefan.eissing@greenbytes.de
> wrote:

> Well, it is used only in one INFO log statement on startup...
>
> There are now several people who participated in early trials if mod_h2
> and gave really useful feedback and found bugs. Without a version number of
> the module being visible in the log somewhere, it would make this kind of
> tests much more difficult.
>
> While the module is experimental, I'd like to continue giving the
> adventurous types early experience versions. That way we can gather useful
> feedback between release cycles.
>

Cool, thanks...  (I guess they'll get a patch to put over 2.4.17, and the
patch will have a modified version.)


>
> Once we leave the experimental mode and merge all tighter to the core,
> this version number becomes meaningless and should go.
>
> //Stefan
>
> > Am 08.10.2015 um 13:59 schrieb Jeff Trawick <trawick@gmail.com>:
> >
> > Can we get rid of this?  The only meaningful version is the httpd
> version.  (I guess mod_ssl still pretends to have a meaningful version
> number.)
> >
> > I could see a potential use of a separate version number in the very
> short term to indicate API breakages in this "experimental" component that
> we couldn't with an MMN Major change, but then the version number has to be
> updated following certain rules and the purpose has to be well described to
> module authors, and module authors mucking with internals of this should be
> following httpd dev closely anyway, at least until it is not experimental.
> >
> > --
> > Born in Roswell... married an alien...
> > http://emptyhammock.com/
> >
>
>


-- 
Born in Roswell... married an alien...
http://emptyhammock.com/

--001a1130c356cae2a8052196c766
Content-Type: text/html; charset=UTF-8
Content-Transfer-Encoding: quoted-printable

<div dir=3D"ltr"><div class=3D"gmail_extra"><div class=3D"gmail_quote">On T=
hu, Oct 8, 2015 at 8:08 AM, Stefan Eissing <span dir=3D"ltr">&lt;<a href=3D=
"mailto:stefan.eissing@greenbytes.de" target=3D"_blank">stefan.eissing@gree=
nbytes.de</a>&gt;</span> wrote:<br><blockquote class=3D"gmail_quote" style=
=3D"margin:0 0 0 .8ex;border-left:1px #ccc solid;padding-left:1ex">Well, it=
 is used only in one INFO log statement on startup...<br>
<br>
There are now several people who participated in early trials if mod_h2 and=
 gave really useful feedback and found bugs. Without a version number of th=
e module being visible in the log somewhere, it would make this kind of tes=
ts much more difficult.<br>
<br>
While the module is experimental, I&#39;d like to continue giving the adven=
turous types early experience versions. That way we can gather useful feedb=
ack between release cycles.<br></blockquote><div><br></div><div>Cool, thank=
s... =C2=A0(I guess they&#39;ll get a patch to put over 2.4.17, and the pat=
ch will have a modified version.)</div><div>=C2=A0<br></div><blockquote cla=
ss=3D"gmail_quote" style=3D"margin:0 0 0 .8ex;border-left:1px #ccc solid;pa=
dding-left:1ex">
<br>
Once we leave the experimental mode and merge all tighter to the core, this=
 version number becomes meaningless and should go.<br>
<span class=3D"HOEnZb"><font color=3D"#888888"><br>
//Stefan<br>
</font></span><div class=3D"HOEnZb"><div class=3D"h5"><br>
&gt; Am 08.10.2015 um 13:59 schrieb Jeff Trawick &lt;<a href=3D"mailto:traw=
ick@gmail.com">trawick@gmail.com</a>&gt;:<br>
&gt;<br>
&gt; Can we get rid of this?=C2=A0 The only meaningful version is the httpd=
 version.=C2=A0 (I guess mod_ssl still pretends to have a meaningful versio=
n number.)<br>
&gt;<br>
&gt; I could see a potential use of a separate version number in the very s=
hort term to indicate API breakages in this &quot;experimental&quot; compon=
ent that we couldn&#39;t with an MMN Major change, but then the version num=
ber has to be updated following certain rules and the purpose has to be wel=
l described to module authors, and module authors mucking with internals of=
 this should be following httpd dev closely anyway, at least until it is no=
t experimental.<br>
&gt;<br>
&gt; --<br>
&gt; Born in Roswell... married an alien...<br>
&gt; <a href=3D"http://emptyhammock.com/" rel=3D"noreferrer" target=3D"_bla=
nk">http://emptyhammock.com/</a><br>
&gt;<br>
<br>
</div></div></blockquote></div><br><br clear=3D"all"><div><br></div>-- <br>=
<div class=3D"gmail_signature"><div dir=3D"ltr">Born in Roswell... married =
an alien...<br><a href=3D"http://emptyhammock.com/" target=3D"_blank">http:=
//emptyhammock.com/</a><div><br></div></div></div>
</div></div>

--001a1130c356cae2a8052196c766--

From dev-return-84169-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Thu Oct  8 12:13:35 2015
Return-Path: <dev-return-84169-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 88F3418FB8
	for <apmail-httpd-dev-archive@www.apache.org>; Thu,  8 Oct 2015 12:13:35 +0000 (UTC)
Received: (qmail 82267 invoked by uid 500); 8 Oct 2015 12:13:35 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 82201 invoked by uid 500); 8 Oct 2015 12:13:35 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 82191 invoked by uid 99); 8 Oct 2015 12:13:35 -0000
Received: from Unknown (HELO spamd2-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 08 Oct 2015 12:13:35 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd2-us-west.apache.org (ASF Mail Server at spamd2-us-west.apache.org) with ESMTP id AAE6B1A24E3
	for <dev@httpd.apache.org>; Thu,  8 Oct 2015 12:13:34 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd2-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.01
X-Spam-Level:
X-Spam-Status: No, score=-0.01 tagged_above=-999 required=6.31
	tests=[SPF_PASS=-0.001, T_RP_MATCHES_RCVD=-0.01, URIBL_BLOCKED=0.001]
	autolearn=disabled
Received: from mx1-us-west.apache.org ([10.40.0.8])
	by localhost (spamd2-us-west.apache.org [10.40.0.9]) (amavisd-new, port 10024)
	with ESMTP id vpuBHl56IVXa for <dev@httpd.apache.org>;
	Thu,  8 Oct 2015 12:13:26 +0000 (UTC)
Received: from mail.greenbytes.de (mail.greenbytes.de [217.91.35.233])
	by mx1-us-west.apache.org (ASF Mail Server at mx1-us-west.apache.org) with ESMTPS id 66EFF20756
	for <dev@httpd.apache.org>; Thu,  8 Oct 2015 12:13:26 +0000 (UTC)
Received: from [192.168.1.42] (unknown [5.10.171.186])
	(using TLSv1 with cipher ECDHE-RSA-AES256-SHA (256/256 bits))
	(Client did not present a certificate)
	by mail.greenbytes.de (Postfix) with ESMTPSA id DBE8D15A00A5
	for <dev@httpd.apache.org>; Thu,  8 Oct 2015 14:13:24 +0200 (CEST)
Content-Type: text/plain; charset=utf-8
Mime-Version: 1.0 (Mac OS X Mail 9.0 \(3094\))
Subject: Re: about those async filters
From: Stefan Eissing <stefan.eissing@greenbytes.de>
In-Reply-To: <DB473D61-EDA9-4403-A9C7-FDB6972DB736@sharp.fm>
Date: Thu, 8 Oct 2015 14:13:24 +0200
Content-Transfer-Encoding: quoted-printable
Message-Id: <9DC32677-5E0D-482A-9678-4FFAC58816C4@greenbytes.de>
References: <114310CC-D227-4912-8651-B3B26F9330C9@greenbytes.de> <7DCE371B-FFB1-4254-B599-467A7827A991@sharp.fm> <CE2F280D-2036-47C2-B636-A14FB0412DB2@greenbytes.de> <EE293ED9-29D4-4000-9F1A-E0BD9A03D840@sharp.fm> <00F85451-CFA8-4D16-A468-038506C1EF1B@greenbytes.de> <DB473D61-EDA9-4403-A9C7-FDB6972DB736@sharp.fm>
To: dev@httpd.apache.org
X-Mailer: Apple Mail (2.3094)


> Am 08.10.2015 um 13:53 schrieb Graham Leggett <minfrin@sharp.fm>:
>=20
>> HTTP/2 on https:// connections, as reported by Firefox, is currently =
at ~30% of requests.
>=20
> We need to make sure we haven=E2=80=99t made a step backwards in the =
core of the server. The event MPM solved the C10k problem for file =
handling, and the async filters generalises this to all filters (most =
critically SSL) and all types of content. We need to make sure that =
mod_http2 doesn=E2=80=99t undo that work and make requests synchronous =
again.

Totally agree. How can we do that? I am willing to setup test scenarios =
with files/php/proxy to compare performance and see that we do not break =
things. What should I test? Any advice welcome.

//Stefan=

From dev-return-84170-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Thu Oct  8 12:24:59 2015
Return-Path: <dev-return-84170-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 79291180A7
	for <apmail-httpd-dev-archive@www.apache.org>; Thu,  8 Oct 2015 12:24:59 +0000 (UTC)
Received: (qmail 20519 invoked by uid 500); 8 Oct 2015 12:24:56 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 20438 invoked by uid 500); 8 Oct 2015 12:24:56 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 20424 invoked by uid 99); 8 Oct 2015 12:24:55 -0000
Received: from Unknown (HELO spamd3-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 08 Oct 2015 12:24:55 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd3-us-west.apache.org (ASF Mail Server at spamd3-us-west.apache.org) with ESMTP id 8898F1809A5;
	Thu,  8 Oct 2015 12:24:55 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd3-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 0.79
X-Spam-Level:
X-Spam-Status: No, score=0.79 tagged_above=-999 required=6.31
	tests=[KAM_ASCII_DIVIDERS=0.8, SPF_PASS=-0.001,
	T_RP_MATCHES_RCVD=-0.01, URIBL_BLOCKED=0.001] autolearn=disabled
Received: from mx1-us-west.apache.org ([10.40.0.8])
	by localhost (spamd3-us-west.apache.org [10.40.0.10]) (amavisd-new, port 10024)
	with ESMTP id AdcSMEl3gyGy; Thu,  8 Oct 2015 12:24:47 +0000 (UTC)
Received: from mail.greenbytes.de (mail.greenbytes.de [217.91.35.233])
	by mx1-us-west.apache.org (ASF Mail Server at mx1-us-west.apache.org) with ESMTPS id EA6D022F1F;
	Thu,  8 Oct 2015 12:24:46 +0000 (UTC)
Received: from [192.168.1.42] (unknown [5.10.171.186])
	(using TLSv1 with cipher ECDHE-RSA-AES256-SHA (256/256 bits))
	(Client did not present a certificate)
	by mail.greenbytes.de (Postfix) with ESMTPSA id 6705D15A03F4;
	Thu,  8 Oct 2015 14:24:45 +0200 (CEST)
Content-Type: text/plain; charset=us-ascii
Mime-Version: 1.0 (Mac OS X Mail 9.0 \(3094\))
Subject: Re: svn commit: r1707468 - in /httpd/httpd/trunk/modules/http2: h2_util.c h2_version.h
From: Stefan Eissing <stefan.eissing@greenbytes.de>
In-Reply-To: <FF583844-8C3D-44A1-96F1-352E047E89C5@jaguNET.com>
Date: Thu, 8 Oct 2015 14:24:44 +0200
Cc: cvs@httpd.apache.org
Content-Transfer-Encoding: quoted-printable
Message-Id: <30EF37B2-3443-4D23-A26E-2D3752AA44A1@greenbytes.de>
References: <20151008100330.D3AB63A02E5@svn01-us-west.apache.org> <6CFC1A2F-1718-41D3-AC78-217469B94482@jaguNET.com> <8F861099-8CCF-4223-84EB-846091A30B02@greenbytes.de> <FF583844-8C3D-44A1-96F1-352E047E89C5@jaguNET.com>
To: dev@httpd.apache.org
X-Mailer: Apple Mail (2.3094)

All green from my side now.

//Stefan

> Am 08.10.2015 um 12:50 schrieb Jim Jagielski <jim@jagunet.com>:
>=20
> No rush... :)
>=20
>> On Oct 8, 2015, at 6:45 AM, Stefan Eissing =
<stefan.eissing@greenbytes.de> wrote:
>>=20
>> Jim, give me a moment. Yann's code reviewing skill are just too =
good...
>>=20
>> //Stefan
>>=20
>>> Am 08.10.2015 um 12:44 schrieb Jim Jagielski <jim@jaguNET.com>:
>>>=20
>>> I am guessing this should be backported to 2.4.17, right?
>>>=20
>>>> On Oct 8, 2015, at 6:03 AM, icing@apache.org wrote:
>>>>=20
>>>> Author: icing
>>>> Date: Thu Oct  8 10:03:30 2015
>>>> New Revision: 1707468
>>>>=20
>>>> URL: http://svn.apache.org/viewvc?rev=3D1707468&view=3Drev
>>>> Log:
>>>> fix for empty responses with nghttp2 v1.3.x, bump version to 1.0.0
>>>>=20
>>>> Modified:
>>>> httpd/httpd/trunk/modules/http2/h2_util.c
>>>> httpd/httpd/trunk/modules/http2/h2_version.h
>>>>=20
>>>> Modified: httpd/httpd/trunk/modules/http2/h2_util.c
>>>> URL: =
http://svn.apache.org/viewvc/httpd/httpd/trunk/modules/http2/h2_util.c?rev=
=3D1707468&r1=3D1707467&r2=3D1707468&view=3Ddiff
>>>> =
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
>>>> --- httpd/httpd/trunk/modules/http2/h2_util.c (original)
>>>> +++ httpd/httpd/trunk/modules/http2/h2_util.c Thu Oct  8 10:03:30 =
2015
>>>> @@ -484,19 +484,38 @@ int h2_util_has_flush_or_eos(apr_bucket_
>>>>=20
>>>> int h2_util_has_eos(apr_bucket_brigade *bb, apr_size_t len)
>>>> {
>>>> -    apr_bucket *b, *end;
>>>> +    apr_bucket *b;
>>>>=20
>>>> -    apr_status_t status =3D last_not_included(bb, len, 0, 0, =
&end);
>>>> -    if (status !=3D APR_SUCCESS) {
>>>> -        return status;
>>>> +    if (len =3D=3D 0) {
>>>> +        /* special case: this is only true, if there are only meta
>>>> +         * and an eos bucket in the brigade head.
>>>> +         */
>>>> +        for (b =3D APR_BRIGADE_FIRST(bb);
>>>> +             b !=3D APR_BRIGADE_SENTINEL(bb);
>>>> +             b =3D APR_BUCKET_NEXT(b))
>>>> +        {
>>>> +            if (!APR_BUCKET_IS_METADATA(b) && b->length !=3D 0) {
>>>> +                break;
>>>> +            }
>>>> +            else if (APR_BUCKET_IS_EOS(b)) {
>>>> +                return 1;
>>>> +            }
>>>> +        }
>>>>  }
>>>> -   =20
>>>> -    for (b =3D APR_BRIGADE_FIRST(bb);
>>>> -         b !=3D APR_BRIGADE_SENTINEL(bb) && b !=3D end;
>>>> -         b =3D APR_BUCKET_NEXT(b))
>>>> -    {
>>>> -        if (APR_BUCKET_IS_EOS(b)) {
>>>> -            return 1;
>>>> +    else {
>>>> +        apr_bucket *end;
>>>> +        apr_status_t status =3D last_not_included(bb, len, 0, 0, =
&end);
>>>> +        if (status !=3D APR_SUCCESS) {
>>>> +            return status;
>>>> +        }
>>>> +       =20
>>>> +        for (b =3D APR_BRIGADE_FIRST(bb);
>>>> +             b !=3D APR_BRIGADE_SENTINEL(bb) && b !=3D end;
>>>> +             b =3D APR_BUCKET_NEXT(b))
>>>> +        {
>>>> +            if (APR_BUCKET_IS_EOS(b)) {
>>>> +                return 1;
>>>> +            }
>>>>      }
>>>>  }
>>>>  return 0;
>>>>=20
>>>> Modified: httpd/httpd/trunk/modules/http2/h2_version.h
>>>> URL: =
http://svn.apache.org/viewvc/httpd/httpd/trunk/modules/http2/h2_version.h?=
rev=3D1707468&r1=3D1707467&r2=3D1707468&view=3Ddiff
>>>> =
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
>>>> --- httpd/httpd/trunk/modules/http2/h2_version.h (original)
>>>> +++ httpd/httpd/trunk/modules/http2/h2_version.h Thu Oct  8 =
10:03:30 2015
>>>> @@ -20,7 +20,7 @@
>>>> * @macro
>>>> * Version number of the h2 module as c string
>>>> */
>>>> -#define MOD_HTTP2_VERSION "0.9.9"
>>>> +#define MOD_HTTP2_VERSION "1.0.0"
>>>>=20
>>>> /**
>>>> * @macro
>>>> @@ -28,7 +28,7 @@
>>>> * release. This is a 24 bit number with 8 bits for major number, 8 =
bits
>>>> * for minor and 8 bits for patch. Version 1.2.3 becomes 0x010203.
>>>> */
>>>> -#define MOD_HTTP2_VERSION_NUM 0x000909
>>>> +#define MOD_HTTP2_VERSION_NUM 0x010000
>>>>=20
>>>>=20
>>>> #endif /* mod_h2_h2_version_h */
>>>>=20
>>>>=20
>>>=20
>>=20
>=20


From dev-return-84171-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Thu Oct  8 12:36:46 2015
Return-Path: <dev-return-84171-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id E6E7218101
	for <apmail-httpd-dev-archive@www.apache.org>; Thu,  8 Oct 2015 12:36:45 +0000 (UTC)
Received: (qmail 55321 invoked by uid 500); 8 Oct 2015 12:36:45 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 55242 invoked by uid 500); 8 Oct 2015 12:36:45 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 55232 invoked by uid 99); 8 Oct 2015 12:36:45 -0000
Received: from Unknown (HELO spamd2-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 08 Oct 2015 12:36:45 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd2-us-west.apache.org (ASF Mail Server at spamd2-us-west.apache.org) with ESMTP id F24B11A24F0
	for <dev@httpd.apache.org>; Thu,  8 Oct 2015 12:36:44 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd2-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.821
X-Spam-Level:
X-Spam-Status: No, score=-0.821 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RCVD_IN_DNSWL_LOW=-0.7, RCVD_IN_MSPIKE_H3=-0.01,
	RCVD_IN_MSPIKE_WL=-0.01, SPF_PASS=-0.001] autolearn=disabled
Authentication-Results: spamd2-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-us-west.apache.org ([10.40.0.8])
	by localhost (spamd2-us-west.apache.org [10.40.0.9]) (amavisd-new, port 10024)
	with ESMTP id FgkBIRnMgP5y for <dev@httpd.apache.org>;
	Thu,  8 Oct 2015 12:36:44 +0000 (UTC)
Received: from mail-qk0-f173.google.com (mail-qk0-f173.google.com [209.85.220.173])
	by mx1-us-west.apache.org (ASF Mail Server at mx1-us-west.apache.org) with ESMTPS id 4E7E122F1F
	for <dev@httpd.apache.org>; Thu,  8 Oct 2015 12:36:44 +0000 (UTC)
Received: by qkht68 with SMTP id t68so18196230qkh.3
        for <dev@httpd.apache.org>; Thu, 08 Oct 2015 05:36:43 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        bh=JK5kcQF5n3u/k0bm00mq1Kx/xUYMzjMhY8SsStT2MVE=;
        b=YiP66MP90n3xEAMbVbnZOvwh4r/24JwWL/xRvOkAEczWxrrjGcDDH7JniQsLcIDRbM
         Dxe6183nMqWxq2lJdCmVPmdvdDZUu8HJQ7mRl6CF1YF5s2VyemUihtDyzrsGF/KYyp4X
         YRMls1MpPJ4sKET61s1znQNPLDebpBykmn+ADQaTyeJMeQE7Jjbi+1i6+/UUCO7gq2DT
         wHKTlr8FpWjyPPUgW2UzTDfyuEzCEz9dadpqsL5gqRoX36NIUg3I4CI+cfirTiN2Dl51
         xKKIoTLXmaP8zA/zLHn5MVCHinnJEh0KMZIz0V/pM7fA5TH496QJyxCO6X/2iBhHcKRA
         f3+g==
MIME-Version: 1.0
X-Received: by 10.55.192.15 with SMTP id o15mr7913941qki.2.1444307803662; Thu,
 08 Oct 2015 05:36:43 -0700 (PDT)
Received: by 10.55.72.20 with HTTP; Thu, 8 Oct 2015 05:36:43 -0700 (PDT)
In-Reply-To: <CAKQ1sVOS+oUVGOSbeAVj4D7QQYDJTiF9eauc_8zcLEVJPu2qLQ@mail.gmail.com>
References: <B3EE8F05-26C7-4B79-B335-B6A431571022@greenbytes.de>
	<CAKQ1sVMThLzUCt03BJ+accZKYrnHmexY4mpwnRyXCXRbA+J-RA@mail.gmail.com>
	<6F5B6977-6103-4A11-868B-2F686F0B4226@greenbytes.de>
	<CAKQ1sVO7s=cTUzJsEEAQYZgPabY3RfzH+A-gqOpHLrw5HBZhsg@mail.gmail.com>
	<54317A51-5546-4401-B101-6FE2AF12D6C4@greenbytes.de>
	<CAKQ1sVPTFXhJGXNBEK_yn8tP4kZdYwzJJ345JtiF3ix84msTvA@mail.gmail.com>
	<CAKQ1sVOS+oUVGOSbeAVj4D7QQYDJTiF9eauc_8zcLEVJPu2qLQ@mail.gmail.com>
Date: Thu, 8 Oct 2015 14:36:43 +0200
Message-ID: <CAKQ1sVMdnK7xchnVUDQdZtnVHyUic6Dv99_pzhYx_EmFiy26xg@mail.gmail.com>
Subject: Re: stop the press!
From: Yann Ylavic <ylavic.dev@gmail.com>
To: dev@httpd.apache.org
Content-Type: text/plain; charset=UTF-8

On Thu, Oct 8, 2015 at 2:12 PM, Yann Ylavic <ylavic.dev@gmail.com> wrote:
> On Thu, Oct 8, 2015 at 1:56 PM, Yann Ylavic <ylavic.dev@gmail.com> wrote:
>>
>> So we can change that later if necessary
>
> Something like this maybe:

Hm, no, this changes "the whole brigade" with *plen == 0 semantic in
h2_util_has_eos(), which other callers may not expect.

From dev-return-84172-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Thu Oct  8 12:39:20 2015
Return-Path: <dev-return-84172-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 0C7D318117
	for <apmail-httpd-dev-archive@www.apache.org>; Thu,  8 Oct 2015 12:39:20 +0000 (UTC)
Received: (qmail 57134 invoked by uid 500); 8 Oct 2015 12:38:45 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 57066 invoked by uid 500); 8 Oct 2015 12:38:45 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 57056 invoked by uid 99); 8 Oct 2015 12:38:45 -0000
Received: from Unknown (HELO spamd3-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 08 Oct 2015 12:38:45 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd3-us-west.apache.org (ASF Mail Server at spamd3-us-west.apache.org) with ESMTP id E9618180DE7
	for <dev@httpd.apache.org>; Thu,  8 Oct 2015 12:38:44 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd3-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.011
X-Spam-Level:
X-Spam-Status: No, score=-0.011 tagged_above=-999 required=6.31
	tests=[SPF_PASS=-0.001, T_RP_MATCHES_RCVD=-0.01] autolearn=disabled
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd3-us-west.apache.org [10.40.0.10]) (amavisd-new, port 10024)
	with ESMTP id MlrXWHSuVKQM for <dev@httpd.apache.org>;
	Thu,  8 Oct 2015 12:38:40 +0000 (UTC)
Received: from mail.greenbytes.de (mail.greenbytes.de [217.91.35.233])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id A40A025426
	for <dev@httpd.apache.org>; Thu,  8 Oct 2015 12:38:39 +0000 (UTC)
Received: from [192.168.1.42] (unknown [5.10.171.186])
	(using TLSv1 with cipher ECDHE-RSA-AES256-SHA (256/256 bits))
	(Client did not present a certificate)
	by mail.greenbytes.de (Postfix) with ESMTPSA id 2352E15A00A5
	for <dev@httpd.apache.org>; Thu,  8 Oct 2015 14:38:39 +0200 (CEST)
Content-Type: text/plain; charset=us-ascii
Mime-Version: 1.0 (Mac OS X Mail 9.0 \(3094\))
Subject: Re: stop the press!
From: Stefan Eissing <stefan.eissing@greenbytes.de>
In-Reply-To: <CAKQ1sVMdnK7xchnVUDQdZtnVHyUic6Dv99_pzhYx_EmFiy26xg@mail.gmail.com>
Date: Thu, 8 Oct 2015 14:38:38 +0200
Content-Transfer-Encoding: quoted-printable
Message-Id: <854EC955-95B9-4FA9-A029-5CA024B64C2F@greenbytes.de>
References: <B3EE8F05-26C7-4B79-B335-B6A431571022@greenbytes.de> <CAKQ1sVMThLzUCt03BJ+accZKYrnHmexY4mpwnRyXCXRbA+J-RA@mail.gmail.com> <6F5B6977-6103-4A11-868B-2F686F0B4226@greenbytes.de> <CAKQ1sVO7s=cTUzJsEEAQYZgPabY3RfzH+A-gqOpHLrw5HBZhsg@mail.gmail.com> <54317A51-5546-4401-B101-6FE2AF12D6C4@greenbytes.de> <CAKQ1sVPTFXhJGXNBEK_yn8tP4kZdYwzJJ345JtiF3ix84msTvA@mail.gmail.com> <CAKQ1sVOS+oUVGOSbeAVj4D7QQYDJTiF9eauc_8zcLEVJPu2qLQ@mail.gmail.com> <CAKQ1sVMdnK7xchnVUDQdZtnVHyUic6Dv99_pzhYx_EmFiy26xg@mail.gmail.com>
To: dev@httpd.apache.org
X-Mailer: Apple Mail (2.3094)

Yes, that's what I realized after your first review.

I think the currently applied patch works fine and any improvement is to =
much for 2.4.17. Time to revisit when Graham rips it all apart... ;-)

//Stefan

> Am 08.10.2015 um 14:36 schrieb Yann Ylavic <ylavic.dev@gmail.com>:
>=20
> On Thu, Oct 8, 2015 at 2:12 PM, Yann Ylavic <ylavic.dev@gmail.com> =
wrote:
>> On Thu, Oct 8, 2015 at 1:56 PM, Yann Ylavic <ylavic.dev@gmail.com> =
wrote:
>>>=20
>>> So we can change that later if necessary
>>=20
>> Something like this maybe:
>=20
> Hm, no, this changes "the whole brigade" with *plen =3D=3D 0 semantic =
in
> h2_util_has_eos(), which other callers may not expect.


From dev-return-84173-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Thu Oct  8 17:45:56 2015
Return-Path: <dev-return-84173-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id D640218D7E
	for <apmail-httpd-dev-archive@www.apache.org>; Thu,  8 Oct 2015 17:45:56 +0000 (UTC)
Received: (qmail 55825 invoked by uid 500); 8 Oct 2015 17:45:53 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 55766 invoked by uid 500); 8 Oct 2015 17:45:53 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 55756 invoked by uid 99); 8 Oct 2015 17:45:53 -0000
Received: from Unknown (HELO spamd4-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 08 Oct 2015 17:45:53 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd4-us-west.apache.org (ASF Mail Server at spamd4-us-west.apache.org) with ESMTP id C13E5C0BDA
	for <dev@httpd.apache.org>; Thu,  8 Oct 2015 17:45:52 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd4-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.12
X-Spam-Level:
X-Spam-Status: No, score=-0.12 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RCVD_IN_MSPIKE_H3=-0.01, RCVD_IN_MSPIKE_WL=-0.01, SPF_PASS=-0.001,
	URIBL_BLOCKED=0.001] autolearn=disabled
Authentication-Results: spamd4-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd4-us-west.apache.org [10.40.0.11]) (amavisd-new, port 10024)
	with ESMTP id oy1SVqRsJHDl for <dev@httpd.apache.org>;
	Thu,  8 Oct 2015 17:45:46 +0000 (UTC)
Received: from mail-qk0-f182.google.com (mail-qk0-f182.google.com [209.85.220.182])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id EFBB421247
	for <dev@httpd.apache.org>; Thu,  8 Oct 2015 17:45:45 +0000 (UTC)
Received: by qkht68 with SMTP id t68so22357715qkh.3
        for <dev@httpd.apache.org>; Thu, 08 Oct 2015 10:45:38 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=mime-version:date:message-id:subject:from:to:cc:content-type;
        bh=CsumB/tfNCitx98muB76JvYvO9U6dSQMca6D+dYogD8=;
        b=hCaOXroLcfVmCURuUVxW1HBejHPS3bG9EyyJYBGRTBXl+NEK0khPyP778tLdDVypwy
         Hx86w7VHGNRE+Hzx1SEKg1H/OebIkOoy5ROnp0kU8Clj3BTsHBEfVFnrhiLiqYYKtw5X
         SifiGnXBr8jkw7OBP2FaSrvLzEx7BDz56snzh8kEUgMclZuwiG3a4XDb9IRG0S4YOkdR
         0Ypw5JMjc5YoqTFVYJVxsFCgoELzZ6eeVayF4wIGOWyJHUgreNELfMGFnB9n+aOfio1L
         1HeE1Di1bAvxC0YMRgKlvUvwz2NoWjuw3oC/8C1BDZTM2NcnBwWxwLgtPnOoTkiN3ju1
         d5IQ==
MIME-Version: 1.0
X-Received: by 10.55.215.156 with SMTP id t28mr9686636qkt.68.1444326338675;
 Thu, 08 Oct 2015 10:45:38 -0700 (PDT)
Received: by 10.55.72.20 with HTTP; Thu, 8 Oct 2015 10:45:38 -0700 (PDT)
Date: Thu, 8 Oct 2015 19:45:38 +0200
Message-ID: <CAKQ1sVOC61qOCnQzf=De=QeXwEA8FdrfjhiFSt1uUm6XDQ+eEg@mail.gmail.com>
Subject: Better SO_REUSEPORT
From: Yann Ylavic <ylavic.dev@gmail.com>
To: dev@httpd.apache.org
Cc: "Lu, Yingqi" <yingqi.lu@intel.com>
Content-Type: text/plain; charset=UTF-8

Looks like we can do even better/faster with it (and latest Linux
kernels), soon :)

https://www.mail-archive.com/netdev@vger.kernel.org/msg81804.html

Promising!

From dev-return-84174-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Thu Oct  8 17:48:58 2015
Return-Path: <dev-return-84174-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 95C0118DA1
	for <apmail-httpd-dev-archive@www.apache.org>; Thu,  8 Oct 2015 17:48:58 +0000 (UTC)
Received: (qmail 68041 invoked by uid 500); 8 Oct 2015 17:48:58 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 67972 invoked by uid 500); 8 Oct 2015 17:48:58 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 67954 invoked by uid 99); 8 Oct 2015 17:48:58 -0000
Received: from Unknown (HELO spamd1-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 08 Oct 2015 17:48:58 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd1-us-west.apache.org (ASF Mail Server at spamd1-us-west.apache.org) with ESMTP id B1C78C4D2E
	for <dev@httpd.apache.org>; Thu,  8 Oct 2015 17:48:57 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd1-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.01
X-Spam-Level:
X-Spam-Status: No, score=-0.01 tagged_above=-999 required=6.31
	tests=[SPF_PASS=-0.001, T_RP_MATCHES_RCVD=-0.01, URIBL_BLOCKED=0.001]
	autolearn=disabled
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd1-us-west.apache.org [10.40.0.7]) (amavisd-new, port 10024)
	with ESMTP id TdS-gjlrubMc for <dev@httpd.apache.org>;
	Thu,  8 Oct 2015 17:48:50 +0000 (UTC)
Received: from mga14.intel.com (mga14.intel.com [192.55.52.115])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTP id 9FF34206E8
	for <dev@httpd.apache.org>; Thu,  8 Oct 2015 17:48:49 +0000 (UTC)
Received: from fmsmga002.fm.intel.com ([10.253.24.26])
  by fmsmga103.fm.intel.com with ESMTP; 08 Oct 2015 10:46:54 -0700
X-ExtLoop1: 1
X-IronPort-AV: E=Sophos;i="5.17,655,1437462000"; 
   d="scan'208";a="822496477"
Received: from orsmsx108.amr.corp.intel.com ([10.22.240.6])
  by fmsmga002.fm.intel.com with ESMTP; 08 Oct 2015 10:46:54 -0700
Received: from orsmsx114.amr.corp.intel.com (10.22.240.10) by
 ORSMSX108.amr.corp.intel.com (10.22.240.6) with Microsoft SMTP Server (TLS)
 id 14.3.248.2; Thu, 8 Oct 2015 10:46:53 -0700
Received: from orsmsx113.amr.corp.intel.com ([169.254.7.211]) by
 ORSMSX114.amr.corp.intel.com ([169.254.8.204]) with mapi id 14.03.0248.002;
 Thu, 8 Oct 2015 10:46:53 -0700
From: "Lu, Yingqi" <yingqi.lu@intel.com>
To: Yann Ylavic <ylavic.dev@gmail.com>, "dev@httpd.apache.org"
	<dev@httpd.apache.org>
Subject: RE: Better SO_REUSEPORT
Thread-Topic: Better SO_REUSEPORT
Thread-Index: AQHRAfEuZV3a+nF9tkWdpVKmh/mNk55h3p+A
Date: Thu, 8 Oct 2015 17:46:51 +0000
Message-ID: <9ACD5B67AAC5594CB6268234CF29CF9AA3A3F733@ORSMSX113.amr.corp.intel.com>
References: <CAKQ1sVOC61qOCnQzf=De=QeXwEA8FdrfjhiFSt1uUm6XDQ+eEg@mail.gmail.com>
In-Reply-To: <CAKQ1sVOC61qOCnQzf=De=QeXwEA8FdrfjhiFSt1uUm6XDQ+eEg@mail.gmail.com>
Accept-Language: en-US
Content-Language: en-US
X-MS-Has-Attach:
X-MS-TNEF-Correlator:
x-originating-ip: [10.22.254.140]
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
MIME-Version: 1.0

R3JlYXQhISBUaGFuayB5b3UgdmVyeSBtdWNoIGZvciBzaGFyaW5nIHRoaXMgd2l0aCB1cyENCg0K
VGhhbmtzLA0KWWluZ3FpDQoNCi0tLS0tT3JpZ2luYWwgTWVzc2FnZS0tLS0tDQpGcm9tOiBZYW5u
IFlsYXZpYyBbbWFpbHRvOnlsYXZpYy5kZXZAZ21haWwuY29tXSANClNlbnQ6IFRodXJzZGF5LCBP
Y3RvYmVyIDA4LCAyMDE1IDEwOjQ2IEFNDQpUbzogZGV2QGh0dHBkLmFwYWNoZS5vcmcNCkNjOiBM
dSwgWWluZ3FpDQpTdWJqZWN0OiBCZXR0ZXIgU09fUkVVU0VQT1JUDQoNCkxvb2tzIGxpa2Ugd2Ug
Y2FuIGRvIGV2ZW4gYmV0dGVyL2Zhc3RlciB3aXRoIGl0IChhbmQgbGF0ZXN0IExpbnV4IGtlcm5l
bHMpLCBzb29uIDopDQoNCmh0dHBzOi8vd3d3Lm1haWwtYXJjaGl2ZS5jb20vbmV0ZGV2QHZnZXIu
a2VybmVsLm9yZy9tc2c4MTgwNC5odG1sDQoNClByb21pc2luZyENCg==

From dev-return-84175-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Thu Oct  8 21:48:39 2015
Return-Path: <dev-return-84175-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 6C93D18910
	for <apmail-httpd-dev-archive@www.apache.org>; Thu,  8 Oct 2015 21:48:39 +0000 (UTC)
Received: (qmail 57243 invoked by uid 500); 8 Oct 2015 21:48:33 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 57168 invoked by uid 500); 8 Oct 2015 21:48:32 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 57158 invoked by uid 99); 8 Oct 2015 21:48:32 -0000
Received: from Unknown (HELO spamd2-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 08 Oct 2015 21:48:32 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd2-us-west.apache.org (ASF Mail Server at spamd2-us-west.apache.org) with ESMTP id 85C261A2572
	for <dev@httpd.apache.org>; Thu,  8 Oct 2015 21:48:32 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd2-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 0.653
X-Spam-Level:
X-Spam-Status: No, score=0.653 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, SPF_NEUTRAL=0.652,
	URIBL_BLOCKED=0.001] autolearn=disabled
Authentication-Results: spamd2-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=comcast.net
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd2-us-west.apache.org [10.40.0.9]) (amavisd-new, port 10024)
	with ESMTP id iBoSgNBZZC6g for <dev@httpd.apache.org>;
	Thu,  8 Oct 2015 21:48:23 +0000 (UTC)
Received: from resqmta-ch2-10v.sys.comcast.net (resqmta-ch2-10v.sys.comcast.net [69.252.207.42])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id 1F860206E8
	for <dev@httpd.apache.org>; Thu,  8 Oct 2015 21:48:23 +0000 (UTC)
Received: from resomta-ch2-05v.sys.comcast.net ([69.252.207.101])
	by resqmta-ch2-10v.sys.comcast.net with comcast
	id Slns1r0052Bo0NV01loMvG; Thu, 08 Oct 2015 21:48:21 +0000
Received: from [192.168.199.10] ([69.251.84.114])
	by resomta-ch2-05v.sys.comcast.net with comcast
	id SloM1r00A2U0RYt01loMrq; Thu, 08 Oct 2015 21:48:21 +0000
Content-Type: text/plain; charset=us-ascii
Mime-Version: 1.0 (Mac OS X Mail 8.2 \(2104\))
Subject: Re: T&R of 2.4.17 this week
From: Jim Jagielski <jim@jaguNET.com>
In-Reply-To: <063688EF-F9E5-4A26-9636-702601760093@jaguNET.com>
Date: Thu, 8 Oct 2015 17:48:21 -0400
Content-Transfer-Encoding: 7bit
Message-Id: <28394810-B890-4B1F-B17E-DBF42D814406@jaguNET.com>
References: <9ACC24A9-B381-4C18-B1C4-8D9F62DD7DB5@jaguNET.com> <063688EF-F9E5-4A26-9636-702601760093@jaguNET.com>
To: dev@httpd.apache.org
X-Mailer: Apple Mail (2.2104)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=comcast.net;
	s=q20140121; t=1444340901;
	bh=LHSq9QdhQlmcBxw0CEKQRolzHTFVbZkLkYHORlMorWY=;
	h=Received:Received:Content-Type:Mime-Version:Subject:From:Date:
	 Message-Id:To;
	b=BlS+QBk27lur9xFte5MqF7HuWNNTdvzH/un91VmzdObX1B4E6c0EWuAuwDZemPLmS
	 XJ9dnm1P//UuY7ggnVAXDvJ/HPBtdsmipAn3fRM0Z4Q02UsUhHzU2s2wPR+fPnGrEa
	 UdEb7skKauYYWwPFZB0Mv48vvNndml7A6zIM1PJBNMB5jAuat+5VqEInNLWtvTlNz8
	 9KuBZMdTR6fEhUxRzR3GKG4+DwA/wE8NeFke4N9qQyNmIWPGWlyrHdkUPe1LbMnD/l
	 dLT5pxNWq9pN6S4orw/xiGG8wmH2b/PxVsgNk/WIs+qUjPGdkV/s4UUERKnmvkfvOq
	 ntNQkoghav6LA==

With the changes, I decided to wait a day and let things settle:
Will T&R tomorrow when I return from keynoting at Drupal Camp Baltimore.

> On Oct 7, 2015, at 9:45 AM, Jim Jagielski <jim@jaguNET.com> wrote:
> 
> So the plan is to T&R sometime tomorrow, likely
> later on in the afternoon, eastern time.


From dev-return-84176-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Fri Oct  9 01:08:23 2015
Return-Path: <dev-return-84176-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id E49561828B
	for <apmail-httpd-dev-archive@www.apache.org>; Fri,  9 Oct 2015 01:08:22 +0000 (UTC)
Received: (qmail 35241 invoked by uid 500); 9 Oct 2015 01:08:22 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 35167 invoked by uid 500); 9 Oct 2015 01:08:21 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 35157 invoked by uid 99); 9 Oct 2015 01:08:21 -0000
Received: from Unknown (HELO spamd3-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 09 Oct 2015 01:08:21 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd3-us-west.apache.org (ASF Mail Server at spamd3-us-west.apache.org) with ESMTP id 7DDD8180DFE
	for <dev@httpd.apache.org>; Fri,  9 Oct 2015 01:08:21 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd3-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 0.999
X-Spam-Level:
X-Spam-Status: No, score=0.999 tagged_above=-999 required=6.31
	tests=[KAM_LAZY_DOMAIN_SECURITY=1, RCVD_IN_MSPIKE_H2=-0.001]
	autolearn=disabled
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd3-us-west.apache.org [10.40.0.10]) (amavisd-new, port 10024)
	with ESMTP id X8JFJuQ1CjPD for <dev@httpd.apache.org>;
	Fri,  9 Oct 2015 01:08:14 +0000 (UTC)
Received: from fed1rmfepo101.cox.net (fed1rmfepo101.cox.net [68.230.241.143])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTP id 6EE0A439CB
	for <dev@httpd.apache.org>; Fri,  9 Oct 2015 01:08:14 +0000 (UTC)
Received: from fed1rmimpo210 ([68.230.241.161]) by fed1rmfepo101.cox.net
          (InterMail vM.8.01.05.15 201-2260-151-145-20131218) with ESMTP
          id <20151009010807.DLOH18049.fed1rmfepo101.cox.net@fed1rmimpo210>
          for <dev@httpd.apache.org>; Thu, 8 Oct 2015 21:08:07 -0400
Received: from [192.168.1.33] ([98.176.34.113])
	by fed1rmimpo210 with cox
	id Sp851r00R2STVfm01p86S8; Thu, 08 Oct 2015 21:08:06 -0400
X-CT-Class: Clean
X-CT-Score: 0.00
X-CT-RefID: str=0001.0A020204.56171376.01E0,ss=1,re=0.000,fgs=0
X-CT-Spam: 0
X-Authority-Analysis: v=2.0 cv=dcleKwre c=1 sm=1
 a=8xCO7h6kmYZdHn5tUOQhsw==:17 a=LrjODJgKAAAA:8 a=WYJwevfS9xZJUu9hEL8A:9
 a=wPNLvfGTeEIA:10 a=0zUZ8yBUoaEA:10 a=8xCO7h6kmYZdHn5tUOQhsw==:117
X-CM-Score: 0.00
Authentication-Results: cox.net; auth=pass (PLAIN) smtp.auth=glewis63@cox.net
Message-ID: <561712F6.7030204@gknw.net>
Date: Thu, 08 Oct 2015 18:05:58 -0700
From: Gregg Smith <gls@gknw.net>
User-Agent: Mozilla/5.0 (Windows; U; Windows NT 6.0; en-US; rv:1.9.2.28) Gecko/20120306 Thunderbird/3.1.20
MIME-Version: 1.0
To: dev@httpd.apache.org
Subject: Re: T&R of 2.4.17 this week
References: <56159f73.568.1970.3a58@land10.nl> <A335AA83-92FD-4580-88ED-B1E37DFB2693@jaguNET.com> <0C6E8F63900E44D08F83CABE8F0BDDF2@father>
In-Reply-To: <0C6E8F63900E44D08F83CABE8F0BDDF2@father>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit

On 10/8/2015 3:57 AM, Steffen wrote:
> Jus curious, why is e.g. LUA there ?

Probably because when mod_lua was added it got added and not the case 
when mod_proxy_html and mod_xml2enc got added nor did I think about it 
when adding mod_h2. My fault.

This is beyond the scope of httpd's source and was originally for the 
old contributed binary distributions but I see no reason not to include 
them anyway.

Done for:
Trunk: r1707640
2.4.x: r1707641



From dev-return-84177-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Fri Oct  9 09:12:20 2015
Return-Path: <dev-return-84177-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 4526118E35
	for <apmail-httpd-dev-archive@www.apache.org>; Fri,  9 Oct 2015 09:12:20 +0000 (UTC)
Received: (qmail 9098 invoked by uid 500); 9 Oct 2015 09:12:19 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 9034 invoked by uid 500); 9 Oct 2015 09:12:19 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 9024 invoked by uid 99); 9 Oct 2015 09:12:19 -0000
Received: from Unknown (HELO spamd4-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 09 Oct 2015 09:12:19 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd4-us-west.apache.org (ASF Mail Server at spamd4-us-west.apache.org) with ESMTP id E4A95C059F
	for <dev@httpd.apache.org>; Fri,  9 Oct 2015 09:12:18 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd4-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.802
X-Spam-Level:
X-Spam-Status: No, score=-0.802 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RCVD_IN_DNSWL_LOW=-0.7, RCVD_IN_MSPIKE_H2=-0.001, SPF_PASS=-0.001]
	autolearn=disabled
Authentication-Results: spamd4-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-us-west.apache.org ([10.40.0.8])
	by localhost (spamd4-us-west.apache.org [10.40.0.11]) (amavisd-new, port 10024)
	with ESMTP id T_nGOfOq6L0F for <dev@httpd.apache.org>;
	Fri,  9 Oct 2015 09:12:18 +0000 (UTC)
Received: from mail-qg0-f50.google.com (mail-qg0-f50.google.com [209.85.192.50])
	by mx1-us-west.apache.org (ASF Mail Server at mx1-us-west.apache.org) with ESMTPS id 449FB20FE0
	for <dev@httpd.apache.org>; Fri,  9 Oct 2015 09:12:18 +0000 (UTC)
Received: by qgew37 with SMTP id w37so5056958qge.0
        for <dev@httpd.apache.org>; Fri, 09 Oct 2015 02:12:17 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=mime-version:date:message-id:subject:from:to:content-type;
        bh=NGtcKhDDPbHfovNsD5EOCviuR43ImkxBPY84YvoQBJM=;
        b=bhipHV7mKIR9saqucYnIzC4SspLZ44ayalzLMQJx24pCxr4uxQirj5889WBaqBOY0O
         tkbF5px9kHk75KMMi4M5WBacbo4clp1qq1XgYegMiNNAFdwK3OnEfc/g21Ri1u8biFhd
         9sVKQUHD+LzIDipGbc1OFmWTPomRuSqALypcEvy9dgdNfSgNU/g0r3Jgd3sLYi9xxEAY
         3MMjhlVDV2rklioucy01sVKyVsr91wvocbYq+iaeSe+utnTBvGlouz3Ji7l/8gVFtaB+
         Dz8wKAGkiPwWG+6OOnDoX4ntTOAjZn/pjJgbH57qIZ81HLGswMKAaR9tvrwA1CEDvq8e
         IFGQ==
MIME-Version: 1.0
X-Received: by 10.140.19.227 with SMTP id 90mr13572298qgh.51.1444381937538;
 Fri, 09 Oct 2015 02:12:17 -0700 (PDT)
Received: by 10.55.72.20 with HTTP; Fri, 9 Oct 2015 02:12:17 -0700 (PDT)
Date: Fri, 9 Oct 2015 11:12:17 +0200
Message-ID: <CAKQ1sVO+5Q9_MRbOF+K_yYq=o+cj7agw6SWxqd6RhHbsN75TaA@mail.gmail.com>
Subject: GitHub (mirror) pull requests notifications
From: Yann Ylavic <ylavic.dev@gmail.com>
To: dev@httpd.apache.org
Content-Type: text/plain; charset=UTF-8

Could they somehow be sent to dev@, or is there legal issues?

From dev-return-84178-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Fri Oct  9 09:50:40 2015
Return-Path: <dev-return-84178-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 3A57118F4E
	for <apmail-httpd-dev-archive@www.apache.org>; Fri,  9 Oct 2015 09:50:40 +0000 (UTC)
Received: (qmail 5542 invoked by uid 500); 9 Oct 2015 09:50:34 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 5472 invoked by uid 500); 9 Oct 2015 09:50:34 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 5463 invoked by uid 99); 9 Oct 2015 09:50:34 -0000
Received: from mail-relay.apache.org (HELO mail-relay.apache.org) (140.211.11.15)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 09 Oct 2015 09:50:34 +0000
Received: from [192.168.1.37] (2804ds5-soeb.0.fullrate.dk [90.184.204.23])
	by mail-relay.apache.org (ASF Mail Server at mail-relay.apache.org) with ESMTPSA id 0915A1A027E
	for <dev@httpd.apache.org>; Fri,  9 Oct 2015 09:50:33 +0000 (UTC)
Subject: Re: GitHub (mirror) pull requests notifications
To: dev@httpd.apache.org
References: <CAKQ1sVO+5Q9_MRbOF+K_yYq=o+cj7agw6SWxqd6RhHbsN75TaA@mail.gmail.com>
From: Daniel Gruno <humbedooh@apache.org>
Message-ID: <56178DE7.2090104@apache.org>
Date: Fri, 9 Oct 2015 11:50:31 +0200
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:38.0) Gecko/20100101
 Thunderbird/38.3.0
MIME-Version: 1.0
In-Reply-To: <CAKQ1sVO+5Q9_MRbOF+K_yYq=o+cj7agw6SWxqd6RhHbsN75TaA@mail.gmail.com>
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit

On 10/09/2015 11:12 AM, Yann Ylavic wrote:
> Could they somehow be sent to dev@, or is there legal issues?
> 
No, nothing legal there...just that people didn't want GH integration ;)
If there's a desire to have it enabled, we can make it so..

With regards,
Daniel.

From dev-return-84179-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Fri Oct  9 10:00:48 2015
Return-Path: <dev-return-84179-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id E5E7C18F80
	for <apmail-httpd-dev-archive@www.apache.org>; Fri,  9 Oct 2015 10:00:48 +0000 (UTC)
Received: (qmail 24567 invoked by uid 500); 9 Oct 2015 10:00:48 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 24501 invoked by uid 500); 9 Oct 2015 10:00:48 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 24491 invoked by uid 99); 9 Oct 2015 10:00:48 -0000
Received: from Unknown (HELO spamd3-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 09 Oct 2015 10:00:48 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd3-us-west.apache.org (ASF Mail Server at spamd3-us-west.apache.org) with ESMTP id 02EBA180A75
	for <dev@httpd.apache.org>; Fri,  9 Oct 2015 10:00:48 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd3-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 1.363
X-Spam-Level: *
X-Spam-Status: No, score=1.363 tagged_above=-999 required=6.31
	tests=[KAM_LAZY_DOMAIN_SECURITY=1, RDNS_DYNAMIC=0.363]
	autolearn=disabled
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd3-us-west.apache.org [10.40.0.10]) (amavisd-new, port 10024)
	with ESMTP id ZfD9-PW3KOJN for <dev@httpd.apache.org>;
	Fri,  9 Oct 2015 10:00:39 +0000 (UTC)
Received: from gungnir.webthing.com (209-20-83-52.slicehost.net [209.20.83.52])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTP id 63DF5439B6
	for <dev@httpd.apache.org>; Fri,  9 Oct 2015 10:00:39 +0000 (UTC)
Received: from [192.168.0.127] (cpc36-newt30-2-0-cust898.19-3.cable.virginm.net [82.32.195.131])
	by gungnir.webthing.com (Postfix) with ESMTPSA id B94EAE8C51
	for <dev@httpd.apache.org>; Fri,  9 Oct 2015 10:00:32 +0000 (UTC)
Message-ID: <1444384831.4034.67.camel@mimir.webthing.com>
Subject: Re: GitHub (mirror) pull requests notifications
From: Nick Kew <nick@webthing.com>
To: dev@httpd.apache.org
Date: Fri, 09 Oct 2015 11:00:31 +0100
In-Reply-To: <CAKQ1sVO+5Q9_MRbOF+K_yYq=o+cj7agw6SWxqd6RhHbsN75TaA@mail.gmail.com>
References: 
	<CAKQ1sVO+5Q9_MRbOF+K_yYq=o+cj7agw6SWxqd6RhHbsN75TaA@mail.gmail.com>
Content-Type: text/plain; charset="UTF-8"
X-Mailer: Evolution 3.4.4-3 
Mime-Version: 1.0
Content-Transfer-Encoding: 7bit

On Fri, 2015-10-09 at 11:12 +0200, Yann Ylavic wrote:
> Could they somehow be sent to dev@, or is there legal issues?

Bugzilla activity doesn't get sent to dev@, even when
it involves PatchAvailable (kind-of equivalent to a
Pull Request, yesno)?

If we were to propagate pull requests, we should perhaps
review bugzilla workflow (IMHO a weakness in how we
work now) at the same time?

-- 
Nick Kew


From dev-return-84180-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Fri Oct  9 10:11:16 2015
Return-Path: <dev-return-84180-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id EEC6D18FB2
	for <apmail-httpd-dev-archive@www.apache.org>; Fri,  9 Oct 2015 10:11:16 +0000 (UTC)
Received: (qmail 46829 invoked by uid 500); 9 Oct 2015 10:11:16 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 46752 invoked by uid 500); 9 Oct 2015 10:11:16 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 46742 invoked by uid 99); 9 Oct 2015 10:11:16 -0000
Received: from Unknown (HELO spamd3-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 09 Oct 2015 10:11:16 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd3-us-west.apache.org (ASF Mail Server at spamd3-us-west.apache.org) with ESMTP id E4E43180A83
	for <dev@httpd.apache.org>; Fri,  9 Oct 2015 10:11:15 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd3-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -1.302
X-Spam-Level:
X-Spam-Status: No, score=-1.302 tagged_above=-999 required=6.31
	tests=[KAM_LAZY_DOMAIN_SECURITY=1, RCVD_IN_DNSWL_MED=-2.3,
	RCVD_IN_MSPIKE_H2=-0.001, SPF_HELO_PASS=-0.001] autolearn=disabled
Received: from mx1-us-west.apache.org ([10.40.0.8])
	by localhost (spamd3-us-west.apache.org [10.40.0.10]) (amavisd-new, port 10024)
	with ESMTP id dcP4HuYh8yMX for <dev@httpd.apache.org>;
	Fri,  9 Oct 2015 10:11:04 +0000 (UTC)
Received: from mail1.bemta14.messagelabs.com (mail1.bemta14.messagelabs.com [193.109.254.109])
	by mx1-us-west.apache.org (ASF Mail Server at mx1-us-west.apache.org) with ESMTPS id 496962164D
	for <dev@httpd.apache.org>; Fri,  9 Oct 2015 10:11:03 +0000 (UTC)
Received: from [193.109.254.3] by server-5.bemta-14.messagelabs.com id F7/60-00475-0B297165; Fri, 09 Oct 2015 10:10:56 +0000
X-Env-Sender: ruediger.pluem@vodafone.com
X-Msg-Ref: server-5.tower-184.messagelabs.com!1444385456!35466923!1
X-Originating-IP: [195.232.244.133]
X-StarScan-Received:
X-StarScan-Version: 6.13.16; banners=-,-,-
X-VirusChecked: Checked
Received: (qmail 29991 invoked from network); 9 Oct 2015 10:10:56 -0000
Received: from mailout01.vodafone.com (HELO mailout01.vodafone.com) (195.232.244.133)
  by server-5.tower-184.messagelabs.com with DHE-RSA-AES256-SHA encrypted SMTP; 9 Oct 2015 10:10:56 -0000
Received: from mailint04.vodafone.com (mailint04.vodafone.com [195.232.244.201])
	by mailout01.vodafone.com (Postfix) with ESMTP id 3nXQCL6lbXz1yM6
	for <dev@httpd.apache.org>; Fri,  9 Oct 2015 12:10:54 +0200 (CEST)
Received: from mailint04.vodafone.com (localhost [127.0.0.1])
	by mailint04.vodafone.com (Postfix) with ESMTP id 3nXQCL4n3YzfZkR
	for <dev@httpd.apache.org>; Fri,  9 Oct 2015 12:10:54 +0200 (CEST)
Received: from VOEXC06W.internal.vodafone.com (voexc06w.dc-ratingen.de [145.230.101.26])
	(using TLSv1 with cipher AES128-SHA (128/128 bits))
	(No client certificate requested)
	by mailint04.vodafone.com (Postfix) with ESMTPS id 3nXQCL4c1vzfZ7c
	for <dev@httpd.apache.org>; Fri,  9 Oct 2015 12:10:54 +0200 (CEST)
Received: from VOEXC29W.internal.vodafone.com (145.230.103.201) by
 VOEXC06W.internal.vodafone.com (145.230.101.26) with Microsoft SMTP Server
 (TLS) id 14.3.224.2; Fri, 9 Oct 2015 12:10:54 +0200
Received: from VOEXM10W.internal.vodafone.com ([169.254.2.88]) by voexc29w
 ([145.230.103.201]) with mapi id 14.03.0224.002; Fri, 9 Oct 2015 12:10:20
 +0200
From: =?utf-8?B?UGzDvG0sIFLDvGRpZ2VyLCBWb2RhZm9uZSBHcm91cA==?=
	<ruediger.pluem@vodafone.com>
To: "dev@httpd.apache.org" <dev@httpd.apache.org>
Subject: AW: GitHub (mirror) pull requests notifications
Thread-Topic: GitHub (mirror) pull requests notifications
Thread-Index: AQHRAnKbe4qA0znNR0Wy7oW6YJWBU55izD2AgAAkNpA=
Date: Fri, 9 Oct 2015 10:10:18 +0000
Message-ID: <AB1691BE05AE7F4992697F2A0835627AC63402C3@VOEXM10W.internal.vodafone.com>
References: <CAKQ1sVO+5Q9_MRbOF+K_yYq=o+cj7agw6SWxqd6RhHbsN75TaA@mail.gmail.com>
 <1444384831.4034.67.camel@mimir.webthing.com>
In-Reply-To: <1444384831.4034.67.camel@mimir.webthing.com>
Accept-Language: en-US
Content-Language: de-DE
X-MS-Has-Attach:
X-MS-TNEF-Correlator:
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
MIME-Version: 1.0

DQoNCj4gLS0tLS1VcnNwcsO8bmdsaWNoZSBOYWNocmljaHQtLS0tLQ0KPiBWb246IE5pY2sgS2V3
IFttYWlsdG86bmlja0B3ZWJ0aGluZy5jb21dDQo+IEdlc2VuZGV0OiBGcmVpdGFnLCA5LiBPa3Rv
YmVyIDIwMTUgMTI6MDENCj4gQW46IGRldkBodHRwZC5hcGFjaGUub3JnDQo+IEJldHJlZmY6IFJl
OiBHaXRIdWIgKG1pcnJvcikgcHVsbCByZXF1ZXN0cyBub3RpZmljYXRpb25zDQo+IA0KPiBPbiBG
cmksIDIwMTUtMTAtMDkgYXQgMTE6MTIgKzAyMDAsIFlhbm4gWWxhdmljIHdyb3RlOg0KPiA+IENv
dWxkIHRoZXkgc29tZWhvdyBiZSBzZW50IHRvIGRldkAsIG9yIGlzIHRoZXJlIGxlZ2FsIGlzc3Vl
cz8NCj4gDQo+IEJ1Z3ppbGxhIGFjdGl2aXR5IGRvZXNuJ3QgZ2V0IHNlbnQgdG8gZGV2QCwgZXZl
biB3aGVuDQo+IGl0IGludm9sdmVzIFBhdGNoQXZhaWxhYmxlIChraW5kLW9mIGVxdWl2YWxlbnQg
dG8gYQ0KPiBQdWxsIFJlcXVlc3QsIHllc25vKT8NCj4gDQo+IElmIHdlIHdlcmUgdG8gcHJvcGFn
YXRlIHB1bGwgcmVxdWVzdHMsIHdlIHNob3VsZCBwZXJoYXBzDQo+IHJldmlldyBidWd6aWxsYSB3
b3JrZmxvdyAoSU1ITyBhIHdlYWtuZXNzIGluIGhvdyB3ZQ0KPiB3b3JrIG5vdykgYXQgdGhlIHNh
bWUgdGltZT8NCg0KR29vZCBwb2ludHMuDQoNClJlZ2FyZHMNCg0KUsO8ZGlnZXINCg0K

From dev-return-84181-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Fri Oct  9 10:21:38 2015
Return-Path: <dev-return-84181-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 162D218FE7
	for <apmail-httpd-dev-archive@www.apache.org>; Fri,  9 Oct 2015 10:21:38 +0000 (UTC)
Received: (qmail 66684 invoked by uid 500); 9 Oct 2015 10:21:37 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 66616 invoked by uid 500); 9 Oct 2015 10:21:37 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 66606 invoked by uid 99); 9 Oct 2015 10:21:37 -0000
Received: from Unknown (HELO spamd2-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 09 Oct 2015 10:21:37 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd2-us-west.apache.org (ASF Mail Server at spamd2-us-west.apache.org) with ESMTP id 29B421A25D0
	for <dev@httpd.apache.org>; Fri,  9 Oct 2015 10:21:37 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd2-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.011
X-Spam-Level:
X-Spam-Status: No, score=-0.011 tagged_above=-999 required=6.31
	tests=[SPF_PASS=-0.001, T_RP_MATCHES_RCVD=-0.01] autolearn=disabled
Received: from mx1-us-west.apache.org ([10.40.0.8])
	by localhost (spamd2-us-west.apache.org [10.40.0.9]) (amavisd-new, port 10024)
	with ESMTP id UvOz-jgM3OfI for <dev@httpd.apache.org>;
	Fri,  9 Oct 2015 10:21:36 +0000 (UTC)
Received: from mailserver.kippdata.de (capsella.kippdata.de [195.227.30.149])
	by mx1-us-west.apache.org (ASF Mail Server at mx1-us-west.apache.org) with ESMTP id 8C010213B7
	for <dev@httpd.apache.org>; Fri,  9 Oct 2015 10:21:35 +0000 (UTC)
Received: from [10.0.110.6] ([192.168.10.45])
	by mailserver.kippdata.de (8.13.5/8.13.5) with ESMTP id t99ALXue001382
	for <dev@httpd.apache.org>; Fri, 9 Oct 2015 12:21:34 +0200 (CEST)
Subject: Re: GitHub (mirror) pull requests notifications
To: dev@httpd.apache.org
References: <CAKQ1sVO+5Q9_MRbOF+K_yYq=o+cj7agw6SWxqd6RhHbsN75TaA@mail.gmail.com>
 <1444384831.4034.67.camel@mimir.webthing.com>
From: Rainer Jung <rainer.jung@kippdata.de>
Message-ID: <5617952A.6000202@kippdata.de>
Date: Fri, 9 Oct 2015 12:21:30 +0200
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:38.0) Gecko/20100101
 Thunderbird/38.3.0
MIME-Version: 1.0
In-Reply-To: <1444384831.4034.67.camel@mimir.webthing.com>
Content-Type: text/plain; charset=utf-8; format=flowed
Content-Transfer-Encoding: 7bit

Am 09.10.2015 um 12:00 schrieb Nick Kew:
> On Fri, 2015-10-09 at 11:12 +0200, Yann Ylavic wrote:
>> Could they somehow be sent to dev@, or is there legal issues?
>
> Bugzilla activity doesn't get sent to dev@, even when
> it involves PatchAvailable (kind-of equivalent to a
> Pull Request, yesno)?
>
> If we were to propagate pull requests, we should perhaps
> review bugzilla workflow (IMHO a weakness in how we
> work now) at the same time?

Or send GH mails to bugs@ similar to the BZ workflow?

Rainer

From dev-return-84182-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Fri Oct  9 10:36:32 2015
Return-Path: <dev-return-84182-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 05DE218065
	for <apmail-httpd-dev-archive@www.apache.org>; Fri,  9 Oct 2015 10:36:32 +0000 (UTC)
Received: (qmail 89582 invoked by uid 500); 9 Oct 2015 10:36:31 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 89511 invoked by uid 500); 9 Oct 2015 10:36:31 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 89499 invoked by uid 99); 9 Oct 2015 10:36:31 -0000
Received: from Unknown (HELO spamd3-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 09 Oct 2015 10:36:31 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd3-us-west.apache.org (ASF Mail Server at spamd3-us-west.apache.org) with ESMTP id D6B0A180A89
	for <dev@httpd.apache.org>; Fri,  9 Oct 2015 10:36:30 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd3-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.802
X-Spam-Level:
X-Spam-Status: No, score=-0.802 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RCVD_IN_DNSWL_LOW=-0.7, RCVD_IN_MSPIKE_H2=-0.001, SPF_PASS=-0.001]
	autolearn=disabled
Authentication-Results: spamd3-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-us-west.apache.org ([10.40.0.8])
	by localhost (spamd3-us-west.apache.org [10.40.0.10]) (amavisd-new, port 10024)
	with ESMTP id ueNk0IHWIKCW for <dev@httpd.apache.org>;
	Fri,  9 Oct 2015 10:36:30 +0000 (UTC)
Received: from mail-qg0-f41.google.com (mail-qg0-f41.google.com [209.85.192.41])
	by mx1-us-west.apache.org (ASF Mail Server at mx1-us-west.apache.org) with ESMTPS id 3946020864
	for <dev@httpd.apache.org>; Fri,  9 Oct 2015 10:36:30 +0000 (UTC)
Received: by qgx61 with SMTP id 61so64781802qgx.3
        for <dev@httpd.apache.org>; Fri, 09 Oct 2015 03:36:29 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        bh=mMyDgcE4YtJV4cFuMC336eO9dy99ho0vg6/ghvLSW2c=;
        b=sKSBo2/HEUCrK7/mhtoVR4hQl4sqdj2em7QWaz+wmj8E7Jre4F68mtcmHRXbQPAptO
         H2nk/r8/xS+7ySHU8VhFdB3hXNVloAyeGEyXbMiexNAnUwsGT101rhmH2S3vnulBlRyQ
         qAezTHbcKujpU08Vpn1jMz2xIR/sZUkV9V7hGfAkOtzffmD8xVNbnNNsYuagxYlCCC9f
         yD8WrWuTKbIykhsVlIGbM+afQ8DQ1dhYYt6hGvNNsoPHaeO3RYcrDITJDA6YmqU82Cdy
         rRDJaB7KXZ3fXtlJEb8KYvrRRfCWZ5x1ih96NJnOWkpmyrNVXczPz/bj+8DSuS7uT8NX
         /GGg==
MIME-Version: 1.0
X-Received: by 10.140.96.71 with SMTP id j65mr4329264qge.92.1444386989405;
 Fri, 09 Oct 2015 03:36:29 -0700 (PDT)
Received: by 10.55.72.20 with HTTP; Fri, 9 Oct 2015 03:36:29 -0700 (PDT)
In-Reply-To: <56178DE7.2090104@apache.org>
References: <CAKQ1sVO+5Q9_MRbOF+K_yYq=o+cj7agw6SWxqd6RhHbsN75TaA@mail.gmail.com>
	<56178DE7.2090104@apache.org>
Date: Fri, 9 Oct 2015 12:36:29 +0200
Message-ID: <CAKQ1sVP7PWyz5ANuSu8sGqN9jy-S9A4kXwwrgcKc5NPgYf0ngQ@mail.gmail.com>
Subject: Re: GitHub (mirror) pull requests notifications
From: Yann Ylavic <ylavic.dev@gmail.com>
To: dev@httpd.apache.org
Content-Type: text/plain; charset=UTF-8

On Fri, Oct 9, 2015 at 11:50 AM, Daniel Gruno <humbedooh@apache.org> wrote:
> On 10/09/2015 11:12 AM, Yann Ylavic wrote:
>> Could they somehow be sent to dev@, or is there legal issues?
>>
> No, nothing legal there...

ISTM that for patches to be donated-to/acceptable-by the ASF, they
must be sent to either bugs@ or dev@, but I can have misinterpreted
what I read (can't find it now...).

From dev-return-84183-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Fri Oct  9 10:42:51 2015
Return-Path: <dev-return-84183-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id A282518090
	for <apmail-httpd-dev-archive@www.apache.org>; Fri,  9 Oct 2015 10:42:51 +0000 (UTC)
Received: (qmail 98836 invoked by uid 500); 9 Oct 2015 10:42:51 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 98767 invoked by uid 500); 9 Oct 2015 10:42:51 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 98756 invoked by uid 99); 9 Oct 2015 10:42:51 -0000
Received: from Unknown (HELO spamd3-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 09 Oct 2015 10:42:51 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd3-us-west.apache.org (ASF Mail Server at spamd3-us-west.apache.org) with ESMTP id BFF591809C5
	for <dev@httpd.apache.org>; Fri,  9 Oct 2015 10:42:50 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd3-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.82
X-Spam-Level:
X-Spam-Status: No, score=-0.82 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RCVD_IN_DNSWL_LOW=-0.7, RCVD_IN_MSPIKE_H3=-0.01,
	RCVD_IN_MSPIKE_WL=-0.01, SPF_PASS=-0.001, URIBL_BLOCKED=0.001]
	autolearn=disabled
Authentication-Results: spamd3-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd3-us-west.apache.org [10.40.0.10]) (amavisd-new, port 10024)
	with ESMTP id mQWDgBuFItk7 for <dev@httpd.apache.org>;
	Fri,  9 Oct 2015 10:42:45 +0000 (UTC)
Received: from mail-qk0-f174.google.com (mail-qk0-f174.google.com [209.85.220.174])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id 323CF439B6
	for <dev@httpd.apache.org>; Fri,  9 Oct 2015 10:42:45 +0000 (UTC)
Received: by qkap81 with SMTP id p81so30637596qka.2
        for <dev@httpd.apache.org>; Fri, 09 Oct 2015 03:42:45 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        bh=1qzhIbFTqpJJZ1hlYjM9rB4gBGJYcp7nOK8nJuY49fs=;
        b=ZDsUj0t1wLaAYnpUaL1ILF16UpizjwIZnYtYTDQnU27J0NtK6nL+pEy9D2N2j5oGxC
         KB/MSW2wk4vz4TzpTHKe5cNvr1JQU2V5GzLk/wGC01qSAwVk/ieehEJn1hDZPDfCE5S3
         3UHPk6fbXIRotezVndjJ+dKwUEEHibwJjUCqdNq4EcI6B3KBim2sMlCZ94094lH3EBnn
         ueZ0oENM/tHmepihMPYv1rlM42Wu7qlm9MhPcgOshKwYK0Xft7DsIeaXlJqesYVX7EIS
         k2CqvAusOJ9mBEEAwFrGxlhDo9GmwC5FzIVkad0B5dp5ypx7IR4iMrqztD/FmSURMekn
         8RVA==
MIME-Version: 1.0
X-Received: by 10.55.15.134 with SMTP id 6mr14129133qkp.38.1444387364990; Fri,
 09 Oct 2015 03:42:44 -0700 (PDT)
Received: by 10.55.72.20 with HTTP; Fri, 9 Oct 2015 03:42:44 -0700 (PDT)
In-Reply-To: <5617952A.6000202@kippdata.de>
References: <CAKQ1sVO+5Q9_MRbOF+K_yYq=o+cj7agw6SWxqd6RhHbsN75TaA@mail.gmail.com>
	<1444384831.4034.67.camel@mimir.webthing.com>
	<5617952A.6000202@kippdata.de>
Date: Fri, 9 Oct 2015 12:42:44 +0200
Message-ID: <CAKQ1sVMMoJ0xA0KnBo5u8vY666FzZA2u9s8=G2=3FZ7Ls9sqJQ@mail.gmail.com>
Subject: Re: GitHub (mirror) pull requests notifications
From: Yann Ylavic <ylavic.dev@gmail.com>
To: dev@httpd.apache.org
Content-Type: text/plain; charset=UTF-8

On Fri, Oct 9, 2015 at 12:21 PM, Rainer Jung <rainer.jung@kippdata.de> wrote:
>
> Or send GH mails to bugs@ similar to the BZ workflow?

That would be equally valuable, and probably simpler.

From dev-return-84184-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Fri Oct  9 10:52:56 2015
Return-Path: <dev-return-84184-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 403DA180DA
	for <apmail-httpd-dev-archive@www.apache.org>; Fri,  9 Oct 2015 10:52:56 +0000 (UTC)
Received: (qmail 27915 invoked by uid 500); 9 Oct 2015 10:52:55 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 27854 invoked by uid 500); 9 Oct 2015 10:52:55 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 27844 invoked by uid 99); 9 Oct 2015 10:52:55 -0000
Received: from Unknown (HELO spamd4-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 09 Oct 2015 10:52:55 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd4-us-west.apache.org (ASF Mail Server at spamd4-us-west.apache.org) with ESMTP id 591C6C0F46
	for <dev@httpd.apache.org>; Fri,  9 Oct 2015 10:52:55 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd4-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 3.501
X-Spam-Level: ***
X-Spam-Status: No, score=3.501 tagged_above=-999 required=6.31
	tests=[KAM_LAZY_DOMAIN_SECURITY=1, KAM_LINKBAIT=2.5,
	URIBL_BLOCKED=0.001] autolearn=disabled
Received: from mx1-us-west.apache.org ([10.40.0.8])
	by localhost (spamd4-us-west.apache.org [10.40.0.11]) (amavisd-new, port 10024)
	with ESMTP id c0Mn0xioa0Oc for <dev@httpd.apache.org>;
	Fri,  9 Oct 2015 10:52:47 +0000 (UTC)
Received: from cr.toftum.org (cr.toftum.org [78.46.97.38])
	by mx1-us-west.apache.org (ASF Mail Server at mx1-us-west.apache.org) with ESMTP id C107920FE0
	for <dev@httpd.apache.org>; Fri,  9 Oct 2015 10:52:46 +0000 (UTC)
Received: by cr.toftum.org (Postfix, from userid 1000)
	id C350E27E8092; Fri,  9 Oct 2015 12:52:38 +0200 (CEST)
Date: Fri, 9 Oct 2015 12:52:38 +0200
From: Mads Toftum <mads@toftum.dk>
To: dev@httpd.apache.org
Subject: Re: GitHub (mirror) pull requests notifications
Message-ID: <20151009105238.GX13083@toftum.dk>
Mail-Followup-To: dev@httpd.apache.org
References: <CAKQ1sVO+5Q9_MRbOF+K_yYq=o+cj7agw6SWxqd6RhHbsN75TaA@mail.gmail.com>
 <1444384831.4034.67.camel@mimir.webthing.com>
 <5617952A.6000202@kippdata.de>
 <CAKQ1sVMMoJ0xA0KnBo5u8vY666FzZA2u9s8=G2=3FZ7Ls9sqJQ@mail.gmail.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Disposition: inline
In-Reply-To: <CAKQ1sVMMoJ0xA0KnBo5u8vY666FzZA2u9s8=G2=3FZ7Ls9sqJQ@mail.gmail.com>
X-Mailer: mutt

On Fri, Oct 09, 2015 at 12:42:44PM +0200, Yann Ylavic wrote:
> On Fri, Oct 9, 2015 at 12:21 PM, Rainer Jung <rainer.jung@kippdata.de> wrote:
> >
> > Or send GH mails to bugs@ similar to the BZ workflow?
> 
> That would be equally valuable, and probably simpler.

And less noisy for those who would rather avoid the automated mails.

vh

Mads Toftum
-- 
http://flickr.com/photos/q42/

From dev-return-84185-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Fri Oct  9 11:00:39 2015
Return-Path: <dev-return-84185-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 413D01811A
	for <apmail-httpd-dev-archive@www.apache.org>; Fri,  9 Oct 2015 11:00:39 +0000 (UTC)
Received: (qmail 52444 invoked by uid 500); 9 Oct 2015 11:00:38 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 52382 invoked by uid 500); 9 Oct 2015 11:00:38 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 52372 invoked by uid 99); 9 Oct 2015 11:00:38 -0000
Received: from Unknown (HELO spamd3-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 09 Oct 2015 11:00:38 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd3-us-west.apache.org (ASF Mail Server at spamd3-us-west.apache.org) with ESMTP id 51435180A6C
	for <dev@httpd.apache.org>; Fri,  9 Oct 2015 11:00:38 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd3-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.101
X-Spam-Level:
X-Spam-Status: No, score=-0.101 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RCVD_IN_MSPIKE_H2=-0.001, SPF_PASS=-0.001, URIBL_BLOCKED=0.001]
	autolearn=disabled
Authentication-Results: spamd3-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd3-us-west.apache.org [10.40.0.10]) (amavisd-new, port 10024)
	with ESMTP id T4hKbGA9kO60 for <dev@httpd.apache.org>;
	Fri,  9 Oct 2015 11:00:29 +0000 (UTC)
Received: from mail-qg0-f48.google.com (mail-qg0-f48.google.com [209.85.192.48])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id 5048924E1C
	for <dev@httpd.apache.org>; Fri,  9 Oct 2015 11:00:29 +0000 (UTC)
Received: by qgew37 with SMTP id w37so6609720qge.0
        for <dev@httpd.apache.org>; Fri, 09 Oct 2015 04:00:22 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        bh=OCDJwr0fqFzK4lWV0rEiL5SyFby6CkpXpYRhIBTrEK8=;
        b=YludvlPH5Wbn69vRKDr3jaB+HPqOPZV+glNM38oa3EIMyJ4tKmKpYk5ctMLQFBAhSj
         gNoeMhbOW37TPI1McYkDp7cEtGswmkY+ytEr7PwZfbKF8SBuOQOY4zXzbfsxUO0VXD9U
         12v5FjmuOTNbPuC2iXLQ2Gj+GDq/zuIKWwd4+t8loPiy5emqYhRjiLiCrgGFr1P8Mf4F
         6L57Yi1KPR2rlMPqEXaEa2pWw38D5/EOn6gclmwtydEDzEdqKA5oUV78/xR6vC1twsuq
         BPItaR63IS8yvyVRl7SVAZW+2T4DsWJj5H8zlVDH8RnRpzc9n2y5F2v3E3LqdrEHNNfI
         Tz9A==
MIME-Version: 1.0
X-Received: by 10.140.131.70 with SMTP id 67mr15590857qhd.70.1444388422242;
 Fri, 09 Oct 2015 04:00:22 -0700 (PDT)
Received: by 10.55.72.20 with HTTP; Fri, 9 Oct 2015 04:00:22 -0700 (PDT)
In-Reply-To: <20151009105238.GX13083@toftum.dk>
References: <CAKQ1sVO+5Q9_MRbOF+K_yYq=o+cj7agw6SWxqd6RhHbsN75TaA@mail.gmail.com>
	<1444384831.4034.67.camel@mimir.webthing.com>
	<5617952A.6000202@kippdata.de>
	<CAKQ1sVMMoJ0xA0KnBo5u8vY666FzZA2u9s8=G2=3FZ7Ls9sqJQ@mail.gmail.com>
	<20151009105238.GX13083@toftum.dk>
Date: Fri, 9 Oct 2015 13:00:22 +0200
Message-ID: <CAKQ1sVOze+O-74oj12485-VJZPEAxHu1Sy4X_DA_tjN2Fn0nxg@mail.gmail.com>
Subject: Re: GitHub (mirror) pull requests notifications
From: Yann Ylavic <ylavic.dev@gmail.com>
To: dev@httpd.apache.org
Content-Type: text/plain; charset=UTF-8

On Fri, Oct 9, 2015 at 12:52 PM, Mads Toftum <mads@toftum.dk> wrote:
> On Fri, Oct 09, 2015 at 12:42:44PM +0200, Yann Ylavic wrote:
>> On Fri, Oct 9, 2015 at 12:21 PM, Rainer Jung <rainer.jung@kippdata.de> wrote:
>> >
>> > Or send GH mails to bugs@ similar to the BZ workflow?
>>
>> That would be equally valuable, and probably simpler.
>
> And less noisy for those who would rather avoid the automated mails.

Well, dev related stuff (patches) on dev@ is not really noise IMO...

Regards,
Yann.

From dev-return-84186-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Fri Oct  9 11:06:17 2015
Return-Path: <dev-return-84186-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 9AE3018143
	for <apmail-httpd-dev-archive@www.apache.org>; Fri,  9 Oct 2015 11:06:17 +0000 (UTC)
Received: (qmail 63293 invoked by uid 500); 9 Oct 2015 11:06:17 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 63212 invoked by uid 500); 9 Oct 2015 11:06:17 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 63201 invoked by uid 99); 9 Oct 2015 11:06:17 -0000
Received: from Unknown (HELO spamd4-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 09 Oct 2015 11:06:17 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd4-us-west.apache.org (ASF Mail Server at spamd4-us-west.apache.org) with ESMTP id 98DE5C0F46
	for <dev@httpd.apache.org>; Fri,  9 Oct 2015 11:06:16 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd4-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 1.001
X-Spam-Level: *
X-Spam-Status: No, score=1.001 tagged_above=-999 required=6.31
	tests=[KAM_LAZY_DOMAIN_SECURITY=1, URIBL_BLOCKED=0.001]
	autolearn=disabled
Received: from mx1-us-west.apache.org ([10.40.0.8])
	by localhost (spamd4-us-west.apache.org [10.40.0.11]) (amavisd-new, port 10024)
	with ESMTP id IWgD0yj9THQC for <dev@httpd.apache.org>;
	Fri,  9 Oct 2015 11:06:08 +0000 (UTC)
Received: from cr.toftum.org (cr.toftum.org [78.46.97.38])
	by mx1-us-west.apache.org (ASF Mail Server at mx1-us-west.apache.org) with ESMTP id D994E20633
	for <dev@httpd.apache.org>; Fri,  9 Oct 2015 11:06:07 +0000 (UTC)
Received: by cr.toftum.org (Postfix, from userid 1000)
	id 456E527E8092; Fri,  9 Oct 2015 13:06:07 +0200 (CEST)
Date: Fri, 9 Oct 2015 13:06:07 +0200
From: Mads Toftum <mads@toftum.dk>
To: dev@httpd.apache.org
Subject: Re: GitHub (mirror) pull requests notifications
Message-ID: <20151009110607.GY13083@toftum.dk>
Mail-Followup-To: dev@httpd.apache.org
References: <CAKQ1sVO+5Q9_MRbOF+K_yYq=o+cj7agw6SWxqd6RhHbsN75TaA@mail.gmail.com>
 <1444384831.4034.67.camel@mimir.webthing.com>
 <5617952A.6000202@kippdata.de>
 <CAKQ1sVMMoJ0xA0KnBo5u8vY666FzZA2u9s8=G2=3FZ7Ls9sqJQ@mail.gmail.com>
 <20151009105238.GX13083@toftum.dk>
 <CAKQ1sVOze+O-74oj12485-VJZPEAxHu1Sy4X_DA_tjN2Fn0nxg@mail.gmail.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Disposition: inline
In-Reply-To: <CAKQ1sVOze+O-74oj12485-VJZPEAxHu1Sy4X_DA_tjN2Fn0nxg@mail.gmail.com>
X-Mailer: mutt

On Fri, Oct 09, 2015 at 01:00:22PM +0200, Yann Ylavic wrote:
> On Fri, Oct 9, 2015 at 12:52 PM, Mads Toftum <mads@toftum.dk> wrote:
> > On Fri, Oct 09, 2015 at 12:42:44PM +0200, Yann Ylavic wrote:
> >> On Fri, Oct 9, 2015 at 12:21 PM, Rainer Jung <rainer.jung@kippdata.de> wrote:
> >> >
> >> > Or send GH mails to bugs@ similar to the BZ workflow?
> >>
> >> That would be equally valuable, and probably simpler.
> >
> > And less noisy for those who would rather avoid the automated mails.
> 
> Well, dev related stuff (patches) on dev@ is not really noise IMO...
> 
They are similar to the bugzilla messages - in many ways it's just the
lazy way of skipping the part about submitting an issue with
PatchAvailable. "Noise" may not be the best word for it, but it isn't
a discussion.

vh

Mads Toftum
-- 
http://flickr.com/photos/q42/

From dev-return-84187-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Fri Oct  9 12:00:59 2015
Return-Path: <dev-return-84187-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 5BD5A182A4
	for <apmail-httpd-dev-archive@www.apache.org>; Fri,  9 Oct 2015 12:00:59 +0000 (UTC)
Received: (qmail 58174 invoked by uid 500); 9 Oct 2015 12:00:58 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 58092 invoked by uid 500); 9 Oct 2015 12:00:58 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 58082 invoked by uid 99); 9 Oct 2015 12:00:58 -0000
Received: from Unknown (HELO spamd2-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 09 Oct 2015 12:00:58 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd2-us-west.apache.org (ASF Mail Server at spamd2-us-west.apache.org) with ESMTP id 47F321A25E1
	for <dev@httpd.apache.org>; Fri,  9 Oct 2015 12:00:58 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd2-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.101
X-Spam-Level:
X-Spam-Status: No, score=-0.101 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RCVD_IN_MSPIKE_H2=-0.001, SPF_PASS=-0.001, URIBL_BLOCKED=0.001]
	autolearn=disabled
Authentication-Results: spamd2-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd2-us-west.apache.org [10.40.0.9]) (amavisd-new, port 10024)
	with ESMTP id EYRRZnVpDny7 for <dev@httpd.apache.org>;
	Fri,  9 Oct 2015 12:00:52 +0000 (UTC)
Received: from mail-qg0-f46.google.com (mail-qg0-f46.google.com [209.85.192.46])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id E4880201F9
	for <dev@httpd.apache.org>; Fri,  9 Oct 2015 12:00:51 +0000 (UTC)
Received: by qgew37 with SMTP id w37so7706362qge.0
        for <dev@httpd.apache.org>; Fri, 09 Oct 2015 05:00:51 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        bh=ydPcbLbLbNc7Lv3dInm//an0MAq6IgJAn6KEl0+GgeQ=;
        b=kcVDO+zAqOPpxhlL+g4dE9x6D3vLU57y0XcQ45B2icdaPQQOd7y3B6T6ZLlNhcLNmo
         xr5Q7+sFsfQvYt8fUEXPwXmmcrJc8skUxwDZfRr/1pKZgkBlBbRtGXagvK6AeetCEVwh
         StoIPAYmaN4nBU3AjsPyboV/X3Tz/yWdWO/3ZX+Yrwx2b3ZLQHEiklDIAlOf22VVR+fu
         ZR4m+1inle+jtizTG+nc5pPGoNKKuvwVKlaQu2RYTolhC4B+l94wrqJeQ00jmE78A0mP
         bBWVpPEyku3f3hMEcXC/LwajM6jrqOlMSuMhnZ0LeFChOVG/kmsDKPUMN+WXeOA/ecql
         YE6w==
MIME-Version: 1.0
X-Received: by 10.141.23.9 with SMTP id z9mr15245461qhd.24.1444392050872; Fri,
 09 Oct 2015 05:00:50 -0700 (PDT)
Received: by 10.55.72.20 with HTTP; Fri, 9 Oct 2015 05:00:50 -0700 (PDT)
In-Reply-To: <5617952A.6000202@kippdata.de>
References: <CAKQ1sVO+5Q9_MRbOF+K_yYq=o+cj7agw6SWxqd6RhHbsN75TaA@mail.gmail.com>
	<1444384831.4034.67.camel@mimir.webthing.com>
	<5617952A.6000202@kippdata.de>
Date: Fri, 9 Oct 2015 14:00:50 +0200
Message-ID: <CAKQ1sVOUangH6FS3PD1QmtxQEAjcuUW07LwFUMM5cqg0EMFdbA@mail.gmail.com>
Subject: Re: GitHub (mirror) pull requests notifications
From: Yann Ylavic <ylavic.dev@gmail.com>
To: dev@httpd.apache.org
Content-Type: text/plain; charset=UTF-8

On Fri, Oct 9, 2015 at 12:21 PM, Rainer Jung <rainer.jung@kippdata.de> wrote:
>
> Or send GH mails to bugs@ similar to the BZ workflow?

Looks like good (and simple) way to have even further contributors
(which is never bad).
Daniel seems to say it's quite easy to do at infra level (including
two-way integration, i.e. replies to bugs@ would reach GH's
requester), so personnaly:

+1

From dev-return-84188-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Fri Oct  9 14:27:54 2015
Return-Path: <dev-return-84188-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id AD53818786
	for <apmail-httpd-dev-archive@www.apache.org>; Fri,  9 Oct 2015 14:27:54 +0000 (UTC)
Received: (qmail 53288 invoked by uid 500); 9 Oct 2015 14:27:54 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 53213 invoked by uid 500); 9 Oct 2015 14:27:54 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 53202 invoked by uid 99); 9 Oct 2015 14:27:54 -0000
Received: from Unknown (HELO spamd1-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 09 Oct 2015 14:27:54 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd1-us-west.apache.org (ASF Mail Server at spamd1-us-west.apache.org) with ESMTP id 9EDE6C1794
	for <dev@httpd.apache.org>; Fri,  9 Oct 2015 14:27:53 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd1-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.011
X-Spam-Level:
X-Spam-Status: No, score=-0.011 tagged_above=-999 required=6.31
	tests=[SPF_PASS=-0.001, T_RP_MATCHES_RCVD=-0.01] autolearn=disabled
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd1-us-west.apache.org [10.40.0.7]) (amavisd-new, port 10024)
	with ESMTP id i1mwVdNyBp2L for <dev@httpd.apache.org>;
	Fri,  9 Oct 2015 14:27:52 +0000 (UTC)
Received: from mail.greenbytes.de (mail.greenbytes.de [217.91.35.233])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id E1E44204D9
	for <dev@httpd.apache.org>; Fri,  9 Oct 2015 14:27:51 +0000 (UTC)
Received: from [192.168.1.48] (unknown [87.78.129.171])
	(using TLSv1 with cipher ECDHE-RSA-AES256-SHA (256/256 bits))
	(Client did not present a certificate)
	by mail.greenbytes.de (Postfix) with ESMTPSA id 384C715A0474
	for <dev@httpd.apache.org>; Fri,  9 Oct 2015 16:27:45 +0200 (CEST)
From: Stefan Eissing <stefan.eissing@greenbytes.de>
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
Subject: last checkins trunk only
Message-Id: <3E7C5868-AAD4-472B-BA6B-630B8C884884@greenbytes.de>
Date: Fri, 9 Oct 2015 16:27:44 +0200
To: dev@httpd.apache.org
Mime-Version: 1.0 (Mac OS X Mail 9.0 \(3094\))
X-Mailer: Apple Mail (2.3094)

FYI: last checkins for mod_http2 are not intended for 2.4.17

From dev-return-84189-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Fri Oct  9 15:49:35 2015
Return-Path: <dev-return-84189-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 861FA18B46
	for <apmail-httpd-dev-archive@www.apache.org>; Fri,  9 Oct 2015 15:49:35 +0000 (UTC)
Received: (qmail 37688 invoked by uid 500); 9 Oct 2015 15:49:35 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 37618 invoked by uid 500); 9 Oct 2015 15:49:35 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 37608 invoked by uid 99); 9 Oct 2015 15:49:35 -0000
Received: from Unknown (HELO spamd4-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 09 Oct 2015 15:49:35 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd4-us-west.apache.org (ASF Mail Server at spamd4-us-west.apache.org) with ESMTP id 99A78C0F46
	for <dev@httpd.apache.org>; Fri,  9 Oct 2015 15:49:34 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd4-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 0.652
X-Spam-Level:
X-Spam-Status: No, score=0.652 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, SPF_NEUTRAL=0.652]
	autolearn=disabled
Authentication-Results: spamd4-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=comcast.net
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd4-us-west.apache.org [10.40.0.11]) (amavisd-new, port 10024)
	with ESMTP id SCR2Iyo0NCnn for <dev@httpd.apache.org>;
	Fri,  9 Oct 2015 15:49:28 +0000 (UTC)
Received: from resqmta-ch2-09v.sys.comcast.net (resqmta-ch2-09v.sys.comcast.net [69.252.207.41])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id D966A439B6
	for <dev@httpd.apache.org>; Fri,  9 Oct 2015 15:49:27 +0000 (UTC)
Received: from resomta-ch2-02v.sys.comcast.net ([69.252.207.98])
	by resqmta-ch2-09v.sys.comcast.net with comcast
	id T3on1r00527uzMh013pM8B; Fri, 09 Oct 2015 15:49:21 +0000
Received: from [192.168.199.10] ([69.251.84.114])
	by resomta-ch2-02v.sys.comcast.net with comcast
	id T3pL1r00Z2U0RYt013pMor; Fri, 09 Oct 2015 15:49:21 +0000
Content-Type: text/plain; charset=us-ascii
Mime-Version: 1.0 (Mac OS X Mail 8.2 \(2104\))
Subject: Re: T&R of 2.4.17 this week
From: Jim Jagielski <jim@jaguNET.com>
In-Reply-To: <28394810-B890-4B1F-B17E-DBF42D814406@jaguNET.com>
Date: Fri, 9 Oct 2015 11:49:20 -0400
Content-Transfer-Encoding: 7bit
Message-Id: <6BD6D103-92B6-4336-9E93-568FC1AECCC1@jaguNET.com>
References: <9ACC24A9-B381-4C18-B1C4-8D9F62DD7DB5@jaguNET.com> <063688EF-F9E5-4A26-9636-702601760093@jaguNET.com> <28394810-B890-4B1F-B17E-DBF42D814406@jaguNET.com>
To: dev@httpd.apache.org
X-Mailer: Apple Mail (2.2104)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=comcast.net;
	s=q20140121; t=1444405761;
	bh=Lou3lF+pfEU5wwUohvGZ2J/fHPj36iOW4xWH378aStM=;
	h=Received:Received:Content-Type:Mime-Version:Subject:From:Date:
	 Message-Id:To;
	b=TIzIeYT6v0D61aFhZexeJjhS7F2cUX9xkZzgUKMo3jX2pATF1mhn2J/QdGjDZ3JP8
	 mI/vacPbqNLsolEKkqJkoUlxvk7Bdj6zQ7hgiIeJdCeTH1+1pFw7raRM9p0AJd1GBw
	 1n8ifzHG28UF2Qz8KASz7GJh5uagZXHLKnV1F32jWcwYOtE4/GXUH7bAGasHnV+iVy
	 QgTSbOkGukBaCT1THydkNDaLHzUwTwiKHp8Jy7NXloBrZptQ1p/HRjqzvq29motldS
	 xZ/HbvjAtgZRknf4Sw1Nu3tfsJEXs5Ne6ysoM3GaNKxVBHA0CWGz2sPHWtgKNMT6c1
	 BOtyCUUlcAayw==

The T&R will happen today around 1:30pm eastern, which is ~1.5hrs from
'now'...

From dev-return-84190-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Fri Oct  9 16:40:46 2015
Return-Path: <dev-return-84190-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 2CB7418D8F
	for <apmail-httpd-dev-archive@www.apache.org>; Fri,  9 Oct 2015 16:40:46 +0000 (UTC)
Received: (qmail 94022 invoked by uid 500); 9 Oct 2015 16:40:45 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 93943 invoked by uid 500); 9 Oct 2015 16:40:45 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 93933 invoked by uid 99); 9 Oct 2015 16:40:45 -0000
Received: from Unknown (HELO spamd1-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 09 Oct 2015 16:40:45 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd1-us-west.apache.org (ASF Mail Server at spamd1-us-west.apache.org) with ESMTP id 218B0C170A
	for <dev@httpd.apache.org>; Fri,  9 Oct 2015 16:40:45 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd1-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 0.653
X-Spam-Level:
X-Spam-Status: No, score=0.653 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, SPF_NEUTRAL=0.652,
	URIBL_BLOCKED=0.001] autolearn=disabled
Authentication-Results: spamd1-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=comcast.net
Received: from mx1-us-west.apache.org ([10.40.0.8])
	by localhost (spamd1-us-west.apache.org [10.40.0.7]) (amavisd-new, port 10024)
	with ESMTP id borKBsXv9xMC for <dev@httpd.apache.org>;
	Fri,  9 Oct 2015 16:40:35 +0000 (UTC)
Received: from resqmta-ch2-02v.sys.comcast.net (resqmta-ch2-02v.sys.comcast.net [69.252.207.34])
	by mx1-us-west.apache.org (ASF Mail Server at mx1-us-west.apache.org) with ESMTPS id 27D742165B
	for <dev@httpd.apache.org>; Fri,  9 Oct 2015 16:40:35 +0000 (UTC)
Received: from resomta-ch2-01v.sys.comcast.net ([69.252.207.97])
	by resqmta-ch2-02v.sys.comcast.net with comcast
	id T4g91r00526dK1R014gTbS; Fri, 09 Oct 2015 16:40:27 +0000
Received: from [192.168.199.10] ([69.251.84.114])
	by resomta-ch2-01v.sys.comcast.net with comcast
	id T4gS1r00c2U0RYt014gTri; Fri, 09 Oct 2015 16:40:27 +0000
Content-Type: text/plain; charset=utf-8
Mime-Version: 1.0 (Mac OS X Mail 8.2 \(2104\))
Subject: Re: about those async filters
From: Jim Jagielski <jim@jaguNET.com>
In-Reply-To: <EFD8D90A-B8B6-419F-B963-744F3ADF3DF6@sharp.fm>
Date: Fri, 9 Oct 2015 12:40:26 -0400
Content-Transfer-Encoding: quoted-printable
Message-Id: <B40A01B7-A4E8-47A2-921A-598E69CF04DB@jaguNET.com>
References: <114310CC-D227-4912-8651-B3B26F9330C9@greenbytes.de> <7DCE371B-FFB1-4254-B599-467A7827A991@sharp.fm> <CE2F280D-2036-47C2-B636-A14FB0412DB2@greenbytes.de> <EE293ED9-29D4-4000-9F1A-E0BD9A03D840@sharp.fm> <F0C3BCD3-0301-4108-A09A-9BDC6E362770@jaguNET.com> <EFD8D90A-B8B6-419F-B963-744F3ADF3DF6@sharp.fm>
To: dev@httpd.apache.org
X-Mailer: Apple Mail (2.2104)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=comcast.net;
	s=q20140121; t=1444408827;
	bh=K3Mgv+Yx5M/TxTS9K0IfYrlIP7Jqic/2NW6ek6kdt/I=;
	h=Received:Received:Content-Type:Mime-Version:Subject:From:Date:
	 Message-Id:To;
	b=MH/a6/U4eiMCCTJc3L/Z9/uVL7RFANlZsEkmybL5CllhtJfAoXd19W/U+vE88bxpQ
	 Ps6Ch1KSnpuv+a3oudtqdMyTtbhfrroe9uCB00jUUB8fKmkSNv4eTQHDZKkp5ul5Qu
	 t2PByszJAicjPTdYTr7gQzewrQYfaXBEASA4XH8djeDGijxAizGtS+jfuXEvFyUOmF
	 vfD05RJjM0naevQESNMi+Y8ZuCf2dO1Z34QmvasfWP+zBBrhsWa0os8y7TbGrLF+GJ
	 FKuhklkWiiQRbrk1XcbIyP4sSqkZP9LXBbfWjUNGR+mpzSREtL+iHp0YlHNaA2dYSj
	 CYeAdaxNBfGXA==


> On Oct 8, 2015, at 7:59 AM, Graham Leggett <minfrin@sharp.fm> wrote:
>=20
> On 08 Oct 2015, at 1:45 PM, Jim Jagielski <jim@jaguNET.com> wrote:
>=20
>> Yeah... it was 'always' foreseen that mod_h2/mod_http2 would provide
>> useful clues on how to make 2.6/3.0 better, especially w/ the idea of
>> slave connections; basically, as you say, let the MPM make =
mod_http2's
>> job easier by abstracting out a lot of the tricks that mod_http2 =
needs
>> to do to something that the MPMs themselves provide.
>>=20
>> At that same time, however, was/is the need/desire to support http/2
>> in 2.4.x (in fact, mod_h2 was *designed* w/ 2.4 in mind). So we are
>> in this initial stage where what's in trunk isn't perfect for trunk
>> (http/2-wise) but that's because it's really architectured for 2.4.
>>=20
>> Once 2.4.17 is out, then I expect mod_http2 to start diverging =
between
>> the trunk and 2.4 variants, as the version in trunk drives the MPM
>> designs there, which correspondingly drives mod_http2 in trunk as =
well
>> (ala a feedback loop). My goal was/is to make motorz "ideally" suited =
to
>> support http2.
>=20
> I don=E2=80=99t yet see a big necessity for diverging. So far the =
changes required have all been backportable to the v2.4 series, and I =
believe we should continue to strive to do so until we find we really =
can=E2=80=99t.
>=20

Oh, I agree. My point was basically that mod_http2 (and the general
impacts it makes on the architecture of core and the MPMs) will
help "drive" design, or at least show where some changes can be
made. Some may be backportable to 2.4 (and that would be ideal) and
others may not be (but that doesn't mean they shouldn't be done)

> I am sensitive to our release cycles - on purpose, we don=E2=80=99t =
release minor releases often, and that is a good thing. We want to ship =
something that is stable that people can deploy and forget about, rather =
than something that changes out from underneath you every six months.
>=20
> I don=E2=80=99t want to wait till v2.6 to get async behaviour, and I =
don=E2=80=99t believe we have to. :)

Same here. ++1!=

From dev-return-84191-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Fri Oct  9 17:40:37 2015
Return-Path: <dev-return-84191-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 5C3C618087
	for <apmail-httpd-dev-archive@www.apache.org>; Fri,  9 Oct 2015 17:40:37 +0000 (UTC)
Received: (qmail 68281 invoked by uid 500); 9 Oct 2015 17:40:33 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 68207 invoked by uid 500); 9 Oct 2015 17:40:33 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 68197 invoked by uid 99); 9 Oct 2015 17:40:33 -0000
Received: from Unknown (HELO spamd3-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 09 Oct 2015 17:40:33 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd3-us-west.apache.org (ASF Mail Server at spamd3-us-west.apache.org) with ESMTP id 3D4841809DB
	for <dev@httpd.apache.org>; Fri,  9 Oct 2015 17:40:33 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd3-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 0.652
X-Spam-Level:
X-Spam-Status: No, score=0.652 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, SPF_NEUTRAL=0.652]
	autolearn=disabled
Authentication-Results: spamd3-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=comcast.net
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd3-us-west.apache.org [10.40.0.10]) (amavisd-new, port 10024)
	with ESMTP id Q4nkeMKKGwPr for <dev@httpd.apache.org>;
	Fri,  9 Oct 2015 17:40:26 +0000 (UTC)
Received: from resqmta-ch2-10v.sys.comcast.net (resqmta-ch2-10v.sys.comcast.net [69.252.207.42])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id D785B204D9
	for <dev@httpd.apache.org>; Fri,  9 Oct 2015 17:40:25 +0000 (UTC)
Received: from resomta-ch2-16v.sys.comcast.net ([69.252.207.112])
	by resqmta-ch2-10v.sys.comcast.net with comcast
	id T5g11r0032S2Q5R015gJXx; Fri, 09 Oct 2015 17:40:18 +0000
Received: from [192.168.199.10] ([69.251.84.114])
	by resomta-ch2-16v.sys.comcast.net with comcast
	id T5gH1r00V2U0RYt015gJRe; Fri, 09 Oct 2015 17:40:18 +0000
From: Jim Jagielski <jim@jaguNET.com>
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
Subject: [VOTE] Release Apache httpd 2.4.17 as GA
Message-Id: <C45BAF78-8A10-4751-B1CA-62BB499FD795@jaguNET.com>
Date: Fri, 9 Oct 2015 13:40:17 -0400
To: httpd <dev@httpd.apache.org>
Mime-Version: 1.0 (Mac OS X Mail 8.2 \(2104\))
X-Mailer: Apple Mail (2.2104)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=comcast.net;
	s=q20140121; t=1444412418;
	bh=UE0OpiWqj/IQWHhLHrV3SUt828hLAuCpucWyeZXllpQ=;
	h=Received:Received:From:Content-Type:Subject:Message-Id:Date:To:
	 Mime-Version;
	b=S98G+Ua7LbKL1WaApTtDNidvyiyasYSt7gc4oMGz/O9p8KZ2HZxxMexCnerphauQ4
	 dfW9py4XrtfAu8fkuu1VvJ8Ty0WwK9I+bAYpFC+wF5KLMMn+xFSZ52Yo/57yB0qr2/
	 9pakIRCSS1ZisyEpmbdM3Ewp8dx6507mEOI223NXXHOA0eRiq8qEY+aUewJqtDVPW/
	 91cVt9N4cMtOB89YJo/SDRn+wbYEIFennpYgMcxWbaM8g5hm+/vqhS9WrZZ92BShuW
	 6s0Vsp/6unIWvKN+bFjTEuYbDFmaNupevqYV9+YnIZWPapNpqpQhCMB30uhUPFLUUt
	 1azbYwcOsNDkw==

The pre-release test tarballs for Apache httpd 2.4.17 can be found
at the usual place:

	http://httpd.apache.org/dev/dist/

I'm calling a VOTE on releasing these as Apache httpd 2.4.17 GA.

[ ] +1: Good to go
[ ] +0: meh
[ ] -1: Danger Will Robinson. And why.

Vote will last the normal 72 hrs.

NOTE: The *-deps are only there for convenience.

Thx!


From dev-return-84192-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Fri Oct  9 17:48:41 2015
Return-Path: <dev-return-84192-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 91F451812D
	for <apmail-httpd-dev-archive@www.apache.org>; Fri,  9 Oct 2015 17:48:41 +0000 (UTC)
Received: (qmail 96483 invoked by uid 500); 9 Oct 2015 17:48:19 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 96390 invoked by uid 500); 9 Oct 2015 17:48:19 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 96381 invoked by uid 99); 9 Oct 2015 17:48:19 -0000
Received: from mail-relay.apache.org (HELO mail-relay.apache.org) (140.211.11.15)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 09 Oct 2015 17:48:19 +0000
Received: from [192.168.1.37] (2804ds5-soeb.0.fullrate.dk [90.184.204.23])
	by mail-relay.apache.org (ASF Mail Server at mail-relay.apache.org) with ESMTPSA id 2CC371A05E9
	for <dev@httpd.apache.org>; Fri,  9 Oct 2015 17:48:17 +0000 (UTC)
Subject: Re: [VOTE] Release Apache httpd 2.4.17 as GA
To: dev@httpd.apache.org
References: <C45BAF78-8A10-4751-B1CA-62BB499FD795@jaguNET.com>
From: Daniel Gruno <humbedooh@apache.org>
Message-ID: <5617FDDF.9070901@apache.org>
Date: Fri, 9 Oct 2015 19:48:15 +0200
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:38.0) Gecko/20100101
 Thunderbird/38.3.0
MIME-Version: 1.0
In-Reply-To: <C45BAF78-8A10-4751-B1CA-62BB499FD795@jaguNET.com>
Content-Type: text/plain; charset=windows-1252
Content-Transfer-Encoding: 7bit

On 10/09/2015 07:40 PM, Jim Jagielski wrote:
> The pre-release test tarballs for Apache httpd 2.4.17 can be found
> at the usual place:
> 
> 	http://httpd.apache.org/dev/dist/
> 
> I'm calling a VOTE on releasing these as Apache httpd 2.4.17 GA.
> 
> [ ] +1: Good to go
> [ ] +0: meh
> [ ] -1: Danger Will Robinson. And why.
> 
> Vote will last the normal 72 hrs.
> 
> NOTE: The *-deps are only there for convenience.
> 
> Thx!
> 

+1 (binding)

I ran it through my usual tests, results at
http://compliance.rocks/result.html?1e67b9ba

Might need to tweak some headers, but meh..

configure, compile, install, run - all works fine (Ubuntu 14.04).
AAAND it installs mod_lua just fine, so yay!

With regards,
Daniel.

From dev-return-84193-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Fri Oct  9 22:04:54 2015
Return-Path: <dev-return-84193-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 3926718C50
	for <apmail-httpd-dev-archive@www.apache.org>; Fri,  9 Oct 2015 22:04:54 +0000 (UTC)
Received: (qmail 30790 invoked by uid 500); 9 Oct 2015 22:04:53 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 30724 invoked by uid 500); 9 Oct 2015 22:04:53 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 30714 invoked by uid 99); 9 Oct 2015 22:04:53 -0000
Received: from Unknown (HELO spamd3-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 09 Oct 2015 22:04:53 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd3-us-west.apache.org (ASF Mail Server at spamd3-us-west.apache.org) with ESMTP id 26CC1180A49
	for <dev@httpd.apache.org>; Fri,  9 Oct 2015 22:04:53 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd3-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 0.999
X-Spam-Level:
X-Spam-Status: No, score=0.999 tagged_above=-999 required=6.31
	tests=[KAM_LAZY_DOMAIN_SECURITY=1, RCVD_IN_MSPIKE_H2=-0.001]
	autolearn=disabled
Received: from mx1-us-west.apache.org ([10.40.0.8])
	by localhost (spamd3-us-west.apache.org [10.40.0.10]) (amavisd-new, port 10024)
	with ESMTP id rM5pdKCEsPp8 for <dev@httpd.apache.org>;
	Fri,  9 Oct 2015 22:04:46 +0000 (UTC)
Received: from fed1rmfepo101.cox.net (fed1rmfepo101.cox.net [68.230.241.143])
	by mx1-us-west.apache.org (ASF Mail Server at mx1-us-west.apache.org) with ESMTP id 1DA2B2031C
	for <dev@httpd.apache.org>; Fri,  9 Oct 2015 22:04:45 +0000 (UTC)
Received: from fed1rmimpo305 ([68.230.241.173]) by fed1rmfepo101.cox.net
          (InterMail vM.8.01.05.15 201-2260-151-145-20131218) with ESMTP
          id <20151009220439.UDOS20041.fed1rmfepo101.cox.net@fed1rmimpo305>
          for <dev@httpd.apache.org>; Fri, 9 Oct 2015 18:04:39 -0400
Received: from [192.168.1.33] ([98.176.34.113])
	by fed1rmimpo305 with cox
	id TA4d1r00g2STVfm01A4erZ; Fri, 09 Oct 2015 18:04:38 -0400
X-CT-Class: Clean
X-CT-Score: 0.00
X-CT-RefID: str=0001.0A020205.561839F6.022A,ss=1,re=0.000,fgs=0
X-CT-Spam: 0
X-Authority-Analysis: v=2.0 cv=f8aW8pOM c=1 sm=1
 a=8xCO7h6kmYZdHn5tUOQhsw==:17 a=LrjODJgKAAAA:8 a=mV9VRH-2AAAA:8
 a=HKnyVL4DYwcqt_C0rcYA:9 a=wPNLvfGTeEIA:10 a=8xCO7h6kmYZdHn5tUOQhsw==:117
X-CM-Score: 0.00
Authentication-Results: cox.net; auth=pass (PLAIN) smtp.auth=glewis63@cox.net
Message-ID: <56183975.4080309@gknw.net>
Date: Fri, 09 Oct 2015 15:02:29 -0700
From: Gregg Smith <gls@gknw.net>
User-Agent: Mozilla/5.0 (Windows; U; Windows NT 6.0; en-US; rv:1.9.2.28) Gecko/20120306 Thunderbird/3.1.20
MIME-Version: 1.0
To: dev@httpd.apache.org
Subject: Re: [VOTE] Release Apache httpd 2.4.17 as GA
References: <C45BAF78-8A10-4751-B1CA-62BB499FD795@jaguNET.com>
In-Reply-To: <C45BAF78-8A10-4751-B1CA-62BB499FD795@jaguNET.com>
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit

On 10/9/2015 10:40 AM, Jim Jagielski wrote:
> The pre-release test tarballs for Apache httpd 2.4.17 can be found
> at the usual place:
>
> 	http://httpd.apache.org/dev/dist/
>
> I'm calling a VOTE on releasing these as Apache httpd 2.4.17 GA.
Not a vote, I haven't gotten that far yet. It's been pointed out to me 
that on our potential first release of the new module that the docs for 
it are wrong : (  I suppose this happens when something is renamed at a 
relatively last minute.

The docs still state the module identifier as  h2_module which of course 
it's http2_module.


From dev-return-84194-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Fri Oct  9 23:47:30 2015
Return-Path: <dev-return-84194-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id ED72A18FFE
	for <apmail-httpd-dev-archive@www.apache.org>; Fri,  9 Oct 2015 23:47:29 +0000 (UTC)
Received: (qmail 24188 invoked by uid 500); 9 Oct 2015 23:47:29 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 24110 invoked by uid 500); 9 Oct 2015 23:47:29 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 24100 invoked by uid 99); 9 Oct 2015 23:47:29 -0000
Received: from Unknown (HELO spamd1-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 09 Oct 2015 23:47:29 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd1-us-west.apache.org (ASF Mail Server at spamd1-us-west.apache.org) with ESMTP id E9CC2C17DB
	for <dev@httpd.apache.org>; Fri,  9 Oct 2015 23:47:28 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd1-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.1
X-Spam-Level:
X-Spam-Status: No, score=-0.1 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	SPF_PASS=-0.001, URIBL_BLOCKED=0.001] autolearn=disabled
Authentication-Results: spamd1-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd1-us-west.apache.org [10.40.0.7]) (amavisd-new, port 10024)
	with ESMTP id cLKnBSziEZ3r for <dev@httpd.apache.org>;
	Fri,  9 Oct 2015 23:47:13 +0000 (UTC)
Received: from mail-pa0-f44.google.com (mail-pa0-f44.google.com [209.85.220.44])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id 79A414357F
	for <dev@httpd.apache.org>; Fri,  9 Oct 2015 23:47:13 +0000 (UTC)
Received: by pablk4 with SMTP id lk4so99485062pab.3
        for <dev@httpd.apache.org>; Fri, 09 Oct 2015 16:47:07 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=to:from:subject:message-id:date:user-agent:mime-version
         :content-type;
        bh=hfARcAH2TWLSxIdrmiRrTbk6ZbRRznUd5+WXtg1eiFk=;
        b=zmC9Qgd6J06oxN1pzfKQSboYoWBnHCtAOUex0kvR+0C/9+z3ZJfBLQFj01WiF8LsVK
         OZA+1lhT5bRsd98Qaef6uTyjX02ZO8qW5Em/2R3ePozd7UruDYgmbksUT5jY/0oBVx2B
         Vb2ko4EEIxfyr+0QpFNo07stPgC/rMZy9pNm5f+reb5JX6bdfhiR1i9YGiOY7sSbJxGk
         c8/9dwAkWeZGWvL13R+4Ljh0He6YfR4Vi/yS+OPIPIZPnpaFROH40+XdSAgl0sfe1uay
         Q2SPAQZMDr6w2n3WYL+dBXk7d4HV4NMpRz/T1Gaq/KjIIrOCX5TB4TY9Mq0dIFBFJ+5F
         Czpg==
X-Received: by 10.66.251.232 with SMTP id zn8mr18293796pac.80.1444434427640;
        Fri, 09 Oct 2015 16:47:07 -0700 (PDT)
Received: from [192.168.1.4] (static-50-43-55-221.bvtn.or.frontiernet.net. [50.43.55.221])
        by smtp.gmail.com with ESMTPSA id gt1sm4628495pbc.10.2015.10.09.16.47.05
        for <dev@httpd.apache.org>
        (version=TLSv1.2 cipher=ECDHE-RSA-AES128-GCM-SHA256 bits=128/128);
        Fri, 09 Oct 2015 16:47:06 -0700 (PDT)
To: dev@httpd.apache.org
From: Jacob Champion <champion.p@gmail.com>
Subject: No luck with `Protocols h2`
Message-ID: <561851F7.1000406@gmail.com>
Date: Fri, 9 Oct 2015 16:47:03 -0700
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:38.0) Gecko/20100101
 Thunderbird/38.2.0
MIME-Version: 1.0
Content-Type: multipart/mixed;
 boundary="------------030006040003090009060805"

This is a multi-part message in MIME format.
--------------030006040003090009060805
Content-Type: text/plain; charset=utf-8; format=flowed
Content-Transfer-Encoding: 7bit

Stefan,

I'm trying to test mod_http2 for the 2.4.17 release, but I cannot for 
the life of me get ALPN and the h2 protocol working together. h2c seems 
to work, as does http/1.1 over TLS. My hope is that I'm just missing a 
config directive somewhere; can anyone else confirm that h2 negotiation 
is working for them?

I've attached a few files; hopefully they help.
- working.txt shows the debug log for an HTTP/1.1 Firefox request that 
ends in a 404. Note "ALPN selected protocol: 'http/1.1'", so ALPN 
appears to be functioning there.
- not_working.txt shows the same request, but after I've added a 
`Protocols h2 http/1.1`	line and restarted the server. Note the "h2_h2, 
error reading 24 bytes speculative" line with status "End of file 
found". Firefox sees a response of zero bytes and does nothing.
- httpd.conf is my server configuration. (It's the result of trying to 
strip out huge pieces of the actual conf to see where the error started 
from; sorry for the mess.)

It's not just Firefox: nghttp also complains that h2 is not being 
negotiated and refuses to continue with the request. I saw the 
no-matching-SSL-virtual-host error first and thought that might have 
something to do with it, but adding ServerAliases didn't seem to help 
anything.

I'm running on Ubuntu 14.04 with Apache 2.4.17, APR 2.0, OpenSSL 1.0.2d, 
nghttp2 1.3.4.

Thanks for any wisdom you can provide,
--Jacob

--------------030006040003090009060805
Content-Type: text/plain; charset=UTF-8;
 name="working.txt"
Content-Transfer-Encoding: base64
Content-Disposition: attachment;
 filename="working.txt"

W0ZyaSBPY3QgMDkgMTY6MjA6NDAuMDI1MTE2IDIwMTVdIFtzc2w6aW5mb10gW3BpZCAzMTg3
MTp0aWQgMTQwMzg3MzYzNjQ5MjgwXSBbY2xpZW50IDEyNy4wLjAuMTo1MTU1OV0gQUgwMTk2
NDogQ29ubmVjdGlvbiB0byBjaGlsZCAxIGVzdGFibGlzaGVkIChzZXJ2ZXIgMTI3LjAuMS4x
OjgwODEpCltGcmkgT2N0IDA5IDE2OjIwOjQwLjAyNTI5NCAyMDE1XSBbc3NsOmRlYnVnXSBb
cGlkIDMxODcxOnRpZCAxNDAzODczNjM2NDkyODBdIHNzbF9lbmdpbmVfa2VybmVsLmMoMTk0
MCk6IFtjbGllbnQgMTI3LjAuMC4xOjUxNTU5XSBBSDAyMDQ0OiBObyBtYXRjaGluZyBTU0wg
dmlydHVhbCBob3N0IGZvciBzZXJ2ZXJuYW1lIGxvY2FsaG9zdCBmb3VuZCAodXNpbmcgZGVm
YXVsdC9maXJzdCB2aXJ0dWFsIGhvc3QpCltGcmkgT2N0IDA5IDE2OjIwOjQwLjAyNTMwNiAy
MDE1XSBbY29yZTpkZWJ1Z10gW3BpZCAzMTg3MTp0aWQgMTQwMzg3MzYzNjQ5MjgwXSBwcm90
b2NvbC5jKDE4NDApOiBbY2xpZW50IDEyNy4wLjAuMTo1MTU1OV0gc2VsZWN0IHByb3RvY29s
IGZyb20gLCBjaG9pY2VzPWgyLHNwZHkvMy4xLGh0dHAvMS4xIGZvciBzZXJ2ZXIgMTI3LjAu
MS4xCltGcmkgT2N0IDA5IDE2OjIwOjQwLjAyNTMxNiAyMDE1XSBbc3NsOmRlYnVnXSBbcGlk
IDMxODcxOnRpZCAxNDAzODczNjM2NDkyODBdIHNzbF9lbmdpbmVfa2VybmVsLmMoMTk0MCk6
IFtjbGllbnQgMTI3LjAuMC4xOjUxNTU5XSBBSDAyMDQ0OiBObyBtYXRjaGluZyBTU0wgdmly
dHVhbCBob3N0IGZvciBzZXJ2ZXJuYW1lIGxvY2FsaG9zdCBmb3VuZCAodXNpbmcgZGVmYXVs
dC9maXJzdCB2aXJ0dWFsIGhvc3QpCltGcmkgT2N0IDA5IDE2OjIwOjQwLjAyNTgxNCAyMDE1
XSBbc3NsOmRlYnVnXSBbcGlkIDMxODcxOnRpZCAxNDAzODczNjM2NDkyODBdIHNzbF9lbmdp
bmVfa2VybmVsLmMoMTg2MCk6IFtjbGllbnQgMTI3LjAuMC4xOjUxNTU5XSBBSDAyMDQxOiBQ
cm90b2NvbDogVExTdjEuMiwgQ2lwaGVyOiBFQ0RIRS1SU0EtQUVTMjU2LVNIQSAoMjU2LzI1
NiBiaXRzKQpbRnJpIE9jdCAwOSAxNjoyMDo0MC4wMjU4NDIgMjAxNV0gW3NzbDpkZWJ1Z10g
W3BpZCAzMTg3MTp0aWQgMTQwMzg3MzYzNjQ5MjgwXSBzc2xfZW5naW5lX2lvLmMoMTQzOSk6
IFtjbGllbnQgMTI3LjAuMC4xOjUxNTU5XSBBSDAyODM2OiBBTFBOIHNlbGVjdGVkIHByb3Rv
Y29sOiAnaHR0cC8xLjEnCltGcmkgT2N0IDA5IDE2OjIwOjQwLjAyNTg3MiAyMDE1XSBbc3Ns
OmRlYnVnXSBbcGlkIDMxODcxOnRpZCAxNDAzODczNjM2NDkyODBdIHNzbF9lbmdpbmVfa2Vy
bmVsLmMoMjQ1KTogW2NsaWVudCAxMjcuMC4wLjE6NTE1NTldIEFIMDIwMzQ6IEluaXRpYWwg
KE5vLjEpIEhUVFBTIHJlcXVlc3QgcmVjZWl2ZWQgZm9yIGNoaWxkIDEgKHNlcnZlciAxMjcu
MC4xLjE6ODA4MSkKW0ZyaSBPY3QgMDkgMTY6MjA6NDAuMDI1OTE3IDIwMTVdIFthdXRoel9j
b3JlOmRlYnVnXSBbcGlkIDMxODcxOnRpZCAxNDAzODczNjM2NDkyODBdIG1vZF9hdXRoel9j
b3JlLmMoODA5KTogW2NsaWVudCAxMjcuMC4wLjE6NTE1NTldIEFIMDE2MjY6IGF1dGhvcml6
YXRpb24gcmVzdWx0IG9mIFJlcXVpcmUgYWxsIGdyYW50ZWQ6IGdyYW50ZWQKW0ZyaSBPY3Qg
MDkgMTY6MjA6NDAuMDI1OTI4IDIwMTVdIFthdXRoel9jb3JlOmRlYnVnXSBbcGlkIDMxODcx
OnRpZCAxNDAzODczNjM2NDkyODBdIG1vZF9hdXRoel9jb3JlLmMoODA5KTogW2NsaWVudCAx
MjcuMC4wLjE6NTE1NTldIEFIMDE2MjY6IGF1dGhvcml6YXRpb24gcmVzdWx0IG9mIDxSZXF1
aXJlQW55PjogZ3JhbnRlZApbRnJpIE9jdCAwOSAxNjoyMDo0MC4wMjU5NDMgMjAxNV0gW2Nv
cmU6aW5mb10gW3BpZCAzMTg3MTp0aWQgMTQwMzg3MzYzNjQ5MjgwXSBbY2xpZW50IDEyNy4w
LjAuMTo1MTU1OV0gQUgwMDEyODogRmlsZSBkb2VzIG5vdCBleGlzdDogL3Vzci9sb2NhbC9h
cGFjaGUyL2h0ZG9jcy9odHRwYmluLwpbRnJpIE9jdCAwOSAxNjoyMDo0NC45MzMyNzEgMjAx
NV0gW3NzbDpkZWJ1Z10gW3BpZCAzMTg3MTp0aWQgMTQwMzg3MDg3NzMwNDMyXSBzc2xfZW5n
aW5lX2lvLmMoMTAwNyk6IFtyZW1vdGUgMTI3LjAuMC4xOjUxNTU5XSBBSDAyMDAxOiBDb25u
ZWN0aW9uIGNsb3NlZCB0byBjaGlsZCAxIHdpdGggc3RhbmRhcmQgc2h1dGRvd24gKHNlcnZl
ciAxMjcuMC4xLjE6ODA4MSkKCg==
--------------030006040003090009060805
Content-Type: text/plain; charset=UTF-8;
 name="not_working.txt"
Content-Transfer-Encoding: base64
Content-Disposition: attachment;
 filename="not_working.txt"

W0ZyaSBPY3QgMDkgMTY6MjE6MTAuOTczODAzIDIwMTVdIFtzc2w6aW5mb10gW3BpZCAzMjA3
Njp0aWQgMTQwMzg3MzM4NDcxMTY4XSBbY2xpZW50IDEyNy4wLjAuMTo1MTU2MV0gQUgwMTk2
NDogQ29ubmVjdGlvbiB0byBjaGlsZCAxMzIgZXN0YWJsaXNoZWQgKHNlcnZlciAxMjcuMC4x
LjE6ODA4MSkKW0ZyaSBPY3QgMDkgMTY6MjE6MTAuOTc0MTE4IDIwMTVdIFtzc2w6ZGVidWdd
IFtwaWQgMzIwNzY6dGlkIDE0MDM4NzMzODQ3MTE2OF0gc3NsX2VuZ2luZV9rZXJuZWwuYygx
OTQwKTogW2NsaWVudCAxMjcuMC4wLjE6NTE1NjFdIEFIMDIwNDQ6IE5vIG1hdGNoaW5nIFNT
TCB2aXJ0dWFsIGhvc3QgZm9yIHNlcnZlcm5hbWUgbG9jYWxob3N0IGZvdW5kICh1c2luZyBk
ZWZhdWx0L2ZpcnN0IHZpcnR1YWwgaG9zdCkKW0ZyaSBPY3QgMDkgMTY6MjE6MTAuOTc0MTMz
IDIwMTVdIFtjb3JlOmRlYnVnXSBbcGlkIDMyMDc2OnRpZCAxNDAzODczMzg0NzExNjhdIHBy
b3RvY29sLmMoMTg0MCk6IFtjbGllbnQgMTI3LjAuMC4xOjUxNTYxXSBzZWxlY3QgcHJvdG9j
b2wgZnJvbSBoMixodHRwLzEuMSwgY2hvaWNlcz1oMixzcGR5LzMuMSxodHRwLzEuMSBmb3Ig
c2VydmVyIDEyNy4wLjEuMQpbRnJpIE9jdCAwOSAxNjoyMToxMC45NzQxNDkgMjAxNV0gW2Nv
cmU6ZGVidWddIFtwaWQgMzIwNzY6dGlkIDE0MDM4NzMzODQ3MTE2OF0gcHJvdG9jb2wuYygx
ODg1KTogW2NsaWVudCAxMjcuMC4wLjE6NTE1NjFdIHNlbGVjdCBwcm90b2NvbCwgcHJvcG9z
YWxzPWgyLGh0dHAvMS4xIHByZWZlcmVuY2VzPWgyLGh0dHAvMS4xIGNvbmZpZ3VyZWQ9aDIs
aHR0cC8xLjEKW0ZyaSBPY3QgMDkgMTY6MjE6MTAuOTc0MTU3IDIwMTVdIFtjb3JlOmRlYnVn
XSBbcGlkIDMyMDc2OnRpZCAxNDAzODczMzg0NzExNjhdIHByb3RvY29sLmMoMTkwMik6IFtj
bGllbnQgMTI3LjAuMC4xOjUxNTYxXSBzZWxlY3RlZCBwcm90b2NvbD1oMgpbRnJpIE9jdCAw
OSAxNjoyMToxMC45NzQxNjYgMjAxNV0gW3NzbDpkZWJ1Z10gW3BpZCAzMjA3Njp0aWQgMTQw
Mzg3MzM4NDcxMTY4XSBzc2xfZW5naW5lX2tlcm5lbC5jKDE5NDApOiBbY2xpZW50IDEyNy4w
LjAuMTo1MTU2MV0gQUgwMjA0NDogTm8gbWF0Y2hpbmcgU1NMIHZpcnR1YWwgaG9zdCBmb3Ig
c2VydmVybmFtZSBsb2NhbGhvc3QgZm91bmQgKHVzaW5nIGRlZmF1bHQvZmlyc3QgdmlydHVh
bCBob3N0KQpbRnJpIE9jdCAwOSAxNjoyMToxMC45ODEzNDEgMjAxNV0gW3NzbDpkZWJ1Z10g
W3BpZCAzMjA3Njp0aWQgMTQwMzg3MzM4NDcxMTY4XSBzc2xfZW5naW5lX2tlcm5lbC5jKDE4
NjApOiBbY2xpZW50IDEyNy4wLjAuMTo1MTU2MV0gQUgwMjA0MTogUHJvdG9jb2w6IFRMU3Yx
LjIsIENpcGhlcjogRUNESEUtUlNBLUFFUzI1Ni1TSEEgKDI1Ni8yNTYgYml0cykKW0ZyaSBP
Y3QgMDkgMTY6MjE6MTAuOTg3MzQ1IDIwMTVdIFtodHRwMjpkZWJ1Z10gW3BpZCAzMjA3Njp0
aWQgMTQwMzg3MzM4NDcxMTY4XSBoMl9oMi5jKDE5MCk6ICg3MDAxNClFbmQgb2YgZmlsZSBm
b3VuZDogW2NsaWVudCAxMjcuMC4wLjE6NTE1NjFdIGgyX2gyLCBlcnJvciByZWFkaW5nIDI0
IGJ5dGVzIHNwZWN1bGF0aXZlCltGcmkgT2N0IDA5IDE2OjIxOjEwLjk4NzQ2OSAyMDE1XSBb
c3NsOmRlYnVnXSBbcGlkIDMyMDc2OnRpZCAxNDAzODczMzg0NzExNjhdIHNzbF9lbmdpbmVf
aW8uYygxMDA3KTogW2NsaWVudCAxMjcuMC4wLjE6NTE1NjFdIEFIMDIwMDE6IENvbm5lY3Rp
b24gY2xvc2VkIHRvIGNoaWxkIDEzMiB3aXRoIHN0YW5kYXJkIHNodXRkb3duIChzZXJ2ZXIg
MTI3LjAuMS4xOjgwODEpCgo=
--------------030006040003090009060805
Content-Type: text/plain; charset=UTF-8;
 name="httpd.conf"
Content-Transfer-Encoding: base64
Content-Disposition: attachment;
 filename="httpd.conf"

TGlzdGVuIDgwODEKCkxvYWRNb2R1bGUgYWxpYXNfbW9kdWxlIG1vZHVsZXMvbW9kX2FsaWFz
LnNvCkxvYWRNb2R1bGUgYXV0aG5fY29yZV9tb2R1bGUgbW9kdWxlcy9tb2RfYXV0aG5fY29y
ZS5zbwpMb2FkTW9kdWxlIGF1dGh6X2NvcmVfbW9kdWxlIG1vZHVsZXMvbW9kX2F1dGh6X2Nv
cmUuc28KTG9hZE1vZHVsZSBkaXJfbW9kdWxlIG1vZHVsZXMvbW9kX2Rpci5zbwpMb2FkTW9k
dWxlIGVudl9tb2R1bGUgbW9kdWxlcy9tb2RfZW52LnNvCkxvYWRNb2R1bGUgaHR0cDJfbW9k
dWxlIG1vZHVsZXMvbW9kX2h0dHAyLnNvCkxvYWRNb2R1bGUgbG9nX2NvbmZpZ19tb2R1bGUg
bW9kdWxlcy9tb2RfbG9nX2NvbmZpZy5zbwpMb2FkTW9kdWxlIG1pbWVfbW9kdWxlIG1vZHVs
ZXMvbW9kX21pbWUuc28KTG9hZE1vZHVsZSBzb2NhY2hlX3NobWNiX21vZHVsZSBtb2R1bGVz
L21vZF9zb2NhY2hlX3NobWNiLnNvCkxvYWRNb2R1bGUgc3NsX21vZHVsZSBtb2R1bGVzL21v
ZF9zc2wuc28KTG9hZE1vZHVsZSBzdGF0dXNfbW9kdWxlIG1vZHVsZXMvbW9kX3N0YXR1cy5z
bwpMb2FkTW9kdWxlIHVuaXhkX21vZHVsZSBtb2R1bGVzL21vZF91bml4ZC5zbwpMb2FkTW9k
dWxlIHZlcnNpb25fbW9kdWxlIG1vZHVsZXMvbW9kX3ZlcnNpb24uc28KCkxvZ0xldmVsIGRl
YnVnCgo8SWZNb2R1bGUgdW5peGRfbW9kdWxlPgpVc2VyIGRhZW1vbgpHcm91cCBkYWVtb24K
PC9JZk1vZHVsZT4KCjxEaXJlY3RvcnkgLz4KICAgIEFsbG93T3ZlcnJpZGUgbm9uZQogICAg
UmVxdWlyZSBhbGwgZGVuaWVkCjwvRGlyZWN0b3J5PgoKRG9jdW1lbnRSb290ICIvdXNyL2xv
Y2FsL2FwYWNoZTIvaHRkb2NzIgo8RGlyZWN0b3J5ICIvdXNyL2xvY2FsL2FwYWNoZTIvaHRk
b2NzIj4KICAgIE9wdGlvbnMgSW5kZXhlcyBGb2xsb3dTeW1MaW5rcwogICAgQWxsb3dPdmVy
cmlkZSBOb25lCiAgICBSZXF1aXJlIGFsbCBncmFudGVkCjwvRGlyZWN0b3J5PgoKUHJvdG9j
b2xzIGgyIGh0dHAvMS4xCgpTU0xDaXBoZXJTdWl0ZSBISUdIOk1FRElVTTohTUQ1OiFSQzQK
U1NMUHJveHlDaXBoZXJTdWl0ZSBISUdIOk1FRElVTTohTUQ1OiFSQzQKU1NMSG9ub3JDaXBo
ZXJPcmRlciBvbiAKU1NMUHJvdG9jb2wgYWxsIC1TU0x2MwpTU0xQcm94eVByb3RvY29sIGFs
bCAtU1NMdjMKU1NMUGFzc1BocmFzZURpYWxvZyAgYnVpbHRpbgpTU0xTZXNzaW9uQ2FjaGUg
ICAgICAgICJzaG1jYjovdXNyL2xvY2FsL2FwYWNoZTIvbG9ncy9zc2xfc2NhY2hlKDUxMjAw
MCkiClNTTFNlc3Npb25DYWNoZVRpbWVvdXQgIDMwMAoKPFZpcnR1YWxIb3N0IF9kZWZhdWx0
Xzo4MDgxPgogIFNTTEVuZ2luZSBPbgoKICBTU0xDZXJ0aWZpY2F0ZUZpbGUgIi9ldGMvc3Ns
L2NlcnRzL3NzbC1jZXJ0LXNuYWtlb2lsLnBlbSIKICBTU0xDZXJ0aWZpY2F0ZUtleUZpbGUg
Ii9ldGMvc3NsL3ByaXZhdGUvc3NsLWNlcnQtc25ha2VvaWwua2V5Igo8L1ZpcnR1YWxIb3N0
PgoKPEZpbGVzTWF0Y2ggIlwuKGNnaXxzaHRtbHxwaHRtbHxwaHApJCI+CiAgICBTU0xPcHRp
b25zICtTdGRFbnZWYXJzCjwvRmlsZXNNYXRjaD4KPERpcmVjdG9yeSAiL3Vzci9sb2NhbC9h
cGFjaGUyL2NnaS1iaW4iPgogICAgU1NMT3B0aW9ucyArU3RkRW52VmFycwo8L0RpcmVjdG9y
eT4KCkN1c3RvbUxvZyAiL3Vzci9sb2NhbC9hcGFjaGUyL2xvZ3Mvc3NsX3JlcXVlc3RfbG9n
IiBcCiAgICAgICAgICAiJXQgJWggJXtTU0xfUFJPVE9DT0x9eCAle1NTTF9DSVBIRVJ9eCBc
IiVyXCIgJWIiCgo8SWZNb2R1bGUgc3NsX21vZHVsZT4KU1NMUmFuZG9tU2VlZCBzdGFydHVw
IGJ1aWx0aW4KU1NMUmFuZG9tU2VlZCBjb25uZWN0IGJ1aWx0aW4KPC9JZk1vZHVsZT4K
--------------030006040003090009060805--

From dev-return-84195-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Sat Oct 10 00:14:09 2015
Return-Path: <dev-return-84195-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 50CB7180EE
	for <apmail-httpd-dev-archive@www.apache.org>; Sat, 10 Oct 2015 00:14:09 +0000 (UTC)
Received: (qmail 64960 invoked by uid 500); 10 Oct 2015 00:14:08 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 64886 invoked by uid 500); 10 Oct 2015 00:14:08 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 64876 invoked by uid 99); 10 Oct 2015 00:14:08 -0000
Received: from Unknown (HELO spamd1-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 10 Oct 2015 00:14:08 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd1-us-west.apache.org (ASF Mail Server at spamd1-us-west.apache.org) with ESMTP id 3C99AC51CC
	for <dev@httpd.apache.org>; Sat, 10 Oct 2015 00:14:08 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd1-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 1.001
X-Spam-Level: *
X-Spam-Status: No, score=1.001 tagged_above=-999 required=6.31
	tests=[KAM_LAZY_DOMAIN_SECURITY=1, URIBL_BLOCKED=0.001]
	autolearn=disabled
Received: from mx1-us-west.apache.org ([10.40.0.8])
	by localhost (spamd1-us-west.apache.org [10.40.0.7]) (amavisd-new, port 10024)
	with ESMTP id xqGJSsWktAqv for <dev@httpd.apache.org>;
	Sat, 10 Oct 2015 00:13:57 +0000 (UTC)
Received: from fed1rmfepo103.cox.net (fed1rmfepo103.cox.net [68.230.241.145])
	by mx1-us-west.apache.org (ASF Mail Server at mx1-us-west.apache.org) with ESMTP id 7122C203BC
	for <dev@httpd.apache.org>; Sat, 10 Oct 2015 00:13:56 +0000 (UTC)
Received: from fed1rmimpo209 ([68.230.241.160]) by fed1rmfepo103.cox.net
          (InterMail vM.8.01.05.15 201-2260-151-145-20131218) with ESMTP
          id <20151010001350.BXLV22789.fed1rmfepo103.cox.net@fed1rmimpo209>
          for <dev@httpd.apache.org>; Fri, 9 Oct 2015 20:13:50 -0400
Received: from [192.168.1.33] ([98.176.34.113])
	by fed1rmimpo209 with cox
	id TCDp1r0092STVfm01CDpqV; Fri, 09 Oct 2015 20:13:50 -0400
X-CT-Class: Clean
X-CT-Score: 0.00
X-CT-RefID: str=0001.0A020204.5618583E.007C,ss=1,re=0.000,fgs=0
X-CT-Spam: 0
X-Authority-Analysis: v=2.0 cv=UYSPvtuN c=1 sm=1
 a=8xCO7h6kmYZdHn5tUOQhsw==:17 a=LrjODJgKAAAA:8 a=vI9lsFiWAAAA:8
 a=jK2yl9Vd9GW0tEqhV_4A:9 a=QEXdDO2ut3YA:10 a=XZOSOZVxYpkA:10
 a=8xCO7h6kmYZdHn5tUOQhsw==:117
X-CM-Score: 0.00
Authentication-Results: cox.net; auth=pass (PLAIN) smtp.auth=glewis63@cox.net
Message-ID: <561857BB.3060101@gknw.net>
Date: Fri, 09 Oct 2015 17:11:39 -0700
From: Gregg Smith <gls@gknw.net>
User-Agent: Mozilla/5.0 (Windows; U; Windows NT 6.0; en-US; rv:1.9.2.28) Gecko/20120306 Thunderbird/3.1.20
MIME-Version: 1.0
To: dev@httpd.apache.org
Subject: Re: No luck with `Protocols h2`
References: <561851F7.1000406@gmail.com>
In-Reply-To: <561851F7.1000406@gmail.com>
Content-Type: text/plain; charset=UTF-8; format=flowed
Content-Transfer-Encoding: 7bit

Hi Jacob,
On 10/9/2015 4:47 PM, Jacob Champion wrote:
> Stefan,
>
> I'm trying to test mod_http2 for the 2.4.17 release, but I cannot for 
> the life of me get ALPN and the h2 protocol working together. h2c 
> seems to work, as does http/1.1 over TLS. My hope is that I'm just 
> missing a config directive somewhere; can anyone else confirm that h2 
> negotiation is working for them?
>
> I've attached a few files; hopefully they help.
> - working.txt shows the debug log for an HTTP/1.1 Firefox request that 
> ends in a 404. Note "ALPN selected protocol: 'http/1.1'", so ALPN 
> appears to be functioning there.
> - not_working.txt shows the same request, but after I've added a 
> `Protocols h2 http/1.1`    line and restarted the server. Note the 
> "h2_h2, error reading 24 bytes speculative" line with status "End of 
> file found". Firefox sees a response of zero bytes and does nothing.
> - httpd.conf is my server configuration. (It's the result of trying to 
> strip out huge pieces of the actual conf to see where the error 
> started from; sorry for the mess.)
>
> It's not just Firefox: nghttp also complains that h2 is not being 
> negotiated and refuses to continue with the request. I saw the 
> no-matching-SSL-virtual-host error first and thought that might have 
> something to do with it, but adding ServerAliases didn't seem to help 
> anything.
>
> I'm running on Ubuntu 14.04 with Apache 2.4.17, APR 2.0, OpenSSL 
> 1.0.2d, nghttp2 1.3.4.
>
> Thanks for any wisdom you can provide,
> --Jacob
I'm betting it's the cipher being used ECDHE-RSA-AES256-SHA. OpenSSL says
ECDHE-RSA-AES256-SHA = TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA

There is a big list of blacklisted ciphers in the RFC 
https://httpwg.github.io/specs/rfc7540.html#BadCipherSuites
You will find that cipher on the list.

I have no real recommendation for you but the RFC states all 
implementations must support
TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256 or OpenSSL's equivalent 
ECDHE-RSA-AES128-GCM-SHA256.
So it's a starting point.

Happy http/2-ing,

Gregg

From dev-return-84196-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Sat Oct 10 00:24:49 2015
Return-Path: <dev-return-84196-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 364C418126
	for <apmail-httpd-dev-archive@www.apache.org>; Sat, 10 Oct 2015 00:24:49 +0000 (UTC)
Received: (qmail 80841 invoked by uid 500); 10 Oct 2015 00:24:48 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 80761 invoked by uid 500); 10 Oct 2015 00:24:48 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 80751 invoked by uid 99); 10 Oct 2015 00:24:48 -0000
Received: from Unknown (HELO spamd1-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 10 Oct 2015 00:24:48 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd1-us-west.apache.org (ASF Mail Server at spamd1-us-west.apache.org) with ESMTP id 3F8A8C1864
	for <dev@httpd.apache.org>; Sat, 10 Oct 2015 00:24:48 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd1-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.102
X-Spam-Level:
X-Spam-Status: No, score=-0.102 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RCVD_IN_MSPIKE_H2=-0.001, SPF_PASS=-0.001] autolearn=disabled
Authentication-Results: spamd1-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-us-west.apache.org ([10.40.0.8])
	by localhost (spamd1-us-west.apache.org [10.40.0.7]) (amavisd-new, port 10024)
	with ESMTP id LJmWg4r7U_7n for <dev@httpd.apache.org>;
	Sat, 10 Oct 2015 00:24:47 +0000 (UTC)
Received: from mail-pa0-f44.google.com (mail-pa0-f44.google.com [209.85.220.44])
	by mx1-us-west.apache.org (ASF Mail Server at mx1-us-west.apache.org) with ESMTPS id 9E00B203BC
	for <dev@httpd.apache.org>; Sat, 10 Oct 2015 00:24:47 +0000 (UTC)
Received: by padhy16 with SMTP id hy16so99879759pad.1
        for <dev@httpd.apache.org>; Fri, 09 Oct 2015 17:24:47 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=subject:to:references:from:message-id:date:user-agent:mime-version
         :in-reply-to:content-type:content-transfer-encoding;
        bh=mG94rXWaVopjjD1gC4q8jzFFVpBRicT/kG4lLqPeYho=;
        b=VmeFdVhgeH3Y5IyTtao+OyV+4MplYIKr2gFN0/0TKkOOTpCu9f7Ws0TpzrErLA61M6
         YS9XrzAyfrlczU5ZvcfN5TGyIoOOJZ5f9K/8Ww5mEyGtcVM2LUfZ2SIzj9O8f6UKam4p
         42Hmq9Lb5v6BRenpBCT3OsjKble+zBftyX/8lSaCjVuZuZRWfgVJDxbdldhNFjDe9d4l
         71qiE/qHGJqLf9euoUYw0OZ6IcdzT8CEifievhkxTWKORPyTaleMPry0W8Muab1KPJQF
         rPqKSkmjtiJOtA+qymgRadOezh6zG8fCrHCdap8E4J/7imCv2hehnHwN9jtONvpij8vr
         eNKg==
X-Received: by 10.68.197.7 with SMTP id iq7mr18818510pbc.108.1444436687343;
        Fri, 09 Oct 2015 17:24:47 -0700 (PDT)
Received: from [192.168.1.4] (static-50-43-55-221.bvtn.or.frontiernet.net. [50.43.55.221])
        by smtp.gmail.com with ESMTPSA id tb9sm4714584pab.13.2015.10.09.17.24.45
        for <dev@httpd.apache.org>
        (version=TLSv1.2 cipher=ECDHE-RSA-AES128-GCM-SHA256 bits=128/128);
        Fri, 09 Oct 2015 17:24:45 -0700 (PDT)
Subject: Re: No luck with `Protocols h2`
To: dev@httpd.apache.org
References: <561851F7.1000406@gmail.com> <561857BB.3060101@gknw.net>
From: Jacob Champion <champion.p@gmail.com>
Message-ID: <56185ACB.4030608@gmail.com>
Date: Fri, 9 Oct 2015 17:24:43 -0700
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:38.0) Gecko/20100101
 Thunderbird/38.2.0
MIME-Version: 1.0
In-Reply-To: <561857BB.3060101@gknw.net>
Content-Type: text/plain; charset=utf-8; format=flowed
Content-Transfer-Encoding: 7bit

On 10/09/2015 05:11 PM, Gregg Smith wrote:
> I have no real recommendation for you but the RFC states all
> implementations must support
> TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256 or OpenSSL's equivalent
> ECDHE-RSA-AES128-GCM-SHA256.
> So it's a starting point.

Perfect! After pulling it up front with

     SSLCipherSuite ECDHE-RSA-AES128-GCM-SHA256:HIGH:MEDIUM:!MD5:!RC4

all appears to be working with Firefox. (Haven't figured out the nghttp 
failure yet though.) Thanks Gregg!

So, there's some feedback for the module then: that's a really strange 
failure mode. It would be nice if something in the logs reflected the 
bad cipher in use, and/or the documentation pointed this interaction 
out. (Or maybe it already does and I just overlooked it?)

--Jacob


From dev-return-84197-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Sat Oct 10 07:20:49 2015
Return-Path: <dev-return-84197-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 85F671884C
	for <apmail-httpd-dev-archive@www.apache.org>; Sat, 10 Oct 2015 07:20:49 +0000 (UTC)
Received: (qmail 62356 invoked by uid 500); 10 Oct 2015 07:20:48 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 62281 invoked by uid 500); 10 Oct 2015 07:20:47 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 62271 invoked by uid 99); 10 Oct 2015 07:20:47 -0000
Received: from Unknown (HELO spamd1-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 10 Oct 2015 07:20:47 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd1-us-west.apache.org (ASF Mail Server at spamd1-us-west.apache.org) with ESMTP id 7E24FC1E1F
	for <dev@httpd.apache.org>; Sat, 10 Oct 2015 07:20:47 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd1-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.01
X-Spam-Level:
X-Spam-Status: No, score=-0.01 tagged_above=-999 required=6.31
	tests=[SPF_PASS=-0.001, T_RP_MATCHES_RCVD=-0.01, URIBL_BLOCKED=0.001]
	autolearn=disabled
Received: from mx1-us-west.apache.org ([10.40.0.8])
	by localhost (spamd1-us-west.apache.org [10.40.0.7]) (amavisd-new, port 10024)
	with ESMTP id RxmaQLb2RUPg for <dev@httpd.apache.org>;
	Sat, 10 Oct 2015 07:20:37 +0000 (UTC)
Received: from mail.greenbytes.de (mail.greenbytes.de [217.91.35.233])
	by mx1-us-west.apache.org (ASF Mail Server at mx1-us-west.apache.org) with ESMTPS id 5B027207EE
	for <dev@httpd.apache.org>; Sat, 10 Oct 2015 07:20:37 +0000 (UTC)
Received: from [192.168.0.130] (unknown [87.78.134.68])
	(using TLSv1 with cipher ECDHE-RSA-AES256-SHA (256/256 bits))
	(Client did not present a certificate)
	by mail.greenbytes.de (Postfix) with ESMTPSA id 7EA3D15A049A
	for <dev@httpd.apache.org>; Sat, 10 Oct 2015 09:20:28 +0200 (CEST)
From: Stefan Eissing <stefan.eissing@greenbytes.de>
Content-Type: text/plain;
	charset=us-ascii
Content-Transfer-Encoding: quoted-printable
Mime-Version: 1.0 (1.0)
Subject: Re: No luck with `Protocols h2`
Message-Id: <D51220D5-8C08-4211-85BB-D5AF3E7EC306@greenbytes.de>
Date: Sat, 10 Oct 2015 09:20:27 +0200
References: <561851F7.1000406@gmail.com> <561857BB.3060101@gknw.net> <56185ACB.4030608@gmail.com>
In-Reply-To: <56185ACB.4030608@gmail.com>
To: dev@httpd.apache.org
X-Mailer: iPhone Mail (13A452)

Glad that Gregg pointed you the right way.=20

Yes, I'll add that to the todos. There should be a better spec compliance ch=
eck configurable in the server that gives at least logs for clients that do n=
ot comply and are turned down.=20

In the meantime, I have prepped a howto h2 to point people to in order to gi=
ve/collect some advice. http://icing.github.io/mod_h2/howto.html

That will, once stable become part of the official docs.=20

> Am 10.10.2015 um 02:24 schrieb Jacob Champion <champion.p@gmail.com>:
>=20
>> On 10/09/2015 05:11 PM, Gregg Smith wrote:
>> I have no real recommendation for you but the RFC states all
>> implementations must support
>> TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256 or OpenSSL's equivalent
>> ECDHE-RSA-AES128-GCM-SHA256.
>> So it's a starting point.
>=20
> Perfect! After pulling it up front with
>=20
>    SSLCipherSuite ECDHE-RSA-AES128-GCM-SHA256:HIGH:MEDIUM:!MD5:!RC4
>=20
> all appears to be working with Firefox. (Haven't figured out the nghttp fa=
ilure yet though.) Thanks Gregg!
>=20
> So, there's some feedback for the module then: that's a really strange fai=
lure mode. It would be nice if something in the logs reflected the bad ciphe=
r in use, and/or the documentation pointed this interaction out. (Or maybe i=
t already does and I just overlooked it?)
>=20
> --Jacob
>=20

From dev-return-84198-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Sat Oct 10 07:22:34 2015
Return-Path: <dev-return-84198-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 650D718853
	for <apmail-httpd-dev-archive@www.apache.org>; Sat, 10 Oct 2015 07:22:34 +0000 (UTC)
Received: (qmail 64177 invoked by uid 500); 10 Oct 2015 07:22:33 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 64107 invoked by uid 500); 10 Oct 2015 07:22:33 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 64097 invoked by uid 99); 10 Oct 2015 07:22:33 -0000
Received: from Unknown (HELO spamd1-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 10 Oct 2015 07:22:33 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd1-us-west.apache.org (ASF Mail Server at spamd1-us-west.apache.org) with ESMTP id 776A7C1E23
	for <dev@httpd.apache.org>; Sat, 10 Oct 2015 07:22:33 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd1-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.01
X-Spam-Level:
X-Spam-Status: No, score=-0.01 tagged_above=-999 required=6.31
	tests=[SPF_PASS=-0.001, T_RP_MATCHES_RCVD=-0.01, URIBL_BLOCKED=0.001]
	autolearn=disabled
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd1-us-west.apache.org [10.40.0.7]) (amavisd-new, port 10024)
	with ESMTP id yY_x6jFiPhmv for <dev@httpd.apache.org>;
	Sat, 10 Oct 2015 07:22:25 +0000 (UTC)
Received: from mail.greenbytes.de (mail.greenbytes.de [217.91.35.233])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id 19E74439C4
	for <dev@httpd.apache.org>; Sat, 10 Oct 2015 07:22:25 +0000 (UTC)
Received: from [192.168.0.130] (unknown [87.78.134.68])
	(using TLSv1 with cipher ECDHE-RSA-AES256-SHA (256/256 bits))
	(Client did not present a certificate)
	by mail.greenbytes.de (Postfix) with ESMTPSA id B5FCE15A05BC
	for <dev@httpd.apache.org>; Sat, 10 Oct 2015 09:22:17 +0200 (CEST)
From: Stefan Eissing <stefan.eissing@greenbytes.de>
Content-Type: text/plain;
	charset=us-ascii
Content-Transfer-Encoding: quoted-printable
Mime-Version: 1.0 (1.0)
Subject: Re: [VOTE] Release Apache httpd 2.4.17 as GA
Message-Id: <1DF4E500-3937-4E93-BA1C-57A8E0B99E16@greenbytes.de>
Date: Sat, 10 Oct 2015 09:22:17 +0200
References: <C45BAF78-8A10-4751-B1CA-62BB499FD795@jaguNET.com> <56183975.4080309@gknw.net>
In-Reply-To: <56183975.4080309@gknw.net>
To: dev@httpd.apache.org
X-Mailer: iPhone Mail (13A452)

Will check the release later today. The nit in the doc should not hold us ba=
ck.

> Am 10.10.2015 um 00:02 schrieb Gregg Smith <gls@gknw.net>:
>=20
>> On 10/9/2015 10:40 AM, Jim Jagielski wrote:
>> The pre-release test tarballs for Apache httpd 2.4.17 can be found
>> at the usual place:
>>=20
>>    http://httpd.apache.org/dev/dist/
>>=20
>> I'm calling a VOTE on releasing these as Apache httpd 2.4.17 GA.
> Not a vote, I haven't gotten that far yet. It's been pointed out to me tha=
t on our potential first release of the new module that the docs for it are w=
rong : (  I suppose this happens when something is renamed at a relatively l=
ast minute.
>=20
> The docs still state the module identifier as  h2_module which of course i=
t's http2_module.
>=20

From dev-return-84199-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Sat Oct 10 07:54:40 2015
Return-Path: <dev-return-84199-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 375DE188DE
	for <apmail-httpd-dev-archive@www.apache.org>; Sat, 10 Oct 2015 07:54:40 +0000 (UTC)
Received: (qmail 84977 invoked by uid 500); 10 Oct 2015 07:54:34 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 84903 invoked by uid 500); 10 Oct 2015 07:54:34 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 84893 invoked by uid 99); 10 Oct 2015 07:54:34 -0000
Received: from Unknown (HELO spamd1-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 10 Oct 2015 07:54:34 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd1-us-west.apache.org (ASF Mail Server at spamd1-us-west.apache.org) with ESMTP id DFFACC529A
	for <dev@httpd.apache.org>; Sat, 10 Oct 2015 07:54:33 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd1-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.01
X-Spam-Level:
X-Spam-Status: No, score=-0.01 tagged_above=-999 required=6.31
	tests=[SPF_PASS=-0.001, T_RP_MATCHES_RCVD=-0.01, URIBL_BLOCKED=0.001]
	autolearn=disabled
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd1-us-west.apache.org [10.40.0.7]) (amavisd-new, port 10024)
	with ESMTP id UMGZKqYdvosL for <dev@httpd.apache.org>;
	Sat, 10 Oct 2015 07:54:25 +0000 (UTC)
Received: from mail.greenbytes.de (mail.greenbytes.de [217.91.35.233])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id 3032042B36
	for <dev@httpd.apache.org>; Sat, 10 Oct 2015 07:54:25 +0000 (UTC)
Received: from [192.168.0.130] (unknown [87.78.134.68])
	(using TLSv1 with cipher ECDHE-RSA-AES256-SHA (256/256 bits))
	(Client did not present a certificate)
	by mail.greenbytes.de (Postfix) with ESMTPSA id 022CB15A0440
	for <dev@httpd.apache.org>; Sat, 10 Oct 2015 09:54:23 +0200 (CEST)
From: Stefan Eissing <stefan.eissing@greenbytes.de>
Content-Type: text/plain;
	charset=us-ascii
Content-Transfer-Encoding: 7bit
Mime-Version: 1.0 (1.0)
Subject: in case someone is bored
Message-Id: <3EDF4154-EA8D-4095-8F6F-98773ABE9550@greenbytes.de>
Date: Sat, 10 Oct 2015 09:54:23 +0200
To: dev@httpd.apache.org
X-Mailer: iPhone Mail (13A452)

https://github.com/google/ngx_brotli

Support is in chrome and firefox.

//Stefan

From dev-return-84200-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Sat Oct 10 11:31:58 2015
Return-Path: <dev-return-84200-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 1224918CEF
	for <apmail-httpd-dev-archive@www.apache.org>; Sat, 10 Oct 2015 11:31:58 +0000 (UTC)
Received: (qmail 7675 invoked by uid 500); 10 Oct 2015 11:31:57 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 7598 invoked by uid 500); 10 Oct 2015 11:31:57 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 7588 invoked by uid 99); 10 Oct 2015 11:31:57 -0000
Received: from Unknown (HELO spamd1-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 10 Oct 2015 11:31:57 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd1-us-west.apache.org (ASF Mail Server at spamd1-us-west.apache.org) with ESMTP id 35F20C5321
	for <dev@httpd.apache.org>; Sat, 10 Oct 2015 11:31:57 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd1-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 2.5
X-Spam-Level: **
X-Spam-Status: No, score=2.5 tagged_above=-999 required=6.31
	tests=[KAM_LAZY_DOMAIN_SECURITY=1, KAM_STOCKGEN=1.5]
	autolearn=disabled
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd1-us-west.apache.org [10.40.0.7]) (amavisd-new, port 10024)
	with ESMTP id Hvf8lQfvjGKm for <dev@httpd.apache.org>;
	Sat, 10 Oct 2015 11:31:52 +0000 (UTC)
Received: from node176.itex.at (mail.123x.at [194.242.35.176])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id 1F55742BEB
	for <dev@httpd.apache.org>; Sat, 10 Oct 2015 11:31:51 +0000 (UTC)
Received: from localhost (localhost [127.0.0.1])
	by node176.itex.at (Postfix) with ESMTP id 8075C22B09
	for <dev@httpd.apache.org>; Sat, 10 Oct 2015 13:31:43 +0200 (CEST)
X-Virus-Scanned: Debian amavisd-new at node176.itex.at
Received: from node176.itex.at ([127.0.0.1])
	by localhost (node176.itex.at [127.0.0.1]) (amavisd-new, port 10024)
	with ESMTP id H303wLZOZ9Qu for <dev@httpd.apache.org>;
	Sat, 10 Oct 2015 13:31:43 +0200 (CEST)
Received: from [10.0.0.1] (unknown [101.174.24.138])
	(Authenticated sender: normw@gknw.net)
	by node176.itex.at (Postfix) with ESMTPSA id 6073E21318
	for <dev@httpd.apache.org>; Sat, 10 Oct 2015 13:31:41 +0200 (CEST)
To: "dev@httpd.apache.org" <dev@httpd.apache.org>
From: NormW <normw@gknw.net>
Subject: A small wrinkle in latest r1707735 update to
 httpd-trunk\modules\http2\h2_util.c
Message-ID: <5618F716.30908@gknw.net>
Date: Sat, 10 Oct 2015 22:31:34 +1100
User-Agent: Mozilla/5.0 (Windows NT 5.1; rv:38.0) Gecko/20100101
 Thunderbird/38.3.0
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8; format=flowed
Content-Transfer-Encoding: 7bit

Hmmmm,
> CC   h2_worker.c
> CC   h2_workers.c
> CC   mod_http2.c
> GEN  obj_release/mod_http2_link.opt
> LINK obj_release/mod_http2.nlm
> ### mwldnlm Linker Error:
> #   Undefined symbol: APR_BUCKET_IS_MMAP in
> #   h2_util.o

In apr-util\include\apr_buckets.h:
> #if APR_HAS_MMAP
> /**
>  * Determine if a bucket is a MMAP bucket
>  * @param e The bucket to inspect
>  * @return true or false
>  */
> #define APR_BUCKET_IS_MMAP(e)        ((e)->type == &apr_bucket_type_mmap)
> #endif

:-( MMAP is (sadly) not a feature of NetWare. If the http2 experts 
assert the entire http2 module is a dud without MMAP support, I am not 
in a position or mind to oppose dropping NetWare 'support' for http2 
entirely.

Alternatively, something like this in h2_util.c MAY be good enough :
>                 }
>++ #if APR_HAS_MMAP
>                 else if (APR_BUCKET_IS_MMAP(b)) {
>                     btype = "mmap";
>                 }
>++ #endif

Norm

From dev-return-84201-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Sat Oct 10 13:40:40 2015
Return-Path: <dev-return-84201-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 1C0CA171E2
	for <apmail-httpd-dev-archive@www.apache.org>; Sat, 10 Oct 2015 13:40:40 +0000 (UTC)
Received: (qmail 36198 invoked by uid 500); 10 Oct 2015 13:40:34 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 36139 invoked by uid 500); 10 Oct 2015 13:40:34 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 36129 invoked by uid 99); 10 Oct 2015 13:40:34 -0000
Received: from Unknown (HELO spamd3-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 10 Oct 2015 13:40:34 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd3-us-west.apache.org (ASF Mail Server at spamd3-us-west.apache.org) with ESMTP id 02021180EE0
	for <dev@httpd.apache.org>; Sat, 10 Oct 2015 13:40:34 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd3-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 0.653
X-Spam-Level:
X-Spam-Status: No, score=0.653 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, SPF_NEUTRAL=0.652,
	URIBL_BLOCKED=0.001] autolearn=disabled
Authentication-Results: spamd3-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=comcast.net
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd3-us-west.apache.org [10.40.0.10]) (amavisd-new, port 10024)
	with ESMTP id nPiXfUFWG8jW for <dev@httpd.apache.org>;
	Sat, 10 Oct 2015 13:40:25 +0000 (UTC)
Received: from resqmta-ch2-09v.sys.comcast.net (resqmta-ch2-09v.sys.comcast.net [69.252.207.41])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id 8759B20524
	for <dev@httpd.apache.org>; Sat, 10 Oct 2015 13:40:24 +0000 (UTC)
Received: from resomta-ch2-04v.sys.comcast.net ([69.252.207.100])
	by resqmta-ch2-09v.sys.comcast.net with comcast
	id TRgL1r0012AWL2D01RgPNt; Sat, 10 Oct 2015 13:40:23 +0000
Received: from [192.168.199.10] ([69.251.84.114])
	by resomta-ch2-04v.sys.comcast.net with comcast
	id TRgN1r0032U0RYt01RgNCe; Sat, 10 Oct 2015 13:40:23 +0000
Content-Type: text/plain; charset=us-ascii
Mime-Version: 1.0 (Mac OS X Mail 8.2 \(2104\))
Subject: Re: [VOTE] Release Apache httpd 2.4.17 as GA
From: Jim Jagielski <jim@jaguNET.com>
In-Reply-To: <C45BAF78-8A10-4751-B1CA-62BB499FD795@jaguNET.com>
Date: Sat, 10 Oct 2015 09:40:22 -0400
Content-Transfer-Encoding: 7bit
Message-Id: <8AA978CD-4541-4A9F-845C-A8FB3F212B27@jaguNET.com>
References: <C45BAF78-8A10-4751-B1CA-62BB499FD795@jaguNET.com>
To: dev@httpd.apache.org
X-Mailer: Apple Mail (2.2104)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=comcast.net;
	s=q20140121; t=1444484423;
	bh=ODwNDwbjJhYt/z1XFEkRJn8CUG8cdrxVkuipajoO6yE=;
	h=Received:Received:Content-Type:Mime-Version:Subject:From:Date:
	 Message-Id:To;
	b=QQ7alE7j8mTKuN8dAQB4/g/xELVEj259f5o8OjHMbJSsiBhqrJs6kspxN9zbLJ0EQ
	 HUbDRrFkk+Iu7Ekcpi8cb4EpfTMJvhVopv/xwZ9w6Nv2rR54C0YHQmxzrFE3xeeI8p
	 MBhbgiPOPU2gld1DeXka3Zjf/Hik/b3OdPi7SHox6WQswcg8VMTfY2W6CbvYttG83H
	 gFwEpO+jefADvcD6Fy6MdJfyGTB+lFFr8uiAXx6jLlo7eo8AYMxMlhKLrFlFx31kPk
	 dwhVXg9YZV0cQ7KpZKkcXvnH9PNJhosbC9c9hZi/KQucf/vvTrH0gyxhK0chOrd0pP
	 6rhaQPlDvdWfg==


> On Oct 9, 2015, at 1:40 PM, Jim Jagielski <jim@jaguNET.com> wrote:
> 
> The pre-release test tarballs for Apache httpd 2.4.17 can be found
> at the usual place:
> 
> 	http://httpd.apache.org/dev/dist/
> 
> I'm calling a VOTE on releasing these as Apache httpd 2.4.17 GA.
> 
> [X] +1: Good to go

Tested:
  o CentOS 6.7, x64:
    - event: lua52 and http2
    - worker: lua52 and http2
  o CentOS 7.0, x64:
    - event: lua52 and http2
    - worker: lua52 and http2
  o OSX 10.10.5 / Xcode 7.0.1, x64
    - event: lua52 and http2
    - worker: lua52 and http2
  o FreeBSD 10.1-RELEASE-P19, x64
    - event: http2

From dev-return-84202-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Sat Oct 10 17:46:13 2015
Return-Path: <dev-return-84202-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 935B1177DD
	for <apmail-httpd-dev-archive@www.apache.org>; Sat, 10 Oct 2015 17:46:13 +0000 (UTC)
Received: (qmail 49034 invoked by uid 500); 10 Oct 2015 17:46:13 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 48968 invoked by uid 500); 10 Oct 2015 17:46:13 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 48958 invoked by uid 99); 10 Oct 2015 17:46:13 -0000
Received: from Unknown (HELO spamd4-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 10 Oct 2015 17:46:13 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd4-us-west.apache.org (ASF Mail Server at spamd4-us-west.apache.org) with ESMTP id A8DCFC0729
	for <dev@httpd.apache.org>; Sat, 10 Oct 2015 17:46:12 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd4-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 1.491
X-Spam-Level: *
X-Spam-Status: No, score=1.491 tagged_above=-999 required=6.31
	tests=[KAM_STOCKGEN=1.5, T_RP_MATCHES_RCVD=-0.01, URIBL_BLOCKED=0.001]
	autolearn=disabled
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd4-us-west.apache.org [10.40.0.11]) (amavisd-new, port 10024)
	with ESMTP id KwLr8yXb3T4X for <dev@httpd.apache.org>;
	Sat, 10 Oct 2015 17:46:04 +0000 (UTC)
Received: from mail.greenbytes.de (mail.greenbytes.de [217.91.35.233])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id 253B920524
	for <dev@httpd.apache.org>; Sat, 10 Oct 2015 17:46:04 +0000 (UTC)
Received: from [192.168.178.41] (unknown [93.211.102.222])
	(using TLSv1 with cipher ECDHE-RSA-AES256-SHA (256/256 bits))
	(Client did not present a certificate)
	by mail.greenbytes.de (Postfix) with ESMTPSA id 09BA115A047E
	for <dev@httpd.apache.org>; Sat, 10 Oct 2015 19:45:56 +0200 (CEST)
Content-Type: text/plain; charset=us-ascii
Mime-Version: 1.0 (Mac OS X Mail 9.0 \(3094\))
Subject: Re: A small wrinkle in latest r1707735 update to httpd-trunk\modules\http2\h2_util.c
From: Stefan Eissing <stefan.eissing@greenbytes.de>
In-Reply-To: <5618F716.30908@gknw.net>
Date: Sat, 10 Oct 2015 19:45:57 +0200
Content-Transfer-Encoding: quoted-printable
Message-Id: <432220E7-4319-40D7-AB6F-206CE59D7CA2@greenbytes.de>
References: <5618F716.30908@gknw.net>
To: dev@httpd.apache.org
X-Mailer: Apple Mail (2.3094)

Ok, will add that. This is only in trunk. 2.4.x should compile for you.

> Am 10.10.2015 um 13:31 schrieb NormW <normw@gknw.net>:
>=20
> Hmmmm,
>> CC   h2_worker.c
>> CC   h2_workers.c
>> CC   mod_http2.c
>> GEN  obj_release/mod_http2_link.opt
>> LINK obj_release/mod_http2.nlm
>> ### mwldnlm Linker Error:
>> #   Undefined symbol: APR_BUCKET_IS_MMAP in
>> #   h2_util.o
>=20
> In apr-util\include\apr_buckets.h:
>> #if APR_HAS_MMAP
>> /**
>> * Determine if a bucket is a MMAP bucket
>> * @param e The bucket to inspect
>> * @return true or false
>> */
>> #define APR_BUCKET_IS_MMAP(e)        ((e)->type =3D=3D =
&apr_bucket_type_mmap)
>> #endif
>=20
> :-( MMAP is (sadly) not a feature of NetWare. If the http2 experts =
assert the entire http2 module is a dud without MMAP support, I am not =
in a position or mind to oppose dropping NetWare 'support' for http2 =
entirely.
>=20
> Alternatively, something like this in h2_util.c MAY be good enough :
>>                }
>> ++ #if APR_HAS_MMAP
>>                else if (APR_BUCKET_IS_MMAP(b)) {
>>                    btype =3D "mmap";
>>                }
>> ++ #endif
>=20
> Norm


From dev-return-84203-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Sat Oct 10 18:14:52 2015
Return-Path: <dev-return-84203-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id D666B1791C
	for <apmail-httpd-dev-archive@www.apache.org>; Sat, 10 Oct 2015 18:14:52 +0000 (UTC)
Received: (qmail 13190 invoked by uid 500); 10 Oct 2015 18:14:52 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 13116 invoked by uid 500); 10 Oct 2015 18:14:52 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 13105 invoked by uid 99); 10 Oct 2015 18:14:52 -0000
Received: from Unknown (HELO spamd2-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 10 Oct 2015 18:14:52 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd2-us-west.apache.org (ASF Mail Server at spamd2-us-west.apache.org) with ESMTP id E70541A275E
	for <dev@httpd.apache.org>; Sat, 10 Oct 2015 18:14:51 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd2-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.011
X-Spam-Level:
X-Spam-Status: No, score=-0.011 tagged_above=-999 required=6.31
	tests=[SPF_PASS=-0.001, T_RP_MATCHES_RCVD=-0.01] autolearn=disabled
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd2-us-west.apache.org [10.40.0.9]) (amavisd-new, port 10024)
	with ESMTP id DdrFlcqSyi-F for <dev@httpd.apache.org>;
	Sat, 10 Oct 2015 18:14:48 +0000 (UTC)
Received: from mail.greenbytes.de (mail.greenbytes.de [217.91.35.233])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id 5624928280
	for <dev@httpd.apache.org>; Sat, 10 Oct 2015 18:14:48 +0000 (UTC)
Received: from [192.168.178.41] (unknown [93.211.102.222])
	(using TLSv1 with cipher ECDHE-RSA-AES256-SHA (256/256 bits))
	(Client did not present a certificate)
	by mail.greenbytes.de (Postfix) with ESMTPSA id 048BB15A34A4
	for <dev@httpd.apache.org>; Sat, 10 Oct 2015 20:14:46 +0200 (CEST)
From: Stefan Eissing <stefan.eissing@greenbytes.de>
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: quoted-printable
Subject: this expected?
Message-Id: <5D0C3260-FB28-4E03-BA5D-FC13CCA933D6@greenbytes.de>
Date: Sat, 10 Oct 2015 20:14:46 +0200
To: dev@httpd.apache.org
Mime-Version: 1.0 (Mac OS X Mail 9.0 \(3094\))
X-Mailer: Apple Mail (2.3094)

Testing 2.4.17 release tar ball on OS X 10.11 (event/worker/prefork, =
openssl 1.0.2d):

t/ssl/varlookup.t ................... 1/81 # Failed test 55 in =
t/ssl/varlookup.t at line 105 fail #55
# Failed test 56 in t/ssl/varlookup.t at line 105 fail #56
# Failed test 57 in t/ssl/varlookup.t at line 105 fail #57
# Failed test 58 in t/ssl/varlookup.t at line 105 fail #58
# Failed test 75 in t/ssl/varlookup.t at line 105 fail #75
# Failed test 76 in t/ssl/varlookup.t at line 105 fail #76
t/ssl/varlookup.t ................... Failed 6/81 subtests=20
t/ssl/verify.t ...................... ok  =20



From dev-return-84204-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Sat Oct 10 18:44:31 2015
Return-Path: <dev-return-84204-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 2F50217A02
	for <apmail-httpd-dev-archive@www.apache.org>; Sat, 10 Oct 2015 18:44:31 +0000 (UTC)
Received: (qmail 80289 invoked by uid 500); 10 Oct 2015 18:44:29 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 80228 invoked by uid 500); 10 Oct 2015 18:44:29 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 80218 invoked by uid 99); 10 Oct 2015 18:44:29 -0000
Received: from Unknown (HELO spamd4-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 10 Oct 2015 18:44:29 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd4-us-west.apache.org (ASF Mail Server at spamd4-us-west.apache.org) with ESMTP id 7516CC0BDA
	for <dev@httpd.apache.org>; Sat, 10 Oct 2015 18:44:29 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd4-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.01
X-Spam-Level:
X-Spam-Status: No, score=-0.01 tagged_above=-999 required=6.31
	tests=[SPF_PASS=-0.001, T_RP_MATCHES_RCVD=-0.01, URIBL_BLOCKED=0.001]
	autolearn=disabled
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd4-us-west.apache.org [10.40.0.11]) (amavisd-new, port 10024)
	with ESMTP id vxsTN28FrY4q for <dev@httpd.apache.org>;
	Sat, 10 Oct 2015 18:44:19 +0000 (UTC)
Received: from mail.greenbytes.de (mail.greenbytes.de [217.91.35.233])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id 96D2A20382
	for <dev@httpd.apache.org>; Sat, 10 Oct 2015 18:44:18 +0000 (UTC)
Received: from [192.168.178.41] (unknown [93.211.102.222])
	(using TLSv1 with cipher ECDHE-RSA-AES256-SHA (256/256 bits))
	(Client did not present a certificate)
	by mail.greenbytes.de (Postfix) with ESMTPSA id 8CC9615A0F79
	for <dev@httpd.apache.org>; Sat, 10 Oct 2015 20:44:17 +0200 (CEST)
Content-Type: text/plain; charset=us-ascii
Mime-Version: 1.0 (Mac OS X Mail 9.0 \(3094\))
Subject: Re: [VOTE] Release Apache httpd 2.4.17 as GA
From: Stefan Eissing <stefan.eissing@greenbytes.de>
In-Reply-To: <C45BAF78-8A10-4751-B1CA-62BB499FD795@jaguNET.com>
Date: Sat, 10 Oct 2015 20:44:16 +0200
Content-Transfer-Encoding: 7bit
Message-Id: <EFCF4480-48CF-4C76-824A-DB49CD0B9E7A@greenbytes.de>
References: <C45BAF78-8A10-4751-B1CA-62BB499FD795@jaguNET.com>
To: dev@httpd.apache.org
X-Mailer: Apple Mail (2.3094)


> Am 09.10.2015 um 19:40 schrieb Jim Jagielski <jim@jagunet.com>:
> 
> The pre-release test tarballs for Apache httpd 2.4.17 can be found
> at the usual place:
> 
> 	http://httpd.apache.org/dev/dist/
> 
> I'm calling a VOTE on releasing these as Apache httpd 2.4.17 GA.
> 
> [ ] +1: Good to go

Apart from the sslvar lookup failures reported in a separate mail

Tested:
* OSX 10.11 / Xcode 7.0.1, x64
  - event, worker, prefork: http2
* Ubuntu 14.04.1, x64
  - event, worker, prefork: http2

From dev-return-84205-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Sat Oct 10 20:14:50 2015
Return-Path: <dev-return-84205-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 9318217BF1
	for <apmail-httpd-dev-archive@www.apache.org>; Sat, 10 Oct 2015 20:14:50 +0000 (UTC)
Received: (qmail 4506 invoked by uid 500); 10 Oct 2015 20:14:44 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 4430 invoked by uid 500); 10 Oct 2015 20:14:44 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 4420 invoked by uid 99); 10 Oct 2015 20:14:44 -0000
Received: from Unknown (HELO spamd1-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 10 Oct 2015 20:14:44 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd1-us-west.apache.org (ASF Mail Server at spamd1-us-west.apache.org) with ESMTP id 570CEC54B9
	for <dev@httpd.apache.org>; Sat, 10 Oct 2015 20:14:44 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd1-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.1
X-Spam-Level:
X-Spam-Status: No, score=-0.1 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	SPF_PASS=-0.001, URIBL_BLOCKED=0.001] autolearn=disabled
Authentication-Results: spamd1-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-us-west.apache.org ([10.40.0.8])
	by localhost (spamd1-us-west.apache.org [10.40.0.7]) (amavisd-new, port 10024)
	with ESMTP id EReeBNO5OHtW for <dev@httpd.apache.org>;
	Sat, 10 Oct 2015 20:14:34 +0000 (UTC)
Received: from mail-pa0-f54.google.com (mail-pa0-f54.google.com [209.85.220.54])
	by mx1-us-west.apache.org (ASF Mail Server at mx1-us-west.apache.org) with ESMTPS id 84AB620633
	for <dev@httpd.apache.org>; Sat, 10 Oct 2015 20:14:34 +0000 (UTC)
Received: by pabve7 with SMTP id ve7so59134577pab.2
        for <dev@httpd.apache.org>; Sat, 10 Oct 2015 13:14:28 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=subject:to:references:from:message-id:date:user-agent:mime-version
         :in-reply-to:content-type:content-transfer-encoding;
        bh=WCaFwXMy32BTGEhMqS1C/0vk6/nxbbJtaVAmvjuWV80=;
        b=mIMsDmUPZR7lC38q1nIjnjl3/N4ZXebbEX9tR6FQGf0lyIOspwPaYHsbfVKCENe57+
         /riet3EGeb8VrhCWM65czS/DJTqEMw6tktcivOy2vrlbQW3OXPLe/yTM1UocsRBtVV/P
         OLZDLQFhC5/mUFt09vZUQ3KS/KbpofnrFqojJ3I/7ne7xYKDIhLpmHmHlXR6XTA2IyFz
         /hFiQgeUTKKZUkIBnbvDuDIGQrSD5U8vOtCkd9TcLLF/N5tHrZ/+WrAfoP4obQsAXY4q
         CIsCNfuFn4pdm51zlQn+NGOqbyt+nkqR4e/7fL78S/NlNW+a1NgKrXcxl4bYOQqxUfnJ
         BO+g==
X-Received: by 10.67.15.100 with SMTP id fn4mr24841059pad.120.1444508068659;
        Sat, 10 Oct 2015 13:14:28 -0700 (PDT)
Received: from [192.168.1.4] (static-50-43-55-221.bvtn.or.frontiernet.net. [50.43.55.221])
        by smtp.gmail.com with ESMTPSA id de4sm9660074pbb.60.2015.10.10.13.14.27
        for <dev@httpd.apache.org>
        (version=TLSv1.2 cipher=ECDHE-RSA-AES128-GCM-SHA256 bits=128/128);
        Sat, 10 Oct 2015 13:14:27 -0700 (PDT)
Subject: Re: No luck with `Protocols h2`
To: dev@httpd.apache.org
References: <561851F7.1000406@gmail.com> <561857BB.3060101@gknw.net>
 <56185ACB.4030608@gmail.com>
 <D51220D5-8C08-4211-85BB-D5AF3E7EC306@greenbytes.de>
From: Jacob Champion <champion.p@gmail.com>
Message-ID: <561971A3.8020804@gmail.com>
Date: Sat, 10 Oct 2015 13:14:27 -0700
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:38.0) Gecko/20100101
 Thunderbird/38.2.0
MIME-Version: 1.0
In-Reply-To: <D51220D5-8C08-4211-85BB-D5AF3E7EC306@greenbytes.de>
Content-Type: text/plain; charset=windows-1252; format=flowed
Content-Transfer-Encoding: 7bit

On 10/10/2015 12:20 AM, Stefan Eissing wrote:
> In the meantime, I have prepped a howto h2 to point people to in order to give/collect some advice. http://icing.github.io/mod_h2/howto.html
>
> That will, once stable become part of the official docs.

Great, thanks! That is very helpful. One bit of feedback: in the Firefox 
section you say that

 > Among the response headers, you see this strange X-Firefox-Spdy entry
 > listing "h2". That is the indication that HTTP/2 is used on this
 > https: connection.

Another (possibly more future-proof?) indicator in that Network Headers 
panel is the "Version: HTTP/2.0" field that is underneath the Status 
Code and above the search bar.

>> Am 10.10.2015 um 02:24 schrieb Jacob Champion <champion.p@gmail.com>:
>>
>>>(Haven't figured out the nghttp failure yet though.) Thanks Gregg!

For those following at home, and to save anyone else the trouble... 
nghttp still wasn't working, so I

- built Wireshark trunk to get HTTP/2 dissection for the stream, but I 
still couldn't decrypt the ephemeral ciphers, so I
- installed an LD_PRELOAD shim to get the pre-master secret keys only to 
find that the encrypted alerts were simply disconnection notices, then 
noticed that
- NPN was being sent in the Client Hello instead of ALPN, which is 
probably because
- my nghttp is using my system OpenSSL (1.0.1) instead of my latest 
compile (1.0.2).

The bleeding edge is fun. :)

In any case, I've now got an httpbin instance running in mod_passenger 
over HTTP/2, which is very cool. I was originally hoping to help with 
the vote, but now that I've discovered my binaries are mismatched, I 
wouldn't trust my test results anyway. Maybe next time.

Good luck with the release!
--Jacob

From dev-return-84206-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Sat Oct 10 20:32:02 2015
Return-Path: <dev-return-84206-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 2C9A917C44
	for <apmail-httpd-dev-archive@www.apache.org>; Sat, 10 Oct 2015 20:32:02 +0000 (UTC)
Received: (qmail 18571 invoked by uid 500); 10 Oct 2015 20:32:01 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 18508 invoked by uid 500); 10 Oct 2015 20:32:01 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 18498 invoked by uid 99); 10 Oct 2015 20:32:01 -0000
Received: from Unknown (HELO spamd4-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 10 Oct 2015 20:32:01 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd4-us-west.apache.org (ASF Mail Server at spamd4-us-west.apache.org) with ESMTP id 2FBE0C0BDA
	for <dev@httpd.apache.org>; Sat, 10 Oct 2015 20:32:01 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd4-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 1.501
X-Spam-Level: *
X-Spam-Status: No, score=1.501 tagged_above=-999 required=6.31
	tests=[KAM_STOCKGEN=1.5, URIBL_BLOCKED=0.001] autolearn=disabled
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd4-us-west.apache.org [10.40.0.11]) (amavisd-new, port 10024)
	with ESMTP id k-q8AdObqYcj for <dev@httpd.apache.org>;
	Sat, 10 Oct 2015 20:31:53 +0000 (UTC)
Received: from node176.itex.at (mail.123x.at [194.242.35.176])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id 8326E42F38
	for <dev@httpd.apache.org>; Sat, 10 Oct 2015 20:31:53 +0000 (UTC)
Received: from localhost (localhost [127.0.0.1])
	by node176.itex.at (Postfix) with ESMTP id BDDCF22A9E
	for <dev@httpd.apache.org>; Sat, 10 Oct 2015 22:31:51 +0200 (CEST)
X-Virus-Scanned: Debian amavisd-new at node176.itex.at
Received: from node176.itex.at ([127.0.0.1])
	by localhost (node176.itex.at [127.0.0.1]) (amavisd-new, port 10024)
	with ESMTP id gi0Gt69SwG4l for <dev@httpd.apache.org>;
	Sat, 10 Oct 2015 22:31:51 +0200 (CEST)
Received: from [10.0.0.1] (CPE-58-167-62-226.lns10.ken.bigpond.net.au [58.167.62.226])
	(Authenticated sender: normw@gknw.net)
	by node176.itex.at (Postfix) with ESMTPSA id 5919B21318
	for <dev@httpd.apache.org>; Sat, 10 Oct 2015 22:31:49 +0200 (CEST)
Subject: Re: A small wrinkle in latest r1707735 update to
 httpd-trunk\modules\http2\h2_util.c
To: dev@httpd.apache.org
References: <5618F716.30908@gknw.net>
 <432220E7-4319-40D7-AB6F-206CE59D7CA2@greenbytes.de>
From: NormW <normw@gknw.net>
Message-ID: <561975AC.5070405@gknw.net>
Date: Sun, 11 Oct 2015 07:31:40 +1100
User-Agent: Mozilla/5.0 (Windows NT 5.1; rv:38.0) Gecko/20100101
 Thunderbird/38.3.0
MIME-Version: 1.0
In-Reply-To: <432220E7-4319-40D7-AB6F-206CE59D7CA2@greenbytes.de>
Content-Type: text/plain; charset=windows-1252; format=flowed
Content-Transfer-Encoding: 7bit

On 11/10/2015 4:45 AM, Stefan Eissing wrote:
> Ok, will add that. This is only in trunk. 2.4.x should compile for you.
Correct.
Norm.
>
>> Am 10.10.2015 um 13:31 schrieb NormW <normw@gknw.net>:
>>
>> Hmmmm,
>>> CC   h2_worker.c
>>> CC   h2_workers.c
>>> CC   mod_http2.c
>>> GEN  obj_release/mod_http2_link.opt
>>> LINK obj_release/mod_http2.nlm
>>> ### mwldnlm Linker Error:
>>> #   Undefined symbol: APR_BUCKET_IS_MMAP in
>>> #   h2_util.o
>>
>> In apr-util\include\apr_buckets.h:
>>> #if APR_HAS_MMAP
>>> /**
>>> * Determine if a bucket is a MMAP bucket
>>> * @param e The bucket to inspect
>>> * @return true or false
>>> */
>>> #define APR_BUCKET_IS_MMAP(e)        ((e)->type == &apr_bucket_type_mmap)
>>> #endif
>>
>> :-( MMAP is (sadly) not a feature of NetWare. If the http2 experts assert the entire http2 module is a dud without MMAP support, I am not in a position or mind to oppose dropping NetWare 'support' for http2 entirely.
>>
>> Alternatively, something like this in h2_util.c MAY be good enough :
>>>                 }
>>> ++ #if APR_HAS_MMAP
>>>                 else if (APR_BUCKET_IS_MMAP(b)) {
>>>                     btype = "mmap";
>>>                 }
>>> ++ #endif
>>
>> Norm
>


From dev-return-84207-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Sun Oct 11 01:21:07 2015
Return-Path: <dev-return-84207-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 5BDD718118
	for <apmail-httpd-dev-archive@www.apache.org>; Sun, 11 Oct 2015 01:21:07 +0000 (UTC)
Received: (qmail 18013 invoked by uid 500); 11 Oct 2015 01:21:06 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 17932 invoked by uid 500); 11 Oct 2015 01:21:06 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 17922 invoked by uid 99); 11 Oct 2015 01:21:06 -0000
Received: from Unknown (HELO spamd1-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 11 Oct 2015 01:21:06 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd1-us-west.apache.org (ASF Mail Server at spamd1-us-west.apache.org) with ESMTP id 24C0DC217A
	for <dev@httpd.apache.org>; Sun, 11 Oct 2015 01:21:06 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd1-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.011
X-Spam-Level:
X-Spam-Status: No, score=-0.011 tagged_above=-999 required=6.31
	tests=[SPF_PASS=-0.001, T_RP_MATCHES_RCVD=-0.01] autolearn=disabled
Received: from mx1-us-west.apache.org ([10.40.0.8])
	by localhost (spamd1-us-west.apache.org [10.40.0.7]) (amavisd-new, port 10024)
	with ESMTP id F21V1knWc-Qv for <dev@httpd.apache.org>;
	Sun, 11 Oct 2015 01:21:04 +0000 (UTC)
Received: from mailserver.kippdata.de (capsella.kippdata.de [195.227.30.149])
	by mx1-us-west.apache.org (ASF Mail Server at mx1-us-west.apache.org) with ESMTP id 54DC8205E9
	for <dev@httpd.apache.org>; Sun, 11 Oct 2015 01:21:03 +0000 (UTC)
Received: from [10.0.110.6] ([192.168.2.104])
	by mailserver.kippdata.de (8.13.5/8.13.5) with ESMTP id t9B1KuBM012395
	for <dev@httpd.apache.org>; Sun, 11 Oct 2015 03:20:56 +0200 (CEST)
Subject: Re: this expected?
To: dev@httpd.apache.org
References: <5D0C3260-FB28-4E03-BA5D-FC13CCA933D6@greenbytes.de>
From: Rainer Jung <rainer.jung@kippdata.de>
Message-ID: <5619B974.2040802@kippdata.de>
Date: Sun, 11 Oct 2015 03:20:52 +0200
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:38.0) Gecko/20100101
 Thunderbird/38.3.0
MIME-Version: 1.0
In-Reply-To: <5D0C3260-FB28-4E03-BA5D-FC13CCA933D6@greenbytes.de>
Content-Type: text/plain; charset=utf-8; format=flowed
Content-Transfer-Encoding: 7bit

Am 10.10.2015 um 20:14 schrieb Stefan Eissing:
> Testing 2.4.17 release tar ball on OS X 10.11 (event/worker/prefork, openssl 1.0.2d):
>
> t/ssl/varlookup.t ................... 1/81 # Failed test 55 in t/ssl/varlookup.t at line 105 fail #55
> # Failed test 56 in t/ssl/varlookup.t at line 105 fail #56
> # Failed test 57 in t/ssl/varlookup.t at line 105 fail #57
> # Failed test 58 in t/ssl/varlookup.t at line 105 fail #58
> # Failed test 75 in t/ssl/varlookup.t at line 105 fail #75
> # Failed test 76 in t/ssl/varlookup.t at line 105 fail #76
> t/ssl/varlookup.t ................... Failed 6/81 subtests
> t/ssl/verify.t ...................... ok

Not really. What output do you get for

t/TEST -v t/ssl/varlookup.t

I get:

...
# testing : SSL_CLIENT_SAN_Email_0
# expected: 'test-dev@httpd.apache.org'
# received: 'test-dev@httpd.apache.org'
ok 55
# testing : SSL_SERVER_SAN_DNS_0
# expected: 'localhost'
# received: 'localhost'
ok 56
# testing : SSL_CLIENT_SAN_OTHER_msUPN_0
# expected: 'test-dev@httpd.apache.org'
# received: 'test-dev@httpd.apache.org'
ok 57
# testing : SSL_SERVER_SAN_OTHER_dnsSRV_0
# expected: '_https.localhost'
# received: '_https.localhost'
ok 58
...
# testing : SSL_CLIENT_A_SIG
# expected: 'sha256WithRSAEncryption'
# received: 'sha256WithRSAEncryption'
ok 75
# testing : SSL_SERVER_A_SIG
# expected: 'sha256WithRSAEncryption'
# received: 'sha256WithRSAEncryption'
ok 76

I'm using OpenSSL 1.0.2 in client and server.

Regards,

Rainer

From dev-return-84208-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Sun Oct 11 02:26:43 2015
Return-Path: <dev-return-84208-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 05DE2181A0
	for <apmail-httpd-dev-archive@www.apache.org>; Sun, 11 Oct 2015 02:26:43 +0000 (UTC)
Received: (qmail 65843 invoked by uid 500); 11 Oct 2015 02:26:42 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 65765 invoked by uid 500); 11 Oct 2015 02:26:42 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 65755 invoked by uid 99); 11 Oct 2015 02:26:42 -0000
Received: from Unknown (HELO spamd2-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 11 Oct 2015 02:26:42 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd2-us-west.apache.org (ASF Mail Server at spamd2-us-west.apache.org) with ESMTP id 25AB71A08AD
	for <dev@httpd.apache.org>; Sun, 11 Oct 2015 02:26:42 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd2-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.01
X-Spam-Level:
X-Spam-Status: No, score=-0.01 tagged_above=-999 required=6.31
	tests=[SPF_PASS=-0.001, T_RP_MATCHES_RCVD=-0.01,
	UNPARSEABLE_RELAY=0.001] autolearn=disabled
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd2-us-west.apache.org [10.40.0.9]) (amavisd-new, port 10024)
	with ESMTP id kLCeuxSDtNVr for <dev@httpd.apache.org>;
	Sun, 11 Oct 2015 02:26:40 +0000 (UTC)
Received: from mail.ausics.net (valhalla.ausics.net [27.33.160.23])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id 0FD8C204D9
	for <dev@httpd.apache.org>; Sun, 11 Oct 2015 02:26:38 +0000 (UTC)
Received: from mail.ausics.net (valhalla.ausics.net [10.10.0.10])
	(using TLSv1 with cipher DHE-RSA-AES256-SHA (256/256 bits))
	(No client certificate requested)
	by mail.ausics.net (Postfix) with ESMTPSA id 388C0C0E029
	for <dev@httpd.apache.org>; Sun, 11 Oct 2015 12:26:28 +1000 (AEST)
Received: from sPqFdD5VsGPCKRws/md/2itqIS9xW6j/ZsrV/aT1yPw=
 (aT4bk38oxoeUIU9rYCA4p9m3Cpmfi0v7)
 by mail.ausics.net
 with HTTP (HTTP/1.1 POST); Sun, 11 Oct 2015 12:26:27 +1000
MIME-Version: 1.0
Content-Type: text/plain; charset=US-ASCII;
 format=flowed
Content-Transfer-Encoding: 7bit
Date: Sun, 11 Oct 2015 12:26:27 +1000
From: Noel Butler <noel.butler@ausics.net>
To: dev@httpd.apache.org
Subject: Re: [VOTE] Release Apache httpd 2.4.17 as GA
In-Reply-To: <C45BAF78-8A10-4751-B1CA-62BB499FD795@jaguNET.com>
References: <C45BAF78-8A10-4751-B1CA-62BB499FD795@jaguNET.com>
Message-ID: <ad83cac9d82509903a3bffaa083c9624@ausics.net>
X-Sender: noel.butler@ausics.net
User-Agent: Roundcube Webmail

On 10/10/2015 03:40, Jim Jagielski wrote:
> The pre-release test tarballs for Apache httpd 2.4.17 can be found
> at the usual place:
> 
> 	http://httpd.apache.org/dev/dist/
> 
> I'm calling a VOTE on releasing these as Apache httpd 2.4.17 GA.
> 
> [X] +1: Good to go
> [ ] +0: meh
> [ ] -1: Danger Will Robinson. And why.
> 
> Vote will last the normal 72 hrs.
> 
> NOTE: The *-deps are only there for convenience.
> 


built with mysql, apr-1.5.2 and apr-util 1.5.4
all good   slackware 13.1/13.37/14.0/14.1

From dev-return-84209-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Sun Oct 11 05:40:06 2015
Return-Path: <dev-return-84209-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 80C6418367
	for <apmail-httpd-dev-archive@www.apache.org>; Sun, 11 Oct 2015 05:40:06 +0000 (UTC)
Received: (qmail 59737 invoked by uid 500); 11 Oct 2015 05:40:06 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 59668 invoked by uid 500); 11 Oct 2015 05:40:05 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 59658 invoked by uid 99); 11 Oct 2015 05:40:05 -0000
Received: from Unknown (HELO spamd1-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 11 Oct 2015 05:40:05 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd1-us-west.apache.org (ASF Mail Server at spamd1-us-west.apache.org) with ESMTP id 82CEAC2167
	for <dev@httpd.apache.org>; Sun, 11 Oct 2015 05:40:05 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd1-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.11
X-Spam-Level:
X-Spam-Status: No, score=-0.11 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	T_RP_MATCHES_RCVD=-0.01] autolearn=disabled
Authentication-Results: spamd1-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=velox.ch header.b=AWbOKw25;
	dkim=pass (2048-bit key) header.d=velox.ch header.b=GOt5iEu/
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd1-us-west.apache.org [10.40.0.7]) (amavisd-new, port 10024)
	with ESMTP id bbFBZxz8WJFh for <dev@httpd.apache.org>;
	Sun, 11 Oct 2015 05:40:01 +0000 (UTC)
Received: from fornix.velox.ch (fornix.velox.ch [85.25.46.13])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id E80C420C18
	for <dev@httpd.apache.org>; Sun, 11 Oct 2015 05:40:00 +0000 (UTC)
Received: from cortex.velox.ch (77-57-164-164.dclient.hispeed.ch [77.57.164.164])
	(authenticated bits=0)
	by fornix.velox.ch (8.14.9/8.14.9/2.2) with ESMTP id t9B5dohs014595
	(version=TLSv1/SSLv3 cipher=DHE-RSA-AES256-GCM-SHA384 bits=256 verify=OK)
	for <dev@httpd.apache.org>; Sun, 11 Oct 2015 07:39:53 +0200
DKIM-Signature: v=1; a=rsa-sha256; c=simple/simple; d=velox.ch;
	s=fornix-727e; t=1444541993;
	bh=QG2Qb5iDhnl1FqkGdzntM3aYpBB3nBbOq3sP9N1+LSg=;
	h=From:Subject:To:References:Date:In-Reply-To;
	b=AWbOKw25ZrLl1bZdjL8OTwy5eqsO5YpT56+EhNtve1YCH/L2YXkZJVIAUh7oITe17
	 35iQB7OazE33Gah9lCpSqULcXarWn0TLeotRDkWFxlfF3i+lNyIZDiiqO+elQzQfKe
	 mLN//2R5VL9puejbGvNeMfrlODfgD0B+PT892UqFxP2Rt1u7jx5REJNVi4vY62kXuQ
	 7Keic4qcRWmhbQRkmdk0dlhFeCXsnUhfaJfM4rWUrF2xtO4xPuXgtzPD4bFGzT6fo3
	 1cFBfr1tNx3W6NSUiywVF5hkoqQvHXwGyV8on60l/Et9ZnTpgs5bWrJP83IVfkOIc1
	 hBmSdR1Nwys8A==
From: Kaspar Brand <httpd-dev.2014@velox.ch>
DKIM-Signature: v=1; a=rsa-sha256; c=simple/simple; d=velox.ch;
	s=cortex-8a58; t=1444541989;
	bh=QG2Qb5iDhnl1FqkGdzntM3aYpBB3nBbOq3sP9N1+LSg=;
	h=From:Subject:To:References:Date:In-Reply-To;
	b=GOt5iEu/daKD1BnZUca3xToipHGRIDFR2N/hdvFxN4wj9XqW8ABReFnMJ49hV3HW1
	 oM+zn9M16BuaeOCDJgQDqvisf5avHp8SHdfVOO9u+pi88s9SoSwkzxyfRJ53d2mAJE
	 yn0njKtyVvXXplXO3nmgQZKN6XbFSQgXuUXy0BnGXynHFe2TOim6w5SRxAzIGr/Uw7
	 YBcn7MgOFt4JQ+7YpjNCLxeprhGoIahQ/szbM+pelYP/HmmLbsqAYiAmMVu7OaJnGz
	 M7pLx/5zJOXyxx/VXn7KQD7/ujlNsDbIoQdB7LFW7plQADTPlPk5kbYayJoq0gpfKk
	 k47Y+F1oUYEVw==
Subject: Re: [VOTE] Release Apache httpd 2.4.17 as GA
To: dev@httpd.apache.org
References: <C45BAF78-8A10-4751-B1CA-62BB499FD795@jaguNET.com>
Message-ID: <5619F629.20105@velox.ch>
Date: Sun, 11 Oct 2015 07:39:53 +0200
MIME-Version: 1.0
In-Reply-To: <C45BAF78-8A10-4751-B1CA-62BB499FD795@jaguNET.com>
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit

On 09.10.2015 19:40, Jim Jagielski wrote:
> The pre-release test tarballs for Apache httpd 2.4.17 can be found
> at the usual place:
> 
> 	http://httpd.apache.org/dev/dist/
> 
> I'm calling a VOTE on releasing these as Apache httpd 2.4.17 GA.
> 
> [X] +1: Good to go

Tested with mod_ssl compiled against OpenSSL 0.9.8/1.0.0/1.0.1/1.0.2.

Kaspar

From dev-return-84210-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Sun Oct 11 05:45:37 2015
Return-Path: <dev-return-84210-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 00C7218376
	for <apmail-httpd-dev-archive@www.apache.org>; Sun, 11 Oct 2015 05:45:37 +0000 (UTC)
Received: (qmail 62659 invoked by uid 500); 11 Oct 2015 05:45:36 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 62584 invoked by uid 500); 11 Oct 2015 05:45:36 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 62574 invoked by uid 99); 11 Oct 2015 05:45:36 -0000
Received: from Unknown (HELO spamd1-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 11 Oct 2015 05:45:36 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd1-us-west.apache.org (ASF Mail Server at spamd1-us-west.apache.org) with ESMTP id 0ABBEC1E9D
	for <dev@httpd.apache.org>; Sun, 11 Oct 2015 05:45:36 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd1-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.109
X-Spam-Level:
X-Spam-Status: No, score=-0.109 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	T_RP_MATCHES_RCVD=-0.01, URIBL_BLOCKED=0.001] autolearn=disabled
Authentication-Results: spamd1-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=velox.ch header.b=3LN0ToXV;
	dkim=pass (2048-bit key) header.d=velox.ch header.b=klq1+31y
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd1-us-west.apache.org [10.40.0.7]) (amavisd-new, port 10024)
	with ESMTP id VKr7n61N1MpP for <dev@httpd.apache.org>;
	Sun, 11 Oct 2015 05:45:26 +0000 (UTC)
Received: from fornix.velox.ch (fornix.velox.ch [85.25.46.13])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id EB43020C18
	for <dev@httpd.apache.org>; Sun, 11 Oct 2015 05:45:25 +0000 (UTC)
Received: from cortex.velox.ch (77-57-164-164.dclient.hispeed.ch [77.57.164.164])
	(authenticated bits=0)
	by fornix.velox.ch (8.14.9/8.14.9/2.2) with ESMTP id t9B5jP3K014631
	(version=TLSv1/SSLv3 cipher=DHE-RSA-AES256-GCM-SHA384 bits=256 verify=OK)
	for <dev@httpd.apache.org>; Sun, 11 Oct 2015 07:45:25 +0200
DKIM-Signature: v=1; a=rsa-sha256; c=simple/simple; d=velox.ch;
	s=fornix-727e; t=1444542325;
	bh=e6qH5f+aarw1KqCOfQYf7MmsM3zIc15gZa3pLCnZsQ8=;
	h=Subject:To:References:From:Date:In-Reply-To;
	b=3LN0ToXVhaEU3CiWSf9Vdj0S4O0XuDCEsVh+mYRNYKRYu6tIPVe32r6bgnXNLBSGj
	 6e4hlX9+XmBhyesvR3zpmjsyygdf3B6TscZFjgMmEotj6c5CsC3sKbh4u/oFoTnnvI
	 BtBc75K+PPhTRIHtvJV/20NrVuHV/E4vyeJrMPGo3+4WUNVY+Y51vTJRpjrV+i3eF2
	 FQ38GjnXEit3vjlup9SbSnIsQsExy9ILuv2mwkGDGXd2hLK7qhtesO01jQGz3dnYRY
	 9sx/inFZYP0uN4ZhObVV6K9cOBiOOlMhmGhTThx3vHRu2K3CPT1QepHrYI85vtyN/G
	 zLeDi0RP83f4Q==
Subject: Re: this expected?
DKIM-Signature: v=1; a=rsa-sha256; c=simple/simple; d=velox.ch;
	s=cortex-8a58; t=1444542324;
	bh=e6qH5f+aarw1KqCOfQYf7MmsM3zIc15gZa3pLCnZsQ8=;
	h=Subject:To:References:From:Date:In-Reply-To;
	b=klq1+31yuJQ+RJru64gm/O3gZXIQH+Fp7d4+/uk448Pmhy8+BHk1I2+lORv8+oud/
	 zBIsXTG/tmFsLLTUXOqBqcKpxQCeUbbmoQUskKwi4H4DW+VQvdXRXmrlu7Bau1cHl0
	 jiCdc8OgAYMkilprFq3gqPZelQ3Yv90ZYMwmIUteI9u84WEpU78QAs3hKdzPC6xBAt
	 /uoWfrDecqTEaj+uIh0vpqZwbIRDe1Vb1S0B+UpWXG9Gv1cRv3Kx5Qe+1M+zF/O9/s
	 TORC21IrUcgnJObB6PwHH8bLUcTi50+ZUxVsWOJX+bUmXr6LStRbBQpO4HVBgKWFGr
	 iklkp1kJYljyg==
To: dev@httpd.apache.org
References: <5D0C3260-FB28-4E03-BA5D-FC13CCA933D6@greenbytes.de>
From: Kaspar Brand <httpd-dev.2014@velox.ch>
Message-ID: <5619F778.6070808@velox.ch>
Date: Sun, 11 Oct 2015 07:45:28 +0200
MIME-Version: 1.0
In-Reply-To: <5D0C3260-FB28-4E03-BA5D-FC13CCA933D6@greenbytes.de>
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit

On 10.10.2015 20:14, Stefan Eissing wrote:
> Testing 2.4.17 release tar ball on OS X 10.11 (event/worker/prefork, openssl 1.0.2d):
> 
> t/ssl/varlookup.t ................... 1/81 # Failed test 55 in t/ssl/varlookup.t at line 105 fail #55
> # Failed test 56 in t/ssl/varlookup.t at line 105 fail #56
> # Failed test 57 in t/ssl/varlookup.t at line 105 fail #57
> # Failed test 58 in t/ssl/varlookup.t at line 105 fail #58
> # Failed test 75 in t/ssl/varlookup.t at line 105 fail #75
> # Failed test 76 in t/ssl/varlookup.t at line 105 fail #76
> t/ssl/varlookup.t ................... Failed 6/81 subtests 

Can you quickly confirm that t/conf/ssl/ca/asf/certs/client_ok.crt (or
any other cert in this directory) is older than
Apache-Test/lib/Apache/TestSSLCA.pm in that test framework installation?
If so, the above failures are a consequence of r1705534 and r1705535,
and TEST -clean should help in getting a fresh collection of certs (if
it doesn't remove the t/conf/ssl/ca directory, it can just be rm'ed
manually).

Kaspar

From dev-return-84211-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Sun Oct 11 07:15:16 2015
Return-Path: <dev-return-84211-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 30F261855B
	for <apmail-httpd-dev-archive@www.apache.org>; Sun, 11 Oct 2015 07:15:16 +0000 (UTC)
Received: (qmail 72342 invoked by uid 500); 11 Oct 2015 07:15:15 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 72259 invoked by uid 500); 11 Oct 2015 07:15:15 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 72250 invoked by uid 99); 11 Oct 2015 07:15:15 -0000
Received: from mail-relay.apache.org (HELO mail-relay.apache.org) (140.211.11.15)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 11 Oct 2015 07:15:15 +0000
Received: from asf-bz1-us-mid.priv.apache.org (nat1-us-mid.apache.org [23.253.172.122])
	by mail-relay.apache.org (ASF Mail Server at mail-relay.apache.org) with ESMTPS id 34F6C1A0056
	for <dev@httpd.apache.org>; Sun, 11 Oct 2015 07:15:15 +0000 (UTC)
Received: by asf-bz1-us-mid.priv.apache.org (ASF Mail Server at asf-bz1-us-mid.priv.apache.org, from userid 0)
	id 9E7C2604B2; Sun, 11 Oct 2015 07:15:14 +0000 (UTC)
From: bugzilla@apache.org
To: dev@httpd.apache.org
Subject: Bug report for Apache httpd-2 [2015/10/11]
Message-Id: <20151011071514.9E7C2604B2@asf-bz1-us-mid.priv.apache.org>
Date: Sun, 11 Oct 2015 07:15:05 +0000 (UTC)

+---------------------------------------------------------------------------+
| Bugzilla Bug ID                                                           |
|     +---------------------------------------------------------------------+
|     | Status: UNC=Unconfirmed NEW=New         ASS=Assigned                |
|     |         OPN=Reopened    VER=Verified    (Skipped Closed/Resolved)   |
|     |   +-----------------------------------------------------------------+
|     |   | Severity: BLK=Blocker CRI=Critical  REG=Regression  MAJ=Major   |
|     |   |           MIN=Minor   NOR=Normal    ENH=Enhancement TRV=Trivial |
|     |   |   +-------------------------------------------------------------+
|     |   |   | Date Posted                                                 |
|     |   |   |          +--------------------------------------------------+
|     |   |   |          | Description                                      |
|     |   |   |          |                                                  |
| 7483|Ass|Enh|2002-03-26|Add FileAction directive to assign a cgi interpret|
| 8713|Inf|Min|2002-05-01|No Errorlog on PROPFIND/Depth:Infinity            |
| 8867|Opn|Cri|2002-05-07|exports.c generation fails when using a symlink to|
|10747|New|Maj|2002-07-12|ftp SIZE command and 'smart' ftp servers results i|
|11294|New|Enh|2002-07-30|desired vhost_alias option                        |
|11580|Opn|Enh|2002-08-09|generate Content-Location headers                 |
|12033|Opn|Nor|2002-08-26|Graceful restart immediately result in [warn] long|
|12680|New|Enh|2002-09-16|Digest authentication with integrity protection   |
|13599|Inf|Nor|2002-10-14|autoindex formating broken for multibyte sequences|
|13661|Ass|Enh|2002-10-15|Apache cannot not handle dynamic IP reallocation  |
|14104|Opn|Enh|2002-10-30|not documented: must restart server to load new CR|
|14496|New|Enh|2002-11-13|Cannot upgrade any version on Windows. Must uninst|
|14922|Inf|Enh|2002-11-28|<target> is currently hardcoded to 'apache2'      |
|15719|Inf|Nor|2002-12-30|WebDAV MOVE to destination URI which is content-ne|
|16761|Inf|Nor|2003-02-04|CustomLog with pipe spawns process during config  |
|16802|New|Enh|2003-02-05|Additional AllowOverride directive "Restrict"     |
|16811|Ass|Maj|2003-02-05|mod_autoindex always return webpages in UTF-8.    |
|17107|New|Min|2003-02-16|Windows should not install printenv               |
|17114|New|Enh|2003-02-17|Please add strip and install-strip targets to Make|
|17244|Ass|Nor|2003-02-20|./configure --help gives false information regardi|
|17497|Opn|Nor|2003-02-27|mod_mime_magic generates incorrect response header|
|18325|New|Enh|2003-03-25|PAM support for suEXEC                            |
|18334|Inf|Cri|2003-03-25|Server crashes when authenticating users against L|
|18497|New|Min|2003-03-30|configure --help gives wrong default for sysconfdi|
|19043|New|Min|2003-04-15|Interesting interaction between cern_meta module a|
|19670|New|Enh|2003-05-05|content type header supplied upon PUT is thrown aw|
|20036|Ass|Nor|2003-05-19|Trailing Dots stripped from PATH_INFO environment |
|21253|New|Nor|2003-07-01|Mime magic doesn't continue if type is specifed fo|
|21260|New|Nor|2003-07-02|CacheMaxExpire directive not enforced !           |
|21533|Ass|Cri|2003-07-11|Multiple levels of htacces files can cause mod_aut|
|22138|Inf|Cri|2003-08-05|Webdav is not preccessing special chars right.    |
|22237|New|Enh|2003-08-08|option to disable ServerSignature on index pages  |
|22484|Opn|Maj|2003-08-16|semaphore problem takes httpd down                |
|22686|Opn|Nor|2003-08-25|ab: apr_poll: The timeout specified has expired (7|
|22898|Opn|Nor|2003-09-02|nph scripts with two HTTP header                  |
|23167|Inf|Cri|2003-09-14|--enable-layout never goes to apr apr-util        |
|23181|New|Nor|2003-09-15|Status 304 (Not modified) and chunking leads to an|
|23238|New|Cri|2003-09-18|non-async-signal-safe operations from signal handl|
|23330|New|Enh|2003-09-22|Enhance ApacheMonitor to view and control Tomcat s|
|23911|Opn|Cri|2003-10-18|CGI processes left defunct/zombie under 2.0.54    |
|24031|New|Enh|2003-10-23|Passphrase protected private key in SSLProxyMachin|
|24095|Opn|Cri|2003-10-24|ERROR "Parent: child process exited with status 32|
|24437|Opn|Nor|2003-11-05|mod_auth_ldap doubly-escapes backslash (\) charact|
|24890|Opn|Nor|2003-11-21|Apache config parser should not be local aware ( g|
|25014|New|Enh|2003-11-26|A flexible interface for mod_log_config           |
|25201|New|Enh|2003-12-04|Provide Cache Purge operation                     |
|25240|Inf|Enh|2003-12-05|SSL Library Error: 336105671 logged as information|
|25435|New|Enh|2003-12-11|sethandler and directoryindex not playing nice    |
|25469|Opn|Enh|2003-12-12|create AuthRoot for defining paths to auth files  |
|25484|Ass|Nor|2003-12-12|Non-service Apache cannot be stopped in WinXP     |
|25543|Inf|Nor|2003-12-15|mod_proxy_ajp overwrites existing response headers|
|25667|New|Nor|2003-12-19|Memory leak in function ssl_scache_dbm_retrieve().|
|25863|New|Enh|2004-01-02|new per-host initialization hooks                 |
|26005|New|Nor|2004-01-08|SERVER_NAME incorrect when using IPv6 address in U|
|26142|New|Maj|2004-01-14|EnableSendFile Off for Windows XP Home            |
|26153|Opn|Cri|2004-01-15|Apache cygwin directory traversal vulnerability   |
|26368|New|Min|2004-01-23|File extensions in AddDescription treated as part |
|26446|New|Nor|2004-01-26|flush buckets followed by eos bucket emit multiple|
|26478|New|Enh|2004-01-28|mod_dav does not expose a method for setting the D|
|26835|New|Enh|2004-02-10|[PATCH] Mod_status Readability & Browser Side Tabl|
|27257|Ass|Enh|2004-02-26|rotatelogs with getopt and setuid                 |
|27578|New|Enh|2004-03-10|made getlastmodified a writable property          |
|27715|Ass|Enh|2004-03-16|Client sending misformed Range "bytes = 0-100" ins|
|27791|Inf|Nor|2004-03-18|mod_cache doesn't re-cache expired content        |
|27835|New|Enh|2004-03-22|When proxying FTP, all errors turns into 404      |
|27869|New|Enh|2004-03-23|stopping and starting httpd again immediately caus|
|28854|Inf|Nor|2004-05-09|Build fails with missing library call on Solaris i|
|28903|New|Enh|2004-05-11|Hooks to add environment variables to CGI and othe|
|29090|Ass|Enh|2004-05-19|MultiviewsMatch NegotiatedOnly extensions not resp|
|29165|New|Nor|2004-05-24|Parent directory icon not correct                 |
|29446|New|Enh|2004-06-08|want directive for setting content negotiation qua|
|29449|New|Enh|2004-06-09|Limit length of specified fields in LogFormat     |
|29450|New|Enh|2004-06-09|Improved logging for mod_access                   |
|29510|Ass|Enh|2004-06-10|ab does not support multiple cookies              |
|29644|Ver|Nor|2004-06-17|mod_proxy keeps downloading even after the client |
|29755|Opn|Nor|2004-06-23|mod_usertrack should use err_headers_out          |
|29822|New|Enh|2004-06-26|implement FTP 'PUT' support in proxy_ftp.c        |
|29941|Ass|Enh|2004-07-06|log files are not tested for availability on confi|
|30259|Ass|Enh|2004-07-22|When proxy connects to backend, a DNS lookup is do|
|30505|Ass|Enh|2004-08-05|Apache uses 'Error', and not lower level event typ|
|30730|Inf|Nor|2004-08-18|[PatchAvailable] mod_actions and Server-Status    |
|30865|Inf|Maj|2004-08-26|mod_disk_cache leaves many temporary files slowing|
|31302|Opn|Cri|2004-09-19|suexec doesn't execute commands if they're not in |
|31311|New|Enh|2004-09-20|Remote user not logged in reverse proxy scenario  |
|31352|Ass|Enh|2004-09-21|RFE, Bind to LDAP server with browser supplier use|
|31418|Opn|Nor|2004-09-25|SSLUserName is not usable by other modules        |
|31484|New|Maj|2004-09-30|Custom environment variables not passed to content|
|31490|New|Nor|2004-09-30|mod_proxy_ftp renders filenames with spaces badly |
|31565|New|Enh|2004-10-06|Won't start correctly if parent closed stdin, stdo|
|31679|New|Enh|2004-10-12|If the argument of a CGI has two or more consecuti|
|31709|Inf|Nor|2004-10-13|Raises an error on SSL name based virtualhosts (wi|
|31712|New|Enh|2004-10-14|config_file is NULL at ap_walk_config etc         |
|31952|New|Enh|2004-10-29|mod_proxy and RealPlayer: audio content streaming |
|32051|Opn|Nor|2004-11-04|mod_example is not thread safe                    |
|32328|Opn|Enh|2004-11-19|Make mod_rewrite escaping optional / expose intern|
|32346|New|Enh|2004-11-22|mod_include/include virtual checks content-type is|
|32524|New|Enh|2004-12-03|ab: add an option to specify a source address     |
|32703|Inf|Enh|2004-12-14|Cannot determine that Apache is frozen if /var fil|
|32750|Ass|Maj|2004-12-17|mod_proxy + Win32DisableAcceptEx = memory leak    |
|32877|New|Enh|2004-12-29|wrong utf-8 encoding/escaping in a href for umlaut|
|33084|New|Enh|2005-01-13|Optional certificate validity period check on SSLV|
|33089|New|Nor|2005-01-13|mod_include: Options +Includes (or IncludesNoExec)|
|33207|New|Nor|2005-01-23|Results of my suexec.c code audit                 |
|33215|New|Nor|2005-01-24|Cygwin build/install.sh fix (OSTYPE => ext=.exe)  |
|33512|Inf|Maj|2005-02-11|mod_mem_cache and possibly mod_deflate            |
|33627|New|Nor|2005-02-18|Bite-sized changes making progress towards compila|
|33685|New|Maj|2005-02-22|Unable to install in the path containing non engli|
|34270|Inf|Nor|2005-04-01|Large POSTs over SSL from Internet Explorer do not|
|34375|New|Enh|2005-04-08|enhancements for mod_include                      |
|34377|New|Enh|2005-04-08|Allow the overriding of 401 Unauthorized returns f|
|34405|New|Enh|2005-04-11|adds DOCUMENT_NAME_WITHOUT_SUFFIX to mod_include  |
|34508|New|Nor|2005-04-19|Randomly slow graceful restart, not accepting new |
|34519|New|Enh|2005-04-19|Directory index should emit valid XHTML           |
|35049|New|Nor|2005-05-24|let AddDefaultCharset apply to text/css and applic|
|35077|New|Nor|2005-05-26|mod_dav passes incorrect paths with LocationMatch |
|35083|Inf|Enh|2005-05-26|Certificate validation problems trapping          |
|35098|Ver|Maj|2005-05-27|Install fails using --prefix                      |
|35154|New|Nor|2005-06-01|Support for NID_serialNumber, etc. in SSLUserName |
|35245|New|Nor|2005-06-06|cache ignores max-age cache-directive in requests |
|35250|New|Enh|2005-06-07|[PatchAvailable] add logging to mod_proxy_connect |
|35280|New|Nor|2005-06-09|FTP proxy breaks RFC 2428 when trying to fall back|
|35556|Inf|Nor|2005-06-30|CRL files not re-read by HUP                      |
|35652|Opn|Min|2005-07-07|Improve error message: "pcfg_openfile: unable to c|
|35702|New|Nor|2005-07-12|Using with https URL, ab freezes or gets SIGSEGV o|
|35781|New|Nor|2005-07-18|ap_sub_req_method_uri() bypasses Limit security co|
|35981|Inf|Maj|2005-08-02|mod_dav overrides dav_fs response on PUT failure  |
|36286|New|Enh|2005-08-20|configtest doesn't check SSL certificates         |
|36492|New|Nor|2005-09-04|split-logfile script dies when splitting log of ma|
|36495|Inf|Nor|2005-09-05|mod_proxy_ajp: ajp_check_msg_header() got bad sign|
|36564|New|Enh|2005-09-08|make mod_ldap really universal                    |
|36636|New|Maj|2005-09-13|database write lock taken for PROPFIND operations |
|36676|New|Nor|2005-09-15|time() bug in httpd/os/win32/util_win32.c:wait_for|
|36710|Opn|Blk|2005-09-19|CGI output not captured                           |
|36724|New|Nor|2005-09-20|Don't install Apache Monitor by default           |
|37110|New|Nor|2005-10-17|Build fails when source tree is read-only         |
|37196|Inf|Min|2005-10-21|Wrong "Parent directory" link                     |
|37201|New|Enh|2005-10-21|Add <IfInterface IP> syntax to apache configuratio|
|37290|Opn|Min|2005-10-28|DirectoryIndex don't work in scriptaliased directo|
|37307|New|Enh|2005-10-31|Can't suppress error messages                     |
|37355|New|Enh|2005-11-04|Allow to specify Proxy-Authorization in ProxyRemot|
|37360|New|Maj|2005-11-04|Install fails on Windows XP x64 when program files|
|37402|New|Nor|2005-11-08|mod_proxy has stopped allowing POST sub-requests  |
|37514|Inf|Nor|2005-11-15|mod_proxy buffers chunked data.                   |
|37564|New|Enh|2005-11-19|Suggestion: mod_suexec SuexecUserGroup directive i|
|37587|Inf|Min|2005-11-22|mod_status Total Traffic value goes up then down? |
|37823|Inf|Nor|2005-12-07|The openssl library linked is different between ht|
|37920|New|Maj|2005-12-15|mod_proxy does not flush data on POST requests fro|
|38116|New|Enh|2006-01-04|Chroot-Patch for SuExec                           |
|38164|New|Nor|2006-01-06|wrong status code for failed COPY/MOVE            |
|38182|New|Nor|2006-01-08|COPY ignores authority in Destination header      |
|38218|New|Enh|2006-01-10|Multiline Comments for *.conf files               |
|38240|Inf|Nor|2006-01-12|apache restart segfault with mutliple Include dire|
|38325|Opn|Nor|2006-01-20|impossible to determine AUTH_TYPE of interpreted r|
|38355|Unc|Enh|2006-01-23|DSO support for mod_rewrite                       |
|38369|New|Enh|2006-01-24|mod_proxy keeps alive connections that should be b|
|38408|New|Nor|2006-01-27|SSI environment vars not set in spawned processes |
|38419|New|Nor|2006-01-27|Problems with large WebDAV properties             |
|38478|New|Maj|2006-02-01|A client starting a SSL renegotiation can crash th|
|38515|New|Enh|2006-02-05|Dynamic LDAP Group Support                        |
|38550|New|Enh|2006-02-07|Setting headers based on proxied data             |
|38571|New|Enh|2006-02-08|CustomLog directive checked by apachectl configtes|
|38756|Inf|Nor|2006-02-22|errors with running make                          |
|38786|New|Nor|2006-02-26|"IndexOption VersionSort" has problems with traili|
|38827|New|Reg|2006-03-02|mod_disk_cache trying to rename locked tempfile on|
|38864|Inf|Enh|2006-03-06|ProxyPassReverse fails in <Location>              |
|38903|New|Maj|2006-03-09|r->allowed does not affect Allow response header  |
|38923|New|Min|2006-03-10|mod_speling incorrectly escapes linked URLs       |
|38928|New|Min|2006-03-11|propose removing "VARIANTS" feature               |
|38995|New|Nor|2006-03-16|httpd tries to communicate with the CGI daemon eve|
|39111|New|Nor|2006-03-27|Potential bug brought by mmapfile (mod_file_cache)|
|39128|Inf|Maj|2006-03-28|Apache 2.2 will not compile mod_ssl library's corr|
|39185|Inf|Nor|2006-04-03|Approximately in 1-2 weeks of work the server hang|
|39216|New|Maj|2006-04-05|mod_disk_cache trying to rename locked file, decre|
|39238|New|Nor|2006-04-07|mod_auth_dbm requires mod_auth or "no groups file?|
|39275|Opn|Nor|2006-04-11|slow child_init causes MaxClients warning         |
|39287|New|Nor|2006-04-12|Incorrect If-Modified-Since validation (due to syn|
|39299|New|Nor|2006-04-13|Internal Server Error (500) on COPY               |
|39329|Inf|Nor|2006-04-17|mod_dbd reconnection and prepared statements      |
|39370|New|Nor|2006-04-20|SSL session will be removed if the client is sendi|
|39380|Inf|Nor|2006-04-21|mod_disk_cache eats memory, has no LFS support, et|
|39418|New|Nor|2006-04-26|CacheMaxExpire directive not enforced             |
|39448|New|Min|2006-04-29|old-style <directory proxy:*> doesn't give any war|
|39498|New|Nor|2006-05-06|accept_filter in apr assumes if found in sys/socke|
|39517|New|Nor|2006-05-08|Corrupt chunked transfer-encoding with Content Neg|
|39658|Opn|Nor|2006-05-25|mod_proxy_ajp SSL Key Size Bug                    |
|39673|New|Nor|2006-05-29|mod_proxy opens connections that disturb NTLM     |
|39692|New|Nor|2006-05-31|mod_proxy_balancer doesn't retry a failed request |
|39723|Inf|Enh|2006-06-05|Forward proxy does not work in tranparent mode    |
|39727|Ass|Nor|2006-06-05|Incorrect ETag on gzip:ed content                 |
|39730|New|Nor|2006-06-06|LanguagePriority and DefaultLanguage are Case Sens|
|39737|New|Nor|2006-06-06|LogFormat "%{tid}P" reports wrong thread id on Win|
|39748|New|Enh|2006-06-07|Header and POST support for mod_include           |
|39753|New|Nor|2006-06-07|incorrect source for LOCALE Decimal Symbol in Win2|
|39785|Inf|Nor|2006-06-12|Status code 408 (Request Timeout) is not logged   |
|39807|Opn|Enh|2006-06-13|large files / filesystem corruption can cause apac|
|39902|New|Nor|2006-06-27|HeaderName directive breaks mod_filter somehow    |
|39904|New|Nor|2006-06-27|graceful restart error and cpu load               |
|39913|Ass|Blk|2006-06-27|detection of static OpenSSL libraries requiring li|
|39916|New|Nor|2006-06-28|Core Filters & non-blocking Sendfile              |
|39923|New|Nor|2006-06-28|AddDescription doesn't work in server config with |
|39928|New|Nor|2006-06-28|port no detected when file name not in URL        |
|39935|New|Nor|2006-06-29|AddDescription does not do literal comparisons on |
|39973|Ass|Enh|2006-07-06|apache software folder should be movable          |
|40035|New|Cri|2006-07-13|Windows Server 2003 "("R2")" 64-Bit Edition no cgi|
|40060|New|Nor|2006-07-17|AuthGroupFile should accept /etc/group syntax     |
|40075|New|Enh|2006-07-19|unable to use ldap groups that contain DNs and use|
|40102|Opn|Nor|2006-07-24|SCRIPT_NAME set incorrectly with mod_rewrite      |
|40146|New|Nor|2006-07-31|mod_ssl info in server_info is blank              |
|40174|New|Min|2006-08-03|Unable to get IndexOptionis ScanHTMLTitles to work|
|40180|Inf|Maj|2006-08-03|Mod_dav and remove folder doesn't work with Micros|
|40190|New|Nor|2006-08-05|translate file                                    |
|40196|New|Nor|2006-08-06|EILSEQ handling, NoImplicitAdd should work, and so|
|40217|Opn|Nor|2006-08-08|mod_dav PROPFIND ignores access restrictions on it|
|40266|Inf|Blk|2006-08-16|berkeley db support in httpd is screwed           |
|40312|New|Nor|2006-08-24|ssl_engine_init.c, ssl_init_ctx_verify contains a |
|40373|New|Nor|2006-08-31|mod_dir adds trailing slash after internal redirec|
|40408|New|Blk|2006-09-04|Apache 2.2.3 is not starting                      |
|40416|New|Maj|2006-09-05|mod_proxy_ftp cannot connect under http load in fo|
|40441|New|Enh|2006-09-08|intelligently handling dynamic subdomains         |
|40453|New|Nor|2006-09-09|lexicographic compare in RewriteCond isn't lexicog|
|40463|New|Nor|2006-09-11|piped logging causes some weird kill()ing         |
|40513|Opn|Maj|2006-09-14|Seeding PRNG with 0 bytes of entropy              |
|40514|New|Nor|2006-09-14|would like GracefulShutdownTimeout to work for gra|
|40540|Inf|Nor|2006-09-19|Bad interaction between MultiViews and SetOutputFi|
|40541|New|Nor|2006-09-19|Action rewrites URI used by Location?             |
|40571|New|Nor|2006-09-21|mod_proxy_ajp don't works with mod_usertrack      |
|40586|New|Enh|2006-09-22|Add option to supress default '-' output          |
|40746|New|Enh|2006-10-12|Feature request: ProxyAllow directive             |
|40749|New|Min|2006-10-12|magic file with string and "%n" causes Apache chil|
|40781|New|Nor|2006-10-17|PATH_TRANSLATED: 'redirect:/~jablko/gallery2/main.|
|40808|New|Enh|2006-10-23|ProxyRemote with optional proxy authentication    |
|40859|New|Enh|2006-11-01|[PATCH] Support -F force option to 'ab' support to|
|40917|New|Nor|2006-11-07|configure does not detect OpenSSL shared lib on HP|
|40953|New|Min|2006-11-12|Should not send any data in 1xx/204/304 reply from|
|40984|Inf|Enh|2006-11-16|AddIcon, AddIconByType for OpenDocument format    |
|40987|Opn|Enh|2006-11-16|ProxyVia Block doesn't remove Via: header for reve|
|41000|New|Nor|2006-11-19|mod_authn_dbd have an error, in function 'authn_db|
|41025|New|Nor|2006-11-23|ROBOTS META-Tag directive needed in mod_autoindex |
|41088|New|Nor|2006-11-30|installation backcolor is wrong (white)           |
|41111|New|Enh|2006-12-05|New option for filters: run only if there are spar|
|41114|New|Blk|2006-12-06|ACL HTTP method is rejected by mod_proxy_ajp      |
|41130|New|Nor|2006-12-07|mod_mime and mod_negotiation type-map both clobber|
|41143|Opn|Nor|2006-12-10|Incorrect ap_getline assumption in mod_proxy_http |
|41195|New|Nor|2006-12-17|properly set the parent pid on shutdown           |
|41196|New|Nor|2006-12-17|worker mpm usage of apr's memory pools is not thre|
|41200|Inf|Maj|2006-12-18|SSI include, prevent client from receiving full ou|
|41240|Inf|Enh|2006-12-25|BRF files support                                 |
|41262|Inf|Nor|2006-12-29|Embedded pcre causes runtime segfault             |
|41362|Inf|Maj|2007-01-14|mod_disk_cache and mod_include conflict generating|
|41375|Inf|Min|2007-01-15|Using same SSL Certificate with different ServerNa|
|41391|New|Min|2007-01-17|too long period setting makes max-age overflow    |
|41412|New|Enh|2007-01-19|RewriteRule Skip should take negative arguments   |
|41435|New|Nor|2007-01-22|Authentication fails with 500 Server Error        |
|41450|Inf|Cri|2007-01-24|Empty page (200 OK) while max-age is empty        |
|41485|New|Nor|2007-01-28|LDAP client certificates not usable in 2.2.x/trunk|
|41529|New|Enh|2007-02-02|Accept BOM in .htaccess                           |
|41556|New|Enh|2007-02-07|Feature Request: format string for masking ip addr|
|41621|New|Maj|2007-02-15|Apache 2.2.4 backend problem with Apache 2.0.59 Re|
|41646|New|Nor|2007-02-16|wrong headers are sent for HEAD requests when Prox|
|41676|Opn|Enh|2007-02-22|Refactor mod_proxy_ftp                            |
|41685|New|Enh|2007-02-22|Implement optional HTTP Authentication in a standa|
|41712|Inf|Nor|2007-02-26|threads locked at logging state                   |
|41729|New|Maj|2007-02-28|error message: ap_get_scoreboard_lb(130) failed in|
|41744|Inf|Maj|2007-03-01|SSI resolves includes but removes original HTML   |
|41763|Opn|Nor|2007-03-05|mod_disk_cache ignores CacheDirLevels and CacheDir|
|41764|New|Nor|2007-03-05|error state and conf                              |
|41771|Inf|Nor|2007-03-06|Erro with mod_proxy_ajp or mod_prox_balancer      |
|41867|New|Nor|2007-03-16|<DirectoryMatch> Matches Files                    |
|41925|New|Nor|2007-03-21|trivial patch to add automatic crypting to 'dbmman|
|41929|New|Nor|2007-03-22|ISAPI ssl variables                               |
|41953|New|Nor|2007-03-26|pidfile remains when 2nd pass of post-config retur|
|41962|New|Min|2007-03-27|Need mod_auth_ldap to authenticate with Active Dir|
|42001|New|Cri|2007-03-30|LINUX : Could not set LDAP_OPT_X_TLS to LDAP_OPT_X|
|42027|Inf|Nor|2007-04-02|FileETag directive appears to be ignored          |
|42054|New|Nor|2007-04-04|service name and parameter issues                 |
|42079|New|Nor|2007-04-10|SSLRequire: Additional access in sub-directoies   |
|42082|New|Nor|2007-04-10|filter_init is called multiple times after an INCL|
|42182|Inf|Nor|2007-04-22|Mime types for cached proxied content             |
|42216|New|Enh|2007-04-24|RFE -- external overload procedure                |
|42262|Inf|Nor|2007-04-26|mod_dav /  worker fails to allocate memory and seg|
|42287|Inf|Nor|2007-04-28|chunked encoded response to POST request to cgi sc|
|42368|Inf|Nor|2007-05-09|httpd is crashing if conf/extra/httpd-manual.conf |
|42373|Inf|Maj|2007-05-09|REPORT request fails over mod_proxy               |
|42404|New|Enh|2007-05-13|Filename/info for disk-cached proxied remote URLs |
|42425|Inf|Nor|2007-05-15|Additional freshness checks in mod_cache.c cause m|
|42471|Inf|Nor|2007-05-21|clients with IE7 take 3megs per page load. httpd.e|
|42492|Inf|Nor|2007-05-22|mod_proxy_ajp with SSL front end: data corruption |
|42499|Inf|Nor|2007-05-23|Backslash produces a 404 error instead of going to|
|42548|New|Nor|2007-05-30|INCLUDE negotiating language aborts with APR_POOL_|
|42561|New|Enh|2007-05-31|[PATCH] AuthLDAPRemoteUserAttribute only applies i|
|42633|New|Min|2007-06-11|mod_info gives wrong information about actual conf|
|42665|New|Nor|2007-06-14|spurious attempt to open ".../file.html/.htaccess"|
|42666|New|Nor|2007-06-14|code & docs corrections for FollowSymLinks and Sym|
|42667|New|Nor|2007-06-14|mod_proxy_balancer not reporting when workers are |
|42668|Inf|Nor|2007-06-14|balancer_manager shows Ok status for the workers t|
|42687|New|Nor|2007-06-18|Fully delegate certificate & key semantics to the |
|42688|New|Enh|2007-06-18|engine managed keys: per process openssl context  |
|42690|New|Nor|2007-06-18|realm is not set for each configured directory whe|
|42695|Opn|Cri|2007-06-18|mod_proxy balancer problem                        |
|42699|New|Enh|2007-06-20|share mod_logio data with other modules           |
|42711|New|Enh|2007-06-20|format string for whole log entries not just id   |
|42732|Opn|Maj|2007-06-25|Authentication against database issue.            |
|42763|New|Nor|2007-06-28|graceful-stop/restart loops go loop too far       |
|42923|Inf|Maj|2007-07-17|vhost certificate NOT overriding cert from the _de|
|42972|Inf|Nor|2007-07-25|Certificate list in mod_ssl module context are not|
|42977|New|Nor|2007-07-25|DAV locking is busted when apr-util is built with |
|42987|New|Nor|2007-07-27|Weak Etags in Apache are useless and violate RFC 2|
|43012|New|Nor|2007-08-02|AIX instdso.sh libphp5.so                         |
|43027|New|Enh|2007-08-03|Header in default language                        |
|43033|New|Nor|2007-08-04|apxs does not correctly detect module name (w/o -n|
|43177|New|Nor|2007-08-21|child pid xxxxx exit signal Segmentation fault    |
|43218|New|Nor|2007-08-27|Wrong cert used for vhost if ServerName is same   |
|43220|Opn|Cri|2007-08-27|mod_proxy truncating ajp output                   |
|43249|Inf|Maj|2007-08-30|ldap_simple_bind_s failed when using SUN LDAP Libs|
|43275|New|Enh|2007-08-31|Remove avoidable network transactions in mod_proxy|
|43289|New|Nor|2007-09-02|XBitHack full g+x returns zero sized response on I|
|43308|New|Nor|2007-09-04|Persistent backend connections not supported for R|
|43352|New|Nor|2007-09-11|Apache2: out of memory during heavy webdav files c|
|43441|New|Nor|2007-09-20|Incorrect HTTP status for pre-commit-blocked autov|
|43471|New|Min|2007-09-25|no need to create a global pool on open_scoreboard|
|43481|New|Cri|2007-09-26|AuthLDAPURL must contain a final path of branch?(l|
|43494|New|Nor|2007-09-26|mod_cgid does not kill never ending scripts       |
|43502|New|Enh|2007-09-28|httpd fails to start if log directory does not exi|
|43513|New|Nor|2007-09-29|Persistent backend connections for ProxyPassMatch |
|43532|Inf|Cri|2007-10-02|Error while compiling Apache 2.2.3 on HPUX        |
|43533|Opn|Nor|2007-10-02|Frequent crashes in mod_include's bndm()          |
|43561|New|Nor|2007-10-05|apxs -q anomaly                                   |
|43577|Inf|Blk|2007-10-09|mod_authnz_ldap not working under WLDAP32 (novell/|
|43607|New|Nor|2007-10-11|mod_proxy sends data on closed connections without|
|43649|Opn|Trv|2007-10-18|mod_autoindex is generating invalid XHTML markup  |
|43652|New|Enh|2007-10-18|Suggest small change for big fix with SuExec & Vir|
|43666|New|Nor|2007-10-20|CGI works, but client denied error messages in err|
|43679|New|Enh|2007-10-23|Contributed tests for checking that subrequests ta|
|43723|Inf|Cri|2007-10-29|Apache 2.2.6 segfault when using mod_dbd          |
|43724|New|Cri|2007-10-29|Apache 2.2.6 segfault on url wich not in cache    |
|43755|New|Enh|2007-10-31|Add a SSLOptions to don't fill SSL_CLIENT_VERIFY  |
|43762|New|Enh|2007-10-31|Misleading tips in an error message about internal|
|43777|New|Nor|2007-11-01|Wrong encoding of <href> element in response      |
|43778|New|Nor|2007-11-01|Wrong responses if httpd has not access to some el|
|43785|New|Enh|2007-11-02|Tracking the per-hit impact of mod_include        |
|43792|New|Enh|2007-11-04|Feature proposal - bind phase                     |
|43818|New|Nor|2007-11-08|PROPFIND on -w- collections returns 207 MULTI-STAT|
|43838|New|Enh|2007-11-11|If-Modified-Since request and htcacheclean conflic|
|43895|New|Nor|2007-11-18|mod_mbox improvements                             |
|43897|Inf|Cri|2007-11-18|Huge memory consumption httpd 2.2.6, mod_proxy - m|
|43931|New|Enh|2007-11-21|OpenSSL autoconfig support for mod_ssl            |
|43943|New|Nor|2007-11-22|SHMCB crash due to misalignment and GCC 4 optimiza|
|43958|Inf|Maj|2007-11-26|mod_proxy_balancer not balancing correct in combin|
|43997|Opn|Min|2007-11-29|Only issue "Init: SSL server IP/Port conflict" if |
|44025|Inf|Nor|2007-12-05|Apache 2.2.6 fails to configure on OpenBSD 4.1    |
|44027|Ass|Enh|2007-12-05|Internationalized Domain Name (IDN) support       |
|44031|Opn|Maj|2007-12-06|RemoveHandler inside subdir location              |
|44034|Ass|Enh|2007-12-06|mpm_winnt doesn't call monitor hook               |
|44105|New|Nor|2007-12-19|Core dumps when using Proxy Keepalive             |
|44155|New|Enh|2007-12-31|smarter retry for LDAP_UNAVAILABLE, LDAP_BUSY, etc|
|44181|Opn|Enh|2008-01-07|add UnAlias                                       |
|44188|Inf|Cri|2008-01-08|Empty response for certain requests (mod_proxy as |
|44218|New|Min|2008-01-13|mod_autoindex shows the default icon for files wit|
|44221|Opn|Cri|2008-01-14|CheckCaseOnly On does not stop Multiple Choices ba|
|44250|New|Nor|2008-01-16|OSX 10.5: __THE_PROCESS_HAS_FORKED_AND_YOU_CANNOT_|
|44279|New|Enh|2008-01-22|Add "iterate" flag to apply rule in a loop while p|
|44302|New|Nor|2008-01-27|AuthLDAPURL does not accept ldapi:// urls         |
|44305|New|Nor|2008-01-28|Inconsistent configuration for suexec path        |
|44316|New|Nor|2008-01-28|httpd 2.0 does not follow ScriptAliases when invok|
|44322|New|Enh|2008-01-29|mod_proxy ProxyPassReverseCookieDomain with no dom|
|44351|New|Nor|2008-02-04|File descriptor leak when using prg RewriteMap    |
|44363|Inf|Maj|2008-02-05|Slow file transfers                               |
|44384|Ass|Nor|2008-02-09|mod_ssl on MacOS X 10.5.1 does not work because of|
|44453|New|Nor|2008-02-19|list_hooks.pl doesn't parse declarations that span|
|44476|New|Maj|2008-02-23|Apache service fails to start due to missing depen|
|44503|Inf|Blk|2008-02-27|Errors during SSL handshake                       |
|44518|New|Enh|2008-03-02|Don't set expires header on HTTP redirect.        |
|44578|New|Enh|2008-03-11|mod_authn_dbd option to let database validate pass|
|44601|New|Trv|2008-03-13|Add a lowercase value to Vary header for consisten|
|44602|New|Enh|2008-03-13|Options for modfying Content-Location (relative OR|
|44622|Inf|Nor|2008-03-17|POST fails to SSL vhost with proxy to HTTP backend|
|44631|New|Nor|2008-03-18|with-included-apr fails to work when using a separ|
|44638|New|Nor|2008-03-19|sed error in httpd.spec.in                        |
|44656|New|Nor|2008-03-22|Tries to retrive error document 404 instead of 406|
|44657|New|Enh|2008-03-22|prefer-type, -encoding, and -charset cookie? (as p|
|44670|New|Min|2008-03-25|Apache httpd 2.2.8 : Cannot ./configure when curre|
|44696|Inf|Nor|2008-03-27|mod_cache sometimes serves old content despite hav|
|44730|New|Nor|2008-04-01|duplicate query string in remote server url when u|
|44752|New|Nor|2008-04-03|Suexec does not correctly check that scripts are i|
|44757|New|Enh|2008-04-04|adding stderr buckets to mod_cgi                  |
|44758|New|Enh|2008-04-04|LimitRequestBody undocumented behaviour with proxi|
|44779|New|Enh|2008-04-08|Using commas and semicolons for content negotiatio|
|44855|New|Nor|2008-04-22|irregular balancing with sticky-session after re-e|
|44865|Ass|Nor|2008-04-23|mod_dav's lock database becomes consistently corru|
|44870|Inf|Nor|2008-04-24|process spinning on 100% cpu                      |
|44923|Inf|Min|2008-05-02|consequences of multiple LDAPTrustedGlobalCert    |
|44924|New|Enh|2008-05-02|allow 'CACERTDIR' in mod_ldap                     |
|44940|New|Maj|2008-05-06|Httpd randomly breaks when verifying client certif|
|44981|New|Enh|2008-05-12|Digital Certificates (CN Based) for Authorization |
|45022|New|Nor|2008-05-16|Processing of escaped glob patterns in "Include" d|
|45023|Opn|Reg|2008-05-16|DEFLATE preventing 304 NOT MODIFIED response      |
|45049|Opn|Nor|2008-05-20|mod_mem_cache caches partial content when client c|
|45054|New|Nor|2008-05-21|SSLVerifyClient optional_no_ca is broken          |
|45058|New|Nor|2008-05-21|Mod_SSL does not set AUTH_TYPE with client certifi|
|45078|New|Nor|2008-05-27|mod_proxy stalls when uploading files             |
|45103|Ass|Min|2008-05-30|apachectl should do config test before reload/rest|
|45111|New|Enh|2008-06-01|make mod_usertrack use mod_unique_id if available |
|45116|New|Nor|2008-06-02|fail to check return value of apr_file_dup2() in /|
|45148|New|Enh|2008-06-06|The actual host of the request will be more helpfu|
|45184|New|Enh|2008-06-11|Regular Expression in directive ServerAlias       |
|45187|New|Maj|2008-06-11|Long File name requests gives FORBIDDEN response  |
|45225|New|Nor|2008-06-17|XBitHack breaks DirectoryIndex + MultiViews conten|
|45253|New|Nor|2008-06-23|Unable to build httpd 2.2.9 on Solaris/SPARC      |
|45257|New|Enh|2008-06-23|add (en)force option for UseCanonicalName         |
|45259|New|Enh|2008-06-23|Add /home/[a-z]/* scheme to UserDir conf          |
|45275|New|Maj|2008-06-25|Locked files during expired page renew in disk cac|
|45281|New|Enh|2008-06-25|SITE CHMOD/SEARCH                                 |
|45287|Inf|Min|2008-06-26|build failure because of difference between BSD an|
|45297|New|Min|2008-06-27|mod_dir does not manage correctly the user (r->use|
|45302|New|Enh|2008-06-28|ServerRoot directive                              |
|45355|New|Nor|2008-07-07|ab text and html output jumbo unification         |
|45356|New|Nor|2008-07-07|ab: optionally reduce resource usage (qsort and me|
|45371|New|Nor|2008-07-10|MSI installer requires uninstall of previous versi|
|45374|New|Blk|2008-07-10|Shared memory error on starting httpd with mod_lda|
|45379|Inf|Nor|2008-07-11|[Bug] svn merge, apache and trailing slashes      |
|45385|Inf|Nor|2008-07-11|unable to compile/make 2.2.9 with --enable-ldap   |
|45393|New|Nor|2008-07-14|Apache returns 500 Error when no LDAP credentials |
|45402|New|Nor|2008-07-15|mod_autoindex incorrectly fails to list files     |
|45405|New|Enh|2008-07-16|Allow binding port to be set for individual worker|
|45449|New|Nor|2008-07-21|[PATCH] Add support to WebDav to MOVE/COPY to remo|
|45456|New|Enh|2008-07-22|mod_dbd don't allow more then one database pool   |
|45487|New|Trv|2008-07-27|broken log messages on startup in win32 version   |
|45497|New|Nor|2008-07-29|Scoreboard slot leaked using MaxRequestsPerChild a|
|45512|Ass|Maj|2008-07-31|Bad Performance of mod_proxy with SSL on Solaris 1|
|45524|New|Enh|2008-08-01|Specifying multiple vhost aliases                 |
|45525|New|Enh|2008-08-01|Switch mod_autoindex to Tango icons               |
|45579|New|Nor|2008-08-06|unknown URI scheme in request-URI ignored         |
|45674|New|Enh|2008-08-22|Allow to change error code returned by "Require ld|
|45726|New|Enh|2008-09-02|Build in a maintenance functionallity             |
|45736|New|Nor|2008-09-03|mod_dav needs a directory for its locks and one sh|
|45754|New|Enh|2008-09-06|autoconf macros                                   |
|45763|New|Nor|2008-09-08|No openssl.cnf defined by default causes OpenSSL c|
|45773|New|Nor|2008-09-09|pcre build generates sources to srcdir rather than|
|45788|New|Nor|2008-09-11|mod_log_forensic output shouldn't be buffered when|
|45801|Opn|Nor|2008-09-13|SSLRequireSSL with strictrequire and satisfy any d|
|45838|New|Nor|2008-09-18|mod_authz_owner & directories                     |
|45868|New|Nor|2008-09-23|mod_mem_cache update of headers in cache object is|
|45900|New|Nor|2008-09-26|"make install" fails from read-only filesystem    |
|45905|New|Enh|2008-09-26|ErrorDocument and default URL                     |
|45922|New|Enh|2008-09-30|Expand the conditions under which "SSLVerifyClient|
|45923|New|Nor|2008-09-30|htpasswd tries to open(file, O_RDONLY | O_APPEND) |
|45926|Inf|Nor|2008-10-01|Unable to start apache 2.2.9                      |
|45986|New|Nor|2008-10-10|[info]...Invalid argument: core_output_filter: wri|
|46024|Opn|Nor|2008-10-16|--enable-static is not available in apache's confi|
|46037|Inf|Nor|2008-10-18|Configuration of trusted OCSP responder certificat|
|46040|New|Enh|2008-10-20|Check for existing version of Apache while install|
|46054|New|Nor|2008-10-21|Running httpd returns the error "bad user name nob|
|46070|New|Nor|2008-10-22|MSI installer does not validate custom installatio|
|46071|New|Enh|2008-10-22|Allowing space in between comma and last option in|
|46074|New|Enh|2008-10-23|Need of friendly and easy to use configuration gra|
|46139|New|Nor|2008-11-02|Apache Restart option is not working              |
|46140|New|Enh|2008-11-03|Change error state in balancer manager            |
|46188|Inf|Nor|2008-11-11|Core dumps in apache 2.0.59                       |
|46195|Opn|Nor|2008-11-12|ProxyPass fails with literal IPv6 address         |
|46215|New|Nor|2008-11-14|Race condition in bybusyness algorithm            |
|46231|New|Maj|2008-11-18|Connection Pooling with ajp depends on syntax ?   |
|46241|New|Enh|2008-11-19|mod_expires - ExpiresByPattern or ExpiresIf       |
|46267|New|Nor|2008-11-22|No shared modules build if use --with-apr and --wi|
|46270|New|Enh|2008-11-23|Add FIPS 140-2 mode for mod_ssl for FIPS 1.2 modul|
|46282|New|Nor|2008-11-24|apache2.2 reverse proxy causing full memory and sw|
|46316|New|Maj|2008-12-01|Proxied SSI ProxyTimeout render failure           |
|46317|Inf|Nor|2008-12-01|mod_authnz_ldap.c(373)  seg fault                 |
|46412|New|Nor|2008-12-17|make_child return value not checked               |
|46417|New|Cri|2008-12-19|[notice] Parent: child process exited with status |
|46428|Opn|Nor|2008-12-21|Spaces in URI doesn't encode in proxy-requests    |
|46442|New|Nor|2008-12-29|Semicolon in allow/deny all rules cause reverse lo|
|46449|New|Maj|2008-12-30|Output out of order from SSI include virtual      |
|46454|New|Min|2008-12-30|escaping wildcards in AddIcon filename matching   |
|46475|New|Nor|2009-01-04|build warnings.                                   |
|46499|New|Maj|2009-01-09|httpd accept() return EAGAIN error                |
|46521|New|Nor|2009-01-13|mod_dav doesn't show symlinks                     |
|46529|Ass|Nor|2009-01-14|Child httpd processes crash with Segmentation faul|
|46534|New|Nor|2009-01-14|mod_proxy_ajp scheme and port do not follow UseCan|
|46578|New|Nor|2009-01-21|Flawed header                                     |
|46582|Ver|Min|2009-01-22|RewriteMap internal functions are not well documen|
|46604|New|Nor|2009-01-26|Error thrown when trying to rpmbuild -tb httpd sou|
|46629|New|Maj|2009-01-29|Apache hanging on system calls for php and perl   |
|46634|Ass|Nor|2009-01-30|Requests sometimes take too long, wrong time taken|
|46644|New|Enh|2009-01-31|Clean way to pass custom environment variables to |
|46646|Ass|Nor|2009-02-01|check group membership is sometimes case sensitive|
|46650|Opn|Nor|2009-02-02|CustomLog enviroment condition SCRIPT_FILENAME    |
|46656|New|Enh|2009-02-03|ProxyErrorOverride inside location                |
|46669|New|Enh|2009-02-06|rotatelogs doesn't autocreate directories         |
|46671|Opn|Cri|2009-02-07|Apache periodicaly crashes .                      |
|46678|New|Nor|2009-02-09|Fixed Content-Length using mod_ext_filter with mod|
|46682|New|Nor|2009-02-09|mod_proxy EAI_AGAIN DNS failure                   |
|46685|Opn|Nor|2009-02-09|401 sent without WWW-Authenticate header when requ|
|46709|Opn|Reg|2009-02-12|Expect: 100-continue to an HTTP/1.0 server change |
|46724|Inf|Cri|2009-02-17|WinXP SP3 - Apache crashes on startup in libapr-1.|
|46743|New|Nor|2009-02-19|Inconsistent behavior of "RewriteOptions inherit" |
|46745|New|Maj|2009-02-20|ab.c error :  undefined reference to `BIO_set_call|
|46751|New|Nor|2009-02-21|Can passenv variables who's name contain '(' or ')|
|46762|New|Nor|2009-02-24|Error, SSL/TLS libraries were missing or unusable |
|46765|Opn|Nor|2009-02-25|doubled HTTP header leads to error (Redmine)      |
|46785|Inf|Nor|2009-03-02|Child process increases to 100% (CPU)             |
|46788|New|Nor|2009-03-02|Set resource limits to avoid denial of service att|
|46810|New|Nor|2009-03-05|apxs / apu-1-config outputting erroneous include p|
|46824|New|Nor|2009-03-09|RemoveOutputFilter will not work for Filters added|
|46845|Inf|Cri|2009-03-12|Apache crashes in Windows when using subversion(pr|
|46847|New|Nor|2009-03-13|WebDAV methods with encoding other than "identity"|
|46873|New|Nor|2009-03-18|feature request: connection count on balancer-mana|
|46884|New|Min|2009-03-20|Call to apu_dso_load Fails In apr_ldap_stub.c On O|
|46946|Inf|Nor|2009-03-31|mod_mbox shows email addresses in plain text      |
|46963|New|Nor|2009-04-03|KeepAliveTimout prevents child process from exitin|
|46969|New|Nor|2009-04-05|CustomLog format %m always GET on errors with loca|
|46970|New|Nor|2009-04-05|CustomLog %X does not record aborted connections w|
|47011|New|Reg|2009-04-09|mod_proxy/mod_proxy_balancer hot-standby BalancerM|
|47055|New|Blk|2009-04-20|SSLVerifyClient + Directory doesn't use cache sess|
|47063|New|Nor|2009-04-21|mod_proxy doesn't call post_request handler when t|
|47134|New|Nor|2009-05-01|Last resolve handling when sending client certific|
|47138|New|Nor|2009-05-01|Reverse Proxy & Balancer generate error fault when|
|47152|New|Maj|2009-05-04|Apache is only serving the first character in the |
|47159|New|Nor|2009-05-06|2.2.x logresolve doesn't support ipv6             |
|47167|New|Nor|2009-05-07|Authenticated sessions being switched by reverse p|
|47170|New|Enh|2009-05-08|rotatelogs ring buffer option                     |
|47180|New|Nor|2009-05-11|DBM ssl_scache setting can cause extreme performan|
|47220|Opn|Enh|2009-05-19|Access to environment variables                   |
|47241|New|Min|2009-05-22|Error in rewriting with character ':'             |
|47256|New|Enh|2009-05-23|Enable SSL on a per-port basis                    |
|47289|New|Nor|2009-05-30|Can't build with dynamic libraries on Mac OS 10.4 |
|47295|New|Nor|2009-06-01|AuthDBDUserPWQueryFmt/AuthDBDUserRealmQueryFmt in |
|47329|New|Nor|2009-06-07|SSLCADNRequest* & SSLCACertificate* silently do no|
|47340|New|Nor|2009-06-09|uldap_cache_comparedn() called without a lock     |
|47344|New|Enh|2009-06-10|[FEATURE REQUEST] RedirectCanonicalName           |
|47345|New|Enh|2009-06-10|rotatelogs timeout patch                          |
|47346|New|Maj|2009-06-10|mod_cache doesn't re-cache expired content when La|
|47387|Inf|Nor|2009-06-18|SSL_CLIENT_I_DN and SSL_CLIENT_S_DN use Email inst|
|47392|Opn|Nor|2009-06-18|<FilesMatch> is using the wrong directory         |
|47435|New|Nor|2009-06-26|mod_authz_host does reading of /etc/hosts on each |
|47438|Inf|Enh|2009-06-27|how to create a non-html "listing generated by the|
|47447|New|Enh|2009-06-29|Add possibility to use client IP as a value in Req|
|47484|New|Nor|2009-07-06|Spurious RewriteLock warning when using external m|
|47485|New|Enh|2009-07-06|HTML5 Websocket implementation                    |
|47514|New|Enh|2009-07-12|Personal data and restrictions based on subject di|
|47528|New|Maj|2009-07-14|Worker process won't restart more than once using |
|47542|New|Nor|2009-07-16|Piped logging processes killed before other proces|
|47562|Inf|Nor|2009-07-23|Apache/2.2.3 (Win32) mod_perl/2.0.3-rc1           |
|47578|New|Nor|2009-07-24|compile ERROR with ssl                            |
|47580|Opn|Nor|2009-07-25|mod_cache sends 200 response instead of 304       |
|47586|New|Nor|2009-07-27|httpd -k start doesn't start service when rotatelo|
|47591|New|Min|2009-07-27|show current HTTP_HOST in mod_status scoreboard   |
|47601|New|Enh|2009-07-29|Support X-Forwarded-For in forward proxy requests |
|47625|New|Nor|2009-08-02|2.2.12 win32 msi installer missing                |
|47634|New|Maj|2009-08-04|mod_ldap connection pool session keepalive not imp|
|47643|New|Enh|2009-08-04|added meta tags to xhtml output for ease of search|
|47650|Opn|Trv|2009-08-05|httxt2dbm calculates value size incorrectly       |
|47657|New|Nor|2009-08-06|Make WebDAV MOVE atomic when replacing files on sa|
|47659|New|Nor|2009-08-07|makefile.win needs check for DBM_LIST, dies on bui|
|47664|New|Nor|2009-08-07|ap_proxy_canonenc: does not recode all high-byte c|
|47665|Inf|Blk|2009-08-09|Apache service well launched but blank Screen     |
|47691|New|Enh|2009-08-12|libtool invocations should use --tag              |
|47693|Opn|Nor|2009-08-13|GET request has race condition w.r.t. replacement |
|47706|Inf|Nor|2009-08-19|(20014)Internal error: proxy: error reading status|
|47716|New|Min|2009-08-20|LimitRequestFieldSize and friends not merged well |
|47719|Opn|Enh|2009-08-20|Broken symbolic link (symlink) causes wrong ErrorD|
|47723|New|Nor|2009-08-22|suEXEC and low RLimitMem gives "crit: invalid uid"|
|47743|Inf|Nor|2009-08-26|mod_so segfaults at server startup in ap_find_load|
|47753|New|Nor|2009-08-27|output and error channels not explicitly passed fo|
|47778|Opn|Enh|2009-09-03|wrong exit value on graceful restart              |
|47780|New|Nor|2009-09-03|Critical errors should be marked by time and level|
|47807|Inf|Nor|2009-09-09|Proxy dialog error with Apache 2.2.13             |
|47808|New|Maj|2009-09-09|Child process core dumps when enabling CRL        |
|47814|Inf|Maj|2009-09-10|openssl_pkcs7_sign error                          |
|47838|New|Enh|2009-09-14|Ability to Dynamically Inject Current Time Into a |
|47874|New|Nor|2009-09-18|mod_fcgid crashes if added during restart         |
|47895|New|Maj|2009-09-24|Incorrect 413 error handling                      |
|47908|New|Min|2009-09-27|'invalid result code' in error_log                |
|47981|New|Nor|2009-10-12|allow language specific html-versions (index.html.|
|47982|New|Nor|2009-10-12|correctly interprete non-standard HTTP_ACCEPT_LANG|
|47988|New|Nor|2009-10-12|Segmentation fault                                |
|47989|New|Nor|2009-10-13|Junk string appended to compressed dynamic content|
|47994|New|Enh|2009-10-14|ScriptInterpreterSource apparently broken in Windo|
|48020|New|Nor|2009-10-17|KCP+ Opera support for mod_auth_digest            |
|48037|Inf|Nor|2009-10-21|mod_proxy_http does not handle asynchronous keepal|
|48045|New|Nor|2009-10-23|Apache 2 initgroups alert, Max OS X, abnormal exit|
|48057|New|Nor|2009-10-26|mod_fcgid creates 1 more process then allowed     |
|48094|New|Nor|2009-11-01|Avoid a race condition in close_worker_sockets()  |
|48107|New|Maj|2009-11-02|Mutual Authentication: Order in ca-bundle influenc|
|48115|New|Enh|2009-11-03|Duration to receive the request, generate response|
|48130|New|Maj|2009-11-04|DAV operations on large filesets consume all the O|
|48154|New|Nor|2009-11-06|Requests through mod_isapi are not parsed by HTTP_|
|48164|New|Enh|2009-11-09|add new parameters to rotatelogs                  |
|48219|New|Nor|2009-11-17|Retrying the worker for seems to omit POST variabl|
|48228|New|Nor|2009-11-18|Renegocation requires multiple client authenticati|
|48246|New|Enh|2009-11-19|Check permissions on file/directory specified for |
|48254|New|Trv|2009-11-20|Bogus "DocumentRoot does not exist" warning when s|
|48283|New|Nor|2009-11-25|Proxy errors since httpd 2.2.12 with Tomcat 6.0.20|
|48291|New|Maj|2009-11-26|mod_substitute loops                              |
|48295|Opn|Nor|2009-11-27|ProxyPassReverseCookiePath: Not changing path corr|
|48301|New|Enh|2009-11-30|Feature request: improved connection status report|
|48309|New|Maj|2009-11-30|libapreq2-2.12: "make test" fails at request.t and|
|48312|Opn|Nor|2009-11-30|ProxyPassReverseCookiePath: Not changing path corr|
|48316|Inf|Nor|2009-12-01|ap_run_insert_filter doesn't work in cache_url_han|
|48354|New|Enh|2009-12-08|void ap_custom_response is not supporting the bina|
|48360|New|Enh|2009-12-09|provide sample configuration file for inclusion in|
|48361|New|Enh|2009-12-09|Add global server option for specifying desired DS|
|48364|Opn|Nor|2009-12-10|PHP-generated pages are not cached in spite of per|
|48369|New|Enh|2009-12-10|add option to automatically restart if a script is|
|48431|New|Nor|2009-12-22|Error logging doesn't work when configured to use |
|48440|Inf|Cri|2009-12-23|Segmentation Fault                                |
|48449|Inf|Nor|2009-12-28|make distclean removes core.c and core_filters.c  |
|48465|Opn|Enh|2009-12-30|Support TCP to connect to backends                |
|48499|New|Nor|2010-01-06|mod_rewrite can't redirect to files with ? in them|
|48500|New|Nor|2010-01-06|mod_mbox mishandles right-click to open msg in new|
|48508|New|Nor|2010-01-07|BalancerMember doesn't accept nocanon directive   |
|48549|New|Enh|2010-01-14|Add Cache-Control s-maxage support                |
|48576|New|Nor|2010-01-19|MOVE or COPY in WebDAV fails with 404 when file ex|
|48585|New|Enh|2010-01-20|mod_cache no longer caches expired content        |
|48602|New|Enh|2010-01-23|use asynch ldap_compare so LDAPTimeout applies    |
|48623|New|Maj|2010-01-26|AuthLDAPURL syntax is not RFC-compliant, prevents |
|48639|New|Enh|2010-01-29|Add htcacheclean as a core monitored process      |
|48652|New|Maj|2010-02-01|"AuthType form" fails if a password contains  '&' |
|48659|New|Maj|2010-02-02|Problem with accents in filename and byte serving |
|48687|New|Nor|2010-02-05|mod_rewrite ignores trailing dot in request URI on|
|48705|New|Enh|2010-02-08|flag to allow newlines in the error log as opposed|
|48712|New|Enh|2010-02-09|Add UID and GID to status page                    |
|48719|New|Nor|2010-02-09|[BUG] mod_proxy_ajp return wrong error message whe|
|48721|New|Nor|2010-02-10|[Patch] Add ProxyAllow to mod_proxy               |
|48731|New|Maj|2010-02-11|Prefork not creating processes after 10 servers ar|
|48732|New|Nor|2010-02-12|[BUG] environment variable SCRIPT_NAME output erro|
|48769|New|Nor|2010-02-18|[PATCH] Processes in the busy list should not be k|
|48777|New|Maj|2010-02-19|proxy balancer not detecting correctly when host (|
|48780|New|Enh|2010-02-19|Enable mod_authnz_ldap to accept valid client cert|
|48792|New|Enh|2010-02-22|httpd util apachectl returns wrong status informat|
|48805|New|Nor|2010-02-23|Corrupted response for HTTPS + KEEPALIVE=ON       |
|48808|New|Enh|2010-02-24|mod_authz_owner support for POSIX access control l|
|48819|Inf|Nor|2010-02-25|After users login on the web page, the page does n|
|48842|Inf|Nor|2010-03-02|mod_log_config logs the full size of the file inst|
|48880|Opn|Nor|2010-03-09|error on make                                     |
|48888|New|Nor|2010-03-10|DOCTYPE definitions nearly 11 years out-of-date   |
|48920|New|Enh|2010-03-15|Breadcrumbs on mod_autoindex path                 |
|48921|Inf|Nor|2010-03-16|mod_mem_cache crash, version 2.2.15.0             |
|48937|New|Enh|2010-03-18|Feature proposal - support sasl_bind              |
|48949|Inf|Cri|2010-03-20|fcgid processes never get killed after graceful re|
|48958|New|Nor|2010-03-22|mod_ldap, ldap credential cache & graceful restart|
|48987|New|Trv|2010-03-25|typo in polish translation of HTTP_UNAUTHORIZED.ht|
|49037|New|Enh|2010-04-02|SSLVerifyClient require_no_ca                     |
|49043|New|Maj|2010-04-04|Using ssi include directive overwrites QUERY_STRIN|
|49058|New|Nor|2010-04-06|Prefork MPM tries to accept on closed listener soc|
|49067|New|Nor|2010-04-08|FTPOptions ShowUnAuthorizedFiles does not work    |
|49068|New|Nor|2010-04-08|UTF-8 URL Encode error                            |
|49087|New|Maj|2010-04-11|MSI installation reports "interrupted installation|
|49114|New|Maj|2010-04-13|NTFS junction directories missing from directory l|
|49123|New|Nor|2010-04-14|mod_proxy_ajp does not send the client's SSL chain|
|49131|New|Nor|2010-04-15|Very long URLs cause 404 or 403 errors with SetAct|
|49133|New|Maj|2010-04-16|Windows service recovery options do not work for A|
|49157|New|Nor|2010-04-20|Issues with xml interface for balancer manager    |
|49187|New|Nor|2010-04-26|Crash mod_mem_cache and mod_svn                   |
|49199|New|Enh|2010-04-27|Implement LDAP scope-aware caching in mod_ldap    |
|49220|New|Nor|2010-04-29|feature request for being able to disable FcgidWra|
|49239|New|Blk|2010-05-01|Apache mod_ssl gives coredump with openssl 0.9.8  |
|49277|New|Nor|2010-05-12|Expose a variable to identify SSL Session renegoti|
|49283|New|Nor|2010-05-12|Language of dates on SSI                          |
|49285|New|Enh|2010-05-13|Relative (local to current directory) URLs do not |
|49348|New|Enh|2010-05-27|[mod_log_config] Output log file name format capab|
|49385|New|Maj|2010-06-03|mod_disk_cache server side included files are inte|
|49387|Inf|Cri|2010-06-03|Unable to modify default charset setting to UTF-8 |
|49391|New|Nor|2010-06-05|mod_disk_cache needs to register a cleanup to kill|
|49396|New|Enh|2010-06-06|PATH_INFO normalization, especially relating to vo|
|49427|New|Nor|2010-06-11|mod_cgid and mod_cgi do not return proper value wh|
|49433|New|Enh|2010-06-13|improving info in server status                   |
|49439|New|Nor|2010-06-14|Bug in mod_userdir which prevents suexec from runn|
|49504|New|Nor|2010-06-25|Solaris 10/x64 worker graceful restart problem    |
|49532|New|Nor|2010-06-30|mod_cache: Set-Cookie headers are appended to cach|
|49553|New|Min|2010-07-05|Set QoS bits via APR2 API instead                 |
|49568|New|Maj|2010-07-07|Apache mod_authnz_ldap built with the MS LDAPSDK d|
|49632|Inf|Nor|2010-07-21|mod_authnz_ldap denies users when search is perfor|
|49633|New|Enh|2010-07-21|Handle AD primary groups in mod_authnz_ldap       |
|49642|New|Nor|2010-07-23|mod_rewrite mistakes encoded question mark as path|
|49643|New|Nor|2010-07-23|WebDav plus mod Negotiation causes directory creat|
|49676|New|Nor|2010-07-30|directory with german umlauts are indented by one |
|49680|New|Maj|2010-07-30|Perl script are not running on Win32, Apache 2.2.1|
|49684|New|Enh|2010-08-01|enhancement for ipv6 implementation               |
|49699|New|Nor|2010-08-03|Inconsistent Keep-alive from proxy to the origin s|
|49715|New|Maj|2010-08-06|ProxyPassMatch Url Encoder Problem                |
|49717|New|Enh|2010-08-06|PATCH: Enable SSL Timeout                         |
|49737|Inf|Nor|2010-08-10|order allow,deny does not work on IPv6            |
|49743|New|Maj|2010-08-12|SSI 'echo encoding="(url/none)"' bug              |
|49746|Opn|Enh|2010-08-12|mod_rewrite urlencode option                      |
|49766|New|Maj|2010-08-17|POST request on CGI script generating empty body c|
|49771|New|Nor|2010-08-17|After graceful restart using mod_proxy_ajp, couldn|
|49772|New|Nor|2010-08-18|mod_deflate kicks itself out on Content-Range resp|
|49798|Opn|Nor|2010-08-22|[mod_log_config] Piped Log scripts process cause w|
|49807|New|Enh|2010-08-23|hard to force Content-Type header for non static f|
|49810|New|Nor|2010-08-23|Mod_autoindex output of header/body/footer scrambl|
|49815|New|Enh|2010-08-24|Enable caching for HTTP Range requests / 206 respo|
|49829|New|Trv|2010-08-26|CGI index command line arguments excessively escap|
|49832|New|Enh|2010-08-26|void ap_custom_response is not supporting the bina|
|49859|Opn|Nor|2010-09-01|url with additional filepath generates bad environ|
|49921|New|Nor|2010-09-13|Trailers in chunked http requests are not handled |
|49926|New|Enh|2010-09-14|New option for mod_log_forensics or mod_log_config|
|49980|New|Nor|2010-09-22|can't use a FIFO for SSL key file; mod_ssl checks |
|49981|New|Enh|2010-09-22|Requesting SSLCertificateKeyFile Dialog functional|
|49990|New|Nor|2010-09-23|Feature request: implement ExpiresActive reset    |
|49996|New|Nor|2010-09-24|Proxied ErrorDocument returns 200 OK response code|
|49997|New|Nor|2010-09-24|wrowe promised me...                              |
|50004|New|Nor|2010-09-26|per-dir rewrite without DocumentRoot or RewriteBas|
|50011|New|Cri|2010-09-27|error running apache, and installing apache as a s|
|50024|New|Min|2010-09-29|Mod_cache/mod_mem_cache and mod_security combinati|
|50038|New|Enh|2010-10-01|What Directives apply to a file/directory? Resulta|
|50041|New|Min|2010-10-04|(9)Bad file descriptor: apr_socket_accept: (client|
|50051|New|Nor|2010-10-07|Log PID in first entry logged for each request    |
|50061|New|Nor|2010-10-08|Semicolon character '%3B' seems to be decoded to '|
|50082|New|Nor|2010-10-12|apachectl status returns incorrect exit code      |
|50112|New|Nor|2010-10-18|buildconf broken in two places                    |
|50116|New|Nor|2010-10-19|Apache fragments packets unnecessarily            |
|50151|New|Nor|2010-10-25|Software caused connection abort and apache proces|
|50155|Inf|Nor|2010-10-25|httpd -s attempts to read SSL certificates        |
|50172|Inf|Nor|2010-10-28|Digest allows access bypassing secuity            |
|50227|New|Enh|2010-11-07|Option to fail SSL handshake for diverted SNI conn|
|50237|Inf|Nor|2010-11-08|webdav LOCK access with multiple threads to same f|
|50261|New|Nor|2010-11-12|graceful restart with multiple listeners using pre|
|50262|New|Nor|2010-11-12|mod_rewrite log ip address vs hostname            |
|50274|New|Nor|2010-11-15|always pass CONTENT_LENGTH to the application     |
|50278|New|Nor|2010-11-16|-DFOREGROUND and ap_unixd_killpg()/ap_os_killpg() |
|50290|Inf|Nor|2010-11-18|vanilla apache 2.2.17 installation crashes (lib-ap|
|50296|New|Nor|2010-11-18|LDAPVerifyServerCert and possibly LDAPTrustedMode |
|50317|New|Nor|2010-11-22|Possible error in mod_cache's "Avoiding the Thunde|
|50336|New|Min|2010-11-25|PUT failures do not emit Allow:                   |
|50344|New|Nor|2010-11-26|ProxyPass does not handle different protocols when|
|50357|New|Enh|2010-11-28|improve matching mechanisms for mime type and enco|
|50372|New|Enh|2010-11-29|any reason for allowing ModMimeUsePathInfo only in|
|50390|New|Nor|2010-11-30|WARNING: Unrecognized options : --disable-ipv6    |
|50402|New|Nor|2010-12-02|SetEnv proxy-sendchunks is ignored for small amoun|
|50412|New|Nor|2010-12-04|if IndexOptions +XHTML, the correct MIME type shou|
|50423|Inf|Nor|2010-12-06|Apache is terminated with signal 11, Segmentation |
|50427|New|Nor|2010-12-07|Windows>=Vista+mod_auth_digest+command line=proble|
|50432|New|Enh|2010-12-08|add PCRE-mode for file based matches              |
|50436|New|Enh|2010-12-08|VirtualHost could behave like people expect it to |
|50444|New|Enh|2010-12-09|Pre-close logging handles in cgid agent           |
|50456|Inf|Nor|2010-12-10|Invalid Error 413 crash Apache                    |
|50464|New|Blk|2010-12-13|undefined reference to `BIO_set_callback' `BIO_set|
|50466|Inf|Maj|2010-12-13|httpd process doesn't recycle                     |
|50473|New|Maj|2010-12-14|zlib.dll Problem                                  |
|50521|New|Nor|2010-12-25|Comment at top of sample main config file is wrong|
|50525|New|Nor|2010-12-28|Header directive won't edit Location header from P|
|50530|New|Enh|2010-12-29|Provide rate limiting for failed authentication at|
|50532|New|Enh|2010-12-30|Mail protection                                   |
|50551|New|Nor|2011-01-06|Some proxied connections ignore ttl setting       |
|50562|Opn|Cri|2011-01-09|wrong PATH_INFO CGI environment with non-ASCII UTF|
|50584|New|Enh|2011-01-14|Add error message when RequestReadTimeout triggere|
|50592|New|Maj|2011-01-15|httpd dumps core on an IPv6 only system           |
|50602|New|Nor|2011-01-17|non thread safe functions used in apache httpd pro|
|50619|New|Min|2011-01-19|After changing resolv.conf signaling httpd doesn't|
|50628|New|Blk|2011-01-21|Core dump happens with Apache 2.2.15 using openssl|
|50630|New|Nor|2011-01-21|Apache return 500 error with authentication by LDA|
|50644|New|Enh|2011-01-24|Add support for maximum number of requests per Kee|
|50654|New|Nor|2011-01-25|FileETag ContentMD5 & Filename, optimisation to Co|
|50693|New|Nor|2011-01-31|AllowOverride Options=(not Foo) should permit no-o|
|50704|Inf|Nor|2011-02-01|mod_cache doesn't cache MultiViews                |
|50712|New|Maj|2011-02-02|Restart button only stops the server ...and do not|
|50727|New|Nor|2011-02-07|ISAPI EXTENSION_CONTROL_BLOCK Missing PostData wit|
|50765|New|Enh|2011-02-11|Runtime Backend Pinning via balancer-manager      |
|50770|New|Nor|2011-02-14|a rotatelogs issue, if time changed               |
|50773|Inf|Nor|2011-02-14|Dav lock database corruption                      |
|50774|New|Enh|2011-02-14|Have a way to invalidate cache without other reque|
|50777|New|Nor|2011-02-14|Back port buildconf specifies AC_PREREQ(2.13) fix |
|50796|New|Enh|2011-02-16|record time between keepalives in access log      |
|50807|New|Maj|2011-02-18|mod_proxy fails to send FIN response when a FIN is|
|50814|New|Nor|2011-02-21|SSI exec not working on Windows (Apache 2.x)      |
|50848|New|Enh|2011-03-01|Content Negotiation type map file precedence could|
|50869|New|Enh|2011-03-04|Need directive to control use and timeout of sessi|
|50873|New|Nor|2011-03-04|httpd does not start properly when built from sour|
|50878|New|Nor|2011-03-05|redundant operation when calling apr_stat         |
|50891|New|Nor|2011-03-08|Apache rewrites WWW-Authenticate headers from CGI |
|50902|Inf|Maj|2011-03-09|on major load on the server, poll() hangs         |
|50916|New|Nor|2011-03-11|RewriteMap program: mod_rewrite sends request but |
|50926|New|Nor|2011-03-14|unexpected <Directory> file-matching behavior     |
|50942|New|Maj|2011-03-17|Apache 2.2.16 forward proxy is 5x times slower tha|
|50945|Opn|Nor|2011-03-18|AJP: Missing support for ErrorOverride            |
|50948|Opn|Nor|2011-03-19|Connection not closed when CGI dies waiting for PO|
|50954|New|Nor|2011-03-21|ProxyRemote doesnt use CONNECT method with https s|
|50959|New|Enh|2011-03-23|Add cache-manifest to the mime type list          |
|50976|New|Nor|2011-03-26|Apache losts client's ip (%a or %h) sometimes.    |
|50999|Opn|Nor|2011-03-30|it seems the configure wrong detect my apr-util ve|
|51001|New|Nor|2011-03-31|patch for hook ap_lua_run_lua_open                |
|51005|New|Enh|2011-04-01|Allow to use username in LDAP filter              |
|51006|New|Blk|2011-04-01|Apache consume all memory and swap when setup as r|
|51019|New|Enh|2011-04-04|[PATCH] Implementation of Asynchronous processing |
|51020|Opn|Nor|2011-04-04|[PATCH] Apache/mod_fcgid.so does not start in comp|
|51022|New|Nor|2011-04-05|Segmentation fault on PUT request                 |
|51030|New|Enh|2011-04-06|Way to terminate CGI immediatly after closing conn|
|51078|Inf|Nor|2011-04-18|[PATCH] mod_fcgid spawned CGI Processes gets orpha|
|51079|New|Enh|2011-04-18|[PATCH] mod_fcgid spawned CGI Process cannot imper|
|51080|New|Nor|2011-04-18|[PATCH] mod_isapi does not support Except:100-Cont|
|51103|Opn|Nor|2011-04-21|mod_reqtimeout does not drop connection and return|
|51107|New|Min|2011-04-22|SetOutputFilter and SetInputFilter should allow "n|
|51118|New|Nor|2011-04-26|LDAP cache is cleared after graceful/restart and o|
|51127|New|Nor|2011-04-27|Make ProxyPassReverseCookiePath work as expected  |
|51168|New|Nor|2011-05-08|mod_status Total Traffic won't take account of int|
|51170|New|Nor|2011-05-09|I/O errors when using keep-alive + mod_ssl        |
|51174|New|Min|2011-05-09|SSLRequire predicates using OIDs unknown to openss|
|51186|New|Blk|2011-05-11|NEw Openssl 1.0.1 with new FIPS                   |
|51190|New|Min|2011-05-12|::/0 does not work with allow from and deny from  |
|51194|New|Nor|2011-05-13|FcgidWrapper does not support paths containing a s|
|51201|Inf|Nor|2011-05-15|Strange behavior REQUEST_METHOD & GET in mod_rewri|
|51223|New|Nor|2011-05-18|304 HTTP Not Modified strips out CORS headers     |
|51224|New|Nor|2011-05-18|mod_dav_fs should respect FileETag                |
|51239|New|Nor|2011-05-21|ap_get_client_block may block continuously sometim|
|51257|New|Nor|2011-05-24|Build failed when cross-compiling: ./gen_test_char|
|51258|New|Enh|2011-05-24|new features for mod_substitute                   |
|51296|New|Enh|2011-05-31|Dynamic engine support using SSLCryptoDevice suppo|
|51297|New|Nor|2011-05-31|Improve error handling during "UNLOCK"            |
|51303|New|Nor|2011-05-31|TraceEnable 500 error                             |
|51312|New|Nor|2011-06-01|mod_filter should support adding to the Vary heade|
|51322|New|Enh|2011-06-04|Prepend and append string to LDAP search parameter|
|51359|Inf|Enh|2011-06-11|Added shebang check for //! so that .js scripts wo|
|51365|New|Nor|2011-06-13|Mod_proxy mangles query string with mod_security  |
|51402|New|Nor|2011-06-21|"ForceLanguagePriority Fallback" not working as im|
|51406|New|Maj|2011-06-21|When listing files in subdirectories, the path is |
|51409|New|Nor|2011-06-21|Sorting options accepted by ls, but ignored       |
|51471|New|Nor|2011-07-04|<DirectoryMatch>ed IndexIgnore doesn't            |
|51479|New|Enh|2011-07-05|[PATCH] AB feature to optionally read in a reusabl|
|51491|New|Nor|2011-07-08|mod_dir breaks POSTs to URLs not ending in /      |
|51495|New|Nor|2011-07-11|mod_substitute cpu and memory limit               |
|51517|New|Maj|2011-07-16|mod_proxy_fcgi is not RFC 3875 compliant (SCRIPT_F|
|51522|Ver|Trv|2011-07-18|Wrong French translation in mpm.html ("Certains Mo|
|51542|New|Nor|2011-07-22|Apache HTTP Server vs PVS-Studio                  |
|51543|New|Nor|2011-07-22|Space in username not properly escaped in log file|
|51552|Inf|Cri|2011-07-25|Apache is not starting (2.2.15)                   |
|51573|New|Enh|2011-07-28|Easy way to erase log files                       |
|51576|Inf|Nor|2011-07-28|mod_rewrite rule stopped working                  |
|51600|New|Enh|2011-08-02|Loading the same certificate in multiple virtual h|
|51603|Inf|Maj|2011-08-02|Apache accepts completely bogus HTTP requests (pos|
|51607|Inf|Nor|2011-08-03|DBDPrepareSQL ( ap_dbd_prepare ) does not work cor|
|51629|New|Nor|2011-08-05|DocumentRoot check incorrect when running under ch|
|51674|New|Blk|2011-08-18|AJP Module Bad Request                            |
|51679|New|Min|2011-08-18|Code signature key expired                        |
|51689|New|Trv|2011-08-19|Cross compiling causes multiple Listen directives |
|51695|New|Trv|2011-08-20|Code clean up (ap_rputs merge)                    |
|51707|New|Nor|2011-08-22|ProxyPassReverse issues within <Location> (differe|
|51709|New|Nor|2011-08-23|ServerName/ServerAlias don't work if Host: header |
|51711|New|Nor|2011-08-23|mod_auth_digest have broken shared mem (nonce) cod|
|51718|New|Enh|2011-08-24|Feature Request: Add shorthand to redirect any Ser|
|51725|New|Nor|2011-08-26|Multiple Range: request accepted as "Range: n-m"  |
|51732|New|Nor|2011-08-29|Inconsistencies in log messages' verbosity levels |
|51747|New|Blk|2011-08-31|mod_fcgid loads entire request into memory while p|
|51757|Inf|Enh|2011-09-02|Add support for SASL auth in LDAP                 |
|51778|Inf|Cri|2011-09-07|while buliding(make) a unix source "httpd-2.2.20.t|
|51797|Inf|Maj|2011-09-10|Crash HTTPD(Windows)                              |
|51814|New|Enh|2011-09-14|mod_proxy in Apache HTTP 2.2 FIN_WAIT2 in server s|
|51858|Inf|Nor|2011-09-21|weird error for mod_rewrite with more then 3 param|
|51864|New|Nor|2011-09-22|mod_cache returns entire entity from origin server|
|51904|New|Nor|2011-09-28|output to stderr from cgi script causes script to |
|51951|New|Nor|2011-10-04|mod_mbox hang on some e-mails on press@a.o - was I|
|51964|Ver|Nor|2011-10-05|Documentation of RewriteRule flag skip unclear    |
|51965|New|Nor|2011-10-05|--with-z=DIR not being honored                    |
|51982|Opn|Nor|2011-10-06|ProxyPassReverse / balancer://cluster/ adds slash |
|51987|Inf|Nor|2011-10-07|RewriteRule doesn't work correctly with apache 2.3|
|51994|New|Enh|2011-10-07|Mod_authn_socache should have some way to flush th|
|52004|Ver|Trv|2011-10-10|Typo "indexe" in French translation of mpm.html   |
|52007|New|Nor|2011-10-10|Content-Length: 0 not set on proxy response       |
|52038|New|Nor|2011-10-16|NameWidth works incorrectly together with Charset=|
|52039|Inf|Nor|2011-10-16|Browser mode does not always work                 |
|52043|New|Nor|2011-10-17|Directories ".", "..", and "/" do not work correct|
|52081|New|Nor|2011-10-24|segfault if mbox files have unexpected names      |
|52090|New|Maj|2011-10-26|Apache thread hangs with error 500 when sending a |
|52120|Opn|Nor|2011-11-01|mod_cache edge case: uncacheable 304 sends cached |
|52123|New|Maj|2011-11-02|DoS: High memory usage in propfind                |
|52132|New|Nor|2011-11-03|[PATCH] process activity score calculated incorrec|
|52139|New|Nor|2011-11-05|Never Syntax Error on non-existent DocumentRoot   |
|52171|Ver|Nor|2011-11-13|confusing documentation of request phases         |
|52174|New|Enh|2011-11-13|Allow hard lower-limits on the number of fcgi serv|
|52178|New|Nor|2011-11-14|IPv6 IPs as ServerName not allowed                |
|52181|Ver|Nor|2011-11-14|mod_rewrite Technical Details Ruleset Processing d|
|52195|Inf|Nor|2011-11-16|Japanese texts are garbled on mailing list archive|
|52196|Inf|Nor|2011-11-16|winnt mpm, others mpm also have this bug. pool sha|
|52207|Inf|Maj|2011-11-18|Upgrade apache version from 2.0.59 to 2.2.12 or ab|
|52222|New|Nor|2011-11-21|IndexIgnore ignores parent directories in argument|
|52247|New|Nor|2011-11-26|mod_mbox gives up on unexpected message format    |
|52248|New|Nor|2011-11-26|Bugzilla version drop-down list does not offer "un|
|52252|New|Nor|2011-11-27|luajit support broken for (at least) luajit 2.0   |
|52253|Inf|Nor|2011-11-28|Timeout doesn't work. mod_proxy_balancer strongly |
|52264|New|Enh|2011-11-30|Update and complete balancer-manager XML output   |
|52269|Inf|Nor|2011-12-01|[mod_proxy] Apache reverse proxy status code trans|
|52275|New|Nor|2011-12-02|memory leak in proxy_ajp_handler                  |
|52298|Inf|Nor|2011-12-07|Can't enter website with client certificate on an |
|52301|New|Enh|2011-12-07|Error message "RSA server certificate ... CN ... d|
|52302|New|Enh|2011-12-07|Better documentation of how server name is determi|
|52304|New|Nor|2011-12-08|<Limit> Does Not Apply When URI Is Folder         |
|52313|New|Enh|2011-12-09|htdbm enhancement: options for colon-in-username, |
|52322|Inf|Enh|2011-12-13|Providing BBC developed httpd modules for inclusio|
|52342|New|Nor|2011-12-15|ap_internal_redirect dropping filters means incons|
|52370|New|Nor|2011-12-19|apreq_decode/url_decode length miscalculation     |
|52377|New|Enh|2011-12-20|Add Directives to assert user, group, and permissi|
|52383|New|Trv|2011-12-24|Instllation log typo                              |
|52391|New|Cri|2011-12-27|100% CPU usage while using Forward Proxy          |
|52395|New|Nor|2011-12-29|reload results in different end environment to res|
|52403|New|Nor|2011-12-31|FallbackResource doesn't work for non-existent PHP|
|52408|New|Nor|2012-01-01|Directoryindex matching automatically redirects   |
|52415|New|Nor|2012-01-03|LockFile placed inappropriately                   |
|52417|New|Nor|2012-01-03|HEADERS information in the file                   |
|52435|New|Nor|2012-01-06|Apache shutdown automatically                     |
|52439|New|Enh|2012-01-09|It should be possible to treat errors in .htaccess|
|52453|New|Enh|2012-01-11|Ability to configure --logfiledir                 |
|52465|New|Nor|2012-01-13|mod_dir is allowed to redirect proxy requests     |
|52481|New|Nor|2012-01-18|Rotatelog.exe crashes Apache after setting 256MB r|
|52485|New|Nor|2012-01-19|CPU load 100%                                     |
|52494|New|Enh|2012-01-22|allow the Action directive to point in the filesys|
|52495|New|Enh|2012-01-22|CACertificate, CADNCertificate, CARevocation, Cert|
|52501|New|Cri|2012-01-23|child pid 10824 exit signal Segmentation fault (11|
|52505|New|Nor|2012-01-23|Include with directory wildcards gives errors for |
|52509|New|Nor|2012-01-23|Resources protected by .htaccess file may not be a|
|52510|New|Cri|2012-01-23|Segmentation Fault 11                             |
|52520|New|Nor|2012-01-24|ProxyRemote & NoProxy directive can not take IPv6 |
|52532|New|Trv|2012-01-26|VirtualHost added TWICE to name-virtual-host list |
|52539|New|Nor|2012-01-26|Apache mod_dav 400 Bad Request for non-existent co|
|52546|New|Nor|2012-01-27|overwrite SERVER_PROTOCOL environment             |
|52573|New|Nor|2012-02-01|mod_speling case correction fails when URI has dou|
|52578|Opn|Enh|2012-02-02|Wrong "bytes sent" logged when connection is close|
|52594|New|Nor|2012-02-03|rpmbuild -ba errors out with "File not found by gl|
|52595|New|Nor|2012-02-03|requests with gzip+chunked encoded body don't prox|
|52605|Inf|Min|2012-02-05|Please allow request lines longer than 8k         |
|52612|New|Nor|2012-02-06|Default Service Account                           |
|52616|Opn|Enh|2012-02-07|SSLUserName uses SSL_CLIENT_S_DN insted of SSL_CLI|
|52617|New|Maj|2012-02-07|Visit the rewrite page from ServerAlias domain vho|
|52623|New|Nor|2012-02-08|does not build with pcre-8.30                     |
|52644|New|Nor|2012-02-12|document how SSL FakeBasicAuth works with strange |
|52668|New|Trv|2012-02-14|More future safe patch for old MSIE ssl-unclean-sh|
|52670|New|Trv|2012-02-15|please clarify the effect of SSLStrictSNIVHostChec|
|52683|New|Enh|2012-02-16|add a symlink option that rechecks the access perm|
|52700|Inf|Blk|2012-02-17|Not rendering html content instead displaying clie|
|52703|Inf|Maj|2012-02-18|SSL+SNI+client-auth "lost" after some time        |
|52710|New|Nor|2012-02-19|mod_fcgid should set PATH_INFO when configured in |
|52756|Inf|Trv|2012-02-24|proxy_html_module LoadModule line not created in h|
|52759|New|Cri|2012-02-24|Apache httpd child process consuming high CPU Util|
|52790|New|Nor|2012-02-28|ldap caching not sufficient                       |
|52795|Opn|Nor|2012-02-29|mod_fcgid fails to spawn process in C:\Program Fil|
|52806|New|Nor|2012-03-01|configure: --with-included-apr is not supported in|
|52807|New|Nor|2012-03-01|some random strings are accepted by "configure" as|
|52816|New|Nor|2012-03-03|Potential segfault in socache_shmcb_create        |
|52817|New|Nor|2012-03-03|Long directory path sucks (but it's really a valid|
|52822|New|Nor|2012-03-04|Quiet installation not fully quiet                |
|52824|Inf|Nor|2012-03-04|Conflicts between AllowOverride and AllowOverrideL|
|52828|New|Maj|2012-03-05|Child process is not replaced in Windows, after a |
|52832|New|Nor|2012-03-05|numerical configuration entry can be mistakenly in|
|52841|Opn|Nor|2012-03-06|[proxy_balancer:emerg] [pid 25593] AH01177: Failed|
|52851|New|Nor|2012-03-07|Core TimeOut directive doesn't work               |
|52860|New|Enh|2012-03-08|Support Transfer-Encoding: gzip                   |
|52865|New|Nor|2012-03-09|Crash by segmentation fault in mod_authn_core in A|
|52870|New|Cri|2012-03-09|100% CPU usage while using Forward Proxy          |
|52874|New|Enh|2012-03-09|Support Use TrustedFirst checking when verifying c|
|52884|New|Nor|2012-03-12|"localhost" leads to start failure                |
|52890|Inf|Nor|2012-03-12|--with-included-apr doesn't work when srclib/apr a|
|52891|New|Nor|2012-03-12|2.2 doesn't perform as well as 1.3                |
|52894|Inf|Nor|2012-03-13|Apache aborts abnormally when ChrootDir is set    |
|52927|Inf|Nor|2012-03-16|[Bug in httpd 2.2.4] [error] (70014)End of file fo|
|52933|New|Nor|2012-03-17|Child survives '-k stop', consuming lots of CPU   |
|52950|New|Nor|2012-03-20|Error when set AuthType to None with valid-user   |
|52963|New|Nor|2012-03-21|Typo in AuthLDAPURL RFC 2255 error message        |
|52975|New|Nor|2012-03-23|Receiving files is suboptimal                     |
|52976|New|Min|2012-03-23|Gratuitous string-duplication in module-configurat|
|52978|New|Enh|2012-03-23|Binding to an interface instead of an address     |
|52995|New|Nor|2012-03-28|httpd -V does not print the default Mutex         |
|53002|New|Nor|2012-03-29|<Location> and auth_form (trailing slash problem?)|
|53015|New|Nor|2012-03-31|missing apr_socket_close                          |
|53016|New|Nor|2012-03-31|missing apr_brigade_destroy                       |
|53023|New|Nor|2012-04-02|mod_rewrite RewriteCond parser error and documenta|
|53037|New|Enh|2012-04-05|clarify mod_ssl documentation on the UID/GID conte|
|53059|New|Nor|2012-04-10|Make httpd easier relocatable by using a variable |
|53098|New|Nor|2012-04-18|mod_proxy_ajp: patch to set worker secret passed t|
|53099|New|Enh|2012-04-18|feature request for mod_remoteip                  |
|53108|New|Enh|2012-04-19|clarification on url-path vs full filesystem path |
|53111|New|Nor|2012-04-20|1% of CMS sites expose database passwords         |
|53121|New|Nor|2012-04-22|Confusing documentation, gzip and deflate         |
|53149|New|Enh|2012-04-25|mod_ldap should/could use mod_socache             |
|53152|Opn|Nor|2012-04-26|RewriteRule documentation: Error about per-directo|
|53156|New|Enh|2012-04-27|CRL validation fails if CRL is missing            |
|53160|New|Cri|2012-04-29|Reverse Proxy mod_deflate doesn't zip back content|
|53183|New|Min|2012-05-03|mod_apreq2 entry point is apreq_module and not apr|
|53193|New|Nor|2012-05-04|SLVerifyClient optional_no_ca + SSLSessionCache = |
|53218|New|Blk|2012-05-11|ProxyPass worker name　(http://localhost:3128/...|
|53233|New|Maj|2012-05-15|Internal error: proxy: error reading status line f|
|53239|New|Maj|2012-05-16|Httpd has problems delivering data on rate-limited|
|53253|New|Maj|2012-05-17|TCP_NOPUSH used with sendfile(2), cause transfers |
|53284|New|Nor|2012-05-24|crash                                             |
|53290|New|Maj|2012-05-24|memory usage                                      |
|53292|New|Min|2012-05-25|add support for HTTP status code 308              |
|53305|New|Nor|2012-05-28|404 errors when adding query string in a balancer |
|53313|New|Nor|2012-05-28|SSI #echo VAR fails (#include OK) if URI/URL has f|
|53319|New|Nor|2012-05-29|Multiple DirectoryIndex statements in the same con|
|53332|New|Nor|2012-05-30|Requests with chunked encoding have no body availa|
|53350|New|Nor|2012-06-01|mod_cache caching 403 responses Apahce 2.2.22     |
|53351|New|Nor|2012-06-02|make fails if layout begins on first line of confi|
|53388|Opn|Nor|2012-06-08|mod_proxy_balanser generates 503 when proxying to |
|53402|New|Trv|2012-06-12|Incorrect error message for mod_ldap params       |
|53461|Inf|Cri|2012-06-23|Compilation problems                              |
|53462|New|Nor|2012-06-25|mod_rewrite does not remove trailing slash when as|
|53479|New|Nor|2012-06-27|mod_rewrite [B] flag should percent-encode the spa|
|53483|New|Enh|2012-06-29|dangerous PCRE patterns in *Match directives      |
|53539|New|Maj|2012-07-12|content type and character set are changing when t|
|53554|New|Nor|2012-07-16|Wrong case for hexadecimal percent encoding [patch|
|53555|New|Maj|2012-07-17|Scoreboard full error with event/ssl              |
|53579|New|Cri|2012-07-20|httpd looping writing on a pipe and unresponsive (|
|53581|New|Blk|2012-07-21|FollowSymlinks doesn't work with DirectoryMatch an|
|53594|New|Enh|2012-07-24|ipad as webserver                                 |
|53595|New|Nor|2012-07-24|Media type qs parameters for MultiViews sent in Co|
|53612|Inf|Nor|2012-07-27|Reverse Proxy causing 500 error SSL proxy 1.0.1c O|
|53618|New|Nor|2012-07-29|proxy_worker_shared fields not maintained in threa|
|53634|New|Nor|2012-08-01|mod_cache returning HTTP 200 for nonexistent resou|
|53638|New|Nor|2012-08-02|Problem with shortcuts to bugzilla in http://httpd|
|53640|Inf|Maj|2012-08-02|make: Fatal error: Command failed for target `htpa|
|53643|New|Cri|2012-08-02|apache segfaults with mod_authn_dbd when dbd_min i|
|53646|New|Nor|2012-08-02|Invalid uniformly distributed balancing of request|
|53651|New|Nor|2012-08-03|Worker failure doesn't have same behaviour as work|
|53667|New|Enh|2012-08-07|Add an equivalent option to "JkOptions ForwardLoca|
|53669|New|Nor|2012-08-07|IndexOptions Incremental IndexOptions documentatio|
|53686|New|Enh|2012-08-09|Status "501 Not Implemented" sent very late       |
|53690|New|Nor|2012-08-09|Calls to semctl() trigger "uninitialized memory" w|
|53692|New|Nor|2012-08-10|mod_auth_form loses request body before login page|
|53693|Opn|Nor|2012-08-10|mod_fcgid performance suffers under increase in re|
|53704|New|Enh|2012-08-13|True online configuration is needed - via LDAP?   |
|53705|New|Nor|2012-08-13|Align server-status balancer display to balancer-m|
|53706|New|Enh|2012-08-13|Include a status display for mod_ldap when present|
|53722|New|Nor|2012-08-15|when -D NO_DETACH is used, no PID file should be c|
|53736|New|Nor|2012-08-17|/balancer-manager doesn't save runtime adjusted se|
|53757|New|Enh|2012-08-21|RewriteMap of type txt should allow specifying col|
|53767|New|Nor|2012-08-23|htcacheclean deletes stale "vary" header files eve|
|53772|New|Nor|2012-08-24|REDIRECT_URL not accessible in mod_proxy          |
|53787|New|Reg|2012-08-28|In forward proxy, doesn't cache disk anymore      |
|53823|New|Nor|2012-09-03|[patch] pure IPv6 only host fix (server/config.c) |
|53835|New|Cri|2012-09-06|mod_proxy_ajp truncate output when using deflate i|
|53870|New|Maj|2012-09-13|Deadlock in CRYPTO_add_lock with Apache 2.2.22 wor|
|53886|New|Nor|2012-09-18|can't start apache control in Redhat Linux 3 X64  |
|53899|New|Nor|2012-09-19|SSL_OP_ALL disables the mitigation code for CVE-20|
|53915|New|Nor|2012-09-21|Colon lost when :port is used in CacheKeyBaseURL  |
|53919|Inf|Enh|2012-09-21|DEFAULT_LOG_FORMAT is not RFC6302 compliant       |
|53923|New|Min|2012-09-23|Overriding CustomLog directive seems impossible   |
|53932|New|Nor|2012-09-25|PROPFIND doesn't support If, If-Match ETag predica|
|53947|New|Enh|2012-09-29|Feature Request, RewriteRule - ProxyPreserveHost f|
|53961|New|Nor|2012-10-04|Null sessions to the default vhost                |
|53970|New|Nor|2012-10-05|Network control directives affects internal subreq|
|53981|New|Nor|2012-10-08|move def of log_request_state from mod_log_config.|
|53988|New|Enh|2012-10-10|Missing FCGIWrapper script should not be a critica|
|53999|Opn|Nor|2012-10-13|Deadlock between procmgr_send_spawn_cmd()/proctabl|
|54030|New|Enh|2012-10-19|Support subjectAltName when (reverse-)proxying    |
|54033|New|Enh|2012-10-21|Parent languages are not ordered according to Acce|
|54072|New|Reg|2012-10-30|Syntax error front-end virtual-path too long      |
|54102|New|Enh|2012-11-05|new feature: automatic route detection            |
|54118|New|Nor|2012-11-08|Handle leak on parent httpd process when rotatelog|
|54126|New|Maj|2012-11-09|Mod_rewrite failing because of url in query string|
|54134|New|Enh|2012-11-11|new feature: ability to use multiple routes in sti|
|54136|New|Min|2012-11-11|balancer-handler shows xml not, when only xml para|
|54158|New|Nor|2012-11-16|Suggestion regarding 2.0 to 2.2 Upgrade Documentat|
|54183|Inf|Nor|2012-11-21|PROPFIND doesn't report getcontenttype property   |
|54215|New|Maj|2012-11-27|configure fails for httpd 2.2.3 with openssl 1.0.1|
|54221|Opn|Nor|2012-11-28|no ErrorLog prefix on CGI errors                  |
|54222|New|Min|2012-11-28|ServerTokens checking is not complete             |
|54223|New|Nor|2012-11-29|AH00554 error when runtime configuration Includes |
|54252|New|Nor|2012-12-05|acinclude.m4 requires -lz when linking with ssl st|
|54253|New|Nor|2012-12-05|mod_proxy_ftp doesn't handle/log partial or cancel|
|54255|New|Nor|2012-12-06|mod_deflate adjusts the headers "too late", should|
|54269|New|Maj|2012-12-09|mod_proxy_html documentation misses several things|
|54276|New|Nor|2012-12-10|rotatelogs not getting killed on graceful restart |
|54280|New|Nor|2012-12-11|mod_auth_form inline login not working with traili|
|54281|New|Nor|2012-12-11|Stick use Partial parameters from query string    |
|54289|New|Nor|2012-12-13|"ap_get_brigade" api is failing in "AP_MODE_SPECUL|
|54306|New|Enh|2012-12-15|add regexp versions of ProxyPassReverse, ProxyPass|
|54309|New|Trv|2012-12-15|clarification on the <Location> directive when use|
|54310|Opn|Nor|2012-12-15|mod_proxy_html drops meta elements with http-equiv|
|54319|New|Reg|2012-12-17|ProxyPass has no effect in <Location> if rewrite o|
|54339|New|Nor|2012-12-21|piped log entries > PIPE_BUF can be interleaved   |
|54342|New|Nor|2012-12-22|AuthnCacheSOCache can't pass args to socache provi|
|54343|New|Maj|2012-12-22|Add sanity checks for malloc() in mpm_winnt.c and |
|54358|New|Nor|2012-12-29|Status 500 when using ldap on Solaris because apr_|
|54363|New|Nor|2012-12-31|make time conversion caching functions thread-safe|
|54364|New|Nor|2012-12-31|Add ref to mod_fcgid docs                         |
|54365|New|Nor|2013-01-02|Connection closed by server during file transfer  |
|54366|New|Nor|2013-01-02|$sysconfdir/extra/httpd-dav.conf is not built base|
|54367|Opn|Maj|2013-01-02|Location header in response to PUT is not %-escape|
|54385|New|Enh|2013-01-08|SSL configuration independent from virtual hosts, |
|54401|New|Nor|2013-01-10|Suggest to make ProxyPassReverseCookieDomain accep|
|54415|New|Enh|2013-01-14|Please tell the root cause of mutex and scoreboard|
|54431|Inf|Blk|2013-01-16|Unable to start the Apache 2.4.3 windows service. |
|54498|New|Nor|2013-01-28|apache crash on any cgi request with certain http |
|54502|New|Nor|2013-01-29|Apache deadlock on epoll_ctl error (1000 process l|
|54512|Inf|Cri|2013-01-31|Apache hung                                       |
|54517|New|Nor|2013-02-01|proxy balancer: timeout or partial failure of back|
|54518|New|Nor|2013-02-01|mod_rewrite not adding Vary header                |
|54519|New|Nor|2013-02-02|httpd already running                             |
|54526|New|Nor|2013-02-05|mod_proxy_http ignores request abortion           |
|54543|New|Enh|2013-02-10|Compile regex only when need                      |
|54546|New|Nor|2013-02-11|httpd crashes on first HUP after change Listen dir|
|54549|New|Nor|2013-02-11|mod_mime AddEncoding and mod_negotiation fix_encod|
|54556|New|Enh|2013-02-13|New flag to add default rule in rule chain        |
|54560|New|Nor|2013-02-13|Potential segfault on return from ap_server_root_r|
|54563|New|Maj|2013-02-15|mod_webdav ignores quota                          |
|54578|New|Nor|2013-02-18|Bad docs or unchecked code for "LimitRequestFields|
|54605|New|Enh|2013-02-24|mod_negotiation should cache the info it generates|
|54608|New|Enh|2013-02-25|Support an option to allow page caching when using|
|54622|New|Nor|2013-02-28|shared memory cleanup                             |
|54626|New|Nor|2013-03-01|mod_authnz_ldap through util_ldap.c does not suppo|
|54633|New|Nor|2013-03-04|Invalid % encoding not rejected                   |
|54637|New|Nor|2013-03-05|Digest: secret not used                           |
|54640|New|Nor|2013-03-05|Slow transaction on a balance member is holding su|
|54649|New|Nor|2013-03-06|Incorrect PIDFILE prevent httpd restart           |
|54653|New|Min|2013-03-08|Suggestion to add https example for forward proxy |
|54656|New|Maj|2013-03-09|SNI and SSLProxyCheckPeerCN based on "connection" |
|54657|New|Nor|2013-03-09|DNS lookup failure for load balancer member does n|
|54683|New|Min|2013-03-13|Ignor directive ErrorDocument with null byte      |
|54699|Opn|Enh|2013-03-15|[feature request] cli webaccess tester            |
|54701|New|Cri|2013-03-15|Apache 2.4.3 Migration Issue Not loading the pages|
|54704|New|Nor|2013-03-15|Web Services stalling on it's own                 |
|54719|New|Nor|2013-03-18|httpd should check for and eventually create pid f|
|54752|New|Nor|2013-03-25|mod_ssl should not use uninitialized memory as ran|
|54782|New|Nor|2013-04-02|Memory Corruption errors - mpm_worker mod_perl    |
|54785|New|Nor|2013-04-02|Random crash when httpd server is stopped         |
|54793|New|Nor|2013-04-03|Socket timeout handler can delete uploaded files P|
|54794|New|Reg|2013-04-03|mod_wsgi|fcgid and subversion >= 1.7 issues       |
|54795|New|Nor|2013-04-03|'apxs -g -n' should be self-referring             |
|54796|Inf|Enh|2013-04-03|CustomLog should be able to use syslog as ErrorLog|
|54804|New|Nor|2013-04-05|mod_fcgid sends a Continue 100 response automatica|
|54813|New|Nor|2013-04-08|documnt the Require args used by authz_dbm includi|
|54816|Inf|Nor|2013-04-08|AH00566: request failed: invalid characters in URI|
|54817|New|Nor|2013-04-09|if prefix and sysconfdir are the same then http.co|
|54820|Inf|Cri|2013-04-09|REwriterule stops working                         |
|54824|New|Nor|2013-04-10|Spec file is missing libuuid-devel requirement    |
|54830|New|Enh|2013-04-11|Make SSLPProxyMachineCertificateFile configurable |
|54848|New|Nor|2013-04-15|Client field too short for IPv6 addresses         |
|54856|Inf|Enh|2013-04-17|NSCreateObjectFileImageFromFile                   |
|54858|New|Nor|2013-04-17|ld duplicate                                      |
|54861|New|Blk|2013-04-18|The number of connections with mysql is more      |
|54869|Inf|Nor|2013-04-19|Non-breaking space characters cause httpd to choke|
|54875|New|Nor|2013-04-23|Conditional request predicated on another URL's ET|
|54878|New|Nor|2013-04-23|Multiple Listen directives prevent server to start|
|54905|Inf|Cri|2013-04-29|Apache2 loops in child Segfaults                  |
|54910|New|Enh|2013-04-30|Format %{Foobar}o cannot be used to log Date and S|
|54911|New|Enh|2013-04-30|Allow logging of fields set by a backend server in|
|54914|New|Nor|2013-04-30|mod_dir DirectoryIndex breaks WebDAV PROPFIND / DE|
|54915|New|Nor|2013-04-30|GET on a WebDAV-enabled collection, with Directory|
|54918|New|Enh|2013-05-02|Implement RFC 6797 HTTP Strict Transport Security |
|54919|Inf|Nor|2013-05-02|*** glibc detected *** /usr/sbin/httpd: double fre|
|54930|New|Nor|2013-05-06|Allow empty message in ErrorDocument directive    |
|54934|Inf|Cri|2013-05-07|Apache is crashing intermittently with a message "|
|54936|New|Nor|2013-05-08|Some potential bugs reported by static analysis to|
|54949|New|Nor|2013-05-10|[PATCH] mod_cache: fix uninitialized tmppath varia|
|54952|Inf|Cri|2013-05-10|[Fri May 10 17:39:01 2013] [error] proxy: CLUSTER:|
|54953|New|Nor|2013-05-11|<VirtualHost 0.0.0.0:80> matches IPv6             |
|54958|New|Nor|2013-05-13|mod_deflate + mod_mime with SSI gives mixed compre|
|54962|New|Maj|2013-05-14|Apache will set incorrect Content-Length header an|
|54965|New|Enh|2013-05-14|Allow ProxyPassMatch in Directory context         |
|54976|New|Nor|2013-05-15|ProxyPass parameter "acquire" and "ttl" ignored in|
|54986|New|Maj|2013-05-16|httpd hanging on large form submit in ap_run_handl|
|54989|New|Nor|2013-05-17|Apache Segfaults on OS X at random - how can I dia|
|54993|New|Nor|2013-05-20|Critical error: File descriptor in bad state: apr_|
|54998|Ver|Nor|2013-05-21|Apache 2.4 terminates all SSL connections using an|
|55000|New|Nor|2013-05-21|Memory usage per process doubles when Apache is co|
|55021|New|Enh|2013-05-28|Support arbitrary sql to authentication username/p|
|55022|Inf|Cri|2013-05-28|child pid 3123 exit signal Bus error (10) - Apache|
|55034|Inf|Maj|2013-05-31|Apache 2.4.4 won't open more that 32k VH file hand|
|55039|New|Enh|2013-05-31|"RequestHeader edit" can't access environment vari|
|55045|New|Nor|2013-06-01|calls to gets() in test_find.c and test_parser.c  |
|55068|New|Enh|2013-06-06|root permissions when writing to per vhosts errorl|
|55069|New|Min|2013-06-06|notice message in error_log even when LogLevel err|
|55070|Opn|Enh|2013-06-06|mod_fcgid stderr always goes to main error log    |
|55072|New|Nor|2013-06-07|ErrorLog doesn't work well when apache shutdown   |
|55093|New|Nor|2013-06-12|[PATCH] mod_fcgid 2.3.7 truncates large posts on R|
|55096|New|Nor|2013-06-12|Make not running on httpd configure Solaris       |
|55098|New|Nor|2013-06-13|does not listen to IP4 when both IP4 address and I|
|55106|New|Enh|2013-06-17|ProxyErrorOverride considers response codes >= 400|
|55117|New|Nor|2013-06-18|GracefullTimeout for worker threads               |
|55148|Inf|Nor|2013-06-26|Error during SSL Handshake with remote server     |
|55152|New|Nor|2013-06-28|graceful restart adjusts to new balancer members, |
|55156|New|Nor|2013-06-28|mod_cache not respecting s-maxage cache-control he|
|55178|New|Nor|2013-07-01|[PATCH] mod_authnz_ldap SASL authentication suppor|
|55192|New|Trv|2013-07-03|htaccess error messages missing request context   |
|55193|New|Min|2013-07-03|ErrorLogFormat is ignored by some modules         |
|55226|New|Enh|2013-07-09|Request for "domain cluster" feature for mod_proxy|
|55234|New|Maj|2013-07-10|Working of attribute "protocol" attribute "protoco|
|55276|Inf|Enh|2013-07-17|Add REST API for load balancer for dynamic registr|
|55278|New|Nor|2013-07-18|mod_session's cookie may be empty, is repeated twi|
|55284|New|Nor|2013-07-20|repeatable segv                                   |
|55286|New|Nor|2013-07-21|Floating point exception (8) in mod_auth_digest   |
|55293|New|Nor|2013-07-22|Incorrect default MIME type for .woff fonts       |
|55306|New|Nor|2013-07-25|Error when copying svn repository, which contains |
|55323|New|Nor|2013-07-29|Double unescaped uri in sub request handler       |
|55327|New|Nor|2013-07-30|Segmentation fault when stopping Apache 2.4.6 norm|
|55340|New|Maj|2013-08-01|Listen for valid, unconfigured IP address passes c|
|55344|New|Nor|2013-08-02|missing ap_hook_monitor on windows                |
|55346|New|Nor|2013-08-02|When on filled quota filesystem, mod_fcgid init in|
|55348|New|Nor|2013-08-02|%h is not changed in logging, only %a             |
|55351|New|Enh|2013-08-04|allow ProxyPassReverseCookieDomain to automaticall|
|55362|New|Nor|2013-08-05|Apache httpd sends "400 Bad Request" to client due|
|55379|New|Min|2013-08-07|htdigest -c doesn't behave as described anymore   |
|55394|New|Nor|2013-08-09|apache 2.4 randomy crashes with signal 6          |
|55401|New|Enh|2013-08-11|document that force-proxy-request-1.0 implies prox|
|55415|New|Maj|2013-08-14|Proxy loop caused by ProxyErrorOverride and ErrorD|
|55431|New|Nor|2013-08-16|mod_negotation does not force the mime type listed|
|55433|New|Nor|2013-08-16|mod_proxy ignores final status code for aborted re|
|55443|Inf|Maj|2013-08-17|never gives 300 multiple choices                  |
|55445|New|Maj|2013-08-18|mod_socache_memcache ignores expiry, creating eter|
|55447|New|Enh|2013-08-18|make type-maps usable again, by making them access|
|55448|New|Nor|2013-08-19|segfault in set_max_workers at event.c:3194 on SIG|
|55449|New|Maj|2013-08-19|AH01185: worker slotmem_create failed --> slotmem |
|55452|New|Maj|2013-08-19|Redirect                                          |
|55458|New|Enh|2013-08-20|allow to configure what mod_ssl responds when one |
|55460|New|Enh|2013-08-21|allow service names to be used in the Listen direc|
|55467|New|Nor|2013-08-21|Support for OpenSSL custom TLS extensions and supp|
|55523|New|Trv|2013-09-04|auth_groupfile error log on access even though suc|
|55535|Inf|Nor|2013-09-08|incorrect check state parametr                    |
|55540|New|Cri|2013-09-09|mod_proxy gzip chunked issue (sample site provided|
|55549|New|Min|2013-09-11|AuthLDAPSubGroupAttribute doesn't do anything     |
|55550|New|Nor|2013-09-11|AuthLDAPSubGroupClass checking is very inefficient|
|55556|New|Nor|2013-09-13|apachebench (ab) doesn't use so_reuseaddr         |
|55557|New|Nor|2013-09-14|Some cppcheck reports                             |
|55573|New|Enh|2013-09-19|FileETag needs MTimeSeconds, MTime with granularit|
|55581|New|Enh|2013-09-22|Support concurrent connections to same FastCGI pro|
|55590|Inf|Maj|2013-09-24|second commit is failing if space is in file name |
|55596|New|Enh|2013-09-25|Add date format used by Expires header            |
|55607|New|Enh|2013-09-28|Re-set HOME environment variable to directory from|
|55615|New|Nor|2013-09-30|Connections are starved and not balanced when conc|
|55619|New|Nor|2013-10-02|Apache httpd reported 500 internal error when uplo|
|55627|New|Min|2013-10-04|Remove unnecessary APLOGNO() for trace logging per|
|55636|Inf|Cri|2013-10-07|long lost child came home - Apache is not respondi|
|55646|Inf|Nor|2013-10-10|non-2xx responses are not considered errors       |
|55654|New|Nor|2013-10-15|Extract variables from configuration without start|
|55670|New|Min|2013-10-18|Startup may fail silently at post_config          |
|55673|New|Nor|2013-10-18|httpd fails to start with SSLProxyMachineCertifica|
|55680|New|Enh|2013-10-20|online manual directory option doesn't exist      |
|55698|New|Maj|2013-10-24|Apache 2.2 + mod_fcgid 2.3.7 (CentOS 6.4) graceful|
|55700|New|Enh|2013-10-24|add something like RewriteOptions InheritDown     |
|55707|New|Nor|2013-10-25|SSLProtocol directive seem to be ignored over diff|
|55708|New|Nor|2013-10-25|Access violation in msvcrt.dll when calling getenv|
|55711|New|Min|2013-10-28|--enable-foo doesn't enable foo                   |
|55712|New|Nor|2013-10-28|Relative <!--#include virtual="../file.shtml"--> g|
|55720|New|Enh|2013-10-29|separate LDAP Bind timeout from LDAPTimeout       |
|55738|New|Nor|2013-11-03|PVS-Studio: few issues                            |
|55763|New|Nor|2013-11-09|raise roots soft RLIMIT_NPROC on linux for high ma|
|55774|New|Nor|2013-11-13|ab: optionally accept tls client certificate      |
|55781|New|Nor|2013-11-15|ajp_read_header: ajp_ilink_receive failed; 120006)|
|55786|New|Maj|2013-11-16|SSLVerifyClient and OptRenegotiate result in a 403|
|55787|New|Maj|2013-11-16|Chroot fails with "Cannot chroot when not started |
|55790|New|Maj|2013-11-17|mod_fcgid lockfile hardcoded to be in /tmp        |
|55793|New|Enh|2013-11-18|DTrace/SystemTap support                          |
|55808|New|Nor|2013-11-21|File integrity verification using MD5 and SHA1    |
|55819|Inf|Nor|2013-11-27|Closing connection behaviour                      |
|55828|New|Cri|2013-11-28|Httpd not start if use ProxyPass balancer://      |
|55834|New|Maj|2013-12-02|Apache does not honor the openssl library path giv|
|55838|New|Nor|2013-12-03|PHP files are being executed instead of downloaded|
|55841|New|Nor|2013-12-04|Misleading news items on bugfix releases ("This ve|
|55856|New|Nor|2013-12-08|YYEMPTY (-2) used as index into yytname (const arr|
|55866|New|Nor|2013-12-11|When ProxyPreserveHost is on, SSL expects the wron|
|55878|New|Nor|2013-12-12|mod_fcgid kills spawned processes too early       |
|55881|New|Nor|2013-12-13|segmentation fault at proxy_util.c:1546           |
|55883|New|Enh|2013-12-14|string callers of ap_expr should be able to transf|
|55887|New|Maj|2013-12-16|In Windows apache, when user access to /con, apach|
|55898|New|Enh|2013-12-17|[RFE] listen on unix socket?                      |
|55914|New|Reg|2013-12-20|child exit segmentation fault after apache gracefu|
|55919|New|Nor|2013-12-22|EPREFIX and dynamic modules                       |
|55942|New|Nor|2014-01-01|400 - Bad Request on POST (Windows Server 2012 Hyp|
|55952|New|Nor|2014-01-05|ab: SSL keep-alive fails with apr_pollset_poll: Th|
|55962|New|Enh|2014-01-06|mod_remoteip should not allow an external proxy to|
|55963|New|Nor|2014-01-07|Add application/ld+json to mime.types             |
|55981|Opn|Nor|2014-01-09|mod_mbox hang on some e-mails on user@openoffice.a|
|55985|Opn|Nor|2014-01-10|apache does not reopen logs when multiple graceful|
|55989|Opn|Enh|2014-01-11|write to error log upon RewriteRule [F]orbidden   |
|55991|New|Nor|2014-01-12|mod_charset_lite doesn't bail out on non-identity |
|56009|Inf|Cri|2014-01-14|Memory leak in httpd 2.4.3 over time with persista|
|56014|New|Nor|2014-01-15|MOd rewrite CO Cookie method the lifetime flag not|
|56028|New|Enh|2014-01-17|Add http/1.0, http/1.1 NPN advertisement to enable|
|56034|New|Nor|2014-01-20|CPU consumption due to circular linked list in ap_|
|56040|New|Enh|2014-01-21|should be able to remove Max-Age cookie parameter |
|56041|New|Enh|2014-01-21|should be able to disable session expiry increment|
|56052|New|Nor|2014-01-22|ap_session_load called multiple times for expired |
|56055|New|Nor|2014-01-23|Route is not extracted properly when a session coo|
|56064|New|Enh|2014-01-25|Optimize PNGs                                     |
|56067|New|Nor|2014-01-27|FallbackResource doesn't work if directory exists |
|56081|New|Maj|2014-01-28|Apache 2.2.26 SIGSEGVs when POST'ing data         |
|56091|Inf|Nor|2014-01-30|SSL handshake error when httpd compiled on Oracle |
|56098|New|Nor|2014-02-01|duplicate cookie                                  |
|56101|New|Cri|2014-02-03|Apache 2.4.6 ceases processing requests (scoreboar|
|56102|New|Nor|2014-02-03|SSL_CLIENT_S_DN_x509_0 is undefined in the environ|
|56109|New|Nor|2014-02-05|Cannot increase the read limit                    |
|56113|New|Nor|2014-02-06|dist commit messages missing from mail-archives di|
|56131|New|Nor|2014-02-12|ProxyPassReverse / zealously replaces Location hea|
|56135|New|Nor|2014-02-13|Add DC to list of x509 components                 |
|56152|New|Nor|2014-02-18|ProxyBlock does not accept network addresses      |
|56176|New|Nor|2014-02-21|mod_substitute truncates the response body if the |
|56188|New|Nor|2014-02-25|mod_proxy_fcgi does not send FCGI_ABORT_REQUEST on|
|56209|New|Nor|2014-03-03|Uninitialised variables in os/win32/ap_regkey.c   |
|56226|Ver|Nor|2014-03-06|per VirtualHost KeepAliveTimeout is not recognized|
|56229|New|Enh|2014-03-06|ocsp ProxyHost and ProxyPort support              |
|56230|New|Nor|2014-03-07|mod_access_compat can log a bogus client denied me|
|56235|New|Nor|2014-03-07|quotes should be optional around expr             |
|56247|New|Cri|2014-03-12|semaphore creation for proxypass                  |
|56250|New|Nor|2014-03-12|sbindir in config.layout for Apache has bin instea|
|56251|New|Nor|2014-03-12|Increase maximum length of FcgidInitialEnv string |
|56252|New|Enh|2014-03-12|make install as privileged user creates files not |
|56262|New|Nor|2014-03-14|ab does not work with extremely long cookies      |
|56264|New|Trv|2014-03-14|Confusing error with .htaccess rewrite to proxy wh|
|56270|New|Enh|2014-03-15|--with-ssl=/foo w/o pkgconfig needs help on AIX 64|
|56288|New|Enh|2014-03-19|rewrite URLs in style attributes                  |
|56289|New|Nor|2014-03-19|Buffer overflow in mod_proxy_html's string replace|
|56308|New|Nor|2014-03-24|1 second delay in handle request kills performance|
|56312|New|Nor|2014-03-25|Can't configure different balancing workers that c|
|56314|New|Nor|2014-03-25|exiting from MPM-worker child caused assert in apr|
|56326|New|Nor|2014-03-27|cache_quick_handler does not serve responses with |
|56331|New|Nor|2014-03-29|windows 'access denied' during revalidaton of reso|
|56333|New|Enh|2014-03-31|API to resume a SUSPENDED connection              |
|56362|New|Maj|2014-04-08|ldaps only works with port 636. Non-standard port |
|56379|New|Nor|2014-04-09|Number of columns in the results returned from pgs|
|56395|New|Enh|2014-04-11|Allow SERVER_ADDR environment variable to be optio|
|56404|New|Nor|2014-04-12|endless loop  when connect to a website(https)  wh|
|56413|New|Blk|2014-04-15|can not restart httpd on centos 5.10 64bit        |
|56422|New|Nor|2014-04-17|authnz_ldap with other forms of authn can fail req|
|56457|New|Nor|2014-04-25|mod_proxy_html.c: 2 * cut'n'paste errors          |
|56473|New|Nor|2014-04-30|ETags don't change when headers do                |
|56475|New|Enh|2014-04-30|Allow TLS record size to be configured            |
|56483|New|Enh|2014-05-02|add disableKeepAlivePercentage similar to tomcat h|
|56493|New|Min|2014-05-06|mod_expires should not set expires in future for s|
|56495|New|Nor|2014-05-06|Application behind mod_proxy does not get SessionH|
|56500|Opn|Enh|2014-05-07|vhosts priority order with wildcard               |
|56504|New|Nor|2014-05-08|cannot build static support binaries              |
|56508|New|Nor|2014-05-09|Requiring SNI - SSLStrictSNIVHostCheck semantics  |
|56517|New|Enh|2014-05-12|Virtualhosts cannot inherit parent CustomLog      |
|56528|New|Enh|2014-05-15|"bad flags delimiter" - improve helpfulness       |
|56541|New|Nor|2014-05-18|Proxy 502's on large file post requests           |
|56559|New|Nor|2014-05-25|multiple unix sockets in one virtualhost fails    |
|56569|New|Nor|2014-05-27|Null CRC in gzip footer with mod_cgid and ErrorDoc|
|56587|New|Nor|2014-06-03|Many VirtualHost's with SSLEngine On              |
|56590|New|Enh|2014-06-04|(REST-) API for configuring balancer manager remot|
|56594|Inf|Nor|2014-06-05|mod_authn_dbd, mod_dbd and mod_ssl                |
|56598|New|Nor|2014-06-06|Content-Length header should be always interpreted|
|56621|New|Nor|2014-06-13|Rotatelogs.exe first start                        |
|56622|New|Nor|2014-06-13|mod_reqtimeout incorrectly applies timeouts to CON|
|56626|New|Nor|2014-06-15|Add info about rotatelogs to log rotation document|
|56633|New|Nor|2014-06-16|mod_auth_basic breaks mod_autoindex               |
|56645|New|Maj|2014-06-19|socket callback with timeout callback causes infin|
|56664|New|Nor|2014-06-24|Proxy retry timeout does not cope with system time|
|56687|New|Nor|2014-07-01|ProxySourceAddress failed to bind socket to local |
|56697|New|Maj|2014-07-04|status page still shown while blocked             |
|56718|New|Nor|2014-07-14|Cleanup request Host headers when absolute URI are|
|56719|New|Nor|2014-07-14|parallel requests get served with delays          |
|56738|New|Enh|2014-07-17|Ability to extract route from cookie with regexp  |
|56740|New|Nor|2014-07-18|suspended_count not maintained properly with wstun|
|56750|New|Enh|2014-07-20|SuexecUserGroup replacement                       |
|56751|New|Maj|2014-07-20|Fails to properly mitigate Slow Post DoS attack   |
|56753|New|Nor|2014-07-21|mod_lua.so: symbol luaL_openlib: referenced symbol|
|56778|New|Nor|2014-07-28|while running make command i got this error       |
|56794|New|Nor|2014-07-31|Added AuthDBDFullAuthQuery option                 |
|56795|Inf|Nor|2014-07-31|Apache 2.4.10 Program received signal SIGPIPE, Bro|
|56818|Inf|Nor|2014-08-05|SetEnvIf may set invalid string length on empty st|
|56843|New|Enh|2014-08-12|Support different OCSP stapling max ages          |
|56868|New|Nor|2014-08-18|relative LuaRoot broken                           |
|56879|New|Nor|2014-08-22|Information disclosure                            |
|56889|New|Nor|2014-08-26|Close state never dies                            |
|56918|Opn|Blk|2014-09-06|error: 'ap_copy_scoreboard_worker' undeclared here|
|56926|New|Nor|2014-09-08|Filename causes AH02599 slotmem issue             |
|56933|New|Min|2014-09-09|not sure it's an appache bug : some browser want t|
|56942|New|Reg|2014-09-10|Unable to implement TRANSFER-CHUNKED:ENCODING with|
|56943|New|Nor|2014-09-10|mod_proxy_connect - AH02447: err/hup on backconn  |
|56977|New|Maj|2014-09-12|segfaults when using mod_mem_cache + mod_disk_cach|
|56986|New|Blk|2014-09-17|chunked Transfer-Encoding forbidden: /test/test.dl|
|57014|New|Cri|2014-09-24|Incorrect test for CC_FOR_BUILD prevents build (on|
|57023|New|Nor|2014-09-26|Socache shmcb don't cache file bigger than 11k    |
|57028|New|Enh|2014-09-27|mod_spdy - support Apache 2.4                     |
|57044|New|Nor|2014-09-29|[PatchAvailable] Use base64url in mod_unique_id ('|
|57045|New|Nor|2014-09-30|dumpio output strings are missing                 |
|57046|New|Enh|2014-09-30|Add additional parameter to enable check URL befor|
|57056|New|Maj|2014-10-03|Rewrite port is taken into hostname               |
|57067|New|Nor|2014-10-08|A proxy worker both standalone and balancer member|
|57069|New|Nor|2014-10-08|apache ssl timeout during chunked request in rever|
|57073|New|Cri|2014-10-09|Intermittent Connection Issues using default httpd|
|57085|New|Enh|2014-10-14|Implement Proxy Protocol in httpd                 |
|57087|New|Nor|2014-10-14|mod_proxy_fcgi doesn't send cgi CONTENT_LENGTH var|
|57100|Ver|Nor|2014-10-16|"SSLProtocol ALL" is ignored for virtual hosts    |
|57101|New|Enh|2014-10-16|[PATCH] Better error reporting when child spawn fa|
|57109|New|Nor|2014-10-17|GPG verification examples are wrong               |
|57119|Opn|Enh|2014-10-20|Suppress address reuse / DNS cache in mod_proxy   |
|57121|New|Nor|2014-10-21|ocsp stapling should not pass temporary server out|
|57131|New|Nor|2014-10-22|OCSP Stapling scalability concern                 |
|57159|New|Min|2014-10-28|mod_ssl OCSP Stapling directives don't support per|
|57160|New|Nor|2014-10-29|httxt2dbm doesn't generate files on NAS           |
|57174|New|Nor|2014-10-31|Update windows visual studio build                |
|57210|New|Nor|2014-11-14|LuaHookMapToStorage not firing in per-directory co|
|57211|New|Enh|2014-11-14|Config-time options                               |
|57212|Opn|Nor|2014-11-14|Headers returned by scripts are limited to 8190 by|
|57218|New|Nor|2014-11-15|[Feature Request] Apache Bench (AB) to output a cs|
|57219|New|Nor|2014-11-15|ApacheBench quits unexpectedly with high concurren|
|57220|New|Nor|2014-11-15|[Feature Request] Add option to ApacheBench to giv|
|57228|New|Nor|2014-11-17|glibc detected *** httpd: double free or corruptio|
|57229|New|Maj|2014-11-17|mod_sed dies on long lines                        |
|57286|New|Nor|2014-11-29|Symbolic links are not honoured                   |
|57298|New|Min|2014-12-02|RewriteBase inside FilesMatch behaves oddly       |
|57299|New|Enh|2014-12-02|mod_session_dbd should not make a database call pe|
|57300|New|Enh|2014-12-02|mod_session_dbd should not save the session at eac|
|57301|New|Enh|2014-12-02|Add SessionMaxAgeAbsolute Directive               |
|57304|Inf|Nor|2014-12-03|MySQL DBD Authentication Incompatible with SSL    |
|57311|New|Nor|2014-12-04|BalancerMember enclosed by <If> gives syntax error|
|57313|New|Nor|2014-12-05|The DefaultType directive has been removed        |
|57327|New|Nor|2014-12-08|mod_ssl seg fault on exit                         |
|57334|Ver|Maj|2014-12-09|Segmentation fault in SSL_renegotiate at ssl_lib.c|
|57337|New|Nor|2014-12-10|Content negotiation fails with conditional Redirec|
|57339|New|Enh|2014-12-10|ErrorLogFormat doesn't allow logging in Internet d|
|57360|New|Nor|2014-12-17|Fail gracefully on certificate/key mismatch       |
|57372|New|Nor|2014-12-19|httpd will lookup every home directory while start|
|57374|Ver|Nor|2014-12-19|Event MPM: Wrong KeepAliveTimeout when system cloc|
|57379|New|Nor|2014-12-20|[patch] Makefile.in  with mpm-shared, cgi and cgid|
|57383|New|Cri|2014-12-21|Error retrieving Report: An Existing connection wa|
|57386|New|Blk|2014-12-22|html5 lost some comments                          |
|57398|New|Maj|2014-12-26|AH01075: Error dispatching request to : (passing b|
|57399|New|Nor|2014-12-28|Many unnecessary CPU wakeups per second           |
|57406|New|Nor|2014-12-31|cgi-bin script is not executing                   |
|57412|New|Maj|2015-01-04|rewrite rules causes duplicate requests           |
|57416|New|Nor|2015-01-06|htcacheclean thinks the cache is smaller than it a|
|57424|Opn|Nor|2015-01-07|mod_rewrite not using ap_context_document_root    |
|57436|New|Enh|2015-01-12|Option to strip extra data after websocket request|
|57439|New|Enh|2015-01-13|Allow to change body timeout per location         |
|57448|New|Nor|2015-01-16|SSI <!--#set --> cannot capture backreferences fro|
|57453|New|Maj|2015-01-17|403 error when virtualhost configured with non-exi|
|57471|New|Nor|2015-01-20|Apache 2.4.10 Compilation fails when compiling aga|
|57477|New|Nor|2015-01-21|mod_auth_digest AH00052: child pid $pid exit signa|
|57483|New|Nor|2015-01-22|Omit "Keep-Alive" header on 1.1 connections       |
|57492|New|Nor|2015-01-24|incomplete chunked-transfered request body is not |
|57506|New|Nor|2015-01-27|<If> directive doesn't work within a <Location> se|
|57510|New|Enh|2015-01-28|Engine keyform support for private keys           |
|57511|New|Maj|2015-01-28|Opening plain TCP Socket on SSL port causes denial|
|57515|New|Nor|2015-01-30|Define/Undefine don't work reasonably outside of g|
|57519|New|Nor|2015-02-01|change SSLv2 to SSLv3 or remove SSLv2 support allt|
|57526|Opn|Maj|2015-02-03|Apache 2.2.29_openssl-1.0.1k_x86_64 Error creating|
|57529|Opn|Nor|2015-02-03|htcacheclean doesn't show the cached URL with '-a'|
|57585|New|Nor|2015-02-13|httpd fails to start if there is an IncludeOptiona|
|57590|New|Nor|2015-02-18|loading mod_proxy_http makes rewriteRule's [proxy]|
|57591|New|Nor|2015-02-18|DirectoryIndex directive cannot be overwritten    |
|57616|New|Maj|2015-02-23|AB - DNS roundrobin support                       |
|57624|New|Enh|2015-02-23|Provide support for http/2.0                      |
|57631|New|Nor|2015-02-24|Useless test in acinclude.m4                      |
|57632|New|Nor|2015-02-24|mod_systemd passes invalid default to APACHE_MODUL|
|57635|New|Nor|2015-02-25|meta-refresh is not rewritten by mod_proxy_html   |
|57636|New|Nor|2015-02-25|URLs without protocol are not rewriten by mod_prox|
|57641|New|Maj|2015-02-27|mod_substitute: Invalid merge order               |
|57646|New|Enh|2015-02-27|SSLEngine inside If directive                     |
|57660|New|Trv|2015-03-04|AB - free memory allocated by xmalloc and xcalloc |
|57680|New|Nor|2015-03-09|SSLSessionCacheTimeout has no effect              |
|57685|New|Nor|2015-03-10|Requests are denied while the mod_cgid daemon star|
|57691|New|Nor|2015-03-12|mod_proxy/proxy_util confuses UDS scheme with HTTP|
|57695|New|Nor|2015-03-12|[core:warn] [pid 1120] (101)Network is unreachable|
|57710|New|Nor|2015-03-15|Wildcard matching for logging headers             |
|57725|New|Enh|2015-03-18|ApacheBench: include http status code in gnuplot o|
|57742|New|Nor|2015-03-23|"reliable piped logging" doesn't work for ErrorLog|
|57745|New|Nor|2015-03-23|httpd exits 1 with no stderr when proxy_balancer_m|
|57746|New|Nor|2015-03-23|Apache hangs on startup using MPM event           |
|57751|Inf|Maj|2015-03-24|Problems with proxy reverse to websockets         |
|57756|New|Enh|2015-03-25|Config options for handling of pipelined request  |
|57757|New|Cri|2015-03-25|extern apr_xlate_t *ap_locale_to_ascii variable gi|
|57771|New|Nor|2015-03-27|cleanup_script uses incorrect connection ID       |
|57774|Inf|Nor|2015-03-28|httpd.conf <IfModule proxy_html_module> content er|
|57777|New|Nor|2015-03-30|Security concerns with documentation of AddHandler|
|57781|New|Nor|2015-03-31|disable reconnection after connection error       |
|57784|New|Enh|2015-03-31|[RFE] Multiple ErrorLog directives                |
|57795|Opn|Maj|2015-04-07|mod_proxy_wstunnel sometimes does not connect and |
|57800|New|Nor|2015-04-09|High CPU usage in ap_core_output_filter           |
|57807|New|Enh|2015-04-13|Build-configurable environment variable length    |
|57810|New|Nor|2015-04-13|Should apache ignore difference in trailing dot be|
|57813|New|Nor|2015-04-14|Rewrite 'pre-compressed content' recipe using 2.4 |
|57814|New|Nor|2015-04-14|Teach mod_deflate how to serve pre-comressed conte|
|57819|New|Nor|2015-04-15|Need a conventions document                       |
|57832|New|Enh|2015-04-19|Reduction of response splitting attacks consequenc|
|57853|Inf|Nor|2015-04-24|mod_proxy_http sends request with header 'Expect: |
|57868|New|Nor|2015-04-28|SIGSEV when lacking correct DB access permissions |
|57876|New|Reg|2015-04-30|logresolve.exe on any Windows immediately crashes |
|57878|New|Nor|2015-04-30|Using UTF-8 for all languages, and avoiding html-e|
|57895|New|Min|2015-05-05|missing m4a mimeType in mime.types                |
|57911|New|Min|2015-05-09|Rewrite documentation unclear or wrong about what |
|57927|New|Maj|2015-05-13|Segmentation Fault at proxy_util.c:994            |
|57933|New|Min|2015-05-18|apr_port_t returns constant                       |
|57941|New|Nor|2015-05-21|config.status: line 331: syntax error near unexpec|
|57949|New|Enh|2015-05-25|new mod_ssl environment variable SSL_{CLIENT|SERVE|
|57950|New|Nor|2015-05-26|[patch] buildconf change hint in build to newer ap|
|57960|New|Nor|2015-05-27|PUT truncates response body; status_line appears t|
|57976|New|Cri|2015-05-30|Server threads stale when sending 500 status with |
|57978|New|Nor|2015-06-01|unix:/ works with any number of / slashes  except |
|57979|New|Nor|2015-06-01|can not turn change log level for mod_filter      |
|57996|New|Nor|2015-06-03|Symlinks erroneously not followed when target inod|
|57997|New|Nor|2015-06-03|Threads started during child_init don't block sign|
|57999|New|Nor|2015-06-04|ap_getparents() may remove start slash of uri     |
|58001|New|Enh|2015-06-04|Implement Forwarded header (RFC 7239) to mod_proxy|
|58007|New|Nor|2015-06-06|400 Bad Request with fully qualified domain name o|
|58025|New|Enh|2015-06-11|mod_authz_dbd : new dbd-query and AuthzDBDQuery op|
|58026|New|Nor|2015-06-11|return 421 status code when SNI and Host: header d|
|58044|New|Cri|2015-06-16|Error sintax 'lua_dump'                           |
|58050|New|Nor|2015-06-17|ErrorDocument does not always work                |
|58073|New|Nor|2015-06-24|Extremely long time for graceful restart          |
|58089|New|Nor|2015-07-01|mod_authz_host uses proxy IP even when mod_remotei|
|58091|New|Nor|2015-07-02|mod_socache_memcache does not reuse memcache conne|
|58097|New|Enh|2015-07-03|[feat] Preserve original connecting IP            |
|58101|New|Nor|2015-07-05|DeflateCompressionLevel inside vhost resets logfor|
|58107|New|Blk|2015-07-06|Httpd crashes on startup every time, dump file att|
|58109|New|Nor|2015-07-06|Apache on windows cannot handle the hash symbol (#|
|58118|Inf|Min|2015-07-09|mod_proxy_fcgi logs 503 when user aborts connectio|
|58120|New|Nor|2015-07-10|ProxyPassInherit does not work as expect          |
|58121|New|Nor|2015-07-10|ProxyHTMLMeta seems to ignore all <meta http-equiv|
|58129|New|Nor|2015-07-12|man pages are not generated correctly             |
|58132|New|Nor|2015-07-12|non-standard, non-traditional man page layout make|
|58135|New|Nor|2015-07-14|mod_cache sends client "if-Modified-Since" to back|
|58141|New|Nor|2015-07-15|Apache Service doesn't start when rotatlogs.exe pa|
|58142|New|Nor|2015-07-15|authz_core ignores loglevel                       |
|58158|New|Nor|2015-07-21|Not honoring HTTP spec with regard to Accept-Encod|
|58168|New|Enh|2015-07-21|Would like full request evaluation support in Rewr|
|58171|New|Nor|2015-07-22|ap_session_save saves the wrong session after a de|
|58177|New|Enh|2015-07-24|Mod Proxy forward trailers in http chunked request|
|58180|New|Enh|2015-07-24|ErrorDocument original URL in subsequent <Location|
|58181|New|Enh|2015-07-25|mod_expire should allow "minus" keyword same like |
|58188|New|Nor|2015-07-28|http2 mod_lua: support build with lua 5.2+        |
|58197|New|Nor|2015-07-31|apr-util-1.5.4 build against openldap - "could not|
|58202|New|Enh|2015-07-31|apxs -q += HTTPD_MAJOR , HTTPD_MMN variables      |
|58225|New|Reg|2015-08-08|intermitant segfault 11 in session_identity_encode|
|58226|New|Nor|2015-08-08|XSS in Error Page                                 |
|58231|New|Nor|2015-08-11|RewriteCond can add "Host" to the Vary-Header     |
|58235|New|Enh|2015-08-12|Ability to allow from domain but with using forwar|
|58243|New|Nor|2015-08-14|rotatelogs goes infinite at startup               |
|58248|New|Nor|2015-08-17|Error 404 in use some characters of utf8 in url   |
|58257|New|Nor|2015-08-18|require ldap-group does not work if account-fullna|
|58278|New|Nor|2015-08-24|apache - mod_security Issue : apache no releasing |
|58280|New|Nor|2015-08-24|Backend connection not closed until timeout if cli|
|58288|New|Blk|2015-08-27|Semaphore amount increase until crash when enablin|
|58292|New|Nor|2015-08-27|FallbackResource breaks chunked encoding sometimes|
|58304|New|Nor|2015-08-30|Unexpected Warnings from Macro Use in 2.4         |
|58305|New|Nor|2015-08-30|mod_cgi documentation not clear about what is pass|
|58306|New|Nor|2015-08-30|documentation needs to make it clear which directi|
|58307|New|Nor|2015-08-31|Segmentation fault in child in "read(__nbytes, __b|
|58317|New|Min|2015-09-02|Error message AH01630 is missing file name on deny|
|58334|New|Min|2015-09-06|WebDAV HTTP access does not include meta tag for c|
|58335|New|Nor|2015-09-07|mod_authnz_ldap mismatch                          |
|58343|New|Nor|2015-09-08|The pdf files come up as a blank page.            |
|58354|New|Maj|2015-09-10|(20014)Internal error (specific information not av|
|58356|New|Blk|2015-09-10|Session jumping due to incorrect route            |
|58364|New|Reg|2015-09-11|Apache Server is restarted time to time (Release 2|
|58417|New|Min|2015-09-16|ApacheBench (ab) won't display Server Software of |
|58419|New|Nor|2015-09-16|ApacheBench (ab) doesn't work with keep-alives aga|
|58423|New|Reg|2015-09-17|Apache >= 2.4.8 PCRE_DUPNAMES causes build failure|
|58454|New|Nor|2015-09-24|Invalid FB (first byte) logging when using SSL/TLS|
|58467|New|Maj|2015-09-29|Environment Variables in ProxyHTMLURLMap produces |
|58475|New|Nor|2015-10-03|Support append/merge with semicolon-separated head|
|58488|New|Nor|2015-10-08|Stoped PHP-FPM pool in multi-pool system with comu|
|58491|New|Maj|2015-10-09|Core dumps appear when the load increases         |
|58492|Inf|Nor|2015-10-09|I think LDAPConnectionPoolTTL is not being honored|
+-----+---+---+----------+--------------------------------------------------+
| Total 1542 bugs                                                           |
+---------------------------------------------------------------------------+

From dev-return-84212-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Sun Oct 11 08:36:26 2015
Return-Path: <dev-return-84212-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 52E43186B3
	for <apmail-httpd-dev-archive@www.apache.org>; Sun, 11 Oct 2015 08:36:26 +0000 (UTC)
Received: (qmail 66799 invoked by uid 500); 11 Oct 2015 08:36:25 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 66726 invoked by uid 500); 11 Oct 2015 08:36:25 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 66715 invoked by uid 99); 11 Oct 2015 08:36:25 -0000
Received: from Unknown (HELO spamd3-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 11 Oct 2015 08:36:25 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd3-us-west.apache.org (ASF Mail Server at spamd3-us-west.apache.org) with ESMTP id 3CBF3180F4F
	for <dev@httpd.apache.org>; Sun, 11 Oct 2015 08:36:25 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd3-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.1
X-Spam-Level:
X-Spam-Status: No, score=-0.1 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RCVD_IN_MSPIKE_H2=-0.001, URIBL_BLOCKED=0.001] autolearn=disabled
Authentication-Results: spamd3-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-us-west.apache.org ([10.40.0.8])
	by localhost (spamd3-us-west.apache.org [10.40.0.10]) (amavisd-new, port 10024)
	with ESMTP id 2gS7IkqH_30o for <dev@httpd.apache.org>;
	Sun, 11 Oct 2015 08:36:12 +0000 (UTC)
Received: from mail-qg0-f49.google.com (mail-qg0-f49.google.com [209.85.192.49])
	by mx1-us-west.apache.org (ASF Mail Server at mx1-us-west.apache.org) with ESMTPS id C5DAC21651
	for <dev@httpd.apache.org>; Sun, 11 Oct 2015 08:36:11 +0000 (UTC)
Received: by qgez77 with SMTP id z77so101267968qge.1
        for <dev@httpd.apache.org>; Sun, 11 Oct 2015 01:36:05 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        bh=OL7BS+I5wu39Xg4Kdek1kUQ3xPy3Xcwi7L4Wl+o6Xxk=;
        b=nPZLVwsa3tGOVUjTAlKR/4WpwwWPuX1hWi7co1DN059VMczNui4mzyphDcSdXpIUF4
         gnsq67xADphHVZKfIiwmrNjq7BHcc+6KdURCHXl7I4Kg43OYfx+1BGyGzH+NpUOCs/Al
         CddzMBVFfTqca1xRVKUS3MFEh+LFQtLfQd3P0PFMv0eyi78bL7CfBdwkZP52WTs8wasy
         ZfuaXeGEbaBLk8ZOyQvYwcaYzXdLjgOG0z7TlLLTHa+OwZVJWcswNQDx7KKdoQXpb8bu
         zpvyN3leifrwzQomFQhGkSutqym3WH106I7RpLqY/jpoAiCZJsgaNbWWjQmAa9DCmN2j
         ku4g==
MIME-Version: 1.0
X-Received: by 10.140.19.227 with SMTP id 90mr24878939qgh.51.1444552565624;
 Sun, 11 Oct 2015 01:36:05 -0700 (PDT)
Received: by 10.55.72.20 with HTTP; Sun, 11 Oct 2015 01:36:05 -0700 (PDT)
In-Reply-To: <C45BAF78-8A10-4751-B1CA-62BB499FD795@jaguNET.com>
References: <C45BAF78-8A10-4751-B1CA-62BB499FD795@jaguNET.com>
Date: Sun, 11 Oct 2015 10:36:05 +0200
Message-ID: <CAKQ1sVOacyCbB9psRgSLz7KmWmBagDMvt98AuEJy94YVRVgf-Q@mail.gmail.com>
Subject: Re: [VOTE] Release Apache httpd 2.4.17 as GA
From: Yann Ylavic <ylavic.dev@gmail.com>
To: dev@httpd.apache.org
Content-Type: text/plain; charset=UTF-8

On Fri, Oct 9, 2015 at 7:40 PM, Jim Jagielski <jim@jagunet.com> wrote:
> The pre-release test tarballs for Apache httpd 2.4.17 can be found
> at the usual place:
>
>         http://httpd.apache.org/dev/dist/
>
> I'm calling a VOTE on releasing these as Apache httpd 2.4.17 GA.
>
> [X] +1: Good to go

* md5/sha1/asc
=> OK

* Debian 8.2 (Jessie)
- Linux 3.14.15-2
- autoconf 2.69-8
- automake 1.14.1-4
- libtool 2.4.2-1.11
- gcc 4.9.2-10
- libc6 2.19-18+deb8u1
- openssl 1.0.1k-3+deb8u1
- pcre 8.35-3.3
=> All tests passed.

* Debian 7.9 (Wheezy)
- Linux 3.2.68-1+deb7u4
- autoconf 2.69-1
- automake 1.11.6-1
- libtool 2.4.2-1.1
- gcc 4.7.2-5
- libc6 2.13-38+deb7u8
- openssl 1.0.1e-2+deb7u17
- pcre 8.30-5
=> All passed passed.

* Debian 6.0.10 (Squeeze)
- Linux 2.6.32-48squeeze13
- autoconf 2.67-2
- automake 1.11.1-1+squeeze11
- libtool 2.2.6b-2
- gcc 4.4.5-8
- libc6 2.11.3-4+deb6u6
- openssl 0.9.8o-4squeeze21
- pcre 8.02-1.1
=> No regression.

Thanks Jim!

From dev-return-84213-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Sun Oct 11 11:58:23 2015
Return-Path: <dev-return-84213-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 0E7BA188E8
	for <apmail-httpd-dev-archive@www.apache.org>; Sun, 11 Oct 2015 11:58:23 +0000 (UTC)
Received: (qmail 88247 invoked by uid 500); 11 Oct 2015 11:58:22 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 88177 invoked by uid 500); 11 Oct 2015 11:58:22 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 88167 invoked by uid 99); 11 Oct 2015 11:58:22 -0000
Received: from Unknown (HELO spamd2-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 11 Oct 2015 11:58:22 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd2-us-west.apache.org (ASF Mail Server at spamd2-us-west.apache.org) with ESMTP id C018F1A0910
	for <dev@httpd.apache.org>; Sun, 11 Oct 2015 11:58:21 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd2-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.01
X-Spam-Level:
X-Spam-Status: No, score=-0.01 tagged_above=-999 required=6.31
	tests=[SPF_PASS=-0.001, T_RP_MATCHES_RCVD=-0.01, URIBL_BLOCKED=0.001]
	autolearn=disabled
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd2-us-west.apache.org [10.40.0.9]) (amavisd-new, port 10024)
	with ESMTP id C1X8giHp31Wy for <dev@httpd.apache.org>;
	Sun, 11 Oct 2015 11:58:11 +0000 (UTC)
Received: from mail.greenbytes.de (mail.greenbytes.de [217.91.35.233])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id 3E268201F9
	for <dev@httpd.apache.org>; Sun, 11 Oct 2015 11:58:11 +0000 (UTC)
Received: from [192.168.178.41] (unknown [84.189.85.191])
	(using TLSv1 with cipher ECDHE-RSA-AES256-SHA (256/256 bits))
	(Client did not present a certificate)
	by mail.greenbytes.de (Postfix) with ESMTPSA id 2F5CF15A03F4
	for <dev@httpd.apache.org>; Sun, 11 Oct 2015 13:58:10 +0200 (CEST)
Content-Type: text/plain; charset=us-ascii
Mime-Version: 1.0 (Mac OS X Mail 9.0 \(3094\))
Subject: Re: this expected?
From: Stefan Eissing <stefan.eissing@greenbytes.de>
In-Reply-To: <5619F778.6070808@velox.ch>
Date: Sun, 11 Oct 2015 13:58:09 +0200
Content-Transfer-Encoding: quoted-printable
Message-Id: <FC1BBEDD-7284-4B90-9E9E-0F4EA1961AEE@greenbytes.de>
References: <5D0C3260-FB28-4E03-BA5D-FC13CCA933D6@greenbytes.de> <5619F778.6070808@velox.ch>
To: dev@httpd.apache.org
X-Mailer: Apple Mail (2.3094)

Thanks, Kaspar, that did it. -clean does not seem to reset it, removed =
dir and restored from svn.

All PASS now.

//Stefan

> Am 11.10.2015 um 07:45 schrieb Kaspar Brand <httpd-dev.2014@velox.ch>:
>=20
> On 10.10.2015 20:14, Stefan Eissing wrote:
>> Testing 2.4.17 release tar ball on OS X 10.11 (event/worker/prefork, =
openssl 1.0.2d):
>>=20
>> t/ssl/varlookup.t ................... 1/81 # Failed test 55 in =
t/ssl/varlookup.t at line 105 fail #55
>> # Failed test 56 in t/ssl/varlookup.t at line 105 fail #56
>> # Failed test 57 in t/ssl/varlookup.t at line 105 fail #57
>> # Failed test 58 in t/ssl/varlookup.t at line 105 fail #58
>> # Failed test 75 in t/ssl/varlookup.t at line 105 fail #75
>> # Failed test 76 in t/ssl/varlookup.t at line 105 fail #76
>> t/ssl/varlookup.t ................... Failed 6/81 subtests=20
>=20
> Can you quickly confirm that t/conf/ssl/ca/asf/certs/client_ok.crt (or
> any other cert in this directory) is older than
> Apache-Test/lib/Apache/TestSSLCA.pm in that test framework =
installation?
> If so, the above failures are a consequence of r1705534 and r1705535,
> and TEST -clean should help in getting a fresh collection of certs (if
> it doesn't remove the t/conf/ssl/ca directory, it can just be rm'ed
> manually).
>=20
> Kaspar


From dev-return-84214-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Sun Oct 11 13:32:28 2015
Return-Path: <dev-return-84214-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id F213018A7D
	for <apmail-httpd-dev-archive@www.apache.org>; Sun, 11 Oct 2015 13:32:28 +0000 (UTC)
Received: (qmail 54037 invoked by uid 500); 11 Oct 2015 13:32:28 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 53964 invoked by uid 500); 11 Oct 2015 13:32:28 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 53954 invoked by uid 99); 11 Oct 2015 13:32:28 -0000
Received: from Unknown (HELO spamd4-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 11 Oct 2015 13:32:28 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd4-us-west.apache.org (ASF Mail Server at spamd4-us-west.apache.org) with ESMTP id F2762C0EC9
	for <dev@httpd.apache.org>; Sun, 11 Oct 2015 13:32:27 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd4-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.011
X-Spam-Level:
X-Spam-Status: No, score=-0.011 tagged_above=-999 required=6.31
	tests=[SPF_PASS=-0.001, T_RP_MATCHES_RCVD=-0.01] autolearn=disabled
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd4-us-west.apache.org [10.40.0.11]) (amavisd-new, port 10024)
	with ESMTP id yONz-NID3JlR for <dev@httpd.apache.org>;
	Sun, 11 Oct 2015 13:32:26 +0000 (UTC)
Received: from mailserver.kippdata.de (capsella.kippdata.de [195.227.30.149])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTP id 8FB7D439B5
	for <dev@httpd.apache.org>; Sun, 11 Oct 2015 13:32:25 +0000 (UTC)
Received: from [10.0.110.6] ([192.168.2.104])
	by mailserver.kippdata.de (8.13.5/8.13.5) with ESMTP id t9BDWHi4015207
	for <dev@httpd.apache.org>; Sun, 11 Oct 2015 15:32:17 +0200 (CEST)
To: "dev@httpd.apache.org" <dev@httpd.apache.org>
From: Rainer Jung <rainer.jung@kippdata.de>
Subject: 2.4.17 test failure for mod_nntp_like_ssl when mod_http2 is loaded
Message-ID: <561A64DC.5000809@kippdata.de>
Date: Sun, 11 Oct 2015 15:32:12 +0200
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:38.0) Gecko/20100101
 Thunderbird/38.3.0
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8; format=flowed
Content-Transfer-Encoding: 7bit

I get a test failure for 2.4.17 in the mod_nntp_like_ssl part. Te 
failure happens on Solaris. Note that the nntp tests are disabled by 
default on Linux because of problems with the kernel accept filter, so 
that many of you wont run this test and thus not observe the problem.

The problems is that the test hangs after test 1 when waiting for the 
result of 2. On Solaris 8 the behavior changes a bit, there test 2 
succeeds, but 3-5 receive an empty result. The difference might be due 
to slight perl test differences. I suspect a common root cause.

Maybe the problem is due to some unclean brigade handling in 
mod_nntp_like_ssl (in light of recent dev list discussions)? Or 
mod_http2 is simply incompatible with mod_nntp_like_ssl and we should 
disable that test if mod_http2 is loaded?

Trace 8 log comparison between good runs (without having mod_http2 
loaded) and bad runs (having mod_http2 loaded):

Good run (no mod_http2)

- end of handshake and immediately write 52 bytes

[Sun Oct 11 14:53:47.911105 2015] [ssl:trace3] [pid 23096:tid 27] 
ssl_engine_kernel.c(1810): [client 127.0.0.1:50990] OpenSSL: Handshake: done
[Sun Oct 11 14:53:47.911142 2015] [ssl:debug] [pid 23096:tid 27] 
ssl_engine_kernel.c(1855): [client 127.0.0.1:50990] AH02041: Protocol: 
TLSv1.2, Cipher: ECDHE-RSA-AES256-GCM-SHA384 (256/256 bits)
[Sun Oct 11 14:53:47.911212 2015] [ssl:trace4] [pid 23096:tid 27] 
ssl_engine_io.c(2088): [client 127.0.0.1:50990] OpenSSL: write 52/52 
bytes to BIO#2861b8 [mem: 2bd45b] (BIO dump follows)


Bad run (including mod_http2)

- end of handshake

[Sun Oct 11 14:54:38.550476 2015] [ssl:trace3] [pid 23133:tid 50] 
ssl_engine_kernel.c(1810): [client 127.0.0.1:50994] OpenSSL: Handshake: done
[Sun Oct 11 14:54:38.550520 2015] [ssl:debug] [pid 23133:tid 50] 
ssl_engine_kernel.c(1855): [client 127.0.0.1:50994] AH02041: Protocol: 
TLSv1.2, Cipher: ECDHE-RSA-AES256-GCM-SHA384 (256/256 bits)
[Sun Oct 11 14:54:38.550555 2015] [core:trace6] [pid 23133:tid 50] 
core_filters.c(523): [client 127.0.0.1:50994] core_output_filter: 
flushing because of FLUSH bucket

- one minute established connection, but nothing else

[Sun Oct 11 14:54:39.274796 2015] [mpm_event:trace6] [pid 23133:tid 53] 
event.c(1577): connections: 1 (clogged: 0 write-completion: 0 
keep-alive: 0 lingering: 0 suspended: 0)
...

- timeout after one minute and write 52 bytes

[Sun Oct 11 14:55:38.551174 2015] [ssl:trace4] [pid 23133:tid 50] 
ssl_engine_io.c(2099): [client 127.0.0.1:50994] OpenSSL: I/O error, 5 
bytes expected to read on BIO#273480 [mem: 3624e3]
[Sun Oct 11 14:55:38.551253 2015] [ssl:info] [pid 23133:tid 50] 
(70007)The timeout specified has expired: [client 127.0.0.1:50994] 
AH01991: SSL input filter read failed.
[Sun Oct 11 14:55:38.551316 2015] [http2:debug] [pid 23133:tid 50] 
h2_h2.c(189): (70007)The timeout specified has expired: [client 
127.0.0.1:50994] h2_h2, error reading 24 bytes speculative
[Sun Oct 11 14:55:38.551344 2015] [http2:trace1] [pid 23133:tid 50] 
h2_h2.c(205): [client 127.0.0.1:50994] h2_h2, declined
[Sun Oct 11 14:55:38.551433 2015] [ssl:trace4] [pid 23133:tid 50] 
ssl_engine_io.c(2088): [client 127.0.0.1:50994] OpenSSL: write 52/52 
bytes to BIO#282488 [mem: 36a633] (BIO dump follows)

Regards,

Rainer

From dev-return-84215-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Sun Oct 11 14:01:50 2015
Return-Path: <dev-return-84215-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id B3B4418B46
	for <apmail-httpd-dev-archive@www.apache.org>; Sun, 11 Oct 2015 14:01:50 +0000 (UTC)
Received: (qmail 86373 invoked by uid 500); 11 Oct 2015 14:01:50 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 86303 invoked by uid 500); 11 Oct 2015 14:01:50 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 86292 invoked by uid 99); 11 Oct 2015 14:01:50 -0000
Received: from Unknown (HELO spamd3-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 11 Oct 2015 14:01:50 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd3-us-west.apache.org (ASF Mail Server at spamd3-us-west.apache.org) with ESMTP id BFD63180A7C
	for <dev@httpd.apache.org>; Sun, 11 Oct 2015 14:01:49 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd3-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.101
X-Spam-Level:
X-Spam-Status: No, score=-0.101 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RCVD_IN_MSPIKE_H2=-0.001, SPF_PASS=-0.001, URIBL_BLOCKED=0.001]
	autolearn=disabled
Authentication-Results: spamd3-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd3-us-west.apache.org [10.40.0.10]) (amavisd-new, port 10024)
	with ESMTP id dUSPUExgQUIK for <dev@httpd.apache.org>;
	Sun, 11 Oct 2015 14:01:40 +0000 (UTC)
Received: from mail-io0-f177.google.com (mail-io0-f177.google.com [209.85.223.177])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id 9AF4120C18
	for <dev@httpd.apache.org>; Sun, 11 Oct 2015 14:01:39 +0000 (UTC)
Received: by iodv82 with SMTP id v82so30679181iod.0
        for <dev@httpd.apache.org>; Sun, 11 Oct 2015 07:01:38 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        bh=Xx1+LLv7X4zXRVCuH1SA29Ox4v+JFHguy0S936AQiP4=;
        b=osMXZZodNbqIyng1l1NkihY96Uym2vv1+JSf54V/7tcv1L9jLCOL0RFwCGIOdd6xZt
         pAgZYyUg3V5EgCtB+ho7p0sKHfRg4+BBNIuExorvQDtopAlRuTgYSujxGrIHlf/xgx4h
         1l7/pXGLJ4AbyrQD4Fw9Ge1OAUCQBX7rclUIS5Y8GNTsK25U4SP4YH0FVixe2S0ELwC5
         rRJwBfMkgF1zCxDPgb1tSNxch89hl06N+8Nck5UO2pTWyY27l/PEolB08PG1WQ45G8gs
         WQMhXx20MZvE44eNxEzfv114nQgAxwp9WrS0smIqqPwygAhvllH/g8qrmWM++GZpz7aH
         3Vww==
MIME-Version: 1.0
X-Received: by 10.107.14.4 with SMTP id 4mr25642341ioo.169.1444572098674; Sun,
 11 Oct 2015 07:01:38 -0700 (PDT)
Received: by 10.64.25.3 with HTTP; Sun, 11 Oct 2015 07:01:38 -0700 (PDT)
In-Reply-To: <561A64DC.5000809@kippdata.de>
References: <561A64DC.5000809@kippdata.de>
Date: Sun, 11 Oct 2015 10:01:38 -0400
Message-ID: <CALK=YjP7pyfzv9Wkn27kL1ZfhKi-oBs10WYGdUh6UA2Bf4ZrEA@mail.gmail.com>
Subject: Re: 2.4.17 test failure for mod_nntp_like_ssl when mod_http2 is loaded
From: Eric Covener <covener@gmail.com>
To: Apache HTTP Server Development List <dev@httpd.apache.org>
Content-Type: text/plain; charset=UTF-8

On Sun, Oct 11, 2015 at 9:32 AM, Rainer Jung <rainer.jung@kippdata.de> wrote:
> The problems is that the test hangs after test 1 when waiting for the result
> of 2. On Solaris 8 the behavior changes a bit, there test 2 succeeds, but
> 3-5 receive an empty result. The difference might be due to slight perl test
> differences. I suspect a common root cause.


Seen on AIX too, but I am struggling with some non system openssl
1.0.2 issues though (between httpd, framework, and 32-bit perl modules
that use the native code) and can't even re-run at the moment.

From dev-return-84216-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Sun Oct 11 14:04:58 2015
Return-Path: <dev-return-84216-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id F1F4418B56
	for <apmail-httpd-dev-archive@www.apache.org>; Sun, 11 Oct 2015 14:04:58 +0000 (UTC)
Received: (qmail 90223 invoked by uid 500); 11 Oct 2015 14:04:58 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 90144 invoked by uid 500); 11 Oct 2015 14:04:58 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 90134 invoked by uid 99); 11 Oct 2015 14:04:58 -0000
Received: from Unknown (HELO spamd3-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 11 Oct 2015 14:04:58 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd3-us-west.apache.org (ASF Mail Server at spamd3-us-west.apache.org) with ESMTP id 168971809F2
	for <dev@httpd.apache.org>; Sun, 11 Oct 2015 14:04:58 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd3-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.011
X-Spam-Level:
X-Spam-Status: No, score=-0.011 tagged_above=-999 required=6.31
	tests=[SPF_PASS=-0.001, T_RP_MATCHES_RCVD=-0.01] autolearn=disabled
Received: from mx1-us-west.apache.org ([10.40.0.8])
	by localhost (spamd3-us-west.apache.org [10.40.0.10]) (amavisd-new, port 10024)
	with ESMTP id HMAi_hAOb8Ss for <dev@httpd.apache.org>;
	Sun, 11 Oct 2015 14:04:57 +0000 (UTC)
Received: from mailserver.kippdata.de (capsella.kippdata.de [195.227.30.149])
	by mx1-us-west.apache.org (ASF Mail Server at mx1-us-west.apache.org) with ESMTP id 78B012031C
	for <dev@httpd.apache.org>; Sun, 11 Oct 2015 14:04:56 +0000 (UTC)
Received: from [10.0.110.6] ([192.168.2.104])
	by mailserver.kippdata.de (8.13.5/8.13.5) with ESMTP id t9BE4tSU015388
	for <dev@httpd.apache.org>; Sun, 11 Oct 2015 16:04:55 +0200 (CEST)
To: "dev@httpd.apache.org" <dev@httpd.apache.org>
From: Rainer Jung <rainer.jung@kippdata.de>
Subject: 2.4.17 test failure for mod_http2 (test 30-31, misdirected)
Message-ID: <561A6C81.9030600@kippdata.de>
Date: Sun, 11 Oct 2015 16:04:49 +0200
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:38.0) Gecko/20100101
 Thunderbird/38.3.0
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8; format=flowed
Content-Transfer-Encoding: 7bit

# testing : GET https://localhost:8532/misdirected
# expected: 421
# received: '404'
not ok 30
# Failed test 30 in t/modules/http2.t at line 129 fail #6
# testing : GET https://localhost:8532/misdirected
# expected: 421
# received: '404'
not ok 31

Is this expected for 2.4? I didn't find anything about this in the 
trace8 error log.

Any hints how to debug? I was using OpenSSL 1.0.2c in the client (Perl 
Test Framework) and 1.0.2d in the server.

Regards,

Rainer

From dev-return-84217-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Sun Oct 11 14:08:28 2015
Return-Path: <dev-return-84217-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id A56A518B5F
	for <apmail-httpd-dev-archive@www.apache.org>; Sun, 11 Oct 2015 14:08:28 +0000 (UTC)
Received: (qmail 93750 invoked by uid 500); 11 Oct 2015 14:08:28 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 93686 invoked by uid 500); 11 Oct 2015 14:08:28 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 93676 invoked by uid 99); 11 Oct 2015 14:08:27 -0000
Received: from Unknown (HELO spamd2-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 11 Oct 2015 14:08:27 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd2-us-west.apache.org (ASF Mail Server at spamd2-us-west.apache.org) with ESMTP id 97B2D1A092C
	for <dev@httpd.apache.org>; Sun, 11 Oct 2015 14:08:27 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd2-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.102
X-Spam-Level:
X-Spam-Status: No, score=-0.102 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RCVD_IN_MSPIKE_H2=-0.001, SPF_PASS=-0.001] autolearn=disabled
Authentication-Results: spamd2-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-us-west.apache.org ([10.40.0.8])
	by localhost (spamd2-us-west.apache.org [10.40.0.9]) (amavisd-new, port 10024)
	with ESMTP id jlczUsulHShK for <dev@httpd.apache.org>;
	Sun, 11 Oct 2015 14:08:27 +0000 (UTC)
Received: from mail-io0-f171.google.com (mail-io0-f171.google.com [209.85.223.171])
	by mx1-us-west.apache.org (ASF Mail Server at mx1-us-west.apache.org) with ESMTPS id C92F82031C
	for <dev@httpd.apache.org>; Sun, 11 Oct 2015 14:08:26 +0000 (UTC)
Received: by iow1 with SMTP id 1so131701680iow.1
        for <dev@httpd.apache.org>; Sun, 11 Oct 2015 07:08:26 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=mime-version:date:message-id:subject:from:to:content-type;
        bh=g4X1gbITAQuFZQOlN5sPwlf/Am3ms92k1y3hsAi3iKA=;
        b=trqrmiyRHHsob4HaNvUWqbwEEa+x971/D3m5yuFMqPqQoFTEvYZ5NDQF5d6xbHP2Uk
         uPjMU7DpuIncLBIuMhY5qiMh9FSnCMbHwxQ5vg9EIANxk3sP6cGCHK5+198baqVUKZ5R
         XHLSiygsnq8NIpgWvgz7i3AyGLcEfKVjSU4sqcpYMLVrTb7n9DCMOeKmPOz/Um9qRdal
         2jJC7b3Xv5bnLrgyLUIIXs2m0e0X9+uiqB4m5cfb0H1zCExUJjLI5TRSB/S+H0KM3YTN
         bObEsORPUfqq+9zKG6cL5sW8PQxAr8MZajgBPdLHQfPwzAXZnX+hwAJCbuvBL16b8Emd
         70eA==
MIME-Version: 1.0
X-Received: by 10.107.134.220 with SMTP id q89mr23566034ioi.90.1444572506311;
 Sun, 11 Oct 2015 07:08:26 -0700 (PDT)
Received: by 10.64.25.3 with HTTP; Sun, 11 Oct 2015 07:08:26 -0700 (PDT)
Date: Sun, 11 Oct 2015 10:08:26 -0400
Message-ID: <CALK=YjOyL_bQanJcfTSS99orcy+VtaXHEx3gU5wUpT7NdCXjAg@mail.gmail.com>
Subject: SSLProxyMachineCertificateFile: file '.../t/conf/ssl/ca/asf/proxy/client_ok.pem'
 does not exist or is empty
From: Eric Covener <covener@gmail.com>
To: Apache HTTP Server Development List <dev@httpd.apache.org>
Content-Type: text/plain; charset=UTF-8

I am trying to run the test framework with ssl and http2 on AIX.

There is no system openssl 1.0.2, and the system perl is 32-bit and
also rather old.

I have a 32-bit and 64-bit openssl squirreld away in ~. I initially
had some problems with httpd under the test framework and openssl
command line tools in my path, as well as some CPAN modules to be
forced to use the new openssl.  AFAICT they are all resolved.

But where I'm at now is this complaint at startup:

SSLProxyMachineCertificateFile: file
'/home/covener/SRC/httpd-framework/t/conf/ssl/ca/asf/proxy/client_ok.pem'
does not exist or is empty


That directory is empty, but no errors are issued after t/TEST -clean
and t/TEST and even removing everything under t/conf and svn up'ing.

Any ideas on debugging this?

From dev-return-84218-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Sun Oct 11 14:17:13 2015
Return-Path: <dev-return-84218-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id AF98B18B81
	for <apmail-httpd-dev-archive@www.apache.org>; Sun, 11 Oct 2015 14:17:13 +0000 (UTC)
Received: (qmail 97732 invoked by uid 500); 11 Oct 2015 14:17:13 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 97654 invoked by uid 500); 11 Oct 2015 14:17:13 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 97642 invoked by uid 99); 11 Oct 2015 14:17:13 -0000
Received: from Unknown (HELO spamd4-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 11 Oct 2015 14:17:13 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd4-us-west.apache.org (ASF Mail Server at spamd4-us-west.apache.org) with ESMTP id 98A84C0BD0
	for <dev@httpd.apache.org>; Sun, 11 Oct 2015 14:17:12 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd4-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.009
X-Spam-Level:
X-Spam-Status: No, score=-0.009 tagged_above=-999 required=6.31
	tests=[T_RP_MATCHES_RCVD=-0.01, URIBL_BLOCKED=0.001]
	autolearn=disabled
Received: from mx1-us-west.apache.org ([10.40.0.8])
	by localhost (spamd4-us-west.apache.org [10.40.0.11]) (amavisd-new, port 10024)
	with ESMTP id ruunXm6mDJHI for <dev@httpd.apache.org>;
	Sun, 11 Oct 2015 14:17:05 +0000 (UTC)
Received: from mailserver.kippdata.de (capsella.kippdata.de [195.227.30.149])
	by mx1-us-west.apache.org (ASF Mail Server at mx1-us-west.apache.org) with ESMTP id A32DA210B8
	for <dev@httpd.apache.org>; Sun, 11 Oct 2015 14:17:04 +0000 (UTC)
Received: from [10.0.110.6] ([192.168.2.104])
	by mailserver.kippdata.de (8.13.5/8.13.5) with ESMTP id t9BEH2Tm015446
	for <dev@httpd.apache.org>; Sun, 11 Oct 2015 16:17:03 +0200 (CEST)
Subject: Re: SSLProxyMachineCertificateFile: file
 '.../t/conf/ssl/ca/asf/proxy/client_ok.pem' does not exist or is empty
To: dev@httpd.apache.org
References: <CALK=YjOyL_bQanJcfTSS99orcy+VtaXHEx3gU5wUpT7NdCXjAg@mail.gmail.com>
From: Rainer Jung <rainer.jung@kippdata.de>
Message-ID: <561A6F59.8080708@kippdata.de>
Date: Sun, 11 Oct 2015 16:16:57 +0200
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:38.0) Gecko/20100101
 Thunderbird/38.3.0
MIME-Version: 1.0
In-Reply-To: <CALK=YjOyL_bQanJcfTSS99orcy+VtaXHEx3gU5wUpT7NdCXjAg@mail.gmail.com>
Content-Type: text/plain; charset=utf-8; format=flowed
Content-Transfer-Encoding: 7bit

Am 11.10.2015 um 16:08 schrieb Eric Covener:
> I am trying to run the test framework with ssl and http2 on AIX.
>
> There is no system openssl 1.0.2, and the system perl is 32-bit and
> also rather old.
>
> I have a 32-bit and 64-bit openssl squirreld away in ~. I initially
> had some problems with httpd under the test framework and openssl
> command line tools in my path, as well as some CPAN modules to be
> forced to use the new openssl.  AFAICT they are all resolved.
>
> But where I'm at now is this complaint at startup:
>
> SSLProxyMachineCertificateFile: file
> '/home/covener/SRC/httpd-framework/t/conf/ssl/ca/asf/proxy/client_ok.pem'
> does not exist or is empty
>
>
> That directory is empty, but no errors are issued after t/TEST -clean
> and t/TEST and even removing everything under t/conf and svn up'ing.
>
> Any ideas on debugging this?

I've got three pem files there:

     6275 Oct 11 12:04 t/conf/ssl/ca/asf/proxy/client_ok.pem
     5808 Oct 11 12:04 t/conf/ssl/ca/asf/proxy/client_revoked.pem
     5813 Oct 11 12:04 t/conf/ssl/ca/asf/proxy/client_snakeoil.pem

The generation e.g. of the ok file happens at the test startup. I get 
the following output (maybe because of t/TEST -v):

[   info] openssl genrsa -out keys/client_ok.pem  2048
Generating RSA private key, 2048 bit long modulus
..............+++
.........................................................................................+++
e is 65537 (0x10001)
[   info] openssl req -new -key keys/client_ok.pem -out 
csr/client_ok.csr -passin pass:httpd -passout pass:httpd -config 
conf/client_ok.cnf
[   info] openssl ca -policy policy_anything -in csr/client_ok.csr -out 
certs/client_ok.crt -passin pass:httpd -config conf/client_ok.cnf -batch 
  -extensions client_ok_ext
Using configuration from conf/client_ok.cnf
Check that the request matches the signature
Signature ok
The Subject's Distinguished Name is as follows
countryName           :PRINTABLE:'US'
stateOrProvinceName   :ASN.1 12:'California'
localityName          :ASN.1 12:'San Francisco'
organizationName      :ASN.1 12:'ASF'
organizationalUnitName:ASN.1 12:'httpd-test'
commonName            :ASN.1 12:'client_ok'
emailAddress          :IA5STRING:'test-dev@httpd.apache.org'
Certificate is to be certified until Oct 10 10:04:20 2016 GMT (365 days)

Write out database with 1 new entries
Data Base Updated
[   info] openssl pkcs12 -export -in certs/client_ok.crt -inkey 
keys/client_ok.pem -out export/client_ok.p12 -passin pass:httpd -passout 
pass:httpd
[   info] generating proxy cert: proxy/client_ok.pem


I think they are generated using

Apache-Test/lib/Apache/TestSSLCA.pm

which contains the following line:

my $openssl = $ENV{APACHE_TEST_OPENSSL_CMD} || 'openssl';

So maybe setting APACHE_TEST_OPENSSL_CMD to the full path of your 1.0.2 
openssl commandline binary will help.

Regards,

Rainer

From dev-return-84219-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Sun Oct 11 14:24:29 2015
Return-Path: <dev-return-84219-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id B22DB18B91
	for <apmail-httpd-dev-archive@www.apache.org>; Sun, 11 Oct 2015 14:24:29 +0000 (UTC)
Received: (qmail 1645 invoked by uid 500); 11 Oct 2015 14:24:29 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 1567 invoked by uid 500); 11 Oct 2015 14:24:29 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 1557 invoked by uid 99); 11 Oct 2015 14:24:29 -0000
Received: from Unknown (HELO spamd1-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 11 Oct 2015 14:24:29 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd1-us-west.apache.org (ASF Mail Server at spamd1-us-west.apache.org) with ESMTP id BF24FC2333
	for <dev@httpd.apache.org>; Sun, 11 Oct 2015 14:24:28 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd1-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.011
X-Spam-Level:
X-Spam-Status: No, score=-0.011 tagged_above=-999 required=6.31
	tests=[SPF_PASS=-0.001, T_RP_MATCHES_RCVD=-0.01] autolearn=disabled
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd1-us-west.apache.org [10.40.0.7]) (amavisd-new, port 10024)
	with ESMTP id cJ6VtrFAa7Ul for <dev@httpd.apache.org>;
	Sun, 11 Oct 2015 14:24:27 +0000 (UTC)
Received: from mailserver.kippdata.de (capsella.kippdata.de [195.227.30.149])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTP id D2906201F9
	for <dev@httpd.apache.org>; Sun, 11 Oct 2015 14:24:26 +0000 (UTC)
Received: from [10.0.110.6] ([192.168.2.104])
	by mailserver.kippdata.de (8.13.5/8.13.5) with ESMTP id t9BEOQt9015476
	for <dev@httpd.apache.org>; Sun, 11 Oct 2015 16:24:26 +0200 (CEST)
Subject: Re: 2.4.17 test failure for mod_http2 (test 30-31, misdirected)
Reply-To: dev@httpd.apache.org
References: <561A6C81.9030600@kippdata.de>
To: "dev@httpd.apache.org" <dev@httpd.apache.org>
From: Rainer Jung <rainer.jung@kippdata.de>
Message-ID: <561A7114.4030909@kippdata.de>
Date: Sun, 11 Oct 2015 16:24:20 +0200
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:38.0) Gecko/20100101
 Thunderbird/38.3.0
MIME-Version: 1.0
In-Reply-To: <561A6C81.9030600@kippdata.de>
Content-Type: text/plain; charset=utf-8; format=flowed
Content-Transfer-Encoding: 7bit

Am 11.10.2015 um 16:04 schrieb Rainer Jung:
> # testing : GET https://localhost:8532/misdirected
> # expected: 421
> # received: '404'
> not ok 30
> # Failed test 30 in t/modules/http2.t at line 129 fail #6
> # testing : GET https://localhost:8532/misdirected
> # expected: 421
> # received: '404'
> not ok 31
>
> Is this expected for 2.4? I didn't find anything about this in the
> trace8 error log.
>
> Any hints how to debug? I was using OpenSSL 1.0.2c in the client (Perl
> Test Framework) and 1.0.2d in the server.

Don't know whether it is related, but there is a small delta between 
trunk modules/ssl/ssl_engine_kernel.c and 2.4.x:

--- 2.4.x/modules/ssl/ssl_engine_kernel.c
+++ trunk/modules/ssl/ssl_engine_kernel.c
@@ -554,6 +529,8 @@
       */
      if ((dc->nVerifyClient != SSL_CVERIFY_UNSET) ||
          (sc->server->auth.verify_mode != SSL_CVERIFY_UNSET)) {
+        SSLSrvConfigRec *hssc = mySrvConfig(handshakeserver);
+
          /* remember old state */
          verify_old = SSL_get_verify_mode(ssl);
          /* configure new state */
@@ -617,8 +623,6 @@
              && renegotiate
              && ((verify & SSL_VERIFY_PEER) ||
                  (verify & SSL_VERIFY_FAIL_IF_NO_PEER_CERT))) {
-            SSLSrvConfigRec *hssc = mySrvConfig(handshakeserver);
-
  #define MODSSL_CFG_CA_NE(f, sc1, sc2) \
              (sc1->server->auth.f && \
               (!sc2->server->auth.f || \

Regards,

Rainer

From dev-return-84220-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Sun Oct 11 15:43:42 2015
Return-Path: <dev-return-84220-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 583DB18C8A
	for <apmail-httpd-dev-archive@www.apache.org>; Sun, 11 Oct 2015 15:43:42 +0000 (UTC)
Received: (qmail 75687 invoked by uid 500); 11 Oct 2015 15:43:41 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 75612 invoked by uid 500); 11 Oct 2015 15:43:41 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 75602 invoked by uid 99); 11 Oct 2015 15:43:41 -0000
Received: from Unknown (HELO spamd2-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 11 Oct 2015 15:43:41 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd2-us-west.apache.org (ASF Mail Server at spamd2-us-west.apache.org) with ESMTP id 2F5C51A0934
	for <dev@httpd.apache.org>; Sun, 11 Oct 2015 15:43:41 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd2-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.101
X-Spam-Level:
X-Spam-Status: No, score=-0.101 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RCVD_IN_MSPIKE_H2=-0.001, SPF_PASS=-0.001, URIBL_BLOCKED=0.001]
	autolearn=disabled
Authentication-Results: spamd2-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd2-us-west.apache.org [10.40.0.9]) (amavisd-new, port 10024)
	with ESMTP id V3kjcrOgvzAR for <dev@httpd.apache.org>;
	Sun, 11 Oct 2015 15:43:33 +0000 (UTC)
Received: from mail-qg0-f47.google.com (mail-qg0-f47.google.com [209.85.192.47])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id 8120B439BA
	for <dev@httpd.apache.org>; Sun, 11 Oct 2015 15:43:33 +0000 (UTC)
Received: by qgeb31 with SMTP id b31so3394088qge.0
        for <dev@httpd.apache.org>; Sun, 11 Oct 2015 08:43:27 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        bh=BzgTKLiKJZUEN8fVdS0jvD3T5vlCBMhqMGFUd3ZVsM0=;
        b=i8ppLRTyC+tXyHzbg+18s6EYP8hvdjIm4IA7s8XLfKlMuI9Eepfs9mqL4iEFa2IlsW
         u0/G7URHrkF/IZN4mtYxx3YeCaSm8Ioj62Pvt4OsZfqGoE8hlTTI6j+EHSbYgxXOUpmK
         bIhX5uJ37Qke7esefr9ZtktjvN1HtzrwF8HDBIuxun+pVzs2Iv+KIKgrOJoVHMpCXHFK
         U/Q4ZY2fGxGtqeL/4bPvCYIsJvAlIgxW40vrIjdtLCAKAL4wXzwJXxtKu7J44NSqNL34
         7T3y4wyibRx/oVsRStYcOCZY/Ft3vhgVuUFha9vofYVZTXIloUbtrLMO8qmgJmLPfBTa
         Q8RA==
MIME-Version: 1.0
X-Received: by 10.140.236.203 with SMTP id h194mr27041557qhc.73.1444578207013;
 Sun, 11 Oct 2015 08:43:27 -0700 (PDT)
Received: by 10.55.72.20 with HTTP; Sun, 11 Oct 2015 08:43:26 -0700 (PDT)
In-Reply-To: <561A7114.4030909@kippdata.de>
References: <561A6C81.9030600@kippdata.de>
	<561A7114.4030909@kippdata.de>
Date: Sun, 11 Oct 2015 17:43:26 +0200
Message-ID: <CAKQ1sVP-mXutGwe3nqwY5jMCnAysFPiAPrMcQWpkUFOCjR2HPA@mail.gmail.com>
Subject: Re: 2.4.17 test failure for mod_http2 (test 30-31, misdirected)
From: Yann Ylavic <ylavic.dev@gmail.com>
To: dev@httpd.apache.org
Content-Type: text/plain; charset=UTF-8

On Sun, Oct 11, 2015 at 4:24 PM, Rainer Jung <rainer.jung@kippdata.de> wrote:
> Am 11.10.2015 um 16:04 schrieb Rainer Jung:
>>
>> # testing : GET https://localhost:8532/misdirected
>> # expected: 421
>> # received: '404'
>> not ok 30
>> # Failed test 30 in t/modules/http2.t at line 129 fail #6
>> # testing : GET https://localhost:8532/misdirected
>> # expected: 421
>> # received: '404'
>> not ok 31
>>
>> Is this expected for 2.4? I didn't find anything about this in the
>> trace8 error log.
>>
>> Any hints how to debug? I was using OpenSSL 1.0.2c in the client (Perl
>> Test Framework) and 1.0.2d in the server.
>
>
> Don't know whether it is related, but there is a small delta between trunk
> modules/ssl/ssl_engine_kernel.c and 2.4.x:
>
> --- 2.4.x/modules/ssl/ssl_engine_kernel.c
> +++ trunk/modules/ssl/ssl_engine_kernel.c
> @@ -554,6 +529,8 @@
>       */
>      if ((dc->nVerifyClient != SSL_CVERIFY_UNSET) ||
>          (sc->server->auth.verify_mode != SSL_CVERIFY_UNSET)) {
> +        SSLSrvConfigRec *hssc = mySrvConfig(handshakeserver);
> +
>          /* remember old state */
>          verify_old = SSL_get_verify_mode(ssl);
>          /* configure new state */
> @@ -617,8 +623,6 @@
>              && renegotiate
>              && ((verify & SSL_VERIFY_PEER) ||
>                  (verify & SSL_VERIFY_FAIL_IF_NO_PEER_CERT))) {
> -            SSLSrvConfigRec *hssc = mySrvConfig(handshakeserver);
> -
>  #define MODSSL_CFG_CA_NE(f, sc1, sc2) \
>              (sc1->server->auth.f && \
>               (!sc2->server->auth.f || \

This change (hunk) may be the one which changed the 421 behaviour:

--- 2.4.x/modules/ssl/ssl_engine_kernel.c (original)
+++ 2.4.x/modules/ssl/ssl_engine_kernel.c Mon Sep 28 13:06:31 2015
@@ -196,11 +195,12 @@ int ssl_hook_ReadReq(request_rec *r)
                             " provided in HTTP request", servername);
                 return HTTP_BAD_REQUEST;
             }
-            rv = apr_parse_addr_port(&host, &scope_id, &port,
r->hostname, r->pool);
-            if (rv != APR_SUCCESS || scope_id) {
-                return HTTP_BAD_REQUEST;
-            }
-            if (strcasecmp(host, servername)) {
+            if (r->server != handshakeserver) {
+                /*
+                 * We are really not in Kansas anymore...
+                 * The request does not select the virtual host that was
+                 * selected by the SNI.
+                 */
                 ap_log_error(APLOG_MARK, APLOG_ERR, 0, r->server,
APLOGNO(02032)
                             "Hostname %s provided via SNI and
hostname %s provided"
                             " via HTTP are different", servername, host);

Previously we issued 421 based on the handshaken Host header vs the
current one, we now only control that request is still on the same
server.
So with no or the default vhost which can handle different requested
Host, there previously could be "refused" with 421 whereas now they
pass the ssl_Auth hook (which is OK since the SSL configuration
between the handshaken and this request has not changed).

Didn't look whether the test is still relevent (not much time for now,
sorry), but it might not be.
Hope this helps...

From dev-return-84221-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Sun Oct 11 16:07:35 2015
Return-Path: <dev-return-84221-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id AC2B318CF0
	for <apmail-httpd-dev-archive@www.apache.org>; Sun, 11 Oct 2015 16:07:35 +0000 (UTC)
Received: (qmail 98020 invoked by uid 500); 11 Oct 2015 16:07:35 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 97945 invoked by uid 500); 11 Oct 2015 16:07:35 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 97935 invoked by uid 99); 11 Oct 2015 16:07:35 -0000
Received: from Unknown (HELO spamd4-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 11 Oct 2015 16:07:35 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd4-us-west.apache.org (ASF Mail Server at spamd4-us-west.apache.org) with ESMTP id 9F168C059F
	for <dev@httpd.apache.org>; Sun, 11 Oct 2015 16:07:34 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd4-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.102
X-Spam-Level:
X-Spam-Status: No, score=-0.102 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RCVD_IN_MSPIKE_H2=-0.001, SPF_PASS=-0.001] autolearn=disabled
Authentication-Results: spamd4-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd4-us-west.apache.org [10.40.0.11]) (amavisd-new, port 10024)
	with ESMTP id DZy_FjPmG9IP for <dev@httpd.apache.org>;
	Sun, 11 Oct 2015 16:07:34 +0000 (UTC)
Received: from mail-qg0-f47.google.com (mail-qg0-f47.google.com [209.85.192.47])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id 3784D20D30
	for <dev@httpd.apache.org>; Sun, 11 Oct 2015 16:07:33 +0000 (UTC)
Received: by qgx61 with SMTP id 61so104885623qgx.3
        for <dev@httpd.apache.org>; Sun, 11 Oct 2015 09:07:32 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        bh=EsuYTTjfx8QonK3mGpnXFnSeM18nEaCVqEiSsukcGbM=;
        b=aIq6NJxZNOedaBIX+3vI1Mn0GmHo30+BnwJK52MuVB3M0QXIhGiQuVb4rJNLHzc/Bw
         SmFpd0n8mTOflwT/xZnmNgjjeX9H6TyZ8UuC9b5/hiRAYkw5aamKuG/iOFOftzjBlk8b
         4a2t2OIqgbA5hIce3som+KibQ+MO44StVqz+HFDOleaVYhXO4jY0c+t7h8qIIHykLSqD
         rJ6eraLnH4qoKuzY+DyjE2HgLOEGC9/9RCt81hAIqZ3RnBUNLH3W+BqCdqck8cw3s2iE
         Y+CTEtzBBD5ArlF2oElVoKIrreDMet4QOn/idNg1RPx3IoDKLTNH+JDlnvQCucgBIZAt
         //4g==
MIME-Version: 1.0
X-Received: by 10.141.23.9 with SMTP id z9mr28581984qhd.24.1444579652264; Sun,
 11 Oct 2015 09:07:32 -0700 (PDT)
Received: by 10.55.72.20 with HTTP; Sun, 11 Oct 2015 09:07:32 -0700 (PDT)
In-Reply-To: <CAKQ1sVP-mXutGwe3nqwY5jMCnAysFPiAPrMcQWpkUFOCjR2HPA@mail.gmail.com>
References: <561A6C81.9030600@kippdata.de>
	<561A7114.4030909@kippdata.de>
	<CAKQ1sVP-mXutGwe3nqwY5jMCnAysFPiAPrMcQWpkUFOCjR2HPA@mail.gmail.com>
Date: Sun, 11 Oct 2015 18:07:32 +0200
Message-ID: <CAKQ1sVP1jK1GK96afkV9uGERBUPK+18WqJWnqfiTsACF0Ax+cw@mail.gmail.com>
Subject: Re: 2.4.17 test failure for mod_http2 (test 30-31, misdirected)
From: Yann Ylavic <ylavic.dev@gmail.com>
To: dev@httpd.apache.org
Content-Type: text/plain; charset=UTF-8

On Sun, Oct 11, 2015 at 5:43 PM, Yann Ylavic <ylavic.dev@gmail.com> wrote:
>
> Didn't look whether the test is still relevent (not much time for now,
> sorry), but it might not be.

Took a quick look, I think for this tests to be relevent, the
corresponding requests would have to reach different vhosts than the
previous requests, which seems not be the case...

From dev-return-84222-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Sun Oct 11 16:26:31 2015
Return-Path: <dev-return-84222-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id D287718D39
	for <apmail-httpd-dev-archive@www.apache.org>; Sun, 11 Oct 2015 16:26:31 +0000 (UTC)
Received: (qmail 20736 invoked by uid 500); 11 Oct 2015 16:26:31 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 20668 invoked by uid 500); 11 Oct 2015 16:26:31 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 20658 invoked by uid 99); 11 Oct 2015 16:26:31 -0000
Received: from Unknown (HELO spamd3-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 11 Oct 2015 16:26:31 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd3-us-west.apache.org (ASF Mail Server at spamd3-us-west.apache.org) with ESMTP id E40FE180EB6
	for <dev@httpd.apache.org>; Sun, 11 Oct 2015 16:26:30 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd3-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.01
X-Spam-Level:
X-Spam-Status: No, score=-0.01 tagged_above=-999 required=6.31
	tests=[SPF_PASS=-0.001, T_RP_MATCHES_RCVD=-0.01, URIBL_BLOCKED=0.001]
	autolearn=disabled
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd3-us-west.apache.org [10.40.0.10]) (amavisd-new, port 10024)
	with ESMTP id jIxFYncmUYXd for <dev@httpd.apache.org>;
	Sun, 11 Oct 2015 16:26:23 +0000 (UTC)
Received: from mail.greenbytes.de (mail.greenbytes.de [217.91.35.233])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id CAB1B439BA
	for <dev@httpd.apache.org>; Sun, 11 Oct 2015 16:26:22 +0000 (UTC)
Received: from [192.168.178.52] (unknown [84.189.85.191])
	(using TLSv1 with cipher ECDHE-RSA-AES256-SHA (256/256 bits))
	(Client did not present a certificate)
	by mail.greenbytes.de (Postfix) with ESMTPSA id 303DC15A0440
	for <dev@httpd.apache.org>; Sun, 11 Oct 2015 18:26:14 +0200 (CEST)
From: Stefan Eissing <stefan.eissing@greenbytes.de>
Content-Type: text/plain;
	charset=us-ascii
Content-Transfer-Encoding: quoted-printable
Mime-Version: 1.0 (1.0)
Subject: Re: 2.4.17 test failure for mod_nntp_like_ssl when mod_http2 is loaded
Message-Id: <A350DE1E-8634-43AC-A054-3BCE181D6CA1@greenbytes.de>
Date: Sun, 11 Oct 2015 18:26:13 +0200
References: <561A64DC.5000809@kippdata.de>
In-Reply-To: <561A64DC.5000809@kippdata.de>
To: dev@httpd.apache.org
X-Mailer: iPhone Mail (13A452)

Hmm, will look into this. The module does a speculative non_blocking read on=
 the connection.=20

That happens only if H2Direct is "on", which I enabled to allow test when th=
e client does not have ALPN.

Then it can detect on the first 24 bytes if the client starts talking h2 rig=
ht away. Is doing a speculative read messing up the handshake?=20

This is not a usual config.=20

//stefan

> Am 11.10.2015 um 15:32 schrieb Rainer Jung <rainer.jung@kippdata.de>:
>=20
> I get a test failure for 2.4.17 in the mod_nntp_like_ssl part. Te failure h=
appens on Solaris. Note that the nntp tests are disabled by default on Linux=
 because of problems with the kernel accept filter, so that many of you wont=
 run this test and thus not observe the problem.
>=20
> The problems is that the test hangs after test 1 when waiting for the resu=
lt of 2. On Solaris 8 the behavior changes a bit, there test 2 succeeds, but=
 3-5 receive an empty result. The difference might be due to slight perl tes=
t differences. I suspect a common root cause.
>=20
> Maybe the problem is due to some unclean brigade handling in mod_nntp_like=
_ssl (in light of recent dev list discussions)? Or mod_http2 is simply incom=
patible with mod_nntp_like_ssl and we should disable that test if mod_http2 i=
s loaded?
>=20
> Trace 8 log comparison between good runs (without having mod_http2 loaded)=
 and bad runs (having mod_http2 loaded):
>=20
> Good run (no mod_http2)
>=20
> - end of handshake and immediately write 52 bytes
>=20
> [Sun Oct 11 14:53:47.911105 2015] [ssl:trace3] [pid 23096:tid 27] ssl_engi=
ne_kernel.c(1810): [client 127.0.0.1:50990] OpenSSL: Handshake: done
> [Sun Oct 11 14:53:47.911142 2015] [ssl:debug] [pid 23096:tid 27] ssl_engin=
e_kernel.c(1855): [client 127.0.0.1:50990] AH02041: Protocol: TLSv1.2, Ciphe=
r: ECDHE-RSA-AES256-GCM-SHA384 (256/256 bits)
> [Sun Oct 11 14:53:47.911212 2015] [ssl:trace4] [pid 23096:tid 27] ssl_engi=
ne_io.c(2088): [client 127.0.0.1:50990] OpenSSL: write 52/52 bytes to BIO#28=
61b8 [mem: 2bd45b] (BIO dump follows)
>=20
>=20
> Bad run (including mod_http2)
>=20
> - end of handshake
>=20
> [Sun Oct 11 14:54:38.550476 2015] [ssl:trace3] [pid 23133:tid 50] ssl_engi=
ne_kernel.c(1810): [client 127.0.0.1:50994] OpenSSL: Handshake: done
> [Sun Oct 11 14:54:38.550520 2015] [ssl:debug] [pid 23133:tid 50] ssl_engin=
e_kernel.c(1855): [client 127.0.0.1:50994] AH02041: Protocol: TLSv1.2, Ciphe=
r: ECDHE-RSA-AES256-GCM-SHA384 (256/256 bits)
> [Sun Oct 11 14:54:38.550555 2015] [core:trace6] [pid 23133:tid 50] core_fi=
lters.c(523): [client 127.0.0.1:50994] core_output_filter: flushing because o=
f FLUSH bucket
>=20
> - one minute established connection, but nothing else
>=20
> [Sun Oct 11 14:54:39.274796 2015] [mpm_event:trace6] [pid 23133:tid 53] ev=
ent.c(1577): connections: 1 (clogged: 0 write-completion: 0 keep-alive: 0 li=
ngering: 0 suspended: 0)
> ...
>=20
> - timeout after one minute and write 52 bytes
>=20
> [Sun Oct 11 14:55:38.551174 2015] [ssl:trace4] [pid 23133:tid 50] ssl_engi=
ne_io.c(2099): [client 127.0.0.1:50994] OpenSSL: I/O error, 5 bytes expected=
 to read on BIO#273480 [mem: 3624e3]
> [Sun Oct 11 14:55:38.551253 2015] [ssl:info] [pid 23133:tid 50] (70007)The=
 timeout specified has expired: [client 127.0.0.1:50994] AH01991: SSL input f=
ilter read failed.
> [Sun Oct 11 14:55:38.551316 2015] [http2:debug] [pid 23133:tid 50] h2_h2.c=
(189): (70007)The timeout specified has expired: [client 127.0.0.1:50994] h2=
_h2, error reading 24 bytes speculative
> [Sun Oct 11 14:55:38.551344 2015] [http2:trace1] [pid 23133:tid 50] h2_h2.=
c(205): [client 127.0.0.1:50994] h2_h2, declined
> [Sun Oct 11 14:55:38.551433 2015] [ssl:trace4] [pid 23133:tid 50] ssl_engi=
ne_io.c(2088): [client 127.0.0.1:50994] OpenSSL: write 52/52 bytes to BIO#28=
2488 [mem: 36a633] (BIO dump follows)
>=20
> Regards,
>=20
> Rainer

From dev-return-84223-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Sun Oct 11 17:00:53 2015
Return-Path: <dev-return-84223-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 11F5018DB8
	for <apmail-httpd-dev-archive@www.apache.org>; Sun, 11 Oct 2015 17:00:53 +0000 (UTC)
Received: (qmail 63966 invoked by uid 500); 11 Oct 2015 17:00:52 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 63887 invoked by uid 500); 11 Oct 2015 17:00:52 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 63877 invoked by uid 99); 11 Oct 2015 17:00:52 -0000
Received: from Unknown (HELO spamd2-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 11 Oct 2015 17:00:52 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd2-us-west.apache.org (ASF Mail Server at spamd2-us-west.apache.org) with ESMTP id 2CC6C1A0950
	for <dev@httpd.apache.org>; Sun, 11 Oct 2015 17:00:52 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd2-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.01
X-Spam-Level:
X-Spam-Status: No, score=-0.01 tagged_above=-999 required=6.31
	tests=[SPF_PASS=-0.001, T_RP_MATCHES_RCVD=-0.01, URIBL_BLOCKED=0.001]
	autolearn=disabled
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd2-us-west.apache.org [10.40.0.9]) (amavisd-new, port 10024)
	with ESMTP id NXJh94p6VlBb for <dev@httpd.apache.org>;
	Sun, 11 Oct 2015 17:00:43 +0000 (UTC)
Received: from mail.greenbytes.de (mail.greenbytes.de [217.91.35.233])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id 109F44357F
	for <dev@httpd.apache.org>; Sun, 11 Oct 2015 17:00:43 +0000 (UTC)
Received: from [192.168.178.41] (unknown [84.189.85.191])
	(using TLSv1 with cipher ECDHE-RSA-AES256-SHA (256/256 bits))
	(Client did not present a certificate)
	by mail.greenbytes.de (Postfix) with ESMTPSA id D5EF415A047E
	for <dev@httpd.apache.org>; Sun, 11 Oct 2015 19:00:41 +0200 (CEST)
Content-Type: text/plain; charset=us-ascii
Mime-Version: 1.0 (Mac OS X Mail 9.0 \(3094\))
Subject: Re: 2.4.17 test failure for mod_nntp_like_ssl when mod_http2 is loaded
From: Stefan Eissing <stefan.eissing@greenbytes.de>
In-Reply-To: <A350DE1E-8634-43AC-A054-3BCE181D6CA1@greenbytes.de>
Date: Sun, 11 Oct 2015 19:00:41 +0200
Content-Transfer-Encoding: quoted-printable
Message-Id: <A873A60B-662E-487A-BA96-C58ED4F4E04E@greenbytes.de>
References: <561A64DC.5000809@kippdata.de> <A350DE1E-8634-43AC-A054-3BCE181D6CA1@greenbytes.de>
To: dev@httpd.apache.org
X-Mailer: Apple Mail (2.3094)

Ok, analyzed the code. Here is what seems to be happening:

- mod_http2, in the connection hook, does a blocking, speculative read =
to
  a) make sure the ALPN has been triggered
  b) check for the magic 24 bytes h2 preface in case H2Direct is on
  This works fine for HTTP/1.1 or protocols where the client starts =
sending bytes right away.
  If the client waits for something from the server first, it gives a =
timeout. This seems to be the NNTP case.

A. The important part is to get the ALPN triggered without a blocking =
read. Any advice from our TLS experts?
B. When that is solved, the check for the 24 bytes can be folder deeper =
to just happen on a H2Direct enabled server/vhost.

The fix for A ideally should be placed into mod_ssl, saving other =
protocol-selection code to mess with it, I think. But for the short =
term, I'd be happy with any advice on how to fix it in mod_http2 alone.

//Stefan


> Am 11.10.2015 um 18:26 schrieb Stefan Eissing =
<stefan.eissing@greenbytes.de>:
>=20
> Hmm, will look into this. The module does a speculative non_blocking =
read on the connection.=20
>=20
> That happens only if H2Direct is "on", which I enabled to allow test =
when the client does not have ALPN.
>=20
> Then it can detect on the first 24 bytes if the client starts talking =
h2 right away. Is doing a speculative read messing up the handshake?=20
>=20
> This is not a usual config.=20
>=20
> //stefan
>=20
>> Am 11.10.2015 um 15:32 schrieb Rainer Jung <rainer.jung@kippdata.de>:
>>=20
>> I get a test failure for 2.4.17 in the mod_nntp_like_ssl part. Te =
failure happens on Solaris. Note that the nntp tests are disabled by =
default on Linux because of problems with the kernel accept filter, so =
that many of you wont run this test and thus not observe the problem.
>>=20
>> The problems is that the test hangs after test 1 when waiting for the =
result of 2. On Solaris 8 the behavior changes a bit, there test 2 =
succeeds, but 3-5 receive an empty result. The difference might be due =
to slight perl test differences. I suspect a common root cause.
>>=20
>> Maybe the problem is due to some unclean brigade handling in =
mod_nntp_like_ssl (in light of recent dev list discussions)? Or =
mod_http2 is simply incompatible with mod_nntp_like_ssl and we should =
disable that test if mod_http2 is loaded?
>>=20
>> Trace 8 log comparison between good runs (without having mod_http2 =
loaded) and bad runs (having mod_http2 loaded):
>>=20
>> Good run (no mod_http2)
>>=20
>> - end of handshake and immediately write 52 bytes
>>=20
>> [Sun Oct 11 14:53:47.911105 2015] [ssl:trace3] [pid 23096:tid 27] =
ssl_engine_kernel.c(1810): [client 127.0.0.1:50990] OpenSSL: Handshake: =
done
>> [Sun Oct 11 14:53:47.911142 2015] [ssl:debug] [pid 23096:tid 27] =
ssl_engine_kernel.c(1855): [client 127.0.0.1:50990] AH02041: Protocol: =
TLSv1.2, Cipher: ECDHE-RSA-AES256-GCM-SHA384 (256/256 bits)
>> [Sun Oct 11 14:53:47.911212 2015] [ssl:trace4] [pid 23096:tid 27] =
ssl_engine_io.c(2088): [client 127.0.0.1:50990] OpenSSL: write 52/52 =
bytes to BIO#2861b8 [mem: 2bd45b] (BIO dump follows)
>>=20
>>=20
>> Bad run (including mod_http2)
>>=20
>> - end of handshake
>>=20
>> [Sun Oct 11 14:54:38.550476 2015] [ssl:trace3] [pid 23133:tid 50] =
ssl_engine_kernel.c(1810): [client 127.0.0.1:50994] OpenSSL: Handshake: =
done
>> [Sun Oct 11 14:54:38.550520 2015] [ssl:debug] [pid 23133:tid 50] =
ssl_engine_kernel.c(1855): [client 127.0.0.1:50994] AH02041: Protocol: =
TLSv1.2, Cipher: ECDHE-RSA-AES256-GCM-SHA384 (256/256 bits)
>> [Sun Oct 11 14:54:38.550555 2015] [core:trace6] [pid 23133:tid 50] =
core_filters.c(523): [client 127.0.0.1:50994] core_output_filter: =
flushing because of FLUSH bucket
>>=20
>> - one minute established connection, but nothing else
>>=20
>> [Sun Oct 11 14:54:39.274796 2015] [mpm_event:trace6] [pid 23133:tid =
53] event.c(1577): connections: 1 (clogged: 0 write-completion: 0 =
keep-alive: 0 lingering: 0 suspended: 0)
>> ...
>>=20
>> - timeout after one minute and write 52 bytes
>>=20
>> [Sun Oct 11 14:55:38.551174 2015] [ssl:trace4] [pid 23133:tid 50] =
ssl_engine_io.c(2099): [client 127.0.0.1:50994] OpenSSL: I/O error, 5 =
bytes expected to read on BIO#273480 [mem: 3624e3]
>> [Sun Oct 11 14:55:38.551253 2015] [ssl:info] [pid 23133:tid 50] =
(70007)The timeout specified has expired: [client 127.0.0.1:50994] =
AH01991: SSL input filter read failed.
>> [Sun Oct 11 14:55:38.551316 2015] [http2:debug] [pid 23133:tid 50] =
h2_h2.c(189): (70007)The timeout specified has expired: [client =
127.0.0.1:50994] h2_h2, error reading 24 bytes speculative
>> [Sun Oct 11 14:55:38.551344 2015] [http2:trace1] [pid 23133:tid 50] =
h2_h2.c(205): [client 127.0.0.1:50994] h2_h2, declined
>> [Sun Oct 11 14:55:38.551433 2015] [ssl:trace4] [pid 23133:tid 50] =
ssl_engine_io.c(2088): [client 127.0.0.1:50994] OpenSSL: write 52/52 =
bytes to BIO#282488 [mem: 36a633] (BIO dump follows)
>>=20
>> Regards,
>>=20
>> Rainer


From dev-return-84224-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Sun Oct 11 17:04:42 2015
Return-Path: <dev-return-84224-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 9C55618DD1
	for <apmail-httpd-dev-archive@www.apache.org>; Sun, 11 Oct 2015 17:04:42 +0000 (UTC)
Received: (qmail 67931 invoked by uid 500); 11 Oct 2015 17:04:37 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 67858 invoked by uid 500); 11 Oct 2015 17:04:36 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 67848 invoked by uid 99); 11 Oct 2015 17:04:36 -0000
Received: from Unknown (HELO spamd2-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 11 Oct 2015 17:04:36 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd2-us-west.apache.org (ASF Mail Server at spamd2-us-west.apache.org) with ESMTP id 7C3391A0939
	for <dev@httpd.apache.org>; Sun, 11 Oct 2015 17:04:36 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd2-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 1.49
X-Spam-Level: *
X-Spam-Status: No, score=1.49 tagged_above=-999 required=6.31
	tests=[KAM_STOCKGEN=1.5, SPF_PASS=-0.001, T_RP_MATCHES_RCVD=-0.01,
	URIBL_BLOCKED=0.001] autolearn=disabled
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd2-us-west.apache.org [10.40.0.9]) (amavisd-new, port 10024)
	with ESMTP id rxeZRazvKWgN for <dev@httpd.apache.org>;
	Sun, 11 Oct 2015 17:04:28 +0000 (UTC)
Received: from mail.greenbytes.de (mail.greenbytes.de [217.91.35.233])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id 50B2D439B5
	for <dev@httpd.apache.org>; Sun, 11 Oct 2015 17:04:28 +0000 (UTC)
Received: from [192.168.178.41] (unknown [84.189.85.191])
	(using TLSv1 with cipher ECDHE-RSA-AES256-SHA (256/256 bits))
	(Client did not present a certificate)
	by mail.greenbytes.de (Postfix) with ESMTPSA id 39DA715A043A
	for <dev@httpd.apache.org>; Sun, 11 Oct 2015 19:04:27 +0200 (CEST)
Content-Type: text/plain; charset=windows-1252
Mime-Version: 1.0 (Mac OS X Mail 9.0 \(3094\))
Subject: Re: A small wrinkle in latest r1707735 update to httpd-trunk\modules\http2\h2_util.c
From: Stefan Eissing <stefan.eissing@greenbytes.de>
In-Reply-To: <561975AC.5070405@gknw.net>
Date: Sun, 11 Oct 2015 19:04:26 +0200
Content-Transfer-Encoding: quoted-printable
Message-Id: <3D9E396F-BF20-4741-81A9-59038FE76BA2@greenbytes.de>
References: <5618F716.30908@gknw.net> <432220E7-4319-40D7-AB6F-206CE59D7CA2@greenbytes.de> <561975AC.5070405@gknw.net>
To: dev@httpd.apache.org
X-Mailer: Apple Mail (2.3094)

Fixed in r1708002.

> Am 10.10.2015 um 22:31 schrieb NormW <normw@gknw.net>:
>=20
> On 11/10/2015 4:45 AM, Stefan Eissing wrote:
>> Ok, will add that. This is only in trunk. 2.4.x should compile for =
you.
> Correct.
> Norm.
>>=20
>>> Am 10.10.2015 um 13:31 schrieb NormW <normw@gknw.net>:
>>>=20
>>> Hmmmm,
>>>> CC   h2_worker.c
>>>> CC   h2_workers.c
>>>> CC   mod_http2.c
>>>> GEN  obj_release/mod_http2_link.opt
>>>> LINK obj_release/mod_http2.nlm
>>>> ### mwldnlm Linker Error:
>>>> #   Undefined symbol: APR_BUCKET_IS_MMAP in
>>>> #   h2_util.o
>>>=20
>>> In apr-util\include\apr_buckets.h:
>>>> #if APR_HAS_MMAP
>>>> /**
>>>> * Determine if a bucket is a MMAP bucket
>>>> * @param e The bucket to inspect
>>>> * @return true or false
>>>> */
>>>> #define APR_BUCKET_IS_MMAP(e)        ((e)->type =3D=3D =
&apr_bucket_type_mmap)
>>>> #endif
>>>=20
>>> :-( MMAP is (sadly) not a feature of NetWare. If the http2 experts =
assert the entire http2 module is a dud without MMAP support, I am not =
in a position or mind to oppose dropping NetWare 'support' for http2 =
entirely.
>>>=20
>>> Alternatively, something like this in h2_util.c MAY be good enough :
>>>>                }
>>>> ++ #if APR_HAS_MMAP
>>>>                else if (APR_BUCKET_IS_MMAP(b)) {
>>>>                    btype =3D "mmap";
>>>>                }
>>>> ++ #endif
>>>=20
>>> Norm
>>=20
>=20


From dev-return-84225-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Sun Oct 11 17:09:03 2015
Return-Path: <dev-return-84225-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 1CC4418DDE
	for <apmail-httpd-dev-archive@www.apache.org>; Sun, 11 Oct 2015 17:09:03 +0000 (UTC)
Received: (qmail 71468 invoked by uid 500); 11 Oct 2015 17:08:50 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 71400 invoked by uid 500); 11 Oct 2015 17:08:50 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 71386 invoked by uid 99); 11 Oct 2015 17:08:50 -0000
Received: from Unknown (HELO spamd1-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 11 Oct 2015 17:08:49 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd1-us-west.apache.org (ASF Mail Server at spamd1-us-west.apache.org) with ESMTP id 9961DC55CC
	for <dev@httpd.apache.org>; Sun, 11 Oct 2015 17:08:49 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd1-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.101
X-Spam-Level:
X-Spam-Status: No, score=-0.101 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RCVD_IN_MSPIKE_H2=-0.001, SPF_PASS=-0.001, URIBL_BLOCKED=0.001]
	autolearn=disabled
Authentication-Results: spamd1-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd1-us-west.apache.org [10.40.0.7]) (amavisd-new, port 10024)
	with ESMTP id PHXFOFq2nIsE for <dev@httpd.apache.org>;
	Sun, 11 Oct 2015 17:08:49 +0000 (UTC)
Received: from mail-qg0-f51.google.com (mail-qg0-f51.google.com [209.85.192.51])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id C4503439B5
	for <dev@httpd.apache.org>; Sun, 11 Oct 2015 17:08:48 +0000 (UTC)
Received: by qgx61 with SMTP id 61so105500328qgx.3
        for <dev@httpd.apache.org>; Sun, 11 Oct 2015 10:08:48 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        bh=TZ5crS+Ww7y/C17carFV57A+0ZYiw4UPf0gzcXcqRnM=;
        b=tzVoClkJ4ZyRvAPBjW/F52CwibtsVq8tlI+gxz1s7ciMybjrb1/XstX3NMP4Xxjsp7
         +E4Vbl6XJ64ZVP6t8xdHtMOFbZKy5YB8ZQCYaJ+9m0rvWdHaIzYaLi/I6iAgRVqqIzTy
         0/bLy9Z9l2kvITb6TM51WlryDlshZ+PgxA0i6cA89NT+yjakn6ogbgsz1RMJwXBgv3rA
         OLiOgajFmjGCrxLwaFnd/2ZTXst0IWOzzKkweIviRMh+QdOeKxAVCsZIj+vDeP+HOwPI
         u3W2pnxEcZID+EkCzhvjBr6jiumZZ7/IwmxjhMHcRrYOVVijbtxxv8NkDDRoFerdCbw/
         GySw==
MIME-Version: 1.0
X-Received: by 10.140.131.198 with SMTP id 189mr29104760qhd.83.1444583328496;
 Sun, 11 Oct 2015 10:08:48 -0700 (PDT)
Received: by 10.55.72.20 with HTTP; Sun, 11 Oct 2015 10:08:48 -0700 (PDT)
In-Reply-To: <A873A60B-662E-487A-BA96-C58ED4F4E04E@greenbytes.de>
References: <561A64DC.5000809@kippdata.de>
	<A350DE1E-8634-43AC-A054-3BCE181D6CA1@greenbytes.de>
	<A873A60B-662E-487A-BA96-C58ED4F4E04E@greenbytes.de>
Date: Sun, 11 Oct 2015 19:08:48 +0200
Message-ID: <CAKQ1sVO5+13U2xcVc-A_1geQChnSikxeosTWubm07yDrvpzMXw@mail.gmail.com>
Subject: Re: 2.4.17 test failure for mod_nntp_like_ssl when mod_http2 is loaded
From: Yann Ylavic <ylavic.dev@gmail.com>
To: dev@httpd.apache.org
Content-Type: text/plain; charset=UTF-8

On Sun, Oct 11, 2015 at 7:00 PM, Stefan Eissing
<stefan.eissing@greenbytes.de> wrote:
> Ok, analyzed the code. Here is what seems to be happening:
>
> - mod_http2, in the connection hook, does a blocking, speculative read to
>   a) make sure the ALPN has been triggered
>   b) check for the magic 24 bytes h2 preface in case H2Direct is on
>   This works fine for HTTP/1.1 or protocols where the client starts sending bytes right away.
>   If the client waits for something from the server first, it gives a timeout. This seems to be the NNTP case.

Does it make any sense to enable h2 on NNTP?

From dev-return-84226-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Sun Oct 11 17:11:39 2015
Return-Path: <dev-return-84226-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 2A70718DE9
	for <apmail-httpd-dev-archive@www.apache.org>; Sun, 11 Oct 2015 17:11:39 +0000 (UTC)
Received: (qmail 74588 invoked by uid 500); 11 Oct 2015 17:11:38 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 74511 invoked by uid 500); 11 Oct 2015 17:11:38 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 74499 invoked by uid 99); 11 Oct 2015 17:11:38 -0000
Received: from Unknown (HELO spamd4-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 11 Oct 2015 17:11:38 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd4-us-west.apache.org (ASF Mail Server at spamd4-us-west.apache.org) with ESMTP id 4569AC0BD0
	for <dev@httpd.apache.org>; Sun, 11 Oct 2015 17:11:38 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd4-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.01
X-Spam-Level:
X-Spam-Status: No, score=-0.01 tagged_above=-999 required=6.31
	tests=[SPF_PASS=-0.001, T_RP_MATCHES_RCVD=-0.01, URIBL_BLOCKED=0.001]
	autolearn=disabled
Received: from mx1-us-west.apache.org ([10.40.0.8])
	by localhost (spamd4-us-west.apache.org [10.40.0.11]) (amavisd-new, port 10024)
	with ESMTP id R6C_C2Ax_1bq for <dev@httpd.apache.org>;
	Sun, 11 Oct 2015 17:11:31 +0000 (UTC)
Received: from mail.greenbytes.de (mail.greenbytes.de [217.91.35.233])
	by mx1-us-west.apache.org (ASF Mail Server at mx1-us-west.apache.org) with ESMTPS id 029A9210B8
	for <dev@httpd.apache.org>; Sun, 11 Oct 2015 17:11:30 +0000 (UTC)
Received: from [192.168.178.41] (unknown [84.189.85.191])
	(using TLSv1 with cipher ECDHE-RSA-AES256-SHA (256/256 bits))
	(Client did not present a certificate)
	by mail.greenbytes.de (Postfix) with ESMTPSA id 2CB7A15A043A
	for <dev@httpd.apache.org>; Sun, 11 Oct 2015 19:11:22 +0200 (CEST)
Content-Type: text/plain; charset=us-ascii
Mime-Version: 1.0 (Mac OS X Mail 9.0 \(3094\))
Subject: Re: 2.4.17 test failure for mod_nntp_like_ssl when mod_http2 is loaded
From: Stefan Eissing <stefan.eissing@greenbytes.de>
In-Reply-To: <CAKQ1sVO5+13U2xcVc-A_1geQChnSikxeosTWubm07yDrvpzMXw@mail.gmail.com>
Date: Sun, 11 Oct 2015 19:11:21 +0200
Content-Transfer-Encoding: quoted-printable
Message-Id: <B1E3C336-57A0-4487-A084-93BCA8E7CC70@greenbytes.de>
References: <561A64DC.5000809@kippdata.de> <A350DE1E-8634-43AC-A054-3BCE181D6CA1@greenbytes.de> <A873A60B-662E-487A-BA96-C58ED4F4E04E@greenbytes.de> <CAKQ1sVO5+13U2xcVc-A_1geQChnSikxeosTWubm07yDrvpzMXw@mail.gmail.com>
To: dev@httpd.apache.org
X-Mailer: Apple Mail (2.3094)

Don't think so. But loading the module should do no harm, I think. And =
it does now.

I am not familiar with the NNTP use case. Is this always an NNTP-only =
server then?

> Am 11.10.2015 um 19:08 schrieb Yann Ylavic <ylavic.dev@gmail.com>:
>=20
> On Sun, Oct 11, 2015 at 7:00 PM, Stefan Eissing
> <stefan.eissing@greenbytes.de> wrote:
>> Ok, analyzed the code. Here is what seems to be happening:
>>=20
>> - mod_http2, in the connection hook, does a blocking, speculative =
read to
>>  a) make sure the ALPN has been triggered
>>  b) check for the magic 24 bytes h2 preface in case H2Direct is on
>>  This works fine for HTTP/1.1 or protocols where the client starts =
sending bytes right away.
>>  If the client waits for something from the server first, it gives a =
timeout. This seems to be the NNTP case.
>=20
> Does it make any sense to enable h2 on NNTP?


From dev-return-84227-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Sun Oct 11 17:15:35 2015
Return-Path: <dev-return-84227-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 94F4418DF6
	for <apmail-httpd-dev-archive@www.apache.org>; Sun, 11 Oct 2015 17:15:35 +0000 (UTC)
Received: (qmail 79014 invoked by uid 500); 11 Oct 2015 17:15:34 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 78946 invoked by uid 500); 11 Oct 2015 17:15:34 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 78935 invoked by uid 99); 11 Oct 2015 17:15:34 -0000
Received: from Unknown (HELO spamd3-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 11 Oct 2015 17:15:34 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd3-us-west.apache.org (ASF Mail Server at spamd3-us-west.apache.org) with ESMTP id 657DA180EB6
	for <dev@httpd.apache.org>; Sun, 11 Oct 2015 17:15:34 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd3-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.12
X-Spam-Level:
X-Spam-Status: No, score=-0.12 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RCVD_IN_MSPIKE_H3=-0.01, RCVD_IN_MSPIKE_WL=-0.01, SPF_PASS=-0.001,
	URIBL_BLOCKED=0.001] autolearn=disabled
Authentication-Results: spamd3-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd3-us-west.apache.org [10.40.0.10]) (amavisd-new, port 10024)
	with ESMTP id LZQKMCR53oI6 for <dev@httpd.apache.org>;
	Sun, 11 Oct 2015 17:15:26 +0000 (UTC)
Received: from mail-qk0-f178.google.com (mail-qk0-f178.google.com [209.85.220.178])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id 2F1B320FE7
	for <dev@httpd.apache.org>; Sun, 11 Oct 2015 17:15:26 +0000 (UTC)
Received: by qkht68 with SMTP id t68so50999180qkh.3
        for <dev@httpd.apache.org>; Sun, 11 Oct 2015 10:15:19 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        bh=aE/lXcwexhcFH8fuyTfM6ZWMp7XN41ftVYv0xloebAA=;
        b=YV7V/BbDWxg0KM/9sVtyR+o9zrrmptfruvDNpuGG7PTUjpsu9CmZS8Suwo8NV7WOt2
         8O/7Yx89QQaVtO+EqSLzI9T4ic0lrK3pup3dzBt6RKBz8ZOrQRftaJe5riyp0M/CI/As
         8lfDuRP3HQyDrXLk9OL5fzYtOMwNzAMcbNlIdBBndQt7ygUPK4AwLUCyHYBq+Ked2lTW
         pcOZa3mqZ5TQUj1vmMlrOLHig/uMZN+jIm8pVjgmuKaK5gI1AWQUAr0LhLuXQ8+5awc9
         4pF6e2gk2jFDc3PblnTFFQbJleEk8dN6o0qktMeseXAO5dfGxQW+Tm5CJC5uzjyiB8d+
         FBTA==
MIME-Version: 1.0
X-Received: by 10.55.209.93 with SMTP id s90mr27814040qki.55.1444583719722;
 Sun, 11 Oct 2015 10:15:19 -0700 (PDT)
Received: by 10.55.72.20 with HTTP; Sun, 11 Oct 2015 10:15:19 -0700 (PDT)
In-Reply-To: <B1E3C336-57A0-4487-A084-93BCA8E7CC70@greenbytes.de>
References: <561A64DC.5000809@kippdata.de>
	<A350DE1E-8634-43AC-A054-3BCE181D6CA1@greenbytes.de>
	<A873A60B-662E-487A-BA96-C58ED4F4E04E@greenbytes.de>
	<CAKQ1sVO5+13U2xcVc-A_1geQChnSikxeosTWubm07yDrvpzMXw@mail.gmail.com>
	<B1E3C336-57A0-4487-A084-93BCA8E7CC70@greenbytes.de>
Date: Sun, 11 Oct 2015 19:15:19 +0200
Message-ID: <CAKQ1sVNabR-048ozc7qy9MhMCqsC7PXYwzvuX=+mCDEKRriZbQ@mail.gmail.com>
Subject: Re: 2.4.17 test failure for mod_nntp_like_ssl when mod_http2 is loaded
From: Yann Ylavic <ylavic.dev@gmail.com>
To: dev@httpd.apache.org
Content-Type: text/plain; charset=UTF-8

On Sun, Oct 11, 2015 at 7:11 PM, Stefan Eissing
<stefan.eissing@greenbytes.de> wrote:
> Don't think so. But loading the module should do no harm, I think. And it does now.

Isn't configuring H2Direct on which harms?

From dev-return-84228-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Sun Oct 11 17:19:37 2015
Return-Path: <dev-return-84228-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id B7DD218E00
	for <apmail-httpd-dev-archive@www.apache.org>; Sun, 11 Oct 2015 17:19:37 +0000 (UTC)
Received: (qmail 81535 invoked by uid 500); 11 Oct 2015 17:19:37 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 81458 invoked by uid 500); 11 Oct 2015 17:19:37 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 81446 invoked by uid 99); 11 Oct 2015 17:19:37 -0000
Received: from Unknown (HELO spamd1-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 11 Oct 2015 17:19:37 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd1-us-west.apache.org (ASF Mail Server at spamd1-us-west.apache.org) with ESMTP id D4B7EC201B
	for <dev@httpd.apache.org>; Sun, 11 Oct 2015 17:19:36 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd1-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.01
X-Spam-Level:
X-Spam-Status: No, score=-0.01 tagged_above=-999 required=6.31
	tests=[SPF_PASS=-0.001, T_RP_MATCHES_RCVD=-0.01, URIBL_BLOCKED=0.001]
	autolearn=disabled
Received: from mx1-us-west.apache.org ([10.40.0.8])
	by localhost (spamd1-us-west.apache.org [10.40.0.7]) (amavisd-new, port 10024)
	with ESMTP id aysPJr_RTJ0w for <dev@httpd.apache.org>;
	Sun, 11 Oct 2015 17:19:27 +0000 (UTC)
Received: from mailserver.kippdata.de (capsella.kippdata.de [195.227.30.149])
	by mx1-us-west.apache.org (ASF Mail Server at mx1-us-west.apache.org) with ESMTP id 278252031C
	for <dev@httpd.apache.org>; Sun, 11 Oct 2015 17:19:26 +0000 (UTC)
Received: from [10.0.110.6] ([192.168.2.104])
	by mailserver.kippdata.de (8.13.5/8.13.5) with ESMTP id t9BHJPBo016519
	for <dev@httpd.apache.org>; Sun, 11 Oct 2015 19:19:25 +0200 (CEST)
Subject: Re: 2.4.17 test failure for mod_nntp_like_ssl when mod_http2 is
 loaded
To: dev@httpd.apache.org
References: <561A64DC.5000809@kippdata.de>
 <A350DE1E-8634-43AC-A054-3BCE181D6CA1@greenbytes.de>
 <A873A60B-662E-487A-BA96-C58ED4F4E04E@greenbytes.de>
 <CAKQ1sVO5+13U2xcVc-A_1geQChnSikxeosTWubm07yDrvpzMXw@mail.gmail.com>
From: Rainer Jung <rainer.jung@kippdata.de>
Message-ID: <561A9A18.70904@kippdata.de>
Date: Sun, 11 Oct 2015 19:19:20 +0200
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:38.0) Gecko/20100101
 Thunderbird/38.3.0
MIME-Version: 1.0
In-Reply-To: <CAKQ1sVO5+13U2xcVc-A_1geQChnSikxeosTWubm07yDrvpzMXw@mail.gmail.com>
Content-Type: text/plain; charset=utf-8; format=flowed
Content-Transfer-Encoding: 7bit

Am 11.10.2015 um 19:08 schrieb Yann Ylavic:
> On Sun, Oct 11, 2015 at 7:00 PM, Stefan Eissing
> <stefan.eissing@greenbytes.de> wrote:
>> Ok, analyzed the code. Here is what seems to be happening:
>>
>> - mod_http2, in the connection hook, does a blocking, speculative read to
>>    a) make sure the ALPN has been triggered
>>    b) check for the magic 24 bytes h2 preface in case H2Direct is on
>>    This works fine for HTTP/1.1 or protocols where the client starts sending bytes right away.
>>    If the client waits for something from the server first, it gives a timeout. This seems to be the NNTP case.
>
> Does it make any sense to enable h2 on NNTP?

For now I disabled the nntp over ssl test when mod_http2 is loaded 
(disabled in the test file) so that the test suite does not hang.

I guess we don't want to test h2 and NNTP on the same requests, but it 
would be ideal, if the modules would not disturb each other, if they 
serve different vhosts in the same Apache. If that's not possible and 
doesn't actually indicate a bigger problem, I'm personally fine with 
that incompatibility with protocols that show "server sends first" behavior.

Regards,

Rainer




From dev-return-84229-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Sun Oct 11 17:23:22 2015
Return-Path: <dev-return-84229-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 0EDFB18E11
	for <apmail-httpd-dev-archive@www.apache.org>; Sun, 11 Oct 2015 17:23:22 +0000 (UTC)
Received: (qmail 85193 invoked by uid 500); 11 Oct 2015 17:23:21 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 85125 invoked by uid 500); 11 Oct 2015 17:23:21 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 85114 invoked by uid 99); 11 Oct 2015 17:23:21 -0000
Received: from Unknown (HELO spamd3-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 11 Oct 2015 17:23:21 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd3-us-west.apache.org (ASF Mail Server at spamd3-us-west.apache.org) with ESMTP id D6888180EC8
	for <dev@httpd.apache.org>; Sun, 11 Oct 2015 17:23:20 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd3-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.01
X-Spam-Level:
X-Spam-Status: No, score=-0.01 tagged_above=-999 required=6.31
	tests=[SPF_PASS=-0.001, T_RP_MATCHES_RCVD=-0.01, URIBL_BLOCKED=0.001]
	autolearn=disabled
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd3-us-west.apache.org [10.40.0.10]) (amavisd-new, port 10024)
	with ESMTP id SRXoIc7uFBPi for <dev@httpd.apache.org>;
	Sun, 11 Oct 2015 17:23:11 +0000 (UTC)
Received: from mail.greenbytes.de (mail.greenbytes.de [217.91.35.233])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id DDC79204D9
	for <dev@httpd.apache.org>; Sun, 11 Oct 2015 17:23:10 +0000 (UTC)
Received: from [192.168.178.41] (unknown [84.189.85.191])
	(using TLSv1 with cipher ECDHE-RSA-AES256-SHA (256/256 bits))
	(Client did not present a certificate)
	by mail.greenbytes.de (Postfix) with ESMTPSA id F2DC915A0440
	for <dev@httpd.apache.org>; Sun, 11 Oct 2015 19:23:08 +0200 (CEST)
Content-Type: text/plain; charset=us-ascii
Mime-Version: 1.0 (Mac OS X Mail 9.0 \(3094\))
Subject: Re: 2.4.17 test failure for mod_nntp_like_ssl when mod_http2 is loaded
From: Stefan Eissing <stefan.eissing@greenbytes.de>
In-Reply-To: <561A9A18.70904@kippdata.de>
Date: Sun, 11 Oct 2015 19:23:08 +0200
Content-Transfer-Encoding: quoted-printable
Message-Id: <1230E7B2-8907-403E-8321-21C7C9D64772@greenbytes.de>
References: <561A64DC.5000809@kippdata.de> <A350DE1E-8634-43AC-A054-3BCE181D6CA1@greenbytes.de> <A873A60B-662E-487A-BA96-C58ED4F4E04E@greenbytes.de> <CAKQ1sVO5+13U2xcVc-A_1geQChnSikxeosTWubm07yDrvpzMXw@mail.gmail.com> <561A9A18.70904@kippdata.de>
To: dev@httpd.apache.org
X-Mailer: Apple Mail (2.3094)


> Am 11.10.2015 um 19:19 schrieb Rainer Jung <rainer.jung@kippdata.de>:
>=20
> Am 11.10.2015 um 19:08 schrieb Yann Ylavic:
>> On Sun, Oct 11, 2015 at 7:00 PM, Stefan Eissing
>> <stefan.eissing@greenbytes.de> wrote:
>>> Ok, analyzed the code. Here is what seems to be happening:
>>>=20
>>> - mod_http2, in the connection hook, does a blocking, speculative =
read to
>>>   a) make sure the ALPN has been triggered
>>>   b) check for the magic 24 bytes h2 preface in case H2Direct is on
>>>   This works fine for HTTP/1.1 or protocols where the client starts =
sending bytes right away.
>>>   If the client waits for something from the server first, it gives =
a timeout. This seems to be the NNTP case.
>>=20
>> Does it make any sense to enable h2 on NNTP?
>=20
> For now I disabled the nntp over ssl test when mod_http2 is loaded =
(disabled in the test file) so that the test suite does not hang.
>=20
> I guess we don't want to test h2 and NNTP on the same requests, but it =
would be ideal, if the modules would not disturb each other, if they =
serve different vhosts in the same Apache. If that's not possible and =
doesn't actually indicate a bigger problem, I'm personally fine with =
that incompatibility with protocols that show "server sends first" =
behavior.

Agreed. What we need is a way to make sure that any ALPN handling is =
done for later connection hooks. Then mod_http2 will only need to sniff =
when H2Direct is enabled.=

From dev-return-84230-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Sun Oct 11 17:30:48 2015
Return-Path: <dev-return-84230-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 2FC7818E27
	for <apmail-httpd-dev-archive@www.apache.org>; Sun, 11 Oct 2015 17:30:48 +0000 (UTC)
Received: (qmail 92006 invoked by uid 500); 11 Oct 2015 17:30:47 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 91931 invoked by uid 500); 11 Oct 2015 17:30:47 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 91921 invoked by uid 99); 11 Oct 2015 17:30:47 -0000
Received: from Unknown (HELO spamd2-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 11 Oct 2015 17:30:47 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd2-us-west.apache.org (ASF Mail Server at spamd2-us-west.apache.org) with ESMTP id 498C21A0958
	for <dev@httpd.apache.org>; Sun, 11 Oct 2015 17:30:47 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd2-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.01
X-Spam-Level:
X-Spam-Status: No, score=-0.01 tagged_above=-999 required=6.31
	tests=[SPF_PASS=-0.001, T_RP_MATCHES_RCVD=-0.01, URIBL_BLOCKED=0.001]
	autolearn=disabled
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd2-us-west.apache.org [10.40.0.9]) (amavisd-new, port 10024)
	with ESMTP id HJugRnlGgVGo for <dev@httpd.apache.org>;
	Sun, 11 Oct 2015 17:30:37 +0000 (UTC)
Received: from mail.greenbytes.de (mail.greenbytes.de [217.91.35.233])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id 58C6642F38
	for <dev@httpd.apache.org>; Sun, 11 Oct 2015 17:30:37 +0000 (UTC)
Received: from [192.168.178.41] (unknown [84.189.85.191])
	(using TLSv1 with cipher ECDHE-RSA-AES256-SHA (256/256 bits))
	(Client did not present a certificate)
	by mail.greenbytes.de (Postfix) with ESMTPSA id A020915A043A
	for <dev@httpd.apache.org>; Sun, 11 Oct 2015 19:30:35 +0200 (CEST)
Content-Type: text/plain; charset=us-ascii
Mime-Version: 1.0 (Mac OS X Mail 9.0 \(3094\))
Subject: Re: 2.4.17 test failure for mod_nntp_like_ssl when mod_http2 is loaded
From: Stefan Eissing <stefan.eissing@greenbytes.de>
In-Reply-To: <1230E7B2-8907-403E-8321-21C7C9D64772@greenbytes.de>
Date: Sun, 11 Oct 2015 19:30:34 +0200
Content-Transfer-Encoding: quoted-printable
Message-Id: <DED1D215-F7E5-4D39-83F7-C461944A8129@greenbytes.de>
References: <561A64DC.5000809@kippdata.de> <A350DE1E-8634-43AC-A054-3BCE181D6CA1@greenbytes.de> <A873A60B-662E-487A-BA96-C58ED4F4E04E@greenbytes.de> <CAKQ1sVO5+13U2xcVc-A_1geQChnSikxeosTWubm07yDrvpzMXw@mail.gmail.com> <561A9A18.70904@kippdata.de> <1230E7B2-8907-403E-8321-21C7C9D64772@greenbytes.de>
To: dev@httpd.apache.org
X-Mailer: Apple Mail (2.3094)

What is the penalty of invoking SSL_do_handshake(ssl) on the server side =
for a new connection? We do this on renegotiate and upgrade cases...

> Am 11.10.2015 um 19:23 schrieb Stefan Eissing =
<stefan.eissing@greenbytes.de>:
>=20
>=20
>> Am 11.10.2015 um 19:19 schrieb Rainer Jung <rainer.jung@kippdata.de>:
>>=20
>> Am 11.10.2015 um 19:08 schrieb Yann Ylavic:
>>> On Sun, Oct 11, 2015 at 7:00 PM, Stefan Eissing
>>> <stefan.eissing@greenbytes.de> wrote:
>>>> Ok, analyzed the code. Here is what seems to be happening:
>>>>=20
>>>> - mod_http2, in the connection hook, does a blocking, speculative =
read to
>>>>  a) make sure the ALPN has been triggered
>>>>  b) check for the magic 24 bytes h2 preface in case H2Direct is on
>>>>  This works fine for HTTP/1.1 or protocols where the client starts =
sending bytes right away.
>>>>  If the client waits for something from the server first, it gives =
a timeout. This seems to be the NNTP case.
>>>=20
>>> Does it make any sense to enable h2 on NNTP?
>>=20
>> For now I disabled the nntp over ssl test when mod_http2 is loaded =
(disabled in the test file) so that the test suite does not hang.
>>=20
>> I guess we don't want to test h2 and NNTP on the same requests, but =
it would be ideal, if the modules would not disturb each other, if they =
serve different vhosts in the same Apache. If that's not possible and =
doesn't actually indicate a bigger problem, I'm personally fine with =
that incompatibility with protocols that show "server sends first" =
behavior.
>=20
> Agreed. What we need is a way to make sure that any ALPN handling is =
done for later connection hooks. Then mod_http2 will only need to sniff =
when H2Direct is enabled.


From dev-return-84231-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Sun Oct 11 17:54:40 2015
Return-Path: <dev-return-84231-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 7292918E84
	for <apmail-httpd-dev-archive@www.apache.org>; Sun, 11 Oct 2015 17:54:40 +0000 (UTC)
Received: (qmail 24417 invoked by uid 500); 11 Oct 2015 17:54:40 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 24338 invoked by uid 500); 11 Oct 2015 17:54:40 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 24328 invoked by uid 99); 11 Oct 2015 17:54:39 -0000
Received: from Unknown (HELO spamd1-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 11 Oct 2015 17:54:39 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd1-us-west.apache.org (ASF Mail Server at spamd1-us-west.apache.org) with ESMTP id 57093C23F0
	for <dev@httpd.apache.org>; Sun, 11 Oct 2015 17:54:39 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd1-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.01
X-Spam-Level:
X-Spam-Status: No, score=-0.01 tagged_above=-999 required=6.31
	tests=[SPF_PASS=-0.001, T_RP_MATCHES_RCVD=-0.01, URIBL_BLOCKED=0.001]
	autolearn=disabled
Received: from mx1-us-west.apache.org ([10.40.0.8])
	by localhost (spamd1-us-west.apache.org [10.40.0.7]) (amavisd-new, port 10024)
	with ESMTP id ZDJ5PAYOi9wH for <dev@httpd.apache.org>;
	Sun, 11 Oct 2015 17:54:30 +0000 (UTC)
Received: from mail.greenbytes.de (mail.greenbytes.de [217.91.35.233])
	by mx1-us-west.apache.org (ASF Mail Server at mx1-us-west.apache.org) with ESMTPS id 9B87B20595
	for <dev@httpd.apache.org>; Sun, 11 Oct 2015 17:54:29 +0000 (UTC)
Received: from [192.168.178.41] (unknown [84.189.85.191])
	(using TLSv1 with cipher ECDHE-RSA-AES256-SHA (256/256 bits))
	(Client did not present a certificate)
	by mail.greenbytes.de (Postfix) with ESMTPSA id EDE8215A0472
	for <dev@httpd.apache.org>; Sun, 11 Oct 2015 19:54:26 +0200 (CEST)
Content-Type: text/plain; charset=us-ascii
Mime-Version: 1.0 (Mac OS X Mail 9.0 \(3094\))
Subject: Re: 2.4.17 test failure for mod_nntp_like_ssl when mod_http2 is loaded
From: Stefan Eissing <stefan.eissing@greenbytes.de>
In-Reply-To: <DED1D215-F7E5-4D39-83F7-C461944A8129@greenbytes.de>
Date: Sun, 11 Oct 2015 19:54:26 +0200
Content-Transfer-Encoding: quoted-printable
Message-Id: <E31D3E0E-D988-4F66-A7AB-A0B3E5B7B0FB@greenbytes.de>
References: <561A64DC.5000809@kippdata.de> <A350DE1E-8634-43AC-A054-3BCE181D6CA1@greenbytes.de> <A873A60B-662E-487A-BA96-C58ED4F4E04E@greenbytes.de> <CAKQ1sVO5+13U2xcVc-A_1geQChnSikxeosTWubm07yDrvpzMXw@mail.gmail.com> <561A9A18.70904@kippdata.de> <1230E7B2-8907-403E-8321-21C7C9D64772@greenbytes.de> <DED1D215-F7E5-4D39-83F7-C461944A8129@greenbytes.de>
To: dev@httpd.apache.org
X-Mailer: Apple Mail (2.3094)

Ok, in ssl_engine_io.c, lines 1426+ I see a hint:

    /* XXX: we could actually move ssl_io_filter_handshake to an
     * ap_hook_process_connection but would still need to call it for
     * AP_MODE_INIT for protocols that may upgrade the connection
     * rather than have SSLEngine On configured.
     */
    if ((status =3D ssl_io_filter_handshake(inctx->filter_ctx)) !=3D =
APR_SUCCESS) {
        return ssl_io_filter_error(f, bb, status);
    }

The handshake handling gets triggered on a filter, so it all happens on =
READs (or WRITEs), which explains why connection hooks do not see it. =
This is quite some code which looks like we do not want to touch for a =
"quick fix". Also, there is no quick fix inside mod_http2 as before =
handshake, the SNI might also not be there yet, thus the vhost cannot be =
determined. etc.

For the current release, I think we should leave it as it is and advise =
that current mod_http2 is incompatible with things like nntp.

For the next release, I'd like the server to perform the handshake at a =
defined time, so other modules can rely on protocols being selected and =
correct vhost being known before the first read/write.

//Stefan

> Am 11.10.2015 um 19:30 schrieb Stefan Eissing =
<stefan.eissing@greenbytes.de>:
>=20
> What is the penalty of invoking SSL_do_handshake(ssl) on the server =
side for a new connection? We do this on renegotiate and upgrade =
cases...
>=20
>> Am 11.10.2015 um 19:23 schrieb Stefan Eissing =
<stefan.eissing@greenbytes.de>:
>>=20
>>=20
>>> Am 11.10.2015 um 19:19 schrieb Rainer Jung =
<rainer.jung@kippdata.de>:
>>>=20
>>> Am 11.10.2015 um 19:08 schrieb Yann Ylavic:
>>>> On Sun, Oct 11, 2015 at 7:00 PM, Stefan Eissing
>>>> <stefan.eissing@greenbytes.de> wrote:
>>>>> Ok, analyzed the code. Here is what seems to be happening:
>>>>>=20
>>>>> - mod_http2, in the connection hook, does a blocking, speculative =
read to
>>>>> a) make sure the ALPN has been triggered
>>>>> b) check for the magic 24 bytes h2 preface in case H2Direct is on
>>>>> This works fine for HTTP/1.1 or protocols where the client starts =
sending bytes right away.
>>>>> If the client waits for something from the server first, it gives =
a timeout. This seems to be the NNTP case.
>>>>=20
>>>> Does it make any sense to enable h2 on NNTP?
>>>=20
>>> For now I disabled the nntp over ssl test when mod_http2 is loaded =
(disabled in the test file) so that the test suite does not hang.
>>>=20
>>> I guess we don't want to test h2 and NNTP on the same requests, but =
it would be ideal, if the modules would not disturb each other, if they =
serve different vhosts in the same Apache. If that's not possible and =
doesn't actually indicate a bigger problem, I'm personally fine with =
that incompatibility with protocols that show "server sends first" =
behavior.
>>=20
>> Agreed. What we need is a way to make sure that any ALPN handling is =
done for later connection hooks. Then mod_http2 will only need to sniff =
when H2Direct is enabled.
>=20


From dev-return-84232-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Sun Oct 11 18:46:11 2015
Return-Path: <dev-return-84232-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 60D4618F85
	for <apmail-httpd-dev-archive@www.apache.org>; Sun, 11 Oct 2015 18:46:11 +0000 (UTC)
Received: (qmail 77597 invoked by uid 500); 11 Oct 2015 18:46:10 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 77524 invoked by uid 500); 11 Oct 2015 18:46:10 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 77514 invoked by uid 99); 11 Oct 2015 18:46:10 -0000
Received: from Unknown (HELO spamd3-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 11 Oct 2015 18:46:10 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd3-us-west.apache.org (ASF Mail Server at spamd3-us-west.apache.org) with ESMTP id 5B300180ECA
	for <dev@httpd.apache.org>; Sun, 11 Oct 2015 18:46:10 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd3-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.012
X-Spam-Level:
X-Spam-Status: No, score=-0.012 tagged_above=-999 required=6.31
	tests=[SPF_HELO_PASS=-0.001, SPF_PASS=-0.001, T_RP_MATCHES_RCVD=-0.01]
	autolearn=disabled
Received: from mx1-us-west.apache.org ([10.40.0.8])
	by localhost (spamd3-us-west.apache.org [10.40.0.10]) (amavisd-new, port 10024)
	with ESMTP id 5y70CR88ZfNb for <dev@httpd.apache.org>;
	Sun, 11 Oct 2015 18:46:08 +0000 (UTC)
Received: from mail.thelounge.net (mail.thelounge.net [91.118.73.15])
	by mx1-us-west.apache.org (ASF Mail Server at mx1-us-west.apache.org) with ESMTPS id 454BE2031C
	for <dev@httpd.apache.org>; Sun, 11 Oct 2015 18:46:08 +0000 (UTC)
Subject: Re: [VOTE] Release Apache httpd 2.4.17 as GA
To: dev@httpd.apache.org
References: <C45BAF78-8A10-4751-B1CA-62BB499FD795@jaguNET.com>
From: Reindl Harald <h.reindl@thelounge.net>
Openpgp: id=13540402D67A7F71C6E974EA866063CF7F780279;
 url=https://arrakis.thelounge.net/gpg/h.reindl_thelounge.net.pub.txt
X-Enigmail-Draft-Status: N1110
Organization: the lounge interactive design
Message-ID: <561AAE67.4010609@thelounge.net>
Date: Sun, 11 Oct 2015 20:45:59 +0200
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:38.0) Gecko/20100101
 Thunderbird/38.3.0
MIME-Version: 1.0
In-Reply-To: <C45BAF78-8A10-4751-B1CA-62BB499FD795@jaguNET.com>
Content-Type: multipart/signed; micalg=pgp-sha1;
 protocol="application/pgp-signature";
 boundary="3iX4t0wBugBBlV58FRqeLAaH37Ii288t7"

This is an OpenPGP/MIME signed message (RFC 4880 and 3156)
--3iX4t0wBugBBlV58FRqeLAaH37Ii288t7
Content-Type: text/plain; charset=windows-1252; format=flowed
Content-Transfer-Encoding: quoted-printable


Am 09.10.2015 um 19:40 schrieb Jim Jagielski:
> The pre-release test tarballs for Apache httpd 2.4.17 can be found
> at the usual place:
>
> 	http://httpd.apache.org/dev/dist/
>
> I'm calling a VOTE on releasing these as Apache httpd 2.4.17 GA.
>
> [ ] +1: Good to go
> [ ] +0: meh
> [ ] -1: Danger Will Robinson. And why

+1 on Fedora 21 / 22 x86_64

one question:
MPMs: Support SO_REUSEPORT to create multiple duplicated listener

does that get automatic enabled on recent Linux kernels or is there any=20
configuration needed to enable it?



--3iX4t0wBugBBlV58FRqeLAaH37Ii288t7
Content-Type: application/pgp-signature; name="signature.asc"
Content-Description: OpenPGP digital signature
Content-Disposition: attachment; filename="signature.asc"

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v2

iEYEARECAAYFAlYarmcACgkQhmBjz394AnkecQCfSCi94RSoQsHijwEDSvWVeg8b
78gAn3msvPCzCFLtGqQWCajIuBIrKiHg
=Wnki
-----END PGP SIGNATURE-----

--3iX4t0wBugBBlV58FRqeLAaH37Ii288t7--

From dev-return-84233-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Sun Oct 11 18:51:49 2015
Return-Path: <dev-return-84233-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 4F5DE18FAE
	for <apmail-httpd-dev-archive@www.apache.org>; Sun, 11 Oct 2015 18:51:49 +0000 (UTC)
Received: (qmail 83650 invoked by uid 500); 11 Oct 2015 18:51:48 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 83580 invoked by uid 500); 11 Oct 2015 18:51:48 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 83569 invoked by uid 99); 11 Oct 2015 18:51:48 -0000
Received: from Unknown (HELO spamd1-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 11 Oct 2015 18:51:48 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd1-us-west.apache.org (ASF Mail Server at spamd1-us-west.apache.org) with ESMTP id 6C28BC5505
	for <dev@httpd.apache.org>; Sun, 11 Oct 2015 18:51:48 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd1-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.1
X-Spam-Level:
X-Spam-Status: No, score=-0.1 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	SPF_PASS=-0.001, URIBL_BLOCKED=0.001] autolearn=disabled
Authentication-Results: spamd1-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd1-us-west.apache.org [10.40.0.7]) (amavisd-new, port 10024)
	with ESMTP id m-JLpRlaSesL for <dev@httpd.apache.org>;
	Sun, 11 Oct 2015 18:51:42 +0000 (UTC)
Received: from mail-qk0-f169.google.com (mail-qk0-f169.google.com [209.85.220.169])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id 46EC42541A
	for <dev@httpd.apache.org>; Sun, 11 Oct 2015 18:51:41 +0000 (UTC)
Received: by qkas79 with SMTP id s79so51477726qka.0
        for <dev@httpd.apache.org>; Sun, 11 Oct 2015 11:51:33 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        bh=iwd9PWTO6sZvZXUvUvj25mkCa69+UGFWWbheC9H6bXk=;
        b=QM0USpnnQuLCNDvOLQ3gcWGzuWOdQh9BEEgvbWgGtH9t+ps8fKyALQkQKkqE9xnPUJ
         +E/y3gWJTkkEsVDn1GVUtx2tNDGOo2x6w9Sri1y29ErJxrrguBrNOwEiLQFfbfQQ6UmE
         Q4IQKBKp1naiXbAfOlFw7gRllmeJzGxRbjv6hRh/fAaYVYfjmHkLLPJXFc2MaIsCEO7U
         oJZJstOA2Ei+etUmC4BkKgaBXASCs0JlzQqGvu66wQcOvpbURcToexnvbQ0copmrNHgW
         ED+XwlYHLp23X0UP2ThZjoXZPHPD9RrebCOywhMpOw7Z9PbcP2gN2eG48+15l4NnHcIN
         pS2g==
MIME-Version: 1.0
X-Received: by 10.55.192.15 with SMTP id o15mr28177090qki.2.1444589493730;
 Sun, 11 Oct 2015 11:51:33 -0700 (PDT)
Received: by 10.55.72.20 with HTTP; Sun, 11 Oct 2015 11:51:33 -0700 (PDT)
In-Reply-To: <561AAE67.4010609@thelounge.net>
References: <C45BAF78-8A10-4751-B1CA-62BB499FD795@jaguNET.com>
	<561AAE67.4010609@thelounge.net>
Date: Sun, 11 Oct 2015 20:51:33 +0200
Message-ID: <CAKQ1sVNqM7s1-eOnLsHr7gs_kyoQvH3FM+1yXGqRtjWC4FDTbQ@mail.gmail.com>
Subject: Re: [VOTE] Release Apache httpd 2.4.17 as GA
From: Yann Ylavic <ylavic.dev@gmail.com>
To: dev@httpd.apache.org
Content-Type: text/plain; charset=UTF-8

On Sun, Oct 11, 2015 at 8:45 PM, Reindl Harald <h.reindl@thelounge.net> wrote:
>
> Am 09.10.2015 um 19:40 schrieb Jim Jagielski:
>>
>> The pre-release test tarballs for Apache httpd 2.4.17 can be found
>> at the usual place:
>>
>>         http://httpd.apache.org/dev/dist/
>>
>> I'm calling a VOTE on releasing these as Apache httpd 2.4.17 GA.
>>
>> [ ] +1: Good to go
>> [ ] +0: meh
>> [ ] -1: Danger Will Robinson. And why
>
>
> +1 on Fedora 21 / 22 x86_64
>
> one question:
> MPMs: Support SO_REUSEPORT to create multiple duplicated listener
>
> does that get automatic enabled on recent Linux kernels or is there any
> configuration needed to enable it?

You need to configure this directive:
http://httpd.apache.org/docs/2.4/mod/mpm_common.html#listencoresbucketsratio

Regards,
Yann.

From dev-return-84234-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Sun Oct 11 18:59:52 2015
Return-Path: <dev-return-84234-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id D8B0118FE7
	for <apmail-httpd-dev-archive@www.apache.org>; Sun, 11 Oct 2015 18:59:52 +0000 (UTC)
Received: (qmail 98293 invoked by uid 500); 11 Oct 2015 18:59:43 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 98220 invoked by uid 500); 11 Oct 2015 18:59:43 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 98210 invoked by uid 99); 11 Oct 2015 18:59:43 -0000
Received: from Unknown (HELO spamd2-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 11 Oct 2015 18:59:43 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd2-us-west.apache.org (ASF Mail Server at spamd2-us-west.apache.org) with ESMTP id 9B4B01A0961
	for <dev@httpd.apache.org>; Sun, 11 Oct 2015 18:59:42 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd2-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.01
X-Spam-Level:
X-Spam-Status: No, score=-0.01 tagged_above=-999 required=6.31
	tests=[SPF_HELO_PASS=-0.001, T_RP_MATCHES_RCVD=-0.01,
	URIBL_BLOCKED=0.001] autolearn=disabled
Received: from mx1-us-west.apache.org ([10.40.0.8])
	by localhost (spamd2-us-west.apache.org [10.40.0.9]) (amavisd-new, port 10024)
	with ESMTP id BImYWh19htal for <dev@httpd.apache.org>;
	Sun, 11 Oct 2015 18:59:33 +0000 (UTC)
Received: from mail.thelounge.net (mail.thelounge.net [91.118.73.15])
	by mx1-us-west.apache.org (ASF Mail Server at mx1-us-west.apache.org) with ESMTPS id B63092303B
	for <dev@httpd.apache.org>; Sun, 11 Oct 2015 18:59:32 +0000 (UTC)
Subject: Re: [VOTE] Release Apache httpd 2.4.17 as GA
To: dev@httpd.apache.org
References: <C45BAF78-8A10-4751-B1CA-62BB499FD795@jaguNET.com>
 <561AAE67.4010609@thelounge.net>
 <CAKQ1sVNqM7s1-eOnLsHr7gs_kyoQvH3FM+1yXGqRtjWC4FDTbQ@mail.gmail.com>
From: Reindl Harald <h.reindl@thelounge.net>
Openpgp: id=13540402D67A7F71C6E974EA866063CF7F780279;
 url=https://arrakis.thelounge.net/gpg/h.reindl_thelounge.net.pub.txt
X-Enigmail-Draft-Status: N1110
Organization: the lounge interactive design
Message-ID: <561AB192.7000709@thelounge.net>
Date: Sun, 11 Oct 2015 20:59:30 +0200
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:38.0) Gecko/20100101
 Thunderbird/38.3.0
MIME-Version: 1.0
In-Reply-To: <CAKQ1sVNqM7s1-eOnLsHr7gs_kyoQvH3FM+1yXGqRtjWC4FDTbQ@mail.gmail.com>
Content-Type: multipart/signed; micalg=pgp-sha1;
 protocol="application/pgp-signature";
 boundary="MbIXGDjcJfoA6iU7vUi479qbJ7Ee1Ved6"

This is an OpenPGP/MIME signed message (RFC 4880 and 3156)
--MbIXGDjcJfoA6iU7vUi479qbJ7Ee1Ved6
Content-Type: text/plain; charset=utf-8; format=flowed
Content-Transfer-Encoding: quoted-printable



Am 11.10.2015 um 20:51 schrieb Yann Ylavic:
> On Sun, Oct 11, 2015 at 8:45 PM, Reindl Harald <h.reindl@thelounge.net>=
 wrote:
>>
>> Am 09.10.2015 um 19:40 schrieb Jim Jagielski:
>>>
>>> The pre-release test tarballs for Apache httpd 2.4.17 can be found
>>> at the usual place:
>>>
>>>          http://httpd.apache.org/dev/dist/
>>>
>>> I'm calling a VOTE on releasing these as Apache httpd 2.4.17 GA.
>>>
>>> [ ] +1: Good to go
>>> [ ] +0: meh
>>> [ ] -1: Danger Will Robinson. And why
>>
>>
>> +1 on Fedora 21 / 22 x86_64
>>
>> one question:
>> MPMs: Support SO_REUSEPORT to create multiple duplicated listener
>>
>> does that get automatic enabled on recent Linux kernels or is there an=
y
>> configuration needed to enable it?
>
> You need to configure this directive:
> http://httpd.apache.org/docs/2.4/mod/mpm_common.html#listencoresbuckets=
ratio

thanks!

Google only showed discussions, Bugzilla and so on and finding the new=20
directive is hard - maybe the hint should made it into the changelog for =

GA release


will give it a try

however, 2.4.17 without touch configs looks fine


--MbIXGDjcJfoA6iU7vUi479qbJ7Ee1Ved6
Content-Type: application/pgp-signature; name="signature.asc"
Content-Description: OpenPGP digital signature
Content-Disposition: attachment; filename="signature.asc"

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v2

iEYEARECAAYFAlYasZIACgkQhmBjz394AnnbgACdHvzplssB0cOi6hoE1ila1bwH
gM4An16N+M25YjUI13RPtZpRH8LdShP3
=Ktit
-----END PGP SIGNATURE-----

--MbIXGDjcJfoA6iU7vUi479qbJ7Ee1Ved6--

From dev-return-84235-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Sun Oct 11 19:08:18 2015
Return-Path: <dev-return-84235-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 196BE1806C
	for <apmail-httpd-dev-archive@www.apache.org>; Sun, 11 Oct 2015 19:08:18 +0000 (UTC)
Received: (qmail 12576 invoked by uid 500); 11 Oct 2015 19:08:11 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 12476 invoked by uid 500); 11 Oct 2015 19:08:11 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 12466 invoked by uid 99); 11 Oct 2015 19:08:11 -0000
Received: from Unknown (HELO spamd1-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 11 Oct 2015 19:08:11 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd1-us-west.apache.org (ASF Mail Server at spamd1-us-west.apache.org) with ESMTP id 03A2AC5619
	for <dev@httpd.apache.org>; Sun, 11 Oct 2015 19:08:11 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd1-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.101
X-Spam-Level:
X-Spam-Status: No, score=-0.101 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RCVD_IN_MSPIKE_H2=-0.001, SPF_PASS=-0.001, URIBL_BLOCKED=0.001]
	autolearn=disabled
Authentication-Results: spamd1-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd1-us-west.apache.org [10.40.0.7]) (amavisd-new, port 10024)
	with ESMTP id Zjg0jGqr_iay for <dev@httpd.apache.org>;
	Sun, 11 Oct 2015 19:08:06 +0000 (UTC)
Received: from mail-qg0-f49.google.com (mail-qg0-f49.google.com [209.85.192.49])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id 3FC712541A
	for <dev@httpd.apache.org>; Sun, 11 Oct 2015 19:08:05 +0000 (UTC)
Received: by qgt47 with SMTP id 47so106636737qgt.2
        for <dev@httpd.apache.org>; Sun, 11 Oct 2015 12:07:58 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        bh=G3exxjlpa5HTlTm5l93xN/Rjo1A7eWS/CUCxZrPIGUM=;
        b=IJj3NIT8wdT1x/D5kywRzXtAVTSUv7TWn8mwOM8nnjQ2fOhRZLOYk4gxrHhUEMXvWD
         amrYVpbWsXBiGi1MfHMBsQRnFyVgqG23Q0M/kqlNg82aa48hBmE9Td6b2zutQDPyXsUt
         mIQ9B3zHpjAhas9dV3XQLsF82IOqKKdP1vWfwq0+NIkxCpzAaQYERw3BSwmuaXWnDCxI
         5E2SQl47wNNNGMNXNtEpW+IoEgQyH7YWRDQGyzKpRSPeDkGZ+2JmlrAdcILEvCuF4ZwU
         rnN+6yLL5UVCUpd9VPSS+wnS/K5rRvNVVw8A4+mavgjvtNEUrLQNkaYzkopvgd6GWyj3
         x54w==
MIME-Version: 1.0
X-Received: by 10.140.236.203 with SMTP id h194mr27858018qhc.73.1444590478036;
 Sun, 11 Oct 2015 12:07:58 -0700 (PDT)
Received: by 10.55.72.20 with HTTP; Sun, 11 Oct 2015 12:07:57 -0700 (PDT)
In-Reply-To: <561AB192.7000709@thelounge.net>
References: <C45BAF78-8A10-4751-B1CA-62BB499FD795@jaguNET.com>
	<561AAE67.4010609@thelounge.net>
	<CAKQ1sVNqM7s1-eOnLsHr7gs_kyoQvH3FM+1yXGqRtjWC4FDTbQ@mail.gmail.com>
	<561AB192.7000709@thelounge.net>
Date: Sun, 11 Oct 2015 21:07:57 +0200
Message-ID: <CAKQ1sVNbPSYQVA5dRrRXkoR1tp+UychOBY3-sSMTNhbU__Q1zw@mail.gmail.com>
Subject: Re: [VOTE] Release Apache httpd 2.4.17 as GA
From: Yann Ylavic <ylavic.dev@gmail.com>
To: dev@httpd.apache.org
Content-Type: text/plain; charset=UTF-8

On Sun, Oct 11, 2015 at 8:59 PM, Reindl Harald <h.reindl@thelounge.net> wrote:
>
> Google only showed discussions, Bugzilla and so on and finding the new
> directive is hard - maybe the hint should made it into the changelog for GA
> release

Yes you're right, I should have mentioned that directive in the CHANGES entry.
Unfortunately I'm afraid it's too late now, the 2.4.17 tag is frozen.
Hopefully the (new) documentation will quickly be indexed...

From dev-return-84236-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Sun Oct 11 19:14:49 2015
Return-Path: <dev-return-84236-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id B8B571808B
	for <apmail-httpd-dev-archive@www.apache.org>; Sun, 11 Oct 2015 19:14:49 +0000 (UTC)
Received: (qmail 23012 invoked by uid 500); 11 Oct 2015 19:14:49 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 22925 invoked by uid 500); 11 Oct 2015 19:14:49 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 22915 invoked by uid 99); 11 Oct 2015 19:14:49 -0000
Received: from Unknown (HELO spamd3-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 11 Oct 2015 19:14:49 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd3-us-west.apache.org (ASF Mail Server at spamd3-us-west.apache.org) with ESMTP id C0FF5180A84
	for <dev@httpd.apache.org>; Sun, 11 Oct 2015 19:14:48 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd3-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.011
X-Spam-Level:
X-Spam-Status: No, score=-0.011 tagged_above=-999 required=6.31
	tests=[SPF_HELO_PASS=-0.001, SPF_PASS=-0.001, T_RP_MATCHES_RCVD=-0.01,
	URIBL_BLOCKED=0.001] autolearn=disabled
Received: from mx1-us-west.apache.org ([10.40.0.8])
	by localhost (spamd3-us-west.apache.org [10.40.0.10]) (amavisd-new, port 10024)
	with ESMTP id 3O_Yo_-gP8wg for <dev@httpd.apache.org>;
	Sun, 11 Oct 2015 19:14:41 +0000 (UTC)
Received: from mail.thelounge.net (mail.thelounge.net [91.118.73.15])
	by mx1-us-west.apache.org (ASF Mail Server at mx1-us-west.apache.org) with ESMTPS id 3CA1320595
	for <dev@httpd.apache.org>; Sun, 11 Oct 2015 19:14:41 +0000 (UTC)
Subject: Re: [VOTE] Release Apache httpd 2.4.17 as GA
To: dev@httpd.apache.org
References: <C45BAF78-8A10-4751-B1CA-62BB499FD795@jaguNET.com>
 <561AAE67.4010609@thelounge.net>
 <CAKQ1sVNqM7s1-eOnLsHr7gs_kyoQvH3FM+1yXGqRtjWC4FDTbQ@mail.gmail.com>
 <561AB192.7000709@thelounge.net>
 <CAKQ1sVNbPSYQVA5dRrRXkoR1tp+UychOBY3-sSMTNhbU__Q1zw@mail.gmail.com>
From: Reindl Harald <h.reindl@thelounge.net>
Openpgp: id=13540402D67A7F71C6E974EA866063CF7F780279;
 url=https://arrakis.thelounge.net/gpg/h.reindl_thelounge.net.pub.txt
X-Enigmail-Draft-Status: N1110
Organization: the lounge interactive design
Message-ID: <561AB51F.7070303@thelounge.net>
Date: Sun, 11 Oct 2015 21:14:39 +0200
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:38.0) Gecko/20100101
 Thunderbird/38.3.0
MIME-Version: 1.0
In-Reply-To: <CAKQ1sVNbPSYQVA5dRrRXkoR1tp+UychOBY3-sSMTNhbU__Q1zw@mail.gmail.com>
Content-Type: multipart/signed; micalg=pgp-sha1;
 protocol="application/pgp-signature";
 boundary="iH5mbiHQ0LafECqT68xfwgEDm7D35Uk6C"

This is an OpenPGP/MIME signed message (RFC 4880 and 3156)
--iH5mbiHQ0LafECqT68xfwgEDm7D35Uk6C
Content-Type: text/plain; charset=utf-8; format=flowed
Content-Transfer-Encoding: quoted-printable



Am 11.10.2015 um 21:07 schrieb Yann Ylavic:
> On Sun, Oct 11, 2015 at 8:59 PM, Reindl Harald <h.reindl@thelounge.net>=
 wrote:
>>
>> Google only showed discussions, Bugzilla and so on and finding the new=

>> directive is hard - maybe the hint should made it into the changelog f=
or GA
>> release
>
> Yes you're right, I should have mentioned that directive in the CHANGES=
 entry.
> Unfortunately I'm afraid it's too late now, the 2.4.17 tag is frozen.
> Hopefully the (new) documentation will quickly be indexed...

no problem since it's diabled by default


"ab -c 100 -n 50000 http://small-image.gif" did not make me that happy=20
after a short test on a quadcore machine, after some time httpd stopped=20
to respond for a tinay statical image with a few bytes

# SO_REUSEPORT support
# <IfVersion >=3D 2.4.17>
#  ListenCoresBucketsRatio 4
# </IfVersion>


--iH5mbiHQ0LafECqT68xfwgEDm7D35Uk6C
Content-Type: application/pgp-signature; name="signature.asc"
Content-Description: OpenPGP digital signature
Content-Disposition: attachment; filename="signature.asc"

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v2

iEYEARECAAYFAlYatR8ACgkQhmBjz394AnkEsgCfU58UJt5whxiWTDPlxIFXkmWc
PJMAn2uf8JjTzl3eCJaqV98faNZ3WUT3
=u3Kn
-----END PGP SIGNATURE-----

--iH5mbiHQ0LafECqT68xfwgEDm7D35Uk6C--

From dev-return-84237-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Sun Oct 11 19:26:00 2015
Return-Path: <dev-return-84237-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id E4F8B180CD
	for <apmail-httpd-dev-archive@www.apache.org>; Sun, 11 Oct 2015 19:25:59 +0000 (UTC)
Received: (qmail 46956 invoked by uid 500); 11 Oct 2015 19:25:59 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 46880 invoked by uid 500); 11 Oct 2015 19:25:59 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 46870 invoked by uid 99); 11 Oct 2015 19:25:59 -0000
Received: from Unknown (HELO spamd2-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 11 Oct 2015 19:25:59 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd2-us-west.apache.org (ASF Mail Server at spamd2-us-west.apache.org) with ESMTP id AC5341A27C7
	for <dev@httpd.apache.org>; Sun, 11 Oct 2015 19:25:58 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd2-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.12
X-Spam-Level:
X-Spam-Status: No, score=-0.12 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RCVD_IN_MSPIKE_H3=-0.01, RCVD_IN_MSPIKE_WL=-0.01, SPF_PASS=-0.001,
	URIBL_BLOCKED=0.001] autolearn=disabled
Authentication-Results: spamd2-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-us-west.apache.org ([10.40.0.8])
	by localhost (spamd2-us-west.apache.org [10.40.0.9]) (amavisd-new, port 10024)
	with ESMTP id hE5jY_dvg0F5 for <dev@httpd.apache.org>;
	Sun, 11 Oct 2015 19:25:53 +0000 (UTC)
Received: from mail-qk0-f180.google.com (mail-qk0-f180.google.com [209.85.220.180])
	by mx1-us-west.apache.org (ASF Mail Server at mx1-us-west.apache.org) with ESMTPS id C97C22045A
	for <dev@httpd.apache.org>; Sun, 11 Oct 2015 19:25:52 +0000 (UTC)
Received: by qkdo1 with SMTP id o1so42614990qkd.1
        for <dev@httpd.apache.org>; Sun, 11 Oct 2015 12:25:46 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        bh=jZnBL5zh424jMo+LY5O0NTzQsp7n5mR5EiiSxuqpwwU=;
        b=nvGlFPKHsBJ5ts/8AcMe0DjkbGMoPcEb8+KjVkdD1x58ap2B/W6LFBefh2aCwR5AKE
         OuCb0W1E5K/02fXIRlgFVZtecpi0lxvvgK4539Qdg+NDwhJJtUEMTH9LQxgIXA8Svw6Y
         0fV1yPU5xdpyYOK80JnmETWGasmnnnZXrqoVV3gZ3uEtcWvteMKhWAWuCdak5YXgBp7B
         3/ceK6eJVkKQIf2VuYU5mb6Sdw++XuSG8zObQmMHPMDbnSO7sQRobf/LDB5QnlwPuxS2
         NYTvlv8FanGCHnijVvZsy9JjJ1YZx38/5jbuqqu9w4eYS2imwroA2Lv6WfoYYzYzksh6
         M4iw==
MIME-Version: 1.0
X-Received: by 10.55.215.156 with SMTP id t28mr27585798qkt.68.1444591545932;
 Sun, 11 Oct 2015 12:25:45 -0700 (PDT)
Received: by 10.55.72.20 with HTTP; Sun, 11 Oct 2015 12:25:45 -0700 (PDT)
In-Reply-To: <561AB51F.7070303@thelounge.net>
References: <C45BAF78-8A10-4751-B1CA-62BB499FD795@jaguNET.com>
	<561AAE67.4010609@thelounge.net>
	<CAKQ1sVNqM7s1-eOnLsHr7gs_kyoQvH3FM+1yXGqRtjWC4FDTbQ@mail.gmail.com>
	<561AB192.7000709@thelounge.net>
	<CAKQ1sVNbPSYQVA5dRrRXkoR1tp+UychOBY3-sSMTNhbU__Q1zw@mail.gmail.com>
	<561AB51F.7070303@thelounge.net>
Date: Sun, 11 Oct 2015 21:25:45 +0200
Message-ID: <CAKQ1sVN2b3N5FevRY-k5-uD=bVaYKH2g-LVuc=qResjewXfh8w@mail.gmail.com>
Subject: Re: [VOTE] Release Apache httpd 2.4.17 as GA
From: Yann Ylavic <ylavic.dev@gmail.com>
To: dev@httpd.apache.org
Content-Type: text/plain; charset=UTF-8

On Sun, Oct 11, 2015 at 9:14 PM, Reindl Harald <h.reindl@thelounge.net> wrote:
>
> "ab -c 100 -n 50000 http://small-image.gif" did not make me that happy after
> a short test on a quadcore machine, after some time httpd stopped to respond
> for a tinay statical image with a few bytes

Hm, with 4 cores and a ratio of 4, there is only one bucket per
listener, which is the same as the default.
Did you try the same test without the directive or with a ratio of 0?
(I rather suspect a connectivity issue with ab).

From dev-return-84238-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Sun Oct 11 19:39:29 2015
Return-Path: <dev-return-84238-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id B0CF71812F
	for <apmail-httpd-dev-archive@www.apache.org>; Sun, 11 Oct 2015 19:39:29 +0000 (UTC)
Received: (qmail 75839 invoked by uid 500); 11 Oct 2015 19:39:29 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 75770 invoked by uid 500); 11 Oct 2015 19:39:29 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 75760 invoked by uid 99); 11 Oct 2015 19:39:29 -0000
Received: from Unknown (HELO spamd1-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 11 Oct 2015 19:39:29 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd1-us-west.apache.org (ASF Mail Server at spamd1-us-west.apache.org) with ESMTP id D9636C563C
	for <dev@httpd.apache.org>; Sun, 11 Oct 2015 19:39:28 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd1-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.011
X-Spam-Level:
X-Spam-Status: No, score=-0.011 tagged_above=-999 required=6.31
	tests=[SPF_HELO_PASS=-0.001, SPF_PASS=-0.001, T_RP_MATCHES_RCVD=-0.01,
	URIBL_BLOCKED=0.001] autolearn=disabled
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd1-us-west.apache.org [10.40.0.7]) (amavisd-new, port 10024)
	with ESMTP id iEJE2L3su2K7 for <dev@httpd.apache.org>;
	Sun, 11 Oct 2015 19:39:23 +0000 (UTC)
Received: from mail.thelounge.net (mail.thelounge.net [91.118.73.15])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id BF11D4357F
	for <dev@httpd.apache.org>; Sun, 11 Oct 2015 19:39:22 +0000 (UTC)
Subject: Re: [VOTE] Release Apache httpd 2.4.17 as GA
To: dev@httpd.apache.org
References: <C45BAF78-8A10-4751-B1CA-62BB499FD795@jaguNET.com>
 <561AAE67.4010609@thelounge.net>
 <CAKQ1sVNqM7s1-eOnLsHr7gs_kyoQvH3FM+1yXGqRtjWC4FDTbQ@mail.gmail.com>
 <561AB192.7000709@thelounge.net>
 <CAKQ1sVNbPSYQVA5dRrRXkoR1tp+UychOBY3-sSMTNhbU__Q1zw@mail.gmail.com>
 <561AB51F.7070303@thelounge.net>
 <CAKQ1sVN2b3N5FevRY-k5-uD=bVaYKH2g-LVuc=qResjewXfh8w@mail.gmail.com>
From: Reindl Harald <h.reindl@thelounge.net>
Openpgp: id=13540402D67A7F71C6E974EA866063CF7F780279;
 url=https://arrakis.thelounge.net/gpg/h.reindl_thelounge.net.pub.txt
X-Enigmail-Draft-Status: N1110
Organization: the lounge interactive design
Message-ID: <561ABAE1.5030807@thelounge.net>
Date: Sun, 11 Oct 2015 21:39:13 +0200
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:38.0) Gecko/20100101
 Thunderbird/38.3.0
MIME-Version: 1.0
In-Reply-To: <CAKQ1sVN2b3N5FevRY-k5-uD=bVaYKH2g-LVuc=qResjewXfh8w@mail.gmail.com>
Content-Type: multipart/signed; micalg=pgp-sha1;
 protocol="application/pgp-signature";
 boundary="HqmoNUqbioCQMkaUnq4Dqma4EW0p9Lt99"

This is an OpenPGP/MIME signed message (RFC 4880 and 3156)
--HqmoNUqbioCQMkaUnq4Dqma4EW0p9Lt99
Content-Type: text/plain; charset=utf-8; format=flowed
Content-Transfer-Encoding: quoted-printable



Am 11.10.2015 um 21:25 schrieb Yann Ylavic:
> On Sun, Oct 11, 2015 at 9:14 PM, Reindl Harald <h.reindl@thelounge.net>=
 wrote:
>>
>> "ab -c 100 -n 50000 http://small-image.gif" did not make me that happy=
 after
>> a short test on a quadcore machine, after some time httpd stopped to r=
espond
>> for a tinay statical image with a few bytes
>
> Hm, with 4 cores and a ratio of 4, there is only one bucket per
> listener, which is the same as the default.
> Did you try the same test without the directive or with a ratio of 0?
> (I rather suspect a connectivity issue with ab)

i did not test it much and honestly i am not able to make a decision=20
based on=20
http://httpd.apache.org/docs/2.4/mod/mpm_common.html#listencoresbucketsra=
tio=20


without the directive all is unchanged and stable

0 is not accepted which i would consider a bug given
the docs days default  "ListenCoresBucketsRatio 0 (disabled)"
AH00526: Syntax error on line 48 of /etc/httpd/conf/httpd-core.conf:
ListenCoresBucketsRatio must be > 0

<IfVersion >=3D 2.4.17>
  ListenCoresBucketsRatio 0
</IfVersion>
__________________________________

i just wanted to test the new feature on a 4.2.3 kernel

"ab" don't scale well but likely not a connectivity issue runnig it on=20
the same machine like httpd


--HqmoNUqbioCQMkaUnq4Dqma4EW0p9Lt99
Content-Type: application/pgp-signature; name="signature.asc"
Content-Description: OpenPGP digital signature
Content-Disposition: attachment; filename="signature.asc"

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v2

iEYEARECAAYFAlYauuEACgkQhmBjz394AnkrNgCfSfw0E86EF9Qb5L4xxsaFqEAh
tEEAmwaYnIFc5o4ovH9jD+fPhorkRWHU
=eg15
-----END PGP SIGNATURE-----

--HqmoNUqbioCQMkaUnq4Dqma4EW0p9Lt99--

From dev-return-84239-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Sun Oct 11 20:06:55 2015
Return-Path: <dev-return-84239-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 9DE4F181F6
	for <apmail-httpd-dev-archive@www.apache.org>; Sun, 11 Oct 2015 20:06:55 +0000 (UTC)
Received: (qmail 3430 invoked by uid 500); 11 Oct 2015 20:06:54 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 3363 invoked by uid 500); 11 Oct 2015 20:06:54 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 3353 invoked by uid 99); 11 Oct 2015 20:06:54 -0000
Received: from Unknown (HELO spamd4-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 11 Oct 2015 20:06:54 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd4-us-west.apache.org (ASF Mail Server at spamd4-us-west.apache.org) with ESMTP id EDB15C0DFC
	for <dev@httpd.apache.org>; Sun, 11 Oct 2015 20:06:53 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd4-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.01
X-Spam-Level:
X-Spam-Status: No, score=-0.01 tagged_above=-999 required=6.31
	tests=[SPF_PASS=-0.001, T_RP_MATCHES_RCVD=-0.01, URIBL_BLOCKED=0.001]
	autolearn=disabled
Received: from mx1-us-west.apache.org ([10.40.0.8])
	by localhost (spamd4-us-west.apache.org [10.40.0.11]) (amavisd-new, port 10024)
	with ESMTP id VS7xhZ5dfe3H for <dev@httpd.apache.org>;
	Sun, 11 Oct 2015 20:06:47 +0000 (UTC)
Received: from mailserver.kippdata.de (capsella.kippdata.de [195.227.30.149])
	by mx1-us-west.apache.org (ASF Mail Server at mx1-us-west.apache.org) with ESMTP id 2976C210B8
	for <dev@httpd.apache.org>; Sun, 11 Oct 2015 20:06:46 +0000 (UTC)
Received: from [10.0.110.6] ([192.168.2.104])
	by mailserver.kippdata.de (8.13.5/8.13.5) with ESMTP id t9BK6jNe017303
	for <dev@httpd.apache.org>; Sun, 11 Oct 2015 22:06:45 +0200 (CEST)
Subject: Re: [VOTE] Release Apache httpd 2.4.17 as GA
To: dev@httpd.apache.org
References: <C45BAF78-8A10-4751-B1CA-62BB499FD795@jaguNET.com>
 <561AAE67.4010609@thelounge.net>
 <CAKQ1sVNqM7s1-eOnLsHr7gs_kyoQvH3FM+1yXGqRtjWC4FDTbQ@mail.gmail.com>
 <561AB192.7000709@thelounge.net>
 <CAKQ1sVNbPSYQVA5dRrRXkoR1tp+UychOBY3-sSMTNhbU__Q1zw@mail.gmail.com>
 <561AB51F.7070303@thelounge.net>
From: Rainer Jung <rainer.jung@kippdata.de>
Message-ID: <561AC150.7020707@kippdata.de>
Date: Sun, 11 Oct 2015 22:06:40 +0200
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:38.0) Gecko/20100101
 Thunderbird/38.3.0
MIME-Version: 1.0
In-Reply-To: <561AB51F.7070303@thelounge.net>
Content-Type: text/plain; charset=utf-8; format=flowed
Content-Transfer-Encoding: 7bit

Am 11.10.2015 um 21:14 schrieb Reindl Harald:
>
>
> Am 11.10.2015 um 21:07 schrieb Yann Ylavic:
>> On Sun, Oct 11, 2015 at 8:59 PM, Reindl Harald
>> <h.reindl@thelounge.net> wrote:
>>>
>>> Google only showed discussions, Bugzilla and so on and finding the new
>>> directive is hard - maybe the hint should made it into the changelog
>>> for GA
>>> release
>>
>> Yes you're right, I should have mentioned that directive in the
>> CHANGES entry.
>> Unfortunately I'm afraid it's too late now, the 2.4.17 tag is frozen.
>> Hopefully the (new) documentation will quickly be indexed...
>
> no problem since it's diabled by default
>
>
> "ab -c 100 -n 50000 http://small-image.gif" did not make me that happy
> after a short test on a quadcore machine, after some time httpd stopped
> to respond for a tinay statical image with a few bytes
>
> # SO_REUSEPORT support
> # <IfVersion >= 2.4.17>
> #  ListenCoresBucketsRatio 4
> # </IfVersion>

You might run into problems if your server accumulates to many TIME_WAIT 
connections. Check their number in the "netstat -an" output.

ab without "-k" does in connection per request and if those are only 
used very short and the server is fast you can end up with a couple of 
10.000s of TIME_WAIT connections (independent of SO_REUSEPORT).

Regards,

Rainer


From dev-return-84240-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Mon Oct 12 08:26:21 2015
Return-Path: <dev-return-84240-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id A109318149
	for <apmail-httpd-dev-archive@www.apache.org>; Mon, 12 Oct 2015 08:26:21 +0000 (UTC)
Received: (qmail 45989 invoked by uid 500); 12 Oct 2015 08:26:21 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 45917 invoked by uid 500); 12 Oct 2015 08:26:21 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 45906 invoked by uid 99); 12 Oct 2015 08:26:21 -0000
Received: from Unknown (HELO spamd1-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 12 Oct 2015 08:26:21 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd1-us-west.apache.org (ASF Mail Server at spamd1-us-west.apache.org) with ESMTP id BDA63C27D9
	for <dev@httpd.apache.org>; Mon, 12 Oct 2015 08:26:20 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd1-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.7
X-Spam-Level:
X-Spam-Status: No, score=-0.7 tagged_above=-999 required=6.31
	tests=[RCVD_IN_DNSWL_LOW=-0.7] autolearn=disabled
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd1-us-west.apache.org [10.40.0.7]) (amavisd-new, port 10024)
	with ESMTP id aRGoG7PzLVDy for <dev@httpd.apache.org>;
	Mon, 12 Oct 2015 08:26:07 +0000 (UTC)
Received: from mail1.bemta3.messagelabs.com (mail1.bemta3.messagelabs.com [195.245.230.166])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id 59DBB24E1C
	for <dev@httpd.apache.org>; Mon, 12 Oct 2015 08:26:07 +0000 (UTC)
Received: from [195.245.230.51] by server-6.bemta-3.messagelabs.com id 2C/E9-29649-99E6B165; Mon, 12 Oct 2015 08:26:01 +0000
X-Env-Sender: ruediger.pluem@vodafone.com
X-Msg-Ref: server-16.tower-33.messagelabs.com!1444638354!32050855!1
X-Originating-IP: [195.232.244.133]
X-StarScan-Received:
X-StarScan-Version: 6.13.16; banners=-,-,-
X-VirusChecked: Checked
Received: (qmail 4105 invoked from network); 12 Oct 2015 08:25:55 -0000
Received: from mailout01.vodafone.com (HELO mailout01.vodafone.com) (195.232.244.133)
  by server-16.tower-33.messagelabs.com with DHE-RSA-AES256-SHA encrypted SMTP; 12 Oct 2015 08:25:55 -0000
Received: from mailint01.vodafone.com (mailint01.vodafone.com [195.232.244.198])
	by mailout01.vodafone.com (Postfix) with ESMTP id 3nZCkp1lj9z1yK7
	for <dev@httpd.apache.org>; Mon, 12 Oct 2015 10:25:54 +0200 (CEST)
Received: from mailint01.vodafone.com (localhost [127.0.0.1])
	by mailint01.vodafone.com (Postfix) with ESMTP id 3nZCjp4KJfzxQV2
	for <dev@httpd.apache.org>; Mon, 12 Oct 2015 10:25:02 +0200 (CEST)
Received: from VOEXC03W.internal.vodafone.com (voexc03w.dc-ratingen.de [145.230.101.23])
	(using TLSv1 with cipher AES128-SHA (128/128 bits))
	(No client certificate requested)
	by mailint01.vodafone.com (Postfix) with ESMTPS id 3nZCjp4FCzzxNyt
	for <dev@httpd.apache.org>; Mon, 12 Oct 2015 10:25:02 +0200 (CEST)
Received: from VOEXC19W.internal.vodafone.com (145.230.103.124) by
 VOEXC03W.internal.vodafone.com (145.230.101.23) with Microsoft SMTP Server
 (TLS) id 14.3.224.2; Mon, 12 Oct 2015 10:25:01 +0200
Received: from VOEXM10W.internal.vodafone.com ([169.254.2.88]) by
 VOEXC19W.internal.vodafone.com ([145.230.103.124]) with mapi id
 14.03.0224.002; Mon, 12 Oct 2015 10:25:00 +0200
From: =?iso-8859-1?Q?Pl=FCm=2C_R=FCdiger=2C_Vodafone_Group?=
	<ruediger.pluem@vodafone.com>
To: "dev@httpd.apache.org" <dev@httpd.apache.org>
Subject: RE: 2.4.17 test failure for mod_nntp_like_ssl when mod_http2 is
 loaded
Thread-Topic: 2.4.17 test failure for mod_nntp_like_ssl when mod_http2 is
 loaded
Thread-Index: AQHRBClIHzOjKMk+RE2YMC4Vxy9as55mWT2AgAAJoYCAAAJFAIAAAvEAgAABEACAAAIUAIAABqsAgAEOEIA=
Date: Mon, 12 Oct 2015 08:25:00 +0000
Message-ID: <AB1691BE05AE7F4992697F2A0835627AC6341EAD@VOEXM10W.internal.vodafone.com>
References: <561A64DC.5000809@kippdata.de>
 <A350DE1E-8634-43AC-A054-3BCE181D6CA1@greenbytes.de>
 <A873A60B-662E-487A-BA96-C58ED4F4E04E@greenbytes.de>
 <CAKQ1sVO5+13U2xcVc-A_1geQChnSikxeosTWubm07yDrvpzMXw@mail.gmail.com>
 <561A9A18.70904@kippdata.de>
 <1230E7B2-8907-403E-8321-21C7C9D64772@greenbytes.de>
 <DED1D215-F7E5-4D39-83F7-C461944A8129@greenbytes.de>
 <E31D3E0E-D988-4F66-A7AB-A0B3E5B7B0FB@greenbytes.de>
In-Reply-To: <E31D3E0E-D988-4F66-A7AB-A0B3E5B7B0FB@greenbytes.de>
Accept-Language: en-US
Content-Language: en-US
X-MS-Has-Attach:
X-MS-TNEF-Correlator:
Content-Type: text/plain; charset="iso-8859-1"
Content-Transfer-Encoding: quoted-printable
MIME-Version: 1.0

How about the following patch?

This separates the triggering of the SSL Handshake and the possible reading=
 of the 24 bytes:

Index: h2_h2.c                                                             =
  =20
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D          =20
--- h2_h2.c     (revision 1707437)                                         =
  =20
+++ h2_h2.c     (working copy)                                             =
  =20
@@ -154,7 +154,7 @@

         temp =3D apr_brigade_create(c->pool, c->bucket_alloc);
         status =3D ap_get_brigade(c->input_filters, temp,
-                                AP_MODE_SPECULATIVE, APR_BLOCK_READ, 24);
+                                AP_MODE_INIT, APR_BLOCK_READ, 0);

         if (status =3D=3D APR_SUCCESS) {
             if (h2_ctx_protocol_get(c)
@@ -171,23 +171,31 @@
                     char *s =3D NULL;
                     apr_size_t slen;

-                    apr_brigade_pflatten(temp, &s, &slen, c->pool);
-                    if ((slen >=3D 24) && !memcmp(H2_MAGIC_TOKEN, s, 24)) =
{
-                        ap_log_cerror(APLOG_MARK, APLOG_TRACE1, 0, c,
-                                      "h2_h2, direct mode detected");
-                        h2_ctx_protocol_set(ctx, is_tls? "h2" : "h2c");
+                    status =3D ap_get_brigade(c->input_filters, temp,
+                                            AP_MODE_SPECULATIVE, APR_BLOCK=
_READ, 24);
+                    if (status =3D=3D APR_SUCCESS) {
+                        apr_brigade_pflatten(temp, &s, &slen, c->pool);
+                        if ((slen >=3D 24) && !memcmp(H2_MAGIC_TOKEN, s, 2=
4)) {
+                            ap_log_cerror(APLOG_MARK, APLOG_TRACE1, 0, c,
+                                          "h2_h2, direct mode detected");
+                            h2_ctx_protocol_set(ctx, is_tls? "h2" : "h2c")=
;
+                        }
+                        else {
+                            ap_log_cerror(APLOG_MARK, APLOG_TRACE2, 0, c,
+                                          "h2_h2, not detected in %d bytes=
: %s",
+                                          (int)slen, s);
+                        }
                     }
-                    else {
-                        ap_log_cerror(APLOG_MARK, APLOG_TRACE2, 0, c,
-                                      "h2_h2, not detected in %d bytes: %s=
",
-                                      (int)slen, s);
-                    }
                 }
+                else {
+                    ap_log_cerror(APLOG_MARK, APLOG_DEBUG, status, c,
+                                  "h2_h2, error reading 24 bytes speculati=
ve");
+                }
             }
         }
         else {
             ap_log_cerror(APLOG_MARK, APLOG_DEBUG, status, c,
-                          "h2_h2, error reading 24 bytes speculative");
+                          "h2_h2, Failed to init connection");
         }
         apr_brigade_destroy(temp);
     }

This would still block in the non ssl case if directmode is not set to off =
explicitly. I would propose to change the default behaviour of directmode h=
ere to off as directmode seems to be something very special to me that shou=
ld be explicitly enabled.

Regards

R=FCdiger

> -----Original Message-----
> From: Stefan Eissing [mailto:stefan.eissing@greenbytes.de]
> Sent: Sonntag, 11. Oktober 2015 19:54
> To: dev@httpd.apache.org
> Subject: Re: 2.4.17 test failure for mod_nntp_like_ssl when mod_http2 is
> loaded
>=20
> Ok, in ssl_engine_io.c, lines 1426+ I see a hint:
>=20
>     /* XXX: we could actually move ssl_io_filter_handshake to an
>      * ap_hook_process_connection but would still need to call it for
>      * AP_MODE_INIT for protocols that may upgrade the connection
>      * rather than have SSLEngine On configured.
>      */
>     if ((status =3D ssl_io_filter_handshake(inctx->filter_ctx)) !=3D
> APR_SUCCESS) {
>         return ssl_io_filter_error(f, bb, status);
>     }
>=20
> The handshake handling gets triggered on a filter, so it all happens on
> READs (or WRITEs), which explains why connection hooks do not see it. Thi=
s
> is quite some code which looks like we do not want to touch for a "quick
> fix". Also, there is no quick fix inside mod_http2 as before handshake,
> the SNI might also not be there yet, thus the vhost cannot be determined.
> etc.
>=20
> For the current release, I think we should leave it as it is and advise
> that current mod_http2 is incompatible with things like nntp.
>=20
> For the next release, I'd like the server to perform the handshake at a
> defined time, so other modules can rely on protocols being selected and
> correct vhost being known before the first read/write.
>=20
> //Stefan
>=20

From dev-return-84241-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Mon Oct 12 08:36:26 2015
Return-Path: <dev-return-84241-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 8E217181A7
	for <apmail-httpd-dev-archive@www.apache.org>; Mon, 12 Oct 2015 08:36:26 +0000 (UTC)
Received: (qmail 63098 invoked by uid 500); 12 Oct 2015 08:36:26 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 63010 invoked by uid 500); 12 Oct 2015 08:36:25 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 63000 invoked by uid 99); 12 Oct 2015 08:36:25 -0000
Received: from Unknown (HELO spamd4-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 12 Oct 2015 08:36:25 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd4-us-west.apache.org (ASF Mail Server at spamd4-us-west.apache.org) with ESMTP id 7478CC0DFC
	for <dev@httpd.apache.org>; Mon, 12 Oct 2015 08:36:25 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd4-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.01
X-Spam-Level:
X-Spam-Status: No, score=-0.01 tagged_above=-999 required=6.31
	tests=[SPF_PASS=-0.001, T_RP_MATCHES_RCVD=-0.01, URIBL_BLOCKED=0.001]
	autolearn=disabled
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd4-us-west.apache.org [10.40.0.11]) (amavisd-new, port 10024)
	with ESMTP id yNUdZRM9V5vl for <dev@httpd.apache.org>;
	Mon, 12 Oct 2015 08:36:17 +0000 (UTC)
Received: from mail.greenbytes.de (mail.greenbytes.de [217.91.35.233])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id 5CCA620F10
	for <dev@httpd.apache.org>; Mon, 12 Oct 2015 08:36:16 +0000 (UTC)
Received: from [192.168.1.42] (unknown [5.10.171.186])
	(using TLSv1 with cipher ECDHE-RSA-AES256-SHA (256/256 bits))
	(Client did not present a certificate)
	by mail.greenbytes.de (Postfix) with ESMTPSA id 9159215A043A
	for <dev@httpd.apache.org>; Mon, 12 Oct 2015 10:36:09 +0200 (CEST)
Content-Type: text/plain; charset=iso-8859-1
Mime-Version: 1.0 (Mac OS X Mail 9.0 \(3094\))
Subject: Re: 2.4.17 test failure for mod_nntp_like_ssl when mod_http2 is loaded
From: Stefan Eissing <stefan.eissing@greenbytes.de>
In-Reply-To: <AB1691BE05AE7F4992697F2A0835627AC6341EAD@VOEXM10W.internal.vodafone.com>
Date: Mon, 12 Oct 2015 10:36:08 +0200
Content-Transfer-Encoding: quoted-printable
Message-Id: <BD8FC109-83BA-467A-93E0-2B2DF6C47DD8@greenbytes.de>
References: <561A64DC.5000809@kippdata.de> <A350DE1E-8634-43AC-A054-3BCE181D6CA1@greenbytes.de> <A873A60B-662E-487A-BA96-C58ED4F4E04E@greenbytes.de> <CAKQ1sVO5+13U2xcVc-A_1geQChnSikxeosTWubm07yDrvpzMXw@mail.gmail.com> <561A9A18.70904@kippdata.de> <1230E7B2-8907-403E-8321-21C7C9D64772@greenbytes.de> <DED1D215-F7E5-4D39-83F7-C461944A8129@greenbytes.de> <E31D3E0E-D988-4F66-A7AB-A0B3E5B7B0FB@greenbytes.de> <AB1691BE05AE7F4992697F2A0835627AC6341EAD@VOEXM10W.internal.vodafone.com>
To: dev@httpd.apache.org
X-Mailer: Apple Mail (2.3094)

Yeah, I tried a 0 len read. Unfortunately, the core input filter is not =
happy about that:

core_filters.c, line 231
        AP_DEBUG_ASSERT(readbytes > 0);

> Am 12.10.2015 um 10:25 schrieb Pl=FCm, R=FCdiger, Vodafone Group =
<ruediger.pluem@vodafone.com>:
>=20
> How about the following patch?
>=20
> This separates the triggering of the SSL Handshake and the possible =
reading of the 24 bytes:
>=20
> Index: h2_h2.c                                                         =
      =20
> =3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D          =20
> --- h2_h2.c     (revision 1707437)                                     =
      =20
> +++ h2_h2.c     (working copy)                                         =
      =20
> @@ -154,7 +154,7 @@
>=20
>         temp =3D apr_brigade_create(c->pool, c->bucket_alloc);
>         status =3D ap_get_brigade(c->input_filters, temp,
> -                                AP_MODE_SPECULATIVE, APR_BLOCK_READ, =
24);
> +                                AP_MODE_INIT, APR_BLOCK_READ, 0);
>=20
>         if (status =3D=3D APR_SUCCESS) {
>             if (h2_ctx_protocol_get(c)
> @@ -171,23 +171,31 @@
>                     char *s =3D NULL;
>                     apr_size_t slen;
>=20
> -                    apr_brigade_pflatten(temp, &s, &slen, c->pool);
> -                    if ((slen >=3D 24) && !memcmp(H2_MAGIC_TOKEN, s, =
24)) {
> -                        ap_log_cerror(APLOG_MARK, APLOG_TRACE1, 0, c,
> -                                      "h2_h2, direct mode detected");
> -                        h2_ctx_protocol_set(ctx, is_tls? "h2" : =
"h2c");
> +                    status =3D ap_get_brigade(c->input_filters, temp,
> +                                            AP_MODE_SPECULATIVE, =
APR_BLOCK_READ, 24);
> +                    if (status =3D=3D APR_SUCCESS) {
> +                        apr_brigade_pflatten(temp, &s, &slen, =
c->pool);
> +                        if ((slen >=3D 24) && !memcmp(H2_MAGIC_TOKEN, =
s, 24)) {
> +                            ap_log_cerror(APLOG_MARK, APLOG_TRACE1, =
0, c,
> +                                          "h2_h2, direct mode =
detected");
> +                            h2_ctx_protocol_set(ctx, is_tls? "h2" : =
"h2c");
> +                        }
> +                        else {
> +                            ap_log_cerror(APLOG_MARK, APLOG_TRACE2, =
0, c,
> +                                          "h2_h2, not detected in %d =
bytes: %s",
> +                                          (int)slen, s);
> +                        }
>                     }
> -                    else {
> -                        ap_log_cerror(APLOG_MARK, APLOG_TRACE2, 0, c,
> -                                      "h2_h2, not detected in %d =
bytes: %s",
> -                                      (int)slen, s);
> -                    }
>                 }
> +                else {
> +                    ap_log_cerror(APLOG_MARK, APLOG_DEBUG, status, c,
> +                                  "h2_h2, error reading 24 bytes =
speculative");
> +                }
>             }
>         }
>         else {
>             ap_log_cerror(APLOG_MARK, APLOG_DEBUG, status, c,
> -                          "h2_h2, error reading 24 bytes =
speculative");
> +                          "h2_h2, Failed to init connection");
>         }
>         apr_brigade_destroy(temp);
>     }
>=20
> This would still block in the non ssl case if directmode is not set to =
off explicitly. I would propose to change the default behaviour of =
directmode here to off as directmode seems to be something very special =
to me that should be explicitly enabled.
>=20
> Regards
>=20
> R=FCdiger
>=20
>> -----Original Message-----
>> From: Stefan Eissing [mailto:stefan.eissing@greenbytes.de]
>> Sent: Sonntag, 11. Oktober 2015 19:54
>> To: dev@httpd.apache.org
>> Subject: Re: 2.4.17 test failure for mod_nntp_like_ssl when mod_http2 =
is
>> loaded
>>=20
>> Ok, in ssl_engine_io.c, lines 1426+ I see a hint:
>>=20
>>    /* XXX: we could actually move ssl_io_filter_handshake to an
>>     * ap_hook_process_connection but would still need to call it for
>>     * AP_MODE_INIT for protocols that may upgrade the connection
>>     * rather than have SSLEngine On configured.
>>     */
>>    if ((status =3D ssl_io_filter_handshake(inctx->filter_ctx)) !=3D
>> APR_SUCCESS) {
>>        return ssl_io_filter_error(f, bb, status);
>>    }
>>=20
>> The handshake handling gets triggered on a filter, so it all happens =
on
>> READs (or WRITEs), which explains why connection hooks do not see it. =
This
>> is quite some code which looks like we do not want to touch for a =
"quick
>> fix". Also, there is no quick fix inside mod_http2 as before =
handshake,
>> the SNI might also not be there yet, thus the vhost cannot be =
determined.
>> etc.
>>=20
>> For the current release, I think we should leave it as it is and =
advise
>> that current mod_http2 is incompatible with things like nntp.
>>=20
>> For the next release, I'd like the server to perform the handshake at =
a
>> defined time, so other modules can rely on protocols being selected =
and
>> correct vhost being known before the first read/write.
>>=20
>> //Stefan
>>=20


From dev-return-84242-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Mon Oct 12 08:42:54 2015
Return-Path: <dev-return-84242-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id C65C4181D4
	for <apmail-httpd-dev-archive@www.apache.org>; Mon, 12 Oct 2015 08:42:54 +0000 (UTC)
Received: (qmail 70907 invoked by uid 500); 12 Oct 2015 08:42:51 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 70827 invoked by uid 500); 12 Oct 2015 08:42:51 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 70817 invoked by uid 99); 12 Oct 2015 08:42:51 -0000
Received: from Unknown (HELO spamd3-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 12 Oct 2015 08:42:51 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd3-us-west.apache.org (ASF Mail Server at spamd3-us-west.apache.org) with ESMTP id D17F8180A56
	for <dev@httpd.apache.org>; Mon, 12 Oct 2015 08:42:50 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd3-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.101
X-Spam-Level:
X-Spam-Status: No, score=-0.101 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RCVD_IN_MSPIKE_H2=-0.001, SPF_PASS=-0.001, URIBL_BLOCKED=0.001]
	autolearn=disabled
Authentication-Results: spamd3-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd3-us-west.apache.org [10.40.0.10]) (amavisd-new, port 10024)
	with ESMTP id ZAL5Aj_A8Lj2 for <dev@httpd.apache.org>;
	Mon, 12 Oct 2015 08:42:42 +0000 (UTC)
Received: from mail-qg0-f41.google.com (mail-qg0-f41.google.com [209.85.192.41])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id 466FF20C18
	for <dev@httpd.apache.org>; Mon, 12 Oct 2015 08:42:41 +0000 (UTC)
Received: by qgt47 with SMTP id 47so115162791qgt.2
        for <dev@httpd.apache.org>; Mon, 12 Oct 2015 01:42:34 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type:content-transfer-encoding;
        bh=94VYBBs3xZ8Ti2+o/zej0pQbdL7FF3wHauAdeka8iRQ=;
        b=zs+ewerOZTMGiCwlZm2C5hk6rULgtYl7mI2jM4Is4HZLMyp3kX+3B2UWzx2DF38M6D
         FDqwTCNkkJrzzddrS8RLkhrnYhVci55R6TzWXHgd1ENsUAXlzcYKcTK9bESLB72+Ulam
         b48+gDandZAh/lUigB57lLUHpkvyZ33BpU/1N9v+6YZ6Wg/CSHaUGubLc96KX2V5/qzl
         fVjkAQAXzNuOKHp69FZb+/EBTSHt/NBDBLsuJro836GO9sW7X3JM6vjSht8gbHcBO4h9
         bWqpHIiOIpR1o86cvbT0w0/FYSDx+uAA99cLJjIrWx5/wLNZ7KhqJe5NGS/4c4KlubND
         r7iQ==
MIME-Version: 1.0
X-Received: by 10.140.101.119 with SMTP id t110mr31650043qge.71.1444639354439;
 Mon, 12 Oct 2015 01:42:34 -0700 (PDT)
Received: by 10.55.72.20 with HTTP; Mon, 12 Oct 2015 01:42:34 -0700 (PDT)
In-Reply-To: <BD8FC109-83BA-467A-93E0-2B2DF6C47DD8@greenbytes.de>
References: <561A64DC.5000809@kippdata.de>
	<A350DE1E-8634-43AC-A054-3BCE181D6CA1@greenbytes.de>
	<A873A60B-662E-487A-BA96-C58ED4F4E04E@greenbytes.de>
	<CAKQ1sVO5+13U2xcVc-A_1geQChnSikxeosTWubm07yDrvpzMXw@mail.gmail.com>
	<561A9A18.70904@kippdata.de>
	<1230E7B2-8907-403E-8321-21C7C9D64772@greenbytes.de>
	<DED1D215-F7E5-4D39-83F7-C461944A8129@greenbytes.de>
	<E31D3E0E-D988-4F66-A7AB-A0B3E5B7B0FB@greenbytes.de>
	<AB1691BE05AE7F4992697F2A0835627AC6341EAD@VOEXM10W.internal.vodafone.com>
	<BD8FC109-83BA-467A-93E0-2B2DF6C47DD8@greenbytes.de>
Date: Mon, 12 Oct 2015 10:42:34 +0200
Message-ID: <CAKQ1sVN-zWKoYFhzwQL467XG7XyvyoC28Ut0TwFnDNNmUbkXZg@mail.gmail.com>
Subject: Re: 2.4.17 test failure for mod_nntp_like_ssl when mod_http2 is loaded
From: Yann Ylavic <ylavic.dev@gmail.com>
To: dev@httpd.apache.org
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: quoted-printable

The key here is using AP_MODE_INIT first (where 0 make sense) before
AP_MODE_SPECULATIVE.


On Mon, Oct 12, 2015 at 10:36 AM, Stefan Eissing
<stefan.eissing@greenbytes.de> wrote:
> Yeah, I tried a 0 len read. Unfortunately, the core input filter is not h=
appy about that:
>
> core_filters.c, line 231
>         AP_DEBUG_ASSERT(readbytes > 0);
>
>> Am 12.10.2015 um 10:25 schrieb Pl=C3=BCm, R=C3=BCdiger, Vodafone Group <=
ruediger.pluem@vodafone.com>:
>>
>> How about the following patch?
>>
>> This separates the triggering of the SSL Handshake and the possible read=
ing of the 24 bytes:
>>
>> Index: h2_h2.c
>> =3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D
>> --- h2_h2.c     (revision 1707437)
>> +++ h2_h2.c     (working copy)
>> @@ -154,7 +154,7 @@
>>
>>         temp =3D apr_brigade_create(c->pool, c->bucket_alloc);
>>         status =3D ap_get_brigade(c->input_filters, temp,
>> -                                AP_MODE_SPECULATIVE, APR_BLOCK_READ, 24=
);
>> +                                AP_MODE_INIT, APR_BLOCK_READ, 0);
>>
>>         if (status =3D=3D APR_SUCCESS) {
>>             if (h2_ctx_protocol_get(c)
>> @@ -171,23 +171,31 @@
>>                     char *s =3D NULL;
>>                     apr_size_t slen;
>>
>> -                    apr_brigade_pflatten(temp, &s, &slen, c->pool);
>> -                    if ((slen >=3D 24) && !memcmp(H2_MAGIC_TOKEN, s, 24=
)) {
>> -                        ap_log_cerror(APLOG_MARK, APLOG_TRACE1, 0, c,
>> -                                      "h2_h2, direct mode detected");
>> -                        h2_ctx_protocol_set(ctx, is_tls? "h2" : "h2c");
>> +                    status =3D ap_get_brigade(c->input_filters, temp,
>> +                                            AP_MODE_SPECULATIVE, APR_BL=
OCK_READ, 24);
>> +                    if (status =3D=3D APR_SUCCESS) {
>> +                        apr_brigade_pflatten(temp, &s, &slen, c->pool);
>> +                        if ((slen >=3D 24) && !memcmp(H2_MAGIC_TOKEN, s=
, 24)) {
>> +                            ap_log_cerror(APLOG_MARK, APLOG_TRACE1, 0, =
c,
>> +                                          "h2_h2, direct mode detected"=
);
>> +                            h2_ctx_protocol_set(ctx, is_tls? "h2" : "h2=
c");
>> +                        }
>> +                        else {
>> +                            ap_log_cerror(APLOG_MARK, APLOG_TRACE2, 0, =
c,
>> +                                          "h2_h2, not detected in %d by=
tes: %s",
>> +                                          (int)slen, s);
>> +                        }
>>                     }
>> -                    else {
>> -                        ap_log_cerror(APLOG_MARK, APLOG_TRACE2, 0, c,
>> -                                      "h2_h2, not detected in %d bytes:=
 %s",
>> -                                      (int)slen, s);
>> -                    }
>>                 }
>> +                else {
>> +                    ap_log_cerror(APLOG_MARK, APLOG_DEBUG, status, c,
>> +                                  "h2_h2, error reading 24 bytes specul=
ative");
>> +                }
>>             }
>>         }
>>         else {
>>             ap_log_cerror(APLOG_MARK, APLOG_DEBUG, status, c,
>> -                          "h2_h2, error reading 24 bytes speculative");
>> +                          "h2_h2, Failed to init connection");
>>         }
>>         apr_brigade_destroy(temp);
>>     }
>>
>> This would still block in the non ssl case if directmode is not set to o=
ff explicitly. I would propose to change the default behaviour of directmod=
e here to off as directmode seems to be something very special to me that s=
hould be explicitly enabled.
>>
>> Regards
>>
>> R=C3=BCdiger
>>
>>> -----Original Message-----
>>> From: Stefan Eissing [mailto:stefan.eissing@greenbytes.de]
>>> Sent: Sonntag, 11. Oktober 2015 19:54
>>> To: dev@httpd.apache.org
>>> Subject: Re: 2.4.17 test failure for mod_nntp_like_ssl when mod_http2 i=
s
>>> loaded
>>>
>>> Ok, in ssl_engine_io.c, lines 1426+ I see a hint:
>>>
>>>    /* XXX: we could actually move ssl_io_filter_handshake to an
>>>     * ap_hook_process_connection but would still need to call it for
>>>     * AP_MODE_INIT for protocols that may upgrade the connection
>>>     * rather than have SSLEngine On configured.
>>>     */
>>>    if ((status =3D ssl_io_filter_handshake(inctx->filter_ctx)) !=3D
>>> APR_SUCCESS) {
>>>        return ssl_io_filter_error(f, bb, status);
>>>    }
>>>
>>> The handshake handling gets triggered on a filter, so it all happens on
>>> READs (or WRITEs), which explains why connection hooks do not see it. T=
his
>>> is quite some code which looks like we do not want to touch for a "quic=
k
>>> fix". Also, there is no quick fix inside mod_http2 as before handshake,
>>> the SNI might also not be there yet, thus the vhost cannot be determine=
d.
>>> etc.
>>>
>>> For the current release, I think we should leave it as it is and advise
>>> that current mod_http2 is incompatible with things like nntp.
>>>
>>> For the next release, I'd like the server to perform the handshake at a
>>> defined time, so other modules can rely on protocols being selected and
>>> correct vhost being known before the first read/write.
>>>
>>> //Stefan
>>>
>

From dev-return-84244-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Mon Oct 12 08:58:17 2015
Return-Path: <dev-return-84244-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id BC9AF1822D
	for <apmail-httpd-dev-archive@www.apache.org>; Mon, 12 Oct 2015 08:58:17 +0000 (UTC)
Received: (qmail 95692 invoked by uid 500); 12 Oct 2015 08:58:17 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 95605 invoked by uid 500); 12 Oct 2015 08:58:17 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 95595 invoked by uid 99); 12 Oct 2015 08:58:17 -0000
Received: from Unknown (HELO spamd4-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 12 Oct 2015 08:58:17 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd4-us-west.apache.org (ASF Mail Server at spamd4-us-west.apache.org) with ESMTP id C6B46C0BE2
	for <dev@httpd.apache.org>; Mon, 12 Oct 2015 08:58:16 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd4-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 0.79
X-Spam-Level:
X-Spam-Status: No, score=0.79 tagged_above=-999 required=6.31
	tests=[KAM_ASCII_DIVIDERS=0.8, SPF_PASS=-0.001,
	T_RP_MATCHES_RCVD=-0.01, URIBL_BLOCKED=0.001] autolearn=disabled
Received: from mx1-us-west.apache.org ([10.40.0.8])
	by localhost (spamd4-us-west.apache.org [10.40.0.11]) (amavisd-new, port 10024)
	with ESMTP id awYfAwsryWuE for <dev@httpd.apache.org>;
	Mon, 12 Oct 2015 08:58:07 +0000 (UTC)
Received: from mail.greenbytes.de (mail.greenbytes.de [217.91.35.233])
	by mx1-us-west.apache.org (ASF Mail Server at mx1-us-west.apache.org) with ESMTPS id 0E5F32031C
	for <dev@httpd.apache.org>; Mon, 12 Oct 2015 08:58:06 +0000 (UTC)
Received: from [192.168.1.42] (unknown [5.10.171.186])
	(using TLSv1 with cipher ECDHE-RSA-AES256-SHA (256/256 bits))
	(Client did not present a certificate)
	by mail.greenbytes.de (Postfix) with ESMTPSA id 16D9115A0321
	for <dev@httpd.apache.org>; Mon, 12 Oct 2015 10:58:04 +0200 (CEST)
Content-Type: text/plain; charset=utf-8
Mime-Version: 1.0 (Mac OS X Mail 9.0 \(3094\))
Subject: Re: 2.4.17 test failure for mod_nntp_like_ssl when mod_http2 is loaded
From: Stefan Eissing <stefan.eissing@greenbytes.de>
In-Reply-To: <CAKQ1sVOAFE5Jui8KN-NtwEVj1Ut+AuuawW669GvM_-f4xDCCVQ@mail.gmail.com>
Date: Mon, 12 Oct 2015 10:58:04 +0200
Content-Transfer-Encoding: quoted-printable
Message-Id: <561CC574-296E-4287-AD60-AED06DBE1ECE@greenbytes.de>
References: <561A64DC.5000809@kippdata.de> <A350DE1E-8634-43AC-A054-3BCE181D6CA1@greenbytes.de> <A873A60B-662E-487A-BA96-C58ED4F4E04E@greenbytes.de> <CAKQ1sVO5+13U2xcVc-A_1geQChnSikxeosTWubm07yDrvpzMXw@mail.gmail.com> <561A9A18.70904@kippdata.de> <1230E7B2-8907-403E-8321-21C7C9D64772@greenbytes.de> <DED1D215-F7E5-4D39-83F7-C461944A8129@greenbytes.de> <E31D3E0E-D988-4F66-A7AB-A0B3E5B7B0FB@greenbytes.de> <AB1691BE05AE7F4992697F2A0835627AC6341EAD@VOEXM10W.internal.vodafone.com> <BD8FC109-83BA-467A-93E0-2B2DF6C47DD8@greenbytes.de> <CAKQ1sVN-zWKoYFhzwQL467XG7XyvyoC28Ut0TwFnDNNmUbkXZg@mail.gmail.com> <CAKQ1sVOAFE5Jui8KN-NtwEVj1Ut+AuuawW669GvM_-f4xDCCVQ@mail.gmail.com>
To: dev@httpd.apache.org
X-Mailer: Apple Mail (2.3094)

The AP_MODE_INIT triggers the handshake nicely. But the protocol =
switching still happens
on the first read. currently looking how to trigger that best.

The h2_task_input is only ever run on "pseudo" connections. But I agree =
that
it should pass init down the filter chain.=20

//Stefan

> Am 12.10.2015 um 10:54 schrieb Yann Ylavic <ylavic.dev@gmail.com>:
>=20
> Also, I wonder if we don't need:
>=20
> Index: modules/http2/h2_task_input.c
> =3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D
> --- modules/http2/h2_task_input.c    (revision 1707888)
> +++ modules/http2/h2_task_input.c    (working copy)
> @@ -116,7 +116,7 @@ apr_status_t h2_task_input_read(h2_task_input *inp
>     }
>=20
>     if (mode =3D=3D AP_MODE_INIT) {
> -        return APR_SUCCESS;
> +        return ap_get_brigade(f->c->input_filters, bb, mode, block, =
readbytes);
>     }
>=20
>     if (input->bb) {
> --
>=20
> We shouldn't since h2_task_input_read() is called at NETWORK level
> (hence after mod_ssl which "eats" AP_MODE_INIT), but it looks more
> correct (as it would be in mod_ssl) since anyway the
> core_input_filter() can handle it.
>=20
>=20
> On Mon, Oct 12, 2015 at 10:42 AM, Yann Ylavic <ylavic.dev@gmail.com> =
wrote:
>> The key here is using AP_MODE_INIT first (where 0 make sense) before
>> AP_MODE_SPECULATIVE.
>>=20
>>=20
>> On Mon, Oct 12, 2015 at 10:36 AM, Stefan Eissing
>> <stefan.eissing@greenbytes.de> wrote:
>>> Yeah, I tried a 0 len read. Unfortunately, the core input filter is =
not happy about that:
>>>=20
>>> core_filters.c, line 231
>>>        AP_DEBUG_ASSERT(readbytes > 0);
>>>=20
>>>> Am 12.10.2015 um 10:25 schrieb Pl=C3=BCm, R=C3=BCdiger, Vodafone =
Group <ruediger.pluem@vodafone.com>:
>>>>=20
>>>> How about the following patch?
>>>>=20
>>>> This separates the triggering of the SSL Handshake and the possible =
reading of the 24 bytes:
>>>>=20
>>>> Index: h2_h2.c
>>>> =3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D
>>>> --- h2_h2.c     (revision 1707437)
>>>> +++ h2_h2.c     (working copy)
>>>> @@ -154,7 +154,7 @@
>>>>=20
>>>>        temp =3D apr_brigade_create(c->pool, c->bucket_alloc);
>>>>        status =3D ap_get_brigade(c->input_filters, temp,
>>>> -                                AP_MODE_SPECULATIVE, =
APR_BLOCK_READ, 24);
>>>> +                                AP_MODE_INIT, APR_BLOCK_READ, 0);
>>>>=20
>>>>        if (status =3D=3D APR_SUCCESS) {
>>>>            if (h2_ctx_protocol_get(c)
>>>> @@ -171,23 +171,31 @@
>>>>                    char *s =3D NULL;
>>>>                    apr_size_t slen;
>>>>=20
>>>> -                    apr_brigade_pflatten(temp, &s, &slen, =
c->pool);
>>>> -                    if ((slen >=3D 24) && !memcmp(H2_MAGIC_TOKEN, =
s, 24)) {
>>>> -                        ap_log_cerror(APLOG_MARK, APLOG_TRACE1, 0, =
c,
>>>> -                                      "h2_h2, direct mode =
detected");
>>>> -                        h2_ctx_protocol_set(ctx, is_tls? "h2" : =
"h2c");
>>>> +                    status =3D ap_get_brigade(c->input_filters, =
temp,
>>>> +                                            AP_MODE_SPECULATIVE, =
APR_BLOCK_READ, 24);
>>>> +                    if (status =3D=3D APR_SUCCESS) {
>>>> +                        apr_brigade_pflatten(temp, &s, &slen, =
c->pool);
>>>> +                        if ((slen >=3D 24) && =
!memcmp(H2_MAGIC_TOKEN, s, 24)) {
>>>> +                            ap_log_cerror(APLOG_MARK, =
APLOG_TRACE1, 0, c,
>>>> +                                          "h2_h2, direct mode =
detected");
>>>> +                            h2_ctx_protocol_set(ctx, is_tls? "h2" =
: "h2c");
>>>> +                        }
>>>> +                        else {
>>>> +                            ap_log_cerror(APLOG_MARK, =
APLOG_TRACE2, 0, c,
>>>> +                                          "h2_h2, not detected in =
%d bytes: %s",
>>>> +                                          (int)slen, s);
>>>> +                        }
>>>>                    }
>>>> -                    else {
>>>> -                        ap_log_cerror(APLOG_MARK, APLOG_TRACE2, 0, =
c,
>>>> -                                      "h2_h2, not detected in %d =
bytes: %s",
>>>> -                                      (int)slen, s);
>>>> -                    }
>>>>                }
>>>> +                else {
>>>> +                    ap_log_cerror(APLOG_MARK, APLOG_DEBUG, status, =
c,
>>>> +                                  "h2_h2, error reading 24 bytes =
speculative");
>>>> +                }
>>>>            }
>>>>        }
>>>>        else {
>>>>            ap_log_cerror(APLOG_MARK, APLOG_DEBUG, status, c,
>>>> -                          "h2_h2, error reading 24 bytes =
speculative");
>>>> +                          "h2_h2, Failed to init connection");
>>>>        }
>>>>        apr_brigade_destroy(temp);
>>>>    }
>>>>=20
>>>> This would still block in the non ssl case if directmode is not set =
to off explicitly. I would propose to change the default behaviour of =
directmode here to off as directmode seems to be something very special =
to me that should be explicitly enabled.
>>>>=20
>>>> Regards
>>>>=20
>>>> R=C3=BCdiger
>>>>=20
>>>>> -----Original Message-----
>>>>> From: Stefan Eissing [mailto:stefan.eissing@greenbytes.de]
>>>>> Sent: Sonntag, 11. Oktober 2015 19:54
>>>>> To: dev@httpd.apache.org
>>>>> Subject: Re: 2.4.17 test failure for mod_nntp_like_ssl when =
mod_http2 is
>>>>> loaded
>>>>>=20
>>>>> Ok, in ssl_engine_io.c, lines 1426+ I see a hint:
>>>>>=20
>>>>>   /* XXX: we could actually move ssl_io_filter_handshake to an
>>>>>    * ap_hook_process_connection but would still need to call it =
for
>>>>>    * AP_MODE_INIT for protocols that may upgrade the connection
>>>>>    * rather than have SSLEngine On configured.
>>>>>    */
>>>>>   if ((status =3D ssl_io_filter_handshake(inctx->filter_ctx)) !=3D
>>>>> APR_SUCCESS) {
>>>>>       return ssl_io_filter_error(f, bb, status);
>>>>>   }
>>>>>=20
>>>>> The handshake handling gets triggered on a filter, so it all =
happens on
>>>>> READs (or WRITEs), which explains why connection hooks do not see =
it. This
>>>>> is quite some code which looks like we do not want to touch for a =
"quick
>>>>> fix". Also, there is no quick fix inside mod_http2 as before =
handshake,
>>>>> the SNI might also not be there yet, thus the vhost cannot be =
determined.
>>>>> etc.
>>>>>=20
>>>>> For the current release, I think we should leave it as it is and =
advise
>>>>> that current mod_http2 is incompatible with things like nntp.
>>>>>=20
>>>>> For the next release, I'd like the server to perform the handshake =
at a
>>>>> defined time, so other modules can rely on protocols being =
selected and
>>>>> correct vhost being known before the first read/write.
>>>>>=20
>>>>> //Stefan
>>>>>=20
>>>=20


From dev-return-84243-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Mon Oct 12 09:01:54 2015
Return-Path: <dev-return-84243-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 999961824F
	for <apmail-httpd-dev-archive@www.apache.org>; Mon, 12 Oct 2015 09:01:54 +0000 (UTC)
Received: (qmail 92245 invoked by uid 500); 12 Oct 2015 08:55:05 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 92168 invoked by uid 500); 12 Oct 2015 08:55:05 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 92158 invoked by uid 99); 12 Oct 2015 08:55:05 -0000
Received: from Unknown (HELO spamd4-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 12 Oct 2015 08:55:05 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd4-us-west.apache.org (ASF Mail Server at spamd4-us-west.apache.org) with ESMTP id 0B3A2C0BE2
	for <dev@httpd.apache.org>; Mon, 12 Oct 2015 08:55:05 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd4-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 0.7
X-Spam-Level:
X-Spam-Status: No, score=0.7 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	KAM_ASCII_DIVIDERS=0.8, SPF_PASS=-0.001, URIBL_BLOCKED=0.001]
	autolearn=disabled
Authentication-Results: spamd4-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-us-west.apache.org ([10.40.0.8])
	by localhost (spamd4-us-west.apache.org [10.40.0.11]) (amavisd-new, port 10024)
	with ESMTP id 96DQI351OCO8 for <dev@httpd.apache.org>;
	Mon, 12 Oct 2015 08:54:52 +0000 (UTC)
Received: from mail-qg0-f47.google.com (mail-qg0-f47.google.com [209.85.192.47])
	by mx1-us-west.apache.org (ASF Mail Server at mx1-us-west.apache.org) with ESMTPS id DE1AD2031C
	for <dev@httpd.apache.org>; Mon, 12 Oct 2015 08:54:51 +0000 (UTC)
Received: by qgx61 with SMTP id 61so115350824qgx.3
        for <dev@httpd.apache.org>; Mon, 12 Oct 2015 01:54:51 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type:content-transfer-encoding;
        bh=qHRnGxCgWY7yqtrFO8FDIqrHO17/UTspz2zYd8wrKbg=;
        b=TMJWBPAW3a86Vpop3doWnOZ7WGVn+VuQp1KhNCoOZbUfS79G1JYmxyYFp7Iebve7Po
         TUvlyVO3Vedm1t+FRP84bdvWyrGtHaOq00OwPMeZ3oZGvjVrOFuKCLEc1Tl1qH3DhIUi
         oLc4u6AWstkWrAgqXaU4vSq+ZseA2e5Q/oTyO9Z4nm2XpCABNsf11XweO3LkCR4IOm1y
         89lE7lujE85lxchM/gshW1uJtSiaCpuMkoudEioWoN24dKcVy2Y75FSmMLa+jn+f4859
         XyxVrCOonXy9QShfQvX4dB/mbk33JI6LX/cBfeAvet7z7tyRaU7mgw3lfCZ8ddLdknb+
         D0Jw==
MIME-Version: 1.0
X-Received: by 10.140.131.70 with SMTP id 67mr33253475qhd.70.1444640091237;
 Mon, 12 Oct 2015 01:54:51 -0700 (PDT)
Received: by 10.55.72.20 with HTTP; Mon, 12 Oct 2015 01:54:51 -0700 (PDT)
In-Reply-To: <CAKQ1sVN-zWKoYFhzwQL467XG7XyvyoC28Ut0TwFnDNNmUbkXZg@mail.gmail.com>
References: <561A64DC.5000809@kippdata.de>
	<A350DE1E-8634-43AC-A054-3BCE181D6CA1@greenbytes.de>
	<A873A60B-662E-487A-BA96-C58ED4F4E04E@greenbytes.de>
	<CAKQ1sVO5+13U2xcVc-A_1geQChnSikxeosTWubm07yDrvpzMXw@mail.gmail.com>
	<561A9A18.70904@kippdata.de>
	<1230E7B2-8907-403E-8321-21C7C9D64772@greenbytes.de>
	<DED1D215-F7E5-4D39-83F7-C461944A8129@greenbytes.de>
	<E31D3E0E-D988-4F66-A7AB-A0B3E5B7B0FB@greenbytes.de>
	<AB1691BE05AE7F4992697F2A0835627AC6341EAD@VOEXM10W.internal.vodafone.com>
	<BD8FC109-83BA-467A-93E0-2B2DF6C47DD8@greenbytes.de>
	<CAKQ1sVN-zWKoYFhzwQL467XG7XyvyoC28Ut0TwFnDNNmUbkXZg@mail.gmail.com>
Date: Mon, 12 Oct 2015 10:54:51 +0200
Message-ID: <CAKQ1sVOAFE5Jui8KN-NtwEVj1Ut+AuuawW669GvM_-f4xDCCVQ@mail.gmail.com>
Subject: Re: 2.4.17 test failure for mod_nntp_like_ssl when mod_http2 is loaded
From: Yann Ylavic <ylavic.dev@gmail.com>
To: dev@httpd.apache.org
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: quoted-printable

Also, I wonder if we don't need:

Index: modules/http2/h2_task_input.c
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D
--- modules/http2/h2_task_input.c    (revision 1707888)
+++ modules/http2/h2_task_input.c    (working copy)
@@ -116,7 +116,7 @@ apr_status_t h2_task_input_read(h2_task_input *inp
     }

     if (mode =3D=3D AP_MODE_INIT) {
-        return APR_SUCCESS;
+        return ap_get_brigade(f->c->input_filters, bb, mode, block, readby=
tes);
     }

     if (input->bb) {
--

We shouldn't since h2_task_input_read() is called at NETWORK level
(hence after mod_ssl which "eats" AP_MODE_INIT), but it looks more
correct (as it would be in mod_ssl) since anyway the
core_input_filter() can handle it.


On Mon, Oct 12, 2015 at 10:42 AM, Yann Ylavic <ylavic.dev@gmail.com> wrote:
> The key here is using AP_MODE_INIT first (where 0 make sense) before
> AP_MODE_SPECULATIVE.
>
>
> On Mon, Oct 12, 2015 at 10:36 AM, Stefan Eissing
> <stefan.eissing@greenbytes.de> wrote:
>> Yeah, I tried a 0 len read. Unfortunately, the core input filter is not =
happy about that:
>>
>> core_filters.c, line 231
>>         AP_DEBUG_ASSERT(readbytes > 0);
>>
>>> Am 12.10.2015 um 10:25 schrieb Pl=C3=BCm, R=C3=BCdiger, Vodafone Group =
<ruediger.pluem@vodafone.com>:
>>>
>>> How about the following patch?
>>>
>>> This separates the triggering of the SSL Handshake and the possible rea=
ding of the 24 bytes:
>>>
>>> Index: h2_h2.c
>>> =3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D
>>> --- h2_h2.c     (revision 1707437)
>>> +++ h2_h2.c     (working copy)
>>> @@ -154,7 +154,7 @@
>>>
>>>         temp =3D apr_brigade_create(c->pool, c->bucket_alloc);
>>>         status =3D ap_get_brigade(c->input_filters, temp,
>>> -                                AP_MODE_SPECULATIVE, APR_BLOCK_READ, 2=
4);
>>> +                                AP_MODE_INIT, APR_BLOCK_READ, 0);
>>>
>>>         if (status =3D=3D APR_SUCCESS) {
>>>             if (h2_ctx_protocol_get(c)
>>> @@ -171,23 +171,31 @@
>>>                     char *s =3D NULL;
>>>                     apr_size_t slen;
>>>
>>> -                    apr_brigade_pflatten(temp, &s, &slen, c->pool);
>>> -                    if ((slen >=3D 24) && !memcmp(H2_MAGIC_TOKEN, s, 2=
4)) {
>>> -                        ap_log_cerror(APLOG_MARK, APLOG_TRACE1, 0, c,
>>> -                                      "h2_h2, direct mode detected");
>>> -                        h2_ctx_protocol_set(ctx, is_tls? "h2" : "h2c")=
;
>>> +                    status =3D ap_get_brigade(c->input_filters, temp,
>>> +                                            AP_MODE_SPECULATIVE, APR_B=
LOCK_READ, 24);
>>> +                    if (status =3D=3D APR_SUCCESS) {
>>> +                        apr_brigade_pflatten(temp, &s, &slen, c->pool)=
;
>>> +                        if ((slen >=3D 24) && !memcmp(H2_MAGIC_TOKEN, =
s, 24)) {
>>> +                            ap_log_cerror(APLOG_MARK, APLOG_TRACE1, 0,=
 c,
>>> +                                          "h2_h2, direct mode detected=
");
>>> +                            h2_ctx_protocol_set(ctx, is_tls? "h2" : "h=
2c");
>>> +                        }
>>> +                        else {
>>> +                            ap_log_cerror(APLOG_MARK, APLOG_TRACE2, 0,=
 c,
>>> +                                          "h2_h2, not detected in %d b=
ytes: %s",
>>> +                                          (int)slen, s);
>>> +                        }
>>>                     }
>>> -                    else {
>>> -                        ap_log_cerror(APLOG_MARK, APLOG_TRACE2, 0, c,
>>> -                                      "h2_h2, not detected in %d bytes=
: %s",
>>> -                                      (int)slen, s);
>>> -                    }
>>>                 }
>>> +                else {
>>> +                    ap_log_cerror(APLOG_MARK, APLOG_DEBUG, status, c,
>>> +                                  "h2_h2, error reading 24 bytes specu=
lative");
>>> +                }
>>>             }
>>>         }
>>>         else {
>>>             ap_log_cerror(APLOG_MARK, APLOG_DEBUG, status, c,
>>> -                          "h2_h2, error reading 24 bytes speculative")=
;
>>> +                          "h2_h2, Failed to init connection");
>>>         }
>>>         apr_brigade_destroy(temp);
>>>     }
>>>
>>> This would still block in the non ssl case if directmode is not set to =
off explicitly. I would propose to change the default behaviour of directmo=
de here to off as directmode seems to be something very special to me that =
should be explicitly enabled.
>>>
>>> Regards
>>>
>>> R=C3=BCdiger
>>>
>>>> -----Original Message-----
>>>> From: Stefan Eissing [mailto:stefan.eissing@greenbytes.de]
>>>> Sent: Sonntag, 11. Oktober 2015 19:54
>>>> To: dev@httpd.apache.org
>>>> Subject: Re: 2.4.17 test failure for mod_nntp_like_ssl when mod_http2 =
is
>>>> loaded
>>>>
>>>> Ok, in ssl_engine_io.c, lines 1426+ I see a hint:
>>>>
>>>>    /* XXX: we could actually move ssl_io_filter_handshake to an
>>>>     * ap_hook_process_connection but would still need to call it for
>>>>     * AP_MODE_INIT for protocols that may upgrade the connection
>>>>     * rather than have SSLEngine On configured.
>>>>     */
>>>>    if ((status =3D ssl_io_filter_handshake(inctx->filter_ctx)) !=3D
>>>> APR_SUCCESS) {
>>>>        return ssl_io_filter_error(f, bb, status);
>>>>    }
>>>>
>>>> The handshake handling gets triggered on a filter, so it all happens o=
n
>>>> READs (or WRITEs), which explains why connection hooks do not see it. =
This
>>>> is quite some code which looks like we do not want to touch for a "qui=
ck
>>>> fix". Also, there is no quick fix inside mod_http2 as before handshake=
,
>>>> the SNI might also not be there yet, thus the vhost cannot be determin=
ed.
>>>> etc.
>>>>
>>>> For the current release, I think we should leave it as it is and advis=
e
>>>> that current mod_http2 is incompatible with things like nntp.
>>>>
>>>> For the next release, I'd like the server to perform the handshake at =
a
>>>> defined time, so other modules can rely on protocols being selected an=
d
>>>> correct vhost being known before the first read/write.
>>>>
>>>> //Stefan
>>>>
>>

From dev-return-84245-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Mon Oct 12 09:07:26 2015
Return-Path: <dev-return-84245-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 4EDC51828E
	for <apmail-httpd-dev-archive@www.apache.org>; Mon, 12 Oct 2015 09:07:26 +0000 (UTC)
Received: (qmail 13433 invoked by uid 500); 12 Oct 2015 09:07:25 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 13354 invoked by uid 500); 12 Oct 2015 09:07:25 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 13344 invoked by uid 99); 12 Oct 2015 09:07:25 -0000
Received: from Unknown (HELO spamd2-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 12 Oct 2015 09:07:25 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd2-us-west.apache.org (ASF Mail Server at spamd2-us-west.apache.org) with ESMTP id 4D5A61A2810
	for <dev@httpd.apache.org>; Mon, 12 Oct 2015 09:07:25 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd2-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.801
X-Spam-Level:
X-Spam-Status: No, score=-0.801 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RCVD_IN_DNSWL_LOW=-0.7, RCVD_IN_MSPIKE_H2=-0.001, SPF_PASS=-0.001,
	URIBL_BLOCKED=0.001] autolearn=disabled
Authentication-Results: spamd2-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd2-us-west.apache.org [10.40.0.9]) (amavisd-new, port 10024)
	with ESMTP id WSyMAkL88Gmq for <dev@httpd.apache.org>;
	Mon, 12 Oct 2015 09:07:24 +0000 (UTC)
Received: from mail-qg0-f51.google.com (mail-qg0-f51.google.com [209.85.192.51])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id 9AA3D439CB
	for <dev@httpd.apache.org>; Mon, 12 Oct 2015 09:07:24 +0000 (UTC)
Received: by qgez77 with SMTP id z77so116112687qge.1
        for <dev@httpd.apache.org>; Mon, 12 Oct 2015 02:07:18 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        bh=0O4sv2YPP3T/DSgGmZLcPbeo/Y0c/iVLMbaJYYdgV2Y=;
        b=UhEbRpiGcVNuU5Ss3mQdYS/FFhARd/3eyYxZ772jNoKX9kmUOE6RjXyajQAeK9W0WR
         aOGNYYeZV1mNpi9YHUK2WuCX0AHNlYltwaN0obj4/zMWcqA/dBzbuUg/0MXl4G+F2hGP
         nKooKBmlvXRDjtsmJIkEGhwpfXs5nihxrxsZIuA4pz2PSlDP9yVb+BYn09Jlm7gb7pra
         okmQt08SB5eStb8sLUCaT1Kz6wQOmuyPJhuVffOVbCi01K4/NF8sjMnsrgATSsjv/UYn
         LiBxZ8IAmICrGKT8eAtX6bxD5htGxCCKbrb/owYwfuMKpgS+t2864T3Z2fMtPNUt+oRM
         0N5g==
MIME-Version: 1.0
X-Received: by 10.140.107.54 with SMTP id g51mr31116936qgf.38.1444640837842;
 Mon, 12 Oct 2015 02:07:17 -0700 (PDT)
Received: by 10.55.72.20 with HTTP; Mon, 12 Oct 2015 02:07:17 -0700 (PDT)
In-Reply-To: <CAKQ1sVNabR-048ozc7qy9MhMCqsC7PXYwzvuX=+mCDEKRriZbQ@mail.gmail.com>
References: <561A64DC.5000809@kippdata.de>
	<A350DE1E-8634-43AC-A054-3BCE181D6CA1@greenbytes.de>
	<A873A60B-662E-487A-BA96-C58ED4F4E04E@greenbytes.de>
	<CAKQ1sVO5+13U2xcVc-A_1geQChnSikxeosTWubm07yDrvpzMXw@mail.gmail.com>
	<B1E3C336-57A0-4487-A084-93BCA8E7CC70@greenbytes.de>
	<CAKQ1sVNabR-048ozc7qy9MhMCqsC7PXYwzvuX=+mCDEKRriZbQ@mail.gmail.com>
Date: Mon, 12 Oct 2015 11:07:17 +0200
Message-ID: <CAKQ1sVP1ZCe2-j24+yBZvFo70aZ1Gw2v7TnW+3U9BBgMwT4W7A@mail.gmail.com>
Subject: Re: 2.4.17 test failure for mod_nntp_like_ssl when mod_http2 is loaded
From: Yann Ylavic <ylavic.dev@gmail.com>
To: dev@httpd.apache.org
Content-Type: text/plain; charset=UTF-8

On Sun, Oct 11, 2015 at 7:15 PM, Yann Ylavic <ylavic.dev@gmail.com> wrote:
> On Sun, Oct 11, 2015 at 7:11 PM, Stefan Eissing
> <stefan.eissing@greenbytes.de> wrote:
>> Don't think so. But loading the module should do no harm, I think. And it does now.
>
> Isn't configuring H2Direct on which harms?

Didn't figure out "H2Direct on" was the default for non-TLS.
I don't think it's a good idea, beyond the NNTP case, the admin should
have to enable this by her/his own.

From dev-return-84246-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Mon Oct 12 09:09:45 2015
Return-Path: <dev-return-84246-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 120B21829B
	for <apmail-httpd-dev-archive@www.apache.org>; Mon, 12 Oct 2015 09:09:45 +0000 (UTC)
Received: (qmail 19529 invoked by uid 500); 12 Oct 2015 09:09:44 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 19468 invoked by uid 500); 12 Oct 2015 09:09:44 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 19458 invoked by uid 99); 12 Oct 2015 09:09:44 -0000
Received: from Unknown (HELO spamd4-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 12 Oct 2015 09:09:44 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd4-us-west.apache.org (ASF Mail Server at spamd4-us-west.apache.org) with ESMTP id F0D04C0BE2
	for <dev@httpd.apache.org>; Mon, 12 Oct 2015 09:09:43 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd4-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.009
X-Spam-Level:
X-Spam-Status: No, score=-0.009 tagged_above=-999 required=6.31
	tests=[T_RP_MATCHES_RCVD=-0.01, URIBL_BLOCKED=0.001]
	autolearn=disabled
Received: from mx1-us-west.apache.org ([10.40.0.8])
	by localhost (spamd4-us-west.apache.org [10.40.0.11]) (amavisd-new, port 10024)
	with ESMTP id hX7RymA_qXPj for <dev@httpd.apache.org>;
	Mon, 12 Oct 2015 09:09:36 +0000 (UTC)
Received: from mail.greenbytes.de (mail.greenbytes.de [217.91.35.233])
	by mx1-us-west.apache.org (ASF Mail Server at mx1-us-west.apache.org) with ESMTPS id 1E56A2031C
	for <dev@httpd.apache.org>; Mon, 12 Oct 2015 09:09:36 +0000 (UTC)
Received: from [192.168.1.42] (unknown [5.10.171.186])
	(using TLSv1 with cipher ECDHE-RSA-AES256-SHA (256/256 bits))
	(Client did not present a certificate)
	by mail.greenbytes.de (Postfix) with ESMTPSA id 20ED715A01AD
	for <dev@httpd.apache.org>; Mon, 12 Oct 2015 11:09:34 +0200 (CEST)
Content-Type: text/plain; charset=us-ascii
Mime-Version: 1.0 (Mac OS X Mail 9.0 \(3094\))
Subject: Re: 2.4.17 test failure for mod_nntp_like_ssl when mod_http2 is loaded
From: Stefan Eissing <stefan.eissing@greenbytes.de>
In-Reply-To: <CAKQ1sVP1ZCe2-j24+yBZvFo70aZ1Gw2v7TnW+3U9BBgMwT4W7A@mail.gmail.com>
Date: Mon, 12 Oct 2015 11:09:33 +0200
Content-Transfer-Encoding: quoted-printable
Message-Id: <E60F1FAA-865A-4F8F-996A-1F881FDEE141@greenbytes.de>
References: <561A64DC.5000809@kippdata.de> <A350DE1E-8634-43AC-A054-3BCE181D6CA1@greenbytes.de> <A873A60B-662E-487A-BA96-C58ED4F4E04E@greenbytes.de> <CAKQ1sVO5+13U2xcVc-A_1geQChnSikxeosTWubm07yDrvpzMXw@mail.gmail.com> <B1E3C336-57A0-4487-A084-93BCA8E7CC70@greenbytes.de> <CAKQ1sVNabR-048ozc7qy9MhMCqsC7PXYwzvuX=+mCDEKRriZbQ@mail.gmail.com> <CAKQ1sVP1ZCe2-j24+yBZvFo70aZ1Gw2v7TnW+3U9BBgMwT4W7A@mail.gmail.com>
To: dev@httpd.apache.org
X-Mailer: Apple Mail (2.3094)

I plan to change it to only happen for servers, where h2/h2c is among =
configured protocols.

> Am 12.10.2015 um 11:07 schrieb Yann Ylavic <ylavic.dev@gmail.com>:
>=20
> On Sun, Oct 11, 2015 at 7:15 PM, Yann Ylavic <ylavic.dev@gmail.com> =
wrote:
>> On Sun, Oct 11, 2015 at 7:11 PM, Stefan Eissing
>> <stefan.eissing@greenbytes.de> wrote:
>>> Don't think so. But loading the module should do no harm, I think. =
And it does now.
>>=20
>> Isn't configuring H2Direct on which harms?
>=20
> Didn't figure out "H2Direct on" was the default for non-TLS.
> I don't think it's a good idea, beyond the NNTP case, the admin should
> have to enable this by her/his own.


From dev-return-84247-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Mon Oct 12 09:12:31 2015
Return-Path: <dev-return-84247-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id DCDB5182C4
	for <apmail-httpd-dev-archive@www.apache.org>; Mon, 12 Oct 2015 09:12:31 +0000 (UTC)
Received: (qmail 28861 invoked by uid 500); 12 Oct 2015 09:12:31 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 28786 invoked by uid 500); 12 Oct 2015 09:12:31 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 28776 invoked by uid 99); 12 Oct 2015 09:12:31 -0000
Received: from Unknown (HELO spamd4-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 12 Oct 2015 09:12:31 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd4-us-west.apache.org (ASF Mail Server at spamd4-us-west.apache.org) with ESMTP id C4E5FC0BE2
	for <dev@httpd.apache.org>; Mon, 12 Oct 2015 09:12:30 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd4-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.801
X-Spam-Level:
X-Spam-Status: No, score=-0.801 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RCVD_IN_DNSWL_LOW=-0.7, RCVD_IN_MSPIKE_H2=-0.001, SPF_PASS=-0.001,
	URIBL_BLOCKED=0.001] autolearn=disabled
Authentication-Results: spamd4-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd4-us-west.apache.org [10.40.0.11]) (amavisd-new, port 10024)
	with ESMTP id VafQrQm5DhIh for <dev@httpd.apache.org>;
	Mon, 12 Oct 2015 09:12:23 +0000 (UTC)
Received: from mail-qg0-f47.google.com (mail-qg0-f47.google.com [209.85.192.47])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id 2BF7542B35
	for <dev@httpd.apache.org>; Mon, 12 Oct 2015 09:12:23 +0000 (UTC)
Received: by qgez77 with SMTP id z77so116178858qge.1
        for <dev@httpd.apache.org>; Mon, 12 Oct 2015 02:12:23 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        bh=VU0QWZdMAwF/fFXgEPZcf/oRnKLLNfccpyOyd8hgwQg=;
        b=OH/lLBaePlb8BqvcrB4p+GemTgvl8jsqDht1KjSTW3o40ErD7XQPsDlp/AsYAEgkV4
         aV7DvqNd05PE+ng7rjmpMAkwA5d+WzW/kA4MmNDlsnlYN3J1wIXRMNj4f/HwJiVmADIA
         miexvlATfj6UUPrddOeV+k1NbvU9/6j3hG55hR8wWSwbh6/6nYnNyUKPz5SQQGW465Ir
         gAwp5GvGY3nL36heQlOk2Jtz28d+XSelNQDWFk9Y2h4FFp4/3ow9B6h55REtX89GTxjQ
         uenBSmtzzIjl1HIPlnIwUgspHZFq0qChudKnxcleQtkydjoDRwmIdGGHF+AGzuxzEAJQ
         CDFw==
MIME-Version: 1.0
X-Received: by 10.141.23.9 with SMTP id z9mr32364425qhd.24.1444641142964; Mon,
 12 Oct 2015 02:12:22 -0700 (PDT)
Received: by 10.55.72.20 with HTTP; Mon, 12 Oct 2015 02:12:22 -0700 (PDT)
In-Reply-To: <E60F1FAA-865A-4F8F-996A-1F881FDEE141@greenbytes.de>
References: <561A64DC.5000809@kippdata.de>
	<A350DE1E-8634-43AC-A054-3BCE181D6CA1@greenbytes.de>
	<A873A60B-662E-487A-BA96-C58ED4F4E04E@greenbytes.de>
	<CAKQ1sVO5+13U2xcVc-A_1geQChnSikxeosTWubm07yDrvpzMXw@mail.gmail.com>
	<B1E3C336-57A0-4487-A084-93BCA8E7CC70@greenbytes.de>
	<CAKQ1sVNabR-048ozc7qy9MhMCqsC7PXYwzvuX=+mCDEKRriZbQ@mail.gmail.com>
	<CAKQ1sVP1ZCe2-j24+yBZvFo70aZ1Gw2v7TnW+3U9BBgMwT4W7A@mail.gmail.com>
	<E60F1FAA-865A-4F8F-996A-1F881FDEE141@greenbytes.de>
Date: Mon, 12 Oct 2015 11:12:22 +0200
Message-ID: <CAKQ1sVNK8uPtZGHdgmrWkuV9a0_uwG--xBJHWRqQj2n0-iGKkA@mail.gmail.com>
Subject: Re: 2.4.17 test failure for mod_nntp_like_ssl when mod_http2 is loaded
From: Yann Ylavic <ylavic.dev@gmail.com>
To: dev@httpd.apache.org
Content-Type: text/plain; charset=UTF-8

That would be better, but still the doc says "This mode falls outside
the RFC 7540 but has become widely implemented as it is very
convenient for development and testing".
Is this something used by real world h2 clients?

On Mon, Oct 12, 2015 at 11:09 AM, Stefan Eissing
<stefan.eissing@greenbytes.de> wrote:
> I plan to change it to only happen for servers, where h2/h2c is among configured protocols.
>
>> Am 12.10.2015 um 11:07 schrieb Yann Ylavic <ylavic.dev@gmail.com>:
>>
>> On Sun, Oct 11, 2015 at 7:15 PM, Yann Ylavic <ylavic.dev@gmail.com> wrote:
>>> On Sun, Oct 11, 2015 at 7:11 PM, Stefan Eissing
>>> <stefan.eissing@greenbytes.de> wrote:
>>>> Don't think so. But loading the module should do no harm, I think. And it does now.
>>>
>>> Isn't configuring H2Direct on which harms?
>>
>> Didn't figure out "H2Direct on" was the default for non-TLS.
>> I don't think it's a good idea, beyond the NNTP case, the admin should
>> have to enable this by her/his own.
>

From dev-return-84248-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Mon Oct 12 09:13:58 2015
Return-Path: <dev-return-84248-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 0334B182D9
	for <apmail-httpd-dev-archive@www.apache.org>; Mon, 12 Oct 2015 09:13:58 +0000 (UTC)
Received: (qmail 32704 invoked by uid 500); 12 Oct 2015 09:13:54 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 32636 invoked by uid 500); 12 Oct 2015 09:13:54 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 32626 invoked by uid 99); 12 Oct 2015 09:13:54 -0000
Received: from Unknown (HELO spamd1-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 12 Oct 2015 09:13:54 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd1-us-west.apache.org (ASF Mail Server at spamd1-us-west.apache.org) with ESMTP id 2C9F6C5773
	for <dev@httpd.apache.org>; Mon, 12 Oct 2015 09:13:54 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd1-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.802
X-Spam-Level:
X-Spam-Status: No, score=-0.802 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RCVD_IN_DNSWL_LOW=-0.7, RCVD_IN_MSPIKE_H2=-0.001, SPF_PASS=-0.001]
	autolearn=disabled
Authentication-Results: spamd1-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-us-west.apache.org ([10.40.0.8])
	by localhost (spamd1-us-west.apache.org [10.40.0.7]) (amavisd-new, port 10024)
	with ESMTP id LnXKobBGqhTf for <dev@httpd.apache.org>;
	Mon, 12 Oct 2015 09:13:53 +0000 (UTC)
Received: from mail-qg0-f44.google.com (mail-qg0-f44.google.com [209.85.192.44])
	by mx1-us-west.apache.org (ASF Mail Server at mx1-us-west.apache.org) with ESMTPS id 7590C207EE
	for <dev@httpd.apache.org>; Mon, 12 Oct 2015 09:13:53 +0000 (UTC)
Received: by qgeb31 with SMTP id b31so14318735qge.0
        for <dev@httpd.apache.org>; Mon, 12 Oct 2015 02:13:52 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        bh=5EhLGctVAgNw7MS4PUGcuYRK6bX2It+WYDGaKLMJgqc=;
        b=tf3aUqPSiPBiAbSyx2q2r6/tqDRhS5mc+LKNCPSkHZxTBUmId4vVbpxmz5Ru4oUCSs
         r2ZhEaAJMpV6Oq6G60gJmX5tC3jrjzK2HCnEilAOwnbHG6iAReqOaWwn+ZoHSfQ8rF11
         0u1vL8DVbWBieE1L0bhV9itW2E3sLhDWGlfgtD6Nzo/ACPYmy/msyA9/LEHzjk9TzprX
         WCqJ9SQfeReUkz03nzu8cqJAlE62RlSVFKX+Kb8Zzevi7ETYJLuT/CbaPSoGakms0/oR
         txDw/7FB3RXRV5/lw5MJsJLn5K94ayJZgUsG2Y2+wL3DRX7HQUlwPdv2+Upzhj5oNgpQ
         CERA==
MIME-Version: 1.0
X-Received: by 10.140.131.198 with SMTP id 189mr32664671qhd.83.1444641232779;
 Mon, 12 Oct 2015 02:13:52 -0700 (PDT)
Received: by 10.55.72.20 with HTTP; Mon, 12 Oct 2015 02:13:52 -0700 (PDT)
In-Reply-To: <CAKQ1sVNK8uPtZGHdgmrWkuV9a0_uwG--xBJHWRqQj2n0-iGKkA@mail.gmail.com>
References: <561A64DC.5000809@kippdata.de>
	<A350DE1E-8634-43AC-A054-3BCE181D6CA1@greenbytes.de>
	<A873A60B-662E-487A-BA96-C58ED4F4E04E@greenbytes.de>
	<CAKQ1sVO5+13U2xcVc-A_1geQChnSikxeosTWubm07yDrvpzMXw@mail.gmail.com>
	<B1E3C336-57A0-4487-A084-93BCA8E7CC70@greenbytes.de>
	<CAKQ1sVNabR-048ozc7qy9MhMCqsC7PXYwzvuX=+mCDEKRriZbQ@mail.gmail.com>
	<CAKQ1sVP1ZCe2-j24+yBZvFo70aZ1Gw2v7TnW+3U9BBgMwT4W7A@mail.gmail.com>
	<E60F1FAA-865A-4F8F-996A-1F881FDEE141@greenbytes.de>
	<CAKQ1sVNK8uPtZGHdgmrWkuV9a0_uwG--xBJHWRqQj2n0-iGKkA@mail.gmail.com>
Date: Mon, 12 Oct 2015 11:13:52 +0200
Message-ID: <CAKQ1sVPXcsGxn07R5Wihp4uizP+bAey1SoX_9e4U_91BWujd1g@mail.gmail.com>
Subject: Re: 2.4.17 test failure for mod_nntp_like_ssl when mod_http2 is loaded
From: Yann Ylavic <ylavic.dev@gmail.com>
To: dev@httpd.apache.org
Content-Type: text/plain; charset=UTF-8

On Mon, Oct 12, 2015 at 11:12 AM, Yann Ylavic <ylavic.dev@gmail.com> wrote:
> Is this something used by real world h2 clients?

I meant browers :p

From dev-return-84249-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Mon Oct 12 09:14:20 2015
Return-Path: <dev-return-84249-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id DFD70182DA
	for <apmail-httpd-dev-archive@www.apache.org>; Mon, 12 Oct 2015 09:14:19 +0000 (UTC)
Received: (qmail 33832 invoked by uid 500); 12 Oct 2015 09:14:19 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 33752 invoked by uid 500); 12 Oct 2015 09:14:19 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 33741 invoked by uid 99); 12 Oct 2015 09:14:19 -0000
Received: from Unknown (HELO spamd4-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 12 Oct 2015 09:14:19 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd4-us-west.apache.org (ASF Mail Server at spamd4-us-west.apache.org) with ESMTP id 0B385C0BE2
	for <dev@httpd.apache.org>; Mon, 12 Oct 2015 09:14:19 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd4-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.01
X-Spam-Level:
X-Spam-Status: No, score=-0.01 tagged_above=-999 required=6.31
	tests=[SPF_PASS=-0.001, T_RP_MATCHES_RCVD=-0.01, URIBL_BLOCKED=0.001]
	autolearn=disabled
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd4-us-west.apache.org [10.40.0.11]) (amavisd-new, port 10024)
	with ESMTP id 3tYPWmWQUIqm for <dev@httpd.apache.org>;
	Mon, 12 Oct 2015 09:14:11 +0000 (UTC)
Received: from mailserver.kippdata.de (capsella.kippdata.de [195.227.30.149])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTP id 06F4A439BE
	for <dev@httpd.apache.org>; Mon, 12 Oct 2015 09:14:10 +0000 (UTC)
Received: from [195.227.30.209] (notebook-rj [195.227.30.209])
	by mailserver.kippdata.de (8.13.5/8.13.5) with ESMTP id t9C9E9oL023412
	for <dev@httpd.apache.org>; Mon, 12 Oct 2015 11:14:09 +0200 (CEST)
Subject: Re: 2.4.17 test failure for mod_nntp_like_ssl when mod_http2 is
 loaded
To: dev@httpd.apache.org
References: <561A64DC.5000809@kippdata.de>
 <A350DE1E-8634-43AC-A054-3BCE181D6CA1@greenbytes.de>
 <A873A60B-662E-487A-BA96-C58ED4F4E04E@greenbytes.de>
 <CAKQ1sVO5+13U2xcVc-A_1geQChnSikxeosTWubm07yDrvpzMXw@mail.gmail.com>
 <B1E3C336-57A0-4487-A084-93BCA8E7CC70@greenbytes.de>
 <CAKQ1sVNabR-048ozc7qy9MhMCqsC7PXYwzvuX=+mCDEKRriZbQ@mail.gmail.com>
 <CAKQ1sVP1ZCe2-j24+yBZvFo70aZ1Gw2v7TnW+3U9BBgMwT4W7A@mail.gmail.com>
 <E60F1FAA-865A-4F8F-996A-1F881FDEE141@greenbytes.de>
From: Rainer Jung <rainer.jung@kippdata.de>
Message-ID: <561B79D6.30101@kippdata.de>
Date: Mon, 12 Oct 2015 11:13:58 +0200
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:38.0) Gecko/20100101
 Thunderbird/38.3.0
MIME-Version: 1.0
In-Reply-To: <E60F1FAA-865A-4F8F-996A-1F881FDEE141@greenbytes.de>
Content-Type: text/plain; charset=utf-8; format=flowed
Content-Transfer-Encoding: 7bit

Am 12.10.2015 um 11:09 schrieb Stefan Eissing:
> I plan to change it to only happen for servers, where h2/h2c is among configured protocols.
>
>> Am 12.10.2015 um 11:07 schrieb Yann Ylavic <ylavic.dev@gmail.com>:
>>
>> On Sun, Oct 11, 2015 at 7:15 PM, Yann Ylavic <ylavic.dev@gmail.com> wrote:
>>> On Sun, Oct 11, 2015 at 7:11 PM, Stefan Eissing
>>> <stefan.eissing@greenbytes.de> wrote:
>>>> Don't think so. But loading the module should do no harm, I think. And it does now.
>>>
>>> Isn't configuring H2Direct on which harms?
>>
>> Didn't figure out "H2Direct on" was the default for non-TLS.
>> I don't think it's a good idea, beyond the NNTP case, the admin should
>> have to enable this by her/his own.

Since I started this thread: IMHO this discussion shouldn't 
stop/influence 2.4.17. mod_http2 is experimental, so even a change of 
defaults in early releases should be OK. And any exotic interop problems 
are not critical enough to roll another release.

Regards,

Rainer


From dev-return-84250-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Mon Oct 12 09:15:49 2015
Return-Path: <dev-return-84250-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 11FD9182E6
	for <apmail-httpd-dev-archive@www.apache.org>; Mon, 12 Oct 2015 09:15:49 +0000 (UTC)
Received: (qmail 37844 invoked by uid 500); 12 Oct 2015 09:15:39 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 37772 invoked by uid 500); 12 Oct 2015 09:15:39 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 37762 invoked by uid 99); 12 Oct 2015 09:15:39 -0000
Received: from Unknown (HELO spamd2-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 12 Oct 2015 09:15:39 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd2-us-west.apache.org (ASF Mail Server at spamd2-us-west.apache.org) with ESMTP id 0CA921A2810
	for <dev@httpd.apache.org>; Mon, 12 Oct 2015 09:15:39 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd2-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.101
X-Spam-Level:
X-Spam-Status: No, score=-0.101 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RCVD_IN_MSPIKE_H2=-0.001, SPF_PASS=-0.001, URIBL_BLOCKED=0.001]
	autolearn=disabled
Authentication-Results: spamd2-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-us-west.apache.org ([10.40.0.8])
	by localhost (spamd2-us-west.apache.org [10.40.0.9]) (amavisd-new, port 10024)
	with ESMTP id mKPSgU5TvdNp for <dev@httpd.apache.org>;
	Mon, 12 Oct 2015 09:15:33 +0000 (UTC)
Received: from mail-qg0-f47.google.com (mail-qg0-f47.google.com [209.85.192.47])
	by mx1-us-west.apache.org (ASF Mail Server at mx1-us-west.apache.org) with ESMTPS id DD7DB20FD1
	for <dev@httpd.apache.org>; Mon, 12 Oct 2015 09:15:32 +0000 (UTC)
Received: by qgt47 with SMTP id 47so115586770qgt.2
        for <dev@httpd.apache.org>; Mon, 12 Oct 2015 02:15:32 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        bh=OC6ddoEo7HVucvlGli/3cu9aCeWTtgVn7Upf+KBkSYA=;
        b=fmvdQFfrZwgPBpudV8GgDLB7wyNC2XOVnPQdTJ4netcS8/OOBno09eJrcPrHaSxhGt
         9JHPU/mZTuOzntMpVH506vYYtwxiMtrEGhk0gqFkGTZj61oDP2gEg9rgYuHT2UTbASHi
         AfgFF3SYv+FOZBDMKdZMc95I6cG3oDSWjI90gV1oggc6+qPKt+35zVTM8UPAuVFcs7EU
         YFRRi+AVs349+aE1LWL3b4tCb0mpE6fnZ2zZQfImbu6lgiTrvFtAYQgd3Q8sBGr31kNa
         0rKqVoiKuRe1b8iGEu04rLrfan1ftuCUK1hGEX1AMjGx7ee3LdSsqQ5M8FArlg4QapzP
         +XGA==
MIME-Version: 1.0
X-Received: by 10.140.101.119 with SMTP id t110mr31786593qge.71.1444641332307;
 Mon, 12 Oct 2015 02:15:32 -0700 (PDT)
Received: by 10.55.72.20 with HTTP; Mon, 12 Oct 2015 02:15:32 -0700 (PDT)
In-Reply-To: <561B79D6.30101@kippdata.de>
References: <561A64DC.5000809@kippdata.de>
	<A350DE1E-8634-43AC-A054-3BCE181D6CA1@greenbytes.de>
	<A873A60B-662E-487A-BA96-C58ED4F4E04E@greenbytes.de>
	<CAKQ1sVO5+13U2xcVc-A_1geQChnSikxeosTWubm07yDrvpzMXw@mail.gmail.com>
	<B1E3C336-57A0-4487-A084-93BCA8E7CC70@greenbytes.de>
	<CAKQ1sVNabR-048ozc7qy9MhMCqsC7PXYwzvuX=+mCDEKRriZbQ@mail.gmail.com>
	<CAKQ1sVP1ZCe2-j24+yBZvFo70aZ1Gw2v7TnW+3U9BBgMwT4W7A@mail.gmail.com>
	<E60F1FAA-865A-4F8F-996A-1F881FDEE141@greenbytes.de>
	<561B79D6.30101@kippdata.de>
Date: Mon, 12 Oct 2015 11:15:32 +0200
Message-ID: <CAKQ1sVMe=aabdqYkske4P4kJJC+9JL0TMH9bycgXH4RfX+WiFw@mail.gmail.com>
Subject: Re: 2.4.17 test failure for mod_nntp_like_ssl when mod_http2 is loaded
From: Yann Ylavic <ylavic.dev@gmail.com>
To: dev@httpd.apache.org
Content-Type: text/plain; charset=UTF-8

On Mon, Oct 12, 2015 at 11:13 AM, Rainer Jung <rainer.jung@kippdata.de> wrote:
>
> Since I started this thread: IMHO this discussion shouldn't stop/influence
> 2.4.17. mod_http2 is experimental, so even a change of defaults in early
> releases should be OK. And any exotic interop problems are not critical
> enough to roll another release.

+1, not a showstopper from my POV.

From dev-return-84251-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Mon Oct 12 09:17:51 2015
Return-Path: <dev-return-84251-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id CB085182F1
	for <apmail-httpd-dev-archive@www.apache.org>; Mon, 12 Oct 2015 09:17:51 +0000 (UTC)
Received: (qmail 40180 invoked by uid 500); 12 Oct 2015 09:17:51 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 40112 invoked by uid 500); 12 Oct 2015 09:17:51 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 40102 invoked by uid 99); 12 Oct 2015 09:17:51 -0000
Received: from Unknown (HELO spamd3-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 12 Oct 2015 09:17:51 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd3-us-west.apache.org (ASF Mail Server at spamd3-us-west.apache.org) with ESMTP id E34E9180A63
	for <dev@httpd.apache.org>; Mon, 12 Oct 2015 09:17:50 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd3-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.01
X-Spam-Level:
X-Spam-Status: No, score=-0.01 tagged_above=-999 required=6.31
	tests=[SPF_PASS=-0.001, T_RP_MATCHES_RCVD=-0.01, URIBL_BLOCKED=0.001]
	autolearn=disabled
Received: from mx1-us-west.apache.org ([10.40.0.8])
	by localhost (spamd3-us-west.apache.org [10.40.0.10]) (amavisd-new, port 10024)
	with ESMTP id 3rJGJih8zIM5 for <dev@httpd.apache.org>;
	Mon, 12 Oct 2015 09:17:42 +0000 (UTC)
Received: from mail.greenbytes.de (mail.greenbytes.de [217.91.35.233])
	by mx1-us-west.apache.org (ASF Mail Server at mx1-us-west.apache.org) with ESMTPS id 8CB7C207EE
	for <dev@httpd.apache.org>; Mon, 12 Oct 2015 09:17:42 +0000 (UTC)
Received: from [192.168.1.42] (unknown [5.10.171.186])
	(using TLSv1 with cipher ECDHE-RSA-AES256-SHA (256/256 bits))
	(Client did not present a certificate)
	by mail.greenbytes.de (Postfix) with ESMTPSA id 3371E15A0321
	for <dev@httpd.apache.org>; Mon, 12 Oct 2015 11:17:41 +0200 (CEST)
Content-Type: text/plain; charset=us-ascii
Mime-Version: 1.0 (Mac OS X Mail 9.0 \(3094\))
Subject: Re: 2.4.17 test failure for mod_nntp_like_ssl when mod_http2 is loaded
From: Stefan Eissing <stefan.eissing@greenbytes.de>
In-Reply-To: <CAKQ1sVNK8uPtZGHdgmrWkuV9a0_uwG--xBJHWRqQj2n0-iGKkA@mail.gmail.com>
Date: Mon, 12 Oct 2015 11:17:40 +0200
Content-Transfer-Encoding: quoted-printable
Message-Id: <4C8FFF1E-5F52-4EA6-8CC4-B5BDCCC8CB42@greenbytes.de>
References: <561A64DC.5000809@kippdata.de> <A350DE1E-8634-43AC-A054-3BCE181D6CA1@greenbytes.de> <A873A60B-662E-487A-BA96-C58ED4F4E04E@greenbytes.de> <CAKQ1sVO5+13U2xcVc-A_1geQChnSikxeosTWubm07yDrvpzMXw@mail.gmail.com> <B1E3C336-57A0-4487-A084-93BCA8E7CC70@greenbytes.de> <CAKQ1sVNabR-048ozc7qy9MhMCqsC7PXYwzvuX=+mCDEKRriZbQ@mail.gmail.com> <CAKQ1sVP1ZCe2-j24+yBZvFo70aZ1Gw2v7TnW+3U9BBgMwT4W7A@mail.gmail.com> <E60F1FAA-865A-4F8F-996A-1F881FDEE141@greenbytes.de> <CAKQ1sVNK8uPtZGHdgmrWkuV9a0_uwG--xBJHWRqQj2n0-iGKkA@mail.gmail.com>
To: dev@httpd.apache.org
X-Mailer: Apple Mail (2.3094)

It is default for some, others do not do it.=20

No browser speaks h2c nowadays.=20

I think reading bytes on a connection which is supposed to allow h2c =
traffic should be fine. Then one could argue if 24 bytes can always be =
expected...

Since we no longer enabled h2c by default in a server, I expect it to be =
fine.=20

//Stefan

> Am 12.10.2015 um 11:12 schrieb Yann Ylavic <ylavic.dev@gmail.com>:
>=20
> That would be better, but still the doc says "This mode falls outside
> the RFC 7540 but has become widely implemented as it is very
> convenient for development and testing".
> Is this something used by real world h2 clients?
>=20
> On Mon, Oct 12, 2015 at 11:09 AM, Stefan Eissing
> <stefan.eissing@greenbytes.de> wrote:
>> I plan to change it to only happen for servers, where h2/h2c is among =
configured protocols.
>>=20
>>> Am 12.10.2015 um 11:07 schrieb Yann Ylavic <ylavic.dev@gmail.com>:
>>>=20
>>> On Sun, Oct 11, 2015 at 7:15 PM, Yann Ylavic <ylavic.dev@gmail.com> =
wrote:
>>>> On Sun, Oct 11, 2015 at 7:11 PM, Stefan Eissing
>>>> <stefan.eissing@greenbytes.de> wrote:
>>>>> Don't think so. But loading the module should do no harm, I think. =
And it does now.
>>>>=20
>>>> Isn't configuring H2Direct on which harms?
>>>=20
>>> Didn't figure out "H2Direct on" was the default for non-TLS.
>>> I don't think it's a good idea, beyond the NNTP case, the admin =
should
>>> have to enable this by her/his own.
>>=20


From dev-return-84252-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Mon Oct 12 10:37:06 2015
Return-Path: <dev-return-84252-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 64F291858D
	for <apmail-httpd-dev-archive@www.apache.org>; Mon, 12 Oct 2015 10:37:06 +0000 (UTC)
Received: (qmail 15168 invoked by uid 500); 12 Oct 2015 10:36:56 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 15095 invoked by uid 500); 12 Oct 2015 10:36:56 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 15085 invoked by uid 99); 12 Oct 2015 10:36:56 -0000
Received: from Unknown (HELO spamd3-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 12 Oct 2015 10:36:56 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd3-us-west.apache.org (ASF Mail Server at spamd3-us-west.apache.org) with ESMTP id 14F0E180A58
	for <dev@httpd.apache.org>; Mon, 12 Oct 2015 10:36:56 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd3-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 2.9
X-Spam-Level: **
X-Spam-Status: No, score=2.9 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	HTML_MESSAGE=3, SPF_PASS=-0.001, URIBL_BLOCKED=0.001]
	autolearn=disabled
Authentication-Results: spamd3-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd3-us-west.apache.org [10.40.0.10]) (amavisd-new, port 10024)
	with ESMTP id jy73usO758Ul for <dev@httpd.apache.org>;
	Mon, 12 Oct 2015 10:36:46 +0000 (UTC)
Received: from mail-io0-f176.google.com (mail-io0-f176.google.com [209.85.223.176])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id 956A1439DF
	for <dev@httpd.apache.org>; Mon, 12 Oct 2015 10:36:46 +0000 (UTC)
Received: by ioii196 with SMTP id i196so146463577ioi.3
        for <dev@httpd.apache.org>; Mon, 12 Oct 2015 03:36:46 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        bh=sn83awKTxSZwbAgbx7lm+9Fk65wwmJc+IE4AUizPokU=;
        b=hRVyCdcSK55HtNz77yx28r6YbgfOA9g6R7/6iws+rWp7aCtWzeE1zz71MWEHbjN7VR
         EqGkMNae3AHg2fwSBotKIWFC8UPnVZMhdP4SC7OLjhMp3e0W0SM50Avhw2vnhxgpIQI5
         4lV1bFWiXvq97kXA2oUyvmxwl5HbT28Tr55pEDh/IB+qHkk6I5EW17p4IAy2uL3xqw7W
         32hDsbgCZULw/bM7phBLpkw4cs4Ws2PhC028JtgeFnMKzGwGsZb8H9zuJFxmTFKaYKQ9
         Wb1M6brZAh8tjdpfLLQhQFPBLhsjpkG1KgPQLPUxlE0zdKD6FWiC9iVVs3jWuPWQanad
         3NLQ==
MIME-Version: 1.0
X-Received: by 10.107.46.136 with SMTP id u8mr25212490iou.69.1444646206190;
 Mon, 12 Oct 2015 03:36:46 -0700 (PDT)
Received: by 10.36.37.18 with HTTP; Mon, 12 Oct 2015 03:36:46 -0700 (PDT)
In-Reply-To: <C45BAF78-8A10-4751-B1CA-62BB499FD795@jaguNET.com>
References: <C45BAF78-8A10-4751-B1CA-62BB499FD795@jaguNET.com>
Date: Mon, 12 Oct 2015 06:36:46 -0400
Message-ID: <CAKUrXK4Xqrf7cfzFhJ30cUe5KyyUaubicsZD46Zitmjhvi9sGA@mail.gmail.com>
Subject: Re: [VOTE] Release Apache httpd 2.4.17 as GA
From: Jeff Trawick <trawick@gmail.com>
To: Apache HTTP Server Development List <dev@httpd.apache.org>
Content-Type: multipart/alternative; boundary=001a113ac3acf23bec0521e5e71e

--001a113ac3acf23bec0521e5e71e
Content-Type: text/plain; charset=UTF-8

On Fri, Oct 9, 2015 at 1:40 PM, Jim Jagielski <jim@jagunet.com> wrote:

> The pre-release test tarballs for Apache httpd 2.4.17 can be found
> at the usual place:
>
>         http://httpd.apache.org/dev/dist/
>
> I'm calling a VOTE on releasing these as Apache httpd 2.4.17 GA.
>
> [ ] +1: Good to go
> [ ] +0: meh
> [ ] -1: Danger Will Robinson. And why.
>
> Vote will last the normal 72 hrs.
>
> NOTE: The *-deps are only there for convenience.
>
> Thx!
>
>
[X] +1: no regression, works with my existing production config with no
apparent problems

On Fedora 22, the only platform where I ran the test suite (latest version
as of yesterday afternoon), I'm getting a bunch of errors for http2 which I
don't see mentioned elsewhere.  I guess they're most likely triggered by
the Perl side of things???

t/modules/http2.t ................... 1/52 # Failed test 11 in
t/modules/http2.t at line 174
# Failed test 12 in t/modules/http2.t at line 176
# Failed test 13 in t/modules/http2.t at line 174 fail #2
# Failed test 14 in t/modules/http2.t at line 176 fail #2
# Failed test 15 in t/modules/http2.t at line 162
# Failed test 16 in t/modules/http2.t at line 164
# Failed test 17 in t/modules/http2.t at line 162 fail #2
# Failed test 18 in t/modules/http2.t at line 164 fail #2
# Failed test 19 in t/modules/http2.t at line 174 fail #3
# Failed test 20 in t/modules/http2.t at line 176 fail #3
# Failed test 21 in t/modules/http2.t at line 162 fail #3
# Failed test 22 in t/modules/http2.t at line 164 fail #3
# Failed test 23 in t/modules/http2.t at line 162 fail #4
# Failed test 24 in t/modules/http2.t at line 164 fail #4
# Failed test 25 in t/modules/http2.t at line 162 fail #5
# Failed test 26 in t/modules/http2.t at line 164 fail #5
# Failed test 37 in t/modules/http2.t at line 174 fail #4
# Failed test 38 in t/modules/http2.t at line 176 fail #4
# Failed test 39 in t/modules/http2.t at line 174 fail #5
# Failed test 40 in t/modules/http2.t at line 176 fail #5
# Failed test 41 in t/modules/http2.t at line 162 fail #6
# Failed test 42 in t/modules/http2.t at line 164 fail #6
# Failed test 43 in t/modules/http2.t at line 162 fail #7
# Failed test 44 in t/modules/http2.t at line 164 fail #7
# Failed test 45 in t/modules/http2.t at line 174 fail #6
# Failed test 46 in t/modules/http2.t at line 176 fail #6
# Failed test 47 in t/modules/http2.t at line 162 fail #8
# Failed test 48 in t/modules/http2.t at line 164 fail #8
# Failed test 49 in t/modules/http2.t at line 162 fail #9
# Failed test 50 in t/modules/http2.t at line 164 fail #9
# Failed test 51 in t/modules/http2.t at line 162 fail #10
# Failed test 52 in t/modules/http2.t at line 164 fail #10
t/modules/http2.t ................... Failed 32/52 subtests

(no other errors, DAV tests were skipped due to lack of appropriate Perl
module)

-- 
Born in Roswell... married an alien...
http://emptyhammock.com/

--001a113ac3acf23bec0521e5e71e
Content-Type: text/html; charset=UTF-8
Content-Transfer-Encoding: quoted-printable

<div dir=3D"ltr"><div class=3D"gmail_extra"><div class=3D"gmail_quote">On F=
ri, Oct 9, 2015 at 1:40 PM, Jim Jagielski <span dir=3D"ltr">&lt;<a href=3D"=
mailto:jim@jagunet.com" target=3D"_blank">jim@jagunet.com</a>&gt;</span> wr=
ote:<br><blockquote class=3D"gmail_quote" style=3D"margin:0px 0px 0px 0.8ex=
;border-left-width:1px;border-left-color:rgb(204,204,204);border-left-style=
:solid;padding-left:1ex">The pre-release test tarballs for Apache httpd 2.4=
.17 can be found<br>
at the usual place:<br>
<br>
=C2=A0 =C2=A0 =C2=A0 =C2=A0 <a href=3D"http://httpd.apache.org/dev/dist/" r=
el=3D"noreferrer" target=3D"_blank">http://httpd.apache.org/dev/dist/</a><b=
r>
<br>
I&#39;m calling a VOTE on releasing these as Apache httpd 2.4.17 GA.<br>
<br>
[ ] +1: Good to go<br>
[ ] +0: meh<br>
[ ] -1: Danger Will Robinson. And why.<br>
<br>
Vote will last the normal 72 hrs.<br>
<br>
NOTE: The *-deps are only there for convenience.<br>
<br>
Thx!<br>
<br>
</blockquote></div><div class=3D"gmail_extra"><br></div>[X] +1: no regressi=
on, works with my existing production config with no apparent problems</div=
><div class=3D"gmail_extra"><br></div><div class=3D"gmail_extra">On Fedora =
22, the only platform where I ran the test suite (latest version as of yest=
erday afternoon), I&#39;m getting a bunch of errors for http2 which I don&#=
39;t see mentioned elsewhere.=C2=A0 I guess they&#39;re most likely trigger=
ed by the Perl side of things???</div><div class=3D"gmail_extra"><br></div>=
<div class=3D"gmail_extra"><div class=3D"gmail_extra">t/modules/http2.t ...=
................ 1/52 # Failed test 11 in t/modules/http2.t at line 174</di=
v><div class=3D"gmail_extra"># Failed test 12 in t/modules/http2.t at line =
176</div><div class=3D"gmail_extra"># Failed test 13 in t/modules/http2.t a=
t line 174 fail #2</div><div class=3D"gmail_extra"># Failed test 14 in t/mo=
dules/http2.t at line 176 fail #2</div><div class=3D"gmail_extra"># Failed =
test 15 in t/modules/http2.t at line 162</div><div class=3D"gmail_extra"># =
Failed test 16 in t/modules/http2.t at line 164</div><div class=3D"gmail_ex=
tra"># Failed test 17 in t/modules/http2.t at line 162 fail #2</div><div cl=
ass=3D"gmail_extra"># Failed test 18 in t/modules/http2.t at line 164 fail =
#2</div><div class=3D"gmail_extra"># Failed test 19 in t/modules/http2.t at=
 line 174 fail #3</div><div class=3D"gmail_extra"># Failed test 20 in t/mod=
ules/http2.t at line 176 fail #3</div><div class=3D"gmail_extra"># Failed t=
est 21 in t/modules/http2.t at line 162 fail #3</div><div class=3D"gmail_ex=
tra"># Failed test 22 in t/modules/http2.t at line 164 fail #3</div><div cl=
ass=3D"gmail_extra"># Failed test 23 in t/modules/http2.t at line 162 fail =
#4</div><div class=3D"gmail_extra"># Failed test 24 in t/modules/http2.t at=
 line 164 fail #4</div><div class=3D"gmail_extra"># Failed test 25 in t/mod=
ules/http2.t at line 162 fail #5</div><div class=3D"gmail_extra"># Failed t=
est 26 in t/modules/http2.t at line 164 fail #5</div><div class=3D"gmail_ex=
tra"># Failed test 37 in t/modules/http2.t at line 174 fail #4</div><div cl=
ass=3D"gmail_extra"># Failed test 38 in t/modules/http2.t at line 176 fail =
#4</div><div class=3D"gmail_extra"># Failed test 39 in t/modules/http2.t at=
 line 174 fail #5</div><div class=3D"gmail_extra"># Failed test 40 in t/mod=
ules/http2.t at line 176 fail #5</div><div class=3D"gmail_extra"># Failed t=
est 41 in t/modules/http2.t at line 162 fail #6</div><div class=3D"gmail_ex=
tra"># Failed test 42 in t/modules/http2.t at line 164 fail #6</div><div cl=
ass=3D"gmail_extra"># Failed test 43 in t/modules/http2.t at line 162 fail =
#7</div><div class=3D"gmail_extra"># Failed test 44 in t/modules/http2.t at=
 line 164 fail #7</div><div class=3D"gmail_extra"># Failed test 45 in t/mod=
ules/http2.t at line 174 fail #6</div><div class=3D"gmail_extra"># Failed t=
est 46 in t/modules/http2.t at line 176 fail #6</div><div class=3D"gmail_ex=
tra"># Failed test 47 in t/modules/http2.t at line 162 fail #8</div><div cl=
ass=3D"gmail_extra"># Failed test 48 in t/modules/http2.t at line 164 fail =
#8</div><div class=3D"gmail_extra"># Failed test 49 in t/modules/http2.t at=
 line 162 fail #9</div><div class=3D"gmail_extra"># Failed test 50 in t/mod=
ules/http2.t at line 164 fail #9</div><div class=3D"gmail_extra"># Failed t=
est 51 in t/modules/http2.t at line 162 fail #10</div><div class=3D"gmail_e=
xtra"># Failed test 52 in t/modules/http2.t at line 164 fail #10</div><div =
class=3D"gmail_extra">t/modules/http2.t ................... Failed 32/52 su=
btests</div><div><br></div><div>(no other errors, DAV tests were skipped du=
e to lack of appropriate Perl module)</div><div><br></div>-- <br><div><div =
dir=3D"ltr">Born in Roswell... married an alien...<br><a href=3D"http://emp=
tyhammock.com/" target=3D"_blank">http://emptyhammock.com/</a><div><br></di=
v></div></div>
</div></div>

--001a113ac3acf23bec0521e5e71e--

From dev-return-84253-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Mon Oct 12 10:48:59 2015
Return-Path: <dev-return-84253-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 492171860B
	for <apmail-httpd-dev-archive@www.apache.org>; Mon, 12 Oct 2015 10:48:59 +0000 (UTC)
Received: (qmail 38693 invoked by uid 500); 12 Oct 2015 10:48:52 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 38617 invoked by uid 500); 12 Oct 2015 10:48:52 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 38607 invoked by uid 99); 12 Oct 2015 10:48:52 -0000
Received: from Unknown (HELO spamd1-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 12 Oct 2015 10:48:52 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd1-us-west.apache.org (ASF Mail Server at spamd1-us-west.apache.org) with ESMTP id D1523C272A
	for <dev@httpd.apache.org>; Mon, 12 Oct 2015 10:48:51 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd1-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 0.299
X-Spam-Level:
X-Spam-Status: No, score=0.299 tagged_above=-999 required=6.31
	tests=[KAM_LAZY_DOMAIN_SECURITY=1, RCVD_IN_DNSWL_LOW=-0.7,
	SPF_HELO_PASS=-0.001] autolearn=disabled
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd1-us-west.apache.org [10.40.0.7]) (amavisd-new, port 10024)
	with ESMTP id 3whp8gBytYPx for <dev@httpd.apache.org>;
	Mon, 12 Oct 2015 10:48:41 +0000 (UTC)
Received: from mail1.bemta3.messagelabs.com (mail1.bemta3.messagelabs.com [195.245.230.161])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id 9E2B9439CB
	for <dev@httpd.apache.org>; Mon, 12 Oct 2015 10:48:40 +0000 (UTC)
Received: from [85.158.138.179] by server-1.bemta-3.messagelabs.com id 41/0A-01421-1009B165; Mon, 12 Oct 2015 10:48:33 +0000
X-Env-Sender: ruediger.pluem@vodafone.com
X-Msg-Ref: server-12.tower-169.messagelabs.com!1444646913!31045754!1
X-Originating-IP: [195.232.244.136]
X-StarScan-Received:
X-StarScan-Version: 6.13.16; banners=-,-,-
X-VirusChecked: Checked
Received: (qmail 32137 invoked from network); 12 Oct 2015 10:48:33 -0000
Received: from mailout04.vodafone.com (HELO mailout04.vodafone.com) (195.232.244.136)
  by server-12.tower-169.messagelabs.com with DHE-RSA-AES256-SHA encrypted SMTP; 12 Oct 2015 10:48:33 -0000
Received: from mailint04.vodafone.com (mailint04.vodafone.com [195.232.244.201])
	by mailout04.vodafone.com (Postfix) with ESMTP id 3nZGvP121bznTYg
	for <dev@httpd.apache.org>; Mon, 12 Oct 2015 12:48:33 +0200 (CEST)
Received: from mailint04.vodafone.com (localhost [127.0.0.1])
	by mailint04.vodafone.com (Postfix) with ESMTP id 3nZGvN6zlwzfcWj
	for <dev@httpd.apache.org>; Mon, 12 Oct 2015 12:48:32 +0200 (CEST)
Received: from VOEXC01W.internal.vodafone.com (voexc01w.dc-ratingen.de [145.230.101.21])
	(using TLSv1 with cipher AES128-SHA (128/128 bits))
	(No client certificate requested)
	by mailint04.vodafone.com (Postfix) with ESMTPS id 3nZGvN6fPKzfbHR
	for <dev@httpd.apache.org>; Mon, 12 Oct 2015 12:48:32 +0200 (CEST)
Received: from AVOEXC04W.internal.vodafone.com (145.230.15.142) by
 VOEXC01W.internal.vodafone.com (145.230.101.21) with Microsoft SMTP Server
 (TLS) id 14.3.224.2; Mon, 12 Oct 2015 12:48:32 +0200
Received: from VOEXM10W.internal.vodafone.com ([169.254.2.88]) by
 AVOEXC04W.internal.vodafone.com ([145.230.15.142]) with mapi id
 14.03.0224.002; Mon, 12 Oct 2015 12:48:32 +0200
From: =?utf-8?B?UGzDvG0sIFLDvGRpZ2VyLCBWb2RhZm9uZSBHcm91cA==?=
	<ruediger.pluem@vodafone.com>
To: "dev@httpd.apache.org" <dev@httpd.apache.org>
Subject: RE: 2.4.17 test failure for mod_nntp_like_ssl when mod_http2 is
 loaded
Thread-Topic: 2.4.17 test failure for mod_nntp_like_ssl when mod_http2 is
 loaded
Thread-Index: AQHRBClIHzOjKMk+RE2YMC4Vxy9as55mWT2AgAAJoYCAAAJFAIAAAvEAgAABEACAAAIUAIAABqsAgAEOEID//+hIAIAAAcwAgAADboCAAADmAIAAQAow
Date: Mon, 12 Oct 2015 10:48:31 +0000
Message-ID: <AB1691BE05AE7F4992697F2A0835627AC63420C8@VOEXM10W.internal.vodafone.com>
References: <561A64DC.5000809@kippdata.de>
 <A350DE1E-8634-43AC-A054-3BCE181D6CA1@greenbytes.de>
 <A873A60B-662E-487A-BA96-C58ED4F4E04E@greenbytes.de>
 <CAKQ1sVO5+13U2xcVc-A_1geQChnSikxeosTWubm07yDrvpzMXw@mail.gmail.com>
 <561A9A18.70904@kippdata.de>
 <1230E7B2-8907-403E-8321-21C7C9D64772@greenbytes.de>
 <DED1D215-F7E5-4D39-83F7-C461944A8129@greenbytes.de>
 <E31D3E0E-D988-4F66-A7AB-A0B3E5B7B0FB@greenbytes.de>
 <AB1691BE05AE7F4992697F2A0835627AC6341EAD@VOEXM10W.internal.vodafone.com>
 <BD8FC109-83BA-467A-93E0-2B2DF6C47DD8@greenbytes.de>
 <CAKQ1sVN-zWKoYFhzwQL467XG7XyvyoC28Ut0TwFnDNNmUbkXZg@mail.gmail.com>
 <CAKQ1sVOAFE5Jui8KN-NtwEVj1Ut+AuuawW669GvM_-f4xDCCVQ@mail.gmail.com>
 <561CC574-296E-4287-AD60-AED06DBE1ECE@greenbytes.de>
In-Reply-To: <561CC574-296E-4287-AD60-AED06DBE1ECE@greenbytes.de>
Accept-Language: en-US
Content-Language: en-US
X-MS-Has-Attach:
X-MS-TNEF-Correlator:
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
MIME-Version: 1.0

DQoNCj4gLS0tLS1PcmlnaW5hbCBNZXNzYWdlLS0tLS0NCj4gRnJvbTogU3RlZmFuIEVpc3Npbmcg
W21haWx0bzpzdGVmYW4uZWlzc2luZ0BncmVlbmJ5dGVzLmRlXQ0KPiBTZW50OiBNb250YWcsIDEy
LiBPa3RvYmVyIDIwMTUgMTA6NTgNCj4gVG86IGRldkBodHRwZC5hcGFjaGUub3JnDQo+IFN1Ympl
Y3Q6IFJlOiAyLjQuMTcgdGVzdCBmYWlsdXJlIGZvciBtb2Rfbm50cF9saWtlX3NzbCB3aGVuIG1v
ZF9odHRwMiBpcw0KPiBsb2FkZWQNCj4gDQo+IFRoZSBBUF9NT0RFX0lOSVQgdHJpZ2dlcnMgdGhl
IGhhbmRzaGFrZSBuaWNlbHkuIEJ1dCB0aGUgcHJvdG9jb2wgc3dpdGNoaW5nDQo+IHN0aWxsIGhh
cHBlbnMNCj4gb24gdGhlIGZpcnN0IHJlYWQuIGN1cnJlbnRseSBsb29raW5nIGhvdyB0byB0cmln
Z2VyIHRoYXQgYmVzdC4NCg0KRXZlbiBpbiB0aGUgQUxQTiBjYXNlIHRoZSBwcm90b2NvbCBzd2l0
Y2hpbmcgaGFwcGVucyBvbiB0aGUgZmlyc3QgcmVhZCBhZnRlciB0aGUgaGFuZHNoYWtlPw0KDQpS
ZWdhcmRzDQoNClLDvGRpZ2VyDQoNCg==

From dev-return-84254-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Mon Oct 12 10:59:18 2015
Return-Path: <dev-return-84254-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id C292418667
	for <apmail-httpd-dev-archive@www.apache.org>; Mon, 12 Oct 2015 10:59:18 +0000 (UTC)
Received: (qmail 68111 invoked by uid 500); 12 Oct 2015 10:59:18 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 68039 invoked by uid 500); 12 Oct 2015 10:59:18 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 68026 invoked by uid 99); 12 Oct 2015 10:59:18 -0000
Received: from Unknown (HELO spamd2-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 12 Oct 2015 10:59:18 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd2-us-west.apache.org (ASF Mail Server at spamd2-us-west.apache.org) with ESMTP id DEC341A2839
	for <dev@httpd.apache.org>; Mon, 12 Oct 2015 10:59:17 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd2-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.01
X-Spam-Level:
X-Spam-Status: No, score=-0.01 tagged_above=-999 required=6.31
	tests=[SPF_PASS=-0.001, T_RP_MATCHES_RCVD=-0.01, URIBL_BLOCKED=0.001]
	autolearn=disabled
Received: from mx1-us-west.apache.org ([10.40.0.8])
	by localhost (spamd2-us-west.apache.org [10.40.0.9]) (amavisd-new, port 10024)
	with ESMTP id kyDOvI1ZkRMz for <dev@httpd.apache.org>;
	Mon, 12 Oct 2015 10:59:11 +0000 (UTC)
Received: from mail.greenbytes.de (mail.greenbytes.de [217.91.35.233])
	by mx1-us-west.apache.org (ASF Mail Server at mx1-us-west.apache.org) with ESMTPS id 043A72045A
	for <dev@httpd.apache.org>; Mon, 12 Oct 2015 10:59:11 +0000 (UTC)
Received: from [192.168.1.42] (unknown [5.10.171.186])
	(using TLSv1 with cipher ECDHE-RSA-AES256-SHA (256/256 bits))
	(Client did not present a certificate)
	by mail.greenbytes.de (Postfix) with ESMTPSA id 3C30C15A03F4
	for <dev@httpd.apache.org>; Mon, 12 Oct 2015 12:59:09 +0200 (CEST)
Content-Type: text/plain; charset=utf-8
Mime-Version: 1.0 (Mac OS X Mail 9.0 \(3094\))
Subject: Re: 2.4.17 test failure for mod_nntp_like_ssl when mod_http2 is loaded
From: Stefan Eissing <stefan.eissing@greenbytes.de>
In-Reply-To: <AB1691BE05AE7F4992697F2A0835627AC63420C8@VOEXM10W.internal.vodafone.com>
Date: Mon, 12 Oct 2015 12:59:08 +0200
Content-Transfer-Encoding: quoted-printable
Message-Id: <7F74B67D-DCDC-4965-984D-EFBCF6448AE9@greenbytes.de>
References: <561A64DC.5000809@kippdata.de> <A350DE1E-8634-43AC-A054-3BCE181D6CA1@greenbytes.de> <A873A60B-662E-487A-BA96-C58ED4F4E04E@greenbytes.de> <CAKQ1sVO5+13U2xcVc-A_1geQChnSikxeosTWubm07yDrvpzMXw@mail.gmail.com> <561A9A18.70904@kippdata.de> <1230E7B2-8907-403E-8321-21C7C9D64772@greenbytes.de> <DED1D215-F7E5-4D39-83F7-C461944A8129@greenbytes.de> <E31D3E0E-D988-4F66-A7AB-A0B3E5B7B0FB@greenbytes.de> <AB1691BE05AE7F4992697F2A0835627AC6341EAD@VOEXM10W.internal.vodafone.com> <BD8FC109-83BA-467A-93E0-2B2DF6C47DD8@greenbytes.de> <CAKQ1sVN-zWKoYFhzwQL467XG7XyvyoC28Ut0TwFnDNNmUbkXZg@mail.gmail.com> <CAKQ1sVOAFE5Jui8KN-NtwEVj1Ut+AuuawW669GvM_-f4xDCCVQ@mail.gmail.com> <561CC574-296E-4287-AD60-AED06DBE1ECE@greenbytes.de> <AB1691BE05AE7F4992697F2A0835627AC63420C8@VOEXM10W.internal.vodafone.com>
To: dev@httpd.apache.org
X-Mailer: Apple Mail (2.3094)

I am about to change that.

> Am 12.10.2015 um 12:48 schrieb Pl=C3=BCm, R=C3=BCdiger, Vodafone Group =
<ruediger.pluem@vodafone.com>:
>=20
>=20
>=20
>> -----Original Message-----
>> From: Stefan Eissing [mailto:stefan.eissing@greenbytes.de]
>> Sent: Montag, 12. Oktober 2015 10:58
>> To: dev@httpd.apache.org
>> Subject: Re: 2.4.17 test failure for mod_nntp_like_ssl when mod_http2 =
is
>> loaded
>>=20
>> The AP_MODE_INIT triggers the handshake nicely. But the protocol =
switching
>> still happens
>> on the first read. currently looking how to trigger that best.
>=20
> Even in the ALPN case the protocol switching happens on the first read =
after the handshake?
>=20
> Regards
>=20
> R=C3=BCdiger
>=20


From dev-return-84255-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Mon Oct 12 11:32:29 2015
Return-Path: <dev-return-84255-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id A9B3C1887C
	for <apmail-httpd-dev-archive@www.apache.org>; Mon, 12 Oct 2015 11:32:29 +0000 (UTC)
Received: (qmail 63693 invoked by uid 500); 12 Oct 2015 11:32:26 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 63629 invoked by uid 500); 12 Oct 2015 11:32:26 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 63619 invoked by uid 99); 12 Oct 2015 11:32:26 -0000
Received: from Unknown (HELO spamd2-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 12 Oct 2015 11:32:26 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd2-us-west.apache.org (ASF Mail Server at spamd2-us-west.apache.org) with ESMTP id CC6221A0A5B
	for <dev@httpd.apache.org>; Mon, 12 Oct 2015 11:32:25 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd2-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 0.11
X-Spam-Level:
X-Spam-Status: No, score=0.11 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	SPF_HELO_PASS=-0.001, SPF_PASS=-0.001, STOX_REPLY_TYPE=0.212]
	autolearn=disabled
Authentication-Results: spamd2-us-west.apache.org (amavisd-new);
	dkim=pass (1024-bit key) header.d=apachelounge.com
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd2-us-west.apache.org [10.40.0.9]) (amavisd-new, port 10024)
	with ESMTP id EvWqRrFU91oj for <dev@httpd.apache.org>;
	Mon, 12 Oct 2015 11:32:24 +0000 (UTC)
Received: from land10web.com (land10web.com [80.101.236.247])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTP id 295EF439CB
	for <dev@httpd.apache.org>; Mon, 12 Oct 2015 11:32:24 +0000 (UTC)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=apachelounge.com;
	s=default; t=1444649583;
	bh=34eMyik9nDGGNioBicCb20fcGvA+9/sh6H80EpZqGdk=;
	h=From:To:References:In-Reply-To:Subject:Date;
	b=XsT3RgkmkvnmKBMzB4Xrl0cStMgwUd/OSKboTDYT0vS4g/ErUX5uoh3WyjbkjqaLK
	 sTRMYgscneEBnUWwImhhhyv6wTvG2vPmZiZqmLJy8ifHYYWWJWbfm+lK1WWk/IP4jk
	 jB1lGkmIF3/RbBufXysgVgOH18Tmcl7ptdcuqNSI=
X-Default-Received-SPF: pass (skip=forwardok (res=PASS)) x-ip-name=80.101.236.247;
Message-ID: <42874351D8D74EDA91B946FE8702188F@father>
From: "Steffen" <info@apachelounge.com>
To: <dev@httpd.apache.org>
References: <C45BAF78-8A10-4751-B1CA-62BB499FD795@jaguNET.com>
In-Reply-To: <C45BAF78-8A10-4751-B1CA-62BB499FD795@jaguNET.com>
Subject: Re: [VOTE] Release Apache httpd 2.4.17 as GA
Date: Mon, 12 Oct 2015 13:32:32 +0200
MIME-Version: 1.0
Content-Type: text/plain;
	format=flowed;
	charset="iso-8859-1";
	reply-type=original
Content-Transfer-Encoding: 7bit
X-Priority: 3
X-MSMail-Priority: Normal
Importance: Normal
X-Mailer: Microsoft Windows Live Mail 16.4.3528.331
X-MimeOLE: Produced By Microsoft MimeOLE V16.4.3528.331

All looks fine with building and running Win32/Win64 VC14/11/10

No regressions/issues seen.

Build with:

nghttp2 1.3.4 
apr 1.5.2 with IPv6 enabled 
apr-util 1.5.4 with Crypto OpenSSL enabled 
apr-iconv 1.2.1 
openssl 1.0.2d +asm 
zlib 1.2.8 +asm 
pcre 8.37 
httpd.exe with OPENSSL_Applink and VC14 SupportedOS Manifest 
libxml2 2.9.2 
lua 5.1.5 
expat 2.1.0


Steffen

-----Original Message----- 
From: Jim Jagielski
Sent: Friday, July 10, 2015 10:33 PM Newsgroups: gmane.comp.apache.devel
To: httpd
Subject: [VOTE] Release Apache httpd 2.4.16 as GA

The pre-release test tarballs for Apache httpd 2.4.16 can be found
at the usual place:

http://httpd.apache.org/dev/dist/

I'm calling a VOTE on releasing these as Apache httpd 2.4.16 GA.


-----Original Message----- 
From: Jim Jagielski 
Sent: Friday, October 9, 2015 7:40 PM 
To: httpd 
Subject: ****** [VOTE] Release Apache httpd 2.4.17 as GA 

The pre-release test tarballs for Apache httpd 2.4.17 can be found
at the usual place:

http://httpd.apache.org/dev/dist/

I'm calling a VOTE on releasing these as Apache httpd 2.4.17 GA.

[ ] +1: Good to go
[ ] +0: meh
[ ] -1: Danger Will Robinson. And why.

Vote will last the normal 72 hrs.

NOTE: The *-deps are only there for convenience.

Thx!


From dev-return-84256-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Mon Oct 12 12:11:11 2015
Return-Path: <dev-return-84256-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 6F7FD18955
	for <apmail-httpd-dev-archive@www.apache.org>; Mon, 12 Oct 2015 12:11:11 +0000 (UTC)
Received: (qmail 28194 invoked by uid 500); 12 Oct 2015 12:11:04 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 28099 invoked by uid 500); 12 Oct 2015 12:11:04 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 28089 invoked by uid 99); 12 Oct 2015 12:11:04 -0000
Received: from Unknown (HELO spamd4-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 12 Oct 2015 12:11:04 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd4-us-west.apache.org (ASF Mail Server at spamd4-us-west.apache.org) with ESMTP id 6B636C0DFC
	for <dev@httpd.apache.org>; Mon, 12 Oct 2015 12:11:04 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd4-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.009
X-Spam-Level:
X-Spam-Status: No, score=-0.009 tagged_above=-999 required=6.31
	tests=[T_RP_MATCHES_RCVD=-0.01, URIBL_BLOCKED=0.001]
	autolearn=disabled
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd4-us-west.apache.org [10.40.0.11]) (amavisd-new, port 10024)
	with ESMTP id KB4R3Q4tsMyu for <dev@httpd.apache.org>;
	Mon, 12 Oct 2015 12:10:56 +0000 (UTC)
Received: from monica.sharp.fm (monica.sharp.fm [80.168.143.5])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTP id 34F702139D
	for <dev@httpd.apache.org>; Mon, 12 Oct 2015 12:10:56 +0000 (UTC)
Received: from [10.105.13.223] (unknown [5.56.169.82])
	(using TLSv1 with cipher DHE-RSA-AES256-SHA (256/256 bits))
	(Client did not present a certificate)
	(Authenticated sender: minfrin@sharp.fm)
	by monica.sharp.fm (Postfix) with ESMTPSA id ADFD08315D
	for <dev@httpd.apache.org>; Mon, 12 Oct 2015 13:10:49 +0100 (BST)
Content-Type: text/plain; charset=utf-8
Mime-Version: 1.0 (Mac OS X Mail 8.2 \(2104\))
Subject: Re: 2.4.17 test failure for mod_nntp_like_ssl when mod_http2 is loaded
From: Graham Leggett <minfrin@sharp.fm>
In-Reply-To: <A873A60B-662E-487A-BA96-C58ED4F4E04E@greenbytes.de>
Date: Mon, 12 Oct 2015 14:10:48 +0200
Content-Transfer-Encoding: quoted-printable
Message-Id: <14605AB3-F0C4-41B0-B6D8-BF4A91FA9192@sharp.fm>
References: <561A64DC.5000809@kippdata.de> <A350DE1E-8634-43AC-A054-3BCE181D6CA1@greenbytes.de> <A873A60B-662E-487A-BA96-C58ED4F4E04E@greenbytes.de>
To: dev@httpd.apache.org
X-Mailer: Apple Mail (2.2104)

On 11 Oct 2015, at 7:00 PM, Stefan Eissing =
<stefan.eissing@greenbytes.de> wrote:

> Ok, analyzed the code. Here is what seems to be happening:
>=20
> - mod_http2, in the connection hook, does a blocking, speculative read =
to
>  a) make sure the ALPN has been triggered

Looking at the code inside the event MPM that calls =
ap_run_process_connection(), it looks like you can just do a non =
blocking read, and if you haven=E2=80=99t received enough bytes, return =
DECLINED and expect to be called again.

This presupposes that other connection filters aren=E2=80=99t trying to =
be excessively cleaver by stealing your connection away from you and =
then responding to your data (for example by error-ing out), which they =
may do by doing blocking reads.

Regards,
Graham
=E2=80=94


From dev-return-84257-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Mon Oct 12 13:13:24 2015
Return-Path: <dev-return-84257-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id C52C018B6A
	for <apmail-httpd-dev-archive@www.apache.org>; Mon, 12 Oct 2015 13:13:24 +0000 (UTC)
Received: (qmail 40331 invoked by uid 500); 12 Oct 2015 13:13:24 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 40256 invoked by uid 500); 12 Oct 2015 13:13:24 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 40246 invoked by uid 99); 12 Oct 2015 13:13:24 -0000
Received: from Unknown (HELO spamd1-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 12 Oct 2015 13:13:24 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd1-us-west.apache.org (ASF Mail Server at spamd1-us-west.apache.org) with ESMTP id D2DDCC28D1
	for <dev@httpd.apache.org>; Mon, 12 Oct 2015 13:13:23 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd1-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 0.653
X-Spam-Level:
X-Spam-Status: No, score=0.653 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, SPF_NEUTRAL=0.652,
	URIBL_BLOCKED=0.001] autolearn=disabled
Authentication-Results: spamd1-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=comcast.net
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd1-us-west.apache.org [10.40.0.7]) (amavisd-new, port 10024)
	with ESMTP id GWCHvY4yYPGV for <dev@httpd.apache.org>;
	Mon, 12 Oct 2015 13:13:12 +0000 (UTC)
Received: from resqmta-ch2-01v.sys.comcast.net (resqmta-ch2-01v.sys.comcast.net [69.252.207.33])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id 5F15642B97
	for <dev@httpd.apache.org>; Mon, 12 Oct 2015 13:13:12 +0000 (UTC)
Received: from resomta-ch2-01v.sys.comcast.net ([69.252.207.97])
	by resqmta-ch2-01v.sys.comcast.net with comcast
	id UDCT1r00326dK1R01DDCvx; Mon, 12 Oct 2015 13:13:12 +0000
Received: from [192.168.199.10] ([69.251.84.114])
	by resomta-ch2-01v.sys.comcast.net with comcast
	id UDDB1r00K2U0RYt01DDBH5; Mon, 12 Oct 2015 13:13:12 +0000
Content-Type: text/plain; charset=us-ascii
Mime-Version: 1.0 (Mac OS X Mail 8.2 \(2104\))
Subject: Re: [VOTE] Release Apache httpd 2.4.17 as GA
From: Jim Jagielski <jim@jaguNET.com>
In-Reply-To: <C45BAF78-8A10-4751-B1CA-62BB499FD795@jaguNET.com>
Date: Mon, 12 Oct 2015 09:13:11 -0400
Content-Transfer-Encoding: 7bit
Message-Id: <349F474D-49FD-400A-AAA8-EE79EB7A183F@jaguNET.com>
References: <C45BAF78-8A10-4751-B1CA-62BB499FD795@jaguNET.com>
To: dev@httpd.apache.org
X-Mailer: Apple Mail (2.2104)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=comcast.net;
	s=q20140121; t=1444655592;
	bh=q5Zm8gp/HIO9260p5HNt+V3o1/+O887mBkwc++omckU=;
	h=Received:Received:Content-Type:Mime-Version:Subject:From:Date:
	 Message-Id:To;
	b=hi/7p0pHS34g5JvnLUvML4ecmRRS0gbcvEycQq0jib4prXNHAX/fMaG3VOFVziFLy
	 jO3DxE9QhL555qIye2wLNRP4f8C+W+H/vZ/BJvtLlaDe+Q84yHZ0xNKKlN+cTBAKs9
	 vTgl3iQDYWKlESxzcA7ENxUBMm/ma0q1F1SuTxc5rJs2Pp8gcJ1eSUvpOZ4sV+qREs
	 pe0Q4pqsnPDFMAej9mdb1rjWTu1Qm3uEsTdLeGxTi3IE5QHCxm6h7F6J/FTYT4MJN8
	 3SpcU18t8I0pQxUUngwLOWBhRexjR3pOcCrzjC4HMv0FfrkSpXwRDwqEw2mAVOusD5
	 4c7aIQtO0LJ8Q==

A little over 4.5 hours until the VOTE closes...

test early, test often! :)

> On Oct 9, 2015, at 1:40 PM, Jim Jagielski <jim@jaguNET.com> wrote:
> 
> The pre-release test tarballs for Apache httpd 2.4.17 can be found
> at the usual place:
> 
> 	http://httpd.apache.org/dev/dist/
> 
> I'm calling a VOTE on releasing these as Apache httpd 2.4.17 GA.
> 
> [ ] +1: Good to go
> [ ] +0: meh
> [ ] -1: Danger Will Robinson. And why.
> 
> Vote will last the normal 72 hrs.
> 
> NOTE: The *-deps are only there for convenience.
> 
> Thx!
> 


From dev-return-84258-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Mon Oct 12 13:15:48 2015
Return-Path: <dev-return-84258-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 49B2818BA1
	for <apmail-httpd-dev-archive@www.apache.org>; Mon, 12 Oct 2015 13:15:48 +0000 (UTC)
Received: (qmail 45459 invoked by uid 500); 12 Oct 2015 13:15:42 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 45374 invoked by uid 500); 12 Oct 2015 13:15:42 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 45364 invoked by uid 99); 12 Oct 2015 13:15:42 -0000
Received: from Unknown (HELO spamd2-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 12 Oct 2015 13:15:42 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd2-us-west.apache.org (ASF Mail Server at spamd2-us-west.apache.org) with ESMTP id 699C31A2862
	for <dev@httpd.apache.org>; Mon, 12 Oct 2015 13:15:42 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd2-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.01
X-Spam-Level:
X-Spam-Status: No, score=-0.01 tagged_above=-999 required=6.31
	tests=[SPF_PASS=-0.001, T_RP_MATCHES_RCVD=-0.01, URIBL_BLOCKED=0.001]
	autolearn=disabled
Received: from mx1-us-west.apache.org ([10.40.0.8])
	by localhost (spamd2-us-west.apache.org [10.40.0.9]) (amavisd-new, port 10024)
	with ESMTP id MuDhVkoTKP2z for <dev@httpd.apache.org>;
	Mon, 12 Oct 2015 13:15:34 +0000 (UTC)
Received: from mail.greenbytes.de (mail.greenbytes.de [217.91.35.233])
	by mx1-us-west.apache.org (ASF Mail Server at mx1-us-west.apache.org) with ESMTPS id 3F2052031C
	for <dev@httpd.apache.org>; Mon, 12 Oct 2015 13:15:34 +0000 (UTC)
Received: from [192.168.1.42] (unknown [5.10.171.186])
	(using TLSv1 with cipher ECDHE-RSA-AES256-SHA (256/256 bits))
	(Client did not present a certificate)
	by mail.greenbytes.de (Postfix) with ESMTPSA id 1CD2715A0474
	for <dev@httpd.apache.org>; Mon, 12 Oct 2015 15:15:32 +0200 (CEST)
Content-Type: text/plain; charset=us-ascii
Mime-Version: 1.0 (Mac OS X Mail 9.0 \(3094\))
Subject: Re: [VOTE] Release Apache httpd 2.4.17 as GA
From: Stefan Eissing <stefan.eissing@greenbytes.de>
In-Reply-To: <349F474D-49FD-400A-AAA8-EE79EB7A183F@jaguNET.com>
Date: Mon, 12 Oct 2015 15:15:31 +0200
Content-Transfer-Encoding: 7bit
Message-Id: <65AE6C8A-DA77-4943-97A7-00E7C7E4F231@greenbytes.de>
References: <C45BAF78-8A10-4751-B1CA-62BB499FD795@jaguNET.com> <349F474D-49FD-400A-AAA8-EE79EB7A183F@jaguNET.com>
To: dev@httpd.apache.org
X-Mailer: Apple Mail (2.3094)

+1

> Am 12.10.2015 um 15:13 schrieb Jim Jagielski <jim@jaguNET.com>:
> 
> A little over 4.5 hours until the VOTE closes...
> 
> test early, test often! :)
> 
>> On Oct 9, 2015, at 1:40 PM, Jim Jagielski <jim@jaguNET.com> wrote:
>> 
>> The pre-release test tarballs for Apache httpd 2.4.17 can be found
>> at the usual place:
>> 
>> 	http://httpd.apache.org/dev/dist/
>> 
>> I'm calling a VOTE on releasing these as Apache httpd 2.4.17 GA.
>> 
>> [ ] +1: Good to go
>> [ ] +0: meh
>> [ ] -1: Danger Will Robinson. And why.
>> 
>> Vote will last the normal 72 hrs.
>> 
>> NOTE: The *-deps are only there for convenience.
>> 
>> Thx!
>> 
> 


From dev-return-84259-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Mon Oct 12 13:37:05 2015
Return-Path: <dev-return-84259-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 1A44818C60
	for <apmail-httpd-dev-archive@www.apache.org>; Mon, 12 Oct 2015 13:37:05 +0000 (UTC)
Received: (qmail 496 invoked by uid 500); 12 Oct 2015 13:37:04 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 401 invoked by uid 500); 12 Oct 2015 13:37:04 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 391 invoked by uid 99); 12 Oct 2015 13:37:04 -0000
Received: from Unknown (HELO spamd3-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 12 Oct 2015 13:37:04 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd3-us-west.apache.org (ASF Mail Server at spamd3-us-west.apache.org) with ESMTP id 0877C180A65
	for <dev@httpd.apache.org>; Mon, 12 Oct 2015 13:37:04 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd3-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.01
X-Spam-Level:
X-Spam-Status: No, score=-0.01 tagged_above=-999 required=6.31
	tests=[SPF_PASS=-0.001, T_RP_MATCHES_RCVD=-0.01, URIBL_BLOCKED=0.001]
	autolearn=disabled
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd3-us-west.apache.org [10.40.0.10]) (amavisd-new, port 10024)
	with ESMTP id v_pOJbqVDhYK for <dev@httpd.apache.org>;
	Mon, 12 Oct 2015 13:36:54 +0000 (UTC)
Received: from mail.greenbytes.de (mail.greenbytes.de [217.91.35.233])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id 5599D20C18
	for <dev@httpd.apache.org>; Mon, 12 Oct 2015 13:36:54 +0000 (UTC)
Received: from [192.168.1.42] (unknown [5.10.171.186])
	(using TLSv1 with cipher ECDHE-RSA-AES256-SHA (256/256 bits))
	(Client did not present a certificate)
	by mail.greenbytes.de (Postfix) with ESMTPSA id 9AA5415A0049
	for <dev@httpd.apache.org>; Mon, 12 Oct 2015 15:36:53 +0200 (CEST)
Content-Type: text/plain; charset=utf-8
Mime-Version: 1.0 (Mac OS X Mail 9.0 \(3094\))
Subject: Re: 2.4.17 test failure for mod_nntp_like_ssl when mod_http2 is loaded
From: Stefan Eissing <stefan.eissing@greenbytes.de>
In-Reply-To: <14605AB3-F0C4-41B0-B6D8-BF4A91FA9192@sharp.fm>
Date: Mon, 12 Oct 2015 15:36:53 +0200
Content-Transfer-Encoding: quoted-printable
Message-Id: <A7045F99-D9F8-4E04-A0D7-DDC2CB294526@greenbytes.de>
References: <561A64DC.5000809@kippdata.de> <A350DE1E-8634-43AC-A054-3BCE181D6CA1@greenbytes.de> <A873A60B-662E-487A-BA96-C58ED4F4E04E@greenbytes.de> <14605AB3-F0C4-41B0-B6D8-BF4A91FA9192@sharp.fm>
To: dev@httpd.apache.org
X-Mailer: Apple Mail (2.3094)

With r1708107 I committed the following changes to /trunk:

mod_ssl:
- calling ap_switch_protocol directly after ap_select protocol from =
inside the SSL ALPN callback. Error in switching will result in a TLS =
error which seems correct. This makes sure that after the ALPN has been =
triggered, the protocol switch is in place.
- alpn_finished check in ssl_engine_io could be removed then. Less flags =
and #ifdefs overall...

mod_http2:
- connection hook triggers handshake by reading in AP_MODE_INIT 0 bytes
- connection hook only every tries to do a blocking read if H2Direct is =
enabled and the connection is still on protocol "http/1.1"
- the default for H2Direct has been changed to "off" for all kinds of =
connections
- documentation xml updated
- ht_task_input passes AP_MODE_INIT calls on to chained filters

I did not test the nntp case (can I? how?), but this should address the =
issue.

Observations:
- The AP_MODE_INIT read should be done in a connection hook of mod_ssl =
itself. Other modules like mod_http2 should not care about that.
- With SNI, the selected virtual host really is a property of the =
connection. It would be good to get access to it from other modules =
*without* having a request_rec

Thanks for all the good suggestiongs from Yann and R=C3=BCdiger!

//Stefan

> Am 12.10.2015 um 14:10 schrieb Graham Leggett <minfrin@sharp.fm>:
>=20
> On 11 Oct 2015, at 7:00 PM, Stefan Eissing =
<stefan.eissing@greenbytes.de> wrote:
>=20
>> Ok, analyzed the code. Here is what seems to be happening:
>>=20
>> - mod_http2, in the connection hook, does a blocking, speculative =
read to
>> a) make sure the ALPN has been triggered
>=20
> Looking at the code inside the event MPM that calls =
ap_run_process_connection(), it looks like you can just do a non =
blocking read, and if you haven=E2=80=99t received enough bytes, return =
DECLINED and expect to be called again.
>=20
> This presupposes that other connection filters aren=E2=80=99t trying =
to be excessively cleaver by stealing your connection away from you and =
then responding to your data (for example by error-ing out), which they =
may do by doing blocking reads.
>=20
> Regards,
> Graham
> =E2=80=94
>=20


From dev-return-84260-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Mon Oct 12 15:18:35 2015
Return-Path: <dev-return-84260-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 8778D18008
	for <apmail-httpd-dev-archive@www.apache.org>; Mon, 12 Oct 2015 15:18:35 +0000 (UTC)
Received: (qmail 27764 invoked by uid 500); 12 Oct 2015 15:18:35 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 27695 invoked by uid 500); 12 Oct 2015 15:18:35 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 27685 invoked by uid 99); 12 Oct 2015 15:18:34 -0000
Received: from Unknown (HELO spamd1-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 12 Oct 2015 15:18:34 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd1-us-west.apache.org (ASF Mail Server at spamd1-us-west.apache.org) with ESMTP id 95C49C2858
	for <dev@httpd.apache.org>; Mon, 12 Oct 2015 15:18:34 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd1-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.1
X-Spam-Level:
X-Spam-Status: No, score=-0.1 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	SPF_PASS=-0.001, URIBL_BLOCKED=0.001] autolearn=disabled
Authentication-Results: spamd1-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd1-us-west.apache.org [10.40.0.7]) (amavisd-new, port 10024)
	with ESMTP id Ypl2yG3M4IH1 for <dev@httpd.apache.org>;
	Mon, 12 Oct 2015 15:18:28 +0000 (UTC)
Received: from mail-ig0-f178.google.com (mail-ig0-f178.google.com [209.85.213.178])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id 24CF042F38
	for <dev@httpd.apache.org>; Mon, 12 Oct 2015 15:18:28 +0000 (UTC)
Received: by ignr19 with SMTP id r19so18250937ign.1
        for <dev@httpd.apache.org>; Mon, 12 Oct 2015 08:18:27 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        bh=cyyhb20l4azSbk1e9TUbWN0/ctdyTmh9kHUxh7+dOgg=;
        b=yOJrtAfZlR615BdUdznQchsLeNzaVELd21aIrtGvRHL1tiAKoMhf7DjmFmXerj7luC
         W+sFVREPG+NTjkS0Qh/87x03mqmadowYM3otbWkTPgVidZ5UAQOVczhKWe0CKQ7z+UV/
         NoW3JnK2Zj1uZknX7XYp4QvdEtZ4n7Z5+lU9ehFXjP0N+znrkPJqPsF2sTICC7NGYllk
         KOji8Jgc3sde4X4QKx2U8utLs8vgB1cE+XcABtfcFKgtoY4XHwTXOC9vb6O8f3rmHOsa
         FtkV+SpGRBfWiNsCUDmyXAizzrJ7f+wIFeucsAae+4DXBkqCYelAsBnxW8WK6NXhKIYt
         U5+A==
MIME-Version: 1.0
X-Received: by 10.50.137.40 with SMTP id qf8mr12204008igb.36.1444663107780;
 Mon, 12 Oct 2015 08:18:27 -0700 (PDT)
Received: by 10.64.25.3 with HTTP; Mon, 12 Oct 2015 08:18:27 -0700 (PDT)
In-Reply-To: <C45BAF78-8A10-4751-B1CA-62BB499FD795@jaguNET.com>
References: <C45BAF78-8A10-4751-B1CA-62BB499FD795@jaguNET.com>
Date: Mon, 12 Oct 2015 11:18:27 -0400
Message-ID: <CALK=YjN3ROjfwrLGJroyhCDwumwS79kC8guwydX_YNjnYR9RXw@mail.gmail.com>
Subject: Re: [VOTE] Release Apache httpd 2.4.17 as GA
From: Eric Covener <covener@gmail.com>
To: Apache HTTP Server Development List <dev@httpd.apache.org>
Content-Type: text/plain; charset=UTF-8

On Fri, Oct 9, 2015 at 1:40 PM, Jim Jagielski <jim@jagunet.com> wrote:
> I'm calling a VOTE on releasing these as Apache httpd 2.4.17 GA.

+1

Tested on AIX 7.1/ppc64/xlc

After much head-scratching, compiling of new openssl/nghttp2, and lots
of myserious CPAN stuff, Test framework passed everything but the two
421 Misidireected testcases in http2.t already discussed elsewhere.

Michael Felt -- if you're listening, it would be nice if perzlr had
openssl 1.0.2 and nghttp2.  The latter compiled quite easily with just
-qcpluscmt.

From dev-return-84261-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Mon Oct 12 15:44:40 2015
Return-Path: <dev-return-84261-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 380AF1811E
	for <apmail-httpd-dev-archive@www.apache.org>; Mon, 12 Oct 2015 15:44:40 +0000 (UTC)
Received: (qmail 81795 invoked by uid 500); 12 Oct 2015 15:44:38 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 81694 invoked by uid 500); 12 Oct 2015 15:44:38 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 81616 invoked by uid 99); 12 Oct 2015 15:44:38 -0000
Received: from Unknown (HELO spamd4-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 12 Oct 2015 15:44:38 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd4-us-west.apache.org (ASF Mail Server at spamd4-us-west.apache.org) with ESMTP id 973EFC0BB0
	for <dev@httpd.apache.org>; Mon, 12 Oct 2015 15:44:37 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd4-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.011
X-Spam-Level:
X-Spam-Status: No, score=-0.011 tagged_above=-999 required=6.31
	tests=[SPF_PASS=-0.001, T_RP_MATCHES_RCVD=-0.01] autolearn=disabled
Received: from mx1-us-west.apache.org ([10.40.0.8])
	by localhost (spamd4-us-west.apache.org [10.40.0.11]) (amavisd-new, port 10024)
	with ESMTP id NH7C4tvrQIbc for <dev@httpd.apache.org>;
	Mon, 12 Oct 2015 15:44:35 +0000 (UTC)
Received: from mailserver.kippdata.de (capsella.kippdata.de [195.227.30.149])
	by mx1-us-west.apache.org (ASF Mail Server at mx1-us-west.apache.org) with ESMTP id 5C24120562
	for <dev@httpd.apache.org>; Mon, 12 Oct 2015 15:44:34 +0000 (UTC)
Received: from [195.227.30.209] (notebook-rj [195.227.30.209])
	by mailserver.kippdata.de (8.13.5/8.13.5) with ESMTP id t9CFiQwt002985
	for <dev@httpd.apache.org>; Mon, 12 Oct 2015 17:44:26 +0200 (CEST)
Subject: Re: [VOTE] Release Apache httpd 2.4.17 as GA
To: dev@httpd.apache.org
References: <C45BAF78-8A10-4751-B1CA-62BB499FD795@jaguNET.com>
From: Rainer Jung <rainer.jung@kippdata.de>
Message-ID: <561BD54F.6010401@kippdata.de>
Date: Mon, 12 Oct 2015 17:44:15 +0200
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:38.0) Gecko/20100101
 Thunderbird/38.3.0
MIME-Version: 1.0
In-Reply-To: <C45BAF78-8A10-4751-B1CA-62BB499FD795@jaguNET.com>
Content-Type: text/plain; charset=utf-8; format=flowed
Content-Transfer-Encoding: 7bit

Am 09.10.2015 um 19:40 schrieb Jim Jagielski:
> The pre-release test tarballs for Apache httpd 2.4.17 can be found
> at the usual place:
>
> 	http://httpd.apache.org/dev/dist/
>
> I'm calling a VOTE on releasing these as Apache httpd 2.4.17 GA.
>
> [X] +1: Good to go
> [ ] +0: meh
> [ ] -1: Danger Will Robinson. And why.
>
> Vote will last the normal 72 hrs.

+1 to release and thank a bunch for RMing.
Hooray to HTTP/2.

In short: No regressions found.

Detailed report:

- Sigs and hashes OK
- contents of tarballs identical
- contents of tag and tarballs identical
   except for expected deltas
   (we could cleanup some m4 files in apr-util/xml/expat/conftools
    at the end of buildconf, no regression)

Built on

- Solaris 8+10 Sparc as 32 Bit Binaries
- SLES 10+11 (64 Bits)
- RHEL 6 (64 Bits)

For all platforms built

- with default (shared), shared and static modules
- with module sets none, few, most, all, reallyall and default
   (always mod_privileges disabled)
- using --enable-load-all-modules
- against "included" APR/APU from deps tarball,
   plus external APR/APU 1.5.2/1.5.4

- using external libraries
   - expat 2.1.0
   - pcre 8.37
   - openssl 1.0.2d
   - lua 5.2.4
   - distcache 1.5.1
   - libxml2 2.9.2
   - libnghttp2 1.3.4

- Tool chain:
     - platform gcc except for Solaris
       (gcc 4.1.2 for Solaris 8 and 4.9.2 for Solaris 10)
     - CFLAGS: -O2 -g -Wall -fno-strict-aliasing
               (and -mpcu=v9 on Solaris)

All builds succeeded
   - one compiler warning (no regression)
ssl/ssl_util_stapling.c:657: warning: 'ok' may be used uninitialized in 
this function

Tested for

- Solaris 8+10 (32), SLES 10+11 (64), RHEL 6 (64)
- MPMs prefork, worker, event
   (except event on Solaris8, unsupported)
- default, shared and static modules
- log levels info, debug and trace8
- module set reallyall (122 modules plus MPMs)
- Solaris 8 and SLES 10 still ongoing but so far OK

The following test failures were seen:

a Test 4 or 5 in t/modules/dav.t:
   Happens for 38 out of 319 runs (7 on SLES 10, 16 on SLES 11,
   13 on RHEL6, 2 on Solaris 10).
   Creation, modified and now times not in the correct order.
   This seems to be a system issue, all tests done on NFS,
   many tested on virtualized guests.
   Not a regression.

b Various tests in t/apache/expr_string.t: (6, 11, 14, 17, 20 ,23)
   Happens for 41 out of 319 runs (31 on SLES 10, 1 on SLES 11,
   9 on RHEL6).
   The failure is always on line 68, where the error_log contents
   are checked.
   Not a regression.

c Test 59 of t/modules/include.t only and always on
   Solaris.
   This is due to a bug in the test, which uses strftime()
   with a "%s" pattern that is not supported on Solaris.
   Until recently the server and the test client both returned
   verbatim "%s" and the test succeeded. After updating some
   Perl modules for the http2 tests, the perl client even
   on Solaris now supports "%s" in strftime and the test starts
   to fail. It seems we have to fix the test.

d Failure of t/modules/session.t on SlES 10.
   Warning: Use of "shift" without parentheses is ambiguous at line 39.
   Perl version is 5.8.8. The script uses a somewhat advances
   $x = shift // "NOTFOUND";
   construct, which seems to be ambiguous for old Perl (I had
   to look in the fine perl docs for the // operator).
   We could probably use a less elegant but more compatible
   construct instead.

e Failure of two tests in t/modules/http2.t.
   The tests do not run in a consistent order, so the test numbers don't
   help, but it always seems to be the "misdirected" test under SSL
   returning 404 instead of 421. Analysis by Yann indicates, that
   the test might be broken and needs some refinement to actually
   trigger a 421.

Regards,

Rainer

From dev-return-84262-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Mon Oct 12 17:42:11 2015
Return-Path: <dev-return-84262-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 4956318754
	for <apmail-httpd-dev-archive@www.apache.org>; Mon, 12 Oct 2015 17:42:11 +0000 (UTC)
Received: (qmail 24225 invoked by uid 500); 12 Oct 2015 17:41:48 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 24144 invoked by uid 500); 12 Oct 2015 17:41:48 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 24134 invoked by uid 99); 12 Oct 2015 17:41:48 -0000
Received: from Unknown (HELO spamd1-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 12 Oct 2015 17:41:48 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd1-us-west.apache.org (ASF Mail Server at spamd1-us-west.apache.org) with ESMTP id 6AC43C58DB
	for <dev@httpd.apache.org>; Mon, 12 Oct 2015 17:41:48 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd1-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 0.001
X-Spam-Level:
X-Spam-Status: No, score=0.001 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, URIBL_BLOCKED=0.001]
	autolearn=disabled
Authentication-Results: spamd1-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=comcast.net
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd1-us-west.apache.org [10.40.0.7]) (amavisd-new, port 10024)
	with ESMTP id CuGr92i2_4_O for <dev@httpd.apache.org>;
	Mon, 12 Oct 2015 17:41:37 +0000 (UTC)
Received: from resqmta-ch2-12v.sys.comcast.net (resqmta-ch2-12v.sys.comcast.net [69.252.207.44])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id 53D2F439DD
	for <dev@httpd.apache.org>; Mon, 12 Oct 2015 17:41:37 +0000 (UTC)
Received: from resomta-ch2-07v.sys.comcast.net ([69.252.207.103])
	by resqmta-ch2-12v.sys.comcast.net with comcast
	id UHgw1r0062EPM3101HhXGX; Mon, 12 Oct 2015 17:41:31 +0000
Received: from [192.168.199.10] ([69.251.84.114])
	by resomta-ch2-07v.sys.comcast.net with comcast
	id UHhX1r00A2U0RYt01HhXfU; Mon, 12 Oct 2015 17:41:31 +0000
Content-Type: text/plain; charset=us-ascii
Mime-Version: 1.0 (Mac OS X Mail 8.2 \(2104\))
Subject: [RESULT] Re: [VOTE] Release Apache httpd 2.4.17 as GA
From: Jim Jagielski <jim@jaguNET.com>
In-Reply-To: <C45BAF78-8A10-4751-B1CA-62BB499FD795@jaguNET.com>
Date: Mon, 12 Oct 2015 13:41:31 -0400
Content-Transfer-Encoding: 7bit
Message-Id: <89BE34AD-F50B-47CC-8432-4742FA182EA7@jaguNET.com>
References: <C45BAF78-8A10-4751-B1CA-62BB499FD795@jaguNET.com>
To: dev@httpd.apache.org
X-Mailer: Apple Mail (2.2104)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=comcast.net;
	s=q20140121; t=1444671691;
	bh=rjTySKj011isPYMXGj3WIcRDjAtNR4QMcUGF+TJSKVQ=;
	h=Received:Received:Content-Type:Mime-Version:Subject:From:Date:
	 Message-Id:To;
	b=FhuhLZlccrzoActBAZfEMvLI3dR8ayz1Etsm0EPhq3uqc05uvV+niYcLnC4rnw2vf
	 CIMJYes7+BDcSC3NkvvSaAa0xNNp10lTV5QATuD5Q15ICH8mYIu3H2CMzBpBn0rbsj
	 hzXbrR08mwQ+QegeT7OVpVNEC1+m+iAEvwkVFSxwG+/aLJ6I1Cw9/SPAAVYExj0rPW
	 ZtP9B81aX487EoBtZMXXCbhpbFo5Kz0tc4cTmB2Zq6Y2gALyHOl65J0b+YsGf4RM1T
	 u9aCFNC/gvTHNw2XzAZbxDGEa0iMF2O1sjbONNgBM58OhXHPF4WK5vizzNDf4n49kJ
	 xbTrAZnosiQoA==

The VOTE is CLOSED.

With more than the required 3 +1 (binding) votes, the VOTE
PASSES!

Thx to all testers and contributors. I will start the process
of pushing to the mirrors and will announce on Weds.

> On Oct 9, 2015, at 1:40 PM, Jim Jagielski <jim@jaguNET.com> wrote:
> 
> The pre-release test tarballs for Apache httpd 2.4.17 can be found
> at the usual place:
> 
> 	http://httpd.apache.org/dev/dist/
> 
> I'm calling a VOTE on releasing these as Apache httpd 2.4.17 GA.
> 
> [ ] +1: Good to go
> [ ] +0: meh
> [ ] -1: Danger Will Robinson. And why.
> 
> Vote will last the normal 72 hrs.
> 
> NOTE: The *-deps are only there for convenience.
> 
> Thx!
> 


From dev-return-84263-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Mon Oct 12 17:43:34 2015
Return-Path: <dev-return-84263-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id D8EDA18780
	for <apmail-httpd-dev-archive@www.apache.org>; Mon, 12 Oct 2015 17:43:34 +0000 (UTC)
Received: (qmail 29458 invoked by uid 500); 12 Oct 2015 17:43:34 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 29388 invoked by uid 500); 12 Oct 2015 17:43:34 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 29378 invoked by uid 99); 12 Oct 2015 17:43:34 -0000
Received: from Unknown (HELO spamd2-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 12 Oct 2015 17:43:34 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd2-us-west.apache.org (ASF Mail Server at spamd2-us-west.apache.org) with ESMTP id ECCEC1A0AB4
	for <dev@httpd.apache.org>; Mon, 12 Oct 2015 17:43:33 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd2-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.01
X-Spam-Level:
X-Spam-Status: No, score=-0.01 tagged_above=-999 required=6.31
	tests=[SPF_PASS=-0.001, T_RP_MATCHES_RCVD=-0.01, URIBL_BLOCKED=0.001]
	autolearn=disabled
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd2-us-west.apache.org [10.40.0.9]) (amavisd-new, port 10024)
	with ESMTP id 847FPnzc8Bro for <dev@httpd.apache.org>;
	Mon, 12 Oct 2015 17:43:24 +0000 (UTC)
Received: from mail.greenbytes.de (mail.greenbytes.de [217.91.35.233])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id 3369120C18
	for <dev@httpd.apache.org>; Mon, 12 Oct 2015 17:43:23 +0000 (UTC)
Received: from [192.168.178.52] (unknown [84.189.95.13])
	(using TLSv1 with cipher ECDHE-RSA-AES256-SHA (256/256 bits))
	(Client did not present a certificate)
	by mail.greenbytes.de (Postfix) with ESMTPSA id 3E8E215A0049
	for <dev@httpd.apache.org>; Mon, 12 Oct 2015 19:43:22 +0200 (CEST)
From: Stefan Eissing <stefan.eissing@greenbytes.de>
Content-Type: text/plain;
	charset=us-ascii
Content-Transfer-Encoding: 7bit
Mime-Version: 1.0 (1.0)
Subject: Re: [RESULT] Re: [VOTE] Release Apache httpd 2.4.17 as GA
Message-Id: <C2A28D2D-F294-4F6B-B6BE-97DC2EDBC5E8@greenbytes.de>
Date: Mon, 12 Oct 2015 19:43:21 +0200
References: <C45BAF78-8A10-4751-B1CA-62BB499FD795@jaguNET.com> <89BE34AD-F50B-47CC-8432-4742FA182EA7@jaguNET.com>
In-Reply-To: <89BE34AD-F50B-47CC-8432-4742FA182EA7@jaguNET.com>
To: dev@httpd.apache.org
X-Mailer: iPhone Mail (13A452)

Yay! Thanks to all!

> Am 12.10.2015 um 19:41 schrieb Jim Jagielski <jim@jaguNET.com>:
> 
> The VOTE is CLOSED.
> 
> With more than the required 3 +1 (binding) votes, the VOTE
> PASSES!
> 
> Thx to all testers and contributors. I will start the process
> of pushing to the mirrors and will announce on Weds.
> 
>> On Oct 9, 2015, at 1:40 PM, Jim Jagielski <jim@jaguNET.com> wrote:
>> 
>> The pre-release test tarballs for Apache httpd 2.4.17 can be found
>> at the usual place:
>> 
>>    http://httpd.apache.org/dev/dist/
>> 
>> I'm calling a VOTE on releasing these as Apache httpd 2.4.17 GA.
>> 
>> [ ] +1: Good to go
>> [ ] +0: meh
>> [ ] -1: Danger Will Robinson. And why.
>> 
>> Vote will last the normal 72 hrs.
>> 
>> NOTE: The *-deps are only there for convenience.
>> 
>> Thx!
> 

From dev-return-84264-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Mon Oct 12 18:34:57 2015
Return-Path: <dev-return-84264-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 6CECA189FA
	for <apmail-httpd-dev-archive@www.apache.org>; Mon, 12 Oct 2015 18:34:57 +0000 (UTC)
Received: (qmail 86854 invoked by uid 500); 12 Oct 2015 18:34:57 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 86784 invoked by uid 500); 12 Oct 2015 18:34:57 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 86774 invoked by uid 99); 12 Oct 2015 18:34:56 -0000
Received: from Unknown (HELO spamd1-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 12 Oct 2015 18:34:56 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd1-us-west.apache.org (ASF Mail Server at spamd1-us-west.apache.org) with ESMTP id 6A0A2C2AE3
	for <dev@httpd.apache.org>; Mon, 12 Oct 2015 18:34:56 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd1-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.121
X-Spam-Level:
X-Spam-Status: No, score=-0.121 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RCVD_IN_MSPIKE_H3=-0.01, RCVD_IN_MSPIKE_WL=-0.01, SPF_PASS=-0.001]
	autolearn=disabled
Authentication-Results: spamd1-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd1-us-west.apache.org [10.40.0.7]) (amavisd-new, port 10024)
	with ESMTP id qGtEvbB2dVGU for <dev@httpd.apache.org>;
	Mon, 12 Oct 2015 18:34:56 +0000 (UTC)
Received: from mail-pa0-f41.google.com (mail-pa0-f41.google.com [209.85.220.41])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id 97F1B439CE
	for <dev@httpd.apache.org>; Mon, 12 Oct 2015 18:34:55 +0000 (UTC)
Received: by pacex6 with SMTP id ex6so6459052pac.3
        for <dev@httpd.apache.org>; Mon, 12 Oct 2015 11:34:49 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=subject:to:references:from:message-id:date:user-agent:mime-version
         :in-reply-to:content-type:content-transfer-encoding;
        bh=cmL64ByU7RnbbeeOtbcVyVOWKtLNQ9QWeC3bKIL2Ma4=;
        b=T+g4ocuxS7h8B5CxthHCux8+tpJnI4tuhJLk7mXB2ntHRG2HGGw9ni78Rw+1eeDX6S
         70VRDGcct1P9rC0xXKddPdfOenav+fWXZWqWWmZQnK1sQk4iEMOHcme3FG3fqXd+YNxQ
         oHeuWr/LK0WHgnmk2NHCQ9R4Kg7Kdfu5kL5CLcaS4Pf0TRnRmWiUJuEmFFISKUVGWSlA
         I4UQ9PQiV8ksdWP+aHMJO4YOIKYy+y7v/poycRGG5YjKlxqOTRTyi+j6qocYBff8lDZh
         VSS2BwNucEM4cUCpKzmPY59bk+4eNOJnBYLgEA7HGgHYc0NgjNjikpBWCTEX3mk7TyD/
         1tiA==
X-Received: by 10.68.109.2 with SMTP id ho2mr36294255pbb.158.1444674889053;
        Mon, 12 Oct 2015 11:34:49 -0700 (PDT)
Received: from [192.168.1.4] (static-50-43-55-221.bvtn.or.frontiernet.net. [50.43.55.221])
        by smtp.gmail.com with ESMTPSA id qy5sm19676401pbb.16.2015.10.12.11.34.47
        for <dev@httpd.apache.org>
        (version=TLSv1.2 cipher=ECDHE-RSA-AES128-GCM-SHA256 bits=128/128);
        Mon, 12 Oct 2015 11:34:47 -0700 (PDT)
Subject: Re: 2.4.17 test failure for mod_nntp_like_ssl when mod_http2 is
 loaded
To: dev@httpd.apache.org
References: <561A64DC.5000809@kippdata.de>
 <A350DE1E-8634-43AC-A054-3BCE181D6CA1@greenbytes.de>
 <A873A60B-662E-487A-BA96-C58ED4F4E04E@greenbytes.de>
 <CAKQ1sVO5+13U2xcVc-A_1geQChnSikxeosTWubm07yDrvpzMXw@mail.gmail.com>
 <B1E3C336-57A0-4487-A084-93BCA8E7CC70@greenbytes.de>
 <CAKQ1sVNabR-048ozc7qy9MhMCqsC7PXYwzvuX=+mCDEKRriZbQ@mail.gmail.com>
 <CAKQ1sVP1ZCe2-j24+yBZvFo70aZ1Gw2v7TnW+3U9BBgMwT4W7A@mail.gmail.com>
 <E60F1FAA-865A-4F8F-996A-1F881FDEE141@greenbytes.de>
 <CAKQ1sVNK8uPtZGHdgmrWkuV9a0_uwG--xBJHWRqQj2n0-iGKkA@mail.gmail.com>
From: Jacob Champion <champion.p@gmail.com>
Message-ID: <561BFD47.2020201@gmail.com>
Date: Mon, 12 Oct 2015 11:34:47 -0700
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:38.0) Gecko/20100101
 Thunderbird/38.3.0
MIME-Version: 1.0
In-Reply-To: <CAKQ1sVNK8uPtZGHdgmrWkuV9a0_uwG--xBJHWRqQj2n0-iGKkA@mail.gmail.com>
Content-Type: text/plain; charset=utf-8; format=flowed
Content-Transfer-Encoding: 7bit

On 10/12/2015 02:12 AM, Yann Ylavic wrote:
> That would be better, but still the doc says "[H2Direct] falls outside
> the RFC 7540 but has become widely implemented as it is very
> convenient for development and testing".

_Does_ it fall outside the RFC? Section 3.4 covers the establishment of 
(cleartext) HTTP/2 connections via prior knowledge, and seems to 
describe exactly this use case:

 > A client MUST send the connection preface (Section 3.5) and then MAY
 > immediately send HTTP/2 frames to such a server; servers can identify
 > these connections by the presence of the connection preface.

I agree that the method of establishing this prior knowledge is 
undefined, but the h2-direct mode seems to be within the RFC's scope. If 
you agree, I'd suggest removing that line from the docs.

--Jacob

From dev-return-84265-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Mon Oct 12 20:08:05 2015
Return-Path: <dev-return-84265-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id E1C0818EBD
	for <apmail-httpd-dev-archive@www.apache.org>; Mon, 12 Oct 2015 20:08:05 +0000 (UTC)
Received: (qmail 6744 invoked by uid 500); 12 Oct 2015 20:07:59 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 6687 invoked by uid 500); 12 Oct 2015 20:07:58 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 6677 invoked by uid 99); 12 Oct 2015 20:07:58 -0000
Received: from Unknown (HELO spamd4-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 12 Oct 2015 20:07:58 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd4-us-west.apache.org (ASF Mail Server at spamd4-us-west.apache.org) with ESMTP id 3FA25C084E
	for <dev@httpd.apache.org>; Mon, 12 Oct 2015 20:07:58 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd4-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.121
X-Spam-Level:
X-Spam-Status: No, score=-0.121 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RCVD_IN_MSPIKE_H3=-0.01, RCVD_IN_MSPIKE_WL=-0.01, SPF_PASS=-0.001]
	autolearn=disabled
Authentication-Results: spamd4-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-us-west.apache.org ([10.40.0.8])
	by localhost (spamd4-us-west.apache.org [10.40.0.11]) (amavisd-new, port 10024)
	with ESMTP id 9lA3lDYCq9Bk for <dev@httpd.apache.org>;
	Mon, 12 Oct 2015 20:07:57 +0000 (UTC)
Received: from mail-pa0-f46.google.com (mail-pa0-f46.google.com [209.85.220.46])
	by mx1-us-west.apache.org (ASF Mail Server at mx1-us-west.apache.org) with ESMTPS id 9A72D2045A
	for <dev@httpd.apache.org>; Mon, 12 Oct 2015 20:07:57 +0000 (UTC)
Received: by pacex6 with SMTP id ex6so8153225pac.3
        for <dev@httpd.apache.org>; Mon, 12 Oct 2015 13:07:51 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=to:from:subject:message-id:date:user-agent:mime-version
         :content-type:content-transfer-encoding;
        bh=Rm9/kdg3Gj2tG6Jfa5YJPzsExT8WiMiGe3Bi6y9rq0k=;
        b=p3XdlUr6me0xpg2f9Cofj0z9R7uJkXGuW5sFr2yAOj4ZtF1Yf+qL3pby3h0/TU1+pR
         tof/h4Gfqkd0sfa7JjDLVgaaZTMbfeUEoVVP0qv0Gbnwf48O0XU5R0U0ZmHLBF24iU6J
         8j5K+Bm9mPiyQbstKIc6VDvb2vR5jqBLO0mEEEWYWorMLivNdVCYYv+somS2VPHHQWVY
         jwlxqx4u0SXsja46RgUBqMDeitykJOKGaVPkHMgrKtwn4Mlt+T6D7uvmWfKzJisrknf8
         GTVMo3WOnKN0w37a2WEqjcsm/XB7g0OI535IT7jCxoKFVA7wAv1HW6e/E1oQvK6o6WxG
         K18Q==
X-Received: by 10.66.121.137 with SMTP id lk9mr21809572pab.87.1444680471380;
        Mon, 12 Oct 2015 13:07:51 -0700 (PDT)
Received: from [192.168.1.4] (static-50-43-55-221.bvtn.or.frontiernet.net. [50.43.55.221])
        by smtp.gmail.com with ESMTPSA id rz9sm19861166pbb.61.2015.10.12.13.07.49
        for <dev@httpd.apache.org>
        (version=TLSv1.2 cipher=ECDHE-RSA-AES128-GCM-SHA256 bits=128/128);
        Mon, 12 Oct 2015 13:07:50 -0700 (PDT)
To: dev@httpd.apache.org
From: Jacob Champion <champion.p@gmail.com>
Subject: Double 101 response on timeout with h2c/mod_http2
Message-ID: <561C1315.8030108@gmail.com>
Date: Mon, 12 Oct 2015 13:07:49 -0700
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:38.0) Gecko/20100101
 Thunderbird/38.3.0
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8; format=flowed
Content-Transfer-Encoding: 7bit

I was curious to see how the mod_reqtimeout filter removal worked with 
mod_http2, since mod_websocket needs something similar. So I opened up 
telnet and did a manual Upgrade: h2c with some junk HTTP2-Settings. I 
got the 101 Switching Protocols response and a binary chunk of SETTINGS, 
then let the connection sit there for a while.

60 seconds later, I got another 101 Switching Protocols response, this 
time with the typical HTTP/1.1 header block, and then the connection closed:

> HTTP/1.1 101 Switching Protocols
> Date: Mon, 12 Oct 2015 19:50:51 GMT
> Server: Apache/2.4.18-dev (Unix) OpenSSL/1.0.2d
> Content-Length: 0
> Connection: close
> Content-Type: text/html

 From a short run with GDB, it looks like the "standard" output filter 
chain is not being disabled in this timeout case.

(Now that mod_http2 is (almost) released, if you'd prefer I move this to 
the bug tracker, just say the word.)

--Jacob

From dev-return-84266-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Tue Oct 13 11:13:39 2015
Return-Path: <dev-return-84266-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id B638B181C5
	for <apmail-httpd-dev-archive@www.apache.org>; Tue, 13 Oct 2015 11:13:39 +0000 (UTC)
Received: (qmail 20315 invoked by uid 500); 13 Oct 2015 11:12:40 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 20233 invoked by uid 500); 13 Oct 2015 11:12:40 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 20223 invoked by uid 99); 13 Oct 2015 11:12:40 -0000
Received: from Unknown (HELO spamd3-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 13 Oct 2015 11:12:40 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd3-us-west.apache.org (ASF Mail Server at spamd3-us-west.apache.org) with ESMTP id 57D1F180A63
	for <dev@httpd.apache.org>; Tue, 13 Oct 2015 11:12:40 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd3-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.102
X-Spam-Level:
X-Spam-Status: No, score=-0.102 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RCVD_IN_MSPIKE_H2=-0.001, SPF_PASS=-0.001] autolearn=disabled
Authentication-Results: spamd3-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd3-us-west.apache.org [10.40.0.10]) (amavisd-new, port 10024)
	with ESMTP id wb0QX2I2VmWn for <dev@httpd.apache.org>;
	Tue, 13 Oct 2015 11:12:39 +0000 (UTC)
Received: from mail-qk0-f175.google.com (mail-qk0-f175.google.com [209.85.220.175])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id 34F4520524
	for <dev@httpd.apache.org>; Tue, 13 Oct 2015 11:12:39 +0000 (UTC)
Received: by qkht68 with SMTP id t68so5235407qkh.3
        for <dev@httpd.apache.org>; Tue, 13 Oct 2015 04:12:38 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        bh=yVtRQIkPJRjcGnKXmcKci45WAxJUrsd6CmgmDcwHApw=;
        b=KaXnG8UIErCEnQayK7E4D7yAKxpajbg0v5tbQTEMaYTqKk8MDHfb2qU45qga9bE3LE
         ZxxF+a41aqaz7NGYe2tbn86UwYKpseA6C3uppP2G53ozeXMnmeOwkkv3WRD/MVcS4PFk
         XBST9TTz5MCt2s0TAZ4Lw8Vtk8UpL2CRP21w6Q6uM/6lAHlEdXMsR7CisBdMjkVlVe8j
         2ZyPMLooUFU/l9Rbr4vukSWXMqCrza0TmIctXagVWQiNQsX2JlbCWjAcUwFVcmjZuXk+
         bmjeWStAuCiPRKoPIaa9vU1esgAgK5utNy+l6LFfEDcmmemFwVUh5SpAvXoqNtZZLVif
         BEqg==
MIME-Version: 1.0
X-Received: by 10.55.209.93 with SMTP id s90mr39095506qki.55.1444734758072;
 Tue, 13 Oct 2015 04:12:38 -0700 (PDT)
Received: by 10.55.72.20 with HTTP; Tue, 13 Oct 2015 04:12:38 -0700 (PDT)
In-Reply-To: <20151012174221.B70583A02E5@svn01-us-west.apache.org>
References: <20151012174221.B70583A02E5@svn01-us-west.apache.org>
Date: Tue, 13 Oct 2015 13:12:38 +0200
Message-ID: <CAKQ1sVPA7Owq9noO1uAFXJ8KSWK5Yq-1wxc7wURdo1FoWjyXwQ@mail.gmail.com>
Subject: Re: svn commit: r10796 - /release/httpd/
From: Yann Ylavic <ylavic.dev@gmail.com>
To: dev@httpd.apache.org
Content-Type: text/plain; charset=UTF-8

On Mon, Oct 12, 2015 at 7:42 PM,  <jim@apache.org> wrote:
> Author: jim
> Date: Mon Oct 12 17:42:21 2015
> New Revision: 10796
>
> Log:
> Push and populate mirrors...

Despite this commit, httpd.a.o (including /download.cgi) still refers
to 2.4.16 for me (EU, but same for httpd.us.a.o), although
www.a.o/dist/httpd/Announcement2.4.html and /dist/httpd/CHANGES_2.4
have been updated to 2.4.17.

From dev-return-84267-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Tue Oct 13 11:16:33 2015
Return-Path: <dev-return-84267-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 66596181D7
	for <apmail-httpd-dev-archive@www.apache.org>; Tue, 13 Oct 2015 11:16:33 +0000 (UTC)
Received: (qmail 25367 invoked by uid 500); 13 Oct 2015 11:16:32 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 25282 invoked by uid 500); 13 Oct 2015 11:16:32 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 25273 invoked by uid 99); 13 Oct 2015 11:16:32 -0000
Received: from mail-relay.apache.org (HELO mail-relay.apache.org) (140.211.11.15)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 13 Oct 2015 11:16:32 +0000
Received: from [192.168.1.37] (2804ds5-soeb.0.fullrate.dk [90.184.204.23])
	by mail-relay.apache.org (ASF Mail Server at mail-relay.apache.org) with ESMTPSA id 50CFB1A0098
	for <dev@httpd.apache.org>; Tue, 13 Oct 2015 11:16:32 +0000 (UTC)
Subject: Re: svn commit: r10796 - /release/httpd/
To: dev@httpd.apache.org
References: <20151012174221.B70583A02E5@svn01-us-west.apache.org>
 <CAKQ1sVPA7Owq9noO1uAFXJ8KSWK5Yq-1wxc7wURdo1FoWjyXwQ@mail.gmail.com>
From: Daniel Gruno <humbedooh@apache.org>
Message-ID: <561CE80D.8090500@apache.org>
Date: Tue, 13 Oct 2015 13:16:29 +0200
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:38.0) Gecko/20100101
 Thunderbird/38.3.0
MIME-Version: 1.0
In-Reply-To: <CAKQ1sVPA7Owq9noO1uAFXJ8KSWK5Yq-1wxc7wURdo1FoWjyXwQ@mail.gmail.com>
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit

On 10/13/2015 01:12 PM, Yann Ylavic wrote:
> On Mon, Oct 12, 2015 at 7:42 PM,  <jim@apache.org> wrote:
>> Author: jim
>> Date: Mon Oct 12 17:42:21 2015
>> New Revision: 10796
>>
>> Log:
>> Push and populate mirrors...
> 
> Despite this commit, httpd.a.o (including /download.cgi) still refers
> to 2.4.16 for me (EU, but same for httpd.us.a.o), although
> www.a.o/dist/httpd/Announcement2.4.html and /dist/httpd/CHANGES_2.4
> have been updated to 2.4.17.
> 
The mirrors need to populate before we can change it to 2.4.17.
Give it a few hours :)

With regards,
Daniel.

From dev-return-84268-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Tue Oct 13 11:18:00 2015
Return-Path: <dev-return-84268-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id EDD92181E7
	for <apmail-httpd-dev-archive@www.apache.org>; Tue, 13 Oct 2015 11:17:59 +0000 (UTC)
Received: (qmail 27271 invoked by uid 500); 13 Oct 2015 11:17:59 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 27199 invoked by uid 500); 13 Oct 2015 11:17:59 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 27189 invoked by uid 99); 13 Oct 2015 11:17:59 -0000
Received: from Unknown (HELO spamd1-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 13 Oct 2015 11:17:59 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd1-us-west.apache.org (ASF Mail Server at spamd1-us-west.apache.org) with ESMTP id 11446C2E77
	for <dev@httpd.apache.org>; Tue, 13 Oct 2015 11:17:59 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd1-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.102
X-Spam-Level:
X-Spam-Status: No, score=-0.102 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RCVD_IN_MSPIKE_H2=-0.001, SPF_PASS=-0.001] autolearn=disabled
Authentication-Results: spamd1-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd1-us-west.apache.org [10.40.0.7]) (amavisd-new, port 10024)
	with ESMTP id a2MfCqiGp82e for <dev@httpd.apache.org>;
	Tue, 13 Oct 2015 11:17:58 +0000 (UTC)
Received: from mail-qg0-f41.google.com (mail-qg0-f41.google.com [209.85.192.41])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id 592674357F
	for <dev@httpd.apache.org>; Tue, 13 Oct 2015 11:17:58 +0000 (UTC)
Received: by qgx61 with SMTP id 61so10641897qgx.3
        for <dev@httpd.apache.org>; Tue, 13 Oct 2015 04:17:58 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        bh=8WGO8UNIN7r8cVyrT8WCC4+hta5BuIuHCMneiT1bujA=;
        b=uLM3mLsQnTeaRfflIMJzelEGrwyTBGsNb6R1oxbRglXW0MGYrzIRymOQHqD2EbF35H
         vsDL+V7Aq00YEvDsxPh3vBmig1EtEth4KL2fOeJ8flAHEfZZLQgdkCuNbgGmMXhMvBtk
         BGiXlyUbCJlo83FWmJ7q9PTpq3iWFu37p4b17APrQlI2QhzrLGguhuKvPInsHlVa5Xq/
         x3BhRrsBBJqp3eWIJgGGsoD5ZBq+ALdtZ8LLNSbHpR6us9PAQVyOYiWguBG3NvKkpIce
         pZFAPA2FXIneRBwwHFA2agtmWzxU5EWdb8hh6Xk//lIxODd68WsJ5WWKRi70F/WprV8w
         //YQ==
MIME-Version: 1.0
X-Received: by 10.140.131.70 with SMTP id 67mr41956977qhd.70.1444735078123;
 Tue, 13 Oct 2015 04:17:58 -0700 (PDT)
Received: by 10.55.72.20 with HTTP; Tue, 13 Oct 2015 04:17:58 -0700 (PDT)
In-Reply-To: <561CE80D.8090500@apache.org>
References: <20151012174221.B70583A02E5@svn01-us-west.apache.org>
	<CAKQ1sVPA7Owq9noO1uAFXJ8KSWK5Yq-1wxc7wURdo1FoWjyXwQ@mail.gmail.com>
	<561CE80D.8090500@apache.org>
Date: Tue, 13 Oct 2015 13:17:58 +0200
Message-ID: <CAKQ1sVPHi2PWUhNHFW=vgWjcRKbaaNBWTv9GCZD1s-MH+k4vUg@mail.gmail.com>
Subject: Re: svn commit: r10796 - /release/httpd/
From: Yann Ylavic <ylavic.dev@gmail.com>
To: dev@httpd.apache.org
Content-Type: text/plain; charset=UTF-8

On Tue, Oct 13, 2015 at 1:16 PM, Daniel Gruno <humbedooh@apache.org> wrote:
> On 10/13/2015 01:12 PM, Yann Ylavic wrote:
>> On Mon, Oct 12, 2015 at 7:42 PM,  <jim@apache.org> wrote:
>>> Author: jim
>>> Date: Mon Oct 12 17:42:21 2015
>>> New Revision: 10796
>>>
>>> Log:
>>> Push and populate mirrors...
>>
>> Despite this commit, httpd.a.o (including /download.cgi) still refers
>> to 2.4.16 for me (EU, but same for httpd.us.a.o), although
>> www.a.o/dist/httpd/Announcement2.4.html and /dist/httpd/CHANGES_2.4
>> have been updated to 2.4.17.
>>
> The mirrors need to populate before we can change it to 2.4.17.
> Give it a few hours :)

Oh ok, CURRENT-IS-2.4.17 is always delayed, missed that.
Thanks.

From dev-return-84269-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Tue Oct 13 13:42:16 2015
Return-Path: <dev-return-84269-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id C400F186FE
	for <apmail-httpd-dev-archive@www.apache.org>; Tue, 13 Oct 2015 13:42:16 +0000 (UTC)
Received: (qmail 70840 invoked by uid 500); 13 Oct 2015 13:42:16 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 70784 invoked by uid 500); 13 Oct 2015 13:42:16 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 70774 invoked by uid 99); 13 Oct 2015 13:42:16 -0000
Received: from Unknown (HELO spamd1-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 13 Oct 2015 13:42:16 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd1-us-west.apache.org (ASF Mail Server at spamd1-us-west.apache.org) with ESMTP id E04CAC5C93
	for <dev@httpd.apache.org>; Tue, 13 Oct 2015 13:42:15 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd1-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 0.652
X-Spam-Level:
X-Spam-Status: No, score=0.652 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, SPF_NEUTRAL=0.652]
	autolearn=disabled
Authentication-Results: spamd1-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=comcast.net
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd1-us-west.apache.org [10.40.0.7]) (amavisd-new, port 10024)
	with ESMTP id uIzvA0Q5XKlU for <dev@httpd.apache.org>;
	Tue, 13 Oct 2015 13:42:10 +0000 (UTC)
Received: from resqmta-ch2-12v.sys.comcast.net (resqmta-ch2-12v.sys.comcast.net [69.252.207.44])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id 374CB42B30
	for <dev@httpd.apache.org>; Tue, 13 Oct 2015 13:42:10 +0000 (UTC)
Received: from resomta-ch2-10v.sys.comcast.net ([69.252.207.106])
	by resqmta-ch2-12v.sys.comcast.net with comcast
	id UdhY1r0062JGN3p01di9wT; Tue, 13 Oct 2015 13:42:09 +0000
Received: from [192.168.199.10] ([69.251.84.114])
	by resomta-ch2-10v.sys.comcast.net with comcast
	id Udi91r0082U0RYt01di9r0; Tue, 13 Oct 2015 13:42:09 +0000
Content-Type: text/plain; charset=us-ascii
Mime-Version: 1.0 (Mac OS X Mail 8.2 \(2104\))
Subject: Re: svn commit: r10796 - /release/httpd/
From: Jim Jagielski <jim@jaguNET.com>
In-Reply-To: <CAKQ1sVPA7Owq9noO1uAFXJ8KSWK5Yq-1wxc7wURdo1FoWjyXwQ@mail.gmail.com>
Date: Tue, 13 Oct 2015 09:42:08 -0400
Content-Transfer-Encoding: 7bit
Message-Id: <9F1FF993-DD00-4365-A9F0-77BC05C68295@jaguNET.com>
References: <20151012174221.B70583A02E5@svn01-us-west.apache.org> <CAKQ1sVPA7Owq9noO1uAFXJ8KSWK5Yq-1wxc7wURdo1FoWjyXwQ@mail.gmail.com>
To: dev@httpd.apache.org
X-Mailer: Apple Mail (2.2104)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=comcast.net;
	s=q20140121; t=1444743729;
	bh=AOrWXzoBZiBoG+QPt5QWXmJKkTjgKDGZfqKM/SKR1ZE=;
	h=Received:Received:Content-Type:Mime-Version:Subject:From:Date:
	 Message-Id:To;
	b=gcUmXN05hz0kDf/zMSlsVbQfz+VS4AExCmBaviBa5S5rkyoIs3rq1/98jujxJeTYV
	 gwy8kyFf1U+9tkDu1mTRvx2rX//lmOt0kS/dvCmR32LwNszzkkxBgGPaf9GchlVPU4
	 t6duNtMSIW7t8uNk2W+Y2nkVq/a3HrxRUX0Neq2Kf9grPnWC45P/YJDgeseqv4tDj6
	 9X8CiSDROlheiK3BIAIz5+VBAUwzjZL8Z+hKXuEG7FT6AefjGxw0qZ6z2X3hDD9zKZ
	 nCyIi1Ok7uzGi+kZBIT86xdUIgG3OcPImoG2LTKoa3elpNSqvKw7EkaNqMkUNQNmJg
	 zQT7Q4G5n1WCA==

That's because we need to the mirrors to catch up. Once they
do then we can adjust fully over to 2.4.17... that's why we
have the delay between pushing the release and actually
announcing the release.

> On Oct 13, 2015, at 7:12 AM, Yann Ylavic <ylavic.dev@gmail.com> wrote:
> 
> On Mon, Oct 12, 2015 at 7:42 PM,  <jim@apache.org> wrote:
>> Author: jim
>> Date: Mon Oct 12 17:42:21 2015
>> New Revision: 10796
>> 
>> Log:
>> Push and populate mirrors...
> 
> Despite this commit, httpd.a.o (including /download.cgi) still refers
> to 2.4.16 for me (EU, but same for httpd.us.a.o), although
> www.a.o/dist/httpd/Announcement2.4.html and /dist/httpd/CHANGES_2.4
> have been updated to 2.4.17.


From dev-return-84270-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Tue Oct 13 17:35:14 2015
Return-Path: <dev-return-84270-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 9C8CA1836B
	for <apmail-httpd-dev-archive@www.apache.org>; Tue, 13 Oct 2015 17:35:14 +0000 (UTC)
Received: (qmail 55874 invoked by uid 500); 13 Oct 2015 17:35:14 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 55804 invoked by uid 500); 13 Oct 2015 17:35:14 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 55794 invoked by uid 99); 13 Oct 2015 17:35:14 -0000
Received: from Unknown (HELO spamd3-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 13 Oct 2015 17:35:14 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd3-us-west.apache.org (ASF Mail Server at spamd3-us-west.apache.org) with ESMTP id 8539E180E3C
	for <dev@httpd.apache.org>; Tue, 13 Oct 2015 17:35:13 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd3-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 0.652
X-Spam-Level:
X-Spam-Status: No, score=0.652 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, SPF_NEUTRAL=0.652]
	autolearn=disabled
Authentication-Results: spamd3-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=comcast.net
Received: from mx1-us-west.apache.org ([10.40.0.8])
	by localhost (spamd3-us-west.apache.org [10.40.0.10]) (amavisd-new, port 10024)
	with ESMTP id x8lsUaOOfVTX for <dev@httpd.apache.org>;
	Tue, 13 Oct 2015 17:35:07 +0000 (UTC)
Received: from resqmta-ch2-10v.sys.comcast.net (resqmta-ch2-10v.sys.comcast.net [69.252.207.42])
	by mx1-us-west.apache.org (ASF Mail Server at mx1-us-west.apache.org) with ESMTPS id D3F1220F1E
	for <dev@httpd.apache.org>; Tue, 13 Oct 2015 17:35:06 +0000 (UTC)
Received: from resomta-ch2-15v.sys.comcast.net ([69.252.207.111])
	by resqmta-ch2-10v.sys.comcast.net with comcast
	id UhaB1r0012Qkjl901hb0L4; Tue, 13 Oct 2015 17:35:00 +0000
Received: from [192.168.199.10] ([69.251.84.114])
	by resomta-ch2-15v.sys.comcast.net with comcast
	id Uhaz1r0042U0RYt01hazaF; Tue, 13 Oct 2015 17:35:00 +0000
From: Jim Jagielski <jim@jaguNET.com>
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
Subject: [ANNOUNCEMENT]  Apache HTTP Server 2.4.17 Released
Message-Id: <A3B7A93F-46B7-4FE3-8D36-1C058E59A7CA@jaguNET.com>
Date: Tue, 13 Oct 2015 13:34:59 -0400
To: httpd <dev@httpd.apache.org>
Mime-Version: 1.0 (Mac OS X Mail 8.2 \(2104\))
X-Mailer: Apple Mail (2.2104)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=comcast.net;
	s=q20140121; t=1444757700;
	bh=2uC2xrK7Dnnups7EGHIUVzjI4nqHE7zlGmLqku4vcAU=;
	h=Received:Received:From:Content-Type:Subject:Message-Id:Date:To:
	 Mime-Version;
	b=kU86dVc2QosD2ZZSX4r89X2sHHj68xTJdqKe5Y1thnBlUozif6f+pOG4MODRzAAtR
	 Fu95jmGLf4OVg+3qyBWeXJB6XCNFkBI9TwwZReiIFWfIBX3gunTMEklDskhEhAGp2E
	 TOlT2+lObfebqbuDVsqBZm9AYPjSpRXerRmXK6Wyay2wyyOedriaMeMfLJPh/0SJ6Z
	 MEFhodWoindOkWGjDrlm05n7d9Pdot0IGO/nccuIG5/HE5s+DX4h6dE7v03Ipd4tiA
	 dL4Y7oH1AvdBGBhczTNiu3Bv0WOLlXdgwaCmSBsFQojWtY6DwBuLUMaNp4na3/DrEC
	 kAGm2UXaN0FYA==

            Apache HTTP Server 2.4.17 Released

The Apache Software Foundation and the Apache HTTP Server Project
are pleased to announce the release of version 2.4.17 of the Apache
HTTP Server ("Apache").  This version of Apache is our latest GA
release of the new generation 2.4.x branch of Apache HTTPD and
represents fifteen years of innovation by the project, and is
recommended over all previous releases. This release of Apache is
principally a feature and bug fix release.

In this release are some exciting new features including:

 *) HTTP/2 support via mod_http2 module
 *) Support for SO_REUSEPORT in MPMs for significant scalability

We consider this release to be the best version of Apache available, and
encourage users of all prior versions to upgrade.

Apache HTTP Server 2.4.17 is available for download from:

 http://httpd.apache.org/download.cgi

Apache 2.4 offers numerous enhancements, improvements, and performance
boosts over the 2.2 codebase.  For an overview of new features
introduced since 2.4 please see:

 http://httpd.apache.org/docs/trunk/new_features_2_4.html

Please see the CHANGES_2.4 file, linked from the download page, for a
full list of changes. A condensed list, CHANGES_2.4.17 includes only
those changes introduced since the prior 2.4 release.  A summary of all 
of the security vulnerabilities addressed in this and earlier releases 
is available:

 http://httpd.apache.org/security/vulnerabilities_24.html

This release requires the Apache Portable Runtime (APR) version 1.5.x
and APR-Util version 1.5.x. The APR libraries must be upgraded for all
features of httpd to operate correctly.

This release builds on and extends the Apache 2.2 API.  Modules written
for Apache 2.2 will need to be recompiled in order to run with Apache
2.4, and require minimal or no source code changes.

 http://svn.apache.org/repos/asf/httpd/httpd/trunk/VERSIONING

When upgrading or installing this version of Apache, please bear in mind
that if you intend to use Apache with one of the threaded MPMs (other
than the Prefork MPM), you must ensure that any modules you will be
using (and the libraries they depend on) are thread-safe.


From dev-return-84271-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Wed Oct 14 12:37:19 2015
Return-Path: <dev-return-84271-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id E656418F79
	for <apmail-httpd-dev-archive@www.apache.org>; Wed, 14 Oct 2015 12:37:19 +0000 (UTC)
Received: (qmail 49289 invoked by uid 500); 14 Oct 2015 12:37:19 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 49209 invoked by uid 500); 14 Oct 2015 12:37:19 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 49199 invoked by uid 99); 14 Oct 2015 12:37:19 -0000
Received: from Unknown (HELO spamd2-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 14 Oct 2015 12:37:19 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd2-us-west.apache.org (ASF Mail Server at spamd2-us-west.apache.org) with ESMTP id D52431A29FE
	for <dev@httpd.apache.org>; Wed, 14 Oct 2015 12:37:18 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd2-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.011
X-Spam-Level:
X-Spam-Status: No, score=-0.011 tagged_above=-999 required=6.31
	tests=[SPF_PASS=-0.001, T_RP_MATCHES_RCVD=-0.01] autolearn=disabled
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd2-us-west.apache.org [10.40.0.9]) (amavisd-new, port 10024)
	with ESMTP id nj48d1itugOL for <dev@httpd.apache.org>;
	Wed, 14 Oct 2015 12:37:17 +0000 (UTC)
Received: from mail.greenbytes.de (mail.greenbytes.de [217.91.35.233])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id EB618206E8
	for <dev@httpd.apache.org>; Wed, 14 Oct 2015 12:37:16 +0000 (UTC)
Received: from [192.168.1.42] (unknown [5.10.171.186])
	(using TLSv1 with cipher ECDHE-RSA-AES256-SHA (256/256 bits))
	(Client did not present a certificate)
	by mail.greenbytes.de (Postfix) with ESMTPSA id 3C00C15A043B
	for <dev@httpd.apache.org>; Wed, 14 Oct 2015 14:37:10 +0200 (CEST)
From: Stefan Eissing <stefan.eissing@greenbytes.de>
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: quoted-printable
Subject: http2 tests
Message-Id: <F6FE5241-F149-41BF-9EBD-21A7DBD07336@greenbytes.de>
Date: Wed, 14 Oct 2015 14:37:09 +0200
To: dev@httpd.apache.org
Mime-Version: 1.0 (Mac OS X Mail 9.0 \(3094\))
X-Mailer: Apple Mail (2.3094)

Need some advice on how to expand our test framework. We had the problem =
that current test on 421 return codes failed as the current setup makes =
that depend on vhosts/other config interference. Undesirable.

Also, I am adding more RFC 7540 compliant behaviour which means =
mod_http2 will check TLS protocol and ciphers. For this I think =
mod_http2 needs its own host as I do not want to mess with SSL test =
setups that need to perform in various environments.

Any advice on how to add a test host (e.g. real port) to our test suite =
in the most compatible way?=20

Thanks!

//Stefan=

From dev-return-84272-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Wed Oct 14 12:56:05 2015
Return-Path: <dev-return-84272-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 5634618047
	for <apmail-httpd-dev-archive@www.apache.org>; Wed, 14 Oct 2015 12:56:05 +0000 (UTC)
Received: (qmail 86555 invoked by uid 500); 14 Oct 2015 12:56:04 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 86478 invoked by uid 500); 14 Oct 2015 12:56:04 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 86466 invoked by uid 99); 14 Oct 2015 12:56:04 -0000
Received: from Unknown (HELO spamd4-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 14 Oct 2015 12:56:04 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd4-us-west.apache.org (ASF Mail Server at spamd4-us-west.apache.org) with ESMTP id 64441C0257
	for <dev@httpd.apache.org>; Wed, 14 Oct 2015 12:56:04 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd4-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.12
X-Spam-Level:
X-Spam-Status: No, score=-0.12 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RCVD_IN_MSPIKE_H3=-0.01, RCVD_IN_MSPIKE_WL=-0.01, SPF_PASS=-0.001,
	URIBL_BLOCKED=0.001] autolearn=disabled
Authentication-Results: spamd4-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-us-west.apache.org ([10.40.0.8])
	by localhost (spamd4-us-west.apache.org [10.40.0.11]) (amavisd-new, port 10024)
	with ESMTP id NgkCLaEDZTUx for <dev@httpd.apache.org>;
	Wed, 14 Oct 2015 12:55:57 +0000 (UTC)
Received: from mail-ig0-f170.google.com (mail-ig0-f170.google.com [209.85.213.170])
	by mx1-us-west.apache.org (ASF Mail Server at mx1-us-west.apache.org) with ESMTPS id D3822237F2
	for <dev@httpd.apache.org>; Wed, 14 Oct 2015 12:55:56 +0000 (UTC)
Received: by igbkq10 with SMTP id kq10so111571029igb.0
        for <dev@httpd.apache.org>; Wed, 14 Oct 2015 05:55:56 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        bh=EJjEgq6Qau0DwJQiIGLb8X78y08yAhUjdANyJTpR6og=;
        b=frLMU4/E6z338MhI9NaYJJC+He2McNFJRzHYo+SsrYOUmqd0K0urLJrNQJeuHDkgES
         MBDVP4xhSz9uRMpHUQHiywyL2ANKLDr3t0PYsxnLEz0fe1xe2+aBJui9Ej/Q9qru1POI
         G1Wvzas6uW+59AF4Zks+oCIQpNKPgh4XFG9rYJ1r0n/hGBfMxWNb9FkmR1WLjTjN7Xad
         zjqXKkRMv896mK4tgCY24OBIfgfCsw2MlfBIeT5BtFdG42MBorf90zb/NheOtUOLpGS3
         a0d+vl0GmSyI0bL9ZNrcNsk/s4um42P93D9D2rU8Ry9xU23i9i7Ng8LmwHORGJqe0TS4
         gPJQ==
MIME-Version: 1.0
X-Received: by 10.51.17.39 with SMTP id gb7mr14046071igd.56.1444827356312;
 Wed, 14 Oct 2015 05:55:56 -0700 (PDT)
Received: by 10.64.25.3 with HTTP; Wed, 14 Oct 2015 05:55:56 -0700 (PDT)
In-Reply-To: <F6FE5241-F149-41BF-9EBD-21A7DBD07336@greenbytes.de>
References: <F6FE5241-F149-41BF-9EBD-21A7DBD07336@greenbytes.de>
Date: Wed, 14 Oct 2015 08:55:56 -0400
Message-ID: <CALK=YjMg5yxpSJiT1Gdh+_oN=gh44fLKXWVCcP09NQS+R38WxQ@mail.gmail.com>
Subject: Re: http2 tests
From: Eric Covener <covener@gmail.com>
To: Apache HTTP Server Development List <dev@httpd.apache.org>
Content-Type: text/plain; charset=UTF-8

On Wed, Oct 14, 2015 at 8:37 AM, Stefan Eissing
<stefan.eissing@greenbytes.de> wrote:
> Any advice on how to add a test host (e.g. real port) to our test suite in the most compatible way?

1426878 added an SSL vhost. It seems like there is a magic port
assignment the config-generator and client share info about .

From dev-return-84273-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Wed Oct 14 12:59:10 2015
Return-Path: <dev-return-84273-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 83D1418060
	for <apmail-httpd-dev-archive@www.apache.org>; Wed, 14 Oct 2015 12:59:10 +0000 (UTC)
Received: (qmail 3923 invoked by uid 500); 14 Oct 2015 12:59:09 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 3841 invoked by uid 500); 14 Oct 2015 12:59:09 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 3831 invoked by uid 99); 14 Oct 2015 12:59:09 -0000
Received: from Unknown (HELO spamd2-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 14 Oct 2015 12:59:09 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd2-us-west.apache.org (ASF Mail Server at spamd2-us-west.apache.org) with ESMTP id 7692B1A2A04
	for <dev@httpd.apache.org>; Wed, 14 Oct 2015 12:59:09 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd2-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 0
X-Spam-Level:
X-Spam-Status: No, score=0 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1] autolearn=disabled
Authentication-Results: spamd2-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=comcast.net
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd2-us-west.apache.org [10.40.0.9]) (amavisd-new, port 10024)
	with ESMTP id p1O2nttuuIwz for <dev@httpd.apache.org>;
	Wed, 14 Oct 2015 12:58:56 +0000 (UTC)
Received: from resqmta-ch2-04v.sys.comcast.net (resqmta-ch2-04v.sys.comcast.net [69.252.207.36])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id EF6954357F
	for <dev@httpd.apache.org>; Wed, 14 Oct 2015 12:58:55 +0000 (UTC)
Received: from resomta-ch2-12v.sys.comcast.net ([69.252.207.108])
	by resqmta-ch2-04v.sys.comcast.net with comcast
	id V0yD1r0042LrikM010yp0Z; Wed, 14 Oct 2015 12:58:49 +0000
Received: from [192.168.199.10] ([69.251.84.114])
	by resomta-ch2-12v.sys.comcast.net with comcast
	id V0yp1r0022U0RYt010yp6p; Wed, 14 Oct 2015 12:58:49 +0000
From: Jim Jagielski <jim@jaguNET.com>
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
Subject: Thx and merit
Message-Id: <EE2ED063-8F6F-4ABA-BE87-49F1751F8D54@jaguNET.com>
Date: Wed, 14 Oct 2015 08:58:48 -0400
To: httpd <dev@httpd.apache.org>
Mime-Version: 1.0 (Mac OS X Mail 8.2 \(2104\))
X-Mailer: Apple Mail (2.2104)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=comcast.net;
	s=q20140121; t=1444827529;
	bh=rTEFiKqnWjGcFMIrGxmbEMvZxdZK+fqqN/9CbDB2apA=;
	h=Received:Received:From:Content-Type:Subject:Message-Id:Date:To:
	 Mime-Version;
	b=mbXIYZZaS4WTd/VlUBS7KroUx/8ttDI7KLNqfG7RojQ1hirRUQrxz+f5Urksp52gP
	 LL0U/24elY9ZjjsGUXTplpZ6g1mqPhA8z2kWUiE5HDelIc4FrS1Z3eGnGvL8DVXVHU
	 wlnmTVdjvrye2+dAWXElOKPkIcvI/lWwH+qhLiLn8QepgNLFglTL+Q5PM3Px83no0I
	 RtbYg8tiAvpNUxXP4oYmpmDSwKtkWiGgo2gjn3z66MF20CQO61Pa26pis95oGk0dGr
	 m6bCye58KqYppi+ifBJ3Bw9atQBbqxe9Vhy4dBFBasQwCI14r9nRRIUzi+DGjYW4kC
	 7BRjC5ow35WPA==

The ASF is all about recognizing and rewarding merit. The whole
"Apache Way" started here, with this project, and httpd has always
been the sort of "guiding light" and example of how Apache projects
(should) work.

Inclusion of the HTTP/2 implementation for httpd, especially for
the 2.4.x branch, is a substantial feather in our cap. But we
would have been far behind the 8-ball if not for the funding by
the GSM Association on greenbytes GmbH's mod_h2 work, and for
the donation of that module to the ASF.

Once again, I'd like to thank them personally!

From dev-return-84274-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Wed Oct 14 14:02:54 2015
Return-Path: <dev-return-84274-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id B11541832D
	for <apmail-httpd-dev-archive@www.apache.org>; Wed, 14 Oct 2015 14:02:54 +0000 (UTC)
Received: (qmail 1977 invoked by uid 500); 14 Oct 2015 14:02:48 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 1890 invoked by uid 500); 14 Oct 2015 14:02:48 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 1879 invoked by uid 99); 14 Oct 2015 14:02:48 -0000
Received: from Unknown (HELO spamd4-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 14 Oct 2015 14:02:48 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd4-us-west.apache.org (ASF Mail Server at spamd4-us-west.apache.org) with ESMTP id A5EB2C084E
	for <dev@httpd.apache.org>; Wed, 14 Oct 2015 14:02:47 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd4-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 3.866
X-Spam-Level: ***
X-Spam-Status: No, score=3.866 tagged_above=-999 required=6.31
	tests=[FSL_HELO_NON_FQDN_1=0.001, KAM_LAZY_DOMAIN_SECURITY=1,
	KAM_LINKBAIT=2.5, RCVD_IN_SORBS_DUL=0.001, RDNS_DYNAMIC=0.363,
	URIBL_BLOCKED=0.001] autolearn=disabled
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd4-us-west.apache.org [10.40.0.11]) (amavisd-new, port 10024)
	with ESMTP id 07w19tPJQHPX for <dev@httpd.apache.org>;
	Wed, 14 Oct 2015 14:02:38 +0000 (UTC)
Received: from baldur (cpc36-newt30-2-0-cust898.19-3.cable.virginm.net [82.32.195.131])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTP id 1001325772
	for <dev@httpd.apache.org>; Wed, 14 Oct 2015 14:02:38 +0000 (UTC)
Received: from baldur (localhost [127.0.0.1])
	by baldur (Postfix) with ESMTP id 76C67C151D00
	for <dev@httpd.apache.org>; Wed, 14 Oct 2015 15:02:30 +0100 (BST)
Date: Wed, 14 Oct 2015 15:02:28 +0100
From: Nick Kew <nick@webthing.com>
To: dev@httpd.apache.org
Subject: Re: Thx and merit
Message-ID: <20151014150228.3507f1e9@baldur>
In-Reply-To: <EE2ED063-8F6F-4ABA-BE87-49F1751F8D54@jaguNET.com>
References: <EE2ED063-8F6F-4ABA-BE87-49F1751F8D54@jaguNET.com>
X-Mailer: Claws Mail 3.7.4 (GTK+ 2.20.1; i486-pc-linux-gnu)
Mime-Version: 1.0
Content-Type: text/plain; charset=US-ASCII
Content-Transfer-Encoding: 7bit

On Wed, 14 Oct 2015 08:58:48 -0400
Jim Jagielski <jim@jaguNET.com> wrote:


> Once again, I'd like to thank them personally!

+1 to all that, with one small addition.

Apache is about the individuals who participate.  So the
chief thanks go to Stefan, who is of course now one of us.
And of course honourable mentions to other developers
such as your good self.

-- 
Nick Kew

From dev-return-84275-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Wed Oct 14 14:03:26 2015
Return-Path: <dev-return-84275-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 7033418338
	for <apmail-httpd-dev-archive@www.apache.org>; Wed, 14 Oct 2015 14:03:26 +0000 (UTC)
Received: (qmail 3300 invoked by uid 500); 14 Oct 2015 14:03:25 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 3234 invoked by uid 500); 14 Oct 2015 14:03:25 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 3224 invoked by uid 99); 14 Oct 2015 14:03:25 -0000
Received: from Unknown (HELO spamd3-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 14 Oct 2015 14:03:25 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd3-us-west.apache.org (ASF Mail Server at spamd3-us-west.apache.org) with ESMTP id 65AB7180A5A
	for <dev@httpd.apache.org>; Wed, 14 Oct 2015 14:03:25 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd3-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.101
X-Spam-Level:
X-Spam-Status: No, score=-0.101 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RCVD_IN_MSPIKE_H2=-0.001, SPF_PASS=-0.001, URIBL_BLOCKED=0.001]
	autolearn=disabled
Authentication-Results: spamd3-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd3-us-west.apache.org [10.40.0.10]) (amavisd-new, port 10024)
	with ESMTP id li1UGY32gzDu for <dev@httpd.apache.org>;
	Wed, 14 Oct 2015 14:03:24 +0000 (UTC)
Received: from mail-io0-f174.google.com (mail-io0-f174.google.com [209.85.223.174])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id 9B66242B59
	for <dev@httpd.apache.org>; Wed, 14 Oct 2015 14:03:24 +0000 (UTC)
Received: by iow1 with SMTP id 1so56324394iow.1
        for <dev@httpd.apache.org>; Wed, 14 Oct 2015 07:03:24 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        bh=0wS21w2aQpP4n7hdaWTlhc4CltI10rZqzdL5sfgP2XM=;
        b=NQCxNy3DqLrPTSvHmt+f3PaxGvIuwW3hNZ/rA8JAPiM9pK0TYAFulXMBgI8LhSZ0Vl
         bQoVnHaLcOamkRzs3XGfNTtCuVEqKQ5Toyr6i6SrbeTKd1IxrQKEmv0Hxj/gIS7Z1Uz8
         q2ruNF8XO9NukHjjhdM+0W9uh8Z205fcmK8tkK7G2k87w+pL7xv7HG8GepBJQqlY3kzR
         fH0X+t66TfvNYgaw5/p+U5S9eMp5TMK3herq+k0XNXozVmVaUGEUoGtJWyitguJz2YnJ
         W0x1wxvMpalACAOioc+fnZ6edsu1VgEtdb5wB1ZlIM9Gix1b3OeoBsFGJ1GWFjeLQHPc
         SeRA==
MIME-Version: 1.0
X-Received: by 10.107.134.198 with SMTP id q67mr4106174ioi.90.1444831404237;
 Wed, 14 Oct 2015 07:03:24 -0700 (PDT)
Received: by 10.64.25.3 with HTTP; Wed, 14 Oct 2015 07:03:24 -0700 (PDT)
In-Reply-To: <EE2ED063-8F6F-4ABA-BE87-49F1751F8D54@jaguNET.com>
References: <EE2ED063-8F6F-4ABA-BE87-49F1751F8D54@jaguNET.com>
Date: Wed, 14 Oct 2015 10:03:24 -0400
Message-ID: <CALK=YjMRqvzoVbQBXDRwFvWv=jxnOO+oH6xfPvM3bC4DWpgfOQ@mail.gmail.com>
Subject: Re: Thx and merit
From: Eric Covener <covener@gmail.com>
To: Apache HTTP Server Development List <dev@httpd.apache.org>
Content-Type: text/plain; charset=UTF-8

On Wed, Oct 14, 2015 at 8:58 AM, Jim Jagielski <jim@jagunet.com> wrote:
> Inclusion of the HTTP/2 implementation for httpd, especially for
> the 2.4.x branch, is a substantial feather in our cap. But we
> would have been far behind the 8-ball if not for the funding by
> the GSM Association on greenbytes GmbH's mod_h2 work, and for
> the donation of that module to the ASF.

+1!

From dev-return-84276-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Wed Oct 14 14:05:59 2015
Return-Path: <dev-return-84276-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 33E1B1834F
	for <apmail-httpd-dev-archive@www.apache.org>; Wed, 14 Oct 2015 14:05:59 +0000 (UTC)
Received: (qmail 7191 invoked by uid 500); 14 Oct 2015 14:05:43 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 7128 invoked by uid 500); 14 Oct 2015 14:05:42 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 7119 invoked by uid 99); 14 Oct 2015 14:05:42 -0000
Received: from Unknown (HELO spamd2-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 14 Oct 2015 14:05:42 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd2-us-west.apache.org (ASF Mail Server at spamd2-us-west.apache.org) with ESMTP id 8121B1A2A14
	for <dev@httpd.apache.org>; Wed, 14 Oct 2015 14:05:42 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd2-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 3
X-Spam-Level: ***
X-Spam-Status: No, score=3 tagged_above=-999 required=6.31
	tests=[FROM_MISSP_EH_MATCH=1.999, KAM_LAZY_DOMAIN_SECURITY=1,
	T_FROM_MISSP_DKIM=0.01, T_RP_MATCHES_RCVD=-0.01, URIBL_BLOCKED=0.001]
	autolearn=disabled
Received: from mx1-us-west.apache.org ([10.40.0.8])
	by localhost (spamd2-us-west.apache.org [10.40.0.9]) (amavisd-new, port 10024)
	with ESMTP id LCAxC6hN6iKk for <dev@httpd.apache.org>;
	Wed, 14 Oct 2015 14:05:34 +0000 (UTC)
Received: from mailrelay1-us-west.apache.org (mailrelay1-us-west.apache.org [209.188.14.139])
	by mx1-us-west.apache.org (ASF Mail Server at mx1-us-west.apache.org) with ESMTP id 9198520758
	for <dev@httpd.apache.org>; Wed, 14 Oct 2015 14:05:34 +0000 (UTC)
Received: from pony-poc.apache.org (pony-poc.apache.org [195.154.156.166])
	by mailrelay1-us-west.apache.org (ASF Mail Server at mailrelay1-us-west.apache.org) with ESMTP id 12748E047F
	for <dev@httpd.apache.org>; Wed, 14 Oct 2015 14:05:34 +0000 (UTC)
Received: from localhost (localhost [127.0.0.1])
	by pony-poc.apache.org (ASF Mail Server at pony-poc.apache.org) with ESMTP id 5C3DF26010D
	for <dev@httpd.apache.org>; Wed, 14 Oct 2015 16:05:43 +0200 (CEST)
Subject: Re: Thx and merit
X-Mailer: LuaSocket 3.0-rc1
Date: Wed, 14 Oct 2015 14:05:43 -0000
x-ponymail-agent: PonyMail/0.1a
MIME-Version: 1.0
References: <EE2ED063-8F6F-4ABA-BE87-49F1751F8D54@jaguNET.com> 
From: "Daniel Gruno"<humbedooh@apache.org>
x-ponymail-sender: f85cc4d67b0b00a9017135e4201b9225b5053fac
Content-Type: text/plain; charset="iso-8859-1"
To: <dev@httpd.apache.org>
In-Reply-To: <EE2ED063-8F6F-4ABA-BE87-49F1751F8D54@jaguNET.com>
Message-ID: <pony-f85cc4d67b0b00a9017135e4201b9225b5053fac-481045ff5c11c8c50fbbea841537f7836a5f5484@dev.httpd.apache.org>

Indeed, +1!

With regards,
Daniel

On 10/14/2015, 2:58:48 PM, Jim Jagielski <jim@jaguNET.com> wrote: 
> The ASF is all about recognizing and rewarding merit. The whole
> "Apache Way" started here, with this project, and httpd has always
> been the sort of "guiding light" and example of how Apache projects
> (should) work.
> 
> Inclusion of the HTTP/2 implementation for httpd, especially for
> the 2.4.x branch, is a substantial feather in our cap. But we
> would have been far behind the 8-ball if not for the funding by
> the GSM Association on greenbytes GmbH's mod_h2 work, and for
> the donation of that module to the ASF.
> 
> Once again, I'd like to thank them personally!
> 
------
Sent via Pony Mail for dev@httpd.apache.org. 
View this email online at:
https://pony-poc.apache.org/list.html?dev@httpd.apache.org

From dev-return-84277-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Wed Oct 14 14:08:44 2015
Return-Path: <dev-return-84277-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 0335918371
	for <apmail-httpd-dev-archive@www.apache.org>; Wed, 14 Oct 2015 14:08:44 +0000 (UTC)
Received: (qmail 14164 invoked by uid 500); 14 Oct 2015 14:08:43 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 14085 invoked by uid 500); 14 Oct 2015 14:08:43 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 14075 invoked by uid 99); 14 Oct 2015 14:08:43 -0000
Received: from Unknown (HELO spamd4-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 14 Oct 2015 14:08:43 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd4-us-west.apache.org (ASF Mail Server at spamd4-us-west.apache.org) with ESMTP id ED865C0257
	for <dev@httpd.apache.org>; Wed, 14 Oct 2015 14:08:42 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd4-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 2.899
X-Spam-Level: **
X-Spam-Status: No, score=2.899 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	HTML_MESSAGE=3, RCVD_IN_MSPIKE_H2=-0.001, SPF_PASS=-0.001,
	URIBL_BLOCKED=0.001] autolearn=disabled
Authentication-Results: spamd4-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-us-west.apache.org ([10.40.0.8])
	by localhost (spamd4-us-west.apache.org [10.40.0.11]) (amavisd-new, port 10024)
	with ESMTP id FmEcpFAxzwYq for <dev@httpd.apache.org>;
	Wed, 14 Oct 2015 14:08:36 +0000 (UTC)
Received: from mail-io0-f174.google.com (mail-io0-f174.google.com [209.85.223.174])
	by mx1-us-west.apache.org (ASF Mail Server at mx1-us-west.apache.org) with ESMTPS id 3836F20758
	for <dev@httpd.apache.org>; Wed, 14 Oct 2015 14:08:36 +0000 (UTC)
Received: by iow1 with SMTP id 1so56515148iow.1
        for <dev@httpd.apache.org>; Wed, 14 Oct 2015 07:08:35 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        bh=IOzuh0zPKfkyAue1eT8f9k3fFdIplNKHoR7yS3DEuLA=;
        b=BGTsL6aTpzOCVgJZ3/0mQNoMC5Mz9MOc1OSYGifxMrt4trjnjuPOSiWWuKl9QOFYH+
         IvzR6BWu+yIUS0oBY0rzsMLidphABil8uK4ghd3IA76v9ZLi7wxIIhIqmXO0ItQ1eOZf
         Jk+KDygypIfMg/8T/MWRXogktHQV3OvZ31sUYatCcHk0OgK5YFLmLVhzkY5r0+BfDp9q
         4NwebTCPj1Mh22bPMMqbQrSiHnBLA4r3fHJ2MIJF+hePa9TsBgrrQA1SppHz2e8jYyj6
         CUr8JzMoLCQdQmIBk9+N0kXYoDuKqVb76QFh3LGfrm1C/PTNnk5lrgns1VcQgkLE88Xw
         w2qg==
MIME-Version: 1.0
X-Received: by 10.107.6.23 with SMTP id 23mr4633344iog.147.1444831715721; Wed,
 14 Oct 2015 07:08:35 -0700 (PDT)
Received: by 10.36.37.18 with HTTP; Wed, 14 Oct 2015 07:08:35 -0700 (PDT)
In-Reply-To: <EE2ED063-8F6F-4ABA-BE87-49F1751F8D54@jaguNET.com>
References: <EE2ED063-8F6F-4ABA-BE87-49F1751F8D54@jaguNET.com>
Date: Wed, 14 Oct 2015 10:08:35 -0400
Message-ID: <CAKUrXK7DvkWDRbGKSWWOtFas1SoAg9FtUZ-PyBjatwdZ=wFGNg@mail.gmail.com>
Subject: Re: Thx and merit
From: Jeff Trawick <trawick@gmail.com>
To: Apache HTTP Server Development List <dev@httpd.apache.org>
Content-Type: multipart/alternative; boundary=001a113f8e7e2d359e05221119ab

--001a113f8e7e2d359e05221119ab
Content-Type: text/plain; charset=UTF-8

On Wed, Oct 14, 2015 at 8:58 AM, Jim Jagielski <jim@jagunet.com> wrote:

> The ASF is all about recognizing and rewarding merit. The whole
> "Apache Way" started here, with this project, and httpd has always
> been the sort of "guiding light" and example of how Apache projects
> (should) work.
>
> Inclusion of the HTTP/2 implementation for httpd, especially for
> the 2.4.x branch, is a substantial feather in our cap. But we
> would have been far behind the 8-ball if not for the funding by
> the GSM Association on greenbytes GmbH's mod_h2 work, and for
> the donation of that module to the ASF.
>
> Once again, I'd like to thank them personally!
>

+1!

-- 
Born in Roswell... married an alien...
http://emptyhammock.com/

--001a113f8e7e2d359e05221119ab
Content-Type: text/html; charset=UTF-8
Content-Transfer-Encoding: quoted-printable

<div dir=3D"ltr"><div class=3D"gmail_extra"><div class=3D"gmail_quote">On W=
ed, Oct 14, 2015 at 8:58 AM, Jim Jagielski <span dir=3D"ltr">&lt;<a href=3D=
"mailto:jim@jagunet.com" target=3D"_blank">jim@jagunet.com</a>&gt;</span> w=
rote:<br><blockquote class=3D"gmail_quote" style=3D"margin:0 0 0 .8ex;borde=
r-left:1px #ccc solid;padding-left:1ex">The ASF is all about recognizing an=
d rewarding merit. The whole<br>
&quot;Apache Way&quot; started here, with this project, and httpd has alway=
s<br>
been the sort of &quot;guiding light&quot; and example of how Apache projec=
ts<br>
(should) work.<br>
<br>
Inclusion of the HTTP/2 implementation for httpd, especially for<br>
the 2.4.x branch, is a substantial feather in our cap. But we<br>
would have been far behind the 8-ball if not for the funding by<br>
the GSM Association on greenbytes GmbH&#39;s mod_h2 work, and for<br>
the donation of that module to the ASF.<br>
<br>
Once again, I&#39;d like to thank them personally!<br>
</blockquote></div><br>+1!<br clear=3D"all"><div><br></div>-- <br><div clas=
s=3D"gmail_signature"><div dir=3D"ltr">Born in Roswell... married an alien.=
..<br><a href=3D"http://emptyhammock.com/" target=3D"_blank">http://emptyha=
mmock.com/</a><div><br></div></div></div>
</div></div>

--001a113f8e7e2d359e05221119ab--

From dev-return-84278-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Wed Oct 14 14:10:35 2015
Return-Path: <dev-return-84278-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 4CFAD1838B
	for <apmail-httpd-dev-archive@www.apache.org>; Wed, 14 Oct 2015 14:10:35 +0000 (UTC)
Received: (qmail 17398 invoked by uid 500); 14 Oct 2015 14:10:34 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 17324 invoked by uid 500); 14 Oct 2015 14:10:34 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 17314 invoked by uid 99); 14 Oct 2015 14:10:34 -0000
Received: from Unknown (HELO spamd1-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 14 Oct 2015 14:10:34 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd1-us-west.apache.org (ASF Mail Server at spamd1-us-west.apache.org) with ESMTP id 0DC30C5F76
	for <dev@httpd.apache.org>; Wed, 14 Oct 2015 14:10:34 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd1-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 2.9
X-Spam-Level: **
X-Spam-Status: No, score=2.9 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	HTML_MESSAGE=3, MIME_QP_LONG_LINE=0.001, SPF_HELO_PASS=-0.001,
	SPF_PASS=-0.001, URIBL_BLOCKED=0.001] autolearn=disabled
Authentication-Results: spamd1-us-west.apache.org (amavisd-new);
	dkim=pass (1024-bit key) header.d=apachelounge.com
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd1-us-west.apache.org [10.40.0.7]) (amavisd-new, port 10024)
	with ESMTP id qlhmLJdN2LqA for <dev@httpd.apache.org>;
	Wed, 14 Oct 2015 14:10:27 +0000 (UTC)
Received: from land10web.com (land10web.com [80.101.236.247])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTP id 355E042B35
	for <dev@httpd.apache.org>; Wed, 14 Oct 2015 14:10:27 +0000 (UTC)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=apachelounge.com;
	s=default; t=1444831897;
	bh=QQKQytc7ld5jSKadsHkxvyH0tecokOB7a5Xt0cuwYKI=;
	h=From:To:Subject:Date;
	b=FAfTs6lGVyZMEuXEL446VyxQgS/Vnje1bUSUc+5OAlvRGrkOKYHwb46Z2D8VSQEXA
	 k4DV4kOf5rEtVuvThXJSAbFHLqwgvAriVpTpf+e5zCK0FFJTY1ZNTdmXkV2NbDvVTB
	 YcOYFIdizxYLYckkMfcYYvIUAjtj//E0inkKvzss=
X-Default-Received-SPF: pass (skip=forwardok (res=PASS)) x-ip-name=127.0.0.1;
From: Steffen <info@apachelounge.com>
To:  <dev@httpd.apache.org>
Subject: Re: Thx and merit
Date: Wed, 14 Oct 2015 16:11:29 +0200
Message-ID: <561e6291.5fc.1a20.6010@land10.nl>
MIME-Version: 1.0
Content-Type: multipart/alternative; boundary="----=_SW_26172_1444831889_mpa="
X-Originating-IP: 127.0.0.1
X-Mailer: SurgeWeb - Ajax Webmail Client

This is a multi-part message in MIME format.

------=_SW_26172_1444831889_mpa=
Content-Type: text/plain; charset=us-ascii; format=flowed


And credits to Tatsuhiro Tsujikawa for his excellent nghttp2 Library 
work.

Steffen


On Wednesday 14/10/2015 at 16:04, Nick Kew  wrote:
> On Wed, 14 Oct 2015 08:58:48 -0400
> Jim Jagielski <jim@jaguNET.com> wrote:
>
>
>>
>> Once again, I'd like to thank them personally!
>
> +1 to all that, with one small addition.
>
> Apache is about the individuals who participate.  So the
> chief thanks go to Stefan, who is of course now one of us.
> And of course honourable mentions to other developers
> such as your good self.
>
> --
> Nick Kew


------=_SW_26172_1444831889_mpa=
Content-Type: text/html; charset=utf-8
Content-Transfer-Encoding: quoted-printable

<html>
<head>
<style>
 .sw_message P{margin:0px;padding:0px;}
 .sw_message {FONT-SIZE: 12pt;FONT-FAMILY:Tahoma,Arial,Helvetica,sans-serif;background:white;}
 .sw_message blockquote{margin-left:5px;padding-left:5px;border-left:2px solid #144fae;color: #144fae;}
 .sw_message blockquote blockquote{border-left:2px solid #006312;color: #006312;}
 .sw_message blockquote blockquote blockquote{border-left:2px solid #8e5656;color: #8e5656;}
 .sw_message blockquote blockquote blockquote blockquote{border-left:2px solid #888;color: #888;}
</style>
</head>
<body class=3d"sw_message">
<div>And credits to Tatsuhiro Tsujikawa for his excellent nghttp2 Library wo=
rk.</div><div><br></div><div>Steffen</div><div>&nbsp;</div><div id=3d"editor=
_signature"></div><div>On Wednesday 14/10/2015 at 16:04, Nick Kew  wrote: </=
div><blockquote type=3d"cite">On Wed, 14 Oct 2015 08:58:48 -0400<br>Jim Jagi=
elski &lt;jim@jaguNET.com&gt; wrote:<br><br><br><blockquote type=3d"cite"> O=
nce again, I'd like to thank them personally!<br></blockquote><br>+1 to all =
that, with one small addition.<br><br>Apache is about the individuals who pa=
rticipate.  So the<br>chief thanks go to Stefan, who is of course now one of=
 us.<br>And of course honourable mentions to other developers<br>such as you=
r good self.<br><br>-- <br>Nick Kew<br></blockquote><br> 
</body></html>

------=_SW_26172_1444831889_mpa=--


From dev-return-84279-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Wed Oct 14 14:15:46 2015
Return-Path: <dev-return-84279-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 7EF21183CE
	for <apmail-httpd-dev-archive@www.apache.org>; Wed, 14 Oct 2015 14:15:46 +0000 (UTC)
Received: (qmail 37688 invoked by uid 500); 14 Oct 2015 14:15:41 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 37613 invoked by uid 500); 14 Oct 2015 14:15:41 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 37602 invoked by uid 99); 14 Oct 2015 14:15:41 -0000
Received: from Unknown (HELO spamd2-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 14 Oct 2015 14:15:41 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd2-us-west.apache.org (ASF Mail Server at spamd2-us-west.apache.org) with ESMTP id 913261A20C8
	for <dev@httpd.apache.org>; Wed, 14 Oct 2015 14:15:40 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd2-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 2.9
X-Spam-Level: **
X-Spam-Status: No, score=2.9 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	HTML_MESSAGE=3, SPF_PASS=-0.001, URIBL_BLOCKED=0.001]
	autolearn=disabled
Authentication-Results: spamd2-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd2-us-west.apache.org [10.40.0.9]) (amavisd-new, port 10024)
	with ESMTP id OFOaPD3Hoi-P for <dev@httpd.apache.org>;
	Wed, 14 Oct 2015 14:15:28 +0000 (UTC)
Received: from mail-io0-f182.google.com (mail-io0-f182.google.com [209.85.223.182])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id 06C702139D
	for <dev@httpd.apache.org>; Wed, 14 Oct 2015 14:15:28 +0000 (UTC)
Received: by iow1 with SMTP id 1so56760428iow.1
        for <dev@httpd.apache.org>; Wed, 14 Oct 2015 07:15:21 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        bh=7g5HCHseZPlTZ4B5rmAjIeqGbG+pDPTAl4VlCOyTlro=;
        b=ZRs1rms0O43U5E0bbhZ6N71kF5zBKJhDQB2QAqQWjYGctgIZLsfVqU80HEodLNfhFp
         pLPPGNIsRySt6mcUr7Sn6lDcLx80GItu6nWn/FoXH2dqYp/hYIwOHJeEUYKRrBPofZn2
         qSo96njpBKMJQKe4rf+Q4nt60A9i/2DqHDAmODqHkGpd/qPeyqpoM84NrGfKBtkb3GYV
         hF1/fpLDLe+1cjmT22tOGnQCOgjrnV5IijJeFHyrdOveo1DEfrh3V5NrlT62Bi+hDhU+
         GsCkA+TFApeUgJoOFuxl6r+lZwCevVjdRVGbt1KE4ZVAbM16BC9CHvABr0HoR25V3heV
         lGFA==
MIME-Version: 1.0
X-Received: by 10.107.33.198 with SMTP id h189mr4017600ioh.72.1444832121509;
 Wed, 14 Oct 2015 07:15:21 -0700 (PDT)
Received: by 10.36.37.18 with HTTP; Wed, 14 Oct 2015 07:15:21 -0700 (PDT)
In-Reply-To: <20151014150228.3507f1e9@baldur>
References: <EE2ED063-8F6F-4ABA-BE87-49F1751F8D54@jaguNET.com>
	<20151014150228.3507f1e9@baldur>
Date: Wed, 14 Oct 2015 10:15:21 -0400
Message-ID: <CAKUrXK5ARZNoQrVQEnSzPmoeGx6VGw1bUKus70mNgTO10m+hCQ@mail.gmail.com>
Subject: Re: Thx and merit
From: Jeff Trawick <trawick@gmail.com>
To: Apache HTTP Server Development List <dev@httpd.apache.org>
Content-Type: multipart/alternative; boundary=001a1140f06e5ce192052211316a

--001a1140f06e5ce192052211316a
Content-Type: text/plain; charset=UTF-8

On Wed, Oct 14, 2015 at 10:02 AM, Nick Kew <nick@webthing.com> wrote:

> On Wed, 14 Oct 2015 08:58:48 -0400
> Jim Jagielski <jim@jaguNET.com> wrote:
>
>
> > Once again, I'd like to thank them personally!
>
> +1 to all that, with one small addition.
>
> Apache is about the individuals who participate.  So the
> chief thanks go to Stefan, who is of course now one of us.
> And of course honourable mentions to other developers
> such as your good self.
>
> --
> Nick Kew
>

I almost hate to say this because I don't want to take anything away from
Stefan, but companies sponsoring work are essentially the people behind the
scenes that we never hear about who are open to or are in fact the driving
force for aligning business goals with development that can be shared with
everyone else, sometimes at the risk of having it blow up in their face if
somebody says the wrong thing or someone in the project can't separate
suspected motivation from assessment of utility.

-- 
Born in Roswell... married an alien...
http://emptyhammock.com/

--001a1140f06e5ce192052211316a
Content-Type: text/html; charset=UTF-8
Content-Transfer-Encoding: quoted-printable

<div dir=3D"ltr"><div class=3D"gmail_extra"><div class=3D"gmail_quote">On W=
ed, Oct 14, 2015 at 10:02 AM, Nick Kew <span dir=3D"ltr">&lt;<a href=3D"mai=
lto:nick@webthing.com" target=3D"_blank">nick@webthing.com</a>&gt;</span> w=
rote:<br><blockquote class=3D"gmail_quote" style=3D"margin:0 0 0 .8ex;borde=
r-left:1px #ccc solid;padding-left:1ex"><span class=3D"">On Wed, 14 Oct 201=
5 08:58:48 -0400<br>
Jim Jagielski &lt;jim@jaguNET.com&gt; wrote:<br>
<br>
<br>
&gt; Once again, I&#39;d like to thank them personally!<br>
<br>
</span>+1 to all that, with one small addition.<br>
<br>
Apache is about the individuals who participate.=C2=A0 So the<br>
chief thanks go to Stefan, who is of course now one of us.<br>
And of course honourable mentions to other developers<br>
such as your good self.<br>
<span class=3D"HOEnZb"><font color=3D"#888888"><br>
--<br>
Nick Kew<br>
</font></span></blockquote></div><br>I almost hate to say this because I do=
n&#39;t want to take anything away from Stefan, but companies sponsoring wo=
rk are essentially the people behind the scenes that we never hear about wh=
o are open to or are in fact the driving force for aligning business goals =
with development that can be shared with everyone else, sometimes at the ri=
sk of having it blow up in their face if somebody says the wrong thing or s=
omeone in the project can&#39;t separate suspected motivation from assessme=
nt of utility.<br clear=3D"all"><div><br></div>-- <br><div class=3D"gmail_s=
ignature"><div dir=3D"ltr">Born in Roswell... married an alien...<br><a hre=
f=3D"http://emptyhammock.com/" target=3D"_blank">http://emptyhammock.com/</=
a><div><br></div></div></div>
</div></div>

--001a1140f06e5ce192052211316a--

From dev-return-84280-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Wed Oct 14 14:27:54 2015
Return-Path: <dev-return-84280-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 1ACE41842A
	for <apmail-httpd-dev-archive@www.apache.org>; Wed, 14 Oct 2015 14:27:54 +0000 (UTC)
Received: (qmail 47717 invoked by uid 500); 14 Oct 2015 14:21:14 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 47643 invoked by uid 500); 14 Oct 2015 14:21:14 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 47633 invoked by uid 99); 14 Oct 2015 14:21:14 -0000
Received: from Unknown (HELO spamd3-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 14 Oct 2015 14:21:14 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd3-us-west.apache.org (ASF Mail Server at spamd3-us-west.apache.org) with ESMTP id 3ADB2180183
	for <dev@httpd.apache.org>; Wed, 14 Oct 2015 14:21:13 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd3-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.1
X-Spam-Level:
X-Spam-Status: No, score=-0.1 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	SPF_PASS=-0.001, URIBL_BLOCKED=0.001] autolearn=disabled
Authentication-Results: spamd3-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd3-us-west.apache.org [10.40.0.10]) (amavisd-new, port 10024)
	with ESMTP id bMIZE5AAc9lp for <dev@httpd.apache.org>;
	Wed, 14 Oct 2015 14:20:59 +0000 (UTC)
Received: from mail-qg0-f49.google.com (mail-qg0-f49.google.com [209.85.192.49])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id 42BA62139D
	for <dev@httpd.apache.org>; Wed, 14 Oct 2015 14:20:59 +0000 (UTC)
Received: by qgx61 with SMTP id 61so43712202qgx.3
        for <dev@httpd.apache.org>; Wed, 14 Oct 2015 07:20:52 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        bh=3w8+Nr/1zOPCCLvB1PdcVxQDRyCNX61JIUfJiCGu6WI=;
        b=bleKHER9/kDlFjdHAMcpAgKNJBA81tHZyjhBEx+sESfcId7Fc8KYOupkOBccUNiNBj
         5fwZ4fdwmbjGv84vjm+Y5gGMOTDZrcaD76xhqVFY6anKRJuHDp3+bM3mHni37A9QRvup
         HbjPk48P7cr3k+R+dZ4MMl8GYU2Hs/Ji79aL4DGYL3syJxE5mUUJvwqrUNiBzYU6Y/cU
         mnzr8Cu4Sc04eO6wzG4E6XflCECmRO9N1FZCh9KSOynj48w7ERPP7UG52ezygAZdqvXT
         xITTZqNf0pk4r7DlSnajq/MDss+HexcazjCda4WmUhcVvb3rw6iTjx0xhhRzS9748vKH
         n+GQ==
MIME-Version: 1.0
X-Received: by 10.140.131.198 with SMTP id 189mr4582285qhd.83.1444832452492;
 Wed, 14 Oct 2015 07:20:52 -0700 (PDT)
Received: by 10.55.156.213 with HTTP; Wed, 14 Oct 2015 07:20:52 -0700 (PDT)
In-Reply-To: <EE2ED063-8F6F-4ABA-BE87-49F1751F8D54@jaguNET.com>
References: <EE2ED063-8F6F-4ABA-BE87-49F1751F8D54@jaguNET.com>
Date: Wed, 14 Oct 2015 16:20:52 +0200
Message-ID: <CAKQ1sVMoSEXQXVmL8roAXMDvCmRJ_Bb0-=+A7Sr-w+-Ju86iQw@mail.gmail.com>
Subject: Re: Thx and merit
From: Yann Ylavic <ylavic.dev@gmail.com>
To: dev@httpd.apache.org
Content-Type: text/plain; charset=UTF-8

+1, thanks Stefan!

On Wed, Oct 14, 2015 at 2:58 PM, Jim Jagielski <jim@jagunet.com> wrote:
> The ASF is all about recognizing and rewarding merit. The whole
> "Apache Way" started here, with this project, and httpd has always
> been the sort of "guiding light" and example of how Apache projects
> (should) work.
>
> Inclusion of the HTTP/2 implementation for httpd, especially for
> the 2.4.x branch, is a substantial feather in our cap. But we
> would have been far behind the 8-ball if not for the funding by
> the GSM Association on greenbytes GmbH's mod_h2 work, and for
> the donation of that module to the ASF.
>
> Once again, I'd like to thank them personally!

From dev-return-84281-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Wed Oct 14 14:48:54 2015
Return-Path: <dev-return-84281-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 261F1184EC
	for <apmail-httpd-dev-archive@www.apache.org>; Wed, 14 Oct 2015 14:48:54 +0000 (UTC)
Received: (qmail 31536 invoked by uid 500); 14 Oct 2015 14:48:53 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 31474 invoked by uid 500); 14 Oct 2015 14:48:53 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 31464 invoked by uid 99); 14 Oct 2015 14:48:53 -0000
Received: from Unknown (HELO spamd1-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 14 Oct 2015 14:48:53 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd1-us-west.apache.org (ASF Mail Server at spamd1-us-west.apache.org) with ESMTP id 075FCC412E
	for <dev@httpd.apache.org>; Wed, 14 Oct 2015 14:48:53 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd1-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 0.653
X-Spam-Level:
X-Spam-Status: No, score=0.653 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, SPF_NEUTRAL=0.652,
	URIBL_BLOCKED=0.001] autolearn=disabled
Authentication-Results: spamd1-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=comcast.net
Received: from mx1-us-west.apache.org ([10.40.0.8])
	by localhost (spamd1-us-west.apache.org [10.40.0.7]) (amavisd-new, port 10024)
	with ESMTP id 8okKh9f_dy2q for <dev@httpd.apache.org>;
	Wed, 14 Oct 2015 14:48:41 +0000 (UTC)
Received: from resqmta-ch2-12v.sys.comcast.net (resqmta-ch2-12v.sys.comcast.net [69.252.207.44])
	by mx1-us-west.apache.org (ASF Mail Server at mx1-us-west.apache.org) with ESMTPS id 5DCA721650
	for <dev@httpd.apache.org>; Wed, 14 Oct 2015 14:48:41 +0000 (UTC)
Received: from resomta-ch2-09v.sys.comcast.net ([69.252.207.105])
	by resqmta-ch2-12v.sys.comcast.net with comcast
	id V2lt1r0052GyhjZ012oa9y; Wed, 14 Oct 2015 14:48:34 +0000
Received: from [192.168.199.10] ([69.251.84.114])
	by resomta-ch2-09v.sys.comcast.net with comcast
	id V2oZ1r00A2U0RYt012oZrR; Wed, 14 Oct 2015 14:48:34 +0000
Content-Type: text/plain; charset=us-ascii
Mime-Version: 1.0 (Mac OS X Mail 8.2 \(2104\))
Subject: Re: Thx and merit
From: Jim Jagielski <jim@jaguNET.com>
In-Reply-To: <20151014150228.3507f1e9@baldur>
Date: Wed, 14 Oct 2015 10:48:31 -0400
Content-Transfer-Encoding: 7bit
Message-Id: <4E7D8477-9B8E-4B4C-B74E-FBAFCFFD81B5@jaguNET.com>
References: <EE2ED063-8F6F-4ABA-BE87-49F1751F8D54@jaguNET.com> <20151014150228.3507f1e9@baldur>
To: dev@httpd.apache.org
X-Mailer: Apple Mail (2.2104)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=comcast.net;
	s=q20140121; t=1444834114;
	bh=dcyyyJvfWguFziVa4y1pS5/EPN667sOxr/FsZhwbYYs=;
	h=Received:Received:Content-Type:Mime-Version:Subject:From:Date:
	 Message-Id:To;
	b=bYUW4yMYxSS5QQyosc7kJwBq0rgLu0XUSf3+O+qG2KlbZWbjEwijnhzvGfRz8i6N7
	 M04SqaMw6O89h3MwWvL0fLmFiZIOfjpkCn+z+Azexwy1GhiJCjQv3mXqwoVAtkMwKD
	 iAAPRtW2S1ySsgFGuRScCRFhw2kbMNq6Ivi4pgaE6K5a/05jct0Ak+FBeSYHSgjMQc
	 9OdMqlVJeaRr8iFuXyASSVXaPMPWuDDkI5ewu8UmXSJunntucHI10j6oIoY+cLmvi9
	 tv2EWYR4U6TbAqm9JIXFBA5JgREKDeGXiJF9QxW/fNvVIjskpxy7AAw+FV5r2wFRMF
	 eYi1a75/yX9qQ==


> On Oct 14, 2015, at 10:02 AM, Nick Kew <nick@webthing.com> wrote:
> 
> On Wed, 14 Oct 2015 08:58:48 -0400
> Jim Jagielski <jim@jaguNET.com> wrote:
> 
> 
>> Once again, I'd like to thank them personally!
> 
> +1 to all that, with one small addition.
> 
> Apache is about the individuals who participate.  So the
> chief thanks go to Stefan, who is of course now one of us.

++1!


From dev-return-84282-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Wed Oct 14 14:55:02 2015
Return-Path: <dev-return-84282-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 7BC751853A
	for <apmail-httpd-dev-archive@www.apache.org>; Wed, 14 Oct 2015 14:55:02 +0000 (UTC)
Received: (qmail 51937 invoked by uid 500); 14 Oct 2015 14:55:02 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 51853 invoked by uid 500); 14 Oct 2015 14:55:02 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 51843 invoked by uid 99); 14 Oct 2015 14:55:02 -0000
Received: from Unknown (HELO spamd1-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 14 Oct 2015 14:55:02 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd1-us-west.apache.org (ASF Mail Server at spamd1-us-west.apache.org) with ESMTP id 7702FC4294
	for <dev@httpd.apache.org>; Wed, 14 Oct 2015 14:55:01 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd1-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.01
X-Spam-Level:
X-Spam-Status: No, score=-0.01 tagged_above=-999 required=6.31
	tests=[SPF_PASS=-0.001, T_RP_MATCHES_RCVD=-0.01, URIBL_BLOCKED=0.001]
	autolearn=disabled
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd1-us-west.apache.org [10.40.0.7]) (amavisd-new, port 10024)
	with ESMTP id bXqz7eYUs9Q4 for <dev@httpd.apache.org>;
	Wed, 14 Oct 2015 14:54:53 +0000 (UTC)
Received: from mail.greenbytes.de (mail.greenbytes.de [217.91.35.233])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id E6D4628FAC
	for <dev@httpd.apache.org>; Wed, 14 Oct 2015 14:54:51 +0000 (UTC)
Received: from [192.168.1.42] (unknown [5.10.171.186])
	(using TLSv1 with cipher ECDHE-RSA-AES256-SHA (256/256 bits))
	(Client did not present a certificate)
	by mail.greenbytes.de (Postfix) with ESMTPSA id B8C8515A0485;
	Wed, 14 Oct 2015 16:54:50 +0200 (CEST)
Content-Type: text/plain; charset=utf-8
Mime-Version: 1.0 (Mac OS X Mail 9.0 \(3094\))
Subject: Re: Thx and merit
From: Stefan Eissing <stefan.eissing@greenbytes.de>
In-Reply-To: <CAKQ1sVMoSEXQXVmL8roAXMDvCmRJ_Bb0-=+A7Sr-w+-Ju86iQw@mail.gmail.com>
Date: Wed, 14 Oct 2015 16:54:50 +0200
Cc: Dan Druta <dd5826@att.com>,
 Istvan Lajtos <ilajtos@gsma.com>,
 OSCAR DE DIOS GONZALEZ <oscar.gonzalezdedios@telefonica.com>,
 Reschke Julian <julian.reschke@greenbytes.de>,
 =?utf-8?Q?B=C3=B6ttcher_Martin?= <martin.boettcher@greenbytes.de>
Content-Transfer-Encoding: quoted-printable
Message-Id: <7709DF56-5A1F-4E31-A7BB-411171737C58@greenbytes.de>
References: <EE2ED063-8F6F-4ABA-BE87-49F1751F8D54@jaguNET.com> <CAKQ1sVMoSEXQXVmL8roAXMDvCmRJ_Bb0-=+A7Sr-w+-Ju86iQw@mail.gmail.com>
To: dev@httpd.apache.org
X-Mailer: Apple Mail (2.3094)

Thanks to everyone for the kind words. It has been my pleasure
to contribute to such a community as Apache and I plan on=20
continuing doing so as much as possible.=20

Many thanks to Jim, Eric, Yann, Rainer, Kaspar and all the
others that have made me welcome here right from the start and=20
who helped me settle in. It's a project with an immense history
and there is always something more to learn about it.

When Apache httpd now speaks HTTP/2, then it's mainly=20
Tatsuhiro Tsujikawa's work in nghttp2 that made this feasible.=20
Many thanks to his excellent work and his nice support!

As Jeff wrote: this all would not have happened if not for the=20
sponsoring of the GSMA and Telefonica. Particularly
Dan Druta and Istvan Lajtos have been driving the idea from the
start and Oscar Gonzalez accompanied the project in its execution=20
phase. Great work!

My employer, greenbytes, is also partly my company, so I could=20
thank myself. However my partners, Julian Reschke and Martin B=C3=B6ttcher=
,
also deserve thanks for supporting this endeavor.

We are but a very small company and it is not possible to sponsor
a full time person for a long duration. We will continue looking
for sponsors to do work in Apache. Such projects really give=20
the greatest worth for all parties involved as can be seen today.

Again, Thanks!

//Stefan

> Am 14.10.2015 um 16:20 schrieb Yann Ylavic <ylavic.dev@gmail.com>:
>=20
> +1, thanks Stefan!
>=20
> On Wed, Oct 14, 2015 at 2:58 PM, Jim Jagielski <jim@jagunet.com> =
wrote:
>> The ASF is all about recognizing and rewarding merit. The whole
>> "Apache Way" started here, with this project, and httpd has always
>> been the sort of "guiding light" and example of how Apache projects
>> (should) work.
>>=20
>> Inclusion of the HTTP/2 implementation for httpd, especially for
>> the 2.4.x branch, is a substantial feather in our cap. But we
>> would have been far behind the 8-ball if not for the funding by
>> the GSM Association on greenbytes GmbH's mod_h2 work, and for
>> the donation of that module to the ASF.
>>=20
>> Once again, I'd like to thank them personally!


From dev-return-84283-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Wed Oct 14 14:56:16 2015
Return-Path: <dev-return-84283-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id C478618553
	for <apmail-httpd-dev-archive@www.apache.org>; Wed, 14 Oct 2015 14:56:16 +0000 (UTC)
Received: (qmail 56151 invoked by uid 500); 14 Oct 2015 14:56:16 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 56078 invoked by uid 500); 14 Oct 2015 14:56:16 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 56067 invoked by uid 99); 14 Oct 2015 14:56:16 -0000
Received: from Unknown (HELO spamd4-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 14 Oct 2015 14:56:16 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd4-us-west.apache.org (ASF Mail Server at spamd4-us-west.apache.org) with ESMTP id 7DAC5C084E
	for <dev@httpd.apache.org>; Wed, 14 Oct 2015 14:56:15 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd4-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 1.492
X-Spam-Level: *
X-Spam-Status: No, score=1.492 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	KAM_ASCII_DIVIDERS=0.8, MIME_QP_LONG_LINE=0.001,
	UPPERCASE_50_75=0.791] autolearn=disabled
Authentication-Results: spamd4-us-west.apache.org (amavisd-new);
	dkim=pass (1024-bit key) header.d=gbiv.com
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd4-us-west.apache.org [10.40.0.11]) (amavisd-new, port 10024)
	with ESMTP id 2_tpq0-oyuFl for <dev@httpd.apache.org>;
	Wed, 14 Oct 2015 14:55:57 +0000 (UTC)
Received: from homiemail-a54.g.dreamhost.com (sub4.mail.dreamhost.com [69.163.253.135])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTP id E851821114
	for <dev@httpd.apache.org>; Wed, 14 Oct 2015 14:55:56 +0000 (UTC)
Received: from homiemail-a54.g.dreamhost.com (localhost [127.0.0.1])
	by homiemail-a54.g.dreamhost.com (Postfix) with ESMTP id 1B8114013062E
	for <dev@httpd.apache.org>; Wed, 14 Oct 2015 07:55:41 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha1; c=relaxed; d=gbiv.com; h=from
	:content-type:content-transfer-encoding:mime-version:subject
	:message-id:date:references:in-reply-to:to; s=gbiv.com; bh=vohYe
	VLWe5SzwyKw+ONjqH/m6f8=; b=a8+X4cCTS+zXg5ffu73BBCE786mrFDdfQHrCG
	OMf044pMeR3M+ZraxCadoXY9rwYYdpl8skb0fRdxT957W5TzCbUN6E4NRxe7az2d
	bbkplAH9pQXYvJIPbnr/bfVDxb1VOmVVUrSTME/oM8HCt5I9uDAwOClCDOpMFrEe
	Bp1wLM=
Received: from [192.168.1.7] (ip68-228-83-124.oc.oc.cox.net [68.228.83.124])
	(using TLSv1 with cipher ECDHE-RSA-AES256-SHA (256/256 bits))
	(No client certificate requested)
	(Authenticated sender: fielding@gbiv.com)
	by homiemail-a54.g.dreamhost.com (Postfix) with ESMTPSA id EA36040130622
	for <dev@httpd.apache.org>; Wed, 14 Oct 2015 07:55:40 -0700 (PDT)
From: "Roy T. Fielding" <fielding@gbiv.com>
Content-Type: text/plain;
	charset=us-ascii
Content-Transfer-Encoding: quoted-printable
Mime-Version: 1.0 (1.0)
Subject: Re: svn commit: r1708593 - in /httpd/httpd/trunk: docs/manual/mod/mod_http2.xml modules/http2/h2_config.c modules/http2/h2_config.h modules/http2/h2_conn.c modules/http2/h2_h2.c modules/http2/h2_h2.h modules/http2/h2_switch.c
Message-Id: <E9BCBCDC-3132-42C5-A6D5-ED200C832DC2@gbiv.com>
Date: Wed, 14 Oct 2015 07:55:39 -0700
References: <20151014121012.507DA3A043F@svn01-us-west.apache.org>
In-Reply-To: <20151014121012.507DA3A043F@svn01-us-west.apache.org>
To: dev@httpd.apache.org
X-Mailer: iPhone Mail (13A452)

Can you please choose a more specific directive name? Like "LimitTLSunderH2"=
.

We don't have switches for RFC compliance. We do have switches for stupid WG=
 political positions that contradict common sense and are not applicable to n=
on-Internet deployments.

....Roy


> On Oct 14, 2015, at 5:10 AM, icing@apache.org wrote:
>=20
> Author: icing
> Date: Wed Oct 14 12:10:11 2015
> New Revision: 1708593
>=20
> URL: http://svn.apache.org/viewvc?rev=3D1708593&view=3Drev
> Log:
> mod_http2: new directive H2Compliance on/off, checking TLS protocol and ci=
pher against RFC7540
>=20
> Modified:
>    httpd/httpd/trunk/docs/manual/mod/mod_http2.xml
>    httpd/httpd/trunk/modules/http2/h2_config.c
>    httpd/httpd/trunk/modules/http2/h2_config.h
>    httpd/httpd/trunk/modules/http2/h2_conn.c
>    httpd/httpd/trunk/modules/http2/h2_h2.c
>    httpd/httpd/trunk/modules/http2/h2_h2.h
>    httpd/httpd/trunk/modules/http2/h2_switch.c
>=20
> Modified: httpd/httpd/trunk/docs/manual/mod/mod_http2.xml
> URL: http://svn.apache.org/viewvc/httpd/httpd/trunk/docs/manual/mod/mod_ht=
tp2.xml?rev=3D1708593&r1=3D1708592&r2=3D1708593&view=3Ddiff
> =3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D
> --- httpd/httpd/trunk/docs/manual/mod/mod_http2.xml (original)
> +++ httpd/httpd/trunk/docs/manual/mod/mod_http2.xml Wed Oct 14 12:10:11 20=
15
> @@ -74,11 +74,11 @@
>                 Direct communication means that if the first bytes receive=
d by the=20
>                 server on a connection match the HTTP/2 preamble, the HTTP=
/2
>                 protocol is switched to immediately without further negoti=
ation.
> -                This mode falls outside the RFC 7540 but has become widel=
y implemented
> -                on cleartext ports as it is very convenient for developme=
nt and testing.=20
> +                This mode is defined in RFC 7540 for the cleartext (h2c) c=
ase. Its
> +                use on TLS connections is not allowed by the standard.
>             </p>
>             <p>
> -                Since this detection implies that the client will send da=
ta on
> +                Since this detection requires that the client will send d=
ata on
>                 new connection immediately, direct HTTP/2 mode is disabled=
 by
>                 default.
>             </p>
>=20
> Modified: httpd/httpd/trunk/modules/http2/h2_config.c
> URL: http://svn.apache.org/viewvc/httpd/httpd/trunk/modules/http2/h2_confi=
g.c?rev=3D1708593&r1=3D1708592&r2=3D1708593&view=3Ddiff
> =3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D
> --- httpd/httpd/trunk/modules/http2/h2_config.c (original)
> +++ httpd/httpd/trunk/modules/http2/h2_config.c Wed Oct 14 12:10:11 2015
> @@ -49,6 +49,7 @@ static h2_config defconf =3D {
>     0,                /* serialize headers */
>     0,                /* h2 direct mode */
>     -1,               /* # session extra files */
> +    1,                /* rfc 7540 compliance */
> };
>=20
> static int files_per_session =3D 0;
> @@ -100,6 +101,7 @@ static void *h2_config_create(apr_pool_t
>     conf->serialize_headers    =3D DEF_VAL;
>     conf->h2_direct            =3D DEF_VAL;
>     conf->session_extra_files  =3D DEF_VAL;
> +    conf->rfc_compliance       =3D DEF_VAL;
>     return conf;
> }
>=20
> @@ -138,6 +140,7 @@ void *h2_config_merge(apr_pool_t *pool,
>     n->serialize_headers =3D H2_CONFIG_GET(add, base, serialize_headers);
>     n->h2_direct      =3D H2_CONFIG_GET(add, base, h2_direct);
>     n->session_extra_files =3D H2_CONFIG_GET(add, base, session_extra_file=
s);
> +    n->rfc_compliance =3D H2_CONFIG_GET(add, base, rfc_compliance);
>=20
>     return n;
> }
> @@ -162,6 +165,8 @@ int h2_config_geti(h2_config *conf, h2_c
>             return H2_CONFIG_GET(conf, &defconf, alt_svc_max_age);
>         case H2_CONF_SER_HEADERS:
>             return H2_CONFIG_GET(conf, &defconf, serialize_headers);
> +        case H2_CONF_COMPLIANCE:
> +            return H2_CONFIG_GET(conf, &defconf, rfc_compliance);
>         case H2_CONF_DIRECT:
>             return H2_CONFIG_GET(conf, &defconf, h2_direct);
>         case H2_CONF_SESSION_FILES:
> @@ -332,8 +337,25 @@ static const char *h2_conf_set_direct(cm
>     return "value must be On or Off";
> }
>=20
> -#define AP_END_CMD     AP_INIT_TAKE1(NULL, NULL, NULL, RSRC_CONF, NULL)
> +static const char *h2_conf_set_compliance(cmd_parms *parms,
> +                                          void *arg, const char *value)
> +{
> +    h2_config *cfg =3D h2_config_sget(parms->server);
> +    if (!strcasecmp(value, "On")) {
> +        cfg->rfc_compliance =3D 1;
> +        return NULL;
> +    }
> +    else if (!strcasecmp(value, "Off")) {
> +        cfg->rfc_compliance =3D 0;
> +        return NULL;
> +    }
> +   =20
> +    (void)arg;
> +    return "value must be On or Off";
> +}
> +
>=20
> +#define AP_END_CMD     AP_INIT_TAKE1(NULL, NULL, NULL, RSRC_CONF, NULL)
>=20
> const command_rec h2_cmds[] =3D {
>     AP_INIT_TAKE1("H2MaxSessionStreams", h2_conf_set_max_streams, NULL,
> @@ -354,6 +376,8 @@ const command_rec h2_cmds[] =3D {
>                   RSRC_CONF, "set the maximum age (in seconds) that client=
 can rely on alt-svc information"),
>     AP_INIT_TAKE1("H2SerializeHeaders", h2_conf_set_serialize_headers, NUL=
L,
>                   RSRC_CONF, "on to enable header serialization for compat=
ibility"),
> +    AP_INIT_TAKE1("H2Compliance", h2_conf_set_compliance, NULL,
> +                  RSRC_CONF, "off to disable strict compliance to RFC 754=
0"),
>     AP_INIT_TAKE1("H2Direct", h2_conf_set_direct, NULL,
>                   RSRC_CONF, "on to enable direct HTTP/2 mode"),
>     AP_INIT_TAKE1("H2SessionExtraFiles", h2_conf_set_session_extra_files, N=
ULL,
>=20
> Modified: httpd/httpd/trunk/modules/http2/h2_config.h
> URL: http://svn.apache.org/viewvc/httpd/httpd/trunk/modules/http2/h2_confi=
g.h?rev=3D1708593&r1=3D1708592&r2=3D1708593&view=3Ddiff
> =3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D
> --- httpd/httpd/trunk/modules/http2/h2_config.h (original)
> +++ httpd/httpd/trunk/modules/http2/h2_config.h Wed Oct 14 12:10:11 2015
> @@ -34,6 +34,7 @@ typedef enum {
>     H2_CONF_SER_HEADERS,
>     H2_CONF_DIRECT,
>     H2_CONF_SESSION_FILES,
> +    H2_CONF_COMPLIANCE,
> } h2_config_var_t;
>=20
> /* Apache httpd module configuration for h2. */
> @@ -51,6 +52,7 @@ typedef struct h2_config {
>                                      processing, better compatibility */
>     int h2_direct;                /* if mod_h2 is active directly */
>     int session_extra_files;      /* # of extra files a session may keep o=
pen */ =20
> +    int rfc_compliance;           /* Comply with all aspects of RFC 7540 *=
/ =20
> } h2_config;
>=20
>=20
>=20
> Modified: httpd/httpd/trunk/modules/http2/h2_conn.c
> URL: http://svn.apache.org/viewvc/httpd/httpd/trunk/modules/http2/h2_conn.=
c?rev=3D1708593&r1=3D1708592&r2=3D1708593&view=3Ddiff
> =3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D
> --- httpd/httpd/trunk/modules/http2/h2_conn.c (original)
> +++ httpd/httpd/trunk/modules/http2/h2_conn.c Wed Oct 14 12:10:11 2015
> @@ -32,6 +32,7 @@
> #include "h2_session.h"
> #include "h2_stream.h"
> #include "h2_stream_set.h"
> +#include "h2_h2.h"
> #include "h2_task.h"
> #include "h2_worker.h"
> #include "h2_workers.h"
> @@ -177,6 +178,11 @@ apr_status_t h2_conn_main(conn_rec *c)
>         return APR_EGENERAL;
>     }
>=20
> +    if (!h2_is_security_compliant(c, 1)) {
> +        nghttp2_submit_goaway(session->ngh2, NGHTTP2_FLAG_NONE, 0,
> +                              NGHTTP2_INADEQUATE_SECURITY, NULL, 0);
> +    }=20
> +
>     status =3D h2_session_process(session);
>=20
>     /* Make sure this connection gets closed properly. */
>=20
> Modified: httpd/httpd/trunk/modules/http2/h2_h2.c
> URL: http://svn.apache.org/viewvc/httpd/httpd/trunk/modules/http2/h2_h2.c?=
rev=3D1708593&r1=3D1708592&r2=3D1708593&view=3Ddiff
> =3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D
> --- httpd/httpd/trunk/modules/http2/h2_h2.c (original)
> +++ httpd/httpd/trunk/modules/http2/h2_h2.c Wed Oct 14 12:10:11 2015
> @@ -54,6 +54,354 @@ APR_DECLARE_OPTIONAL_FN(int, ssl_is_http
> static int (*opt_ssl_engine_disable)(conn_rec*);
> static int (*opt_ssl_is_https)(conn_rec*);
> /*************************************************************************=
******
> + * SSL var lookup
> + */
> +APR_DECLARE_OPTIONAL_FN(char *, ssl_var_lookup,
> +                        (apr_pool_t *, server_rec *,
> +                         conn_rec *, request_rec *,
> +                         char *));
> +static char *(*opt_ssl_var_lookup)(apr_pool_t *, server_rec *,
> +                                   conn_rec *, request_rec *,
> +                                   char *);
> +
> +/************************************************************************=
*******
> + * Check connection security requirements of RFC 7540
> + */
> +
> +/*
> + * Black Listed Ciphers from RFC 7549 Appendix A
> + *
> + */
> +static const char *RFC7540_names[] =3D {
> +    /* ciphers with NULL encrpytion */
> +    "NULL-MD5",                         /* TLS_NULL_WITH_NULL_NULL */
> +    /* same */                          /* TLS_RSA_WITH_NULL_MD5 */
> +    "NULL-SHA",                         /* TLS_RSA_WITH_NULL_SHA */
> +    "NULL-SHA256",                      /* TLS_RSA_WITH_NULL_SHA256 */
> +    "PSK-NULL-SHA",                     /* TLS_PSK_WITH_NULL_SHA */
> +    "DHE-PSK-NULL-SHA",                 /* TLS_DHE_PSK_WITH_NULL_SHA */
> +    "RSA-PSK-NULL-SHA",                 /* TLS_RSA_PSK_WITH_NULL_SHA */
> +    "PSK-NULL-SHA256",                  /* TLS_PSK_WITH_NULL_SHA256 */
> +    "PSK-NULL-SHA384",                  /* TLS_PSK_WITH_NULL_SHA384 */
> +    "DHE-PSK-NULL-SHA256",              /* TLS_DHE_PSK_WITH_NULL_SHA256 *=
/
> +    "DHE-PSK-NULL-SHA384",              /* TLS_DHE_PSK_WITH_NULL_SHA384 *=
/
> +    "RSA-PSK-NULL-SHA256",              /* TLS_RSA_PSK_WITH_NULL_SHA256 *=
/
> +    "RSA-PSK-NULL-SHA384",              /* TLS_RSA_PSK_WITH_NULL_SHA384 *=
/
> +    "ECDH-ECDSA-NULL-SHA",              /* TLS_ECDH_ECDSA_WITH_NULL_SHA *=
/
> +    "ECDHE-ECDSA-NULL-SHA",             /* TLS_ECDHE_ECDSA_WITH_NULL_SHA *=
/
> +    "ECDH-RSA-NULL-SHA",                /* TLS_ECDH_RSA_WITH_NULL_SHA */
> +    "ECDHE-RSA-NULL-SHA",               /* TLS_ECDHE_RSA_WITH_NULL_SHA */=

> +    "AECDH-NULL-SHA",                   /* TLS_ECDH_anon_WITH_NULL_SHA */=

> +    "ECDHE-PSK-NULL-SHA",               /* TLS_ECDHE_PSK_WITH_NULL_SHA */=

> +    "ECDHE-PSK-NULL-SHA256",            /* TLS_ECDHE_PSK_WITH_NULL_SHA256=
 */
> +    "ECDHE-PSK-NULL-SHA384",            /* TLS_ECDHE_PSK_WITH_NULL_SHA384=
 */
> +   =20
> +    /* DES/3DES ciphers */
> +    "PSK-3DES-EDE-CBC-SHA",             /* TLS_PSK_WITH_3DES_EDE_CBC_SHA *=
/
> +    "DHE-PSK-3DES-EDE-CBC-SHA",         /* TLS_DHE_PSK_WITH_3DES_EDE_CBC_=
SHA */
> +    "RSA-PSK-3DES-EDE-CBC-SHA",         /* TLS_RSA_PSK_WITH_3DES_EDE_CBC_=
SHA */
> +    "ECDH-ECDSA-DES-CBC3-SHA",          /* TLS_ECDH_ECDSA_WITH_3DES_EDE_C=
BC_SHA */
> +    "ECDHE-ECDSA-DES-CBC3-SHA",         /* TLS_ECDHE_ECDSA_WITH_3DES_EDE_=
CBC_SHA */
> +    "ECDH-RSA-DES-CBC3-SHA",            /* TLS_ECDH_RSA_WITH_3DES_EDE_CBC=
_SHA */
> +    "ECDHE-RSA-DES-CBC3-SHA",           /* TLS_ECDHE_RSA_WITH_3DES_EDE_CB=
C_SHA */
> +    "AECDH-DES-CBC3-SHA",               /* TLS_ECDH_anon_WITH_3DES_EDE_CB=
C_SHA */
> +    "SRP-3DES-EDE-CBC-SHA",             /* TLS_SRP_SHA_WITH_3DES_EDE_CBC_=
SHA */
> +    "SRP-RSA-3DES-EDE-CBC-SHA",         /* TLS_SRP_SHA_RSA_WITH_3DES_EDE_=
CBC_SHA */
> +    "SRP-DSS-3DES-EDE-CBC-SHA",         /* TLS_SRP_SHA_DSS_WITH_3DES_EDE_=
CBC_SHA */
> +    "ECDHE-PSK-3DES-EDE-CBC-SHA",       /* TLS_ECDHE_PSK_WITH_3DES_EDE_CB=
C_SHA */
> +    "DES-CBC-SHA",                      /* TLS_RSA_WITH_DES_CBC_SHA */
> +    "DES-CBC3-SHA",                     /* TLS_RSA_WITH_3DES_EDE_CBC_SHA *=
/
> +    "DHE-DSS-DES-CBC3-SHA",             /* TLS_DHE_DSS_WITH_3DES_EDE_CBC_=
SHA */
> +    "DHE-RSA-DES-CBC-SHA",              /* TLS_DHE_RSA_WITH_DES_CBC_SHA *=
/
> +    "DHE-RSA-DES-CBC3-SHA",             /* TLS_DHE_RSA_WITH_3DES_EDE_CBC_=
SHA */
> +    "ADH-DES-CBC-SHA",                  /* TLS_DH_anon_WITH_DES_CBC_SHA *=
/
> +    "ADH-DES-CBC3-SHA",                 /* TLS_DH_anon_WITH_3DES_EDE_CBC_=
SHA */
> +    "EXP-DH-DSS-DES-CBC-SHA",           /* TLS_DH_DSS_EXPORT_WITH_DES40_C=
BC_SHA */
> +    "DH-DSS-DES-CBC-SHA",               /* TLS_DH_DSS_WITH_DES_CBC_SHA */=

> +    "DH-DSS-DES-CBC3-SHA",              /* TLS_DH_DSS_WITH_3DES_EDE_CBC_S=
HA */
> +    "EXP-DH-RSA-DES-CBC-SHA",           /* TLS_DH_RSA_EXPORT_WITH_DES40_C=
BC_SHA */
> +    "DH-RSA-DES-CBC-SHA",               /* TLS_DH_RSA_WITH_DES_CBC_SHA */=

> +    "DH-RSA-DES-CBC3-SHA",              /* TLS_DH_RSA_WITH_3DES_EDE_CBC_S=
HA */
> +
> +    /* blacklisted EXPORT ciphers */
> +    "EXP-RC4-MD5",                      /* TLS_RSA_EXPORT_WITH_RC4_40_MD5=
 */
> +    "EXP-RC2-CBC-MD5",                  /* TLS_RSA_EXPORT_WITH_RC2_CBC_40=
_MD5 */
> +    "EXP-DES-CBC-SHA",                  /* TLS_RSA_EXPORT_WITH_DES40_CBC_=
SHA */
> +    "EXP-DHE-DSS-DES-CBC-SHA",          /* TLS_DHE_DSS_EXPORT_WITH_DES40_=
CBC_SHA */
> +    "EXP-DHE-RSA-DES-CBC-SHA",          /* TLS_DHE_RSA_EXPORT_WITH_DES40_=
CBC_SHA */
> +    "EXP-ADH-DES-CBC-SHA",              /* TLS_DH_anon_EXPORT_WITH_DES40_=
CBC_SHA */
> +    "EXP-ADH-RC4-MD5",                  /* TLS_DH_anon_EXPORT_WITH_RC4_40=
_MD5 */
> +
> +    /* blacklisted RC4 encryption */
> +    "RC4-MD5",                          /* TLS_RSA_WITH_RC4_128_MD5 */
> +    "RC4-SHA",                          /* TLS_RSA_WITH_RC4_128_SHA */
> +    "ADH-RC4-MD5",                      /* TLS_DH_anon_WITH_RC4_128_MD5 *=
/
> +    "KRB5-RC4-SHA",                     /* TLS_KRB5_WITH_RC4_128_SHA */
> +    "KRB5-RC4-MD5",                     /* TLS_KRB5_WITH_RC4_128_MD5 */
> +    "EXP-KRB5-RC4-SHA",                 /* TLS_KRB5_EXPORT_WITH_RC4_40_SH=
A */
> +    "EXP-KRB5-RC4-MD5",                 /* TLS_KRB5_EXPORT_WITH_RC4_40_MD=
5 */
> +    "PSK-RC4-SHA",                      /* TLS_PSK_WITH_RC4_128_SHA */
> +    "DHE-PSK-RC4-SHA",                  /* TLS_DHE_PSK_WITH_RC4_128_SHA *=
/
> +    "RSA-PSK-RC4-SHA",                  /* TLS_RSA_PSK_WITH_RC4_128_SHA *=
/
> +    "ECDH-ECDSA-RC4-SHA",               /* TLS_ECDH_ECDSA_WITH_RC4_128_SH=
A */
> +    "ECDHE-ECDSA-RC4-SHA",              /* TLS_ECDHE_ECDSA_WITH_RC4_128_S=
HA */
> +    "ECDH-RSA-RC4-SHA",                 /* TLS_ECDH_RSA_WITH_RC4_128_SHA *=
/
> +    "ECDHE-RSA-RC4-SHA",                /* TLS_ECDHE_RSA_WITH_RC4_128_SHA=
 */
> +    "AECDH-RC4-SHA",                    /* TLS_ECDH_anon_WITH_RC4_128_SHA=
 */
> +    "ECDHE-PSK-RC4-SHA",                /* TLS_ECDHE_PSK_WITH_RC4_128_SHA=
 */
> +
> +    /* blacklisted AES128 encrpytion ciphers */
> +    "AES128-SHA256",                    /* TLS_RSA_WITH_AES_128_CBC_SHA *=
/
> +    "DH-DSS-AES128-SHA",                /* TLS_DH_DSS_WITH_AES_128_CBC_SH=
A */
> +    "DH-RSA-AES128-SHA",                /* TLS_DH_RSA_WITH_AES_128_CBC_SH=
A */
> +    "DHE-DSS-AES128-SHA",               /* TLS_DHE_DSS_WITH_AES_128_CBC_S=
HA */
> +    "DHE-RSA-AES128-SHA",               /* TLS_DHE_RSA_WITH_AES_128_CBC_S=
HA */
> +    "ADH-AES128-SHA",                   /* TLS_DH_anon_WITH_AES_128_CBC_S=
HA */
> +    "AES128-SHA256",                    /* TLS_RSA_WITH_AES_128_CBC_SHA25=
6 */
> +    "DH-DSS-AES128-SHA256",             /* TLS_DH_DSS_WITH_AES_128_CBC_SH=
A256 */
> +    "DH-RSA-AES128-SHA256",             /* TLS_DH_RSA_WITH_AES_128_CBC_SH=
A256 */
> +    "DHE-DSS-AES128-SHA256",            /* TLS_DHE_DSS_WITH_AES_128_CBC_S=
HA256 */
> +    "DHE-RSA-AES128-SHA256",            /* TLS_DHE_RSA_WITH_AES_128_CBC_S=
HA256 */
> +    "ECDH-ECDSA-AES128-SHA",            /* TLS_ECDH_ECDSA_WITH_AES_128_CB=
C_SHA */
> +    "ECDHE-ECDSA-AES128-SHA",           /* TLS_ECDHE_ECDSA_WITH_AES_128_C=
BC_SHA */
> +    "ECDH-RSA-AES128-SHA",              /* TLS_ECDH_RSA_WITH_AES_128_CBC_=
SHA */
> +    "ECDHE-RSA-AES128-SHA",             /* TLS_ECDHE_RSA_WITH_AES_128_CBC=
_SHA */
> +    "AECDH-AES128-SHA",                 /* TLS_ECDH_anon_WITH_AES_128_CBC=
_SHA */
> +    "ECDHE-ECDSA-AES128-SHA256",        /* TLS_ECDHE_ECDSA_WITH_AES_128_C=
BC_SHA256 */
> +    "ECDH-ECDSA-AES128-SHA256",         /* TLS_ECDH_ECDSA_WITH_AES_128_CB=
C_SHA256 */
> +    "ECDHE-RSA-AES128-SHA256",          /* TLS_ECDHE_RSA_WITH_AES_128_CBC=
_SHA256 */
> +    "ECDH-RSA-AES128-SHA256",           /* TLS_ECDH_RSA_WITH_AES_128_CBC_=
SHA256 */
> +    "ADH-AES128-SHA256",                /* TLS_DH_anon_WITH_AES_128_CBC_S=
HA256 */
> +    "PSK-AES128-CBC-SHA",               /* TLS_PSK_WITH_AES_128_CBC_SHA *=
/
> +    "DHE-PSK-AES128-CBC-SHA",           /* TLS_DHE_PSK_WITH_AES_128_CBC_S=
HA */
> +    "RSA-PSK-AES128-CBC-SHA",           /* TLS_RSA_PSK_WITH_AES_128_CBC_S=
HA */
> +    "PSK-AES128-CBC-SHA256",            /* TLS_PSK_WITH_AES_128_CBC_SHA25=
6 */
> +    "DHE-PSK-AES128-CBC-SHA256",        /* TLS_DHE_PSK_WITH_AES_128_CBC_S=
HA256 */
> +    "RSA-PSK-AES128-CBC-SHA256",        /* TLS_RSA_PSK_WITH_AES_128_CBC_S=
HA256 */
> +    "ECDHE-PSK-AES128-CBC-SHA",         /* TLS_ECDHE_PSK_WITH_AES_128_CBC=
_SHA */
> +    "ECDHE-PSK-AES128-CBC-SHA256",      /* TLS_ECDHE_PSK_WITH_AES_128_CBC=
_SHA256 */
> +    "AES128-CCM",                       /* TLS_RSA_WITH_AES_128_CCM */
> +    "AES128-CCM8",                      /* TLS_RSA_WITH_AES_128_CCM_8 */
> +    "PSK-AES128-CCM",                   /* TLS_PSK_WITH_AES_128_CCM */
> +    "PSK-AES128-CCM8",                  /* TLS_PSK_WITH_AES_128_CCM_8 */
> +    "AES128-GCM-SHA256",                /* TLS_RSA_WITH_AES_128_GCM_SHA25=
6 */
> +    "DH-RSA-AES128-GCM-SHA256",         /* TLS_DH_RSA_WITH_AES_128_GCM_SH=
A256 */
> +    "DH-DSS-AES128-GCM-SHA256",         /* TLS_DH_DSS_WITH_AES_128_GCM_SH=
A256 */
> +    "ADH-AES128-GCM-SHA256",            /* TLS_DH_anon_WITH_AES_128_GCM_S=
HA256 */
> +    "PSK-AES128-GCM-SHA256",            /* TLS_PSK_WITH_AES_128_GCM_SHA25=
6 */
> +    "RSA-PSK-AES128-GCM-SHA256",        /* TLS_RSA_PSK_WITH_AES_128_GCM_S=
HA256 */
> +    "ECDH-ECDSA-AES128-GCM-SHA256",     /* TLS_ECDH_ECDSA_WITH_AES_128_GC=
M_SHA256 */
> +    "ECDH-RSA-AES128-GCM-SHA256",       /* TLS_ECDH_RSA_WITH_AES_128_GCM_=
SHA256 */
> +    "SRP-AES-128-CBC-SHA",              /* TLS_SRP_SHA_WITH_AES_128_CBC_S=
HA */
> +    "SRP-RSA-AES-128-CBC-SHA",          /* TLS_SRP_SHA_RSA_WITH_AES_128_C=
BC_SHA */
> +    "SRP-DSS-AES-128-CBC-SHA",          /* TLS_SRP_SHA_DSS_WITH_AES_128_C=
BC_SHA */
> +   =20
> +    /* blacklisted AES256 encrpytion ciphers */
> +    "AES256-SHA",                       /* TLS_RSA_WITH_AES_256_CBC_SHA *=
/
> +    "DH-DSS-AES256-SHA",                /* TLS_DH_DSS_WITH_AES_256_CBC_SH=
A */
> +    "DH-RSA-AES256-SHA",                /* TLS_DH_RSA_WITH_AES_256_CBC_SH=
A */
> +    "DHE-DSS-AES256-SHA",               /* TLS_DHE_DSS_WITH_AES_256_CBC_S=
HA */
> +    "DHE-RSA-AES256-SHA",               /* TLS_DHE_RSA_WITH_AES_256_CBC_S=
HA */
> +    "ADH-AES256-SHA",                   /* TLS_DH_anon_WITH_AES_256_CBC_S=
HA */
> +    "AES256-SHA256",                    /* TLS_RSA_WITH_AES_256_CBC_SHA25=
6 */
> +    "DH-DSS-AES256-SHA256",             /* TLS_DH_DSS_WITH_AES_256_CBC_SH=
A256 */
> +    "DH-RSA-AES256-SHA256",             /* TLS_DH_RSA_WITH_AES_256_CBC_SH=
A256 */
> +    "DHE-DSS-AES256-SHA256",            /* TLS_DHE_DSS_WITH_AES_256_CBC_S=
HA256 */
> +    "DHE-RSA-AES256-SHA256",            /* TLS_DHE_RSA_WITH_AES_256_CBC_S=
HA256 */
> +    "ADH-AES256-SHA256",                /* TLS_DH_anon_WITH_AES_256_CBC_S=
HA256 */
> +    "ECDH-ECDSA-AES256-SHA",            /* TLS_ECDH_ECDSA_WITH_AES_256_CB=
C_SHA */
> +    "ECDHE-ECDSA-AES256-SHA",           /* TLS_ECDHE_ECDSA_WITH_AES_256_C=
BC_SHA */
> +    "ECDH-RSA-AES256-SHA",              /* TLS_ECDH_RSA_WITH_AES_256_CBC_=
SHA */
> +    "ECDHE-RSA-AES256-SHA",             /* TLS_ECDHE_RSA_WITH_AES_256_CBC=
_SHA */
> +    "AECDH-AES256-SHA",                 /* TLS_ECDH_anon_WITH_AES_256_CBC=
_SHA */
> +    "ECDHE-ECDSA-AES256-SHA384",        /* TLS_ECDHE_ECDSA_WITH_AES_256_C=
BC_SHA384 */
> +    "ECDH-ECDSA-AES256-SHA384",         /* TLS_ECDH_ECDSA_WITH_AES_256_CB=
C_SHA384 */
> +    "ECDHE-RSA-AES256-SHA384",          /* TLS_ECDHE_RSA_WITH_AES_256_CBC=
_SHA384 */
> +    "ECDH-RSA-AES256-SHA384",           /* TLS_ECDH_RSA_WITH_AES_256_CBC_=
SHA384 */
> +    "PSK-AES256-CBC-SHA",               /* TLS_PSK_WITH_AES_256_CBC_SHA *=
/
> +    "DHE-PSK-AES256-CBC-SHA",           /* TLS_DHE_PSK_WITH_AES_256_CBC_S=
HA */
> +    "RSA-PSK-AES256-CBC-SHA",           /* TLS_RSA_PSK_WITH_AES_256_CBC_S=
HA */
> +    "PSK-AES256-CBC-SHA384",            /* TLS_PSK_WITH_AES_256_CBC_SHA38=
4 */
> +    "DHE-PSK-AES256-CBC-SHA384",        /* TLS_DHE_PSK_WITH_AES_256_CBC_S=
HA384 */
> +    "RSA-PSK-AES256-CBC-SHA384",        /* TLS_RSA_PSK_WITH_AES_256_CBC_S=
HA384 */
> +    "ECDHE-PSK-AES256-CBC-SHA",         /* TLS_ECDHE_PSK_WITH_AES_256_CBC=
_SHA */
> +    "ECDHE-PSK-AES256-CBC-SHA384",      /* TLS_ECDHE_PSK_WITH_AES_256_CBC=
_SHA384 */
> +    "SRP-AES-256-CBC-SHA",              /* TLS_SRP_SHA_WITH_AES_256_CBC_S=
HA */
> +    "SRP-RSA-AES-256-CBC-SHA",          /* TLS_SRP_SHA_RSA_WITH_AES_256_C=
BC_SHA */
> +    "SRP-DSS-AES-256-CBC-SHA",          /* TLS_SRP_SHA_DSS_WITH_AES_256_C=
BC_SHA */
> +    "AES256-CCM",                       /* TLS_RSA_WITH_AES_256_CCM */
> +    "AES256-CCM8",                      /* TLS_RSA_WITH_AES_256_CCM_8 */
> +    "PSK-AES256-CCM",                   /* TLS_PSK_WITH_AES_256_CCM */
> +    "PSK-AES256-CCM8",                  /* TLS_PSK_WITH_AES_256_CCM_8 */
> +    "AES256-GCM-SHA384",                /* TLS_RSA_WITH_AES_256_GCM_SHA38=
4 */
> +    "DH-RSA-AES256-GCM-SHA384",         /* TLS_DH_RSA_WITH_AES_256_GCM_SH=
A384 */
> +    "DH-DSS-AES256-GCM-SHA384",         /* TLS_DH_DSS_WITH_AES_256_GCM_SH=
A384 */
> +    "ADH-AES256-GCM-SHA384",            /* TLS_DH_anon_WITH_AES_256_GCM_S=
HA384 */
> +    "PSK-AES256-GCM-SHA384",            /* TLS_PSK_WITH_AES_256_GCM_SHA38=
4 */
> +    "RSA-PSK-AES256-GCM-SHA384",        /* TLS_RSA_PSK_WITH_AES_256_GCM_S=
HA384 */
> +    "ECDH-ECDSA-AES256-GCM-SHA384",     /* TLS_ECDH_ECDSA_WITH_AES_256_GC=
M_SHA384 */
> +    "ECDH-RSA-AES256-GCM-SHA384",       /* TLS_ECDH_RSA_WITH_AES_256_GCM_=
SHA384 */
> +   =20
> +    /* blacklisted CAMELLIA128 encrpytion ciphers */
> +    "CAMELLIA128-SHA",                  /* TLS_RSA_WITH_CAMELLIA_128_CBC_=
SHA */
> +    "DH-DSS-CAMELLIA128-SHA",           /* TLS_DH_DSS_WITH_CAMELLIA_128_C=
BC_SHA */
> +    "DH-RSA-CAMELLIA128-SHA",           /* TLS_DH_RSA_WITH_CAMELLIA_128_C=
BC_SHA */
> +    "DHE-DSS-CAMELLIA128-SHA",          /* TLS_DHE_DSS_WITH_CAMELLIA_128_=
CBC_SHA */
> +    "DHE-RSA-CAMELLIA128-SHA",          /* TLS_DHE_RSA_WITH_CAMELLIA_128_=
CBC_SHA */
> +    "ADH-CAMELLIA128-SHA",              /* TLS_DH_anon_WITH_CAMELLIA_128_=
CBC_SHA */
> +    "ECDHE-ECDSA-CAMELLIA128-SHA256",   /* TLS_ECDHE_ECDSA_WITH_CAMELLIA_=
128_CBC_SHA256 */
> +    "ECDH-ECDSA-CAMELLIA128-SHA256",    /* TLS_ECDH_ECDSA_WITH_CAMELLIA_1=
28_CBC_SHA256 */
> +    "ECDHE-RSA-CAMELLIA128-SHA256",     /* TLS_ECDHE_RSA_WITH_CAMELLIA_12=
8_CBC_SHA256 */
> +    "ECDH-RSA-CAMELLIA128-SHA256",      /* TLS_ECDH_RSA_WITH_CAMELLIA_128=
_CBC_SHA256 */
> +    "PSK-CAMELLIA128-SHA256",           /* TLS_PSK_WITH_CAMELLIA_128_CBC_=
SHA256 */
> +    "DHE-PSK-CAMELLIA128-SHA256",       /* TLS_DHE_PSK_WITH_CAMELLIA_128_=
CBC_SHA256 */
> +    "RSA-PSK-CAMELLIA128-SHA256",       /* TLS_RSA_PSK_WITH_CAMELLIA_128_=
CBC_SHA256 */
> +    "ECDHE-PSK-CAMELLIA128-SHA256",     /* TLS_ECDHE_PSK_WITH_CAMELLIA_12=
8_CBC_SHA256 */
> +    "CAMELLIA128-GCM-SHA256",           /* TLS_RSA_WITH_CAMELLIA_128_GCM_=
SHA256 */
> +    "DH-RSA-CAMELLIA128-GCM-SHA256",    /* TLS_DH_RSA_WITH_CAMELLIA_128_G=
CM_SHA256 */
> +    "DH-DSS-CAMELLIA128-GCM-SHA256",    /* TLS_DH_DSS_WITH_CAMELLIA_128_G=
CM_SHA256 */
> +    "ADH-CAMELLIA128-GCM-SHA256",       /* TLS_DH_anon_WITH_CAMELLIA_128_=
GCM_SHA256 */
> +    "ECDH-ECDSA-CAMELLIA128-GCM-SHA256",/* TLS_ECDH_ECDSA_WITH_CAMELLIA_1=
28_GCM_SHA256 */
> +    "ECDH-RSA-CAMELLIA128-GCM-SHA256",  /* TLS_ECDH_RSA_WITH_CAMELLIA_128=
_GCM_SHA256 */
> +    "PSK-CAMELLIA128-GCM-SHA256",       /* TLS_PSK_WITH_CAMELLIA_128_GCM_=
SHA256 */
> +    "RSA-PSK-CAMELLIA128-GCM-SHA256",   /* TLS_RSA_PSK_WITH_CAMELLIA_128_=
GCM_SHA256 */
> +    "CAMELLIA128-SHA256",               /* TLS_RSA_WITH_CAMELLIA_128_CBC_=
SHA256 */
> +    "DH-DSS-CAMELLIA128-SHA256",        /* TLS_DH_DSS_WITH_CAMELLIA_128_C=
BC_SHA256 */
> +    "DH-RSA-CAMELLIA128-SHA256",        /* TLS_DH_RSA_WITH_CAMELLIA_128_C=
BC_SHA256 */
> +    "DHE-DSS-CAMELLIA128-SHA256",       /* TLS_DHE_DSS_WITH_CAMELLIA_128_=
CBC_SHA256 */
> +    "DHE-RSA-CAMELLIA128-SHA256",       /* TLS_DHE_RSA_WITH_CAMELLIA_128_=
CBC_SHA256 */
> +    "ADH-CAMELLIA128-SHA256",           /* TLS_DH_anon_WITH_CAMELLIA_128_=
CBC_SHA256 */
> +   =20
> +    /* blacklisted CAMELLIA256 encrpytion ciphers */
> +    "CAMELLIA256-SHA",                  /* TLS_RSA_WITH_CAMELLIA_256_CBC_=
SHA */
> +    "DH-RSA-CAMELLIA256-SHA",           /* TLS_DH_RSA_WITH_CAMELLIA_256_C=
BC_SHA */
> +    "DH-DSS-CAMELLIA256-SHA",           /* TLS_DH_DSS_WITH_CAMELLIA_256_C=
BC_SHA */
> +    "DHE-DSS-CAMELLIA256-SHA",          /* TLS_DHE_DSS_WITH_CAMELLIA_256_=
CBC_SHA */
> +    "DHE-RSA-CAMELLIA256-SHA",          /* TLS_DHE_RSA_WITH_CAMELLIA_256_=
CBC_SHA */
> +    "ADH-CAMELLIA256-SHA",              /* TLS_DH_anon_WITH_CAMELLIA_256_=
CBC_SHA */
> +    "ECDHE-ECDSA-CAMELLIA256-SHA384",   /* TLS_ECDHE_ECDSA_WITH_CAMELLIA_=
256_CBC_SHA384 */
> +    "ECDH-ECDSA-CAMELLIA256-SHA384",    /* TLS_ECDH_ECDSA_WITH_CAMELLIA_2=
56_CBC_SHA384 */
> +    "ECDHE-RSA-CAMELLIA256-SHA384",     /* TLS_ECDHE_RSA_WITH_CAMELLIA_25=
6_CBC_SHA384 */
> +    "ECDH-RSA-CAMELLIA256-SHA384",      /* TLS_ECDH_RSA_WITH_CAMELLIA_256=
_CBC_SHA384 */
> +    "PSK-CAMELLIA256-SHA384",           /* TLS_PSK_WITH_CAMELLIA_256_CBC_=
SHA384 */
> +    "DHE-PSK-CAMELLIA256-SHA384",       /* TLS_DHE_PSK_WITH_CAMELLIA_256_=
CBC_SHA384 */
> +    "RSA-PSK-CAMELLIA256-SHA384",       /* TLS_RSA_PSK_WITH_CAMELLIA_256_=
CBC_SHA384 */
> +    "ECDHE-PSK-CAMELLIA256-SHA384",     /* TLS_ECDHE_PSK_WITH_CAMELLIA_25=
6_CBC_SHA384 */
> +    "CAMELLIA256-SHA256",               /* TLS_RSA_WITH_CAMELLIA_256_CBC_=
SHA256 */
> +    "DH-DSS-CAMELLIA256-SHA256",        /* TLS_DH_DSS_WITH_CAMELLIA_256_C=
BC_SHA256 */
> +    "DH-RSA-CAMELLIA256-SHA256",        /* TLS_DH_RSA_WITH_CAMELLIA_256_C=
BC_SHA256 */
> +    "DHE-DSS-CAMELLIA256-SHA256",       /* TLS_DHE_DSS_WITH_CAMELLIA_256_=
CBC_SHA256 */
> +    "DHE-RSA-CAMELLIA256-SHA256",       /* TLS_DHE_RSA_WITH_CAMELLIA_256_=
CBC_SHA256 */
> +    "ADH-CAMELLIA256-SHA256",           /* TLS_DH_anon_WITH_CAMELLIA_256_=
CBC_SHA256 */
> +    "CAMELLIA256-GCM-SHA384",           /* TLS_RSA_WITH_CAMELLIA_256_GCM_=
SHA384 */
> +    "DH-RSA-CAMELLIA256-GCM-SHA384",    /* TLS_DH_RSA_WITH_CAMELLIA_256_G=
CM_SHA384 */
> +    "DH-DSS-CAMELLIA256-GCM-SHA384",    /* TLS_DH_DSS_WITH_CAMELLIA_256_G=
CM_SHA384 */
> +    "ADH-CAMELLIA256-GCM-SHA384",       /* TLS_DH_anon_WITH_CAMELLIA_256_=
GCM_SHA384 */
> +    "ECDH-ECDSA-CAMELLIA256-GCM-SHA384",/* TLS_ECDH_ECDSA_WITH_CAMELLIA_2=
56_GCM_SHA384 */
> +    "ECDH-RSA-CAMELLIA256-GCM-SHA384",  /* TLS_ECDH_RSA_WITH_CAMELLIA_256=
_GCM_SHA384 */
> +    "PSK-CAMELLIA256-GCM-SHA384",       /* TLS_PSK_WITH_CAMELLIA_256_GCM_=
SHA384 */
> +    "RSA-PSK-CAMELLIA256-GCM-SHA384",   /* TLS_RSA_PSK_WITH_CAMELLIA_256_=
GCM_SHA384 */
> +   =20
> +    /* The blacklisted ARIA encrpytion ciphers */
> +    "ARIA128-SHA256",                   /* TLS_RSA_WITH_ARIA_128_CBC_SHA2=
56 */
> +    "ARIA256-SHA384",                   /* TLS_RSA_WITH_ARIA_256_CBC_SHA3=
84 */
> +    "DH-DSS-ARIA128-SHA256",            /* TLS_DH_DSS_WITH_ARIA_128_CBC_S=
HA256 */
> +    "DH-DSS-ARIA256-SHA384",            /* TLS_DH_DSS_WITH_ARIA_256_CBC_S=
HA384 */
> +    "DH-RSA-ARIA128-SHA256",            /* TLS_DH_RSA_WITH_ARIA_128_CBC_S=
HA256 */
> +    "DH-RSA-ARIA256-SHA384",            /* TLS_DH_RSA_WITH_ARIA_256_CBC_S=
HA384 */
> +    "DHE-DSS-ARIA128-SHA256",           /* TLS_DHE_DSS_WITH_ARIA_128_CBC_=
SHA256 */
> +    "DHE-DSS-ARIA256-SHA384",           /* TLS_DHE_DSS_WITH_ARIA_256_CBC_=
SHA384 */
> +    "DHE-RSA-ARIA128-SHA256",           /* TLS_DHE_RSA_WITH_ARIA_128_CBC_=
SHA256 */
> +    "DHE-RSA-ARIA256-SHA384",           /* TLS_DHE_RSA_WITH_ARIA_256_CBC_=
SHA384 */
> +    "ADH-ARIA128-SHA256",               /* TLS_DH_anon_WITH_ARIA_128_CBC_=
SHA256 */
> +    "ADH-ARIA256-SHA384",               /* TLS_DH_anon_WITH_ARIA_256_CBC_=
SHA384 */
> +    "ECDHE-ECDSA-ARIA128-SHA256",       /* TLS_ECDHE_ECDSA_WITH_ARIA_128_=
CBC_SHA256 */
> +    "ECDHE-ECDSA-ARIA256-SHA384",       /* TLS_ECDHE_ECDSA_WITH_ARIA_256_=
CBC_SHA384 */
> +    "ECDH-ECDSA-ARIA128-SHA256",        /* TLS_ECDH_ECDSA_WITH_ARIA_128_C=
BC_SHA256 */
> +    "ECDH-ECDSA-ARIA256-SHA384",        /* TLS_ECDH_ECDSA_WITH_ARIA_256_C=
BC_SHA384 */
> +    "ECDHE-RSA-ARIA128-SHA256",         /* TLS_ECDHE_RSA_WITH_ARIA_128_CB=
C_SHA256 */
> +    "ECDHE-RSA-ARIA256-SHA384",         /* TLS_ECDHE_RSA_WITH_ARIA_256_CB=
C_SHA384 */
> +    "ECDH-RSA-ARIA128-SHA256",          /* TLS_ECDH_RSA_WITH_ARIA_128_CBC=
_SHA256 */
> +    "ECDH-RSA-ARIA256-SHA384",          /* TLS_ECDH_RSA_WITH_ARIA_256_CBC=
_SHA384 */
> +    "ARIA128-GCM-SHA256",               /* TLS_RSA_WITH_ARIA_128_GCM_SHA2=
56 */
> +    "ARIA256-GCM-SHA384",               /* TLS_RSA_WITH_ARIA_256_GCM_SHA3=
84 */
> +    "DH-DSS-ARIA128-GCM-SHA256",        /* TLS_DH_DSS_WITH_ARIA_128_GCM_S=
HA256 */
> +    "DH-DSS-ARIA256-GCM-SHA384",        /* TLS_DH_DSS_WITH_ARIA_256_GCM_S=
HA384 */
> +    "DH-RSA-ARIA128-GCM-SHA256",        /* TLS_DH_RSA_WITH_ARIA_128_GCM_S=
HA256 */
> +    "DH-RSA-ARIA256-GCM-SHA384",        /* TLS_DH_RSA_WITH_ARIA_256_GCM_S=
HA384 */
> +    "ADH-ARIA128-GCM-SHA256",           /* TLS_DH_anon_WITH_ARIA_128_GCM_=
SHA256 */
> +    "ADH-ARIA256-GCM-SHA384",           /* TLS_DH_anon_WITH_ARIA_256_GCM_=
SHA384 */
> +    "ECDH-ECDSA-ARIA128-GCM-SHA256",    /* TLS_ECDH_ECDSA_WITH_ARIA_128_G=
CM_SHA256 */
> +    "ECDH-ECDSA-ARIA256-GCM-SHA384",    /* TLS_ECDH_ECDSA_WITH_ARIA_256_G=
CM_SHA384 */
> +    "ECDH-RSA-ARIA128-GCM-SHA256",      /* TLS_ECDH_RSA_WITH_ARIA_128_GCM=
_SHA256 */
> +    "ECDH-RSA-ARIA256-GCM-SHA384",      /* TLS_ECDH_RSA_WITH_ARIA_256_GCM=
_SHA384 */
> +    "PSK-ARIA128-SHA256",               /* TLS_PSK_WITH_ARIA_128_CBC_SHA2=
56 */
> +    "PSK-ARIA256-SHA384",               /* TLS_PSK_WITH_ARIA_256_CBC_SHA3=
84 */
> +    "DHE-PSK-ARIA128-SHA256",           /* TLS_DHE_PSK_WITH_ARIA_128_CBC_=
SHA256 */
> +    "DHE-PSK-ARIA256-SHA384",           /* TLS_DHE_PSK_WITH_ARIA_256_CBC_=
SHA384 */
> +    "RSA-PSK-ARIA128-SHA256",           /* TLS_RSA_PSK_WITH_ARIA_128_CBC_=
SHA256 */
> +    "RSA-PSK-ARIA256-SHA384",           /* TLS_RSA_PSK_WITH_ARIA_256_CBC_=
SHA384 */
> +    "ARIA128-GCM-SHA256",               /* TLS_PSK_WITH_ARIA_128_GCM_SHA2=
56 */
> +    "ARIA256-GCM-SHA384",               /* TLS_PSK_WITH_ARIA_256_GCM_SHA3=
84 */
> +    "RSA-PSK-ARIA128-GCM-SHA256",       /* TLS_RSA_PSK_WITH_ARIA_128_GCM_=
SHA256 */
> +    "RSA-PSK-ARIA256-GCM-SHA384",       /* TLS_RSA_PSK_WITH_ARIA_256_GCM_=
SHA384 */
> +    "ECDHE-PSK-ARIA128-SHA256",         /* TLS_ECDHE_PSK_WITH_ARIA_128_CB=
C_SHA256 */
> +    "ECDHE-PSK-ARIA256-SHA384",         /* TLS_ECDHE_PSK_WITH_ARIA_256_CB=
C_SHA384 */
> +
> +    /* blacklisted SEED encryptions */
> +    "SEED-SHA",                         /*TLS_RSA_WITH_SEED_CBC_SHA */
> +    "DH-DSS-SEED-SHA",                  /* TLS_DH_DSS_WITH_SEED_CBC_SHA *=
/
> +    "DH-RSA-SEED-SHA",                  /* TLS_DH_RSA_WITH_SEED_CBC_SHA *=
/
> +    "DHE-DSS-SEED-SHA",                 /* TLS_DHE_DSS_WITH_SEED_CBC_SHA *=
/
> +    "DHE-RSA-SEED-SHA",                 /* TLS_DHE_RSA_WITH_SEED_CBC_SHA *=
/              =20
> +    "ADH-SEED-SHA",                     /* TLS_DH_anon_WITH_SEED_CBC_SHA *=
/
> +
> +    /* blacklisted KRB5 ciphers */
> +    "KRB5-DES-CBC-SHA",                 /* TLS_KRB5_WITH_DES_CBC_SHA */
> +    "KRB5-DES-CBC3-SHA",                /* TLS_KRB5_WITH_3DES_EDE_CBC_SHA=
 */
> +    "KRB5-IDEA-CBC-SHA",                /* TLS_KRB5_WITH_IDEA_CBC_SHA */
> +    "KRB5-DES-CBC-MD5",                 /* TLS_KRB5_WITH_DES_CBC_MD5 */
> +    "KRB5-DES-CBC3-MD5",                /* TLS_KRB5_WITH_3DES_EDE_CBC_MD5=
 */
> +    "KRB5-IDEA-CBC-MD5",                /* TLS_KRB5_WITH_IDEA_CBC_MD5 */
> +    "EXP-KRB5-DES-CBC-SHA",             /* TLS_KRB5_EXPORT_WITH_DES_CBC_4=
0_SHA */
> +    "EXP-KRB5-DES-CBC-MD5",             /* TLS_KRB5_EXPORT_WITH_DES_CBC_4=
0_MD5 */
> +    "EXP-KRB5-RC2-CBC-SHA",             /* TLS_KRB5_EXPORT_WITH_RC2_CBC_4=
0_SHA */
> +    "EXP-KRB5-RC2-CBC-MD5",             /* TLS_KRB5_EXPORT_WITH_RC2_CBC_4=
0_MD5 */
> + =20
> +    /* blacklisted exoticas */
> +    "DHE-DSS-CBC-SHA",                  /* TLS_DHE_DSS_WITH_DES_CBC_SHA *=
/
> +    "IDEA-CBC-SHA",                     /* TLS_RSA_WITH_IDEA_CBC_SHA */
> +   =20
> +    /* not really sure if the following names are correct */
> +    "SSL3_CK_SCSV",                     /* TLS_EMPTY_RENEGOTIATION_INFO_S=
CSV */
> +    "SSL3_CK_FALLBACK_SCSV"
> +};
> +static size_t RFC7540_names_LEN =3D sizeof(RFC7540_names)/sizeof(RFC7540_=
names[0]);
> +
> +
> +static apr_hash_t *BLCNames;
> +
> +static void cipher_init(apr_pool_t *pool)
> +{
> +    apr_hash_t *hash =3D apr_hash_make(pool);
> +    const char *source;
> +    int i;
> +   =20
> +    source =3D "rfc7540";
> +    for (i =3D 0; i < RFC7540_names_LEN; ++i) {
> +        apr_hash_set(hash, RFC7540_names[i], APR_HASH_KEY_STRING, source)=
;
> +    }
> +   =20
> +    BLCNames =3D hash;
> +}
> +
> +static int cipher_is_blacklisted(const char *cipher, const char **psource=
)
> +{  =20
> +    *psource =3D apr_hash_get(BLCNames, cipher, APR_HASH_KEY_STRING);
> +    return !!*psource;
> +}
> +
> +/************************************************************************=
*******
>  * Hooks for processing incoming connections:
>  * - pre_conn_before_tls switches SSL off for stream connections
>  * - process_conn take over connection in case of h2
> @@ -72,12 +420,15 @@ apr_status_t h2_h2_init(apr_pool_t *pool
>     ap_log_error(APLOG_MARK, APLOG_DEBUG, 0, s, "h2_h2, child_init");
>     opt_ssl_engine_disable =3D APR_RETRIEVE_OPTIONAL_FN(ssl_engine_disable=
);
>     opt_ssl_is_https =3D APR_RETRIEVE_OPTIONAL_FN(ssl_is_https);
> +    opt_ssl_var_lookup =3D APR_RETRIEVE_OPTIONAL_FN(ssl_var_lookup);
>=20
> -    if (!opt_ssl_is_https) {
> +    if (!opt_ssl_is_https || !opt_ssl_var_lookup) {
>         ap_log_error(APLOG_MARK, APLOG_WARNING, 0, s,
>                      APLOGNO(02951) "mod_ssl does not seem to be enabled")=
;
>     }
>=20
> +    cipher_init(pool);
> +   =20
>     return APR_SUCCESS;
> }
>=20
> @@ -94,6 +445,63 @@ int h2_tls_disable(conn_rec *c)
>     return 0;
> }
>=20
> +int h2_is_security_compliant(conn_rec *c, int require_all)=20
> +{
> +    int is_tls =3D h2_h2_is_tls(c);
> +    h2_config *cfg =3D h2_config_get(c);
> +
> +    if (is_tls && h2_config_geti(cfg, H2_CONF_COMPLIANCE) > 0) {
> +        /* Check TLS connection for RFC 7540 compliance
> +         */
> +        apr_pool_t *pool =3D c->pool;
> +        server_rec *s =3D c->base_server;
> +        char *val;
> +       =20
> +        if (!opt_ssl_var_lookup) {
> +            /* unable to check */
> +            return 0;
> +        }
> +       =20
> +        /* Need Tlsv1.2 or higher, rfc 7540, ch. 9.2
> +         */
> +        val =3D opt_ssl_var_lookup(pool, s, c, NULL, "SSL_PROTOCOL");
> +        if (val && *val) {
> +            if (strncmp("TLS", val, 3)=20
> +                || !strcmp("TLSv1", val)=20
> +                || !strcmp("TLSv1.1", val)) {
> +            ap_log_cerror(APLOG_MARK, APLOG_DEBUG, 0, c,
> +                          "h2_h2(%ld): tls protocol not suitable: %s",=20=

> +                          (long)c->id, val);
> +                return 0;
> +            }
> +        }
> +        else if (require_all) {
> +            ap_log_cerror(APLOG_MARK, APLOG_DEBUG, 0, c,
> +                          "h2_h2(%ld): tls protocol is indetermined", (lo=
ng)c->id);
> +            return 0;
> +        }
> +
> +        /* Check TLS cipher blacklist
> +         */
> +        val =3D opt_ssl_var_lookup(pool, s, c, NULL, "SSL_CIPHER");
> +        if (val && *val) {
> +            const char *source;
> +            if (cipher_is_blacklisted(val, &source)) {
> +                ap_log_cerror(APLOG_MARK, APLOG_DEBUG, 0, c,
> +                              "h2_h2(%ld): tls cipher %s blacklisted by %=
s",=20
> +                              (long)c->id, val, source);
> +                return 0;
> +            }
> +        }
> +        else if (require_all) {
> +            ap_log_cerror(APLOG_MARK, APLOG_DEBUG, 0, c,
> +                          "h2_h2(%ld): tls cipher is indetermined", (long=
)c->id);
> +            return 0;
> +        }
> +    }
> +    return 1;
> +}
> +
> /*************************************************************************=
******
>  * Register various hooks
>  */
>=20
> Modified: httpd/httpd/trunk/modules/http2/h2_h2.h
> URL: http://svn.apache.org/viewvc/httpd/httpd/trunk/modules/http2/h2_h2.h?=
rev=3D1708593&r1=3D1708592&r2=3D1708593&view=3Ddiff
> =3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D
> --- httpd/httpd/trunk/modules/http2/h2_h2.h (original)
> +++ httpd/httpd/trunk/modules/http2/h2_h2.h Wed Oct 14 12:10:11 2015
> @@ -53,5 +53,16 @@ int h2_tls_disable(conn_rec *c);
>  */
> void h2_h2_register_hooks(void);
>=20
> +/**
> + * Check if the given connection fulfills the security requirements
> + * of RFC 7540.
> + * @param c the connection
> + * @param require_all !=3D 0 iff any missing connection properties make
> + *    the test fail. For example, a cipher might not have been selected w=
hile
> + *    the handshake is still ongoing.
> + * @return !=3D 0 iff security requirements are met
> + */
> +int h2_is_security_compliant(conn_rec *c, int require_all);
> +
>=20
> #endif /* defined(__mod_h2__h2_h2__) */
>=20
> Modified: httpd/httpd/trunk/modules/http2/h2_switch.c
> URL: http://svn.apache.org/viewvc/httpd/httpd/trunk/modules/http2/h2_switc=
h.c?rev=3D1708593&r1=3D1708592&r2=3D1708593&view=3Ddiff
> =3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D
> --- httpd/httpd/trunk/modules/http2/h2_switch.c (original)
> +++ httpd/httpd/trunk/modules/http2/h2_switch.c Wed Oct 14 12:10:11 2015
> @@ -35,24 +35,12 @@
> #include "h2_switch.h"
>=20
> /*************************************************************************=
******
> - * SSL var lookup
> - */
> -APR_DECLARE_OPTIONAL_FN(char *, ssl_var_lookup,
> -                        (apr_pool_t *, server_rec *,
> -                         conn_rec *, request_rec *,
> -                         char *));
> -static char *(*opt_ssl_var_lookup)(apr_pool_t *, server_rec *,
> -                                   conn_rec *, request_rec *,
> -                                   char *);
> -
> -/************************************************************************=
*******
>  * Once per lifetime init, retrieve optional functions
>  */
> apr_status_t h2_switch_init(apr_pool_t *pool, server_rec *s)
> {
>     (void)pool;
>     ap_log_error(APLOG_MARK, APLOG_DEBUG, 0, s, "h2_switch init");
> -    opt_ssl_var_lookup =3D APR_RETRIEVE_OPTIONAL_FN(ssl_var_lookup);
>=20
>     return APR_SUCCESS;
> }
> @@ -63,7 +51,8 @@ static int h2_protocol_propose(conn_rec
>                                apr_array_header_t *proposals)
> {
>     int proposed =3D 0;
> -    const char **protos =3D h2_h2_is_tls(c)? h2_tls_protos : h2_clear_pro=
tos;
> +    int is_tls =3D h2_h2_is_tls(c);
> +    const char **protos =3D is_tls? h2_tls_protos : h2_clear_protos;
>=20
>     (void)s;
>     if (strcmp(AP_PROTOCOL_HTTP1, ap_get_protocol(c))) {
> @@ -74,6 +63,12 @@ static int h2_protocol_propose(conn_rec
>         return DECLINED;
>     }
>=20
> +    if (!h2_is_security_compliant(c, 0)) {
> +        ap_log_cerror(APLOG_MARK, APLOG_DEBUG, 0, c,
> +                      "protocol propose: security requirements not met, d=
eclined");
> +        return DECLINED;
> +    }
> +   =20
>     if (r) {
>         const char *p;
>         /* So far, this indicates an HTTP/1 Upgrade header initiated
>=20
>=20
>=20


From dev-return-84284-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Wed Oct 14 15:13:11 2015
Return-Path: <dev-return-84284-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id F3517185E9
	for <apmail-httpd-dev-archive@www.apache.org>; Wed, 14 Oct 2015 15:13:10 +0000 (UTC)
Received: (qmail 86926 invoked by uid 500); 14 Oct 2015 15:13:10 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 86861 invoked by uid 500); 14 Oct 2015 15:13:10 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 86851 invoked by uid 99); 14 Oct 2015 15:13:10 -0000
Received: from Unknown (HELO spamd3-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 14 Oct 2015 15:13:10 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd3-us-west.apache.org (ASF Mail Server at spamd3-us-west.apache.org) with ESMTP id E5DA6180A5E
	for <dev@httpd.apache.org>; Wed, 14 Oct 2015 15:13:09 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd3-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 1.581
X-Spam-Level: *
X-Spam-Status: No, score=1.581 tagged_above=-999 required=6.31
	tests=[KAM_ASCII_DIVIDERS=0.8, SPF_PASS=-0.001,
	T_RP_MATCHES_RCVD=-0.01, UPPERCASE_50_75=0.791, URIBL_BLOCKED=0.001]
	autolearn=disabled
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd3-us-west.apache.org [10.40.0.10]) (amavisd-new, port 10024)
	with ESMTP id 2Saoti61lliS for <dev@httpd.apache.org>;
	Wed, 14 Oct 2015 15:12:56 +0000 (UTC)
Received: from mail.greenbytes.de (mail.greenbytes.de [217.91.35.233])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id 0BEB02314A
	for <dev@httpd.apache.org>; Wed, 14 Oct 2015 15:12:55 +0000 (UTC)
Received: from [192.168.1.42] (unknown [5.10.171.186])
	(using TLSv1 with cipher ECDHE-RSA-AES256-SHA (256/256 bits))
	(Client did not present a certificate)
	by mail.greenbytes.de (Postfix) with ESMTPSA id 6B90A15A0448
	for <dev@httpd.apache.org>; Wed, 14 Oct 2015 17:12:54 +0200 (CEST)
Content-Type: text/plain; charset=us-ascii
Mime-Version: 1.0 (Mac OS X Mail 9.0 \(3094\))
Subject: Re: svn commit: r1708593 - in /httpd/httpd/trunk: docs/manual/mod/mod_http2.xml modules/http2/h2_config.c modules/http2/h2_config.h modules/http2/h2_conn.c modules/http2/h2_h2.c modules/http2/h2_h2.h modules/http2/h2_switch.c
From: Stefan Eissing <stefan.eissing@greenbytes.de>
In-Reply-To: <E9BCBCDC-3132-42C5-A6D5-ED200C832DC2@gbiv.com>
Date: Wed, 14 Oct 2015 17:12:53 +0200
Content-Transfer-Encoding: quoted-printable
Message-Id: <C8A0E48E-767F-488A-92BF-4A2BE9CDFE30@greenbytes.de>
References: <20151014121012.507DA3A043F@svn01-us-west.apache.org> <E9BCBCDC-3132-42C5-A6D5-ED200C832DC2@gbiv.com>
To: dev@httpd.apache.org
X-Mailer: Apple Mail (2.3094)

And we were all just getting so warm and fuzzy here... ;-)

There are several areas where RFC 7540 says something that - let's say =
it=20
like this - applies maybe to the Internet - whatever that is - but that
Apache httpd should and will work in environments that have other needs.

Instead of a unspecific "H2Compliance", we can make individual directive
to address these parts.=20

We already have:
- H2Direct on|off, can enable direct mode on cleartext and TLS =
connections

We can add
- H2ModernTLSOnly on|off, to enforce TLS params as specified in the RFC =
and also enforced by modern browsers as described in =
https://wiki.mozilla.org/Security/Server_Side_TLS#Modern_compatibility
- H2UpgradeInTLS on|off, to allow HTTP/1.1 style Upgrade: on TLS =
connections
...
(insert your wishes here)

//Stefan

> Am 14.10.2015 um 16:55 schrieb Roy T. Fielding <fielding@gbiv.com>:
>=20
> Can you please choose a more specific directive name? Like =
"LimitTLSunderH2".
>=20
> We don't have switches for RFC compliance. We do have switches for =
stupid WG political positions that contradict common sense and are not =
applicable to non-Internet deployments.
>=20
> ....Roy
>=20
>=20
>> On Oct 14, 2015, at 5:10 AM, icing@apache.org wrote:
>>=20
>> Author: icing
>> Date: Wed Oct 14 12:10:11 2015
>> New Revision: 1708593
>>=20
>> URL: http://svn.apache.org/viewvc?rev=3D1708593&view=3Drev
>> Log:
>> mod_http2: new directive H2Compliance on/off, checking TLS protocol =
and cipher against RFC7540
>>=20
>> Modified:
>>   httpd/httpd/trunk/docs/manual/mod/mod_http2.xml
>>   httpd/httpd/trunk/modules/http2/h2_config.c
>>   httpd/httpd/trunk/modules/http2/h2_config.h
>>   httpd/httpd/trunk/modules/http2/h2_conn.c
>>   httpd/httpd/trunk/modules/http2/h2_h2.c
>>   httpd/httpd/trunk/modules/http2/h2_h2.h
>>   httpd/httpd/trunk/modules/http2/h2_switch.c
>>=20
>> Modified: httpd/httpd/trunk/docs/manual/mod/mod_http2.xml
>> URL: =
http://svn.apache.org/viewvc/httpd/httpd/trunk/docs/manual/mod/mod_http2.x=
ml?rev=3D1708593&r1=3D1708592&r2=3D1708593&view=3Ddiff
>> =
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
>> --- httpd/httpd/trunk/docs/manual/mod/mod_http2.xml (original)
>> +++ httpd/httpd/trunk/docs/manual/mod/mod_http2.xml Wed Oct 14 =
12:10:11 2015
>> @@ -74,11 +74,11 @@
>>                Direct communication means that if the first bytes =
received by the=20
>>                server on a connection match the HTTP/2 preamble, the =
HTTP/2
>>                protocol is switched to immediately without further =
negotiation.
>> -                This mode falls outside the RFC 7540 but has become =
widely implemented
>> -                on cleartext ports as it is very convenient for =
development and testing.=20
>> +                This mode is defined in RFC 7540 for the cleartext =
(h2c) case. Its
>> +                use on TLS connections is not allowed by the =
standard.
>>            </p>
>>            <p>
>> -                Since this detection implies that the client will =
send data on
>> +                Since this detection requires that the client will =
send data on
>>                new connection immediately, direct HTTP/2 mode is =
disabled by
>>                default.
>>            </p>
>>=20
>> Modified: httpd/httpd/trunk/modules/http2/h2_config.c
>> URL: =
http://svn.apache.org/viewvc/httpd/httpd/trunk/modules/http2/h2_config.c?r=
ev=3D1708593&r1=3D1708592&r2=3D1708593&view=3Ddiff
>> =
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
>> --- httpd/httpd/trunk/modules/http2/h2_config.c (original)
>> +++ httpd/httpd/trunk/modules/http2/h2_config.c Wed Oct 14 12:10:11 =
2015
>> @@ -49,6 +49,7 @@ static h2_config defconf =3D {
>>    0,                /* serialize headers */
>>    0,                /* h2 direct mode */
>>    -1,               /* # session extra files */
>> +    1,                /* rfc 7540 compliance */
>> };
>>=20
>> static int files_per_session =3D 0;
>> @@ -100,6 +101,7 @@ static void *h2_config_create(apr_pool_t
>>    conf->serialize_headers    =3D DEF_VAL;
>>    conf->h2_direct            =3D DEF_VAL;
>>    conf->session_extra_files  =3D DEF_VAL;
>> +    conf->rfc_compliance       =3D DEF_VAL;
>>    return conf;
>> }
>>=20
>> @@ -138,6 +140,7 @@ void *h2_config_merge(apr_pool_t *pool,
>>    n->serialize_headers =3D H2_CONFIG_GET(add, base, =
serialize_headers);
>>    n->h2_direct      =3D H2_CONFIG_GET(add, base, h2_direct);
>>    n->session_extra_files =3D H2_CONFIG_GET(add, base, =
session_extra_files);
>> +    n->rfc_compliance =3D H2_CONFIG_GET(add, base, rfc_compliance);
>>=20
>>    return n;
>> }
>> @@ -162,6 +165,8 @@ int h2_config_geti(h2_config *conf, h2_c
>>            return H2_CONFIG_GET(conf, &defconf, alt_svc_max_age);
>>        case H2_CONF_SER_HEADERS:
>>            return H2_CONFIG_GET(conf, &defconf, serialize_headers);
>> +        case H2_CONF_COMPLIANCE:
>> +            return H2_CONFIG_GET(conf, &defconf, rfc_compliance);
>>        case H2_CONF_DIRECT:
>>            return H2_CONFIG_GET(conf, &defconf, h2_direct);
>>        case H2_CONF_SESSION_FILES:
>> @@ -332,8 +337,25 @@ static const char *h2_conf_set_direct(cm
>>    return "value must be On or Off";
>> }
>>=20
>> -#define AP_END_CMD     AP_INIT_TAKE1(NULL, NULL, NULL, RSRC_CONF, =
NULL)
>> +static const char *h2_conf_set_compliance(cmd_parms *parms,
>> +                                          void *arg, const char =
*value)
>> +{
>> +    h2_config *cfg =3D h2_config_sget(parms->server);
>> +    if (!strcasecmp(value, "On")) {
>> +        cfg->rfc_compliance =3D 1;
>> +        return NULL;
>> +    }
>> +    else if (!strcasecmp(value, "Off")) {
>> +        cfg->rfc_compliance =3D 0;
>> +        return NULL;
>> +    }
>> +   =20
>> +    (void)arg;
>> +    return "value must be On or Off";
>> +}
>> +
>>=20
>> +#define AP_END_CMD     AP_INIT_TAKE1(NULL, NULL, NULL, RSRC_CONF, =
NULL)
>>=20
>> const command_rec h2_cmds[] =3D {
>>    AP_INIT_TAKE1("H2MaxSessionStreams", h2_conf_set_max_streams, =
NULL,
>> @@ -354,6 +376,8 @@ const command_rec h2_cmds[] =3D {
>>                  RSRC_CONF, "set the maximum age (in seconds) that =
client can rely on alt-svc information"),
>>    AP_INIT_TAKE1("H2SerializeHeaders", h2_conf_set_serialize_headers, =
NULL,
>>                  RSRC_CONF, "on to enable header serialization for =
compatibility"),
>> +    AP_INIT_TAKE1("H2Compliance", h2_conf_set_compliance, NULL,
>> +                  RSRC_CONF, "off to disable strict compliance to =
RFC 7540"),
>>    AP_INIT_TAKE1("H2Direct", h2_conf_set_direct, NULL,
>>                  RSRC_CONF, "on to enable direct HTTP/2 mode"),
>>    AP_INIT_TAKE1("H2SessionExtraFiles", =
h2_conf_set_session_extra_files, NULL,
>>=20
>> Modified: httpd/httpd/trunk/modules/http2/h2_config.h
>> URL: =
http://svn.apache.org/viewvc/httpd/httpd/trunk/modules/http2/h2_config.h?r=
ev=3D1708593&r1=3D1708592&r2=3D1708593&view=3Ddiff
>> =
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
>> --- httpd/httpd/trunk/modules/http2/h2_config.h (original)
>> +++ httpd/httpd/trunk/modules/http2/h2_config.h Wed Oct 14 12:10:11 =
2015
>> @@ -34,6 +34,7 @@ typedef enum {
>>    H2_CONF_SER_HEADERS,
>>    H2_CONF_DIRECT,
>>    H2_CONF_SESSION_FILES,
>> +    H2_CONF_COMPLIANCE,
>> } h2_config_var_t;
>>=20
>> /* Apache httpd module configuration for h2. */
>> @@ -51,6 +52,7 @@ typedef struct h2_config {
>>                                     processing, better compatibility =
*/
>>    int h2_direct;                /* if mod_h2 is active directly */
>>    int session_extra_files;      /* # of extra files a session may =
keep open */ =20
>> +    int rfc_compliance;           /* Comply with all aspects of RFC =
7540 */ =20
>> } h2_config;
>>=20
>>=20
>>=20
>> Modified: httpd/httpd/trunk/modules/http2/h2_conn.c
>> URL: =
http://svn.apache.org/viewvc/httpd/httpd/trunk/modules/http2/h2_conn.c?rev=
=3D1708593&r1=3D1708592&r2=3D1708593&view=3Ddiff
>> =
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
>> --- httpd/httpd/trunk/modules/http2/h2_conn.c (original)
>> +++ httpd/httpd/trunk/modules/http2/h2_conn.c Wed Oct 14 12:10:11 =
2015
>> @@ -32,6 +32,7 @@
>> #include "h2_session.h"
>> #include "h2_stream.h"
>> #include "h2_stream_set.h"
>> +#include "h2_h2.h"
>> #include "h2_task.h"
>> #include "h2_worker.h"
>> #include "h2_workers.h"
>> @@ -177,6 +178,11 @@ apr_status_t h2_conn_main(conn_rec *c)
>>        return APR_EGENERAL;
>>    }
>>=20
>> +    if (!h2_is_security_compliant(c, 1)) {
>> +        nghttp2_submit_goaway(session->ngh2, NGHTTP2_FLAG_NONE, 0,
>> +                              NGHTTP2_INADEQUATE_SECURITY, NULL, 0);
>> +    }=20
>> +
>>    status =3D h2_session_process(session);
>>=20
>>    /* Make sure this connection gets closed properly. */
>>=20
>> Modified: httpd/httpd/trunk/modules/http2/h2_h2.c
>> URL: =
http://svn.apache.org/viewvc/httpd/httpd/trunk/modules/http2/h2_h2.c?rev=3D=
1708593&r1=3D1708592&r2=3D1708593&view=3Ddiff
>> =
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
>> --- httpd/httpd/trunk/modules/http2/h2_h2.c (original)
>> +++ httpd/httpd/trunk/modules/http2/h2_h2.c Wed Oct 14 12:10:11 2015
>> @@ -54,6 +54,354 @@ APR_DECLARE_OPTIONAL_FN(int, ssl_is_http
>> static int (*opt_ssl_engine_disable)(conn_rec*);
>> static int (*opt_ssl_is_https)(conn_rec*);
>> =
/*************************************************************************=
******
>> + * SSL var lookup
>> + */
>> +APR_DECLARE_OPTIONAL_FN(char *, ssl_var_lookup,
>> +                        (apr_pool_t *, server_rec *,
>> +                         conn_rec *, request_rec *,
>> +                         char *));
>> +static char *(*opt_ssl_var_lookup)(apr_pool_t *, server_rec *,
>> +                                   conn_rec *, request_rec *,
>> +                                   char *);
>> +
>> =
+/************************************************************************=
*******
>> + * Check connection security requirements of RFC 7540
>> + */
>> +
>> +/*
>> + * Black Listed Ciphers from RFC 7549 Appendix A
>> + *
>> + */
>> +static const char *RFC7540_names[] =3D {
>> +    /* ciphers with NULL encrpytion */
>> +    "NULL-MD5",                         /* TLS_NULL_WITH_NULL_NULL =
*/
>> +    /* same */                          /* TLS_RSA_WITH_NULL_MD5 */
>> +    "NULL-SHA",                         /* TLS_RSA_WITH_NULL_SHA */
>> +    "NULL-SHA256",                      /* TLS_RSA_WITH_NULL_SHA256 =
*/
>> +    "PSK-NULL-SHA",                     /* TLS_PSK_WITH_NULL_SHA */
>> +    "DHE-PSK-NULL-SHA",                 /* TLS_DHE_PSK_WITH_NULL_SHA =
*/
>> +    "RSA-PSK-NULL-SHA",                 /* TLS_RSA_PSK_WITH_NULL_SHA =
*/
>> +    "PSK-NULL-SHA256",                  /* TLS_PSK_WITH_NULL_SHA256 =
*/
>> +    "PSK-NULL-SHA384",                  /* TLS_PSK_WITH_NULL_SHA384 =
*/
>> +    "DHE-PSK-NULL-SHA256",              /* =
TLS_DHE_PSK_WITH_NULL_SHA256 */
>> +    "DHE-PSK-NULL-SHA384",              /* =
TLS_DHE_PSK_WITH_NULL_SHA384 */
>> +    "RSA-PSK-NULL-SHA256",              /* =
TLS_RSA_PSK_WITH_NULL_SHA256 */
>> +    "RSA-PSK-NULL-SHA384",              /* =
TLS_RSA_PSK_WITH_NULL_SHA384 */
>> +    "ECDH-ECDSA-NULL-SHA",              /* =
TLS_ECDH_ECDSA_WITH_NULL_SHA */
>> +    "ECDHE-ECDSA-NULL-SHA",             /* =
TLS_ECDHE_ECDSA_WITH_NULL_SHA */
>> +    "ECDH-RSA-NULL-SHA",                /* =
TLS_ECDH_RSA_WITH_NULL_SHA */
>> +    "ECDHE-RSA-NULL-SHA",               /* =
TLS_ECDHE_RSA_WITH_NULL_SHA */
>> +    "AECDH-NULL-SHA",                   /* =
TLS_ECDH_anon_WITH_NULL_SHA */
>> +    "ECDHE-PSK-NULL-SHA",               /* =
TLS_ECDHE_PSK_WITH_NULL_SHA */
>> +    "ECDHE-PSK-NULL-SHA256",            /* =
TLS_ECDHE_PSK_WITH_NULL_SHA256 */
>> +    "ECDHE-PSK-NULL-SHA384",            /* =
TLS_ECDHE_PSK_WITH_NULL_SHA384 */
>> +   =20
>> +    /* DES/3DES ciphers */
>> +    "PSK-3DES-EDE-CBC-SHA",             /* =
TLS_PSK_WITH_3DES_EDE_CBC_SHA */
>> +    "DHE-PSK-3DES-EDE-CBC-SHA",         /* =
TLS_DHE_PSK_WITH_3DES_EDE_CBC_SHA */
>> +    "RSA-PSK-3DES-EDE-CBC-SHA",         /* =
TLS_RSA_PSK_WITH_3DES_EDE_CBC_SHA */
>> +    "ECDH-ECDSA-DES-CBC3-SHA",          /* =
TLS_ECDH_ECDSA_WITH_3DES_EDE_CBC_SHA */
>> +    "ECDHE-ECDSA-DES-CBC3-SHA",         /* =
TLS_ECDHE_ECDSA_WITH_3DES_EDE_CBC_SHA */
>> +    "ECDH-RSA-DES-CBC3-SHA",            /* =
TLS_ECDH_RSA_WITH_3DES_EDE_CBC_SHA */
>> +    "ECDHE-RSA-DES-CBC3-SHA",           /* =
TLS_ECDHE_RSA_WITH_3DES_EDE_CBC_SHA */
>> +    "AECDH-DES-CBC3-SHA",               /* =
TLS_ECDH_anon_WITH_3DES_EDE_CBC_SHA */
>> +    "SRP-3DES-EDE-CBC-SHA",             /* =
TLS_SRP_SHA_WITH_3DES_EDE_CBC_SHA */
>> +    "SRP-RSA-3DES-EDE-CBC-SHA",         /* =
TLS_SRP_SHA_RSA_WITH_3DES_EDE_CBC_SHA */
>> +    "SRP-DSS-3DES-EDE-CBC-SHA",         /* =
TLS_SRP_SHA_DSS_WITH_3DES_EDE_CBC_SHA */
>> +    "ECDHE-PSK-3DES-EDE-CBC-SHA",       /* =
TLS_ECDHE_PSK_WITH_3DES_EDE_CBC_SHA */
>> +    "DES-CBC-SHA",                      /* TLS_RSA_WITH_DES_CBC_SHA =
*/
>> +    "DES-CBC3-SHA",                     /* =
TLS_RSA_WITH_3DES_EDE_CBC_SHA */
>> +    "DHE-DSS-DES-CBC3-SHA",             /* =
TLS_DHE_DSS_WITH_3DES_EDE_CBC_SHA */
>> +    "DHE-RSA-DES-CBC-SHA",              /* =
TLS_DHE_RSA_WITH_DES_CBC_SHA */
>> +    "DHE-RSA-DES-CBC3-SHA",             /* =
TLS_DHE_RSA_WITH_3DES_EDE_CBC_SHA */
>> +    "ADH-DES-CBC-SHA",                  /* =
TLS_DH_anon_WITH_DES_CBC_SHA */
>> +    "ADH-DES-CBC3-SHA",                 /* =
TLS_DH_anon_WITH_3DES_EDE_CBC_SHA */
>> +    "EXP-DH-DSS-DES-CBC-SHA",           /* =
TLS_DH_DSS_EXPORT_WITH_DES40_CBC_SHA */
>> +    "DH-DSS-DES-CBC-SHA",               /* =
TLS_DH_DSS_WITH_DES_CBC_SHA */
>> +    "DH-DSS-DES-CBC3-SHA",              /* =
TLS_DH_DSS_WITH_3DES_EDE_CBC_SHA */
>> +    "EXP-DH-RSA-DES-CBC-SHA",           /* =
TLS_DH_RSA_EXPORT_WITH_DES40_CBC_SHA */
>> +    "DH-RSA-DES-CBC-SHA",               /* =
TLS_DH_RSA_WITH_DES_CBC_SHA */
>> +    "DH-RSA-DES-CBC3-SHA",              /* =
TLS_DH_RSA_WITH_3DES_EDE_CBC_SHA */
>> +
>> +    /* blacklisted EXPORT ciphers */
>> +    "EXP-RC4-MD5",                      /* =
TLS_RSA_EXPORT_WITH_RC4_40_MD5 */
>> +    "EXP-RC2-CBC-MD5",                  /* =
TLS_RSA_EXPORT_WITH_RC2_CBC_40_MD5 */
>> +    "EXP-DES-CBC-SHA",                  /* =
TLS_RSA_EXPORT_WITH_DES40_CBC_SHA */
>> +    "EXP-DHE-DSS-DES-CBC-SHA",          /* =
TLS_DHE_DSS_EXPORT_WITH_DES40_CBC_SHA */
>> +    "EXP-DHE-RSA-DES-CBC-SHA",          /* =
TLS_DHE_RSA_EXPORT_WITH_DES40_CBC_SHA */
>> +    "EXP-ADH-DES-CBC-SHA",              /* =
TLS_DH_anon_EXPORT_WITH_DES40_CBC_SHA */
>> +    "EXP-ADH-RC4-MD5",                  /* =
TLS_DH_anon_EXPORT_WITH_RC4_40_MD5 */
>> +
>> +    /* blacklisted RC4 encryption */
>> +    "RC4-MD5",                          /* TLS_RSA_WITH_RC4_128_MD5 =
*/
>> +    "RC4-SHA",                          /* TLS_RSA_WITH_RC4_128_SHA =
*/
>> +    "ADH-RC4-MD5",                      /* =
TLS_DH_anon_WITH_RC4_128_MD5 */
>> +    "KRB5-RC4-SHA",                     /* TLS_KRB5_WITH_RC4_128_SHA =
*/
>> +    "KRB5-RC4-MD5",                     /* TLS_KRB5_WITH_RC4_128_MD5 =
*/
>> +    "EXP-KRB5-RC4-SHA",                 /* =
TLS_KRB5_EXPORT_WITH_RC4_40_SHA */
>> +    "EXP-KRB5-RC4-MD5",                 /* =
TLS_KRB5_EXPORT_WITH_RC4_40_MD5 */
>> +    "PSK-RC4-SHA",                      /* TLS_PSK_WITH_RC4_128_SHA =
*/
>> +    "DHE-PSK-RC4-SHA",                  /* =
TLS_DHE_PSK_WITH_RC4_128_SHA */
>> +    "RSA-PSK-RC4-SHA",                  /* =
TLS_RSA_PSK_WITH_RC4_128_SHA */
>> +    "ECDH-ECDSA-RC4-SHA",               /* =
TLS_ECDH_ECDSA_WITH_RC4_128_SHA */
>> +    "ECDHE-ECDSA-RC4-SHA",              /* =
TLS_ECDHE_ECDSA_WITH_RC4_128_SHA */
>> +    "ECDH-RSA-RC4-SHA",                 /* =
TLS_ECDH_RSA_WITH_RC4_128_SHA */
>> +    "ECDHE-RSA-RC4-SHA",                /* =
TLS_ECDHE_RSA_WITH_RC4_128_SHA */
>> +    "AECDH-RC4-SHA",                    /* =
TLS_ECDH_anon_WITH_RC4_128_SHA */
>> +    "ECDHE-PSK-RC4-SHA",                /* =
TLS_ECDHE_PSK_WITH_RC4_128_SHA */
>> +
>> +    /* blacklisted AES128 encrpytion ciphers */
>> +    "AES128-SHA256",                    /* =
TLS_RSA_WITH_AES_128_CBC_SHA */
>> +    "DH-DSS-AES128-SHA",                /* =
TLS_DH_DSS_WITH_AES_128_CBC_SHA */
>> +    "DH-RSA-AES128-SHA",                /* =
TLS_DH_RSA_WITH_AES_128_CBC_SHA */
>> +    "DHE-DSS-AES128-SHA",               /* =
TLS_DHE_DSS_WITH_AES_128_CBC_SHA */
>> +    "DHE-RSA-AES128-SHA",               /* =
TLS_DHE_RSA_WITH_AES_128_CBC_SHA */
>> +    "ADH-AES128-SHA",                   /* =
TLS_DH_anon_WITH_AES_128_CBC_SHA */
>> +    "AES128-SHA256",                    /* =
TLS_RSA_WITH_AES_128_CBC_SHA256 */
>> +    "DH-DSS-AES128-SHA256",             /* =
TLS_DH_DSS_WITH_AES_128_CBC_SHA256 */
>> +    "DH-RSA-AES128-SHA256",             /* =
TLS_DH_RSA_WITH_AES_128_CBC_SHA256 */
>> +    "DHE-DSS-AES128-SHA256",            /* =
TLS_DHE_DSS_WITH_AES_128_CBC_SHA256 */
>> +    "DHE-RSA-AES128-SHA256",            /* =
TLS_DHE_RSA_WITH_AES_128_CBC_SHA256 */
>> +    "ECDH-ECDSA-AES128-SHA",            /* =
TLS_ECDH_ECDSA_WITH_AES_128_CBC_SHA */
>> +    "ECDHE-ECDSA-AES128-SHA",           /* =
TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA */
>> +    "ECDH-RSA-AES128-SHA",              /* =
TLS_ECDH_RSA_WITH_AES_128_CBC_SHA */
>> +    "ECDHE-RSA-AES128-SHA",             /* =
TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA */
>> +    "AECDH-AES128-SHA",                 /* =
TLS_ECDH_anon_WITH_AES_128_CBC_SHA */
>> +    "ECDHE-ECDSA-AES128-SHA256",        /* =
TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA256 */
>> +    "ECDH-ECDSA-AES128-SHA256",         /* =
TLS_ECDH_ECDSA_WITH_AES_128_CBC_SHA256 */
>> +    "ECDHE-RSA-AES128-SHA256",          /* =
TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256 */
>> +    "ECDH-RSA-AES128-SHA256",           /* =
TLS_ECDH_RSA_WITH_AES_128_CBC_SHA256 */
>> +    "ADH-AES128-SHA256",                /* =
TLS_DH_anon_WITH_AES_128_CBC_SHA256 */
>> +    "PSK-AES128-CBC-SHA",               /* =
TLS_PSK_WITH_AES_128_CBC_SHA */
>> +    "DHE-PSK-AES128-CBC-SHA",           /* =
TLS_DHE_PSK_WITH_AES_128_CBC_SHA */
>> +    "RSA-PSK-AES128-CBC-SHA",           /* =
TLS_RSA_PSK_WITH_AES_128_CBC_SHA */
>> +    "PSK-AES128-CBC-SHA256",            /* =
TLS_PSK_WITH_AES_128_CBC_SHA256 */
>> +    "DHE-PSK-AES128-CBC-SHA256",        /* =
TLS_DHE_PSK_WITH_AES_128_CBC_SHA256 */
>> +    "RSA-PSK-AES128-CBC-SHA256",        /* =
TLS_RSA_PSK_WITH_AES_128_CBC_SHA256 */
>> +    "ECDHE-PSK-AES128-CBC-SHA",         /* =
TLS_ECDHE_PSK_WITH_AES_128_CBC_SHA */
>> +    "ECDHE-PSK-AES128-CBC-SHA256",      /* =
TLS_ECDHE_PSK_WITH_AES_128_CBC_SHA256 */
>> +    "AES128-CCM",                       /* TLS_RSA_WITH_AES_128_CCM =
*/
>> +    "AES128-CCM8",                      /* =
TLS_RSA_WITH_AES_128_CCM_8 */
>> +    "PSK-AES128-CCM",                   /* TLS_PSK_WITH_AES_128_CCM =
*/
>> +    "PSK-AES128-CCM8",                  /* =
TLS_PSK_WITH_AES_128_CCM_8 */
>> +    "AES128-GCM-SHA256",                /* =
TLS_RSA_WITH_AES_128_GCM_SHA256 */
>> +    "DH-RSA-AES128-GCM-SHA256",         /* =
TLS_DH_RSA_WITH_AES_128_GCM_SHA256 */
>> +    "DH-DSS-AES128-GCM-SHA256",         /* =
TLS_DH_DSS_WITH_AES_128_GCM_SHA256 */
>> +    "ADH-AES128-GCM-SHA256",            /* =
TLS_DH_anon_WITH_AES_128_GCM_SHA256 */
>> +    "PSK-AES128-GCM-SHA256",            /* =
TLS_PSK_WITH_AES_128_GCM_SHA256 */
>> +    "RSA-PSK-AES128-GCM-SHA256",        /* =
TLS_RSA_PSK_WITH_AES_128_GCM_SHA256 */
>> +    "ECDH-ECDSA-AES128-GCM-SHA256",     /* =
TLS_ECDH_ECDSA_WITH_AES_128_GCM_SHA256 */
>> +    "ECDH-RSA-AES128-GCM-SHA256",       /* =
TLS_ECDH_RSA_WITH_AES_128_GCM_SHA256 */
>> +    "SRP-AES-128-CBC-SHA",              /* =
TLS_SRP_SHA_WITH_AES_128_CBC_SHA */
>> +    "SRP-RSA-AES-128-CBC-SHA",          /* =
TLS_SRP_SHA_RSA_WITH_AES_128_CBC_SHA */
>> +    "SRP-DSS-AES-128-CBC-SHA",          /* =
TLS_SRP_SHA_DSS_WITH_AES_128_CBC_SHA */
>> +   =20
>> +    /* blacklisted AES256 encrpytion ciphers */
>> +    "AES256-SHA",                       /* =
TLS_RSA_WITH_AES_256_CBC_SHA */
>> +    "DH-DSS-AES256-SHA",                /* =
TLS_DH_DSS_WITH_AES_256_CBC_SHA */
>> +    "DH-RSA-AES256-SHA",                /* =
TLS_DH_RSA_WITH_AES_256_CBC_SHA */
>> +    "DHE-DSS-AES256-SHA",               /* =
TLS_DHE_DSS_WITH_AES_256_CBC_SHA */
>> +    "DHE-RSA-AES256-SHA",               /* =
TLS_DHE_RSA_WITH_AES_256_CBC_SHA */
>> +    "ADH-AES256-SHA",                   /* =
TLS_DH_anon_WITH_AES_256_CBC_SHA */
>> +    "AES256-SHA256",                    /* =
TLS_RSA_WITH_AES_256_CBC_SHA256 */
>> +    "DH-DSS-AES256-SHA256",             /* =
TLS_DH_DSS_WITH_AES_256_CBC_SHA256 */
>> +    "DH-RSA-AES256-SHA256",             /* =
TLS_DH_RSA_WITH_AES_256_CBC_SHA256 */
>> +    "DHE-DSS-AES256-SHA256",            /* =
TLS_DHE_DSS_WITH_AES_256_CBC_SHA256 */
>> +    "DHE-RSA-AES256-SHA256",            /* =
TLS_DHE_RSA_WITH_AES_256_CBC_SHA256 */
>> +    "ADH-AES256-SHA256",                /* =
TLS_DH_anon_WITH_AES_256_CBC_SHA256 */
>> +    "ECDH-ECDSA-AES256-SHA",            /* =
TLS_ECDH_ECDSA_WITH_AES_256_CBC_SHA */
>> +    "ECDHE-ECDSA-AES256-SHA",           /* =
TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA */
>> +    "ECDH-RSA-AES256-SHA",              /* =
TLS_ECDH_RSA_WITH_AES_256_CBC_SHA */
>> +    "ECDHE-RSA-AES256-SHA",             /* =
TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA */
>> +    "AECDH-AES256-SHA",                 /* =
TLS_ECDH_anon_WITH_AES_256_CBC_SHA */
>> +    "ECDHE-ECDSA-AES256-SHA384",        /* =
TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA384 */
>> +    "ECDH-ECDSA-AES256-SHA384",         /* =
TLS_ECDH_ECDSA_WITH_AES_256_CBC_SHA384 */
>> +    "ECDHE-RSA-AES256-SHA384",          /* =
TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA384 */
>> +    "ECDH-RSA-AES256-SHA384",           /* =
TLS_ECDH_RSA_WITH_AES_256_CBC_SHA384 */
>> +    "PSK-AES256-CBC-SHA",               /* =
TLS_PSK_WITH_AES_256_CBC_SHA */
>> +    "DHE-PSK-AES256-CBC-SHA",           /* =
TLS_DHE_PSK_WITH_AES_256_CBC_SHA */
>> +    "RSA-PSK-AES256-CBC-SHA",           /* =
TLS_RSA_PSK_WITH_AES_256_CBC_SHA */
>> +    "PSK-AES256-CBC-SHA384",            /* =
TLS_PSK_WITH_AES_256_CBC_SHA384 */
>> +    "DHE-PSK-AES256-CBC-SHA384",        /* =
TLS_DHE_PSK_WITH_AES_256_CBC_SHA384 */
>> +    "RSA-PSK-AES256-CBC-SHA384",        /* =
TLS_RSA_PSK_WITH_AES_256_CBC_SHA384 */
>> +    "ECDHE-PSK-AES256-CBC-SHA",         /* =
TLS_ECDHE_PSK_WITH_AES_256_CBC_SHA */
>> +    "ECDHE-PSK-AES256-CBC-SHA384",      /* =
TLS_ECDHE_PSK_WITH_AES_256_CBC_SHA384 */
>> +    "SRP-AES-256-CBC-SHA",              /* =
TLS_SRP_SHA_WITH_AES_256_CBC_SHA */
>> +    "SRP-RSA-AES-256-CBC-SHA",          /* =
TLS_SRP_SHA_RSA_WITH_AES_256_CBC_SHA */
>> +    "SRP-DSS-AES-256-CBC-SHA",          /* =
TLS_SRP_SHA_DSS_WITH_AES_256_CBC_SHA */
>> +    "AES256-CCM",                       /* TLS_RSA_WITH_AES_256_CCM =
*/
>> +    "AES256-CCM8",                      /* =
TLS_RSA_WITH_AES_256_CCM_8 */
>> +    "PSK-AES256-CCM",                   /* TLS_PSK_WITH_AES_256_CCM =
*/
>> +    "PSK-AES256-CCM8",                  /* =
TLS_PSK_WITH_AES_256_CCM_8 */
>> +    "AES256-GCM-SHA384",                /* =
TLS_RSA_WITH_AES_256_GCM_SHA384 */
>> +    "DH-RSA-AES256-GCM-SHA384",         /* =
TLS_DH_RSA_WITH_AES_256_GCM_SHA384 */
>> +    "DH-DSS-AES256-GCM-SHA384",         /* =
TLS_DH_DSS_WITH_AES_256_GCM_SHA384 */
>> +    "ADH-AES256-GCM-SHA384",            /* =
TLS_DH_anon_WITH_AES_256_GCM_SHA384 */
>> +    "PSK-AES256-GCM-SHA384",            /* =
TLS_PSK_WITH_AES_256_GCM_SHA384 */
>> +    "RSA-PSK-AES256-GCM-SHA384",        /* =
TLS_RSA_PSK_WITH_AES_256_GCM_SHA384 */
>> +    "ECDH-ECDSA-AES256-GCM-SHA384",     /* =
TLS_ECDH_ECDSA_WITH_AES_256_GCM_SHA384 */
>> +    "ECDH-RSA-AES256-GCM-SHA384",       /* =
TLS_ECDH_RSA_WITH_AES_256_GCM_SHA384 */
>> +   =20
>> +    /* blacklisted CAMELLIA128 encrpytion ciphers */
>> +    "CAMELLIA128-SHA",                  /* =
TLS_RSA_WITH_CAMELLIA_128_CBC_SHA */
>> +    "DH-DSS-CAMELLIA128-SHA",           /* =
TLS_DH_DSS_WITH_CAMELLIA_128_CBC_SHA */
>> +    "DH-RSA-CAMELLIA128-SHA",           /* =
TLS_DH_RSA_WITH_CAMELLIA_128_CBC_SHA */
>> +    "DHE-DSS-CAMELLIA128-SHA",          /* =
TLS_DHE_DSS_WITH_CAMELLIA_128_CBC_SHA */
>> +    "DHE-RSA-CAMELLIA128-SHA",          /* =
TLS_DHE_RSA_WITH_CAMELLIA_128_CBC_SHA */
>> +    "ADH-CAMELLIA128-SHA",              /* =
TLS_DH_anon_WITH_CAMELLIA_128_CBC_SHA */
>> +    "ECDHE-ECDSA-CAMELLIA128-SHA256",   /* =
TLS_ECDHE_ECDSA_WITH_CAMELLIA_128_CBC_SHA256 */
>> +    "ECDH-ECDSA-CAMELLIA128-SHA256",    /* =
TLS_ECDH_ECDSA_WITH_CAMELLIA_128_CBC_SHA256 */
>> +    "ECDHE-RSA-CAMELLIA128-SHA256",     /* =
TLS_ECDHE_RSA_WITH_CAMELLIA_128_CBC_SHA256 */
>> +    "ECDH-RSA-CAMELLIA128-SHA256",      /* =
TLS_ECDH_RSA_WITH_CAMELLIA_128_CBC_SHA256 */
>> +    "PSK-CAMELLIA128-SHA256",           /* =
TLS_PSK_WITH_CAMELLIA_128_CBC_SHA256 */
>> +    "DHE-PSK-CAMELLIA128-SHA256",       /* =
TLS_DHE_PSK_WITH_CAMELLIA_128_CBC_SHA256 */
>> +    "RSA-PSK-CAMELLIA128-SHA256",       /* =
TLS_RSA_PSK_WITH_CAMELLIA_128_CBC_SHA256 */
>> +    "ECDHE-PSK-CAMELLIA128-SHA256",     /* =
TLS_ECDHE_PSK_WITH_CAMELLIA_128_CBC_SHA256 */
>> +    "CAMELLIA128-GCM-SHA256",           /* =
TLS_RSA_WITH_CAMELLIA_128_GCM_SHA256 */
>> +    "DH-RSA-CAMELLIA128-GCM-SHA256",    /* =
TLS_DH_RSA_WITH_CAMELLIA_128_GCM_SHA256 */
>> +    "DH-DSS-CAMELLIA128-GCM-SHA256",    /* =
TLS_DH_DSS_WITH_CAMELLIA_128_GCM_SHA256 */
>> +    "ADH-CAMELLIA128-GCM-SHA256",       /* =
TLS_DH_anon_WITH_CAMELLIA_128_GCM_SHA256 */
>> +    "ECDH-ECDSA-CAMELLIA128-GCM-SHA256",/* =
TLS_ECDH_ECDSA_WITH_CAMELLIA_128_GCM_SHA256 */
>> +    "ECDH-RSA-CAMELLIA128-GCM-SHA256",  /* =
TLS_ECDH_RSA_WITH_CAMELLIA_128_GCM_SHA256 */
>> +    "PSK-CAMELLIA128-GCM-SHA256",       /* =
TLS_PSK_WITH_CAMELLIA_128_GCM_SHA256 */
>> +    "RSA-PSK-CAMELLIA128-GCM-SHA256",   /* =
TLS_RSA_PSK_WITH_CAMELLIA_128_GCM_SHA256 */
>> +    "CAMELLIA128-SHA256",               /* =
TLS_RSA_WITH_CAMELLIA_128_CBC_SHA256 */
>> +    "DH-DSS-CAMELLIA128-SHA256",        /* =
TLS_DH_DSS_WITH_CAMELLIA_128_CBC_SHA256 */
>> +    "DH-RSA-CAMELLIA128-SHA256",        /* =
TLS_DH_RSA_WITH_CAMELLIA_128_CBC_SHA256 */
>> +    "DHE-DSS-CAMELLIA128-SHA256",       /* =
TLS_DHE_DSS_WITH_CAMELLIA_128_CBC_SHA256 */
>> +    "DHE-RSA-CAMELLIA128-SHA256",       /* =
TLS_DHE_RSA_WITH_CAMELLIA_128_CBC_SHA256 */
>> +    "ADH-CAMELLIA128-SHA256",           /* =
TLS_DH_anon_WITH_CAMELLIA_128_CBC_SHA256 */
>> +   =20
>> +    /* blacklisted CAMELLIA256 encrpytion ciphers */
>> +    "CAMELLIA256-SHA",                  /* =
TLS_RSA_WITH_CAMELLIA_256_CBC_SHA */
>> +    "DH-RSA-CAMELLIA256-SHA",           /* =
TLS_DH_RSA_WITH_CAMELLIA_256_CBC_SHA */
>> +    "DH-DSS-CAMELLIA256-SHA",           /* =
TLS_DH_DSS_WITH_CAMELLIA_256_CBC_SHA */
>> +    "DHE-DSS-CAMELLIA256-SHA",          /* =
TLS_DHE_DSS_WITH_CAMELLIA_256_CBC_SHA */
>> +    "DHE-RSA-CAMELLIA256-SHA",          /* =
TLS_DHE_RSA_WITH_CAMELLIA_256_CBC_SHA */
>> +    "ADH-CAMELLIA256-SHA",              /* =
TLS_DH_anon_WITH_CAMELLIA_256_CBC_SHA */
>> +    "ECDHE-ECDSA-CAMELLIA256-SHA384",   /* =
TLS_ECDHE_ECDSA_WITH_CAMELLIA_256_CBC_SHA384 */
>> +    "ECDH-ECDSA-CAMELLIA256-SHA384",    /* =
TLS_ECDH_ECDSA_WITH_CAMELLIA_256_CBC_SHA384 */
>> +    "ECDHE-RSA-CAMELLIA256-SHA384",     /* =
TLS_ECDHE_RSA_WITH_CAMELLIA_256_CBC_SHA384 */
>> +    "ECDH-RSA-CAMELLIA256-SHA384",      /* =
TLS_ECDH_RSA_WITH_CAMELLIA_256_CBC_SHA384 */
>> +    "PSK-CAMELLIA256-SHA384",           /* =
TLS_PSK_WITH_CAMELLIA_256_CBC_SHA384 */
>> +    "DHE-PSK-CAMELLIA256-SHA384",       /* =
TLS_DHE_PSK_WITH_CAMELLIA_256_CBC_SHA384 */
>> +    "RSA-PSK-CAMELLIA256-SHA384",       /* =
TLS_RSA_PSK_WITH_CAMELLIA_256_CBC_SHA384 */
>> +    "ECDHE-PSK-CAMELLIA256-SHA384",     /* =
TLS_ECDHE_PSK_WITH_CAMELLIA_256_CBC_SHA384 */
>> +    "CAMELLIA256-SHA256",               /* =
TLS_RSA_WITH_CAMELLIA_256_CBC_SHA256 */
>> +    "DH-DSS-CAMELLIA256-SHA256",        /* =
TLS_DH_DSS_WITH_CAMELLIA_256_CBC_SHA256 */
>> +    "DH-RSA-CAMELLIA256-SHA256",        /* =
TLS_DH_RSA_WITH_CAMELLIA_256_CBC_SHA256 */
>> +    "DHE-DSS-CAMELLIA256-SHA256",       /* =
TLS_DHE_DSS_WITH_CAMELLIA_256_CBC_SHA256 */
>> +    "DHE-RSA-CAMELLIA256-SHA256",       /* =
TLS_DHE_RSA_WITH_CAMELLIA_256_CBC_SHA256 */
>> +    "ADH-CAMELLIA256-SHA256",           /* =
TLS_DH_anon_WITH_CAMELLIA_256_CBC_SHA256 */
>> +    "CAMELLIA256-GCM-SHA384",           /* =
TLS_RSA_WITH_CAMELLIA_256_GCM_SHA384 */
>> +    "DH-RSA-CAMELLIA256-GCM-SHA384",    /* =
TLS_DH_RSA_WITH_CAMELLIA_256_GCM_SHA384 */
>> +    "DH-DSS-CAMELLIA256-GCM-SHA384",    /* =
TLS_DH_DSS_WITH_CAMELLIA_256_GCM_SHA384 */
>> +    "ADH-CAMELLIA256-GCM-SHA384",       /* =
TLS_DH_anon_WITH_CAMELLIA_256_GCM_SHA384 */
>> +    "ECDH-ECDSA-CAMELLIA256-GCM-SHA384",/* =
TLS_ECDH_ECDSA_WITH_CAMELLIA_256_GCM_SHA384 */
>> +    "ECDH-RSA-CAMELLIA256-GCM-SHA384",  /* =
TLS_ECDH_RSA_WITH_CAMELLIA_256_GCM_SHA384 */
>> +    "PSK-CAMELLIA256-GCM-SHA384",       /* =
TLS_PSK_WITH_CAMELLIA_256_GCM_SHA384 */
>> +    "RSA-PSK-CAMELLIA256-GCM-SHA384",   /* =
TLS_RSA_PSK_WITH_CAMELLIA_256_GCM_SHA384 */
>> +   =20
>> +    /* The blacklisted ARIA encrpytion ciphers */
>> +    "ARIA128-SHA256",                   /* =
TLS_RSA_WITH_ARIA_128_CBC_SHA256 */
>> +    "ARIA256-SHA384",                   /* =
TLS_RSA_WITH_ARIA_256_CBC_SHA384 */
>> +    "DH-DSS-ARIA128-SHA256",            /* =
TLS_DH_DSS_WITH_ARIA_128_CBC_SHA256 */
>> +    "DH-DSS-ARIA256-SHA384",            /* =
TLS_DH_DSS_WITH_ARIA_256_CBC_SHA384 */
>> +    "DH-RSA-ARIA128-SHA256",            /* =
TLS_DH_RSA_WITH_ARIA_128_CBC_SHA256 */
>> +    "DH-RSA-ARIA256-SHA384",            /* =
TLS_DH_RSA_WITH_ARIA_256_CBC_SHA384 */
>> +    "DHE-DSS-ARIA128-SHA256",           /* =
TLS_DHE_DSS_WITH_ARIA_128_CBC_SHA256 */
>> +    "DHE-DSS-ARIA256-SHA384",           /* =
TLS_DHE_DSS_WITH_ARIA_256_CBC_SHA384 */
>> +    "DHE-RSA-ARIA128-SHA256",           /* =
TLS_DHE_RSA_WITH_ARIA_128_CBC_SHA256 */
>> +    "DHE-RSA-ARIA256-SHA384",           /* =
TLS_DHE_RSA_WITH_ARIA_256_CBC_SHA384 */
>> +    "ADH-ARIA128-SHA256",               /* =
TLS_DH_anon_WITH_ARIA_128_CBC_SHA256 */
>> +    "ADH-ARIA256-SHA384",               /* =
TLS_DH_anon_WITH_ARIA_256_CBC_SHA384 */
>> +    "ECDHE-ECDSA-ARIA128-SHA256",       /* =
TLS_ECDHE_ECDSA_WITH_ARIA_128_CBC_SHA256 */
>> +    "ECDHE-ECDSA-ARIA256-SHA384",       /* =
TLS_ECDHE_ECDSA_WITH_ARIA_256_CBC_SHA384 */
>> +    "ECDH-ECDSA-ARIA128-SHA256",        /* =
TLS_ECDH_ECDSA_WITH_ARIA_128_CBC_SHA256 */
>> +    "ECDH-ECDSA-ARIA256-SHA384",        /* =
TLS_ECDH_ECDSA_WITH_ARIA_256_CBC_SHA384 */
>> +    "ECDHE-RSA-ARIA128-SHA256",         /* =
TLS_ECDHE_RSA_WITH_ARIA_128_CBC_SHA256 */
>> +    "ECDHE-RSA-ARIA256-SHA384",         /* =
TLS_ECDHE_RSA_WITH_ARIA_256_CBC_SHA384 */
>> +    "ECDH-RSA-ARIA128-SHA256",          /* =
TLS_ECDH_RSA_WITH_ARIA_128_CBC_SHA256 */
>> +    "ECDH-RSA-ARIA256-SHA384",          /* =
TLS_ECDH_RSA_WITH_ARIA_256_CBC_SHA384 */
>> +    "ARIA128-GCM-SHA256",               /* =
TLS_RSA_WITH_ARIA_128_GCM_SHA256 */
>> +    "ARIA256-GCM-SHA384",               /* =
TLS_RSA_WITH_ARIA_256_GCM_SHA384 */
>> +    "DH-DSS-ARIA128-GCM-SHA256",        /* =
TLS_DH_DSS_WITH_ARIA_128_GCM_SHA256 */
>> +    "DH-DSS-ARIA256-GCM-SHA384",        /* =
TLS_DH_DSS_WITH_ARIA_256_GCM_SHA384 */
>> +    "DH-RSA-ARIA128-GCM-SHA256",        /* =
TLS_DH_RSA_WITH_ARIA_128_GCM_SHA256 */
>> +    "DH-RSA-ARIA256-GCM-SHA384",        /* =
TLS_DH_RSA_WITH_ARIA_256_GCM_SHA384 */
>> +    "ADH-ARIA128-GCM-SHA256",           /* =
TLS_DH_anon_WITH_ARIA_128_GCM_SHA256 */
>> +    "ADH-ARIA256-GCM-SHA384",           /* =
TLS_DH_anon_WITH_ARIA_256_GCM_SHA384 */
>> +    "ECDH-ECDSA-ARIA128-GCM-SHA256",    /* =
TLS_ECDH_ECDSA_WITH_ARIA_128_GCM_SHA256 */
>> +    "ECDH-ECDSA-ARIA256-GCM-SHA384",    /* =
TLS_ECDH_ECDSA_WITH_ARIA_256_GCM_SHA384 */
>> +    "ECDH-RSA-ARIA128-GCM-SHA256",      /* =
TLS_ECDH_RSA_WITH_ARIA_128_GCM_SHA256 */
>> +    "ECDH-RSA-ARIA256-GCM-SHA384",      /* =
TLS_ECDH_RSA_WITH_ARIA_256_GCM_SHA384 */
>> +    "PSK-ARIA128-SHA256",               /* =
TLS_PSK_WITH_ARIA_128_CBC_SHA256 */
>> +    "PSK-ARIA256-SHA384",               /* =
TLS_PSK_WITH_ARIA_256_CBC_SHA384 */
>> +    "DHE-PSK-ARIA128-SHA256",           /* =
TLS_DHE_PSK_WITH_ARIA_128_CBC_SHA256 */
>> +    "DHE-PSK-ARIA256-SHA384",           /* =
TLS_DHE_PSK_WITH_ARIA_256_CBC_SHA384 */
>> +    "RSA-PSK-ARIA128-SHA256",           /* =
TLS_RSA_PSK_WITH_ARIA_128_CBC_SHA256 */
>> +    "RSA-PSK-ARIA256-SHA384",           /* =
TLS_RSA_PSK_WITH_ARIA_256_CBC_SHA384 */
>> +    "ARIA128-GCM-SHA256",               /* =
TLS_PSK_WITH_ARIA_128_GCM_SHA256 */
>> +    "ARIA256-GCM-SHA384",               /* =
TLS_PSK_WITH_ARIA_256_GCM_SHA384 */
>> +    "RSA-PSK-ARIA128-GCM-SHA256",       /* =
TLS_RSA_PSK_WITH_ARIA_128_GCM_SHA256 */
>> +    "RSA-PSK-ARIA256-GCM-SHA384",       /* =
TLS_RSA_PSK_WITH_ARIA_256_GCM_SHA384 */
>> +    "ECDHE-PSK-ARIA128-SHA256",         /* =
TLS_ECDHE_PSK_WITH_ARIA_128_CBC_SHA256 */
>> +    "ECDHE-PSK-ARIA256-SHA384",         /* =
TLS_ECDHE_PSK_WITH_ARIA_256_CBC_SHA384 */
>> +
>> +    /* blacklisted SEED encryptions */
>> +    "SEED-SHA",                         /*TLS_RSA_WITH_SEED_CBC_SHA =
*/
>> +    "DH-DSS-SEED-SHA",                  /* =
TLS_DH_DSS_WITH_SEED_CBC_SHA */
>> +    "DH-RSA-SEED-SHA",                  /* =
TLS_DH_RSA_WITH_SEED_CBC_SHA */
>> +    "DHE-DSS-SEED-SHA",                 /* =
TLS_DHE_DSS_WITH_SEED_CBC_SHA */
>> +    "DHE-RSA-SEED-SHA",                 /* =
TLS_DHE_RSA_WITH_SEED_CBC_SHA */              =20
>> +    "ADH-SEED-SHA",                     /* =
TLS_DH_anon_WITH_SEED_CBC_SHA */
>> +
>> +    /* blacklisted KRB5 ciphers */
>> +    "KRB5-DES-CBC-SHA",                 /* TLS_KRB5_WITH_DES_CBC_SHA =
*/
>> +    "KRB5-DES-CBC3-SHA",                /* =
TLS_KRB5_WITH_3DES_EDE_CBC_SHA */
>> +    "KRB5-IDEA-CBC-SHA",                /* =
TLS_KRB5_WITH_IDEA_CBC_SHA */
>> +    "KRB5-DES-CBC-MD5",                 /* TLS_KRB5_WITH_DES_CBC_MD5 =
*/
>> +    "KRB5-DES-CBC3-MD5",                /* =
TLS_KRB5_WITH_3DES_EDE_CBC_MD5 */
>> +    "KRB5-IDEA-CBC-MD5",                /* =
TLS_KRB5_WITH_IDEA_CBC_MD5 */
>> +    "EXP-KRB5-DES-CBC-SHA",             /* =
TLS_KRB5_EXPORT_WITH_DES_CBC_40_SHA */
>> +    "EXP-KRB5-DES-CBC-MD5",             /* =
TLS_KRB5_EXPORT_WITH_DES_CBC_40_MD5 */
>> +    "EXP-KRB5-RC2-CBC-SHA",             /* =
TLS_KRB5_EXPORT_WITH_RC2_CBC_40_SHA */
>> +    "EXP-KRB5-RC2-CBC-MD5",             /* =
TLS_KRB5_EXPORT_WITH_RC2_CBC_40_MD5 */
>> + =20
>> +    /* blacklisted exoticas */
>> +    "DHE-DSS-CBC-SHA",                  /* =
TLS_DHE_DSS_WITH_DES_CBC_SHA */
>> +    "IDEA-CBC-SHA",                     /* TLS_RSA_WITH_IDEA_CBC_SHA =
*/
>> +   =20
>> +    /* not really sure if the following names are correct */
>> +    "SSL3_CK_SCSV",                     /* =
TLS_EMPTY_RENEGOTIATION_INFO_SCSV */
>> +    "SSL3_CK_FALLBACK_SCSV"
>> +};
>> +static size_t RFC7540_names_LEN =3D =
sizeof(RFC7540_names)/sizeof(RFC7540_names[0]);
>> +
>> +
>> +static apr_hash_t *BLCNames;
>> +
>> +static void cipher_init(apr_pool_t *pool)
>> +{
>> +    apr_hash_t *hash =3D apr_hash_make(pool);
>> +    const char *source;
>> +    int i;
>> +   =20
>> +    source =3D "rfc7540";
>> +    for (i =3D 0; i < RFC7540_names_LEN; ++i) {
>> +        apr_hash_set(hash, RFC7540_names[i], APR_HASH_KEY_STRING, =
source);
>> +    }
>> +   =20
>> +    BLCNames =3D hash;
>> +}
>> +
>> +static int cipher_is_blacklisted(const char *cipher, const char =
**psource)
>> +{  =20
>> +    *psource =3D apr_hash_get(BLCNames, cipher, =
APR_HASH_KEY_STRING);
>> +    return !!*psource;
>> +}
>> +
>> =
+/************************************************************************=
*******
>> * Hooks for processing incoming connections:
>> * - pre_conn_before_tls switches SSL off for stream connections
>> * - process_conn take over connection in case of h2
>> @@ -72,12 +420,15 @@ apr_status_t h2_h2_init(apr_pool_t *pool
>>    ap_log_error(APLOG_MARK, APLOG_DEBUG, 0, s, "h2_h2, child_init");
>>    opt_ssl_engine_disable =3D =
APR_RETRIEVE_OPTIONAL_FN(ssl_engine_disable);
>>    opt_ssl_is_https =3D APR_RETRIEVE_OPTIONAL_FN(ssl_is_https);
>> +    opt_ssl_var_lookup =3D APR_RETRIEVE_OPTIONAL_FN(ssl_var_lookup);
>>=20
>> -    if (!opt_ssl_is_https) {
>> +    if (!opt_ssl_is_https || !opt_ssl_var_lookup) {
>>        ap_log_error(APLOG_MARK, APLOG_WARNING, 0, s,
>>                     APLOGNO(02951) "mod_ssl does not seem to be =
enabled");
>>    }
>>=20
>> +    cipher_init(pool);
>> +   =20
>>    return APR_SUCCESS;
>> }
>>=20
>> @@ -94,6 +445,63 @@ int h2_tls_disable(conn_rec *c)
>>    return 0;
>> }
>>=20
>> +int h2_is_security_compliant(conn_rec *c, int require_all)=20
>> +{
>> +    int is_tls =3D h2_h2_is_tls(c);
>> +    h2_config *cfg =3D h2_config_get(c);
>> +
>> +    if (is_tls && h2_config_geti(cfg, H2_CONF_COMPLIANCE) > 0) {
>> +        /* Check TLS connection for RFC 7540 compliance
>> +         */
>> +        apr_pool_t *pool =3D c->pool;
>> +        server_rec *s =3D c->base_server;
>> +        char *val;
>> +       =20
>> +        if (!opt_ssl_var_lookup) {
>> +            /* unable to check */
>> +            return 0;
>> +        }
>> +       =20
>> +        /* Need Tlsv1.2 or higher, rfc 7540, ch. 9.2
>> +         */
>> +        val =3D opt_ssl_var_lookup(pool, s, c, NULL, =
"SSL_PROTOCOL");
>> +        if (val && *val) {
>> +            if (strncmp("TLS", val, 3)=20
>> +                || !strcmp("TLSv1", val)=20
>> +                || !strcmp("TLSv1.1", val)) {
>> +            ap_log_cerror(APLOG_MARK, APLOG_DEBUG, 0, c,
>> +                          "h2_h2(%ld): tls protocol not suitable: =
%s",=20
>> +                          (long)c->id, val);
>> +                return 0;
>> +            }
>> +        }
>> +        else if (require_all) {
>> +            ap_log_cerror(APLOG_MARK, APLOG_DEBUG, 0, c,
>> +                          "h2_h2(%ld): tls protocol is =
indetermined", (long)c->id);
>> +            return 0;
>> +        }
>> +
>> +        /* Check TLS cipher blacklist
>> +         */
>> +        val =3D opt_ssl_var_lookup(pool, s, c, NULL, "SSL_CIPHER");
>> +        if (val && *val) {
>> +            const char *source;
>> +            if (cipher_is_blacklisted(val, &source)) {
>> +                ap_log_cerror(APLOG_MARK, APLOG_DEBUG, 0, c,
>> +                              "h2_h2(%ld): tls cipher %s blacklisted =
by %s",=20
>> +                              (long)c->id, val, source);
>> +                return 0;
>> +            }
>> +        }
>> +        else if (require_all) {
>> +            ap_log_cerror(APLOG_MARK, APLOG_DEBUG, 0, c,
>> +                          "h2_h2(%ld): tls cipher is indetermined", =
(long)c->id);
>> +            return 0;
>> +        }
>> +    }
>> +    return 1;
>> +}
>> +
>> =
/*************************************************************************=
******
>> * Register various hooks
>> */
>>=20
>> Modified: httpd/httpd/trunk/modules/http2/h2_h2.h
>> URL: =
http://svn.apache.org/viewvc/httpd/httpd/trunk/modules/http2/h2_h2.h?rev=3D=
1708593&r1=3D1708592&r2=3D1708593&view=3Ddiff
>> =
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
>> --- httpd/httpd/trunk/modules/http2/h2_h2.h (original)
>> +++ httpd/httpd/trunk/modules/http2/h2_h2.h Wed Oct 14 12:10:11 2015
>> @@ -53,5 +53,16 @@ int h2_tls_disable(conn_rec *c);
>> */
>> void h2_h2_register_hooks(void);
>>=20
>> +/**
>> + * Check if the given connection fulfills the security requirements
>> + * of RFC 7540.
>> + * @param c the connection
>> + * @param require_all !=3D 0 iff any missing connection properties =
make
>> + *    the test fail. For example, a cipher might not have been =
selected while
>> + *    the handshake is still ongoing.
>> + * @return !=3D 0 iff security requirements are met
>> + */
>> +int h2_is_security_compliant(conn_rec *c, int require_all);
>> +
>>=20
>> #endif /* defined(__mod_h2__h2_h2__) */
>>=20
>> Modified: httpd/httpd/trunk/modules/http2/h2_switch.c
>> URL: =
http://svn.apache.org/viewvc/httpd/httpd/trunk/modules/http2/h2_switch.c?r=
ev=3D1708593&r1=3D1708592&r2=3D1708593&view=3Ddiff
>> =
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
>> --- httpd/httpd/trunk/modules/http2/h2_switch.c (original)
>> +++ httpd/httpd/trunk/modules/http2/h2_switch.c Wed Oct 14 12:10:11 =
2015
>> @@ -35,24 +35,12 @@
>> #include "h2_switch.h"
>>=20
>> =
/*************************************************************************=
******
>> - * SSL var lookup
>> - */
>> -APR_DECLARE_OPTIONAL_FN(char *, ssl_var_lookup,
>> -                        (apr_pool_t *, server_rec *,
>> -                         conn_rec *, request_rec *,
>> -                         char *));
>> -static char *(*opt_ssl_var_lookup)(apr_pool_t *, server_rec *,
>> -                                   conn_rec *, request_rec *,
>> -                                   char *);
>> -
>> =
-/************************************************************************=
*******
>> * Once per lifetime init, retrieve optional functions
>> */
>> apr_status_t h2_switch_init(apr_pool_t *pool, server_rec *s)
>> {
>>    (void)pool;
>>    ap_log_error(APLOG_MARK, APLOG_DEBUG, 0, s, "h2_switch init");
>> -    opt_ssl_var_lookup =3D APR_RETRIEVE_OPTIONAL_FN(ssl_var_lookup);
>>=20
>>    return APR_SUCCESS;
>> }
>> @@ -63,7 +51,8 @@ static int h2_protocol_propose(conn_rec
>>                               apr_array_header_t *proposals)
>> {
>>    int proposed =3D 0;
>> -    const char **protos =3D h2_h2_is_tls(c)? h2_tls_protos : =
h2_clear_protos;
>> +    int is_tls =3D h2_h2_is_tls(c);
>> +    const char **protos =3D is_tls? h2_tls_protos : h2_clear_protos;
>>=20
>>    (void)s;
>>    if (strcmp(AP_PROTOCOL_HTTP1, ap_get_protocol(c))) {
>> @@ -74,6 +63,12 @@ static int h2_protocol_propose(conn_rec
>>        return DECLINED;
>>    }
>>=20
>> +    if (!h2_is_security_compliant(c, 0)) {
>> +        ap_log_cerror(APLOG_MARK, APLOG_DEBUG, 0, c,
>> +                      "protocol propose: security requirements not =
met, declined");
>> +        return DECLINED;
>> +    }
>> +   =20
>>    if (r) {
>>        const char *p;
>>        /* So far, this indicates an HTTP/1 Upgrade header initiated
>>=20
>>=20
>>=20
>=20



From dev-return-84285-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Wed Oct 14 18:54:57 2015
Return-Path: <dev-return-84285-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id D34AD18216
	for <apmail-httpd-dev-archive@www.apache.org>; Wed, 14 Oct 2015 18:54:57 +0000 (UTC)
Received: (qmail 27788 invoked by uid 500); 14 Oct 2015 18:54:48 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 27714 invoked by uid 500); 14 Oct 2015 18:54:48 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 27704 invoked by uid 99); 14 Oct 2015 18:54:47 -0000
Received: from Unknown (HELO spamd2-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 14 Oct 2015 18:54:47 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd2-us-west.apache.org (ASF Mail Server at spamd2-us-west.apache.org) with ESMTP id 6F05A1A234A
	for <dev@httpd.apache.org>; Wed, 14 Oct 2015 18:54:47 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd2-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 3
X-Spam-Level: ***
X-Spam-Status: No, score=3 tagged_above=-999 required=6.31
	tests=[HTML_MESSAGE=3, SPF_PASS=-0.001, URIBL_BLOCKED=0.001]
	autolearn=disabled
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd2-us-west.apache.org [10.40.0.9]) (amavisd-new, port 10024)
	with ESMTP id uYRbCRsXGiI1 for <dev@httpd.apache.org>;
	Wed, 14 Oct 2015 18:54:39 +0000 (UTC)
Received: from mail-lf0-f51.google.com (mail-lf0-f51.google.com [209.85.215.51])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id 9D4E520C18
	for <dev@httpd.apache.org>; Wed, 14 Oct 2015 18:54:37 +0000 (UTC)
Received: by lffy185 with SMTP id y185so17145496lff.2
        for <dev@httpd.apache.org>; Wed, 14 Oct 2015 11:54:36 -0700 (PDT)
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=1e100.net; s=20130820;
        h=x-gm-message-state:mime-version:in-reply-to:references:date
         :message-id:subject:from:to:content-type;
        bh=8kiaqUIwJlXbgRCDuQ1IBW5u9upC7DDwa9xQi2oNu74=;
        b=XQARjB+H4c8+UAXcrh+N50/XAgI1722Wbhvk54sGSg86bpn0i/QTE4IjnSYLbYTBLm
         E4wWJAvPLwf2NUfPCWuTwFk/xj9SI5bicSam3FI1m/a+AvafIxzDMU/spNE0jc0GSl04
         3yD2680Ni1BuuIJc/dTfmlPHPovbV7h9LJiaq7z+UTNudzmFONewOfelzglidAhRd1Wi
         8cnrydrhsjCIexfcdZKW/biNyxFIzLhaBwerottHo5mMmEgvh0IptKYqpoG6RVALPnVl
         r/KTsG1OkvDyGbQi+GWfDStBcWpfBHrc1kiaqEQeN9tqecV9/k8yajVYRFAAdtYs/rel
         QKDQ==
X-Gm-Message-State: ALoCoQll/PPo0Zd8zuIYEqxl21TlAv0anZlpJhEOpazg0DUZqmdR4EmGbmvoAXZNCu+W9jNdEWr/
MIME-Version: 1.0
X-Received: by 10.25.152.194 with SMTP id a185mr1628267lfe.122.1444848875834;
 Wed, 14 Oct 2015 11:54:35 -0700 (PDT)
Received: by 10.112.3.36 with HTTP; Wed, 14 Oct 2015 11:54:35 -0700 (PDT)
Received: by 10.112.3.36 with HTTP; Wed, 14 Oct 2015 11:54:35 -0700 (PDT)
In-Reply-To: <20151014150228.3507f1e9@baldur>
References: <EE2ED063-8F6F-4ABA-BE87-49F1751F8D54@jaguNET.com>
	<20151014150228.3507f1e9@baldur>
Date: Wed, 14 Oct 2015 15:54:35 -0300
Message-ID: <CAAcS2GoOe7ytK5kTAJ8brsmQQfgxyT9P7Sz6FZPM=6Y1MdQv-w@mail.gmail.com>
Subject: Re: Thx and merit
From: "Arturo 'Buanzo' Busleiman" <buanzo@buanzo.com.ar>
To: dev@httpd.apache.org
Content-Type: multipart/alternative; boundary=001a114035e6ffabc405221517f6

--001a114035e6ffabc405221517f6
Content-Type: text/plain; charset=UTF-8

My profound respect and gratitude to all the individuals involved in
supporting, developing, testing and documenting h2.

With love and awe,
Buanzo.
On 14 Oct 2015 11:02 am, "Nick Kew" <nick@webthing.com> wrote:

> On Wed, 14 Oct 2015 08:58:48 -0400
> Jim Jagielski <jim@jaguNET.com> wrote:
>
>
> > Once again, I'd like to thank them personally!
>
> +1 to all that, with one small addition.
>
> Apache is about the individuals who participate.  So the
> chief thanks go to Stefan, who is of course now one of us.
> And of course honourable mentions to other developers
> such as your good self.
>
> --
> Nick Kew
>

--001a114035e6ffabc405221517f6
Content-Type: text/html; charset=UTF-8
Content-Transfer-Encoding: quoted-printable

<p dir=3D"ltr">My profound respect and gratitude to all the individuals inv=
olved in supporting, developing, testing and documenting h2.</p>
<p dir=3D"ltr">With love and awe,<br>
Buanzo.<br>
</p>
<div class=3D"gmail_quote">On 14 Oct 2015 11:02 am, &quot;Nick Kew&quot; &l=
t;<a href=3D"mailto:nick@webthing.com">nick@webthing.com</a>&gt; wrote:<br =
type=3D"attribution"><blockquote class=3D"gmail_quote" style=3D"margin:0 0 =
0 .8ex;border-left:1px #ccc solid;padding-left:1ex">On Wed, 14 Oct 2015 08:=
58:48 -0400<br>
Jim Jagielski &lt;jim@jaguNET.com&gt; wrote:<br>
<br>
<br>
&gt; Once again, I&#39;d like to thank them personally!<br>
<br>
+1 to all that, with one small addition.<br>
<br>
Apache is about the individuals who participate.=C2=A0 So the<br>
chief thanks go to Stefan, who is of course now one of us.<br>
And of course honourable mentions to other developers<br>
such as your good self.<br>
<br>
--<br>
Nick Kew<br>
</blockquote></div>

--001a114035e6ffabc405221517f6--

From dev-return-84286-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Wed Oct 14 19:12:49 2015
Return-Path: <dev-return-84286-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 007D818311
	for <apmail-httpd-dev-archive@www.apache.org>; Wed, 14 Oct 2015 19:12:49 +0000 (UTC)
Received: (qmail 90385 invoked by uid 500); 14 Oct 2015 19:12:48 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 90312 invoked by uid 500); 14 Oct 2015 19:12:48 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 90302 invoked by uid 99); 14 Oct 2015 19:12:48 -0000
Received: from Unknown (HELO spamd3-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 14 Oct 2015 19:12:48 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd3-us-west.apache.org (ASF Mail Server at spamd3-us-west.apache.org) with ESMTP id 1874F180A51
	for <dev@httpd.apache.org>; Wed, 14 Oct 2015 19:12:48 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd3-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.011
X-Spam-Level:
X-Spam-Status: No, score=-0.011 tagged_above=-999 required=6.31
	tests=[SPF_PASS=-0.001, T_RP_MATCHES_RCVD=-0.01] autolearn=disabled
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd3-us-west.apache.org [10.40.0.10]) (amavisd-new, port 10024)
	with ESMTP id nficvEXShqLT for <dev@httpd.apache.org>;
	Wed, 14 Oct 2015 19:12:46 +0000 (UTC)
Received: from mailserver.kippdata.de (capsella.kippdata.de [195.227.30.149])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTP id EC31C21114
	for <dev@httpd.apache.org>; Wed, 14 Oct 2015 19:12:45 +0000 (UTC)
Received: from [10.0.110.6] ([192.168.2.104])
	by mailserver.kippdata.de (8.13.5/8.13.5) with ESMTP id t9EJChPH008993
	for <dev@httpd.apache.org>; Wed, 14 Oct 2015 21:12:44 +0200 (CEST)
Subject: Re: Thx and merit
To: dev@httpd.apache.org
References: <EE2ED063-8F6F-4ABA-BE87-49F1751F8D54@jaguNET.com>
From: Rainer Jung <rainer.jung@kippdata.de>
Message-ID: <561EA922.7090206@kippdata.de>
Date: Wed, 14 Oct 2015 21:12:34 +0200
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:38.0) Gecko/20100101
 Thunderbird/38.3.0
MIME-Version: 1.0
In-Reply-To: <EE2ED063-8F6F-4ABA-BE87-49F1751F8D54@jaguNET.com>
Content-Type: text/plain; charset=utf-8; format=flowed
Content-Transfer-Encoding: 7bit

Am 14.10.2015 um 14:58 schrieb Jim Jagielski:
> The ASF is all about recognizing and rewarding merit. The whole
> "Apache Way" started here, with this project, and httpd has always
> been the sort of "guiding light" and example of how Apache projects
> (should) work.
>
> Inclusion of the HTTP/2 implementation for httpd, especially for
> the 2.4.x branch, is a substantial feather in our cap. But we
> would have been far behind the 8-ball if not for the funding by
> the GSM Association on greenbytes GmbH's mod_h2 work, and for
> the donation of that module to the ASF.
>
> Once again, I'd like to thank them personally!

+1 and big thanks to Stefan and Tatsuhiro Tsujikawa.

Looking forward for early adopters experience!

Regards,

Rainer


From dev-return-84287-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Wed Oct 14 19:16:20 2015
Return-Path: <dev-return-84287-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id E14651833A
	for <apmail-httpd-dev-archive@www.apache.org>; Wed, 14 Oct 2015 19:16:19 +0000 (UTC)
Received: (qmail 137 invoked by uid 500); 14 Oct 2015 19:16:19 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 99959 invoked by uid 500); 14 Oct 2015 19:16:19 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 99949 invoked by uid 99); 14 Oct 2015 19:16:19 -0000
Received: from Unknown (HELO spamd4-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 14 Oct 2015 19:16:19 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd4-us-west.apache.org (ASF Mail Server at spamd4-us-west.apache.org) with ESMTP id D5E0EC0257
	for <dev@httpd.apache.org>; Wed, 14 Oct 2015 19:16:18 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd4-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.011
X-Spam-Level:
X-Spam-Status: No, score=-0.011 tagged_above=-999 required=6.31
	tests=[SPF_PASS=-0.001, T_RP_MATCHES_RCVD=-0.01] autolearn=disabled
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd4-us-west.apache.org [10.40.0.11]) (amavisd-new, port 10024)
	with ESMTP id pL0a3KwM48MR for <dev@httpd.apache.org>;
	Wed, 14 Oct 2015 19:16:17 +0000 (UTC)
Received: from mailserver.kippdata.de (capsella.kippdata.de [195.227.30.149])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTP id 9DC5342B59
	for <dev@httpd.apache.org>; Wed, 14 Oct 2015 19:16:17 +0000 (UTC)
Received: from [10.0.110.6] ([192.168.2.104])
	by mailserver.kippdata.de (8.13.5/8.13.5) with ESMTP id t9EJG8Go009019
	for <dev@httpd.apache.org>; Wed, 14 Oct 2015 21:16:09 +0200 (CEST)
Subject: Re: http2 tests
To: dev@httpd.apache.org
References: <F6FE5241-F149-41BF-9EBD-21A7DBD07336@greenbytes.de>
From: Rainer Jung <rainer.jung@kippdata.de>
Message-ID: <561EA9EE.8030401@kippdata.de>
Date: Wed, 14 Oct 2015 21:15:58 +0200
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:38.0) Gecko/20100101
 Thunderbird/38.3.0
MIME-Version: 1.0
In-Reply-To: <F6FE5241-F149-41BF-9EBD-21A7DBD07336@greenbytes.de>
Content-Type: text/plain; charset=utf-8; format=flowed
Content-Transfer-Encoding: 7bit

Am 14.10.2015 um 14:37 schrieb Stefan Eissing:
> Need some advice on how to expand our test framework. We had the problem that current test on 421 return codes failed as the current setup makes that depend on vhosts/other config interference. Undesirable.
>
> Also, I am adding more RFC 7540 compliant behaviour which means mod_http2 will check TLS protocol and ciphers. For this I think mod_http2 needs its own host as I do not want to mess with SSL test setups that need to perform in various environments.
>
> Any advice on how to add a test host (e.g. real port) to our test suite in the most compatible way?

Not answering to your question but related to the thread subject: I 
noticed that the h2 tests do not run in a fixed order. That makes it a 
bit harder to compare test results, because the id of a failed test 
might change. Any idea why the order can change? I had a quick look, but 
didn't find a simple reason.

Regards,

Rainer


From dev-return-84288-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Thu Oct 15 07:01:00 2015
Return-Path: <dev-return-84288-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 20F1718C26
	for <apmail-httpd-dev-archive@www.apache.org>; Thu, 15 Oct 2015 07:01:00 +0000 (UTC)
Received: (qmail 85160 invoked by uid 500); 15 Oct 2015 07:00:56 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 85091 invoked by uid 500); 15 Oct 2015 07:00:56 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 85080 invoked by uid 99); 15 Oct 2015 07:00:56 -0000
Received: from Unknown (HELO spamd1-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 15 Oct 2015 07:00:56 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd1-us-west.apache.org (ASF Mail Server at spamd1-us-west.apache.org) with ESMTP id 4878BC48B6
	for <dev@httpd.apache.org>; Thu, 15 Oct 2015 07:00:56 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd1-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.101
X-Spam-Level:
X-Spam-Status: No, score=-0.101 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	SPF_PASS=-0.001] autolearn=disabled
Authentication-Results: spamd1-us-west.apache.org (amavisd-new);
	dkim=pass (1024-bit key) header.d=beamartyr.net
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd1-us-west.apache.org [10.40.0.7]) (amavisd-new, port 10024)
	with ESMTP id 7BS0Tp4cQX7U for <dev@httpd.apache.org>;
	Thu, 15 Oct 2015 07:00:53 +0000 (UTC)
Received: from mail1.mirimar.net (mail1.mirimar.net [85.195.98.136])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id AC15C2054C
	for <dev@httpd.apache.org>; Thu, 15 Oct 2015 07:00:52 +0000 (UTC)
Received: from [172.17.36.218] (odap-199-203-61-119.bb.netvision.net.il [199.203.61.119])
	(authenticated bits=0)
	by mail1.mirimar.net (8.14.3/8.14.3/Debian-9.1ubuntu1) with ESMTP id t9F70hN0013867
	(version=TLSv1/SSLv3 cipher=DHE-RSA-AES128-SHA bits=128 verify=NO)
	for <dev@httpd.apache.org>; Thu, 15 Oct 2015 09:00:45 +0200
DKIM-Signature: v=1; a=rsa-sha256; c=simple/simple; d=beamartyr.net; s=mail;
	t=1444892446; bh=1obLHvKNbhlA9qzSGiZANTFhrF0n9Pf/Go9O/8VwGaU=;
	h=Message-ID:Date:From:MIME-Version:To:Subject:References:
	 In-Reply-To:Content-Type:Content-Transfer-Encoding;
	b=kr9rIX7Up72bvt/rwHTRLU+HVk3TWHsuPLZ1iHljuboNlVsEJg+//Hxju2gx5zqKA
	 9RFej4h8WTuaG2XAJWkGzKHyPd2LwsgNNCRGXHfzKcDSqoXyHGmWPsxGOitSYdehTw
	 UiTWl7Yxu9gkCMMD5z6wPb2pKHW1M1NQaGGwn7dA=
Message-ID: <561F4F1B.5000900@beamartyr.net>
Date: Thu, 15 Oct 2015 10:00:43 +0300
From: Issac Goldstand <margol@beamartyr.net>
User-Agent: Mozilla/5.0 (Windows NT 6.3; WOW64; rv:31.0) Gecko/20100101 Thunderbird/31.6.0
MIME-Version: 1.0
To: dev@httpd.apache.org
Subject: Re: Thx and merit
References: <EE2ED063-8F6F-4ABA-BE87-49F1751F8D54@jaguNET.com>
In-Reply-To: <EE2ED063-8F6F-4ABA-BE87-49F1751F8D54@jaguNET.com>
Content-Type: text/plain; charset=windows-1252
Content-Transfer-Encoding: 7bit

Big +1

Thanks to all, and especially Stefan (and greenbytes GmbH) for his
continued contribution to pushing http2 support forward!

  Issac

On 10/14/2015 3:58 PM, Jim Jagielski wrote:
> The ASF is all about recognizing and rewarding merit. The whole
> "Apache Way" started here, with this project, and httpd has always
> been the sort of "guiding light" and example of how Apache projects
> (should) work.
> 
> Inclusion of the HTTP/2 implementation for httpd, especially for
> the 2.4.x branch, is a substantial feather in our cap. But we
> would have been far behind the 8-ball if not for the funding by
> the GSM Association on greenbytes GmbH's mod_h2 work, and for
> the donation of that module to the ASF.
> 
> Once again, I'd like to thank them personally!
> 


From dev-return-84289-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Thu Oct 15 20:54:07 2015
Return-Path: <dev-return-84289-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id CE05918218
	for <apmail-httpd-dev-archive@www.apache.org>; Thu, 15 Oct 2015 20:54:07 +0000 (UTC)
Received: (qmail 93947 invoked by uid 500); 15 Oct 2015 20:54:07 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 93876 invoked by uid 500); 15 Oct 2015 20:54:07 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 93866 invoked by uid 99); 15 Oct 2015 20:54:07 -0000
Received: from Unknown (HELO spamd1-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 15 Oct 2015 20:54:07 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd1-us-west.apache.org (ASF Mail Server at spamd1-us-west.apache.org) with ESMTP id D463EC4B88
	for <dev@httpd.apache.org>; Thu, 15 Oct 2015 20:54:06 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd1-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.003
X-Spam-Level:
X-Spam-Status: No, score=-0.003 tagged_above=-999 required=6.31
	tests=[RCVD_IN_MSPIKE_H2=-0.001, SPF_HELO_PASS=-0.001,
	SPF_PASS=-0.001] autolearn=disabled
Received: from mx1-us-west.apache.org ([10.40.0.8])
	by localhost (spamd1-us-west.apache.org [10.40.0.7]) (amavisd-new, port 10024)
	with ESMTP id DyV57EIbsldC for <dev@httpd.apache.org>;
	Thu, 15 Oct 2015 20:54:05 +0000 (UTC)
Received: from na01-bn1-obe.outbound.protection.outlook.com (mail-bn1bbn0103.outbound.protection.outlook.com [157.56.111.103])
	by mx1-us-west.apache.org (ASF Mail Server at mx1-us-west.apache.org) with ESMTPS id 15FE623038
	for <dev@httpd.apache.org>; Thu, 15 Oct 2015 20:54:05 +0000 (UTC)
Authentication-Results: spf=none (sender IP is )
 smtp.mailfrom=paul.spangler@ni.com; 
Received: from [10.2.33.35] (130.164.62.81) by
 BY1PR0401MB1611.namprd04.prod.outlook.com (10.162.211.21) with Microsoft SMTP
 Server (TLS) id 15.1.293.16; Thu, 15 Oct 2015 20:54:03 +0000
Subject: Re: [PATCH 57300] mod_session save optimization
To: Apache Dev <dev@httpd.apache.org>
References: <934f2ef4f2c04d199f3754e24a4b3a64@us-aus-exch5.ni.corp.natinst.com>
From: Paul Spangler <paul.spangler@ni.com>
Message-ID: <56201261.6040707@ni.com>
Date: Thu, 15 Oct 2015 15:53:53 -0500
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:38.0) Gecko/20100101
 Thunderbird/38.2.0
MIME-Version: 1.0
In-Reply-To: <934f2ef4f2c04d199f3754e24a4b3a64@us-aus-exch5.ni.corp.natinst.com>
Content-Type: text/plain; charset="utf-8"; format=flowed
Content-Transfer-Encoding: 7bit
X-Originating-IP: [130.164.62.81]
X-ClientProxiedBy: SN1PR12CA0040.namprd12.prod.outlook.com (25.162.96.178) To
 BY1PR0401MB1611.namprd04.prod.outlook.com (25.162.211.21)
X-Microsoft-Exchange-Diagnostics:
	1;BY1PR0401MB1611;2:nRjT1mKVvSt21ZiCJDzv4nG1oBVEuPQJ3Buflnz826jVYPG25ZfQ5VJJzwx0do6Lzl4h3scEJaGekr56FXX863+9PzIYSAezaI3O2YE34gXxY+GrlcIUK5cPBVLaa3mWFzg7tkzRXt6tVYKnec37TloXCfu88qA5FOAhxaPTA6Q=;3:B/cvDDjFsj/Hgera5kW1QU4LJQg2MkmEaySH5GjOSnkYayH5AT4X1/168a6zoBt45bXm255lVzJ80ymHTerliRzIRRjuaOKhLvjd1+UIFH4ycAnoOqQQMKGNW9gZpLiS41hJ5K4LKRxI1yYLWiO4AQ==;25:PO9T7RYbVX1NLFC5dwupRyyuzsHShPSvOXwsbrjtMVFQ3NTMJeaIvKvKhKxMSBchboz4jce+/U6dHNcI1Z31Mq0i6R4UL/5mIByt1PguMe3ZwiZZK7WaoaJ3vlpWQGIKvfYdaeOcqLytC+ARm3OZ96kUwzFGZt7yUtHavSLg2Q3yRfFpEk6xg6sv+pF5BiQWkUkx/nzHRKvFeRQyTdJyMh0sxT2bvT2N5wqtJHJlfAdrKlaY0IozeRNE56sTzqMYrZpkkt4pkWDa02HjeM6rhQ==
X-Microsoft-Antispam: UriScan:;BCL:0;PCL:0;RULEID:;SRVR:BY1PR0401MB1611;
X-Microsoft-Exchange-Diagnostics:
	1;BY1PR0401MB1611;20:1mOXq0+LjahTxXO3+rg9x1VJQGonfIbEZxTTj6+QfIFdIBvVOHxN1pMt351bWBW/NYtGtOznz/ZvB3ErYb+CrNmNZifaeS6gFKaYcXz+BG2Yof1xkk4cfmpkNtdGcr6NglrN1ioLaPCdN9SD9pAOOKw5Kuu8whD8R+8aYOOpbVwS4r1hsf9VCL7FhqCnQwEPsrVJXtZ75HwMTMwz4UHYA98UEaqlRSx2zXZFvmvy+cN3GsI7okcOH+rO/FQLKzqeAgSlpNph29Wh2ZdzuIYG7ftvSlPz0bCyaJpjMmOKbai13WvoQDWSidbujT7QlB9SnjdfD4WjEqH7UssNP9F1CXcKFHbg8/5p5OPUlBg8WVmzdDa4syBARUdBE4mbe0Sm2inOFsK+P5YdT5FKktIuUu0hiIUO1ZREtSPbHlRvICW+aGNxSAFb5AEGixLHo1z2tUe/NKHXH/SkbmqIk1+/IowZDYQY7QPuniEOhG7Im/jW2H9Lwcto9UwQU8faUoWbrqWEo52dlnYUArKxS3TRT6S2Cgoob3NAd0ejV4HVhy84LH/0p4if1S3djjh3lfB0pY7vyUUW6LeQVZKhsX6CQUVbMnKUNehXgyisB0y4Me8=
X-Microsoft-Antispam-PRVS:
	<BY1PR0401MB161116A896B16CE38DD73527843E0@BY1PR0401MB1611.namprd04.prod.outlook.com>
X-Exchange-Antispam-Report-Test: UriScan:;
X-Exchange-Antispam-Report-CFA-Test:
	BCL:0;PCL:0;RULEID:(601004)(2401047)(8121501046)(5005006)(520078)(3002001);SRVR:BY1PR0401MB1611;BCL:0;PCL:0;RULEID:;SRVR:BY1PR0401MB1611;
X-Microsoft-Exchange-Diagnostics:
	1;BY1PR0401MB1611;4:MIAYfKnm9o8amrSJMxrKzHcpJq8SI1JUlaxYHaB1sQtO/6SlmhtSEI5EcYdKCQBdxO+maOE24Bq3CxIX5KdmsTGUrIOGX1dq3vTFX82TyH/gW7XN7Q6XuU1o6bjlU62YjkZQ9dINOIZgO6eB+DLqJguHMXgSxLYWn+jIrVFSxCe6VAVTvRwo/9DLaH6DxK77p+cEvTnPqHNeVSoXYILij74Q9qO+QU92SmSFVn0LiFNLJjts1Edjz4GJrXE5oUaR0s43zz4g9YFhW8xRWrX5aLVVH5YU/QLUzpGoaEqKz4pTlyvnzAP4olwVk//gLvNZCw4taZWQt/vuo1SxiFSN2PFDa2QfvYz94i7Bv0gRW0I=
X-Forefront-PRVS: 0730093765
X-Forefront-Antispam-Report:
	SFV:NSPM;SFS:(10019020)(6049001)(6009001)(377454003)(479174004)(24454002)(199003)(189002)(5007970100001)(47776003)(77096005)(105586002)(15975445007)(86362001)(5004730100002)(2950100001)(42186005)(40100003)(92566002)(59896002)(117636001)(83506001)(66066001)(64706001)(36756003)(122386002)(46102003)(5008740100001)(65956001)(54356999)(23676002)(87976001)(19580395003)(101416001)(450100001)(65806001)(99136001)(106356001)(81156007)(107886002)(65816999)(64126003)(50986999)(50466002)(110136002)(4001350100001)(189998001)(97736004)(5001960100002)(76176999)(87266999)(62816006);DIR:OUT;SFP:1102;SCL:1;SRVR:BY1PR0401MB1611;H:[10.2.33.35];FPR:;SPF:None;PTR:InfoNoRecords;A:1;MX:1;LANG:en;
Received-SPF: None (protection.outlook.com: ni.com does not designate
 permitted sender hosts)
X-Microsoft-Exchange-Diagnostics:
	=?utf-8?B?MTtCWTFQUjA0MDFNQjE2MTE7MjM6MUYyVW5VcHZkeTNSbENrWWd0U3djelFt?=
 =?utf-8?B?Zk45SjJPS1oyb0xxd2RhT3NXelJTeWE1eFMreWRxTStrTnNKRm44Yjd1VVFQ?=
 =?utf-8?B?SVM3YzlINldLclBHVGZOOXI3eDZQcFE4bnBpU0kzbis5SW1uYmFxZG95T2d5?=
 =?utf-8?B?d3dOUTVyUHJtOTF0bWEyR2J4QnRFY1lNYXZob1FSL2F4dnJQS0JxTXM3OFND?=
 =?utf-8?B?bXpoWFBlOEx0YVFkMC9UYTVhNzJNVTlOK0lJUXJZKzI0N05FcjdyemwwWEk5?=
 =?utf-8?B?cnBWWjNhMEFkT2lVZkU0dE10VDhWTUFMMEdkMnV3OHdRVzJ2R1FwTGkrOW95?=
 =?utf-8?B?TXU0Wml5VHcrUzYzdTZVd1RlUWRnYzNZd21oY0RDRU5pRlhMQVAyNTZjR3Zt?=
 =?utf-8?B?REUvNGFrVWV3Tm96NDdaTm1hQXAvY3gvZ2NIdXhwYm9Yc25DdERDTDUvZXJn?=
 =?utf-8?B?bXZVWHlVemFKZm1jS08vQlh1SUZiZGhIdXlyWEF3S0tEWTd2MUxmcFQ4SzJB?=
 =?utf-8?B?WDdoL0ZpYjEyQ29UOFhDNGVQczU5ZUtmUloxR0RaSmJBekpkUFVGL2p0SnM2?=
 =?utf-8?B?dmhnV1ErK1Q0UkRYeE9nT3haaHhwMHpKajFhVndMYWNzcXJuV1EwYzJzMTJn?=
 =?utf-8?B?VXFDbmR4ZFJlOTArT2VzSjNDVDcyYU43Z3NsMFZ6czhHQ1A4NVh5TVJrNjVw?=
 =?utf-8?B?RXVqTXlJcHZ5aGR2dENuMUVRcUUxRHhodUZ2YldtTWFvNEVVZzcwUy9rSENM?=
 =?utf-8?B?UFdzU2JiVVFVeitsTHNjTU40QnpqS2daZjhCMnMzVTlzN3pRWlc5WmEzWDdo?=
 =?utf-8?B?ak1WUmU0QnIwN3c1M3RncnAwcXlEdW51QU9GNlZQVzFIYVNIQ3JYc3pBdUl6?=
 =?utf-8?B?RDBDVm0xcFBsa3hsWXRiQSt5R0NybFZnSXZ5MDl6VUczOUY1MTNJWGJ0c3pO?=
 =?utf-8?B?c1lBeVdKNXo3NlZJQ01pL3RxZldtTi9Xdmc5VEVabDFwcFZDenZMUlR6VGVa?=
 =?utf-8?B?Yk12TzVOWnR2SzJvdklXSDVaR1ROTDRXdVVIc2wza3JBNG9IWDkwMHg4bGF2?=
 =?utf-8?B?ellnL0tiZldwUEM1emxXTDQ1STlVNGptS1Q4OVdOazF1bEgrOVpOcGVUeFc3?=
 =?utf-8?B?MS85WDBvUnFpMTdOZkdkZXY2NHVPbGVpSkZINXQ3Z2VPK0VSZlM0MkRxdUIx?=
 =?utf-8?B?clpRekJGSWthZ2h2MlJ1RnVkS1ppVXpyRmNrck5nOFJtbUpxNTZHMVJMcEpr?=
 =?utf-8?B?TkNPSDdocU8rVlJZejkwN21tMUdlSUgrZk9TekdtNkJ5VzJmVHZJcFljbU9z?=
 =?utf-8?B?dk9sMUFLU0pFbDc3emV2a1NJTmZEY1JhcldKTlRmZFhZMThIbVQ2RmhuUWJT?=
 =?utf-8?B?c0xENGtZbUR6M2MxaEt0WWFCd2VJcFllTWNUMDVFS2lpVjhvdDY1c1FUU3cv?=
 =?utf-8?B?WittOUNZRzdUTE1iYVEzdE51LytSdTlJaVU3YjcyaEgwVGIrb0ZhNml3S1d1?=
 =?utf-8?B?cllZb3JBNFRKMnd1QXNNYlMxaXVaUzZNWS9neUlZQ3RGdnBnYURDd3dXL2ZG?=
 =?utf-8?B?UjdZcGwwRnp2dnBiUmV5elp6VXJia3dmbzU2eW9BdjJLUy9rVDhNZkxCTFRi?=
 =?utf-8?B?Z1dZcGNuMElOM09TS0hIUHBBbXdBV3lHU1ZWT0x3UldyQSs5eGs3Q2VDL3NC?=
 =?utf-8?B?c1pLT0V6Si9LQWMyRWx6dWpueFRBODg0SStXcUpWME56LytMV3pkejQ4VC9J?=
 =?utf-8?B?SElZbHVtSmxjcHJxS1ZzM1pKK1doWGFpZGdxOU9JenlvTk1aWkcxSmJXb3p0?=
 =?utf-8?Q?QwlvQi8BPHwbafq?=
X-Microsoft-Exchange-Diagnostics:
	1;BY1PR0401MB1611;5:txjhrokiPFIJwmK06pp1oeeFg7YeT6bJcTUp0gQ3PWszLJm6jv50T6dztDu3M1IjW9DhIM0zJGZCMvHTP6BjPzXORc1Gl8Jx+osgJsAy889jyD3jTDC31tFriHvYd7O2NJmEjsRmLCDzBmRP0E0p+w==;24:qKseGdkGBrtU+XqWN/0Hufo0odYEd2bzH8oRsTK+A79cDGi0QCm9Sd1NJOTYCNW9Ctz4tJMjGCzjDGXL3wfDHF6paLJMlWmmfpKFsEfxT8Q=;20:ukDQCiN1p+2DvQD3JTd7GDH1QLUGB+AFrspqAHCqmoIj0Pl0+ailJul7Zw164FAU2nk9udT2qk8s2M6xv5phjA==
SpamDiagnosticOutput: 1:23
SpamDiagnosticMetadata: NSPM
X-OriginatorOrg: ni.com
X-MS-Exchange-CrossTenant-OriginalArrivalTime: 15 Oct 2015 20:54:03.1888 (UTC)
X-MS-Exchange-CrossTenant-FromEntityHeader: Hosted
X-MS-Exchange-Transport-CrossTenantHeadersStamped: BY1PR0401MB1611

On 8/20/2015 4:58 PM, Paul Spangler wrote:
> Hello,
>
> The bug report contains a more detailed explanation of the patch, but
> there are some points I thought might lead to some discussion.
>
> First a quick summary of the issue: mod_session writes out the session
> every request even if there aren't any changes to the data. This makes
> some sense when the session has a max age and the expiry value needs to
> be refreshed. However, there isn't likely to be much benefit in
> repeatedly refreshing the expiry by a few milliseconds, possibly
> generating database traffic each time. This patch proposes a new
> directive to define an interval of time where the expiry doesn't need to
> be refreshed if there are no session data changes.
>
> 1. We had a hard time coming up with a name for the directive. The patch
> goes with SessionExpiryUpdateInterval, being the interval of time that
> may pass before updating the expiry value is required. I don't know if
> there are any existing directives with a similar function that we should
> mimic instead.
>
> 2. The patch includes a behavior change independent of the new directive
> when using sessions without a max age: if the data hasn't changed, don't
> write out the session. Most noticeably, this means new sessions that
> never get data are discarded without being saved.
>
> 3. I wasn't sure how best to add tests for a new directive since the
> test server won't start if the directive is missing. The patch that
> includes the test changes look for the 2.5 version to know the new
> directive is there, and will require a modification if/when the
> directive is back-ported to 2.4 to enable the new tests.
>
> https://bz.apache.org/bugzilla/show_bug.cgi?id=57300
>
> Thanks for your consideration.
>
Bump in case anyone is interested now that the list has died down a bit.

-- 
Paul Spangler
LabVIEW R&D
National Instruments

From dev-return-84290-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Fri Oct 16 03:53:48 2015
Return-Path: <dev-return-84290-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id C616F18FB5
	for <apmail-httpd-dev-archive@www.apache.org>; Fri, 16 Oct 2015 03:53:48 +0000 (UTC)
Received: (qmail 69498 invoked by uid 500); 16 Oct 2015 03:53:48 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 69418 invoked by uid 500); 16 Oct 2015 03:53:48 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 69408 invoked by uid 99); 16 Oct 2015 03:53:47 -0000
Received: from Unknown (HELO spamd2-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 16 Oct 2015 03:53:47 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd2-us-west.apache.org (ASF Mail Server at spamd2-us-west.apache.org) with ESMTP id 6F29B1A2AF4
	for <dev@httpd.apache.org>; Fri, 16 Oct 2015 03:53:47 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd2-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.102
X-Spam-Level:
X-Spam-Status: No, score=-0.102 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RCVD_IN_MSPIKE_H2=-0.001, SPF_PASS=-0.001] autolearn=disabled
Authentication-Results: spamd2-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-us-west.apache.org ([10.40.0.8])
	by localhost (spamd2-us-west.apache.org [10.40.0.9]) (amavisd-new, port 10024)
	with ESMTP id AssPhnWcBuZR for <dev@httpd.apache.org>;
	Fri, 16 Oct 2015 03:53:46 +0000 (UTC)
Received: from mail-io0-f170.google.com (mail-io0-f170.google.com [209.85.223.170])
	by mx1-us-west.apache.org (ASF Mail Server at mx1-us-west.apache.org) with ESMTPS id E42D52324F
	for <dev@httpd.apache.org>; Fri, 16 Oct 2015 03:53:45 +0000 (UTC)
Received: by iodv82 with SMTP id v82so111607883iod.0
        for <dev@httpd.apache.org>; Thu, 15 Oct 2015 20:53:45 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=mime-version:date:message-id:subject:from:to:content-type;
        bh=ng2Gs3PCFVQf64uxYFZGvK8Lz8Os3uKz6eqzQ/p6AH8=;
        b=0IGo9kr83WYPUuE9wLd3tAna+obUHU26mat2mWeGvh56XHup8GNXbLHV64aaHQjfep
         Cf0/3cjX0sNt6ZIvpPx6pck1qnP/WcAUbt4mqw/Z1vILyBpJ4A4OvrYqUgz3PhCv4JcV
         JFzh6x4Ow3pBpV/1wQYs9K98l4NoLTDgTkb6Qwv1HjXWigMagn17SKJvWU5A5ott1hix
         M+Apx3T9nH1ZFCJrwJ27mbfuLDn51PKakB1G9p99A0KL0guvDUgEwuoBLcZneYznRyCR
         BQro6gUxz3wYNo8myhdA2mopwH+NIFwu1yK39oe9QraYvo32t760aXO0VMG9loHEFc5x
         Mv+w==
MIME-Version: 1.0
X-Received: by 10.107.134.198 with SMTP id q67mr14895726ioi.90.1444967625414;
 Thu, 15 Oct 2015 20:53:45 -0700 (PDT)
Received: by 10.64.25.3 with HTTP; Thu, 15 Oct 2015 20:53:45 -0700 (PDT)
Date: Thu, 15 Oct 2015 23:53:45 -0400
Message-ID: <CALK=YjMWSTLMzr=5nKws8M8=CkrhqQJ8S1xCgyQycms-V1pNDQ@mail.gmail.com>
Subject: 2.4.17 alignment issue sparc/ia64
From: Eric Covener <covener@gmail.com>
To: Apache HTTP Server Development List <dev@httpd.apache.org>
Content-Type: text/plain; charset=UTF-8

We recently merged 2.4.17 and saw some bus errors on hp/ia64 and
solaris/sparc64. Selectively backing things out, it appears that the
SO_REUSEPORT patch causes the worker_score to no longer (necessarily)
be double-word aligned.

I'm able to hit the same thing with the httpd-2.4.x branch.  I have a
particular config that I can start with:

/bin/apachectl  -f conf/testcase.conf -k start -c "ServerLimit 1" -DNO_DETACH
or
/bin/apachectl  -f conf/testcase.conf -k start -c "ServerLimit 2" -DNO_DETACH

And the former will get a bus error and the latter will not.

(stuff from my draft email below is not vanilla httpd-2.4.x)

t@1 (l@1) program terminated by signal BUS (Bus Error)
Current function is update_child_status_internal
  479           ws->last_used = apr_time_now();
(dbx) where
current thread: t@1
=>[1] update_child_status_internal(child_num = 0, thread_num = 0,
status = 0, c = (nil), r = (nil)), line 479 in "scoreboard.c"
  [2] ap_update_child_status_from_indexes(child_num = 0, thread_num =
0, status = 0, r = (nil)), line 529 in "scoreboard.c"
  [3] server_main_loop(remaining_children_to_start = 0, num_buckets =
1), line 1879 in "worker.c"
  [4] worker_run(_pconf = 0x100205f68, plog = 0x100234158, s =
0x10020e340), line 2056 in "worker.c"
  [5] ap_run_mpm(0x100205f68, 0x100234158, 0x10020e340, 0x5, 0x0,
0x0), at 0x10005a8a4
  [6] main(argc = 7, argv = 0xffffffff7ffff7f8), line 878 in "main.c"
(dbx)
(dbx) print ws
ws = 0xffffffff7bb00044
(dbx) print &(ws->last_used)
&ws->last_used = 0xffffffff7bb00094

(both of these are unaligned, when I log their values w/o the
SO_REUSEPORT they're always aligned)

Experimentation is SLOW on my sparc system, so I thought I'd throw up
a flare for help sooner rather than later in case anyone has a clue.
I hope to be able to try to back out some more things on the vanilla
httpd-2.4.x

-- 
Eric Covener
covener@gmail.com

From dev-return-84291-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Fri Oct 16 06:18:18 2015
Return-Path: <dev-return-84291-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id BE137102C6
	for <apmail-httpd-dev-archive@www.apache.org>; Fri, 16 Oct 2015 06:18:18 +0000 (UTC)
Received: (qmail 50442 invoked by uid 500); 16 Oct 2015 06:18:18 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 50374 invoked by uid 500); 16 Oct 2015 06:18:18 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 50362 invoked by uid 99); 16 Oct 2015 06:18:18 -0000
Received: from Unknown (HELO spamd1-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 16 Oct 2015 06:18:18 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd1-us-west.apache.org (ASF Mail Server at spamd1-us-west.apache.org) with ESMTP id DB47DC1297
	for <dev@httpd.apache.org>; Fri, 16 Oct 2015 06:18:17 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd1-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.121
X-Spam-Level:
X-Spam-Status: No, score=-0.121 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RCVD_IN_MSPIKE_H3=-0.01, RCVD_IN_MSPIKE_WL=-0.01, SPF_PASS=-0.001]
	autolearn=disabled
Authentication-Results: spamd1-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd1-us-west.apache.org [10.40.0.7]) (amavisd-new, port 10024)
	with ESMTP id keNvGM-99rV0 for <dev@httpd.apache.org>;
	Fri, 16 Oct 2015 06:18:16 +0000 (UTC)
Received: from mail-pa0-f45.google.com (mail-pa0-f45.google.com [209.85.220.45])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id 15F6C2054C
	for <dev@httpd.apache.org>; Fri, 16 Oct 2015 06:18:16 +0000 (UTC)
Received: by pabrc13 with SMTP id rc13so110892496pab.0
        for <dev@httpd.apache.org>; Thu, 15 Oct 2015 23:18:09 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=subject:to:references:from:message-id:date:user-agent:mime-version
         :in-reply-to:content-type:content-transfer-encoding;
        bh=x7ae36/VgTbvoYh9Kh71tf/Pk/iWxQlWDixJCKJjslo=;
        b=H8yDcp277SmJ30dgBP4pRkV+ujwN4+nIYJQfzsy0CEr8m9xlQMFrsB2Y2jZeLzoxC2
         q4COQuACGzWBkt2pxwvyPWYUNN6KY43HLK9KHXCvRzXSatLx9Kqe45cO2d+2jDWY6BjW
         d5AoXZ+BqLICLwZlRmBDePD7CYE1hX4n2soTjs2dG3yANDlRPGDhuIwWO9aQ8AsYyotL
         8/LT/qM0I93J1Zv0UnT6BcEnG6qoMYKsOh4SlGae9pYo8XQJa+Q7FnFd+VebGSSEpgP+
         X1/9RDmLY3WjbIw4ph2uyuhV675I34HNSODiISp/uQJte7H29nDxesMqkpkK1Cca+rjb
         C/3w==
X-Received: by 10.68.244.34 with SMTP id xd2mr14766490pbc.0.1444976289208;
        Thu, 15 Oct 2015 23:18:09 -0700 (PDT)
Received: from [192.168.1.4] (static-50-43-55-221.bvtn.or.frontiernet.net. [50.43.55.221])
        by smtp.gmail.com with ESMTPSA id xm4sm19049059pab.27.2015.10.15.23.18.07
        for <dev@httpd.apache.org>
        (version=TLSv1.2 cipher=ECDHE-RSA-AES128-GCM-SHA256 bits=128/128);
        Thu, 15 Oct 2015 23:18:08 -0700 (PDT)
Subject: Re: 2.4.17 alignment issue sparc/ia64
To: dev@httpd.apache.org
References: <CALK=YjMWSTLMzr=5nKws8M8=CkrhqQJ8S1xCgyQycms-V1pNDQ@mail.gmail.com>
From: Jacob Champion <champion.p@gmail.com>
Message-ID: <5620969E.7030303@gmail.com>
Date: Thu, 15 Oct 2015 23:18:06 -0700
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:38.0) Gecko/20100101
 Thunderbird/38.3.0
MIME-Version: 1.0
In-Reply-To: <CALK=YjMWSTLMzr=5nKws8M8=CkrhqQJ8S1xCgyQycms-V1pNDQ@mail.gmail.com>
Content-Type: text/plain; charset=utf-8; format=flowed
Content-Transfer-Encoding: 7bit

On 10/15/2015 08:53 PM, Eric Covener wrote:
> We recently merged 2.4.17 and saw some bus errors on hp/ia64 and
> solaris/sparc64. Selectively backing things out, it appears that the
> SO_REUSEPORT patch causes the worker_score to no longer (necessarily)
> be double-word aligned.

I don't have any experience with either Solaris or SPARC, but the size 
of struct process_score increased by one int with git commit 01bb7186, 
and it looks like ap_init_scoreboard() doesn't try to maintain any 
particular alignment when it's assigning pointers from more_storage.

Maybe that could be your issue? Spitballing here, but is your 
ServerLimit an odd number, and does changing it to be an even number fix 
the problem?

Hope this helps,
--Jacob

From dev-return-84292-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Fri Oct 16 06:25:26 2015
Return-Path: <dev-return-84292-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id D35BC102E7
	for <apmail-httpd-dev-archive@www.apache.org>; Fri, 16 Oct 2015 06:25:26 +0000 (UTC)
Received: (qmail 58230 invoked by uid 500); 16 Oct 2015 06:25:26 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 58172 invoked by uid 500); 16 Oct 2015 06:25:26 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 58162 invoked by uid 99); 16 Oct 2015 06:25:26 -0000
Received: from Unknown (HELO spamd3-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 16 Oct 2015 06:25:26 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd3-us-west.apache.org (ASF Mail Server at spamd3-us-west.apache.org) with ESMTP id D31DE1809BF
	for <dev@httpd.apache.org>; Fri, 16 Oct 2015 06:25:25 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd3-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.102
X-Spam-Level:
X-Spam-Status: No, score=-0.102 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RCVD_IN_MSPIKE_H2=-0.001, SPF_PASS=-0.001] autolearn=disabled
Authentication-Results: spamd3-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd3-us-west.apache.org [10.40.0.10]) (amavisd-new, port 10024)
	with ESMTP id VJY_yHPwIlHT for <dev@httpd.apache.org>;
	Fri, 16 Oct 2015 06:25:25 +0000 (UTC)
Received: from mail-pa0-f53.google.com (mail-pa0-f53.google.com [209.85.220.53])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id 0EFBD42ABE
	for <dev@httpd.apache.org>; Fri, 16 Oct 2015 06:25:25 +0000 (UTC)
Received: by payp3 with SMTP id p3so63450106pay.1
        for <dev@httpd.apache.org>; Thu, 15 Oct 2015 23:25:24 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=subject:to:references:from:message-id:date:user-agent:mime-version
         :in-reply-to:content-type:content-transfer-encoding;
        bh=9UVod3G3gH9D4iu6C43s3yCmdPyMx9UXbLalPv0EVdY=;
        b=R5+2GKHQssnrxJA8+5lr80J+h9KkUJk5ViloeG1b1UlyIPhV5vdt9FI+dT5BTMxQ9j
         AUZAW4SJ/tsTFpDpisSGOvB8dRqhf15+Bzas5vvWrwnJeaOfHFkOxaeibxhUEg2DOW1s
         Flbs48sIsGmZGvUwzgJrkex7s7p6AmJTJEg+tOeBOQHirZXII+HCNze7Iu0cNPF/IW28
         cCeOV1at0JSBDyS1ynp1OIxVFgRmf8A6Okf2vMwb/1r2eZrbvN64Xv3BUFGhohGbTKMg
         gYoYxJ55tgqwijayui0BghaLd23DIfe6IvZCu1/YSJvv46wqt752oJFDSTjOIag3H0dX
         kHtQ==
X-Received: by 10.68.139.100 with SMTP id qx4mr7195699pbb.149.1444976724379;
        Thu, 15 Oct 2015 23:25:24 -0700 (PDT)
Received: from [192.168.1.4] (static-50-43-55-221.bvtn.or.frontiernet.net. [50.43.55.221])
        by smtp.gmail.com with ESMTPSA id of1sm18991649pbc.11.2015.10.15.23.25.22
        for <dev@httpd.apache.org>
        (version=TLSv1.2 cipher=ECDHE-RSA-AES128-GCM-SHA256 bits=128/128);
        Thu, 15 Oct 2015 23:25:23 -0700 (PDT)
Subject: Re: 2.4.17 alignment issue sparc/ia64
To: dev@httpd.apache.org
References: <CALK=YjMWSTLMzr=5nKws8M8=CkrhqQJ8S1xCgyQycms-V1pNDQ@mail.gmail.com>
 <5620969E.7030303@gmail.com>
From: Jacob Champion <champion.p@gmail.com>
Message-ID: <56209851.6020002@gmail.com>
Date: Thu, 15 Oct 2015 23:25:21 -0700
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:38.0) Gecko/20100101
 Thunderbird/38.3.0
MIME-Version: 1.0
In-Reply-To: <5620969E.7030303@gmail.com>
Content-Type: text/plain; charset=utf-8; format=flowed
Content-Transfer-Encoding: 7bit

On 10/15/2015 11:18 PM, Jacob Champion wrote:
> it looks like ap_init_scoreboard() doesn't try to maintain any
> particular alignment when it's assigning pointers from more_storage.

Though one would think your compiler would be padding out the struct to 
a double-word multiple anyway. Hrm.

--Jacob


From dev-return-84293-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Fri Oct 16 07:23:41 2015
Return-Path: <dev-return-84293-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id A98DD10501
	for <apmail-httpd-dev-archive@www.apache.org>; Fri, 16 Oct 2015 07:23:41 +0000 (UTC)
Received: (qmail 38223 invoked by uid 500); 16 Oct 2015 07:23:41 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 38141 invoked by uid 500); 16 Oct 2015 07:23:41 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 38131 invoked by uid 99); 16 Oct 2015 07:23:41 -0000
Received: from Unknown (HELO spamd2-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 16 Oct 2015 07:23:41 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd2-us-west.apache.org (ASF Mail Server at spamd2-us-west.apache.org) with ESMTP id C99011A25BE
	for <dev@httpd.apache.org>; Fri, 16 Oct 2015 07:23:40 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd2-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.011
X-Spam-Level:
X-Spam-Status: No, score=-0.011 tagged_above=-999 required=6.31
	tests=[SPF_PASS=-0.001, T_RP_MATCHES_RCVD=-0.01] autolearn=disabled
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd2-us-west.apache.org [10.40.0.9]) (amavisd-new, port 10024)
	with ESMTP id pUQb20anzmKK for <dev@httpd.apache.org>;
	Fri, 16 Oct 2015 07:23:39 +0000 (UTC)
Received: from mailserver.kippdata.de (capsella.kippdata.de [195.227.30.149])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTP id 0521542B59
	for <dev@httpd.apache.org>; Fri, 16 Oct 2015 07:23:38 +0000 (UTC)
Received: from [10.0.110.6] ([192.168.2.104])
	by mailserver.kippdata.de (8.13.5/8.13.5) with ESMTP id t9G7Nb4j029236
	for <dev@httpd.apache.org>; Fri, 16 Oct 2015 09:23:37 +0200 (CEST)
Subject: Re: 2.4.17 alignment issue sparc/ia64
To: dev@httpd.apache.org
References: <CALK=YjMWSTLMzr=5nKws8M8=CkrhqQJ8S1xCgyQycms-V1pNDQ@mail.gmail.com>
 <5620969E.7030303@gmail.com> <56209851.6020002@gmail.com>
From: Rainer Jung <rainer.jung@kippdata.de>
Message-ID: <5620A5EE.7020608@kippdata.de>
Date: Fri, 16 Oct 2015 09:23:26 +0200
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:38.0) Gecko/20100101
 Thunderbird/38.3.0
MIME-Version: 1.0
In-Reply-To: <56209851.6020002@gmail.com>
Content-Type: text/plain; charset=utf-8; format=flowed
Content-Transfer-Encoding: 7bit

Am 16.10.2015 um 08:25 schrieb Jacob Champion:
> On 10/15/2015 11:18 PM, Jacob Champion wrote:
>> it looks like ap_init_scoreboard() doesn't try to maintain any
>> particular alignment when it's assigning pointers from more_storage.
>
> Though one would think your compiler would be padding out the struct to
> a double-word multiple anyway. Hrm.

I had not yet fully read Erics mail, but the compiler would pad which 
does not help, once the stuff moves into shared memory under an address 
that is not divisible by 8. If the 64 bit struct member is then accessed 
directly in shared memory without first copying out, you would get a bus 
error.

Regards,

Rainer

From dev-return-84294-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Fri Oct 16 08:02:23 2015
Return-Path: <dev-return-84294-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 6D61210603
	for <apmail-httpd-dev-archive@www.apache.org>; Fri, 16 Oct 2015 08:02:23 +0000 (UTC)
Received: (qmail 98193 invoked by uid 500); 16 Oct 2015 08:02:23 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 98119 invoked by uid 500); 16 Oct 2015 08:02:22 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 98108 invoked by uid 99); 16 Oct 2015 08:02:22 -0000
Received: from Unknown (HELO spamd4-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 16 Oct 2015 08:02:22 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd4-us-west.apache.org (ASF Mail Server at spamd4-us-west.apache.org) with ESMTP id 7AB03C0DCD
	for <dev@httpd.apache.org>; Fri, 16 Oct 2015 08:02:22 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd4-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.102
X-Spam-Level:
X-Spam-Status: No, score=-0.102 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RCVD_IN_MSPIKE_H2=-0.001, SPF_PASS=-0.001] autolearn=disabled
Authentication-Results: spamd4-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd4-us-west.apache.org [10.40.0.11]) (amavisd-new, port 10024)
	with ESMTP id 4UBRkRT65IcV for <dev@httpd.apache.org>;
	Fri, 16 Oct 2015 08:02:21 +0000 (UTC)
Received: from mail-qg0-f43.google.com (mail-qg0-f43.google.com [209.85.192.43])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id 28F9242ABE
	for <dev@httpd.apache.org>; Fri, 16 Oct 2015 08:02:21 +0000 (UTC)
Received: by qgt47 with SMTP id 47so92839086qgt.2
        for <dev@httpd.apache.org>; Fri, 16 Oct 2015 01:02:15 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        bh=dmave4QPxdej0XIB25lE7vcXvms3WQgAnnzaCkmAYXA=;
        b=Uv0+E/Oi1nZ/5uh73PU/WBEJO3q61ZiW4lSIZBtMi+yrQp2fCnmCu7CnFRqlVyLkqZ
         gSTIfos6RyN2Qm5smgppUfLTB4+rjPLdhjlgVDcmcccdwzZp6XQkpB+vUqn2grLNt2+Y
         /+ZX6k78xZ58jbsD76lTxhgUlr0N4Y9c433FZ7+I1AoAnQx+6H6t87eaw617/wn+kmhT
         3vNbNa5Jyk8QEZ7P12k1V+QuuGMFV9Fj6SaJnLbpHjngZZE+eBtmEEUerXJgNdzUEpo2
         R7uHi3ohEJ5pk+gwyeHFlp71ZtVNOdJC8lOXjBtcPGta1ou22jC+frTi9A71KINhwvsZ
         yi7w==
MIME-Version: 1.0
X-Received: by 10.140.131.70 with SMTP id 67mr18854823qhd.70.1444982535253;
 Fri, 16 Oct 2015 01:02:15 -0700 (PDT)
Received: by 10.55.156.213 with HTTP; Fri, 16 Oct 2015 01:02:15 -0700 (PDT)
In-Reply-To: <CALK=YjMWSTLMzr=5nKws8M8=CkrhqQJ8S1xCgyQycms-V1pNDQ@mail.gmail.com>
References: <CALK=YjMWSTLMzr=5nKws8M8=CkrhqQJ8S1xCgyQycms-V1pNDQ@mail.gmail.com>
Date: Fri, 16 Oct 2015 10:02:15 +0200
Message-ID: <CAKQ1sVP6HPyQj4Tq-47DQ27tbCTRk+005UoAnxmgL7xdWW6+_A@mail.gmail.com>
Subject: Re: 2.4.17 alignment issue sparc/ia64
From: Yann Ylavic <ylavic.dev@gmail.com>
To: dev@httpd.apache.org
Content-Type: text/plain; charset=UTF-8

On Fri, Oct 16, 2015 at 5:53 AM, Eric Covener <covener@gmail.com> wrote:
> We recently merged 2.4.17 and saw some bus errors on hp/ia64 and
> solaris/sparc64. Selectively backing things out, it appears that the
> SO_REUSEPORT patch causes the worker_score to no longer (necessarily)
> be double-word aligned.
>

We should do something like the following patch:

Index: server/scoreboard.c
===================================================================
--- server/scoreboard.c    (revision 1708095)
+++ server/scoreboard.c    (working copy)
@@ -129,14 +129,19 @@ static apr_status_t ap_cleanup_shared_mem(void *d)
     return APR_SUCCESS;
 }

+#define SIZE_OF_scoreboard    APR_ALIGN_DEFAULT(sizeof(scoreboard))
+#define SIZE_OF_global_score  APR_ALIGN_DEFAULT(sizeof(global_score))
+#define SIZE_OF_process_score APR_ALIGN_DEFAULT(sizeof(process_score))
+#define SIZE_OF_worker_score  APR_ALIGN_DEFAULT(sizeof(worker_score))
+
 AP_DECLARE(int) ap_calc_scoreboard_size(void)
 {
     ap_mpm_query(AP_MPMQ_HARD_LIMIT_THREADS, &thread_limit);
     ap_mpm_query(AP_MPMQ_HARD_LIMIT_DAEMONS, &server_limit);

-    scoreboard_size = sizeof(global_score);
-    scoreboard_size += sizeof(process_score) * server_limit;
-    scoreboard_size += sizeof(worker_score) * server_limit * thread_limit;
+    scoreboard_size = SIZE_OF_global_score;
+    scoreboard_size += SIZE_OF_process_score * server_limit;
+    scoreboard_size += SIZE_OF_worker_score * server_limit * thread_limit;

     return scoreboard_size;
 }
@@ -153,17 +158,17 @@ AP_DECLARE(void) ap_init_scoreboard(void *shared_s

     ap_calc_scoreboard_size();
     ap_scoreboard_image =
-        ap_calloc(1, sizeof(scoreboard) + server_limit *
sizeof(worker_score *));
+        ap_calloc(1, SIZE_OF_scoreboard + server_limit *
sizeof(worker_score *));
     more_storage = shared_score;
     ap_scoreboard_image->global = (global_score *)more_storage;
-    more_storage += sizeof(global_score);
+    more_storage += SIZE_OF_global_score;
     ap_scoreboard_image->parent = (process_score *)more_storage;
-    more_storage += sizeof(process_score) * server_limit;
+    more_storage += SIZE_OF_process_score * server_limit;
     ap_scoreboard_image->servers =
-        (worker_score **)((char*)ap_scoreboard_image + sizeof(scoreboard));
+        (worker_score **)((char*)ap_scoreboard_image + SIZE_OF_scoreboard);
     for (i = 0; i < server_limit; i++) {
         ap_scoreboard_image->servers[i] = (worker_score *)more_storage;
-        more_storage += thread_limit * sizeof(worker_score);
+        more_storage += thread_limit * SIZE_OF_worker_score;
     }
     ap_assert(more_storage == (char*)shared_score + scoreboard_size);
     ap_scoreboard_image->global->server_limit = server_limit;
@@ -305,10 +310,10 @@ int ap_create_scoreboard(apr_pool_t *p, ap_scorebo
     if (ap_scoreboard_image) {
         ap_scoreboard_image->global->restart_time = apr_time_now();
         memset(ap_scoreboard_image->parent, 0,
-               sizeof(process_score) * server_limit);
+               SIZE_OF_process_score * server_limit);
         for (i = 0; i < server_limit; i++) {
             memset(ap_scoreboard_image->servers[i], 0,
-                   sizeof(worker_score) * thread_limit);
+                   SIZE_OF_worker_score * thread_limit);
         }
         ap_init_scoreboard(NULL);
         return OK;
--

Can you give it a try please?

Regards,
Yann.

From dev-return-84295-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Fri Oct 16 09:01:30 2015
Return-Path: <dev-return-84295-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 9D96C107F2
	for <apmail-httpd-dev-archive@www.apache.org>; Fri, 16 Oct 2015 09:01:30 +0000 (UTC)
Received: (qmail 94758 invoked by uid 500); 16 Oct 2015 09:01:30 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 94679 invoked by uid 500); 16 Oct 2015 09:01:30 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 94666 invoked by uid 99); 16 Oct 2015 09:01:30 -0000
Received: from Unknown (HELO spamd4-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 16 Oct 2015 09:01:30 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd4-us-west.apache.org (ASF Mail Server at spamd4-us-west.apache.org) with ESMTP id ADCECC084E
	for <dev@httpd.apache.org>; Fri, 16 Oct 2015 09:01:29 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd4-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.12
X-Spam-Level:
X-Spam-Status: No, score=-0.12 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RCVD_IN_MSPIKE_H3=-0.01, RCVD_IN_MSPIKE_WL=-0.01, SPF_PASS=-0.001,
	URIBL_BLOCKED=0.001] autolearn=disabled
Authentication-Results: spamd4-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd4-us-west.apache.org [10.40.0.11]) (amavisd-new, port 10024)
	with ESMTP id YRvgEKb4OT1S for <dev@httpd.apache.org>;
	Fri, 16 Oct 2015 09:01:22 +0000 (UTC)
Received: from mail-wi0-f181.google.com (mail-wi0-f181.google.com [209.85.212.181])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id 4613042ABE
	for <dev@httpd.apache.org>; Fri, 16 Oct 2015 09:01:22 +0000 (UTC)
Received: by wicgb1 with SMTP id gb1so296978wic.1
        for <dev@httpd.apache.org>; Fri, 16 Oct 2015 02:01:15 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=mime-version:in-reply-to:references:from:date:message-id:subject:to
         :content-type;
        bh=9bTgWLjuJ7J/S/tZhpHoETli5lrQWQFeRSFQNZ3l1rg=;
        b=qbP/TroPNSjZvJwiTodK6X6QA204TOpfhvFaLumTuR8UW0obdQeSN2Fg1KFgaKo+sx
         +Lf5quaeg1qRKxs6TlyHmF1Rswl4bwMNXgV7k9CBLPbdwLiTcdJUY6Dk7EKCCBcx6zeX
         NkyPXmGoRdowmO9urUy/s91uK6ZlncRVE5+E9cX1c+HVxbSEeeMclhEOE4i9CyucMLxz
         Nz+rWnTlzBTN2ZVUgzqGpGeqG/rYwlJVplT+CW3MwiDIczZj/dtsdCfgHWqRgpDqfIdA
         arT/d8qiD/yrcv4kcun5EMapZcu6exRfqFIwmzUJO+2XG4G1OTYAWB0VuLyD8nKji/T2
         bQrg==
X-Received: by 10.180.198.12 with SMTP id iy12mr3402202wic.72.1444986074204;
 Fri, 16 Oct 2015 02:01:14 -0700 (PDT)
MIME-Version: 1.0
Received: by 10.27.88.10 with HTTP; Fri, 16 Oct 2015 02:00:54 -0700 (PDT)
In-Reply-To: <CAOhm=5p7=_gGWWL4F=nVBYa8UrmQyQ54K-+-ux3SRe5n7h7SQQ@mail.gmail.com>
References: <CAOhm=5p7=_gGWWL4F=nVBYa8UrmQyQ54K-+-ux3SRe5n7h7SQQ@mail.gmail.com>
From: Chris <chrcoluk@gmail.com>
Date: Fri, 16 Oct 2015 10:00:54 +0100
Message-ID: <CAOhm=5qGL6LDFc2SzrY2weNkFwSt3R5E7gqDcQWacyDdVooz=Q@mail.gmail.com>
Subject: Fwd: mod_http2 protocols directive broken
To: dev@httpd.apache.org
Content-Type: text/plain; charset=UTF-8

Hi guys.

Was excited to see the module got added to 2.4.17 but I cannot get it
to work in my testing following information from this url.
https://icing.github.io/mod_h2/howto.html#http

So what is confirmed working?

I compiled apache with the appropriate configure flag.

I can confirm in the error log the module loads.

However the protocols directive seems to be ignored, testing with both
curl and nghttp2, confirm only http 1.1. is used.  I have tried using
invalid syntax on the protocols directive to cause an error but the
server starts anyway without error as if it ignores the value, I have
tried the value in both the server config and vhost which has no
affect.

Any ideas?

I have been testing on both http and https and both stuck on http 1.1.

Chris

From dev-return-84296-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Fri Oct 16 09:14:28 2015
Return-Path: <dev-return-84296-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id D43F11088F
	for <apmail-httpd-dev-archive@www.apache.org>; Fri, 16 Oct 2015 09:14:28 +0000 (UTC)
Received: (qmail 31194 invoked by uid 500); 16 Oct 2015 09:14:28 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 31117 invoked by uid 500); 16 Oct 2015 09:14:28 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 31107 invoked by uid 99); 16 Oct 2015 09:14:28 -0000
Received: from Unknown (HELO spamd1-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 16 Oct 2015 09:14:28 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd1-us-west.apache.org (ASF Mail Server at spamd1-us-west.apache.org) with ESMTP id D1035C12AC
	for <dev@httpd.apache.org>; Fri, 16 Oct 2015 09:14:27 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd1-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.01
X-Spam-Level:
X-Spam-Status: No, score=-0.01 tagged_above=-999 required=6.31
	tests=[SPF_PASS=-0.001, T_RP_MATCHES_RCVD=-0.01, URIBL_BLOCKED=0.001]
	autolearn=disabled
Received: from mx1-us-west.apache.org ([10.40.0.8])
	by localhost (spamd1-us-west.apache.org [10.40.0.7]) (amavisd-new, port 10024)
	with ESMTP id TGgUXQP-kX1S for <dev@httpd.apache.org>;
	Fri, 16 Oct 2015 09:14:16 +0000 (UTC)
Received: from mail.greenbytes.de (mail.greenbytes.de [217.91.35.233])
	by mx1-us-west.apache.org (ASF Mail Server at mx1-us-west.apache.org) with ESMTPS id E604520758
	for <dev@httpd.apache.org>; Fri, 16 Oct 2015 09:14:15 +0000 (UTC)
Received: from [192.168.1.48] (unknown [87.78.174.25])
	(using TLSv1 with cipher ECDHE-RSA-AES256-SHA (256/256 bits))
	(Client did not present a certificate)
	by mail.greenbytes.de (Postfix) with ESMTPSA id 4B17515A043B
	for <dev@httpd.apache.org>; Fri, 16 Oct 2015 11:14:05 +0200 (CEST)
Content-Type: text/plain; charset=us-ascii
Mime-Version: 1.0 (Mac OS X Mail 9.0 \(3094\))
Subject: Re: mod_http2 protocols directive broken
From: Stefan Eissing <stefan.eissing@greenbytes.de>
In-Reply-To: <CAOhm=5qGL6LDFc2SzrY2weNkFwSt3R5E7gqDcQWacyDdVooz=Q@mail.gmail.com>
Date: Fri, 16 Oct 2015 11:14:00 +0200
Content-Transfer-Encoding: quoted-printable
Message-Id: <8714C592-91B2-4B33-954C-83F44DAEBB88@greenbytes.de>
References: <CAOhm=5p7=_gGWWL4F=nVBYa8UrmQyQ54K-+-ux3SRe5n7h7SQQ@mail.gmail.com> <CAOhm=5qGL6LDFc2SzrY2weNkFwSt3R5E7gqDcQWacyDdVooz=Q@mail.gmail.com>
To: dev@httpd.apache.org
X-Mailer: Apple Mail (2.3094)

Chris,

I wrote some advice at https://icing.github.io/mod_h2/howto.html =
already.

There are several checks described. Which one fails for you and how? I =
need
the output of the step that differs from the advice. Just a verbal =
description
is not enough. Thx.

  //Stefan

> Am 16.10.2015 um 11:00 schrieb Chris <chrcoluk@gmail.com>:
>=20
> Hi guys.
>=20
> Was excited to see the module got added to 2.4.17 but I cannot get it
> to work in my testing following information from this url.
> https://icing.github.io/mod_h2/howto.html#http
>=20
> So what is confirmed working?
>=20
> I compiled apache with the appropriate configure flag.
>=20
> I can confirm in the error log the module loads.
>=20
> However the protocols directive seems to be ignored, testing with both
> curl and nghttp2, confirm only http 1.1. is used.  I have tried using
> invalid syntax on the protocols directive to cause an error but the
> server starts anyway without error as if it ignores the value, I have
> tried the value in both the server config and vhost which has no
> affect.
>=20
> Any ideas?
>=20
> I have been testing on both http and https and both stuck on http 1.1.
>=20
> Chris


From dev-return-84297-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Fri Oct 16 09:23:38 2015
Return-Path: <dev-return-84297-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 23BEF108F5
	for <apmail-httpd-dev-archive@www.apache.org>; Fri, 16 Oct 2015 09:23:38 +0000 (UTC)
Received: (qmail 50495 invoked by uid 500); 16 Oct 2015 09:23:37 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 50417 invoked by uid 500); 16 Oct 2015 09:23:37 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 50407 invoked by uid 99); 16 Oct 2015 09:23:37 -0000
Received: from Unknown (HELO spamd4-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 16 Oct 2015 09:23:37 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd4-us-west.apache.org (ASF Mail Server at spamd4-us-west.apache.org) with ESMTP id 2F555C084E
	for <dev@httpd.apache.org>; Fri, 16 Oct 2015 09:23:37 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd4-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.1
X-Spam-Level:
X-Spam-Status: No, score=-0.1 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	SPF_PASS=-0.001, URIBL_BLOCKED=0.001] autolearn=disabled
Authentication-Results: spamd4-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd4-us-west.apache.org [10.40.0.11]) (amavisd-new, port 10024)
	with ESMTP id EVfbG9ehnEbD for <dev@httpd.apache.org>;
	Fri, 16 Oct 2015 09:23:22 +0000 (UTC)
Received: from mail-wi0-f169.google.com (mail-wi0-f169.google.com [209.85.212.169])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id CFAA02315C
	for <dev@httpd.apache.org>; Fri, 16 Oct 2015 09:23:17 +0000 (UTC)
Received: by wicgb1 with SMTP id gb1so1066415wic.1
        for <dev@httpd.apache.org>; Fri, 16 Oct 2015 02:23:17 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=mime-version:in-reply-to:references:from:date:message-id:subject:to
         :content-type;
        bh=WHypzlJ37JNbde4eN0TCBOYxAT9gGkP16Ym0ePOqrro=;
        b=iKbPRXCd6MClpM1QkjfjfJElABborP3XhqX3pXfcc1lFlyw1T5QE3VjaS8zQJF8Q/9
         +byWraYo+b/t7ygB8te/qv3s+dZXgE/oA0ZmUOlzbnycapuKaia9+ZuVVb5+rNqMaGhZ
         ZjroXlexLS//nQdWuxZTdsDBwlbKzeyC/2fsDdezOWYaPtYstpyTAT0vpuQ2jpnFD974
         5w9/XJUdpb9FBHsIg1hp8GPHxeAEQ3NVmOH4I3iwHmJjvJwGpJOmzle8n/ft3lZN/s5H
         rZ2GlzWO1G/OS4z5ks76ofmGoKPw2Y9bBBRWbr5i55JGYij5BcwheDnXfGeUEV31XLOY
         r+BA==
X-Received: by 10.194.6.106 with SMTP id z10mr15721964wjz.104.1444987397201;
 Fri, 16 Oct 2015 02:23:17 -0700 (PDT)
MIME-Version: 1.0
Received: by 10.27.88.10 with HTTP; Fri, 16 Oct 2015 02:22:57 -0700 (PDT)
In-Reply-To: <8714C592-91B2-4B33-954C-83F44DAEBB88@greenbytes.de>
References: <CAOhm=5p7=_gGWWL4F=nVBYa8UrmQyQ54K-+-ux3SRe5n7h7SQQ@mail.gmail.com>
 <CAOhm=5qGL6LDFc2SzrY2weNkFwSt3R5E7gqDcQWacyDdVooz=Q@mail.gmail.com> <8714C592-91B2-4B33-954C-83F44DAEBB88@greenbytes.de>
From: Chris <chrcoluk@gmail.com>
Date: Fri, 16 Oct 2015 10:22:57 +0100
Message-ID: <CAOhm=5p7QTEX7WKSoNA93QvEvfV6frn92iyem8oai9=JC2=_9Q@mail.gmail.com>
Subject: Re: mod_http2 protocols directive broken
To: dev@httpd.apache.org
Content-Type: text/plain; charset=UTF-8

Hi Stefan, here is the output of both checks. Note I will confirm also
curl is compiled with http2 support and will also show curl -V output.

Curl -V
"curl 7.45.0 (amd64-portbld-freebsd9.3) libcurl/7.45.0 OpenSSL/1.0.2d
zlib/1.2.8 libidn/1.31 nghttp2/1.3.4
Protocols: dict file ftp ftps gopher http https imap imaps pop3 pop3s
rtsp smb smbs smtp smtps telnet tftp
Features: AsynchDNS IDN IPv6 Largefile NTLM NTLM_WB SSL libz TLS-SRP
HTTP2 UnixSockets "

Curl http2 test
"# curl -v --http2 -v http://freebsd-admin.com/
*   Trying 2a01:4f8:201:5465::4...
* Connected to freebsd-admin.com (2a01:4f8:201:5465::4) port 80 (#0)
> GET / HTTP/1.1
> Host: freebsd-admin.com
> User-Agent: curl/7.45.0
> Accept: */*
> Connection: Upgrade, HTTP2-Settings
> Upgrade: h2c
> HTTP2-Settings: AAMAAABkAAQAAP__
>
< HTTP/1.1 302 Found
< Date: Fri, 16 Oct 2015 09:19:56 GMT
< Server: Apache
< X-Frame-Options: SAMEORIGIN
< X-Xss-Protection: 1; mode=block
< X-Content-Type-Options: nosniff
< Content-Security-Policy: default-src 'self'; script-src 'self'
'unsafe-eval' 'unsafe-inline' https://*.freebsd-admin.com; connect-src
'self' https://*.freebsd-admin.com; img-src 'self'
https://*.freebsd-admin.com; style-src 'unsafe-inline' 'self'
https://*.freebsd-admin.com; block-all-mixed-content;
< X-Content-Security-Policy: default-src 'self'; script-src 'self'
'unsafe-eval' 'unsafe-inline' https://*.freebsd-admin.com; connect-src
'self' https://*.freebsd-admin.com; img-src 'self'
https://*.freebsd-admin.com; style-src 'self' 'unsafe-inline'
https://*.freebsd-admin.com; block-all-mixed-content;
< Location: https://freebsd-admin.com/
< Content-Length: 210
< Content-Type: text/html; charset=iso-8859-1
<
<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML 2.0//EN">
<html><head>
<title>302 Found</title>
</head><body>
<h1>Found</h1>
<p>The document has moved <a href="https://freebsd-admin.com/">here</a>.</p>
</body></html>
* Connection #0 to host freebsd-admin.com left intact"

nghttp2 test
"# nghttp -uv http://freebsd-admin.com/
[  0.000] Connected
[  0.000] HTTP Upgrade request
GET / HTTP/1.1
Host: freebsd-admin.com
Connection: Upgrade, HTTP2-Settings
Upgrade: h2c
HTTP2-Settings: AAMAAABkAAQAAP__
Accept: */*
User-Agent: nghttp2/1.3.4


[  0.001] HTTP Upgrade response
HTTP/1.1 302 Found
Date: Fri, 16 Oct 2015 09:21:42 GMT
Server: Apache
X-Frame-Options: SAMEORIGIN
X-Xss-Protection: 1; mode=block
X-Content-Type-Options: nosniff
Content-Security-Policy: default-src 'self'; script-src 'self'
'unsafe-eval' 'unsafe-inline' https://*.freebsd-admin.com; connect-src
'self' https://*.freebsd-admin.com; img-src 'self'
https://*.freebsd-admin.com; style-src 'unsafe-inline' 'self'
https://*.freebsd-admin.com; block-all-mixed-content;
X-Content-Security-Policy: default-src 'self'; script-src 'self'
'unsafe-eval' 'unsafe-inline' https://*.freebsd-admin.com; connect-src
'self' https://*.freebsd-admin.com; img-src 'self'
https://*.freebsd-admin.com; style-src 'self' 'unsafe-inline'
https://*.freebsd-admin.com; block-all-mixed-content;
Location: https://freebsd-admin.com/
Content-Length: 210
Content-Type: text/html; charset=iso-8859-1

<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML 2.0//EN">
<html><head>
<title>302 Found</title>
</head><body>
<h1>Found</h1>
<p>The document has moved <a href="https://freebsd-admin.com/">here</a>.</p>
</body></html>

[ERROR] HTTP Upgrade failed
Some requests were not processed. total=1, processed=0"

Finally I also set logging to http2:debug but I dont see anything that
indicates an error.

"[Fri Oct 16 10:06:01.060039 2015] [http2:info] [pid 19537:tid
34410099712] mod_http2 (v1.0.0, nghttp2 1.3.4), initializing...
[Fri Oct 16 10:06:01.060051 2015] [http2:debug] [pid 19537:tid
34410099712] h2_h2.c(72): h2_h2, child_init
[Fri Oct 16 10:06:01.060059 2015] [http2:debug] [pid 19537:tid
34410099712] h2_switch.c(54): h2_switch init
[Fri Oct 16 10:06:01.060287 2015] [lbmethod_heartbeat:notice] [pid
19537:tid 34410099712] AH02282: No slotmem from mod_heartmonitor
[Fri Oct 16 10:06:02.001571 2015] [mpm_event:notice] [pid 19537:tid
34410099712] AH00489: Apache/2.4.17 (Unix) OpenSSL/1.0.2d configured
-- resuming normal operations
[Fri Oct 16 10:06:02.001600 2015] [core:notice] [pid 19537:tid
34410099712] AH00094: Command line: '/usr/sbin/httpd -D SSL'
[Fri Oct 16 10:06:02.001697 2015] [http2:debug] [pid 19678:tid
34410099712] h2_conn.c(123): h2_workers: min=32 max=64, mthrpchild=32,
thr_limit=64
[Fri Oct 16 10:06:02.001755 2015] [http2:debug] [pid 19678:tid
34410099712] h2_workers.c(227): h2_workers: starting
[Fri Oct 16 10:06:02.002007 2015] [http2:debug] [pid 19727:tid
34410099712] h2_conn.c(123): h2_workers: min=32 max=64, mthrpchild=32,
thr_limit=64
[Fri Oct 16 10:06:02.002062 2015] [http2:debug] [pid 19727:tid
34410099712] h2_workers.c(227): h2_workers: starting"

Hope this helps.

On 16 October 2015 at 10:14, Stefan Eissing
<stefan.eissing@greenbytes.de> wrote:
> Chris,
>
> I wrote some advice at https://icing.github.io/mod_h2/howto.html already.
>
> There are several checks described. Which one fails for you and how? I need
> the output of the step that differs from the advice. Just a verbal description
> is not enough. Thx.
>
>   //Stefan
>
>> Am 16.10.2015 um 11:00 schrieb Chris <chrcoluk@gmail.com>:
>>
>> Hi guys.
>>
>> Was excited to see the module got added to 2.4.17 but I cannot get it
>> to work in my testing following information from this url.
>> https://icing.github.io/mod_h2/howto.html#http
>>
>> So what is confirmed working?
>>
>> I compiled apache with the appropriate configure flag.
>>
>> I can confirm in the error log the module loads.
>>
>> However the protocols directive seems to be ignored, testing with both
>> curl and nghttp2, confirm only http 1.1. is used.  I have tried using
>> invalid syntax on the protocols directive to cause an error but the
>> server starts anyway without error as if it ignores the value, I have
>> tried the value in both the server config and vhost which has no
>> affect.
>>
>> Any ideas?
>>
>> I have been testing on both http and https and both stuck on http 1.1.
>>
>> Chris
>

From dev-return-84298-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Fri Oct 16 09:37:07 2015
Return-Path: <dev-return-84298-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 89D8010959
	for <apmail-httpd-dev-archive@www.apache.org>; Fri, 16 Oct 2015 09:37:07 +0000 (UTC)
Received: (qmail 83080 invoked by uid 500); 16 Oct 2015 09:37:07 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 83008 invoked by uid 500); 16 Oct 2015 09:37:07 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 82998 invoked by uid 99); 16 Oct 2015 09:37:06 -0000
Received: from Unknown (HELO spamd1-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 16 Oct 2015 09:37:06 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd1-us-west.apache.org (ASF Mail Server at spamd1-us-west.apache.org) with ESMTP id 8AFCAC6314
	for <dev@httpd.apache.org>; Fri, 16 Oct 2015 09:37:06 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd1-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.009
X-Spam-Level:
X-Spam-Status: No, score=-0.009 tagged_above=-999 required=6.31
	tests=[T_RP_MATCHES_RCVD=-0.01, URIBL_BLOCKED=0.001]
	autolearn=disabled
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd1-us-west.apache.org [10.40.0.7]) (amavisd-new, port 10024)
	with ESMTP id NM-l0EoIx1da for <dev@httpd.apache.org>;
	Fri, 16 Oct 2015 09:36:53 +0000 (UTC)
Received: from mail.greenbytes.de (mail.greenbytes.de [217.91.35.233])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id B039D20F5E
	for <dev@httpd.apache.org>; Fri, 16 Oct 2015 09:36:52 +0000 (UTC)
Received: from [192.168.1.48] (unknown [87.78.174.25])
	(using TLSv1 with cipher ECDHE-RSA-AES256-SHA (256/256 bits))
	(Client did not present a certificate)
	by mail.greenbytes.de (Postfix) with ESMTPSA id DCBCE15A0486
	for <dev@httpd.apache.org>; Fri, 16 Oct 2015 11:36:45 +0200 (CEST)
Content-Type: text/plain; charset=us-ascii
Mime-Version: 1.0 (Mac OS X Mail 9.0 \(3094\))
Subject: Re: mod_http2 protocols directive broken
From: Stefan Eissing <stefan.eissing@greenbytes.de>
In-Reply-To: <CAOhm=5p7QTEX7WKSoNA93QvEvfV6frn92iyem8oai9=JC2=_9Q@mail.gmail.com>
Date: Fri, 16 Oct 2015 11:36:45 +0200
Content-Transfer-Encoding: quoted-printable
Message-Id: <5A21C2A9-EC9B-4F5E-9E7D-37B4D65EA5F2@greenbytes.de>
References: <CAOhm=5p7=_gGWWL4F=nVBYa8UrmQyQ54K-+-ux3SRe5n7h7SQQ@mail.gmail.com> <CAOhm=5qGL6LDFc2SzrY2weNkFwSt3R5E7gqDcQWacyDdVooz=Q@mail.gmail.com> <8714C592-91B2-4B33-954C-83F44DAEBB88@greenbytes.de> <CAOhm=5p7QTEX7WKSoNA93QvEvfV6frn92iyem8oai9=JC2=_9Q@mail.gmail.com>
To: dev@httpd.apache.org
X-Mailer: Apple Mail (2.3094)

Lets move this to the users list where others can also see it.

> Am 16.10.2015 um 11:22 schrieb Chris <chrcoluk@gmail.com>:
>=20
> Hi Stefan, here is the output of both checks. Note I will confirm also
> curl is compiled with http2 support and will also show curl -V output.
>=20
> Curl -V
> "curl 7.45.0 (amd64-portbld-freebsd9.3) libcurl/7.45.0 OpenSSL/1.0.2d
> zlib/1.2.8 libidn/1.31 nghttp2/1.3.4
> Protocols: dict file ftp ftps gopher http https imap imaps pop3 pop3s
> rtsp smb smbs smtp smtps telnet tftp
> Features: AsynchDNS IDN IPv6 Largefile NTLM NTLM_WB SSL libz TLS-SRP
> HTTP2 UnixSockets "
>=20
> Curl http2 test
> "# curl -v --http2 -v http://freebsd-admin.com/
> *   Trying 2a01:4f8:201:5465::4...
> * Connected to freebsd-admin.com (2a01:4f8:201:5465::4) port 80 (#0)
>> GET / HTTP/1.1
>> Host: freebsd-admin.com
>> User-Agent: curl/7.45.0
>> Accept: */*
>> Connection: Upgrade, HTTP2-Settings
>> Upgrade: h2c
>> HTTP2-Settings: AAMAAABkAAQAAP__
>>=20
> < HTTP/1.1 302 Found
> < Date: Fri, 16 Oct 2015 09:19:56 GMT
> < Server: Apache
> < X-Frame-Options: SAMEORIGIN
> < X-Xss-Protection: 1; mode=3Dblock
> < X-Content-Type-Options: nosniff
> < Content-Security-Policy: default-src 'self'; script-src 'self'
> 'unsafe-eval' 'unsafe-inline' https://*.freebsd-admin.com; connect-src
> 'self' https://*.freebsd-admin.com; img-src 'self'
> https://*.freebsd-admin.com; style-src 'unsafe-inline' 'self'
> https://*.freebsd-admin.com; block-all-mixed-content;
> < X-Content-Security-Policy: default-src 'self'; script-src 'self'
> 'unsafe-eval' 'unsafe-inline' https://*.freebsd-admin.com; connect-src
> 'self' https://*.freebsd-admin.com; img-src 'self'
> https://*.freebsd-admin.com; style-src 'self' 'unsafe-inline'
> https://*.freebsd-admin.com; block-all-mixed-content;
> < Location: https://freebsd-admin.com/
> < Content-Length: 210
> < Content-Type: text/html; charset=3Diso-8859-1
> <
> <!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML 2.0//EN">
> <html><head>
> <title>302 Found</title>
> </head><body>
> <h1>Found</h1>
> <p>The document has moved <a =
href=3D"https://freebsd-admin.com/">here</a>.</p>
> </body></html>
> * Connection #0 to host freebsd-admin.com left intact"
>=20
> nghttp2 test
> "# nghttp -uv http://freebsd-admin.com/
> [  0.000] Connected
> [  0.000] HTTP Upgrade request
> GET / HTTP/1.1
> Host: freebsd-admin.com
> Connection: Upgrade, HTTP2-Settings
> Upgrade: h2c
> HTTP2-Settings: AAMAAABkAAQAAP__
> Accept: */*
> User-Agent: nghttp2/1.3.4
>=20
>=20
> [  0.001] HTTP Upgrade response
> HTTP/1.1 302 Found
> Date: Fri, 16 Oct 2015 09:21:42 GMT
> Server: Apache
> X-Frame-Options: SAMEORIGIN
> X-Xss-Protection: 1; mode=3Dblock
> X-Content-Type-Options: nosniff
> Content-Security-Policy: default-src 'self'; script-src 'self'
> 'unsafe-eval' 'unsafe-inline' https://*.freebsd-admin.com; connect-src
> 'self' https://*.freebsd-admin.com; img-src 'self'
> https://*.freebsd-admin.com; style-src 'unsafe-inline' 'self'
> https://*.freebsd-admin.com; block-all-mixed-content;
> X-Content-Security-Policy: default-src 'self'; script-src 'self'
> 'unsafe-eval' 'unsafe-inline' https://*.freebsd-admin.com; connect-src
> 'self' https://*.freebsd-admin.com; img-src 'self'
> https://*.freebsd-admin.com; style-src 'self' 'unsafe-inline'
> https://*.freebsd-admin.com; block-all-mixed-content;
> Location: https://freebsd-admin.com/
> Content-Length: 210
> Content-Type: text/html; charset=3Diso-8859-1
>=20
> <!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML 2.0//EN">
> <html><head>
> <title>302 Found</title>
> </head><body>
> <h1>Found</h1>
> <p>The document has moved <a =
href=3D"https://freebsd-admin.com/">here</a>.</p>
> </body></html>
>=20
> [ERROR] HTTP Upgrade failed
> Some requests were not processed. total=3D1, processed=3D0"
>=20
> Finally I also set logging to http2:debug but I dont see anything that
> indicates an error.
>=20
> "[Fri Oct 16 10:06:01.060039 2015] [http2:info] [pid 19537:tid
> 34410099712] mod_http2 (v1.0.0, nghttp2 1.3.4), initializing...
> [Fri Oct 16 10:06:01.060051 2015] [http2:debug] [pid 19537:tid
> 34410099712] h2_h2.c(72): h2_h2, child_init
> [Fri Oct 16 10:06:01.060059 2015] [http2:debug] [pid 19537:tid
> 34410099712] h2_switch.c(54): h2_switch init
> [Fri Oct 16 10:06:01.060287 2015] [lbmethod_heartbeat:notice] [pid
> 19537:tid 34410099712] AH02282: No slotmem from mod_heartmonitor
> [Fri Oct 16 10:06:02.001571 2015] [mpm_event:notice] [pid 19537:tid
> 34410099712] AH00489: Apache/2.4.17 (Unix) OpenSSL/1.0.2d configured
> -- resuming normal operations
> [Fri Oct 16 10:06:02.001600 2015] [core:notice] [pid 19537:tid
> 34410099712] AH00094: Command line: '/usr/sbin/httpd -D SSL'
> [Fri Oct 16 10:06:02.001697 2015] [http2:debug] [pid 19678:tid
> 34410099712] h2_conn.c(123): h2_workers: min=3D32 max=3D64, =
mthrpchild=3D32,
> thr_limit=3D64
> [Fri Oct 16 10:06:02.001755 2015] [http2:debug] [pid 19678:tid
> 34410099712] h2_workers.c(227): h2_workers: starting
> [Fri Oct 16 10:06:02.002007 2015] [http2:debug] [pid 19727:tid
> 34410099712] h2_conn.c(123): h2_workers: min=3D32 max=3D64, =
mthrpchild=3D32,
> thr_limit=3D64
> [Fri Oct 16 10:06:02.002062 2015] [http2:debug] [pid 19727:tid
> 34410099712] h2_workers.c(227): h2_workers: starting"
>=20
> Hope this helps.
>=20
> On 16 October 2015 at 10:14, Stefan Eissing
> <stefan.eissing@greenbytes.de> wrote:
>> Chris,
>>=20
>> I wrote some advice at https://icing.github.io/mod_h2/howto.html =
already.
>>=20
>> There are several checks described. Which one fails for you and how? =
I need
>> the output of the step that differs from the advice. Just a verbal =
description
>> is not enough. Thx.
>>=20
>>  //Stefan
>>=20
>>> Am 16.10.2015 um 11:00 schrieb Chris <chrcoluk@gmail.com>:
>>>=20
>>> Hi guys.
>>>=20
>>> Was excited to see the module got added to 2.4.17 but I cannot get =
it
>>> to work in my testing following information from this url.
>>> https://icing.github.io/mod_h2/howto.html#http
>>>=20
>>> So what is confirmed working?
>>>=20
>>> I compiled apache with the appropriate configure flag.
>>>=20
>>> I can confirm in the error log the module loads.
>>>=20
>>> However the protocols directive seems to be ignored, testing with =
both
>>> curl and nghttp2, confirm only http 1.1. is used.  I have tried =
using
>>> invalid syntax on the protocols directive to cause an error but the
>>> server starts anyway without error as if it ignores the value, I =
have
>>> tried the value in both the server config and vhost which has no
>>> affect.
>>>=20
>>> Any ideas?
>>>=20
>>> I have been testing on both http and https and both stuck on http =
1.1.
>>>=20
>>> Chris
>>=20


From dev-return-84299-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Fri Oct 16 09:38:29 2015
Return-Path: <dev-return-84299-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 72B531096A
	for <apmail-httpd-dev-archive@www.apache.org>; Fri, 16 Oct 2015 09:38:29 +0000 (UTC)
Received: (qmail 85698 invoked by uid 500); 16 Oct 2015 09:38:29 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 85635 invoked by uid 500); 16 Oct 2015 09:38:29 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 85625 invoked by uid 99); 16 Oct 2015 09:38:28 -0000
Received: from Unknown (HELO spamd3-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 16 Oct 2015 09:38:28 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd3-us-west.apache.org (ASF Mail Server at spamd3-us-west.apache.org) with ESMTP id 85B011809A8
	for <dev@httpd.apache.org>; Fri, 16 Oct 2015 09:38:28 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd3-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.099
X-Spam-Level:
X-Spam-Status: No, score=-0.099 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	URIBL_BLOCKED=0.001] autolearn=disabled
Authentication-Results: spamd3-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd3-us-west.apache.org [10.40.0.10]) (amavisd-new, port 10024)
	with ESMTP id mPRcRRKLXWrz for <dev@httpd.apache.org>;
	Fri, 16 Oct 2015 09:38:18 +0000 (UTC)
Received: from mail-wi0-f174.google.com (mail-wi0-f174.google.com [209.85.212.174])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id 8BA9143A17
	for <dev@httpd.apache.org>; Fri, 16 Oct 2015 09:38:17 +0000 (UTC)
Received: by wicll6 with SMTP id ll6so1641042wic.0
        for <dev@httpd.apache.org>; Fri, 16 Oct 2015 02:38:11 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=mime-version:in-reply-to:references:from:date:message-id:subject:to
         :content-type;
        bh=EW/qGATujqBtILVSkYmovttoeovyrK70SjyCoaKnAKA=;
        b=RtKgY4U5WI97zW32lQRj40Dy86+PIKiJ0BMlbvQ5gLIm1Tp1qrxkfLs0EmBz1wdnKR
         +jnyb7a7+SdmJCHsWtTFyzfo5tvQg4AoZXND9aSnvx50Js2omi+aOE3UTuMYTKwlt6Mf
         Vn5iKELd378S8nbMGW77o/hhOdqkzoX7bfBy5cU+0t2zkh0fxSeQRhQHrQVPOrSLLjeZ
         dgJwyPL8o84Aj1BBhz6JRqa2CMFpX3rW4GJ3lXuRePhn3cbrwrGXMnCug6vJPDtxV+ms
         rxFmG9NfPc6nIlRF1+dKq/XIi16Co/aQkCS/lLMS96H+mEFytUcuUurQV9NKnPqzde+Y
         VCng==
X-Received: by 10.180.198.12 with SMTP id iy12mr3610740wic.72.1444988291391;
 Fri, 16 Oct 2015 02:38:11 -0700 (PDT)
MIME-Version: 1.0
Received: by 10.27.88.10 with HTTP; Fri, 16 Oct 2015 02:37:51 -0700 (PDT)
In-Reply-To: <5A21C2A9-EC9B-4F5E-9E7D-37B4D65EA5F2@greenbytes.de>
References: <CAOhm=5p7=_gGWWL4F=nVBYa8UrmQyQ54K-+-ux3SRe5n7h7SQQ@mail.gmail.com>
 <CAOhm=5qGL6LDFc2SzrY2weNkFwSt3R5E7gqDcQWacyDdVooz=Q@mail.gmail.com>
 <8714C592-91B2-4B33-954C-83F44DAEBB88@greenbytes.de> <CAOhm=5p7QTEX7WKSoNA93QvEvfV6frn92iyem8oai9=JC2=_9Q@mail.gmail.com>
 <5A21C2A9-EC9B-4F5E-9E7D-37B4D65EA5F2@greenbytes.de>
From: Chris <chrcoluk@gmail.com>
Date: Fri, 16 Oct 2015 10:37:51 +0100
Message-ID: <CAOhm=5q9SCwecedyVfdJnnQWmCD_UbR86ThrG=iAS0d+iLd5uw@mail.gmail.com>
Subject: Re: mod_http2 protocols directive broken
To: dev@httpd.apache.org
Content-Type: text/plain; charset=UTF-8

do you want me to repost this there then?

On 16 October 2015 at 10:36, Stefan Eissing
<stefan.eissing@greenbytes.de> wrote:
> Lets move this to the users list where others can also see it.
>
>> Am 16.10.2015 um 11:22 schrieb Chris <chrcoluk@gmail.com>:
>>
>> Hi Stefan, here is the output of both checks. Note I will confirm also
>> curl is compiled with http2 support and will also show curl -V output.
>>
>> Curl -V
>> "curl 7.45.0 (amd64-portbld-freebsd9.3) libcurl/7.45.0 OpenSSL/1.0.2d
>> zlib/1.2.8 libidn/1.31 nghttp2/1.3.4
>> Protocols: dict file ftp ftps gopher http https imap imaps pop3 pop3s
>> rtsp smb smbs smtp smtps telnet tftp
>> Features: AsynchDNS IDN IPv6 Largefile NTLM NTLM_WB SSL libz TLS-SRP
>> HTTP2 UnixSockets "
>>
>> Curl http2 test
>> "# curl -v --http2 -v http://freebsd-admin.com/
>> *   Trying 2a01:4f8:201:5465::4...
>> * Connected to freebsd-admin.com (2a01:4f8:201:5465::4) port 80 (#0)
>>> GET / HTTP/1.1
>>> Host: freebsd-admin.com
>>> User-Agent: curl/7.45.0
>>> Accept: */*
>>> Connection: Upgrade, HTTP2-Settings
>>> Upgrade: h2c
>>> HTTP2-Settings: AAMAAABkAAQAAP__
>>>
>> < HTTP/1.1 302 Found
>> < Date: Fri, 16 Oct 2015 09:19:56 GMT
>> < Server: Apache
>> < X-Frame-Options: SAMEORIGIN
>> < X-Xss-Protection: 1; mode=block
>> < X-Content-Type-Options: nosniff
>> < Content-Security-Policy: default-src 'self'; script-src 'self'
>> 'unsafe-eval' 'unsafe-inline' https://*.freebsd-admin.com; connect-src
>> 'self' https://*.freebsd-admin.com; img-src 'self'
>> https://*.freebsd-admin.com; style-src 'unsafe-inline' 'self'
>> https://*.freebsd-admin.com; block-all-mixed-content;
>> < X-Content-Security-Policy: default-src 'self'; script-src 'self'
>> 'unsafe-eval' 'unsafe-inline' https://*.freebsd-admin.com; connect-src
>> 'self' https://*.freebsd-admin.com; img-src 'self'
>> https://*.freebsd-admin.com; style-src 'self' 'unsafe-inline'
>> https://*.freebsd-admin.com; block-all-mixed-content;
>> < Location: https://freebsd-admin.com/
>> < Content-Length: 210
>> < Content-Type: text/html; charset=iso-8859-1
>> <
>> <!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML 2.0//EN">
>> <html><head>
>> <title>302 Found</title>
>> </head><body>
>> <h1>Found</h1>
>> <p>The document has moved <a href="https://freebsd-admin.com/">here</a>.</p>
>> </body></html>
>> * Connection #0 to host freebsd-admin.com left intact"
>>
>> nghttp2 test
>> "# nghttp -uv http://freebsd-admin.com/
>> [  0.000] Connected
>> [  0.000] HTTP Upgrade request
>> GET / HTTP/1.1
>> Host: freebsd-admin.com
>> Connection: Upgrade, HTTP2-Settings
>> Upgrade: h2c
>> HTTP2-Settings: AAMAAABkAAQAAP__
>> Accept: */*
>> User-Agent: nghttp2/1.3.4
>>
>>
>> [  0.001] HTTP Upgrade response
>> HTTP/1.1 302 Found
>> Date: Fri, 16 Oct 2015 09:21:42 GMT
>> Server: Apache
>> X-Frame-Options: SAMEORIGIN
>> X-Xss-Protection: 1; mode=block
>> X-Content-Type-Options: nosniff
>> Content-Security-Policy: default-src 'self'; script-src 'self'
>> 'unsafe-eval' 'unsafe-inline' https://*.freebsd-admin.com; connect-src
>> 'self' https://*.freebsd-admin.com; img-src 'self'
>> https://*.freebsd-admin.com; style-src 'unsafe-inline' 'self'
>> https://*.freebsd-admin.com; block-all-mixed-content;
>> X-Content-Security-Policy: default-src 'self'; script-src 'self'
>> 'unsafe-eval' 'unsafe-inline' https://*.freebsd-admin.com; connect-src
>> 'self' https://*.freebsd-admin.com; img-src 'self'
>> https://*.freebsd-admin.com; style-src 'self' 'unsafe-inline'
>> https://*.freebsd-admin.com; block-all-mixed-content;
>> Location: https://freebsd-admin.com/
>> Content-Length: 210
>> Content-Type: text/html; charset=iso-8859-1
>>
>> <!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML 2.0//EN">
>> <html><head>
>> <title>302 Found</title>
>> </head><body>
>> <h1>Found</h1>
>> <p>The document has moved <a href="https://freebsd-admin.com/">here</a>.</p>
>> </body></html>
>>
>> [ERROR] HTTP Upgrade failed
>> Some requests were not processed. total=1, processed=0"
>>
>> Finally I also set logging to http2:debug but I dont see anything that
>> indicates an error.
>>
>> "[Fri Oct 16 10:06:01.060039 2015] [http2:info] [pid 19537:tid
>> 34410099712] mod_http2 (v1.0.0, nghttp2 1.3.4), initializing...
>> [Fri Oct 16 10:06:01.060051 2015] [http2:debug] [pid 19537:tid
>> 34410099712] h2_h2.c(72): h2_h2, child_init
>> [Fri Oct 16 10:06:01.060059 2015] [http2:debug] [pid 19537:tid
>> 34410099712] h2_switch.c(54): h2_switch init
>> [Fri Oct 16 10:06:01.060287 2015] [lbmethod_heartbeat:notice] [pid
>> 19537:tid 34410099712] AH02282: No slotmem from mod_heartmonitor
>> [Fri Oct 16 10:06:02.001571 2015] [mpm_event:notice] [pid 19537:tid
>> 34410099712] AH00489: Apache/2.4.17 (Unix) OpenSSL/1.0.2d configured
>> -- resuming normal operations
>> [Fri Oct 16 10:06:02.001600 2015] [core:notice] [pid 19537:tid
>> 34410099712] AH00094: Command line: '/usr/sbin/httpd -D SSL'
>> [Fri Oct 16 10:06:02.001697 2015] [http2:debug] [pid 19678:tid
>> 34410099712] h2_conn.c(123): h2_workers: min=32 max=64, mthrpchild=32,
>> thr_limit=64
>> [Fri Oct 16 10:06:02.001755 2015] [http2:debug] [pid 19678:tid
>> 34410099712] h2_workers.c(227): h2_workers: starting
>> [Fri Oct 16 10:06:02.002007 2015] [http2:debug] [pid 19727:tid
>> 34410099712] h2_conn.c(123): h2_workers: min=32 max=64, mthrpchild=32,
>> thr_limit=64
>> [Fri Oct 16 10:06:02.002062 2015] [http2:debug] [pid 19727:tid
>> 34410099712] h2_workers.c(227): h2_workers: starting"
>>
>> Hope this helps.
>>
>> On 16 October 2015 at 10:14, Stefan Eissing
>> <stefan.eissing@greenbytes.de> wrote:
>>> Chris,
>>>
>>> I wrote some advice at https://icing.github.io/mod_h2/howto.html already.
>>>
>>> There are several checks described. Which one fails for you and how? I need
>>> the output of the step that differs from the advice. Just a verbal description
>>> is not enough. Thx.
>>>
>>>  //Stefan
>>>
>>>> Am 16.10.2015 um 11:00 schrieb Chris <chrcoluk@gmail.com>:
>>>>
>>>> Hi guys.
>>>>
>>>> Was excited to see the module got added to 2.4.17 but I cannot get it
>>>> to work in my testing following information from this url.
>>>> https://icing.github.io/mod_h2/howto.html#http
>>>>
>>>> So what is confirmed working?
>>>>
>>>> I compiled apache with the appropriate configure flag.
>>>>
>>>> I can confirm in the error log the module loads.
>>>>
>>>> However the protocols directive seems to be ignored, testing with both
>>>> curl and nghttp2, confirm only http 1.1. is used.  I have tried using
>>>> invalid syntax on the protocols directive to cause an error but the
>>>> server starts anyway without error as if it ignores the value, I have
>>>> tried the value in both the server config and vhost which has no
>>>> affect.
>>>>
>>>> Any ideas?
>>>>
>>>> I have been testing on both http and https and both stuck on http 1.1.
>>>>
>>>> Chris
>>>
>

From dev-return-84300-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Fri Oct 16 10:21:21 2015
Return-Path: <dev-return-84300-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 6C84610B43
	for <apmail-httpd-dev-archive@www.apache.org>; Fri, 16 Oct 2015 10:21:21 +0000 (UTC)
Received: (qmail 92628 invoked by uid 500); 16 Oct 2015 10:21:18 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 92555 invoked by uid 500); 16 Oct 2015 10:21:17 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 92545 invoked by uid 99); 16 Oct 2015 10:21:17 -0000
Received: from Unknown (HELO spamd1-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 16 Oct 2015 10:21:17 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd1-us-west.apache.org (ASF Mail Server at spamd1-us-west.apache.org) with ESMTP id 7E94DC15C6
	for <dev@httpd.apache.org>; Fri, 16 Oct 2015 10:21:17 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd1-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.119
X-Spam-Level:
X-Spam-Status: No, score=-0.119 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RCVD_IN_MSPIKE_H3=-0.01, RCVD_IN_MSPIKE_WL=-0.01, URIBL_BLOCKED=0.001]
	autolearn=disabled
Authentication-Results: spamd1-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd1-us-west.apache.org [10.40.0.7]) (amavisd-new, port 10024)
	with ESMTP id fsuKX4UWBh6Y for <dev@httpd.apache.org>;
	Fri, 16 Oct 2015 10:21:08 +0000 (UTC)
Received: from mail-qk0-f180.google.com (mail-qk0-f180.google.com [209.85.220.180])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id C376F2139D
	for <dev@httpd.apache.org>; Fri, 16 Oct 2015 10:21:07 +0000 (UTC)
Received: by qkas79 with SMTP id s79so52008645qka.0
        for <dev@httpd.apache.org>; Fri, 16 Oct 2015 03:21:00 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=mime-version:date:message-id:subject:from:to:content-type;
        bh=zxt2oKWeguas29vD8/ul4c9p4LHwqRe5I2+bqiIBdJM=;
        b=BroTE/QdMM4eBqR5IzgmpDJWKzWcKvAPYcyJMd/p4+3mYy+D+6z7Kn6sTXkWG6uVDp
         BXE3W4ToQiJGEJBnQmWSqHlwcjajouc0/F0OOkiLkjOW1NvrHcBpZGvlLQfSUiFb7Zs3
         GK77GAued7AodUyJRC5xqgDNEQ28S7Vqv7D+xzLLRf3UnvD5ZywjmTOusgZJ4M1tJig6
         a0Lh0mzh7+7/EGrLXSuzaLG5htjjfVjEJitz36ri1WZxUqPjeKyTGISXgP15otc5lgov
         aYBsoqBQXCv5j1sd8hixbV+KV+0R27o089KkPPJF9adGiXXNiZ34O5dJTfI1EB+OPb01
         2p7w==
MIME-Version: 1.0
X-Received: by 10.55.15.134 with SMTP id 6mr17718697qkp.38.1444990860819; Fri,
 16 Oct 2015 03:21:00 -0700 (PDT)
Received: by 10.55.156.213 with HTTP; Fri, 16 Oct 2015 03:21:00 -0700 (PDT)
Date: Fri, 16 Oct 2015 12:21:00 +0200
Message-ID: <CAKQ1sVNx3g2PjkxG6z2LwqA6CuJeVv2L6SryVsMWp2SydoKFjQ@mail.gmail.com>
Subject: H2 compatible ciphers (was: svn commit: r1708593)
From: Yann Ylavic <ylavic.dev@gmail.com>
To: dev@httpd.apache.org
Content-Type: text/plain; charset=UTF-8

On Wed, Oct 14, 2015 at 2:10 PM,  <icing@apache.org> wrote:
> Author: icing
> Date: Wed Oct 14 12:10:11 2015
> New Revision: 1708593
>
> URL: http://svn.apache.org/viewvc?rev=1708593&view=rev
> Log:
> mod_http2: new directive H2Compliance on/off, checking TLS protocol and cipher against RFC7540
>
[]
>
> Modified: httpd/httpd/trunk/modules/http2/h2_h2.c
> URL: http://svn.apache.org/viewvc/httpd/httpd/trunk/modules/http2/h2_h2.c?rev=1708593&r1=1708592&r2=1708593&view=diff
> ==============================================================================
> --- httpd/httpd/trunk/modules/http2/h2_h2.c (original)
> +++ httpd/httpd/trunk/modules/http2/h2_h2.c Wed Oct 14 12:10:11 2015
> @@ -54,6 +54,354 @@ APR_DECLARE_OPTIONAL_FN(int, ssl_is_http
[]
> +/*
> + * Black Listed Ciphers from RFC 7549 Appendix A
> + *
> + */
> +static const char *RFC7540_names[] = {

Wow, that's a pretty long list, and rather disputable IMHO...

[]
> +
> +    /* blacklisted AES128 encrpytion ciphers */
[]
> +    "DHE-RSA-AES128-SHA256",            /* TLS_DHE_RSA_WITH_AES_128_CBC_SHA256 */
[]
> +    "ECDHE-ECDSA-AES128-SHA256",        /* TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA256 */
[]
> +    "ECDHE-RSA-AES128-SHA256",          /* TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256 */
[]
> +    "AES128-GCM-SHA256",                /* TLS_RSA_WITH_AES_128_GCM_SHA256 */
[]
> +
> +    /* blacklisted AES256 encrpytion ciphers */
[]
> +    "DHE-RSA-AES256-SHA256",            /* TLS_DHE_RSA_WITH_AES_256_CBC_SHA256 */
[]
> +    "ECDHE-ECDSA-AES256-SHA384",        /* TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA384 */
[]
> +    "ECDHE-RSA-AES256-SHA384",          /* TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA384 */
[]
> +    "AES256-GCM-SHA384",                /* TLS_RSA_WITH_AES_256_GCM_SHA384 */
[]
> +
> +    /* blacklisted CAMELLIA128 encrpytion ciphers */
[]
> +    "ECDHE-ECDSA-CAMELLIA128-SHA256",   /* TLS_ECDHE_ECDSA_WITH_CAMELLIA_128_CBC_SHA256 */
[]
> +    "ECDHE-RSA-CAMELLIA128-SHA256",     /* TLS_ECDHE_RSA_WITH_CAMELLIA_128_CBC_SHA256 */
[]
> +    "CAMELLIA128-GCM-SHA256",           /* TLS_RSA_WITH_CAMELLIA_128_GCM_SHA256 */
[]
> +    "DHE-RSA-CAMELLIA128-SHA256",       /* TLS_DHE_RSA_WITH_CAMELLIA_128_CBC_SHA256 */
[]
> +
> +    /* blacklisted CAMELLIA256 encrpytion ciphers */
[]
> +    "ECDHE-ECDSA-CAMELLIA256-SHA384",   /* TLS_ECDHE_ECDSA_WITH_CAMELLIA_256_CBC_SHA384 */
[]
> +    "ECDHE-RSA-CAMELLIA256-SHA384",     /* TLS_ECDHE_RSA_WITH_CAMELLIA_256_CBC_SHA384 */
[]
> +    "DHE-RSA-CAMELLIA256-SHA256",       /* TLS_DHE_RSA_WITH_CAMELLIA_256_CBC_SHA256 */
[]
> +    "CAMELLIA256-GCM-SHA384",           /* TLS_RSA_WITH_CAMELLIA_256_GCM_SHA384 */
[]
> +};

Any idea why those above are blacklisted?
Looks like they decided to blacklist all non-ECDHe or CBC based cipher
suites, that's quite radical!
AFAICT, they are all (still) safe ciphers, maybe CBC ones are
"vulnerable" to timing attacks with SSL/TLS (lucky13 like, which
should have been addressed/countermeasured in most TLS libs though),
and DHE ones have lower performances due to network overhead with
big(ger) RSA keys, but what about RSA+GCM ones (which is still the
reference in AEAD cryptography!) with a reference block cipher (AES,
CAMELLIA, ...)?

And maybe more importantly, what remains currently?

I tried:
$ openssl ciphers -v 'TLSv1.2:!kRSA:!aECDH:!DH'

With openssl-1.0.2, this let us:
- ECDHE-RSA-AES256-GCM-SHA384
- ECDHE-ECDSA-AES256-GCM-SHA384
- ECDHE-RSA-AES256-SHA384
- ECDHE-ECDSA-AES256-SHA384
- ECDHE-RSA-AES128-GCM-SHA256
- ECDHE-ECDSA-AES128-GCM-SHA256
- ECDHE-RSA-AES128-SHA256
- ECDHE-ECDSA-AES128-SHA256

Whereas libressl-2.2.1 also adds:
- ECDHE-RSA-CHACHA20-POLY1305
- ECDHE-ECDSA-CHACHA20-POLY1305

Quite restrictive (even though those are obviously solid ciphers,
maybe IMHO modulo the complicated ECDSA mode which is disputed)...

BTW, if I am correct, maybe the SSLCipherSuite
'TLSv1.2:!kRSA:!aECDH:!DH' could be used/documented to avoid
whitelisting in httpd configurations (missing new/compatible ciphers
added to the TLS libs over time)...

PS: note that the SSLCipherSuite given in
https://icing.github.io/mod_h2/howto.html#https includes some in the
above blacklist.

From dev-return-84301-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Fri Oct 16 10:46:11 2015
Return-Path: <dev-return-84301-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id DBD5810C31
	for <apmail-httpd-dev-archive@www.apache.org>; Fri, 16 Oct 2015 10:46:11 +0000 (UTC)
Received: (qmail 38006 invoked by uid 500); 16 Oct 2015 10:46:11 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 37936 invoked by uid 500); 16 Oct 2015 10:46:11 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 37926 invoked by uid 99); 16 Oct 2015 10:46:11 -0000
Received: from Unknown (HELO spamd4-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 16 Oct 2015 10:46:11 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd4-us-west.apache.org (ASF Mail Server at spamd4-us-west.apache.org) with ESMTP id F060BC084E
	for <dev@httpd.apache.org>; Fri, 16 Oct 2015 10:46:10 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd4-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.009
X-Spam-Level:
X-Spam-Status: No, score=-0.009 tagged_above=-999 required=6.31
	tests=[T_RP_MATCHES_RCVD=-0.01, URIBL_BLOCKED=0.001]
	autolearn=disabled
Received: from mx1-us-west.apache.org ([10.40.0.8])
	by localhost (spamd4-us-west.apache.org [10.40.0.11]) (amavisd-new, port 10024)
	with ESMTP id 8k1RuT4-DC8n for <dev@httpd.apache.org>;
	Fri, 16 Oct 2015 10:45:58 +0000 (UTC)
Received: from mail.greenbytes.de (mail.greenbytes.de [217.91.35.233])
	by mx1-us-west.apache.org (ASF Mail Server at mx1-us-west.apache.org) with ESMTPS id 180FF23038
	for <dev@httpd.apache.org>; Fri, 16 Oct 2015 10:45:58 +0000 (UTC)
Received: from [192.168.1.48] (unknown [87.78.174.25])
	(using TLSv1 with cipher ECDHE-RSA-AES256-SHA (256/256 bits))
	(Client did not present a certificate)
	by mail.greenbytes.de (Postfix) with ESMTPSA id 06AF815A0321
	for <dev@httpd.apache.org>; Fri, 16 Oct 2015 12:45:55 +0200 (CEST)
Content-Type: text/plain; charset=us-ascii
Mime-Version: 1.0 (Mac OS X Mail 9.0 \(3094\))
Subject: Re: H2 compatible ciphers (was: svn commit: r1708593)
From: Stefan Eissing <stefan.eissing@greenbytes.de>
In-Reply-To: <CAKQ1sVNx3g2PjkxG6z2LwqA6CuJeVv2L6SryVsMWp2SydoKFjQ@mail.gmail.com>
Date: Fri, 16 Oct 2015 12:45:54 +0200
Content-Transfer-Encoding: quoted-printable
Message-Id: <7785D0B9-E1C7-483E-B468-CBDFA99156BB@greenbytes.de>
References: <CAKQ1sVNx3g2PjkxG6z2LwqA6CuJeVv2L6SryVsMWp2SydoKFjQ@mail.gmail.com>
To: dev@httpd.apache.org
X-Mailer: Apple Mail (2.3094)

Hi Yann,

I am not a cipher expert enough to know why the list in RFC 7540 was =
compiled this way... :(

But indeed, there is a good sized overlap. And that does not make sense. =
I have sent a mail to the httpwg mailing list, asking for enlightment.

If the blacklist in RFC 7540 proves to be totally bogus, I'd favor =
ditching it in our server checks.=20

However there are some value to be had in checking that user's do not =
activate "unsafe" ciphers by accident. If an admin can configure our =
server to have something like the categories described at =
https://wiki.mozilla.org/Security/Server_Side_TLS#Modern_compatibility =
that could help.

What I mean is an SSL config where I can say:

   SSLCompatibility modern|intermediate|old|custom

(or something along the lines), it could be a safeguard against all =
other SSL parameter configs. The defaults for ciphers and other params =
could change according to this, or at least WARNINGS could be logged in =
case a negotiated connection violates it. Maybe

   SSLCompatibilityPolicy warn|enforce|ignore

???

> Am 16.10.2015 um 12:21 schrieb Yann Ylavic <ylavic.dev@gmail.com>:
>=20
> On Wed, Oct 14, 2015 at 2:10 PM,  <icing@apache.org> wrote:
>> Author: icing
>> Date: Wed Oct 14 12:10:11 2015
>> New Revision: 1708593
>>=20
>> URL: http://svn.apache.org/viewvc?rev=3D1708593&view=3Drev
>> Log:
>> mod_http2: new directive H2Compliance on/off, checking TLS protocol =
and cipher against RFC7540
>>=20
> []
>>=20
>> Modified: httpd/httpd/trunk/modules/http2/h2_h2.c
>> URL: =
http://svn.apache.org/viewvc/httpd/httpd/trunk/modules/http2/h2_h2.c?rev=3D=
1708593&r1=3D1708592&r2=3D1708593&view=3Ddiff
>> =
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
>> --- httpd/httpd/trunk/modules/http2/h2_h2.c (original)
>> +++ httpd/httpd/trunk/modules/http2/h2_h2.c Wed Oct 14 12:10:11 2015
>> @@ -54,6 +54,354 @@ APR_DECLARE_OPTIONAL_FN(int, ssl_is_http
> []
>> +/*
>> + * Black Listed Ciphers from RFC 7549 Appendix A
>> + *
>> + */
>> +static const char *RFC7540_names[] =3D {
>=20
> Wow, that's a pretty long list, and rather disputable IMHO...
>=20
> []
>> +
>> +    /* blacklisted AES128 encrpytion ciphers */
> []
>> +    "DHE-RSA-AES128-SHA256",            /* =
TLS_DHE_RSA_WITH_AES_128_CBC_SHA256 */
> []
>> +    "ECDHE-ECDSA-AES128-SHA256",        /* =
TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA256 */
> []
>> +    "ECDHE-RSA-AES128-SHA256",          /* =
TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256 */
> []
>> +    "AES128-GCM-SHA256",                /* =
TLS_RSA_WITH_AES_128_GCM_SHA256 */
> []
>> +
>> +    /* blacklisted AES256 encrpytion ciphers */
> []
>> +    "DHE-RSA-AES256-SHA256",            /* =
TLS_DHE_RSA_WITH_AES_256_CBC_SHA256 */
> []
>> +    "ECDHE-ECDSA-AES256-SHA384",        /* =
TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA384 */
> []
>> +    "ECDHE-RSA-AES256-SHA384",          /* =
TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA384 */
> []
>> +    "AES256-GCM-SHA384",                /* =
TLS_RSA_WITH_AES_256_GCM_SHA384 */
> []
>> +
>> +    /* blacklisted CAMELLIA128 encrpytion ciphers */
> []
>> +    "ECDHE-ECDSA-CAMELLIA128-SHA256",   /* =
TLS_ECDHE_ECDSA_WITH_CAMELLIA_128_CBC_SHA256 */
> []
>> +    "ECDHE-RSA-CAMELLIA128-SHA256",     /* =
TLS_ECDHE_RSA_WITH_CAMELLIA_128_CBC_SHA256 */
> []
>> +    "CAMELLIA128-GCM-SHA256",           /* =
TLS_RSA_WITH_CAMELLIA_128_GCM_SHA256 */
> []
>> +    "DHE-RSA-CAMELLIA128-SHA256",       /* =
TLS_DHE_RSA_WITH_CAMELLIA_128_CBC_SHA256 */
> []
>> +
>> +    /* blacklisted CAMELLIA256 encrpytion ciphers */
> []
>> +    "ECDHE-ECDSA-CAMELLIA256-SHA384",   /* =
TLS_ECDHE_ECDSA_WITH_CAMELLIA_256_CBC_SHA384 */
> []
>> +    "ECDHE-RSA-CAMELLIA256-SHA384",     /* =
TLS_ECDHE_RSA_WITH_CAMELLIA_256_CBC_SHA384 */
> []
>> +    "DHE-RSA-CAMELLIA256-SHA256",       /* =
TLS_DHE_RSA_WITH_CAMELLIA_256_CBC_SHA256 */
> []
>> +    "CAMELLIA256-GCM-SHA384",           /* =
TLS_RSA_WITH_CAMELLIA_256_GCM_SHA384 */
> []
>> +};
>=20
> Any idea why those above are blacklisted?
> Looks like they decided to blacklist all non-ECDHe or CBC based cipher
> suites, that's quite radical!
> AFAICT, they are all (still) safe ciphers, maybe CBC ones are
> "vulnerable" to timing attacks with SSL/TLS (lucky13 like, which
> should have been addressed/countermeasured in most TLS libs though),
> and DHE ones have lower performances due to network overhead with
> big(ger) RSA keys, but what about RSA+GCM ones (which is still the
> reference in AEAD cryptography!) with a reference block cipher (AES,
> CAMELLIA, ...)?
>=20
> And maybe more importantly, what remains currently?
>=20
> I tried:
> $ openssl ciphers -v 'TLSv1.2:!kRSA:!aECDH:!DH'
>=20
> With openssl-1.0.2, this let us:
> - ECDHE-RSA-AES256-GCM-SHA384
> - ECDHE-ECDSA-AES256-GCM-SHA384
> - ECDHE-RSA-AES256-SHA384
> - ECDHE-ECDSA-AES256-SHA384
> - ECDHE-RSA-AES128-GCM-SHA256
> - ECDHE-ECDSA-AES128-GCM-SHA256
> - ECDHE-RSA-AES128-SHA256
> - ECDHE-ECDSA-AES128-SHA256
>=20
> Whereas libressl-2.2.1 also adds:
> - ECDHE-RSA-CHACHA20-POLY1305
> - ECDHE-ECDSA-CHACHA20-POLY1305
>=20
> Quite restrictive (even though those are obviously solid ciphers,
> maybe IMHO modulo the complicated ECDSA mode which is disputed)...
>=20
> BTW, if I am correct, maybe the SSLCipherSuite
> 'TLSv1.2:!kRSA:!aECDH:!DH' could be used/documented to avoid
> whitelisting in httpd configurations (missing new/compatible ciphers
> added to the TLS libs over time)...
>=20
> PS: note that the SSLCipherSuite given in
> https://icing.github.io/mod_h2/howto.html#https includes some in the
> above blacklist.


From dev-return-84302-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Fri Oct 16 10:54:10 2015
Return-Path: <dev-return-84302-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id B598210C7F
	for <apmail-httpd-dev-archive@www.apache.org>; Fri, 16 Oct 2015 10:54:10 +0000 (UTC)
Received: (qmail 58976 invoked by uid 500); 16 Oct 2015 10:54:09 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 58913 invoked by uid 500); 16 Oct 2015 10:54:09 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 58903 invoked by uid 99); 16 Oct 2015 10:54:09 -0000
Received: from Unknown (HELO spamd4-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 16 Oct 2015 10:54:09 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd4-us-west.apache.org (ASF Mail Server at spamd4-us-west.apache.org) with ESMTP id 32EABC084E
	for <dev@httpd.apache.org>; Fri, 16 Oct 2015 10:54:09 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd4-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.1
X-Spam-Level:
X-Spam-Status: No, score=-0.1 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	SPF_PASS=-0.001, URIBL_BLOCKED=0.001] autolearn=disabled
Authentication-Results: spamd4-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd4-us-west.apache.org [10.40.0.11]) (amavisd-new, port 10024)
	with ESMTP id KDieO2Mh0KKG for <dev@httpd.apache.org>;
	Fri, 16 Oct 2015 10:53:59 +0000 (UTC)
Received: from mail-wi0-f176.google.com (mail-wi0-f176.google.com [209.85.212.176])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id 0708F429AA
	for <dev@httpd.apache.org>; Fri, 16 Oct 2015 10:53:59 +0000 (UTC)
Received: by wicgb1 with SMTP id gb1so4219217wic.1
        for <dev@httpd.apache.org>; Fri, 16 Oct 2015 03:53:52 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=mime-version:in-reply-to:references:from:date:message-id:subject:to
         :content-type:content-transfer-encoding;
        bh=/CTVb7x/BwnVh9zZq6Ob+WeLEP9hb7zHZureSAeqP4M=;
        b=DjtCg3NEYQRGCgxTdXW4tsCYl+REX1FHb0zVm/HVhs8jwlqeZMNZnHlwexijc4lqra
         WHPWI0yeAnhB8B50hW5w8adE2jFGHH5AtEzDnxtAMEZLdyoHkKaW75/i35Acs6d+Wt6I
         a8hCMUu62BEYCer8eY2xZCJnPgRrHwJWbg+PnmGLhnolCDmiu67hcXcVJHWfv0LnB9+r
         pe/A2HXG/77oMoBREbQPMuIVGmnji46HkzVkmIyBuB+InfTJzOmc4kBMDWLkWfmTDDVd
         zqYtwACYXPBUlrV5wMJIQ0AfYTNlt7ZSu+H8a8SMmRM+CDhl2I6KL5mwnzWJo5Qcs/R1
         +m+A==
X-Received: by 10.194.6.106 with SMTP id z10mr16222324wjz.104.1444992832278;
 Fri, 16 Oct 2015 03:53:52 -0700 (PDT)
MIME-Version: 1.0
Received: by 10.27.88.10 with HTTP; Fri, 16 Oct 2015 03:53:32 -0700 (PDT)
In-Reply-To: <7785D0B9-E1C7-483E-B468-CBDFA99156BB@greenbytes.de>
References: <CAKQ1sVNx3g2PjkxG6z2LwqA6CuJeVv2L6SryVsMWp2SydoKFjQ@mail.gmail.com>
 <7785D0B9-E1C7-483E-B468-CBDFA99156BB@greenbytes.de>
From: Chris <chrcoluk@gmail.com>
Date: Fri, 16 Oct 2015 11:53:32 +0100
Message-ID: <CAOhm=5qz=bZOfBa9dCkyWZhVZGzRtX_0pzM0HmwYTOFzTxP1Uw@mail.gmail.com>
Subject: Re: H2 compatible ciphers (was: svn commit: r1708593)
To: dev@httpd.apache.org
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: quoted-printable

The blacklist does look too radical to me as well.  My server was
configured with some in that list.

Also it can place a server admin in a tough position e.g. what if they
want to support IE8, or maybe android2 which doesn thave tls 1.2
stuff, but also support h2, they would be forced to choose one or the
other.

On 16 October 2015 at 11:45, Stefan Eissing
<stefan.eissing@greenbytes.de> wrote:
> Hi Yann,
>
> I am not a cipher expert enough to know why the list in RFC 7540 was comp=
iled this way... :(
>
> But indeed, there is a good sized overlap. And that does not make sense. =
I have sent a mail to the httpwg mailing list, asking for enlightment.
>
> If the blacklist in RFC 7540 proves to be totally bogus, I'd favor ditchi=
ng it in our server checks.
>
> However there are some value to be had in checking that user's do not act=
ivate "unsafe" ciphers by accident. If an admin can configure our server to=
 have something like the categories described at https://wiki.mozilla.org/S=
ecurity/Server_Side_TLS#Modern_compatibility that could help.
>
> What I mean is an SSL config where I can say:
>
>    SSLCompatibility modern|intermediate|old|custom
>
> (or something along the lines), it could be a safeguard against all other=
 SSL parameter configs. The defaults for ciphers and other params could cha=
nge according to this, or at least WARNINGS could be logged in case a negot=
iated connection violates it. Maybe
>
>    SSLCompatibilityPolicy warn|enforce|ignore
>
> ???
>
>> Am 16.10.2015 um 12:21 schrieb Yann Ylavic <ylavic.dev@gmail.com>:
>>
>> On Wed, Oct 14, 2015 at 2:10 PM,  <icing@apache.org> wrote:
>>> Author: icing
>>> Date: Wed Oct 14 12:10:11 2015
>>> New Revision: 1708593
>>>
>>> URL: http://svn.apache.org/viewvc?rev=3D1708593&view=3Drev
>>> Log:
>>> mod_http2: new directive H2Compliance on/off, checking TLS protocol and=
 cipher against RFC7540
>>>
>> []
>>>
>>> Modified: httpd/httpd/trunk/modules/http2/h2_h2.c
>>> URL: http://svn.apache.org/viewvc/httpd/httpd/trunk/modules/http2/h2_h2=
.c?rev=3D1708593&r1=3D1708592&r2=3D1708593&view=3Ddiff
>>> =3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D
>>> --- httpd/httpd/trunk/modules/http2/h2_h2.c (original)
>>> +++ httpd/httpd/trunk/modules/http2/h2_h2.c Wed Oct 14 12:10:11 2015
>>> @@ -54,6 +54,354 @@ APR_DECLARE_OPTIONAL_FN(int, ssl_is_http
>> []
>>> +/*
>>> + * Black Listed Ciphers from RFC 7549 Appendix A
>>> + *
>>> + */
>>> +static const char *RFC7540_names[] =3D {
>>
>> Wow, that's a pretty long list, and rather disputable IMHO...
>>
>> []
>>> +
>>> +    /* blacklisted AES128 encrpytion ciphers */
>> []
>>> +    "DHE-RSA-AES128-SHA256",            /* TLS_DHE_RSA_WITH_AES_128_CB=
C_SHA256 */
>> []
>>> +    "ECDHE-ECDSA-AES128-SHA256",        /* TLS_ECDHE_ECDSA_WITH_AES_12=
8_CBC_SHA256 */
>> []
>>> +    "ECDHE-RSA-AES128-SHA256",          /* TLS_ECDHE_RSA_WITH_AES_128_=
CBC_SHA256 */
>> []
>>> +    "AES128-GCM-SHA256",                /* TLS_RSA_WITH_AES_128_GCM_SH=
A256 */
>> []
>>> +
>>> +    /* blacklisted AES256 encrpytion ciphers */
>> []
>>> +    "DHE-RSA-AES256-SHA256",            /* TLS_DHE_RSA_WITH_AES_256_CB=
C_SHA256 */
>> []
>>> +    "ECDHE-ECDSA-AES256-SHA384",        /* TLS_ECDHE_ECDSA_WITH_AES_25=
6_CBC_SHA384 */
>> []
>>> +    "ECDHE-RSA-AES256-SHA384",          /* TLS_ECDHE_RSA_WITH_AES_256_=
CBC_SHA384 */
>> []
>>> +    "AES256-GCM-SHA384",                /* TLS_RSA_WITH_AES_256_GCM_SH=
A384 */
>> []
>>> +
>>> +    /* blacklisted CAMELLIA128 encrpytion ciphers */
>> []
>>> +    "ECDHE-ECDSA-CAMELLIA128-SHA256",   /* TLS_ECDHE_ECDSA_WITH_CAMELL=
IA_128_CBC_SHA256 */
>> []
>>> +    "ECDHE-RSA-CAMELLIA128-SHA256",     /* TLS_ECDHE_RSA_WITH_CAMELLIA=
_128_CBC_SHA256 */
>> []
>>> +    "CAMELLIA128-GCM-SHA256",           /* TLS_RSA_WITH_CAMELLIA_128_G=
CM_SHA256 */
>> []
>>> +    "DHE-RSA-CAMELLIA128-SHA256",       /* TLS_DHE_RSA_WITH_CAMELLIA_1=
28_CBC_SHA256 */
>> []
>>> +
>>> +    /* blacklisted CAMELLIA256 encrpytion ciphers */
>> []
>>> +    "ECDHE-ECDSA-CAMELLIA256-SHA384",   /* TLS_ECDHE_ECDSA_WITH_CAMELL=
IA_256_CBC_SHA384 */
>> []
>>> +    "ECDHE-RSA-CAMELLIA256-SHA384",     /* TLS_ECDHE_RSA_WITH_CAMELLIA=
_256_CBC_SHA384 */
>> []
>>> +    "DHE-RSA-CAMELLIA256-SHA256",       /* TLS_DHE_RSA_WITH_CAMELLIA_2=
56_CBC_SHA256 */
>> []
>>> +    "CAMELLIA256-GCM-SHA384",           /* TLS_RSA_WITH_CAMELLIA_256_G=
CM_SHA384 */
>> []
>>> +};
>>
>> Any idea why those above are blacklisted?
>> Looks like they decided to blacklist all non-ECDHe or CBC based cipher
>> suites, that's quite radical!
>> AFAICT, they are all (still) safe ciphers, maybe CBC ones are
>> "vulnerable" to timing attacks with SSL/TLS (lucky13 like, which
>> should have been addressed/countermeasured in most TLS libs though),
>> and DHE ones have lower performances due to network overhead with
>> big(ger) RSA keys, but what about RSA+GCM ones (which is still the
>> reference in AEAD cryptography!) with a reference block cipher (AES,
>> CAMELLIA, ...)?
>>
>> And maybe more importantly, what remains currently?
>>
>> I tried:
>> $ openssl ciphers -v 'TLSv1.2:!kRSA:!aECDH:!DH'
>>
>> With openssl-1.0.2, this let us:
>> - ECDHE-RSA-AES256-GCM-SHA384
>> - ECDHE-ECDSA-AES256-GCM-SHA384
>> - ECDHE-RSA-AES256-SHA384
>> - ECDHE-ECDSA-AES256-SHA384
>> - ECDHE-RSA-AES128-GCM-SHA256
>> - ECDHE-ECDSA-AES128-GCM-SHA256
>> - ECDHE-RSA-AES128-SHA256
>> - ECDHE-ECDSA-AES128-SHA256
>>
>> Whereas libressl-2.2.1 also adds:
>> - ECDHE-RSA-CHACHA20-POLY1305
>> - ECDHE-ECDSA-CHACHA20-POLY1305
>>
>> Quite restrictive (even though those are obviously solid ciphers,
>> maybe IMHO modulo the complicated ECDSA mode which is disputed)...
>>
>> BTW, if I am correct, maybe the SSLCipherSuite
>> 'TLSv1.2:!kRSA:!aECDH:!DH' could be used/documented to avoid
>> whitelisting in httpd configurations (missing new/compatible ciphers
>> added to the TLS libs over time)...
>>
>> PS: note that the SSLCipherSuite given in
>> https://icing.github.io/mod_h2/howto.html#https includes some in the
>> above blacklist.
>

From dev-return-84303-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Fri Oct 16 10:57:07 2015
Return-Path: <dev-return-84303-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 948A210C94
	for <apmail-httpd-dev-archive@www.apache.org>; Fri, 16 Oct 2015 10:57:07 +0000 (UTC)
Received: (qmail 62591 invoked by uid 500); 16 Oct 2015 10:57:06 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 62518 invoked by uid 500); 16 Oct 2015 10:57:06 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 62508 invoked by uid 99); 16 Oct 2015 10:57:06 -0000
Received: from Unknown (HELO spamd4-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 16 Oct 2015 10:57:06 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd4-us-west.apache.org (ASF Mail Server at spamd4-us-west.apache.org) with ESMTP id 0CF6BC084E
	for <dev@httpd.apache.org>; Fri, 16 Oct 2015 10:57:06 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd4-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.009
X-Spam-Level:
X-Spam-Status: No, score=-0.009 tagged_above=-999 required=6.31
	tests=[T_RP_MATCHES_RCVD=-0.01, URIBL_BLOCKED=0.001]
	autolearn=disabled
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd4-us-west.apache.org [10.40.0.11]) (amavisd-new, port 10024)
	with ESMTP id F9xwkIIfTKgl for <dev@httpd.apache.org>;
	Fri, 16 Oct 2015 10:56:52 +0000 (UTC)
Received: from mail.greenbytes.de (mail.greenbytes.de [217.91.35.233])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id 17F2820751
	for <dev@httpd.apache.org>; Fri, 16 Oct 2015 10:56:52 +0000 (UTC)
Received: from [192.168.1.48] (unknown [87.78.174.25])
	(using TLSv1 with cipher ECDHE-RSA-AES256-SHA (256/256 bits))
	(Client did not present a certificate)
	by mail.greenbytes.de (Postfix) with ESMTPSA id 75FF315A043B
	for <dev@httpd.apache.org>; Fri, 16 Oct 2015 12:56:51 +0200 (CEST)
Content-Type: text/plain; charset=us-ascii
Mime-Version: 1.0 (Mac OS X Mail 9.0 \(3094\))
Subject: Re: H2 compatible ciphers (was: svn commit: r1708593)
From: Stefan Eissing <stefan.eissing@greenbytes.de>
In-Reply-To: <CAOhm=5qz=bZOfBa9dCkyWZhVZGzRtX_0pzM0HmwYTOFzTxP1Uw@mail.gmail.com>
Date: Fri, 16 Oct 2015 12:56:50 +0200
Content-Transfer-Encoding: quoted-printable
Message-Id: <3C3CEF7B-8FDC-4F0A-B830-8E336C1D9D76@greenbytes.de>
References: <CAKQ1sVNx3g2PjkxG6z2LwqA6CuJeVv2L6SryVsMWp2SydoKFjQ@mail.gmail.com> <7785D0B9-E1C7-483E-B468-CBDFA99156BB@greenbytes.de> <CAOhm=5qz=bZOfBa9dCkyWZhVZGzRtX_0pzM0HmwYTOFzTxP1Uw@mail.gmail.com>
To: dev@httpd.apache.org
X-Mailer: Apple Mail (2.3094)

I am not blacklisting ciphers for the whole server. I try to define
the security settings required for HTTP/2 as defined in the standard -
as a configurable directive.

There is no problem with denying HTTP/2 support for an IE8.

//Stefan

> Am 16.10.2015 um 12:53 schrieb Chris <chrcoluk@gmail.com>:
>=20
> The blacklist does look too radical to me as well.  My server was
> configured with some in that list.
>=20
> Also it can place a server admin in a tough position e.g. what if they
> want to support IE8, or maybe android2 which doesn thave tls 1.2
> stuff, but also support h2, they would be forced to choose one or the
> other.
>=20
> On 16 October 2015 at 11:45, Stefan Eissing
> <stefan.eissing@greenbytes.de> wrote:
>> Hi Yann,
>>=20
>> I am not a cipher expert enough to know why the list in RFC 7540 was =
compiled this way... :(
>>=20
>> But indeed, there is a good sized overlap. And that does not make =
sense. I have sent a mail to the httpwg mailing list, asking for =
enlightment.
>>=20
>> If the blacklist in RFC 7540 proves to be totally bogus, I'd favor =
ditching it in our server checks.
>>=20
>> However there are some value to be had in checking that user's do not =
activate "unsafe" ciphers by accident. If an admin can configure our =
server to have something like the categories described at =
https://wiki.mozilla.org/Security/Server_Side_TLS#Modern_compatibility =
that could help.
>>=20
>> What I mean is an SSL config where I can say:
>>=20
>>   SSLCompatibility modern|intermediate|old|custom
>>=20
>> (or something along the lines), it could be a safeguard against all =
other SSL parameter configs. The defaults for ciphers and other params =
could change according to this, or at least WARNINGS could be logged in =
case a negotiated connection violates it. Maybe
>>=20
>>   SSLCompatibilityPolicy warn|enforce|ignore
>>=20
>> ???
>>=20
>>> Am 16.10.2015 um 12:21 schrieb Yann Ylavic <ylavic.dev@gmail.com>:
>>>=20
>>> On Wed, Oct 14, 2015 at 2:10 PM,  <icing@apache.org> wrote:
>>>> Author: icing
>>>> Date: Wed Oct 14 12:10:11 2015
>>>> New Revision: 1708593
>>>>=20
>>>> URL: http://svn.apache.org/viewvc?rev=3D1708593&view=3Drev
>>>> Log:
>>>> mod_http2: new directive H2Compliance on/off, checking TLS protocol =
and cipher against RFC7540
>>>>=20
>>> []
>>>>=20
>>>> Modified: httpd/httpd/trunk/modules/http2/h2_h2.c
>>>> URL: =
http://svn.apache.org/viewvc/httpd/httpd/trunk/modules/http2/h2_h2.c?rev=3D=
1708593&r1=3D1708592&r2=3D1708593&view=3Ddiff
>>>> =
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
>>>> --- httpd/httpd/trunk/modules/http2/h2_h2.c (original)
>>>> +++ httpd/httpd/trunk/modules/http2/h2_h2.c Wed Oct 14 12:10:11 =
2015
>>>> @@ -54,6 +54,354 @@ APR_DECLARE_OPTIONAL_FN(int, ssl_is_http
>>> []
>>>> +/*
>>>> + * Black Listed Ciphers from RFC 7549 Appendix A
>>>> + *
>>>> + */
>>>> +static const char *RFC7540_names[] =3D {
>>>=20
>>> Wow, that's a pretty long list, and rather disputable IMHO...
>>>=20
>>> []
>>>> +
>>>> +    /* blacklisted AES128 encrpytion ciphers */
>>> []
>>>> +    "DHE-RSA-AES128-SHA256",            /* =
TLS_DHE_RSA_WITH_AES_128_CBC_SHA256 */
>>> []
>>>> +    "ECDHE-ECDSA-AES128-SHA256",        /* =
TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA256 */
>>> []
>>>> +    "ECDHE-RSA-AES128-SHA256",          /* =
TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256 */
>>> []
>>>> +    "AES128-GCM-SHA256",                /* =
TLS_RSA_WITH_AES_128_GCM_SHA256 */
>>> []
>>>> +
>>>> +    /* blacklisted AES256 encrpytion ciphers */
>>> []
>>>> +    "DHE-RSA-AES256-SHA256",            /* =
TLS_DHE_RSA_WITH_AES_256_CBC_SHA256 */
>>> []
>>>> +    "ECDHE-ECDSA-AES256-SHA384",        /* =
TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA384 */
>>> []
>>>> +    "ECDHE-RSA-AES256-SHA384",          /* =
TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA384 */
>>> []
>>>> +    "AES256-GCM-SHA384",                /* =
TLS_RSA_WITH_AES_256_GCM_SHA384 */
>>> []
>>>> +
>>>> +    /* blacklisted CAMELLIA128 encrpytion ciphers */
>>> []
>>>> +    "ECDHE-ECDSA-CAMELLIA128-SHA256",   /* =
TLS_ECDHE_ECDSA_WITH_CAMELLIA_128_CBC_SHA256 */
>>> []
>>>> +    "ECDHE-RSA-CAMELLIA128-SHA256",     /* =
TLS_ECDHE_RSA_WITH_CAMELLIA_128_CBC_SHA256 */
>>> []
>>>> +    "CAMELLIA128-GCM-SHA256",           /* =
TLS_RSA_WITH_CAMELLIA_128_GCM_SHA256 */
>>> []
>>>> +    "DHE-RSA-CAMELLIA128-SHA256",       /* =
TLS_DHE_RSA_WITH_CAMELLIA_128_CBC_SHA256 */
>>> []
>>>> +
>>>> +    /* blacklisted CAMELLIA256 encrpytion ciphers */
>>> []
>>>> +    "ECDHE-ECDSA-CAMELLIA256-SHA384",   /* =
TLS_ECDHE_ECDSA_WITH_CAMELLIA_256_CBC_SHA384 */
>>> []
>>>> +    "ECDHE-RSA-CAMELLIA256-SHA384",     /* =
TLS_ECDHE_RSA_WITH_CAMELLIA_256_CBC_SHA384 */
>>> []
>>>> +    "DHE-RSA-CAMELLIA256-SHA256",       /* =
TLS_DHE_RSA_WITH_CAMELLIA_256_CBC_SHA256 */
>>> []
>>>> +    "CAMELLIA256-GCM-SHA384",           /* =
TLS_RSA_WITH_CAMELLIA_256_GCM_SHA384 */
>>> []
>>>> +};
>>>=20
>>> Any idea why those above are blacklisted?
>>> Looks like they decided to blacklist all non-ECDHe or CBC based =
cipher
>>> suites, that's quite radical!
>>> AFAICT, they are all (still) safe ciphers, maybe CBC ones are
>>> "vulnerable" to timing attacks with SSL/TLS (lucky13 like, which
>>> should have been addressed/countermeasured in most TLS libs though),
>>> and DHE ones have lower performances due to network overhead with
>>> big(ger) RSA keys, but what about RSA+GCM ones (which is still the
>>> reference in AEAD cryptography!) with a reference block cipher (AES,
>>> CAMELLIA, ...)?
>>>=20
>>> And maybe more importantly, what remains currently?
>>>=20
>>> I tried:
>>> $ openssl ciphers -v 'TLSv1.2:!kRSA:!aECDH:!DH'
>>>=20
>>> With openssl-1.0.2, this let us:
>>> - ECDHE-RSA-AES256-GCM-SHA384
>>> - ECDHE-ECDSA-AES256-GCM-SHA384
>>> - ECDHE-RSA-AES256-SHA384
>>> - ECDHE-ECDSA-AES256-SHA384
>>> - ECDHE-RSA-AES128-GCM-SHA256
>>> - ECDHE-ECDSA-AES128-GCM-SHA256
>>> - ECDHE-RSA-AES128-SHA256
>>> - ECDHE-ECDSA-AES128-SHA256
>>>=20
>>> Whereas libressl-2.2.1 also adds:
>>> - ECDHE-RSA-CHACHA20-POLY1305
>>> - ECDHE-ECDSA-CHACHA20-POLY1305
>>>=20
>>> Quite restrictive (even though those are obviously solid ciphers,
>>> maybe IMHO modulo the complicated ECDSA mode which is disputed)...
>>>=20
>>> BTW, if I am correct, maybe the SSLCipherSuite
>>> 'TLSv1.2:!kRSA:!aECDH:!DH' could be used/documented to avoid
>>> whitelisting in httpd configurations (missing new/compatible ciphers
>>> added to the TLS libs over time)...
>>>=20
>>> PS: note that the SSLCipherSuite given in
>>> https://icing.github.io/mod_h2/howto.html#https includes some in the
>>> above blacklist.
>>=20


From dev-return-84304-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Fri Oct 16 11:36:19 2015
Return-Path: <dev-return-84304-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 208EC10E23
	for <apmail-httpd-dev-archive@www.apache.org>; Fri, 16 Oct 2015 11:36:19 +0000 (UTC)
Received: (qmail 35376 invoked by uid 500); 16 Oct 2015 11:36:18 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 35305 invoked by uid 500); 16 Oct 2015 11:36:18 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 35292 invoked by uid 99); 16 Oct 2015 11:36:18 -0000
Received: from Unknown (HELO spamd1-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 16 Oct 2015 11:36:18 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd1-us-west.apache.org (ASF Mail Server at spamd1-us-west.apache.org) with ESMTP id 3D914C5059
	for <dev@httpd.apache.org>; Fri, 16 Oct 2015 11:36:18 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd1-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.01
X-Spam-Level:
X-Spam-Status: No, score=-0.01 tagged_above=-999 required=6.31
	tests=[SPF_PASS=-0.001, T_RP_MATCHES_RCVD=-0.01, URIBL_BLOCKED=0.001]
	autolearn=disabled
Received: from mx1-us-west.apache.org ([10.40.0.8])
	by localhost (spamd1-us-west.apache.org [10.40.0.7]) (amavisd-new, port 10024)
	with ESMTP id igLbCW-sEjdh for <dev@httpd.apache.org>;
	Fri, 16 Oct 2015 11:36:10 +0000 (UTC)
Received: from monica.sharp.fm (monica.sharp.fm [80.168.143.5])
	by mx1-us-west.apache.org (ASF Mail Server at mx1-us-west.apache.org) with ESMTP id 8F1F522F1F
	for <dev@httpd.apache.org>; Fri, 16 Oct 2015 11:36:10 +0000 (UTC)
Received: from [192.168.220.234] (unknown [192.168.220.234])
	(using TLSv1 with cipher DHE-RSA-AES256-SHA (256/256 bits))
	(Client did not present a certificate)
	(Authenticated sender: minfrin@sharp.fm)
	by monica.sharp.fm (Postfix) with ESMTPSA id 9A996831D6
	for <dev@httpd.apache.org>; Fri, 16 Oct 2015 12:36:02 +0100 (BST)
Content-Type: text/plain; charset=utf-8
Mime-Version: 1.0 (Mac OS X Mail 8.2 \(2104\))
Subject: Re: H2 compatible ciphers (was: svn commit: r1708593)
From: Graham Leggett <minfrin@sharp.fm>
In-Reply-To: <3C3CEF7B-8FDC-4F0A-B830-8E336C1D9D76@greenbytes.de>
Date: Fri, 16 Oct 2015 13:36:01 +0200
Content-Transfer-Encoding: quoted-printable
Message-Id: <AFF097DC-8F37-4608-9D76-A397DAB7D79E@sharp.fm>
References: <CAKQ1sVNx3g2PjkxG6z2LwqA6CuJeVv2L6SryVsMWp2SydoKFjQ@mail.gmail.com> <7785D0B9-E1C7-483E-B468-CBDFA99156BB@greenbytes.de> <CAOhm=5qz=bZOfBa9dCkyWZhVZGzRtX_0pzM0HmwYTOFzTxP1Uw@mail.gmail.com> <3C3CEF7B-8FDC-4F0A-B830-8E336C1D9D76@greenbytes.de>
To: dev@httpd.apache.org
X-Mailer: Apple Mail (2.2104)

On 16 Oct 2015, at 12:56 PM, Stefan Eissing =
<stefan.eissing@greenbytes.de> wrote:

> I am not blacklisting ciphers for the whole server. I try to define
> the security settings required for HTTP/2 as defined in the standard -
> as a configurable directive.
>=20
> There is no problem with denying HTTP/2 support for an IE8.

I am wondering whether the cipher blacklist shouldn=E2=80=99t be a =
configurable list with a default set of RFC compliant values in the =
default config file, perhaps with shortcuts like naming a blacklist =
after an RFC.

Fitting this in with the existing infrastructure this could be as simple =
as extending the SSLCipherSuite directive to support this:

SSLCipherSuite -RFC7540

Maybe this is actually an openssl problem rather than an httpd problem, =
it could be that openssl needs to be taught how to blacklist RFC7540 as =
a group.

Regards,
Graham
=E2=80=94


From dev-return-84305-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Fri Oct 16 11:38:30 2015
Return-Path: <dev-return-84305-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 9255A10E37
	for <apmail-httpd-dev-archive@www.apache.org>; Fri, 16 Oct 2015 11:38:30 +0000 (UTC)
Received: (qmail 37854 invoked by uid 500); 16 Oct 2015 11:38:30 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 37785 invoked by uid 500); 16 Oct 2015 11:38:30 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 37774 invoked by uid 99); 16 Oct 2015 11:38:30 -0000
Received: from Unknown (HELO spamd4-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 16 Oct 2015 11:38:30 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd4-us-west.apache.org (ASF Mail Server at spamd4-us-west.apache.org) with ESMTP id 88C40C0DCD
	for <dev@httpd.apache.org>; Fri, 16 Oct 2015 11:38:29 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd4-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.121
X-Spam-Level:
X-Spam-Status: No, score=-0.121 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RCVD_IN_MSPIKE_H3=-0.01, RCVD_IN_MSPIKE_WL=-0.01, SPF_PASS=-0.001]
	autolearn=disabled
Authentication-Results: spamd4-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-us-west.apache.org ([10.40.0.8])
	by localhost (spamd4-us-west.apache.org [10.40.0.11]) (amavisd-new, port 10024)
	with ESMTP id NOoZNjhIv3n9 for <dev@httpd.apache.org>;
	Fri, 16 Oct 2015 11:38:28 +0000 (UTC)
Received: from mail-qk0-f179.google.com (mail-qk0-f179.google.com [209.85.220.179])
	by mx1-us-west.apache.org (ASF Mail Server at mx1-us-west.apache.org) with ESMTPS id 93F9720758
	for <dev@httpd.apache.org>; Fri, 16 Oct 2015 11:38:28 +0000 (UTC)
Received: by qkht68 with SMTP id t68so52572910qkh.3
        for <dev@httpd.apache.org>; Fri, 16 Oct 2015 04:38:28 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        bh=A6fX4WBITijcGdYDoEx5sq20Bm4y7s/oP+aX7q78zmY=;
        b=B2SPr0FlUrV7aJd2KdYoPcC6S6kh4wJ1WcNTHzihJNBFppU8ctLcwRVmvF+PLj9Mei
         KvE4s6VtvfvAALLRTaawA9b2Ayp/JupB8A85/aazyArnEn0IQw+KO7SBfZe9t/ehm9cz
         wl8Q1NpzQn5qu1HxGGNxPyG4pglx9h4ANZJ2sfYEH1P4t/mIt3CF8LVpV9khQoEaJPuT
         xnRTLJceiyH9e9RqArIZWM3CkqPDgvUR8v9worQVVWVcOwhJstBw7Fwo8LMRfowQMpSu
         RlsNvajl9Bcs+jkI+Iqq4dQ5SiRwi9y2RmX2jK9bMJQSUDa2+wpiDiIIz7mRJZpUY7qk
         TLmQ==
MIME-Version: 1.0
X-Received: by 10.55.15.134 with SMTP id 6mr18115798qkp.38.1444995507867; Fri,
 16 Oct 2015 04:38:27 -0700 (PDT)
Received: by 10.55.156.213 with HTTP; Fri, 16 Oct 2015 04:38:27 -0700 (PDT)
In-Reply-To: <CAKQ1sVNx3g2PjkxG6z2LwqA6CuJeVv2L6SryVsMWp2SydoKFjQ@mail.gmail.com>
References: <CAKQ1sVNx3g2PjkxG6z2LwqA6CuJeVv2L6SryVsMWp2SydoKFjQ@mail.gmail.com>
Date: Fri, 16 Oct 2015 13:38:27 +0200
Message-ID: <CAKQ1sVObJbAiRHdKHpU9veo8UtUqHXJ+L=PbcbWWd4Poo4TmGg@mail.gmail.com>
Subject: Re: H2 compatible ciphers (was: svn commit: r1708593)
From: Yann Ylavic <ylavic.dev@gmail.com>
To: dev@httpd.apache.org
Content-Type: text/plain; charset=UTF-8

On Fri, Oct 16, 2015 at 12:21 PM, Yann Ylavic <ylavic.dev@gmail.com> wrote:
>
> And maybe more importantly, what remains currently?

Actually I tried some brute bash script (attached) to show what
remains compared to "openssl ciphers ALL", and the result is:

* libressl/install/2.2.1/bin/openssl:
- ECDHE-ECDSA-CHACHA20-POLY1305
- ECDHE-RSA-CHACHA20-POLY1305
- DHE-RSA-CHACHA20-POLY1305
- ECDHE-RSA-AES256-GCM-SHA384
- ECDHE-ECDSA-AES256-GCM-SHA384
- DHE-DSS-AES256-GCM-SHA384
- DHE-RSA-AES256-GCM-SHA384
- GOST2012256-GOST89-GOST89
- GOST2001-GOST89-GOST89
- ECDHE-RSA-AES128-GCM-SHA256
- ECDHE-ECDSA-AES128-GCM-SHA256
- DHE-DSS-AES128-GCM-SHA256
- DHE-RSA-AES128-GCM-SHA256
- EDH-RSA-DES-CBC3-SHA
- EDH-DSS-DES-CBC3-SHA
- EDH-RSA-DES-CBC-SHA
- EDH-DSS-DES-CBC-SHA

* openssl/install/1.0.2d/bin/openssl:
- ECDHE-RSA-AES256-GCM-SHA384
- ECDHE-ECDSA-AES256-GCM-SHA384
- DHE-DSS-AES256-GCM-SHA384
- DHE-RSA-AES256-GCM-SHA384
- ECDHE-RSA-AES128-GCM-SHA256
- ECDHE-ECDSA-AES128-GCM-SHA256
- DHE-DSS-AES128-GCM-SHA256
- DHE-RSA-AES128-GCM-SHA256
- EDH-RSA-DES-CBC3-SHA
- EDH-DSS-DES-CBC3-SHA
- EDH-RSA-DES-CBC-SHA
- EDH-DSS-DES-CBC-SHA
- EXP-EDH-RSA-DES-CBC-SHA
- EXP-EDH-DSS-DES-CBC-SHA

Some 'TLSv1.2:!kRSA:!aECDH:!DH' is a bit too restrictive, and their
blacklist a bit broken anymay (I wouldn't recommend the latters :)
I'll try a better one, but it would be nice if the httpwg could
express their blacklist in terms of authentication/key-exchange
methods and block-ciphers/stream-ciphers instead of this "out of the
hat" list.

By the way the SSLCompatibility idea is great, was not my point, but
maybe this can give you some bits for httpwg mailing list...

From dev-return-84306-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Fri Oct 16 11:39:50 2015
Return-Path: <dev-return-84306-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 8F0EE10E3F
	for <apmail-httpd-dev-archive@www.apache.org>; Fri, 16 Oct 2015 11:39:50 +0000 (UTC)
Received: (qmail 39239 invoked by uid 500); 16 Oct 2015 11:39:50 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 39152 invoked by uid 500); 16 Oct 2015 11:39:50 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 39141 invoked by uid 99); 16 Oct 2015 11:39:50 -0000
Received: from Unknown (HELO spamd3-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 16 Oct 2015 11:39:50 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd3-us-west.apache.org (ASF Mail Server at spamd3-us-west.apache.org) with ESMTP id 9A5FB1809AB
	for <dev@httpd.apache.org>; Fri, 16 Oct 2015 11:39:49 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd3-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.102
X-Spam-Level:
X-Spam-Status: No, score=-0.102 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RCVD_IN_MSPIKE_H2=-0.001, SPF_PASS=-0.001] autolearn=disabled
Authentication-Results: spamd3-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd3-us-west.apache.org [10.40.0.10]) (amavisd-new, port 10024)
	with ESMTP id kOhkVTBUK2wx for <dev@httpd.apache.org>;
	Fri, 16 Oct 2015 11:39:38 +0000 (UTC)
Received: from mail-qg0-f50.google.com (mail-qg0-f50.google.com [209.85.192.50])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id F2C6742B59
	for <dev@httpd.apache.org>; Fri, 16 Oct 2015 11:39:37 +0000 (UTC)
Received: by qgad10 with SMTP id d10so3624784qga.3
        for <dev@httpd.apache.org>; Fri, 16 Oct 2015 04:39:31 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        bh=omCTzK5LVZUacrJuCYibYqoXCuCITec+rwUSot/HNQA=;
        b=1ItE6CKXn5BJDYr2xaCNTzYBaPKrbSak7InPE1LpcO17A1cA8nFG2cNTeHee/xp2P6
         wCpbeZtcogiQB3SVrmHAYLjMLbFpty31vHMulc3ukHq/mRBjc6LjfF1O6r/xEnpfykp6
         jQ256ARYGugxT0qQe9fGiaeNkgqPjXEdfrU6HcGpqFV9WnmX3prcHlmoNNAmiBKeUTYa
         G+T0ylhKVqmmmrJRziHj7qDf8Ykf0m9Or5rXRxb7/u5VxSsALSDIdG1vBMsymEHe2pwY
         hJl1M653swyQGVgvzHHXQhDNHJIvNQa+599Z/a3WOsWsaFyrZLUzVNyJ0b+0TcDRAdSL
         K3fw==
MIME-Version: 1.0
X-Received: by 10.140.96.71 with SMTP id j65mr18124844qge.92.1444995571367;
 Fri, 16 Oct 2015 04:39:31 -0700 (PDT)
Received: by 10.55.156.213 with HTTP; Fri, 16 Oct 2015 04:39:31 -0700 (PDT)
In-Reply-To: <CAKQ1sVObJbAiRHdKHpU9veo8UtUqHXJ+L=PbcbWWd4Poo4TmGg@mail.gmail.com>
References: <CAKQ1sVNx3g2PjkxG6z2LwqA6CuJeVv2L6SryVsMWp2SydoKFjQ@mail.gmail.com>
	<CAKQ1sVObJbAiRHdKHpU9veo8UtUqHXJ+L=PbcbWWd4Poo4TmGg@mail.gmail.com>
Date: Fri, 16 Oct 2015 13:39:31 +0200
Message-ID: <CAKQ1sVORE_ZoGtSyYYzZ88OkbR0vLGQtnuskH6fcSXbSG5-YsQ@mail.gmail.com>
Subject: Re: H2 compatible ciphers (was: svn commit: r1708593)
From: Yann Ylavic <ylavic.dev@gmail.com>
To: dev@httpd.apache.org
Content-Type: multipart/mixed; boundary=001a113a9aa4bc9a070522373fe8

--001a113a9aa4bc9a070522373fe8
Content-Type: text/plain; charset=UTF-8

On Fri, Oct 16, 2015 at 1:38 PM, Yann Ylavic <ylavic.dev@gmail.com> wrote:
>
> Actually I tried some brute bash script (attached)

Really attached now...

--001a113a9aa4bc9a070522373fe8
Content-Type: application/x-sh; name="http2_vs_openssl.sh"
Content-Disposition: attachment; filename="http2_vs_openssl.sh"
Content-Transfer-Encoding: base64
X-Attachment-Id: f_iftl1vh90

Y2lwaGVycz0nCk5VTEwtTUQ1Ck5VTEwtU0hBCk5VTEwtU0hBMjU2ClBTSy1OVUxMLVNIQQpESEUt
UFNLLU5VTEwtU0hBClJTQS1QU0stTlVMTC1TSEEKUFNLLU5VTEwtU0hBMjU2ClBTSy1OVUxMLVNI
QTM4NApESEUtUFNLLU5VTEwtU0hBMjU2CkRIRS1QU0stTlVMTC1TSEEzODQKUlNBLVBTSy1OVUxM
LVNIQTI1NgpSU0EtUFNLLU5VTEwtU0hBMzg0CkVDREgtRUNEU0EtTlVMTC1TSEEKRUNESEUtRUNE
U0EtTlVMTC1TSEEKRUNESC1SU0EtTlVMTC1TSEEKRUNESEUtUlNBLU5VTEwtU0hBCkFFQ0RILU5V
TEwtU0hBCkVDREhFLVBTSy1OVUxMLVNIQQpFQ0RIRS1QU0stTlVMTC1TSEEyNTYKRUNESEUtUFNL
LU5VTEwtU0hBMzg0ClBTSy0zREVTLUVERS1DQkMtU0hBCkRIRS1QU0stM0RFUy1FREUtQ0JDLVNI
QQpSU0EtUFNLLTNERVMtRURFLUNCQy1TSEEKRUNESC1FQ0RTQS1ERVMtQ0JDMy1TSEEKRUNESEUt
RUNEU0EtREVTLUNCQzMtU0hBCkVDREgtUlNBLURFUy1DQkMzLVNIQQpFQ0RIRS1SU0EtREVTLUNC
QzMtU0hBCkFFQ0RILURFUy1DQkMzLVNIQQpTUlAtM0RFUy1FREUtQ0JDLVNIQQpTUlAtUlNBLTNE
RVMtRURFLUNCQy1TSEEKU1JQLURTUy0zREVTLUVERS1DQkMtU0hBCkVDREhFLVBTSy0zREVTLUVE
RS1DQkMtU0hBCkRFUy1DQkMtU0hBCkRFUy1DQkMzLVNIQQpESEUtRFNTLURFUy1DQkMzLVNIQQpE
SEUtUlNBLURFUy1DQkMtU0hBCkRIRS1SU0EtREVTLUNCQzMtU0hBCkFESC1ERVMtQ0JDLVNIQQpB
REgtREVTLUNCQzMtU0hBCkVYUC1ESC1EU1MtREVTLUNCQy1TSEEKREgtRFNTLURFUy1DQkMtU0hB
CkRILURTUy1ERVMtQ0JDMy1TSEEKRVhQLURILVJTQS1ERVMtQ0JDLVNIQQpESC1SU0EtREVTLUNC
Qy1TSEEKREgtUlNBLURFUy1DQkMzLVNIQQpFWFAtUkM0LU1ENQpFWFAtUkMyLUNCQy1NRDUKRVhQ
LURFUy1DQkMtU0hBCkVYUC1ESEUtRFNTLURFUy1DQkMtU0hBCkVYUC1ESEUtUlNBLURFUy1DQkMt
U0hBCkVYUC1BREgtREVTLUNCQy1TSEEKRVhQLUFESC1SQzQtTUQ1ClJDNC1NRDUKUkM0LVNIQQpB
REgtUkM0LU1ENQpLUkI1LVJDNC1TSEEKS1JCNS1SQzQtTUQ1CkVYUC1LUkI1LVJDNC1TSEEKRVhQ
LUtSQjUtUkM0LU1ENQpQU0stUkM0LVNIQQpESEUtUFNLLVJDNC1TSEEKUlNBLVBTSy1SQzQtU0hB
CkVDREgtRUNEU0EtUkM0LVNIQQpFQ0RIRS1FQ0RTQS1SQzQtU0hBCkVDREgtUlNBLVJDNC1TSEEK
RUNESEUtUlNBLVJDNC1TSEEKQUVDREgtUkM0LVNIQQpFQ0RIRS1QU0stUkM0LVNIQQpBRVMxMjgt
U0hBMjU2CkRILURTUy1BRVMxMjgtU0hBCkRILVJTQS1BRVMxMjgtU0hBCkRIRS1EU1MtQUVTMTI4
LVNIQQpESEUtUlNBLUFFUzEyOC1TSEEKQURILUFFUzEyOC1TSEEKQUVTMTI4LVNIQTI1NgpESC1E
U1MtQUVTMTI4LVNIQTI1NgpESC1SU0EtQUVTMTI4LVNIQTI1NgpESEUtRFNTLUFFUzEyOC1TSEEy
NTYKREhFLVJTQS1BRVMxMjgtU0hBMjU2CkVDREgtRUNEU0EtQUVTMTI4LVNIQQpFQ0RIRS1FQ0RT
QS1BRVMxMjgtU0hBCkVDREgtUlNBLUFFUzEyOC1TSEEKRUNESEUtUlNBLUFFUzEyOC1TSEEKQUVD
REgtQUVTMTI4LVNIQQpFQ0RIRS1FQ0RTQS1BRVMxMjgtU0hBMjU2CkVDREgtRUNEU0EtQUVTMTI4
LVNIQTI1NgpFQ0RIRS1SU0EtQUVTMTI4LVNIQTI1NgpFQ0RILVJTQS1BRVMxMjgtU0hBMjU2CkFE
SC1BRVMxMjgtU0hBMjU2ClBTSy1BRVMxMjgtQ0JDLVNIQQpESEUtUFNLLUFFUzEyOC1DQkMtU0hB
ClJTQS1QU0stQUVTMTI4LUNCQy1TSEEKUFNLLUFFUzEyOC1DQkMtU0hBMjU2CkRIRS1QU0stQUVT
MTI4LUNCQy1TSEEyNTYKUlNBLVBTSy1BRVMxMjgtQ0JDLVNIQTI1NgpFQ0RIRS1QU0stQUVTMTI4
LUNCQy1TSEEKRUNESEUtUFNLLUFFUzEyOC1DQkMtU0hBMjU2CkFFUzEyOC1DQ00KQUVTMTI4LUND
TTgKUFNLLUFFUzEyOC1DQ00KUFNLLUFFUzEyOC1DQ004CkFFUzEyOC1HQ00tU0hBMjU2CkRILVJT
QS1BRVMxMjgtR0NNLVNIQTI1NgpESC1EU1MtQUVTMTI4LUdDTS1TSEEyNTYKQURILUFFUzEyOC1H
Q00tU0hBMjU2ClBTSy1BRVMxMjgtR0NNLVNIQTI1NgpSU0EtUFNLLUFFUzEyOC1HQ00tU0hBMjU2
CkVDREgtRUNEU0EtQUVTMTI4LUdDTS1TSEEyNTYKRUNESC1SU0EtQUVTMTI4LUdDTS1TSEEyNTYK
U1JQLUFFUy0xMjgtQ0JDLVNIQQpTUlAtUlNBLUFFUy0xMjgtQ0JDLVNIQQpTUlAtRFNTLUFFUy0x
MjgtQ0JDLVNIQQpBRVMyNTYtU0hBCkRILURTUy1BRVMyNTYtU0hBCkRILVJTQS1BRVMyNTYtU0hB
CkRIRS1EU1MtQUVTMjU2LVNIQQpESEUtUlNBLUFFUzI1Ni1TSEEKQURILUFFUzI1Ni1TSEEKQUVT
MjU2LVNIQTI1NgpESC1EU1MtQUVTMjU2LVNIQTI1NgpESC1SU0EtQUVTMjU2LVNIQTI1NgpESEUt
RFNTLUFFUzI1Ni1TSEEyNTYKREhFLVJTQS1BRVMyNTYtU0hBMjU2CkFESC1BRVMyNTYtU0hBMjU2
CkVDREgtRUNEU0EtQUVTMjU2LVNIQQpFQ0RIRS1FQ0RTQS1BRVMyNTYtU0hBCkVDREgtUlNBLUFF
UzI1Ni1TSEEKRUNESEUtUlNBLUFFUzI1Ni1TSEEKQUVDREgtQUVTMjU2LVNIQQpFQ0RIRS1FQ0RT
QS1BRVMyNTYtU0hBMzg0CkVDREgtRUNEU0EtQUVTMjU2LVNIQTM4NApFQ0RIRS1SU0EtQUVTMjU2
LVNIQTM4NApFQ0RILVJTQS1BRVMyNTYtU0hBMzg0ClBTSy1BRVMyNTYtQ0JDLVNIQQpESEUtUFNL
LUFFUzI1Ni1DQkMtU0hBClJTQS1QU0stQUVTMjU2LUNCQy1TSEEKUFNLLUFFUzI1Ni1DQkMtU0hB
Mzg0CkRIRS1QU0stQUVTMjU2LUNCQy1TSEEzODQKUlNBLVBTSy1BRVMyNTYtQ0JDLVNIQTM4NApF
Q0RIRS1QU0stQUVTMjU2LUNCQy1TSEEKRUNESEUtUFNLLUFFUzI1Ni1DQkMtU0hBMzg0ClNSUC1B
RVMtMjU2LUNCQy1TSEEKU1JQLVJTQS1BRVMtMjU2LUNCQy1TSEEKU1JQLURTUy1BRVMtMjU2LUNC
Qy1TSEEKQUVTMjU2LUNDTQpBRVMyNTYtQ0NNOApQU0stQUVTMjU2LUNDTQpQU0stQUVTMjU2LUND
TTgKQUVTMjU2LUdDTS1TSEEzODQKREgtUlNBLUFFUzI1Ni1HQ00tU0hBMzg0CkRILURTUy1BRVMy
NTYtR0NNLVNIQTM4NApBREgtQUVTMjU2LUdDTS1TSEEzODQKUFNLLUFFUzI1Ni1HQ00tU0hBMzg0
ClJTQS1QU0stQUVTMjU2LUdDTS1TSEEzODQKRUNESC1FQ0RTQS1BRVMyNTYtR0NNLVNIQTM4NApF
Q0RILVJTQS1BRVMyNTYtR0NNLVNIQTM4NApDQU1FTExJQTEyOC1TSEEKREgtRFNTLUNBTUVMTElB
MTI4LVNIQQpESC1SU0EtQ0FNRUxMSUExMjgtU0hBCkRIRS1EU1MtQ0FNRUxMSUExMjgtU0hBCkRI
RS1SU0EtQ0FNRUxMSUExMjgtU0hBCkFESC1DQU1FTExJQTEyOC1TSEEKRUNESEUtRUNEU0EtQ0FN
RUxMSUExMjgtU0hBMjU2CkVDREgtRUNEU0EtQ0FNRUxMSUExMjgtU0hBMjU2CkVDREhFLVJTQS1D
QU1FTExJQTEyOC1TSEEyNTYKRUNESC1SU0EtQ0FNRUxMSUExMjgtU0hBMjU2ClBTSy1DQU1FTExJ
QTEyOC1TSEEyNTYKREhFLVBTSy1DQU1FTExJQTEyOC1TSEEyNTYKUlNBLVBTSy1DQU1FTExJQTEy
OC1TSEEyNTYKRUNESEUtUFNLLUNBTUVMTElBMTI4LVNIQTI1NgpDQU1FTExJQTEyOC1HQ00tU0hB
MjU2CkRILVJTQS1DQU1FTExJQTEyOC1HQ00tU0hBMjU2CkRILURTUy1DQU1FTExJQTEyOC1HQ00t
U0hBMjU2CkFESC1DQU1FTExJQTEyOC1HQ00tU0hBMjU2CkVDREgtRUNEU0EtQ0FNRUxMSUExMjgt
R0NNLVNIQTI1NgpFQ0RILVJTQS1DQU1FTExJQTEyOC1HQ00tU0hBMjU2ClBTSy1DQU1FTExJQTEy
OC1HQ00tU0hBMjU2ClJTQS1QU0stQ0FNRUxMSUExMjgtR0NNLVNIQTI1NgpDQU1FTExJQTEyOC1T
SEEyNTYKREgtRFNTLUNBTUVMTElBMTI4LVNIQTI1NgpESC1SU0EtQ0FNRUxMSUExMjgtU0hBMjU2
CkRIRS1EU1MtQ0FNRUxMSUExMjgtU0hBMjU2CkRIRS1SU0EtQ0FNRUxMSUExMjgtU0hBMjU2CkFE
SC1DQU1FTExJQTEyOC1TSEEyNTYKQ0FNRUxMSUEyNTYtU0hBCkRILVJTQS1DQU1FTExJQTI1Ni1T
SEEKREgtRFNTLUNBTUVMTElBMjU2LVNIQQpESEUtRFNTLUNBTUVMTElBMjU2LVNIQQpESEUtUlNB
LUNBTUVMTElBMjU2LVNIQQpBREgtQ0FNRUxMSUEyNTYtU0hBCkVDREhFLUVDRFNBLUNBTUVMTElB
MjU2LVNIQTM4NApFQ0RILUVDRFNBLUNBTUVMTElBMjU2LVNIQTM4NApFQ0RIRS1SU0EtQ0FNRUxM
SUEyNTYtU0hBMzg0CkVDREgtUlNBLUNBTUVMTElBMjU2LVNIQTM4NApQU0stQ0FNRUxMSUEyNTYt
U0hBMzg0CkRIRS1QU0stQ0FNRUxMSUEyNTYtU0hBMzg0ClJTQS1QU0stQ0FNRUxMSUEyNTYtU0hB
Mzg0CkVDREhFLVBTSy1DQU1FTExJQTI1Ni1TSEEzODQKQ0FNRUxMSUEyNTYtU0hBMjU2CkRILURT
Uy1DQU1FTExJQTI1Ni1TSEEyNTYKREgtUlNBLUNBTUVMTElBMjU2LVNIQTI1NgpESEUtRFNTLUNB
TUVMTElBMjU2LVNIQTI1NgpESEUtUlNBLUNBTUVMTElBMjU2LVNIQTI1NgpBREgtQ0FNRUxMSUEy
NTYtU0hBMjU2CkNBTUVMTElBMjU2LUdDTS1TSEEzODQKREgtUlNBLUNBTUVMTElBMjU2LUdDTS1T
SEEzODQKREgtRFNTLUNBTUVMTElBMjU2LUdDTS1TSEEzODQKQURILUNBTUVMTElBMjU2LUdDTS1T
SEEzODQKRUNESC1FQ0RTQS1DQU1FTExJQTI1Ni1HQ00tU0hBMzg0CkVDREgtUlNBLUNBTUVMTElB
MjU2LUdDTS1TSEEzODQKUFNLLUNBTUVMTElBMjU2LUdDTS1TSEEzODQKUlNBLVBTSy1DQU1FTExJ
QTI1Ni1HQ00tU0hBMzg0CkFSSUExMjgtU0hBMjU2CkFSSUEyNTYtU0hBMzg0CkRILURTUy1BUklB
MTI4LVNIQTI1NgpESC1EU1MtQVJJQTI1Ni1TSEEzODQKREgtUlNBLUFSSUExMjgtU0hBMjU2CkRI
LVJTQS1BUklBMjU2LVNIQTM4NApESEUtRFNTLUFSSUExMjgtU0hBMjU2CkRIRS1EU1MtQVJJQTI1
Ni1TSEEzODQKREhFLVJTQS1BUklBMTI4LVNIQTI1NgpESEUtUlNBLUFSSUEyNTYtU0hBMzg0CkFE
SC1BUklBMTI4LVNIQTI1NgpBREgtQVJJQTI1Ni1TSEEzODQKRUNESEUtRUNEU0EtQVJJQTEyOC1T
SEEyNTYKRUNESEUtRUNEU0EtQVJJQTI1Ni1TSEEzODQKRUNESC1FQ0RTQS1BUklBMTI4LVNIQTI1
NgpFQ0RILUVDRFNBLUFSSUEyNTYtU0hBMzg0CkVDREhFLVJTQS1BUklBMTI4LVNIQTI1NgpFQ0RI
RS1SU0EtQVJJQTI1Ni1TSEEzODQKRUNESC1SU0EtQVJJQTEyOC1TSEEyNTYKRUNESC1SU0EtQVJJ
QTI1Ni1TSEEzODQKQVJJQTEyOC1HQ00tU0hBMjU2CkFSSUEyNTYtR0NNLVNIQTM4NApESC1EU1Mt
QVJJQTEyOC1HQ00tU0hBMjU2CkRILURTUy1BUklBMjU2LUdDTS1TSEEzODQKREgtUlNBLUFSSUEx
MjgtR0NNLVNIQTI1NgpESC1SU0EtQVJJQTI1Ni1HQ00tU0hBMzg0CkFESC1BUklBMTI4LUdDTS1T
SEEyNTYKQURILUFSSUEyNTYtR0NNLVNIQTM4NApFQ0RILUVDRFNBLUFSSUExMjgtR0NNLVNIQTI1
NgpFQ0RILUVDRFNBLUFSSUEyNTYtR0NNLVNIQTM4NApFQ0RILVJTQS1BUklBMTI4LUdDTS1TSEEy
NTYKRUNESC1SU0EtQVJJQTI1Ni1HQ00tU0hBMzg0ClBTSy1BUklBMTI4LVNIQTI1NgpQU0stQVJJ
QTI1Ni1TSEEzODQKREhFLVBTSy1BUklBMTI4LVNIQTI1NgpESEUtUFNLLUFSSUEyNTYtU0hBMzg0
ClJTQS1QU0stQVJJQTEyOC1TSEEyNTYKUlNBLVBTSy1BUklBMjU2LVNIQTM4NApBUklBMTI4LUdD
TS1TSEEyNTYKQVJJQTI1Ni1HQ00tU0hBMzg0ClJTQS1QU0stQVJJQTEyOC1HQ00tU0hBMjU2ClJT
QS1QU0stQVJJQTI1Ni1HQ00tU0hBMzg0CkVDREhFLVBTSy1BUklBMTI4LVNIQTI1NgpFQ0RIRS1Q
U0stQVJJQTI1Ni1TSEEzODQKU0VFRC1TSEEKREgtRFNTLVNFRUQtU0hBCkRILVJTQS1TRUVELVNI
QQpESEUtRFNTLVNFRUQtU0hBCkRIRS1SU0EtU0VFRC1TSEEKQURILVNFRUQtU0hBCktSQjUtREVT
LUNCQy1TSEEKS1JCNS1ERVMtQ0JDMy1TSEEKS1JCNS1JREVBLUNCQy1TSEEKS1JCNS1ERVMtQ0JD
LU1ENQpLUkI1LURFUy1DQkMzLU1ENQpLUkI1LUlERUEtQ0JDLU1ENQpFWFAtS1JCNS1ERVMtQ0JD
LVNIQQpFWFAtS1JCNS1ERVMtQ0JDLU1ENQpFWFAtS1JCNS1SQzItQ0JDLVNIQQpFWFAtS1JCNS1S
QzItQ0JDLU1ENQpESEUtRFNTLUNCQy1TSEEKSURFQS1DQkMtU0hBClNTTDNfQ0tfU0NTVgpTU0wz
X0NLX0ZBTExCQUNLX1NDU1YKJwoKZm9yIG9wZW5zc2wgaW4gJEA7IGRvCiAgICBlY2hvCiAgICBl
Y2hvICIqICRvcGVuc3NsOiIKICAgIGZvciBjaXBoZXIgaW4gYCRvcGVuc3NsIGNpcGhlcnMgLXYg
J0FMTCcgfGF3ayAne3ByaW50ICQxfSdgOyBkbwogICAgICAgIGVjaG8gJGNpcGhlcnMgfCBncmVw
IC1xICIkY2lwaGVyIiB8fCB7CiAgICAgICAgICAgIGVjaG8gIi0gJGNpcGhlciIKICAgICAgICB9
CiAgICBkb25lCmRvbmUK
--001a113a9aa4bc9a070522373fe8--

From dev-return-84307-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Fri Oct 16 11:51:39 2015
Return-Path: <dev-return-84307-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 230EC10E8A
	for <apmail-httpd-dev-archive@www.apache.org>; Fri, 16 Oct 2015 11:51:39 +0000 (UTC)
Received: (qmail 63886 invoked by uid 500); 16 Oct 2015 11:51:38 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 63819 invoked by uid 500); 16 Oct 2015 11:51:38 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 63809 invoked by uid 99); 16 Oct 2015 11:51:38 -0000
Received: from Unknown (HELO spamd1-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 16 Oct 2015 11:51:38 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd1-us-west.apache.org (ASF Mail Server at spamd1-us-west.apache.org) with ESMTP id F2400C4FE3
	for <dev@httpd.apache.org>; Fri, 16 Oct 2015 11:51:37 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd1-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.009
X-Spam-Level:
X-Spam-Status: No, score=-0.009 tagged_above=-999 required=6.31
	tests=[T_RP_MATCHES_RCVD=-0.01, URIBL_BLOCKED=0.001]
	autolearn=disabled
Received: from mx1-us-west.apache.org ([10.40.0.8])
	by localhost (spamd1-us-west.apache.org [10.40.0.7]) (amavisd-new, port 10024)
	with ESMTP id 9CKFUdnzvpyO for <dev@httpd.apache.org>;
	Fri, 16 Oct 2015 11:51:23 +0000 (UTC)
Received: from mail.greenbytes.de (mail.greenbytes.de [217.91.35.233])
	by mx1-us-west.apache.org (ASF Mail Server at mx1-us-west.apache.org) with ESMTPS id 3689D23031
	for <dev@httpd.apache.org>; Fri, 16 Oct 2015 11:51:23 +0000 (UTC)
Received: from [192.168.1.48] (unknown [87.78.174.25])
	(using TLSv1 with cipher ECDHE-RSA-AES256-SHA (256/256 bits))
	(Client did not present a certificate)
	by mail.greenbytes.de (Postfix) with ESMTPSA id 8D59D15A0486
	for <dev@httpd.apache.org>; Fri, 16 Oct 2015 13:51:21 +0200 (CEST)
Content-Type: text/plain; charset=utf-8
Mime-Version: 1.0 (Mac OS X Mail 9.0 \(3094\))
Subject: Re: H2 compatible ciphers (was: svn commit: r1708593)
From: Stefan Eissing <stefan.eissing@greenbytes.de>
In-Reply-To: <AFF097DC-8F37-4608-9D76-A397DAB7D79E@sharp.fm>
Date: Fri, 16 Oct 2015 13:51:20 +0200
Content-Transfer-Encoding: quoted-printable
Message-Id: <00D6D3A8-2F1F-48BF-B49F-E27C32B228FE@greenbytes.de>
References: <CAKQ1sVNx3g2PjkxG6z2LwqA6CuJeVv2L6SryVsMWp2SydoKFjQ@mail.gmail.com> <7785D0B9-E1C7-483E-B468-CBDFA99156BB@greenbytes.de> <CAOhm=5qz=bZOfBa9dCkyWZhVZGzRtX_0pzM0HmwYTOFzTxP1Uw@mail.gmail.com> <3C3CEF7B-8FDC-4F0A-B830-8E336C1D9D76@greenbytes.de> <AFF097DC-8F37-4608-9D76-A397DAB7D79E@sharp.fm>
To: dev@httpd.apache.org
X-Mailer: Apple Mail (2.3094)

Yes, I proposed something along those lines at the http workshop this =
summer. Needs some more pushing, it seems.

There is one thing that I understood to be implied by all this: that h2 =
is not negotiated when the security is too weak. Which, the more I think =
and implemented about it, does not make sense. But I asked for input =
from the wg, see what they say...

Back to our little world:

I find the definitions on the mozilla wiki helpful. They might not be =
perfect (yet), but it is better to start defining security parameter =
sets than staring at SSL configuration strings and figuring out if they =
all together do what you want.

As we have seen, security is highly in flux, thanks to some smart guys =
with unlimited funding, and placing recommended mod_ssl configurations =
on a web site will do nothing for the millions of servers out there.

I think can do better and offer a config file to users of httpd that =
defines security policies and
- gets updated every release
- is downloadable by itself, copy it into your installation and reload

So, admins would add
 =20
  SecurityPolicy modern

to their config files and every httpd update would bring that to the =
lastest and greatest specification.

Of course, there is potential for breakage here. But maybe one prefers =
that to being insecure with not updated clients...

//Stefan

> Am 16.10.2015 um 13:36 schrieb Graham Leggett <minfrin@sharp.fm>:
>=20
> On 16 Oct 2015, at 12:56 PM, Stefan Eissing =
<stefan.eissing@greenbytes.de> wrote:
>=20
>> I am not blacklisting ciphers for the whole server. I try to define
>> the security settings required for HTTP/2 as defined in the standard =
-
>> as a configurable directive.
>>=20
>> There is no problem with denying HTTP/2 support for an IE8.
>=20
> I am wondering whether the cipher blacklist shouldn=E2=80=99t be a =
configurable list with a default set of RFC compliant values in the =
default config file, perhaps with shortcuts like naming a blacklist =
after an RFC.
>=20
> Fitting this in with the existing infrastructure this could be as =
simple as extending the SSLCipherSuite directive to support this:
>=20
> SSLCipherSuite -RFC7540
>=20
> Maybe this is actually an openssl problem rather than an httpd =
problem, it could be that openssl needs to be taught how to blacklist =
RFC7540 as a group.
>=20
> Regards,
> Graham
> =E2=80=94
>=20


From dev-return-84308-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Fri Oct 16 11:54:20 2015
Return-Path: <dev-return-84308-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 4A3B810EA3
	for <apmail-httpd-dev-archive@www.apache.org>; Fri, 16 Oct 2015 11:54:20 +0000 (UTC)
Received: (qmail 70406 invoked by uid 500); 16 Oct 2015 11:54:19 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 70307 invoked by uid 500); 16 Oct 2015 11:54:19 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 70297 invoked by uid 99); 16 Oct 2015 11:54:19 -0000
Received: from Unknown (HELO spamd1-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 16 Oct 2015 11:54:19 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd1-us-west.apache.org (ASF Mail Server at spamd1-us-west.apache.org) with ESMTP id 5F9FFC50A1
	for <dev@httpd.apache.org>; Fri, 16 Oct 2015 11:54:19 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd1-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.102
X-Spam-Level:
X-Spam-Status: No, score=-0.102 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RCVD_IN_MSPIKE_H2=-0.001, SPF_PASS=-0.001] autolearn=disabled
Authentication-Results: spamd1-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd1-us-west.apache.org [10.40.0.7]) (amavisd-new, port 10024)
	with ESMTP id a2XaOuXuSw0R for <dev@httpd.apache.org>;
	Fri, 16 Oct 2015 11:54:18 +0000 (UTC)
Received: from mail-qg0-f42.google.com (mail-qg0-f42.google.com [209.85.192.42])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id ADE3542BA7
	for <dev@httpd.apache.org>; Fri, 16 Oct 2015 11:54:18 +0000 (UTC)
Received: by qgez77 with SMTP id z77so96960365qge.1
        for <dev@httpd.apache.org>; Fri, 16 Oct 2015 04:54:12 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        bh=GyayJOpgEqwT2LYj37kJiSyFkbqY1v61ssASrZaEMug=;
        b=xYcl9PPXwNzhzqhub7pK+r79Zr2+FnyORpjgOMRrfLZybgLt7kojlcxX/ozG9QFJdk
         Ar7b7fgQxbI3U6CZ0vfQErs8quYN00SBslKkB0xiA5HYI0tQhghjKBP9wQnyPc2HPMTO
         6jAIQApiLEFU7uJopvx7DGXF3Li+fY9I7cMwoL3rccfDGNyxWUJB5R58/3XeFCVuPiFm
         8WEvjxXypXGPcCE4nvSdjBPw+2NLGXuYUHwJ9ZVN8OWQXmsEI6zpR8xlNxTHXKn/ZawB
         YoN1FOBYv7astnhG4jzVoopO7jLEleCzoCo689oeebz1CwVjDNxZ4/5U0PxOec1aYmel
         5IbQ==
MIME-Version: 1.0
X-Received: by 10.140.131.198 with SMTP id 189mr19545984qhd.83.1444996452135;
 Fri, 16 Oct 2015 04:54:12 -0700 (PDT)
Received: by 10.55.156.213 with HTTP; Fri, 16 Oct 2015 04:54:12 -0700 (PDT)
In-Reply-To: <CAKQ1sVP6HPyQj4Tq-47DQ27tbCTRk+005UoAnxmgL7xdWW6+_A@mail.gmail.com>
References: <CALK=YjMWSTLMzr=5nKws8M8=CkrhqQJ8S1xCgyQycms-V1pNDQ@mail.gmail.com>
	<CAKQ1sVP6HPyQj4Tq-47DQ27tbCTRk+005UoAnxmgL7xdWW6+_A@mail.gmail.com>
Date: Fri, 16 Oct 2015 13:54:12 +0200
Message-ID: <CAKQ1sVO5=kaZitCpQ0Vuqx8E+nj69cv5+pEuzDo1_jhMZRB4Cg@mail.gmail.com>
Subject: Re: 2.4.17 alignment issue sparc/ia64
From: Yann Ylavic <ylavic.dev@gmail.com>
To: dev@httpd.apache.org
Content-Type: text/plain; charset=UTF-8

On Fri, Oct 16, 2015 at 10:02 AM, Yann Ylavic <ylavic.dev@gmail.com> wrote:
>
> We should do something like the following patch:
>
> Index: server/scoreboard.c
> ===================================================================
> --- server/scoreboard.c    (revision 1708095)
> +++ server/scoreboard.c    (working copy)
> @@ -129,14 +129,19 @@ static apr_status_t ap_cleanup_shared_mem(void *d)
>      return APR_SUCCESS;
>  }
>
> +#define SIZE_OF_scoreboard    APR_ALIGN_DEFAULT(sizeof(scoreboard))
> +#define SIZE_OF_global_score  APR_ALIGN_DEFAULT(sizeof(global_score))
> +#define SIZE_OF_process_score APR_ALIGN_DEFAULT(sizeof(process_score))
> +#define SIZE_OF_worker_score  APR_ALIGN_DEFAULT(sizeof(worker_score))

Maybe the following would be more correct:

+#define SCOREBOARD_ALIGN(size) APR_ALIGN((size),sizeof(void *))
+#define SIZE_OF_scoreboard     SCOREBOARD_ALIGN(sizeof(scoreboard))
+#define SIZE_OF_global_score   SCOREBOARD_ALIGN(sizeof(global_score))
+#define SIZE_OF_process_score  SCOREBOARD_ALIGN(sizeof(process_score))
+#define SIZE_OF_worker_score   SCOREBOARD_ALIGN(sizeof(worker_score))

since APR_ALIGN_DEFAULT seems to align to 8 bytes whatever the
platform requires...

Maybe some APR_ALIGN_NATIVE macro is missing in APR, like:
#define APR_ALIGN_NATIVE(size) APR_ALIGN((size), APR_SIZEOF_VOIDP)
but that's another story :)

From dev-return-84309-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Fri Oct 16 11:58:21 2015
Return-Path: <dev-return-84309-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 1A49A10ED2
	for <apmail-httpd-dev-archive@www.apache.org>; Fri, 16 Oct 2015 11:58:21 +0000 (UTC)
Received: (qmail 78495 invoked by uid 500); 16 Oct 2015 11:58:20 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 78431 invoked by uid 500); 16 Oct 2015 11:58:20 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 78421 invoked by uid 99); 16 Oct 2015 11:58:20 -0000
Received: from Unknown (HELO spamd2-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 16 Oct 2015 11:58:20 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd2-us-west.apache.org (ASF Mail Server at spamd2-us-west.apache.org) with ESMTP id 3034D1A2B84
	for <dev@httpd.apache.org>; Fri, 16 Oct 2015 11:58:20 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd2-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.032
X-Spam-Level:
X-Spam-Status: No, score=-0.032 tagged_above=-999 required=6.31
	tests=[RCVD_IN_MSPIKE_H3=-0.01, RCVD_IN_MSPIKE_WL=-0.01,
	SPF_HELO_PASS=-0.001, SPF_PASS=-0.001, T_RP_MATCHES_RCVD=-0.01]
	autolearn=disabled
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd2-us-west.apache.org [10.40.0.9]) (amavisd-new, port 10024)
	with ESMTP id dyYFQ2aJjwa5 for <dev@httpd.apache.org>;
	Fri, 16 Oct 2015 11:58:19 +0000 (UTC)
Received: from mx1.redhat.com (mx1.redhat.com [209.132.183.28])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id 613A442B59
	for <dev@httpd.apache.org>; Fri, 16 Oct 2015 11:58:19 +0000 (UTC)
Received: from int-mx09.intmail.prod.int.phx2.redhat.com (int-mx09.intmail.prod.int.phx2.redhat.com [10.5.11.22])
	by mx1.redhat.com (Postfix) with ESMTPS id 978F8C0BFD38
	for <dev@httpd.apache.org>; Fri, 16 Oct 2015 11:58:18 +0000 (UTC)
Received: from dhcp-24-191.brq.redhat.com (vpn1-7-204.ams2.redhat.com [10.36.7.204])
	by int-mx09.intmail.prod.int.phx2.redhat.com (8.14.4/8.14.4) with ESMTP id t9GBwHG1014381
	for <dev@httpd.apache.org>; Fri, 16 Oct 2015 07:58:18 -0400
To: dev@httpd.apache.org
From: =?UTF-8?Q?Jan_Kalu=c5=bea?= <jkaluza@redhat.com>
Subject: "httpd -X" segfaults with 2.4.17
Message-ID: <5620E659.9070309@redhat.com>
Date: Fri, 16 Oct 2015 13:58:17 +0200
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:38.0) Gecko/20100101
 Thunderbird/38.1.0
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8; format=flowed
Content-Transfer-Encoding: 7bit
X-Scanned-By: MIMEDefang 2.68 on 10.5.11.22

Hi,

httpd 2.4.17 segfaults when used with prefork MPM (and probably also 
with other MPMs) and -X option since r1705492.

The crash happens in the following call in prefork.c (and probably also 
worker.c and so on):

     ap_mpm_pod_check(my_bucket->pod)

pod is NULL and later dereferenced.

The pod is NULL because of the following:

         if (!one_process && /* no POD in one_process mode */
                 (rv = ap_mpm_pod_open(pconf, &all_buckets[i].pod))) {

Since the previous code opened pod every time, I (right now) have no 
idea how it is supposed to work after that patch, so while I'm going to 
look deeper at it, I'm sending this email to the list in case other 
people would have better idea how it is supposed to work after the 
SO_REUSEPORT change.

Regards,
Jan Kaluza

From dev-return-84310-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Fri Oct 16 12:06:55 2015
Return-Path: <dev-return-84310-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 48DF710F2D
	for <apmail-httpd-dev-archive@www.apache.org>; Fri, 16 Oct 2015 12:06:55 +0000 (UTC)
Received: (qmail 99660 invoked by uid 500); 16 Oct 2015 12:06:51 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 99583 invoked by uid 500); 16 Oct 2015 12:06:51 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 99573 invoked by uid 99); 16 Oct 2015 12:06:51 -0000
Received: from Unknown (HELO spamd3-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 16 Oct 2015 12:06:51 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd3-us-west.apache.org (ASF Mail Server at spamd3-us-west.apache.org) with ESMTP id 64C3E1809BA
	for <dev@httpd.apache.org>; Fri, 16 Oct 2015 12:06:51 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd3-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.102
X-Spam-Level:
X-Spam-Status: No, score=-0.102 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RCVD_IN_MSPIKE_H2=-0.001, SPF_PASS=-0.001] autolearn=disabled
Authentication-Results: spamd3-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd3-us-west.apache.org [10.40.0.10]) (amavisd-new, port 10024)
	with ESMTP id GvWhe5Tak0eS for <dev@httpd.apache.org>;
	Fri, 16 Oct 2015 12:06:50 +0000 (UTC)
Received: from mail-qk0-f171.google.com (mail-qk0-f171.google.com [209.85.220.171])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id 157EA2315C
	for <dev@httpd.apache.org>; Fri, 16 Oct 2015 12:06:50 +0000 (UTC)
Received: by qkas79 with SMTP id s79so52994931qka.0
        for <dev@httpd.apache.org>; Fri, 16 Oct 2015 05:06:43 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type:content-transfer-encoding;
        bh=8dFI5X9/MGzl9ByrM1XtvDaaEbUZ9OJixZrr4gFcxpc=;
        b=zNF//sAsxmOIfiDYgyp+DVIEdeqCMdpDAAXsbuZZcHANCMwAVbhV97nRXDKYmCrJ9/
         98cokyuE1hhUW19oyWvzzooLJ2CoayRdjKjbDtnf3eDEj3FthuRWj/WOL5g7fjavLSJT
         kIbXhb4do7i1jrw99h36HgpQHTbeV3uogMyDK3fj/DjviYSCYr2016J+ZNIzcV5oDEEZ
         yUx5L+uC1QZL9uglExOY6wC+sVXAKHifwL5BkouzdYk7mYddHLbDsN/Lj2x6poJQgu7F
         MoaMqn54AdnueOPaVvygfJpmGjtBoVH5WyFb0Z1TOL5ZMzwkkLpz+e91bt+QhrqJQwC4
         5zPQ==
MIME-Version: 1.0
X-Received: by 10.55.15.134 with SMTP id 6mr18267698qkp.38.1444997203662; Fri,
 16 Oct 2015 05:06:43 -0700 (PDT)
Received: by 10.55.156.213 with HTTP; Fri, 16 Oct 2015 05:06:43 -0700 (PDT)
In-Reply-To: <5620E659.9070309@redhat.com>
References: <5620E659.9070309@redhat.com>
Date: Fri, 16 Oct 2015 14:06:43 +0200
Message-ID: <CAKQ1sVN-2qE4QDHEAfLzbb2RGNs2jM9kshU9WkPwKVEDizLGuQ@mail.gmail.com>
Subject: Re: "httpd -X" segfaults with 2.4.17
From: Yann Ylavic <ylavic.dev@gmail.com>
To: dev@httpd.apache.org
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: quoted-printable

Hi Jan,

On Fri, Oct 16, 2015 at 1:58 PM, Jan Kalu=C5=BEa <jkaluza@redhat.com> wrote=
:
> Hi,
>
> httpd 2.4.17 segfaults when used with prefork MPM (and probably also with
> other MPMs) and -X option since r1705492.
>
> The crash happens in the following call in prefork.c (and probably also
> worker.c and so on):
>
>     ap_mpm_pod_check(my_bucket->pod)
>
> pod is NULL and later dereferenced.
>
> The pod is NULL because of the following:
>
>         if (!one_process && /* no POD in one_process mode */
>                 (rv =3D ap_mpm_pod_open(pconf, &all_buckets[i].pod))) {

This is a bad copy-and-paste from the worker/event logic, which I'm to
blame for...
I think we should simply remove the !one_process check here.

Regards,
Yann.

From dev-return-84311-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Fri Oct 16 12:33:40 2015
Return-Path: <dev-return-84311-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 31327171D5
	for <apmail-httpd-dev-archive@www.apache.org>; Fri, 16 Oct 2015 12:33:40 +0000 (UTC)
Received: (qmail 43675 invoked by uid 500); 16 Oct 2015 12:33:39 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 43611 invoked by uid 500); 16 Oct 2015 12:33:39 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 43601 invoked by uid 99); 16 Oct 2015 12:33:39 -0000
Received: from Unknown (HELO spamd4-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 16 Oct 2015 12:33:39 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd4-us-west.apache.org (ASF Mail Server at spamd4-us-west.apache.org) with ESMTP id 47EC0C0DCD
	for <dev@httpd.apache.org>; Fri, 16 Oct 2015 12:33:39 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd4-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 0.689
X-Spam-Level:
X-Spam-Status: No, score=0.689 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RCVD_IN_MSPIKE_H2=-0.001, SPF_PASS=-0.001, UPPERCASE_50_75=0.791]
	autolearn=disabled
Authentication-Results: spamd4-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd4-us-west.apache.org [10.40.0.11]) (amavisd-new, port 10024)
	with ESMTP id TAf_OS-q_PDR for <dev@httpd.apache.org>;
	Fri, 16 Oct 2015 12:33:38 +0000 (UTC)
Received: from mail-qg0-f42.google.com (mail-qg0-f42.google.com [209.85.192.42])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id DD6A142B32
	for <dev@httpd.apache.org>; Fri, 16 Oct 2015 12:33:37 +0000 (UTC)
Received: by qgeo38 with SMTP id o38so53793971qge.0
        for <dev@httpd.apache.org>; Fri, 16 Oct 2015 05:33:37 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        bh=hjYcyaJwqNlRuaIekRWztPQgvRscURjf/VSb7XB78/E=;
        b=kG9DQ+Nn6U2BEZxWYAYDMrb7msZRirtKcyo3KSVeO+jip332uqo9eCiSEAyWHY0w5R
         WPhGMfaEcxQdLhgPd7cUFmjAuZ5Jpf5fjqwfd9I5PnAXx0BFbo/9+eAduMEhQLDkg87c
         b0wlIVGvvwSLwR+4vdLZXrgRXXHIRe/yyo+AfkBWD22pQ4VLjepzW8INqGsh1XVkQtYv
         yyCoFuRz1+h7MIEZv1l0no1gFTypoqTshECaTRX1ScuczEefli8r2kTJZISfyJiwXzFl
         1/t34NaenDkrnOaQ/5BZArF2XcZjIRx6IxCuepEZ+ieve/fGwVkwn2VMcHwjvQDbwmd9
         eLzA==
MIME-Version: 1.0
X-Received: by 10.140.96.71 with SMTP id j65mr18442140qge.92.1444998817636;
 Fri, 16 Oct 2015 05:33:37 -0700 (PDT)
Received: by 10.55.156.213 with HTTP; Fri, 16 Oct 2015 05:33:37 -0700 (PDT)
In-Reply-To: <CAKQ1sVObJbAiRHdKHpU9veo8UtUqHXJ+L=PbcbWWd4Poo4TmGg@mail.gmail.com>
References: <CAKQ1sVNx3g2PjkxG6z2LwqA6CuJeVv2L6SryVsMWp2SydoKFjQ@mail.gmail.com>
	<CAKQ1sVObJbAiRHdKHpU9veo8UtUqHXJ+L=PbcbWWd4Poo4TmGg@mail.gmail.com>
Date: Fri, 16 Oct 2015 14:33:37 +0200
Message-ID: <CAKQ1sVOMCg6wYD_xpxgWuPiyR=o6HSDKjdBj34v4KPn1Ns+SGw@mail.gmail.com>
Subject: Re: H2 compatible ciphers (was: svn commit: r1708593)
From: Yann Ylavic <ylavic.dev@gmail.com>
To: dev@httpd.apache.org
Content-Type: text/plain; charset=UTF-8

On Fri, Oct 16, 2015 at 1:38 PM, Yann Ylavic <ylavic.dev@gmail.com> wrote:
>
> Actually I tried some brute bash script (attached) to show what
> remains compared to "openssl ciphers ALL", and the result is:
>
> * libressl/install/2.2.1/bin/openssl:
> - ECDHE-ECDSA-CHACHA20-POLY1305
> - ECDHE-RSA-CHACHA20-POLY1305
> - DHE-RSA-CHACHA20-POLY1305
> - ECDHE-RSA-AES256-GCM-SHA384
> - ECDHE-ECDSA-AES256-GCM-SHA384
> - DHE-DSS-AES256-GCM-SHA384
> - DHE-RSA-AES256-GCM-SHA384
> - GOST2012256-GOST89-GOST89
> - GOST2001-GOST89-GOST89
> - ECDHE-RSA-AES128-GCM-SHA256
> - ECDHE-ECDSA-AES128-GCM-SHA256
> - DHE-DSS-AES128-GCM-SHA256
> - DHE-RSA-AES128-GCM-SHA256
> - EDH-RSA-DES-CBC3-SHA
> - EDH-DSS-DES-CBC3-SHA
> - EDH-RSA-DES-CBC-SHA
> - EDH-DSS-DES-CBC-SHA
>
> * openssl/install/1.0.2d/bin/openssl:
> - ECDHE-RSA-AES256-GCM-SHA384
> - ECDHE-ECDSA-AES256-GCM-SHA384
> - DHE-DSS-AES256-GCM-SHA384
> - DHE-RSA-AES256-GCM-SHA384
> - ECDHE-RSA-AES128-GCM-SHA256
> - ECDHE-ECDSA-AES128-GCM-SHA256
> - DHE-DSS-AES128-GCM-SHA256
> - DHE-RSA-AES128-GCM-SHA256
> - EDH-RSA-DES-CBC3-SHA
> - EDH-DSS-DES-CBC3-SHA
> - EDH-RSA-DES-CBC-SHA
> - EDH-DSS-DES-CBC-SHA
> - EXP-EDH-RSA-DES-CBC-SHA
> - EXP-EDH-DSS-DES-CBC-SHA
>
> So 'TLSv1.2:!kRSA:!aECDH:!DH' is a bit too restrictive

Looks like 'ALL:!SSLv3:!kRSA:!ADH:!aECDH' matches pretty well
(excluding for the undesirable ones above).

From dev-return-84312-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Fri Oct 16 12:35:41 2015
Return-Path: <dev-return-84312-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 11D8B17206
	for <apmail-httpd-dev-archive@www.apache.org>; Fri, 16 Oct 2015 12:35:41 +0000 (UTC)
Received: (qmail 47786 invoked by uid 500); 16 Oct 2015 12:35:40 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 47714 invoked by uid 500); 16 Oct 2015 12:35:40 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 47704 invoked by uid 99); 16 Oct 2015 12:35:40 -0000
Received: from Unknown (HELO spamd2-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 16 Oct 2015 12:35:40 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd2-us-west.apache.org (ASF Mail Server at spamd2-us-west.apache.org) with ESMTP id 216A31A2B94
	for <dev@httpd.apache.org>; Fri, 16 Oct 2015 12:35:40 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd2-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.011
X-Spam-Level:
X-Spam-Status: No, score=-0.011 tagged_above=-999 required=6.31
	tests=[SPF_PASS=-0.001, T_RP_MATCHES_RCVD=-0.01] autolearn=disabled
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd2-us-west.apache.org [10.40.0.9]) (amavisd-new, port 10024)
	with ESMTP id lN1eIKwzFPuu for <dev@httpd.apache.org>;
	Fri, 16 Oct 2015 12:35:38 +0000 (UTC)
Received: from mailserver.kippdata.de (capsella.kippdata.de [195.227.30.149])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTP id C996921277
	for <dev@httpd.apache.org>; Fri, 16 Oct 2015 12:35:37 +0000 (UTC)
Received: from [10.0.110.6] ([192.168.10.45])
	by mailserver.kippdata.de (8.13.5/8.13.5) with ESMTP id t9GCZan9004121
	for <dev@httpd.apache.org>; Fri, 16 Oct 2015 14:35:37 +0200 (CEST)
Subject: Re: 2.4.17 alignment issue sparc/ia64
To: dev@httpd.apache.org
References: <CALK=YjMWSTLMzr=5nKws8M8=CkrhqQJ8S1xCgyQycms-V1pNDQ@mail.gmail.com>
 <CAKQ1sVP6HPyQj4Tq-47DQ27tbCTRk+005UoAnxmgL7xdWW6+_A@mail.gmail.com>
 <CAKQ1sVO5=kaZitCpQ0Vuqx8E+nj69cv5+pEuzDo1_jhMZRB4Cg@mail.gmail.com>
From: Rainer Jung <rainer.jung@kippdata.de>
Message-ID: <5620EF0E.7000109@kippdata.de>
Date: Fri, 16 Oct 2015 14:35:26 +0200
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:38.0) Gecko/20100101
 Thunderbird/38.3.0
MIME-Version: 1.0
In-Reply-To: <CAKQ1sVO5=kaZitCpQ0Vuqx8E+nj69cv5+pEuzDo1_jhMZRB4Cg@mail.gmail.com>
Content-Type: text/plain; charset=utf-8; format=flowed
Content-Transfer-Encoding: 7bit

Am 16.10.2015 um 13:54 schrieb Yann Ylavic:
> On Fri, Oct 16, 2015 at 10:02 AM, Yann Ylavic <ylavic.dev@gmail.com> wrote:
>>
>> We should do something like the following patch:
>>
>> Index: server/scoreboard.c
>> ===================================================================
>> --- server/scoreboard.c    (revision 1708095)
>> +++ server/scoreboard.c    (working copy)
>> @@ -129,14 +129,19 @@ static apr_status_t ap_cleanup_shared_mem(void *d)
>>       return APR_SUCCESS;
>>   }
>>
>> +#define SIZE_OF_scoreboard    APR_ALIGN_DEFAULT(sizeof(scoreboard))
>> +#define SIZE_OF_global_score  APR_ALIGN_DEFAULT(sizeof(global_score))
>> +#define SIZE_OF_process_score APR_ALIGN_DEFAULT(sizeof(process_score))
>> +#define SIZE_OF_worker_score  APR_ALIGN_DEFAULT(sizeof(worker_score))
>
> Maybe the following would be more correct:
>
> +#define SCOREBOARD_ALIGN(size) APR_ALIGN((size),sizeof(void *))
> +#define SIZE_OF_scoreboard     SCOREBOARD_ALIGN(sizeof(scoreboard))
> +#define SIZE_OF_global_score   SCOREBOARD_ALIGN(sizeof(global_score))
> +#define SIZE_OF_process_score  SCOREBOARD_ALIGN(sizeof(process_score))
> +#define SIZE_OF_worker_score   SCOREBOARD_ALIGN(sizeof(worker_score))
>
> since APR_ALIGN_DEFAULT seems to align to 8 bytes whatever the
> platform requires...
>
> Maybe some APR_ALIGN_NATIVE macro is missing in APR, like:
> #define APR_ALIGN_NATIVE(size) APR_ALIGN((size), APR_SIZEOF_VOIDP)
> but that's another story :)

I didn't yet have the time to reproduce and test your patch, but the 
APR_ALIGN((size),sizeof(void *)) align approach would not work. The 
problem here is that even or especially when building for 32 Bits and 
then using a 64 Bit data type, the alignment fails. So the pointer size 
would be 4 here, but the requirement alignment 8 bytes.

Fun with hardware.

Rainer

From dev-return-84313-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Fri Oct 16 12:42:23 2015
Return-Path: <dev-return-84313-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 7478D17226
	for <apmail-httpd-dev-archive@www.apache.org>; Fri, 16 Oct 2015 12:42:23 +0000 (UTC)
Received: (qmail 54779 invoked by uid 500); 16 Oct 2015 12:42:17 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 54709 invoked by uid 500); 16 Oct 2015 12:42:17 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 54699 invoked by uid 99); 16 Oct 2015 12:42:17 -0000
Received: from Unknown (HELO spamd1-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 16 Oct 2015 12:42:17 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd1-us-west.apache.org (ASF Mail Server at spamd1-us-west.apache.org) with ESMTP id 364E5C6377
	for <dev@httpd.apache.org>; Fri, 16 Oct 2015 12:42:17 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd1-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 0.001
X-Spam-Level:
X-Spam-Status: No, score=0.001 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, URIBL_BLOCKED=0.001]
	autolearn=disabled
Authentication-Results: spamd1-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=comcast.net
Received: from mx1-us-west.apache.org ([10.40.0.8])
	by localhost (spamd1-us-west.apache.org [10.40.0.7]) (amavisd-new, port 10024)
	with ESMTP id pm0hAzS9lCJd for <dev@httpd.apache.org>;
	Fri, 16 Oct 2015 12:42:04 +0000 (UTC)
Received: from resqmta-ch2-01v.sys.comcast.net (resqmta-ch2-01v.sys.comcast.net [69.252.207.33])
	by mx1-us-west.apache.org (ASF Mail Server at mx1-us-west.apache.org) with ESMTPS id A617821165
	for <dev@httpd.apache.org>; Fri, 16 Oct 2015 12:42:04 +0000 (UTC)
Received: from resomta-ch2-05v.sys.comcast.net ([69.252.207.101])
	by resqmta-ch2-01v.sys.comcast.net with comcast
	id VohX1r0042Bo0NV01ohyv9; Fri, 16 Oct 2015 12:41:58 +0000
Received: from [192.168.199.10] ([69.251.84.114])
	by resomta-ch2-05v.sys.comcast.net with comcast
	id Vohw1r00N2U0RYt01ohxa6; Fri, 16 Oct 2015 12:41:58 +0000
Content-Type: text/plain; charset=us-ascii
Mime-Version: 1.0 (Mac OS X Mail 8.2 \(2104\))
Subject: Re: 2.4.17 alignment issue sparc/ia64
From: Jim Jagielski <jim@jaguNET.com>
In-Reply-To: <5620EF0E.7000109@kippdata.de>
Date: Fri, 16 Oct 2015 08:41:56 -0400
Content-Transfer-Encoding: quoted-printable
Message-Id: <AD85E66E-4EAC-41C8-A368-A291BD2B3241@jaguNET.com>
References: <CALK=YjMWSTLMzr=5nKws8M8=CkrhqQJ8S1xCgyQycms-V1pNDQ@mail.gmail.com> <CAKQ1sVP6HPyQj4Tq-47DQ27tbCTRk+005UoAnxmgL7xdWW6+_A@mail.gmail.com> <CAKQ1sVO5=kaZitCpQ0Vuqx8E+nj69cv5+pEuzDo1_jhMZRB4Cg@mail.gmail.com> <5620EF0E.7000109@kippdata.de>
To: dev@httpd.apache.org
X-Mailer: Apple Mail (2.2104)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=comcast.net;
	s=q20140121; t=1444999318;
	bh=fMZVabhW02YXWUakGCSbR1Fp44Mb4KKux6lB0csTwvc=;
	h=Received:Received:Content-Type:Mime-Version:Subject:From:Date:
	 Message-Id:To;
	b=N0EPJ+Mtp6fOyv7HYMrk11lxL5RyFE6cLpT17To5oFscF77FQPr3XyI0LKD9ywp7O
	 0DNfQKbZwfRyg0hHt9y+wCiH14/2ML0qFbX2/H0cmtoVu5L4NBNVNr/gXePgafa5n0
	 MWiHiNcndCuH0hj9zD/Y3fxLdF/w/vt/gPptmEEeVVKoPHQ6dQ1Ox4gmX3s4Qk5cne
	 IUCdtqPgiHDZxvQU27jpx0yg8k3B1QOHie9G62ksUtF9dn3dJQfhPWYoC5priX/53Y
	 nrhLCCaE6Oj//4Tz4IC5qEsdqk0WoLzUQpesWZsPkhoso7NoZ7eTxXyuzmWeqZznya
	 /o5VOH0/TuE0Q==

I seem to recall similar issues w/ the shm slotmem impl...

> On Oct 16, 2015, at 8:35 AM, Rainer Jung <rainer.jung@kippdata.de> =
wrote:
>=20
> Am 16.10.2015 um 13:54 schrieb Yann Ylavic:
>> On Fri, Oct 16, 2015 at 10:02 AM, Yann Ylavic <ylavic.dev@gmail.com> =
wrote:
>>>=20
>>> We should do something like the following patch:
>>>=20
>>> Index: server/scoreboard.c
>>> =3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D
>>> --- server/scoreboard.c    (revision 1708095)
>>> +++ server/scoreboard.c    (working copy)
>>> @@ -129,14 +129,19 @@ static apr_status_t ap_cleanup_shared_mem(void =
*d)
>>>      return APR_SUCCESS;
>>>  }
>>>=20
>>> +#define SIZE_OF_scoreboard    APR_ALIGN_DEFAULT(sizeof(scoreboard))
>>> +#define SIZE_OF_global_score  =
APR_ALIGN_DEFAULT(sizeof(global_score))
>>> +#define SIZE_OF_process_score =
APR_ALIGN_DEFAULT(sizeof(process_score))
>>> +#define SIZE_OF_worker_score  =
APR_ALIGN_DEFAULT(sizeof(worker_score))
>>=20
>> Maybe the following would be more correct:
>>=20
>> +#define SCOREBOARD_ALIGN(size) APR_ALIGN((size),sizeof(void *))
>> +#define SIZE_OF_scoreboard     SCOREBOARD_ALIGN(sizeof(scoreboard))
>> +#define SIZE_OF_global_score   =
SCOREBOARD_ALIGN(sizeof(global_score))
>> +#define SIZE_OF_process_score  =
SCOREBOARD_ALIGN(sizeof(process_score))
>> +#define SIZE_OF_worker_score   =
SCOREBOARD_ALIGN(sizeof(worker_score))
>>=20
>> since APR_ALIGN_DEFAULT seems to align to 8 bytes whatever the
>> platform requires...
>>=20
>> Maybe some APR_ALIGN_NATIVE macro is missing in APR, like:
>> #define APR_ALIGN_NATIVE(size) APR_ALIGN((size), APR_SIZEOF_VOIDP)
>> but that's another story :)
>=20
> I didn't yet have the time to reproduce and test your patch, but the =
APR_ALIGN((size),sizeof(void *)) align approach would not work. The =
problem here is that even or especially when building for 32 Bits and =
then using a 64 Bit data type, the alignment fails. So the pointer size =
would be 4 here, but the requirement alignment 8 bytes.
>=20
> Fun with hardware.
>=20
> Rainer


From dev-return-84314-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Fri Oct 16 12:48:52 2015
Return-Path: <dev-return-84314-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id B9E9117277
	for <apmail-httpd-dev-archive@www.apache.org>; Fri, 16 Oct 2015 12:48:52 +0000 (UTC)
Received: (qmail 72625 invoked by uid 500); 16 Oct 2015 12:48:52 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 72563 invoked by uid 500); 16 Oct 2015 12:48:52 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 72553 invoked by uid 99); 16 Oct 2015 12:48:52 -0000
Received: from Unknown (HELO spamd4-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 16 Oct 2015 12:48:52 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd4-us-west.apache.org (ASF Mail Server at spamd4-us-west.apache.org) with ESMTP id C8F6FC0BE5
	for <dev@httpd.apache.org>; Fri, 16 Oct 2015 12:48:51 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd4-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.101
X-Spam-Level:
X-Spam-Status: No, score=-0.101 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RCVD_IN_MSPIKE_H2=-0.001, SPF_PASS=-0.001, URIBL_BLOCKED=0.001]
	autolearn=disabled
Authentication-Results: spamd4-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd4-us-west.apache.org [10.40.0.11]) (amavisd-new, port 10024)
	with ESMTP id MTf_GXRRX40w for <dev@httpd.apache.org>;
	Fri, 16 Oct 2015 12:48:44 +0000 (UTC)
Received: from mail-qg0-f45.google.com (mail-qg0-f45.google.com [209.85.192.45])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id 0DAF020751
	for <dev@httpd.apache.org>; Fri, 16 Oct 2015 12:48:44 +0000 (UTC)
Received: by qgad10 with SMTP id d10so5186506qga.3
        for <dev@httpd.apache.org>; Fri, 16 Oct 2015 05:48:37 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        bh=CrkxkWAY+IH5FTuH6z0/bNFOzuQm1mVjmkg3vukF83k=;
        b=mYAbvmMnH7k4ejah7epbd7QJhk97rSVLXGgGAMOObnKF3CEjtUoke0v3vcHzeYF9eR
         02OsRP7jhrQchvtLfCUCSNlt2sNN+e0kHBvLp6VOvK6Tx0GKjbMve6ZAL/r0KovCxjwV
         iPjBvHBu1iOYC3VOtxEZ3dDhaGmUMRL7UGUhlTd8HMdgYsn0EFH/K8vshqXmDzyKuzKM
         MVV8firXMPhZiVNF21iGKCRFeJbVIc6LdwR9vw2tgJpWWelwE8XJOILqK5N/J+NB8/95
         6tvoN6RQEVOQTXIBAsmzgyTXmAjODKp4BvYYogxK0k3mrpiT5HjupMM0oBokOj4+eADT
         fiIQ==
MIME-Version: 1.0
X-Received: by 10.140.43.183 with SMTP id e52mr11141806qga.38.1444999717440;
 Fri, 16 Oct 2015 05:48:37 -0700 (PDT)
Received: by 10.55.156.213 with HTTP; Fri, 16 Oct 2015 05:48:37 -0700 (PDT)
In-Reply-To: <5620EF0E.7000109@kippdata.de>
References: <CALK=YjMWSTLMzr=5nKws8M8=CkrhqQJ8S1xCgyQycms-V1pNDQ@mail.gmail.com>
	<CAKQ1sVP6HPyQj4Tq-47DQ27tbCTRk+005UoAnxmgL7xdWW6+_A@mail.gmail.com>
	<CAKQ1sVO5=kaZitCpQ0Vuqx8E+nj69cv5+pEuzDo1_jhMZRB4Cg@mail.gmail.com>
	<5620EF0E.7000109@kippdata.de>
Date: Fri, 16 Oct 2015 14:48:37 +0200
Message-ID: <CAKQ1sVMCcJ4nvhiibJe_edW06A8Spvt=8m5PxnQ-FdGhX=H+dA@mail.gmail.com>
Subject: Re: 2.4.17 alignment issue sparc/ia64
From: Yann Ylavic <ylavic.dev@gmail.com>
To: dev@httpd.apache.org
Content-Type: text/plain; charset=UTF-8

On Fri, Oct 16, 2015 at 2:35 PM, Rainer Jung <rainer.jung@kippdata.de> wrote:
>
> I didn't yet have the time to reproduce and test your patch, but the
> APR_ALIGN((size),sizeof(void *)) align approach would not work. The problem
> here is that even or especially when building for 32 Bits and then using a
> 64 Bit data type, the alignment fails. So the pointer size would be 4 here,
> but the requirement alignment 8 bytes.

Hm, correct, each integral type (greater than the word) needs be
aligned on its size!

From dev-return-84315-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Fri Oct 16 12:56:46 2015
Return-Path: <dev-return-84315-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id A1787172F4
	for <apmail-httpd-dev-archive@www.apache.org>; Fri, 16 Oct 2015 12:56:46 +0000 (UTC)
Received: (qmail 87552 invoked by uid 500); 16 Oct 2015 12:56:40 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 87465 invoked by uid 500); 16 Oct 2015 12:56:39 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 87455 invoked by uid 99); 16 Oct 2015 12:56:39 -0000
Received: from Unknown (HELO spamd2-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 16 Oct 2015 12:56:39 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd2-us-west.apache.org (ASF Mail Server at spamd2-us-west.apache.org) with ESMTP id 807CD1A25E6
	for <dev@httpd.apache.org>; Fri, 16 Oct 2015 12:56:39 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd2-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.101
X-Spam-Level:
X-Spam-Status: No, score=-0.101 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RCVD_IN_MSPIKE_H2=-0.001, SPF_PASS=-0.001, URIBL_BLOCKED=0.001]
	autolearn=disabled
Authentication-Results: spamd2-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd2-us-west.apache.org [10.40.0.9]) (amavisd-new, port 10024)
	with ESMTP id R-9i2ZJpP7k4 for <dev@httpd.apache.org>;
	Fri, 16 Oct 2015 12:56:34 +0000 (UTC)
Received: from mail-qk0-f175.google.com (mail-qk0-f175.google.com [209.85.220.175])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id 3F8B82139D
	for <dev@httpd.apache.org>; Fri, 16 Oct 2015 12:56:33 +0000 (UTC)
Received: by qkas79 with SMTP id s79so53593534qka.0
        for <dev@httpd.apache.org>; Fri, 16 Oct 2015 05:56:26 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        bh=jIBMvrQTXZmJC2Y18itDsEckpqLpZGoaeOyGCsG7GZo=;
        b=QOD3mtTr2LFqJCSJCPOueaxdHldgRtFvKgezx2Wbw4s6nMikc7DC2beiL6JYpgK+EP
         /K/s43Ql+PsHvAeHz0JNpoxmGvzUpX54KnBQ5ORN8xHwXq311B8Y1SkXa1jgBTWXjnMX
         kmWfWJdwHWq6jc829FFaOPaovsseg7LwrZgImuOrxzut233XrxRHbBi7FvbnS3q0Z5sv
         HM1ppb+RtvCm9bSxqekIS33mrg35jMPspjMwK2rNu/1GPphYiW79fQcC6TTI7xan/LYu
         g6hnJzN35bzFqgg2JBoVuZKpYqUVZ8sIqL1Ae1qTspbAwxKSJnh889/ee7htzlI0xQiT
         DWgQ==
MIME-Version: 1.0
X-Received: by 10.55.15.134 with SMTP id 6mr18566170qkp.38.1445000186074; Fri,
 16 Oct 2015 05:56:26 -0700 (PDT)
Received: by 10.55.156.213 with HTTP; Fri, 16 Oct 2015 05:56:26 -0700 (PDT)
In-Reply-To: <CAKQ1sVMCcJ4nvhiibJe_edW06A8Spvt=8m5PxnQ-FdGhX=H+dA@mail.gmail.com>
References: <CALK=YjMWSTLMzr=5nKws8M8=CkrhqQJ8S1xCgyQycms-V1pNDQ@mail.gmail.com>
	<CAKQ1sVP6HPyQj4Tq-47DQ27tbCTRk+005UoAnxmgL7xdWW6+_A@mail.gmail.com>
	<CAKQ1sVO5=kaZitCpQ0Vuqx8E+nj69cv5+pEuzDo1_jhMZRB4Cg@mail.gmail.com>
	<5620EF0E.7000109@kippdata.de>
	<CAKQ1sVMCcJ4nvhiibJe_edW06A8Spvt=8m5PxnQ-FdGhX=H+dA@mail.gmail.com>
Date: Fri, 16 Oct 2015 14:56:26 +0200
Message-ID: <CAKQ1sVMF1e4NCemsZRCGcU-eQOU6v1=+DHu08S3o0BFujmNnEg@mail.gmail.com>
Subject: Re: 2.4.17 alignment issue sparc/ia64
From: Yann Ylavic <ylavic.dev@gmail.com>
To: dev@httpd.apache.org
Content-Type: text/plain; charset=UTF-8

On Fri, Oct 16, 2015 at 2:48 PM, Yann Ylavic <ylavic.dev@gmail.com> wrote:
> On Fri, Oct 16, 2015 at 2:35 PM, Rainer Jung <rainer.jung@kippdata.de> wrote:
>>
>> I didn't yet have the time to reproduce and test your patch, but the
>> APR_ALIGN((size),sizeof(void *)) align approach would not work. The problem
>> here is that even or especially when building for 32 Bits and then using a
>> 64 Bit data type, the alignment fails. So the pointer size would be 4 here,
>> but the requirement alignment 8 bytes.
>
> Hm, correct, each integral type (greater than the word) needs be
> aligned on its size!

Though the issue here is not accessing the type as an integral, so
aligning on 4 bytes (for 32 bit hardware) should enough for accessing
each scoreborad entry/struct (the members of the structs themselves
will still be aligned according to their type, so they can also be
safely accessed).

From dev-return-84316-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Fri Oct 16 13:08:58 2015
Return-Path: <dev-return-84316-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id EFEED173B0
	for <apmail-httpd-dev-archive@www.apache.org>; Fri, 16 Oct 2015 13:08:57 +0000 (UTC)
Received: (qmail 33060 invoked by uid 500); 16 Oct 2015 13:08:51 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 33001 invoked by uid 500); 16 Oct 2015 13:08:51 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 32918 invoked by uid 99); 16 Oct 2015 13:08:51 -0000
Received: from Unknown (HELO spamd2-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 16 Oct 2015 13:08:51 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd2-us-west.apache.org (ASF Mail Server at spamd2-us-west.apache.org) with ESMTP id 5E2961A0692
	for <dev@httpd.apache.org>; Fri, 16 Oct 2015 13:08:51 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd2-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.01
X-Spam-Level:
X-Spam-Status: No, score=-0.01 tagged_above=-999 required=6.31
	tests=[SPF_PASS=-0.001, T_RP_MATCHES_RCVD=-0.01, URIBL_BLOCKED=0.001]
	autolearn=disabled
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd2-us-west.apache.org [10.40.0.9]) (amavisd-new, port 10024)
	with ESMTP id b0N_XpzEqcek for <dev@httpd.apache.org>;
	Fri, 16 Oct 2015 13:08:50 +0000 (UTC)
Received: from mailserver.kippdata.de (capsella.kippdata.de [195.227.30.149])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTP id 9CEC820925
	for <dev@httpd.apache.org>; Fri, 16 Oct 2015 13:08:49 +0000 (UTC)
Received: from [10.0.110.6] ([10.198.19.77])
	by mailserver.kippdata.de (8.13.5/8.13.5) with ESMTP id t9GD8lPp004563
	for <dev@httpd.apache.org>; Fri, 16 Oct 2015 15:08:48 +0200 (CEST)
Subject: Re: 2.4.17 alignment issue sparc/ia64
To: dev@httpd.apache.org
References: <CALK=YjMWSTLMzr=5nKws8M8=CkrhqQJ8S1xCgyQycms-V1pNDQ@mail.gmail.com>
 <CAKQ1sVP6HPyQj4Tq-47DQ27tbCTRk+005UoAnxmgL7xdWW6+_A@mail.gmail.com>
 <CAKQ1sVO5=kaZitCpQ0Vuqx8E+nj69cv5+pEuzDo1_jhMZRB4Cg@mail.gmail.com>
 <5620EF0E.7000109@kippdata.de>
 <CAKQ1sVMCcJ4nvhiibJe_edW06A8Spvt=8m5PxnQ-FdGhX=H+dA@mail.gmail.com>
 <CAKQ1sVMF1e4NCemsZRCGcU-eQOU6v1=+DHu08S3o0BFujmNnEg@mail.gmail.com>
From: Rainer Jung <rainer.jung@kippdata.de>
Message-ID: <5620F6D4.2000204@kippdata.de>
Date: Fri, 16 Oct 2015 15:08:36 +0200
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:38.0) Gecko/20100101
 Thunderbird/38.3.0
MIME-Version: 1.0
In-Reply-To: <CAKQ1sVMF1e4NCemsZRCGcU-eQOU6v1=+DHu08S3o0BFujmNnEg@mail.gmail.com>
Content-Type: text/plain; charset=utf-8; format=flowed
Content-Transfer-Encoding: 7bit

Am 16.10.2015 um 14:56 schrieb Yann Ylavic:
> On Fri, Oct 16, 2015 at 2:48 PM, Yann Ylavic <ylavic.dev@gmail.com> wrote:
>> On Fri, Oct 16, 2015 at 2:35 PM, Rainer Jung <rainer.jung@kippdata.de> wrote:
>>>
>>> I didn't yet have the time to reproduce and test your patch, but the
>>> APR_ALIGN((size),sizeof(void *)) align approach would not work. The problem
>>> here is that even or especially when building for 32 Bits and then using a
>>> 64 Bit data type, the alignment fails. So the pointer size would be 4 here,
>>> but the requirement alignment 8 bytes.
>>
>> Hm, correct, each integral type (greater than the word) needs be
>> aligned on its size!
>
> Though the issue here is not accessing the type as an integral, so
> aligning on 4 bytes (for 32 bit hardware) should enough for accessing
> each scoreborad entry/struct (the members of the structs themselves
> will still be aligned according to their type, so they can also be
> safely accessed).

Wasn't the bus error occuring in

ws->last_used = apr_time_now();

and the address is

(dbx) print &(ws->last_used)
&ws->last_used = 0xffffffff7bb00094

not divisible by 8 although the data type (not pointer size) is 64 Bit.

Regards,

Rainer


From dev-return-84317-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Fri Oct 16 13:16:37 2015
Return-Path: <dev-return-84317-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 0815E17428
	for <apmail-httpd-dev-archive@www.apache.org>; Fri, 16 Oct 2015 13:16:37 +0000 (UTC)
Received: (qmail 56446 invoked by uid 500); 16 Oct 2015 13:16:27 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 56380 invoked by uid 500); 16 Oct 2015 13:16:27 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 56369 invoked by uid 99); 16 Oct 2015 13:16:27 -0000
Received: from Unknown (HELO spamd3-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 16 Oct 2015 13:16:27 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd3-us-west.apache.org (ASF Mail Server at spamd3-us-west.apache.org) with ESMTP id 98A7F180DD7
	for <dev@httpd.apache.org>; Fri, 16 Oct 2015 13:16:26 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd3-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.1
X-Spam-Level:
X-Spam-Status: No, score=-0.1 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	SPF_PASS=-0.001, URIBL_BLOCKED=0.001] autolearn=disabled
Authentication-Results: spamd3-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd3-us-west.apache.org [10.40.0.10]) (amavisd-new, port 10024)
	with ESMTP id RoNwBnWxfZf3 for <dev@httpd.apache.org>;
	Fri, 16 Oct 2015 13:16:12 +0000 (UTC)
Received: from mail-qg0-f50.google.com (mail-qg0-f50.google.com [209.85.192.50])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id 2314942BA7
	for <dev@httpd.apache.org>; Fri, 16 Oct 2015 13:16:12 +0000 (UTC)
Received: by qgad10 with SMTP id d10so5917926qga.3
        for <dev@httpd.apache.org>; Fri, 16 Oct 2015 06:16:12 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        bh=cAIwJ7DIeJJWu7Y17vQCaBQN+HvVr5mKJViN0gLEOH4=;
        b=IPqNEj7ASp40S/2PgpgjxuKv0KX2uEeFL1J6xue3AvHjiG4svHWpXcjXJtLAxsZVcU
         agOyeGVYrs6yvK7/cqnfJn8vQhHvbWT93FUk3rff/s5snUDPrlCR8hxbw2P4YD1Rv57G
         iKdOODaoIZV1YyyUy6xcA4ke+w1ffRBQq7Exk684HIDP1oABSqo/zLSkiuwGbruTTKE2
         yXNefK5QNqQD9MqppuOweY1EDAjgb9O0JYpcLXmAobTO4skRXQ9/MEiR46ut1MAQO5yk
         FZWgVRGre8xP/bXvTKHy65oM8Awy4ZbWqZC3TvBg37stFBqxidiRHH8OlpwKnJxeA3WA
         n1+A==
MIME-Version: 1.0
X-Received: by 10.141.23.9 with SMTP id z9mr19945215qhd.24.1445001371919; Fri,
 16 Oct 2015 06:16:11 -0700 (PDT)
Received: by 10.55.156.213 with HTTP; Fri, 16 Oct 2015 06:16:11 -0700 (PDT)
In-Reply-To: <5620F6D4.2000204@kippdata.de>
References: <CALK=YjMWSTLMzr=5nKws8M8=CkrhqQJ8S1xCgyQycms-V1pNDQ@mail.gmail.com>
	<CAKQ1sVP6HPyQj4Tq-47DQ27tbCTRk+005UoAnxmgL7xdWW6+_A@mail.gmail.com>
	<CAKQ1sVO5=kaZitCpQ0Vuqx8E+nj69cv5+pEuzDo1_jhMZRB4Cg@mail.gmail.com>
	<5620EF0E.7000109@kippdata.de>
	<CAKQ1sVMCcJ4nvhiibJe_edW06A8Spvt=8m5PxnQ-FdGhX=H+dA@mail.gmail.com>
	<CAKQ1sVMF1e4NCemsZRCGcU-eQOU6v1=+DHu08S3o0BFujmNnEg@mail.gmail.com>
	<5620F6D4.2000204@kippdata.de>
Date: Fri, 16 Oct 2015 15:16:11 +0200
Message-ID: <CAKQ1sVO4BZk2_hkgj6jQS+3b8eR-jSLUtC96QAYDXGLMxS=qwA@mail.gmail.com>
Subject: Re: 2.4.17 alignment issue sparc/ia64
From: Yann Ylavic <ylavic.dev@gmail.com>
To: dev@httpd.apache.org
Content-Type: text/plain; charset=UTF-8

On Fri, Oct 16, 2015 at 3:08 PM, Rainer Jung <rainer.jung@kippdata.de> wrote:
> Am 16.10.2015 um 14:56 schrieb Yann Ylavic:
>>
>> On Fri, Oct 16, 2015 at 2:48 PM, Yann Ylavic <ylavic.dev@gmail.com> wrote:
>>>
>>> On Fri, Oct 16, 2015 at 2:35 PM, Rainer Jung <rainer.jung@kippdata.de>
>>> wrote:
>>>>
>>>>
>>>> I didn't yet have the time to reproduce and test your patch, but the
>>>> APR_ALIGN((size),sizeof(void *)) align approach would not work. The
>>>> problem
>>>> here is that even or especially when building for 32 Bits and then using
>>>> a
>>>> 64 Bit data type, the alignment fails. So the pointer size would be 4
>>>> here,
>>>> but the requirement alignment 8 bytes.
>>>
>>>
>>> Hm, correct, each integral type (greater than the word) needs be
>>> aligned on its size!
>>
>>
>> Though the issue here is not accessing the type as an integral, so
>> aligning on 4 bytes (for 32 bit hardware) should enough for accessing
>> each scoreborad entry/struct (the members of the structs themselves
>> will still be aligned according to their type, so they can also be
>> safely accessed).
>
>
> Wasn't the bus error occuring in
>
> ws->last_used = apr_time_now();
>
> and the address is
>
> (dbx) print &(ws->last_used)
> &ws->last_used = 0xffffffff7bb00094
>
> not divisible by 8 although the data type (not pointer size) is 64 Bit.

Yes but ws itself isn't aligned either:
    (dbx) print ws
    ws = 0xffffffff7bb00044
which is IMHO the issue.

Align ws and everything goes well (at least I think :p ).

Regards,
Yann.

From dev-return-84318-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Fri Oct 16 13:29:23 2015
Return-Path: <dev-return-84318-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id CBFD8174D8
	for <apmail-httpd-dev-archive@www.apache.org>; Fri, 16 Oct 2015 13:29:23 +0000 (UTC)
Received: (qmail 81400 invoked by uid 500); 16 Oct 2015 13:29:14 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 81325 invoked by uid 500); 16 Oct 2015 13:29:13 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 81315 invoked by uid 99); 16 Oct 2015 13:29:13 -0000
Received: from Unknown (HELO spamd1-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 16 Oct 2015 13:29:13 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd1-us-west.apache.org (ASF Mail Server at spamd1-us-west.apache.org) with ESMTP id 63C30C50DF
	for <dev@httpd.apache.org>; Fri, 16 Oct 2015 13:29:13 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd1-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.121
X-Spam-Level:
X-Spam-Status: No, score=-0.121 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RCVD_IN_MSPIKE_H3=-0.01, RCVD_IN_MSPIKE_WL=-0.01, SPF_PASS=-0.001]
	autolearn=disabled
Authentication-Results: spamd1-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd1-us-west.apache.org [10.40.0.7]) (amavisd-new, port 10024)
	with ESMTP id KN-f4noCo7VL for <dev@httpd.apache.org>;
	Fri, 16 Oct 2015 13:29:13 +0000 (UTC)
Received: from mail-wi0-f172.google.com (mail-wi0-f172.google.com [209.85.212.172])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id 92A0C429AA
	for <dev@httpd.apache.org>; Fri, 16 Oct 2015 13:29:12 +0000 (UTC)
Received: by wijp11 with SMTP id p11so10531582wij.0
        for <dev@httpd.apache.org>; Fri, 16 Oct 2015 06:29:06 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=mime-version:in-reply-to:references:from:date:message-id:subject:to
         :content-type;
        bh=jJBFXCIUscAQ/vRkPsPinOC6CzdHUqIQf0JIMMkGlpI=;
        b=CiKs3R+1wAmCx0xM4iG/NMohqpezIFUn3MNw6XKLlnmBQLjOCJF69w6+5mbh5IrTyf
         PjUYfaXRJElrXmfHedKjqOoSIX6uZ0COmA2fbGcO7F51CHHU5JBXMcsEalJFmbKOSfy4
         4wU+WFX1YyszJpWv1/sQNAsW0m8YhxUoeq7nTa5SWfTeYSnyYYvhbTAdq7qXzN+UVQWU
         hgMuQKUEdIZ7Akq54dK/DjqBe1l8hX/oZH3pQO6Kukb2iisrrosuff9FhXlyRR9WFzkC
         MxAi1YsjsysZ9WHBaSDPfmdPHVpIgvbGwp0rrR+CXgxrKLewvFU0prQEGHutWocOqtEJ
         QWjQ==
X-Received: by 10.194.76.67 with SMTP id i3mr18682198wjw.5.1445002146592; Fri,
 16 Oct 2015 06:29:06 -0700 (PDT)
MIME-Version: 1.0
Received: by 10.27.88.10 with HTTP; Fri, 16 Oct 2015 06:28:47 -0700 (PDT)
In-Reply-To: <CAKQ1sVOMCg6wYD_xpxgWuPiyR=o6HSDKjdBj34v4KPn1Ns+SGw@mail.gmail.com>
References: <CAKQ1sVNx3g2PjkxG6z2LwqA6CuJeVv2L6SryVsMWp2SydoKFjQ@mail.gmail.com>
 <CAKQ1sVObJbAiRHdKHpU9veo8UtUqHXJ+L=PbcbWWd4Poo4TmGg@mail.gmail.com> <CAKQ1sVOMCg6wYD_xpxgWuPiyR=o6HSDKjdBj34v4KPn1Ns+SGw@mail.gmail.com>
From: Chris <chrcoluk@gmail.com>
Date: Fri, 16 Oct 2015 14:28:47 +0100
Message-ID: <CAOhm=5qPYuXD+BpbZZhcOa=_J_3hdid6s4w0=HaZCPy3as+GVw@mail.gmail.com>
Subject: Re: H2 compatible ciphers (was: svn commit: r1708593)
To: dev@httpd.apache.org
Content-Type: text/plain; charset=UTF-8

interesting that chrome is happily using h2 on my domain that I
activated for h2 earlier and I have a couple of banned ciphers in
mod_ssl.

On 16 October 2015 at 13:33, Yann Ylavic <ylavic.dev@gmail.com> wrote:
> On Fri, Oct 16, 2015 at 1:38 PM, Yann Ylavic <ylavic.dev@gmail.com> wrote:
>>
>> Actually I tried some brute bash script (attached) to show what
>> remains compared to "openssl ciphers ALL", and the result is:
>>
>> * libressl/install/2.2.1/bin/openssl:
>> - ECDHE-ECDSA-CHACHA20-POLY1305
>> - ECDHE-RSA-CHACHA20-POLY1305
>> - DHE-RSA-CHACHA20-POLY1305
>> - ECDHE-RSA-AES256-GCM-SHA384
>> - ECDHE-ECDSA-AES256-GCM-SHA384
>> - DHE-DSS-AES256-GCM-SHA384
>> - DHE-RSA-AES256-GCM-SHA384
>> - GOST2012256-GOST89-GOST89
>> - GOST2001-GOST89-GOST89
>> - ECDHE-RSA-AES128-GCM-SHA256
>> - ECDHE-ECDSA-AES128-GCM-SHA256
>> - DHE-DSS-AES128-GCM-SHA256
>> - DHE-RSA-AES128-GCM-SHA256
>> - EDH-RSA-DES-CBC3-SHA
>> - EDH-DSS-DES-CBC3-SHA
>> - EDH-RSA-DES-CBC-SHA
>> - EDH-DSS-DES-CBC-SHA
>>
>> * openssl/install/1.0.2d/bin/openssl:
>> - ECDHE-RSA-AES256-GCM-SHA384
>> - ECDHE-ECDSA-AES256-GCM-SHA384
>> - DHE-DSS-AES256-GCM-SHA384
>> - DHE-RSA-AES256-GCM-SHA384
>> - ECDHE-RSA-AES128-GCM-SHA256
>> - ECDHE-ECDSA-AES128-GCM-SHA256
>> - DHE-DSS-AES128-GCM-SHA256
>> - DHE-RSA-AES128-GCM-SHA256
>> - EDH-RSA-DES-CBC3-SHA
>> - EDH-DSS-DES-CBC3-SHA
>> - EDH-RSA-DES-CBC-SHA
>> - EDH-DSS-DES-CBC-SHA
>> - EXP-EDH-RSA-DES-CBC-SHA
>> - EXP-EDH-DSS-DES-CBC-SHA
>>
>> So 'TLSv1.2:!kRSA:!aECDH:!DH' is a bit too restrictive
>
> Looks like 'ALL:!SSLv3:!kRSA:!ADH:!aECDH' matches pretty well
> (excluding for the undesirable ones above).

From dev-return-84319-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Fri Oct 16 13:37:04 2015
Return-Path: <dev-return-84319-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 74FB717541
	for <apmail-httpd-dev-archive@www.apache.org>; Fri, 16 Oct 2015 13:37:04 +0000 (UTC)
Received: (qmail 1804 invoked by uid 500); 16 Oct 2015 13:37:04 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 1741 invoked by uid 500); 16 Oct 2015 13:37:03 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 1729 invoked by uid 99); 16 Oct 2015 13:37:03 -0000
Received: from Unknown (HELO spamd2-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 16 Oct 2015 13:37:03 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd2-us-west.apache.org (ASF Mail Server at spamd2-us-west.apache.org) with ESMTP id 87C981A2B94
	for <dev@httpd.apache.org>; Fri, 16 Oct 2015 13:37:03 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd2-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.102
X-Spam-Level:
X-Spam-Status: No, score=-0.102 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RCVD_IN_MSPIKE_H2=-0.001, SPF_PASS=-0.001] autolearn=disabled
Authentication-Results: spamd2-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd2-us-west.apache.org [10.40.0.9]) (amavisd-new, port 10024)
	with ESMTP id c-q3TmWv0Y4B for <dev@httpd.apache.org>;
	Fri, 16 Oct 2015 13:37:03 +0000 (UTC)
Received: from mail-ig0-f171.google.com (mail-ig0-f171.google.com [209.85.213.171])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id DCAF8429AA
	for <dev@httpd.apache.org>; Fri, 16 Oct 2015 13:37:02 +0000 (UTC)
Received: by igdg1 with SMTP id g1so849301igd.1
        for <dev@httpd.apache.org>; Fri, 16 Oct 2015 06:37:02 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        bh=cD7R39/wyQnzsP6l/Rby7z5QwpbXdbXNlaeIEXtC4qc=;
        b=hARMpcIO7mYB0oy0TGXW0UaQsbQSmdrA4hhBgianG3y6HzTg5o9bj7KINsqLAKYe3+
         AE/GldpmdVaifKdX2SwXLdXXL67r2T6zmmbJV4b5wCtoLDCeP5Xf6csa55pG1F0esJIe
         xnlWfzojiLAibqrY4mqgymdWUDkvI742/HEybGlS82WJrO626g2h3NJ9X3TxGDaUeQvE
         j2cWI+LUfAQvhLZl455BHqPBoPslTHrXfYQbpKqVz+7fdmD2dsyCZUxOuUrqTVBLaCpu
         Ex/9CJgsfC9Aul2KWfQAKfDEzZOF8LAXQcZQoFRumQNDUu5t33gqWEfy82i+EoR6rBGb
         fxpQ==
MIME-Version: 1.0
X-Received: by 10.50.66.170 with SMTP id g10mr5093835igt.36.1445002622552;
 Fri, 16 Oct 2015 06:37:02 -0700 (PDT)
Received: by 10.64.25.3 with HTTP; Fri, 16 Oct 2015 06:37:02 -0700 (PDT)
In-Reply-To: <CAOhm=5qPYuXD+BpbZZhcOa=_J_3hdid6s4w0=HaZCPy3as+GVw@mail.gmail.com>
References: <CAKQ1sVNx3g2PjkxG6z2LwqA6CuJeVv2L6SryVsMWp2SydoKFjQ@mail.gmail.com>
	<CAKQ1sVObJbAiRHdKHpU9veo8UtUqHXJ+L=PbcbWWd4Poo4TmGg@mail.gmail.com>
	<CAKQ1sVOMCg6wYD_xpxgWuPiyR=o6HSDKjdBj34v4KPn1Ns+SGw@mail.gmail.com>
	<CAOhm=5qPYuXD+BpbZZhcOa=_J_3hdid6s4w0=HaZCPy3as+GVw@mail.gmail.com>
Date: Fri, 16 Oct 2015 09:37:02 -0400
Message-ID: <CALK=YjNMv2PWLjO3-4T2H__qZgFz9XqBUJN6u6Ztq_ZGs5M6TA@mail.gmail.com>
Subject: Re: H2 compatible ciphers (was: svn commit: r1708593)
From: Eric Covener <covener@gmail.com>
To: Apache HTTP Server Development List <dev@httpd.apache.org>
Content-Type: text/plain; charset=UTF-8

On Fri, Oct 16, 2015 at 9:28 AM, Chris <chrcoluk@gmail.com> wrote:
> interesting that chrome is happily using h2 on my domain that I
> activated for h2 earlier and I have a couple of banned ciphers in
> mod_ssl.


unbanned ones listed earlier, or no SSLHonorCipherOrder?

From dev-return-84320-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Fri Oct 16 13:41:40 2015
Return-Path: <dev-return-84320-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id C35BA175A2
	for <apmail-httpd-dev-archive@www.apache.org>; Fri, 16 Oct 2015 13:41:40 +0000 (UTC)
Received: (qmail 18427 invoked by uid 500); 16 Oct 2015 13:41:39 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 18354 invoked by uid 500); 16 Oct 2015 13:41:39 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 18344 invoked by uid 99); 16 Oct 2015 13:41:39 -0000
Received: from Unknown (HELO spamd4-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 16 Oct 2015 13:41:39 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd4-us-west.apache.org (ASF Mail Server at spamd4-us-west.apache.org) with ESMTP id 40603C0BE5
	for <dev@httpd.apache.org>; Fri, 16 Oct 2015 13:41:39 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd4-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 0.689
X-Spam-Level:
X-Spam-Status: No, score=0.689 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RCVD_IN_MSPIKE_H2=-0.001, SPF_PASS=-0.001, UPPERCASE_50_75=0.791]
	autolearn=disabled
Authentication-Results: spamd4-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd4-us-west.apache.org [10.40.0.11]) (amavisd-new, port 10024)
	with ESMTP id LNH5AlXDBmLg for <dev@httpd.apache.org>;
	Fri, 16 Oct 2015 13:41:38 +0000 (UTC)
Received: from mail-qg0-f49.google.com (mail-qg0-f49.google.com [209.85.192.49])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id 3DC1124D0D
	for <dev@httpd.apache.org>; Fri, 16 Oct 2015 13:41:37 +0000 (UTC)
Received: by qgez77 with SMTP id z77so99645897qge.1
        for <dev@httpd.apache.org>; Fri, 16 Oct 2015 06:41:36 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        bh=UAMmZc1eOIOtxPLUBGa7cxFpWcAAvp69b9VUqp4VY/w=;
        b=KCCprKsfEH7NdRbIf/el9zZMcMXn4muBMRazjQKDm7a/OqFvWTomzBN9KuvavmTAWQ
         y0i0q/OWZi2XdcW3ww/5GlbFNIsvVCwdofQCIrbUTpFS7iAK2OH/lmUy0kxiqMLIG5u9
         CgNsJ/XRQncdQY1DoAEquz9X6ggM0hi1Z4XtemTBSSrrJ+mYQeaEsW95nYcm01QA1Fim
         BhzVZyQKGcsJvBsPQXzkneAGQfev33etDxYUX5JN4mcckbKZT+oyF5fBRXSgIeCBXsHy
         8FSIZUru1i1STEB/izAC50VF19+C1EGncVKjoqJzhX3Z09vqARFGSTlwjvGoNdKJb5wO
         jVkA==
MIME-Version: 1.0
X-Received: by 10.140.131.198 with SMTP id 189mr20282795qhd.83.1445002896323;
 Fri, 16 Oct 2015 06:41:36 -0700 (PDT)
Received: by 10.55.156.213 with HTTP; Fri, 16 Oct 2015 06:41:36 -0700 (PDT)
In-Reply-To: <CAKQ1sVOMCg6wYD_xpxgWuPiyR=o6HSDKjdBj34v4KPn1Ns+SGw@mail.gmail.com>
References: <CAKQ1sVNx3g2PjkxG6z2LwqA6CuJeVv2L6SryVsMWp2SydoKFjQ@mail.gmail.com>
	<CAKQ1sVObJbAiRHdKHpU9veo8UtUqHXJ+L=PbcbWWd4Poo4TmGg@mail.gmail.com>
	<CAKQ1sVOMCg6wYD_xpxgWuPiyR=o6HSDKjdBj34v4KPn1Ns+SGw@mail.gmail.com>
Date: Fri, 16 Oct 2015 15:41:36 +0200
Message-ID: <CAKQ1sVNup6Y5_nFqEJnZs6KXsVBVqosw=LnYSHOcsL5UK1wqXQ@mail.gmail.com>
Subject: Re: H2 compatible ciphers (was: svn commit: r1708593)
From: Yann Ylavic <ylavic.dev@gmail.com>
To: dev@httpd.apache.org
Content-Type: text/plain; charset=UTF-8

On Fri, Oct 16, 2015 at 2:33 PM, Yann Ylavic <ylavic.dev@gmail.com> wrote:
> On Fri, Oct 16, 2015 at 1:38 PM, Yann Ylavic <ylavic.dev@gmail.com> wrote:
>>
>> Actually I tried some brute bash script (attached) to show what
>> remains compared to "openssl ciphers ALL", and the result is:
>>
>> * libressl/install/2.2.1/bin/openssl:
>> - ECDHE-ECDSA-CHACHA20-POLY1305
>> - ECDHE-RSA-CHACHA20-POLY1305
>> - DHE-RSA-CHACHA20-POLY1305
>> - ECDHE-RSA-AES256-GCM-SHA384
>> - ECDHE-ECDSA-AES256-GCM-SHA384
>> - DHE-DSS-AES256-GCM-SHA384
>> - DHE-RSA-AES256-GCM-SHA384
>> - GOST2012256-GOST89-GOST89
>> - GOST2001-GOST89-GOST89
>> - ECDHE-RSA-AES128-GCM-SHA256
>> - ECDHE-ECDSA-AES128-GCM-SHA256
>> - DHE-DSS-AES128-GCM-SHA256
>> - DHE-RSA-AES128-GCM-SHA256
>> - EDH-RSA-DES-CBC3-SHA
>> - EDH-DSS-DES-CBC3-SHA
>> - EDH-RSA-DES-CBC-SHA
>> - EDH-DSS-DES-CBC-SHA
>>
>> * openssl/install/1.0.2d/bin/openssl:
>> - ECDHE-RSA-AES256-GCM-SHA384
>> - ECDHE-ECDSA-AES256-GCM-SHA384
>> - DHE-DSS-AES256-GCM-SHA384
>> - DHE-RSA-AES256-GCM-SHA384
>> - ECDHE-RSA-AES128-GCM-SHA256
>> - ECDHE-ECDSA-AES128-GCM-SHA256
>> - DHE-DSS-AES128-GCM-SHA256
>> - DHE-RSA-AES128-GCM-SHA256
>> - EDH-RSA-DES-CBC3-SHA
>> - EDH-DSS-DES-CBC3-SHA
>> - EDH-RSA-DES-CBC-SHA
>> - EDH-DSS-DES-CBC-SHA
>> - EXP-EDH-RSA-DES-CBC-SHA
>> - EXP-EDH-DSS-DES-CBC-SHA
>>
>> So 'TLSv1.2:!kRSA:!aECDH:!DH' is a bit too restrictive
>
> Looks like 'ALL:!SSLv3:!kRSA:!ADH:!aECDH' matches pretty well
> (excluding for the undesirable ones above).

Actually there is a typo above (!ADH => !aDH), so the correct suite
would be: 'ALL:!SSLv3:!kRSA:!aDH:!aECDH'.
This assumes aNULL is added by default (which http does in its latest
versions, along with eNULL), otherwise the full openssl command would
be:

$ openssl ciphers -v 'ALL:!SSLv3:!kRSA:!aDH:!aECDH:!aNULL'

which gives,

* libressl/install/2.2.1/bin/openssl:
ECDHE-ECDSA-CHACHA20-POLY1305 TLSv1.2 Kx=ECDH     Au=ECDSA
Enc=ChaCha20-Poly1305 Mac=AEAD
ECDHE-RSA-CHACHA20-POLY1305 TLSv1.2 Kx=ECDH     Au=RSA
Enc=ChaCha20-Poly1305 Mac=AEAD
DHE-RSA-CHACHA20-POLY1305 TLSv1.2 Kx=DH       Au=RSA
Enc=ChaCha20-Poly1305 Mac=AEAD
ECDHE-RSA-AES256-GCM-SHA384 TLSv1.2 Kx=ECDH     Au=RSA  Enc=AESGCM(256) Mac=AEAD
ECDHE-ECDSA-AES256-GCM-SHA384 TLSv1.2 Kx=ECDH     Au=ECDSA
Enc=AESGCM(256) Mac=AEAD
ECDHE-RSA-AES256-SHA384 TLSv1.2 Kx=ECDH     Au=RSA  Enc=AES(256)  Mac=SHA384
ECDHE-ECDSA-AES256-SHA384 TLSv1.2 Kx=ECDH     Au=ECDSA Enc=AES(256)  Mac=SHA384
DHE-DSS-AES256-GCM-SHA384 TLSv1.2 Kx=DH       Au=DSS  Enc=AESGCM(256) Mac=AEAD
DHE-RSA-AES256-GCM-SHA384 TLSv1.2 Kx=DH       Au=RSA  Enc=AESGCM(256) Mac=AEAD
DHE-RSA-AES256-SHA256   TLSv1.2 Kx=DH       Au=RSA  Enc=AES(256)  Mac=SHA256
DHE-DSS-AES256-SHA256   TLSv1.2 Kx=DH       Au=DSS  Enc=AES(256)  Mac=SHA256
DHE-RSA-CAMELLIA256-SHA256 TLSv1.2 Kx=DH       Au=RSA
Enc=Camellia(256) Mac=SHA256
DHE-DSS-CAMELLIA256-SHA256 TLSv1.2 Kx=DH       Au=DSS
Enc=Camellia(256) Mac=SHA256
ECDHE-RSA-AES128-GCM-SHA256 TLSv1.2 Kx=ECDH     Au=RSA  Enc=AESGCM(128) Mac=AEAD
ECDHE-ECDSA-AES128-GCM-SHA256 TLSv1.2 Kx=ECDH     Au=ECDSA
Enc=AESGCM(128) Mac=AEAD
ECDHE-RSA-AES128-SHA256 TLSv1.2 Kx=ECDH     Au=RSA  Enc=AES(128)  Mac=SHA256
ECDHE-ECDSA-AES128-SHA256 TLSv1.2 Kx=ECDH     Au=ECDSA Enc=AES(128)  Mac=SHA256
DHE-DSS-AES128-GCM-SHA256 TLSv1.2 Kx=DH       Au=DSS  Enc=AESGCM(128) Mac=AEAD
DHE-RSA-AES128-GCM-SHA256 TLSv1.2 Kx=DH       Au=RSA  Enc=AESGCM(128) Mac=AEAD
DHE-RSA-AES128-SHA256   TLSv1.2 Kx=DH       Au=RSA  Enc=AES(128)  Mac=SHA256
DHE-DSS-AES128-SHA256   TLSv1.2 Kx=DH       Au=DSS  Enc=AES(128)  Mac=SHA256
DHE-RSA-CAMELLIA128-SHA256 TLSv1.2 Kx=DH       Au=RSA
Enc=Camellia(128) Mac=SHA256
DHE-DSS-CAMELLIA128-SHA256 TLSv1.2 Kx=DH       Au=DSS
Enc=Camellia(128) Mac=SHA256

* openssl/install/1.0.2d/bin/openssl:
ECDHE-RSA-AES256-GCM-SHA384 TLSv1.2 Kx=ECDH     Au=RSA  Enc=AESGCM(256) Mac=AEAD
ECDHE-ECDSA-AES256-GCM-SHA384 TLSv1.2 Kx=ECDH     Au=ECDSA
Enc=AESGCM(256) Mac=AEAD
ECDHE-RSA-AES256-SHA384 TLSv1.2 Kx=ECDH     Au=RSA  Enc=AES(256)  Mac=SHA384
ECDHE-ECDSA-AES256-SHA384 TLSv1.2 Kx=ECDH     Au=ECDSA Enc=AES(256)  Mac=SHA384
DHE-DSS-AES256-GCM-SHA384 TLSv1.2 Kx=DH       Au=DSS  Enc=AESGCM(256) Mac=AEAD
DHE-RSA-AES256-GCM-SHA384 TLSv1.2 Kx=DH       Au=RSA  Enc=AESGCM(256) Mac=AEAD
DHE-RSA-AES256-SHA256   TLSv1.2 Kx=DH       Au=RSA  Enc=AES(256)  Mac=SHA256
DHE-DSS-AES256-SHA256   TLSv1.2 Kx=DH       Au=DSS  Enc=AES(256)  Mac=SHA256
ECDHE-RSA-AES128-GCM-SHA256 TLSv1.2 Kx=ECDH     Au=RSA  Enc=AESGCM(128) Mac=AEAD
ECDHE-ECDSA-AES128-GCM-SHA256 TLSv1.2 Kx=ECDH     Au=ECDSA
Enc=AESGCM(128) Mac=AEAD
ECDHE-RSA-AES128-SHA256 TLSv1.2 Kx=ECDH     Au=RSA  Enc=AES(128)  Mac=SHA256
ECDHE-ECDSA-AES128-SHA256 TLSv1.2 Kx=ECDH     Au=ECDSA Enc=AES(128)  Mac=SHA256
DHE-DSS-AES128-GCM-SHA256 TLSv1.2 Kx=DH       Au=DSS  Enc=AESGCM(128) Mac=AEAD
DHE-RSA-AES128-GCM-SHA256 TLSv1.2 Kx=DH       Au=RSA  Enc=AESGCM(128) Mac=AEAD
DHE-RSA-AES128-SHA256   TLSv1.2 Kx=DH       Au=RSA  Enc=AES(128)  Mac=SHA256
DHE-DSS-AES128-SHA256   TLSv1.2 Kx=DH       Au=DSS  Enc=AES(128)  Mac=SHA256

From dev-return-84321-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Fri Oct 16 13:49:56 2015
Return-Path: <dev-return-84321-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id D7B8E17623
	for <apmail-httpd-dev-archive@www.apache.org>; Fri, 16 Oct 2015 13:49:55 +0000 (UTC)
Received: (qmail 45529 invoked by uid 500); 16 Oct 2015 13:49:55 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 45456 invoked by uid 500); 16 Oct 2015 13:49:55 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 45441 invoked by uid 99); 16 Oct 2015 13:49:54 -0000
Received: from Unknown (HELO spamd1-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 16 Oct 2015 13:49:54 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd1-us-west.apache.org (ASF Mail Server at spamd1-us-west.apache.org) with ESMTP id 8C3DAC1354
	for <dev@httpd.apache.org>; Fri, 16 Oct 2015 13:49:54 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd1-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.01
X-Spam-Level:
X-Spam-Status: No, score=-0.01 tagged_above=-999 required=6.31
	tests=[T_RP_MATCHES_RCVD=-0.01] autolearn=disabled
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd1-us-west.apache.org [10.40.0.7]) (amavisd-new, port 10024)
	with ESMTP id 18gMGEe1Uazv for <dev@httpd.apache.org>;
	Fri, 16 Oct 2015 13:49:50 +0000 (UTC)
Received: from mail.netnea.com (gstserv.netnea.com [213.200.225.210])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id D539F439BB
	for <dev@httpd.apache.org>; Fri, 16 Oct 2015 13:49:49 +0000 (UTC)
Received: from localhost (localhost [127.0.0.1])
	by mail.netnea.com (Postfix) with ESMTP id BE5354005C
	for <dev@httpd.apache.org>; Fri, 16 Oct 2015 15:49:41 +0200 (CEST)
X-Virus-Scanned: Debian amavisd-new at neanet.com
Received: from mail.netnea.com ([127.0.0.1])
	by localhost (x28.netnea.com [127.0.0.1]) (amavisd-new, port 10024)
	with ESMTP id BYU5UK8NfeYS for <dev@httpd.apache.org>;
	Fri, 16 Oct 2015 15:49:41 +0200 (CEST)
Received: from elias (unknown [93.94.243.179])
	(using TLSv1.2 with cipher ECDHE-RSA-AES256-GCM-SHA384 (256/256 bits))
	(Client did not present a certificate)
	by mail.netnea.com (Postfix) with ESMTPSA id A14134005A
	for <dev@httpd.apache.org>; Fri, 16 Oct 2015 15:49:41 +0200 (CEST)
Received: by elias (Postfix, from userid 1000)
	id 492A76407AA; Fri, 16 Oct 2015 15:49:41 +0200 (CEST)
Date: Fri, 16 Oct 2015 15:49:41 +0200
From: Christian Folini <christian.folini@netnea.com>
To: dev@httpd.apache.org
Subject: Re: "httpd -X" segfaults with 2.4.17
Message-ID: <20151016134941.GA7661@elias>
References: <5620E659.9070309@redhat.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Disposition: inline
Content-Transfer-Encoding: 8bit
In-Reply-To: <5620E659.9070309@redhat.com>
User-Agent: Mutt/1.5.21 (2010-09-15)

On Fri, Oct 16, 2015 at 01:58:17PM +0200, Jan Kaluža wrote:
> httpd 2.4.17 segfaults when used with prefork MPM (and probably also
> with other MPMs) and -X option since r1705492.
> 
> The crash happens in the following call in prefork.c (and probably
> also worker.c and so on):

Works fine here with event. At least so far.

Ahoj,

Christian Folini


-- 
The test of every religious, political, or educational system is the 
man which it forms.
-- Henri-Frédéric Amiel

From dev-return-84322-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Fri Oct 16 14:01:13 2015
Return-Path: <dev-return-84322-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 0DC9A176D3
	for <apmail-httpd-dev-archive@www.apache.org>; Fri, 16 Oct 2015 14:01:13 +0000 (UTC)
Received: (qmail 81846 invoked by uid 500); 16 Oct 2015 14:01:12 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 81767 invoked by uid 500); 16 Oct 2015 14:01:12 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 81757 invoked by uid 99); 16 Oct 2015 14:01:12 -0000
Received: from Unknown (HELO spamd2-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 16 Oct 2015 14:01:12 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd2-us-west.apache.org (ASF Mail Server at spamd2-us-west.apache.org) with ESMTP id 079101A2B9B
	for <dev@httpd.apache.org>; Fri, 16 Oct 2015 14:01:12 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd2-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.101
X-Spam-Level:
X-Spam-Status: No, score=-0.101 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RCVD_IN_MSPIKE_H2=-0.001, SPF_PASS=-0.001, URIBL_BLOCKED=0.001]
	autolearn=disabled
Authentication-Results: spamd2-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd2-us-west.apache.org [10.40.0.9]) (amavisd-new, port 10024)
	with ESMTP id 9d6J5U8N4zHv for <dev@httpd.apache.org>;
	Fri, 16 Oct 2015 14:01:11 +0000 (UTC)
Received: from mail-qg0-f41.google.com (mail-qg0-f41.google.com [209.85.192.41])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id 2203E21277
	for <dev@httpd.apache.org>; Fri, 16 Oct 2015 14:01:10 +0000 (UTC)
Received: by qgt47 with SMTP id 47so99881522qgt.2
        for <dev@httpd.apache.org>; Fri, 16 Oct 2015 07:01:09 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        bh=d1swqNfRGGAGMdar3Ucegy79TwMLIvUEddOTYRKEpKY=;
        b=RmgRgQtrJdLWn0fpT26McV6Fxf1/J4z1TNYMwh+vNL8lpjiUBTDxvSkbm7K0YI1LPL
         oh1Pn0ab4qxYouBXXBBvm4SsHMTKhc05Es0t4kTDfiLXGvrvri02HBaJx59L2zk2lLFf
         ILxlYnefprgKyz+yGWJuxfOg9k+dhJixBBEVi308aiVPpD+1IXqCVEFrhTdIhZV1a6Yu
         viQy+ARyBoeXOSA/ngfmlgk7w8rwkIW61SktM6kwbOyS6ANSsXBC6fVrYcbMnwSYmUym
         q2D1pBAH+p3lH2qfDVlir3BBC9xrn/TNenrxE2JjimzcuslL6uQGBUZ6OK1cWu8iGRXy
         bwZQ==
MIME-Version: 1.0
X-Received: by 10.140.43.183 with SMTP id e52mr11621375qga.38.1445004069198;
 Fri, 16 Oct 2015 07:01:09 -0700 (PDT)
Received: by 10.55.156.213 with HTTP; Fri, 16 Oct 2015 07:01:09 -0700 (PDT)
In-Reply-To: <CAKQ1sVO4BZk2_hkgj6jQS+3b8eR-jSLUtC96QAYDXGLMxS=qwA@mail.gmail.com>
References: <CALK=YjMWSTLMzr=5nKws8M8=CkrhqQJ8S1xCgyQycms-V1pNDQ@mail.gmail.com>
	<CAKQ1sVP6HPyQj4Tq-47DQ27tbCTRk+005UoAnxmgL7xdWW6+_A@mail.gmail.com>
	<CAKQ1sVO5=kaZitCpQ0Vuqx8E+nj69cv5+pEuzDo1_jhMZRB4Cg@mail.gmail.com>
	<5620EF0E.7000109@kippdata.de>
	<CAKQ1sVMCcJ4nvhiibJe_edW06A8Spvt=8m5PxnQ-FdGhX=H+dA@mail.gmail.com>
	<CAKQ1sVMF1e4NCemsZRCGcU-eQOU6v1=+DHu08S3o0BFujmNnEg@mail.gmail.com>
	<5620F6D4.2000204@kippdata.de>
	<CAKQ1sVO4BZk2_hkgj6jQS+3b8eR-jSLUtC96QAYDXGLMxS=qwA@mail.gmail.com>
Date: Fri, 16 Oct 2015 16:01:09 +0200
Message-ID: <CAKQ1sVNMWo9b0RgMp-C1_dw8pbkAdbo6fqFcD0ojMPtHg1siug@mail.gmail.com>
Subject: Re: 2.4.17 alignment issue sparc/ia64
From: Yann Ylavic <ylavic.dev@gmail.com>
To: dev@httpd.apache.org
Content-Type: text/plain; charset=UTF-8

On Fri, Oct 16, 2015 at 3:16 PM, Yann Ylavic <ylavic.dev@gmail.com> wrote:
> On Fri, Oct 16, 2015 at 3:08 PM, Rainer Jung <rainer.jung@kippdata.de> wrote:
>>
>> Wasn't the bus error occuring in
>>
>> ws->last_used = apr_time_now();
>>
>> and the address is
>>
>> (dbx) print &(ws->last_used)
>> &ws->last_used = 0xffffffff7bb00094
>>
>> not divisible by 8 although the data type (not pointer size) is 64 Bit.
>
> Yes but ws itself isn't aligned either:
>     (dbx) print ws
>     ws = 0xffffffff7bb00044
> which is IMHO the issue.
>
> Align ws and everything goes well (at least I think :p ).

Hm (again), you may be right.
On sparc32 still, the compiler would do the alignment correctly for
the allocated struct if it contained a 64 bit type (forcing an 8 bytes
alignment), but we are not using malloc() here.
Since we assign the address by ourselves but don't (can't) know
whether it contains a 64bit type, we must align on 8 bytes boundary,
otherwise things like:
    struct s {
        apr_int64_t i64;
        ...
    };
could fault when s->i64 is used.

That's probably why APR_ALIGN_DEFAULT(1) is always 8 which is the
largest integral type handle by the APR.
Thanks for the remainder!

From dev-return-84323-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Fri Oct 16 14:02:47 2015
Return-Path: <dev-return-84323-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 09438176DE
	for <apmail-httpd-dev-archive@www.apache.org>; Fri, 16 Oct 2015 14:02:47 +0000 (UTC)
Received: (qmail 84297 invoked by uid 500); 16 Oct 2015 14:02:46 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 84229 invoked by uid 500); 16 Oct 2015 14:02:46 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 84219 invoked by uid 99); 16 Oct 2015 14:02:46 -0000
Received: from Unknown (HELO spamd4-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 16 Oct 2015 14:02:46 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd4-us-west.apache.org (ASF Mail Server at spamd4-us-west.apache.org) with ESMTP id 23AC7C0DCD
	for <dev@httpd.apache.org>; Fri, 16 Oct 2015 14:02:46 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd4-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 0
X-Spam-Level:
X-Spam-Status: No, score=0 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1] autolearn=disabled
Authentication-Results: spamd4-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=comcast.net
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd4-us-west.apache.org [10.40.0.11]) (amavisd-new, port 10024)
	with ESMTP id CgmUGkqeFs2c for <dev@httpd.apache.org>;
	Fri, 16 Oct 2015 14:02:31 +0000 (UTC)
Received: from resqmta-ch2-12v.sys.comcast.net (resqmta-ch2-12v.sys.comcast.net [69.252.207.44])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id 2CBD32139D
	for <dev@httpd.apache.org>; Fri, 16 Oct 2015 14:02:31 +0000 (UTC)
Received: from resomta-ch2-06v.sys.comcast.net ([69.252.207.102])
	by resqmta-ch2-12v.sys.comcast.net with comcast
	id Vq1a1r0042D5gil01q2PEo; Fri, 16 Oct 2015 14:02:23 +0000
Received: from [192.168.199.10] ([69.251.84.114])
	by resomta-ch2-06v.sys.comcast.net with comcast
	id Vq2N1r00R2U0RYt01q2N9j; Fri, 16 Oct 2015 14:02:23 +0000
Content-Type: text/plain; charset=us-ascii
Mime-Version: 1.0 (Mac OS X Mail 8.2 \(2104\))
Subject: Re: 2.4.17 alignment issue sparc/ia64
From: Jim Jagielski <jim@jaguNET.com>
In-Reply-To: <CAKQ1sVO4BZk2_hkgj6jQS+3b8eR-jSLUtC96QAYDXGLMxS=qwA@mail.gmail.com>
Date: Fri, 16 Oct 2015 10:02:22 -0400
Content-Transfer-Encoding: 7bit
Message-Id: <185E2C4C-E341-4F7D-8DA3-A0F2D5B1FAEA@jaguNET.com>
References: <CALK=YjMWSTLMzr=5nKws8M8=CkrhqQJ8S1xCgyQycms-V1pNDQ@mail.gmail.com> <CAKQ1sVP6HPyQj4Tq-47DQ27tbCTRk+005UoAnxmgL7xdWW6+_A@mail.gmail.com> <CAKQ1sVO5=kaZitCpQ0Vuqx8E+nj69cv5+pEuzDo1_jhMZRB4Cg@mail.gmail.com> <5620EF0E.7000109@kippdata.de> <CAKQ1sVMCcJ4nvhiibJe_edW06A8Spvt=8m5PxnQ-FdGhX=H+dA@mail.gmail.com> <CAKQ1sVMF1e4NCemsZRCGcU-eQOU6v1=+DHu08S3o0BFujmNnEg@mail.gmail.com> <5620F6D4.2000204@kippdata.de> <CAKQ1sVO4BZk2_hkgj6jQS+3b8eR-jSLUtC96QAYDXGLMxS=qwA@mail.gmail.com>
To: dev@httpd.apache.org
X-Mailer: Apple Mail (2.2104)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=comcast.net;
	s=q20140121; t=1445004143;
	bh=GQCNZ2Uf4qTNqirhQobKJTfeeWLn3RifBt0CyGmqe5A=;
	h=Received:Received:Content-Type:Mime-Version:Subject:From:Date:
	 Message-Id:To;
	b=bV4oyr1+qW9OEkrsLzPLIGq/wwAzH6dcW4Az/Pmpw+CQrGzQGhez2WOdrUuYrIO7C
	 Og5MPCdi1maq0mZo+QmxBtKrKFkSbiJDE/uLqn25xUTN1Ux9MeqNgnuctqBQKXWMYv
	 MyA9pVVvV+oFYbfjk1k9dtmIBSHK5yd5Sg7mI7/BHlaaG/RqlSsR5ZxVfZM6T/QN+E
	 r1BJ/77IV54dFFiOQXWtWmm4TkLwbe18y81qRB2aDB21H6H9WG0eKdDMQw+Xy30v6i
	 h7GPzuS+MPjQ4ghKZw9vViuXcEo14KjkWm9tG6QrKB5ggqzJcJpfelX0VakOc5JAsN
	 nH0WhQC1yeM0w==

> 
> Yes but ws itself isn't aligned either:
>    (dbx) print ws
>    ws = 0xffffffff7bb00044
> which is IMHO the issue.
> 
> Align ws and everything goes well (at least I think :p ).
> 

It better! :)


From dev-return-84324-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Fri Oct 16 14:16:59 2015
Return-Path: <dev-return-84324-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id BD02D177AE
	for <apmail-httpd-dev-archive@www.apache.org>; Fri, 16 Oct 2015 14:16:59 +0000 (UTC)
Received: (qmail 29021 invoked by uid 500); 16 Oct 2015 14:16:58 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 28952 invoked by uid 500); 16 Oct 2015 14:16:58 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 28942 invoked by uid 99); 16 Oct 2015 14:16:58 -0000
Received: from Unknown (HELO spamd3-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 16 Oct 2015 14:16:58 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd3-us-west.apache.org (ASF Mail Server at spamd3-us-west.apache.org) with ESMTP id CAEF3180E8F
	for <dev@httpd.apache.org>; Fri, 16 Oct 2015 14:16:57 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd3-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.121
X-Spam-Level:
X-Spam-Status: No, score=-0.121 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RCVD_IN_MSPIKE_H3=-0.01, RCVD_IN_MSPIKE_WL=-0.01, SPF_PASS=-0.001]
	autolearn=disabled
Authentication-Results: spamd3-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-us-west.apache.org ([10.40.0.8])
	by localhost (spamd3-us-west.apache.org [10.40.0.10]) (amavisd-new, port 10024)
	with ESMTP id JTFTzh8wWwsq for <dev@httpd.apache.org>;
	Fri, 16 Oct 2015 14:16:57 +0000 (UTC)
Received: from mail-ig0-f177.google.com (mail-ig0-f177.google.com [209.85.213.177])
	by mx1-us-west.apache.org (ASF Mail Server at mx1-us-west.apache.org) with ESMTPS id 42E5723031
	for <dev@httpd.apache.org>; Fri, 16 Oct 2015 14:16:57 +0000 (UTC)
Received: by igbkq10 with SMTP id kq10so14731291igb.0
        for <dev@httpd.apache.org>; Fri, 16 Oct 2015 07:16:56 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        bh=dr/dhbZxdFVq3ARC2E6cg2Owhm9bJLO4qZhkc+xOTyk=;
        b=h8HX6pmerd0nQqYAHUZg/KmrPjfU8gN9yKEpYL8oJEhgR78EcvBWT5iIZ2hNAjmvqm
         jw/OHAZkwYQtaXjBSPjZ+/dlvxjomXMAgCZf7TlAt9wdNN3uXWul5PwCunB0xOvDg1Tr
         J2QcolaIvw9zWzbZU61YLqlKNwoGXi2n9zETP/tSxoTm5rIVVZyzRvacUQVWICfM9hgQ
         ALWWCyibsp1yY3wGoUwN0l8QOW0fxLCrILN88bX9GrPRSq9kEaU0KEekV5WpVzP3Z2C/
         WTdmCDW9rjui574RRUu6pV4Ix6mDamD9dA0YZZGKm0v/ByEGaMu9M34pXZyX0gmNIRWK
         Ua2A==
MIME-Version: 1.0
X-Received: by 10.50.59.210 with SMTP id b18mr5537850igr.72.1445005016740;
 Fri, 16 Oct 2015 07:16:56 -0700 (PDT)
Received: by 10.64.25.3 with HTTP; Fri, 16 Oct 2015 07:16:56 -0700 (PDT)
In-Reply-To: <CAKQ1sVP6HPyQj4Tq-47DQ27tbCTRk+005UoAnxmgL7xdWW6+_A@mail.gmail.com>
References: <CALK=YjMWSTLMzr=5nKws8M8=CkrhqQJ8S1xCgyQycms-V1pNDQ@mail.gmail.com>
	<CAKQ1sVP6HPyQj4Tq-47DQ27tbCTRk+005UoAnxmgL7xdWW6+_A@mail.gmail.com>
Date: Fri, 16 Oct 2015 10:16:56 -0400
Message-ID: <CALK=YjM3d-tV5SvSZ6jY3d=xVeRSos1gt1GdOKUvM5K-TiHg4Q@mail.gmail.com>
Subject: Re: 2.4.17 alignment issue sparc/ia64
From: Eric Covener <covener@gmail.com>
To: Apache HTTP Server Development List <dev@httpd.apache.org>
Content-Type: text/plain; charset=UTF-8

On Fri, Oct 16, 2015 at 4:02 AM, Yann Ylavic <ylavic.dev@gmail.com> wrote:
> We should do something like the following patch:

Promising so far with my two one-off testcases, putting it through a
longer test now.

Thanks!

From dev-return-84325-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Fri Oct 16 14:20:43 2015
Return-Path: <dev-return-84325-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 4EE15177EA
	for <apmail-httpd-dev-archive@www.apache.org>; Fri, 16 Oct 2015 14:20:43 +0000 (UTC)
Received: (qmail 44963 invoked by uid 500); 16 Oct 2015 14:20:42 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 44890 invoked by uid 500); 16 Oct 2015 14:20:42 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 44880 invoked by uid 99); 16 Oct 2015 14:20:42 -0000
Received: from Unknown (HELO spamd4-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 16 Oct 2015 14:20:42 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd4-us-west.apache.org (ASF Mail Server at spamd4-us-west.apache.org) with ESMTP id 53BAEC0BE5
	for <dev@httpd.apache.org>; Fri, 16 Oct 2015 14:20:42 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd4-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.102
X-Spam-Level:
X-Spam-Status: No, score=-0.102 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RCVD_IN_MSPIKE_H2=-0.001, SPF_PASS=-0.001] autolearn=disabled
Authentication-Results: spamd4-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd4-us-west.apache.org [10.40.0.11]) (amavisd-new, port 10024)
	with ESMTP id xCYrItnE0PfM for <dev@httpd.apache.org>;
	Fri, 16 Oct 2015 14:20:41 +0000 (UTC)
Received: from mail-qg0-f47.google.com (mail-qg0-f47.google.com [209.85.192.47])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id EB7452054C
	for <dev@httpd.apache.org>; Fri, 16 Oct 2015 14:20:40 +0000 (UTC)
Received: by qgad10 with SMTP id d10so7743432qga.3
        for <dev@httpd.apache.org>; Fri, 16 Oct 2015 07:20:40 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        bh=PSWl1e1Q+QzJYUda98ECaUwd0BXl2tlHchmbXhZt5MM=;
        b=0omXUsPEB2aWVxCmNApM9Q9OdtkeFTs/hhGOn5ybd59hBkbs9vx3cwgsP172h6RceH
         Vs8L8JBUrAx4VjGnqti0yfEPZwcZ7nqgNX6g1cdXp1O1QYdpWmDoFLJ6jKTwt6/JtWgH
         W5ZC6/FZ4VKIscalqwiKoSOH3QNlWphJCGXuDVJ8HWiePZXgxVJ7EqQg/oxDAxiIRezE
         L9k+AuMSZVhsl9XH8u1vyQSS0aSmu4ui0ohRqKvl+i6oy51COd/WJ7CrvHk0TWFPd+iL
         +XY7Ax+av7RuI8aZ+vLxyT/5lcrAIXj40OIsXlU/jmWh/Unfwr0X08J/A3L5d8AcyUXJ
         ADtA==
MIME-Version: 1.0
X-Received: by 10.140.96.71 with SMTP id j65mr19148389qge.92.1445005240041;
 Fri, 16 Oct 2015 07:20:40 -0700 (PDT)
Received: by 10.55.156.213 with HTTP; Fri, 16 Oct 2015 07:20:39 -0700 (PDT)
In-Reply-To: <CALK=YjM3d-tV5SvSZ6jY3d=xVeRSos1gt1GdOKUvM5K-TiHg4Q@mail.gmail.com>
References: <CALK=YjMWSTLMzr=5nKws8M8=CkrhqQJ8S1xCgyQycms-V1pNDQ@mail.gmail.com>
	<CAKQ1sVP6HPyQj4Tq-47DQ27tbCTRk+005UoAnxmgL7xdWW6+_A@mail.gmail.com>
	<CALK=YjM3d-tV5SvSZ6jY3d=xVeRSos1gt1GdOKUvM5K-TiHg4Q@mail.gmail.com>
Date: Fri, 16 Oct 2015 16:20:39 +0200
Message-ID: <CAKQ1sVMJ-Sr+EzHGwwCtsauiE+-6-m+p5fOjRaV0w2ZAq4sVtg@mail.gmail.com>
Subject: Re: 2.4.17 alignment issue sparc/ia64
From: Yann Ylavic <ylavic.dev@gmail.com>
To: dev@httpd.apache.org
Content-Type: text/plain; charset=UTF-8

On Fri, Oct 16, 2015 at 4:16 PM, Eric Covener <covener@gmail.com> wrote:
> On Fri, Oct 16, 2015 at 4:02 AM, Yann Ylavic <ylavic.dev@gmail.com> wrote:
>> We should do something like the following patch:
>
> Promising so far with my two one-off testcases, putting it through a
> longer test now.

Committed in r1709008 (was afraid the discussion could have led to the
wrong one being tested...).
Will revert if it fails.

From dev-return-84326-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Fri Oct 16 14:22:36 2015
Return-Path: <dev-return-84326-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 8380C177FF
	for <apmail-httpd-dev-archive@www.apache.org>; Fri, 16 Oct 2015 14:22:36 +0000 (UTC)
Received: (qmail 51556 invoked by uid 500); 16 Oct 2015 14:22:36 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 51477 invoked by uid 500); 16 Oct 2015 14:22:36 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 51465 invoked by uid 99); 16 Oct 2015 14:22:36 -0000
Received: from Unknown (HELO spamd4-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 16 Oct 2015 14:22:36 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd4-us-west.apache.org (ASF Mail Server at spamd4-us-west.apache.org) with ESMTP id 9E421C0BE5
	for <dev@httpd.apache.org>; Fri, 16 Oct 2015 14:22:35 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd4-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.121
X-Spam-Level:
X-Spam-Status: No, score=-0.121 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RCVD_IN_MSPIKE_H3=-0.01, RCVD_IN_MSPIKE_WL=-0.01, SPF_PASS=-0.001]
	autolearn=disabled
Authentication-Results: spamd4-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd4-us-west.apache.org [10.40.0.11]) (amavisd-new, port 10024)
	with ESMTP id vmeaV1NOOcE4 for <dev@httpd.apache.org>;
	Fri, 16 Oct 2015 14:22:35 +0000 (UTC)
Received: from mail-wi0-f171.google.com (mail-wi0-f171.google.com [209.85.212.171])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id B752643A13
	for <dev@httpd.apache.org>; Fri, 16 Oct 2015 14:22:34 +0000 (UTC)
Received: by wicll6 with SMTP id ll6so12514325wic.0
        for <dev@httpd.apache.org>; Fri, 16 Oct 2015 07:22:34 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=mime-version:in-reply-to:references:from:date:message-id:subject:to
         :content-type;
        bh=93rQTe9fK2oGhEtyyiPEA31kbSvAhq8nSpQs7+GFtX8=;
        b=UCSLfvmMxFidESqCPbSqtHKcFEFIX4WFt+eheRNVSRdTgsNO2iaAX1loa2nflvWx5T
         IUSn6mWEDo3G1218zGNbj97zhYVudm+0mjoQ08mctdOc5uTttjP9Ts9rixe2hJe6nohJ
         5ZMj1M9McYVASJyVcM8S0XLUG9kOY7uxbhDlGfNY3zyGiofvCST0y0vQW8s8gA0uTQDJ
         e7SRX9RxCZY4+YlcflnR44+1u8aGrY1uYk+kgV//7CP17WgzMCrOuS5ZsRXKPUe3PuWO
         eOO1eP+T6hSTiHX/vzL3atTnf2HAt4LDSzDB7mUZivAQvi5tYw65ucwNWR20G8zOFAOB
         7qcg==
X-Received: by 10.194.76.67 with SMTP id i3mr19040394wjw.5.1445005353970; Fri,
 16 Oct 2015 07:22:33 -0700 (PDT)
MIME-Version: 1.0
Received: by 10.27.88.10 with HTTP; Fri, 16 Oct 2015 07:22:14 -0700 (PDT)
In-Reply-To: <CALK=YjNMv2PWLjO3-4T2H__qZgFz9XqBUJN6u6Ztq_ZGs5M6TA@mail.gmail.com>
References: <CAKQ1sVNx3g2PjkxG6z2LwqA6CuJeVv2L6SryVsMWp2SydoKFjQ@mail.gmail.com>
 <CAKQ1sVObJbAiRHdKHpU9veo8UtUqHXJ+L=PbcbWWd4Poo4TmGg@mail.gmail.com>
 <CAKQ1sVOMCg6wYD_xpxgWuPiyR=o6HSDKjdBj34v4KPn1Ns+SGw@mail.gmail.com>
 <CAOhm=5qPYuXD+BpbZZhcOa=_J_3hdid6s4w0=HaZCPy3as+GVw@mail.gmail.com> <CALK=YjNMv2PWLjO3-4T2H__qZgFz9XqBUJN6u6Ztq_ZGs5M6TA@mail.gmail.com>
From: Chris <chrcoluk@gmail.com>
Date: Fri, 16 Oct 2015 15:22:14 +0100
Message-ID: <CAOhm=5qoSRoBP7GzDZdBtxmSOKLBx8hQRBG=HBoPcStw1VVZpQ@mail.gmail.com>
Subject: Re: H2 compatible ciphers (was: svn commit: r1708593)
To: dev@httpd.apache.org
Content-Type: text/plain; charset=UTF-8

sslhonorcipherorder is definitely set.

I will check again to see if is in the unbanned ones.

On 16 October 2015 at 14:37, Eric Covener <covener@gmail.com> wrote:
> On Fri, Oct 16, 2015 at 9:28 AM, Chris <chrcoluk@gmail.com> wrote:
>> interesting that chrome is happily using h2 on my domain that I
>> activated for h2 earlier and I have a couple of banned ciphers in
>> mod_ssl.
>
>
> unbanned ones listed earlier, or no SSLHonorCipherOrder?

From dev-return-84327-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Fri Oct 16 14:25:32 2015
Return-Path: <dev-return-84327-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 80DA317826
	for <apmail-httpd-dev-archive@www.apache.org>; Fri, 16 Oct 2015 14:25:32 +0000 (UTC)
Received: (qmail 64362 invoked by uid 500); 16 Oct 2015 14:25:32 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 64277 invoked by uid 500); 16 Oct 2015 14:25:32 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 64267 invoked by uid 99); 16 Oct 2015 14:25:32 -0000
Received: from Unknown (HELO spamd3-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 16 Oct 2015 14:25:32 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd3-us-west.apache.org (ASF Mail Server at spamd3-us-west.apache.org) with ESMTP id 7FAE6180E8F
	for <dev@httpd.apache.org>; Fri, 16 Oct 2015 14:25:31 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd3-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.121
X-Spam-Level:
X-Spam-Status: No, score=-0.121 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RCVD_IN_MSPIKE_H3=-0.01, RCVD_IN_MSPIKE_WL=-0.01, SPF_PASS=-0.001]
	autolearn=disabled
Authentication-Results: spamd3-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd3-us-west.apache.org [10.40.0.10]) (amavisd-new, port 10024)
	with ESMTP id yEF_0dBErv8j for <dev@httpd.apache.org>;
	Fri, 16 Oct 2015 14:25:31 +0000 (UTC)
Received: from mail-wi0-f172.google.com (mail-wi0-f172.google.com [209.85.212.172])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id 9BAEF43A13
	for <dev@httpd.apache.org>; Fri, 16 Oct 2015 14:25:30 +0000 (UTC)
Received: by wicll6 with SMTP id ll6so12638677wic.0
        for <dev@httpd.apache.org>; Fri, 16 Oct 2015 07:25:29 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=mime-version:in-reply-to:references:from:date:message-id:subject:to
         :content-type;
        bh=+o2fA+HxK/8cxEeHbGQaHyMOEAFbDGX0Z3QK2h32VIE=;
        b=PtVpOY5GvOmTj/5t7aDPGsASDMbPzg6PQqW8/d2dBSFLQpjcEhlGxfFBGgquvTamxH
         wq/SzY2iu7CFRkhob6mb3FG8COz3KpKtGoCBKMTzX1CJoyItoJTrqUrhtZQsFAzc3YkD
         PlEMco09CnJb/4gm4rc1XD2V3k8UCt2QY+toOD+miHiapy0h0Qcej5h2xOsyHgnC89bL
         hi/9zDnXhcJmBA8GFN9M12doLPwknKWucSm4bmlpe+G0wHeOIgCM6QhirZmt7ADboHU9
         evaD15KOrcVwu+9EBTcilNX12Vb4UDFkdGDrKZgPbxqS7wJwQzwjx9zsADkOyCuqHgkW
         lFOw==
X-Received: by 10.180.198.12 with SMTP id iy12mr5338141wic.72.1445005528470;
 Fri, 16 Oct 2015 07:25:28 -0700 (PDT)
MIME-Version: 1.0
Received: by 10.27.88.10 with HTTP; Fri, 16 Oct 2015 07:25:09 -0700 (PDT)
In-Reply-To: <CALK=YjNMv2PWLjO3-4T2H__qZgFz9XqBUJN6u6Ztq_ZGs5M6TA@mail.gmail.com>
References: <CAKQ1sVNx3g2PjkxG6z2LwqA6CuJeVv2L6SryVsMWp2SydoKFjQ@mail.gmail.com>
 <CAKQ1sVObJbAiRHdKHpU9veo8UtUqHXJ+L=PbcbWWd4Poo4TmGg@mail.gmail.com>
 <CAKQ1sVOMCg6wYD_xpxgWuPiyR=o6HSDKjdBj34v4KPn1Ns+SGw@mail.gmail.com>
 <CAOhm=5qPYuXD+BpbZZhcOa=_J_3hdid6s4w0=HaZCPy3as+GVw@mail.gmail.com> <CALK=YjNMv2PWLjO3-4T2H__qZgFz9XqBUJN6u6Ztq_ZGs5M6TA@mail.gmail.com>
From: Chris <chrcoluk@gmail.com>
Date: Fri, 16 Oct 2015 15:25:09 +0100
Message-ID: <CAOhm=5q7pEvN9Hj=+CciFiR+OyGi96TAQUK6O8Ec6o+C2dBOcw@mail.gmail.com>
Subject: Re: H2 compatible ciphers (was: svn commit: r1708593)
To: dev@httpd.apache.org
Content-Type: text/plain; charset=UTF-8

here is ciphers as listed by ssllabs scanning a site on the server.
(in the order set)

TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256 (0xc02f)   ECDH 256 bits (eq.
3072 bits RSA)   FS 128
TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256 (0xc027)   ECDH 256 bits (eq.
3072 bits RSA)   FS 128
TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA (0xc013)   ECDH 256 bits (eq. 3072
bits RSA)   FS 128
TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384 (0xc030)   ECDH 256 bits (eq.
3072 bits RSA)   FS 256
TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA384 (0xc028)   ECDH 256 bits (eq.
3072 bits RSA)   FS 256
TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA (0xc014)   ECDH 256 bits (eq. 3072
bits RSA)   FS 256
TLS_ECDHE_RSA_WITH_3DES_EDE_CBC_SHA (0xc012)   ECDH 256 bits (eq. 3072
bits RSA)   FS 112
TLS_DHE_RSA_WITH_AES_128_CBC_SHA (0x33)   DH 2048 bits (p: 256, g: 1,
Ys: 256)   FS 128
TLS_RSA_WITH_3DES_EDE_CBC_SHA (0xa)

On 16 October 2015 at 14:37, Eric Covener <covener@gmail.com> wrote:
> On Fri, Oct 16, 2015 at 9:28 AM, Chris <chrcoluk@gmail.com> wrote:
>> interesting that chrome is happily using h2 on my domain that I
>> activated for h2 earlier and I have a couple of banned ciphers in
>> mod_ssl.
>
>
> unbanned ones listed earlier, or no SSLHonorCipherOrder?

From dev-return-84328-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Fri Oct 16 14:29:56 2015
Return-Path: <dev-return-84328-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 0E8AF17867
	for <apmail-httpd-dev-archive@www.apache.org>; Fri, 16 Oct 2015 14:29:56 +0000 (UTC)
Received: (qmail 79367 invoked by uid 500); 16 Oct 2015 14:29:47 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 79293 invoked by uid 500); 16 Oct 2015 14:29:47 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 79283 invoked by uid 99); 16 Oct 2015 14:29:47 -0000
Received: from Unknown (HELO spamd1-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 16 Oct 2015 14:29:47 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd1-us-west.apache.org (ASF Mail Server at spamd1-us-west.apache.org) with ESMTP id 259A3C6386
	for <dev@httpd.apache.org>; Fri, 16 Oct 2015 14:29:47 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd1-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.121
X-Spam-Level:
X-Spam-Status: No, score=-0.121 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RCVD_IN_MSPIKE_H3=-0.01, RCVD_IN_MSPIKE_WL=-0.01, SPF_PASS=-0.001]
	autolearn=disabled
Authentication-Results: spamd1-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd1-us-west.apache.org [10.40.0.7]) (amavisd-new, port 10024)
	with ESMTP id rdovKhVT3lgc for <dev@httpd.apache.org>;
	Fri, 16 Oct 2015 14:29:46 +0000 (UTC)
Received: from mail-wi0-f175.google.com (mail-wi0-f175.google.com [209.85.212.175])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id 5B1E6429AA
	for <dev@httpd.apache.org>; Fri, 16 Oct 2015 14:29:46 +0000 (UTC)
Received: by wicgb1 with SMTP id gb1so11861077wic.1
        for <dev@httpd.apache.org>; Fri, 16 Oct 2015 07:29:45 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=mime-version:in-reply-to:references:from:date:message-id:subject:to
         :content-type;
        bh=RI3fqCkXRd/a/IBzP2+dVWbnnW89Lyo6CX9P2joT+p0=;
        b=j+hTKdDDcpnDggZAjb7kceEVf2+qdhHdUeMbGTVYUcRj2PayDyLBehCSD/VuhRNmXC
         wLQjX3lrHG0BG0bs1YHHn2YryTwgY6zVERZtZWs2D2ShiMMM5D2vV5IwHN913FoWxx2Q
         vrBP5HBRhjxRdf2+iwbwUFJJkvaE0JAR3rnQ8jq3wmMdtH02GFVXQygwygw7kXw2wusR
         2H9qZpCzuqgmH43SBrA+PebBXJbcWlmX1xRZ4pJ9jP1Yyk2ekpkbcnneN31xFb+fuPxt
         oAh/hhsc3k85b5j7RggIZLwcYyVRfBmRcuDiS84N4fLq1IK/Dvbyht6zmRYGvMhUfgq/
         kzwg==
X-Received: by 10.180.198.12 with SMTP id iy12mr5363471wic.72.1445005779773;
 Fri, 16 Oct 2015 07:29:39 -0700 (PDT)
MIME-Version: 1.0
Received: by 10.27.88.10 with HTTP; Fri, 16 Oct 2015 07:29:20 -0700 (PDT)
In-Reply-To: <CALK=YjNMv2PWLjO3-4T2H__qZgFz9XqBUJN6u6Ztq_ZGs5M6TA@mail.gmail.com>
References: <CAKQ1sVNx3g2PjkxG6z2LwqA6CuJeVv2L6SryVsMWp2SydoKFjQ@mail.gmail.com>
 <CAKQ1sVObJbAiRHdKHpU9veo8UtUqHXJ+L=PbcbWWd4Poo4TmGg@mail.gmail.com>
 <CAKQ1sVOMCg6wYD_xpxgWuPiyR=o6HSDKjdBj34v4KPn1Ns+SGw@mail.gmail.com>
 <CAOhm=5qPYuXD+BpbZZhcOa=_J_3hdid6s4w0=HaZCPy3as+GVw@mail.gmail.com> <CALK=YjNMv2PWLjO3-4T2H__qZgFz9XqBUJN6u6Ztq_ZGs5M6TA@mail.gmail.com>
From: Chris <chrcoluk@gmail.com>
Date: Fri, 16 Oct 2015 15:29:20 +0100
Message-ID: <CAOhm=5pHZO2KEHk_TOTutTfOd6zsuLArBz-F2-wuTtwEhaNpLA@mail.gmail.com>
Subject: Re: H2 compatible ciphers (was: svn commit: r1708593)
To: dev@httpd.apache.org
Content-Type: text/plain; charset=UTF-8

here is my cipher list used in mod_ssl

SSLCipherSuite ECDHE-RSA-AES128-GCM-SHA256:ECDH+AES128:ECDHE-RSA-AES256-GCM-SHA384:ECDH+AES256:ECDH+3DES:CHACHA20+POLY1305:DHE-RSA-AES128-SHA:RSA+3DES:!aNULL:!MD5

note tho poly1305 doesnt work so ignore that one.

On 16 October 2015 at 14:37, Eric Covener <covener@gmail.com> wrote:
> On Fri, Oct 16, 2015 at 9:28 AM, Chris <chrcoluk@gmail.com> wrote:
>> interesting that chrome is happily using h2 on my domain that I
>> activated for h2 earlier and I have a couple of banned ciphers in
>> mod_ssl.
>
>
> unbanned ones listed earlier, or no SSLHonorCipherOrder?

From dev-return-84329-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Fri Oct 16 14:32:49 2015
Return-Path: <dev-return-84329-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 085C117882
	for <apmail-httpd-dev-archive@www.apache.org>; Fri, 16 Oct 2015 14:32:49 +0000 (UTC)
Received: (qmail 83506 invoked by uid 500); 16 Oct 2015 14:32:42 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 83441 invoked by uid 500); 16 Oct 2015 14:32:42 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 83429 invoked by uid 99); 16 Oct 2015 14:32:42 -0000
Received: from Unknown (HELO spamd3-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 16 Oct 2015 14:32:42 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd3-us-west.apache.org (ASF Mail Server at spamd3-us-west.apache.org) with ESMTP id 3780F180E8F
	for <dev@httpd.apache.org>; Fri, 16 Oct 2015 14:32:42 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd3-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.121
X-Spam-Level:
X-Spam-Status: No, score=-0.121 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RCVD_IN_MSPIKE_H3=-0.01, RCVD_IN_MSPIKE_WL=-0.01, SPF_PASS=-0.001]
	autolearn=disabled
Authentication-Results: spamd3-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-us-west.apache.org ([10.40.0.8])
	by localhost (spamd3-us-west.apache.org [10.40.0.10]) (amavisd-new, port 10024)
	with ESMTP id tArXutPs-46l for <dev@httpd.apache.org>;
	Fri, 16 Oct 2015 14:32:41 +0000 (UTC)
Received: from mail-qk0-f170.google.com (mail-qk0-f170.google.com [209.85.220.170])
	by mx1-us-west.apache.org (ASF Mail Server at mx1-us-west.apache.org) with ESMTPS id 7C7012074F
	for <dev@httpd.apache.org>; Fri, 16 Oct 2015 14:32:41 +0000 (UTC)
Received: by qkht68 with SMTP id t68so54819455qkh.3
        for <dev@httpd.apache.org>; Fri, 16 Oct 2015 07:32:35 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        bh=ZsxSaN+9vDQUgm66+4bDeU4gjwhthYjOYMvcLH6z1T0=;
        b=jIgWQsCyPu0FcmThkLIqc1XzJ8DdTIv9cjay46XrF+5IHoxAX1jLiBEboNBA2pHgXB
         IjD0vsKuOKm1/QSLOuDhRYM8W7Fr/hTRbvFcll+w68cgaXpiilRJE0qAc2PdWjkeYZV4
         9FQfKOGg2IN4HmitbFegEh0WXNjiMxWzmkinoJYVqai/+rQwxpMbzZDuP/3UitOz9puN
         V9G/idZnNVct2C/sLGzqloc08oCixjYqQQjR6im9nTNfJt/bLp0Cnknd/CxiOFIQU67k
         Ixv3WY2A7AlfnsAGvVeta9QzBflWnoVpwhBTvdbkcylcV4r08ifCih1K4EQFMbz8aIDf
         gBTA==
MIME-Version: 1.0
X-Received: by 10.55.192.15 with SMTP id o15mr19697177qki.2.1445005955579;
 Fri, 16 Oct 2015 07:32:35 -0700 (PDT)
Received: by 10.55.156.213 with HTTP; Fri, 16 Oct 2015 07:32:35 -0700 (PDT)
In-Reply-To: <CAOhm=5pHZO2KEHk_TOTutTfOd6zsuLArBz-F2-wuTtwEhaNpLA@mail.gmail.com>
References: <CAKQ1sVNx3g2PjkxG6z2LwqA6CuJeVv2L6SryVsMWp2SydoKFjQ@mail.gmail.com>
	<CAKQ1sVObJbAiRHdKHpU9veo8UtUqHXJ+L=PbcbWWd4Poo4TmGg@mail.gmail.com>
	<CAKQ1sVOMCg6wYD_xpxgWuPiyR=o6HSDKjdBj34v4KPn1Ns+SGw@mail.gmail.com>
	<CAOhm=5qPYuXD+BpbZZhcOa=_J_3hdid6s4w0=HaZCPy3as+GVw@mail.gmail.com>
	<CALK=YjNMv2PWLjO3-4T2H__qZgFz9XqBUJN6u6Ztq_ZGs5M6TA@mail.gmail.com>
	<CAOhm=5pHZO2KEHk_TOTutTfOd6zsuLArBz-F2-wuTtwEhaNpLA@mail.gmail.com>
Date: Fri, 16 Oct 2015 16:32:35 +0200
Message-ID: <CAKQ1sVMJokWTUGzEOHgc4y0CMqAw4CQTB9-ocuhtePjPoarq_w@mail.gmail.com>
Subject: Re: H2 compatible ciphers (was: svn commit: r1708593)
From: Yann Ylavic <ylavic.dev@gmail.com>
To: dev@httpd.apache.org
Content-Type: text/plain; charset=UTF-8

Some of them are not banned, so I don't see why Chrome should complain.
Is the selected cipher a banned one?

On Fri, Oct 16, 2015 at 4:29 PM, Chris <chrcoluk@gmail.com> wrote:
> here is my cipher list used in mod_ssl
>
> SSLCipherSuite ECDHE-RSA-AES128-GCM-SHA256:ECDH+AES128:ECDHE-RSA-AES256-GCM-SHA384:ECDH+AES256:ECDH+3DES:CHACHA20+POLY1305:DHE-RSA-AES128-SHA:RSA+3DES:!aNULL:!MD5
>
> note tho poly1305 doesnt work so ignore that one.
>
> On 16 October 2015 at 14:37, Eric Covener <covener@gmail.com> wrote:
>> On Fri, Oct 16, 2015 at 9:28 AM, Chris <chrcoluk@gmail.com> wrote:
>>> interesting that chrome is happily using h2 on my domain that I
>>> activated for h2 earlier and I have a couple of banned ciphers in
>>> mod_ssl.
>>
>>
>> unbanned ones listed earlier, or no SSLHonorCipherOrder?

From dev-return-84330-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Fri Oct 16 14:34:20 2015
Return-Path: <dev-return-84330-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id C28981788F
	for <apmail-httpd-dev-archive@www.apache.org>; Fri, 16 Oct 2015 14:34:20 +0000 (UTC)
Received: (qmail 90870 invoked by uid 500); 16 Oct 2015 14:34:20 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 90792 invoked by uid 500); 16 Oct 2015 14:34:20 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 90782 invoked by uid 99); 16 Oct 2015 14:34:20 -0000
Received: from Unknown (HELO spamd4-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 16 Oct 2015 14:34:20 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd4-us-west.apache.org (ASF Mail Server at spamd4-us-west.apache.org) with ESMTP id D48FCC0DCD
	for <dev@httpd.apache.org>; Fri, 16 Oct 2015 14:34:19 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd4-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.121
X-Spam-Level:
X-Spam-Status: No, score=-0.121 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RCVD_IN_MSPIKE_H3=-0.01, RCVD_IN_MSPIKE_WL=-0.01, SPF_PASS=-0.001]
	autolearn=disabled
Authentication-Results: spamd4-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-us-west.apache.org ([10.40.0.8])
	by localhost (spamd4-us-west.apache.org [10.40.0.11]) (amavisd-new, port 10024)
	with ESMTP id r_ify2ac047P for <dev@httpd.apache.org>;
	Fri, 16 Oct 2015 14:34:19 +0000 (UTC)
Received: from mail-wi0-f173.google.com (mail-wi0-f173.google.com [209.85.212.173])
	by mx1-us-west.apache.org (ASF Mail Server at mx1-us-west.apache.org) with ESMTPS id E75A023038
	for <dev@httpd.apache.org>; Fri, 16 Oct 2015 14:34:18 +0000 (UTC)
Received: by wicll6 with SMTP id ll6so14075761wic.1
        for <dev@httpd.apache.org>; Fri, 16 Oct 2015 07:34:17 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=mime-version:in-reply-to:references:from:date:message-id:subject:to
         :content-type;
        bh=SdZWgGuYa/YDS0CpcoKroWOhE54/BA3pUhyYUTC6QPk=;
        b=poI2A+Vugx1IdOtkZi9PJtS+04SFi6+ibosxH4Pv17g/YWZfLrbrqLWgqotUbVQF+x
         Pw/ostp34pum2/ODWkERO/T4uXUefycMZzEyEQWJknrAHv5M9NlmoPFa8jIQ+7qMLLk0
         UjSmvzkBz1xCZyRh0ik+zVnoovd5ntGtRwKQ9uxl7wq8wUudDKL7I1/Me7jiGXpgIKe5
         RIzI2OxSA9fOd/XJxsP7eujE18eDsRXJEhedB1gZ2wAbvCGhmt7EsRUjvJdBukc364Tg
         pdtnq/DO942B3DA2hlXH8EAtLFYyhy2BuqkPxlDItQV6EiqJryQ5TjVgt3fHgEB/PMgu
         +S5g==
X-Received: by 10.194.249.34 with SMTP id yr2mr17640407wjc.90.1445006057654;
 Fri, 16 Oct 2015 07:34:17 -0700 (PDT)
MIME-Version: 1.0
Received: by 10.27.88.10 with HTTP; Fri, 16 Oct 2015 07:33:58 -0700 (PDT)
In-Reply-To: <CAKQ1sVMJokWTUGzEOHgc4y0CMqAw4CQTB9-ocuhtePjPoarq_w@mail.gmail.com>
References: <CAKQ1sVNx3g2PjkxG6z2LwqA6CuJeVv2L6SryVsMWp2SydoKFjQ@mail.gmail.com>
 <CAKQ1sVObJbAiRHdKHpU9veo8UtUqHXJ+L=PbcbWWd4Poo4TmGg@mail.gmail.com>
 <CAKQ1sVOMCg6wYD_xpxgWuPiyR=o6HSDKjdBj34v4KPn1Ns+SGw@mail.gmail.com>
 <CAOhm=5qPYuXD+BpbZZhcOa=_J_3hdid6s4w0=HaZCPy3as+GVw@mail.gmail.com>
 <CALK=YjNMv2PWLjO3-4T2H__qZgFz9XqBUJN6u6Ztq_ZGs5M6TA@mail.gmail.com>
 <CAOhm=5pHZO2KEHk_TOTutTfOd6zsuLArBz-F2-wuTtwEhaNpLA@mail.gmail.com> <CAKQ1sVMJokWTUGzEOHgc4y0CMqAw4CQTB9-ocuhtePjPoarq_w@mail.gmail.com>
From: Chris <chrcoluk@gmail.com>
Date: Fri, 16 Oct 2015 15:33:58 +0100
Message-ID: <CAOhm=5qSFfvrfGj_tcB-QtAqWznN_xR+iEgqJBy2T1TvboPyGg@mail.gmail.com>
Subject: Re: H2 compatible ciphers (was: svn commit: r1708593)
To: dev@httpd.apache.org
Content-Type: text/plain; charset=UTF-8

ahh so only one needs to be unbanned for it to work?

the selected cipher isnt banned no.

On 16 October 2015 at 15:32, Yann Ylavic <ylavic.dev@gmail.com> wrote:
> Some of them are not banned, so I don't see why Chrome should complain.
> Is the selected cipher a banned one?
>
> On Fri, Oct 16, 2015 at 4:29 PM, Chris <chrcoluk@gmail.com> wrote:
>> here is my cipher list used in mod_ssl
>>
>> SSLCipherSuite ECDHE-RSA-AES128-GCM-SHA256:ECDH+AES128:ECDHE-RSA-AES256-GCM-SHA384:ECDH+AES256:ECDH+3DES:CHACHA20+POLY1305:DHE-RSA-AES128-SHA:RSA+3DES:!aNULL:!MD5
>>
>> note tho poly1305 doesnt work so ignore that one.
>>
>> On 16 October 2015 at 14:37, Eric Covener <covener@gmail.com> wrote:
>>> On Fri, Oct 16, 2015 at 9:28 AM, Chris <chrcoluk@gmail.com> wrote:
>>>> interesting that chrome is happily using h2 on my domain that I
>>>> activated for h2 earlier and I have a couple of banned ciphers in
>>>> mod_ssl.
>>>
>>>
>>> unbanned ones listed earlier, or no SSLHonorCipherOrder?

From dev-return-84331-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Fri Oct 16 14:35:16 2015
Return-Path: <dev-return-84331-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 7AAA4178A0
	for <apmail-httpd-dev-archive@www.apache.org>; Fri, 16 Oct 2015 14:35:16 +0000 (UTC)
Received: (qmail 94236 invoked by uid 500); 16 Oct 2015 14:35:15 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 94166 invoked by uid 500); 16 Oct 2015 14:35:15 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 94154 invoked by uid 99); 16 Oct 2015 14:35:15 -0000
Received: from Unknown (HELO spamd1-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 16 Oct 2015 14:35:15 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd1-us-west.apache.org (ASF Mail Server at spamd1-us-west.apache.org) with ESMTP id B41E9C639B
	for <dev@httpd.apache.org>; Fri, 16 Oct 2015 14:35:14 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd1-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.121
X-Spam-Level:
X-Spam-Status: No, score=-0.121 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RCVD_IN_MSPIKE_H3=-0.01, RCVD_IN_MSPIKE_WL=-0.01, SPF_PASS=-0.001]
	autolearn=disabled
Authentication-Results: spamd1-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-us-west.apache.org ([10.40.0.8])
	by localhost (spamd1-us-west.apache.org [10.40.0.7]) (amavisd-new, port 10024)
	with ESMTP id jjhK6unsq2G0 for <dev@httpd.apache.org>;
	Fri, 16 Oct 2015 14:35:14 +0000 (UTC)
Received: from mail-qk0-f170.google.com (mail-qk0-f170.google.com [209.85.220.170])
	by mx1-us-west.apache.org (ASF Mail Server at mx1-us-west.apache.org) with ESMTPS id D160B2326A
	for <dev@httpd.apache.org>; Fri, 16 Oct 2015 14:35:13 +0000 (UTC)
Received: by qkas79 with SMTP id s79so55000309qka.0
        for <dev@httpd.apache.org>; Fri, 16 Oct 2015 07:35:13 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        bh=tQm+SFfp9nyjgpBIbf1zXhXy/Ef6QZhYxdqVQQVwpRU=;
        b=ZXdm83ORdaKYi/IpvwfqpHip3c5ma/zbx6NGlOXUVgBHELglJq6h7CVHM5jvfusiCA
         aoM9ZvsoLamSjf63hFYPCNV911MlpXI+0uAeXqjXDv76vgEZzpVi3DiS+FCxYpXj03RF
         jxlkqMjXbrfCU9eH+ybIf033/lcJ53zBQ2ekI7uKqazGZDJVRB9YkZLcGbJCQdidJN0O
         IvVGDNP/u/1j4BzqEBRnkANJ2PuOasDzFqhim3yi21BBdHNBnX1A/mmdeVzaqJVY0cqL
         07qT30uDtHAbuTEGvDEks7L9R1i1ISrBLrP4Rbd77v/teK/FPtrvWySnfLdc0nZDBY8M
         wtjg==
MIME-Version: 1.0
X-Received: by 10.55.215.156 with SMTP id t28mr19044854qkt.68.1445006112983;
 Fri, 16 Oct 2015 07:35:12 -0700 (PDT)
Received: by 10.55.156.213 with HTTP; Fri, 16 Oct 2015 07:35:12 -0700 (PDT)
In-Reply-To: <CAOhm=5qSFfvrfGj_tcB-QtAqWznN_xR+iEgqJBy2T1TvboPyGg@mail.gmail.com>
References: <CAKQ1sVNx3g2PjkxG6z2LwqA6CuJeVv2L6SryVsMWp2SydoKFjQ@mail.gmail.com>
	<CAKQ1sVObJbAiRHdKHpU9veo8UtUqHXJ+L=PbcbWWd4Poo4TmGg@mail.gmail.com>
	<CAKQ1sVOMCg6wYD_xpxgWuPiyR=o6HSDKjdBj34v4KPn1Ns+SGw@mail.gmail.com>
	<CAOhm=5qPYuXD+BpbZZhcOa=_J_3hdid6s4w0=HaZCPy3as+GVw@mail.gmail.com>
	<CALK=YjNMv2PWLjO3-4T2H__qZgFz9XqBUJN6u6Ztq_ZGs5M6TA@mail.gmail.com>
	<CAOhm=5pHZO2KEHk_TOTutTfOd6zsuLArBz-F2-wuTtwEhaNpLA@mail.gmail.com>
	<CAKQ1sVMJokWTUGzEOHgc4y0CMqAw4CQTB9-ocuhtePjPoarq_w@mail.gmail.com>
	<CAOhm=5qSFfvrfGj_tcB-QtAqWznN_xR+iEgqJBy2T1TvboPyGg@mail.gmail.com>
Date: Fri, 16 Oct 2015 16:35:12 +0200
Message-ID: <CAKQ1sVM5qiOmuWvFZzP0VD-SEnbQjLoQiSpGhbL00kx8i5vvxg@mail.gmail.com>
Subject: Re: H2 compatible ciphers (was: svn commit: r1708593)
From: Yann Ylavic <ylavic.dev@gmail.com>
To: dev@httpd.apache.org
Content-Type: text/plain; charset=UTF-8

Yes, the browser won't see the whole list, only the selected one.

On Fri, Oct 16, 2015 at 4:33 PM, Chris <chrcoluk@gmail.com> wrote:
> ahh so only one needs to be unbanned for it to work?
>
> the selected cipher isnt banned no.
>
> On 16 October 2015 at 15:32, Yann Ylavic <ylavic.dev@gmail.com> wrote:
>> Some of them are not banned, so I don't see why Chrome should complain.
>> Is the selected cipher a banned one?
>>
>> On Fri, Oct 16, 2015 at 4:29 PM, Chris <chrcoluk@gmail.com> wrote:
>>> here is my cipher list used in mod_ssl
>>>
>>> SSLCipherSuite ECDHE-RSA-AES128-GCM-SHA256:ECDH+AES128:ECDHE-RSA-AES256-GCM-SHA384:ECDH+AES256:ECDH+3DES:CHACHA20+POLY1305:DHE-RSA-AES128-SHA:RSA+3DES:!aNULL:!MD5
>>>
>>> note tho poly1305 doesnt work so ignore that one.
>>>
>>> On 16 October 2015 at 14:37, Eric Covener <covener@gmail.com> wrote:
>>>> On Fri, Oct 16, 2015 at 9:28 AM, Chris <chrcoluk@gmail.com> wrote:
>>>>> interesting that chrome is happily using h2 on my domain that I
>>>>> activated for h2 earlier and I have a couple of banned ciphers in
>>>>> mod_ssl.
>>>>
>>>>
>>>> unbanned ones listed earlier, or no SSLHonorCipherOrder?

From dev-return-84332-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Fri Oct 16 14:37:07 2015
Return-Path: <dev-return-84332-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 672B1178C0
	for <apmail-httpd-dev-archive@www.apache.org>; Fri, 16 Oct 2015 14:37:07 +0000 (UTC)
Received: (qmail 623 invoked by uid 500); 16 Oct 2015 14:37:05 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 508 invoked by uid 500); 16 Oct 2015 14:37:05 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 495 invoked by uid 99); 16 Oct 2015 14:37:05 -0000
Received: from Unknown (HELO spamd4-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 16 Oct 2015 14:37:05 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd4-us-west.apache.org (ASF Mail Server at spamd4-us-west.apache.org) with ESMTP id 316FAC0BE5
	for <dev@httpd.apache.org>; Fri, 16 Oct 2015 14:37:05 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd4-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.121
X-Spam-Level:
X-Spam-Status: No, score=-0.121 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RCVD_IN_MSPIKE_H3=-0.01, RCVD_IN_MSPIKE_WL=-0.01, SPF_PASS=-0.001]
	autolearn=disabled
Authentication-Results: spamd4-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd4-us-west.apache.org [10.40.0.11]) (amavisd-new, port 10024)
	with ESMTP id gGIiy0JA1s4y for <dev@httpd.apache.org>;
	Fri, 16 Oct 2015 14:37:04 +0000 (UTC)
Received: from mail-wi0-f179.google.com (mail-wi0-f179.google.com [209.85.212.179])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id E948720751
	for <dev@httpd.apache.org>; Fri, 16 Oct 2015 14:37:03 +0000 (UTC)
Received: by wicll6 with SMTP id ll6so14204524wic.1
        for <dev@httpd.apache.org>; Fri, 16 Oct 2015 07:37:03 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=mime-version:in-reply-to:references:from:date:message-id:subject:to
         :content-type;
        bh=4qCyvaRqPAWRRV1n9trlokSaavfMSyeoHppZL2d8Jcs=;
        b=MHUbPwQlxRfZWj9EbfYVT9RyPyaje4Dp/p5o5JjQjctG/4eUHTSv3qJgnbpACJhKB7
         8+cww0WE4zSfmFktwBlPqrQCvpOOx2wiUZArle/0v5CzaJIzcal6+NJdT0GaGsb6akky
         QaR97wXKFrMcfMCCJa86/3a1lzUknFEHpav4xNeHqt5kzwNj8YEB9iABODUC74Lxpu8P
         66D8ftr0K5/41IezIxou9eljo+2g0+RWg24mnA/fKz4poB1N1qERHvxGQqIK/DvyhlyV
         enyReNYlAkl2GEhLOLpMS6Um2hwwZK/xiQ2668xNqtr5Ay5sbSNxsO52AKtj4MXDqADS
         VtVg==
X-Received: by 10.180.188.169 with SMTP id gb9mr5396869wic.72.1445006223700;
 Fri, 16 Oct 2015 07:37:03 -0700 (PDT)
MIME-Version: 1.0
Received: by 10.27.88.10 with HTTP; Fri, 16 Oct 2015 07:36:44 -0700 (PDT)
In-Reply-To: <CAKQ1sVM5qiOmuWvFZzP0VD-SEnbQjLoQiSpGhbL00kx8i5vvxg@mail.gmail.com>
References: <CAKQ1sVNx3g2PjkxG6z2LwqA6CuJeVv2L6SryVsMWp2SydoKFjQ@mail.gmail.com>
 <CAKQ1sVObJbAiRHdKHpU9veo8UtUqHXJ+L=PbcbWWd4Poo4TmGg@mail.gmail.com>
 <CAKQ1sVOMCg6wYD_xpxgWuPiyR=o6HSDKjdBj34v4KPn1Ns+SGw@mail.gmail.com>
 <CAOhm=5qPYuXD+BpbZZhcOa=_J_3hdid6s4w0=HaZCPy3as+GVw@mail.gmail.com>
 <CALK=YjNMv2PWLjO3-4T2H__qZgFz9XqBUJN6u6Ztq_ZGs5M6TA@mail.gmail.com>
 <CAOhm=5pHZO2KEHk_TOTutTfOd6zsuLArBz-F2-wuTtwEhaNpLA@mail.gmail.com>
 <CAKQ1sVMJokWTUGzEOHgc4y0CMqAw4CQTB9-ocuhtePjPoarq_w@mail.gmail.com>
 <CAOhm=5qSFfvrfGj_tcB-QtAqWznN_xR+iEgqJBy2T1TvboPyGg@mail.gmail.com> <CAKQ1sVM5qiOmuWvFZzP0VD-SEnbQjLoQiSpGhbL00kx8i5vvxg@mail.gmail.com>
From: Chris <chrcoluk@gmail.com>
Date: Fri, 16 Oct 2015 15:36:44 +0100
Message-ID: <CAOhm=5o00nrdVWYNC6VdaDQfK1aAgYjDjz1OBCQ_W-XUyo=nEQ@mail.gmail.com>
Subject: Re: H2 compatible ciphers (was: svn commit: r1708593)
To: dev@httpd.apache.org
Content-Type: text/plain; charset=UTF-8

good to know thanks :)

Thats why I was told off for suggesting supporting ie8 and http2 at
the same time was not possible then :)

On 16 October 2015 at 15:35, Yann Ylavic <ylavic.dev@gmail.com> wrote:
> Yes, the browser won't see the whole list, only the selected one.
>
> On Fri, Oct 16, 2015 at 4:33 PM, Chris <chrcoluk@gmail.com> wrote:
>> ahh so only one needs to be unbanned for it to work?
>>
>> the selected cipher isnt banned no.
>>
>> On 16 October 2015 at 15:32, Yann Ylavic <ylavic.dev@gmail.com> wrote:
>>> Some of them are not banned, so I don't see why Chrome should complain.
>>> Is the selected cipher a banned one?
>>>
>>> On Fri, Oct 16, 2015 at 4:29 PM, Chris <chrcoluk@gmail.com> wrote:
>>>> here is my cipher list used in mod_ssl
>>>>
>>>> SSLCipherSuite ECDHE-RSA-AES128-GCM-SHA256:ECDH+AES128:ECDHE-RSA-AES256-GCM-SHA384:ECDH+AES256:ECDH+3DES:CHACHA20+POLY1305:DHE-RSA-AES128-SHA:RSA+3DES:!aNULL:!MD5
>>>>
>>>> note tho poly1305 doesnt work so ignore that one.
>>>>
>>>> On 16 October 2015 at 14:37, Eric Covener <covener@gmail.com> wrote:
>>>>> On Fri, Oct 16, 2015 at 9:28 AM, Chris <chrcoluk@gmail.com> wrote:
>>>>>> interesting that chrome is happily using h2 on my domain that I
>>>>>> activated for h2 earlier and I have a couple of banned ciphers in
>>>>>> mod_ssl.
>>>>>
>>>>>
>>>>> unbanned ones listed earlier, or no SSLHonorCipherOrder?

From dev-return-84333-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Fri Oct 16 17:27:45 2015
Return-Path: <dev-return-84333-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 7B74C18179
	for <apmail-httpd-dev-archive@www.apache.org>; Fri, 16 Oct 2015 17:27:45 +0000 (UTC)
Received: (qmail 48957 invoked by uid 500); 16 Oct 2015 17:27:44 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 48885 invoked by uid 500); 16 Oct 2015 17:27:44 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 48875 invoked by uid 99); 16 Oct 2015 17:27:44 -0000
Received: from Unknown (HELO spamd3-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 16 Oct 2015 17:27:44 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd3-us-west.apache.org (ASF Mail Server at spamd3-us-west.apache.org) with ESMTP id 08EB0180E8F
	for <dev@httpd.apache.org>; Fri, 16 Oct 2015 17:27:44 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd3-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.12
X-Spam-Level:
X-Spam-Status: No, score=-0.12 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RCVD_IN_MSPIKE_H3=-0.01, RCVD_IN_MSPIKE_WL=-0.01, SPF_PASS=-0.001,
	URIBL_BLOCKED=0.001] autolearn=disabled
Authentication-Results: spamd3-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd3-us-west.apache.org [10.40.0.10]) (amavisd-new, port 10024)
	with ESMTP id fuUw1ZUGfJuX for <dev@httpd.apache.org>;
	Fri, 16 Oct 2015 17:27:36 +0000 (UTC)
Received: from mail-ig0-f177.google.com (mail-ig0-f177.google.com [209.85.213.177])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id B232042B32
	for <dev@httpd.apache.org>; Fri, 16 Oct 2015 17:27:35 +0000 (UTC)
Received: by igbkq10 with SMTP id kq10so18026446igb.0
        for <dev@httpd.apache.org>; Fri, 16 Oct 2015 10:27:29 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        bh=GJ1gFz1I1yhRzZ4e95Ca+m2slL4g+29dXqcfVmHqxbo=;
        b=zTWZqCLQm0TX0WDBEvQ3DMxJQGiUvDW9YRQkcCFSD/++rGjK/bYd/Nn2d+DvKuAlYr
         joCojOA0R/Lgx5B0zEuby1sZojMREMvZO9C5zBuC8CCcz04ZkUlrF4hko6i5Jt5UggYe
         1lPmgUnAjQ/3IzMt1V9MhJLDFbSLrOtfeN0CJs8ie7j16N2g5uaoK8xC9bPRNKzvxoSR
         4221D+ZWix2OpYFkIP0GHP+KUvA+l0O+g6A1h8S6FANvuFiyAiUIhQ/QvsoKuTCH8vBJ
         jKSkC0vk6zF905tYjwhPhxv8p3/aQq/nyD07jGAeoy3nR9ZLjJP9wMqdSJaI1A+JpvYz
         CmWQ==
MIME-Version: 1.0
X-Received: by 10.51.17.39 with SMTP id gb7mr6708339igd.36.1445016447824; Fri,
 16 Oct 2015 10:27:27 -0700 (PDT)
Received: by 10.64.25.3 with HTTP; Fri, 16 Oct 2015 10:27:27 -0700 (PDT)
In-Reply-To: <bug-58498-7868-pmYEvgEoKS@https.bz.apache.org/bugzilla/>
References: <bug-58498-7868@https.bz.apache.org/bugzilla/>
	<bug-58498-7868-pmYEvgEoKS@https.bz.apache.org/bugzilla/>
Date: Fri, 16 Oct 2015 13:27:27 -0400
Message-ID: <CALK=YjMozaD4W+1qOHEaJ4NF=emjP1gmPZSjPRu-jXgh_yo5Ug@mail.gmail.com>
Subject: Fwd: [Bug 58498] Apache 2.4.17: Regression with mod_autoindex (in
 combination with Phusion Passenger)
From: Eric Covener <covener@gmail.com>
To: Apache HTTP Server Development List <dev@httpd.apache.org>
Content-Type: text/plain; charset=UTF-8

What's with the backwards start and end there?  Does the
successor/predecessor override FIRST/MIDDLE/LAST?


---------- Forwarded message ----------
From:  <bugzilla@apache.org>
Date: Fri, Oct 16, 2015 at 1:24 PM
Subject: [Bug 58498] Apache 2.4.17: Regression with mod_autoindex (in
combination with Phusion Passenger)
To: bugs@httpd.apache.org


https://bz.apache.org/bugzilla/show_bug.cgi?id=58498

--- Comment #2 from Rainer Jung <rainer.jung@kippdata.de> ---
I'm not an expert on passenger, but one can see the hook registration at

https://github.com/phusion/passenger/blob/stable-5.0/src/apache2_module/Hooks.cpp

scrolling down to the end of the file.

The code in the file contains some handler juggling and also rules for ordering
relative to mod_autoindex. Especially

ap_hook_handler(start_blocking_mod_autoindex, NULL, autoindex_module,
APR_HOOK_LAST);
ap_hook_handler(end_blocking_mod_autoindex, autoindex_module, NULL,
APR_HOOK_FIRST);

points to

DEFINE_REQUEST_HOOK(start_blocking_mod_autoindex, startBlockingModAutoIndex)
DEFINE_REQUEST_HOOK(end_blocking_mod_autoindex, endBlockingModAutoIndex)

which brings the following functions into the game:

        int startBlockingModAutoIndex(request_rec *r) {
                RequestNote *note = getRequestNote(r);
                if (note != 0 && hasModAutoIndex()) {
                        note->handlerBeforeModAutoIndex = r->handler;
                        r->handler = "";
                }
                return DECLINED;
        }

        int endBlockingModAutoIndex(request_rec *r) {
                RequestNote *note = getRequestNote(r);
                if (note != 0 && hasModAutoIndex()) {
                        r->handler = note->handlerBeforeModAutoIndex;
                }
                return DECLINED;
        }


In front of them is a comment:

         * mod_autoindex will try to display a directory index for URIs that
map to a directory.
         * This is undesired because of page caching semantics. Suppose that a
Rails application
         * has an ImagesController which has page caching enabled, and thus
also a 'public/images'
         * directory. When the visitor visits /images we'll want the request to
be forwarded to
         * the Rails application, instead of displaying a directory index.
         *
         * So in this hook method, we temporarily change some fields in the
request structure
         * in order to block mod_autoindex. In endBlockingModAutoIndex(), we
restore the request
         * structure to its former state.

Not sure whether this is related.

Rainer

--
You are receiving this mail because:
You are the assignee for the bug.

---------------------------------------------------------------------
To unsubscribe, e-mail: bugs-unsubscribe@httpd.apache.org
For additional commands, e-mail: bugs-help@httpd.apache.org



-- 
Eric Covener
covener@gmail.com

From dev-return-84334-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Fri Oct 16 17:33:06 2015
Return-Path: <dev-return-84334-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id AF3FC181B7
	for <apmail-httpd-dev-archive@www.apache.org>; Fri, 16 Oct 2015 17:33:06 +0000 (UTC)
Received: (qmail 65436 invoked by uid 500); 16 Oct 2015 17:33:05 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 65365 invoked by uid 500); 16 Oct 2015 17:33:05 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 65349 invoked by uid 99); 16 Oct 2015 17:33:05 -0000
Received: from Unknown (HELO spamd2-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 16 Oct 2015 17:33:05 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd2-us-west.apache.org (ASF Mail Server at spamd2-us-west.apache.org) with ESMTP id B6DB81A068D
	for <dev@httpd.apache.org>; Fri, 16 Oct 2015 17:33:04 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd2-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.1
X-Spam-Level:
X-Spam-Status: No, score=-0.1 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	SPF_PASS=-0.001, URIBL_BLOCKED=0.001] autolearn=disabled
Authentication-Results: spamd2-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-us-west.apache.org ([10.40.0.8])
	by localhost (spamd2-us-west.apache.org [10.40.0.9]) (amavisd-new, port 10024)
	with ESMTP id 2fYeDsNjP1Sm for <dev@httpd.apache.org>;
	Fri, 16 Oct 2015 17:32:56 +0000 (UTC)
Received: from mail-io0-f172.google.com (mail-io0-f172.google.com [209.85.223.172])
	by mx1-us-west.apache.org (ASF Mail Server at mx1-us-west.apache.org) with ESMTPS id B525C2074F
	for <dev@httpd.apache.org>; Fri, 16 Oct 2015 17:32:55 +0000 (UTC)
Received: by iodv82 with SMTP id v82so131215040iod.0
        for <dev@httpd.apache.org>; Fri, 16 Oct 2015 10:32:55 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        bh=Q6YCyGeAig2Qhn0A24PRUNhy39Ts1EU2FU9wWJpQThE=;
        b=hZmrI4zGdrxjC3aICSgfQRJOHz15WUlaEiph7UyB1YU5u77YAc1by2gEVTB2OPG6wT
         0kW/cU1LVHIlcJxrSJJHG6DA6b8ENd3J5G0BxIo5/h0D+/MuaCOsh/KE6nlVGjGezMu7
         FZWuet9cqvA0r9EO4pWn22CSMXa8yj/a9tOZKSuWtiWXI8DePQHP3hnzJJSSlG6zJJ0N
         FH21gy5wKC7zYhjlBejE4ayIgNI7fOmBNaFMGkSjGVle/ReAAzONryN4X4rQBI4zuPl+
         dhbt1Nh2jLamZ6WZgt5JoYPanQMdDVwmK47Bgas70n/acUIActN+aAFc3kNhbT6d+9q+
         6EtA==
MIME-Version: 1.0
X-Received: by 10.107.14.4 with SMTP id 4mr20792386ioo.169.1445016775219; Fri,
 16 Oct 2015 10:32:55 -0700 (PDT)
Received: by 10.64.25.3 with HTTP; Fri, 16 Oct 2015 10:32:55 -0700 (PDT)
In-Reply-To: <CALK=YjMozaD4W+1qOHEaJ4NF=emjP1gmPZSjPRu-jXgh_yo5Ug@mail.gmail.com>
References: <bug-58498-7868@https.bz.apache.org/bugzilla/>
	<bug-58498-7868-pmYEvgEoKS@https.bz.apache.org/bugzilla/>
	<CALK=YjMozaD4W+1qOHEaJ4NF=emjP1gmPZSjPRu-jXgh_yo5Ug@mail.gmail.com>
Date: Fri, 16 Oct 2015 13:32:55 -0400
Message-ID: <CALK=YjM1GBvauCBNWDBgT3DDz6ObGtU2RJgQ5hqiS0bYX9OCMw@mail.gmail.com>
Subject: Re: [Bug 58498] Apache 2.4.17: Regression with mod_autoindex (in
 combination with Phusion Passenger)
From: Eric Covener <covener@gmail.com>
To: Apache HTTP Server Development List <dev@httpd.apache.org>
Content-Type: text/plain; charset=UTF-8

On Fri, Oct 16, 2015 at 1:27 PM, Eric Covener <covener@gmail.com> wrote:
> What's with the backwards start and end there?  Does the
> successor/predecessor override FIRST/MIDDLE/LAST?
>
>
> ---------- Forwarded message ----------
> From:  <bugzilla@apache.org>
> Date: Fri, Oct 16, 2015 at 1:24 PM
> Subject: [Bug 58498] Apache 2.4.17: Regression with mod_autoindex (in
> combination with Phusion Passenger)
> To: bugs@httpd.apache.org
>
>
> https://bz.apache.org/bugzilla/show_bug.cgi?id=58498
>
> --- Comment #2 from Rainer Jung <rainer.jung@kippdata.de> ---
> I'm not an expert on passenger, but one can see the hook registration at
>
> https://github.com/phusion/passenger/blob/stable-5.0/src/apache2_module/Hooks.cpp
>
> scrolling down to the end of the file.
>
> The code in the file contains some handler juggling and also rules for ordering
> relative to mod_autoindex. Especially
>
> ap_hook_handler(start_blocking_mod_autoindex, NULL, autoindex_module,
> APR_HOOK_LAST);
> ap_hook_handler(end_blocking_mod_autoindex, autoindex_module, NULL,
> APR_HOOK_FIRST);
>
> points to
>
> DEFINE_REQUEST_HOOK(start_blocking_mod_autoindex, startBlockingModAutoIndex)
> DEFINE_REQUEST_HOOK(end_blocking_mod_autoindex, endBlockingModAutoIndex)
>
> which brings the following functions into the game:
>
>         int startBlockingModAutoIndex(request_rec *r) {
>                 RequestNote *note = getRequestNote(r);
>                 if (note != 0 && hasModAutoIndex()) {
>                         note->handlerBeforeModAutoIndex = r->handler;
>                         r->handler = "";

"" is what we now call DEFAULT_HANDLER_NAME which we now use to decide
nobody set a handler and things are up for grabs

If this hadn't shipped I'd be inclined to just back it out and revisit
the original issue later (mod_autoindex w/o mod_mime) -- but since it
has, I'd just as well guide passenger to use a non-empty string here
since either way, software needs to be updated.

Open to other points of view though.

From dev-return-84335-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Fri Oct 16 17:35:02 2015
Return-Path: <dev-return-84335-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 63731181DA
	for <apmail-httpd-dev-archive@www.apache.org>; Fri, 16 Oct 2015 17:35:02 +0000 (UTC)
Received: (qmail 72776 invoked by uid 500); 16 Oct 2015 17:34:58 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 72727 invoked by uid 500); 16 Oct 2015 17:34:58 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 72717 invoked by uid 99); 16 Oct 2015 17:34:58 -0000
Received: from Unknown (HELO spamd1-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 16 Oct 2015 17:34:58 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd1-us-west.apache.org (ASF Mail Server at spamd1-us-west.apache.org) with ESMTP id 4057CC1530
	for <dev@httpd.apache.org>; Fri, 16 Oct 2015 17:34:58 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd1-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.01
X-Spam-Level:
X-Spam-Status: No, score=-0.01 tagged_above=-999 required=6.31
	tests=[SPF_PASS=-0.001, T_RP_MATCHES_RCVD=-0.01, URIBL_BLOCKED=0.001]
	autolearn=disabled
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd1-us-west.apache.org [10.40.0.7]) (amavisd-new, port 10024)
	with ESMTP id 6nLYle5Ucgpe for <dev@httpd.apache.org>;
	Fri, 16 Oct 2015 17:34:48 +0000 (UTC)
Received: from mailserver.kippdata.de (capsella.kippdata.de [195.227.30.149])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTP id C0F9E2054C
	for <dev@httpd.apache.org>; Fri, 16 Oct 2015 17:34:47 +0000 (UTC)
Received: from [10.0.110.6] ([192.168.2.104])
	by mailserver.kippdata.de (8.13.5/8.13.5) with ESMTP id t9GHYkXM006840
	for <dev@httpd.apache.org>; Fri, 16 Oct 2015 19:34:47 +0200 (CEST)
Subject: Re: Fwd: [Bug 58498] Apache 2.4.17: Regression with mod_autoindex (in
 combination with Phusion Passenger)
To: dev@httpd.apache.org
References: <bug-58498-7868@https.bz.apache.org/bugzilla/>
 <bug-58498-7868-pmYEvgEoKS@https.bz.apache.org/bugzilla/>
 <CALK=YjMozaD4W+1qOHEaJ4NF=emjP1gmPZSjPRu-jXgh_yo5Ug@mail.gmail.com>
From: Rainer Jung <rainer.jung@kippdata.de>
Message-ID: <5621352C.7020108@kippdata.de>
Date: Fri, 16 Oct 2015 19:34:36 +0200
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:38.0) Gecko/20100101
 Thunderbird/38.3.0
MIME-Version: 1.0
In-Reply-To: <CALK=YjMozaD4W+1qOHEaJ4NF=emjP1gmPZSjPRu-jXgh_yo5Ug@mail.gmail.com>
Content-Type: text/plain; charset=utf-8; format=flowed
Content-Transfer-Encoding: 8bit

Am 16.10.2015 um 19:27 schrieb Eric Covener:
> What's with the backwards start and end there?  Does the
> successor/predecessor override FIRST/MIDDLE/LAST?

backwards?

successor/predecessor are:

static const char * const autoindex_module[] = { "mod_autoindex.c", NULL };

ap_hook_handler(start_blocking_mod_autoindex, NULL, autoindex_module, 
APR_HOOK_LAST);
ap_hook_handler(end_blocking_mod_autoindex, autoindex_module, NULL, 
APR_HOOK_FIRST);

Regards,

Rainer

> ---------- Forwarded message ----------
> From:  <bugzilla@apache.org>
> Date: Fri, Oct 16, 2015 at 1:24 PM
> Subject: [Bug 58498] Apache 2.4.17: Regression with mod_autoindex (in
> combination with Phusion Passenger)
> To: bugs@httpd.apache.org
>
>
> https://bz.apache.org/bugzilla/show_bug.cgi?id=58498
>
> --- Comment #2 from Rainer Jung <rainer.jung@kippdata.de> ---
> I'm not an expert on passenger, but one can see the hook registration at
>
> https://github.com/phusion/passenger/blob/stable-5.0/src/apache2_module/Hooks.cpp
>
> scrolling down to the end of the file.
>
> The code in the file contains some handler juggling and also rules for ordering
> relative to mod_autoindex. Especially
>
> ap_hook_handler(start_blocking_mod_autoindex, NULL, autoindex_module,
> APR_HOOK_LAST);
> ap_hook_handler(end_blocking_mod_autoindex, autoindex_module, NULL,
> APR_HOOK_FIRST);
>
> points to
>
> DEFINE_REQUEST_HOOK(start_blocking_mod_autoindex, startBlockingModAutoIndex)
> DEFINE_REQUEST_HOOK(end_blocking_mod_autoindex, endBlockingModAutoIndex)
>
> which brings the following functions into the game:
>
>          int startBlockingModAutoIndex(request_rec *r) {
>                  RequestNote *note = getRequestNote(r);
>                  if (note != 0 && hasModAutoIndex()) {
>                          note->handlerBeforeModAutoIndex = r->handler;
>                          r->handler = "";
>                  }
>                  return DECLINED;
>          }
>
>          int endBlockingModAutoIndex(request_rec *r) {
>                  RequestNote *note = getRequestNote(r);
>                  if (note != 0 && hasModAutoIndex()) {
>                          r->handler = note->handlerBeforeModAutoIndex;
>                  }
>                  return DECLINED;
>          }
>
>
> In front of them is a comment:
>
>           * mod_autoindex will try to display a directory index for URIs that
> map to a directory.
>           * This is undesired because of page caching semantics. Suppose that a
> Rails application
>           * has an ImagesController which has page caching enabled, and thus
> also a 'public/images'
>           * directory. When the visitor visits /images we'll want the request to
> be forwarded to
>           * the Rails application, instead of displaying a directory index.
>           *
>           * So in this hook method, we temporarily change some fields in the
> request structure
>           * in order to block mod_autoindex. In endBlockingModAutoIndex(), we
> restore the request
>           * structure to its former state.
>
> Not sure whether this is related.
>
> Rainer
>
> --
> You are receiving this mail because:
> You are the assignee for the bug.
>
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: bugs-unsubscribe@httpd.apache.org
> For additional commands, e-mail: bugs-help@httpd.apache.org
>
>
>

-- 
kippdata
informationstechnologie GmbH   Tel: 0228 98549 -0
Bornheimer Str. 33a            Fax: 0228 98549 -50
53111 Bonn                     www.kippdata.de

HRB 8018 Amtsgericht Bonn / USt.-IdNr. DE 196 457 417
Geschäftsführer: Dr. Thomas Höfer, Rainer Jung, Sven Maurmann

From dev-return-84336-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Fri Oct 16 17:37:16 2015
Return-Path: <dev-return-84336-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id E605A181E5
	for <apmail-httpd-dev-archive@www.apache.org>; Fri, 16 Oct 2015 17:37:16 +0000 (UTC)
Received: (qmail 78583 invoked by uid 500); 16 Oct 2015 17:37:16 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 78517 invoked by uid 500); 16 Oct 2015 17:37:16 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 78507 invoked by uid 99); 16 Oct 2015 17:37:16 -0000
Received: from Unknown (HELO spamd1-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 16 Oct 2015 17:37:16 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd1-us-west.apache.org (ASF Mail Server at spamd1-us-west.apache.org) with ESMTP id 02DF2C63CB
	for <dev@httpd.apache.org>; Fri, 16 Oct 2015 17:37:16 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd1-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.099
X-Spam-Level:
X-Spam-Status: No, score=-0.099 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	URIBL_BLOCKED=0.001] autolearn=disabled
Authentication-Results: spamd1-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-us-west.apache.org ([10.40.0.8])
	by localhost (spamd1-us-west.apache.org [10.40.0.7]) (amavisd-new, port 10024)
	with ESMTP id bBixqvtrUuRF for <dev@httpd.apache.org>;
	Fri, 16 Oct 2015 17:37:08 +0000 (UTC)
Received: from mail-ig0-f171.google.com (mail-ig0-f171.google.com [209.85.213.171])
	by mx1-us-west.apache.org (ASF Mail Server at mx1-us-west.apache.org) with ESMTPS id C25D723038
	for <dev@httpd.apache.org>; Fri, 16 Oct 2015 17:37:07 +0000 (UTC)
Received: by igbkq10 with SMTP id kq10so18221749igb.0
        for <dev@httpd.apache.org>; Fri, 16 Oct 2015 10:37:07 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        bh=UI550knzH87/7ddj7Q97yJnZ2zn5kw0upRIgn9KPZ/s=;
        b=ll8RUlyB+OwVPDiaxR25xpUuOKtURq76nQhDzeQd2Hs8zwgAVlYSz+6pGRiAcZZdml
         he6m/ol4T7sczKiaHRPFAJMElrtqm4SMvuyVOawO3xPx3FusY6mHC2t0eEVbUja45cTC
         R+KY5s2Hpa1NIblStHQTjuHxrZbei5pr4M1L6/4A2ssy0Sozvn3/BWngQrMdQFqw3aZ1
         ojX7NivpxR3w9BF9Gd+2Tb+KQpHx5MnWuyxUq1/9Tw8YbKB6g20wEnicUiJBRjlp1woS
         3xinOTW6t84B6pR2Z0BIhM9q9aeOXOHYZe2wIiRYV35hc7zHgFjRJZtvpBfTseCHwIKd
         qs7Q==
MIME-Version: 1.0
X-Received: by 10.50.66.170 with SMTP id g10mr6532440igt.36.1445017027314;
 Fri, 16 Oct 2015 10:37:07 -0700 (PDT)
Received: by 10.64.25.3 with HTTP; Fri, 16 Oct 2015 10:37:07 -0700 (PDT)
In-Reply-To: <5621352C.7020108@kippdata.de>
References: <bug-58498-7868@https.bz.apache.org/bugzilla/>
	<bug-58498-7868-pmYEvgEoKS@https.bz.apache.org/bugzilla/>
	<CALK=YjMozaD4W+1qOHEaJ4NF=emjP1gmPZSjPRu-jXgh_yo5Ug@mail.gmail.com>
	<5621352C.7020108@kippdata.de>
Date: Fri, 16 Oct 2015 13:37:07 -0400
Message-ID: <CALK=YjPqzQuT1baOdKMbTA=YaNwnsqgonPyjHm3nrXBWChixaw@mail.gmail.com>
Subject: Re: Fwd: [Bug 58498] Apache 2.4.17: Regression with mod_autoindex (in
 combination with Phusion Passenger)
From: Eric Covener <covener@gmail.com>
To: Apache HTTP Server Development List <dev@httpd.apache.org>
Content-Type: text/plain; charset=UTF-8

On Fri, Oct 16, 2015 at 1:34 PM, Rainer Jung <rainer.jung@kippdata.de> wrote:
> Am 16.10.2015 um 19:27 schrieb Eric Covener:
>>
>> What's with the backwards start and end there?  Does the
>> successor/predecessor override FIRST/MIDDLE/LAST?
>
>
> backwards?
>
> successor/predecessor are:
>
> static const char * const autoindex_module[] = { "mod_autoindex.c", NULL };
>
> ap_hook_handler(start_blocking_mod_autoindex, NULL, autoindex_module,
> APR_HOOK_LAST);
> ap_hook_handler(end_blocking_mod_autoindex, autoindex_module, NULL,
> APR_HOOK_FIRST);

I mean start_blocking is APR_HOOK_LAST and end_blocking is
APR_HOOK_FIRST which is odd.  I'd have thought start would come before
end :)

I (intuitively only) thought the successor only moved you around
within whatever FIRST/MIDDLE/LAST you picked, but I guess not.


-- 
Eric Covener
covener@gmail.com

From dev-return-84337-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Fri Oct 16 19:08:11 2015
Return-Path: <dev-return-84337-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 3471F18591
	for <apmail-httpd-dev-archive@www.apache.org>; Fri, 16 Oct 2015 19:08:11 +0000 (UTC)
Received: (qmail 98456 invoked by uid 500); 16 Oct 2015 19:08:10 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 98393 invoked by uid 500); 16 Oct 2015 19:08:10 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 98383 invoked by uid 99); 16 Oct 2015 19:08:10 -0000
Received: from Unknown (HELO spamd4-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 16 Oct 2015 19:08:10 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd4-us-west.apache.org (ASF Mail Server at spamd4-us-west.apache.org) with ESMTP id F2357C084E
	for <dev@httpd.apache.org>; Fri, 16 Oct 2015 19:08:09 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd4-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.121
X-Spam-Level:
X-Spam-Status: No, score=-0.121 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RCVD_IN_MSPIKE_H3=-0.01, RCVD_IN_MSPIKE_WL=-0.01, SPF_PASS=-0.001]
	autolearn=disabled
Authentication-Results: spamd4-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-us-west.apache.org ([10.40.0.8])
	by localhost (spamd4-us-west.apache.org [10.40.0.11]) (amavisd-new, port 10024)
	with ESMTP id HGHBETt_8C2n for <dev@httpd.apache.org>;
	Fri, 16 Oct 2015 19:08:09 +0000 (UTC)
Received: from mail-pa0-f54.google.com (mail-pa0-f54.google.com [209.85.220.54])
	by mx1-us-west.apache.org (ASF Mail Server at mx1-us-west.apache.org) with ESMTPS id 3E19222F1F
	for <dev@httpd.apache.org>; Fri, 16 Oct 2015 19:08:09 +0000 (UTC)
Received: by padcn9 with SMTP id cn9so13189510pad.2
        for <dev@httpd.apache.org>; Fri, 16 Oct 2015 12:08:03 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=subject:to:references:from:message-id:date:user-agent:mime-version
         :in-reply-to:content-type:content-transfer-encoding;
        bh=FhOoiQsGoPtUKBJB6pd2bVUkS653Hp43V4EZ6ivZmIM=;
        b=RCNon5TEtw1x9izwOs92eZB0V2v5DIxNo+6akiQGBugUAnpH9XXZV9hFOnvKu/s8wt
         NthGYcB691h+G21+d5xFn2vTgB/0RYj5lVykK4K7Bm7uY/WsAgUHTTpGDxL5dafyvIGb
         4yDmhkOFYkZSTr8As7DtHnkiIVya+G8HfpTsc2vT2HXRBsGiX3bDw1sEU5TRP4fXxcfw
         MGzP7mfqYGHgAqeUvrATjKV3lXxA8H95f4PMFPkIusTn57hhXntUg5vounPVddI85+D6
         7BMlq4dgPnaGrMOz0/Xq60oLPAQyL8yh1SQpqvYQltJspdPTid4iZIiB3+MPaD+NYsGT
         Lf8A==
X-Received: by 10.68.89.33 with SMTP id bl1mr13870489pbb.139.1445022483592;
        Fri, 16 Oct 2015 12:08:03 -0700 (PDT)
Received: from [192.168.1.4] (static-50-43-55-221.bvtn.or.frontiernet.net. [50.43.55.221])
        by smtp.gmail.com with ESMTPSA id ve8sm106728pbc.48.2015.10.16.12.08.02
        for <dev@httpd.apache.org>
        (version=TLSv1.2 cipher=ECDHE-RSA-AES128-GCM-SHA256 bits=128/128);
        Fri, 16 Oct 2015 12:08:02 -0700 (PDT)
Subject: Re: [PATCH 57300] mod_session save optimization
To: dev@httpd.apache.org
References: <934f2ef4f2c04d199f3754e24a4b3a64@us-aus-exch5.ni.corp.natinst.com>
 <56201261.6040707@ni.com>
From: Jacob Champion <champion.p@gmail.com>
Message-ID: <56214B11.1040906@gmail.com>
Date: Fri, 16 Oct 2015 12:08:01 -0700
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:38.0) Gecko/20100101
 Thunderbird/38.3.0
MIME-Version: 1.0
In-Reply-To: <56201261.6040707@ni.com>
Content-Type: text/plain; charset=utf-8; format=flowed
Content-Transfer-Encoding: 7bit

On 10/15/2015 01:53 PM, Paul Spangler wrote:
> Bump in case anyone is interested now that the list has died down a bit.

I'm a little biased :) but I am still interested.

 From a practical angle, Paul's patch makes session-based applications 
usable with databases that have more expensive writes (SQLite being a 
key example). Without this feature, we saw the server's performance 
crater when a moderate number (100's) of requests were made in a short 
period of time.

 From a technical angle, it doesn't make sense to me that every request 
results in a write to the database when using mod_session_dbd. As it 
stands now, I don't feel like mod_session is production-ready when 
combined with a SQLite backend.

 From an emotional angle, Paul has been patiently pinging the list with 
no response for two months now. Surely he deserves some reply, even if 
it's just an explanation of why there is no interest in the feature? It 
feels like mod_session and friends need some love.

--Jacob

From dev-return-84338-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Fri Oct 16 21:52:10 2015
Return-Path: <dev-return-84338-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id A03F818CDA
	for <apmail-httpd-dev-archive@www.apache.org>; Fri, 16 Oct 2015 21:52:10 +0000 (UTC)
Received: (qmail 67531 invoked by uid 500); 16 Oct 2015 21:52:05 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 67450 invoked by uid 500); 16 Oct 2015 21:52:05 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 67437 invoked by uid 99); 16 Oct 2015 21:52:05 -0000
Received: from Unknown (HELO spamd2-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 16 Oct 2015 21:52:05 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd2-us-west.apache.org (ASF Mail Server at spamd2-us-west.apache.org) with ESMTP id C115F1A0964
	for <dev@httpd.apache.org>; Fri, 16 Oct 2015 21:52:04 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd2-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.119
X-Spam-Level:
X-Spam-Status: No, score=-0.119 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RCVD_IN_MSPIKE_H3=-0.01, RCVD_IN_MSPIKE_WL=-0.01, URIBL_BLOCKED=0.001]
	autolearn=disabled
Authentication-Results: spamd2-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd2-us-west.apache.org [10.40.0.9]) (amavisd-new, port 10024)
	with ESMTP id ppkqn7FttJK9 for <dev@httpd.apache.org>;
	Fri, 16 Oct 2015 21:51:54 +0000 (UTC)
Received: from mail-qk0-f174.google.com (mail-qk0-f174.google.com [209.85.220.174])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id A558342B35
	for <dev@httpd.apache.org>; Fri, 16 Oct 2015 21:51:54 +0000 (UTC)
Received: by qkas79 with SMTP id s79so60503063qka.0
        for <dev@httpd.apache.org>; Fri, 16 Oct 2015 14:51:48 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        bh=U84q8tUlmmViOV5sWPAp5wgBXhPXZ9tyyufyrCGdpfY=;
        b=G4Lt907Qhnj2S7D+CJ82atDXg+D4gQ29aHWG3LMRT6wAeVhKpT9ZKtZuuMwcqS++bg
         PzglNHCIGg3iL1u3/OLdQM3EfTlS9iTWTI7kNPjhTXigpx7HVTOMxb7DRv37BYkyI/L5
         l4wF/cIsWwo6+33wv2kDyldbPrr1zRCOOo6Zi83BHzqMWVyA3y1/lfdpY9xWmp0avtFW
         eeyehIGLBvFRaSEc1DdtNfIAuy3+wmv3rULmkOXyxqocSABRlD+6RADkkhihaxR8olx/
         0bTlX4tZEkZeb6xYSMN+ILn4PMuBuwtWuADBtsDJHz9tC2UvGdmvkYdWpTYOWQFHMtVY
         ya+w==
MIME-Version: 1.0
X-Received: by 10.55.192.15 with SMTP id o15mr22246253qki.2.1445032308211;
 Fri, 16 Oct 2015 14:51:48 -0700 (PDT)
Received: by 10.55.156.213 with HTTP; Fri, 16 Oct 2015 14:51:48 -0700 (PDT)
In-Reply-To: <56201261.6040707@ni.com>
References: <934f2ef4f2c04d199f3754e24a4b3a64@us-aus-exch5.ni.corp.natinst.com>
	<56201261.6040707@ni.com>
Date: Fri, 16 Oct 2015 23:51:48 +0200
Message-ID: <CAKQ1sVN9h9=YQ9w6TBWeAXRz+ANN-aqEVpvE24T5N2hyn1+nkg@mail.gmail.com>
Subject: Re: [PATCH 57300] mod_session save optimization
From: Yann Ylavic <ylavic.dev@gmail.com>
To: dev@httpd.apache.org
Content-Type: text/plain; charset=UTF-8

Hello Paul,

sorry for the delay...

On Thu, Oct 15, 2015 at 10:53 PM, Paul Spangler <paul.spangler@ni.com> wrote:
> On 8/20/2015 4:58 PM, Paul Spangler wrote:
>>
>> The bug report contains a more detailed explanation of the patch, but
>> there are some points I thought might lead to some discussion.

Didn't look at the details yet, but the approach looks sensible.
The test suite is appreciated too!

>>
> Bump in case anyone is interested now that the list has died down a bit.

Will take a closer look and comment/commit soon, reporting on bugzilla.
Thanks for the patch anyway, and your perseverence :)

Regards,
Yann.

From dev-return-84339-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Sat Oct 17 08:58:37 2015
Return-Path: <dev-return-84339-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id CD56618A7F
	for <apmail-httpd-dev-archive@www.apache.org>; Sat, 17 Oct 2015 08:58:37 +0000 (UTC)
Received: (qmail 50858 invoked by uid 500); 17 Oct 2015 08:58:35 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 50800 invoked by uid 500); 17 Oct 2015 08:58:35 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 50787 invoked by uid 99); 17 Oct 2015 08:58:35 -0000
Received: from Unknown (HELO spamd1-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 17 Oct 2015 08:58:35 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd1-us-west.apache.org (ASF Mail Server at spamd1-us-west.apache.org) with ESMTP id 2123AC521E
	for <dev@httpd.apache.org>; Sat, 17 Oct 2015 08:58:35 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd1-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.109
X-Spam-Level:
X-Spam-Status: No, score=-0.109 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	T_RP_MATCHES_RCVD=-0.01, URIBL_BLOCKED=0.001] autolearn=disabled
Authentication-Results: spamd1-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=velox.ch header.b=tBiEC7Sv;
	dkim=pass (2048-bit key) header.d=velox.ch header.b=KR+yZw4p
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd1-us-west.apache.org [10.40.0.7]) (amavisd-new, port 10024)
	with ESMTP id DE2aUPyPSMZl for <dev@httpd.apache.org>;
	Sat, 17 Oct 2015 08:58:24 +0000 (UTC)
Received: from fornix.velox.ch (fornix.velox.ch [85.25.46.13])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id 5118B439C9
	for <dev@httpd.apache.org>; Sat, 17 Oct 2015 08:58:24 +0000 (UTC)
Received: from cortex.velox.ch (77-57-164-164.dclient.hispeed.ch [77.57.164.164])
	(authenticated bits=0)
	by fornix.velox.ch (8.14.9/8.14.9/2.2) with ESMTP id t9H8wEBm010458
	(version=TLSv1/SSLv3 cipher=DHE-RSA-AES256-GCM-SHA384 bits=256 verify=OK)
	for <dev@httpd.apache.org>; Sat, 17 Oct 2015 10:58:14 +0200
DKIM-Signature: v=1; a=rsa-sha256; c=simple/simple; d=velox.ch;
	s=fornix-727e; t=1445072295;
	bh=EsN+dkTXiLz0iy8krqIUHF6m8QKOI/21OJJ2sHYHyvY=;
	h=Subject:To:References:From:Date:In-Reply-To;
	b=tBiEC7Svu5psyKnQOfGsVvgcCWMR92daNWrT97c9zFQohvcNQIPo0agJzr88Q5hUO
	 oJapjWj7xExSG7oqzlvPR6pwSA6OwZRz3stLcJ6qbaHBSN3592OTReZd3VilY0qqJE
	 H3fLscQIZvNPlPQ7IpzqSs8iAqFDD/q0P5gCf1+clrH7RPWYCQd8M2j/RdHmTXEF9L
	 q/ClHRNB7JwDjg3y0gVUzIDUgj3YtmPfnvm7L34DwgU8B/Cdvol0cVDnvOaNLoUzjs
	 YPF3zwSZjytd0y5ibDphPvIjEfjyjO6KpGI8xAwZ9Zk1JHLSzs+yZ7Dbr9ilZHkklv
	 YneaKG1pyo3Fw==
Subject: Re: http2 tests
DKIM-Signature: v=1; a=rsa-sha256; c=simple/simple; d=velox.ch;
	s=cortex-8a58; t=1445072293;
	bh=EsN+dkTXiLz0iy8krqIUHF6m8QKOI/21OJJ2sHYHyvY=;
	h=Subject:To:References:From:Date:In-Reply-To;
	b=KR+yZw4p54aYzxc46t6UVRRn/e/Yrg92MAv2rK5YUEBT1p4A6Wl61zww2zMklKKP9
	 04uPqtNY9jDBgQR7kQoJ+4teWnK2pOBQuZ3ExQ9yLr8Bt2HURxnr4FYxQ+f/cSr2nE
	 dDhOWv1luetL/YJm1Nj2MXrfStbXOay1iaxXS57u1Nl/6nkWiqZUXg2BlF4PA5Rb03
	 CN4CL11gHZroDKNdIoU6OpSnOsXxVREHLB323ZEmjkJfcNIL8jwr7Prz9EYV+AXnHm
	 6qSJGb2strn6T+5lyEbiigzxhzFbNqvsPobEF1dKaxcQb8B5CFH+v2P3RnAwMonzHd
	 DNl4KX9+5ytsg==
To: dev@httpd.apache.org
References: <F6FE5241-F149-41BF-9EBD-21A7DBD07336@greenbytes.de>
 <CALK=YjMg5yxpSJiT1Gdh+_oN=gh44fLKXWVCcP09NQS+R38WxQ@mail.gmail.com>
From: Kaspar Brand <httpd-dev.2014@velox.ch>
Message-ID: <56220DA6.5070909@velox.ch>
Date: Sat, 17 Oct 2015 10:58:14 +0200
MIME-Version: 1.0
In-Reply-To: <CALK=YjMg5yxpSJiT1Gdh+_oN=gh44fLKXWVCcP09NQS+R38WxQ@mail.gmail.com>
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit

On 14.10.2015 14:55, Eric Covener wrote:
> On Wed, Oct 14, 2015 at 8:37 AM, Stefan Eissing
> <stefan.eissing@greenbytes.de> wrote:
>> Any advice on how to add a test host (e.g. real port) to our test suite in the most compatible way?
> 
> 1426878 added an SSL vhost. It seems like there is a magic port
> assignment the config-generator and client share info about .

Not sure if I'm too late with this, but just add something like the
below - this will add the required Listen and VirtualHost directives to
the generated config files (with an auto-assigned port number).

Kaspar

--- t/conf/ssl/ssl.conf.in      (revision 1709127)
+++ t/conf/ssl/ssl.conf.in      (working copy)
@@ -252,4 +252,10 @@
          SSLCipherSuite AES256-SHA
     </Location>

+    <VirtualHost ssl_http2>
+        SSLEngine On
+
+        # ...
+    </VirtualHost>
+
 </IfModule>



From dev-return-84340-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Sat Oct 17 09:18:51 2015
Return-Path: <dev-return-84340-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 8BD6C18B09
	for <apmail-httpd-dev-archive@www.apache.org>; Sat, 17 Oct 2015 09:18:51 +0000 (UTC)
Received: (qmail 69565 invoked by uid 500); 17 Oct 2015 09:18:51 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 69491 invoked by uid 500); 17 Oct 2015 09:18:51 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 69480 invoked by uid 99); 17 Oct 2015 09:18:51 -0000
Received: from Unknown (HELO spamd2-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 17 Oct 2015 09:18:51 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd2-us-west.apache.org (ASF Mail Server at spamd2-us-west.apache.org) with ESMTP id 875E61A0A32
	for <dev@httpd.apache.org>; Sat, 17 Oct 2015 09:18:50 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd2-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.11
X-Spam-Level:
X-Spam-Status: No, score=-0.11 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	T_RP_MATCHES_RCVD=-0.01] autolearn=disabled
Authentication-Results: spamd2-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=velox.ch header.b=q9RFShSJ;
	dkim=pass (2048-bit key) header.d=velox.ch header.b=duIFBj2V
Received: from mx1-us-west.apache.org ([10.40.0.8])
	by localhost (spamd2-us-west.apache.org [10.40.0.9]) (amavisd-new, port 10024)
	with ESMTP id nu_LWt4lqmB6 for <dev@httpd.apache.org>;
	Sat, 17 Oct 2015 09:18:45 +0000 (UTC)
Received: from fornix.velox.ch (fornix.velox.ch [85.25.46.13])
	by mx1-us-west.apache.org (ASF Mail Server at mx1-us-west.apache.org) with ESMTPS id 394922118F
	for <dev@httpd.apache.org>; Sat, 17 Oct 2015 09:18:45 +0000 (UTC)
Received: from cortex.velox.ch (77-57-164-164.dclient.hispeed.ch [77.57.164.164])
	(authenticated bits=0)
	by fornix.velox.ch (8.14.9/8.14.9/2.2) with ESMTP id t9H9IXWM010609
	(version=TLSv1/SSLv3 cipher=DHE-RSA-AES256-GCM-SHA384 bits=256 verify=OK)
	for <dev@httpd.apache.org>; Sat, 17 Oct 2015 11:18:33 +0200
DKIM-Signature: v=1; a=rsa-sha256; c=simple/simple; d=velox.ch;
	s=fornix-727e; t=1445073514;
	bh=jY09IrkQZruBMaEwyzxcdv/dqY/gqR3KISXi4b0a+DU=;
	h=Subject:To:References:From:Date:In-Reply-To;
	b=q9RFShSJwNghF5w5hEBr5ZNnZH8j6znjH3gb/CKHQoomCu60tH1VwOBvEX+bshk8o
	 0F4MgHK8LnZ1pDwkkcXZziyOJaYG3MbRD3Irgl4mpLeuhQpUc4Qz79NuXUPDSdQnwA
	 yq57OZIfX8hhLF7WFLq5DjkqdcSxk5hbCHux/euXOpRxwsMe9IkdSJciXcTpZ28RvF
	 YMEbmS1DA8lHt58d7ziGPW5M4auzd4OuOOZUj6REWjke6z9Q9W2yDEblRKNh6oM30+
	 4dF1GoxTTUsph3iZ6kJzRDDPs0H+j6R1L8frbbAKeSPZxsswY0GFG1x4UHs6kvJCFp
	 zerIQQy5zUdUw==
Subject: Re: H2 compatible ciphers
DKIM-Signature: v=1; a=rsa-sha256; c=simple/simple; d=velox.ch;
	s=cortex-8a58; t=1445073512;
	bh=jY09IrkQZruBMaEwyzxcdv/dqY/gqR3KISXi4b0a+DU=;
	h=Subject:To:References:From:Date:In-Reply-To;
	b=duIFBj2Vl3zqRdnkgAeC6oyaGhtWOObHrLKl7UlvhZDiTnicuzPvBuvCPLQ5lkMAe
	 NaOTP4slLZG6WqPCNS57cnLzdcfutykbmCaRiUvftG9ViNv98PFOkzOKPjAEP0AsTF
	 jk0zuRiq3ONJu4IfWudMyHEfEpUN+WMkW4NzVlq/mK1+yrLI/x/uCXsxQHElccJyJj
	 FYOKbEF2PwT3QEWNImC4y4Cx1vMFmEmJzwzJlhzzm3invqSEDXW7AEB5f4vEOMZN6h
	 Z5LufzcYunq/2SOs2GNiGPTZrB0/PPAHlNC4ZraZT9ngTo+eodPxBzz5Xxxs8kY428
	 id2qxLoUTDgYw==
To: dev@httpd.apache.org
References: <CAKQ1sVNx3g2PjkxG6z2LwqA6CuJeVv2L6SryVsMWp2SydoKFjQ@mail.gmail.com>
 <7785D0B9-E1C7-483E-B468-CBDFA99156BB@greenbytes.de>
From: Kaspar Brand <httpd-dev.2014@velox.ch>
Message-ID: <5622126A.7040601@velox.ch>
Date: Sat, 17 Oct 2015 11:18:34 +0200
MIME-Version: 1.0
In-Reply-To: <7785D0B9-E1C7-483E-B468-CBDFA99156BB@greenbytes.de>
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit

On 16.10.2015 12:45, Stefan Eissing wrote:
> If the blacklist in RFC 7540 proves to be totally bogus, I'd favor
> ditching it in our server checks.

Sharing Yann's surprise about this huge blacklist... I'm also wondering
if this won't become a Sisyphean task, in the end (will the httpwg
regularly amend that list, BTW, or how do they intend to prevent
"unwanted" cipher suites from being used with HTTP/2?).

Another - quite radical - approach would consist of using a whitelist,
which consists of a single cipher suite only: given that section 9.2 of
RFC 7540 states

"Implementations of HTTP/2 MUST use TLS version 1.2"

and section 9.2.2 further says

"deployments of HTTP/2 that use TLS 1.2 MUST support
TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256 [TLS-ECDHE] with the P-256
elliptic curve [FIPS186]"

then "H2Compliance on" would only have to make sure that this exact
suite is negotiated. (What this MTI cipher suite also means, IINM, is
that you can't run an RFC 7540 h2 compliant server with an ECDSA key
only, actually... not sure if that was really an intended effect of this
requirement.)

Kaspar

From dev-return-84341-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Sat Oct 17 09:51:15 2015
Return-Path: <dev-return-84341-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id C792518B73
	for <apmail-httpd-dev-archive@www.apache.org>; Sat, 17 Oct 2015 09:51:15 +0000 (UTC)
Received: (qmail 91898 invoked by uid 500); 17 Oct 2015 09:51:15 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 91819 invoked by uid 500); 17 Oct 2015 09:51:15 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 91806 invoked by uid 99); 17 Oct 2015 09:51:15 -0000
Received: from Unknown (HELO spamd4-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 17 Oct 2015 09:51:15 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd4-us-west.apache.org (ASF Mail Server at spamd4-us-west.apache.org) with ESMTP id DFF28C0BE5
	for <dev@httpd.apache.org>; Sat, 17 Oct 2015 09:51:14 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd4-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.011
X-Spam-Level:
X-Spam-Status: No, score=-0.011 tagged_above=-999 required=6.31
	tests=[SPF_HELO_PASS=-0.001, T_RP_MATCHES_RCVD=-0.01]
	autolearn=disabled
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd4-us-west.apache.org [10.40.0.11]) (amavisd-new, port 10024)
	with ESMTP id WA5Bmh8dVf_6 for <dev@httpd.apache.org>;
	Sat, 17 Oct 2015 09:51:00 +0000 (UTC)
Received: from mail.thelounge.net (mail.thelounge.net [91.118.73.15])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id A3CE942B35
	for <dev@httpd.apache.org>; Sat, 17 Oct 2015 09:50:59 +0000 (UTC)
Subject: Re: H2 compatible ciphers
To: dev@httpd.apache.org
References: <CAKQ1sVNx3g2PjkxG6z2LwqA6CuJeVv2L6SryVsMWp2SydoKFjQ@mail.gmail.com>
 <7785D0B9-E1C7-483E-B468-CBDFA99156BB@greenbytes.de>
 <5622126A.7040601@velox.ch>
From: Reindl Harald <h.reindl@thelounge.net>
Openpgp: id=13540402D67A7F71C6E974EA866063CF7F780279;
 url=https://arrakis.thelounge.net/gpg/h.reindl_thelounge.net.pub.txt
X-Enigmail-Draft-Status: N1110
Organization: the lounge interactive design
Message-ID: <56221A00.6030201@thelounge.net>
Date: Sat, 17 Oct 2015 11:50:56 +0200
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:38.0) Gecko/20100101
 Thunderbird/38.3.0
MIME-Version: 1.0
In-Reply-To: <5622126A.7040601@velox.ch>
Content-Type: multipart/signed; micalg=pgp-sha1;
 protocol="application/pgp-signature";
 boundary="T03D8qd1foCVtJl4xW05PnDg7QqI9fqHf"

This is an OpenPGP/MIME signed message (RFC 4880 and 3156)
--T03D8qd1foCVtJl4xW05PnDg7QqI9fqHf
Content-Type: text/plain; charset=utf-8; format=flowed
Content-Transfer-Encoding: quoted-printable



Am 17.10.2015 um 11:18 schrieb Kaspar Brand:
> Another - quite radical - approach would consist of using a whitelist,
> which consists of a single cipher suite only: given that section 9.2 of=

> RFC 7540 states
>
> "Implementations of HTTP/2 MUST use TLS version 1.2"
>
> and section 9.2.2 further says
>
> "deployments of HTTP/2 that use TLS 1.2 MUST support
> TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256 [TLS-ECDHE] with the P-256
> elliptic curve [FIPS186]"
>
> then "H2Compliance on" would only have to make sure that this exact
> suite is negotiated. (What this MTI cipher suite also means, IINM, is
> that you can't run an RFC 7540 h2 compliant server with an ECDSA key
> only, actually... not sure if that was really an intended effect of thi=
s
> requirement.)

terrible idea because it would lead to disable new, safer and=20
recommended ciphers in the future until somebody adds them to the whiteli=
st

so users (clientside) would have to wait for openssl *and* apache after=20
their browser has already support and with the current release cycles of =

all major browsers it's likely to end that way


--T03D8qd1foCVtJl4xW05PnDg7QqI9fqHf
Content-Type: application/pgp-signature; name="signature.asc"
Content-Description: OpenPGP digital signature
Content-Disposition: attachment; filename="signature.asc"

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v2

iEYEARECAAYFAlYiGgEACgkQhmBjz394AnmInQCdGSA+n3DIjD18/RXCu9JPvOwV
sTEAmwdta+YvNhy6SiOtGnXb1UKoKqv9
=rAx7
-----END PGP SIGNATURE-----

--T03D8qd1foCVtJl4xW05PnDg7QqI9fqHf--

From dev-return-84342-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Sat Oct 17 13:30:27 2015
Return-Path: <dev-return-84342-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id E67DB18DE6
	for <apmail-httpd-dev-archive@www.apache.org>; Sat, 17 Oct 2015 13:30:26 +0000 (UTC)
Received: (qmail 72795 invoked by uid 500); 17 Oct 2015 13:30:26 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 72714 invoked by uid 500); 17 Oct 2015 13:30:26 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 72702 invoked by uid 99); 17 Oct 2015 13:30:26 -0000
Received: from Unknown (HELO spamd4-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 17 Oct 2015 13:30:26 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd4-us-west.apache.org (ASF Mail Server at spamd4-us-west.apache.org) with ESMTP id 9CE36C0AB3
	for <dev@httpd.apache.org>; Sat, 17 Oct 2015 13:30:25 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd4-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.01
X-Spam-Level:
X-Spam-Status: No, score=-0.01 tagged_above=-999 required=6.31
	tests=[SPF_PASS=-0.001, T_RP_MATCHES_RCVD=-0.01, URIBL_BLOCKED=0.001]
	autolearn=disabled
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd4-us-west.apache.org [10.40.0.11]) (amavisd-new, port 10024)
	with ESMTP id CWobVeAcDNlO for <dev@httpd.apache.org>;
	Sat, 17 Oct 2015 13:30:14 +0000 (UTC)
Received: from mail.greenbytes.de (mail.greenbytes.de [217.91.35.233])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id 549C320B89
	for <dev@httpd.apache.org>; Sat, 17 Oct 2015 13:30:14 +0000 (UTC)
Received: from [192.168.178.52] (unknown [93.211.108.231])
	(using TLSv1 with cipher ECDHE-RSA-AES256-SHA (256/256 bits))
	(Client did not present a certificate)
	by mail.greenbytes.de (Postfix) with ESMTPSA id E530715A03F4
	for <dev@httpd.apache.org>; Sat, 17 Oct 2015 15:30:06 +0200 (CEST)
From: Stefan Eissing <stefan.eissing@greenbytes.de>
Content-Type: text/plain;
	charset=us-ascii
Content-Transfer-Encoding: quoted-printable
Mime-Version: 1.0 (1.0)
Subject: Re: http2 tests
Message-Id: <D3820D51-16D5-4AA9-9F3D-163C24D60C14@greenbytes.de>
Date: Sat, 17 Oct 2015 15:30:06 +0200
References: <F6FE5241-F149-41BF-9EBD-21A7DBD07336@greenbytes.de> <CALK=YjMg5yxpSJiT1Gdh+_oN=gh44fLKXWVCcP09NQS+R38WxQ@mail.gmail.com> <56220DA6.5070909@velox.ch>
In-Reply-To: <56220DA6.5070909@velox.ch>
To: dev@httpd.apache.org
X-Mailer: iPhone Mail (13A452)

Thanks! Yes, I have sth like this in the works in order to test more specifi=
c http2 edge cases. You'll probably see it sometime next week.=20

> Am 17.10.2015 um 10:58 schrieb Kaspar Brand <httpd-dev.2014@velox.ch>:
>=20
>> On 14.10.2015 14:55, Eric Covener wrote:
>> On Wed, Oct 14, 2015 at 8:37 AM, Stefan Eissing
>> <stefan.eissing@greenbytes.de> wrote:
>>> Any advice on how to add a test host (e.g. real port) to our test suite i=
n the most compatible way?
>>=20
>> 1426878 added an SSL vhost. It seems like there is a magic port
>> assignment the config-generator and client share info about .
>=20
> Not sure if I'm too late with this, but just add something like the
> below - this will add the required Listen and VirtualHost directives to
> the generated config files (with an auto-assigned port number).
>=20
> Kaspar
>=20
> --- t/conf/ssl/ssl.conf.in      (revision 1709127)
> +++ t/conf/ssl/ssl.conf.in      (working copy)
> @@ -252,4 +252,10 @@
>          SSLCipherSuite AES256-SHA
>     </Location>
>=20
> +    <VirtualHost ssl_http2>
> +        SSLEngine On
> +
> +        # ...
> +    </VirtualHost>
> +
> </IfModule>
>=20
>=20

From dev-return-84343-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Sat Oct 17 13:37:41 2015
Return-Path: <dev-return-84343-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 6413E18E10
	for <apmail-httpd-dev-archive@www.apache.org>; Sat, 17 Oct 2015 13:37:41 +0000 (UTC)
Received: (qmail 81993 invoked by uid 500); 17 Oct 2015 13:37:41 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 81935 invoked by uid 500); 17 Oct 2015 13:37:40 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 81925 invoked by uid 99); 17 Oct 2015 13:37:40 -0000
Received: from Unknown (HELO spamd2-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 17 Oct 2015 13:37:40 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd2-us-west.apache.org (ASF Mail Server at spamd2-us-west.apache.org) with ESMTP id 884A71A2663
	for <dev@httpd.apache.org>; Sat, 17 Oct 2015 13:37:40 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd2-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.01
X-Spam-Level:
X-Spam-Status: No, score=-0.01 tagged_above=-999 required=6.31
	tests=[SPF_PASS=-0.001, T_RP_MATCHES_RCVD=-0.01, URIBL_BLOCKED=0.001]
	autolearn=disabled
Received: from mx1-us-west.apache.org ([10.40.0.8])
	by localhost (spamd2-us-west.apache.org [10.40.0.9]) (amavisd-new, port 10024)
	with ESMTP id yBUYa28D3ugI for <dev@httpd.apache.org>;
	Sat, 17 Oct 2015 13:37:32 +0000 (UTC)
Received: from mail.greenbytes.de (mail.greenbytes.de [217.91.35.233])
	by mx1-us-west.apache.org (ASF Mail Server at mx1-us-west.apache.org) with ESMTPS id 3ED1721165
	for <dev@httpd.apache.org>; Sat, 17 Oct 2015 13:37:32 +0000 (UTC)
Received: from [192.168.178.52] (unknown [93.211.108.231])
	(using TLSv1 with cipher ECDHE-RSA-AES256-SHA (256/256 bits))
	(Client did not present a certificate)
	by mail.greenbytes.de (Postfix) with ESMTPSA id 81FB715A0448
	for <dev@httpd.apache.org>; Sat, 17 Oct 2015 15:37:23 +0200 (CEST)
From: Stefan Eissing <stefan.eissing@greenbytes.de>
Content-Type: text/plain;
	charset=us-ascii
Content-Transfer-Encoding: quoted-printable
Mime-Version: 1.0 (1.0)
Subject: Re: H2 compatible ciphers
Message-Id: <0D0F6A42-5896-47F6-8F34-CCF1839EF39A@greenbytes.de>
Date: Sat, 17 Oct 2015 15:37:22 +0200
References: <CAKQ1sVNx3g2PjkxG6z2LwqA6CuJeVv2L6SryVsMWp2SydoKFjQ@mail.gmail.com> <7785D0B9-E1C7-483E-B468-CBDFA99156BB@greenbytes.de> <5622126A.7040601@velox.ch> <56221A00.6030201@thelounge.net>
In-Reply-To: <56221A00.6030201@thelounge.net>
To: dev@httpd.apache.org
X-Mailer: iPhone Mail (13A452)

Yes, I think whatever improvements we make, they need to be open for admin o=
verrides. OTOH the majority of the deployments will want to have sth like mo=
dern/intermediate/old and get whatever that exactly means delivered by us as=
 regular updates in releases (or via their distros).

Especially with more sites adding https for h2 and hopefully let's encrypt c=
oming online soon.=20

> Am 17.10.2015 um 11:50 schrieb Reindl Harald <h.reindl@thelounge.net>:
>=20
>=20
>=20
>> Am 17.10.2015 um 11:18 schrieb Kaspar Brand:
>> Another - quite radical - approach would consist of using a whitelist,
>> which consists of a single cipher suite only: given that section 9.2 of
>> RFC 7540 states
>>=20
>> "Implementations of HTTP/2 MUST use TLS version 1.2"
>>=20
>> and section 9.2.2 further says
>>=20
>> "deployments of HTTP/2 that use TLS 1.2 MUST support
>> TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256 [TLS-ECDHE] with the P-256
>> elliptic curve [FIPS186]"
>>=20
>> then "H2Compliance on" would only have to make sure that this exact
>> suite is negotiated. (What this MTI cipher suite also means, IINM, is
>> that you can't run an RFC 7540 h2 compliant server with an ECDSA key
>> only, actually... not sure if that was really an intended effect of this
>> requirement.)
>=20
> terrible idea because it would lead to disable new, safer and recommended c=
iphers in the future until somebody adds them to the whitelist
>=20
> so users (clientside) would have to wait for openssl *and* apache after th=
eir browser has already support and with the current release cycles of all m=
ajor browsers it's likely to end that way
>=20

From dev-return-84344-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Sun Oct 18 07:15:16 2015
Return-Path: <dev-return-84344-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 7FE7B18BC3
	for <apmail-httpd-dev-archive@www.apache.org>; Sun, 18 Oct 2015 07:15:16 +0000 (UTC)
Received: (qmail 65914 invoked by uid 500); 18 Oct 2015 07:15:16 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 65839 invoked by uid 500); 18 Oct 2015 07:15:16 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 65830 invoked by uid 99); 18 Oct 2015 07:15:15 -0000
Received: from mail-relay.apache.org (HELO mail-relay.apache.org) (140.211.11.15)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 18 Oct 2015 07:15:15 +0000
Received: from asf-bz1-us-mid.priv.apache.org (nat1-us-mid.apache.org [23.253.172.122])
	by mail-relay.apache.org (ASF Mail Server at mail-relay.apache.org) with ESMTPS id 96F721A0256
	for <dev@httpd.apache.org>; Sun, 18 Oct 2015 07:15:15 +0000 (UTC)
Received: by asf-bz1-us-mid.priv.apache.org (ASF Mail Server at asf-bz1-us-mid.priv.apache.org, from userid 0)
	id 17A21605FE; Sun, 18 Oct 2015 07:15:15 +0000 (UTC)
From: bugzilla@apache.org
To: dev@httpd.apache.org
Subject: Bug report for Apache httpd-2 [2015/10/18]
Message-Id: <20151018071515.17A21605FE@asf-bz1-us-mid.priv.apache.org>
Date: Sun, 18 Oct 2015 07:15:05 +0000 (UTC)

+---------------------------------------------------------------------------+
| Bugzilla Bug ID                                                           |
|     +---------------------------------------------------------------------+
|     | Status: UNC=Unconfirmed NEW=New         ASS=Assigned                |
|     |         OPN=Reopened    VER=Verified    (Skipped Closed/Resolved)   |
|     |   +-----------------------------------------------------------------+
|     |   | Severity: BLK=Blocker CRI=Critical  REG=Regression  MAJ=Major   |
|     |   |           MIN=Minor   NOR=Normal    ENH=Enhancement TRV=Trivial |
|     |   |   +-------------------------------------------------------------+
|     |   |   | Date Posted                                                 |
|     |   |   |          +--------------------------------------------------+
|     |   |   |          | Description                                      |
|     |   |   |          |                                                  |
| 7483|Ass|Enh|2002-03-26|Add FileAction directive to assign a cgi interpret|
| 8713|Inf|Min|2002-05-01|No Errorlog on PROPFIND/Depth:Infinity            |
| 8867|Opn|Cri|2002-05-07|exports.c generation fails when using a symlink to|
|10747|New|Maj|2002-07-12|ftp SIZE command and 'smart' ftp servers results i|
|11294|New|Enh|2002-07-30|desired vhost_alias option                        |
|11580|Opn|Enh|2002-08-09|generate Content-Location headers                 |
|12033|Opn|Nor|2002-08-26|Graceful restart immediately result in [warn] long|
|12680|New|Enh|2002-09-16|Digest authentication with integrity protection   |
|13599|Inf|Nor|2002-10-14|autoindex formating broken for multibyte sequences|
|13661|Ass|Enh|2002-10-15|Apache cannot not handle dynamic IP reallocation  |
|14104|Opn|Enh|2002-10-30|not documented: must restart server to load new CR|
|14496|New|Enh|2002-11-13|Cannot upgrade any version on Windows. Must uninst|
|14922|Inf|Enh|2002-11-28|<target> is currently hardcoded to 'apache2'      |
|15719|Inf|Nor|2002-12-30|WebDAV MOVE to destination URI which is content-ne|
|16761|Inf|Nor|2003-02-04|CustomLog with pipe spawns process during config  |
|16802|New|Enh|2003-02-05|Additional AllowOverride directive "Restrict"     |
|16811|Ass|Maj|2003-02-05|mod_autoindex always return webpages in UTF-8.    |
|17107|New|Min|2003-02-16|Windows should not install printenv               |
|17114|New|Enh|2003-02-17|Please add strip and install-strip targets to Make|
|17244|Ass|Nor|2003-02-20|./configure --help gives false information regardi|
|17497|Opn|Nor|2003-02-27|mod_mime_magic generates incorrect response header|
|18325|New|Enh|2003-03-25|PAM support for suEXEC                            |
|18334|Inf|Cri|2003-03-25|Server crashes when authenticating users against L|
|18497|New|Min|2003-03-30|configure --help gives wrong default for sysconfdi|
|19043|New|Min|2003-04-15|Interesting interaction between cern_meta module a|
|19670|New|Enh|2003-05-05|content type header supplied upon PUT is thrown aw|
|20036|Ass|Nor|2003-05-19|Trailing Dots stripped from PATH_INFO environment |
|21253|New|Nor|2003-07-01|Mime magic doesn't continue if type is specifed fo|
|21260|New|Nor|2003-07-02|CacheMaxExpire directive not enforced !           |
|21533|Ass|Cri|2003-07-11|Multiple levels of htacces files can cause mod_aut|
|22138|Inf|Cri|2003-08-05|Webdav is not preccessing special chars right.    |
|22237|New|Enh|2003-08-08|option to disable ServerSignature on index pages  |
|22484|Opn|Maj|2003-08-16|semaphore problem takes httpd down                |
|22686|Opn|Nor|2003-08-25|ab: apr_poll: The timeout specified has expired (7|
|22898|Opn|Nor|2003-09-02|nph scripts with two HTTP header                  |
|23167|Inf|Cri|2003-09-14|--enable-layout never goes to apr apr-util        |
|23181|New|Nor|2003-09-15|Status 304 (Not modified) and chunking leads to an|
|23238|New|Cri|2003-09-18|non-async-signal-safe operations from signal handl|
|23330|New|Enh|2003-09-22|Enhance ApacheMonitor to view and control Tomcat s|
|23911|Opn|Cri|2003-10-18|CGI processes left defunct/zombie under 2.0.54    |
|24031|New|Enh|2003-10-23|Passphrase protected private key in SSLProxyMachin|
|24095|Opn|Cri|2003-10-24|ERROR "Parent: child process exited with status 32|
|24437|Opn|Nor|2003-11-05|mod_auth_ldap doubly-escapes backslash (\) charact|
|24890|Opn|Nor|2003-11-21|Apache config parser should not be local aware ( g|
|25014|New|Enh|2003-11-26|A flexible interface for mod_log_config           |
|25201|New|Enh|2003-12-04|Provide Cache Purge operation                     |
|25240|Inf|Enh|2003-12-05|SSL Library Error: 336105671 logged as information|
|25435|New|Enh|2003-12-11|sethandler and directoryindex not playing nice    |
|25469|Opn|Enh|2003-12-12|create AuthRoot for defining paths to auth files  |
|25484|Ass|Nor|2003-12-12|Non-service Apache cannot be stopped in WinXP     |
|25543|Inf|Nor|2003-12-15|mod_proxy_ajp overwrites existing response headers|
|25667|New|Nor|2003-12-19|Memory leak in function ssl_scache_dbm_retrieve().|
|25863|New|Enh|2004-01-02|new per-host initialization hooks                 |
|26005|New|Nor|2004-01-08|SERVER_NAME incorrect when using IPv6 address in U|
|26142|New|Maj|2004-01-14|EnableSendFile Off for Windows XP Home            |
|26153|Opn|Cri|2004-01-15|Apache cygwin directory traversal vulnerability   |
|26368|New|Min|2004-01-23|File extensions in AddDescription treated as part |
|26446|New|Nor|2004-01-26|flush buckets followed by eos bucket emit multiple|
|26478|New|Enh|2004-01-28|mod_dav does not expose a method for setting the D|
|26835|New|Enh|2004-02-10|[PATCH] Mod_status Readability & Browser Side Tabl|
|27257|Ass|Enh|2004-02-26|rotatelogs with getopt and setuid                 |
|27578|New|Enh|2004-03-10|made getlastmodified a writable property          |
|27715|Ass|Enh|2004-03-16|Client sending misformed Range "bytes = 0-100" ins|
|27791|Inf|Nor|2004-03-18|mod_cache doesn't re-cache expired content        |
|27835|New|Enh|2004-03-22|When proxying FTP, all errors turns into 404      |
|27869|New|Enh|2004-03-23|stopping and starting httpd again immediately caus|
|28854|Inf|Nor|2004-05-09|Build fails with missing library call on Solaris i|
|28903|New|Enh|2004-05-11|Hooks to add environment variables to CGI and othe|
|29090|Ass|Enh|2004-05-19|MultiviewsMatch NegotiatedOnly extensions not resp|
|29165|New|Nor|2004-05-24|Parent directory icon not correct                 |
|29446|New|Enh|2004-06-08|want directive for setting content negotiation qua|
|29449|New|Enh|2004-06-09|Limit length of specified fields in LogFormat     |
|29450|New|Enh|2004-06-09|Improved logging for mod_access                   |
|29510|Ass|Enh|2004-06-10|ab does not support multiple cookies              |
|29644|Ver|Nor|2004-06-17|mod_proxy keeps downloading even after the client |
|29755|Opn|Nor|2004-06-23|mod_usertrack should use err_headers_out          |
|29822|New|Enh|2004-06-26|implement FTP 'PUT' support in proxy_ftp.c        |
|29941|Ass|Enh|2004-07-06|log files are not tested for availability on confi|
|30259|Ass|Enh|2004-07-22|When proxy connects to backend, a DNS lookup is do|
|30505|Ass|Enh|2004-08-05|Apache uses 'Error', and not lower level event typ|
|30730|Inf|Nor|2004-08-18|[PatchAvailable] mod_actions and Server-Status    |
|30865|Inf|Maj|2004-08-26|mod_disk_cache leaves many temporary files slowing|
|31302|Opn|Cri|2004-09-19|suexec doesn't execute commands if they're not in |
|31311|New|Enh|2004-09-20|Remote user not logged in reverse proxy scenario  |
|31352|Ass|Enh|2004-09-21|RFE, Bind to LDAP server with browser supplier use|
|31418|Opn|Nor|2004-09-25|SSLUserName is not usable by other modules        |
|31484|New|Maj|2004-09-30|Custom environment variables not passed to content|
|31490|New|Nor|2004-09-30|mod_proxy_ftp renders filenames with spaces badly |
|31565|New|Enh|2004-10-06|Won't start correctly if parent closed stdin, stdo|
|31679|New|Enh|2004-10-12|If the argument of a CGI has two or more consecuti|
|31709|Inf|Nor|2004-10-13|Raises an error on SSL name based virtualhosts (wi|
|31712|New|Enh|2004-10-14|config_file is NULL at ap_walk_config etc         |
|31952|New|Enh|2004-10-29|mod_proxy and RealPlayer: audio content streaming |
|32051|Opn|Nor|2004-11-04|mod_example is not thread safe                    |
|32328|Opn|Enh|2004-11-19|Make mod_rewrite escaping optional / expose intern|
|32346|New|Enh|2004-11-22|mod_include/include virtual checks content-type is|
|32524|New|Enh|2004-12-03|ab: add an option to specify a source address     |
|32703|Inf|Enh|2004-12-14|Cannot determine that Apache is frozen if /var fil|
|32750|Ass|Maj|2004-12-17|mod_proxy + Win32DisableAcceptEx = memory leak    |
|32877|New|Enh|2004-12-29|wrong utf-8 encoding/escaping in a href for umlaut|
|33084|New|Enh|2005-01-13|Optional certificate validity period check on SSLV|
|33089|New|Nor|2005-01-13|mod_include: Options +Includes (or IncludesNoExec)|
|33207|New|Nor|2005-01-23|Results of my suexec.c code audit                 |
|33215|New|Nor|2005-01-24|Cygwin build/install.sh fix (OSTYPE => ext=.exe)  |
|33512|Inf|Maj|2005-02-11|mod_mem_cache and possibly mod_deflate            |
|33627|New|Nor|2005-02-18|Bite-sized changes making progress towards compila|
|33685|New|Maj|2005-02-22|Unable to install in the path containing non engli|
|34270|Inf|Nor|2005-04-01|Large POSTs over SSL from Internet Explorer do not|
|34375|New|Enh|2005-04-08|enhancements for mod_include                      |
|34377|New|Enh|2005-04-08|Allow the overriding of 401 Unauthorized returns f|
|34405|New|Enh|2005-04-11|adds DOCUMENT_NAME_WITHOUT_SUFFIX to mod_include  |
|34508|New|Nor|2005-04-19|Randomly slow graceful restart, not accepting new |
|34519|New|Enh|2005-04-19|Directory index should emit valid XHTML           |
|35049|New|Nor|2005-05-24|let AddDefaultCharset apply to text/css and applic|
|35077|New|Nor|2005-05-26|mod_dav passes incorrect paths with LocationMatch |
|35083|Inf|Enh|2005-05-26|Certificate validation problems trapping          |
|35098|Ver|Maj|2005-05-27|Install fails using --prefix                      |
|35154|New|Nor|2005-06-01|Support for NID_serialNumber, etc. in SSLUserName |
|35245|New|Nor|2005-06-06|cache ignores max-age cache-directive in requests |
|35250|New|Enh|2005-06-07|[PatchAvailable] add logging to mod_proxy_connect |
|35280|New|Nor|2005-06-09|FTP proxy breaks RFC 2428 when trying to fall back|
|35556|Inf|Nor|2005-06-30|CRL files not re-read by HUP                      |
|35652|Opn|Min|2005-07-07|Improve error message: "pcfg_openfile: unable to c|
|35702|New|Nor|2005-07-12|Using with https URL, ab freezes or gets SIGSEGV o|
|35781|New|Nor|2005-07-18|ap_sub_req_method_uri() bypasses Limit security co|
|35981|Inf|Maj|2005-08-02|mod_dav overrides dav_fs response on PUT failure  |
|36286|New|Enh|2005-08-20|configtest doesn't check SSL certificates         |
|36492|New|Nor|2005-09-04|split-logfile script dies when splitting log of ma|
|36495|Inf|Nor|2005-09-05|mod_proxy_ajp: ajp_check_msg_header() got bad sign|
|36564|New|Enh|2005-09-08|make mod_ldap really universal                    |
|36636|New|Maj|2005-09-13|database write lock taken for PROPFIND operations |
|36676|New|Nor|2005-09-15|time() bug in httpd/os/win32/util_win32.c:wait_for|
|36710|Opn|Blk|2005-09-19|CGI output not captured                           |
|36724|New|Nor|2005-09-20|Don't install Apache Monitor by default           |
|37110|New|Nor|2005-10-17|Build fails when source tree is read-only         |
|37196|Inf|Min|2005-10-21|Wrong "Parent directory" link                     |
|37201|New|Enh|2005-10-21|Add <IfInterface IP> syntax to apache configuratio|
|37290|Opn|Min|2005-10-28|DirectoryIndex don't work in scriptaliased directo|
|37307|New|Enh|2005-10-31|Can't suppress error messages                     |
|37355|New|Enh|2005-11-04|Allow to specify Proxy-Authorization in ProxyRemot|
|37360|New|Maj|2005-11-04|Install fails on Windows XP x64 when program files|
|37402|New|Nor|2005-11-08|mod_proxy has stopped allowing POST sub-requests  |
|37514|Inf|Nor|2005-11-15|mod_proxy buffers chunked data.                   |
|37564|New|Enh|2005-11-19|Suggestion: mod_suexec SuexecUserGroup directive i|
|37587|Inf|Min|2005-11-22|mod_status Total Traffic value goes up then down? |
|37823|Inf|Nor|2005-12-07|The openssl library linked is different between ht|
|37920|New|Maj|2005-12-15|mod_proxy does not flush data on POST requests fro|
|38116|New|Enh|2006-01-04|Chroot-Patch for SuExec                           |
|38164|New|Nor|2006-01-06|wrong status code for failed COPY/MOVE            |
|38182|New|Nor|2006-01-08|COPY ignores authority in Destination header      |
|38218|New|Enh|2006-01-10|Multiline Comments for *.conf files               |
|38240|Inf|Nor|2006-01-12|apache restart segfault with mutliple Include dire|
|38325|Opn|Nor|2006-01-20|impossible to determine AUTH_TYPE of interpreted r|
|38355|Unc|Enh|2006-01-23|DSO support for mod_rewrite                       |
|38369|New|Enh|2006-01-24|mod_proxy keeps alive connections that should be b|
|38408|New|Nor|2006-01-27|SSI environment vars not set in spawned processes |
|38419|New|Nor|2006-01-27|Problems with large WebDAV properties             |
|38478|New|Maj|2006-02-01|A client starting a SSL renegotiation can crash th|
|38515|New|Enh|2006-02-05|Dynamic LDAP Group Support                        |
|38550|New|Enh|2006-02-07|Setting headers based on proxied data             |
|38571|New|Enh|2006-02-08|CustomLog directive checked by apachectl configtes|
|38756|Inf|Nor|2006-02-22|errors with running make                          |
|38786|New|Nor|2006-02-26|"IndexOption VersionSort" has problems with traili|
|38827|New|Reg|2006-03-02|mod_disk_cache trying to rename locked tempfile on|
|38864|Inf|Enh|2006-03-06|ProxyPassReverse fails in <Location>              |
|38903|New|Maj|2006-03-09|r->allowed does not affect Allow response header  |
|38923|New|Min|2006-03-10|mod_speling incorrectly escapes linked URLs       |
|38928|New|Min|2006-03-11|propose removing "VARIANTS" feature               |
|38995|New|Nor|2006-03-16|httpd tries to communicate with the CGI daemon eve|
|39111|New|Nor|2006-03-27|Potential bug brought by mmapfile (mod_file_cache)|
|39128|Inf|Maj|2006-03-28|Apache 2.2 will not compile mod_ssl library's corr|
|39185|Inf|Nor|2006-04-03|Approximately in 1-2 weeks of work the server hang|
|39216|New|Maj|2006-04-05|mod_disk_cache trying to rename locked file, decre|
|39238|New|Nor|2006-04-07|mod_auth_dbm requires mod_auth or "no groups file?|
|39275|Opn|Nor|2006-04-11|slow child_init causes MaxClients warning         |
|39287|New|Nor|2006-04-12|Incorrect If-Modified-Since validation (due to syn|
|39299|New|Nor|2006-04-13|Internal Server Error (500) on COPY               |
|39329|Inf|Nor|2006-04-17|mod_dbd reconnection and prepared statements      |
|39370|New|Nor|2006-04-20|SSL session will be removed if the client is sendi|
|39380|Inf|Nor|2006-04-21|mod_disk_cache eats memory, has no LFS support, et|
|39418|New|Nor|2006-04-26|CacheMaxExpire directive not enforced             |
|39448|New|Min|2006-04-29|old-style <directory proxy:*> doesn't give any war|
|39498|New|Nor|2006-05-06|accept_filter in apr assumes if found in sys/socke|
|39517|New|Nor|2006-05-08|Corrupt chunked transfer-encoding with Content Neg|
|39658|Opn|Nor|2006-05-25|mod_proxy_ajp SSL Key Size Bug                    |
|39673|New|Nor|2006-05-29|mod_proxy opens connections that disturb NTLM     |
|39692|New|Nor|2006-05-31|mod_proxy_balancer doesn't retry a failed request |
|39723|Inf|Enh|2006-06-05|Forward proxy does not work in tranparent mode    |
|39727|Ass|Nor|2006-06-05|Incorrect ETag on gzip:ed content                 |
|39730|New|Nor|2006-06-06|LanguagePriority and DefaultLanguage are Case Sens|
|39737|New|Nor|2006-06-06|LogFormat "%{tid}P" reports wrong thread id on Win|
|39748|New|Enh|2006-06-07|Header and POST support for mod_include           |
|39753|New|Nor|2006-06-07|incorrect source for LOCALE Decimal Symbol in Win2|
|39785|Inf|Nor|2006-06-12|Status code 408 (Request Timeout) is not logged   |
|39807|Opn|Enh|2006-06-13|large files / filesystem corruption can cause apac|
|39902|New|Nor|2006-06-27|HeaderName directive breaks mod_filter somehow    |
|39904|New|Nor|2006-06-27|graceful restart error and cpu load               |
|39913|Ass|Blk|2006-06-27|detection of static OpenSSL libraries requiring li|
|39916|New|Nor|2006-06-28|Core Filters & non-blocking Sendfile              |
|39923|New|Nor|2006-06-28|AddDescription doesn't work in server config with |
|39928|New|Nor|2006-06-28|port no detected when file name not in URL        |
|39935|New|Nor|2006-06-29|AddDescription does not do literal comparisons on |
|39973|Ass|Enh|2006-07-06|apache software folder should be movable          |
|40035|New|Cri|2006-07-13|Windows Server 2003 "("R2")" 64-Bit Edition no cgi|
|40060|New|Nor|2006-07-17|AuthGroupFile should accept /etc/group syntax     |
|40075|New|Enh|2006-07-19|unable to use ldap groups that contain DNs and use|
|40102|Opn|Nor|2006-07-24|SCRIPT_NAME set incorrectly with mod_rewrite      |
|40146|New|Nor|2006-07-31|mod_ssl info in server_info is blank              |
|40174|New|Min|2006-08-03|Unable to get IndexOptionis ScanHTMLTitles to work|
|40180|Inf|Maj|2006-08-03|Mod_dav and remove folder doesn't work with Micros|
|40190|New|Nor|2006-08-05|translate file                                    |
|40196|New|Nor|2006-08-06|EILSEQ handling, NoImplicitAdd should work, and so|
|40217|Opn|Nor|2006-08-08|mod_dav PROPFIND ignores access restrictions on it|
|40266|Inf|Blk|2006-08-16|berkeley db support in httpd is screwed           |
|40312|New|Nor|2006-08-24|ssl_engine_init.c, ssl_init_ctx_verify contains a |
|40373|New|Nor|2006-08-31|mod_dir adds trailing slash after internal redirec|
|40408|New|Blk|2006-09-04|Apache 2.2.3 is not starting                      |
|40416|New|Maj|2006-09-05|mod_proxy_ftp cannot connect under http load in fo|
|40441|New|Enh|2006-09-08|intelligently handling dynamic subdomains         |
|40453|New|Nor|2006-09-09|lexicographic compare in RewriteCond isn't lexicog|
|40463|New|Nor|2006-09-11|piped logging causes some weird kill()ing         |
|40513|Opn|Maj|2006-09-14|Seeding PRNG with 0 bytes of entropy              |
|40514|New|Nor|2006-09-14|would like GracefulShutdownTimeout to work for gra|
|40540|Inf|Nor|2006-09-19|Bad interaction between MultiViews and SetOutputFi|
|40541|New|Nor|2006-09-19|Action rewrites URI used by Location?             |
|40571|New|Nor|2006-09-21|mod_proxy_ajp don't works with mod_usertrack      |
|40586|New|Enh|2006-09-22|Add option to supress default '-' output          |
|40746|New|Enh|2006-10-12|Feature request: ProxyAllow directive             |
|40749|New|Min|2006-10-12|magic file with string and "%n" causes Apache chil|
|40781|New|Nor|2006-10-17|PATH_TRANSLATED: 'redirect:/~jablko/gallery2/main.|
|40808|New|Enh|2006-10-23|ProxyRemote with optional proxy authentication    |
|40859|New|Enh|2006-11-01|[PATCH] Support -F force option to 'ab' support to|
|40917|New|Nor|2006-11-07|configure does not detect OpenSSL shared lib on HP|
|40953|New|Min|2006-11-12|Should not send any data in 1xx/204/304 reply from|
|40984|Inf|Enh|2006-11-16|AddIcon, AddIconByType for OpenDocument format    |
|40987|Opn|Enh|2006-11-16|ProxyVia Block doesn't remove Via: header for reve|
|41000|New|Nor|2006-11-19|mod_authn_dbd have an error, in function 'authn_db|
|41025|New|Nor|2006-11-23|ROBOTS META-Tag directive needed in mod_autoindex |
|41088|New|Nor|2006-11-30|installation backcolor is wrong (white)           |
|41111|New|Enh|2006-12-05|New option for filters: run only if there are spar|
|41114|New|Blk|2006-12-06|ACL HTTP method is rejected by mod_proxy_ajp      |
|41130|New|Nor|2006-12-07|mod_mime and mod_negotiation type-map both clobber|
|41143|Opn|Nor|2006-12-10|Incorrect ap_getline assumption in mod_proxy_http |
|41195|New|Nor|2006-12-17|properly set the parent pid on shutdown           |
|41196|New|Nor|2006-12-17|worker mpm usage of apr's memory pools is not thre|
|41200|Inf|Maj|2006-12-18|SSI include, prevent client from receiving full ou|
|41240|Inf|Enh|2006-12-25|BRF files support                                 |
|41262|Inf|Nor|2006-12-29|Embedded pcre causes runtime segfault             |
|41362|Inf|Maj|2007-01-14|mod_disk_cache and mod_include conflict generating|
|41375|Inf|Min|2007-01-15|Using same SSL Certificate with different ServerNa|
|41391|New|Min|2007-01-17|too long period setting makes max-age overflow    |
|41412|New|Enh|2007-01-19|RewriteRule Skip should take negative arguments   |
|41435|New|Nor|2007-01-22|Authentication fails with 500 Server Error        |
|41450|Inf|Cri|2007-01-24|Empty page (200 OK) while max-age is empty        |
|41485|New|Nor|2007-01-28|LDAP client certificates not usable in 2.2.x/trunk|
|41529|New|Enh|2007-02-02|Accept BOM in .htaccess                           |
|41556|New|Enh|2007-02-07|Feature Request: format string for masking ip addr|
|41621|New|Maj|2007-02-15|Apache 2.2.4 backend problem with Apache 2.0.59 Re|
|41646|New|Nor|2007-02-16|wrong headers are sent for HEAD requests when Prox|
|41676|Opn|Enh|2007-02-22|Refactor mod_proxy_ftp                            |
|41685|New|Enh|2007-02-22|Implement optional HTTP Authentication in a standa|
|41712|Inf|Nor|2007-02-26|threads locked at logging state                   |
|41729|New|Maj|2007-02-28|error message: ap_get_scoreboard_lb(130) failed in|
|41744|Inf|Maj|2007-03-01|SSI resolves includes but removes original HTML   |
|41763|Opn|Nor|2007-03-05|mod_disk_cache ignores CacheDirLevels and CacheDir|
|41764|New|Nor|2007-03-05|error state and conf                              |
|41771|Inf|Nor|2007-03-06|Erro with mod_proxy_ajp or mod_prox_balancer      |
|41867|New|Nor|2007-03-16|<DirectoryMatch> Matches Files                    |
|41925|New|Nor|2007-03-21|trivial patch to add automatic crypting to 'dbmman|
|41929|New|Nor|2007-03-22|ISAPI ssl variables                               |
|41953|New|Nor|2007-03-26|pidfile remains when 2nd pass of post-config retur|
|41962|New|Min|2007-03-27|Need mod_auth_ldap to authenticate with Active Dir|
|42001|New|Cri|2007-03-30|LINUX : Could not set LDAP_OPT_X_TLS to LDAP_OPT_X|
|42027|Inf|Nor|2007-04-02|FileETag directive appears to be ignored          |
|42054|New|Nor|2007-04-04|service name and parameter issues                 |
|42079|New|Nor|2007-04-10|SSLRequire: Additional access in sub-directoies   |
|42082|New|Nor|2007-04-10|filter_init is called multiple times after an INCL|
|42182|Inf|Nor|2007-04-22|Mime types for cached proxied content             |
|42216|New|Enh|2007-04-24|RFE -- external overload procedure                |
|42262|Inf|Nor|2007-04-26|mod_dav /  worker fails to allocate memory and seg|
|42287|Inf|Nor|2007-04-28|chunked encoded response to POST request to cgi sc|
|42368|Inf|Nor|2007-05-09|httpd is crashing if conf/extra/httpd-manual.conf |
|42373|Inf|Maj|2007-05-09|REPORT request fails over mod_proxy               |
|42404|New|Enh|2007-05-13|Filename/info for disk-cached proxied remote URLs |
|42425|Inf|Nor|2007-05-15|Additional freshness checks in mod_cache.c cause m|
|42471|Inf|Nor|2007-05-21|clients with IE7 take 3megs per page load. httpd.e|
|42492|Inf|Nor|2007-05-22|mod_proxy_ajp with SSL front end: data corruption |
|42499|Inf|Nor|2007-05-23|Backslash produces a 404 error instead of going to|
|42548|New|Nor|2007-05-30|INCLUDE negotiating language aborts with APR_POOL_|
|42561|New|Enh|2007-05-31|[PATCH] AuthLDAPRemoteUserAttribute only applies i|
|42633|New|Min|2007-06-11|mod_info gives wrong information about actual conf|
|42665|New|Nor|2007-06-14|spurious attempt to open ".../file.html/.htaccess"|
|42666|New|Nor|2007-06-14|code & docs corrections for FollowSymLinks and Sym|
|42667|New|Nor|2007-06-14|mod_proxy_balancer not reporting when workers are |
|42668|Inf|Nor|2007-06-14|balancer_manager shows Ok status for the workers t|
|42687|New|Nor|2007-06-18|Fully delegate certificate & key semantics to the |
|42688|New|Enh|2007-06-18|engine managed keys: per process openssl context  |
|42690|New|Nor|2007-06-18|realm is not set for each configured directory whe|
|42695|Opn|Cri|2007-06-18|mod_proxy balancer problem                        |
|42699|New|Enh|2007-06-20|share mod_logio data with other modules           |
|42711|New|Enh|2007-06-20|format string for whole log entries not just id   |
|42732|Opn|Maj|2007-06-25|Authentication against database issue.            |
|42763|New|Nor|2007-06-28|graceful-stop/restart loops go loop too far       |
|42923|Inf|Maj|2007-07-17|vhost certificate NOT overriding cert from the _de|
|42972|Inf|Nor|2007-07-25|Certificate list in mod_ssl module context are not|
|42977|New|Nor|2007-07-25|DAV locking is busted when apr-util is built with |
|42987|New|Nor|2007-07-27|Weak Etags in Apache are useless and violate RFC 2|
|43012|New|Nor|2007-08-02|AIX instdso.sh libphp5.so                         |
|43027|New|Enh|2007-08-03|Header in default language                        |
|43033|New|Nor|2007-08-04|apxs does not correctly detect module name (w/o -n|
|43177|New|Nor|2007-08-21|child pid xxxxx exit signal Segmentation fault    |
|43218|New|Nor|2007-08-27|Wrong cert used for vhost if ServerName is same   |
|43220|Opn|Cri|2007-08-27|mod_proxy truncating ajp output                   |
|43249|Inf|Maj|2007-08-30|ldap_simple_bind_s failed when using SUN LDAP Libs|
|43275|New|Enh|2007-08-31|Remove avoidable network transactions in mod_proxy|
|43289|New|Nor|2007-09-02|XBitHack full g+x returns zero sized response on I|
|43308|New|Nor|2007-09-04|Persistent backend connections not supported for R|
|43352|New|Nor|2007-09-11|Apache2: out of memory during heavy webdav files c|
|43441|New|Nor|2007-09-20|Incorrect HTTP status for pre-commit-blocked autov|
|43471|New|Min|2007-09-25|no need to create a global pool on open_scoreboard|
|43481|New|Cri|2007-09-26|AuthLDAPURL must contain a final path of branch?(l|
|43494|New|Nor|2007-09-26|mod_cgid does not kill never ending scripts       |
|43502|New|Enh|2007-09-28|httpd fails to start if log directory does not exi|
|43513|New|Nor|2007-09-29|Persistent backend connections for ProxyPassMatch |
|43532|Inf|Cri|2007-10-02|Error while compiling Apache 2.2.3 on HPUX        |
|43533|Opn|Nor|2007-10-02|Frequent crashes in mod_include's bndm()          |
|43561|New|Nor|2007-10-05|apxs -q anomaly                                   |
|43577|Inf|Blk|2007-10-09|mod_authnz_ldap not working under WLDAP32 (novell/|
|43607|New|Nor|2007-10-11|mod_proxy sends data on closed connections without|
|43649|Opn|Trv|2007-10-18|mod_autoindex is generating invalid XHTML markup  |
|43652|New|Enh|2007-10-18|Suggest small change for big fix with SuExec & Vir|
|43666|New|Nor|2007-10-20|CGI works, but client denied error messages in err|
|43679|New|Enh|2007-10-23|Contributed tests for checking that subrequests ta|
|43723|Inf|Cri|2007-10-29|Apache 2.2.6 segfault when using mod_dbd          |
|43724|New|Cri|2007-10-29|Apache 2.2.6 segfault on url wich not in cache    |
|43755|New|Enh|2007-10-31|Add a SSLOptions to don't fill SSL_CLIENT_VERIFY  |
|43762|New|Enh|2007-10-31|Misleading tips in an error message about internal|
|43777|New|Nor|2007-11-01|Wrong encoding of <href> element in response      |
|43778|New|Nor|2007-11-01|Wrong responses if httpd has not access to some el|
|43785|New|Enh|2007-11-02|Tracking the per-hit impact of mod_include        |
|43792|New|Enh|2007-11-04|Feature proposal - bind phase                     |
|43818|New|Nor|2007-11-08|PROPFIND on -w- collections returns 207 MULTI-STAT|
|43838|New|Enh|2007-11-11|If-Modified-Since request and htcacheclean conflic|
|43895|New|Nor|2007-11-18|mod_mbox improvements                             |
|43897|Inf|Cri|2007-11-18|Huge memory consumption httpd 2.2.6, mod_proxy - m|
|43931|New|Enh|2007-11-21|OpenSSL autoconfig support for mod_ssl            |
|43943|New|Nor|2007-11-22|SHMCB crash due to misalignment and GCC 4 optimiza|
|43958|Inf|Maj|2007-11-26|mod_proxy_balancer not balancing correct in combin|
|43997|Opn|Min|2007-11-29|Only issue "Init: SSL server IP/Port conflict" if |
|44025|Inf|Nor|2007-12-05|Apache 2.2.6 fails to configure on OpenBSD 4.1    |
|44027|Ass|Enh|2007-12-05|Internationalized Domain Name (IDN) support       |
|44031|Opn|Maj|2007-12-06|RemoveHandler inside subdir location              |
|44034|Ass|Enh|2007-12-06|mpm_winnt doesn't call monitor hook               |
|44105|New|Nor|2007-12-19|Core dumps when using Proxy Keepalive             |
|44155|New|Enh|2007-12-31|smarter retry for LDAP_UNAVAILABLE, LDAP_BUSY, etc|
|44181|Opn|Enh|2008-01-07|add UnAlias                                       |
|44188|Inf|Cri|2008-01-08|Empty response for certain requests (mod_proxy as |
|44218|New|Min|2008-01-13|mod_autoindex shows the default icon for files wit|
|44221|Opn|Cri|2008-01-14|CheckCaseOnly On does not stop Multiple Choices ba|
|44250|New|Nor|2008-01-16|OSX 10.5: __THE_PROCESS_HAS_FORKED_AND_YOU_CANNOT_|
|44279|New|Enh|2008-01-22|Add "iterate" flag to apply rule in a loop while p|
|44302|New|Nor|2008-01-27|AuthLDAPURL does not accept ldapi:// urls         |
|44305|New|Nor|2008-01-28|Inconsistent configuration for suexec path        |
|44316|New|Nor|2008-01-28|httpd 2.0 does not follow ScriptAliases when invok|
|44322|New|Enh|2008-01-29|mod_proxy ProxyPassReverseCookieDomain with no dom|
|44351|New|Nor|2008-02-04|File descriptor leak when using prg RewriteMap    |
|44363|Inf|Maj|2008-02-05|Slow file transfers                               |
|44384|Ass|Nor|2008-02-09|mod_ssl on MacOS X 10.5.1 does not work because of|
|44453|New|Nor|2008-02-19|list_hooks.pl doesn't parse declarations that span|
|44476|New|Maj|2008-02-23|Apache service fails to start due to missing depen|
|44503|Inf|Blk|2008-02-27|Errors during SSL handshake                       |
|44518|New|Enh|2008-03-02|Don't set expires header on HTTP redirect.        |
|44578|New|Enh|2008-03-11|mod_authn_dbd option to let database validate pass|
|44601|New|Trv|2008-03-13|Add a lowercase value to Vary header for consisten|
|44602|New|Enh|2008-03-13|Options for modfying Content-Location (relative OR|
|44622|Inf|Nor|2008-03-17|POST fails to SSL vhost with proxy to HTTP backend|
|44631|New|Nor|2008-03-18|with-included-apr fails to work when using a separ|
|44638|New|Nor|2008-03-19|sed error in httpd.spec.in                        |
|44656|New|Nor|2008-03-22|Tries to retrive error document 404 instead of 406|
|44657|New|Enh|2008-03-22|prefer-type, -encoding, and -charset cookie? (as p|
|44670|New|Min|2008-03-25|Apache httpd 2.2.8 : Cannot ./configure when curre|
|44696|Inf|Nor|2008-03-27|mod_cache sometimes serves old content despite hav|
|44730|New|Nor|2008-04-01|duplicate query string in remote server url when u|
|44752|New|Nor|2008-04-03|Suexec does not correctly check that scripts are i|
|44757|New|Enh|2008-04-04|adding stderr buckets to mod_cgi                  |
|44758|New|Enh|2008-04-04|LimitRequestBody undocumented behaviour with proxi|
|44779|New|Enh|2008-04-08|Using commas and semicolons for content negotiatio|
|44855|New|Nor|2008-04-22|irregular balancing with sticky-session after re-e|
|44865|Ass|Nor|2008-04-23|mod_dav's lock database becomes consistently corru|
|44870|Inf|Nor|2008-04-24|process spinning on 100% cpu                      |
|44923|Inf|Min|2008-05-02|consequences of multiple LDAPTrustedGlobalCert    |
|44924|New|Enh|2008-05-02|allow 'CACERTDIR' in mod_ldap                     |
|44940|New|Maj|2008-05-06|Httpd randomly breaks when verifying client certif|
|44981|New|Enh|2008-05-12|Digital Certificates (CN Based) for Authorization |
|45022|New|Nor|2008-05-16|Processing of escaped glob patterns in "Include" d|
|45023|Opn|Reg|2008-05-16|DEFLATE preventing 304 NOT MODIFIED response      |
|45049|Opn|Nor|2008-05-20|mod_mem_cache caches partial content when client c|
|45054|New|Nor|2008-05-21|SSLVerifyClient optional_no_ca is broken          |
|45058|New|Nor|2008-05-21|Mod_SSL does not set AUTH_TYPE with client certifi|
|45078|New|Nor|2008-05-27|mod_proxy stalls when uploading files             |
|45103|Ass|Min|2008-05-30|apachectl should do config test before reload/rest|
|45111|New|Enh|2008-06-01|make mod_usertrack use mod_unique_id if available |
|45116|New|Nor|2008-06-02|fail to check return value of apr_file_dup2() in /|
|45148|New|Enh|2008-06-06|The actual host of the request will be more helpfu|
|45184|New|Enh|2008-06-11|Regular Expression in directive ServerAlias       |
|45187|New|Maj|2008-06-11|Long File name requests gives FORBIDDEN response  |
|45225|New|Nor|2008-06-17|XBitHack breaks DirectoryIndex + MultiViews conten|
|45253|New|Nor|2008-06-23|Unable to build httpd 2.2.9 on Solaris/SPARC      |
|45257|New|Enh|2008-06-23|add (en)force option for UseCanonicalName         |
|45259|New|Enh|2008-06-23|Add /home/[a-z]/* scheme to UserDir conf          |
|45275|New|Maj|2008-06-25|Locked files during expired page renew in disk cac|
|45281|New|Enh|2008-06-25|SITE CHMOD/SEARCH                                 |
|45287|Inf|Min|2008-06-26|build failure because of difference between BSD an|
|45297|New|Min|2008-06-27|mod_dir does not manage correctly the user (r->use|
|45302|New|Enh|2008-06-28|ServerRoot directive                              |
|45355|New|Nor|2008-07-07|ab text and html output jumbo unification         |
|45356|New|Nor|2008-07-07|ab: optionally reduce resource usage (qsort and me|
|45371|New|Nor|2008-07-10|MSI installer requires uninstall of previous versi|
|45374|New|Blk|2008-07-10|Shared memory error on starting httpd with mod_lda|
|45379|Inf|Nor|2008-07-11|[Bug] svn merge, apache and trailing slashes      |
|45385|Inf|Nor|2008-07-11|unable to compile/make 2.2.9 with --enable-ldap   |
|45393|New|Nor|2008-07-14|Apache returns 500 Error when no LDAP credentials |
|45402|New|Nor|2008-07-15|mod_autoindex incorrectly fails to list files     |
|45405|New|Enh|2008-07-16|Allow binding port to be set for individual worker|
|45449|New|Nor|2008-07-21|[PATCH] Add support to WebDav to MOVE/COPY to remo|
|45456|New|Enh|2008-07-22|mod_dbd don't allow more then one database pool   |
|45487|New|Trv|2008-07-27|broken log messages on startup in win32 version   |
|45497|New|Nor|2008-07-29|Scoreboard slot leaked using MaxRequestsPerChild a|
|45512|Ass|Maj|2008-07-31|Bad Performance of mod_proxy with SSL on Solaris 1|
|45524|New|Enh|2008-08-01|Specifying multiple vhost aliases                 |
|45525|New|Enh|2008-08-01|Switch mod_autoindex to Tango icons               |
|45579|New|Nor|2008-08-06|unknown URI scheme in request-URI ignored         |
|45674|New|Enh|2008-08-22|Allow to change error code returned by "Require ld|
|45726|New|Enh|2008-09-02|Build in a maintenance functionallity             |
|45736|New|Nor|2008-09-03|mod_dav needs a directory for its locks and one sh|
|45754|New|Enh|2008-09-06|autoconf macros                                   |
|45763|New|Nor|2008-09-08|No openssl.cnf defined by default causes OpenSSL c|
|45773|New|Nor|2008-09-09|pcre build generates sources to srcdir rather than|
|45788|New|Nor|2008-09-11|mod_log_forensic output shouldn't be buffered when|
|45801|Opn|Nor|2008-09-13|SSLRequireSSL with strictrequire and satisfy any d|
|45838|New|Nor|2008-09-18|mod_authz_owner & directories                     |
|45868|New|Nor|2008-09-23|mod_mem_cache update of headers in cache object is|
|45900|New|Nor|2008-09-26|"make install" fails from read-only filesystem    |
|45905|New|Enh|2008-09-26|ErrorDocument and default URL                     |
|45922|New|Enh|2008-09-30|Expand the conditions under which "SSLVerifyClient|
|45923|New|Nor|2008-09-30|htpasswd tries to open(file, O_RDONLY | O_APPEND) |
|45926|Inf|Nor|2008-10-01|Unable to start apache 2.2.9                      |
|45986|New|Nor|2008-10-10|[info]...Invalid argument: core_output_filter: wri|
|46024|Opn|Nor|2008-10-16|--enable-static is not available in apache's confi|
|46037|Inf|Nor|2008-10-18|Configuration of trusted OCSP responder certificat|
|46040|New|Enh|2008-10-20|Check for existing version of Apache while install|
|46054|New|Nor|2008-10-21|Running httpd returns the error "bad user name nob|
|46070|New|Nor|2008-10-22|MSI installer does not validate custom installatio|
|46071|New|Enh|2008-10-22|Allowing space in between comma and last option in|
|46074|New|Enh|2008-10-23|Need of friendly and easy to use configuration gra|
|46139|New|Nor|2008-11-02|Apache Restart option is not working              |
|46140|New|Enh|2008-11-03|Change error state in balancer manager            |
|46188|Inf|Nor|2008-11-11|Core dumps in apache 2.0.59                       |
|46195|Opn|Nor|2008-11-12|ProxyPass fails with literal IPv6 address         |
|46215|New|Nor|2008-11-14|Race condition in bybusyness algorithm            |
|46231|New|Maj|2008-11-18|Connection Pooling with ajp depends on syntax ?   |
|46241|New|Enh|2008-11-19|mod_expires - ExpiresByPattern or ExpiresIf       |
|46267|New|Nor|2008-11-22|No shared modules build if use --with-apr and --wi|
|46270|New|Enh|2008-11-23|Add FIPS 140-2 mode for mod_ssl for FIPS 1.2 modul|
|46282|New|Nor|2008-11-24|apache2.2 reverse proxy causing full memory and sw|
|46316|New|Maj|2008-12-01|Proxied SSI ProxyTimeout render failure           |
|46317|Inf|Nor|2008-12-01|mod_authnz_ldap.c(373)  seg fault                 |
|46412|New|Nor|2008-12-17|make_child return value not checked               |
|46417|New|Cri|2008-12-19|[notice] Parent: child process exited with status |
|46428|Opn|Nor|2008-12-21|Spaces in URI doesn't encode in proxy-requests    |
|46442|New|Nor|2008-12-29|Semicolon in allow/deny all rules cause reverse lo|
|46449|New|Maj|2008-12-30|Output out of order from SSI include virtual      |
|46454|New|Min|2008-12-30|escaping wildcards in AddIcon filename matching   |
|46475|New|Nor|2009-01-04|build warnings.                                   |
|46499|New|Maj|2009-01-09|httpd accept() return EAGAIN error                |
|46521|New|Nor|2009-01-13|mod_dav doesn't show symlinks                     |
|46529|Ass|Nor|2009-01-14|Child httpd processes crash with Segmentation faul|
|46534|New|Nor|2009-01-14|mod_proxy_ajp scheme and port do not follow UseCan|
|46578|New|Nor|2009-01-21|Flawed header                                     |
|46582|Ver|Min|2009-01-22|RewriteMap internal functions are not well documen|
|46604|New|Nor|2009-01-26|Error thrown when trying to rpmbuild -tb httpd sou|
|46629|New|Maj|2009-01-29|Apache hanging on system calls for php and perl   |
|46634|Ass|Nor|2009-01-30|Requests sometimes take too long, wrong time taken|
|46644|New|Enh|2009-01-31|Clean way to pass custom environment variables to |
|46646|Ass|Nor|2009-02-01|check group membership is sometimes case sensitive|
|46650|Opn|Nor|2009-02-02|CustomLog enviroment condition SCRIPT_FILENAME    |
|46656|New|Enh|2009-02-03|ProxyErrorOverride inside location                |
|46669|New|Enh|2009-02-06|rotatelogs doesn't autocreate directories         |
|46671|Opn|Cri|2009-02-07|Apache periodicaly crashes .                      |
|46678|New|Nor|2009-02-09|Fixed Content-Length using mod_ext_filter with mod|
|46682|New|Nor|2009-02-09|mod_proxy EAI_AGAIN DNS failure                   |
|46685|Opn|Nor|2009-02-09|401 sent without WWW-Authenticate header when requ|
|46709|Opn|Reg|2009-02-12|Expect: 100-continue to an HTTP/1.0 server change |
|46724|Inf|Cri|2009-02-17|WinXP SP3 - Apache crashes on startup in libapr-1.|
|46743|New|Nor|2009-02-19|Inconsistent behavior of "RewriteOptions inherit" |
|46745|New|Maj|2009-02-20|ab.c error :  undefined reference to `BIO_set_call|
|46751|New|Nor|2009-02-21|Can passenv variables who's name contain '(' or ')|
|46762|New|Nor|2009-02-24|Error, SSL/TLS libraries were missing or unusable |
|46765|Opn|Nor|2009-02-25|doubled HTTP header leads to error (Redmine)      |
|46785|Inf|Nor|2009-03-02|Child process increases to 100% (CPU)             |
|46788|New|Nor|2009-03-02|Set resource limits to avoid denial of service att|
|46810|New|Nor|2009-03-05|apxs / apu-1-config outputting erroneous include p|
|46824|New|Nor|2009-03-09|RemoveOutputFilter will not work for Filters added|
|46845|Inf|Cri|2009-03-12|Apache crashes in Windows when using subversion(pr|
|46847|New|Nor|2009-03-13|WebDAV methods with encoding other than "identity"|
|46873|New|Nor|2009-03-18|feature request: connection count on balancer-mana|
|46884|New|Min|2009-03-20|Call to apu_dso_load Fails In apr_ldap_stub.c On O|
|46946|Inf|Nor|2009-03-31|mod_mbox shows email addresses in plain text      |
|46963|New|Nor|2009-04-03|KeepAliveTimout prevents child process from exitin|
|46969|New|Nor|2009-04-05|CustomLog format %m always GET on errors with loca|
|46970|New|Nor|2009-04-05|CustomLog %X does not record aborted connections w|
|47011|New|Reg|2009-04-09|mod_proxy/mod_proxy_balancer hot-standby BalancerM|
|47055|New|Blk|2009-04-20|SSLVerifyClient + Directory doesn't use cache sess|
|47063|New|Nor|2009-04-21|mod_proxy doesn't call post_request handler when t|
|47134|New|Nor|2009-05-01|Last resolve handling when sending client certific|
|47138|New|Nor|2009-05-01|Reverse Proxy & Balancer generate error fault when|
|47152|New|Maj|2009-05-04|Apache is only serving the first character in the |
|47159|New|Nor|2009-05-06|2.2.x logresolve doesn't support ipv6             |
|47167|New|Nor|2009-05-07|Authenticated sessions being switched by reverse p|
|47170|New|Enh|2009-05-08|rotatelogs ring buffer option                     |
|47180|New|Nor|2009-05-11|DBM ssl_scache setting can cause extreme performan|
|47220|Opn|Enh|2009-05-19|Access to environment variables                   |
|47241|New|Min|2009-05-22|Error in rewriting with character ':'             |
|47256|New|Enh|2009-05-23|Enable SSL on a per-port basis                    |
|47289|New|Nor|2009-05-30|Can't build with dynamic libraries on Mac OS 10.4 |
|47295|New|Nor|2009-06-01|AuthDBDUserPWQueryFmt/AuthDBDUserRealmQueryFmt in |
|47329|New|Nor|2009-06-07|SSLCADNRequest* & SSLCACertificate* silently do no|
|47340|New|Nor|2009-06-09|uldap_cache_comparedn() called without a lock     |
|47344|New|Enh|2009-06-10|[FEATURE REQUEST] RedirectCanonicalName           |
|47345|New|Enh|2009-06-10|rotatelogs timeout patch                          |
|47346|New|Maj|2009-06-10|mod_cache doesn't re-cache expired content when La|
|47387|Inf|Nor|2009-06-18|SSL_CLIENT_I_DN and SSL_CLIENT_S_DN use Email inst|
|47392|Opn|Nor|2009-06-18|<FilesMatch> is using the wrong directory         |
|47435|New|Nor|2009-06-26|mod_authz_host does reading of /etc/hosts on each |
|47438|Inf|Enh|2009-06-27|how to create a non-html "listing generated by the|
|47447|New|Enh|2009-06-29|Add possibility to use client IP as a value in Req|
|47484|New|Nor|2009-07-06|Spurious RewriteLock warning when using external m|
|47485|New|Enh|2009-07-06|HTML5 Websocket implementation                    |
|47514|New|Enh|2009-07-12|Personal data and restrictions based on subject di|
|47528|New|Maj|2009-07-14|Worker process won't restart more than once using |
|47542|New|Nor|2009-07-16|Piped logging processes killed before other proces|
|47562|Inf|Nor|2009-07-23|Apache/2.2.3 (Win32) mod_perl/2.0.3-rc1           |
|47578|New|Nor|2009-07-24|compile ERROR with ssl                            |
|47580|Opn|Nor|2009-07-25|mod_cache sends 200 response instead of 304       |
|47586|New|Nor|2009-07-27|httpd -k start doesn't start service when rotatelo|
|47591|New|Min|2009-07-27|show current HTTP_HOST in mod_status scoreboard   |
|47601|New|Enh|2009-07-29|Support X-Forwarded-For in forward proxy requests |
|47625|New|Nor|2009-08-02|2.2.12 win32 msi installer missing                |
|47634|New|Maj|2009-08-04|mod_ldap connection pool session keepalive not imp|
|47643|New|Enh|2009-08-04|added meta tags to xhtml output for ease of search|
|47650|Opn|Trv|2009-08-05|httxt2dbm calculates value size incorrectly       |
|47657|New|Nor|2009-08-06|Make WebDAV MOVE atomic when replacing files on sa|
|47659|New|Nor|2009-08-07|makefile.win needs check for DBM_LIST, dies on bui|
|47664|New|Nor|2009-08-07|ap_proxy_canonenc: does not recode all high-byte c|
|47665|Inf|Blk|2009-08-09|Apache service well launched but blank Screen     |
|47691|New|Enh|2009-08-12|libtool invocations should use --tag              |
|47693|Opn|Nor|2009-08-13|GET request has race condition w.r.t. replacement |
|47706|Inf|Nor|2009-08-19|(20014)Internal error: proxy: error reading status|
|47716|New|Min|2009-08-20|LimitRequestFieldSize and friends not merged well |
|47719|Opn|Enh|2009-08-20|Broken symbolic link (symlink) causes wrong ErrorD|
|47723|New|Nor|2009-08-22|suEXEC and low RLimitMem gives "crit: invalid uid"|
|47743|Inf|Nor|2009-08-26|mod_so segfaults at server startup in ap_find_load|
|47753|New|Nor|2009-08-27|output and error channels not explicitly passed fo|
|47778|Opn|Enh|2009-09-03|wrong exit value on graceful restart              |
|47780|New|Nor|2009-09-03|Critical errors should be marked by time and level|
|47807|Inf|Nor|2009-09-09|Proxy dialog error with Apache 2.2.13             |
|47808|New|Maj|2009-09-09|Child process core dumps when enabling CRL        |
|47814|Inf|Maj|2009-09-10|openssl_pkcs7_sign error                          |
|47838|New|Enh|2009-09-14|Ability to Dynamically Inject Current Time Into a |
|47874|New|Nor|2009-09-18|mod_fcgid crashes if added during restart         |
|47895|New|Maj|2009-09-24|Incorrect 413 error handling                      |
|47908|New|Min|2009-09-27|'invalid result code' in error_log                |
|47981|New|Nor|2009-10-12|allow language specific html-versions (index.html.|
|47982|New|Nor|2009-10-12|correctly interprete non-standard HTTP_ACCEPT_LANG|
|47988|New|Nor|2009-10-12|Segmentation fault                                |
|47989|New|Nor|2009-10-13|Junk string appended to compressed dynamic content|
|47994|New|Enh|2009-10-14|ScriptInterpreterSource apparently broken in Windo|
|48020|New|Nor|2009-10-17|KCP+ Opera support for mod_auth_digest            |
|48037|Inf|Nor|2009-10-21|mod_proxy_http does not handle asynchronous keepal|
|48045|New|Nor|2009-10-23|Apache 2 initgroups alert, Max OS X, abnormal exit|
|48057|New|Nor|2009-10-26|mod_fcgid creates 1 more process then allowed     |
|48094|New|Nor|2009-11-01|Avoid a race condition in close_worker_sockets()  |
|48107|New|Maj|2009-11-02|Mutual Authentication: Order in ca-bundle influenc|
|48115|New|Enh|2009-11-03|Duration to receive the request, generate response|
|48130|New|Maj|2009-11-04|DAV operations on large filesets consume all the O|
|48154|New|Nor|2009-11-06|Requests through mod_isapi are not parsed by HTTP_|
|48164|New|Enh|2009-11-09|add new parameters to rotatelogs                  |
|48219|New|Nor|2009-11-17|Retrying the worker for seems to omit POST variabl|
|48228|New|Nor|2009-11-18|Renegocation requires multiple client authenticati|
|48246|New|Enh|2009-11-19|Check permissions on file/directory specified for |
|48254|New|Trv|2009-11-20|Bogus "DocumentRoot does not exist" warning when s|
|48283|New|Nor|2009-11-25|Proxy errors since httpd 2.2.12 with Tomcat 6.0.20|
|48291|New|Maj|2009-11-26|mod_substitute loops                              |
|48295|Opn|Nor|2009-11-27|ProxyPassReverseCookiePath: Not changing path corr|
|48301|New|Enh|2009-11-30|Feature request: improved connection status report|
|48309|New|Maj|2009-11-30|libapreq2-2.12: "make test" fails at request.t and|
|48312|Opn|Nor|2009-11-30|ProxyPassReverseCookiePath: Not changing path corr|
|48316|Inf|Nor|2009-12-01|ap_run_insert_filter doesn't work in cache_url_han|
|48354|New|Enh|2009-12-08|void ap_custom_response is not supporting the bina|
|48360|New|Enh|2009-12-09|provide sample configuration file for inclusion in|
|48361|New|Enh|2009-12-09|Add global server option for specifying desired DS|
|48364|Opn|Nor|2009-12-10|PHP-generated pages are not cached in spite of per|
|48369|New|Enh|2009-12-10|add option to automatically restart if a script is|
|48431|New|Nor|2009-12-22|Error logging doesn't work when configured to use |
|48440|Inf|Cri|2009-12-23|Segmentation Fault                                |
|48449|Inf|Nor|2009-12-28|make distclean removes core.c and core_filters.c  |
|48465|Opn|Enh|2009-12-30|Support TCP to connect to backends                |
|48499|New|Nor|2010-01-06|mod_rewrite can't redirect to files with ? in them|
|48500|New|Nor|2010-01-06|mod_mbox mishandles right-click to open msg in new|
|48508|New|Nor|2010-01-07|BalancerMember doesn't accept nocanon directive   |
|48549|New|Enh|2010-01-14|Add Cache-Control s-maxage support                |
|48576|New|Nor|2010-01-19|MOVE or COPY in WebDAV fails with 404 when file ex|
|48585|New|Enh|2010-01-20|mod_cache no longer caches expired content        |
|48602|New|Enh|2010-01-23|use asynch ldap_compare so LDAPTimeout applies    |
|48623|New|Maj|2010-01-26|AuthLDAPURL syntax is not RFC-compliant, prevents |
|48639|New|Enh|2010-01-29|Add htcacheclean as a core monitored process      |
|48652|New|Maj|2010-02-01|"AuthType form" fails if a password contains  '&' |
|48659|New|Maj|2010-02-02|Problem with accents in filename and byte serving |
|48687|New|Nor|2010-02-05|mod_rewrite ignores trailing dot in request URI on|
|48705|New|Enh|2010-02-08|flag to allow newlines in the error log as opposed|
|48712|New|Enh|2010-02-09|Add UID and GID to status page                    |
|48719|New|Nor|2010-02-09|[BUG] mod_proxy_ajp return wrong error message whe|
|48721|New|Nor|2010-02-10|[Patch] Add ProxyAllow to mod_proxy               |
|48731|New|Maj|2010-02-11|Prefork not creating processes after 10 servers ar|
|48732|New|Nor|2010-02-12|[BUG] environment variable SCRIPT_NAME output erro|
|48769|New|Nor|2010-02-18|[PATCH] Processes in the busy list should not be k|
|48777|New|Maj|2010-02-19|proxy balancer not detecting correctly when host (|
|48780|New|Enh|2010-02-19|Enable mod_authnz_ldap to accept valid client cert|
|48792|New|Enh|2010-02-22|httpd util apachectl returns wrong status informat|
|48805|New|Nor|2010-02-23|Corrupted response for HTTPS + KEEPALIVE=ON       |
|48808|New|Enh|2010-02-24|mod_authz_owner support for POSIX access control l|
|48819|Inf|Nor|2010-02-25|After users login on the web page, the page does n|
|48842|Inf|Nor|2010-03-02|mod_log_config logs the full size of the file inst|
|48880|Opn|Nor|2010-03-09|error on make                                     |
|48888|New|Nor|2010-03-10|DOCTYPE definitions nearly 11 years out-of-date   |
|48920|New|Enh|2010-03-15|Breadcrumbs on mod_autoindex path                 |
|48921|Inf|Nor|2010-03-16|mod_mem_cache crash, version 2.2.15.0             |
|48937|New|Enh|2010-03-18|Feature proposal - support sasl_bind              |
|48949|Inf|Cri|2010-03-20|fcgid processes never get killed after graceful re|
|48958|New|Nor|2010-03-22|mod_ldap, ldap credential cache & graceful restart|
|48987|New|Trv|2010-03-25|typo in polish translation of HTTP_UNAUTHORIZED.ht|
|49037|New|Enh|2010-04-02|SSLVerifyClient require_no_ca                     |
|49043|New|Maj|2010-04-04|Using ssi include directive overwrites QUERY_STRIN|
|49058|New|Nor|2010-04-06|Prefork MPM tries to accept on closed listener soc|
|49067|New|Nor|2010-04-08|FTPOptions ShowUnAuthorizedFiles does not work    |
|49068|New|Nor|2010-04-08|UTF-8 URL Encode error                            |
|49087|New|Maj|2010-04-11|MSI installation reports "interrupted installation|
|49114|New|Maj|2010-04-13|NTFS junction directories missing from directory l|
|49123|New|Nor|2010-04-14|mod_proxy_ajp does not send the client's SSL chain|
|49131|New|Nor|2010-04-15|Very long URLs cause 404 or 403 errors with SetAct|
|49133|New|Maj|2010-04-16|Windows service recovery options do not work for A|
|49157|New|Nor|2010-04-20|Issues with xml interface for balancer manager    |
|49187|New|Nor|2010-04-26|Crash mod_mem_cache and mod_svn                   |
|49199|New|Enh|2010-04-27|Implement LDAP scope-aware caching in mod_ldap    |
|49220|New|Nor|2010-04-29|feature request for being able to disable FcgidWra|
|49239|New|Blk|2010-05-01|Apache mod_ssl gives coredump with openssl 0.9.8  |
|49277|New|Nor|2010-05-12|Expose a variable to identify SSL Session renegoti|
|49283|New|Nor|2010-05-12|Language of dates on SSI                          |
|49285|New|Enh|2010-05-13|Relative (local to current directory) URLs do not |
|49348|New|Enh|2010-05-27|[mod_log_config] Output log file name format capab|
|49385|New|Maj|2010-06-03|mod_disk_cache server side included files are inte|
|49387|Inf|Cri|2010-06-03|Unable to modify default charset setting to UTF-8 |
|49391|New|Nor|2010-06-05|mod_disk_cache needs to register a cleanup to kill|
|49396|New|Enh|2010-06-06|PATH_INFO normalization, especially relating to vo|
|49427|New|Nor|2010-06-11|mod_cgid and mod_cgi do not return proper value wh|
|49433|New|Enh|2010-06-13|improving info in server status                   |
|49439|New|Nor|2010-06-14|Bug in mod_userdir which prevents suexec from runn|
|49504|New|Nor|2010-06-25|Solaris 10/x64 worker graceful restart problem    |
|49532|New|Nor|2010-06-30|mod_cache: Set-Cookie headers are appended to cach|
|49553|New|Min|2010-07-05|Set QoS bits via APR2 API instead                 |
|49568|New|Maj|2010-07-07|Apache mod_authnz_ldap built with the MS LDAPSDK d|
|49632|Inf|Nor|2010-07-21|mod_authnz_ldap denies users when search is perfor|
|49633|New|Enh|2010-07-21|Handle AD primary groups in mod_authnz_ldap       |
|49642|New|Nor|2010-07-23|mod_rewrite mistakes encoded question mark as path|
|49643|New|Nor|2010-07-23|WebDav plus mod Negotiation causes directory creat|
|49676|New|Nor|2010-07-30|directory with german umlauts are indented by one |
|49680|New|Maj|2010-07-30|Perl script are not running on Win32, Apache 2.2.1|
|49684|New|Enh|2010-08-01|enhancement for ipv6 implementation               |
|49699|New|Nor|2010-08-03|Inconsistent Keep-alive from proxy to the origin s|
|49715|New|Maj|2010-08-06|ProxyPassMatch Url Encoder Problem                |
|49717|New|Enh|2010-08-06|PATCH: Enable SSL Timeout                         |
|49737|Inf|Nor|2010-08-10|order allow,deny does not work on IPv6            |
|49743|New|Maj|2010-08-12|SSI 'echo encoding="(url/none)"' bug              |
|49746|Opn|Enh|2010-08-12|mod_rewrite urlencode option                      |
|49766|New|Maj|2010-08-17|POST request on CGI script generating empty body c|
|49771|New|Nor|2010-08-17|After graceful restart using mod_proxy_ajp, couldn|
|49772|New|Nor|2010-08-18|mod_deflate kicks itself out on Content-Range resp|
|49798|Opn|Nor|2010-08-22|[mod_log_config] Piped Log scripts process cause w|
|49807|New|Enh|2010-08-23|hard to force Content-Type header for non static f|
|49810|New|Nor|2010-08-23|Mod_autoindex output of header/body/footer scrambl|
|49815|New|Enh|2010-08-24|Enable caching for HTTP Range requests / 206 respo|
|49829|New|Trv|2010-08-26|CGI index command line arguments excessively escap|
|49832|New|Enh|2010-08-26|void ap_custom_response is not supporting the bina|
|49859|Opn|Nor|2010-09-01|url with additional filepath generates bad environ|
|49921|New|Nor|2010-09-13|Trailers in chunked http requests are not handled |
|49926|New|Enh|2010-09-14|New option for mod_log_forensics or mod_log_config|
|49980|New|Nor|2010-09-22|can't use a FIFO for SSL key file; mod_ssl checks |
|49981|New|Enh|2010-09-22|Requesting SSLCertificateKeyFile Dialog functional|
|49990|New|Nor|2010-09-23|Feature request: implement ExpiresActive reset    |
|49996|New|Nor|2010-09-24|Proxied ErrorDocument returns 200 OK response code|
|49997|New|Nor|2010-09-24|wrowe promised me...                              |
|50004|New|Nor|2010-09-26|per-dir rewrite without DocumentRoot or RewriteBas|
|50011|New|Cri|2010-09-27|error running apache, and installing apache as a s|
|50024|New|Min|2010-09-29|Mod_cache/mod_mem_cache and mod_security combinati|
|50038|New|Enh|2010-10-01|What Directives apply to a file/directory? Resulta|
|50041|New|Min|2010-10-04|(9)Bad file descriptor: apr_socket_accept: (client|
|50051|New|Nor|2010-10-07|Log PID in first entry logged for each request    |
|50061|New|Nor|2010-10-08|Semicolon character '%3B' seems to be decoded to '|
|50082|New|Nor|2010-10-12|apachectl status returns incorrect exit code      |
|50112|New|Nor|2010-10-18|buildconf broken in two places                    |
|50116|New|Nor|2010-10-19|Apache fragments packets unnecessarily            |
|50151|New|Nor|2010-10-25|Software caused connection abort and apache proces|
|50155|Inf|Nor|2010-10-25|httpd -s attempts to read SSL certificates        |
|50172|Inf|Nor|2010-10-28|Digest allows access bypassing secuity            |
|50227|New|Enh|2010-11-07|Option to fail SSL handshake for diverted SNI conn|
|50237|Inf|Nor|2010-11-08|webdav LOCK access with multiple threads to same f|
|50261|New|Nor|2010-11-12|graceful restart with multiple listeners using pre|
|50262|New|Nor|2010-11-12|mod_rewrite log ip address vs hostname            |
|50274|New|Nor|2010-11-15|always pass CONTENT_LENGTH to the application     |
|50278|New|Nor|2010-11-16|-DFOREGROUND and ap_unixd_killpg()/ap_os_killpg() |
|50290|Inf|Nor|2010-11-18|vanilla apache 2.2.17 installation crashes (lib-ap|
|50296|New|Nor|2010-11-18|LDAPVerifyServerCert and possibly LDAPTrustedMode |
|50317|New|Nor|2010-11-22|Possible error in mod_cache's "Avoiding the Thunde|
|50336|New|Min|2010-11-25|PUT failures do not emit Allow:                   |
|50344|New|Nor|2010-11-26|ProxyPass does not handle different protocols when|
|50357|New|Enh|2010-11-28|improve matching mechanisms for mime type and enco|
|50372|New|Enh|2010-11-29|any reason for allowing ModMimeUsePathInfo only in|
|50390|New|Nor|2010-11-30|WARNING: Unrecognized options : --disable-ipv6    |
|50402|New|Nor|2010-12-02|SetEnv proxy-sendchunks is ignored for small amoun|
|50412|New|Nor|2010-12-04|if IndexOptions +XHTML, the correct MIME type shou|
|50423|Inf|Nor|2010-12-06|Apache is terminated with signal 11, Segmentation |
|50427|New|Nor|2010-12-07|Windows>=Vista+mod_auth_digest+command line=proble|
|50432|New|Enh|2010-12-08|add PCRE-mode for file based matches              |
|50436|New|Enh|2010-12-08|VirtualHost could behave like people expect it to |
|50444|New|Enh|2010-12-09|Pre-close logging handles in cgid agent           |
|50456|Inf|Nor|2010-12-10|Invalid Error 413 crash Apache                    |
|50464|New|Blk|2010-12-13|undefined reference to `BIO_set_callback' `BIO_set|
|50466|Inf|Maj|2010-12-13|httpd process doesn't recycle                     |
|50473|New|Maj|2010-12-14|zlib.dll Problem                                  |
|50521|New|Nor|2010-12-25|Comment at top of sample main config file is wrong|
|50525|New|Nor|2010-12-28|Header directive won't edit Location header from P|
|50530|New|Enh|2010-12-29|Provide rate limiting for failed authentication at|
|50532|New|Enh|2010-12-30|Mail protection                                   |
|50551|New|Nor|2011-01-06|Some proxied connections ignore ttl setting       |
|50562|Opn|Cri|2011-01-09|wrong PATH_INFO CGI environment with non-ASCII UTF|
|50584|New|Enh|2011-01-14|Add error message when RequestReadTimeout triggere|
|50592|New|Maj|2011-01-15|httpd dumps core on an IPv6 only system           |
|50602|New|Nor|2011-01-17|non thread safe functions used in apache httpd pro|
|50619|New|Min|2011-01-19|After changing resolv.conf signaling httpd doesn't|
|50628|New|Blk|2011-01-21|Core dump happens with Apache 2.2.15 using openssl|
|50630|New|Nor|2011-01-21|Apache return 500 error with authentication by LDA|
|50644|New|Enh|2011-01-24|Add support for maximum number of requests per Kee|
|50654|New|Nor|2011-01-25|FileETag ContentMD5 & Filename, optimisation to Co|
|50693|New|Nor|2011-01-31|AllowOverride Options=(not Foo) should permit no-o|
|50704|Inf|Nor|2011-02-01|mod_cache doesn't cache MultiViews                |
|50712|New|Maj|2011-02-02|Restart button only stops the server ...and do not|
|50727|New|Nor|2011-02-07|ISAPI EXTENSION_CONTROL_BLOCK Missing PostData wit|
|50765|New|Enh|2011-02-11|Runtime Backend Pinning via balancer-manager      |
|50770|New|Nor|2011-02-14|a rotatelogs issue, if time changed               |
|50773|Inf|Nor|2011-02-14|Dav lock database corruption                      |
|50774|New|Enh|2011-02-14|Have a way to invalidate cache without other reque|
|50777|New|Nor|2011-02-14|Back port buildconf specifies AC_PREREQ(2.13) fix |
|50796|New|Enh|2011-02-16|record time between keepalives in access log      |
|50807|New|Maj|2011-02-18|mod_proxy fails to send FIN response when a FIN is|
|50814|New|Nor|2011-02-21|SSI exec not working on Windows (Apache 2.x)      |
|50848|New|Enh|2011-03-01|Content Negotiation type map file precedence could|
|50869|New|Enh|2011-03-04|Need directive to control use and timeout of sessi|
|50873|New|Nor|2011-03-04|httpd does not start properly when built from sour|
|50878|New|Nor|2011-03-05|redundant operation when calling apr_stat         |
|50891|New|Nor|2011-03-08|Apache rewrites WWW-Authenticate headers from CGI |
|50902|Inf|Maj|2011-03-09|on major load on the server, poll() hangs         |
|50916|New|Nor|2011-03-11|RewriteMap program: mod_rewrite sends request but |
|50926|New|Nor|2011-03-14|unexpected <Directory> file-matching behavior     |
|50942|New|Maj|2011-03-17|Apache 2.2.16 forward proxy is 5x times slower tha|
|50945|Opn|Nor|2011-03-18|AJP: Missing support for ErrorOverride            |
|50948|Opn|Nor|2011-03-19|Connection not closed when CGI dies waiting for PO|
|50954|New|Nor|2011-03-21|ProxyRemote doesnt use CONNECT method with https s|
|50959|New|Enh|2011-03-23|Add cache-manifest to the mime type list          |
|50976|New|Nor|2011-03-26|Apache losts client's ip (%a or %h) sometimes.    |
|50999|Opn|Nor|2011-03-30|it seems the configure wrong detect my apr-util ve|
|51001|New|Nor|2011-03-31|patch for hook ap_lua_run_lua_open                |
|51005|New|Enh|2011-04-01|Allow to use username in LDAP filter              |
|51006|New|Blk|2011-04-01|Apache consume all memory and swap when setup as r|
|51019|New|Enh|2011-04-04|[PATCH] Implementation of Asynchronous processing |
|51020|Opn|Nor|2011-04-04|[PATCH] Apache/mod_fcgid.so does not start in comp|
|51022|New|Nor|2011-04-05|Segmentation fault on PUT request                 |
|51030|New|Enh|2011-04-06|Way to terminate CGI immediatly after closing conn|
|51078|Inf|Nor|2011-04-18|[PATCH] mod_fcgid spawned CGI Processes gets orpha|
|51079|New|Enh|2011-04-18|[PATCH] mod_fcgid spawned CGI Process cannot imper|
|51080|New|Nor|2011-04-18|[PATCH] mod_isapi does not support Except:100-Cont|
|51103|Opn|Nor|2011-04-21|mod_reqtimeout does not drop connection and return|
|51104|Opn|Maj|2011-04-21|C++ support about httpd_config.h                  |
|51107|New|Min|2011-04-22|SetOutputFilter and SetInputFilter should allow "n|
|51118|New|Nor|2011-04-26|LDAP cache is cleared after graceful/restart and o|
|51127|New|Nor|2011-04-27|Make ProxyPassReverseCookiePath work as expected  |
|51168|New|Nor|2011-05-08|mod_status Total Traffic won't take account of int|
|51170|New|Nor|2011-05-09|I/O errors when using keep-alive + mod_ssl        |
|51174|New|Min|2011-05-09|SSLRequire predicates using OIDs unknown to openss|
|51186|New|Blk|2011-05-11|NEw Openssl 1.0.1 with new FIPS                   |
|51190|New|Min|2011-05-12|::/0 does not work with allow from and deny from  |
|51194|New|Nor|2011-05-13|FcgidWrapper does not support paths containing a s|
|51201|Inf|Nor|2011-05-15|Strange behavior REQUEST_METHOD & GET in mod_rewri|
|51223|New|Nor|2011-05-18|304 HTTP Not Modified strips out CORS headers     |
|51224|New|Nor|2011-05-18|mod_dav_fs should respect FileETag                |
|51239|New|Nor|2011-05-21|ap_get_client_block may block continuously sometim|
|51257|New|Nor|2011-05-24|Build failed when cross-compiling: ./gen_test_char|
|51258|Opn|Enh|2011-05-24|new features for mod_substitute                   |
|51296|New|Enh|2011-05-31|Dynamic engine support using SSLCryptoDevice suppo|
|51297|New|Nor|2011-05-31|Improve error handling during "UNLOCK"            |
|51303|New|Nor|2011-05-31|TraceEnable 500 error                             |
|51312|New|Nor|2011-06-01|mod_filter should support adding to the Vary heade|
|51322|New|Enh|2011-06-04|Prepend and append string to LDAP search parameter|
|51359|Inf|Enh|2011-06-11|Added shebang check for //! so that .js scripts wo|
|51365|New|Nor|2011-06-13|Mod_proxy mangles query string with mod_security  |
|51402|New|Nor|2011-06-21|"ForceLanguagePriority Fallback" not working as im|
|51406|New|Maj|2011-06-21|When listing files in subdirectories, the path is |
|51409|New|Nor|2011-06-21|Sorting options accepted by ls, but ignored       |
|51471|New|Nor|2011-07-04|<DirectoryMatch>ed IndexIgnore doesn't            |
|51479|New|Enh|2011-07-05|[PATCH] AB feature to optionally read in a reusabl|
|51491|New|Nor|2011-07-08|mod_dir breaks POSTs to URLs not ending in /      |
|51495|New|Nor|2011-07-11|mod_substitute cpu and memory limit               |
|51517|New|Maj|2011-07-16|mod_proxy_fcgi is not RFC 3875 compliant (SCRIPT_F|
|51522|Ver|Trv|2011-07-18|Wrong French translation in mpm.html ("Certains Mo|
|51542|New|Nor|2011-07-22|Apache HTTP Server vs PVS-Studio                  |
|51543|New|Nor|2011-07-22|Space in username not properly escaped in log file|
|51552|Inf|Cri|2011-07-25|Apache is not starting (2.2.15)                   |
|51573|New|Enh|2011-07-28|Easy way to erase log files                       |
|51576|Inf|Nor|2011-07-28|mod_rewrite rule stopped working                  |
|51600|New|Enh|2011-08-02|Loading the same certificate in multiple virtual h|
|51603|Inf|Maj|2011-08-02|Apache accepts completely bogus HTTP requests (pos|
|51607|Inf|Nor|2011-08-03|DBDPrepareSQL ( ap_dbd_prepare ) does not work cor|
|51629|New|Nor|2011-08-05|DocumentRoot check incorrect when running under ch|
|51674|New|Blk|2011-08-18|AJP Module Bad Request                            |
|51679|New|Min|2011-08-18|Code signature key expired                        |
|51689|New|Trv|2011-08-19|Cross compiling causes multiple Listen directives |
|51695|New|Trv|2011-08-20|Code clean up (ap_rputs merge)                    |
|51707|New|Nor|2011-08-22|ProxyPassReverse issues within <Location> (differe|
|51709|New|Nor|2011-08-23|ServerName/ServerAlias don't work if Host: header |
|51711|New|Nor|2011-08-23|mod_auth_digest have broken shared mem (nonce) cod|
|51718|New|Enh|2011-08-24|Feature Request: Add shorthand to redirect any Ser|
|51725|New|Nor|2011-08-26|Multiple Range: request accepted as "Range: n-m"  |
|51732|New|Nor|2011-08-29|Inconsistencies in log messages' verbosity levels |
|51747|New|Blk|2011-08-31|mod_fcgid loads entire request into memory while p|
|51757|Inf|Enh|2011-09-02|Add support for SASL auth in LDAP                 |
|51778|Inf|Cri|2011-09-07|while buliding(make) a unix source "httpd-2.2.20.t|
|51797|Inf|Maj|2011-09-10|Crash HTTPD(Windows)                              |
|51814|New|Enh|2011-09-14|mod_proxy in Apache HTTP 2.2 FIN_WAIT2 in server s|
|51858|Inf|Nor|2011-09-21|weird error for mod_rewrite with more then 3 param|
|51864|New|Nor|2011-09-22|mod_cache returns entire entity from origin server|
|51904|New|Nor|2011-09-28|output to stderr from cgi script causes script to |
|51951|New|Nor|2011-10-04|mod_mbox hang on some e-mails on press@a.o - was I|
|51964|Ver|Nor|2011-10-05|Documentation of RewriteRule flag skip unclear    |
|51965|New|Nor|2011-10-05|--with-z=DIR not being honored                    |
|51982|Opn|Nor|2011-10-06|ProxyPassReverse / balancer://cluster/ adds slash |
|51987|Inf|Nor|2011-10-07|RewriteRule doesn't work correctly with apache 2.3|
|51994|New|Enh|2011-10-07|Mod_authn_socache should have some way to flush th|
|52004|Ver|Trv|2011-10-10|Typo "indexe" in French translation of mpm.html   |
|52007|New|Nor|2011-10-10|Content-Length: 0 not set on proxy response       |
|52038|New|Nor|2011-10-16|NameWidth works incorrectly together with Charset=|
|52039|Inf|Nor|2011-10-16|Browser mode does not always work                 |
|52043|New|Nor|2011-10-17|Directories ".", "..", and "/" do not work correct|
|52081|New|Nor|2011-10-24|segfault if mbox files have unexpected names      |
|52090|New|Maj|2011-10-26|Apache thread hangs with error 500 when sending a |
|52120|Opn|Nor|2011-11-01|mod_cache edge case: uncacheable 304 sends cached |
|52123|New|Maj|2011-11-02|DoS: High memory usage in propfind                |
|52132|New|Nor|2011-11-03|[PATCH] process activity score calculated incorrec|
|52139|New|Nor|2011-11-05|Never Syntax Error on non-existent DocumentRoot   |
|52171|Ver|Nor|2011-11-13|confusing documentation of request phases         |
|52174|New|Enh|2011-11-13|Allow hard lower-limits on the number of fcgi serv|
|52178|New|Nor|2011-11-14|IPv6 IPs as ServerName not allowed                |
|52181|Ver|Nor|2011-11-14|mod_rewrite Technical Details Ruleset Processing d|
|52195|Inf|Nor|2011-11-16|Japanese texts are garbled on mailing list archive|
|52196|Inf|Nor|2011-11-16|winnt mpm, others mpm also have this bug. pool sha|
|52207|Inf|Maj|2011-11-18|Upgrade apache version from 2.0.59 to 2.2.12 or ab|
|52222|New|Nor|2011-11-21|IndexIgnore ignores parent directories in argument|
|52247|New|Nor|2011-11-26|mod_mbox gives up on unexpected message format    |
|52248|New|Nor|2011-11-26|Bugzilla version drop-down list does not offer "un|
|52252|New|Nor|2011-11-27|luajit support broken for (at least) luajit 2.0   |
|52253|Inf|Nor|2011-11-28|Timeout doesn't work. mod_proxy_balancer strongly |
|52264|New|Enh|2011-11-30|Update and complete balancer-manager XML output   |
|52269|Inf|Nor|2011-12-01|[mod_proxy] Apache reverse proxy status code trans|
|52275|New|Nor|2011-12-02|memory leak in proxy_ajp_handler                  |
|52298|Inf|Nor|2011-12-07|Can't enter website with client certificate on an |
|52301|New|Enh|2011-12-07|Error message "RSA server certificate ... CN ... d|
|52302|New|Enh|2011-12-07|Better documentation of how server name is determi|
|52304|New|Nor|2011-12-08|<Limit> Does Not Apply When URI Is Folder         |
|52313|New|Enh|2011-12-09|htdbm enhancement: options for colon-in-username, |
|52322|Inf|Enh|2011-12-13|Providing BBC developed httpd modules for inclusio|
|52342|New|Nor|2011-12-15|ap_internal_redirect dropping filters means incons|
|52370|New|Nor|2011-12-19|apreq_decode/url_decode length miscalculation     |
|52377|New|Enh|2011-12-20|Add Directives to assert user, group, and permissi|
|52383|New|Trv|2011-12-24|Instllation log typo                              |
|52391|New|Cri|2011-12-27|100% CPU usage while using Forward Proxy          |
|52395|New|Nor|2011-12-29|reload results in different end environment to res|
|52403|New|Nor|2011-12-31|FallbackResource doesn't work for non-existent PHP|
|52408|New|Nor|2012-01-01|Directoryindex matching automatically redirects   |
|52415|New|Nor|2012-01-03|LockFile placed inappropriately                   |
|52417|New|Nor|2012-01-03|HEADERS information in the file                   |
|52435|New|Nor|2012-01-06|Apache shutdown automatically                     |
|52439|New|Enh|2012-01-09|It should be possible to treat errors in .htaccess|
|52453|New|Enh|2012-01-11|Ability to configure --logfiledir                 |
|52465|New|Nor|2012-01-13|mod_dir is allowed to redirect proxy requests     |
|52481|New|Nor|2012-01-18|Rotatelog.exe crashes Apache after setting 256MB r|
|52485|New|Nor|2012-01-19|CPU load 100%                                     |
|52494|New|Enh|2012-01-22|allow the Action directive to point in the filesys|
|52495|New|Enh|2012-01-22|CACertificate, CADNCertificate, CARevocation, Cert|
|52501|New|Cri|2012-01-23|child pid 10824 exit signal Segmentation fault (11|
|52505|New|Nor|2012-01-23|Include with directory wildcards gives errors for |
|52509|New|Nor|2012-01-23|Resources protected by .htaccess file may not be a|
|52510|New|Cri|2012-01-23|Segmentation Fault 11                             |
|52520|New|Nor|2012-01-24|ProxyRemote & NoProxy directive can not take IPv6 |
|52532|New|Trv|2012-01-26|VirtualHost added TWICE to name-virtual-host list |
|52539|New|Nor|2012-01-26|Apache mod_dav 400 Bad Request for non-existent co|
|52546|New|Nor|2012-01-27|overwrite SERVER_PROTOCOL environment             |
|52573|New|Nor|2012-02-01|mod_speling case correction fails when URI has dou|
|52578|Opn|Enh|2012-02-02|Wrong "bytes sent" logged when connection is close|
|52594|New|Nor|2012-02-03|rpmbuild -ba errors out with "File not found by gl|
|52595|New|Nor|2012-02-03|requests with gzip+chunked encoded body don't prox|
|52605|Inf|Min|2012-02-05|Please allow request lines longer than 8k         |
|52612|New|Nor|2012-02-06|Default Service Account                           |
|52616|Opn|Enh|2012-02-07|SSLUserName uses SSL_CLIENT_S_DN insted of SSL_CLI|
|52617|New|Maj|2012-02-07|Visit the rewrite page from ServerAlias domain vho|
|52623|New|Nor|2012-02-08|does not build with pcre-8.30                     |
|52644|New|Nor|2012-02-12|document how SSL FakeBasicAuth works with strange |
|52668|New|Trv|2012-02-14|More future safe patch for old MSIE ssl-unclean-sh|
|52670|New|Trv|2012-02-15|please clarify the effect of SSLStrictSNIVHostChec|
|52683|New|Enh|2012-02-16|add a symlink option that rechecks the access perm|
|52700|Inf|Blk|2012-02-17|Not rendering html content instead displaying clie|
|52703|Inf|Maj|2012-02-18|SSL+SNI+client-auth "lost" after some time        |
|52710|New|Nor|2012-02-19|mod_fcgid should set PATH_INFO when configured in |
|52756|Inf|Trv|2012-02-24|proxy_html_module LoadModule line not created in h|
|52759|New|Cri|2012-02-24|Apache httpd child process consuming high CPU Util|
|52790|New|Nor|2012-02-28|ldap caching not sufficient                       |
|52795|Opn|Nor|2012-02-29|mod_fcgid fails to spawn process in C:\Program Fil|
|52806|New|Nor|2012-03-01|configure: --with-included-apr is not supported in|
|52807|New|Nor|2012-03-01|some random strings are accepted by "configure" as|
|52816|New|Nor|2012-03-03|Potential segfault in socache_shmcb_create        |
|52817|New|Nor|2012-03-03|Long directory path sucks (but it's really a valid|
|52822|New|Nor|2012-03-04|Quiet installation not fully quiet                |
|52824|Inf|Nor|2012-03-04|Conflicts between AllowOverride and AllowOverrideL|
|52828|New|Maj|2012-03-05|Child process is not replaced in Windows, after a |
|52832|New|Nor|2012-03-05|numerical configuration entry can be mistakenly in|
|52841|Opn|Nor|2012-03-06|[proxy_balancer:emerg] [pid 25593] AH01177: Failed|
|52851|New|Nor|2012-03-07|Core TimeOut directive doesn't work               |
|52860|New|Enh|2012-03-08|Support Transfer-Encoding: gzip                   |
|52865|New|Nor|2012-03-09|Crash by segmentation fault in mod_authn_core in A|
|52870|New|Cri|2012-03-09|100% CPU usage while using Forward Proxy          |
|52874|New|Enh|2012-03-09|Support Use TrustedFirst checking when verifying c|
|52884|New|Nor|2012-03-12|"localhost" leads to start failure                |
|52890|Inf|Nor|2012-03-12|--with-included-apr doesn't work when srclib/apr a|
|52891|New|Nor|2012-03-12|2.2 doesn't perform as well as 1.3                |
|52894|Inf|Nor|2012-03-13|Apache aborts abnormally when ChrootDir is set    |
|52927|Inf|Nor|2012-03-16|[Bug in httpd 2.2.4] [error] (70014)End of file fo|
|52933|New|Nor|2012-03-17|Child survives '-k stop', consuming lots of CPU   |
|52950|New|Nor|2012-03-20|Error when set AuthType to None with valid-user   |
|52963|New|Nor|2012-03-21|Typo in AuthLDAPURL RFC 2255 error message        |
|52975|New|Nor|2012-03-23|Receiving files is suboptimal                     |
|52976|New|Min|2012-03-23|Gratuitous string-duplication in module-configurat|
|52978|New|Enh|2012-03-23|Binding to an interface instead of an address     |
|52995|New|Nor|2012-03-28|httpd -V does not print the default Mutex         |
|53002|New|Nor|2012-03-29|<Location> and auth_form (trailing slash problem?)|
|53015|New|Nor|2012-03-31|missing apr_socket_close                          |
|53016|New|Nor|2012-03-31|missing apr_brigade_destroy                       |
|53023|New|Nor|2012-04-02|mod_rewrite RewriteCond parser error and documenta|
|53037|New|Enh|2012-04-05|clarify mod_ssl documentation on the UID/GID conte|
|53059|New|Nor|2012-04-10|Make httpd easier relocatable by using a variable |
|53098|New|Nor|2012-04-18|mod_proxy_ajp: patch to set worker secret passed t|
|53099|New|Enh|2012-04-18|feature request for mod_remoteip                  |
|53108|New|Enh|2012-04-19|clarification on url-path vs full filesystem path |
|53111|New|Nor|2012-04-20|1% of CMS sites expose database passwords         |
|53121|New|Nor|2012-04-22|Confusing documentation, gzip and deflate         |
|53149|New|Enh|2012-04-25|mod_ldap should/could use mod_socache             |
|53152|Opn|Nor|2012-04-26|RewriteRule documentation: Error about per-directo|
|53156|New|Enh|2012-04-27|CRL validation fails if CRL is missing            |
|53160|New|Cri|2012-04-29|Reverse Proxy mod_deflate doesn't zip back content|
|53183|New|Min|2012-05-03|mod_apreq2 entry point is apreq_module and not apr|
|53193|New|Nor|2012-05-04|SLVerifyClient optional_no_ca + SSLSessionCache = |
|53218|New|Blk|2012-05-11|ProxyPass worker name　(http://localhost:3128/...|
|53233|New|Maj|2012-05-15|Internal error: proxy: error reading status line f|
|53239|New|Maj|2012-05-16|Httpd has problems delivering data on rate-limited|
|53253|New|Maj|2012-05-17|TCP_NOPUSH used with sendfile(2), cause transfers |
|53284|New|Nor|2012-05-24|crash                                             |
|53290|New|Maj|2012-05-24|memory usage                                      |
|53292|New|Min|2012-05-25|add support for HTTP status code 308              |
|53305|New|Nor|2012-05-28|404 errors when adding query string in a balancer |
|53313|New|Nor|2012-05-28|SSI #echo VAR fails (#include OK) if URI/URL has f|
|53319|New|Nor|2012-05-29|Multiple DirectoryIndex statements in the same con|
|53332|New|Nor|2012-05-30|Requests with chunked encoding have no body availa|
|53350|New|Nor|2012-06-01|mod_cache caching 403 responses Apahce 2.2.22     |
|53351|New|Nor|2012-06-02|make fails if layout begins on first line of confi|
|53388|Opn|Nor|2012-06-08|mod_proxy_balanser generates 503 when proxying to |
|53402|New|Trv|2012-06-12|Incorrect error message for mod_ldap params       |
|53461|Inf|Cri|2012-06-23|Compilation problems                              |
|53462|New|Nor|2012-06-25|mod_rewrite does not remove trailing slash when as|
|53479|New|Nor|2012-06-27|mod_rewrite [B] flag should percent-encode the spa|
|53483|New|Enh|2012-06-29|dangerous PCRE patterns in *Match directives      |
|53539|New|Maj|2012-07-12|content type and character set are changing when t|
|53554|New|Nor|2012-07-16|Wrong case for hexadecimal percent encoding [patch|
|53555|New|Maj|2012-07-17|Scoreboard full error with event/ssl              |
|53579|New|Cri|2012-07-20|httpd looping writing on a pipe and unresponsive (|
|53581|New|Blk|2012-07-21|FollowSymlinks doesn't work with DirectoryMatch an|
|53594|New|Enh|2012-07-24|ipad as webserver                                 |
|53595|New|Nor|2012-07-24|Media type qs parameters for MultiViews sent in Co|
|53612|Inf|Nor|2012-07-27|Reverse Proxy causing 500 error SSL proxy 1.0.1c O|
|53618|New|Nor|2012-07-29|proxy_worker_shared fields not maintained in threa|
|53634|New|Nor|2012-08-01|mod_cache returning HTTP 200 for nonexistent resou|
|53638|New|Nor|2012-08-02|Problem with shortcuts to bugzilla in http://httpd|
|53640|Inf|Maj|2012-08-02|make: Fatal error: Command failed for target `htpa|
|53643|New|Cri|2012-08-02|apache segfaults with mod_authn_dbd when dbd_min i|
|53646|New|Nor|2012-08-02|Invalid uniformly distributed balancing of request|
|53651|New|Nor|2012-08-03|Worker failure doesn't have same behaviour as work|
|53667|New|Enh|2012-08-07|Add an equivalent option to "JkOptions ForwardLoca|
|53669|New|Nor|2012-08-07|IndexOptions Incremental IndexOptions documentatio|
|53686|New|Enh|2012-08-09|Status "501 Not Implemented" sent very late       |
|53690|New|Nor|2012-08-09|Calls to semctl() trigger "uninitialized memory" w|
|53692|New|Nor|2012-08-10|mod_auth_form loses request body before login page|
|53693|Opn|Nor|2012-08-10|mod_fcgid performance suffers under increase in re|
|53704|New|Enh|2012-08-13|True online configuration is needed - via LDAP?   |
|53705|New|Nor|2012-08-13|Align server-status balancer display to balancer-m|
|53706|New|Enh|2012-08-13|Include a status display for mod_ldap when present|
|53722|New|Nor|2012-08-15|when -D NO_DETACH is used, no PID file should be c|
|53736|New|Nor|2012-08-17|/balancer-manager doesn't save runtime adjusted se|
|53757|New|Enh|2012-08-21|RewriteMap of type txt should allow specifying col|
|53767|New|Nor|2012-08-23|htcacheclean deletes stale "vary" header files eve|
|53772|New|Nor|2012-08-24|REDIRECT_URL not accessible in mod_proxy          |
|53787|New|Reg|2012-08-28|In forward proxy, doesn't cache disk anymore      |
|53823|New|Nor|2012-09-03|[patch] pure IPv6 only host fix (server/config.c) |
|53835|New|Cri|2012-09-06|mod_proxy_ajp truncate output when using deflate i|
|53870|New|Maj|2012-09-13|Deadlock in CRYPTO_add_lock with Apache 2.2.22 wor|
|53886|New|Nor|2012-09-18|can't start apache control in Redhat Linux 3 X64  |
|53899|New|Nor|2012-09-19|SSL_OP_ALL disables the mitigation code for CVE-20|
|53915|New|Nor|2012-09-21|Colon lost when :port is used in CacheKeyBaseURL  |
|53919|Inf|Enh|2012-09-21|DEFAULT_LOG_FORMAT is not RFC6302 compliant       |
|53923|New|Min|2012-09-23|Overriding CustomLog directive seems impossible   |
|53932|New|Nor|2012-09-25|PROPFIND doesn't support If, If-Match ETag predica|
|53947|New|Enh|2012-09-29|Feature Request, RewriteRule - ProxyPreserveHost f|
|53961|New|Nor|2012-10-04|Null sessions to the default vhost                |
|53970|New|Nor|2012-10-05|Network control directives affects internal subreq|
|53981|New|Nor|2012-10-08|move def of log_request_state from mod_log_config.|
|53988|New|Enh|2012-10-10|Missing FCGIWrapper script should not be a critica|
|53999|Opn|Nor|2012-10-13|Deadlock between procmgr_send_spawn_cmd()/proctabl|
|54030|New|Enh|2012-10-19|Support subjectAltName when (reverse-)proxying    |
|54033|New|Enh|2012-10-21|Parent languages are not ordered according to Acce|
|54072|New|Reg|2012-10-30|Syntax error front-end virtual-path too long      |
|54102|New|Enh|2012-11-05|new feature: automatic route detection            |
|54118|New|Nor|2012-11-08|Handle leak on parent httpd process when rotatelog|
|54126|New|Maj|2012-11-09|Mod_rewrite failing because of url in query string|
|54134|New|Enh|2012-11-11|new feature: ability to use multiple routes in sti|
|54136|New|Min|2012-11-11|balancer-handler shows xml not, when only xml para|
|54158|New|Nor|2012-11-16|Suggestion regarding 2.0 to 2.2 Upgrade Documentat|
|54183|Inf|Nor|2012-11-21|PROPFIND doesn't report getcontenttype property   |
|54215|New|Maj|2012-11-27|configure fails for httpd 2.2.3 with openssl 1.0.1|
|54221|Opn|Nor|2012-11-28|no ErrorLog prefix on CGI errors                  |
|54222|New|Min|2012-11-28|ServerTokens checking is not complete             |
|54223|New|Nor|2012-11-29|AH00554 error when runtime configuration Includes |
|54252|New|Nor|2012-12-05|acinclude.m4 requires -lz when linking with ssl st|
|54253|New|Nor|2012-12-05|mod_proxy_ftp doesn't handle/log partial or cancel|
|54255|New|Nor|2012-12-06|mod_deflate adjusts the headers "too late", should|
|54269|New|Maj|2012-12-09|mod_proxy_html documentation misses several things|
|54276|New|Nor|2012-12-10|rotatelogs not getting killed on graceful restart |
|54280|New|Nor|2012-12-11|mod_auth_form inline login not working with traili|
|54281|New|Nor|2012-12-11|Stick use Partial parameters from query string    |
|54289|New|Nor|2012-12-13|"ap_get_brigade" api is failing in "AP_MODE_SPECUL|
|54306|New|Enh|2012-12-15|add regexp versions of ProxyPassReverse, ProxyPass|
|54309|New|Trv|2012-12-15|clarification on the <Location> directive when use|
|54310|Opn|Nor|2012-12-15|mod_proxy_html drops meta elements with http-equiv|
|54319|New|Reg|2012-12-17|ProxyPass has no effect in <Location> if rewrite o|
|54339|New|Nor|2012-12-21|piped log entries > PIPE_BUF can be interleaved   |
|54342|New|Nor|2012-12-22|AuthnCacheSOCache can't pass args to socache provi|
|54343|New|Maj|2012-12-22|Add sanity checks for malloc() in mpm_winnt.c and |
|54358|New|Nor|2012-12-29|Status 500 when using ldap on Solaris because apr_|
|54363|New|Nor|2012-12-31|make time conversion caching functions thread-safe|
|54364|New|Nor|2012-12-31|Add ref to mod_fcgid docs                         |
|54365|New|Nor|2013-01-02|Connection closed by server during file transfer  |
|54366|New|Nor|2013-01-02|$sysconfdir/extra/httpd-dav.conf is not built base|
|54367|Opn|Maj|2013-01-02|Location header in response to PUT is not %-escape|
|54385|New|Enh|2013-01-08|SSL configuration independent from virtual hosts, |
|54401|New|Nor|2013-01-10|Suggest to make ProxyPassReverseCookieDomain accep|
|54415|New|Enh|2013-01-14|Please tell the root cause of mutex and scoreboard|
|54431|Inf|Blk|2013-01-16|Unable to start the Apache 2.4.3 windows service. |
|54498|New|Nor|2013-01-28|apache crash on any cgi request with certain http |
|54502|New|Nor|2013-01-29|Apache deadlock on epoll_ctl error (1000 process l|
|54512|Inf|Cri|2013-01-31|Apache hung                                       |
|54517|New|Nor|2013-02-01|proxy balancer: timeout or partial failure of back|
|54518|New|Nor|2013-02-01|mod_rewrite not adding Vary header                |
|54519|New|Nor|2013-02-02|httpd already running                             |
|54526|New|Nor|2013-02-05|mod_proxy_http ignores request abortion           |
|54543|New|Enh|2013-02-10|Compile regex only when need                      |
|54546|New|Nor|2013-02-11|httpd crashes on first HUP after change Listen dir|
|54549|New|Nor|2013-02-11|mod_mime AddEncoding and mod_negotiation fix_encod|
|54556|New|Enh|2013-02-13|New flag to add default rule in rule chain        |
|54560|New|Nor|2013-02-13|Potential segfault on return from ap_server_root_r|
|54563|New|Maj|2013-02-15|mod_webdav ignores quota                          |
|54578|New|Nor|2013-02-18|Bad docs or unchecked code for "LimitRequestFields|
|54605|New|Enh|2013-02-24|mod_negotiation should cache the info it generates|
|54608|New|Enh|2013-02-25|Support an option to allow page caching when using|
|54622|New|Nor|2013-02-28|shared memory cleanup                             |
|54626|New|Nor|2013-03-01|mod_authnz_ldap through util_ldap.c does not suppo|
|54633|New|Nor|2013-03-04|Invalid % encoding not rejected                   |
|54637|New|Nor|2013-03-05|Digest: secret not used                           |
|54640|New|Nor|2013-03-05|Slow transaction on a balance member is holding su|
|54649|New|Nor|2013-03-06|Incorrect PIDFILE prevent httpd restart           |
|54653|New|Min|2013-03-08|Suggestion to add https example for forward proxy |
|54656|New|Maj|2013-03-09|SNI and SSLProxyCheckPeerCN based on "connection" |
|54657|New|Nor|2013-03-09|DNS lookup failure for load balancer member does n|
|54683|New|Min|2013-03-13|Ignor directive ErrorDocument with null byte      |
|54699|Opn|Enh|2013-03-15|[feature request] cli webaccess tester            |
|54701|New|Cri|2013-03-15|Apache 2.4.3 Migration Issue Not loading the pages|
|54704|New|Nor|2013-03-15|Web Services stalling on it's own                 |
|54719|New|Nor|2013-03-18|httpd should check for and eventually create pid f|
|54752|New|Nor|2013-03-25|mod_ssl should not use uninitialized memory as ran|
|54782|New|Nor|2013-04-02|Memory Corruption errors - mpm_worker mod_perl    |
|54785|New|Nor|2013-04-02|Random crash when httpd server is stopped         |
|54793|New|Nor|2013-04-03|Socket timeout handler can delete uploaded files P|
|54794|New|Reg|2013-04-03|mod_wsgi|fcgid and subversion >= 1.7 issues       |
|54795|New|Nor|2013-04-03|'apxs -g -n' should be self-referring             |
|54796|Inf|Enh|2013-04-03|CustomLog should be able to use syslog as ErrorLog|
|54804|New|Nor|2013-04-05|mod_fcgid sends a Continue 100 response automatica|
|54813|New|Nor|2013-04-08|documnt the Require args used by authz_dbm includi|
|54816|Inf|Nor|2013-04-08|AH00566: request failed: invalid characters in URI|
|54817|New|Nor|2013-04-09|if prefix and sysconfdir are the same then http.co|
|54820|Inf|Cri|2013-04-09|REwriterule stops working                         |
|54824|New|Nor|2013-04-10|Spec file is missing libuuid-devel requirement    |
|54830|New|Enh|2013-04-11|Make SSLPProxyMachineCertificateFile configurable |
|54848|New|Nor|2013-04-15|Client field too short for IPv6 addresses         |
|54856|Inf|Enh|2013-04-17|NSCreateObjectFileImageFromFile                   |
|54858|New|Nor|2013-04-17|ld duplicate                                      |
|54861|New|Blk|2013-04-18|The number of connections with mysql is more      |
|54869|Inf|Nor|2013-04-19|Non-breaking space characters cause httpd to choke|
|54875|New|Nor|2013-04-23|Conditional request predicated on another URL's ET|
|54878|New|Nor|2013-04-23|Multiple Listen directives prevent server to start|
|54905|Inf|Cri|2013-04-29|Apache2 loops in child Segfaults                  |
|54910|New|Enh|2013-04-30|Format %{Foobar}o cannot be used to log Date and S|
|54911|New|Enh|2013-04-30|Allow logging of fields set by a backend server in|
|54914|New|Nor|2013-04-30|mod_dir DirectoryIndex breaks WebDAV PROPFIND / DE|
|54915|New|Nor|2013-04-30|GET on a WebDAV-enabled collection, with Directory|
|54918|New|Enh|2013-05-02|Implement RFC 6797 HTTP Strict Transport Security |
|54919|Inf|Nor|2013-05-02|*** glibc detected *** /usr/sbin/httpd: double fre|
|54930|New|Nor|2013-05-06|Allow empty message in ErrorDocument directive    |
|54934|Inf|Cri|2013-05-07|Apache is crashing intermittently with a message "|
|54936|New|Nor|2013-05-08|Some potential bugs reported by static analysis to|
|54949|New|Nor|2013-05-10|[PATCH] mod_cache: fix uninitialized tmppath varia|
|54952|Inf|Cri|2013-05-10|[Fri May 10 17:39:01 2013] [error] proxy: CLUSTER:|
|54953|New|Nor|2013-05-11|<VirtualHost 0.0.0.0:80> matches IPv6             |
|54958|New|Nor|2013-05-13|mod_deflate + mod_mime with SSI gives mixed compre|
|54962|New|Maj|2013-05-14|Apache will set incorrect Content-Length header an|
|54965|New|Enh|2013-05-14|Allow ProxyPassMatch in Directory context         |
|54976|New|Nor|2013-05-15|ProxyPass parameter "acquire" and "ttl" ignored in|
|54986|New|Maj|2013-05-16|httpd hanging on large form submit in ap_run_handl|
|54989|New|Nor|2013-05-17|Apache Segfaults on OS X at random - how can I dia|
|54993|New|Nor|2013-05-20|Critical error: File descriptor in bad state: apr_|
|54998|Ver|Nor|2013-05-21|Apache 2.4 terminates all SSL connections using an|
|55000|New|Nor|2013-05-21|Memory usage per process doubles when Apache is co|
|55021|New|Enh|2013-05-28|Support arbitrary sql to authentication username/p|
|55022|Inf|Cri|2013-05-28|child pid 3123 exit signal Bus error (10) - Apache|
|55034|Inf|Maj|2013-05-31|Apache 2.4.4 won't open more that 32k VH file hand|
|55039|New|Enh|2013-05-31|"RequestHeader edit" can't access environment vari|
|55045|New|Nor|2013-06-01|calls to gets() in test_find.c and test_parser.c  |
|55068|New|Enh|2013-06-06|root permissions when writing to per vhosts errorl|
|55069|New|Min|2013-06-06|notice message in error_log even when LogLevel err|
|55070|Opn|Enh|2013-06-06|mod_fcgid stderr always goes to main error log    |
|55072|New|Nor|2013-06-07|ErrorLog doesn't work well when apache shutdown   |
|55093|New|Nor|2013-06-12|[PATCH] mod_fcgid 2.3.7 truncates large posts on R|
|55096|New|Nor|2013-06-12|Make not running on httpd configure Solaris       |
|55098|New|Nor|2013-06-13|does not listen to IP4 when both IP4 address and I|
|55106|New|Enh|2013-06-17|ProxyErrorOverride considers response codes >= 400|
|55117|New|Nor|2013-06-18|GracefullTimeout for worker threads               |
|55148|Inf|Nor|2013-06-26|Error during SSL Handshake with remote server     |
|55152|New|Nor|2013-06-28|graceful restart adjusts to new balancer members, |
|55156|New|Nor|2013-06-28|mod_cache not respecting s-maxage cache-control he|
|55178|New|Nor|2013-07-01|[PATCH] mod_authnz_ldap SASL authentication suppor|
|55192|New|Trv|2013-07-03|htaccess error messages missing request context   |
|55193|New|Min|2013-07-03|ErrorLogFormat is ignored by some modules         |
|55226|New|Enh|2013-07-09|Request for "domain cluster" feature for mod_proxy|
|55234|New|Maj|2013-07-10|Working of attribute "protocol" attribute "protoco|
|55276|Inf|Enh|2013-07-17|Add REST API for load balancer for dynamic registr|
|55278|New|Nor|2013-07-18|mod_session's cookie may be empty, is repeated twi|
|55284|New|Nor|2013-07-20|repeatable segv                                   |
|55286|New|Nor|2013-07-21|Floating point exception (8) in mod_auth_digest   |
|55293|New|Nor|2013-07-22|Incorrect default MIME type for .woff fonts       |
|55306|New|Nor|2013-07-25|Error when copying svn repository, which contains |
|55323|New|Nor|2013-07-29|Double unescaped uri in sub request handler       |
|55327|New|Nor|2013-07-30|Segmentation fault when stopping Apache 2.4.6 norm|
|55340|New|Maj|2013-08-01|Listen for valid, unconfigured IP address passes c|
|55344|New|Nor|2013-08-02|missing ap_hook_monitor on windows                |
|55346|New|Nor|2013-08-02|When on filled quota filesystem, mod_fcgid init in|
|55348|New|Nor|2013-08-02|%h is not changed in logging, only %a             |
|55351|New|Enh|2013-08-04|allow ProxyPassReverseCookieDomain to automaticall|
|55362|New|Nor|2013-08-05|Apache httpd sends "400 Bad Request" to client due|
|55379|New|Min|2013-08-07|htdigest -c doesn't behave as described anymore   |
|55394|New|Nor|2013-08-09|apache 2.4 randomy crashes with signal 6          |
|55401|New|Enh|2013-08-11|document that force-proxy-request-1.0 implies prox|
|55415|New|Maj|2013-08-14|Proxy loop caused by ProxyErrorOverride and ErrorD|
|55431|New|Nor|2013-08-16|mod_negotation does not force the mime type listed|
|55433|New|Nor|2013-08-16|mod_proxy ignores final status code for aborted re|
|55443|Inf|Maj|2013-08-17|never gives 300 multiple choices                  |
|55445|New|Maj|2013-08-18|mod_socache_memcache ignores expiry, creating eter|
|55447|New|Enh|2013-08-18|make type-maps usable again, by making them access|
|55448|New|Nor|2013-08-19|segfault in set_max_workers at event.c:3194 on SIG|
|55449|New|Maj|2013-08-19|AH01185: worker slotmem_create failed --> slotmem |
|55452|New|Maj|2013-08-19|Redirect                                          |
|55458|New|Enh|2013-08-20|allow to configure what mod_ssl responds when one |
|55460|New|Enh|2013-08-21|allow service names to be used in the Listen direc|
|55467|New|Nor|2013-08-21|Support for OpenSSL custom TLS extensions and supp|
|55523|New|Trv|2013-09-04|auth_groupfile error log on access even though suc|
|55535|Inf|Nor|2013-09-08|incorrect check state parametr                    |
|55540|New|Cri|2013-09-09|mod_proxy gzip chunked issue (sample site provided|
|55549|New|Min|2013-09-11|AuthLDAPSubGroupAttribute doesn't do anything     |
|55550|New|Nor|2013-09-11|AuthLDAPSubGroupClass checking is very inefficient|
|55556|New|Nor|2013-09-13|apachebench (ab) doesn't use so_reuseaddr         |
|55557|New|Nor|2013-09-14|Some cppcheck reports                             |
|55573|New|Enh|2013-09-19|FileETag needs MTimeSeconds, MTime with granularit|
|55581|New|Enh|2013-09-22|Support concurrent connections to same FastCGI pro|
|55590|Inf|Maj|2013-09-24|second commit is failing if space is in file name |
|55596|New|Enh|2013-09-25|Add date format used by Expires header            |
|55607|New|Enh|2013-09-28|Re-set HOME environment variable to directory from|
|55615|New|Nor|2013-09-30|Connections are starved and not balanced when conc|
|55619|New|Nor|2013-10-02|Apache httpd reported 500 internal error when uplo|
|55627|New|Min|2013-10-04|Remove unnecessary APLOGNO() for trace logging per|
|55636|Inf|Cri|2013-10-07|long lost child came home - Apache is not respondi|
|55646|Inf|Nor|2013-10-10|non-2xx responses are not considered errors       |
|55654|New|Nor|2013-10-15|Extract variables from configuration without start|
|55670|New|Min|2013-10-18|Startup may fail silently at post_config          |
|55673|New|Nor|2013-10-18|httpd fails to start with SSLProxyMachineCertifica|
|55680|New|Enh|2013-10-20|online manual directory option doesn't exist      |
|55698|New|Maj|2013-10-24|Apache 2.2 + mod_fcgid 2.3.7 (CentOS 6.4) graceful|
|55700|New|Enh|2013-10-24|add something like RewriteOptions InheritDown     |
|55707|New|Nor|2013-10-25|SSLProtocol directive seem to be ignored over diff|
|55708|New|Nor|2013-10-25|Access violation in msvcrt.dll when calling getenv|
|55711|New|Min|2013-10-28|--enable-foo doesn't enable foo                   |
|55712|New|Nor|2013-10-28|Relative <!--#include virtual="../file.shtml"--> g|
|55720|New|Enh|2013-10-29|separate LDAP Bind timeout from LDAPTimeout       |
|55738|New|Nor|2013-11-03|PVS-Studio: few issues                            |
|55763|New|Nor|2013-11-09|raise roots soft RLIMIT_NPROC on linux for high ma|
|55774|New|Nor|2013-11-13|ab: optionally accept tls client certificate      |
|55781|New|Nor|2013-11-15|ajp_read_header: ajp_ilink_receive failed; 120006)|
|55786|New|Maj|2013-11-16|SSLVerifyClient and OptRenegotiate result in a 403|
|55787|New|Maj|2013-11-16|Chroot fails with "Cannot chroot when not started |
|55790|New|Maj|2013-11-17|mod_fcgid lockfile hardcoded to be in /tmp        |
|55793|New|Enh|2013-11-18|DTrace/SystemTap support                          |
|55808|New|Nor|2013-11-21|File integrity verification using MD5 and SHA1    |
|55819|Inf|Nor|2013-11-27|Closing connection behaviour                      |
|55828|New|Cri|2013-11-28|Httpd not start if use ProxyPass balancer://      |
|55834|New|Maj|2013-12-02|Apache does not honor the openssl library path giv|
|55838|New|Nor|2013-12-03|PHP files are being executed instead of downloaded|
|55841|New|Nor|2013-12-04|Misleading news items on bugfix releases ("This ve|
|55856|New|Nor|2013-12-08|YYEMPTY (-2) used as index into yytname (const arr|
|55866|New|Nor|2013-12-11|When ProxyPreserveHost is on, SSL expects the wron|
|55878|New|Nor|2013-12-12|mod_fcgid kills spawned processes too early       |
|55881|New|Nor|2013-12-13|segmentation fault at proxy_util.c:1546           |
|55883|New|Enh|2013-12-14|string callers of ap_expr should be able to transf|
|55887|New|Maj|2013-12-16|In Windows apache, when user access to /con, apach|
|55898|New|Enh|2013-12-17|[RFE] listen on unix socket?                      |
|55914|New|Reg|2013-12-20|child exit segmentation fault after apache gracefu|
|55919|New|Nor|2013-12-22|EPREFIX and dynamic modules                       |
|55942|New|Nor|2014-01-01|400 - Bad Request on POST (Windows Server 2012 Hyp|
|55952|New|Nor|2014-01-05|ab: SSL keep-alive fails with apr_pollset_poll: Th|
|55962|New|Enh|2014-01-06|mod_remoteip should not allow an external proxy to|
|55963|New|Nor|2014-01-07|Add application/ld+json to mime.types             |
|55981|Opn|Nor|2014-01-09|mod_mbox hang on some e-mails on user@openoffice.a|
|55985|Opn|Nor|2014-01-10|apache does not reopen logs when multiple graceful|
|55989|Opn|Enh|2014-01-11|write to error log upon RewriteRule [F]orbidden   |
|55991|New|Nor|2014-01-12|mod_charset_lite doesn't bail out on non-identity |
|56009|Inf|Cri|2014-01-14|Memory leak in httpd 2.4.3 over time with persista|
|56014|New|Nor|2014-01-15|MOd rewrite CO Cookie method the lifetime flag not|
|56028|New|Enh|2014-01-17|Add http/1.0, http/1.1 NPN advertisement to enable|
|56034|New|Nor|2014-01-20|CPU consumption due to circular linked list in ap_|
|56040|New|Enh|2014-01-21|should be able to remove Max-Age cookie parameter |
|56041|New|Enh|2014-01-21|should be able to disable session expiry increment|
|56052|New|Nor|2014-01-22|ap_session_load called multiple times for expired |
|56055|New|Nor|2014-01-23|Route is not extracted properly when a session coo|
|56064|New|Enh|2014-01-25|Optimize PNGs                                     |
|56067|New|Nor|2014-01-27|FallbackResource doesn't work if directory exists |
|56081|New|Maj|2014-01-28|Apache 2.2.26 SIGSEGVs when POST'ing data         |
|56091|Inf|Nor|2014-01-30|SSL handshake error when httpd compiled on Oracle |
|56098|New|Nor|2014-02-01|duplicate cookie                                  |
|56101|New|Cri|2014-02-03|Apache 2.4.6 ceases processing requests (scoreboar|
|56102|New|Nor|2014-02-03|SSL_CLIENT_S_DN_x509_0 is undefined in the environ|
|56109|New|Nor|2014-02-05|Cannot increase the read limit                    |
|56113|New|Nor|2014-02-06|dist commit messages missing from mail-archives di|
|56131|New|Nor|2014-02-12|ProxyPassReverse / zealously replaces Location hea|
|56135|New|Nor|2014-02-13|Add DC to list of x509 components                 |
|56152|New|Nor|2014-02-18|ProxyBlock does not accept network addresses      |
|56176|New|Nor|2014-02-21|mod_substitute truncates the response body if the |
|56188|New|Nor|2014-02-25|mod_proxy_fcgi does not send FCGI_ABORT_REQUEST on|
|56209|New|Nor|2014-03-03|Uninitialised variables in os/win32/ap_regkey.c   |
|56226|Ver|Nor|2014-03-06|per VirtualHost KeepAliveTimeout is not recognized|
|56229|New|Enh|2014-03-06|ocsp ProxyHost and ProxyPort support              |
|56230|New|Nor|2014-03-07|mod_access_compat can log a bogus client denied me|
|56235|New|Nor|2014-03-07|quotes should be optional around expr             |
|56247|New|Cri|2014-03-12|semaphore creation for proxypass                  |
|56250|New|Nor|2014-03-12|sbindir in config.layout for Apache has bin instea|
|56251|New|Nor|2014-03-12|Increase maximum length of FcgidInitialEnv string |
|56252|New|Enh|2014-03-12|make install as privileged user creates files not |
|56262|New|Nor|2014-03-14|ab does not work with extremely long cookies      |
|56264|New|Trv|2014-03-14|Confusing error with .htaccess rewrite to proxy wh|
|56270|New|Enh|2014-03-15|--with-ssl=/foo w/o pkgconfig needs help on AIX 64|
|56288|New|Enh|2014-03-19|rewrite URLs in style attributes                  |
|56289|New|Nor|2014-03-19|Buffer overflow in mod_proxy_html's string replace|
|56308|New|Nor|2014-03-24|1 second delay in handle request kills performance|
|56312|New|Nor|2014-03-25|Can't configure different balancing workers that c|
|56314|New|Nor|2014-03-25|exiting from MPM-worker child caused assert in apr|
|56326|New|Nor|2014-03-27|cache_quick_handler does not serve responses with |
|56331|New|Nor|2014-03-29|windows 'access denied' during revalidaton of reso|
|56333|New|Enh|2014-03-31|API to resume a SUSPENDED connection              |
|56362|New|Maj|2014-04-08|ldaps only works with port 636. Non-standard port |
|56379|New|Nor|2014-04-09|Number of columns in the results returned from pgs|
|56395|New|Enh|2014-04-11|Allow SERVER_ADDR environment variable to be optio|
|56404|New|Nor|2014-04-12|endless loop  when connect to a website(https)  wh|
|56413|New|Blk|2014-04-15|can not restart httpd on centos 5.10 64bit        |
|56422|New|Nor|2014-04-17|authnz_ldap with other forms of authn can fail req|
|56457|New|Nor|2014-04-25|mod_proxy_html.c: 2 * cut'n'paste errors          |
|56473|New|Nor|2014-04-30|ETags don't change when headers do                |
|56475|New|Enh|2014-04-30|Allow TLS record size to be configured            |
|56483|New|Enh|2014-05-02|add disableKeepAlivePercentage similar to tomcat h|
|56493|New|Min|2014-05-06|mod_expires should not set expires in future for s|
|56495|New|Nor|2014-05-06|Application behind mod_proxy does not get SessionH|
|56500|Opn|Enh|2014-05-07|vhosts priority order with wildcard               |
|56504|New|Nor|2014-05-08|cannot build static support binaries              |
|56508|New|Nor|2014-05-09|Requiring SNI - SSLStrictSNIVHostCheck semantics  |
|56517|New|Enh|2014-05-12|Virtualhosts cannot inherit parent CustomLog      |
|56528|New|Enh|2014-05-15|"bad flags delimiter" - improve helpfulness       |
|56541|New|Nor|2014-05-18|Proxy 502's on large file post requests           |
|56559|New|Nor|2014-05-25|multiple unix sockets in one virtualhost fails    |
|56569|New|Nor|2014-05-27|Null CRC in gzip footer with mod_cgid and ErrorDoc|
|56587|New|Nor|2014-06-03|Many VirtualHost's with SSLEngine On              |
|56590|New|Enh|2014-06-04|(REST-) API for configuring balancer manager remot|
|56594|Inf|Nor|2014-06-05|mod_authn_dbd, mod_dbd and mod_ssl                |
|56598|New|Nor|2014-06-06|Content-Length header should be always interpreted|
|56621|New|Nor|2014-06-13|Rotatelogs.exe first start                        |
|56622|New|Nor|2014-06-13|mod_reqtimeout incorrectly applies timeouts to CON|
|56626|New|Nor|2014-06-15|Add info about rotatelogs to log rotation document|
|56633|New|Nor|2014-06-16|mod_auth_basic breaks mod_autoindex               |
|56645|New|Maj|2014-06-19|socket callback with timeout callback causes infin|
|56664|New|Nor|2014-06-24|Proxy retry timeout does not cope with system time|
|56687|New|Nor|2014-07-01|ProxySourceAddress failed to bind socket to local |
|56697|New|Maj|2014-07-04|status page still shown while blocked             |
|56718|New|Nor|2014-07-14|Cleanup request Host headers when absolute URI are|
|56719|New|Nor|2014-07-14|parallel requests get served with delays          |
|56738|New|Enh|2014-07-17|Ability to extract route from cookie with regexp  |
|56740|New|Nor|2014-07-18|suspended_count not maintained properly with wstun|
|56750|New|Enh|2014-07-20|SuexecUserGroup replacement                       |
|56751|New|Maj|2014-07-20|Fails to properly mitigate Slow Post DoS attack   |
|56753|New|Nor|2014-07-21|mod_lua.so: symbol luaL_openlib: referenced symbol|
|56778|New|Nor|2014-07-28|while running make command i got this error       |
|56794|New|Nor|2014-07-31|Added AuthDBDFullAuthQuery option                 |
|56795|Inf|Nor|2014-07-31|Apache 2.4.10 Program received signal SIGPIPE, Bro|
|56818|Inf|Nor|2014-08-05|SetEnvIf may set invalid string length on empty st|
|56843|New|Enh|2014-08-12|Support different OCSP stapling max ages          |
|56868|New|Nor|2014-08-18|relative LuaRoot broken                           |
|56879|New|Nor|2014-08-22|Information disclosure                            |
|56889|New|Nor|2014-08-26|Close state never dies                            |
|56918|Opn|Blk|2014-09-06|error: 'ap_copy_scoreboard_worker' undeclared here|
|56926|New|Nor|2014-09-08|Filename causes AH02599 slotmem issue             |
|56933|New|Min|2014-09-09|not sure it's an appache bug : some browser want t|
|56942|New|Reg|2014-09-10|Unable to implement TRANSFER-CHUNKED:ENCODING with|
|56943|New|Nor|2014-09-10|mod_proxy_connect - AH02447: err/hup on backconn  |
|56977|New|Maj|2014-09-12|segfaults when using mod_mem_cache + mod_disk_cach|
|56986|New|Blk|2014-09-17|chunked Transfer-Encoding forbidden: /test/test.dl|
|57014|New|Cri|2014-09-24|Incorrect test for CC_FOR_BUILD prevents build (on|
|57023|New|Nor|2014-09-26|Socache shmcb don't cache file bigger than 11k    |
|57028|New|Enh|2014-09-27|mod_spdy - support Apache 2.4                     |
|57044|New|Nor|2014-09-29|[PatchAvailable] Use base64url in mod_unique_id ('|
|57045|New|Nor|2014-09-30|dumpio output strings are missing                 |
|57046|New|Enh|2014-09-30|Add additional parameter to enable check URL befor|
|57056|New|Maj|2014-10-03|Rewrite port is taken into hostname               |
|57067|New|Nor|2014-10-08|A proxy worker both standalone and balancer member|
|57069|New|Nor|2014-10-08|apache ssl timeout during chunked request in rever|
|57073|New|Cri|2014-10-09|Intermittent Connection Issues using default httpd|
|57085|New|Enh|2014-10-14|Implement Proxy Protocol in httpd                 |
|57087|New|Nor|2014-10-14|mod_proxy_fcgi doesn't send cgi CONTENT_LENGTH var|
|57100|Ver|Nor|2014-10-16|"SSLProtocol ALL" is ignored for virtual hosts    |
|57101|New|Enh|2014-10-16|[PATCH] Better error reporting when child spawn fa|
|57109|New|Nor|2014-10-17|GPG verification examples are wrong               |
|57119|Opn|Enh|2014-10-20|Suppress address reuse / DNS cache in mod_proxy   |
|57121|New|Nor|2014-10-21|ocsp stapling should not pass temporary server out|
|57131|New|Nor|2014-10-22|OCSP Stapling scalability concern                 |
|57159|New|Min|2014-10-28|mod_ssl OCSP Stapling directives don't support per|
|57160|New|Nor|2014-10-29|httxt2dbm doesn't generate files on NAS           |
|57174|New|Nor|2014-10-31|Update windows visual studio build                |
|57210|New|Nor|2014-11-14|LuaHookMapToStorage not firing in per-directory co|
|57211|New|Enh|2014-11-14|Config-time options                               |
|57212|Opn|Nor|2014-11-14|Headers returned by scripts are limited to 8190 by|
|57218|New|Nor|2014-11-15|[Feature Request] Apache Bench (AB) to output a cs|
|57219|New|Nor|2014-11-15|ApacheBench quits unexpectedly with high concurren|
|57220|New|Nor|2014-11-15|[Feature Request] Add option to ApacheBench to giv|
|57228|New|Nor|2014-11-17|glibc detected *** httpd: double free or corruptio|
|57229|New|Maj|2014-11-17|mod_sed dies on long lines                        |
|57286|New|Nor|2014-11-29|Symbolic links are not honoured                   |
|57298|New|Min|2014-12-02|RewriteBase inside FilesMatch behaves oddly       |
|57299|New|Enh|2014-12-02|mod_session_dbd should not make a database call pe|
|57300|New|Enh|2014-12-02|mod_session_dbd should not save the session at eac|
|57301|New|Enh|2014-12-02|Add SessionMaxAgeAbsolute Directive               |
|57304|Inf|Nor|2014-12-03|MySQL DBD Authentication Incompatible with SSL    |
|57311|New|Nor|2014-12-04|BalancerMember enclosed by <If> gives syntax error|
|57313|New|Nor|2014-12-05|The DefaultType directive has been removed        |
|57327|New|Nor|2014-12-08|mod_ssl seg fault on exit                         |
|57334|Ver|Maj|2014-12-09|Segmentation fault in SSL_renegotiate at ssl_lib.c|
|57337|New|Nor|2014-12-10|Content negotiation fails with conditional Redirec|
|57339|New|Enh|2014-12-10|ErrorLogFormat doesn't allow logging in Internet d|
|57360|New|Nor|2014-12-17|Fail gracefully on certificate/key mismatch       |
|57372|New|Nor|2014-12-19|httpd will lookup every home directory while start|
|57374|Ver|Nor|2014-12-19|Event MPM: Wrong KeepAliveTimeout when system cloc|
|57379|New|Nor|2014-12-20|[patch] Makefile.in  with mpm-shared, cgi and cgid|
|57383|New|Cri|2014-12-21|Error retrieving Report: An Existing connection wa|
|57386|New|Blk|2014-12-22|html5 lost some comments                          |
|57398|New|Maj|2014-12-26|AH01075: Error dispatching request to : (passing b|
|57399|New|Nor|2014-12-28|Many unnecessary CPU wakeups per second           |
|57406|New|Nor|2014-12-31|cgi-bin script is not executing                   |
|57412|New|Maj|2015-01-04|rewrite rules causes duplicate requests           |
|57416|New|Nor|2015-01-06|htcacheclean thinks the cache is smaller than it a|
|57424|Opn|Nor|2015-01-07|mod_rewrite not using ap_context_document_root    |
|57436|New|Enh|2015-01-12|Option to strip extra data after websocket request|
|57439|New|Enh|2015-01-13|Allow to change body timeout per location         |
|57448|New|Nor|2015-01-16|SSI <!--#set --> cannot capture backreferences fro|
|57453|New|Maj|2015-01-17|403 error when virtualhost configured with non-exi|
|57471|New|Nor|2015-01-20|Apache 2.4.10 Compilation fails when compiling aga|
|57477|New|Nor|2015-01-21|mod_auth_digest AH00052: child pid $pid exit signa|
|57483|New|Nor|2015-01-22|Omit "Keep-Alive" header on 1.1 connections       |
|57492|New|Nor|2015-01-24|incomplete chunked-transfered request body is not |
|57506|New|Nor|2015-01-27|<If> directive doesn't work within a <Location> se|
|57510|New|Enh|2015-01-28|Engine keyform support for private keys           |
|57511|New|Maj|2015-01-28|Opening plain TCP Socket on SSL port causes denial|
|57515|New|Nor|2015-01-30|Define/Undefine don't work reasonably outside of g|
|57519|New|Nor|2015-02-01|change SSLv2 to SSLv3 or remove SSLv2 support allt|
|57526|Opn|Maj|2015-02-03|Apache 2.2.29_openssl-1.0.1k_x86_64 Error creating|
|57529|Opn|Nor|2015-02-03|htcacheclean doesn't show the cached URL with '-a'|
|57585|New|Nor|2015-02-13|httpd fails to start if there is an IncludeOptiona|
|57590|New|Nor|2015-02-18|loading mod_proxy_http makes rewriteRule's [proxy]|
|57591|New|Nor|2015-02-18|DirectoryIndex directive cannot be overwritten    |
|57616|New|Maj|2015-02-23|AB - DNS roundrobin support                       |
|57624|New|Enh|2015-02-23|Provide support for http/2.0                      |
|57631|New|Nor|2015-02-24|Useless test in acinclude.m4                      |
|57632|New|Nor|2015-02-24|mod_systemd passes invalid default to APACHE_MODUL|
|57635|New|Nor|2015-02-25|meta-refresh is not rewritten by mod_proxy_html   |
|57636|New|Nor|2015-02-25|URLs without protocol are not rewriten by mod_prox|
|57641|New|Maj|2015-02-27|mod_substitute: Invalid merge order               |
|57646|New|Enh|2015-02-27|SSLEngine inside If directive                     |
|57660|New|Trv|2015-03-04|AB - free memory allocated by xmalloc and xcalloc |
|57680|New|Nor|2015-03-09|SSLSessionCacheTimeout has no effect              |
|57685|New|Nor|2015-03-10|Requests are denied while the mod_cgid daemon star|
|57691|New|Nor|2015-03-12|mod_proxy/proxy_util confuses UDS scheme with HTTP|
|57695|New|Nor|2015-03-12|[core:warn] [pid 1120] (101)Network is unreachable|
|57710|New|Nor|2015-03-15|Wildcard matching for logging headers             |
|57725|New|Enh|2015-03-18|ApacheBench: include http status code in gnuplot o|
|57742|New|Nor|2015-03-23|"reliable piped logging" doesn't work for ErrorLog|
|57745|New|Nor|2015-03-23|httpd exits 1 with no stderr when proxy_balancer_m|
|57746|New|Nor|2015-03-23|Apache hangs on startup using MPM event           |
|57751|Inf|Maj|2015-03-24|Problems with proxy reverse to websockets         |
|57756|New|Enh|2015-03-25|Config options for handling of pipelined request  |
|57757|New|Cri|2015-03-25|extern apr_xlate_t *ap_locale_to_ascii variable gi|
|57771|New|Nor|2015-03-27|cleanup_script uses incorrect connection ID       |
|57774|Inf|Nor|2015-03-28|httpd.conf <IfModule proxy_html_module> content er|
|57777|New|Nor|2015-03-30|Security concerns with documentation of AddHandler|
|57781|New|Nor|2015-03-31|disable reconnection after connection error       |
|57784|New|Enh|2015-03-31|[RFE] Multiple ErrorLog directives                |
|57795|Opn|Maj|2015-04-07|mod_proxy_wstunnel sometimes does not connect and |
|57800|New|Nor|2015-04-09|High CPU usage in ap_core_output_filter           |
|57807|New|Enh|2015-04-13|Build-configurable environment variable length    |
|57810|New|Nor|2015-04-13|Should apache ignore difference in trailing dot be|
|57813|New|Nor|2015-04-14|Rewrite 'pre-compressed content' recipe using 2.4 |
|57814|New|Nor|2015-04-14|Teach mod_deflate how to serve pre-comressed conte|
|57819|New|Nor|2015-04-15|Need a conventions document                       |
|57832|New|Enh|2015-04-19|Reduction of response splitting attacks consequenc|
|57853|Inf|Nor|2015-04-24|mod_proxy_http sends request with header 'Expect: |
|57868|New|Nor|2015-04-28|SIGSEV when lacking correct DB access permissions |
|57876|New|Reg|2015-04-30|logresolve.exe on any Windows immediately crashes |
|57878|New|Nor|2015-04-30|Using UTF-8 for all languages, and avoiding html-e|
|57895|New|Min|2015-05-05|missing m4a mimeType in mime.types                |
|57911|New|Min|2015-05-09|Rewrite documentation unclear or wrong about what |
|57927|New|Maj|2015-05-13|Segmentation Fault at proxy_util.c:994            |
|57933|New|Min|2015-05-18|apr_port_t returns constant                       |
|57941|New|Nor|2015-05-21|config.status: line 331: syntax error near unexpec|
|57949|New|Enh|2015-05-25|new mod_ssl environment variable SSL_{CLIENT|SERVE|
|57950|New|Nor|2015-05-26|[patch] buildconf change hint in build to newer ap|
|57960|New|Nor|2015-05-27|PUT truncates response body; status_line appears t|
|57976|New|Cri|2015-05-30|Server threads stale when sending 500 status with |
|57978|New|Nor|2015-06-01|unix:/ works with any number of / slashes  except |
|57979|New|Nor|2015-06-01|can not turn change log level for mod_filter      |
|57996|New|Nor|2015-06-03|Symlinks erroneously not followed when target inod|
|57997|New|Nor|2015-06-03|Threads started during child_init don't block sign|
|57999|New|Nor|2015-06-04|ap_getparents() may remove start slash of uri     |
|58001|New|Enh|2015-06-04|Implement Forwarded header (RFC 7239) to mod_proxy|
|58007|New|Nor|2015-06-06|400 Bad Request with fully qualified domain name o|
|58025|New|Enh|2015-06-11|mod_authz_dbd : new dbd-query and AuthzDBDQuery op|
|58026|New|Nor|2015-06-11|return 421 status code when SNI and Host: header d|
|58044|New|Cri|2015-06-16|Error sintax 'lua_dump'                           |
|58050|New|Nor|2015-06-17|ErrorDocument does not always work                |
|58073|New|Nor|2015-06-24|Extremely long time for graceful restart          |
|58089|New|Nor|2015-07-01|mod_authz_host uses proxy IP even when mod_remotei|
|58091|New|Nor|2015-07-02|mod_socache_memcache does not reuse memcache conne|
|58097|New|Enh|2015-07-03|[feat] Preserve original connecting IP            |
|58101|New|Nor|2015-07-05|DeflateCompressionLevel inside vhost resets logfor|
|58107|New|Blk|2015-07-06|Httpd crashes on startup every time, dump file att|
|58109|New|Nor|2015-07-06|Apache on windows cannot handle the hash symbol (#|
|58118|Inf|Min|2015-07-09|mod_proxy_fcgi logs 503 when user aborts connectio|
|58120|New|Nor|2015-07-10|ProxyPassInherit does not work as expect          |
|58121|New|Nor|2015-07-10|ProxyHTMLMeta seems to ignore all <meta http-equiv|
|58129|New|Nor|2015-07-12|man pages are not generated correctly             |
|58132|New|Nor|2015-07-12|non-standard, non-traditional man page layout make|
|58135|New|Nor|2015-07-14|mod_cache sends client "if-Modified-Since" to back|
|58141|New|Nor|2015-07-15|Apache Service doesn't start when rotatlogs.exe pa|
|58142|New|Nor|2015-07-15|authz_core ignores loglevel                       |
|58158|New|Nor|2015-07-21|Not honoring HTTP spec with regard to Accept-Encod|
|58168|New|Enh|2015-07-21|Would like full request evaluation support in Rewr|
|58171|New|Nor|2015-07-22|ap_session_save saves the wrong session after a de|
|58177|New|Enh|2015-07-24|Mod Proxy forward trailers in http chunked request|
|58180|New|Enh|2015-07-24|ErrorDocument original URL in subsequent <Location|
|58181|New|Enh|2015-07-25|mod_expire should allow "minus" keyword same like |
|58188|New|Nor|2015-07-28|http2 mod_lua: support build with lua 5.2+        |
|58197|New|Nor|2015-07-31|apr-util-1.5.4 build against openldap - "could not|
|58202|New|Enh|2015-07-31|apxs -q += HTTPD_MAJOR , HTTPD_MMN variables      |
|58225|New|Reg|2015-08-08|intermitant segfault 11 in session_identity_encode|
|58226|New|Nor|2015-08-08|XSS in Error Page                                 |
|58231|New|Nor|2015-08-11|RewriteCond can add "Host" to the Vary-Header     |
|58235|New|Enh|2015-08-12|Ability to allow from domain but with using forwar|
|58243|New|Nor|2015-08-14|rotatelogs goes infinite at startup               |
|58248|New|Nor|2015-08-17|Error 404 in use some characters of utf8 in url   |
|58257|New|Nor|2015-08-18|require ldap-group does not work if account-fullna|
|58278|New|Nor|2015-08-24|apache - mod_security Issue : apache no releasing |
|58280|New|Nor|2015-08-24|Backend connection not closed until timeout if cli|
|58288|New|Blk|2015-08-27|Semaphore amount increase until crash when enablin|
|58292|New|Nor|2015-08-27|FallbackResource breaks chunked encoding sometimes|
|58304|New|Nor|2015-08-30|Unexpected Warnings from Macro Use in 2.4         |
|58305|New|Nor|2015-08-30|mod_cgi documentation not clear about what is pass|
|58306|New|Nor|2015-08-30|documentation needs to make it clear which directi|
|58307|New|Nor|2015-08-31|Segmentation fault in child in "read(__nbytes, __b|
|58317|New|Min|2015-09-02|Error message AH01630 is missing file name on deny|
|58334|New|Min|2015-09-06|WebDAV HTTP access does not include meta tag for c|
|58335|New|Nor|2015-09-07|mod_authnz_ldap mismatch                          |
|58343|New|Nor|2015-09-08|The pdf files come up as a blank page.            |
|58354|New|Maj|2015-09-10|(20014)Internal error (specific information not av|
|58356|New|Blk|2015-09-10|Session jumping due to incorrect route            |
|58364|New|Reg|2015-09-11|Apache Server is restarted time to time (Release 2|
|58417|New|Min|2015-09-16|ApacheBench (ab) won't display Server Software of |
|58419|New|Nor|2015-09-16|ApacheBench (ab) doesn't work with keep-alives aga|
|58423|New|Reg|2015-09-17|Apache >= 2.4.8 PCRE_DUPNAMES causes build failure|
|58454|New|Nor|2015-09-24|Invalid FB (first byte) logging when using SSL/TLS|
|58467|New|Maj|2015-09-29|Environment Variables in ProxyHTMLURLMap produces |
|58475|New|Nor|2015-10-03|Support append/merge with semicolon-separated head|
|58488|New|Nor|2015-10-08|Stoped PHP-FPM pool in multi-pool system with comu|
|58491|New|Maj|2015-10-09|Core dumps appear when the load increases         |
|58492|Inf|Nor|2015-10-09|I think LDAPConnectionPoolTTL is not being honored|
|58498|New|Nor|2015-10-16|Apache 2.4.17: Regression with mod_autoindex (in c|
|58500|New|Nor|2015-10-16|dav_fs not enabled by default                     |
|58503|New|Cri|2015-10-16|segfault in apr_brigade_cleanup() under high load |
+-----+---+---+----------+--------------------------------------------------+
| Total 1546 bugs                                                           |
+---------------------------------------------------------------------------+

From dev-return-84345-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Mon Oct 19 11:49:44 2015
Return-Path: <dev-return-84345-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 3D2571819F
	for <apmail-httpd-dev-archive@www.apache.org>; Mon, 19 Oct 2015 11:49:44 +0000 (UTC)
Received: (qmail 58368 invoked by uid 500); 19 Oct 2015 11:49:40 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 58302 invoked by uid 500); 19 Oct 2015 11:49:40 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 58292 invoked by uid 99); 19 Oct 2015 11:49:40 -0000
Received: from Unknown (HELO spamd4-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 19 Oct 2015 11:49:40 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd4-us-west.apache.org (ASF Mail Server at spamd4-us-west.apache.org) with ESMTP id 13C1CC04B9
	for <dev@httpd.apache.org>; Mon, 19 Oct 2015 11:49:40 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd4-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.011
X-Spam-Level:
X-Spam-Status: No, score=-0.011 tagged_above=-999 required=6.31
	tests=[SPF_PASS=-0.001, T_RP_MATCHES_RCVD=-0.01] autolearn=disabled
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd4-us-west.apache.org [10.40.0.11]) (amavisd-new, port 10024)
	with ESMTP id UrGjVlpfF_an for <dev@httpd.apache.org>;
	Mon, 19 Oct 2015 11:49:39 +0000 (UTC)
Received: from monica.sharp.fm (monica.sharp.fm [80.168.143.5])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTP id 009F6439C4
	for <dev@httpd.apache.org>; Mon, 19 Oct 2015 11:49:38 +0000 (UTC)
Received: from [10.105.35.7] (unknown [5.56.169.80])
	(using TLSv1 with cipher DHE-RSA-AES256-SHA (256/256 bits))
	(Client did not present a certificate)
	(Authenticated sender: minfrin@sharp.fm)
	by monica.sharp.fm (Postfix) with ESMTPSA id E7DD4804A8
	for <dev@httpd.apache.org>; Mon, 19 Oct 2015 12:49:31 +0100 (BST)
From: Graham Leggett <minfrin@sharp.fm>
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: quoted-printable
Subject: XSLT filter for httpd
Message-Id: <F26CAC6B-20F9-48DB-9F63-840067826293@sharp.fm>
Date: Mon, 19 Oct 2015 13:49:31 +0200
To: dev@httpd.apache.org
Mime-Version: 1.0 (Mac OS X Mail 8.2 \(2104\))
X-Mailer: Apple Mail (2.2104)

Hi all,

In the light of the move to simple services that talk XML/JSON and HTML =
and Javascript based clients that become more and more capable, I find =
myself wanting an XSLT filter quite often these days to sit in the =
middle and translate between the two.

As a complement to mod_xmlenc, would it make sense to include an XSLT =
filter in httpd out the box?

Regards,
Graham
=E2=80=94


From dev-return-84346-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Mon Oct 19 13:20:39 2015
Return-Path: <dev-return-84346-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 5A6931848A
	for <apmail-httpd-dev-archive@www.apache.org>; Mon, 19 Oct 2015 13:20:39 +0000 (UTC)
Received: (qmail 72315 invoked by uid 500); 19 Oct 2015 13:20:25 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 72254 invoked by uid 500); 19 Oct 2015 13:20:25 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 72245 invoked by uid 99); 19 Oct 2015 13:20:25 -0000
Received: from Unknown (HELO spamd3-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 19 Oct 2015 13:20:25 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd3-us-west.apache.org (ASF Mail Server at spamd3-us-west.apache.org) with ESMTP id 333D7180A88
	for <dev@httpd.apache.org>; Mon, 19 Oct 2015 13:20:25 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd3-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 1.363
X-Spam-Level: *
X-Spam-Status: No, score=1.363 tagged_above=-999 required=6.31
	tests=[KAM_LAZY_DOMAIN_SECURITY=1, RDNS_DYNAMIC=0.363]
	autolearn=disabled
Received: from mx1-us-west.apache.org ([10.40.0.8])
	by localhost (spamd3-us-west.apache.org [10.40.0.10]) (amavisd-new, port 10024)
	with ESMTP id qqTr3YEjkncy for <dev@httpd.apache.org>;
	Mon, 19 Oct 2015 13:20:24 +0000 (UTC)
Received: from gungnir.webthing.com (209-20-83-52.slicehost.net [209.20.83.52])
	by mx1-us-west.apache.org (ASF Mail Server at mx1-us-west.apache.org) with ESMTP id 6581A2304E
	for <dev@httpd.apache.org>; Mon, 19 Oct 2015 13:20:24 +0000 (UTC)
Received: from [192.168.0.127] (cpc36-newt30-2-0-cust898.19-3.cable.virginm.net [82.32.195.131])
	by gungnir.webthing.com (Postfix) with ESMTPSA id 0A73BE8C51
	for <dev@httpd.apache.org>; Mon, 19 Oct 2015 13:20:17 +0000 (UTC)
Message-ID: <1445260816.3909.61.camel@mimir.webthing.com>
Subject: Re: XSLT filter for httpd
From: Nick Kew <niq@apache.org>
To: dev@httpd.apache.org
Date: Mon, 19 Oct 2015 14:20:16 +0100
In-Reply-To: <F26CAC6B-20F9-48DB-9F63-840067826293@sharp.fm>
References: <F26CAC6B-20F9-48DB-9F63-840067826293@sharp.fm>
Content-Type: text/plain; charset="UTF-8"
X-Mailer: Evolution 3.4.4-3 
Mime-Version: 1.0
Content-Transfer-Encoding: 7bit

On Mon, 2015-10-19 at 13:49 +0200, Graham Leggett wrote:
> Hi all,
> 
> In the light of the move to simple services that talk XML/JSON and HTML and Javascript based clients that become more and more capable, I find myself wanting an XSLT filter quite often these days to sit in the middle and translate between the two.
> 
> As a complement to mod_xmlenc, would it make sense to include an XSLT filter in httpd out the box?

There are several old modules: for example mod_transform.
I expect they still serve for sites without i18n requirements.
One option would be to overhaul that.

Note, mod_transform is GPL.  Originally my decision when I released
its earlier predecessor, before I was part of the dev@httpd team.
I'd be happy to re-license it as Apache, and I don't think
any of my co-developers would object.

-- 
Nick Kew


From dev-return-84347-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Mon Oct 19 13:39:23 2015
Return-Path: <dev-return-84347-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 0901318539
	for <apmail-httpd-dev-archive@www.apache.org>; Mon, 19 Oct 2015 13:39:23 +0000 (UTC)
Received: (qmail 18893 invoked by uid 500); 19 Oct 2015 13:39:18 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 18743 invoked by uid 500); 19 Oct 2015 13:39:18 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 18543 invoked by uid 99); 19 Oct 2015 13:39:18 -0000
Received: from Unknown (HELO spamd1-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 19 Oct 2015 13:39:18 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd1-us-west.apache.org (ASF Mail Server at spamd1-us-west.apache.org) with ESMTP id 2CC84C5768
	for <dev@httpd.apache.org>; Mon, 19 Oct 2015 13:39:18 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd1-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 0.001
X-Spam-Level:
X-Spam-Status: No, score=0.001 tagged_above=-999 required=6.31
	tests=[RP_MATCHES_RCVD=0.001] autolearn=disabled
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd1-us-west.apache.org [10.40.0.7]) (amavisd-new, port 10024)
	with ESMTP id Jr_xowRw1u29 for <dev@httpd.apache.org>;
	Mon, 19 Oct 2015 13:39:13 +0000 (UTC)
Received: from monica.sharp.fm (monica.sharp.fm [80.168.143.5])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTP id 40380206E3
	for <dev@httpd.apache.org>; Mon, 19 Oct 2015 13:39:13 +0000 (UTC)
Received: from [10.105.13.216] (unknown [5.56.169.82])
	(using TLSv1 with cipher DHE-RSA-AES256-SHA (256/256 bits))
	(Client did not present a certificate)
	(Authenticated sender: minfrin@sharp.fm)
	by monica.sharp.fm (Postfix) with ESMTPSA id 099ED8034F
	for <dev@httpd.apache.org>; Mon, 19 Oct 2015 14:39:06 +0100 (BST)
Content-Type: text/plain; charset=utf-8
Mime-Version: 1.0 (Mac OS X Mail 8.2 \(2104\))
Subject: Re: XSLT filter for httpd
From: Graham Leggett <minfrin@sharp.fm>
In-Reply-To: <1445260816.3909.61.camel@mimir.webthing.com>
Date: Mon, 19 Oct 2015 15:39:06 +0200
Content-Transfer-Encoding: quoted-printable
Message-Id: <8FC296F6-273A-4E97-B68A-CCC10B68CD2C@sharp.fm>
References: <F26CAC6B-20F9-48DB-9F63-840067826293@sharp.fm> <1445260816.3909.61.camel@mimir.webthing.com>
To: dev@httpd.apache.org
X-Mailer: Apple Mail (2.2104)

On 19 Oct 2015, at 3:20 PM, Nick Kew <niq@apache.org> wrote:

> There are several old modules: for example mod_transform.
> I expect they still serve for sites without i18n requirements.
> One option would be to overhaul that.
>=20
> Note, mod_transform is GPL.  Originally my decision when I released
> its earlier predecessor, before I was part of the dev@httpd team.
> I'd be happy to re-license it as Apache, and I don't think
> any of my co-developers would object.

I=E2=80=99ve been using mod_transform v0.6.0 for a while, and have =
wanted to develop it further. It would be a great starting point.

Regards,
Graham
=E2=80=94


From dev-return-84348-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Mon Oct 19 13:44:02 2015
Return-Path: <dev-return-84348-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id C45D818553
	for <apmail-httpd-dev-archive@www.apache.org>; Mon, 19 Oct 2015 13:44:02 +0000 (UTC)
Received: (qmail 39204 invoked by uid 500); 19 Oct 2015 13:44:02 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 39129 invoked by uid 500); 19 Oct 2015 13:44:02 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 39115 invoked by uid 99); 19 Oct 2015 13:44:02 -0000
Received: from Unknown (HELO spamd2-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 19 Oct 2015 13:44:02 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd2-us-west.apache.org (ASF Mail Server at spamd2-us-west.apache.org) with ESMTP id E22961A0A73
	for <dev@httpd.apache.org>; Mon, 19 Oct 2015 13:44:01 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd2-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.032
X-Spam-Level:
X-Spam-Status: No, score=-0.032 tagged_above=-999 required=6.31
	tests=[RCVD_IN_MSPIKE_H3=-0.01, RCVD_IN_MSPIKE_WL=-0.01,
	SPF_HELO_PASS=-0.001, SPF_PASS=-0.001, T_RP_MATCHES_RCVD=-0.01]
	autolearn=disabled
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd2-us-west.apache.org [10.40.0.9]) (amavisd-new, port 10024)
	with ESMTP id yT_hvwtO2HFj for <dev@httpd.apache.org>;
	Mon, 19 Oct 2015 13:44:00 +0000 (UTC)
Received: from mx1.redhat.com (mx1.redhat.com [209.132.183.28])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id 8F2E220C70
	for <dev@httpd.apache.org>; Mon, 19 Oct 2015 13:44:00 +0000 (UTC)
Received: from int-mx09.intmail.prod.int.phx2.redhat.com (int-mx09.intmail.prod.int.phx2.redhat.com [10.5.11.22])
	by mx1.redhat.com (Postfix) with ESMTPS id 419D792460
	for <dev@httpd.apache.org>; Mon, 19 Oct 2015 13:43:59 +0000 (UTC)
Received: from ditustat.brq.redhat.com (ditustat.brq.redhat.com [10.34.131.181])
	by int-mx09.intmail.prod.int.phx2.redhat.com (8.14.4/8.14.4) with ESMTP id t9JDhvCS009168
	(version=TLSv1/SSLv3 cipher=AES256-SHA bits=256 verify=NO)
	for <dev@httpd.apache.org>; Mon, 19 Oct 2015 09:43:58 -0400
Received: from adelton by ditustat.brq.redhat.com with local (Exim 4.85)
	(envelope-from <jpazdziora@redhat.com>)
	id 1ZoAjF-000772-65
	for dev@httpd.apache.org; Mon, 19 Oct 2015 15:43:57 +0200
Date: Mon, 19 Oct 2015 15:43:57 +0200
From: Jan Pazdziora <jpazdziora@redhat.com>
To: dev@httpd.apache.org
Subject: Re: XSLT filter for httpd
Message-ID: <20151019134357.GA6104@redhat.com>
References: <F26CAC6B-20F9-48DB-9F63-840067826293@sharp.fm>
 <1445260816.3909.61.camel@mimir.webthing.com>
 <8FC296F6-273A-4E97-B68A-CCC10B68CD2C@sharp.fm>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Disposition: inline
Content-Transfer-Encoding: 8bit
In-Reply-To: <8FC296F6-273A-4E97-B68A-CCC10B68CD2C@sharp.fm>
Organization: Red Hat Czech s.r.o., =?iso-8859-2?Q?Purky?=
 =?iso-8859-2?Q?=F2ova_99=2F71=2C_612_45_Brno=2C_Czech_Republic=3B_registe?=
 =?iso-8859-2?Q?red?= in Brno under identification number CZ27690016
User-Agent: Mutt/1.5.24 (2015-08-30)
X-Scanned-By: MIMEDefang 2.68 on 10.5.11.22

On Mon, Oct 19, 2015 at 03:39:06PM +0200, Graham Leggett wrote:
> On 19 Oct 2015, at 3:20 PM, Nick Kew <niq@apache.org> wrote:
> 
> > There are several old modules: for example mod_transform.
> > I expect they still serve for sites without i18n requirements.
> > One option would be to overhaul that.
> > 
> > Note, mod_transform is GPL.  Originally my decision when I released
> > its earlier predecessor, before I was part of the dev@httpd team.
> > I'd be happy to re-license it as Apache, and I don't think
> > any of my co-developers would object.
> 
> I’ve been using mod_transform v0.6.0 for a while, and have wanted to develop it further. It would be a great starting point.
> 

I've been using xslt_filter and I'd be happy to switch to and help
with any module which the community would prefer.

-- 
Jan Pazdziora
Senior Principal Software Engineer, Identity Management Engineering, Red Hat

From dev-return-84349-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Mon Oct 19 14:55:11 2015
Return-Path: <dev-return-84349-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 8A64A188B6
	for <apmail-httpd-dev-archive@www.apache.org>; Mon, 19 Oct 2015 14:55:11 +0000 (UTC)
Received: (qmail 57245 invoked by uid 500); 19 Oct 2015 14:55:10 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 57184 invoked by uid 500); 19 Oct 2015 14:55:10 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 57173 invoked by uid 99); 19 Oct 2015 14:55:10 -0000
Received: from Unknown (HELO spamd3-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 19 Oct 2015 14:55:10 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd3-us-west.apache.org (ASF Mail Server at spamd3-us-west.apache.org) with ESMTP id 211EB180DD9
	for <dev@httpd.apache.org>; Mon, 19 Oct 2015 14:55:10 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd3-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 1.365
X-Spam-Level: *
X-Spam-Status: No, score=1.365 tagged_above=-999 required=6.31
	tests=[FSL_HELO_NON_FQDN_1=0.001, KAM_LAZY_DOMAIN_SECURITY=1,
	RDNS_DYNAMIC=0.363, URIBL_BLOCKED=0.001] autolearn=disabled
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd3-us-west.apache.org [10.40.0.10]) (amavisd-new, port 10024)
	with ESMTP id hOQgqbXl-RYQ for <dev@httpd.apache.org>;
	Mon, 19 Oct 2015 14:55:04 +0000 (UTC)
Received: from baldur (cpc36-newt30-2-0-cust898.19-3.cable.virginm.net [82.32.195.131])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTP id 35B2C20925
	for <dev@httpd.apache.org>; Mon, 19 Oct 2015 14:55:04 +0000 (UTC)
Received: from baldur (localhost [127.0.0.1])
	by baldur (Postfix) with ESMTP id E2007C1B9BC7;
	Mon, 19 Oct 2015 15:54:57 +0100 (BST)
Date: Mon, 19 Oct 2015 15:54:55 +0100
From: Nick Kew <niq@apache.org>
To: dev@httpd.apache.org
Cc: pquerna@apache.org
Subject: Re: XSLT filter for httpd
Message-ID: <20151019155455.655162f0@baldur>
In-Reply-To: <8FC296F6-273A-4E97-B68A-CCC10B68CD2C@sharp.fm>
References: <F26CAC6B-20F9-48DB-9F63-840067826293@sharp.fm>
	<1445260816.3909.61.camel@mimir.webthing.com>
	<8FC296F6-273A-4E97-B68A-CCC10B68CD2C@sharp.fm>
X-Mailer: Claws Mail 3.7.4 (GTK+ 2.20.1; i486-pc-linux-gnu)
Mime-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: quoted-printable

On Mon, 19 Oct 2015 15:39:06 +0200
Graham Leggett <minfrin@sharp.fm> wrote:

> > Note, mod_transform is GPL.  Originally my decision when I released
> > its earlier predecessor, before I was part of the dev@httpd team.
> > I'd be happy to re-license it as Apache, and I don't think
> > any of my co-developers would object.
>=20
> I=E2=80=99ve been using mod_transform v0.6.0 for a while, and have wanted=
 to develop it further. It would be a great starting point.

I have a distant recollection of consulting Paul and Edward about
re-licensing, then dropping the ball on it.  IIRC the outcome was,
they were both happy to re-license, but there had also been one
or two third-party patches raising a questionmark over whether we
should consult anyone else.

Cc: Paul.  Do you recollect that?  You still in contact with Edward?

--=20
Nick Kew

From dev-return-84350-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Mon Oct 19 15:14:39 2015
Return-Path: <dev-return-84350-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id B3F5F1898F
	for <apmail-httpd-dev-archive@www.apache.org>; Mon, 19 Oct 2015 15:14:39 +0000 (UTC)
Received: (qmail 1667 invoked by uid 500); 19 Oct 2015 15:14:23 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 1602 invoked by uid 500); 19 Oct 2015 15:14:23 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 1592 invoked by uid 99); 19 Oct 2015 15:14:23 -0000
Received: from Unknown (HELO spamd4-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 19 Oct 2015 15:14:23 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd4-us-west.apache.org (ASF Mail Server at spamd4-us-west.apache.org) with ESMTP id CB79BC092D
	for <dev@httpd.apache.org>; Mon, 19 Oct 2015 15:14:22 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd4-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 2.97
X-Spam-Level: **
X-Spam-Status: No, score=2.97 tagged_above=-999 required=6.31
	tests=[HTML_MESSAGE=3, RCVD_IN_MSPIKE_H3=-0.01,
	RCVD_IN_MSPIKE_WL=-0.01, T_RP_MATCHES_RCVD=-0.01] autolearn=disabled
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd4-us-west.apache.org [10.40.0.11]) (amavisd-new, port 10024)
	with ESMTP id e-Yt1b_IiRMl for <dev@httpd.apache.org>;
	Mon, 19 Oct 2015 15:14:13 +0000 (UTC)
Received: from smtp.checkpoint.com (smtp.checkpoint.com [194.29.34.68])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id E65D320751
	for <dev@httpd.apache.org>; Mon, 19 Oct 2015 15:14:12 +0000 (UTC)
x-m-msg: CPCHECK
Received: from IL-EX10.ad.checkpoint.com ([194.29.34.147])
	by smtp.checkpoint.com (8.13.8/8.13.8) with ESMTP id t9JFEB30006406
	for <dev@httpd.apache.org>; Mon, 19 Oct 2015 18:14:11 +0300
Received: from dlpgw.checkpoint.com (194.29.34.27) by
 IL-EX10.ad.checkpoint.com (194.29.34.147) with Microsoft SMTP Server id
 14.3.248.2; Mon, 19 Oct 2015 18:14:11 +0300
Received: by dlpgw.checkpoint.com (Postfix, from userid 0)	id 6A2E3C60806;
 Mon, 19 Oct 2015 18:14:11 +0300 (IDT)
X-CPDLP: {2DFC3502-D2D7-F0DA-F65B-D5669EB1AD73}.1445267613
Received: from IL-EX10.ad.checkpoint.com ([169.254.2.36]) by
 DAG-EX10.ad.checkpoint.com ([169.254.3.11]) with mapi id 14.03.0248.002; Mon,
 19 Oct 2015 18:13:33 +0300
From: Yehezkel Horowitz <horowity@checkpoint.com>
To: "dev@httpd.apache.org" <dev@httpd.apache.org>
Subject: Improve Apache performance on high load (prefork MPM) with multiple
 Accept mutexes (Patch attached)
Thread-Topic: Improve Apache performance on high load (prefork MPM) with
 multiple Accept mutexes (Patch attached)
Thread-Index: AdEKfWuZhdmjohBKS/yAuQ98J4a/oQ==
Date: Mon, 19 Oct 2015 15:13:32 +0000
Message-ID: <6A49427F0EB5B44F9F1006B09A0A28F4F8B09BFD@IL-EX10.ad.checkpoint.com>
Accept-Language: en-US
Content-Language: en-US
X-MS-Has-Attach: yes
X-MS-TNEF-Correlator: 
x-originating-ip: [194.29.34.193]
x-kse-antivirus-interceptor-info: scan successful
x-kse-antivirus-info: Clean
x-cpdlp: 11adb54a542f69fe497b09812598f610c881572657
Content-Type: multipart/mixed;
	boundary="_004_6A49427F0EB5B44F9F1006B09A0A28F4F8B09BFDILEX10adcheckpo_"
MIME-Version: 1.0
X-KSE-AntiSpam-Interceptor-Info: protection disabled
X-KSE-Antivirus-Interceptor-Info: scan successful
X-KSE-Antivirus-Info: Clean

--_004_6A49427F0EB5B44F9F1006B09A0A28F4F8B09BFDILEX10adcheckpo_
Content-Type: multipart/alternative;
	boundary="_000_6A49427F0EB5B44F9F1006B09A0A28F4F8B09BFDILEX10adcheckpo_"

--_000_6A49427F0EB5B44F9F1006B09A0A28F4F8B09BFDILEX10adcheckpo_
Content-Type: text/plain; charset="us-ascii"
Content-Transfer-Encoding: quoted-printable

Hello Apache gurus.

I was working on a project which used Apache 2.2.x with prefork MPM (using =
flock as mutex method) on Linux machine (with 20 cores), and run into the f=
ollowing problem.

During load, when number of Apache child processes get beyond some point (~=
3000 processes) - Apache didn't accept the incoming connections in reasonab=
le time (seen in netstat as SYN_RECV).

I found a document about Apache Performance Tuning [1], in which there is a=
n idea to improve the performance by:
"Another solution that has been considered but never implemented is to part=
ially serialize the loop -- that is, let in a certain number of processes. =
This would only be of interest on multiprocessor boxes where it's possible =
that multiple children could run simultaneously, and the serialization actu=
ally doesn't take advantage of the full bandwidth. This is a possible area =
of future investigation, but priority remains low because highly parallel w=
eb servers are not the norm."

I wrote a small patch (aligned to 2.2.31) that implements this idea - creat=
e 4 mutexes and spread the child processes across the mutexes (by getpid() =
% mutex_number).

So in any given time - 4 ideal child processes are expected [2] to wait in =
the "select loop".
Once a new connection arrive - 4 processes are awake by the OS: 1 will succ=
eed to accept the socket (and will release his mutex) and 3 will return to =
the "select loop".

This solved my specific problem and allowed me to get more load on the mach=
ine.

My questions to this forum are:


1.       Do you think this is a good implementation of the suggested idea?



2.       Any pitfalls I missed?


3.       Would you consider accepting this patch to the project?
If so, could you guide me what else needs to be done for acceptances?
I know there is a need for configuration & documentation work - I'll work o=
n once the patch will be approved...


4.       Do you think '4' is a good default for the mutexes number? What sh=
ould be the considerations to set the default?



5.       Does such implementation relevant for other MPMs (worker/event)?

Any other feedback is welcome.

[1] http://httpd.apache.org/docs/2.2/misc/perf-tuning.html, accept Serializ=
ation - Multiple Sockets section.
[2] There is no guarantee that exactly 4 processes will wait as all process=
es of "getpid() % mutex_number =3D=3D 0" might be busy in a given time. But=
 this sounds to me like a fair limitation.

Note: flock give me the best results, still it seems to be with n^2 complex=
ity (where 'n' is the number of waiting processes), so reducing the number =
of processes waiting on each mutex give exponential improvement.

Regards,

Yehezkel Horowitz
Check Point Software Technologies Ltd.

--_000_6A49427F0EB5B44F9F1006B09A0A28F4F8B09BFDILEX10adcheckpo_
Content-Type: text/html; charset="us-ascii"
Content-Transfer-Encoding: quoted-printable

<html xmlns:v=3D"urn:schemas-microsoft-com:vml" xmlns:o=3D"urn:schemas-micr=
osoft-com:office:office" xmlns:w=3D"urn:schemas-microsoft-com:office:word" =
xmlns:m=3D"http://schemas.microsoft.com/office/2004/12/omml" xmlns=3D"http:=
//www.w3.org/TR/REC-html40">
<head>
<meta http-equiv=3D"Content-Type" content=3D"text/html; charset=3Dus-ascii"=
>
<meta name=3D"Generator" content=3D"Microsoft Word 14 (filtered medium)">
<style><!--
/* Font Definitions */
@font-face
	{font-family:Calibri;
	panose-1:2 15 5 2 2 2 4 3 2 4;}
/* Style Definitions */
p.MsoNormal, li.MsoNormal, div.MsoNormal
	{margin:0in;
	margin-bottom:.0001pt;
	font-size:11.0pt;
	font-family:"Calibri","sans-serif";}
a:link, span.MsoHyperlink
	{mso-style-priority:99;
	color:blue;
	text-decoration:underline;}
a:visited, span.MsoHyperlinkFollowed
	{mso-style-priority:99;
	color:purple;
	text-decoration:underline;}
p.MsoListParagraph, li.MsoListParagraph, div.MsoListParagraph
	{mso-style-priority:34;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:.5in;
	margin-bottom:.0001pt;
	font-size:11.0pt;
	font-family:"Calibri","sans-serif";}
span.EmailStyle17
	{mso-style-type:personal-compose;
	font-family:"Calibri","sans-serif";
	color:windowtext;}
..MsoChpDefault
	{mso-style-type:export-only;}
@page WordSection1
	{size:8.5in 11.0in;
	margin:1.0in 1.0in 1.0in 1.0in;}
div.WordSection1
	{page:WordSection1;}
/* List Definitions */
@list l0
	{mso-list-id:1169976873;
	mso-list-type:hybrid;
	mso-list-template-ids:1360162746 67698703 67698713 67698715 67698703 67698=
713 67698715 67698703 67698713 67698715;}
@list l0:level1
	{mso-level-tab-stop:none;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l0:level2
	{mso-level-number-format:alpha-lower;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l0:level3
	{mso-level-number-format:roman-lower;
	mso-level-tab-stop:none;
	mso-level-number-position:right;
	text-indent:-9.0pt;}
@list l0:level4
	{mso-level-tab-stop:none;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l0:level5
	{mso-level-number-format:alpha-lower;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l0:level6
	{mso-level-number-format:roman-lower;
	mso-level-tab-stop:none;
	mso-level-number-position:right;
	text-indent:-9.0pt;}
@list l0:level7
	{mso-level-tab-stop:none;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l0:level8
	{mso-level-number-format:alpha-lower;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l0:level9
	{mso-level-number-format:roman-lower;
	mso-level-tab-stop:none;
	mso-level-number-position:right;
	text-indent:-9.0pt;}
ol
	{margin-bottom:0in;}
ul
	{margin-bottom:0in;}
--></style><!--[if gte mso 9]><xml>
<o:shapedefaults v:ext=3D"edit" spidmax=3D"1026" />
</xml><![endif]--><!--[if gte mso 9]><xml>
<o:shapelayout v:ext=3D"edit">
<o:idmap v:ext=3D"edit" data=3D"1" />
</o:shapelayout></xml><![endif]-->
</head>
<body lang=3D"EN-US" link=3D"blue" vlink=3D"purple">
<div class=3D"WordSection1">
<p class=3D"MsoNormal">Hello Apache gurus.<o:p></o:p></p>
<p class=3D"MsoNormal"><o:p>&nbsp;</o:p></p>
<p class=3D"MsoNormal">I was working on a project which used Apache 2.2.x w=
ith prefork MPM (using flock as mutex method) on Linux machine (with 20 cor=
es), and run into the following problem.<o:p></o:p></p>
<p class=3D"MsoNormal"><o:p>&nbsp;</o:p></p>
<p class=3D"MsoNormal">During load, when number of Apache child processes g=
et beyond some point (~3000 processes) - Apache didn&#8217;t accept the inc=
oming connections in reasonable time (seen in netstat as SYN_RECV).<o:p></o=
:p></p>
<p class=3D"MsoNormal"><o:p>&nbsp;</o:p></p>
<p class=3D"MsoNormal">I found a document about Apache Performance Tuning [=
1], in which there is an idea to improve the performance by:<o:p></o:p></p>
<p class=3D"MsoNormal">&#8220;Another solution that has been considered but=
 never implemented is to partially serialize the loop -- that is, let in a =
certain number of processes. This would only be of interest on multiprocess=
or boxes where it's possible that multiple
 children could run simultaneously, and the serialization actually doesn't =
take advantage of the full bandwidth. This is a possible area of future inv=
estigation, but priority remains low because highly parallel web servers ar=
e not the norm.&#8221;<o:p></o:p></p>
<p class=3D"MsoNormal"><o:p>&nbsp;</o:p></p>
<p class=3D"MsoNormal">I wrote a small patch (aligned to 2.2.31) that imple=
ments this idea &#8211; create 4 mutexes and spread the child processes acr=
oss the mutexes (by getpid() % mutex_number).
<o:p></o:p></p>
<p class=3D"MsoNormal"><o:p>&nbsp;</o:p></p>
<p class=3D"MsoNormal">So in any given time - 4 ideal child processes are e=
xpected [2] to wait in the &#8220;select loop&#8221;.
<o:p></o:p></p>
<p class=3D"MsoNormal">Once a new connection arrive - 4 processes are awake=
 by the OS: 1 will succeed to accept the socket (and will release his mutex=
) and 3 will return to the &#8220;select loop&#8221;.<o:p></o:p></p>
<p class=3D"MsoNormal"><o:p>&nbsp;</o:p></p>
<p class=3D"MsoNormal">This solved my specific problem and allowed me to ge=
t more load on the machine.<o:p></o:p></p>
<p class=3D"MsoNormal"><o:p>&nbsp;</o:p></p>
<p class=3D"MsoNormal">My questions to this forum are:<o:p></o:p></p>
<p class=3D"MsoNormal"><o:p>&nbsp;</o:p></p>
<p class=3D"MsoListParagraph" style=3D"text-indent:-.25in;mso-list:l0 level=
1 lfo1"><![if !supportLists]><span style=3D"mso-list:Ignore">1.<span style=
=3D"font:7.0pt &quot;Times New Roman&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&=
nbsp;
</span></span><![endif]><span dir=3D"LTR"></span>Do you think this is a goo=
d implementation of the suggested idea?
<o:p></o:p></p>
<p class=3D"MsoListParagraph"><o:p>&nbsp;</o:p></p>
<p class=3D"MsoListParagraph" style=3D"text-indent:-.25in;mso-list:l0 level=
1 lfo1"><![if !supportLists]><span style=3D"mso-list:Ignore">2.<span style=
=3D"font:7.0pt &quot;Times New Roman&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&=
nbsp;
</span></span><![endif]><span dir=3D"LTR"></span>Any pitfalls I missed?<o:p=
></o:p></p>
<p class=3D"MsoNormal"><o:p>&nbsp;</o:p></p>
<p class=3D"MsoListParagraph" style=3D"text-indent:-.25in;mso-list:l0 level=
1 lfo1"><![if !supportLists]><span style=3D"mso-list:Ignore">3.<span style=
=3D"font:7.0pt &quot;Times New Roman&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&=
nbsp;
</span></span><![endif]><span dir=3D"LTR"></span>Would you consider accepti=
ng this patch to the project?
<br>
If so, could you guide me what else needs to be done for acceptances?<br>
I know there is a need for configuration &amp; documentation work - I&#8217=
;ll work on once the patch will be approved&#8230;<o:p></o:p></p>
<p class=3D"MsoNormal"><o:p>&nbsp;</o:p></p>
<p class=3D"MsoListParagraph" style=3D"text-indent:-.25in;mso-list:l0 level=
1 lfo1"><![if !supportLists]><span style=3D"mso-list:Ignore">4.<span style=
=3D"font:7.0pt &quot;Times New Roman&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&=
nbsp;
</span></span><![endif]><span dir=3D"LTR"></span>Do you think &#8216;4&#821=
7; is a good default for the mutexes number? What should be the considerati=
ons to set the default?<o:p></o:p></p>
<p class=3D"MsoListParagraph"><o:p>&nbsp;</o:p></p>
<p class=3D"MsoListParagraph" style=3D"text-indent:-.25in;mso-list:l0 level=
1 lfo1"><![if !supportLists]><span style=3D"mso-list:Ignore">5.<span style=
=3D"font:7.0pt &quot;Times New Roman&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&=
nbsp;
</span></span><![endif]><span dir=3D"LTR"></span>Does such implementation r=
elevant for other MPMs (worker/event)?<o:p></o:p></p>
<p class=3D"MsoNormal"><o:p>&nbsp;</o:p></p>
<p class=3D"MsoNormal">Any other feedback is welcome.<o:p></o:p></p>
<p class=3D"MsoNormal"><o:p>&nbsp;</o:p></p>
<p class=3D"MsoNormal">[1] <a href=3D"http://httpd.apache.org/docs/2.2/misc=
/perf-tuning.html">
http://httpd.apache.org/docs/2.2/misc/perf-tuning.html</a>, accept Serializ=
ation - Multiple Sockets section.
<o:p></o:p></p>
<p class=3D"MsoNormal">[2] There is no guarantee that exactly 4 processes w=
ill wait as all processes of &#8220;getpid() % mutex_number =3D=3D 0&#8221;=
 might be busy in a given time. But this sounds to me like a fair limitatio=
n.<o:p></o:p></p>
<p class=3D"MsoNormal"><o:p>&nbsp;</o:p></p>
<p class=3D"MsoNormal">Note: flock give me the best results, still it seems=
 to be with n^2 complexity (where &#8216;n&#8217; is the number of waiting =
processes), so reducing the number of processes waiting on each mutex give =
exponential improvement.<o:p></o:p></p>
<p class=3D"MsoNormal"><o:p>&nbsp;</o:p></p>
<p class=3D"MsoNormal">Regards,<o:p></o:p></p>
<p class=3D"MsoNormal"><o:p>&nbsp;</o:p></p>
<p class=3D"MsoNormal"><span style=3D"font-size:12.0pt;color:navy">Yehezkel=
 Horowitz<o:p></o:p></span></p>
<p class=3D"MsoNormal"><span style=3D"font-size:10.0pt;color:navy">Check Po=
int Software Technologies Ltd.</span><o:p></o:p></p>
</div>
</body>
</html>

--_000_6A49427F0EB5B44F9F1006B09A0A28F4F8B09BFDILEX10adcheckpo_--

--_004_6A49427F0EB5B44F9F1006B09A0A28F4F8B09BFDILEX10adcheckpo_
Content-Type: application/octet-stream; name="multi-accept-mutexes.patch"
Content-Description: multi-accept-mutexes.patch
Content-Disposition: attachment; filename="multi-accept-mutexes.patch";
	size=5180; creation-date="Mon, 19 Oct 2015 15:10:49 GMT";
	modification-date="Wed, 14 Oct 2015 12:54:47 GMT"
Content-Transfer-Encoding: base64

ZGlmZiAtLWdpdCBhL3NlcnZlci9tcG0vcHJlZm9yay9wcmVmb3JrLmMgYi9zZXJ2ZXIvbXBtL3By
ZWZvcmsvcHJlZm9yay5jCmluZGV4IDlmODAwMDYuLjVkNGRlYjUgMTAwNjQ0Ci0tLSBhL3NlcnZl
ci9tcG0vcHJlZm9yay9wcmVmb3JrLmMKKysrIGIvc2VydmVyL21wbS9wcmVmb3JrL3ByZWZvcmsu
YwpAQCAtOTAsOCArOTAsMTIgQEAKIAogLyogY29uZmlnIGdsb2JhbHMgKi8KIAorI2RlZmluZSBU
T1RBTF9BQ0NFUFRfTVVURVhfTlVNQkVSIDQKKwogaW50IGFwX3RocmVhZHNfcGVyX2NoaWxkPTA7
ICAgICAgICAgLyogV29ya2VyIHRocmVhZHMgcGVyIGNoaWxkICovCi1zdGF0aWMgYXByX3Byb2Nf
bXV0ZXhfdCAqYWNjZXB0X211dGV4Oworc3RhdGljIGFwcl9wcm9jX211dGV4X3QqIGFjY2VwdF9t
dXRleF9hcnJheVtUT1RBTF9BQ0NFUFRfTVVURVhfTlVNQkVSXTsKK3N0YXRpYyBpbnQgbXlfbXV0
ZXhfYnlfcGlkID0gMDsKK3N0YXRpYyBjb25zdCBjaGFyICpteV9hcF9sb2NrX2ZuYW1lID0gTlVM
TDsgIAogc3RhdGljIGludCBhcF9kYWVtb25zX3RvX3N0YXJ0PTA7CiBzdGF0aWMgaW50IGFwX2Rh
ZW1vbnNfbWluX2ZyZWU9MDsKIHN0YXRpYyBpbnQgYXBfZGFlbW9uc19tYXhfZnJlZT0wOwpAQCAt
MjAyLDcgKzIwNiw3IEBAIHN0YXRpYyB2b2lkIGNsZWFuX2NoaWxkX2V4aXQoaW50IGNvZGUpCiAK
IHN0YXRpYyB2b2lkIGFjY2VwdF9tdXRleF9vbih2b2lkKQogewotICAgIGFwcl9zdGF0dXNfdCBy
diA9IGFwcl9wcm9jX211dGV4X2xvY2soYWNjZXB0X211dGV4KTsKKyAgICBhcHJfc3RhdHVzX3Qg
cnYgPSBhcHJfcHJvY19tdXRleF9sb2NrKGFjY2VwdF9tdXRleF9hcnJheVtteV9tdXRleF9ieV9w
aWRdKTsKICAgICBpZiAocnYgIT0gQVBSX1NVQ0NFU1MpIHsKICAgICAgICAgY29uc3QgY2hhciAq
bXNnID0gImNvdWxkbid0IGdyYWIgdGhlIGFjY2VwdCBtdXRleCI7CiAKQEAgLTIyMCw3ICsyMjQs
NyBAQCBzdGF0aWMgdm9pZCBhY2NlcHRfbXV0ZXhfb24odm9pZCkKIAogc3RhdGljIHZvaWQgYWNj
ZXB0X211dGV4X29mZih2b2lkKQogewotICAgIGFwcl9zdGF0dXNfdCBydiA9IGFwcl9wcm9jX211
dGV4X3VubG9jayhhY2NlcHRfbXV0ZXgpOworICAgIGFwcl9zdGF0dXNfdCBydiA9IGFwcl9wcm9j
X211dGV4X3VubG9jayhhY2NlcHRfbXV0ZXhfYXJyYXlbbXlfbXV0ZXhfYnlfcGlkXSk7CiAgICAg
aWYgKHJ2ICE9IEFQUl9TVUNDRVNTKSB7CiAgICAgICAgIGNvbnN0IGNoYXIgKm1zZyA9ICJjb3Vs
ZG4ndCByZWxlYXNlIHRoZSBhY2NlcHQgbXV0ZXgiOwogCkBAIC01MDMsMTEgKzUwNywxNiBAQCBz
dGF0aWMgdm9pZCBjaGlsZF9tYWluKGludCBjaGlsZF9udW1fYXJnKQogCiAgICAgLyogbmVlZHMg
dG8gYmUgZG9uZSBiZWZvcmUgd2Ugc3dpdGNoIFVJRHMgc28gd2UgaGF2ZSBwZXJtaXNzaW9ucyAq
LwogICAgIGFwX3Jlb3Blbl9zY29yZWJvYXJkKHBjaGlsZCwgTlVMTCwgMCk7Ci0gICAgc3RhdHVz
ID0gYXByX3Byb2NfbXV0ZXhfY2hpbGRfaW5pdCgmYWNjZXB0X211dGV4LCBhcF9sb2NrX2ZuYW1l
LCBwY2hpbGQpOworCisgICAgbXlfbXV0ZXhfYnlfcGlkID0gYXBfbXlfcGlkICUgVE9UQUxfQUND
RVBUX01VVEVYX05VTUJFUjsKKyAgICAKKyAgICBteV9hcF9sb2NrX2ZuYW1lID0gYXByX3BzcHJp
bnRmKHBjaGlsZCwgIiVzXyVkIiwgYXBfbG9ja19mbmFtZSwgbXlfbXV0ZXhfYnlfcGlkKTsKKwkK
KyAgICBzdGF0dXMgPSBhcHJfcHJvY19tdXRleF9jaGlsZF9pbml0KCZhY2NlcHRfbXV0ZXhfYXJy
YXlbbXlfbXV0ZXhfYnlfcGlkXSwgbXlfYXBfbG9ja19mbmFtZSwgcGNoaWxkKTsKICAgICBpZiAo
c3RhdHVzICE9IEFQUl9TVUNDRVNTKSB7CiAgICAgICAgIGFwX2xvZ19lcnJvcihBUExPR19NQVJL
LCBBUExPR19FTUVSRywgc3RhdHVzLCBhcF9zZXJ2ZXJfY29uZiwKICAgICAgICAgICAgICAgICAg
ICAgICJDb3VsZG4ndCBpbml0aWFsaXplIGNyb3NzLXByb2Nlc3MgbG9jayBpbiBjaGlsZCAiCi0g
ICAgICAgICAgICAgICAgICAgICAiKCVzKSAoJWQpIiwgYXBfbG9ja19mbmFtZSwgYXBfYWNjZXB0
X2xvY2tfbWVjaCk7CisgICAgICAgICAgICAgICAgICAgICAiKCVzKSAoJWQpIiwgbXlfYXBfbG9j
a19mbmFtZSwgYXBfYWNjZXB0X2xvY2tfbWVjaCk7CiAgICAgICAgIGNsZWFuX2NoaWxkX2V4aXQo
QVBFWElUX0NISUxERkFUQUwpOwogICAgIH0KIApAQCAtOTI4LDYgKzkzNyw4IEBAIGludCBhcF9t
cG1fcnVuKGFwcl9wb29sX3QgKl9wY29uZiwgYXByX3Bvb2xfdCAqcGxvZywgc2VydmVyX3JlYyAq
cykKICAgICBpbnQgaW5kZXg7CiAgICAgaW50IHJlbWFpbmluZ19jaGlsZHJlbl90b19zdGFydDsK
ICAgICBhcHJfc3RhdHVzX3QgcnY7CisgICAgaW50IGk7CisgICAgY2hhciAqIHRtcF9sb2NrX2Zu
YW1lOwogCiAgICAgYXBfbG9nX3BpZChwY29uZiwgYXBfcGlkX2ZuYW1lKTsKIApAQCAtOTQ0LDMx
ICs5NTUsMzcgQEAgaW50IGFwX21wbV9ydW4oYXByX3Bvb2xfdCAqX3Bjb25mLCBhcHJfcG9vbF90
ICpwbG9nLCBzZXJ2ZXJfcmVjICpzKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
YXBfc2VydmVyX3Jvb3RfcmVsYXRpdmUoX3Bjb25mLCBhcF9sb2NrX2ZuYW1lKSwKICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIGFwX215X3BpZCk7CiAKLSAgICBydiA9IGFwcl9wcm9j
X211dGV4X2NyZWF0ZSgmYWNjZXB0X211dGV4LCBhcF9sb2NrX2ZuYW1lLAotICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgIGFwX2FjY2VwdF9sb2NrX21lY2gsIF9wY29uZik7Ci0gICAgaWYg
KHJ2ICE9IEFQUl9TVUNDRVNTKSB7Ci0gICAgICAgIGFwX2xvZ19lcnJvcihBUExPR19NQVJLLCBB
UExPR19FTUVSRywgcnYsIHMsCi0gICAgICAgICAgICAgICAgICAgICAiQ291bGRuJ3QgY3JlYXRl
IGFjY2VwdCBsb2NrICglcykgKCVkKSIsCi0gICAgICAgICAgICAgICAgICAgICBhcF9sb2NrX2Zu
YW1lLCBhcF9hY2NlcHRfbG9ja19tZWNoKTsKLSAgICAgICAgbXBtX3N0YXRlID0gQVBfTVBNUV9T
VE9QUElORzsKLSAgICAgICAgcmV0dXJuIDE7CisgICAgZm9yIChpID0gMCA7IGkgPCBUT1RBTF9B
Q0NFUFRfTVVURVhfTlVNQkVSIDsgKytpKSB7CisJCQkJCQkJCQkgCisgICAgICAgdG1wX2xvY2tf
Zm5hbWUgPSBhcHJfcHNwcmludGYoX3Bjb25mLCAiJXNfJWQiLCBhcF9sb2NrX2ZuYW1lLCBpKTsK
KyAgICAKKyAgICAgICBydiA9IGFwcl9wcm9jX211dGV4X2NyZWF0ZSgmYWNjZXB0X211dGV4X2Fy
cmF5W2ldLCB0bXBfbG9ja19mbmFtZSwKKwkJCQkJCQkJICAgYXBfYWNjZXB0X2xvY2tfbWVjaCwg
X3Bjb25mKTsKKyAgICAgICBpZiAocnYgIT0gQVBSX1NVQ0NFU1MpIHsKKyAgICAgICAgICBhcF9s
b2dfZXJyb3IoQVBMT0dfTUFSSywgQVBMT0dfRU1FUkcsIHJ2LCBzLAorICAgICAgICAgICAgICAg
ICAgICAgICAiQ291bGRuJ3QgY3JlYXRlIGFjY2VwdCBsb2NrICglcykgKCVkKSIsCisgICAgICAg
ICAgICAgICAgICAgICAgIHRtcF9sb2NrX2ZuYW1lLCBhcF9hY2NlcHRfbG9ja19tZWNoKTsKKyAg
ICAgICAgICBtcG1fc3RhdGUgPSBBUF9NUE1RX1NUT1BQSU5HOworICAgICAgICAgIHJldHVybiAx
OwogICAgIH0KKwkKIAogI2lmIEFQUl9VU0VfU1lTVlNFTV9TRVJJQUxJWkUKLSAgICBpZiAoYXBf
YWNjZXB0X2xvY2tfbWVjaCA9PSBBUFJfTE9DS19ERUZBVUxUIHx8Ci0gICAgICAgIGFwX2FjY2Vw
dF9sb2NrX21lY2ggPT0gQVBSX0xPQ0tfU1lTVlNFTSkgeworCQlpZiAoYXBfYWNjZXB0X2xvY2tf
bWVjaCA9PSBBUFJfTE9DS19ERUZBVUxUIHx8CisJCQlhcF9hY2NlcHRfbG9ja19tZWNoID09IEFQ
Ul9MT0NLX1NZU1ZTRU0pIHsKICNlbHNlCi0gICAgaWYgKGFwX2FjY2VwdF9sb2NrX21lY2ggPT0g
QVBSX0xPQ0tfU1lTVlNFTSkgeworCQlpZiAoYXBfYWNjZXB0X2xvY2tfbWVjaCA9PSBBUFJfTE9D
S19TWVNWU0VNKSB7CiAjZW5kaWYKLSAgICAgICAgcnYgPSB1bml4ZF9zZXRfcHJvY19tdXRleF9w
ZXJtcyhhY2NlcHRfbXV0ZXgpOwotICAgICAgICBpZiAocnYgIT0gQVBSX1NVQ0NFU1MpIHsKLSAg
ICAgICAgICAgIGFwX2xvZ19lcnJvcihBUExPR19NQVJLLCBBUExPR19FTUVSRywgcnYsIHMsCi0g
ICAgICAgICAgICAgICAgICAgICAgICAgIkNvdWxkbid0IHNldCBwZXJtaXNzaW9ucyBvbiBjcm9z
cy1wcm9jZXNzIGxvY2s7ICIKLSAgICAgICAgICAgICAgICAgICAgICAgICAiY2hlY2sgVXNlciBh
bmQgR3JvdXAgZGlyZWN0aXZlcyIpOwotICAgICAgICAgICAgbXBtX3N0YXRlID0gQVBfTVBNUV9T
VE9QUElORzsKLSAgICAgICAgICAgIHJldHVybiAxOwotICAgICAgICB9Ci0gICAgfQorCQkJcnYg
PSB1bml4ZF9zZXRfcHJvY19tdXRleF9wZXJtcyhhY2NlcHRfbXV0ZXhfYXJyYXlbaV0pOworCQkJ
aWYgKHJ2ICE9IEFQUl9TVUNDRVNTKSB7CisJCQkJYXBfbG9nX2Vycm9yKEFQTE9HX01BUkssIEFQ
TE9HX0VNRVJHLCBydiwgcywKKwkJCQkJCQkgIkNvdWxkbid0IHNldCBwZXJtaXNzaW9ucyBvbiBj
cm9zcy1wcm9jZXNzIGxvY2s7ICIKKwkJCQkJCQkgImNoZWNrIFVzZXIgYW5kIEdyb3VwIGRpcmVj
dGl2ZXMiKTsKKwkJCQltcG1fc3RhdGUgPSBBUF9NUE1RX1NUT1BQSU5HOworCQkJCXJldHVybiAx
OworCQkJfQorCQl9CisJfQogCiAgICAgaWYgKCFpc19ncmFjZWZ1bCkgewogICAgICAgICBpZiAo
YXBfcnVuX3ByZV9tcG0ocy0+cHJvY2Vzcy0+cG9vbCwgU0JfU0hBUkVEKSAhPSBPSykgewpAQCAt
MTAyMiw3ICsxMDM5LDcgQEAgaW50IGFwX21wbV9ydW4oYXByX3Bvb2xfdCAqX3Bjb25mLCBhcHJf
cG9vbF90ICpwbG9nLCBzZXJ2ZXJfcmVjICpzKQogI2lmZGVmIEFQX01QTV9XQU5UX1NFVF9BQ0NF
UFRfTE9DS19NRUNICiAgICAgYXBfbG9nX2Vycm9yKEFQTE9HX01BUkssIEFQTE9HX0RFQlVHLCAw
LCBhcF9zZXJ2ZXJfY29uZiwKICAgICAgICAgICAgICAgICAiQWNjZXB0TXV0ZXg6ICVzIChkZWZh
dWx0OiAlcykiLAotICAgICAgICAgICAgICAgIGFwcl9wcm9jX211dGV4X25hbWUoYWNjZXB0X211
dGV4KSwKKyAgICAgICAgICAgICAgICBhcHJfcHJvY19tdXRleF9uYW1lKGFjY2VwdF9tdXRleF9h
cnJheVswXSksCiAgICAgICAgICAgICAgICAgYXByX3Byb2NfbXV0ZXhfZGVmbmFtZSgpKTsKICNl
bmRpZgogICAgIHJlc3RhcnRfcGVuZGluZyA9IHNodXRkb3duX3BlbmRpbmcgPSAwOwo=

--_004_6A49427F0EB5B44F9F1006B09A0A28F4F8B09BFDILEX10adcheckpo_--

From dev-return-84351-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Mon Oct 19 20:08:59 2015
Return-Path: <dev-return-84351-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id AEFC318881
	for <apmail-httpd-dev-archive@www.apache.org>; Mon, 19 Oct 2015 20:08:59 +0000 (UTC)
Received: (qmail 50724 invoked by uid 500); 19 Oct 2015 20:07:57 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 50152 invoked by uid 500); 19 Oct 2015 20:07:51 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 49460 invoked by uid 99); 19 Oct 2015 20:07:48 -0000
Received: from Unknown (HELO spamd2-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 19 Oct 2015 20:07:48 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd2-us-west.apache.org (ASF Mail Server at spamd2-us-west.apache.org) with ESMTP id E08211A0AB6;
	Mon, 19 Oct 2015 20:07:47 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd2-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.102
X-Spam-Level:
X-Spam-Status: No, score=-0.102 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RCVD_IN_MSPIKE_H2=-0.001, SPF_PASS=-0.001] autolearn=disabled
Authentication-Results: spamd2-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-us-west.apache.org ([10.40.0.8])
	by localhost (spamd2-us-west.apache.org [10.40.0.9]) (amavisd-new, port 10024)
	with ESMTP id 1uNL0GL864GR; Mon, 19 Oct 2015 20:07:46 +0000 (UTC)
Received: from mail-qk0-f172.google.com (mail-qk0-f172.google.com [209.85.220.172])
	by mx1-us-west.apache.org (ASF Mail Server at mx1-us-west.apache.org) with ESMTPS id 8EB2B20FE0;
	Mon, 19 Oct 2015 20:07:46 +0000 (UTC)
Received: by qkcy65 with SMTP id y65so23209323qkc.0;
        Mon, 19 Oct 2015 13:07:40 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :cc:content-type;
        bh=SupE8pn5w8IhR9tw66tH9NONIpc77pkcr28/4Afut38=;
        b=nk5ob81p9Hxu/d7tbjmasgQy7NxvOhctK24bM6UiqC+aRpGkGlZwv9cp7TryHo/67k
         K3MR8sFHstaxgp2nE4ko/asZXcsz3CSQ6fPH8S6wRGlsNtKLGtG3v6gsHeGq3/mVGaox
         3dRc852x5fFOo0SQGoUDreBA8khJimYMN49xCvkWWgN92C7ilQLO7lnDOBFMTwE/exVO
         8oh/7GS3b09665hE+BRhxjntO2XuokbNIDjqe5/ZDfPkgaHNXHw3KGeQfYXEAl5ackzR
         Qhe0Jc+LJ1EngjvCI/ULQxTWHkco6jczI0Uy7qrxLIZc96bXusMoT7CHg1wgYp3o2DMv
         OoBQ==
MIME-Version: 1.0
X-Received: by 10.55.15.134 with SMTP id 6mr38254978qkp.38.1445285258092; Mon,
 19 Oct 2015 13:07:38 -0700 (PDT)
Received: by 10.55.156.213 with HTTP; Mon, 19 Oct 2015 13:07:38 -0700 (PDT)
In-Reply-To: <56251BB6.5010309@gmail.com>
References: <56251BB6.5010309@gmail.com>
Date: Mon, 19 Oct 2015 22:07:38 +0200
Message-ID: <CAKQ1sVOjz3swFj1pt+oob7meqku5gh1aeEohraKdcRyaDLJh6A@mail.gmail.com>
Subject: Re: Non-blocking ap_get_brigade() doesn't return EAGAIN?
From: Yann Ylavic <ylavic.dev@gmail.com>
To: modules-dev@httpd.apache.org
Cc: dev@httpd.apache.org
Content-Type: text/plain; charset=UTF-8

Hi Jacob,

[CCing dev@, probably more insight about this from there]

On Mon, Oct 19, 2015 at 6:35 PM, Jacob Champion <champion.p@gmail.com> wrote:
> The patchset I recently folded into mod_websocket [1] rails the CPU when
> using ws:// instead of wss://. The problem appears to be that an empty
> non-blocking read from ap_get_brigade() returns EAGAIN when using SSL, but
> without SSL it is returning SUCCESS with an empty brigade.
>
> Yann, I noticed that you wrote about something similar a while ago [2] but I
> don't know if that conversation went anywhere. Is SUCCESS with an empty
> brigade really a correct postcondition for ap_get_brigade(), or is this a
> bug?

The httpd input filters/handlers usually check for both
APR_STATUS_IS_EAGAIN() or SUCCESS+APR_BRIGADE_EMPTY()...

The latter comes from the core input filter, with the following code
and comment:
        /* We should treat EAGAIN here the same as we do for EOF (brigade is
         * empty).  We do this by returning whatever we have read.  This may
         * or may not be bogus, but is consistent (for now) with EOF logic.
         */
        if (APR_STATUS_IS_EAGAIN(rv) && block == APR_NONBLOCK_READ) {
            rv = APR_SUCCESS;
        }
        return rv;

This comment is about AP_MODE_GETLINE, and I think it predates the way
we handle APR_EOF now, with either:
    /* ...
     * Ideally, this should be returning SUCCESS with EOS bucket, but
     * some higher-up APIs (spec. read_request_line via ap_rgetline)
     * want an error code.
     */
    if (APR_BRIGADE_EMPTY(ctx->b)) {
        return APR_EOF;
    }

or for AP_MODE_READBYTES/AP_MODE_SPECULATIVE:
    if (block == APR_BLOCK_READ && len == 0) {
        /* We wanted to read some bytes in blocking mode.  We read
         * 0 bytes.  Hence, we now assume we are EOS.
         *
         * When we are in normal mode, return an EOS bucket to the
         * caller.
         * When we are in speculative mode, leave ctx->b empty, so
         * that the next call returns an EOS bucket.
         */
        [...]
        if (mode == AP_MODE_READBYTES) {
            e = apr_bucket_eos_create(f->c->bucket_alloc);
            APR_BRIGADE_INSERT_TAIL(b, e);
        }
        return APR_SUCCESS;
    }

or else for AP_MODE_READBYTES/AP_MODE_SPECULATIVE still, but non-blocking:
    rv = apr_bucket_read(e, &str, &len, block);
    if (APR_STATUS_IS_EAGAIN(rv) && block == APR_NONBLOCK_READ) {
        /* getting EAGAIN for a blocking read is an error; for a
         * non-blocking read, return an empty brigade. */
        return APR_SUCCESS;
    }
    else if (rv != APR_SUCCESS) {
        return rv;
    }
    [else: try to consume all the buckets non-blocking until
           the requested number of bytes is reached,
           or we would block,
           or EOF]
where e is typically (soon or later) the socket bucket (which will
never return APR_EOF on read, but morph to an empty string instead).

So there are indeed some weirdness here, and probably some room for
simplification and optimization.

For the simplification, I agree we should return EAGAIN for a
non-blocking read which would block, thus simplify several callers
which already check it (they have to, as you said, because of mod_ssl)
along with the empty case.
Not to mention that EAGAIN can also be returned in blocking mode (per
the above code) and is to be considered an error, hence the typical
would-block check is currently mode == APR_NONBLOCK_READ &&
(APR_STATUS_IS_EAGAIN(rv) || EMPTY(bb)) (not really simple...), so
this case should be turned to a real error IMO.
We could also return EAGAIN in AP_MODE_GETLINE, but here we would have
to take care of not returning an incomplete line (though this is not
the case currently, since we return SUCCESS in this case too, while we
could easily keep it buffered in ctx->b).

For the optimization, they are also cases where we could return EOF
early (in non-blocking mode), and save some round trips.
There is no way we can return anything else than EOF on the next calls anyway.

I'll (re)take a look at the thread [2] you mentioned (and refresh my
mind, I don't remember all the details :), and then propose something
to dev@...

Regards,
Yann.

From dev-return-84352-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Mon Oct 19 20:30:07 2015
Return-Path: <dev-return-84352-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 8EB5F1892D
	for <apmail-httpd-dev-archive@www.apache.org>; Mon, 19 Oct 2015 20:30:07 +0000 (UTC)
Received: (qmail 21287 invoked by uid 500); 19 Oct 2015 20:30:06 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 21223 invoked by uid 500); 19 Oct 2015 20:30:06 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 21213 invoked by uid 99); 19 Oct 2015 20:30:06 -0000
Received: from Unknown (HELO spamd3-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 19 Oct 2015 20:30:06 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd3-us-west.apache.org (ASF Mail Server at spamd3-us-west.apache.org) with ESMTP id 1F8E4180A67
	for <dev@httpd.apache.org>; Mon, 19 Oct 2015 20:30:06 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd3-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.102
X-Spam-Level:
X-Spam-Status: No, score=-0.102 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RCVD_IN_MSPIKE_H2=-0.001, SPF_PASS=-0.001] autolearn=disabled
Authentication-Results: spamd3-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd3-us-west.apache.org [10.40.0.10]) (amavisd-new, port 10024)
	with ESMTP id MZptCXqmedbS for <dev@httpd.apache.org>;
	Mon, 19 Oct 2015 20:30:05 +0000 (UTC)
Received: from mail-qg0-f50.google.com (mail-qg0-f50.google.com [209.85.192.50])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id AA44E206E3
	for <dev@httpd.apache.org>; Mon, 19 Oct 2015 20:30:04 +0000 (UTC)
Received: by qgbb65 with SMTP id b65so64000374qgb.2
        for <dev@httpd.apache.org>; Mon, 19 Oct 2015 13:29:58 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        bh=pJCY5jYfZUWsesSWOppZZJB2L+Iu0yjS2Th14aPThSE=;
        b=rlZMs7vUxfo0ZgvbDXu3MAgGpC9weizl8wWRFp+RduY+9EwdRKCq0GPNZy0TMZNHcb
         V249vNei75JL5XMpgKxr0DCRCp5mTEzafisGlfQvK4SqzvGwiFmLh/RNfD6U2DJ0jJ5i
         pyvXdsOJRUnaRTvCnsL4YG7quhGvvEgNoERK//68KXrsu/JSr9cXg/9feif1wrPflv2P
         qd9WGMKMaXfEL1eJTY/F0IjgxkovjQTBZjELPzTklBGosV86sBIqS2KpvKNN/UAcSR4K
         trSc9gMWRABi2jR6icsHGWmpu35H1s/WzDRxpDD+lxwD/AHdV1Tki3SgzEblNl4Hri/+
         cCcQ==
MIME-Version: 1.0
X-Received: by 10.140.236.203 with SMTP id h194mr38893318qhc.73.1445286598240;
 Mon, 19 Oct 2015 13:29:58 -0700 (PDT)
Received: by 10.55.156.213 with HTTP; Mon, 19 Oct 2015 13:29:58 -0700 (PDT)
In-Reply-To: <CAKQ1sVNchFx=egp=Q0tgT+1GcBXiten8mh9STetcZXOfJxhsjQ@mail.gmail.com>
References: <CAKQ1sVNchFx=egp=Q0tgT+1GcBXiten8mh9STetcZXOfJxhsjQ@mail.gmail.com>
Date: Mon, 19 Oct 2015 22:29:58 +0200
Message-ID: <CAKQ1sVPjcA9EYNpjcmM9=AU_LCgAsFntOcZnmGoHymds3S5wmA@mail.gmail.com>
Subject: Fwd: Forwarded buckets' lifetime (was: [Bug 58503] segfault in apr_brigade_cleanup()...)
From: Yann Ylavic <ylavic.dev@gmail.com>
To: dev@httpd.apache.org
Content-Type: text/plain; charset=UTF-8

[Meant for dev@...]

Thoughts?

> https://bz.apache.org/bugzilla/show_bug.cgi?id=58503
>
> --- Comment #8 from Yann Ylavic <ylavic.dev@gmail.com> ---
> (In reply to Ruediger Pluem from comment #7)
>> Actually I think mod_proxy_wstunnel falls into the same pitfall
>> mod_proxy_http was in and it needs to do the same / something similar then
>> mod_proxy_http.c with
>>
>> proxy_buckets_lifetime_transform
>
> Yes I agree, just proposed a quick patch to determine whether it came from
> mod_proxy_wstunnel or some failure in the core deferred/pipelined write
> logic...
>
> We need to either use lifetime_transform like in proxy_http, or I was thinking
> of modifying all the input filters that create their buckets on f->r/c's
> pool/bucket_alloc so that they now use their given bb->p and bb->bucket_alloc.
>
> By doing the latter, we wouldn't have to transform the lifetime, it would be
> determined by the caller...

From dev-return-84353-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Mon Oct 19 23:05:30 2015
Return-Path: <dev-return-84353-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 8609118FE6
	for <apmail-httpd-dev-archive@www.apache.org>; Mon, 19 Oct 2015 23:05:30 +0000 (UTC)
Received: (qmail 76277 invoked by uid 500); 19 Oct 2015 23:05:26 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 76006 invoked by uid 500); 19 Oct 2015 23:05:25 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 75800 invoked by uid 99); 19 Oct 2015 23:05:25 -0000
Received: from Unknown (HELO spamd2-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 19 Oct 2015 23:05:25 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd2-us-west.apache.org (ASF Mail Server at spamd2-us-west.apache.org) with ESMTP id 8B0001A0AD8
	for <dev@httpd.apache.org>; Mon, 19 Oct 2015 23:05:25 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd2-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.101
X-Spam-Level:
X-Spam-Status: No, score=-0.101 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RCVD_IN_MSPIKE_H2=-0.001, SPF_PASS=-0.001, URIBL_BLOCKED=0.001]
	autolearn=disabled
Authentication-Results: spamd2-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd2-us-west.apache.org [10.40.0.9]) (amavisd-new, port 10024)
	with ESMTP id ed4fNXRPtJNl for <dev@httpd.apache.org>;
	Mon, 19 Oct 2015 23:05:19 +0000 (UTC)
Received: from mail-qg0-f43.google.com (mail-qg0-f43.google.com [209.85.192.43])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id 7923720750
	for <dev@httpd.apache.org>; Mon, 19 Oct 2015 23:05:18 +0000 (UTC)
Received: by qgeo38 with SMTP id o38so278844qge.0
        for <dev@httpd.apache.org>; Mon, 19 Oct 2015 16:05:17 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type:content-transfer-encoding;
        bh=T/zZrlxeD/RZ+AOBnMLVv4ABr9K2k5T7CHfnR5GmrSw=;
        b=qhmL1nCjVzGLHz2ODgr65bcf9pvfMHhAXRPHOfu+G3xpjuXH54fh5A/+PJe/fY+re8
         wxivw4gSClldILHi5IhugQeTbkud0qhJazVCSCVY3TenaPJJIus3LAXLptLeuXeySWO4
         i4MaJMrp3U0Td0iBJyrGKKF9rH4rN4O8IpeoHX8Hb9HGUqBFqTIiadGUV8AnQpcpWqEB
         om25/GxU/rA6dLYBimVKDD60kIkNQ1VYu/6SNQ5JSI1osnkRbujAEaTgQuxn6DnQ/Ffz
         y5aOOY2CNJcVQp0XwDr3BoOiZ6SXoffnEqPZeDbq+Yp8K6bZzvnwlNMD/Vb5FRHNOcBU
         iYFw==
MIME-Version: 1.0
X-Received: by 10.140.43.183 with SMTP id e52mr4978qga.38.1445295917408; Mon,
 19 Oct 2015 16:05:17 -0700 (PDT)
Received: by 10.55.156.213 with HTTP; Mon, 19 Oct 2015 16:05:17 -0700 (PDT)
In-Reply-To: <5625642E.30708@ptc.com>
References: <5625642E.30708@ptc.com>
Date: Tue, 20 Oct 2015 01:05:17 +0200
Message-ID: <CAKQ1sVPceAVuDMNgt-qGomU6EARQap5HpCbvaPPiwtYXsUvRpg@mail.gmail.com>
Subject: Re: [users@httpd] Chunked transfer delay with httpd 2.4 on Windows.
From: Yann Ylavic <ylavic.dev@gmail.com>
To: dev@httpd.apache.org
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: quoted-printable

[From users@]

On Mon, Oct 19, 2015 at 11:44 PM, Andy Wang <awang@ptc.com> wrote:
>
> The issue is currently reproduced using Apache httpd 2.4.16, mod_jk 1.2.4=
1
> and tomcat 8.0.28.
>
> I've created a very very simple JSP page that does nothing but print a sm=
all
> string, but I've tried changing the jsp page to print a very very large
> string (10000+ characters) and no difference.
>
> If I POST to this JSP page, and something like mod_deflate is in place to
> force a chunked transfer the TCP packet capture looks like this:
>
> No.     Time           Source  Destination   Protocol Length Info
>    1850 4827.762721000 client  server        TCP      66     54131=E2=86=
=922280
> [SYN] Seq=3D0 Win=3D8192 Len=3D0 MSS=3D1460 WS=3D256 SACK_PERM=3D1
>    1851 4827.764976000 server  client        TCP      66     2280=E2=86=
=9254131
> [SYN, ACK] Seq=3D0 Ack=3D1 Win=3D8192 Len=3D0 MSS=3D1460 WS=3D256 SACK_PE=
RM=3D1
>    1852 4827.765053000 client  server        TCP      54     54131=E2=86=
=922280
> [ACK] Seq=3D1 Ack=3D1 Win=3D131328 Len=3D0
>    1853 4827.765315000 client  server        HTTP     791    POST
> /JSPtoPostTo HTTP/1.1
>    1854 4827.777981000 server  client        TCP      466    [TCP segment=
 of
> a reassembled PDU]
>    1855 4827.982961000 client  server        TCP      54     54131=E2=86=
=922280
> [ACK] Seq=3D738 Ack=3D413 Win=3D130816 Len=3D0
>    1856 4832.770458000 server  client        HTTP     74     HTTP/1.1 200=
 OK
> (text/html)
>    1857 4832.770459000 server  client        TCP      60     2280=E2=86=
=9254131
> [FIN, ACK] Seq=3D433 Ack=3D738 Win=3D65536 Len=3D0
>    1858 4832.770555000 client  server        TCP      54     54131=E2=86=
=922280
> [ACK] Seq=3D738 Ack=3D434 Win=3D130816 Len=3D0
>    1859 4832.770904000 client  server        TCP      54     54131=E2=86=
=922280
> [FIN, ACK] Seq=3D738 Ack=3D434 Win=3D130816 Len=3D0
>    1860 4832.774200000 server  client        TCP      60     2280=E2=86=
=9254131
> [ACK] Seq=3D434 Ack=3D739 Win=3D65536 Len=3D0
>
> Spdficially, note the 5 second delay between the first segment (No. 1854)
> and the second data segment (1856).

This is the deferred write triggering *after* the keepalive timeout,
whereas no subsequent request was pipelined.
I wonder if we shouldn't issue a flush at the end of each request when
the following is not already there, ie:

Index: modules/http/http_request.c
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D
--- modules/http/http_request.c    (revision 1708095)
+++ modules/http/http_request.c    (working copy)
@@ -228,8 +228,9 @@ AP_DECLARE(void) ap_die(int type, request_rec *r)
     ap_die_r(type, r, r->status);
 }

-static void check_pipeline(conn_rec *c, apr_bucket_brigade *bb)
+static int check_pipeline(conn_rec *c, apr_bucket_brigade *bb)
 {
+    c->data_in_input_filters =3D 0;
     if (c->keepalive !=3D AP_CONN_CLOSE && !c->aborted) {
         apr_status_t rv;

@@ -236,17 +237,12 @@ AP_DECLARE(void) ap_die(int type, request_rec *r)
         AP_DEBUG_ASSERT(APR_BRIGADE_EMPTY(bb));
         rv =3D ap_get_brigade(c->input_filters, bb, AP_MODE_SPECULATIVE,
                             APR_NONBLOCK_READ, 1);
-        if (rv !=3D APR_SUCCESS || APR_BRIGADE_EMPTY(bb)) {
-            /*
-             * Error or empty brigade: There is no data present in the inp=
ut
-             * filter
-             */
-            c->data_in_input_filters =3D 0;
-        }
-        else {
+        if (rv =3D=3D APR_SUCCESS && !APR_BRIGADE_EMPTY(bb)) {
             c->data_in_input_filters =3D 1;
+            return 1;
         }
     }
+    return 0;
 }


@@ -287,11 +283,30 @@ AP_DECLARE(void) ap_process_request_after_handler(
      * already by the EOR bucket's cleanup function.
      */

-    check_pipeline(c, bb);
+    if (!check_pipeline(c, bb)) {
+        apr_status_t rv;
+
+        b =3D apr_bucket_flush_create(c->bucket_alloc);
+        APR_BRIGADE_INSERT_HEAD(bb, b);
+        rv =3D ap_pass_brigade(c->output_filters, bb);
+        if (APR_STATUS_IS_TIMEUP(rv)) {
+            /*
+             * Notice a timeout as an error message. This might be
+             * valuable for detecting clients with broken network
+             * connections or possible DoS attacks.
+             *
+             * It is still safe to use r / r->pool here as the eor bucket
+             * could not have been destroyed in the event of a timeout.
+             */
+            ap_log_cerror(APLOG_MARK, APLOG_INFO, rv, c, APLOGNO(01581)
+                          "Timeout while flushing data to the client");
+        }
+    }
     apr_brigade_destroy(bb);
-    if (c->cs)
+    if (c->cs) {
         c->cs->state =3D (c->aborted) ? CONN_STATE_LINGER
                                     : CONN_STATE_WRITE_COMPLETION;
+    }
     AP_PROCESS_REQUEST_RETURN((uintptr_t)r, r->uri, r->status);
     if (ap_extended_status) {
         ap_time_process_request(c->sbh, STOP_PREQUEST);
@@ -373,33 +388,10 @@ void ap_process_async_request(request_rec *r)

 AP_DECLARE(void) ap_process_request(request_rec *r)
 {
-    apr_bucket_brigade *bb;
-    apr_bucket *b;
-    conn_rec *c =3D r->connection;
-    apr_status_t rv;
-
     ap_process_async_request(r);

-    if (!c->data_in_input_filters) {
-        bb =3D apr_brigade_create(c->pool, c->bucket_alloc);
-        b =3D apr_bucket_flush_create(c->bucket_alloc);
-        APR_BRIGADE_INSERT_HEAD(bb, b);
-        rv =3D ap_pass_brigade(c->output_filters, bb);
-        if (APR_STATUS_IS_TIMEUP(rv)) {
-            /*
-             * Notice a timeout as an error message. This might be
-             * valuable for detecting clients with broken network
-             * connections or possible DoS attacks.
-             *
-             * It is still safe to use r / r->pool here as the eor bucket
-             * could not have been destroyed in the event of a timeout.
-             */
-            ap_log_rerror(APLOG_MARK, APLOG_INFO, rv, r, APLOGNO(01581)
-                          "Timeout while writing data for URI %s to the"
-                          " client", r->unparsed_uri);
-        }
-    }
     if (ap_extended_status) {
+        conn_rec *c =3D r->connection;
         ap_time_process_request(c->sbh, STOP_PREQUEST);
     }
 }
--

Thoughts?

From dev-return-84354-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Mon Oct 19 23:37:12 2015
Return-Path: <dev-return-84354-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id A506418153
	for <apmail-httpd-dev-archive@www.apache.org>; Mon, 19 Oct 2015 23:37:12 +0000 (UTC)
Received: (qmail 82232 invoked by uid 500); 19 Oct 2015 23:37:12 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 82148 invoked by uid 500); 19 Oct 2015 23:37:11 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 82138 invoked by uid 99); 19 Oct 2015 23:37:11 -0000
Received: from Unknown (HELO spamd3-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 19 Oct 2015 23:37:11 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd3-us-west.apache.org (ASF Mail Server at spamd3-us-west.apache.org) with ESMTP id 694A8180A64
	for <dev@httpd.apache.org>; Mon, 19 Oct 2015 23:37:11 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd3-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.11
X-Spam-Level:
X-Spam-Status: No, score=-0.11 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	SPF_PASS=-0.001, T_RP_MATCHES_RCVD=-0.01, URIBL_BLOCKED=0.001]
	autolearn=disabled
Authentication-Results: spamd3-us-west.apache.org (amavisd-new);
	dkim=pass (1024-bit key) header.d=ptc.com
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd3-us-west.apache.org [10.40.0.10]) (amavisd-new, port 10024)
	with ESMTP id eNrszZdoJWC1 for <dev@httpd.apache.org>;
	Mon, 19 Oct 2015 23:37:01 +0000 (UTC)
Received: from mx1.ptc.com (mx1.ptc.com [12.11.148.188])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id 8D1C143B05
	for <dev@httpd.apache.org>; Mon, 19 Oct 2015 23:37:01 +0000 (UTC)
DKIM-Signature: v=1; a=rsa-sha256; c=simple/simple;
  d=ptc.com; s=ptc; t=1445297821; x=1476833821;
  h=subject:to:references:from:message-id:date:mime-version:
   in-reply-to:content-transfer-encoding;
  bh=zZMO4upnDyL/ZUls0fn5mvIixg153rfslVRwKwzDhFo=;
  b=H7tZ2hlEFiotsc5+zD+H86Uu/c6hWmeP3eICxMO2s27sZmlCT8IBQMQ9
   yEOeuZUOtss5jby46Yhx0xVgB7D8fkk81fOxQHFaYviDYg+GDhHU0wncD
   39uLPzLaZxkST4bFT0MWKdk1vrNllp7a53urwhMxUZrSEACx+fH0+DdL3
   k=;
X-IronPort-AV: E=Sophos;i="5.17,704,1437451200"; 
   d="scan'208";a="117722494"
Received: from hq-x10prdhub1.ptcnet.ptc.com ([132.253.198.27])
  by mx1-int.ptc.com with ESMTP/TLS/AES128-SHA; 19 Oct 2015 19:36:55 -0400
Received: from awang.ptcnet.ptc.com (132.253.8.73) by
 int-mail-hub1.ptcnet.ptc.com (132.253.201.252) with Microsoft SMTP Server id
 14.3.123.3; Mon, 19 Oct 2015 19:36:55 -0400
Subject: Re: [users@httpd] Chunked transfer delay with httpd 2.4 on Windows.
To: <dev@httpd.apache.org>
References: <5625642E.30708@ptc.com>
 <CAKQ1sVPceAVuDMNgt-qGomU6EARQap5HpCbvaPPiwtYXsUvRpg@mail.gmail.com>
From: Andy Wang <awang@ptc.com>
Message-ID: <56257E96.2030909@ptc.com>
Date: Mon, 19 Oct 2015 18:36:54 -0500
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:38.0) Gecko/20100101
 Thunderbird/38.3.0
MIME-Version: 1.0
In-Reply-To: <CAKQ1sVPceAVuDMNgt-qGomU6EARQap5HpCbvaPPiwtYXsUvRpg@mail.gmail.com>
Content-Type: text/plain; charset="utf-8"; format=flowed
Content-Transfer-Encoding: 8bit
X-Originating-IP: [132.253.8.73]


On 10/19/2015 06:05 PM, Yann Ylavic wrote:
> [From users@]
>
> On Mon, Oct 19, 2015 at 11:44 PM, Andy Wang <awang@ptc.com> wrote:
>>
>> The issue is currently reproduced using Apache httpd 2.4.16, mod_jk 1.2.41
>> and tomcat 8.0.28.
>>
>> I've created a very very simple JSP page that does nothing but print a small
>> string, but I've tried changing the jsp page to print a very very large
>> string (10000+ characters) and no difference.
>>
>> If I POST to this JSP page, and something like mod_deflate is in place to
>> force a chunked transfer the TCP packet capture looks like this:
>>
>> No.     Time           Source  Destination   Protocol Length Info
>>     1850 4827.762721000 client  server        TCP      66     54131→2280
>> [SYN] Seq=0 Win=8192 Len=0 MSS=1460 WS=256 SACK_PERM=1
>>     1851 4827.764976000 server  client        TCP      66     2280→54131
>> [SYN, ACK] Seq=0 Ack=1 Win=8192 Len=0 MSS=1460 WS=256 SACK_PERM=1
>>     1852 4827.765053000 client  server        TCP      54     54131→2280
>> [ACK] Seq=1 Ack=1 Win=131328 Len=0
>>     1853 4827.765315000 client  server        HTTP     791    POST
>> /JSPtoPostTo HTTP/1.1
>>     1854 4827.777981000 server  client        TCP      466    [TCP segment of
>> a reassembled PDU]
>>     1855 4827.982961000 client  server        TCP      54     54131→2280
>> [ACK] Seq=738 Ack=413 Win=130816 Len=0
>>     1856 4832.770458000 server  client        HTTP     74     HTTP/1.1 200 OK
>> (text/html)
>>     1857 4832.770459000 server  client        TCP      60     2280→54131
>> [FIN, ACK] Seq=433 Ack=738 Win=65536 Len=0
>>     1858 4832.770555000 client  server        TCP      54     54131→2280
>> [ACK] Seq=738 Ack=434 Win=130816 Len=0
>>     1859 4832.770904000 client  server        TCP      54     54131→2280
>> [FIN, ACK] Seq=738 Ack=434 Win=130816 Len=0
>>     1860 4832.774200000 server  client        TCP      60     2280→54131
>> [ACK] Seq=434 Ack=739 Win=65536 Len=0
>>
>> Spdficially, note the 5 second delay between the first segment (No. 1854)
>> and the second data segment (1856).
>
> This is the deferred write triggering *after* the keepalive timeout,
> whereas no subsequent request was pipelined.
> I wonder if we shouldn't issue a flush at the end of each request when
> the following is not already there, ie:
>
> Index: modules/http/http_request.c
> ===================================================================
> --- modules/http/http_request.c    (revision 1708095)
> +++ modules/http/http_request.c    (working copy)
> @@ -228,8 +228,9 @@ AP_DECLARE(void) ap_die(int type, request_rec *r)
>       ap_die_r(type, r, r->status);
>   }
>
> -static void check_pipeline(conn_rec *c, apr_bucket_brigade *bb)
> +static int check_pipeline(conn_rec *c, apr_bucket_brigade *bb)
>   {
> +    c->data_in_input_filters = 0;
>       if (c->keepalive != AP_CONN_CLOSE && !c->aborted) {
>           apr_status_t rv;
>
> @@ -236,17 +237,12 @@ AP_DECLARE(void) ap_die(int type, request_rec *r)
>           AP_DEBUG_ASSERT(APR_BRIGADE_EMPTY(bb));
>           rv = ap_get_brigade(c->input_filters, bb, AP_MODE_SPECULATIVE,
>                               APR_NONBLOCK_READ, 1);
> -        if (rv != APR_SUCCESS || APR_BRIGADE_EMPTY(bb)) {
> -            /*
> -             * Error or empty brigade: There is no data present in the input
> -             * filter
> -             */
> -            c->data_in_input_filters = 0;
> -        }
> -        else {
> +        if (rv == APR_SUCCESS && !APR_BRIGADE_EMPTY(bb)) {
>               c->data_in_input_filters = 1;
> +            return 1;
>           }
>       }
> +    return 0;
>   }
>
>
> @@ -287,11 +283,30 @@ AP_DECLARE(void) ap_process_request_after_handler(
>        * already by the EOR bucket's cleanup function.
>        */
>
> -    check_pipeline(c, bb);
> +    if (!check_pipeline(c, bb)) {
> +        apr_status_t rv;
> +
> +        b = apr_bucket_flush_create(c->bucket_alloc);
> +        APR_BRIGADE_INSERT_HEAD(bb, b);
> +        rv = ap_pass_brigade(c->output_filters, bb);
> +        if (APR_STATUS_IS_TIMEUP(rv)) {
> +            /*
> +             * Notice a timeout as an error message. This might be
> +             * valuable for detecting clients with broken network
> +             * connections or possible DoS attacks.
> +             *
> +             * It is still safe to use r / r->pool here as the eor bucket
> +             * could not have been destroyed in the event of a timeout.
> +             */
> +            ap_log_cerror(APLOG_MARK, APLOG_INFO, rv, c, APLOGNO(01581)
> +                          "Timeout while flushing data to the client");
> +        }
> +    }
>       apr_brigade_destroy(bb);
> -    if (c->cs)
> +    if (c->cs) {
>           c->cs->state = (c->aborted) ? CONN_STATE_LINGER
>                                       : CONN_STATE_WRITE_COMPLETION;
> +    }
>       AP_PROCESS_REQUEST_RETURN((uintptr_t)r, r->uri, r->status);
>       if (ap_extended_status) {
>           ap_time_process_request(c->sbh, STOP_PREQUEST);
> @@ -373,33 +388,10 @@ void ap_process_async_request(request_rec *r)
>
>   AP_DECLARE(void) ap_process_request(request_rec *r)
>   {
> -    apr_bucket_brigade *bb;
> -    apr_bucket *b;
> -    conn_rec *c = r->connection;
> -    apr_status_t rv;
> -
>       ap_process_async_request(r);
>
> -    if (!c->data_in_input_filters) {
> -        bb = apr_brigade_create(c->pool, c->bucket_alloc);
> -        b = apr_bucket_flush_create(c->bucket_alloc);
> -        APR_BRIGADE_INSERT_HEAD(bb, b);
> -        rv = ap_pass_brigade(c->output_filters, bb);
> -        if (APR_STATUS_IS_TIMEUP(rv)) {
> -            /*
> -             * Notice a timeout as an error message. This might be
> -             * valuable for detecting clients with broken network
> -             * connections or possible DoS attacks.
> -             *
> -             * It is still safe to use r / r->pool here as the eor bucket
> -             * could not have been destroyed in the event of a timeout.
> -             */
> -            ap_log_rerror(APLOG_MARK, APLOG_INFO, rv, r, APLOGNO(01581)
> -                          "Timeout while writing data for URI %s to the"
> -                          " client", r->unparsed_uri);
> -        }
> -    }
>       if (ap_extended_status) {
> +        conn_rec *c = r->connection;
>           ap_time_process_request(c->sbh, STOP_PREQUEST);
>       }
>   }
> --
>
> Thoughts?
>

I'll take a look at this patch tomorrow and apply it to see if it works.
Thanks for taking a look at it.

Andy

From dev-return-84355-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Tue Oct 20 00:44:30 2015
Return-Path: <dev-return-84355-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id B71C118349
	for <apmail-httpd-dev-archive@www.apache.org>; Tue, 20 Oct 2015 00:44:30 +0000 (UTC)
Received: (qmail 93530 invoked by uid 500); 20 Oct 2015 00:44:29 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 93145 invoked by uid 500); 20 Oct 2015 00:44:29 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 92871 invoked by uid 99); 20 Oct 2015 00:44:29 -0000
Received: from Unknown (HELO spamd4-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 20 Oct 2015 00:44:29 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd4-us-west.apache.org (ASF Mail Server at spamd4-us-west.apache.org) with ESMTP id CC3ABC0EC7
	for <dev@httpd.apache.org>; Tue, 20 Oct 2015 00:44:28 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd4-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.102
X-Spam-Level:
X-Spam-Status: No, score=-0.102 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RCVD_IN_MSPIKE_H2=-0.001, SPF_PASS=-0.001] autolearn=disabled
Authentication-Results: spamd4-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd4-us-west.apache.org [10.40.0.11]) (amavisd-new, port 10024)
	with ESMTP id cR1L408R5SeX for <dev@httpd.apache.org>;
	Tue, 20 Oct 2015 00:44:19 +0000 (UTC)
Received: from mail-io0-f169.google.com (mail-io0-f169.google.com [209.85.223.169])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id 7718F42B95
	for <dev@httpd.apache.org>; Tue, 20 Oct 2015 00:44:19 +0000 (UTC)
Received: by iofz202 with SMTP id z202so5361192iof.2
        for <dev@httpd.apache.org>; Mon, 19 Oct 2015 17:44:19 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        bh=z7q4FzvAYojSVYBAfbXE9Cc/uYNKqJZJUEwsm9R1esw=;
        b=TwpTaHapzi7yxoeghC5cuUG8rCVnEqrSM0Gqb19fzKzo64iB9hIM52SC4elDJOk7O/
         gRJMnc/gqd43Ky32wSd0vKWK4KyMoSTuU6zalT8zJaEfB286g1DmixRNbOLWgroJHI11
         dOhS6ueubKVxPA4qGE4x2EBgDAtjYxvqFo3rrE7NozvCXaA9NxoOxVeNInZ//4/cdSPM
         iPZjkea52w6m9XlBpd/OBVyJSpCG0ZsOEVkFKMmytQJT3O1AS4Glx8MV5ANeLxO/EJrj
         0SfEnE73c77jqTuIajsr836LQwIH8m9gta2rWze/qXoK+1xIeEgR7IpHdkJ0ej1zdcHI
         Kj/Q==
MIME-Version: 1.0
X-Received: by 10.107.160.143 with SMTP id j137mr831775ioe.13.1445301859085;
 Mon, 19 Oct 2015 17:44:19 -0700 (PDT)
Received: by 10.64.112.69 with HTTP; Mon, 19 Oct 2015 17:44:19 -0700 (PDT)
In-Reply-To: <CAKQ1sVPceAVuDMNgt-qGomU6EARQap5HpCbvaPPiwtYXsUvRpg@mail.gmail.com>
References: <5625642E.30708@ptc.com>
	<CAKQ1sVPceAVuDMNgt-qGomU6EARQap5HpCbvaPPiwtYXsUvRpg@mail.gmail.com>
Date: Mon, 19 Oct 2015 20:44:19 -0400
Message-ID: <CALK=YjM5CvMgWAWT=X67JxBdaJDJ5PCFsHJijSEs0bKovFnQtQ@mail.gmail.com>
Subject: Re: [users@httpd] Chunked transfer delay with httpd 2.4 on Windows.
From: Eric Covener <covener@gmail.com>
To: Apache HTTP Server Development List <dev@httpd.apache.org>
Content-Type: text/plain; charset=UTF-8

On Mon, Oct 19, 2015 at 7:05 PM, Yann Ylavic <ylavic.dev@gmail.com> wrote:
> This is the deferred write triggering *after* the keepalive timeout,
> whereas no subsequent request was pipelined.
> I wonder if we shouldn't issue a flush at the end of each request when
> the following is not already there, ie:

Can you describe what breaks the current code? It looks like it's
already trying to handle this case, I couldn't tell the operative
difference.

From dev-return-84356-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Tue Oct 20 02:25:26 2015
Return-Path: <dev-return-84356-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id A80031863E
	for <apmail-httpd-dev-archive@www.apache.org>; Tue, 20 Oct 2015 02:25:26 +0000 (UTC)
Received: (qmail 73589 invoked by uid 500); 20 Oct 2015 02:25:26 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 73517 invoked by uid 500); 20 Oct 2015 02:25:26 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 73507 invoked by uid 99); 20 Oct 2015 02:25:26 -0000
Received: from Unknown (HELO spamd1-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 20 Oct 2015 02:25:26 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd1-us-west.apache.org (ASF Mail Server at spamd1-us-west.apache.org) with ESMTP id 9EBF4C5934
	for <dev@httpd.apache.org>; Tue, 20 Oct 2015 02:25:25 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd1-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.1
X-Spam-Level:
X-Spam-Status: No, score=-0.1 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RP_MATCHES_RCVD=0.001, SPF_PASS=-0.001] autolearn=disabled
Authentication-Results: spamd1-us-west.apache.org (amavisd-new);
	dkim=pass (1024-bit key) header.d=ptc.com
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd1-us-west.apache.org [10.40.0.7]) (amavisd-new, port 10024)
	with ESMTP id to7r9kejA61K for <dev@httpd.apache.org>;
	Tue, 20 Oct 2015 02:25:18 +0000 (UTC)
Received: from mx1.ptc.com (mx1.ptc.com [12.11.148.188])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id 0095D2074E
	for <dev@httpd.apache.org>; Tue, 20 Oct 2015 02:25:17 +0000 (UTC)
DKIM-Signature: v=1; a=rsa-sha256; c=simple/simple;
  d=ptc.com; s=ptc; t=1445307918; x=1476843918;
  h=subject:to:references:from:message-id:date:mime-version:
   in-reply-to:content-transfer-encoding;
  bh=SvfnzaB6LBT2TFQYHYma0DoLObknvXRb/WpmUFLjJ6U=;
  b=h/nD1PRd5pm4V5g62RQ2vj2NQpl4gAqtE1ik1gWpBQgto1yYu2+9Xaxx
   clba+ykzjQFmm+fNpja2Ef+wp7NnsCK1KNuUjQ+BKT+EOHK+jTRz+WJLl
   XygjbYBdtZhZgXcRQduaDa/mrHIVsozSdODqZmDTyVBGAcRRNHnHTCeud
   A=;
X-IronPort-AV: E=Sophos;i="5.17,705,1437451200"; 
   d="scan'208";a="117757561"
Received: from hq-x10prdhub2.ptcnet.ptc.com ([132.253.198.28])
  by mx1-int.ptc.com with ESMTP/TLS/AES128-SHA; 19 Oct 2015 22:24:43 -0400
Received: from awang.ptcnet.ptc.com (132.253.8.73) by
 int-mail-hub2.ptcnet.ptc.com (132.253.201.252) with Microsoft SMTP Server id
 14.3.123.3; Mon, 19 Oct 2015 22:24:42 -0400
Subject: Re: [users@httpd] Chunked transfer delay with httpd 2.4 on Windows.
To: <dev@httpd.apache.org>
References: <5625642E.30708@ptc.com>
 <CAKQ1sVPceAVuDMNgt-qGomU6EARQap5HpCbvaPPiwtYXsUvRpg@mail.gmail.com>
 <CALK=YjM5CvMgWAWT=X67JxBdaJDJ5PCFsHJijSEs0bKovFnQtQ@mail.gmail.com>
From: Andy Wang <awang@ptc.com>
Message-ID: <5625A5E7.2070309@ptc.com>
Date: Mon, 19 Oct 2015 21:24:39 -0500
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:38.0) Gecko/20100101
 Thunderbird/38.3.0
MIME-Version: 1.0
In-Reply-To: <CALK=YjM5CvMgWAWT=X67JxBdaJDJ5PCFsHJijSEs0bKovFnQtQ@mail.gmail.com>
Content-Type: text/plain; charset="utf-8"; format=flowed
Content-Transfer-Encoding: 7bit
X-Originating-IP: [132.253.8.73]



On 10/19/2015 07:44 PM, Eric Covener wrote:
> On Mon, Oct 19, 2015 at 7:05 PM, Yann Ylavic <ylavic.dev@gmail.com> wrote:
>> This is the deferred write triggering *after* the keepalive timeout,
>> whereas no subsequent request was pipelined.
>> I wonder if we shouldn't issue a flush at the end of each request when
>> the following is not already there, ie:
>
> Can you describe what breaks the current code? It looks like it's
> already trying to handle this case, I couldn't tell the operative
> difference.
>

I'm also curious why it is that I seem to only be able to reproduce it 
with a particular client.  i would have expected using ncat to simulate 
the exact same request would have been able to trigger the same behavior.

And why is this only occurring on windows?

From dev-return-84357-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Tue Oct 20 07:45:13 2015
Return-Path: <dev-return-84357-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id DB70518EE9
	for <apmail-httpd-dev-archive@www.apache.org>; Tue, 20 Oct 2015 07:45:13 +0000 (UTC)
Received: (qmail 51701 invoked by uid 500); 20 Oct 2015 07:45:13 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 51592 invoked by uid 500); 20 Oct 2015 07:45:13 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 51582 invoked by uid 99); 20 Oct 2015 07:45:13 -0000
Received: from Unknown (HELO spamd3-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 20 Oct 2015 07:45:13 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd3-us-west.apache.org (ASF Mail Server at spamd3-us-west.apache.org) with ESMTP id ACC76180A4C
	for <dev@httpd.apache.org>; Tue, 20 Oct 2015 07:45:12 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd3-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -1.302
X-Spam-Level:
X-Spam-Status: No, score=-1.302 tagged_above=-999 required=6.31
	tests=[KAM_LAZY_DOMAIN_SECURITY=1, RCVD_IN_DNSWL_MED=-2.3,
	RCVD_IN_MSPIKE_H2=-0.001, SPF_HELO_PASS=-0.001] autolearn=disabled
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd3-us-west.apache.org [10.40.0.10]) (amavisd-new, port 10024)
	with ESMTP id WcpqJxI-rhit for <dev@httpd.apache.org>;
	Tue, 20 Oct 2015 07:45:01 +0000 (UTC)
Received: from mail1.bemta14.messagelabs.com (mail1.bemta14.messagelabs.com [193.109.254.120])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id 0DDCB439B6
	for <dev@httpd.apache.org>; Tue, 20 Oct 2015 07:45:00 +0000 (UTC)
Received: from [193.109.254.3] by server-16.bemta-14.messagelabs.com id 31/54-05427-5F0F5265; Tue, 20 Oct 2015 07:44:53 +0000
X-Env-Sender: ruediger.pluem@vodafone.com
X-Msg-Ref: server-5.tower-184.messagelabs.com!1445327092!37648126!1
X-Originating-IP: [195.232.244.134]
X-StarScan-Received:
X-StarScan-Version: 6.13.16; banners=-,-,-
X-VirusChecked: Checked
Received: (qmail 28984 invoked from network); 20 Oct 2015 07:44:53 -0000
Received: from mailout02.vodafone.com (HELO mailout02.vodafone.com) (195.232.244.134)
  by server-5.tower-184.messagelabs.com with DHE-RSA-AES256-SHA encrypted SMTP; 20 Oct 2015 07:44:53 -0000
Received: from mailint04.vodafone.com (mailint04.vodafone.com [195.232.244.201])
	by mailout02.vodafone.com (Postfix) with ESMTP id 3ng6Rm6jWWzbdMY
	for <dev@httpd.apache.org>; Tue, 20 Oct 2015 09:44:52 +0200 (CEST)
Received: from mailint04.vodafone.com (localhost [127.0.0.1])
	by mailint04.vodafone.com (Postfix) with ESMTP id 3ng6Rm5hnYzfb2n
	for <dev@httpd.apache.org>; Tue, 20 Oct 2015 09:44:52 +0200 (CEST)
Received: from VOEXC03W.internal.vodafone.com (voexc03w.dc-ratingen.de [145.230.101.23])
	(using TLSv1 with cipher AES128-SHA (128/128 bits))
	(No client certificate requested)
	by mailint04.vodafone.com (Postfix) with ESMTPS id 3ng6Rm5d51zfZjl
	for <dev@httpd.apache.org>; Tue, 20 Oct 2015 09:44:52 +0200 (CEST)
Received: from VOEXC17W.internal.vodafone.com (145.230.101.19) by
 VOEXC03W.internal.vodafone.com (145.230.101.23) with Microsoft SMTP Server
 (TLS) id 14.3.224.2; Tue, 20 Oct 2015 09:44:52 +0200
Received: from VOEXM10W.internal.vodafone.com ([169.254.2.88]) by
 voexc17w.internal.vodafone.com ([145.230.101.19]) with mapi id
 14.03.0224.002; Tue, 20 Oct 2015 09:44:51 +0200
From: =?utf-8?B?UGzDvG0sIFLDvGRpZ2VyLCBWb2RhZm9uZSBHcm91cA==?=
	<ruediger.pluem@vodafone.com>
To: "dev@httpd.apache.org" <dev@httpd.apache.org>
Subject: RE: Forwarded buckets' lifetime (was: [Bug 58503] segfault in
 apr_brigade_cleanup()...)
Thread-Topic: Forwarded buckets' lifetime (was: [Bug 58503] segfault in
 apr_brigade_cleanup()...)
Thread-Index: AQHRCqzzgkBlOIRDuk6LHQAmJbhhNJ5z/zSA
Date: Tue, 20 Oct 2015 07:44:50 +0000
Message-ID: <AB1691BE05AE7F4992697F2A0835627AC6348972@VOEXM10W.internal.vodafone.com>
References: <CAKQ1sVNchFx=egp=Q0tgT+1GcBXiten8mh9STetcZXOfJxhsjQ@mail.gmail.com>
 <CAKQ1sVPjcA9EYNpjcmM9=AU_LCgAsFntOcZnmGoHymds3S5wmA@mail.gmail.com>
In-Reply-To: <CAKQ1sVPjcA9EYNpjcmM9=AU_LCgAsFntOcZnmGoHymds3S5wmA@mail.gmail.com>
Accept-Language: en-US
Content-Language: en-US
X-MS-Has-Attach:
X-MS-TNEF-Correlator:
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
MIME-Version: 1.0

DQoNCj4gLS0tLS1PcmlnaW5hbCBNZXNzYWdlLS0tLS0NCj4gRnJvbTogWWFubiBZbGF2aWMgW21h
aWx0bzp5bGF2aWMuZGV2QGdtYWlsLmNvbV0NCj4gU2VudDogTW9udGFnLCAxOS4gT2t0b2JlciAy
MDE1IDIyOjMwDQo+IFRvOiBkZXZAaHR0cGQuYXBhY2hlLm9yZw0KPiBTdWJqZWN0OiBGd2Q6IEZv
cndhcmRlZCBidWNrZXRzJyBsaWZldGltZSAod2FzOiBbQnVnIDU4NTAzXSBzZWdmYXVsdCBpbg0K
PiBhcHJfYnJpZ2FkZV9jbGVhbnVwKCkuLi4pDQo+IA0KPiBbTWVhbnQgZm9yIGRldkAuLi5dDQo+
IA0KPiBUaG91Z2h0cz8NCj4gDQo+ID4gaHR0cHM6Ly9iei5hcGFjaGUub3JnL2J1Z3ppbGxhL3No
b3dfYnVnLmNnaT9pZD01ODUwMw0KPiA+DQo+ID4gLS0tIENvbW1lbnQgIzggZnJvbSBZYW5uIFls
YXZpYyA8eWxhdmljLmRldkBnbWFpbC5jb20+IC0tLQ0KPiA+IChJbiByZXBseSB0byBSdWVkaWdl
ciBQbHVlbSBmcm9tIGNvbW1lbnQgIzcpDQo+ID4+IEFjdHVhbGx5IEkgdGhpbmsgbW9kX3Byb3h5
X3dzdHVubmVsIGZhbGxzIGludG8gdGhlIHNhbWUgcGl0ZmFsbA0KPiA+PiBtb2RfcHJveHlfaHR0
cCB3YXMgaW4gYW5kIGl0IG5lZWRzIHRvIGRvIHRoZSBzYW1lIC8gc29tZXRoaW5nIHNpbWlsYXIN
Cj4gdGhlbg0KPiA+PiBtb2RfcHJveHlfaHR0cC5jIHdpdGgNCj4gPj4NCj4gPj4gcHJveHlfYnVj
a2V0c19saWZldGltZV90cmFuc2Zvcm0NCj4gPg0KPiA+IFllcyBJIGFncmVlLCBqdXN0IHByb3Bv
c2VkIGEgcXVpY2sgcGF0Y2ggdG8gZGV0ZXJtaW5lIHdoZXRoZXIgaXQgY2FtZQ0KPiBmcm9tDQo+
ID4gbW9kX3Byb3h5X3dzdHVubmVsIG9yIHNvbWUgZmFpbHVyZSBpbiB0aGUgY29yZSBkZWZlcnJl
ZC9waXBlbGluZWQgd3JpdGUNCj4gPiBsb2dpYy4uLg0KPiA+DQo+ID4gV2UgbmVlZCB0byBlaXRo
ZXIgdXNlIGxpZmV0aW1lX3RyYW5zZm9ybSBsaWtlIGluIHByb3h5X2h0dHAsIG9yIEkgd2FzDQo+
IHRoaW5raW5nDQo+ID4gb2YgbW9kaWZ5aW5nIGFsbCB0aGUgaW5wdXQgZmlsdGVycyB0aGF0IGNy
ZWF0ZSB0aGVpciBidWNrZXRzIG9uIGYtPnIvYydzDQo+ID4gcG9vbC9idWNrZXRfYWxsb2Mgc28g
dGhhdCB0aGV5IG5vdyB1c2UgdGhlaXIgZ2l2ZW4gYmItPnAgYW5kIGJiLQ0KPiA+YnVja2V0X2Fs
bG9jLg0KDQpJIGRvbid0IHRoaW5rIHRoYXQgdGhpcyBpcyBhIGdvb2QgaWRlYSwgYmVjYXVzZSBi
dWNrZXQgYnJpZ2FkZXMgc29tZXRpbWVzIGhhdmUgYSBsb25nZXIgbGlmZXRpbWUNCnRoZW4gdGhl
IGJ1Y2tldHMgdGhhdCBhcmUgY3JlYXRlZCByaWdodCBub3cgd2l0aCBmLT5yL2Mnc3Bvb2wvYnVj
a2V0X2FsbG9jLiBUaGV5IGdldCBjcmVhdGVkIGFuZCBhcmUga2VwdA0KYW5kIG9ubHkgZ2V0IGNs
ZWFyZWQgdG8gYXZvaWQgY3JlYXRpbmcgdGhlbSBvdmVyIGFuZCBvdmVyIGFnYWluLiBTbyB0aGlz
IHN0ZXAgY2FuIG9wZW4gdXAgYSBiaWcNCmNhbiBvZiB3b3Jtcy4gRnVydGhlcm1vcmUgaXQgaXMg
YW4gQVBJIGNoYW5nZSwgYmVjYXVzZSBjdXJyZW50bHkgdGhlIGNhbGxlciBleHBlY3RzIHRoZSBi
dWNrZXRzDQphcmUgY3JlYXRlZCB3aXRoIGYtPnIvYydzcG9vbC9idWNrZXRfYWxsb2MgdW5kIHlv
dSBjYW5ub3QgY2hhbmdlIHRoYXQgZXhwZWN0YXRpb24gZm9yIDNyZCBwYXJ0eSBtb2R1bGVzLg0K
DQpTbyBpZiBhdCBhbGwgYSBjaGFuZ2UgZm9yIHRydW5rIG9ubHkgdGhhdCByZXF1aXJlcyBhIHZl
cnkgZGVlcCByZXZpZXcgb2YgYWxsIGJyaWdhZGUgdXNhZ2VzLg0KDQoNClJlZ2FyZHMNCg0KUsO8
ZGlnZXINCg==

From dev-return-84358-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Tue Oct 20 08:01:39 2015
Return-Path: <dev-return-84358-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id ECAA018FC5
	for <apmail-httpd-dev-archive@www.apache.org>; Tue, 20 Oct 2015 08:01:39 +0000 (UTC)
Received: (qmail 88586 invoked by uid 500); 20 Oct 2015 08:01:39 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 88504 invoked by uid 500); 20 Oct 2015 08:01:39 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 88494 invoked by uid 99); 20 Oct 2015 08:01:39 -0000
Received: from Unknown (HELO spamd1-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 20 Oct 2015 08:01:39 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd1-us-west.apache.org (ASF Mail Server at spamd1-us-west.apache.org) with ESMTP id F1C09C80D2
	for <dev@httpd.apache.org>; Tue, 20 Oct 2015 08:01:38 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd1-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.1
X-Spam-Level:
X-Spam-Status: No, score=-0.1 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	SPF_PASS=-0.001, URIBL_BLOCKED=0.001] autolearn=disabled
Authentication-Results: spamd1-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd1-us-west.apache.org [10.40.0.7]) (amavisd-new, port 10024)
	with ESMTP id 6ETi4nlW8xMF for <dev@httpd.apache.org>;
	Tue, 20 Oct 2015 08:01:30 +0000 (UTC)
Received: from mail-qk0-f173.google.com (mail-qk0-f173.google.com [209.85.220.173])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id 4C20C28FC4
	for <dev@httpd.apache.org>; Tue, 20 Oct 2015 08:01:29 +0000 (UTC)
Received: by qkcy65 with SMTP id y65so3987826qkc.0
        for <dev@httpd.apache.org>; Tue, 20 Oct 2015 01:01:28 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        bh=Ht1Eq8hfQ/GE68pweWDCC14tGkovC5kvfeNsom4HCZA=;
        b=Q26UzU4lzhl7Lu8Vqe8Gd9b/vLh7+9hBry+C5VBeS7mwQhhv8WibSoZtpZ7Nb75Gvx
         mm1tLa1fXImTYhcDt9+UJpInWuU/vxl0f9P7UjYdr1idm/2tdfdPHAI05Fx49t9IoIA5
         qqf6l7TyLZpdUbafRFXYGYMUEmleqC56w8dbNo59biiInVIcEbVXksG5robd+A5nPmm1
         UOX95f/0xUDPbZi+0hQjNxG47hBX25E6GzOmprOYswUtqklAh8GJ8wnVMcLaJt9QE/sF
         KvLwgpZcV4AnxIvKWtzG8p2YTWglsreKuuUyHRSnKKdQvj4lGQswAi5vHfcAToesB+2S
         5Uqw==
MIME-Version: 1.0
X-Received: by 10.55.56.130 with SMTP id f124mr1954368qka.79.1445328088188;
 Tue, 20 Oct 2015 01:01:28 -0700 (PDT)
Received: by 10.55.156.213 with HTTP; Tue, 20 Oct 2015 01:01:28 -0700 (PDT)
In-Reply-To: <5625A5E7.2070309@ptc.com>
References: <5625642E.30708@ptc.com>
	<CAKQ1sVPceAVuDMNgt-qGomU6EARQap5HpCbvaPPiwtYXsUvRpg@mail.gmail.com>
	<CALK=YjM5CvMgWAWT=X67JxBdaJDJ5PCFsHJijSEs0bKovFnQtQ@mail.gmail.com>
	<5625A5E7.2070309@ptc.com>
Date: Tue, 20 Oct 2015 10:01:28 +0200
Message-ID: <CAKQ1sVPRX_st3SWAnF30C62qxTNqjHiSV3iaCHFPr1HLGp_CxA@mail.gmail.com>
Subject: Re: [users@httpd] Chunked transfer delay with httpd 2.4 on Windows.
From: Yann Ylavic <ylavic.dev@gmail.com>
To: dev@httpd.apache.org
Content-Type: text/plain; charset=UTF-8

On Tue, Oct 20, 2015 at 4:24 AM, Andy Wang <awang@ptc.com> wrote:
>
>
> On 10/19/2015 07:44 PM, Eric Covener wrote:
>>
>> On Mon, Oct 19, 2015 at 7:05 PM, Yann Ylavic <ylavic.dev@gmail.com> wrote:
>>>
>>> This is the deferred write triggering *after* the keepalive timeout,
>>> whereas no subsequent request was pipelined.
>>> I wonder if we shouldn't issue a flush at the end of each request when
>>> the following is not already there, ie:
>>
>>
>> Can you describe what breaks the current code? It looks like it's
>> already trying to handle this case, I couldn't tell the operative
>> difference.
>>
>
> I'm also curious why it is that I seem to only be able to reproduce it with
> a particular client.  i would have expected using ncat to simulate the exact
> same request would have been able to trigger the same behavior.
>
> And why is this only occurring on windows?

Yes, a complete misinterpretation on my side!
The issue must be somewhere in mod_deflate (EOS handling?), since the
flush done at connection level is of no help for the request filters.
Will look at this...

From dev-return-84359-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Tue Oct 20 08:08:38 2015
Return-Path: <dev-return-84359-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id D50571000A
	for <apmail-httpd-dev-archive@www.apache.org>; Tue, 20 Oct 2015 08:08:38 +0000 (UTC)
Received: (qmail 3045 invoked by uid 500); 20 Oct 2015 08:08:35 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 2968 invoked by uid 500); 20 Oct 2015 08:08:35 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 2955 invoked by uid 99); 20 Oct 2015 08:08:35 -0000
Received: from Unknown (HELO spamd1-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 20 Oct 2015 08:08:35 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd1-us-west.apache.org (ASF Mail Server at spamd1-us-west.apache.org) with ESMTP id D2534C5AD4
	for <dev@httpd.apache.org>; Tue, 20 Oct 2015 08:08:34 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd1-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 1
X-Spam-Level: *
X-Spam-Status: No, score=1 tagged_above=-999 required=6.31
	tests=[KAM_LAZY_DOMAIN_SECURITY=1, SPF_HELO_PASS=-0.001,
	URIBL_BLOCKED=0.001] autolearn=disabled
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd1-us-west.apache.org [10.40.0.7]) (amavisd-new, port 10024)
	with ESMTP id BACGpxOuweNx for <dev@httpd.apache.org>;
	Tue, 20 Oct 2015 08:08:22 +0000 (UTC)
Received: from mail1.bemta14.messagelabs.com (mail1.bemta14.messagelabs.com [193.109.254.109])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id 31AA920594
	for <dev@httpd.apache.org>; Tue, 20 Oct 2015 08:08:22 +0000 (UTC)
Received: from [193.109.254.3] by server-5.bemta-14.messagelabs.com id 62/5E-00475-076F5265; Tue, 20 Oct 2015 08:08:16 +0000
X-Env-Sender: ruediger.pluem@vodafone.com
X-Msg-Ref: server-13.tower-184.messagelabs.com!1445328495!37680606!1
X-Originating-IP: [195.232.244.133]
X-StarScan-Received:
X-StarScan-Version: 6.13.16; banners=-,-,-
X-VirusChecked: Checked
Received: (qmail 22903 invoked from network); 20 Oct 2015 08:08:16 -0000
Received: from mailout01.vodafone.com (HELO mailout01.vodafone.com) (195.232.244.133)
  by server-13.tower-184.messagelabs.com with DHE-RSA-AES256-SHA encrypted SMTP; 20 Oct 2015 08:08:16 -0000
Received: from mailint03.vodafone.com (mailint03.vodafone.com [195.232.244.200])
	by mailout01.vodafone.com (Postfix) with ESMTP id 3ng6yl67gHz1yHk
	for <dev@httpd.apache.org>; Tue, 20 Oct 2015 10:08:15 +0200 (CEST)
Received: from mailint03.vodafone.com (localhost [127.0.0.1])
	by mailint03.vodafone.com (Postfix) with ESMTP id 3ng6yl4v3wz16LQS
	for <dev@httpd.apache.org>; Tue, 20 Oct 2015 10:08:15 +0200 (CEST)
Received: from VOEXC04W.internal.vodafone.com (voexc04w.dc-ratingen.de [145.230.101.24])
	(using TLSv1 with cipher AES128-SHA (128/128 bits))
	(No client certificate requested)
	by mailint03.vodafone.com (Postfix) with ESMTPS id 3ng6yl4nXZz16LPC
	for <dev@httpd.apache.org>; Tue, 20 Oct 2015 10:08:15 +0200 (CEST)
Received: from VOEXM10W.internal.vodafone.com ([169.254.2.88]) by
 VOEXC04W.internal.vodafone.com ([145.230.101.24]) with mapi id
 14.03.0224.002; Tue, 20 Oct 2015 10:08:14 +0200
From: =?utf-8?B?UGzDvG0sIFLDvGRpZ2VyLCBWb2RhZm9uZSBHcm91cA==?=
	<ruediger.pluem@vodafone.com>
To: "dev@httpd.apache.org" <dev@httpd.apache.org>
Subject: RE: [users@httpd] Chunked transfer delay with httpd 2.4 on Windows.
Thread-Topic: [users@httpd] Chunked transfer delay with httpd 2.4 on Windows.
Thread-Index: AQHRCsKp6VHmLQpuNE+WM3OmAfdh+J50BOAQ
Date: Tue, 20 Oct 2015 08:08:14 +0000
Message-ID: <AB1691BE05AE7F4992697F2A0835627AC63489BF@VOEXM10W.internal.vodafone.com>
References: <5625642E.30708@ptc.com>
 <CAKQ1sVPceAVuDMNgt-qGomU6EARQap5HpCbvaPPiwtYXsUvRpg@mail.gmail.com>
In-Reply-To: <CAKQ1sVPceAVuDMNgt-qGomU6EARQap5HpCbvaPPiwtYXsUvRpg@mail.gmail.com>
Accept-Language: en-US
Content-Language: en-US
X-MS-Has-Attach:
X-MS-TNEF-Correlator:
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
MIME-Version: 1.0

DQoNCj4gLS0tLS1PcmlnaW5hbCBNZXNzYWdlLS0tLS0NCj4gRnJvbTogWWFubiBZbGF2aWMgW21h
aWx0bzp5bGF2aWMuZGV2QGdtYWlsLmNvbV0NCj4gU2VudDogRGllbnN0YWcsIDIwLiBPa3RvYmVy
IDIwMTUgMDE6MDUNCj4gVG86IGRldkBodHRwZC5hcGFjaGUub3JnDQo+IFN1YmplY3Q6IFJlOiBb
dXNlcnNAaHR0cGRdIENodW5rZWQgdHJhbnNmZXIgZGVsYXkgd2l0aCBodHRwZCAyLjQgb24NCj4g
V2luZG93cy4NCj4gDQo+IFtGcm9tIHVzZXJzQF0NCj4gDQo+IE9uIE1vbiwgT2N0IDE5LCAyMDE1
IGF0IDExOjQ0IFBNLCBBbmR5IFdhbmcgPGF3YW5nQHB0Yy5jb20+IHdyb3RlOg0KPiA+DQo+ID4g
VGhlIGlzc3VlIGlzIGN1cnJlbnRseSByZXByb2R1Y2VkIHVzaW5nIEFwYWNoZSBodHRwZCAyLjQu
MTYsIG1vZF9qaw0KPiAxLjIuNDENCj4gPiBhbmQgdG9tY2F0IDguMC4yOC4NCj4gPg0KPiA+IEkn
dmUgY3JlYXRlZCBhIHZlcnkgdmVyeSBzaW1wbGUgSlNQIHBhZ2UgdGhhdCBkb2VzIG5vdGhpbmcg
YnV0IHByaW50IGENCj4gc21hbGwNCj4gPiBzdHJpbmcsIGJ1dCBJJ3ZlIHRyaWVkIGNoYW5naW5n
IHRoZSBqc3AgcGFnZSB0byBwcmludCBhIHZlcnkgdmVyeSBsYXJnZQ0KPiA+IHN0cmluZyAoMTAw
MDArIGNoYXJhY3RlcnMpIGFuZCBubyBkaWZmZXJlbmNlLg0KPiA+DQo+ID4gSWYgSSBQT1NUIHRv
IHRoaXMgSlNQIHBhZ2UsIGFuZCBzb21ldGhpbmcgbGlrZSBtb2RfZGVmbGF0ZSBpcyBpbiBwbGFj
ZQ0KPiB0bw0KPiA+IGZvcmNlIGEgY2h1bmtlZCB0cmFuc2ZlciB0aGUgVENQIHBhY2tldCBjYXB0
dXJlIGxvb2tzIGxpa2UgdGhpczoNCj4gPg0KPiA+IE5vLiAgICAgVGltZSAgICAgICAgICAgU291
cmNlICBEZXN0aW5hdGlvbiAgIFByb3RvY29sIExlbmd0aCBJbmZvDQo+ID4gICAgMTg1MCA0ODI3
Ljc2MjcyMTAwMCBjbGllbnQgIHNlcnZlciAgICAgICAgVENQICAgICAgNjYgICAgIDU0MTMx4oaS
MjI4MA0KPiA+IFtTWU5dIFNlcT0wIFdpbj04MTkyIExlbj0wIE1TUz0xNDYwIFdTPTI1NiBTQUNL
X1BFUk09MQ0KPiA+ICAgIDE4NTEgNDgyNy43NjQ5NzYwMDAgc2VydmVyICBjbGllbnQgICAgICAg
IFRDUCAgICAgIDY2ICAgICAyMjgw4oaSNTQxMzENCj4gPiBbU1lOLCBBQ0tdIFNlcT0wIEFjaz0x
IFdpbj04MTkyIExlbj0wIE1TUz0xNDYwIFdTPTI1NiBTQUNLX1BFUk09MQ0KPiA+ICAgIDE4NTIg
NDgyNy43NjUwNTMwMDAgY2xpZW50ICBzZXJ2ZXIgICAgICAgIFRDUCAgICAgIDU0ICAgICA1NDEz
MeKGkjIyODANCj4gPiBbQUNLXSBTZXE9MSBBY2s9MSBXaW49MTMxMzI4IExlbj0wDQo+ID4gICAg
MTg1MyA0ODI3Ljc2NTMxNTAwMCBjbGllbnQgIHNlcnZlciAgICAgICAgSFRUUCAgICAgNzkxICAg
IFBPU1QNCj4gPiAvSlNQdG9Qb3N0VG8gSFRUUC8xLjENCj4gPiAgICAxODU0IDQ4MjcuNzc3OTgx
MDAwIHNlcnZlciAgY2xpZW50ICAgICAgICBUQ1AgICAgICA0NjYgICAgW1RDUA0KPiBzZWdtZW50
IG9mDQo+ID4gYSByZWFzc2VtYmxlZCBQRFVdDQo+ID4gICAgMTg1NSA0ODI3Ljk4Mjk2MTAwMCBj
bGllbnQgIHNlcnZlciAgICAgICAgVENQICAgICAgNTQgICAgIDU0MTMx4oaSMjI4MA0KPiA+IFtB
Q0tdIFNlcT03MzggQWNrPTQxMyBXaW49MTMwODE2IExlbj0wDQo+ID4gICAgMTg1NiA0ODMyLjc3
MDQ1ODAwMCBzZXJ2ZXIgIGNsaWVudCAgICAgICAgSFRUUCAgICAgNzQgICAgIEhUVFAvMS4xDQo+
IDIwMCBPSw0KPiA+ICh0ZXh0L2h0bWwpDQo+ID4gICAgMTg1NyA0ODMyLjc3MDQ1OTAwMCBzZXJ2
ZXIgIGNsaWVudCAgICAgICAgVENQICAgICAgNjAgICAgIDIyODDihpI1NDEzMQ0KPiA+IFtGSU4s
IEFDS10gU2VxPTQzMyBBY2s9NzM4IFdpbj02NTUzNiBMZW49MA0KPiA+ICAgIDE4NTggNDgzMi43
NzA1NTUwMDAgY2xpZW50ICBzZXJ2ZXIgICAgICAgIFRDUCAgICAgIDU0ICAgICA1NDEzMeKGkjIy
ODANCj4gPiBbQUNLXSBTZXE9NzM4IEFjaz00MzQgV2luPTEzMDgxNiBMZW49MA0KPiA+ICAgIDE4
NTkgNDgzMi43NzA5MDQwMDAgY2xpZW50ICBzZXJ2ZXIgICAgICAgIFRDUCAgICAgIDU0ICAgICA1
NDEzMeKGkjIyODANCj4gPiBbRklOLCBBQ0tdIFNlcT03MzggQWNrPTQzNCBXaW49MTMwODE2IExl
bj0wDQo+ID4gICAgMTg2MCA0ODMyLjc3NDIwMDAwMCBzZXJ2ZXIgIGNsaWVudCAgICAgICAgVENQ
ICAgICAgNjAgICAgIDIyODDihpI1NDEzMQ0KPiA+IFtBQ0tdIFNlcT00MzQgQWNrPTczOSBXaW49
NjU1MzYgTGVuPTANCj4gPg0KPiA+IFNwZGZpY2lhbGx5LCBub3RlIHRoZSA1IHNlY29uZCBkZWxh
eSBiZXR3ZWVuIHRoZSBmaXJzdCBzZWdtZW50IChOby4NCj4gMTg1NCkNCj4gPiBhbmQgdGhlIHNl
Y29uZCBkYXRhIHNlZ21lbnQgKDE4NTYpLg0KPiANCj4gVGhpcyBpcyB0aGUgZGVmZXJyZWQgd3Jp
dGUgdHJpZ2dlcmluZyAqYWZ0ZXIqIHRoZSBrZWVwYWxpdmUgdGltZW91dCwNCj4gd2hlcmVhcyBu
byBzdWJzZXF1ZW50IHJlcXVlc3Qgd2FzIHBpcGVsaW5lZC4NCj4gSSB3b25kZXIgaWYgd2Ugc2hv
dWxkbid0IGlzc3VlIGEgZmx1c2ggYXQgdGhlIGVuZCBvZiBlYWNoIHJlcXVlc3Qgd2hlbg0KPiB0
aGUgZm9sbG93aW5nIGlzIG5vdCBhbHJlYWR5IHRoZXJlLCBpZToNCj4gDQo+IEluZGV4OiBtb2R1
bGVzL2h0dHAvaHR0cF9yZXF1ZXN0LmMNCj4gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQ0KPiAtLS0gbW9kdWxlcy9odHRw
L2h0dHBfcmVxdWVzdC5jICAgIChyZXZpc2lvbiAxNzA4MDk1KQ0KPiArKysgbW9kdWxlcy9odHRw
L2h0dHBfcmVxdWVzdC5jICAgICh3b3JraW5nIGNvcHkpDQo+IEBAIC0yMjgsOCArMjI4LDkgQEAg
QVBfREVDTEFSRSh2b2lkKSBhcF9kaWUoaW50IHR5cGUsIHJlcXVlc3RfcmVjICpyKQ0KPiAgICAg
IGFwX2RpZV9yKHR5cGUsIHIsIHItPnN0YXR1cyk7DQo+ICB9DQo+IA0KPiAtc3RhdGljIHZvaWQg
Y2hlY2tfcGlwZWxpbmUoY29ubl9yZWMgKmMsIGFwcl9idWNrZXRfYnJpZ2FkZSAqYmIpDQo+ICtz
dGF0aWMgaW50IGNoZWNrX3BpcGVsaW5lKGNvbm5fcmVjICpjLCBhcHJfYnVja2V0X2JyaWdhZGUg
KmJiKQ0KDQpXaHkgY2hhbmdpbmcgdGhlIHByb3RvdHlwZT8gV2UgY291bGQgY2hlY2sgZm9yIGMt
PmRhdGFfaW5faW5wdXRfZmlsdGVycyBpbnN0ZWFkLg0KDQo+ICB7DQo+ICsgICAgYy0+ZGF0YV9p
bl9pbnB1dF9maWx0ZXJzID0gMDsNCj4gICAgICBpZiAoYy0+a2VlcGFsaXZlICE9IEFQX0NPTk5f
Q0xPU0UgJiYgIWMtPmFib3J0ZWQpIHsNCj4gICAgICAgICAgYXByX3N0YXR1c190IHJ2Ow0KPiAN
Cj4gQEAgLTIzNiwxNyArMjM3LDEyIEBAIEFQX0RFQ0xBUkUodm9pZCkgYXBfZGllKGludCB0eXBl
LCByZXF1ZXN0X3JlYyAqcikNCj4gICAgICAgICAgQVBfREVCVUdfQVNTRVJUKEFQUl9CUklHQURF
X0VNUFRZKGJiKSk7DQo+ICAgICAgICAgIHJ2ID0gYXBfZ2V0X2JyaWdhZGUoYy0+aW5wdXRfZmls
dGVycywgYmIsIEFQX01PREVfU1BFQ1VMQVRJVkUsDQo+ICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgQVBSX05PTkJMT0NLX1JFQUQsIDEpOw0KPiAtICAgICAgICBpZiAocnYgIT0gQVBSX1NV
Q0NFU1MgfHwgQVBSX0JSSUdBREVfRU1QVFkoYmIpKSB7DQo+IC0gICAgICAgICAgICAvKg0KPiAt
ICAgICAgICAgICAgICogRXJyb3Igb3IgZW1wdHkgYnJpZ2FkZTogVGhlcmUgaXMgbm8gZGF0YSBw
cmVzZW50IGluIHRoZQ0KPiBpbnB1dA0KPiAtICAgICAgICAgICAgICogZmlsdGVyDQo+IC0gICAg
ICAgICAgICAgKi8NCj4gLSAgICAgICAgICAgIGMtPmRhdGFfaW5faW5wdXRfZmlsdGVycyA9IDA7
DQo+IC0gICAgICAgIH0NCj4gLSAgICAgICAgZWxzZSB7DQo+ICsgICAgICAgIGlmIChydiA9PSBB
UFJfU1VDQ0VTUyAmJiAhQVBSX0JSSUdBREVfRU1QVFkoYmIpKSB7DQo+ICAgICAgICAgICAgICBj
LT5kYXRhX2luX2lucHV0X2ZpbHRlcnMgPSAxOw0KPiArICAgICAgICAgICAgcmV0dXJuIDE7DQo+
ICAgICAgICAgIH0NCj4gICAgICB9DQo+ICsgICAgcmV0dXJuIDA7DQo+ICB9DQo+IA0KPiANCj4g
QEAgLTI4NywxMSArMjgzLDMwIEBAIEFQX0RFQ0xBUkUodm9pZCkgYXBfcHJvY2Vzc19yZXF1ZXN0
X2FmdGVyX2hhbmRsZXIoDQo+ICAgICAgICogYWxyZWFkeSBieSB0aGUgRU9SIGJ1Y2tldCdzIGNs
ZWFudXAgZnVuY3Rpb24uDQo+ICAgICAgICovDQo+IA0KPiAtICAgIGNoZWNrX3BpcGVsaW5lKGMs
IGJiKTsNCj4gKyAgICBpZiAoIWNoZWNrX3BpcGVsaW5lKGMsIGJiKSkgew0KPiArICAgICAgICBh
cHJfc3RhdHVzX3QgcnY7DQo+ICsNCj4gKyAgICAgICAgYiA9IGFwcl9idWNrZXRfZmx1c2hfY3Jl
YXRlKGMtPmJ1Y2tldF9hbGxvYyk7DQo+ICsgICAgICAgIEFQUl9CUklHQURFX0lOU0VSVF9IRUFE
KGJiLCBiKTsNCj4gKyAgICAgICAgcnYgPSBhcF9wYXNzX2JyaWdhZGUoYy0+b3V0cHV0X2ZpbHRl
cnMsIGJiKTsNCj4gKyAgICAgICAgaWYgKEFQUl9TVEFUVVNfSVNfVElNRVVQKHJ2KSkgew0KPiAr
ICAgICAgICAgICAgLyoNCj4gKyAgICAgICAgICAgICAqIE5vdGljZSBhIHRpbWVvdXQgYXMgYW4g
ZXJyb3IgbWVzc2FnZS4gVGhpcyBtaWdodCBiZQ0KPiArICAgICAgICAgICAgICogdmFsdWFibGUg
Zm9yIGRldGVjdGluZyBjbGllbnRzIHdpdGggYnJva2VuIG5ldHdvcmsNCj4gKyAgICAgICAgICAg
ICAqIGNvbm5lY3Rpb25zIG9yIHBvc3NpYmxlIERvUyBhdHRhY2tzLg0KPiArICAgICAgICAgICAg
ICoNCj4gKyAgICAgICAgICAgICAqIEl0IGlzIHN0aWxsIHNhZmUgdG8gdXNlIHIgLyByLT5wb29s
IGhlcmUgYXMgdGhlIGVvciBidWNrZXQNCj4gKyAgICAgICAgICAgICAqIGNvdWxkIG5vdCBoYXZl
IGJlZW4gZGVzdHJveWVkIGluIHRoZSBldmVudCBvZiBhIHRpbWVvdXQuDQo+ICsgICAgICAgICAg
ICAgKi8NCj4gKyAgICAgICAgICAgIGFwX2xvZ19jZXJyb3IoQVBMT0dfTUFSSywgQVBMT0dfSU5G
TywgcnYsIGMsIEFQTE9HTk8oMDE1ODEpDQo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICJU
aW1lb3V0IHdoaWxlIGZsdXNoaW5nIGRhdGEgdG8gdGhlIGNsaWVudCIpOw0KPiArICAgICAgICB9
DQo+ICsgICAgfQ0KPiAgICAgIGFwcl9icmlnYWRlX2Rlc3Ryb3koYmIpOw0KPiAtICAgIGlmIChj
LT5jcykNCj4gKyAgICBpZiAoYy0+Y3MpIHsNCj4gICAgICAgICAgYy0+Y3MtPnN0YXRlID0gKGMt
PmFib3J0ZWQpID8gQ09OTl9TVEFURV9MSU5HRVINCj4gICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIDogQ09OTl9TVEFURV9XUklURV9DT01QTEVUSU9OOw0KDQpJZiB3ZSBoYXZl
IGRvbmUgYSBmbHVzaCBhYm92ZSB3ZSBhcmUgSU1ITyBubyBsb25nZXIgaW4gQ09OTl9TVEFURV9X
UklURV9DT01QTEVUSU9OLg0KDQo+ICsgICAgfQ0KPiAgICAgIEFQX1BST0NFU1NfUkVRVUVTVF9S
RVRVUk4oKHVpbnRwdHJfdClyLCByLT51cmksIHItPnN0YXR1cyk7DQo+ICAgICAgaWYgKGFwX2V4
dGVuZGVkX3N0YXR1cykgew0KPiAgICAgICAgICBhcF90aW1lX3Byb2Nlc3NfcmVxdWVzdChjLT5z
YmgsIFNUT1BfUFJFUVVFU1QpOw0KPiBAQCAtMzczLDMzICszODgsMTAgQEAgdm9pZCBhcF9wcm9j
ZXNzX2FzeW5jX3JlcXVlc3QocmVxdWVzdF9yZWMgKnIpDQo+IA0KPiAgQVBfREVDTEFSRSh2b2lk
KSBhcF9wcm9jZXNzX3JlcXVlc3QocmVxdWVzdF9yZWMgKnIpDQo+ICB7DQo+IC0gICAgYXByX2J1
Y2tldF9icmlnYWRlICpiYjsNCj4gLSAgICBhcHJfYnVja2V0ICpiOw0KPiAtICAgIGNvbm5fcmVj
ICpjID0gci0+Y29ubmVjdGlvbjsNCj4gLSAgICBhcHJfc3RhdHVzX3QgcnY7DQo+IC0NCj4gICAg
ICBhcF9wcm9jZXNzX2FzeW5jX3JlcXVlc3Qocik7DQo+IA0KPiAtICAgIGlmICghYy0+ZGF0YV9p
bl9pbnB1dF9maWx0ZXJzKSB7DQo+IC0gICAgICAgIGJiID0gYXByX2JyaWdhZGVfY3JlYXRlKGMt
PnBvb2wsIGMtPmJ1Y2tldF9hbGxvYyk7DQo+IC0gICAgICAgIGIgPSBhcHJfYnVja2V0X2ZsdXNo
X2NyZWF0ZShjLT5idWNrZXRfYWxsb2MpOw0KPiAtICAgICAgICBBUFJfQlJJR0FERV9JTlNFUlRf
SEVBRChiYiwgYik7DQo+IC0gICAgICAgIHJ2ID0gYXBfcGFzc19icmlnYWRlKGMtPm91dHB1dF9m
aWx0ZXJzLCBiYik7DQo+IC0gICAgICAgIGlmIChBUFJfU1RBVFVTX0lTX1RJTUVVUChydikpIHsN
Cj4gLSAgICAgICAgICAgIC8qDQo+IC0gICAgICAgICAgICAgKiBOb3RpY2UgYSB0aW1lb3V0IGFz
IGFuIGVycm9yIG1lc3NhZ2UuIFRoaXMgbWlnaHQgYmUNCj4gLSAgICAgICAgICAgICAqIHZhbHVh
YmxlIGZvciBkZXRlY3RpbmcgY2xpZW50cyB3aXRoIGJyb2tlbiBuZXR3b3JrDQo+IC0gICAgICAg
ICAgICAgKiBjb25uZWN0aW9ucyBvciBwb3NzaWJsZSBEb1MgYXR0YWNrcy4NCj4gLSAgICAgICAg
ICAgICAqDQo+IC0gICAgICAgICAgICAgKiBJdCBpcyBzdGlsbCBzYWZlIHRvIHVzZSByIC8gci0+
cG9vbCBoZXJlIGFzIHRoZSBlb3IgYnVja2V0DQo+IC0gICAgICAgICAgICAgKiBjb3VsZCBub3Qg
aGF2ZSBiZWVuIGRlc3Ryb3llZCBpbiB0aGUgZXZlbnQgb2YgYSB0aW1lb3V0Lg0KPiAtICAgICAg
ICAgICAgICovDQo+IC0gICAgICAgICAgICBhcF9sb2dfcmVycm9yKEFQTE9HX01BUkssIEFQTE9H
X0lORk8sIHJ2LCByLCBBUExPR05PKDAxNTgxKQ0KPiAtICAgICAgICAgICAgICAgICAgICAgICAg
ICAiVGltZW91dCB3aGlsZSB3cml0aW5nIGRhdGEgZm9yIFVSSSAlcyB0byB0aGUiDQo+IC0gICAg
ICAgICAgICAgICAgICAgICAgICAgICIgY2xpZW50Iiwgci0+dW5wYXJzZWRfdXJpKTsNCj4gLSAg
ICAgICAgfQ0KPiAtICAgIH0NCj4gICAgICBpZiAoYXBfZXh0ZW5kZWRfc3RhdHVzKSB7DQo+ICsg
ICAgICAgIGNvbm5fcmVjICpjID0gci0+Y29ubmVjdGlvbjsNCg0KciBpcyBsaWtlbHkgdG8gYmUg
ZGVhZCBoZXJlDQoNCmNvbm5fcmVjICpjID0gci0+Y29ubmVjdGlvbg0KDQpuZWVkcyB0byBzdGF5
IG9uIHRvcC4NCg0KDQpSZWdhcmRzDQoNClLDvGRpZ2VyDQoNCg==

From dev-return-84360-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Tue Oct 20 08:16:19 2015
Return-Path: <dev-return-84360-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id BFF1410058
	for <apmail-httpd-dev-archive@www.apache.org>; Tue, 20 Oct 2015 08:16:19 +0000 (UTC)
Received: (qmail 15223 invoked by uid 500); 20 Oct 2015 08:16:19 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 15136 invoked by uid 500); 20 Oct 2015 08:16:18 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 15125 invoked by uid 99); 20 Oct 2015 08:16:18 -0000
Received: from Unknown (HELO spamd1-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 20 Oct 2015 08:16:18 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd1-us-west.apache.org (ASF Mail Server at spamd1-us-west.apache.org) with ESMTP id 6FF54C2CB9
	for <dev@httpd.apache.org>; Tue, 20 Oct 2015 08:16:18 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd1-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 1
X-Spam-Level: *
X-Spam-Status: No, score=1 tagged_above=-999 required=6.31
	tests=[KAM_LAZY_DOMAIN_SECURITY=1, SPF_HELO_PASS=-0.001,
	URIBL_BLOCKED=0.001] autolearn=disabled
Received: from mx1-us-west.apache.org ([10.40.0.8])
	by localhost (spamd1-us-west.apache.org [10.40.0.7]) (amavisd-new, port 10024)
	with ESMTP id 79jaOIi2uCrQ for <dev@httpd.apache.org>;
	Tue, 20 Oct 2015 08:16:06 +0000 (UTC)
Received: from mail1.bemta3.messagelabs.com (mail1.bemta3.messagelabs.com [195.245.230.165])
	by mx1-us-west.apache.org (ASF Mail Server at mx1-us-west.apache.org) with ESMTPS id 9DF522078F
	for <dev@httpd.apache.org>; Tue, 20 Oct 2015 08:16:05 +0000 (UTC)
Received: from [195.245.230.51] by server-5.bemta-3.messagelabs.com id C9/88-01748-C38F5265; Tue, 20 Oct 2015 08:15:56 +0000
X-Env-Sender: ruediger.pluem@vodafone.com
X-Msg-Ref: server-12.tower-33.messagelabs.com!1445328955!30373794!1
X-Originating-IP: [195.232.244.134]
X-StarScan-Received:
X-StarScan-Version: 6.13.16; banners=-,-,-
X-VirusChecked: Checked
Received: (qmail 5774 invoked from network); 20 Oct 2015 08:15:55 -0000
Received: from mailout02.vodafone.com (HELO mailout02.vodafone.com) (195.232.244.134)
  by server-12.tower-33.messagelabs.com with DHE-RSA-AES256-SHA encrypted SMTP; 20 Oct 2015 08:15:55 -0000
Received: from mailint04.vodafone.com (mailint04.vodafone.com [195.232.244.201])
	by mailout02.vodafone.com (Postfix) with ESMTP id 3ng77Y46ZQzbdPX
	for <dev@httpd.apache.org>; Tue, 20 Oct 2015 10:15:53 +0200 (CEST)
Received: from mailint04.vodafone.com (localhost [127.0.0.1])
	by mailint04.vodafone.com (Postfix) with ESMTP id 3ng75b3yk1zfbqm
	for <dev@httpd.apache.org>; Tue, 20 Oct 2015 10:14:11 +0200 (CEST)
Received: from VOEXC05W.internal.vodafone.com (mail5.nl.mx.vodafone.com [145.230.101.25])
	(using TLSv1 with cipher AES128-SHA (128/128 bits))
	(No client certificate requested)
	by mailint04.vodafone.com (Postfix) with ESMTPS id 3ng75b3v0Qzfdhs
	for <dev@httpd.apache.org>; Tue, 20 Oct 2015 10:14:11 +0200 (CEST)
Received: from VOEXC22W.internal.vodafone.com (145.230.103.127) by
 VOEXC05W.internal.vodafone.com (145.230.101.25) with Microsoft SMTP Server
 (TLS) id 14.3.224.2; Tue, 20 Oct 2015 10:14:10 +0200
Received: from VOEXM10W.internal.vodafone.com ([169.254.2.88]) by
 VOEXC22W.internal.vodafone.com ([145.230.103.127]) with mapi id
 14.03.0224.002; Tue, 20 Oct 2015 10:14:07 +0200
From: =?utf-8?B?UGzDvG0sIFLDvGRpZ2VyLCBWb2RhZm9uZSBHcm91cA==?=
	<ruediger.pluem@vodafone.com>
To: "dev@httpd.apache.org" <dev@httpd.apache.org>
Subject: RE: [users@httpd] Chunked transfer delay with httpd 2.4 on Windows.
Thread-Topic: [users@httpd] Chunked transfer delay with httpd 2.4 on Windows.
Thread-Index: AQJr39snR3okfWd+mdb2/cStNlHK3ANosmwhAQQfMhoCkCKjkgEy2EUyAdi34oc=
Date: Tue, 20 Oct 2015 08:14:07 +0000
Message-ID: <AB1691BE05AE7F4992697F2A0835627AC63489DC@VOEXM10W.internal.vodafone.com>
References: <5625642E.30708@ptc.com>
	<CAKQ1sVPceAVuDMNgt-qGomU6EARQap5HpCbvaPPiwtYXsUvRpg@mail.gmail.com>
	<CALK=YjM5CvMgWAWT=X67JxBdaJDJ5PCFsHJijSEs0bKovFnQtQ@mail.gmail.com>
	<5625A5E7.2070309@ptc.com>
 <CAKQ1sVPRX_st3SWAnF30C62qxTNqjHiSV3iaCHFPr1HLGp_CxA@mail.gmail.com>
In-Reply-To: <CAKQ1sVPRX_st3SWAnF30C62qxTNqjHiSV3iaCHFPr1HLGp_CxA@mail.gmail.com>
Content-Language: en-US
X-MS-Has-Attach:
X-MS-TNEF-Correlator:
exchangemailitem-processed-by-si: Success
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
MIME-Version: 1.0
SI-Deferred-For-Outbound-Conversion: False

DQoNCj4gLS0tLS1PcmlnaW5hbCBNZXNzYWdlLS0tLS0NCj4gRnJvbTogWWFubiBZbGF2aWMgW21h
aWx0bzp5bGF2aWMuZGV2QGdtYWlsLmNvbV0NCj4gU2VudDogRGllbnN0YWcsIDIwLiBPa3RvYmVy
IDIwMTUgMTA6MDENCj4gVG86IGRldkBodHRwZC5hcGFjaGUub3JnDQo+IFN1YmplY3Q6IFJlOiBb
dXNlcnNAaHR0cGRdIENodW5rZWQgdHJhbnNmZXIgZGVsYXkgd2l0aCBodHRwZCAyLjQgb24NCj4g
V2luZG93cy4NCj4NCj4gT24gVHVlLCBPY3QgMjAsIDIwMTUgYXQgNDoyNCBBTSwgQW5keSBXYW5n
IDxhd2FuZ0BwdGMuY29tPiB3cm90ZToNCj4gPg0KPiA+DQo+ID4gT24gMTAvMTkvMjAxNSAwNzo0
NCBQTSwgRXJpYyBDb3ZlbmVyIHdyb3RlOg0KPiA+Pg0KPiA+PiBPbiBNb24sIE9jdCAxOSwgMjAx
NSBhdCA3OjA1IFBNLCBZYW5uIFlsYXZpYyA8eWxhdmljLmRldkBnbWFpbC5jb20+DQo+IHdyb3Rl
Og0KPiA+Pj4NCj4gPj4+IFRoaXMgaXMgdGhlIGRlZmVycmVkIHdyaXRlIHRyaWdnZXJpbmcgKmFm
dGVyKiB0aGUga2VlcGFsaXZlIHRpbWVvdXQsDQo+ID4+PiB3aGVyZWFzIG5vIHN1YnNlcXVlbnQg
cmVxdWVzdCB3YXMgcGlwZWxpbmVkLg0KPiA+Pj4gSSB3b25kZXIgaWYgd2Ugc2hvdWxkbid0IGlz
c3VlIGEgZmx1c2ggYXQgdGhlIGVuZCBvZiBlYWNoIHJlcXVlc3Qgd2hlbg0KPiA+Pj4gdGhlIGZv
bGxvd2luZyBpcyBub3QgYWxyZWFkeSB0aGVyZSwgaWU6DQo+ID4+DQo+ID4+DQo+ID4+IENhbiB5
b3UgZGVzY3JpYmUgd2hhdCBicmVha3MgdGhlIGN1cnJlbnQgY29kZT8gSXQgbG9va3MgbGlrZSBp
dCdzDQo+ID4+IGFscmVhZHkgdHJ5aW5nIHRvIGhhbmRsZSB0aGlzIGNhc2UsIEkgY291bGRuJ3Qg
dGVsbCB0aGUgb3BlcmF0aXZlDQo+ID4+IGRpZmZlcmVuY2UuDQo+ID4+DQo+ID4NCj4gPiBJJ20g
YWxzbyBjdXJpb3VzIHdoeSBpdCBpcyB0aGF0IEkgc2VlbSB0byBvbmx5IGJlIGFibGUgdG8gcmVw
cm9kdWNlIGl0DQo+IHdpdGgNCj4gPiBhIHBhcnRpY3VsYXIgY2xpZW50LiAgaSB3b3VsZCBoYXZl
IGV4cGVjdGVkIHVzaW5nIG5jYXQgdG8gc2ltdWxhdGUgdGhlDQo+IGV4YWN0DQo+ID4gc2FtZSBy
ZXF1ZXN0IHdvdWxkIGhhdmUgYmVlbiBhYmxlIHRvIHRyaWdnZXIgdGhlIHNhbWUgYmVoYXZpb3Iu
DQo+ID4NCj4gPiBBbmQgd2h5IGlzIHRoaXMgb25seSBvY2N1cnJpbmcgb24gd2luZG93cz8NCj4N
Cj4gWWVzLCBhIGNvbXBsZXRlIG1pc2ludGVycHJldGF0aW9uIG9uIG15IHNpZGUhDQo+IFRoZSBp
c3N1ZSBtdXN0IGJlIHNvbWV3aGVyZSBpbiBtb2RfZGVmbGF0ZSAoRU9TIGhhbmRsaW5nPyksIHNp
bmNlIHRoZQ0KPiBmbHVzaCBkb25lIGF0IGNvbm5lY3Rpb24gbGV2ZWwgaXMgb2Ygbm8gaGVscCBm
b3IgdGhlIHJlcXVlc3QgZmlsdGVycy4NCj4gV2lsbCBsb29rIGF0IHRoaXMuLi4NCg0KWWVhaC4g
VGhlcmUgaXMgb25seSBhIGRpZmZlcmVuY2UgYmV0d2VlbiBhc3luYyBhbmQgc3luYyBtcG0ncyBh
bmQgV2luZG93cyBpcyBzeW5jDQphbmQgaGVuY2UgdGhlIGZsdXNoIGlzIGFscmVhZHkgc2VudC4N
CkFueSBlcnJvciBtZXNzYWdlcyBpbiB0aGUgbG9nZmlsZT8NCg0KUmVnYXJkcw0KDQpSw7xkaWdl
cg0K

From dev-return-84361-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Tue Oct 20 08:18:02 2015
Return-Path: <dev-return-84361-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 9A61F10067
	for <apmail-httpd-dev-archive@www.apache.org>; Tue, 20 Oct 2015 08:18:02 +0000 (UTC)
Received: (qmail 17204 invoked by uid 500); 20 Oct 2015 08:18:02 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 17124 invoked by uid 500); 20 Oct 2015 08:18:02 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 17114 invoked by uid 99); 20 Oct 2015 08:18:02 -0000
Received: from Unknown (HELO spamd2-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 20 Oct 2015 08:18:02 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd2-us-west.apache.org (ASF Mail Server at spamd2-us-west.apache.org) with ESMTP id AABF71A2D06
	for <dev@httpd.apache.org>; Tue, 20 Oct 2015 08:18:01 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd2-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 1
X-Spam-Level: *
X-Spam-Status: No, score=1 tagged_above=-999 required=6.31
	tests=[KAM_LAZY_DOMAIN_SECURITY=1, SPF_HELO_PASS=-0.001,
	URIBL_BLOCKED=0.001] autolearn=disabled
Received: from mx1-us-west.apache.org ([10.40.0.8])
	by localhost (spamd2-us-west.apache.org [10.40.0.9]) (amavisd-new, port 10024)
	with ESMTP id GeBdfZG8fZpa for <dev@httpd.apache.org>;
	Tue, 20 Oct 2015 08:17:50 +0000 (UTC)
Received: from mail1.bemta14.messagelabs.com (mail1.bemta14.messagelabs.com [193.109.254.110])
	by mx1-us-west.apache.org (ASF Mail Server at mx1-us-west.apache.org) with ESMTPS id 8333320FF5
	for <dev@httpd.apache.org>; Tue, 20 Oct 2015 08:17:50 +0000 (UTC)
Received: from [193.109.255.99] by server-6.bemta-14.messagelabs.com id BE/C8-16618-6A8F5265; Tue, 20 Oct 2015 08:17:42 +0000
X-Env-Sender: ruediger.pluem@vodafone.com
X-Msg-Ref: server-14.tower-48.messagelabs.com!1445329062!3100435!1
X-Originating-IP: [195.232.244.133]
X-StarScan-Received:
X-StarScan-Version: 7.19.2; banners=-,-,-
X-VirusChecked: Checked
Received: (qmail 26637 invoked from network); 20 Oct 2015 08:17:42 -0000
Received: from mailout01.vodafone.com (HELO mailout01.vodafone.com) (195.232.244.133)
  by server-14.tower-48.messagelabs.com with DHE-RSA-AES256-SHA encrypted SMTP; 20 Oct 2015 08:17:42 -0000
Received: from mailint04.vodafone.com (mailint04.vodafone.com [195.232.244.201])
	by mailout01.vodafone.com (Postfix) with ESMTP id 3ng79f13jpz1yJ0
	for <dev@httpd.apache.org>; Tue, 20 Oct 2015 10:17:42 +0200 (CEST)
Received: from mailint04.vodafone.com (localhost [127.0.0.1])
	by mailint04.vodafone.com (Postfix) with ESMTP id 3ng79f00Sdzfbt0
	for <dev@httpd.apache.org>; Tue, 20 Oct 2015 10:17:41 +0200 (CEST)
Received: from VOEXC04W.internal.vodafone.com (voexc04w.dc-ratingen.de [145.230.101.24])
	(using TLSv1 with cipher AES128-SHA (128/128 bits))
	(No client certificate requested)
	by mailint04.vodafone.com (Postfix) with ESMTPS id 3ng79d6wLGzfbnw
	for <dev@httpd.apache.org>; Tue, 20 Oct 2015 10:17:41 +0200 (CEST)
Received: from VOEXC12W.internal.vodafone.com (145.230.101.14) by
 VOEXC04W.internal.vodafone.com (145.230.101.24) with Microsoft SMTP Server
 (TLS) id 14.3.224.2; Tue, 20 Oct 2015 10:17:21 +0200
Received: from VOEXM10W.internal.vodafone.com ([169.254.2.88]) by
 voexc12w.internal.vodafone.com ([145.230.101.14]) with mapi id
 14.03.0224.002; Tue, 20 Oct 2015 10:17:20 +0200
From: =?utf-8?B?UGzDvG0sIFLDvGRpZ2VyLCBWb2RhZm9uZSBHcm91cA==?=
	<ruediger.pluem@vodafone.com>
To: "dev@httpd.apache.org" <dev@httpd.apache.org>
Subject: RE: [users@httpd] Chunked transfer delay with httpd 2.4 on Windows.
Thread-Topic: [users@httpd] Chunked transfer delay with httpd 2.4 on Windows.
Thread-Index: AQHRCsKp6VHmLQpuNE+WM3OmAfdh+J5zadyAgAAcCICAAF4bAIAAJXpg
Date: Tue, 20 Oct 2015 08:17:19 +0000
Message-ID: <AB1691BE05AE7F4992697F2A0835627AC63489F4@VOEXM10W.internal.vodafone.com>
References: <5625642E.30708@ptc.com>
	<CAKQ1sVPceAVuDMNgt-qGomU6EARQap5HpCbvaPPiwtYXsUvRpg@mail.gmail.com>
	<CALK=YjM5CvMgWAWT=X67JxBdaJDJ5PCFsHJijSEs0bKovFnQtQ@mail.gmail.com>
	<5625A5E7.2070309@ptc.com>
 <CAKQ1sVPRX_st3SWAnF30C62qxTNqjHiSV3iaCHFPr1HLGp_CxA@mail.gmail.com>
In-Reply-To: <CAKQ1sVPRX_st3SWAnF30C62qxTNqjHiSV3iaCHFPr1HLGp_CxA@mail.gmail.com>
Accept-Language: en-US
Content-Language: en-US
X-MS-Has-Attach:
X-MS-TNEF-Correlator:
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
MIME-Version: 1.0

DQoNCj4gLS0tLS1PcmlnaW5hbCBNZXNzYWdlLS0tLS0NCj4gRnJvbTogWWFubiBZbGF2aWMgW21h
aWx0bzp5bGF2aWMuZGV2QGdtYWlsLmNvbV0NCj4gU2VudDogRGllbnN0YWcsIDIwLiBPa3RvYmVy
IDIwMTUgMTA6MDENCj4gVG86IGRldkBodHRwZC5hcGFjaGUub3JnDQo+IFN1YmplY3Q6IFJlOiBb
dXNlcnNAaHR0cGRdIENodW5rZWQgdHJhbnNmZXIgZGVsYXkgd2l0aCBodHRwZCAyLjQgb24NCj4g
V2luZG93cy4NCj4gDQo+IE9uIFR1ZSwgT2N0IDIwLCAyMDE1IGF0IDQ6MjQgQU0sIEFuZHkgV2Fu
ZyA8YXdhbmdAcHRjLmNvbT4gd3JvdGU6DQo+ID4NCj4gPg0KPiA+IE9uIDEwLzE5LzIwMTUgMDc6
NDQgUE0sIEVyaWMgQ292ZW5lciB3cm90ZToNCj4gPj4NCj4gPj4gT24gTW9uLCBPY3QgMTksIDIw
MTUgYXQgNzowNSBQTSwgWWFubiBZbGF2aWMgPHlsYXZpYy5kZXZAZ21haWwuY29tPg0KPiB3cm90
ZToNCj4gPj4+DQo+ID4+PiBUaGlzIGlzIHRoZSBkZWZlcnJlZCB3cml0ZSB0cmlnZ2VyaW5nICph
ZnRlciogdGhlIGtlZXBhbGl2ZSB0aW1lb3V0LA0KPiA+Pj4gd2hlcmVhcyBubyBzdWJzZXF1ZW50
IHJlcXVlc3Qgd2FzIHBpcGVsaW5lZC4NCj4gPj4+IEkgd29uZGVyIGlmIHdlIHNob3VsZG4ndCBp
c3N1ZSBhIGZsdXNoIGF0IHRoZSBlbmQgb2YgZWFjaCByZXF1ZXN0IHdoZW4NCj4gPj4+IHRoZSBm
b2xsb3dpbmcgaXMgbm90IGFscmVhZHkgdGhlcmUsIGllOg0KPiA+Pg0KPiA+Pg0KPiA+PiBDYW4g
eW91IGRlc2NyaWJlIHdoYXQgYnJlYWtzIHRoZSBjdXJyZW50IGNvZGU/IEl0IGxvb2tzIGxpa2Ug
aXQncw0KPiA+PiBhbHJlYWR5IHRyeWluZyB0byBoYW5kbGUgdGhpcyBjYXNlLCBJIGNvdWxkbid0
IHRlbGwgdGhlIG9wZXJhdGl2ZQ0KPiA+PiBkaWZmZXJlbmNlLg0KPiA+Pg0KPiA+DQo+ID4gSSdt
IGFsc28gY3VyaW91cyB3aHkgaXQgaXMgdGhhdCBJIHNlZW0gdG8gb25seSBiZSBhYmxlIHRvIHJl
cHJvZHVjZSBpdA0KPiB3aXRoDQo+ID4gYSBwYXJ0aWN1bGFyIGNsaWVudC4gIGkgd291bGQgaGF2
ZSBleHBlY3RlZCB1c2luZyBuY2F0IHRvIHNpbXVsYXRlIHRoZQ0KPiBleGFjdA0KPiA+IHNhbWUg
cmVxdWVzdCB3b3VsZCBoYXZlIGJlZW4gYWJsZSB0byB0cmlnZ2VyIHRoZSBzYW1lIGJlaGF2aW9y
Lg0KPiA+DQo+ID4gQW5kIHdoeSBpcyB0aGlzIG9ubHkgb2NjdXJyaW5nIG9uIHdpbmRvd3M/DQo+
IA0KPiBZZXMsIGEgY29tcGxldGUgbWlzaW50ZXJwcmV0YXRpb24gb24gbXkgc2lkZSENCj4gVGhl
IGlzc3VlIG11c3QgYmUgc29tZXdoZXJlIGluIG1vZF9kZWZsYXRlIChFT1MgaGFuZGxpbmc/KSwg
c2luY2UgdGhlDQo+IGZsdXNoIGRvbmUgYXQgY29ubmVjdGlvbiBsZXZlbCBpcyBvZiBubyBoZWxw
IGZvciB0aGUgcmVxdWVzdCBmaWx0ZXJzLg0KPiBXaWxsIGxvb2sgYXQgdGhpcy4uLg0KDQpPciBp
cyB0aGlzIHNvbWV0aGluZyB3aXRoIG1vZF9qayBub3QgY29ycmVjdGx5IHNlbmRpbmcgYW4gRU9T
PyBEb2VzIHRoaXMgaGFwcGVuIHdpdGggbW9kX3Byb3h5X2FqcCBhcyB3ZWxsPw0KDQpSZWdhcmRz
DQoNClLDvGRpZ2VyDQo=

From dev-return-84362-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Tue Oct 20 08:57:49 2015
Return-Path: <dev-return-84362-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id D952A1034F
	for <apmail-httpd-dev-archive@www.apache.org>; Tue, 20 Oct 2015 08:57:49 +0000 (UTC)
Received: (qmail 61823 invoked by uid 500); 20 Oct 2015 08:43:06 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 61544 invoked by uid 500); 20 Oct 2015 08:43:06 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 61467 invoked by uid 99); 20 Oct 2015 08:43:06 -0000
Received: from Unknown (HELO spamd1-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 20 Oct 2015 08:43:06 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd1-us-west.apache.org (ASF Mail Server at spamd1-us-west.apache.org) with ESMTP id EA47DC80E0
	for <dev@httpd.apache.org>; Tue, 20 Oct 2015 08:43:05 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd1-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.099
X-Spam-Level:
X-Spam-Status: No, score=-0.099 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RP_MATCHES_RCVD=0.001, SPF_PASS=-0.001, URIBL_BLOCKED=0.001]
	autolearn=disabled
Authentication-Results: spamd1-us-west.apache.org (amavisd-new);
	dkim=pass (1024-bit key) header.d=greenbytes.de
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd1-us-west.apache.org [10.40.0.7]) (amavisd-new, port 10024)
	with ESMTP id tLd1a468-NjU for <dev@httpd.apache.org>;
	Tue, 20 Oct 2015 08:42:58 +0000 (UTC)
Received: from mail.greenbytes.de (mail.greenbytes.de [217.91.35.233])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id 9FE8A4415F
	for <dev@httpd.apache.org>; Tue, 20 Oct 2015 08:42:57 +0000 (UTC)
Received: from [192.168.1.42] (unknown [5.10.171.186])
	(using TLSv1 with cipher ECDHE-RSA-AES256-SHA (256/256 bits))
	(Client did not present a certificate)
	by mail.greenbytes.de (Postfix) with ESMTPSA id 97A9115A0098
	for <dev@httpd.apache.org>; Tue, 20 Oct 2015 10:42:49 +0200 (CEST)
DKIM-Signature: v=1; a=rsa-sha256; c=simple/simple; d=greenbytes.de; s=mail;
	t=1445330569; bh=Cd2/4FpuhSF7VD6awPoDu+EOXcuZ/5sKrwYCMQYIFRk=;
	h=Subject:From:In-Reply-To:Date:References:To:From;
	b=DdHi68H7ZFrPTQL3HTOsNlhdmZtsu/5Y759kIpwIYYf2ryjm3NJkgmiqlzkH1hP4p
	 7kMpjOrptuc7151hC7HGe5D+U6kX2mjXiUqSauWaQjAPCF6rmLWLCFL+2YRn7TbrOP
	 LviY0CtLhQ/+Kxqm6c3rXZ3iXmmg3mTbt7l2gVgc=
Content-Type: text/plain; charset=utf-8
Mime-Version: 1.0 (Mac OS X Mail 9.0 \(3094\))
Subject: Re: Forwarded buckets' lifetime (was: [Bug 58503] segfault in apr_brigade_cleanup()...)
From: Stefan Eissing <stefan.eissing@greenbytes.de>
In-Reply-To: <AB1691BE05AE7F4992697F2A0835627AC6348972@VOEXM10W.internal.vodafone.com>
Date: Tue, 20 Oct 2015 10:42:48 +0200
Content-Transfer-Encoding: quoted-printable
Message-Id: <7B24F4D1-6904-4C00-A337-88F712026BE9@greenbytes.de>
References: <CAKQ1sVNchFx=egp=Q0tgT+1GcBXiten8mh9STetcZXOfJxhsjQ@mail.gmail.com> <CAKQ1sVPjcA9EYNpjcmM9=AU_LCgAsFntOcZnmGoHymds3S5wmA@mail.gmail.com> <AB1691BE05AE7F4992697F2A0835627AC6348972@VOEXM10W.internal.vodafone.com>
To: dev@httpd.apache.org
X-Mailer: Apple Mail (2.3094)


> Am 20.10.2015 um 09:44 schrieb Pl=C3=BCm, R=C3=BCdiger, Vodafone Group =
<ruediger.pluem@vodafone.com>:
>=20
>=20
>=20
>> -----Original Message-----
>> From: Yann Ylavic [mailto:ylavic.dev@gmail.com]
>> Sent: Montag, 19. Oktober 2015 22:30
>> To: dev@httpd.apache.org
>> Subject: Fwd: Forwarded buckets' lifetime (was: [Bug 58503] segfault =
in
>> apr_brigade_cleanup()...)
>>=20
>> [Meant for dev@...]
>>=20
>> Thoughts?
>>=20
>>> https://bz.apache.org/bugzilla/show_bug.cgi?id=3D58503
>>>=20
>>> --- Comment #8 from Yann Ylavic <ylavic.dev@gmail.com> ---
>>> (In reply to Ruediger Pluem from comment #7)
>>>> Actually I think mod_proxy_wstunnel falls into the same pitfall
>>>> mod_proxy_http was in and it needs to do the same / something =
similar
>> then
>>>> mod_proxy_http.c with
>>>>=20
>>>> proxy_buckets_lifetime_transform
>>>=20
>>> Yes I agree, just proposed a quick patch to determine whether it =
came
>> from
>>> mod_proxy_wstunnel or some failure in the core deferred/pipelined =
write
>>> logic...
>>>=20
>>> We need to either use lifetime_transform like in proxy_http, or I =
was
>> thinking
>>> of modifying all the input filters that create their buckets on =
f->r/c's
>>> pool/bucket_alloc so that they now use their given bb->p and bb-
>>> bucket_alloc.
>=20
> I don't think that this is a good idea, because bucket brigades =
sometimes have a longer lifetime
> then the buckets that are created right now with =
f->r/c'spool/bucket_alloc. They get created and are kept
> and only get cleared to avoid creating them over and over again. So =
this step can open up a big
> can of worms. Furthermore it is an API change, because currently the =
caller expects the buckets
> are created with f->r/c'spool/bucket_alloc und you cannot change that =
expectation for 3rd party modules.
>=20
> So if at all a change for trunk only that requires a very deep review =
of all brigade usages.

As I learned, bucket brigades are very optimized for the common HTTP/1 =
case: appearing during one
request and going away together with the request - preferably with only =
one thread involved.

When (sub-)request are used - and you may look at HTTP/2 processing as =
involving sub-requests, this
model no longer holds and such functionality has a heavy price to pay. =
It needs to step very
carefully to avoid the pitfalls of pool destroy cleanups on EOR.

Given the complexity and the modules out there, I do not think it wise =
to change the behaviour
of the existing apr_bucket_brigade in 2.4.x. I think it is better to =
think of an alternate bucket
brigade design and maybe how that could live next to the old one in =
2.4.x. Or skip 2.4.x entirely
for this.

//Stefan






From dev-return-84363-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Tue Oct 20 09:11:21 2015
Return-Path: <dev-return-84363-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 2DB55104D4
	for <apmail-httpd-dev-archive@www.apache.org>; Tue, 20 Oct 2015 09:11:21 +0000 (UTC)
Received: (qmail 76762 invoked by uid 500); 20 Oct 2015 08:59:44 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 76663 invoked by uid 500); 20 Oct 2015 08:59:44 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 76625 invoked by uid 99); 20 Oct 2015 08:59:44 -0000
Received: from Unknown (HELO spamd2-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 20 Oct 2015 08:59:44 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd2-us-west.apache.org (ASF Mail Server at spamd2-us-west.apache.org) with ESMTP id 40BD31A2CEF
	for <dev@httpd.apache.org>; Tue, 20 Oct 2015 08:59:44 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd2-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.109
X-Spam-Level:
X-Spam-Status: No, score=-0.109 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	T_RP_MATCHES_RCVD=-0.01, URIBL_BLOCKED=0.001] autolearn=disabled
Authentication-Results: spamd2-us-west.apache.org (amavisd-new);
	dkim=pass (1024-bit key) header.d=greenbytes.de
Received: from mx1-us-west.apache.org ([10.40.0.8])
	by localhost (spamd2-us-west.apache.org [10.40.0.9]) (amavisd-new, port 10024)
	with ESMTP id TfoBcLWm9680 for <dev@httpd.apache.org>;
	Tue, 20 Oct 2015 08:59:31 +0000 (UTC)
Received: from mail.greenbytes.de (mail.greenbytes.de [217.91.35.233])
	by mx1-us-west.apache.org (ASF Mail Server at mx1-us-west.apache.org) with ESMTPS id 30DBE210B8
	for <dev@httpd.apache.org>; Tue, 20 Oct 2015 08:59:30 +0000 (UTC)
Received: from [192.168.1.42] (unknown [5.10.171.186])
	(using TLSv1 with cipher ECDHE-RSA-AES256-SHA (256/256 bits))
	(Client did not present a certificate)
	by mail.greenbytes.de (Postfix) with ESMTPSA id D5B5115A0756
	for <dev@httpd.apache.org>; Tue, 20 Oct 2015 10:59:22 +0200 (CEST)
DKIM-Signature: v=1; a=rsa-sha256; c=simple/simple; d=greenbytes.de; s=mail;
	t=1445331563; bh=KQ9lQSyHl9mp0DkH5h42hKuolQwwRIEd2tP0Ex60cFI=;
	h=From:Subject:Date:To:From;
	b=icQsAOJ26MLsXFXTaffghXXuPh0obuUacakObR22FQqsAuaantpQcsV8iWxVewdLH
	 mj7CW4M7m2GOu4Tc5k4W+iWYwAM3rdQWXEK9Ce1vUnFWKEVPoxPnvXeoYzwVelj8hk
	 0sfsI63DMaJHAqrA9vqeK/0f2d3GEDi0QQlbUYLs=
From: Stefan Eissing <stefan.eissing@greenbytes.de>
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: quoted-printable
Subject: client certificate weight lifting
Message-Id: <CBC4B73C-DE10-4B2D-BA72-FA65639D8226@greenbytes.de>
Date: Tue, 20 Oct 2015 10:59:21 +0200
To: dev@httpd.apache.org
Mime-Version: 1.0 (Mac OS X Mail 9.0 \(3094\))
X-Mailer: Apple Mail (2.3094)

First draft on client certs in the age of HTTP/2: =
https://tools.ietf.org/html/draft-thomson-http2-client-certs-00 in =
cooperation with the TSL WG as feature in TLS 1.3 and extension in 1.2.

//Stefan=

From dev-return-84365-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Tue Oct 20 09:14:02 2015
Return-Path: <dev-return-84365-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id D1F9610577
	for <apmail-httpd-dev-archive@www.apache.org>; Tue, 20 Oct 2015 09:14:02 +0000 (UTC)
Received: (qmail 24004 invoked by uid 500); 20 Oct 2015 09:09:28 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 22371 invoked by uid 500); 20 Oct 2015 09:09:27 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 17569 invoked by uid 99); 20 Oct 2015 09:07:15 -0000
Received: from Unknown (HELO spamd1-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 20 Oct 2015 09:07:15 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd1-us-west.apache.org (ASF Mail Server at spamd1-us-west.apache.org) with ESMTP id 29E16C80DE
	for <dev@httpd.apache.org>; Tue, 20 Oct 2015 09:07:15 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd1-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.119
X-Spam-Level:
X-Spam-Status: No, score=-0.119 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RCVD_IN_MSPIKE_H3=-0.01, RCVD_IN_MSPIKE_WL=-0.01, URIBL_BLOCKED=0.001]
	autolearn=disabled
Authentication-Results: spamd1-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd1-us-west.apache.org [10.40.0.7]) (amavisd-new, port 10024)
	with ESMTP id 60YfxagK5Sej for <dev@httpd.apache.org>;
	Tue, 20 Oct 2015 09:07:06 +0000 (UTC)
Received: from mail-qk0-f173.google.com (mail-qk0-f173.google.com [209.85.220.173])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id 480FB4415F
	for <dev@httpd.apache.org>; Tue, 20 Oct 2015 09:07:06 +0000 (UTC)
Received: by qkca6 with SMTP id a6so4481471qkc.3
        for <dev@httpd.apache.org>; Tue, 20 Oct 2015 02:07:06 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type:content-transfer-encoding;
        bh=HqF4M6SDo3iuchhZA+QNgmU1V2/DY/UfAwcQtJLrmHo=;
        b=avGdsS/4K/zGpszG+rnlMrn5WvN/Hn+O94nPld812m8qN1sK4e3m1K3eGlwmFi6SWn
         jH4yuADhwnpPtBECRopxTq+zQxhAc6wtYEJZoQX8he4/LcDP82HXge7qufOhlOqOWM7m
         qZyOJBCDxomaYdmGUyg6NurvDEZiTnqbD71v0j6bVSo2gipnrY8QIwSvkgGzxPELIpAW
         n636XLKBCA8rlUi11Fy8DBRuhy7XJQAJBbQspMH8XT4u82c9GebCVgy3O4O70VYOtWoX
         n6EGSgqwXSv9Wh3PAMgL8O8smrvEo+ObMp1NyT6kMtpSahnfCbtsjI+ztAkMAabAnHZu
         x6Tg==
MIME-Version: 1.0
X-Received: by 10.55.215.156 with SMTP id t28mr2348246qkt.68.1445332026019;
 Tue, 20 Oct 2015 02:07:06 -0700 (PDT)
Received: by 10.55.156.213 with HTTP; Tue, 20 Oct 2015 02:07:05 -0700 (PDT)
In-Reply-To: <AB1691BE05AE7F4992697F2A0835627AC63489BF@VOEXM10W.internal.vodafone.com>
References: <5625642E.30708@ptc.com>
	<CAKQ1sVPceAVuDMNgt-qGomU6EARQap5HpCbvaPPiwtYXsUvRpg@mail.gmail.com>
	<AB1691BE05AE7F4992697F2A0835627AC63489BF@VOEXM10W.internal.vodafone.com>
Date: Tue, 20 Oct 2015 11:07:05 +0200
Message-ID: <CAKQ1sVM4qVj_ZTEYk5oTX67T5AMbZmCp=AgwOARXcks_eBXenA@mail.gmail.com>
Subject: Re: [users@httpd] Chunked transfer delay with httpd 2.4 on Windows.
From: Yann Ylavic <ylavic.dev@gmail.com>
To: dev@httpd.apache.org
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: quoted-printable

The proposed patch is dead anyway, just one remark though.

On Tue, Oct 20, 2015 at 10:08 AM, Pl=C3=BCm, R=C3=BCdiger, Vodafone Group
<ruediger.pluem@vodafone.com> wrote:
>
>
>> -----Original Message-----
>> From: Yann Ylavic [mailto:ylavic.dev@gmail.com]
>> Sent: Dienstag, 20. Oktober 2015 01:05
>>
>> Index: modules/http/http_request.c
>> =3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D
[]
>> --- modules/http/http_request.c    (revision 1708095)
>> +++ modules/http/http_request.c    (working copy)
>>
>> -    if (!c->data_in_input_filters) {
>> -        bb =3D apr_brigade_create(c->pool, c->bucket_alloc);
>> -        b =3D apr_bucket_flush_create(c->bucket_alloc);
>> -        APR_BRIGADE_INSERT_HEAD(bb, b);
>> -        rv =3D ap_pass_brigade(c->output_filters, bb);
>> -        if (APR_STATUS_IS_TIMEUP(rv)) {
>> -            /*
>> -             * Notice a timeout as an error message. This might be
>> -             * valuable for detecting clients with broken network
>> -             * connections or possible DoS attacks.
>> -             *
>> -             * It is still safe to use r / r->pool here as the eor buck=
et
>> -             * could not have been destroyed in the event of a timeout.
>> -             */
>> -            ap_log_rerror(APLOG_MARK, APLOG_INFO, rv, r, APLOGNO(01581)
>> -                          "Timeout while writing data for URI %s to the=
"
>> -                          " client", r->unparsed_uri);
>> -        }
>> -    }
>>      if (ap_extended_status) {
>> +        conn_rec *c =3D r->connection;
>
> r is likely to be dead here

Correct, and I think the above code is quite risky too.
Does it really worth logging at the request level here, whereas using
something like:
    ap_log_cerror(APLOG_MARK, APLOG_INFO, rv, c, APLOGNO(01581)
                  "Timeout flusing data to the client");
would be as much informative IMHO.

From dev-return-84364-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Tue Oct 20 09:14:05 2015
Return-Path: <dev-return-84364-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id ED58A10579
	for <apmail-httpd-dev-archive@www.apache.org>; Tue, 20 Oct 2015 09:14:04 +0000 (UTC)
Received: (qmail 22357 invoked by uid 500); 20 Oct 2015 09:09:26 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 21205 invoked by uid 500); 20 Oct 2015 09:09:24 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 17648 invoked by uid 99); 20 Oct 2015 09:08:42 -0000
Received: from Unknown (HELO spamd2-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 20 Oct 2015 09:08:42 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd2-us-west.apache.org (ASF Mail Server at spamd2-us-west.apache.org) with ESMTP id 5B3731A2082
	for <dev@httpd.apache.org>; Tue, 20 Oct 2015 08:54:22 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd2-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.1
X-Spam-Level:
X-Spam-Status: No, score=-0.1 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RCVD_IN_MSPIKE_H2=-0.001, URIBL_BLOCKED=0.001] autolearn=disabled
Authentication-Results: spamd2-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-us-west.apache.org ([10.40.0.8])
	by localhost (spamd2-us-west.apache.org [10.40.0.9]) (amavisd-new, port 10024)
	with ESMTP id 74ngfY1gv9ip for <dev@httpd.apache.org>;
	Tue, 20 Oct 2015 08:54:17 +0000 (UTC)
Received: from mail-qg0-f41.google.com (mail-qg0-f41.google.com [209.85.192.41])
	by mx1-us-west.apache.org (ASF Mail Server at mx1-us-west.apache.org) with ESMTPS id 2D40B211A9
	for <dev@httpd.apache.org>; Tue, 20 Oct 2015 08:54:17 +0000 (UTC)
Received: by qgem9 with SMTP id m9so8762785qge.1
        for <dev@httpd.apache.org>; Tue, 20 Oct 2015 01:54:16 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type:content-transfer-encoding;
        bh=9ehY2poTO8nptnRZyMs6t1f/6KQZ9AKpQPnvWf4WFFc=;
        b=VL3M306bHanvOkTjqgJZhHhqHqz9UuE1kPAJL+HmuFQi6b9qWsCL5kVcq6S8Lw6vf0
         GDgHgpvNYKNenLrncaJLGFYuYt/jO0J3XYvT8jSLV394d7q9rQuKjK+IUo1vNpbH1n8+
         nCwYNkiajUrtyQkxgR1P4NMxNSWDf8UQvY8dpk40Y9KXUl+u3ipsWhH6fs1gSLIplF/V
         aDPRWcr8OgqigI8SeMqoKAjRYChCZbh3glDigqBpe3m52bSrPAOO0rUxg7AT7KrXBzsj
         1SUcsuQRP1a5LAm2n7slrCx778M60+yg9Hq6SyFDvDuK0pmUEiiRQKOggHIpEd4FdTkM
         NY6w==
MIME-Version: 1.0
X-Received: by 10.140.95.66 with SMTP id h60mr2396306qge.14.1445331256477;
 Tue, 20 Oct 2015 01:54:16 -0700 (PDT)
Received: by 10.55.156.213 with HTTP; Tue, 20 Oct 2015 01:54:16 -0700 (PDT)
In-Reply-To: <AB1691BE05AE7F4992697F2A0835627AC63489F4@VOEXM10W.internal.vodafone.com>
References: <5625642E.30708@ptc.com>
	<CAKQ1sVPceAVuDMNgt-qGomU6EARQap5HpCbvaPPiwtYXsUvRpg@mail.gmail.com>
	<CALK=YjM5CvMgWAWT=X67JxBdaJDJ5PCFsHJijSEs0bKovFnQtQ@mail.gmail.com>
	<5625A5E7.2070309@ptc.com>
	<CAKQ1sVPRX_st3SWAnF30C62qxTNqjHiSV3iaCHFPr1HLGp_CxA@mail.gmail.com>
	<AB1691BE05AE7F4992697F2A0835627AC63489F4@VOEXM10W.internal.vodafone.com>
Date: Tue, 20 Oct 2015 10:54:16 +0200
Message-ID: <CAKQ1sVMhNzYPWHTvhdeV6z+mV2ZNq5vjHj=W1d6R46cOQ_-qhQ@mail.gmail.com>
Subject: Re: [users@httpd] Chunked transfer delay with httpd 2.4 on Windows.
From: Yann Ylavic <ylavic.dev@gmail.com>
To: dev@httpd.apache.org
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: quoted-printable

On Tue, Oct 20, 2015 at 10:17 AM, Pl=C3=BCm, R=C3=BCdiger, Vodafone Group
<ruediger.pluem@vodafone.com> wrote:
>
> Or is this something with mod_jk not correctly sending an EOS? Does this =
happen with mod_proxy_ajp as well?

If that was the case, I think we wouldn't enter the keepalive state,
that's why I mentioned the EOS handling in mod_deflate.
However the code is not Windows specific there... Maybe a Windows
specific zlib issue?

I agree that log TRACEs could help here too.

Regards,
Yann.

From dev-return-84366-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Tue Oct 20 09:24:59 2015
Return-Path: <dev-return-84366-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id D374310645
	for <apmail-httpd-dev-archive@www.apache.org>; Tue, 20 Oct 2015 09:24:59 +0000 (UTC)
Received: (qmail 50753 invoked by uid 500); 20 Oct 2015 09:24:59 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 50677 invoked by uid 500); 20 Oct 2015 09:24:59 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 50667 invoked by uid 99); 20 Oct 2015 09:24:59 -0000
Received: from Unknown (HELO spamd4-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 20 Oct 2015 09:24:59 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd4-us-west.apache.org (ASF Mail Server at spamd4-us-west.apache.org) with ESMTP id C3720C0EDB
	for <dev@httpd.apache.org>; Tue, 20 Oct 2015 09:24:58 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd4-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.1
X-Spam-Level:
X-Spam-Status: No, score=-0.1 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	SPF_PASS=-0.001, URIBL_BLOCKED=0.001] autolearn=disabled
Authentication-Results: spamd4-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd4-us-west.apache.org [10.40.0.11]) (amavisd-new, port 10024)
	with ESMTP id c0aVEtN6B_bG for <dev@httpd.apache.org>;
	Tue, 20 Oct 2015 09:24:50 +0000 (UTC)
Received: from mail-qk0-f178.google.com (mail-qk0-f178.google.com [209.85.220.178])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id 1E88A42B7B
	for <dev@httpd.apache.org>; Tue, 20 Oct 2015 09:24:50 +0000 (UTC)
Received: by qkfm62 with SMTP id m62so4621871qkf.1
        for <dev@httpd.apache.org>; Tue, 20 Oct 2015 02:24:50 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type:content-transfer-encoding;
        bh=WYJzGxZPaAfuXfAXi+XXRXj+JKabuGY56WLnsIt7AIQ=;
        b=o9inGJwPvx0Yq0/xsoGfabpLXs+ikqR0qMKdoLbrx6F4z37dCG0co3/4uFuvbxbugY
         h0oqNLyzo1He/H85Us0+Ao8hui7x7aunDxsKbTehVCh7eGffR/gp0q+AvphqcBRFepU0
         kwxgWUqKhZWEROBMNAxvOysYVSFexmOx6qJbMaOhU+VoBAaeGAn8z/jr/X0EcSXMMa16
         RQ+nISBGLHdD+0JEqp+7AuRlEB76FnBtmtkBK6LROeMBlyeZ2BmyDRMby/tp3IjynaZy
         XlF7RNf5kYTB9jFnBnyA3BsiyQBP0NA9xRIk9SzxHm36Fu+Hp+VVEejfqDyJKBOtMWsO
         pc+A==
MIME-Version: 1.0
X-Received: by 10.55.56.130 with SMTP id f124mr2272477qka.79.1445333089857;
 Tue, 20 Oct 2015 02:24:49 -0700 (PDT)
Received: by 10.55.156.213 with HTTP; Tue, 20 Oct 2015 02:24:49 -0700 (PDT)
In-Reply-To: <7B24F4D1-6904-4C00-A337-88F712026BE9@greenbytes.de>
References: <CAKQ1sVNchFx=egp=Q0tgT+1GcBXiten8mh9STetcZXOfJxhsjQ@mail.gmail.com>
	<CAKQ1sVPjcA9EYNpjcmM9=AU_LCgAsFntOcZnmGoHymds3S5wmA@mail.gmail.com>
	<AB1691BE05AE7F4992697F2A0835627AC6348972@VOEXM10W.internal.vodafone.com>
	<7B24F4D1-6904-4C00-A337-88F712026BE9@greenbytes.de>
Date: Tue, 20 Oct 2015 11:24:49 +0200
Message-ID: <CAKQ1sVNMu6iJDYAoPYOOeBXk63hhe-qBHkHNEdeHP5D5Nm1q4w@mail.gmail.com>
Subject: Re: Forwarded buckets' lifetime (was: [Bug 58503] segfault in apr_brigade_cleanup()...)
From: Yann Ylavic <ylavic.dev@gmail.com>
To: dev@httpd.apache.org
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: quoted-printable

On Tue, Oct 20, 2015 at 10:42 AM, Stefan Eissing
<stefan.eissing@greenbytes.de> wrote:
>
>> Am 20.10.2015 um 09:44 schrieb Pl=C3=BCm, R=C3=BCdiger, Vodafone Group <=
ruediger.pluem@vodafone.com>:
>>
>>> -----Original Message-----
>>> From: Yann Ylavic [mailto:ylavic.dev@gmail.com]
>>> Sent: Montag, 19. Oktober 2015 22:30
>>>>
>>>> https://bz.apache.org/bugzilla/show_bug.cgi?id=3D58503
>>>>
>>>> --- Comment #8 from Yann Ylavic <ylavic.dev@gmail.com> ---
>>>> (In reply to Ruediger Pluem from comment #7)
>>>>> Actually I think mod_proxy_wstunnel falls into the same pitfall
>>>>> mod_proxy_http was in and it needs to do the same / something similar
>>> then
>>>>> mod_proxy_http.c with
>>>>>
>>>>> proxy_buckets_lifetime_transform
>>>>
>>>>
>>>> We need to either use lifetime_transform like in proxy_http, or I was
>>>> thinking
>>>> of modifying all the input filters that create their buckets on f->r/c=
's
>>>> pool/bucket_alloc so that they now use their given bb->p and bb-
>>>> bucket_alloc.
>>
>> I don't think that this is a good idea, because bucket brigades sometime=
s have a longer lifetime
>> then the buckets that are created right now with f->r/c'spool/bucket_all=
oc. They get created and are kept
>> and only get cleared to avoid creating them over and over again. So this=
 step can open up a big
>> can of worms. Furthermore it is an API change, because currently the cal=
ler expects the buckets
>> are created with f->r/c'spool/bucket_alloc und you cannot change that ex=
pectation for 3rd party modules.
>>
>> So if at all a change for trunk only that requires a very deep review of=
 all brigade usages.
>
> As I learned, bucket brigades are very optimized for the common HTTP/1 ca=
se: appearing during one
> request and going away together with the request - preferably with only o=
ne thread involved.

What I proposed is precisely to let the caller of ap_get_brigade()
decide the lifetime of the buckets it gets, by the involved input
filters playing the game.
But I agree we would still need a "safe guard" like
bucket_lifetime_transform() which would do the right thing for
(third-party) buckets that do not match, whereas in the common case we
would avoid any copy.
I suspect this could also help the h2 case by having spare/recycled
brigades which could be shared/exchanged with the single writer on the
client connection.
I'm not sure this would break anything in 2.4.x, but since this is
quite theorical for now, let me try a first implementation which will
help me think more about the implications.

Regards,
Yann.

From dev-return-84367-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Tue Oct 20 09:28:40 2015
Return-Path: <dev-return-84367-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id D8C3F10660
	for <apmail-httpd-dev-archive@www.apache.org>; Tue, 20 Oct 2015 09:28:40 +0000 (UTC)
Received: (qmail 61255 invoked by uid 500); 20 Oct 2015 09:28:40 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 61186 invoked by uid 500); 20 Oct 2015 09:28:40 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 61176 invoked by uid 99); 20 Oct 2015 09:28:40 -0000
Received: from Unknown (HELO spamd3-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 20 Oct 2015 09:28:40 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd3-us-west.apache.org (ASF Mail Server at spamd3-us-west.apache.org) with ESMTP id D7671180A4C
	for <dev@httpd.apache.org>; Tue, 20 Oct 2015 09:28:39 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd3-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.11
X-Spam-Level:
X-Spam-Status: No, score=-0.11 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	SPF_PASS=-0.001, T_RP_MATCHES_RCVD=-0.01, URIBL_BLOCKED=0.001]
	autolearn=disabled
Authentication-Results: spamd3-us-west.apache.org (amavisd-new);
	dkim=pass (1024-bit key) header.d=greenbytes.de
Received: from mx1-us-west.apache.org ([10.40.0.8])
	by localhost (spamd3-us-west.apache.org [10.40.0.10]) (amavisd-new, port 10024)
	with ESMTP id QkqEGwaq0rtu for <dev@httpd.apache.org>;
	Tue, 20 Oct 2015 09:28:29 +0000 (UTC)
Received: from mail.greenbytes.de (mail.greenbytes.de [217.91.35.233])
	by mx1-us-west.apache.org (ASF Mail Server at mx1-us-west.apache.org) with ESMTPS id A6B6F2078F
	for <dev@httpd.apache.org>; Tue, 20 Oct 2015 09:28:28 +0000 (UTC)
Received: from [192.168.1.42] (unknown [5.10.171.186])
	(using TLSv1 with cipher ECDHE-RSA-AES256-SHA (256/256 bits))
	(Client did not present a certificate)
	by mail.greenbytes.de (Postfix) with ESMTPSA id 8173215A0098
	for <dev@httpd.apache.org>; Tue, 20 Oct 2015 11:28:26 +0200 (CEST)
DKIM-Signature: v=1; a=rsa-sha256; c=simple/simple; d=greenbytes.de; s=mail;
	t=1445333306; bh=0+C+Ac69vMRgKx4T/j9Sdmw5Gtr7ixQa91iNR2+0Sw4=;
	h=Subject:From:In-Reply-To:Date:References:To:From;
	b=B/FG3uUEh1UHwWYdV4+bq36/JwTMpqk6BX6Plbk25qtP73WrPXc2Sa+CO39kp3sIe
	 Vls0KbC0ffaXMIMOmlA/FQYy5qLrnCsqOJcwDXMYbuXNsl47vprhlUg1XDgLfnvWCK
	 HfV7OR1dyjf42joPOVHCUW+z+u1yptimBg2cerck=
Content-Type: text/plain; charset=utf-8
Mime-Version: 1.0 (Mac OS X Mail 9.0 \(3094\))
Subject: Re: Forwarded buckets' lifetime (was: [Bug 58503] segfault in apr_brigade_cleanup()...)
From: Stefan Eissing <stefan.eissing@greenbytes.de>
In-Reply-To: <CAKQ1sVNMu6iJDYAoPYOOeBXk63hhe-qBHkHNEdeHP5D5Nm1q4w@mail.gmail.com>
Date: Tue, 20 Oct 2015 11:28:25 +0200
Content-Transfer-Encoding: quoted-printable
Message-Id: <F05EAD21-1B45-43A0-AFF2-7D507594FD04@greenbytes.de>
References: <CAKQ1sVNchFx=egp=Q0tgT+1GcBXiten8mh9STetcZXOfJxhsjQ@mail.gmail.com> <CAKQ1sVPjcA9EYNpjcmM9=AU_LCgAsFntOcZnmGoHymds3S5wmA@mail.gmail.com> <AB1691BE05AE7F4992697F2A0835627AC6348972@VOEXM10W.internal.vodafone.com> <7B24F4D1-6904-4C00-A337-88F712026BE9@greenbytes.de> <CAKQ1sVNMu6iJDYAoPYOOeBXk63hhe-qBHkHNEdeHP5D5Nm1q4w@mail.gmail.com>
To: dev@httpd.apache.org
X-Mailer: Apple Mail (2.3094)

Let's do this. I will review and think about changes from the h2 =
angle...

> Am 20.10.2015 um 11:24 schrieb Yann Ylavic <ylavic.dev@gmail.com>:
>=20
> On Tue, Oct 20, 2015 at 10:42 AM, Stefan Eissing
> <stefan.eissing@greenbytes.de> wrote:
>>=20
>>> Am 20.10.2015 um 09:44 schrieb Pl=C3=BCm, R=C3=BCdiger, Vodafone =
Group <ruediger.pluem@vodafone.com>:
>>>=20
>>>> -----Original Message-----
>>>> From: Yann Ylavic [mailto:ylavic.dev@gmail.com]
>>>> Sent: Montag, 19. Oktober 2015 22:30
>>>>>=20
>>>>> https://bz.apache.org/bugzilla/show_bug.cgi?id=3D58503
>>>>>=20
>>>>> --- Comment #8 from Yann Ylavic <ylavic.dev@gmail.com> ---
>>>>> (In reply to Ruediger Pluem from comment #7)
>>>>>> Actually I think mod_proxy_wstunnel falls into the same pitfall
>>>>>> mod_proxy_http was in and it needs to do the same / something =
similar
>>>> then
>>>>>> mod_proxy_http.c with
>>>>>>=20
>>>>>> proxy_buckets_lifetime_transform
>>>>>=20
>>>>>=20
>>>>> We need to either use lifetime_transform like in proxy_http, or I =
was
>>>>> thinking
>>>>> of modifying all the input filters that create their buckets on =
f->r/c's
>>>>> pool/bucket_alloc so that they now use their given bb->p and bb-
>>>>> bucket_alloc.
>>>=20
>>> I don't think that this is a good idea, because bucket brigades =
sometimes have a longer lifetime
>>> then the buckets that are created right now with =
f->r/c'spool/bucket_alloc. They get created and are kept
>>> and only get cleared to avoid creating them over and over again. So =
this step can open up a big
>>> can of worms. Furthermore it is an API change, because currently the =
caller expects the buckets
>>> are created with f->r/c'spool/bucket_alloc und you cannot change =
that expectation for 3rd party modules.
>>>=20
>>> So if at all a change for trunk only that requires a very deep =
review of all brigade usages.
>>=20
>> As I learned, bucket brigades are very optimized for the common =
HTTP/1 case: appearing during one
>> request and going away together with the request - preferably with =
only one thread involved.
>=20
> What I proposed is precisely to let the caller of ap_get_brigade()
> decide the lifetime of the buckets it gets, by the involved input
> filters playing the game.
> But I agree we would still need a "safe guard" like
> bucket_lifetime_transform() which would do the right thing for
> (third-party) buckets that do not match, whereas in the common case we
> would avoid any copy.
> I suspect this could also help the h2 case by having spare/recycled
> brigades which could be shared/exchanged with the single writer on the
> client connection.
> I'm not sure this would break anything in 2.4.x, but since this is
> quite theorical for now, let me try a first implementation which will
> help me think more about the implications.
>=20
> Regards,
> Yann.


From dev-return-84368-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Tue Oct 20 09:37:36 2015
Return-Path: <dev-return-84368-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 5EFEE106B1
	for <apmail-httpd-dev-archive@www.apache.org>; Tue, 20 Oct 2015 09:37:36 +0000 (UTC)
Received: (qmail 86856 invoked by uid 500); 20 Oct 2015 09:37:01 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 86779 invoked by uid 500); 20 Oct 2015 09:37:01 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 86769 invoked by uid 99); 20 Oct 2015 09:37:01 -0000
Received: from Unknown (HELO spamd3-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 20 Oct 2015 09:37:01 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd3-us-west.apache.org (ASF Mail Server at spamd3-us-west.apache.org) with ESMTP id C3D991809A8
	for <dev@httpd.apache.org>; Tue, 20 Oct 2015 09:37:00 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd3-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.009
X-Spam-Level:
X-Spam-Status: No, score=-0.009 tagged_above=-999 required=6.31
	tests=[T_RP_MATCHES_RCVD=-0.01, URIBL_BLOCKED=0.001]
	autolearn=disabled
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd3-us-west.apache.org [10.40.0.10]) (amavisd-new, port 10024)
	with ESMTP id odfiKNL9Ckcz for <dev@httpd.apache.org>;
	Tue, 20 Oct 2015 09:36:50 +0000 (UTC)
Received: from monica.sharp.fm (monica.sharp.fm [80.168.143.5])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTP id 264E542B7B
	for <dev@httpd.apache.org>; Tue, 20 Oct 2015 09:36:50 +0000 (UTC)
Received: from [10.105.13.216] (unknown [5.56.169.82])
	(using TLSv1 with cipher DHE-RSA-AES256-SHA (256/256 bits))
	(Client did not present a certificate)
	(Authenticated sender: minfrin@sharp.fm)
	by monica.sharp.fm (Postfix) with ESMTPSA id 6DADC80546
	for <dev@httpd.apache.org>; Tue, 20 Oct 2015 10:36:49 +0100 (BST)
Content-Type: text/plain; charset=utf-8
Mime-Version: 1.0 (Mac OS X Mail 8.2 \(2104\))
Subject: Re: Forwarded buckets' lifetime (was: [Bug 58503] segfault in apr_brigade_cleanup()...)
From: Graham Leggett <minfrin@sharp.fm>
In-Reply-To: <7B24F4D1-6904-4C00-A337-88F712026BE9@greenbytes.de>
Date: Tue, 20 Oct 2015 11:36:48 +0200
Content-Transfer-Encoding: quoted-printable
Message-Id: <0D5B13DA-8642-4662-9606-6B5DF94EB87B@sharp.fm>
References: <CAKQ1sVNchFx=egp=Q0tgT+1GcBXiten8mh9STetcZXOfJxhsjQ@mail.gmail.com> <CAKQ1sVPjcA9EYNpjcmM9=AU_LCgAsFntOcZnmGoHymds3S5wmA@mail.gmail.com> <AB1691BE05AE7F4992697F2A0835627AC6348972@VOEXM10W.internal.vodafone.com> <7B24F4D1-6904-4C00-A337-88F712026BE9@greenbytes.de>
To: dev@httpd.apache.org
X-Mailer: Apple Mail (2.2104)

On 20 Oct 2015, at 10:42 AM, Stefan Eissing =
<stefan.eissing@greenbytes.de> wrote:

>> So if at all a change for trunk only that requires a very deep review =
of all brigade usages.
>=20
> As I learned, bucket brigades are very optimized for the common HTTP/1 =
case: appearing during one
> request and going away together with the request - preferably with =
only one thread involved.
>=20
> When (sub-)request are used - and you may look at HTTP/2 processing as =
involving sub-requests, this
> model no longer holds and such functionality has a heavy price to pay. =
It needs to step very
> carefully to avoid the pitfalls of pool destroy cleanups on EOR.

I=E2=80=99m not fully following why this involves a heavy price - we =
already have (and have solved) the same problem in the proxy. The proxy =
welds backend conn_rec=E2=80=99s to frontend conn_rec=E2=80=99s, while =
mod_http2 welds a child conn_rec to a parent conn_rec.

In the proxy case the EOR bucket only ever lives in one conn_rec, as =
long as you stick to that - ie destroy the EOR bucket in the child =
conn_rec, it should work fine.

> Given the complexity and the modules out there, I do not think it wise =
to change the behaviour
> of the existing apr_bucket_brigade in 2.4.x. I think it is better to =
think of an alternate bucket
> brigade design and maybe how that could live next to the old one in =
2.4.x. Or skip 2.4.x entirely
> for this.

I am very wary of alternate designs that throw away the investment the =
community has made in existing code, existing tooling, and existing =
knowledge. I would far rather we fix these bugs in the current design =
than try come up with alternatives.

So far, all the work I=E2=80=99ve done in expanding support for async =
filters has simply involved finding and fixing bugs.

Regards,
Graham
=E2=80=94


From dev-return-84369-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Tue Oct 20 09:38:29 2015
Return-Path: <dev-return-84369-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 059DD106C0
	for <apmail-httpd-dev-archive@www.apache.org>; Tue, 20 Oct 2015 09:38:29 +0000 (UTC)
Received: (qmail 89836 invoked by uid 500); 20 Oct 2015 09:38:28 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 89476 invoked by uid 500); 20 Oct 2015 09:38:28 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 89427 invoked by uid 99); 20 Oct 2015 09:38:28 -0000
Received: from Unknown (HELO spamd2-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 20 Oct 2015 09:38:28 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd2-us-west.apache.org (ASF Mail Server at spamd2-us-west.apache.org) with ESMTP id 8E3CE1A2021
	for <dev@httpd.apache.org>; Tue, 20 Oct 2015 09:38:27 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd2-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 1
X-Spam-Level: *
X-Spam-Status: No, score=1 tagged_above=-999 required=6.31
	tests=[KAM_LAZY_DOMAIN_SECURITY=1, SPF_HELO_PASS=-0.001,
	URIBL_BLOCKED=0.001] autolearn=disabled
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd2-us-west.apache.org [10.40.0.9]) (amavisd-new, port 10024)
	with ESMTP id Fge7gGphEiOo for <dev@httpd.apache.org>;
	Tue, 20 Oct 2015 09:38:16 +0000 (UTC)
Received: from mail1.bemta14.messagelabs.com (mail1.bemta14.messagelabs.com [193.109.254.108])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id 4A30E42B7B
	for <dev@httpd.apache.org>; Tue, 20 Oct 2015 09:38:16 +0000 (UTC)
Received: from [193.109.255.99] by server-4.bemta-14.messagelabs.com id A4/3B-10715-18B06265; Tue, 20 Oct 2015 09:38:09 +0000
X-Env-Sender: ruediger.pluem@vodafone.com
X-Msg-Ref: server-3.tower-48.messagelabs.com!1445333888!3138039!1
X-Originating-IP: [195.232.244.134]
X-StarScan-Received:
X-StarScan-Version: 7.19.2; banners=-,-,-
X-VirusChecked: Checked
Received: (qmail 27743 invoked from network); 20 Oct 2015 09:38:09 -0000
Received: from mailout02.vodafone.com (HELO mailout02.vodafone.com) (195.232.244.134)
  by server-3.tower-48.messagelabs.com with DHE-RSA-AES256-SHA encrypted SMTP; 20 Oct 2015 09:38:09 -0000
Received: from mailint01.vodafone.com (mailint01.vodafone.com [195.232.244.198])
	by mailout02.vodafone.com (Postfix) with ESMTP id 3ng8yS5ztWzbdN5
	for <dev@httpd.apache.org>; Tue, 20 Oct 2015 11:38:08 +0200 (CEST)
Received: from mailint01.vodafone.com (localhost [127.0.0.1])
	by mailint01.vodafone.com (Postfix) with ESMTP id 3ng8yS4zrTzfg26
	for <dev@httpd.apache.org>; Tue, 20 Oct 2015 11:38:08 +0200 (CEST)
Received: from VOEXC02W.internal.vodafone.com (voexc02w.dc-ratingen.de [145.230.101.22])
	(using TLSv1 with cipher AES128-SHA (128/128 bits))
	(No client certificate requested)
	by mailint01.vodafone.com (Postfix) with ESMTPS id 3ng8yS4v39zfg1L
	for <dev@httpd.apache.org>; Tue, 20 Oct 2015 11:38:08 +0200 (CEST)
Received: from AVOEXC04W.internal.vodafone.com (145.230.15.142) by
 VOEXC02W.internal.vodafone.com (145.230.101.22) with Microsoft SMTP Server
 (TLS) id 14.3.224.2; Tue, 20 Oct 2015 11:38:08 +0200
Received: from VOEXM10W.internal.vodafone.com ([169.254.2.88]) by
 AVOEXC04W.internal.vodafone.com ([145.230.15.142]) with mapi id
 14.03.0224.002; Tue, 20 Oct 2015 11:38:07 +0200
From: =?utf-8?B?UGzDvG0sIFLDvGRpZ2VyLCBWb2RhZm9uZSBHcm91cA==?=
	<ruediger.pluem@vodafone.com>
To: "dev@httpd.apache.org" <dev@httpd.apache.org>
Subject: RE: [users@httpd] Chunked transfer delay with httpd 2.4 on Windows.
Thread-Topic: [users@httpd] Chunked transfer delay with httpd 2.4 on Windows.
Thread-Index: AQHRCsKp6VHmLQpuNE+WM3OmAfdh+J5zadyAgAAcCICAAF4bAIAAJXpg///pRwCAAC1QoA==
Date: Tue, 20 Oct 2015 09:38:06 +0000
Message-ID: <AB1691BE05AE7F4992697F2A0835627AC6348C38@VOEXM10W.internal.vodafone.com>
References: <5625642E.30708@ptc.com>
	<CAKQ1sVPceAVuDMNgt-qGomU6EARQap5HpCbvaPPiwtYXsUvRpg@mail.gmail.com>
	<CALK=YjM5CvMgWAWT=X67JxBdaJDJ5PCFsHJijSEs0bKovFnQtQ@mail.gmail.com>
	<5625A5E7.2070309@ptc.com>
	<CAKQ1sVPRX_st3SWAnF30C62qxTNqjHiSV3iaCHFPr1HLGp_CxA@mail.gmail.com>
	<AB1691BE05AE7F4992697F2A0835627AC63489F4@VOEXM10W.internal.vodafone.com>
 <CAKQ1sVMhNzYPWHTvhdeV6z+mV2ZNq5vjHj=W1d6R46cOQ_-qhQ@mail.gmail.com>
In-Reply-To: <CAKQ1sVMhNzYPWHTvhdeV6z+mV2ZNq5vjHj=W1d6R46cOQ_-qhQ@mail.gmail.com>
Accept-Language: en-US
Content-Language: en-US
X-MS-Has-Attach:
X-MS-TNEF-Correlator:
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
MIME-Version: 1.0

DQoNCj4gLS0tLS1PcmlnaW5hbCBNZXNzYWdlLS0tLS0NCj4gRnJvbTogWWFubiBZbGF2aWMgW21h
aWx0bzp5bGF2aWMuZGV2QGdtYWlsLmNvbV0NCj4gU2VudDogRGllbnN0YWcsIDIwLiBPa3RvYmVy
IDIwMTUgMTA6NTQNCj4gVG86IGRldkBodHRwZC5hcGFjaGUub3JnDQo+IFN1YmplY3Q6IFJlOiBb
dXNlcnNAaHR0cGRdIENodW5rZWQgdHJhbnNmZXIgZGVsYXkgd2l0aCBodHRwZCAyLjQgb24NCj4g
V2luZG93cy4NCj4gDQo+IE9uIFR1ZSwgT2N0IDIwLCAyMDE1IGF0IDEwOjE3IEFNLCBQbMO8bSwg
UsO8ZGlnZXIsIFZvZGFmb25lIEdyb3VwDQo+IDxydWVkaWdlci5wbHVlbUB2b2RhZm9uZS5jb20+
IHdyb3RlOg0KPiA+DQo+ID4gT3IgaXMgdGhpcyBzb21ldGhpbmcgd2l0aCBtb2Rfamsgbm90IGNv
cnJlY3RseSBzZW5kaW5nIGFuIEVPUz8gRG9lcyB0aGlzDQo+IGhhcHBlbiB3aXRoIG1vZF9wcm94
eV9hanAgYXMgd2VsbD8NCj4gDQo+IElmIHRoYXQgd2FzIHRoZSBjYXNlLCBJIHRoaW5rIHdlIHdv
dWxkbid0IGVudGVyIHRoZSBrZWVwYWxpdmUgc3RhdGUsDQoNCldoeSBub3Q/IElmIHRoZSBoYW5k
bGVyIG9mIG1vZF9qayB3b3VsZCBqdXN0IHNlbnQgdGhlIGRhdGEgaW4gYSBicmlnYWRlIHdpdGhv
dXQgYW4gRU9TDQphbmQgdGhlbiBleGl0IHdpdGggSFRUUF9PSyB5b3UgSU1ITyB3b3VsZCBnZXQg
dGhlcmUuDQoNClJlZ2FyZHMNCg0KUsO8ZGlnZXINCg==

From dev-return-84370-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Tue Oct 20 10:14:22 2015
Return-Path: <dev-return-84370-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 163241085F
	for <apmail-httpd-dev-archive@www.apache.org>; Tue, 20 Oct 2015 10:14:22 +0000 (UTC)
Received: (qmail 60198 invoked by uid 500); 20 Oct 2015 10:14:13 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 60114 invoked by uid 500); 20 Oct 2015 10:14:13 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 60104 invoked by uid 99); 20 Oct 2015 10:14:13 -0000
Received: from Unknown (HELO spamd1-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 20 Oct 2015 10:14:13 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd1-us-west.apache.org (ASF Mail Server at spamd1-us-west.apache.org) with ESMTP id 396B5C2CD5
	for <dev@httpd.apache.org>; Tue, 20 Oct 2015 10:14:13 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd1-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.8
X-Spam-Level:
X-Spam-Status: No, score=-0.8 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RCVD_IN_DNSWL_LOW=-0.7, SPF_PASS=-0.001, URIBL_BLOCKED=0.001]
	autolearn=disabled
Authentication-Results: spamd1-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-us-west.apache.org ([10.40.0.8])
	by localhost (spamd1-us-west.apache.org [10.40.0.7]) (amavisd-new, port 10024)
	with ESMTP id joi_U7xndU9B for <dev@httpd.apache.org>;
	Tue, 20 Oct 2015 10:14:07 +0000 (UTC)
Received: from mail-qg0-f50.google.com (mail-qg0-f50.google.com [209.85.192.50])
	by mx1-us-west.apache.org (ASF Mail Server at mx1-us-west.apache.org) with ESMTPS id DBAD820FE0
	for <dev@httpd.apache.org>; Tue, 20 Oct 2015 10:14:06 +0000 (UTC)
Received: by qgad10 with SMTP id d10so10000094qga.3
        for <dev@httpd.apache.org>; Tue, 20 Oct 2015 03:14:06 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type:content-transfer-encoding;
        bh=llnQ2gzxr2v/0HtjA30w5UZmhQFMLEDPOyheo4iqTIs=;
        b=Lvvehmz648Emv5JaBfV9txMiZC6cf114EItCNg6REBm2G1HBveq4wH50I/4kKHdoqC
         IA9LInHlfeEPbZ1hDDiUkgZHtrvv+KzGeVoBooNxKIGlEwesJuVadFcI9NEym1SPlJ5u
         m3gr8xreT6trAL/n6wpn2ExLKlZCoZFds8eIXZWpMhWKyTL6mTkOknWb4Yjfwnid9mUu
         JcauFHx4BAQBWWKLDWsqozWALVaKyC0Q8OnUL6qZPtdhT8ddYrDh0Mg70EPJdvbltoe7
         kOp6TfngbHmIrsXl/gLRiweZONu5LinlwMqAuXuOTtR6t5wTtC9lTLXp6lrlhm6Hz5rv
         Nwkg==
MIME-Version: 1.0
X-Received: by 10.141.23.9 with SMTP id z9mr2792423qhd.24.1445336046169; Tue,
 20 Oct 2015 03:14:06 -0700 (PDT)
Received: by 10.55.156.213 with HTTP; Tue, 20 Oct 2015 03:14:06 -0700 (PDT)
In-Reply-To: <AB1691BE05AE7F4992697F2A0835627AC6348C38@VOEXM10W.internal.vodafone.com>
References: <5625642E.30708@ptc.com>
	<CAKQ1sVPceAVuDMNgt-qGomU6EARQap5HpCbvaPPiwtYXsUvRpg@mail.gmail.com>
	<CALK=YjM5CvMgWAWT=X67JxBdaJDJ5PCFsHJijSEs0bKovFnQtQ@mail.gmail.com>
	<5625A5E7.2070309@ptc.com>
	<CAKQ1sVPRX_st3SWAnF30C62qxTNqjHiSV3iaCHFPr1HLGp_CxA@mail.gmail.com>
	<AB1691BE05AE7F4992697F2A0835627AC63489F4@VOEXM10W.internal.vodafone.com>
	<CAKQ1sVMhNzYPWHTvhdeV6z+mV2ZNq5vjHj=W1d6R46cOQ_-qhQ@mail.gmail.com>
	<AB1691BE05AE7F4992697F2A0835627AC6348C38@VOEXM10W.internal.vodafone.com>
Date: Tue, 20 Oct 2015 12:14:06 +0200
Message-ID: <CAKQ1sVNHz_aCLZ3um-NV8cJGnhR3FtE6wz+zGgusvW=MA+cO_A@mail.gmail.com>
Subject: Re: [users@httpd] Chunked transfer delay with httpd 2.4 on Windows.
From: Yann Ylavic <ylavic.dev@gmail.com>
To: dev@httpd.apache.org
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: quoted-printable

On Tue, Oct 20, 2015 at 11:38 AM, Pl=C3=BCm, R=C3=BCdiger, Vodafone Group
<ruediger.pluem@vodafone.com> wrote:
>
>
>> -----Original Message-----
>> From: Yann Ylavic [mailto:ylavic.dev@gmail.com]
>> Sent: Dienstag, 20. Oktober 2015 10:54
>> To: dev@httpd.apache.org
>> Subject: Re: [users@httpd] Chunked transfer delay with httpd 2.4 on
>> Windows.
>>
>> On Tue, Oct 20, 2015 at 10:17 AM, Pl=C3=BCm, R=C3=BCdiger, Vodafone Grou=
p
>> <ruediger.pluem@vodafone.com> wrote:
>> >
>> > Or is this something with mod_jk not correctly sending an EOS? Does th=
is
>> happen with mod_proxy_ajp as well?
>>
>> If that was the case, I think we wouldn't enter the keepalive state,
>
> Why not? If the handler of mod_jk would just sent the data in a brigade w=
ithout an EOS
> and then exit with HTTP_OK you IMHO would get there.

Good point, let's see the log.

From dev-return-84371-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Tue Oct 20 10:20:04 2015
Return-Path: <dev-return-84371-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id DD07E1088D
	for <apmail-httpd-dev-archive@www.apache.org>; Tue, 20 Oct 2015 10:20:04 +0000 (UTC)
Received: (qmail 72256 invoked by uid 500); 20 Oct 2015 10:20:04 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 72179 invoked by uid 500); 20 Oct 2015 10:20:04 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 72169 invoked by uid 99); 20 Oct 2015 10:20:04 -0000
Received: from Unknown (HELO spamd4-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 20 Oct 2015 10:20:04 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd4-us-west.apache.org (ASF Mail Server at spamd4-us-west.apache.org) with ESMTP id C187EC0F11
	for <dev@httpd.apache.org>; Tue, 20 Oct 2015 10:20:03 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd4-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.101
X-Spam-Level:
X-Spam-Status: No, score=-0.101 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RCVD_IN_MSPIKE_H2=-0.001, SPF_PASS=-0.001, URIBL_BLOCKED=0.001]
	autolearn=disabled
Authentication-Results: spamd4-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd4-us-west.apache.org [10.40.0.11]) (amavisd-new, port 10024)
	with ESMTP id VS2mMWDVq7Jf for <dev@httpd.apache.org>;
	Tue, 20 Oct 2015 10:19:57 +0000 (UTC)
Received: from mail-qg0-f53.google.com (mail-qg0-f53.google.com [209.85.192.53])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id 8830E42BEB
	for <dev@httpd.apache.org>; Tue, 20 Oct 2015 10:19:57 +0000 (UTC)
Received: by qgbb65 with SMTP id b65so10120002qgb.2
        for <dev@httpd.apache.org>; Tue, 20 Oct 2015 03:19:51 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type:content-transfer-encoding;
        bh=d5NKDrHGitxcD8bhyMQaDgCy6hGCIQLv7kZX6G+stAs=;
        b=qGhv9Dd55CkfiaoxIvGX06XFkcLnpO455pQKfVZUi/kgIhT7D6hfW6wgs0Nythwn3G
         3Ep6DcbPPsnJA3Q2Wjmt6rwMSxITlZ/QlVMLWfia6jinm8Bc7M5cN1E4uckObsZ1+Yc6
         9qNYqgL4z9473Ic/qzb7RfuXrrezRWbia+To4rddo7F8StECxcIjYighwAxvNIsqw56a
         eYMJ7ghR6/Yu+Jq3sFyXI7arsNgxJOEsI7lY9jHe5oIl2bP00IXv0xoHpm0LZnHuht7O
         3RYUSgeyf7o+sQUcbBH8zftO6mBJpQi3TKabQj1/48fKQxQyOvRn3ZbXIoMTQn5nVH9N
         qizQ==
MIME-Version: 1.0
X-Received: by 10.140.131.198 with SMTP id 189mr2759115qhd.83.1445336391487;
 Tue, 20 Oct 2015 03:19:51 -0700 (PDT)
Received: by 10.55.156.213 with HTTP; Tue, 20 Oct 2015 03:19:51 -0700 (PDT)
In-Reply-To: <CAKQ1sVNHz_aCLZ3um-NV8cJGnhR3FtE6wz+zGgusvW=MA+cO_A@mail.gmail.com>
References: <5625642E.30708@ptc.com>
	<CAKQ1sVPceAVuDMNgt-qGomU6EARQap5HpCbvaPPiwtYXsUvRpg@mail.gmail.com>
	<CALK=YjM5CvMgWAWT=X67JxBdaJDJ5PCFsHJijSEs0bKovFnQtQ@mail.gmail.com>
	<5625A5E7.2070309@ptc.com>
	<CAKQ1sVPRX_st3SWAnF30C62qxTNqjHiSV3iaCHFPr1HLGp_CxA@mail.gmail.com>
	<AB1691BE05AE7F4992697F2A0835627AC63489F4@VOEXM10W.internal.vodafone.com>
	<CAKQ1sVMhNzYPWHTvhdeV6z+mV2ZNq5vjHj=W1d6R46cOQ_-qhQ@mail.gmail.com>
	<AB1691BE05AE7F4992697F2A0835627AC6348C38@VOEXM10W.internal.vodafone.com>
	<CAKQ1sVNHz_aCLZ3um-NV8cJGnhR3FtE6wz+zGgusvW=MA+cO_A@mail.gmail.com>
Date: Tue, 20 Oct 2015 12:19:51 +0200
Message-ID: <CAKQ1sVO_E2AZBL9CPfpm=_RQEnHWRDWNg67NFKCqy-vC=uoJBw@mail.gmail.com>
Subject: Re: [users@httpd] Chunked transfer delay with httpd 2.4 on Windows.
From: Yann Ylavic <ylavic.dev@gmail.com>
To: dev@httpd.apache.org
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: quoted-printable

On Tue, Oct 20, 2015 at 12:14 PM, Yann Ylavic <ylavic.dev@gmail.com> wrote:
> On Tue, Oct 20, 2015 at 11:38 AM, Pl=C3=BCm, R=C3=BCdiger, Vodafone Group
> <ruediger.pluem@vodafone.com> wrote:
>>
>>
>>> -----Original Message-----
>>> From: Yann Ylavic [mailto:ylavic.dev@gmail.com]
>>> Sent: Dienstag, 20. Oktober 2015 10:54
>>> To: dev@httpd.apache.org
>>> Subject: Re: [users@httpd] Chunked transfer delay with httpd 2.4 on
>>> Windows.
>>>
>>> On Tue, Oct 20, 2015 at 10:17 AM, Pl=C3=BCm, R=C3=BCdiger, Vodafone Gro=
up
>>> <ruediger.pluem@vodafone.com> wrote:
>>> >
>>> > Or is this something with mod_jk not correctly sending an EOS? Does t=
his
>>> happen with mod_proxy_ajp as well?
>>>
>>> If that was the case, I think we wouldn't enter the keepalive state,
>>
>> Why not? If the handler of mod_jk would just sent the data in a brigade =
without an EOS
>> and then exit with HTTP_OK you IMHO would get there.
>
> Good point, let's see the log.

mod_dumpio's traces (level TRACE7) could be helpful here, Andy?

From dev-return-84372-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Tue Oct 20 15:17:52 2015
Return-Path: <dev-return-84372-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id D5A491836A
	for <apmail-httpd-dev-archive@www.apache.org>; Tue, 20 Oct 2015 15:17:52 +0000 (UTC)
Received: (qmail 27001 invoked by uid 500); 20 Oct 2015 15:17:52 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 26920 invoked by uid 500); 20 Oct 2015 15:17:52 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 26911 invoked by uid 99); 20 Oct 2015 15:17:52 -0000
Received: from mail-relay.apache.org (HELO mail-relay.apache.org) (140.211.11.15)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 20 Oct 2015 15:17:52 +0000
Received: from mail-ob0-f171.google.com (mail-ob0-f171.google.com [209.85.214.171])
	by mail-relay.apache.org (ASF Mail Server at mail-relay.apache.org) with ESMTPSA id D6C911A093D
	for <dev@httpd.apache.org>; Tue, 20 Oct 2015 15:17:51 +0000 (UTC)
Received: by obbwb3 with SMTP id wb3so16787000obb.0
        for <dev@httpd.apache.org>; Tue, 20 Oct 2015 08:17:51 -0700 (PDT)
X-Gm-Message-State: ALoCoQk2fM1LF+C57hA8PPHxxq2p8tzPTVnW/CIbzKcnaL9biM9QA22ovUVCTwePL0MUiLH7ecff
MIME-Version: 1.0
X-Received: by 10.60.155.162 with SMTP id vx2mr2298930oeb.49.1445354271270;
 Tue, 20 Oct 2015 08:17:51 -0700 (PDT)
Received: by 10.76.88.39 with HTTP; Tue, 20 Oct 2015 08:17:51 -0700 (PDT)
In-Reply-To: <20151019155455.655162f0@baldur>
References: <F26CAC6B-20F9-48DB-9F63-840067826293@sharp.fm>
	<1445260816.3909.61.camel@mimir.webthing.com>
	<8FC296F6-273A-4E97-B68A-CCC10B68CD2C@sharp.fm>
	<20151019155455.655162f0@baldur>
Date: Tue, 20 Oct 2015 08:17:51 -0700
Message-ID: <CAMDeyhwuooC11KMiDO2K2b2QwaCtEDdCBx9Wzx_LGbc0HXLu_g@mail.gmail.com>
Subject: Re: XSLT filter for httpd
From: Paul Querna <pquerna@apache.org>
To: httpd <dev@httpd.apache.org>
Cc: Edward Rudd <urkle@outoforder.cc>, Christian Parpart <trapni@gentoo.org>
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: quoted-printable

On Mon, Oct 19, 2015 at 7:54 AM, Nick Kew <niq@apache.org> wrote:
> On Mon, 19 Oct 2015 15:39:06 +0200
> Graham Leggett <minfrin@sharp.fm> wrote:
>
>> > Note, mod_transform is GPL.  Originally my decision when I released
>> > its earlier predecessor, before I was part of the dev@httpd team.
>> > I'd be happy to re-license it as Apache, and I don't think
>> > any of my co-developers would object.
>>
>> I=E2=80=99ve been using mod_transform v0.6.0 for a while, and have wante=
d to develop it further. It would be a great starting point.
>
> I have a distant recollection of consulting Paul and Edward about
> re-licensing, then dropping the ball on it.  IIRC the outcome was,
> they were both happy to re-license, but there had also been one
> or two third-party patches raising a questionmark over whether we
> should consult anyone else.
>
> Cc: Paul.  Do you recollect that?  You still in contact with Edward?

I have no objections to relicensing mod_transform, Adding Edward and
Christian, the only other people with commits in afaik:

https://github.com/OutOfOrder/mod_transform/commits/master

 I'm not sure I believe in belongs in HTTP Server project itself, I
think it has had a fine life as an external module, and github is
doing fine for basic maintenance, but I'll bow to people with energy
if y'all really want it under the ASF domain.

From dev-return-84373-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Tue Oct 20 16:14:35 2015
Return-Path: <dev-return-84373-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 43218186BD
	for <apmail-httpd-dev-archive@www.apache.org>; Tue, 20 Oct 2015 16:14:35 +0000 (UTC)
Received: (qmail 62548 invoked by uid 500); 20 Oct 2015 16:14:34 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 62491 invoked by uid 500); 20 Oct 2015 16:14:34 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 62481 invoked by uid 99); 20 Oct 2015 16:14:34 -0000
Received: from Unknown (HELO spamd3-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 20 Oct 2015 16:14:34 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd3-us-west.apache.org (ASF Mail Server at spamd3-us-west.apache.org) with ESMTP id 1A742180A4F
	for <dev@httpd.apache.org>; Tue, 20 Oct 2015 16:14:34 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd3-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.111
X-Spam-Level:
X-Spam-Status: No, score=-0.111 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	SPF_PASS=-0.001, T_RP_MATCHES_RCVD=-0.01] autolearn=disabled
Authentication-Results: spamd3-us-west.apache.org (amavisd-new);
	dkim=pass (1024-bit key) header.d=greenbytes.de
Received: from mx1-us-west.apache.org ([10.40.0.8])
	by localhost (spamd3-us-west.apache.org [10.40.0.10]) (amavisd-new, port 10024)
	with ESMTP id NfKmmhijS8yC for <dev@httpd.apache.org>;
	Tue, 20 Oct 2015 16:14:33 +0000 (UTC)
Received: from mail.greenbytes.de (mail.greenbytes.de [217.91.35.233])
	by mx1-us-west.apache.org (ASF Mail Server at mx1-us-west.apache.org) with ESMTPS id E100320FE0
	for <dev@httpd.apache.org>; Tue, 20 Oct 2015 16:14:32 +0000 (UTC)
Received: from [192.168.1.42] (unknown [217.91.35.233])
	(using TLSv1 with cipher ECDHE-RSA-AES256-SHA (256/256 bits))
	(Client did not present a certificate)
	by mail.greenbytes.de (Postfix) with ESMTPSA id 304AD15A0448
	for <dev@httpd.apache.org>; Tue, 20 Oct 2015 18:14:31 +0200 (CEST)
DKIM-Signature: v=1; a=rsa-sha256; c=simple/simple; d=greenbytes.de; s=mail;
	t=1445357671; bh=qbehkA/L3rZVVp2PHvDqAkCO0b+Atq72O1Su5/x54Zg=;
	h=From:Subject:Date:To:From;
	b=lATcphqsKsuCQWBZzh+k8jpKgVzxn8fmAzvUOVNapYRWf43b+bfKsdlPgPkk8TMSs
	 C1hmz+AtrgsVRcJKquzzwkdw9xFJ0S5PdGqkhxJTr8K8VXZJz0zq6I3sv1qy8AZ+Wi
	 OA8XWDYbZWccyl+8SORvXexSLWZpmkeQwb5nMxh0=
From: Stefan Eissing <stefan.eissing@greenbytes.de>
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: quoted-printable
Subject: master connections
Message-Id: <EF4EF523-EAC1-47B6-9953-93973051C46C@greenbytes.de>
Date: Tue, 20 Oct 2015 18:14:30 +0200
To: dev@httpd.apache.org
Mime-Version: 1.0 (Mac OS X Mail 9.0 \(3094\))
X-Mailer: Apple Mail (2.3094)

In /trunk we have the master connection member of conn_rec which we =
cannot backport to 2.4.x - as I understand.

Question: can I use a conn_rec->notes entry to hold the master conn_rec =
of a 2.4.x slave connection? Or is there some better way to do this?

Background: I would like to add master connection handling for SSL var =
lookups and stop brutal-inheriting the mod_ssl config onto slave =
connections (which is dangerous and a hack).

Thoughts?

//Stefan=

From dev-return-84374-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Tue Oct 20 16:17:14 2015
Return-Path: <dev-return-84374-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id D827D186D3
	for <apmail-httpd-dev-archive@www.apache.org>; Tue, 20 Oct 2015 16:17:14 +0000 (UTC)
Received: (qmail 69478 invoked by uid 500); 20 Oct 2015 16:16:40 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 69399 invoked by uid 500); 20 Oct 2015 16:16:40 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 69389 invoked by uid 99); 20 Oct 2015 16:16:40 -0000
Received: from Unknown (HELO spamd2-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 20 Oct 2015 16:16:40 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd2-us-west.apache.org (ASF Mail Server at spamd2-us-west.apache.org) with ESMTP id 0C2841A2021
	for <dev@httpd.apache.org>; Tue, 20 Oct 2015 16:16:40 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd2-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.11
X-Spam-Level:
X-Spam-Status: No, score=-0.11 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	T_RP_MATCHES_RCVD=-0.01] autolearn=disabled
Authentication-Results: spamd2-us-west.apache.org (amavisd-new);
	dkim=pass (1024-bit key) header.d=ptc.com
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd2-us-west.apache.org [10.40.0.9]) (amavisd-new, port 10024)
	with ESMTP id aOchK3gUe_96 for <dev@httpd.apache.org>;
	Tue, 20 Oct 2015 16:16:33 +0000 (UTC)
Received: from mx2.ptc.com (mx2.ptc.com [12.11.148.189])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id 572B442BEB
	for <dev@httpd.apache.org>; Tue, 20 Oct 2015 16:16:33 +0000 (UTC)
DKIM-Signature: v=1; a=rsa-sha256; c=simple/simple;
  d=ptc.com; s=ptc; t=1445357793; x=1476893793;
  h=subject:to:references:from:message-id:date:mime-version:
   in-reply-to:content-transfer-encoding;
  bh=WEdD9IAYVlTo9gJ/8FzlmJo6wzobApHsTDLdAQNARGY=;
  b=UFzpG0PBv1tRu1Gq0B87aXxZUoXGmpaNqGY7+gfzBdKhh0TW96o15obi
   CyYIIqJcJ7i6cchU0hIvqRWVOrPXfS0/YplFkFUippBMRWOzcGI77mdbK
   gB45UF2aMb1Vd0qsJ6z7ln/Zv47mcgfswmnr0Gp3YI2In2CehWE80YvzC
   Y=;
X-IronPort-AV: E=Sophos;i="5.17,707,1437451200"; 
   d="scan'208";a="28317341"
Received: from hq-x10prdhub2.ptcnet.ptc.com ([132.253.198.28])
  by mx2-int.ptc.com with ESMTP/TLS/AES128-SHA; 20 Oct 2015 12:16:27 -0400
Received: from awang.ptcnet.ptc.com (132.253.8.73) by
 int-mail-hub2.ptcnet.ptc.com (132.253.201.252) with Microsoft SMTP Server id
 14.3.123.3; Tue, 20 Oct 2015 12:16:27 -0400
Subject: Re: [users@httpd] Chunked transfer delay with httpd 2.4 on Windows.
To: <dev@httpd.apache.org>
References: <5625642E.30708@ptc.com>
 <CAKQ1sVPceAVuDMNgt-qGomU6EARQap5HpCbvaPPiwtYXsUvRpg@mail.gmail.com>
 <CALK=YjM5CvMgWAWT=X67JxBdaJDJ5PCFsHJijSEs0bKovFnQtQ@mail.gmail.com>
 <5625A5E7.2070309@ptc.com>
 <CAKQ1sVPRX_st3SWAnF30C62qxTNqjHiSV3iaCHFPr1HLGp_CxA@mail.gmail.com>
 <AB1691BE05AE7F4992697F2A0835627AC63489F4@VOEXM10W.internal.vodafone.com>
 <CAKQ1sVMhNzYPWHTvhdeV6z+mV2ZNq5vjHj=W1d6R46cOQ_-qhQ@mail.gmail.com>
 <AB1691BE05AE7F4992697F2A0835627AC6348C38@VOEXM10W.internal.vodafone.com>
 <CAKQ1sVNHz_aCLZ3um-NV8cJGnhR3FtE6wz+zGgusvW=MA+cO_A@mail.gmail.com>
 <CAKQ1sVO_E2AZBL9CPfpm=_RQEnHWRDWNg67NFKCqy-vC=uoJBw@mail.gmail.com>
From: Andy Wang <awang@ptc.com>
Message-ID: <562668DA.5060804@ptc.com>
Date: Tue, 20 Oct 2015 11:16:26 -0500
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:38.0) Gecko/20100101
 Thunderbird/38.3.0
MIME-Version: 1.0
In-Reply-To: <CAKQ1sVO_E2AZBL9CPfpm=_RQEnHWRDWNg67NFKCqy-vC=uoJBw@mail.gmail.com>
Content-Type: text/plain; charset="utf-8"; format=flowed
Content-Transfer-Encoding: 7bit
X-Originating-IP: [132.253.8.73]



On 10/20/2015 05:19 AM, Yann Ylavic wrote:

>
> mod_dumpio's traces (level TRACE7) could be helpful here, Andy?
>

I'll reconfigure to get that in a bit today.
I'll also try with mod_proxy_ajp as well to see if the same occurs.

Thanks,
Andy

From dev-return-84375-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Tue Oct 20 16:17:46 2015
Return-Path: <dev-return-84375-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 07F64186E1
	for <apmail-httpd-dev-archive@www.apache.org>; Tue, 20 Oct 2015 16:17:46 +0000 (UTC)
Received: (qmail 70808 invoked by uid 500); 20 Oct 2015 16:17:23 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 70716 invoked by uid 500); 20 Oct 2015 16:17:23 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 70706 invoked by uid 99); 20 Oct 2015 16:17:23 -0000
Received: from Unknown (HELO spamd3-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 20 Oct 2015 16:17:23 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd3-us-west.apache.org (ASF Mail Server at spamd3-us-west.apache.org) with ESMTP id 27D61180A4F
	for <dev@httpd.apache.org>; Tue, 20 Oct 2015 16:17:23 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd3-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.01
X-Spam-Level:
X-Spam-Status: No, score=-0.01 tagged_above=-999 required=6.31
	tests=[SPF_PASS=-0.001, T_RP_MATCHES_RCVD=-0.01, URIBL_BLOCKED=0.001]
	autolearn=disabled
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd3-us-west.apache.org [10.40.0.10]) (amavisd-new, port 10024)
	with ESMTP id I-a_tkxyU2jE for <dev@httpd.apache.org>;
	Tue, 20 Oct 2015 16:17:08 +0000 (UTC)
Received: from monica.sharp.fm (monica.sharp.fm [80.168.143.5])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTP id 7249B20751
	for <dev@httpd.apache.org>; Tue, 20 Oct 2015 16:17:07 +0000 (UTC)
Received: from [10.105.13.216] (unknown [5.56.169.82])
	(using TLSv1 with cipher DHE-RSA-AES256-SHA (256/256 bits))
	(Client did not present a certificate)
	(Authenticated sender: minfrin@sharp.fm)
	by monica.sharp.fm (Postfix) with ESMTPSA id 4CB2C80184
	for <dev@httpd.apache.org>; Tue, 20 Oct 2015 17:17:01 +0100 (BST)
Content-Type: text/plain; charset=utf-8
Mime-Version: 1.0 (Mac OS X Mail 8.2 \(2104\))
Subject: Re: master connections
From: Graham Leggett <minfrin@sharp.fm>
In-Reply-To: <EF4EF523-EAC1-47B6-9953-93973051C46C@greenbytes.de>
Date: Tue, 20 Oct 2015 18:16:56 +0200
Content-Transfer-Encoding: quoted-printable
Message-Id: <808F3456-7F06-4A45-ADE6-E2C30CE35224@sharp.fm>
References: <EF4EF523-EAC1-47B6-9953-93973051C46C@greenbytes.de>
To: dev@httpd.apache.org
X-Mailer: Apple Mail (2.2104)

On 20 Oct 2015, at 6:14 PM, Stefan Eissing =
<stefan.eissing@greenbytes.de> wrote:

> In /trunk we have the master connection member of conn_rec which we =
cannot backport to 2.4.x - as I understand.

We can do, as long as the value goes at the very end of the struct, and =
we have a minor MMN bump in ap_mmn.h.

Regards,
Graham
=E2=80=94


From dev-return-84376-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Tue Oct 20 16:26:04 2015
Return-Path: <dev-return-84376-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 7EA5518751
	for <apmail-httpd-dev-archive@www.apache.org>; Tue, 20 Oct 2015 16:26:04 +0000 (UTC)
Received: (qmail 10773 invoked by uid 500); 20 Oct 2015 16:26:04 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 10696 invoked by uid 500); 20 Oct 2015 16:26:04 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 10686 invoked by uid 99); 20 Oct 2015 16:26:03 -0000
Received: from Unknown (HELO spamd1-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 20 Oct 2015 16:26:03 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd1-us-west.apache.org (ASF Mail Server at spamd1-us-west.apache.org) with ESMTP id 876E6C3AFE
	for <dev@httpd.apache.org>; Tue, 20 Oct 2015 16:26:03 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd1-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 0.001
X-Spam-Level:
X-Spam-Status: No, score=0.001 tagged_above=-999 required=6.31
	tests=[RP_MATCHES_RCVD=0.001, SPF_PASS=-0.001, URIBL_BLOCKED=0.001]
	autolearn=disabled
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd1-us-west.apache.org [10.40.0.7]) (amavisd-new, port 10024)
	with ESMTP id 9W11nbZ4OJFY for <dev@httpd.apache.org>;
	Tue, 20 Oct 2015 16:25:57 +0000 (UTC)
Received: from mailserver.kippdata.de (capsella.kippdata.de [195.227.30.149])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTP id 093A342BEB
	for <dev@httpd.apache.org>; Tue, 20 Oct 2015 16:25:56 +0000 (UTC)
Received: from [10.0.110.6] ([10.16.239.129])
	by mailserver.kippdata.de (8.13.5/8.13.5) with ESMTP id t9KGPoiq011405
	for <dev@httpd.apache.org>; Tue, 20 Oct 2015 18:25:50 +0200 (CEST)
Subject: Re: [users@httpd] Chunked transfer delay with httpd 2.4 on Windows.
To: dev@httpd.apache.org
References: <5625642E.30708@ptc.com>
 <CAKQ1sVPceAVuDMNgt-qGomU6EARQap5HpCbvaPPiwtYXsUvRpg@mail.gmail.com>
 <CALK=YjM5CvMgWAWT=X67JxBdaJDJ5PCFsHJijSEs0bKovFnQtQ@mail.gmail.com>
 <5625A5E7.2070309@ptc.com>
 <CAKQ1sVPRX_st3SWAnF30C62qxTNqjHiSV3iaCHFPr1HLGp_CxA@mail.gmail.com>
 <AB1691BE05AE7F4992697F2A0835627AC63489F4@VOEXM10W.internal.vodafone.com>
 <CAKQ1sVMhNzYPWHTvhdeV6z+mV2ZNq5vjHj=W1d6R46cOQ_-qhQ@mail.gmail.com>
 <AB1691BE05AE7F4992697F2A0835627AC6348C38@VOEXM10W.internal.vodafone.com>
From: Rainer Jung <rainer.jung@kippdata.de>
Message-ID: <56266B0B.8030106@kippdata.de>
Date: Tue, 20 Oct 2015 18:25:47 +0200
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:38.0) Gecko/20100101
 Thunderbird/38.3.0
MIME-Version: 1.0
In-Reply-To: <AB1691BE05AE7F4992697F2A0835627AC6348C38@VOEXM10W.internal.vodafone.com>
Content-Type: text/plain; charset=utf-8; format=flowed
Content-Transfer-Encoding: 8bit

Am 20.10.2015 um 11:38 schrieb Plüm, Rüdiger, Vodafone Group:
>
>
>> -----Original Message-----
>> From: Yann Ylavic [mailto:ylavic.dev@gmail.com]
>> Sent: Dienstag, 20. Oktober 2015 10:54
>> To: dev@httpd.apache.org
>> Subject: Re: [users@httpd] Chunked transfer delay with httpd 2.4 on
>> Windows.
>>
>> On Tue, Oct 20, 2015 at 10:17 AM, Plüm, Rüdiger, Vodafone Group
>> <ruediger.pluem@vodafone.com> wrote:
>>>
>>> Or is this something with mod_jk not correctly sending an EOS? Does this
>> happen with mod_proxy_ajp as well?
>>
>> If that was the case, I think we wouldn't enter the keepalive state,
>
> Why not? If the handler of mod_jk would just sent the data in a brigade without an EOS
> and then exit with HTTP_OK you IMHO would get there.

mod_jk gets the data from the backend via AJP as chunks and for each 
chunk it received, it simply calls ap_rwrite() to let the web server 
send it to the client.

It does not directly interact with buckets or brigades.

Regards,

Rainer


From dev-return-84377-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Tue Oct 20 19:23:38 2015
Return-Path: <dev-return-84377-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 5C721171FF
	for <apmail-httpd-dev-archive@www.apache.org>; Tue, 20 Oct 2015 19:23:38 +0000 (UTC)
Received: (qmail 38904 invoked by uid 500); 20 Oct 2015 19:23:22 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 38828 invoked by uid 500); 20 Oct 2015 19:23:22 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 38817 invoked by uid 99); 20 Oct 2015 19:23:22 -0000
Received: from Unknown (HELO spamd2-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 20 Oct 2015 19:23:22 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd2-us-west.apache.org (ASF Mail Server at spamd2-us-west.apache.org) with ESMTP id A7DED1A2CC0
	for <dev@httpd.apache.org>; Tue, 20 Oct 2015 19:23:21 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd2-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 3.99
X-Spam-Level: ***
X-Spam-Status: No, score=3.99 tagged_above=-999 required=6.31
	tests=[HTML_MESSAGE=3, KAM_LAZY_DOMAIN_SECURITY=1,
	T_RP_MATCHES_RCVD=-0.01] autolearn=disabled
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd2-us-west.apache.org [10.40.0.9]) (amavisd-new, port 10024)
	with ESMTP id 2avVla4JwrHK for <dev@httpd.apache.org>;
	Tue, 20 Oct 2015 19:23:19 +0000 (UTC)
Received: from oldblue.lightblue.com (oldblue.lightblue.com [83.105.78.194])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTP id 8967420750
	for <dev@httpd.apache.org>; Tue, 20 Oct 2015 19:23:18 +0000 (UTC)
Received: from [83.105.78.212] by oldblue.lightblue.com (GMS
 15.01.3664/KW9347.00.a5a499dd) with ESMTP id urziuaaa for
 dev@httpd.apache.org; Tue, 20 Oct 2015 20:22:47 +0100
Reply-To: <jlewis@lightblue.com>
From: "John Dougrez-Lewis" <jlewis@lightblue.com>
To: <dev@httpd.apache.org>
Subject: Apache Module Development Query on character encodings.
Date: Tue, 20 Oct 2015 20:23:02 +0100
Organization: Light Blue Ltd
Message-ID: <15f001d10b6c$bcbc0ff0$36342fd0$@com>
MIME-Version: 1.0
Content-Type: multipart/alternative;
	boundary="----=_NextPart_000_15F1_01D10B75.1E8077F0"
X-Mailer: Microsoft Office Outlook 12.0
Thread-Index: AdELbLykKbsrySNXSjSdGiWYeU5XUQ==
Content-Language: en-gb

This is a multi-part message in MIME format.

------=_NextPart_000_15F1_01D10B75.1E8077F0
Content-Type: text/plain;
	charset="US-ASCII"
Content-Transfer-Encoding: 7bit

Hi,

 

I'm considering writing an Apache Module that will involve using libxml2 and
CLucene. 

 

I need to be able to service and respond to requests as follows:

 

For processing with libxml2:

 

Request Input character encoding => UTF-8 

processing of UTF-8

UTF-8 => Response output character encoding

 

For processing with CLucene:

 

Request Input character encoding => UCS-2 (fixed width 16-bit Unicode)

processing of UCS-2

UCS-2  => Response output character encoding

 

I'm new to Apache Modules, but have read Nick Kew's book (which is very
good).

 

The input and output buffers appears to be 8-bit char* based but I can't see
any references to specific encodings.

 

How do I go about massaging the input & output into UTF-8 and fixed width
16-bit Unicode?

 

Are there any good references on how to achieve this?

 

 

Regards,

 

John

 

--

John Dougrez-Lewis

 


------=_NextPart_000_15F1_01D10B75.1E8077F0
Content-Type: text/html;
	charset="US-ASCII"
Content-Transfer-Encoding: quoted-printable

<html xmlns:v=3D"urn:schemas-microsoft-com:vml" =
xmlns:o=3D"urn:schemas-microsoft-com:office:office" =
xmlns:w=3D"urn:schemas-microsoft-com:office:word" =
xmlns:m=3D"http://schemas.microsoft.com/office/2004/12/omml" =
xmlns=3D"http://www.w3.org/TR/REC-html40"><head><meta =
http-equiv=3DContent-Type content=3D"text/html; =
charset=3Dus-ascii"><meta name=3DGenerator content=3D"Microsoft Word 12 =
(filtered medium)"><style><!--
/* Font Definitions */
@font-face
	{font-family:"Cambria Math";
	panose-1:2 4 5 3 5 4 6 3 2 4;}
@font-face
	{font-family:Calibri;
	panose-1:2 15 5 2 2 2 4 3 2 4;}
@font-face
	{font-family:Consolas;
	panose-1:2 11 6 9 2 2 4 3 2 4;}
/* Style Definitions */
p.MsoNormal, li.MsoNormal, div.MsoNormal
	{margin:0cm;
	margin-bottom:.0001pt;
	font-size:11.0pt;
	font-family:"Calibri","sans-serif";}
a:link, span.MsoHyperlink
	{mso-style-priority:99;
	color:blue;
	text-decoration:underline;}
a:visited, span.MsoHyperlinkFollowed
	{mso-style-priority:99;
	color:purple;
	text-decoration:underline;}
span.EmailStyle17
	{mso-style-type:personal-compose;
	font-family:"Calibri","sans-serif";
	color:windowtext;}
.MsoChpDefault
	{mso-style-type:export-only;}
@page WordSection1
	{size:612.0pt 792.0pt;
	margin:72.0pt 72.0pt 72.0pt 72.0pt;}
div.WordSection1
	{page:WordSection1;}
--></style><!--[if gte mso 9]><xml>
<o:shapedefaults v:ext=3D"edit" spidmax=3D"1026" />
</xml><![endif]--><!--[if gte mso 9]><xml>
<o:shapelayout v:ext=3D"edit">
<o:idmap v:ext=3D"edit" data=3D"1" />
</o:shapelayout></xml><![endif]--></head><body lang=3DEN-GB link=3Dblue =
vlink=3Dpurple><div class=3DWordSection1><p =
class=3DMsoNormal>Hi,<o:p></o:p></p><p =
class=3DMsoNormal><o:p>&nbsp;</o:p></p><p class=3DMsoNormal>I&#8217;m =
considering writing an Apache Module that will involve using libxml2 and =
CLucene. <o:p></o:p></p><p class=3DMsoNormal><o:p>&nbsp;</o:p></p><p =
class=3DMsoNormal>I need to be able to service and respond to requests =
as follows:<o:p></o:p></p><p class=3DMsoNormal><o:p>&nbsp;</o:p></p><p =
class=3DMsoNormal>For processing with libxml2:<o:p></o:p></p><p =
class=3DMsoNormal><o:p>&nbsp;</o:p></p><p class=3DMsoNormal>Request =
Input character encoding =3D&gt; UTF-8 <o:p></o:p></p><p =
class=3DMsoNormal>processing of UTF-8<o:p></o:p></p><p =
class=3DMsoNormal>UTF-8 =3D&gt; Response output character =
encoding<o:p></o:p></p><p class=3DMsoNormal><o:p>&nbsp;</o:p></p><p =
class=3DMsoNormal>For processing with CLucene:<o:p></o:p></p><p =
class=3DMsoNormal><o:p>&nbsp;</o:p></p><p class=3DMsoNormal>Request =
Input character encoding =3D&gt; UCS-2 (fixed width 16-bit =
Unicode)<o:p></o:p></p><p class=3DMsoNormal>processing of =
UCS-2<o:p></o:p></p><p class=3DMsoNormal>UCS-2&nbsp; =3D&gt; Response =
output character encoding<o:p></o:p></p><p =
class=3DMsoNormal><o:p>&nbsp;</o:p></p><p class=3DMsoNormal>I&#8217;m =
new to Apache Modules, but have read Nick Kew&#8217;s book (which is =
very good).<o:p></o:p></p><p class=3DMsoNormal><o:p>&nbsp;</o:p></p><p =
class=3DMsoNormal>The input and output buffers appears to be 8-bit char* =
based but I can&#8217;t see any references to specific =
encodings.<o:p></o:p></p><p class=3DMsoNormal><o:p>&nbsp;</o:p></p><p =
class=3DMsoNormal>How do I go about massaging the input &amp; output =
into UTF-8 and fixed width 16-bit Unicode?<o:p></o:p></p><p =
class=3DMsoNormal><o:p>&nbsp;</o:p></p><p class=3DMsoNormal>Are there =
any good references on how to achieve this?<o:p></o:p></p><p =
class=3DMsoNormal><o:p>&nbsp;</o:p></p><p =
class=3DMsoNormal><o:p>&nbsp;</o:p></p><p =
class=3DMsoNormal>Regards,<o:p></o:p></p><p =
class=3DMsoNormal><o:p>&nbsp;</o:p></p><p =
class=3DMsoNormal>John<o:p></o:p></p><p =
class=3DMsoNormal><o:p>&nbsp;</o:p></p><p class=3DMsoNormal><span =
style=3D'font-size:10.5pt;font-family:Consolas'>--<o:p></o:p></span></p><=
p class=3DMsoNormal><span =
style=3D'font-size:10.5pt;font-family:Consolas'>John =
Dougrez-Lewis<o:p></o:p></span></p><p =
class=3DMsoNormal><o:p>&nbsp;</o:p></p></div></body></html>
------=_NextPart_000_15F1_01D10B75.1E8077F0--


From dev-return-84378-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Tue Oct 20 19:58:22 2015
Return-Path: <dev-return-84378-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id BA7271746F
	for <apmail-httpd-dev-archive@www.apache.org>; Tue, 20 Oct 2015 19:58:22 +0000 (UTC)
Received: (qmail 53648 invoked by uid 500); 20 Oct 2015 19:58:20 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 53580 invoked by uid 500); 20 Oct 2015 19:58:20 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 53568 invoked by uid 99); 20 Oct 2015 19:58:20 -0000
Received: from Unknown (HELO spamd1-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 20 Oct 2015 19:58:20 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd1-us-west.apache.org (ASF Mail Server at spamd1-us-west.apache.org) with ESMTP id 5A571C396B
	for <dev@httpd.apache.org>; Tue, 20 Oct 2015 19:58:20 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd1-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.1
X-Spam-Level:
X-Spam-Status: No, score=-0.1 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RP_MATCHES_RCVD=0.001, SPF_PASS=-0.001] autolearn=disabled
Authentication-Results: spamd1-us-west.apache.org (amavisd-new);
	dkim=pass (1024-bit key) header.d=ptc.com
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd1-us-west.apache.org [10.40.0.7]) (amavisd-new, port 10024)
	with ESMTP id NLhdKqIqsmiv for <dev@httpd.apache.org>;
	Tue, 20 Oct 2015 19:58:13 +0000 (UTC)
Received: from mx2.ptc.com (mx2.ptc.com [12.11.148.189])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id 60C4620925
	for <dev@httpd.apache.org>; Tue, 20 Oct 2015 19:58:12 +0000 (UTC)
DKIM-Signature: v=1; a=rsa-sha256; c=simple/simple;
  d=ptc.com; s=ptc; t=1445371092; x=1476907092;
  h=subject:to:references:from:message-id:date:mime-version:
   in-reply-to:content-transfer-encoding;
  bh=zaYYiGLqAtuZ3ISXSkRcVd0T68+3OC6/Yi42RyV1HSs=;
  b=XKc2S1dh4IfX1EQd4m0btHFfl7mYYi/ASd41LIeJFYkAo7jVNQEsZMcw
   WCUECmumKNp32ZqdLxG5n7lkUgxgXHlWh/n8nSp70l9sgfSZZfqWVG8Ao
   sUynNIvFyXz4g4AOKEuRNGW70dVcxN0cfFYwIuIdX1ImOkST9Z8MDUASY
   M=;
X-IronPort-AV: E=Sophos;i="5.17,708,1437451200"; 
   d="scan'208";a="28340597"
Received: from hq-x10prdhub1.ptcnet.ptc.com ([132.253.198.27])
  by mx2-int.ptc.com with ESMTP/TLS/AES128-SHA; 20 Oct 2015 15:57:50 -0400
Received: from awang.ptcnet.ptc.com (132.253.8.73) by
 int-mail-hub1.ptcnet.ptc.com (132.253.201.252) with Microsoft SMTP Server id
 14.3.123.3; Tue, 20 Oct 2015 15:57:50 -0400
Subject: Re: [users@httpd] Chunked transfer delay with httpd 2.4 on Windows.
To: <dev@httpd.apache.org>
References: <5625642E.30708@ptc.com>
 <CAKQ1sVPceAVuDMNgt-qGomU6EARQap5HpCbvaPPiwtYXsUvRpg@mail.gmail.com>
 <CALK=YjM5CvMgWAWT=X67JxBdaJDJ5PCFsHJijSEs0bKovFnQtQ@mail.gmail.com>
 <5625A5E7.2070309@ptc.com>
 <CAKQ1sVPRX_st3SWAnF30C62qxTNqjHiSV3iaCHFPr1HLGp_CxA@mail.gmail.com>
 <AB1691BE05AE7F4992697F2A0835627AC63489F4@VOEXM10W.internal.vodafone.com>
 <CAKQ1sVMhNzYPWHTvhdeV6z+mV2ZNq5vjHj=W1d6R46cOQ_-qhQ@mail.gmail.com>
 <AB1691BE05AE7F4992697F2A0835627AC6348C38@VOEXM10W.internal.vodafone.com>
 <CAKQ1sVNHz_aCLZ3um-NV8cJGnhR3FtE6wz+zGgusvW=MA+cO_A@mail.gmail.com>
 <CAKQ1sVO_E2AZBL9CPfpm=_RQEnHWRDWNg67NFKCqy-vC=uoJBw@mail.gmail.com>
 <562668DA.5060804@ptc.com>
From: Andy Wang <awang@ptc.com>
Message-ID: <56269CBD.5060701@ptc.com>
Date: Tue, 20 Oct 2015 14:57:49 -0500
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:38.0) Gecko/20100101
 Thunderbird/38.3.0
MIME-Version: 1.0
In-Reply-To: <562668DA.5060804@ptc.com>
Content-Type: text/plain; charset="utf-8"; format=flowed
Content-Transfer-Encoding: 7bit
X-Originating-IP: [132.253.8.73]



On 10/20/2015 11:16 AM, Andy Wang wrote:
>
>
> On 10/20/2015 05:19 AM, Yann Ylavic wrote:
>
>>
>> mod_dumpio's traces (level TRACE7) could be helpful here, Andy?
>>
>
> I'll reconfigure to get that in a bit today.
> I'll also try with mod_proxy_ajp as well to see if the same occurs.


mod_proxy_ajp has the same behavior.
Here's the output from mod_dumpio - lemme know if you'd like the raw 
file.  I'd have to figure out how to make it available somewhere after 
sanitizing a few things.

[Tue Oct 20 14:53:53.800924 2015] [dumpio:trace7] [pid 5228:tid 2776] 
mod_dumpio.c(164): [client 132.253.8.198:55373] mod_dumpio: dumpio_out
[Tue Oct 20 14:53:53.800924 2015] [dumpio:trace7] [pid 5228:tid 2776] 
mod_dumpio.c(58): [client 132.253.8.198:55373] mod_dumpio:  dumpio_out 
(data-HEAP): 362 bytes
[Tue Oct 20 14:53:53.800924 2015] [dumpio:trace7] [pid 5228:tid 2776] 
mod_dumpio.c(100): [client 132.253.8.198:55373] mod_dumpio:  dumpio_out 
(data-HEAP): HTTP/1.1 200 OK\r\nDate: Tue, 20 Oct 2015 19:53:53 
GMT\r\nServer: Apache/2.4.16 (Win64)\r\nX-Frame-Options: 
SAMEORIGIN\r\nExpires: Thu, 01 Jan 1970 00:00:00 GMT\r\nCache-Control: 
no-cache\r\nContent-Type: text/html;charset=UTF-8\r\nVary: 
Accept-Encoding,User-Agent\r\nContent-Encoding: gzip\r\nKeep-Alive: 
timeout=5, max=100\r\nConnection: Keep-Alive\r\nTransfer-Encoding: 
chunked\r\n\r\n
[Tue Oct 20 14:53:53.800924 2015] [dumpio:trace7] [pid 5228:tid 2776] 
mod_dumpio.c(164): [client 132.253.8.198:55373] mod_dumpio: dumpio_out
[Tue Oct 20 14:53:53.800924 2015] [dumpio:trace7] [pid 5228:tid 2776] 
mod_dumpio.c(58): [client 132.253.8.198:55373] mod_dumpio:  dumpio_out 
(data-TRANSIENT): 4 bytes
[Tue Oct 20 14:53:53.800924 2015] [dumpio:trace7] [pid 5228:tid 2776] 
mod_dumpio.c(100): [client 132.253.8.198:55373] mod_dumpio:  dumpio_out 
(data-TRANSIENT): 1e\r\n
[Tue Oct 20 14:53:53.800924 2015] [dumpio:trace7] [pid 5228:tid 2776] 
mod_dumpio.c(58): [client 132.253.8.198:55373] mod_dumpio:  dumpio_out 
(data-IMMORTAL): 10 bytes
[Tue Oct 20 14:53:53.800924 2015] [dumpio:trace7] [pid 5228:tid 2776] 
mod_dumpio.c(100): [client 132.253.8.198:55373] mod_dumpio:  dumpio_out 
(data-IMMORTAL): \x1f\x8b\b
[Tue Oct 20 14:53:53.800924 2015] [dumpio:trace7] [pid 5228:tid 2776] 
mod_dumpio.c(58): [client 132.253.8.198:55373] mod_dumpio:  dumpio_out 
(data-HEAP): 20 bytes
[Tue Oct 20 14:53:53.800924 2015] [dumpio:trace7] [pid 5228:tid 2776] 
mod_dumpio.c(100): [client 132.253.8.198:55373] mod_dumpio:  dumpio_out 
(data-HEAP): \x8a\x8a\x02\x02\xab\x92\xd4\xe2\x12+\x10+\x8a\x97\v
[Tue Oct 20 14:53:53.800924 2015] [dumpio:trace7] [pid 5228:tid 2776] 
mod_dumpio.c(58): [client 132.253.8.198:55373] mod_dumpio:  dumpio_out 
(data-IMMORTAL): 2 bytes
[Tue Oct 20 14:53:53.800924 2015] [dumpio:trace7] [pid 5228:tid 2776] 
mod_dumpio.c(100): [client 132.253.8.198:55373] mod_dumpio:  dumpio_out 
(data-IMMORTAL): \r\n
[Tue Oct 20 14:53:53.800924 2015] [dumpio:trace7] [pid 5228:tid 2776] 
mod_dumpio.c(58): [client 132.253.8.198:55373] mod_dumpio:  dumpio_out 
(metadata-FLUSH): 0 bytes
[Tue Oct 20 14:53:53.800924 2015] [dumpio:trace7] [pid 5228:tid 2776] 
mod_dumpio.c(164): [client 132.253.8.198:55373] mod_dumpio: dumpio_out
[Tue Oct 20 14:53:53.800924 2015] [dumpio:trace7] [pid 5228:tid 2776] 
mod_dumpio.c(58): [client 132.253.8.198:55373] mod_dumpio:  dumpio_out 
(data-TRANSIENT): 3 bytes
[Tue Oct 20 14:53:53.800924 2015] [dumpio:trace7] [pid 5228:tid 2776] 
mod_dumpio.c(100): [client 132.253.8.198:55373] mod_dumpio:  dumpio_out 
(data-TRANSIENT): a\r\n
[Tue Oct 20 14:53:53.800924 2015] [dumpio:trace7] [pid 5228:tid 2776] 
mod_dumpio.c(58): [client 132.253.8.198:55373] mod_dumpio:  dumpio_out 
(data-HEAP): 2 bytes
[Tue Oct 20 14:53:53.800924 2015] [dumpio:trace7] [pid 5228:tid 2776] 
mod_dumpio.c(100): [client 132.253.8.198:55373] mod_dumpio:  dumpio_out 
(data-HEAP): \x03
[Tue Oct 20 14:53:53.800924 2015] [dumpio:trace7] [pid 5228:tid 2776] 
mod_dumpio.c(58): [client 132.253.8.198:55373] mod_dumpio:  dumpio_out 
(data-POOL): 8 bytes
[Tue Oct 20 14:53:53.800924 2015] [dumpio:trace7] [pid 5228:tid 2776] 
mod_dumpio.c(100): [client 132.253.8.198:55373] mod_dumpio:  dumpio_out 
(data-POOL): \xfe\x8e\xed\xee\x12
[Tue Oct 20 14:53:53.800924 2015] [dumpio:trace7] [pid 5228:tid 2776] 
mod_dumpio.c(58): [client 132.253.8.198:55373] mod_dumpio:  dumpio_out 
(data-IMMORTAL): 2 bytes
[Tue Oct 20 14:53:53.800924 2015] [dumpio:trace7] [pid 5228:tid 2776] 
mod_dumpio.c(100): [client 132.253.8.198:55373] mod_dumpio:  dumpio_out 
(data-IMMORTAL): \r\n
[Tue Oct 20 14:53:53.800924 2015] [dumpio:trace7] [pid 5228:tid 2776] 
mod_dumpio.c(58): [client 132.253.8.198:55373] mod_dumpio:  dumpio_out 
(data-IMMORTAL): 5 bytes
[Tue Oct 20 14:53:53.800924 2015] [dumpio:trace7] [pid 5228:tid 2776] 
mod_dumpio.c(100): [client 132.253.8.198:55373] mod_dumpio:  dumpio_out 
(data-IMMORTAL): 0\r\n\r\n
[Tue Oct 20 14:53:53.800924 2015] [dumpio:trace7] [pid 5228:tid 2776] 
mod_dumpio.c(58): [client 132.253.8.198:55373] mod_dumpio:  dumpio_out 
(metadata-EOS): 0 bytes
[Tue Oct 20 14:53:53.800924 2015] [dumpio:trace7] [pid 5228:tid 2776] 
mod_dumpio.c(164): [client 132.253.8.198:55373] mod_dumpio: dumpio_out
[Tue Oct 20 14:53:53.800924 2015] [dumpio:trace7] [pid 5228:tid 2776] 
mod_dumpio.c(58): [client 132.253.8.198:55373] mod_dumpio:  dumpio_out 
(metadata-EOR): 0 bytes
[Tue Oct 20 14:53:53.800924 2015] [dumpio:trace7] [pid 5228:tid 2776] 
mod_dumpio.c(135): [client 132.253.8.198:55373] mod_dumpio: dumpio_in 
[speculative-nonblocking] 1 readbytes
[Tue Oct 20 14:53:53.800924 2015] [dumpio:trace7] [pid 5228:tid 2776] 
mod_dumpio.c(58): [client 132.253.8.198:55373] mod_dumpio:  dumpio_in 
(data-HEAP): 1 bytes
[Tue Oct 20 14:53:53.800924 2015] [dumpio:trace7] [pid 5228:tid 2776] 
mod_dumpio.c(100): [client 132.253.8.198:55373] mod_dumpio:  dumpio_in 
(data-HEAP): \n
[Tue Oct 20 14:53:53.800924 2015] [dumpio:trace7] [pid 5228:tid 2776] 
mod_dumpio.c(135): [client 132.253.8.198:55373] mod_dumpio: dumpio_in 
[getline-blocking] 0 readbytes
[Tue Oct 20 14:53:53.800924 2015] [dumpio:trace7] [pid 5228:tid 2776] 
mod_dumpio.c(58): [client 132.253.8.198:55373] mod_dumpio:  dumpio_in 
(data-HEAP): 1 bytes
[Tue Oct 20 14:53:53.800924 2015] [dumpio:trace7] [pid 5228:tid 2776] 
mod_dumpio.c(100): [client 132.253.8.198:55373] mod_dumpio:  dumpio_in 
(data-HEAP): \n
[Tue Oct 20 14:53:53.800924 2015] [dumpio:trace7] [pid 5228:tid 2776] 
mod_dumpio.c(135): [client 132.253.8.198:55373] mod_dumpio: dumpio_in 
[getline-blocking] 0 readbytes
[Tue Oct 20 14:53:58.801084 2015] [dumpio:trace7] [pid 5228:tid 2776] 
mod_dumpio.c(150): [client 132.253.8.198:55373] mod_dumpio: dumpio_in - 
70007
[Tue Oct 20 14:53:58.801084 2015] [dumpio:trace7] [pid 5228:tid 2776] 
mod_dumpio.c(164): [client 132.253.8.198:55373] mod_dumpio: dumpio_out
[Tue Oct 20 14:53:58.801084 2015] [dumpio:trace7] [pid 5228:tid 2776] 
mod_dumpio.c(58): [client 132.253.8.198:55373] mod_dumpio:  dumpio_out 
(metadata-FLUSH): 0 bytes
[Tue Oct 20 14:53:58.801084 2015] [dumpio:trace7] [pid 5228:tid 2776] 
mod_dumpio.c(58): [client 132.253.8.198:55373] mod_dumpio:  dumpio_out 
(metadata-EOC): 0 bytes

From dev-return-84379-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Tue Oct 20 20:00:09 2015
Return-Path: <dev-return-84379-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id E102717497
	for <apmail-httpd-dev-archive@www.apache.org>; Tue, 20 Oct 2015 20:00:09 +0000 (UTC)
Received: (qmail 56275 invoked by uid 500); 20 Oct 2015 19:59:47 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 56212 invoked by uid 500); 20 Oct 2015 19:59:47 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 56202 invoked by uid 99); 20 Oct 2015 19:59:47 -0000
Received: from Unknown (HELO spamd1-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 20 Oct 2015 19:59:47 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd1-us-west.apache.org (ASF Mail Server at spamd1-us-west.apache.org) with ESMTP id D851EC396B
	for <dev@httpd.apache.org>; Tue, 20 Oct 2015 19:59:46 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd1-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.1
X-Spam-Level:
X-Spam-Status: No, score=-0.1 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RP_MATCHES_RCVD=0.001, SPF_PASS=-0.001] autolearn=disabled
Authentication-Results: spamd1-us-west.apache.org (amavisd-new);
	dkim=pass (1024-bit key) header.d=ptc.com
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd1-us-west.apache.org [10.40.0.7]) (amavisd-new, port 10024)
	with ESMTP id w2SvTk0JvMJZ for <dev@httpd.apache.org>;
	Tue, 20 Oct 2015 19:59:40 +0000 (UTC)
Received: from mx2.ptc.com (mx2.ptc.com [12.11.148.189])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id 6802B20750
	for <dev@httpd.apache.org>; Tue, 20 Oct 2015 19:59:39 +0000 (UTC)
DKIM-Signature: v=1; a=rsa-sha256; c=simple/simple;
  d=ptc.com; s=ptc; t=1445371179; x=1476907179;
  h=subject:to:references:from:message-id:date:mime-version:
   in-reply-to:content-transfer-encoding;
  bh=CLght+jHDHWI0hklB1nvHPuEIjAqTRt2ydiTG21gw4g=;
  b=qqNyBm8IqYHfypjuwKzTFNQQOaM/mLQrQ9OyVToUP2/tBsPVQOzjQJUI
   tkIiqBArfn/lKKR2KocOhApjejhNv8tZ3XC58/s/et6ly6qP3vJX2Bd3+
   Hl5cyLuzLorMpJx+J7uLbnGrScYMfAe7jNJf8j8VpCLzT9WwuZRnez7U7
   E=;
X-IronPort-AV: E=Sophos;i="5.17,708,1437451200"; 
   d="scan'208";a="28340640"
Received: from hq-x10prdhub2.ptcnet.ptc.com ([132.253.198.28])
  by mx2-int.ptc.com with ESMTP/TLS/AES128-SHA; 20 Oct 2015 15:59:38 -0400
Received: from awang.ptcnet.ptc.com (132.253.8.73) by
 int-mail-hub2.ptcnet.ptc.com (132.253.201.252) with Microsoft SMTP Server id
 14.3.123.3; Tue, 20 Oct 2015 15:59:38 -0400
Subject: Re: [users@httpd] Chunked transfer delay with httpd 2.4 on Windows.
To: <dev@httpd.apache.org>
References: <5625642E.30708@ptc.com>
 <CAKQ1sVPceAVuDMNgt-qGomU6EARQap5HpCbvaPPiwtYXsUvRpg@mail.gmail.com>
 <CALK=YjM5CvMgWAWT=X67JxBdaJDJ5PCFsHJijSEs0bKovFnQtQ@mail.gmail.com>
 <5625A5E7.2070309@ptc.com>
 <CAKQ1sVPRX_st3SWAnF30C62qxTNqjHiSV3iaCHFPr1HLGp_CxA@mail.gmail.com>
 <AB1691BE05AE7F4992697F2A0835627AC63489F4@VOEXM10W.internal.vodafone.com>
 <CAKQ1sVMhNzYPWHTvhdeV6z+mV2ZNq5vjHj=W1d6R46cOQ_-qhQ@mail.gmail.com>
 <AB1691BE05AE7F4992697F2A0835627AC6348C38@VOEXM10W.internal.vodafone.com>
 <CAKQ1sVNHz_aCLZ3um-NV8cJGnhR3FtE6wz+zGgusvW=MA+cO_A@mail.gmail.com>
 <CAKQ1sVO_E2AZBL9CPfpm=_RQEnHWRDWNg67NFKCqy-vC=uoJBw@mail.gmail.com>
 <562668DA.5060804@ptc.com> <56269CBD.5060701@ptc.com>
From: Andy Wang <awang@ptc.com>
Message-ID: <56269D29.8040103@ptc.com>
Date: Tue, 20 Oct 2015 14:59:37 -0500
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:38.0) Gecko/20100101
 Thunderbird/38.3.0
MIME-Version: 1.0
In-Reply-To: <56269CBD.5060701@ptc.com>
Content-Type: text/plain; charset="utf-8"; format=flowed
Content-Transfer-Encoding: 7bit
X-Originating-IP: [132.253.8.73]



On 10/20/2015 02:57 PM, Andy Wang wrote:
>
>
> On 10/20/2015 11:16 AM, Andy Wang wrote:
>>
>>
>> On 10/20/2015 05:19 AM, Yann Ylavic wrote:
>>
>>>
>>> mod_dumpio's traces (level TRACE7) could be helpful here, Andy?
>>>
>>
>> I'll reconfigure to get that in a bit today.
>> I'll also try with mod_proxy_ajp as well to see if the same occurs.
>
>
> mod_proxy_ajp has the same behavior.
> Here's the output from mod_dumpio - lemme know if you'd like the raw
> file.  I'd have to figure out how to make it available somewhere after
> sanitizing a few things.
>



[Tue Oct 20 14:53:53.800924 2015] [dumpio:trace7] [pid 5228:tid 2776] 
mod_dumpio.c(135): [client 132.253.8.198:55373] mod_dumpio: dumpio_in 
[getline-blocking] 0 readbytes
[Tue Oct 20 14:53:53.800924 2015] [dumpio:trace7] [pid 5228:tid 2776] 
mod_dumpio.c(58): [client 132.253.8.198:55373] mod_dumpio:  dumpio_in 
(data-HEAP): 1 bytes
[Tue Oct 20 14:53:53.800924 2015] [dumpio:trace7] [pid 5228:tid 2776] 
mod_dumpio.c(100): [client 132.253.8.198:55373] mod_dumpio:  dumpio_in 
(data-HEAP): \n
[Tue Oct 20 14:53:53.800924 2015] [dumpio:trace7] [pid 5228:tid 2776] 
mod_dumpio.c(135): [client 132.253.8.198:55373] mod_dumpio: dumpio_in 
[getline-blocking] 0 readbytes
[Tue Oct 20 14:53:58.801084 2015] [dumpio:trace7] [pid 5228:tid 2776] 
mod_dumpio.c(150): [client 132.253.8.198:55373] mod_dumpio: dumpio_in - 
70007
[Tue Oct 20 14:53:58.801084 2015] [dumpio:trace7] [pid 5228:tid 2776] 
mod_dumpio.c(164): [client 132.253.8.198:55373] mod_dumpio: dumpio_out

Does this appear to be saying that it's timing out tryign to read more 
from the input (the request?)

From dev-return-84380-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Tue Oct 20 20:42:15 2015
Return-Path: <dev-return-84380-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id C7C8C17605
	for <apmail-httpd-dev-archive@www.apache.org>; Tue, 20 Oct 2015 20:42:15 +0000 (UTC)
Received: (qmail 61074 invoked by uid 500); 20 Oct 2015 20:42:14 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 60995 invoked by uid 500); 20 Oct 2015 20:42:14 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 60985 invoked by uid 99); 20 Oct 2015 20:42:14 -0000
Received: from Unknown (HELO spamd2-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 20 Oct 2015 20:42:14 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd2-us-west.apache.org (ASF Mail Server at spamd2-us-west.apache.org) with ESMTP id 54D261A2DBB
	for <dev@httpd.apache.org>; Tue, 20 Oct 2015 20:42:14 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd2-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.003
X-Spam-Level:
X-Spam-Status: No, score=-0.003 tagged_above=-999 required=6.31
	tests=[RCVD_IN_MSPIKE_H2=-0.001, SPF_HELO_PASS=-0.001,
	SPF_PASS=-0.001] autolearn=disabled
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd2-us-west.apache.org [10.40.0.9]) (amavisd-new, port 10024)
	with ESMTP id 2V536DD8HNjP for <dev@httpd.apache.org>;
	Tue, 20 Oct 2015 20:42:13 +0000 (UTC)
Received: from na01-by2-obe.outbound.protection.outlook.com (mail-by2on0122.outbound.protection.outlook.com [207.46.100.122])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id 65D0520750
	for <dev@httpd.apache.org>; Tue, 20 Oct 2015 20:42:12 +0000 (UTC)
Authentication-Results: spf=none (sender IP is )
 smtp.mailfrom=paul.spangler@ni.com; 
Received: from [10.2.33.35] (130.164.62.81) by
 BY1PR0401MB1612.namprd04.prod.outlook.com (10.162.211.22) with Microsoft SMTP
 Server (TLS) id 15.1.300.14; Tue, 20 Oct 2015 20:42:03 +0000
Subject: Re: Apache Module Development Query on character encodings.
To: <dev@httpd.apache.org>
References: <15f001d10b6c$bcbc0ff0$36342fd0$@com>
From: Paul Spangler <paul.spangler@ni.com>
Message-ID: <5626A716.4000602@ni.com>
Date: Tue, 20 Oct 2015 15:41:58 -0500
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:38.0) Gecko/20100101
 Thunderbird/38.2.0
MIME-Version: 1.0
In-Reply-To: <15f001d10b6c$bcbc0ff0$36342fd0$@com>
Content-Type: text/plain; charset="windows-1252"; format=flowed
Content-Transfer-Encoding: 7bit
X-Originating-IP: [130.164.62.81]
X-ClientProxiedBy: BLUPR08CA0053.namprd08.prod.outlook.com (10.141.200.33) To
 BY1PR0401MB1612.namprd04.prod.outlook.com (25.162.211.22)
X-Microsoft-Exchange-Diagnostics:
	1;BY1PR0401MB1612;2:0hUcu2ph3YgsdkVofxGgYkugdiMqJovNROfOziME+slBy9cwrqb0190HiO2+E8X6luaF32WBKCMgiS9Rv1YBPBwZbGiZE81tZjOBzXIHCfqJ8rFauwn7jBFBHs5SzgNNexBjgOKEVTvmXWD207vic1a88LfXgZJqe6wqr6SzHOs=;3:p+0PKZSs8+M3MEVSK5fl2sxGUt5HIX39QtF+O1tkX57CJ1Jn/PcRCBfQw77jIqgUrN4psxer7b/aTt8cPTZ/9TUPm/OTMZdRic9zdWXUaU2gsM6LBn4PvX3FHONVwGuEc24r0lMS7/69JIemCfb6yA==;25:YOtSN6kFyre7zcYONbRKmBXTlgKzZkJMReLiUTFR0J4udZ9HjPqR59xd/X1v9wOIo8ES7x7OYSW7Az6GDtUyeR+FZaekRygyvYF0ND54vNpek5UM5+KrtLyFUvBetiqIyUBYVkubOC2E8fl8d0fEj7E6773BmFCdGsbo1S5bSS9/zEBGCKTJFoa5kgyOlddtS6Z2IT7DEkP39mELjIiQEsj3InEIzuURciQJ8MEWyp3i4fOG5RJt0JoOs3JCe/pzA5tMuuESzpPQ/N3mA8d0/Q==
X-Microsoft-Antispam: UriScan:;BCL:0;PCL:0;RULEID:;SRVR:BY1PR0401MB1612;
X-Microsoft-Exchange-Diagnostics:
	1;BY1PR0401MB1612;20:d9z8Qjz1zqa6LmBwh+kgLnzBuNQ7nVZVGu+Mpbuw3c70mNrzkYeWVLQDXBZTaQyqB+60gftGSFS/ssdYYm1/BjjKhJwKxxSFF3vq8Ji8s+SG4VbeU0CRpLQaPeJ/tGWtzqrjeLp5yXjU5NOLYy/wQkTVwxqd8Yqt6HZmyTPTkqPctA7KygvuQy3OZEPmpT6m7Wzu41s1zRQnREJC4zmvJYrGyWsyuR7Slt7V8lPIKuEMUhk00dGteNJPF0+MpYfWny3K3o7yTvuhmGU2nDD+uPbFmUcUWrUOU+No85Led3Tru2qNcvjVS18WdfEu2P+HI4JElehhCDhjTk6e0rUhHaMBHiiowVI6oFo6a1XzwyqIUPG41AXxJPA3xS891gkhSemFbiRU+PSc3BOThfgsaK2HJZDiOjDVQ559R+2X3L/qM3lZ01tiSMgRWVEG3MKWp01gZnQAVOVl4N27azeoRY0rq5kFDN9BiOII0q8Yhqro1ZOa/rfxTtjyFZVOB9WkJsXADgCU8PzSjqkjjPeCIFaLKZknrxyheWkVVBl1rcvyMfbEI7L0/Kd1qOAOzasN6b6TT1veotACV1ui39/aQst/WOXuot/zCiZRNud3Uw8=
X-Microsoft-Antispam-PRVS:
	<BY1PR0401MB1612D420FED5889CC5804BEC84390@BY1PR0401MB1612.namprd04.prod.outlook.com>
X-Exchange-Antispam-Report-Test: UriScan:;
X-Exchange-Antispam-Report-CFA-Test:
	BCL:0;PCL:0;RULEID:(601004)(2401047)(520078)(5005006)(8121501046)(3002001);SRVR:BY1PR0401MB1612;BCL:0;PCL:0;RULEID:;SRVR:BY1PR0401MB1612;
X-Microsoft-Exchange-Diagnostics:
	1;BY1PR0401MB1612;4:3O7fKgiX5CX6rTTKu7K9tXEqdpNyFZEGGXStJu56DvRIn2llcdmI+MdRpQDapI3hQoeomZJ1IvDCiQlbRkzP3dB9vhOhUwxg8Az3zL+XrJq+Z8F04xIvL75NyknzTf/jRojAyCXd8X5razgfW1B2Q5/9CbbUcUPVUDdJzS2rugB9mr+xsvRkP9uy1VGTbPy7q8CAnDgSPEcJ/B4qG0O3QUnmvnzVAXxkN9/WTWVIg6wWuxyi4H6ffSJLcZsgr2w8sfcMziVgAvfnGPLcYwrfCX6KbJoiUiA9yLNWaUATQRiaeiwmrdgu35VMH6tKBRz1+yJ1iLF1fQVOTEKuSbSamwCGR0/Weykf5GJQKIzRbQw=
X-Forefront-PRVS: 073515755F
X-Forefront-Antispam-Report:
	SFV:NSPM;SFS:(10019020)(6049001)(6009001)(377454003)(189002)(199003)(24454002)(479174004)(87976001)(5008740100001)(551544002)(59896002)(110136002)(5001960100002)(2351001)(189998001)(23746002)(107886002)(5007970100001)(2950100001)(5004730100002)(77096005)(105586002)(83506001)(64126003)(5001920100001)(36756003)(81156007)(65956001)(40100003)(33656002)(450100001)(66066001)(101416001)(54356999)(42186005)(65816999)(97736004)(76176999)(47776003)(80316001)(122386002)(46102003)(50986999)(65806001)(87266999)(4001350100001)(64706001)(92566002)(106356001)(86362001)(50466002);DIR:OUT;SFP:1102;SCL:1;SRVR:BY1PR0401MB1612;H:[10.2.33.35];FPR:;SPF:None;PTR:InfoNoRecords;MX:1;A:1;LANG:en;
Received-SPF: None (protection.outlook.com: ni.com does not designate
 permitted sender hosts)
X-Microsoft-Exchange-Diagnostics:
	=?Windows-1252?Q?1;BY1PR0401MB1612;23:+qrpkivhotUh3PZAhFAXJ1eOp5u0chj6L3v?=
 =?Windows-1252?Q?rJTxVqwSNss78mmfRu6AyEsuISjK1rdSafC7OlhnK+3wMUaD4R5NPwc/?=
 =?Windows-1252?Q?KV35BT9aGHefITVA0bi7I1JkwXjoPfyCchoKhMZ5mgHA+Snwlobjf3WI?=
 =?Windows-1252?Q?7rSRXsIxEhHzdhEpy5V2Qf1N+N3FeMYj8JjkYa4rC6vgC19efw0RzWv9?=
 =?Windows-1252?Q?xZUfgEbFq2w5QNG2I8zEVwgC13wxXMmIq34jKrWkCYNzPcplxr4/67FA?=
 =?Windows-1252?Q?vu+QVLHnmoK4Oz35oYCrvTKSLljMNkqCVFV+8I5T7v0BT4mRcDegxlet?=
 =?Windows-1252?Q?8sdKA0sepy8fHeYDK9TeelJS70FO5tYKfNGSy7FjenB44R8nQYD6CyHJ?=
 =?Windows-1252?Q?vXYlRCoQLSPycvocrh+hNH2CcJ2z/rpBQn95aIs9FiDsji3FHmVPO70m?=
 =?Windows-1252?Q?Xi2kLpbBrwTL0j2qNVhbJCobisBFMdXqyvh1sqLb4Zv5ZrezL6EJLhmd?=
 =?Windows-1252?Q?MdKzH3/6MzE+FuBMNNOWwMO4C1slssTqzuDjn368EGjrt91SEGa9Gu9X?=
 =?Windows-1252?Q?edxZdy8hEQ8oCKhbcKMi1HaepTTdIZe2bHvYDVDfVxJlYNaTEaYhTPgj?=
 =?Windows-1252?Q?Ozxrv1VpEeodfiRm6YlINBOQNEUwJeJER2e0Zk0YPwOGR9B73/wso0vO?=
 =?Windows-1252?Q?5VbMexHS5OusugJbT3su5E6gr75X1vzWNq765wT9/bLputKE5Q1sKPp2?=
 =?Windows-1252?Q?c2JBoxk8ladtFR7zgqJZGr8aGLLhN7Bdx+Ke5YfbLJbMrryLdrTwyWQU?=
 =?Windows-1252?Q?ICIa20qseBwQsUMUjAzHcRh7XnERQUwYzSsOW8aUGMz+Wgp85jqnI+hA?=
 =?Windows-1252?Q?TJgE8g5EpFjUJeRw6Qks2JWn+Ud+0Dt+LrMWiheAHMeEZIQYxWQNDC7I?=
 =?Windows-1252?Q?YS921S9ddrbLR0gf/SwvDMQPKl8u655N+mo2ykVNG9JReN/2cEc2MEe6?=
 =?Windows-1252?Q?EZqpUqjWhUhBTIvlfGBAQAwvN2hGpf1A3N7hl6G6U2nTXF4/lZNle/w1?=
 =?Windows-1252?Q?T70m15TAnFJsqs9LBRXA8rwl6NJdx+2pq9KNnRI7j7V1/hRzCPVq/4fi?=
 =?Windows-1252?Q?8AJZn4csMJNVA0PBaEfVaWf/yXVqBIrfwa1am29C9tvT8teXmKSAdOqM?=
 =?Windows-1252?Q?aRN8zu9ARNeTu4bs7mdbgpXtyIWJBJJj/OkXknGvwb1L3I4f6BtlZM5I?=
 =?Windows-1252?Q?qu0oK4V2aRTOOWFF+xNgT1iWlS/h6uQ6GkNPPJqJVzYv/bnAG20vdigM?=
 =?Windows-1252?Q?jkktuMZfX1ATITF4Q2oilG4c9lmuxRIn5JJx3hWW8opeTcZ/m5YaY+Pi?=
 =?Windows-1252?Q?RLfyNgYO+oax1YJN1oxKE0y5iE/RWe8rn+Eo9rFvPBjiOhBoGR5R2DYi?=
 =?Windows-1252?Q?1tgejmCNumYMJUctl947I?=
X-Microsoft-Exchange-Diagnostics:
	1;BY1PR0401MB1612;5:bmaZFX5Ioj3HSRv12XbnV1mpWrUtOtYWvSU5VMGcHzT9T55FYNxSdoHlQ8cb2dPkevOTXcV6ayaP3PRVL0mY3uGu4biS5mPISXqE5rbzRSJQqvX9lXq8QZZI63xN+lVTMSRmrM5m3TtIcACY9JO79Q==;24:vZ6WTY2mpp9e4g4UZM2LQvLpVDO0xujYRqBCO3n4FiYzBSlcOXn3YOQOrXTcKyaqA9zfqvJ71P4bowuBKm2m7GAXb3+oT2vG8QxPb7oBRcQ=;20:hVr4Y//FhgwuCnamqhKX2A7i4qslru14EHIntbxc6ZAlNKr5AJXBADGalAdwDN7qTJl1V9WZ1KcB4ncmWEdrfQ==
SpamDiagnosticOutput: 1:23
SpamDiagnosticMetadata: NSPM
X-OriginatorOrg: ni.com
X-MS-Exchange-CrossTenant-OriginalArrivalTime: 20 Oct 2015 20:42:03.4356 (UTC)
X-MS-Exchange-CrossTenant-FromEntityHeader: Hosted
X-MS-Exchange-Transport-CrossTenantHeadersStamped: BY1PR0401MB1612

On 10/20/2015 2:23 PM, John Dougrez-Lewis wrote:
> How do I go about massaging the input & output into UTF-8 and fixed
> width 16-bit Unicode?
>
> Are there any good references on how to achieve this?

I can't speak for whether or not it's a good reference, but 
mod_authnz_ldap can do the "Request Input character encoding => UTF-8" 
part of what you described to convert usernames and passwords to UTF-8 
before passing them to LDAP.

It uses the apr_xlate API along with a file specified by the 
AuthLDAPCharsetConfig directive to map the Accept-Language header to a 
character encoding. I believe the xlate API is using iconv under the 
hood, which can be its own source of problems if the server environment 
isn't set up properly.

I'd also be interested to hear if there are other ways for modules to 
handle character encodings, which is never an easy topic. I suppose 
ideally the protocol would dictate a required encoding that the client 
must use (via Content-Types), which simplifies things quite a bit.

Regards,

Paul Spangler
LabVIEW R&D
National Instruments

From dev-return-84381-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Tue Oct 20 22:22:40 2015
Return-Path: <dev-return-84381-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 4116B17CA4
	for <apmail-httpd-dev-archive@www.apache.org>; Tue, 20 Oct 2015 22:22:40 +0000 (UTC)
Received: (qmail 41786 invoked by uid 500); 20 Oct 2015 22:22:39 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 41709 invoked by uid 500); 20 Oct 2015 22:22:39 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 41699 invoked by uid 99); 20 Oct 2015 22:22:39 -0000
Received: from Unknown (HELO spamd2-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 20 Oct 2015 22:22:39 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd2-us-west.apache.org (ASF Mail Server at spamd2-us-west.apache.org) with ESMTP id 43E8B1A2163
	for <dev@httpd.apache.org>; Tue, 20 Oct 2015 22:22:39 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd2-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 0
X-Spam-Level:
X-Spam-Status: No, score=0 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1] autolearn=disabled
Authentication-Results: spamd2-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=comcast.net
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd2-us-west.apache.org [10.40.0.9]) (amavisd-new, port 10024)
	with ESMTP id sbxYU8UNQ1q4 for <dev@httpd.apache.org>;
	Tue, 20 Oct 2015 22:22:31 +0000 (UTC)
Received: from resqmta-ch2-08v.sys.comcast.net (resqmta-ch2-08v.sys.comcast.net [69.252.207.40])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id 7A08B4415F
	for <dev@httpd.apache.org>; Tue, 20 Oct 2015 22:22:31 +0000 (UTC)
Received: from resomta-ch2-17v.sys.comcast.net ([69.252.207.113])
	by resqmta-ch2-08v.sys.comcast.net with comcast
	id XaMY1r0032TL4Rh01aNR06; Tue, 20 Oct 2015 22:22:25 +0000
Received: from [172.20.17.158] ([74.203.127.5])
	by resomta-ch2-17v.sys.comcast.net with comcast
	id XaLG1r00m07786a01aLKHD; Tue, 20 Oct 2015 22:20:23 +0000
Content-Type: text/plain; charset=us-ascii
Mime-Version: 1.0 (Mac OS X Mail 8.2 \(2104\))
Subject: Re: Forwarded buckets' lifetime (was: [Bug 58503] segfault in apr_brigade_cleanup()...)
From: Jim Jagielski <jim@jaguNET.com>
In-Reply-To: <0D5B13DA-8642-4662-9606-6B5DF94EB87B@sharp.fm>
Date: Tue, 20 Oct 2015 18:20:15 -0400
Content-Transfer-Encoding: 7bit
Message-Id: <D70FBC43-2E52-4BDD-ADA5-88623657CBEC@jaguNET.com>
References: <CAKQ1sVNchFx=egp=Q0tgT+1GcBXiten8mh9STetcZXOfJxhsjQ@mail.gmail.com> <CAKQ1sVPjcA9EYNpjcmM9=AU_LCgAsFntOcZnmGoHymds3S5wmA@mail.gmail.com> <AB1691BE05AE7F4992697F2A0835627AC6348972@VOEXM10W.internal.vodafone.com> <7B24F4D1-6904-4C00-A337-88F712026BE9@greenbytes.de> <0D5B13DA-8642-4662-9606-6B5DF94EB87B@sharp.fm>
To: dev@httpd.apache.org
X-Mailer: Apple Mail (2.2104)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=comcast.net;
	s=q20140121; t=1445379745;
	bh=QO/pwawbJzmP9wWa1LEhJLdR25VLc4fC/UcOz2cXnOg=;
	h=Received:Received:Content-Type:Mime-Version:Subject:From:Date:
	 Message-Id:To;
	b=uGfTAZVGkuBKS9nna9/AAvXW8RAGKxbty335y6tNjdsYm49MpsHEZpCyWyNj/EfJ1
	 ogbDsxnQksB6QR0Ehybs4imRRN2A9kMlrOjQvhLBcnm6a6ff27IzeBiuaq3OpY10uc
	 artz9/sLZYShH1LQlbFfcKcE3h6NhGPzVutWER99PU6DHBK+uB9ckFE5tvhj8p0SUZ
	 4u65TH89vXo52ean87ZICbpU92nxjItj0HCh48bR9qRZrr1d2+wRCsKqeLYGpmmGUv
	 hxPUJhXUg4HiGsC6Ltok0H+BamxbpVP4Sb5hyTm42pw+WCsWKy844iu7rXQAQPkam9
	 HwkFIPeDxz0zg==

Sorry for not being on-list a bit lately... I've been a bit swamped.

Anyway, I too don't want httpd to go down the 'systemd' route: claim
something as broken to explain, and justify, ripping it out
and re-creating anew. Sometimes this needs be done, but not
very often. And when stuff *is* broken, again, it's best to
fix it than replace it (usually).

From dev-return-84382-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Tue Oct 20 22:38:07 2015
Return-Path: <dev-return-84382-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 5E3EE18052
	for <apmail-httpd-dev-archive@www.apache.org>; Tue, 20 Oct 2015 22:38:07 +0000 (UTC)
Received: (qmail 88464 invoked by uid 500); 20 Oct 2015 22:38:06 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 88399 invoked by uid 500); 20 Oct 2015 22:38:06 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 88390 invoked by uid 99); 20 Oct 2015 22:38:06 -0000
Received: from Unknown (HELO spamd4-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 20 Oct 2015 22:38:06 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd4-us-west.apache.org (ASF Mail Server at spamd4-us-west.apache.org) with ESMTP id 6C770C0F9B
	for <dev@httpd.apache.org>; Tue, 20 Oct 2015 22:38:06 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd4-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 3.924
X-Spam-Level: ***
X-Spam-Status: No, score=3.924 tagged_above=-999 required=6.31
	tests=[FSL_HELO_NON_FQDN_1=0.001, RCVD_IN_PBL=3.558,
	RCVD_IN_SORBS_DUL=0.001, RDNS_DYNAMIC=0.363, URIBL_BLOCKED=0.001]
	autolearn=disabled
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd4-us-west.apache.org [10.40.0.11]) (amavisd-new, port 10024)
	with ESMTP id 4WG5-OogenvQ for <dev@httpd.apache.org>;
	Tue, 20 Oct 2015 22:37:59 +0000 (UTC)
Received: from baldur (cpc36-newt30-2-0-cust898.19-3.cable.virginm.net [82.32.195.131])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTP id 76E5942B7B
	for <dev@httpd.apache.org>; Tue, 20 Oct 2015 22:37:59 +0000 (UTC)
Received: from baldur (localhost [127.0.0.1])
	by baldur (Postfix) with ESMTP id 5F830C1B9BC7
	for <dev@httpd.apache.org>; Tue, 20 Oct 2015 23:37:52 +0100 (BST)
Date: Tue, 20 Oct 2015 23:37:49 +0100
From: Nick Kew <niq@apache.org>
To: dev@httpd.apache.org
Subject: Re: Apache Module Development Query on character encodings.
Message-ID: <20151020233749.65b41df1@baldur>
In-Reply-To: <15f001d10b6c$bcbc0ff0$36342fd0$@com>
References: <15f001d10b6c$bcbc0ff0$36342fd0$@com>
X-Mailer: Claws Mail 3.7.4 (GTK+ 2.20.1; i486-pc-linux-gnu)
Mime-Version: 1.0
Content-Type: text/plain; charset=US-ASCII
Content-Transfer-Encoding: 7bit

On Tue, 20 Oct 2015 20:23:02 +0100
"John Dougrez-Lewis" <jlewis@lightblue.com> wrote:

> Hi,

Hi, are you by any chance the Raving Loony I once knew at Cambridge?

> I need to be able to service and respond to requests as follows:

Basically there are three parts to working with character encodings:
 * Detecting them in incoming data.
 * Converting them to order.
 * Correctly labelling outgoing data.

mod_xml2enc will do all that for libxml2-based filters,
and could easily be tweaked to drop the libxml2-specific
optimisations for general-purpose use.  Alternatively
the charset-detection from mod_xml2enc could probably
be folded into mod_charset_lite.

> The input and output buffers appears to be 8-bit char* based but I can't see
> any references to specific encodings.
> 
>  
> 
> How do I go about massaging the input & output into UTF-8 and fixed width
> 16-bit Unicode?
> 
>  
> 
> Are there any good references on how to achieve this?

It's a bit of a mess, because there are several different
standards (HTTP, XML and HTML), and in real life those are
sometimes in conflict.  The detection in mod_xml2enc has
been fine-tuned over the years and test-driven on a wide
range of scripts, including non-Latin charsets such
as Russian/Cyrillic and Arabic.

-- 
Nick Kew

From dev-return-84383-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Wed Oct 21 00:09:47 2015
Return-Path: <dev-return-84383-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 3E6FD18385
	for <apmail-httpd-dev-archive@www.apache.org>; Wed, 21 Oct 2015 00:09:47 +0000 (UTC)
Received: (qmail 66457 invoked by uid 500); 21 Oct 2015 00:09:46 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 66376 invoked by uid 500); 21 Oct 2015 00:09:46 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 66354 invoked by uid 99); 21 Oct 2015 00:09:46 -0000
Received: from Unknown (HELO spamd1-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 21 Oct 2015 00:09:46 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd1-us-west.apache.org (ASF Mail Server at spamd1-us-west.apache.org) with ESMTP id 47F16C3C1D;
	Wed, 21 Oct 2015 00:09:46 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd1-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.121
X-Spam-Level:
X-Spam-Status: No, score=-0.121 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RCVD_IN_MSPIKE_H3=-0.01, RCVD_IN_MSPIKE_WL=-0.01, SPF_PASS=-0.001]
	autolearn=disabled
Authentication-Results: spamd1-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd1-us-west.apache.org [10.40.0.7]) (amavisd-new, port 10024)
	with ESMTP id 5PKTl4ptajha; Wed, 21 Oct 2015 00:09:45 +0000 (UTC)
Received: from mail-pa0-f46.google.com (mail-pa0-f46.google.com [209.85.220.46])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id 8A3E944168;
	Wed, 21 Oct 2015 00:09:45 +0000 (UTC)
Received: by pacfv9 with SMTP id fv9so37104207pac.3;
        Tue, 20 Oct 2015 17:09:44 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=subject:to:references:cc:from:message-id:date:user-agent
         :mime-version:in-reply-to:content-type:content-transfer-encoding;
        bh=+RLcubewK1Un+RCW9Ci2LEp0rimOT8Njn2J3YUcTP0A=;
        b=cwEPc5nQSOIThUuHH0lrM54VuCULwav1rm3UQ48c+cTsZ5PNcuvpn4Xxno82cv8nK8
         GMMARusGRGVVhDPhOlwUCOsz3ZR7Uit8oFDdos2OjDrqtdvYLzTlEQDvfHXrbyPFiaro
         pUqdD6ex3NuzWO6cSXxtjyYD3acUseZNRW0eIps4DMwZZQDTKqQYiEZyEg4g6g3MYkC2
         41TT4JoEhKdS8vH284HNKWQ0nFeULl4aIoEd6ebFVysaHB3uUxn5uVu5hrX56be6vLQz
         xYXlGAccoigynBoThubipI3+w8QX1zV1Gz6BQvR++PNt7rmhL+Q1Eov9dZXuHQ4w2LDE
         gLfg==
X-Received: by 10.69.1.67 with SMTP id be3mr7111354pbd.78.1445386184875;
        Tue, 20 Oct 2015 17:09:44 -0700 (PDT)
Received: from [192.168.1.4] (static-50-43-55-221.bvtn.or.frontiernet.net. [50.43.55.221])
        by smtp.gmail.com with ESMTPSA id st5sm5796837pab.42.2015.10.20.17.09.43
        (version=TLSv1.2 cipher=ECDHE-RSA-AES128-GCM-SHA256 bits=128/128);
        Tue, 20 Oct 2015 17:09:43 -0700 (PDT)
Subject: Re: Non-blocking ap_get_brigade() doesn't return EAGAIN?
To: modules-dev@httpd.apache.org
References: <56251BB6.5010309@gmail.com>
 <CAKQ1sVOjz3swFj1pt+oob7meqku5gh1aeEohraKdcRyaDLJh6A@mail.gmail.com>
Cc: dev@httpd.apache.org
From: Jacob Champion <champion.p@gmail.com>
Message-ID: <5626D7C6.9030201@gmail.com>
Date: Tue, 20 Oct 2015 17:09:42 -0700
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:38.0) Gecko/20100101
 Thunderbird/38.3.0
MIME-Version: 1.0
In-Reply-To: <CAKQ1sVOjz3swFj1pt+oob7meqku5gh1aeEohraKdcRyaDLJh6A@mail.gmail.com>
Content-Type: text/plain; charset=utf-8; format=flowed
Content-Transfer-Encoding: 7bit

On 10/19/2015 01:07 PM, Yann Ylavic wrote:
> I'll (re)take a look at the thread [2] you mentioned (and refresh my
> mind, I don't remember all the details :), and then propose something
> to dev@...

Great, thanks! Looking forward to the discussion.

--Jacob

From dev-return-84384-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Wed Oct 21 06:04:49 2015
Return-Path: <dev-return-84384-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id BE8C418DC0
	for <apmail-httpd-dev-archive@www.apache.org>; Wed, 21 Oct 2015 06:04:49 +0000 (UTC)
Received: (qmail 18821 invoked by uid 500); 21 Oct 2015 06:04:43 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 18752 invoked by uid 500); 21 Oct 2015 06:04:43 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 18742 invoked by uid 99); 21 Oct 2015 06:04:43 -0000
Received: from Unknown (HELO spamd3-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 21 Oct 2015 06:04:43 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd3-us-west.apache.org (ASF Mail Server at spamd3-us-west.apache.org) with ESMTP id A2BD61809D1
	for <dev@httpd.apache.org>; Wed, 21 Oct 2015 06:04:42 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd3-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 0.99
X-Spam-Level:
X-Spam-Status: No, score=0.99 tagged_above=-999 required=6.31
	tests=[KAM_LAZY_DOMAIN_SECURITY=1, T_RP_MATCHES_RCVD=-0.01]
	autolearn=disabled
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd3-us-west.apache.org [10.40.0.10]) (amavisd-new, port 10024)
	with ESMTP id iG_piZnAMmhs for <dev@httpd.apache.org>;
	Wed, 21 Oct 2015 06:04:40 +0000 (UTC)
Received: from oldblue.lightblue.com (oldblue.lightblue.com [83.105.78.194])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTP id 958E620594
	for <dev@httpd.apache.org>; Wed, 21 Oct 2015 06:04:39 +0000 (UTC)
Received: from [83.105.78.212] by oldblue.lightblue.com (GMS
 15.01.3664/KW9347.00.a5a499dd) with ESMTP id tbajuaaa for
 dev@httpd.apache.org; Wed, 21 Oct 2015 07:04:13 +0100
Reply-To: <jlewis@lightblue.com>
From: "John Dougrez-Lewis" <jlewis@lightblue.com>
To: <dev@httpd.apache.org>
References: <15f001d10b6c$bcbc0ff0$36342fd0$@com> <20151020233749.65b41df1@baldur>
In-Reply-To: <20151020233749.65b41df1@baldur>
Subject: RE: Apache Module Development Query on character encodings.
Date: Wed, 21 Oct 2015 07:04:27 +0100
Organization: Light Blue Ltd
Message-ID: <16ae01d10bc6$57eac990$07c05cb0$@com>
MIME-Version: 1.0
Content-Type: text/plain;
	charset="US-ASCII"
Content-Transfer-Encoding: 7bit
X-Mailer: Microsoft Office Outlook 12.0
Thread-Index: AdELh++sJWdyGtSuT6G1e9z5+e1s0wAPEgXg
Content-Language: en-gb

Hi Nick,

> Hi, are you by any chance the Raving Loony I once knew at Cambridge?

Yes indeed - that must be 35 years ago now - these days I'm a bit more
sensible (although the legacy of the OMRLP lives on).


> Basically there are three parts to working with character encodings:
>  * Detecting them in incoming data.
>  * Converting them to order.
>  * Correctly labelling outgoing data.

> mod_xml2enc will do all that for libxml2-based filters, and could easily
be tweaked to drop the libxml2-specific optimisations for general-
> purpose use.  Alternatively the charset-detection from mod_xml2enc could
probably be folded into mod_charset_lite.

So basically mod_xml2enc will detect the incoming encoding (whatever it may
be)?


Are there not HTTP headers which give a good indication of the input format
(albeit that you have to detect the format and read the stream to confirm
it)?


I'm new to Apache coding/configuration - how would xml2enc/mod_charset_lite
input & output modules/filters be setup in configuration and/or chained in
code?


Do you have any views on libxml2 suitability for use within Apache module
code?

It appears to have good all-round performance compared to other XML
libraries. I note that it has a C++ wrapper which is LGPL'ed so there are
likely to licensing/distribution issues if I ever decided to try release
code under an Apache License.



Regards,

John


From dev-return-84385-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Wed Oct 21 12:29:50 2015
Return-Path: <dev-return-84385-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 6541E17CFE
	for <apmail-httpd-dev-archive@www.apache.org>; Wed, 21 Oct 2015 12:29:50 +0000 (UTC)
Received: (qmail 54824 invoked by uid 500); 21 Oct 2015 12:29:49 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 54743 invoked by uid 500); 21 Oct 2015 12:29:49 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 54734 invoked by uid 99); 21 Oct 2015 12:29:49 -0000
Received: from mail-relay.apache.org (HELO mail-relay.apache.org) (140.211.11.15)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 21 Oct 2015 12:29:49 +0000
Received: from gauss.localdomain (v4-86134dad.pool.vitroconnect.de [134.19.77.173])
	by mail-relay.apache.org (ASF Mail Server at mail-relay.apache.org) with ESMTPSA id 4500B1A0181
	for <dev@httpd.apache.org>; Wed, 21 Oct 2015 12:29:49 +0000 (UTC)
Received: from [IPv6:::1] (localhost [IPv6:::1])
	by gauss.localdomain (Postfix) with ESMTP id 4C465DF
	for <dev@httpd.apache.org>; Wed, 21 Oct 2015 14:29:48 +0200 (CEST)
Subject: Re: [users@httpd] Chunked transfer delay with httpd 2.4 on Windows.
To: dev@httpd.apache.org
References: <5625642E.30708@ptc.com>
 <CAKQ1sVPceAVuDMNgt-qGomU6EARQap5HpCbvaPPiwtYXsUvRpg@mail.gmail.com>
 <CALK=YjM5CvMgWAWT=X67JxBdaJDJ5PCFsHJijSEs0bKovFnQtQ@mail.gmail.com>
 <5625A5E7.2070309@ptc.com>
 <CAKQ1sVPRX_st3SWAnF30C62qxTNqjHiSV3iaCHFPr1HLGp_CxA@mail.gmail.com>
 <AB1691BE05AE7F4992697F2A0835627AC63489F4@VOEXM10W.internal.vodafone.com>
 <CAKQ1sVMhNzYPWHTvhdeV6z+mV2ZNq5vjHj=W1d6R46cOQ_-qhQ@mail.gmail.com>
 <AB1691BE05AE7F4992697F2A0835627AC6348C38@VOEXM10W.internal.vodafone.com>
 <CAKQ1sVNHz_aCLZ3um-NV8cJGnhR3FtE6wz+zGgusvW=MA+cO_A@mail.gmail.com>
 <CAKQ1sVO_E2AZBL9CPfpm=_RQEnHWRDWNg67NFKCqy-vC=uoJBw@mail.gmail.com>
 <562668DA.5060804@ptc.com> <56269CBD.5060701@ptc.com>
From: Ruediger Pluem <rpluem@apache.org>
X-Enigmail-Draft-Status: N1110
Message-ID: <5627853C.4040006@apache.org>
Date: Wed, 21 Oct 2015 14:29:48 +0200
User-Agent: Mozilla/5.0 (X11; Linux i686 on x86_64; rv:41.0) Gecko/20100101
 Firefox/41.0 SeaMonkey/2.38
MIME-Version: 1.0
In-Reply-To: <56269CBD.5060701@ptc.com>
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 8bit



On 10/20/2015 09:57 PM, Andy Wang wrote:
> 
> 
> On 10/20/2015 11:16 AM, Andy Wang wrote:
>>
>>
>> On 10/20/2015 05:19 AM, Yann Ylavic wrote:
>>
>>>
>>> mod_dumpio's traces (level TRACE7) could be helpful here, Andy?
>>>
>>
>> I'll reconfigure to get that in a bit today.
>> I'll also try with mod_proxy_ajp as well to see if the same occurs.
> 
> 
> mod_proxy_ajp has the same behavior.
> Here's the output from mod_dumpio - lemme know if you'd like the raw file.  I'd have to figure out how to make it
> available somewhere after sanitizing a few things.
> 
> [Tue Oct 20 14:53:53.800924 2015] [dumpio:trace7] [pid 5228:tid 2776] mod_dumpio.c(164): [client 132.253.8.198:55373]
> mod_dumpio: dumpio_out
> [Tue Oct 20 14:53:53.800924 2015] [dumpio:trace7] [pid 5228:tid 2776] mod_dumpio.c(58): [client 132.253.8.198:55373]
> mod_dumpio:  dumpio_out (data-HEAP): 362 bytes
> [Tue Oct 20 14:53:53.800924 2015] [dumpio:trace7] [pid 5228:tid 2776] mod_dumpio.c(100): [client 132.253.8.198:55373]
> mod_dumpio:  dumpio_out (data-HEAP): HTTP/1.1 200 OK\r\nDate: Tue, 20 Oct 2015 19:53:53 GMT\r\nServer: Apache/2.4.16
> (Win64)\r\nX-Frame-Options: SAMEORIGIN\r\nExpires: Thu, 01 Jan 1970 00:00:00 GMT\r\nCache-Control:
> no-cache\r\nContent-Type: text/html;charset=UTF-8\r\nVary: Accept-Encoding,User-Agent\r\nContent-Encoding:
> gzip\r\nKeep-Alive: timeout=5, max=100\r\nConnection: Keep-Alive\r\nTransfer-Encoding: chunked\r\n\r\n
> [Tue Oct 20 14:53:53.800924 2015] [dumpio:trace7] [pid 5228:tid 2776] mod_dumpio.c(164): [client 132.253.8.198:55373]
> mod_dumpio: dumpio_out
> [Tue Oct 20 14:53:53.800924 2015] [dumpio:trace7] [pid 5228:tid 2776] mod_dumpio.c(58): [client 132.253.8.198:55373]
> mod_dumpio:  dumpio_out (data-TRANSIENT): 4 bytes
> [Tue Oct 20 14:53:53.800924 2015] [dumpio:trace7] [pid 5228:tid 2776] mod_dumpio.c(100): [client 132.253.8.198:55373]
> mod_dumpio:  dumpio_out (data-TRANSIENT): 1e\r\n
> [Tue Oct 20 14:53:53.800924 2015] [dumpio:trace7] [pid 5228:tid 2776] mod_dumpio.c(58): [client 132.253.8.198:55373]
> mod_dumpio:  dumpio_out (data-IMMORTAL): 10 bytes
> [Tue Oct 20 14:53:53.800924 2015] [dumpio:trace7] [pid 5228:tid 2776] mod_dumpio.c(100): [client 132.253.8.198:55373]
> mod_dumpio:  dumpio_out (data-IMMORTAL): \x1f\x8b\b
> [Tue Oct 20 14:53:53.800924 2015] [dumpio:trace7] [pid 5228:tid 2776] mod_dumpio.c(58): [client 132.253.8.198:55373]
> mod_dumpio:  dumpio_out (data-HEAP): 20 bytes
> [Tue Oct 20 14:53:53.800924 2015] [dumpio:trace7] [pid 5228:tid 2776] mod_dumpio.c(100): [client 132.253.8.198:55373]
> mod_dumpio:  dumpio_out (data-HEAP): \x8a\x8a\x02\x02\xab\x92\xd4\xe2\x12+\x10+\x8a\x97\v
> [Tue Oct 20 14:53:53.800924 2015] [dumpio:trace7] [pid 5228:tid 2776] mod_dumpio.c(58): [client 132.253.8.198:55373]
> mod_dumpio:  dumpio_out (data-IMMORTAL): 2 bytes
> [Tue Oct 20 14:53:53.800924 2015] [dumpio:trace7] [pid 5228:tid 2776] mod_dumpio.c(100): [client 132.253.8.198:55373]
> mod_dumpio:  dumpio_out (data-IMMORTAL): \r\n
> [Tue Oct 20 14:53:53.800924 2015] [dumpio:trace7] [pid 5228:tid 2776] mod_dumpio.c(58): [client 132.253.8.198:55373]
> mod_dumpio:  dumpio_out (metadata-FLUSH): 0 bytes
> [Tue Oct 20 14:53:53.800924 2015] [dumpio:trace7] [pid 5228:tid 2776] mod_dumpio.c(164): [client 132.253.8.198:55373]
> mod_dumpio: dumpio_out
> [Tue Oct 20 14:53:53.800924 2015] [dumpio:trace7] [pid 5228:tid 2776] mod_dumpio.c(58): [client 132.253.8.198:55373]
> mod_dumpio:  dumpio_out (data-TRANSIENT): 3 bytes
> [Tue Oct 20 14:53:53.800924 2015] [dumpio:trace7] [pid 5228:tid 2776] mod_dumpio.c(100): [client 132.253.8.198:55373]
> mod_dumpio:  dumpio_out (data-TRANSIENT): a\r\n
> [Tue Oct 20 14:53:53.800924 2015] [dumpio:trace7] [pid 5228:tid 2776] mod_dumpio.c(58): [client 132.253.8.198:55373]
> mod_dumpio:  dumpio_out (data-HEAP): 2 bytes
> [Tue Oct 20 14:53:53.800924 2015] [dumpio:trace7] [pid 5228:tid 2776] mod_dumpio.c(100): [client 132.253.8.198:55373]
> mod_dumpio:  dumpio_out (data-HEAP): \x03
> [Tue Oct 20 14:53:53.800924 2015] [dumpio:trace7] [pid 5228:tid 2776] mod_dumpio.c(58): [client 132.253.8.198:55373]
> mod_dumpio:  dumpio_out (data-POOL): 8 bytes
> [Tue Oct 20 14:53:53.800924 2015] [dumpio:trace7] [pid 5228:tid 2776] mod_dumpio.c(100): [client 132.253.8.198:55373]
> mod_dumpio:  dumpio_out (data-POOL): \xfe\x8e\xed\xee\x12
> [Tue Oct 20 14:53:53.800924 2015] [dumpio:trace7] [pid 5228:tid 2776] mod_dumpio.c(58): [client 132.253.8.198:55373]
> mod_dumpio:  dumpio_out (data-IMMORTAL): 2 bytes
> [Tue Oct 20 14:53:53.800924 2015] [dumpio:trace7] [pid 5228:tid 2776] mod_dumpio.c(100): [client 132.253.8.198:55373]
> mod_dumpio:  dumpio_out (data-IMMORTAL): \r\n
> [Tue Oct 20 14:53:53.800924 2015] [dumpio:trace7] [pid 5228:tid 2776] mod_dumpio.c(58): [client 132.253.8.198:55373]
> mod_dumpio:  dumpio_out (data-IMMORTAL): 5 bytes
> [Tue Oct 20 14:53:53.800924 2015] [dumpio:trace7] [pid 5228:tid 2776] mod_dumpio.c(100): [client 132.253.8.198:55373]
> mod_dumpio:  dumpio_out (data-IMMORTAL): 0\r\n\r\n
> [Tue Oct 20 14:53:53.800924 2015] [dumpio:trace7] [pid 5228:tid 2776] mod_dumpio.c(58): [client 132.253.8.198:55373]
> mod_dumpio:  dumpio_out (metadata-EOS): 0 bytes
> [Tue Oct 20 14:53:53.800924 2015] [dumpio:trace7] [pid 5228:tid 2776] mod_dumpio.c(164): [client 132.253.8.198:55373]
> mod_dumpio: dumpio_out
> [Tue Oct 20 14:53:53.800924 2015] [dumpio:trace7] [pid 5228:tid 2776] mod_dumpio.c(58): [client 132.253.8.198:55373]
> mod_dumpio:  dumpio_out (metadata-EOR): 0 bytes
> [Tue Oct 20 14:53:53.800924 2015] [dumpio:trace7] [pid 5228:tid 2776] mod_dumpio.c(135): [client 132.253.8.198:55373]
> mod_dumpio: dumpio_in [speculative-nonblocking] 1 readbytes
> [Tue Oct 20 14:53:53.800924 2015] [dumpio:trace7] [pid 5228:tid 2776] mod_dumpio.c(58): [client 132.253.8.198:55373]
> mod_dumpio:  dumpio_in (data-HEAP): 1 bytes
> [Tue Oct 20 14:53:53.800924 2015] [dumpio:trace7] [pid 5228:tid 2776] mod_dumpio.c(100): [client 132.253.8.198:55373]
> mod_dumpio:  dumpio_in (data-HEAP): \n

This looks like there is a stray \n in the input queue that causes httpd to think that there is a pipelined request.
What client did you use?


> [Tue Oct 20 14:53:53.800924 2015] [dumpio:trace7] [pid 5228:tid 2776] mod_dumpio.c(135): [client 132.253.8.198:55373]
> mod_dumpio: dumpio_in [getline-blocking] 0 readbytes
> [Tue Oct 20 14:53:53.800924 2015] [dumpio:trace7] [pid 5228:tid 2776] mod_dumpio.c(58): [client 132.253.8.198:55373]
> mod_dumpio:  dumpio_in (data-HEAP): 1 bytes
> [Tue Oct 20 14:53:53.800924 2015] [dumpio:trace7] [pid 5228:tid 2776] mod_dumpio.c(100): [client 132.253.8.198:55373]
> mod_dumpio:  dumpio_in (data-HEAP): \n
> [Tue Oct 20 14:53:53.800924 2015] [dumpio:trace7] [pid 5228:tid 2776] mod_dumpio.c(135): [client 132.253.8.198:55373]
> mod_dumpio: dumpio_in [getline-blocking] 0 readbytes
> [Tue Oct 20 14:53:58.801084 2015] [dumpio:trace7] [pid 5228:tid 2776] mod_dumpio.c(150): [client 132.253.8.198:55373]
> mod_dumpio: dumpio_in - 70007
> [Tue Oct 20 14:53:58.801084 2015] [dumpio:trace7] [pid 5228:tid 2776] mod_dumpio.c(164): [client 132.253.8.198:55373]
> mod_dumpio: dumpio_out
> [Tue Oct 20 14:53:58.801084 2015] [dumpio:trace7] [pid 5228:tid 2776] mod_dumpio.c(58): [client 132.253.8.198:55373]
> mod_dumpio:  dumpio_out (metadata-FLUSH): 0 bytes
> [Tue Oct 20 14:53:58.801084 2015] [dumpio:trace7] [pid 5228:tid 2776] mod_dumpio.c(58): [client 132.253.8.198:55373]
> mod_dumpio:  dumpio_out (metadata-EOC): 0 bytes
> 

Regards

Rüdiger

From dev-return-84386-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Wed Oct 21 12:43:06 2015
Return-Path: <dev-return-84386-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 0114017D7A
	for <apmail-httpd-dev-archive@www.apache.org>; Wed, 21 Oct 2015 12:43:06 +0000 (UTC)
Received: (qmail 84574 invoked by uid 500); 21 Oct 2015 12:43:05 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 84505 invoked by uid 500); 21 Oct 2015 12:43:05 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 84495 invoked by uid 99); 21 Oct 2015 12:43:05 -0000
Received: from Unknown (HELO spamd4-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 21 Oct 2015 12:43:05 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd4-us-west.apache.org (ASF Mail Server at spamd4-us-west.apache.org) with ESMTP id 07B32C137C
	for <dev@httpd.apache.org>; Wed, 21 Oct 2015 12:43:05 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd4-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.111
X-Spam-Level:
X-Spam-Status: No, score=-0.111 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	SPF_PASS=-0.001, T_RP_MATCHES_RCVD=-0.01] autolearn=disabled
Authentication-Results: spamd4-us-west.apache.org (amavisd-new);
	dkim=pass (1024-bit key) header.d=greenbytes.de
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd4-us-west.apache.org [10.40.0.11]) (amavisd-new, port 10024)
	with ESMTP id zOIZ5qox-cpU for <dev@httpd.apache.org>;
	Wed, 21 Oct 2015 12:42:56 +0000 (UTC)
Received: from mail.greenbytes.de (mail.greenbytes.de [217.91.35.233])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id 0B80520B89
	for <dev@httpd.apache.org>; Wed, 21 Oct 2015 12:42:56 +0000 (UTC)
Received: from [192.168.1.42] (unknown [217.91.35.233])
	(using TLSv1 with cipher ECDHE-RSA-AES256-SHA (256/256 bits))
	(Client did not present a certificate)
	by mail.greenbytes.de (Postfix) with ESMTPSA id 73CC115A0622
	for <dev@httpd.apache.org>; Wed, 21 Oct 2015 14:42:49 +0200 (CEST)
DKIM-Signature: v=1; a=rsa-sha256; c=simple/simple; d=greenbytes.de; s=mail;
	t=1445431369; bh=DalPYKbi2imSattbxprD7xJgK0TP2Y5VcRab1c6T59s=;
	h=From:Subject:Date:To:From;
	b=FqMamzyC1KSme8kwxVeLbrK3gCAEoZu19KfMag8iqNAxK86McObeckl/goOx4qWp4
	 CBZtE+bcW2XdfqIfDR8aF1MTMbSplMJCeKB10AOlQD7SRqoOWaKZDcqUnDMQyhj3ub
	 smKWzZmbze75vsBhNqkjqw+9rtjZNLB9voVhc0jg=
From: Stefan Eissing <stefan.eissing@greenbytes.de>
Content-Type: multipart/mixed; boundary="Apple-Mail=_F3B9C345-C57D-448C-8E47-1040D0109283"
Subject: master connection + mod_ssl + http2
Message-Id: <AEF6E6A0-2B04-443F-AD62-97AEC4C2B9BB@greenbytes.de>
Date: Wed, 21 Oct 2015 14:42:49 +0200
To: dev@httpd.apache.org
Mime-Version: 1.0 (Mac OS X Mail 9.0 \(3094\))
X-Mailer: Apple Mail (2.3094)


--Apple-Mail=_F3B9C345-C57D-448C-8E47-1040D0109283
Content-Transfer-Encoding: quoted-printable
Content-Type: text/plain;
	charset=us-ascii

Played around with the concept of master connections today.

I attached a patch that - I think - goes in the right direction. But =
others know mod_ssl better than me. Feedback welcome!

The basic changes:
1. conn_rec->master is NULL for HTTP/1.1 connections, but points to the =
"real" connection for HTTP/2 requests.
2. mod_ssl no longer initalizes any SSLConnRec* for slave connections =
(conn_rec->master !=3D NULL)
3. lookup of ssl variables uses the master's sslconn->ssl if none is =
found on the connection itself
4. ssl_hook_Access() that checks renegotiation fails with a FORBIDDEN =
for a slave connection with a note for the reason.
   This should allow mod_http2 to generate the correct HTTP/2 stream =
error
5. ssl_hook_ReadReq() that checks for wrong host names now has an =
additional check for TLS compatiblity which compares
   protocol, cipher suite, certificate and key file/path names and =
verify mode of the request server against the
   handshake server. This compatibility is strict equality and not as =
sophisticated as the renegotiation checks.

With these changes, mod_http2 has less work for the slave connection =
setup and no longer needs to disable ssl for those. While mod_ssl =
continues to be ignorant of mod_http2, as the same restrictions would =
apply to any protocol with slave connections. With a minor bump in MMN =
we can have this in the next 2.4.

//Stefan

PS. There are more changes needed for mod_http2 as are in the patch. I =
did not want to make this too messy. The ssl changes are the relevant =
one...

--Apple-Mail=_F3B9C345-C57D-448C-8E47-1040D0109283
Content-Disposition: attachment;
	filename=ssl-master-conn.patch
Content-Type: application/octet-stream;
	name="ssl-master-conn.patch"
Content-Transfer-Encoding: 7bit

Index: modules/http2/h2_conn.c
===================================================================
--- modules/http2/h2_conn.c	(revision 1709562)
+++ modules/http2/h2_conn.c	(working copy)
@@ -44,7 +44,6 @@
 
 static h2_mpm_type_t mpm_type = H2_MPM_UNKNOWN;
 static module *mpm_module;
-static module *ssl_module;
 static int checked;
 
 static void check_modules(void) 
@@ -65,9 +64,6 @@
                 mpm_type = H2_MPM_PREFORK;
                 mpm_module = m;
             }
-            else if (!strcmp("mod_ssl.c", m->name)) {
-                ssl_module = m;
-            }
         }
         checked = 1;
     }
@@ -104,9 +100,6 @@
             mpm_type = H2_MPM_PREFORK;
             mpm_module = m;
         }
-        else if (!strcmp("mod_ssl.c", m->name)) {
-            ssl_module = m;
-        }
     }
     
     if (minw <= 0) {
@@ -422,22 +415,12 @@
     env->c.conn_config = ap_create_conn_config(env->pool);
     env->c.notes = apr_table_make(env->pool, 5);
     
+    /* In order to do this in 2.4.x, we need to add a member to conn_rec */
+    env->c.master = master;
+    
     ap_set_module_config(env->c.conn_config, &core_module, 
                          h2_worker_get_socket(worker));
     
-    /* If we serve http:// requests over a TLS connection, we do
-     * not want any mod_ssl vars to be visible.
-     */
-    if (ssl_module && (!env->scheme || strcmp("http", env->scheme))) {
-        /* See #19, there is a range of SSL variables to be gotten from
-         * the main connection that should be available in request handlers
-         */
-        void *sslcfg = ap_get_module_config(master->conn_config, ssl_module);
-        if (sslcfg) {
-            ap_set_module_config(env->c.conn_config, ssl_module, sslcfg);
-        }
-    }
-    
     /* This works for mpm_worker so far. Other mpm modules have 
      * different needs, unfortunately. The most interesting one 
      * being mpm_event...
Index: modules/http2/h2_h2.c
===================================================================
--- modules/http2/h2_h2.c	(revision 1709602)
+++ modules/http2/h2_h2.c	(working copy)
@@ -437,14 +437,6 @@
     return opt_ssl_is_https && opt_ssl_is_https(c);
 }
 
-int h2_tls_disable(conn_rec *c)
-{
-    if (opt_ssl_engine_disable) {
-        return opt_ssl_engine_disable(c);
-    }
-    return 0;
-}
-
 int h2_is_acceptable_connection(conn_rec *c, int require_all) 
 {
     int is_tls = h2_h2_is_tls(c);
Index: modules/http2/h2_h2.h
===================================================================
--- modules/http2/h2_h2.h	(revision 1709587)
+++ modules/http2/h2_h2.h	(working copy)
@@ -43,12 +43,6 @@
  */
 int h2_h2_is_tls(conn_rec *c);
 
-/* Disable SSL for this connection, can only be invoked in a pre-
- * connection hook before mod_ssl.
- * @return != 0 iff disable worked
- */
-int h2_tls_disable(conn_rec *c);
-
 /* Register apache hooks for h2 protocol
  */
 void h2_h2_register_hooks(void);
Index: modules/http2/h2_task.c
===================================================================
--- modules/http2/h2_task.c	(revision 1709562)
+++ modules/http2/h2_task.c	(working copy)
@@ -121,12 +121,6 @@
     if (h2_ctx_is_task(ctx)) {
         h2_task_env *env = h2_ctx_get_task(ctx);
         
-        /* This connection is a pseudo-connection used for a h2_task.
-         * Since we read/write directly from it ourselves, we need
-         * to disable a possible ssl connection filter.
-         */
-        h2_tls_disable(c);
-        
         ap_log_cerror(APLOG_MARK, APLOG_TRACE2, 0, c,
                       "h2_h2, pre_connection, found stream task");
         
Index: modules/ssl/mod_ssl.c
===================================================================
--- modules/ssl/mod_ssl.c	(revision 1709602)
+++ modules/ssl/mod_ssl.c	(working copy)
@@ -563,8 +563,8 @@
     /*
      * Immediately stop processing if SSL is disabled for this connection
      */
-    if (!(sc && (sc->enabled == SSL_ENABLED_TRUE ||
-                 (sslconn && sslconn->is_proxy))))
+    if (c->master || !(sc && (sc->enabled == SSL_ENABLED_TRUE ||
+                              (sslconn && sslconn->is_proxy))))
     {
         return DECLINED;
     }
Index: modules/ssl/ssl_engine_kernel.c
===================================================================
--- modules/ssl/ssl_engine_kernel.c	(revision 1709562)
+++ modules/ssl/ssl_engine_kernel.c	(working copy)
@@ -113,6 +113,108 @@
     return result;
 }
 
+static int ap_array_same_str_set(apr_array_header_t *s1, apr_array_header_t *s2)
+{
+    int i;
+    const char *c;
+    
+    if (s1 == s2) {
+        return 1;
+    }
+    else if (!s1 || !s2 || (s1->nelts != s2->nelts)) {
+        return 0;
+    }
+    
+    for (i = 0; i < s1->nelts; i++) {
+        c = APR_ARRAY_IDX(s1, i, const char *);
+        if (!c || !ap_array_str_contains(s2, c)) {
+            return 0;
+        }
+    }
+    return 1;
+}
+
+static int ssl_pk_server_compatible(modssl_pk_server_t *pks1, 
+                                    modssl_pk_server_t *pks2) 
+{
+    if (!pks1 || !pks2) {
+        return 0;
+    }
+    /* both have the same certificates? */
+    if ((pks1->ca_name_path != pks2->ca_name_path)
+        && (!pks1->ca_name_path || !pks2->ca_name_path 
+            || strcmp(pks1->ca_name_path, pks2->ca_name_path))) {
+        return 0;
+    }
+    if ((pks1->ca_name_file != pks2->ca_name_file)
+        && (!pks1->ca_name_file || !pks2->ca_name_file 
+            || strcmp(pks1->ca_name_file, pks2->ca_name_file))) {
+        return 0;
+    }
+    if (!ap_array_same_str_set(pks1->cert_files, pks2->cert_files)
+        || !ap_array_same_str_set(pks1->key_files, pks2->key_files)) {
+        return 0;
+    }
+    return 1;
+}
+
+static int ssl_auth_compatible(modssl_auth_ctx_t *a1, 
+                               modssl_auth_ctx_t *a2) 
+{
+    if (!a1 || !a2) {
+        return 0;
+    }
+    /* both have the same verification */
+    if ((a1->verify_depth != a2->verify_depth)
+        || (a1->verify_mode != a2->verify_mode)) {
+        return 0;
+    }
+    /* both have the same ca path/file */
+    if ((a1->ca_cert_path != a2->ca_cert_path)
+        && (!a1->ca_cert_path || !a2->ca_cert_path 
+            || strcmp(a1->ca_cert_path, a2->ca_cert_path))) {
+        return 0;
+    }
+    if ((a1->ca_cert_file != a2->ca_cert_file)
+        && (!a1->ca_cert_file || !a2->ca_cert_file 
+            || strcmp(a1->ca_cert_file, a2->ca_cert_file))) {
+        return 0;
+    }
+    /* both have the same ca cipher suite string */
+    if ((a1->cipher_suite != a2->cipher_suite)
+        && (!a1->cipher_suite || !a2->cipher_suite 
+            || strcmp(a1->cipher_suite, a2->cipher_suite))) {
+        return 0;
+    }
+    return 1;
+}
+
+static int ssl_ctx_compatible(modssl_ctx_t *ctx1, 
+                              modssl_ctx_t *ctx2) 
+{
+    if (!ctx1 || !ctx2 
+        || (ctx1->protocol != ctx2->protocol)
+        || !ssl_auth_compatible(&ctx1->auth, &ctx2->auth)
+        || !ssl_pk_server_compatible(ctx1->pks, ctx2->pks)) {
+        return 0;
+    }
+    return 1;
+}
+
+static int ssl_server_compatible(server_rec *s1, server_rec *s2)
+{
+    SSLSrvConfigRec *sc1 = s1? mySrvConfig(s1) : NULL;
+    SSLSrvConfigRec *sc2 = s2? mySrvConfig(s2) : NULL;
+
+    /* both use the same TLS protocol? */
+    if (!sc1 || !sc2 
+        || !ssl_ctx_compatible(sc1->server, sc2->server)) {
+        return 0;
+    }
+    
+    return 1;
+}
+
 /*
  *  Post Read Request Handler
  */
@@ -138,6 +240,9 @@
     }
 
     sslconn = myConnConfig(r->connection);
+    if (!(sslconn && sslconn->ssl) && r->connection->master) {
+        sslconn = myConnConfig(r->connection->master);
+    }
     if (!sslconn) {
         return DECLINED;
     }
@@ -195,15 +300,16 @@
                             " provided in HTTP request", servername);
                 return HTTP_BAD_REQUEST;
             }
-            if (r->server != handshakeserver) {
+            if (r->server != handshakeserver 
+                && !ssl_server_compatible(sslconn->server, r->server)) {
                 /* 
-                 * We are really not in Kansas anymore...
                  * The request does not select the virtual host that was
-                 * selected by the SNI.
+                 * selected by the SNI and its SSL parameters are different
                  */
+                
                 ap_log_error(APLOG_MARK, APLOG_ERR, 0, r->server, APLOGNO(02032)
                              "Hostname %s provided via SNI and hostname %s provided"
-                             " via HTTP select a different server",
+                             " via HTTP have no compatible SSL setup",
                              servername, r->hostname);
                 return HTTP_MISDIRECTED_REQUEST;
             }
@@ -313,8 +419,15 @@
     X509_STORE_CTX cert_store_ctx;
     STACK_OF(SSL_CIPHER) *cipher_list_old = NULL, *cipher_list = NULL;
     const SSL_CIPHER *cipher = NULL;
-    int depth, verify_old, verify, n;
+    int depth, verify_old, verify, n, is_slave = 0;
 
+    if (!(sslconn && ssl) && r->connection->master) {
+        sslconn         = myConnConfig(r->connection->master);
+        ssl             = sslconn ? sslconn->ssl : NULL;
+        handshakeserver = sslconn ? sslconn->server : NULL;
+        is_slave        = 1;
+    }
+    
     if (ssl) {
         /*
          * We should have handshaken here (on handshakeserver),
@@ -333,7 +446,7 @@
      * Support for SSLRequireSSL directive
      */
     if (dc->bSSLRequired && !ssl) {
-        if (sc->enabled == SSL_ENABLED_OPTIONAL) {
+        if ((sc->enabled == SSL_ENABLED_OPTIONAL) && !is_slave) {
             /* This vhost was configured for optional SSL, just tell the
              * client that we need to upgrade.
              */
@@ -432,6 +545,18 @@
         }
 
         /* configure new state */
+        /* TODO: this is not a good idea inside a slave connection, since
+         * multiple threads might try to do the same thing.
+         * We should instead:
+         * A. check if the master cipher suite is == the configured one
+         *    -> do nothing (this should work as TLS master connections MUST
+         *       NOT renegotiate)
+         * B. create a new SSL* from our SSL_CTX and set cipher suite there,
+         *       and retrieve ciphers from, free
+         * C. if renegotiation is needed, fail the request and add a note
+         *    about the reason so protocol engines can return the proper
+         *    failure codes.
+         */
         if ((dc->szCipherSuite || sc->server->auth.cipher_suite) &&
             !SSL_set_cipher_list(ssl, dc->szCipherSuite ?
                                       dc->szCipherSuite :
@@ -502,6 +627,15 @@
         }
 
         if (renegotiate) {
+            if (is_slave) {
+                /* The request causes renegotiation on a slave connection.
+                 * This is not allowed since we might have concurrent requests
+                 * on this connection.
+                 */
+                apr_table_setn(r->notes, "ssl-renegotiation-forbidden", "cipher-suite");
+                return HTTP_FORBIDDEN;
+            }
+            
 #ifdef SSL_OP_CIPHER_SERVER_PREFERENCE
             if (sc->cipher_server_pref == TRUE) {
                 SSL_set_options(ssl, SSL_OP_CIPHER_SERVER_PREFERENCE);
@@ -549,6 +683,9 @@
             verify |= SSL_VERIFY_PEER;
         }
 
+        /* TODO: this seems premature since we do not know if there
+         *       are any changes required.
+         */
         SSL_set_verify(ssl, verify, ssl_callback_SSLVerify);
         SSL_set_verify_result(ssl, X509_V_OK);
 
@@ -564,6 +701,14 @@
                   (verify     & SSL_VERIFY_FAIL_IF_NO_PEER_CERT)))
             {
                 renegotiate = TRUE;
+                if (is_slave) {
+                    /* The request causes renegotiation on a slave connection.
+                     * This is not allowed since we might have concurrent requests
+                     * on this connection.
+                     */
+                    apr_table_setn(r->notes, "ssl-renegotiation-forbidden", "verify-client");
+                    return HTTP_FORBIDDEN;
+                }
                 /* optimization */
 
                 if ((dc->nOptions & SSL_OPT_OPTRENEGOTIATE) &&
@@ -1186,6 +1331,10 @@
         apr_table_mergen(r->headers_out, "Connection", "upgrade");
     }
 
+    if (!(sslconn && sslconn->ssl) && r->connection->master) {
+        sslconn = myConnConfig(r->connection->master);
+    }
+
     /*
      * Check to see if SSL is on
      */
@@ -1208,8 +1357,8 @@
 
     /* standard SSL environment variables */
     if (dc->nOptions & SSL_OPT_STDENVVARS) {
-        modssl_var_extract_dns(env, sslconn->ssl, r->pool);
-        modssl_var_extract_san_entries(env, sslconn->ssl, r->pool);
+        modssl_var_extract_dns(env, ssl, r->pool);
+        modssl_var_extract_san_entries(env, ssl, r->pool);
 
         for (i = 0; ssl_hook_Fixup_vars[i]; i++) {
             var = (char *)ssl_hook_Fixup_vars[i];
Index: modules/ssl/ssl_engine_vars.c
===================================================================
--- modules/ssl/ssl_engine_vars.c	(revision 1709562)
+++ modules/ssl/ssl_engine_vars.c	(working copy)
@@ -39,7 +39,7 @@
 **  _________________________________________________________________
 */
 
-static char *ssl_var_lookup_ssl(apr_pool_t *p, conn_rec *c, request_rec *r, char *var);
+static char *ssl_var_lookup_ssl(apr_pool_t *p, SSLConnRec *sslconn, request_rec *r, char *var);
 static char *ssl_var_lookup_ssl_cert(apr_pool_t *p, request_rec *r, X509 *xs, char *var);
 static char *ssl_var_lookup_ssl_cert_dn(apr_pool_t *p, X509_NAME *xsname, char *var);
 static char *ssl_var_lookup_ssl_cert_san(apr_pool_t *p, X509 *xs, char *var);
@@ -49,8 +49,8 @@
 static char *ssl_var_lookup_ssl_cert_chain(apr_pool_t *p, STACK_OF(X509) *sk, char *var);
 static char *ssl_var_lookup_ssl_cert_rfc4523_cea(apr_pool_t *p, SSL *ssl);
 static char *ssl_var_lookup_ssl_cert_PEM(apr_pool_t *p, X509 *xs);
-static char *ssl_var_lookup_ssl_cert_verify(apr_pool_t *p, conn_rec *c);
-static char *ssl_var_lookup_ssl_cipher(apr_pool_t *p, conn_rec *c, char *var);
+static char *ssl_var_lookup_ssl_cert_verify(apr_pool_t *p, SSLConnRec *sslconn);
+static char *ssl_var_lookup_ssl_cipher(apr_pool_t *p, SSLConnRec *sslconn, char *var);
 static void  ssl_var_lookup_ssl_cipher_bits(SSL *ssl, int *usekeysize, int *algkeysize);
 static char *ssl_var_lookup_ssl_version(apr_pool_t *p, char *var);
 static char *ssl_var_lookup_ssl_compress_meth(SSL *ssl);
@@ -146,7 +146,7 @@
     char *var = (char *)data;
     SSLConnRec *sslconn = myConnConfig(ctx->c);
 
-    return sslconn ? ssl_var_lookup_ssl(ctx->p, ctx->c, ctx->r, var) : NULL;
+    return sslconn ? ssl_var_lookup_ssl(ctx->p, sslconn, ctx->r, var) : NULL;
 }
 
 static const char *expr_func_fn(ap_expr_eval_ctx_t *ctx, const void *data,
@@ -332,9 +332,13 @@
      */
     if (result == NULL && c != NULL) {
         SSLConnRec *sslconn = myConnConfig(c);
+        if (!(sslconn && sslconn->ssl) && c->master) {
+            /* use master connection if no SSL defined here */
+            sslconn = myConnConfig(c->master);
+        }
         if (strlen(var) > 4 && strcEQn(var, "SSL_", 4)
             && sslconn && sslconn->ssl)
-            result = ssl_var_lookup_ssl(p, c, r, var+4);
+            result = ssl_var_lookup_ssl(p, sslconn, r, var+4);
         else if (strcEQ(var, "HTTPS")) {
             if (sslconn && sslconn->ssl)
                 result = "on";
@@ -404,10 +408,9 @@
     return (char *)result;
 }
 
-static char *ssl_var_lookup_ssl(apr_pool_t *p, conn_rec *c, request_rec *r,
-                                char *var)
+static char *ssl_var_lookup_ssl(apr_pool_t *p, SSLConnRec *sslconn, 
+                                request_rec *r, char *var)
 {
-    SSLConnRec *sslconn = myConnConfig(c);
     char *result;
     X509 *xs;
     STACK_OF(X509) *sk;
@@ -447,7 +450,7 @@
             result = "Initial";
     }
     else if (ssl != NULL && strlen(var) >= 6 && strcEQn(var, "CIPHER", 6)) {
-        result = ssl_var_lookup_ssl_cipher(p, c, var+6);
+        result = ssl_var_lookup_ssl_cipher(p, sslconn, var+6);
     }
     else if (ssl != NULL && strlen(var) > 18 && strcEQn(var, "CLIENT_CERT_CHAIN_", 18)) {
         sk = SSL_get_peer_cert_chain(ssl);
@@ -457,7 +460,7 @@
         result = ssl_var_lookup_ssl_cert_rfc4523_cea(p, ssl);
     }
     else if (ssl != NULL && strcEQ(var, "CLIENT_VERIFY")) {
-        result = ssl_var_lookup_ssl_cert_verify(p, c);
+        result = ssl_var_lookup_ssl_cert_verify(p, sslconn);
     }
     else if (ssl != NULL && strlen(var) > 7 && strcEQn(var, "CLIENT_", 7)) {
         if ((xs = SSL_get_peer_certificate(ssl)) != NULL) {
@@ -866,9 +869,8 @@
     return result;
 }
 
-static char *ssl_var_lookup_ssl_cert_verify(apr_pool_t *p, conn_rec *c)
+static char *ssl_var_lookup_ssl_cert_verify(apr_pool_t *p, SSLConnRec *sslconn)
 {
-    SSLConnRec *sslconn = myConnConfig(c);
     char *result;
     long vrc;
     const char *verr;
@@ -902,9 +904,8 @@
     return result;
 }
 
-static char *ssl_var_lookup_ssl_cipher(apr_pool_t *p, conn_rec *c, char *var)
+static char *ssl_var_lookup_ssl_cipher(apr_pool_t *p, SSLConnRec *sslconn, char *var)
 {
-    SSLConnRec *sslconn = myConnConfig(c);
     char *result;
     BOOL resdup;
     int usekeysize, algkeysize;

--Apple-Mail=_F3B9C345-C57D-448C-8E47-1040D0109283
Content-Transfer-Encoding: 7bit
Content-Type: text/plain;
	charset=us-ascii

 
--Apple-Mail=_F3B9C345-C57D-448C-8E47-1040D0109283--

From dev-return-84387-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Wed Oct 21 13:18:30 2015
Return-Path: <dev-return-84387-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id D4FB517EAA
	for <apmail-httpd-dev-archive@www.apache.org>; Wed, 21 Oct 2015 13:18:30 +0000 (UTC)
Received: (qmail 52941 invoked by uid 500); 21 Oct 2015 13:18:27 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 52861 invoked by uid 500); 21 Oct 2015 13:18:27 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 52851 invoked by uid 99); 21 Oct 2015 13:18:27 -0000
Received: from Unknown (HELO spamd1-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 21 Oct 2015 13:18:27 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd1-us-west.apache.org (ASF Mail Server at spamd1-us-west.apache.org) with ESMTP id D1598C3FA8
	for <dev@httpd.apache.org>; Wed, 21 Oct 2015 13:18:26 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd1-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.101
X-Spam-Level:
X-Spam-Status: No, score=-0.101 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RCVD_IN_MSPIKE_H2=-0.001, SPF_PASS=-0.001, URIBL_BLOCKED=0.001]
	autolearn=disabled
Authentication-Results: spamd1-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-us-west.apache.org ([10.40.0.8])
	by localhost (spamd1-us-west.apache.org [10.40.0.7]) (amavisd-new, port 10024)
	with ESMTP id zlqIpTT2EUc0 for <dev@httpd.apache.org>;
	Wed, 21 Oct 2015 13:18:21 +0000 (UTC)
Received: from mail-qk0-f171.google.com (mail-qk0-f171.google.com [209.85.220.171])
	by mx1-us-west.apache.org (ASF Mail Server at mx1-us-west.apache.org) with ESMTPS id 31FC5206A7
	for <dev@httpd.apache.org>; Wed, 21 Oct 2015 13:18:21 +0000 (UTC)
Received: by qkbl190 with SMTP id l190so33303470qkb.2
        for <dev@httpd.apache.org>; Wed, 21 Oct 2015 06:18:20 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        bh=EWxiJF2RNPbi0CfZhdMYwNaVrF0I+HGmpMWyNZj9x/w=;
        b=yc0lCf2cJEhkiXMswMyKIt95BXeriTDS17lfYGw4O253/j0kbC7bTfZnbS1ixA3ROG
         ztkDyBDQbHD63QU5PD6/U11mgAwVZb8OnD5aqKFIJrfq8eR1qR2U826F0MrK5GHYj7bK
         kFUS9bnwa3gL7x2oXVGNTl6DVpE0IzmQenCoES+qc+UG2ylhv6+nilA2ixqZ1ZLAyHKc
         QwrGA/4sT5WrpxVO5HKyxZc9zumaJ5P2/8kzqqmB0jScT9+chJTMYHN9brbROkM/KBG+
         Y/FXYOnb+R2z1y0718jW72wJyI4BUptJyZuxpWZI7lRV9fIhyDwg0i8WPgE0fC8SBWPw
         enCQ==
MIME-Version: 1.0
X-Received: by 10.140.131.198 with SMTP id 189mr11577063qhd.83.1445433500429;
 Wed, 21 Oct 2015 06:18:20 -0700 (PDT)
Received: by 10.55.156.213 with HTTP; Wed, 21 Oct 2015 06:18:20 -0700 (PDT)
In-Reply-To: <AEF6E6A0-2B04-443F-AD62-97AEC4C2B9BB@greenbytes.de>
References: <AEF6E6A0-2B04-443F-AD62-97AEC4C2B9BB@greenbytes.de>
Date: Wed, 21 Oct 2015 15:18:20 +0200
Message-ID: <CAKQ1sVM+AyhA0p_nba1GC_QraMNvdxL+tguUAZNAOvL81XbrwQ@mail.gmail.com>
Subject: Re: master connection + mod_ssl + http2
From: Yann Ylavic <ylavic.dev@gmail.com>
To: dev@httpd.apache.org
Content-Type: text/plain; charset=UTF-8

Hi Stefan,

On Wed, Oct 21, 2015 at 2:42 PM, Stefan Eissing
<stefan.eissing@greenbytes.de> wrote:
> Played around with the concept of master connections today.
>
> I attached a patch that - I think - goes in the right direction.

Didn't look at all the details yet but it looks good to me.

One (aside) point, you should probably separate h2 changes from mod_ssl ones.
The former are CTR, but we'll still need a vote for the latter...
I think it also concers a couple of commits you did lately, even
though changes to both modules are related, it will probably ease
backport to commit them separetly.

>
> The basic changes:
[]
> 5. ssl_hook_ReadReq() that checks for wrong host names now has an additional check for TLS compatiblity which compares
>    protocol, cipher suite, certificate and key file/path names and verify mode of the request server against the
>    handshake server. This compatibility is strict equality and not as sophisticated as the renegotiation checks.

Thanks, we needed that!
It seems however that there are doublons with the checks done in
ssl_hook_Access().
I'm not sure whether this can be expensive, but maybe we could do that
at one single place?
Also the check on the cipher suite looks more tolerent there, it may
be enough to check that the negociated cipher is in the new vhost's
list.

Didn't look at the other points, yet ;)

Regards,
Yann.

From dev-return-84388-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Wed Oct 21 14:07:15 2015
Return-Path: <dev-return-84388-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id D9BA9180F6
	for <apmail-httpd-dev-archive@www.apache.org>; Wed, 21 Oct 2015 14:07:15 +0000 (UTC)
Received: (qmail 76900 invoked by uid 500); 21 Oct 2015 14:07:15 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 76836 invoked by uid 500); 21 Oct 2015 14:07:15 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 76824 invoked by uid 99); 21 Oct 2015 14:07:15 -0000
Received: from Unknown (HELO spamd4-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 21 Oct 2015 14:07:15 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd4-us-west.apache.org (ASF Mail Server at spamd4-us-west.apache.org) with ESMTP id A05F1C0FC5
	for <dev@httpd.apache.org>; Wed, 21 Oct 2015 14:07:14 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd4-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.102
X-Spam-Level:
X-Spam-Status: No, score=-0.102 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RCVD_IN_MSPIKE_H2=-0.001, SPF_PASS=-0.001] autolearn=disabled
Authentication-Results: spamd4-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-us-west.apache.org ([10.40.0.8])
	by localhost (spamd4-us-west.apache.org [10.40.0.11]) (amavisd-new, port 10024)
	with ESMTP id j2KntaoooouT for <dev@httpd.apache.org>;
	Wed, 21 Oct 2015 14:07:13 +0000 (UTC)
Received: from mail-qk0-f175.google.com (mail-qk0-f175.google.com [209.85.220.175])
	by mx1-us-west.apache.org (ASF Mail Server at mx1-us-west.apache.org) with ESMTPS id 8820722F1F
	for <dev@httpd.apache.org>; Wed, 21 Oct 2015 14:07:13 +0000 (UTC)
Received: by qkcy65 with SMTP id y65so35378491qkc.0
        for <dev@httpd.apache.org>; Wed, 21 Oct 2015 07:07:07 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        bh=zrB7qHsnpaEGJYTwlrAkon4dT9fQtrJuwoCf9gYDfDQ=;
        b=HvgB6eQgSUOuYtgTtW5lftnKGGfy3ojuenC/sAMMJWEsfkkEWoQOYMtB7R5nva9u3P
         QcPWzUbpaBdSDV683E5R8J2536+LBxvFKlOvixrfCeyH656BGRX+XmSqGutO2MI7bGP8
         C5TQC5thEBiCKYEADhQRwOBQ1Vugb/BqhEOHBr/XUWaqesWUhj357JZhgVEdsKLRGtBe
         pcsMyjw/M2zWAUqwP4t4lizBNj2/mjonFeChrqKFtpEch+sRkpuHKus2BBJNxL4J9qjt
         7DmwflXYop2mJrYIuuxCzc75+f4DuyeDCBunT1GlmixJOtQ0OCwcKl+pPMuD27YUYrt0
         d32w==
MIME-Version: 1.0
X-Received: by 10.140.131.70 with SMTP id 67mr12205938qhd.70.1445436427153;
 Wed, 21 Oct 2015 07:07:07 -0700 (PDT)
Received: by 10.55.156.213 with HTTP; Wed, 21 Oct 2015 07:07:07 -0700 (PDT)
In-Reply-To: <5627853C.4040006@apache.org>
References: <5625642E.30708@ptc.com>
	<CAKQ1sVPceAVuDMNgt-qGomU6EARQap5HpCbvaPPiwtYXsUvRpg@mail.gmail.com>
	<CALK=YjM5CvMgWAWT=X67JxBdaJDJ5PCFsHJijSEs0bKovFnQtQ@mail.gmail.com>
	<5625A5E7.2070309@ptc.com>
	<CAKQ1sVPRX_st3SWAnF30C62qxTNqjHiSV3iaCHFPr1HLGp_CxA@mail.gmail.com>
	<AB1691BE05AE7F4992697F2A0835627AC63489F4@VOEXM10W.internal.vodafone.com>
	<CAKQ1sVMhNzYPWHTvhdeV6z+mV2ZNq5vjHj=W1d6R46cOQ_-qhQ@mail.gmail.com>
	<AB1691BE05AE7F4992697F2A0835627AC6348C38@VOEXM10W.internal.vodafone.com>
	<CAKQ1sVNHz_aCLZ3um-NV8cJGnhR3FtE6wz+zGgusvW=MA+cO_A@mail.gmail.com>
	<CAKQ1sVO_E2AZBL9CPfpm=_RQEnHWRDWNg67NFKCqy-vC=uoJBw@mail.gmail.com>
	<562668DA.5060804@ptc.com>
	<56269CBD.5060701@ptc.com>
	<5627853C.4040006@apache.org>
Date: Wed, 21 Oct 2015 16:07:07 +0200
Message-ID: <CAKQ1sVORFAFNwxw92Xfxhd9pGs3vCgHgoA3SCty29BbvHoPeSQ@mail.gmail.com>
Subject: Re: [users@httpd] Chunked transfer delay with httpd 2.4 on Windows.
From: Yann Ylavic <ylavic.dev@gmail.com>
To: dev@httpd.apache.org
Content-Type: text/plain; charset=UTF-8

On Wed, Oct 21, 2015 at 2:29 PM, Ruediger Pluem <rpluem@apache.org> wrote:
>
> This looks like there is a stray \n in the input queue that causes httpd to think that there is a pipelined request.

I think we should tolerate blank lines in check_pipeline(), like
read_request_line() does (this is also a RFC compliance).

How about the following patch?

Index: modules/http/http_request.c
===================================================================
--- modules/http/http_request.c    (revision 1709107)
+++ modules/http/http_request.c    (working copy)
@@ -228,24 +228,50 @@ AP_DECLARE(void) ap_die(int type, request_rec *r)
     ap_die_r(type, r, r->status);
 }

-static void check_pipeline(conn_rec *c, apr_bucket_brigade *bb)
+static void check_pipeline(conn_rec *c, apr_bucket_brigade *bb,
+                           int max_blank_lines)
 {
+    c->data_in_input_filters = 0;
     if (c->keepalive != AP_CONN_CLOSE && !c->aborted) {
         apr_status_t rv;
+        int num_blank_lines = 0;
+        char ch, cr = 0;
+        apr_size_t n;

-        AP_DEBUG_ASSERT(APR_BRIGADE_EMPTY(bb));
-        rv = ap_get_brigade(c->input_filters, bb, AP_MODE_SPECULATIVE,
-                            APR_NONBLOCK_READ, 1);
-        if (rv != APR_SUCCESS || APR_BRIGADE_EMPTY(bb)) {
-            /*
-             * Error or empty brigade: There is no data present in the input
-             * filter
-             */
-            c->data_in_input_filters = 0;
+        do {
+            apr_brigade_cleanup(bb);
+            rv = ap_get_brigade(c->input_filters, bb, AP_MODE_SPECULATIVE,
+                                APR_NONBLOCK_READ, 1);
+            if (rv != APR_SUCCESS || APR_BRIGADE_EMPTY(bb)) {
+                /*
+                 * Error or empty brigade: There is no data present
in the input
+                 * filter
+                 */
+                c->data_in_input_filters = 0;
+                break;
+            }
+
+            n = 0;
+            apr_brigade_flatten(bb, &ch, &n);
+            if (!n) {
+                break;
+            }
+            if (ch == APR_ASCII_LF) {
+                num_blank_lines++;
+                cr = 0;
+            }
+            else if (!cr && ch == APR_ASCII_CR) {
+                cr = 1;
+            }
+            else {
+                c->data_in_input_filters = 1;
+                break;
+            }
+        } while (num_blank_lines < max_blank_lines);
+
+        if (num_blank_lines >= max_blank_lines) {
+            c->keepalive = AP_CONN_CLOSE;
         }
-        else {
-            c->data_in_input_filters = 1;
-        }
     }
 }

@@ -255,7 +281,12 @@ AP_DECLARE(void) ap_process_request_after_handler(
     apr_bucket_brigade *bb;
     apr_bucket *b;
     conn_rec *c = r->connection;
+    int max_blank_lines = r->server->limit_req_fields;

+    if (max_blank_lines <= 0) {
+        max_blank_lines = DEFAULT_LIMIT_REQUEST_FIELDS;
+    }
+
     /* Send an EOR bucket through the output filter chain.  When
      * this bucket is destroyed, the request will be logged and
      * its pool will be freed
@@ -279,7 +310,7 @@ AP_DECLARE(void) ap_process_request_after_handler(
      * already by the EOR bucket's cleanup function.
      */

-    check_pipeline(c, bb);
+    check_pipeline(c, bb, max_blank_lines);
     apr_brigade_destroy(bb);
     if (c->cs)
         c->cs->state = (c->aborted) ? CONN_STATE_LINGER
--

Regards,
Yann.

From dev-return-84389-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Wed Oct 21 14:19:25 2015
Return-Path: <dev-return-84389-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id B79A8181AA
	for <apmail-httpd-dev-archive@www.apache.org>; Wed, 21 Oct 2015 14:19:25 +0000 (UTC)
Received: (qmail 4457 invoked by uid 500); 21 Oct 2015 14:19:12 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 4376 invoked by uid 500); 21 Oct 2015 14:19:11 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 4366 invoked by uid 99); 21 Oct 2015 14:19:11 -0000
Received: from Unknown (HELO spamd2-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 21 Oct 2015 14:19:11 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd2-us-west.apache.org (ASF Mail Server at spamd2-us-west.apache.org) with ESMTP id 7D6911A227C
	for <dev@httpd.apache.org>; Wed, 21 Oct 2015 14:19:11 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd2-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.11
X-Spam-Level:
X-Spam-Status: No, score=-0.11 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	SPF_PASS=-0.001, T_RP_MATCHES_RCVD=-0.01, URIBL_BLOCKED=0.001]
	autolearn=disabled
Authentication-Results: spamd2-us-west.apache.org (amavisd-new);
	dkim=pass (1024-bit key) header.d=greenbytes.de
Received: from mx1-us-west.apache.org ([10.40.0.8])
	by localhost (spamd2-us-west.apache.org [10.40.0.9]) (amavisd-new, port 10024)
	with ESMTP id CFAuwHw00KS2 for <dev@httpd.apache.org>;
	Wed, 21 Oct 2015 14:19:00 +0000 (UTC)
Received: from mail.greenbytes.de (mail.greenbytes.de [217.91.35.233])
	by mx1-us-west.apache.org (ASF Mail Server at mx1-us-west.apache.org) with ESMTPS id 377E926B30
	for <dev@httpd.apache.org>; Wed, 21 Oct 2015 14:19:00 +0000 (UTC)
Received: from [192.168.1.42] (unknown [217.91.35.233])
	(using TLSv1 with cipher ECDHE-RSA-AES256-SHA (256/256 bits))
	(Client did not present a certificate)
	by mail.greenbytes.de (Postfix) with ESMTPSA id C164C15A027D
	for <dev@httpd.apache.org>; Wed, 21 Oct 2015 16:18:51 +0200 (CEST)
DKIM-Signature: v=1; a=rsa-sha256; c=simple/simple; d=greenbytes.de; s=mail;
	t=1445437131; bh=STivvxxREy94DBd6AgDFztoETfaO6N0DAqvu4p+rYWE=;
	h=Subject:From:In-Reply-To:Date:References:To:From;
	b=CyqaOi9KciIabJ6bnzuzv4vEr+8jd5Xfa2W0gkqvRfjAhWXr8ueD70PJ3RdTf4UwA
	 DH2rAPew8h+YE2i/i88MdusXL/iyDMDxVxjKfioNkUev6bCNqtEIpEnxYBEwSIbCmI
	 skQFnDXH4uiljH4gxuU7cpw6SYqDx7CoSZN1fXoM=
Content-Type: text/plain; charset=us-ascii
Mime-Version: 1.0 (Mac OS X Mail 9.0 \(3094\))
Subject: buckets and connections (long post)
From: Stefan Eissing <stefan.eissing@greenbytes.de>
In-Reply-To: <D70FBC43-2E52-4BDD-ADA5-88623657CBEC@jaguNET.com>
Date: Wed, 21 Oct 2015 16:18:51 +0200
Content-Transfer-Encoding: quoted-printable
Message-Id: <4D37F1D6-E2FB-408B-9D82-9F7ABABFFE1E@greenbytes.de>
References: <CAKQ1sVNchFx=egp=Q0tgT+1GcBXiten8mh9STetcZXOfJxhsjQ@mail.gmail.com> <CAKQ1sVPjcA9EYNpjcmM9=AU_LCgAsFntOcZnmGoHymds3S5wmA@mail.gmail.com> <AB1691BE05AE7F4992697F2A0835627AC6348972@VOEXM10W.internal.vodafone.com> <7B24F4D1-6904-4C00-A337-88F712026BE9@greenbytes.de> <0D5B13DA-8642-4662-9606-6B5DF94EB87B@sharp.fm> <D70FBC43-2E52-4BDD-ADA5-88623657CBEC@jaguNET.com>
To: dev@httpd.apache.org
X-Mailer: Apple Mail (2.3094)

(Sorry for the long post. It was helpful for myself to write it. If this =
does not
 hold your interest long enough, just ignore it please.)

As I understand it - and that is incomplete - we have a usual request =
processing like this:

A)
worker:
  conn <--- cfilter <--- rfilter
     |--b-b-b-b-b-b-b-b...

with buckets trickling to the connection through connection and request =
filters, state being
held on the stack of the assigned worker.

Once the filters are done, we have

B)
  conn=20
     |--b-b-b-b-b...

just a connection with a bucket brigade yet to be written. This no =
longer needs a stack. The
worker can (depending on the mpm) be re-assigned to other tasks. Buckets =
are streamed out based
on io events (for example).

To go from A) to B), the connection needs to set-aside buckets, which is =
only real work for
some particular type of buckets. Transient ones for example, where the =
data may reside on the=20
stack which is what we need to free in order to reuse the worker.

This is beneficial when the work for setting buckets aside has much less =
impact on the system
than keeping the worker threads allocated. This is especially likely =
when slow clients are involved
that take ages to read a response.

In HTTP/1.1, usually a response is fully read by the client before it =
makes the next request. So,
at least half the roundtrip time, the connection will be in state

C)
  conn=20
     |-

without anything to read or write. But when the next request come in, it =
gets assigned a worker and is
back in state A). Repeat until connection close.

Ok, so far?


How good does this mechanism work for mod_http2? On the one side it's =
the same, on the other quite different.

On the real, main connection, the master connection, where the h2 =
session resides, things are
pretty similar with some exceptions:
- it is very bursty. requests continue to come in. There is no pause =
between responses and the next request.
- pauses, when they happen, will be longer. clients are expected to keep =
open connections around for
  longer (if we let them).
- When there is nothing to do, mod_http2 makes a blocking read on the =
connection input. This currently
  does not lead to the state B) or C). The worker for the http2 =
connection stays assigned. This needs
  to improve.

On the virtual, slave connection, the one for HTTP/2 streams, aka. =
requests, things are very different:
- the slave connection has a socket purely for the looks of it. there is =
no real connection.
- event-ing for input/output is done via conditional variables and mutex =
with the thread working on
  the main connection
- the "set-aside" happens, when output is transferred from the slave =
connection to the main one. The main
  connection allows a configurable number of maximum bytes buffered (or =
set-aside). Whenever the rest
  of the response fits into this buffer, the slave connection will be =
closed and the slave worker is
  reassigned.=20
- Even better, when the response is a file bucket, the file is =
transferred, which is not counted=20
  against the buffer limit (as it is just a handle). Therefore, static =
files are only looked up=20
  by a slave connection, all IO is done by the master thread.

So state A) is the same for slave connections. B) only insofar as the =
set-aside is replaced with the=20
transfer of buckets to the master connection - which happens all the =
time. So, slave connections are
just in A) or are gone. slave connections are not kept open.


This is the way it is implemented now. There may be other ways, but this =
is the way we have. If we
continue along this path, we have the following obstacles to overcome:
1. the master connection probably can play nicer with the MPM so that an =
idle connection uses less
   resources
2. The transfer of buckets from the slave to the master connection is a =
COPY except in case of
   file buckets (and there is a limit on that as well to not run out of =
handles).
   All other attempts at avoiding the copy, failed. This may be a =
personal limitation of my APRbilities.
3. The amount of buffered bytes should be more flexible per stream and =
redistribute a maximum for=20
   the whole session depending on load.
4. mod_http2 needs a process wide Resource Allocator for file handles. A =
master connection should
   borrow n handles at start, increase/decrease the amount based on =
load, to give best performance
5. similar optimizations should be possible for other bucket types =
(mmap? immortal? heap?)
6. pool buckets are very tricky to optimize, as pool creation/destroy is =
not thread-safe in general
   and it depends on how the parent pools and their allocators are set =
up.=20
   Early hopes get easily crushed under load.
7. The buckets passed down on the master connection are using another =
buffer - when on https:// -
   to influence the SSL record sizes on write. Another COPY is not nice, =
but write performance
   is better this way. The ssl optimizations in place do not work for =
HTTP/2 as it has other
   bucket patterns. We should look if we can combine this into something =
without COPY, but with
   good sized SSL writes.


//Stefan



> Am 21.10.2015 um 00:20 schrieb Jim Jagielski <jim@jaguNET.com>:
>=20
> Sorry for not being on-list a bit lately... I've been a bit swamped.
>=20
> Anyway, I too don't want httpd to go down the 'systemd' route: claim
> something as broken to explain, and justify, ripping it out
> and re-creating anew. Sometimes this needs be done, but not
> very often. And when stuff *is* broken, again, it's best to
> fix it than replace it (usually).


From dev-return-84390-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Wed Oct 21 14:23:42 2015
Return-Path: <dev-return-84390-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 1C13B181CB
	for <apmail-httpd-dev-archive@www.apache.org>; Wed, 21 Oct 2015 14:23:42 +0000 (UTC)
Received: (qmail 17656 invoked by uid 500); 21 Oct 2015 14:23:37 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 17578 invoked by uid 500); 21 Oct 2015 14:23:35 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 17568 invoked by uid 99); 21 Oct 2015 14:23:35 -0000
Received: from Unknown (HELO spamd3-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 21 Oct 2015 14:23:35 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd3-us-west.apache.org (ASF Mail Server at spamd3-us-west.apache.org) with ESMTP id 0D3FB1809C5
	for <dev@httpd.apache.org>; Wed, 21 Oct 2015 14:23:34 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd3-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 1.999
X-Spam-Level: *
X-Spam-Status: No, score=1.999 tagged_above=-999 required=6.31
	tests=[FREEMAIL_REPLY=1, KAM_LAZY_DOMAIN_SECURITY=1,
	RCVD_IN_MSPIKE_H2=-0.001] autolearn=disabled
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd3-us-west.apache.org [10.40.0.10]) (amavisd-new, port 10024)
	with ESMTP id by80FNF3gCao for <dev@httpd.apache.org>;
	Wed, 21 Oct 2015 14:23:21 +0000 (UTC)
Received: from mail1.bemta14.messagelabs.com (mail1.bemta14.messagelabs.com [193.109.254.118])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id 790B7439D5
	for <dev@httpd.apache.org>; Wed, 21 Oct 2015 14:23:21 +0000 (UTC)
Received: from [193.109.254.3] by server-14.bemta-14.messagelabs.com id D6/F9-04752-2DF97265; Wed, 21 Oct 2015 14:23:14 +0000
X-Env-Sender: ruediger.pluem@vodafone.com
X-Msg-Ref: server-11.tower-184.messagelabs.com!1445437393!38073963!1
X-Originating-IP: [195.232.244.136]
X-StarScan-Received:
X-StarScan-Version: 6.13.16; banners=-,-,-
X-VirusChecked: Checked
Received: (qmail 32630 invoked from network); 21 Oct 2015 14:23:14 -0000
Received: from mailout04.vodafone.com (HELO mailout04.vodafone.com) (195.232.244.136)
  by server-11.tower-184.messagelabs.com with DHE-RSA-AES256-SHA encrypted SMTP; 21 Oct 2015 14:23:14 -0000
Received: from mailint04.vodafone.com (mailint04.vodafone.com [195.232.244.201])
	by mailout04.vodafone.com (Postfix) with ESMTP id 3ngvDx5d0pznTYj
	for <dev@httpd.apache.org>; Wed, 21 Oct 2015 16:23:13 +0200 (CEST)
Received: from mailint04.vodafone.com (localhost [127.0.0.1])
	by mailint04.vodafone.com (Postfix) with ESMTP id 3ngvDh4lNJzflJl
	for <dev@httpd.apache.org>; Wed, 21 Oct 2015 16:23:00 +0200 (CEST)
Received: from VOEXC04W.internal.vodafone.com (voexc04w.dc-ratingen.de [145.230.101.24])
	(using TLSv1 with cipher AES128-SHA (128/128 bits))
	(No client certificate requested)
	by mailint04.vodafone.com (Postfix) with ESMTPS id 3ngvCq5xSqzfkgy
	for <dev@httpd.apache.org>; Wed, 21 Oct 2015 16:22:15 +0200 (CEST)
Received: from VOEXC16W.internal.vodafone.com (145.230.101.18) by
 VOEXC04W.internal.vodafone.com (145.230.101.24) with Microsoft SMTP Server
 (TLS) id 14.3.224.2; Wed, 21 Oct 2015 16:22:13 +0200
Received: from VOEXM10W.internal.vodafone.com ([169.254.2.88]) by
 voexc16w.internal.vodafone.com ([145.230.101.18]) with mapi id
 14.03.0224.002; Wed, 21 Oct 2015 16:22:13 +0200
From: =?utf-8?B?UGzDvG0sIFLDvGRpZ2VyLCBWb2RhZm9uZSBHcm91cA==?=
	<ruediger.pluem@vodafone.com>
To: "dev@httpd.apache.org" <dev@httpd.apache.org>
Subject: AW: [users@httpd] Chunked transfer delay with httpd 2.4 on Windows.
Thread-Topic: [users@httpd] Chunked transfer delay with httpd 2.4 on Windows.
Thread-Index: AQHRCsKp6VHmLQpuNE+WM3OmAfdh+J5zadyAgAAcCICAAF4bAIAAJXpg///pRwCAAC1QoP//6P4AgAABm4CAAGOhAIAAPdqAgAEVKQCAABswgIAAJQ/Q
Date: Wed, 21 Oct 2015 14:22:12 +0000
Message-ID: <AB1691BE05AE7F4992697F2A0835627AC634A1A9@VOEXM10W.internal.vodafone.com>
References: <5625642E.30708@ptc.com>
	<CAKQ1sVPceAVuDMNgt-qGomU6EARQap5HpCbvaPPiwtYXsUvRpg@mail.gmail.com>
	<CALK=YjM5CvMgWAWT=X67JxBdaJDJ5PCFsHJijSEs0bKovFnQtQ@mail.gmail.com>
	<5625A5E7.2070309@ptc.com>
	<CAKQ1sVPRX_st3SWAnF30C62qxTNqjHiSV3iaCHFPr1HLGp_CxA@mail.gmail.com>
	<AB1691BE05AE7F4992697F2A0835627AC63489F4@VOEXM10W.internal.vodafone.com>
	<CAKQ1sVMhNzYPWHTvhdeV6z+mV2ZNq5vjHj=W1d6R46cOQ_-qhQ@mail.gmail.com>
	<AB1691BE05AE7F4992697F2A0835627AC6348C38@VOEXM10W.internal.vodafone.com>
	<CAKQ1sVNHz_aCLZ3um-NV8cJGnhR3FtE6wz+zGgusvW=MA+cO_A@mail.gmail.com>
	<CAKQ1sVO_E2AZBL9CPfpm=_RQEnHWRDWNg67NFKCqy-vC=uoJBw@mail.gmail.com>
	<562668DA.5060804@ptc.com>	<56269CBD.5060701@ptc.com>
	<5627853C.4040006@apache.org>
 <CAKQ1sVORFAFNwxw92Xfxhd9pGs3vCgHgoA3SCty29BbvHoPeSQ@mail.gmail.com>
In-Reply-To: <CAKQ1sVORFAFNwxw92Xfxhd9pGs3vCgHgoA3SCty29BbvHoPeSQ@mail.gmail.com>
Accept-Language: en-US
Content-Language: de-DE
X-MS-Has-Attach:
X-MS-TNEF-Correlator:
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
MIME-Version: 1.0

DQoNCj4gLS0tLS1VcnNwcsO8bmdsaWNoZSBOYWNocmljaHQtLS0tLQ0KPiBWb246IFlhbm4gWWxh
dmljIFttYWlsdG86eWxhdmljLmRldkBnbWFpbC5jb21dDQo+IEdlc2VuZGV0OiBNaXR0d29jaCwg
MjEuIE9rdG9iZXIgMjAxNSAxNjowNw0KPiBBbjogZGV2QGh0dHBkLmFwYWNoZS5vcmcNCj4gQmV0
cmVmZjogUmU6IFt1c2Vyc0BodHRwZF0gQ2h1bmtlZCB0cmFuc2ZlciBkZWxheSB3aXRoIGh0dHBk
IDIuNCBvbg0KPiBXaW5kb3dzLg0KPiANCj4gT24gV2VkLCBPY3QgMjEsIDIwMTUgYXQgMjoyOSBQ
TSwgUnVlZGlnZXIgUGx1ZW0gPHJwbHVlbUBhcGFjaGUub3JnPg0KPiB3cm90ZToNCj4gPg0KPiA+
IFRoaXMgbG9va3MgbGlrZSB0aGVyZSBpcyBhIHN0cmF5IFxuIGluIHRoZSBpbnB1dCBxdWV1ZSB0
aGF0IGNhdXNlcw0KPiBodHRwZCB0byB0aGluayB0aGF0IHRoZXJlIGlzIGEgcGlwZWxpbmVkIHJl
cXVlc3QuDQo+IA0KPiBJIHRoaW5rIHdlIHNob3VsZCB0b2xlcmF0ZSBibGFuayBsaW5lcyBpbiBj
aGVja19waXBlbGluZSgpLCBsaWtlDQo+IHJlYWRfcmVxdWVzdF9saW5lKCkgZG9lcyAodGhpcyBp
cyBhbHNvIGEgUkZDIGNvbXBsaWFuY2UpLg0KPiANCj4gSG93IGFib3V0IHRoZSBmb2xsb3dpbmcg
cGF0Y2g/DQoNCkluIGdlbmVyYWwgdGhpcyBsb29rcyBnb29kLCBidXQgd2h5IG5vdCBtb3Zpbmcg
dGhlIG1heF9ibGFua19saW5lcyBsb2dpYw0KaW50byBjaGVja19waXBlbGluZSB1c2luZyBjLT5z
ZXJ2ZXItPmxpbWl0X3JlcV9maWVsZHMsIHNvIHRoYXQgd2UgZG8gbm90IG5lZWQgdG8gY2hhbmdl
DQppdHMgcHJvdG90eXBlPw0KDQoNClJlZ2FyZHMNCg0KUsO8ZGlnZXINCg==

From dev-return-84391-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Wed Oct 21 14:25:27 2015
Return-Path: <dev-return-84391-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 3E558181E6
	for <apmail-httpd-dev-archive@www.apache.org>; Wed, 21 Oct 2015 14:25:27 +0000 (UTC)
Received: (qmail 25241 invoked by uid 500); 21 Oct 2015 14:25:17 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 25157 invoked by uid 500); 21 Oct 2015 14:25:16 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 25146 invoked by uid 99); 21 Oct 2015 14:25:16 -0000
Received: from Unknown (HELO spamd2-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 21 Oct 2015 14:25:16 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd2-us-west.apache.org (ASF Mail Server at spamd2-us-west.apache.org) with ESMTP id B70471A227C
	for <dev@httpd.apache.org>; Wed, 21 Oct 2015 14:25:15 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd2-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.01
X-Spam-Level:
X-Spam-Status: No, score=-0.01 tagged_above=-999 required=6.31
	tests=[SPF_PASS=-0.001, T_RP_MATCHES_RCVD=-0.01, URIBL_BLOCKED=0.001]
	autolearn=disabled
Received: from mx1-us-west.apache.org ([10.40.0.8])
	by localhost (spamd2-us-west.apache.org [10.40.0.9]) (amavisd-new, port 10024)
	with ESMTP id M-e8Mbh_vMrm for <dev@httpd.apache.org>;
	Wed, 21 Oct 2015 14:25:08 +0000 (UTC)
Received: from monica.sharp.fm (monica.sharp.fm [80.168.143.5])
	by mx1-us-west.apache.org (ASF Mail Server at mx1-us-west.apache.org) with ESMTP id 6FEA126B30
	for <dev@httpd.apache.org>; Wed, 21 Oct 2015 14:25:08 +0000 (UTC)
Received: from [10.105.13.226] (unknown [5.56.169.82])
	(using TLSv1 with cipher DHE-RSA-AES256-SHA (256/256 bits))
	(Client did not present a certificate)
	(Authenticated sender: minfrin@sharp.fm)
	by monica.sharp.fm (Postfix) with ESMTPSA id 8F00980718
	for <dev@httpd.apache.org>; Wed, 21 Oct 2015 15:25:01 +0100 (BST)
Content-Type: text/plain; charset=utf-8
Mime-Version: 1.0 (Mac OS X Mail 8.2 \(2104\))
Subject: Re: master connection + mod_ssl + http2
From: Graham Leggett <minfrin@sharp.fm>
In-Reply-To: <AEF6E6A0-2B04-443F-AD62-97AEC4C2B9BB@greenbytes.de>
Date: Wed, 21 Oct 2015 16:25:00 +0200
Content-Transfer-Encoding: quoted-printable
Message-Id: <CE0233E3-BB06-44B6-9C51-E8909D05C43F@sharp.fm>
References: <AEF6E6A0-2B04-443F-AD62-97AEC4C2B9BB@greenbytes.de>
To: dev@httpd.apache.org
X-Mailer: Apple Mail (2.2104)

On 21 Oct 2015, at 2:42 PM, Stefan Eissing =
<stefan.eissing@greenbytes.de> wrote:

> The basic changes:
> 1. conn_rec->master is NULL for HTTP/1.1 connections, but points to =
the "real" connection for HTTP/2 requests.
> 2. mod_ssl no longer initalizes any SSLConnRec* for slave connections =
(conn_rec->master !=3D NULL)
> 3. lookup of ssl variables uses the master's sslconn->ssl if none is =
found on the connection itself
> 4. ssl_hook_Access() that checks renegotiation fails with a FORBIDDEN =
for a slave connection with a note for the reason.
>   This should allow mod_http2 to generate the correct HTTP/2 stream =
error
> 5. ssl_hook_ReadReq() that checks for wrong host names now has an =
additional check for TLS compatiblity which compares
>   protocol, cipher suite, certificate and key file/path names and =
verify mode of the request server against the
>   handshake server. This compatibility is strict equality and not as =
sophisticated as the renegotiation checks.
>=20
> With these changes, mod_http2 has less work for the slave connection =
setup and no longer needs to disable ssl for those. While mod_ssl =
continues to be ignorant of mod_http2, as the same restrictions would =
apply to any protocol with slave connections. With a minor bump in MMN =
we can have this in the next 2.4.

Not having looked at the patch yet, the above seems to make sense.

Regards,
Graham
=E2=80=94


From dev-return-84392-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Wed Oct 21 14:28:03 2015
Return-Path: <dev-return-84392-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 7E8AC181FD
	for <apmail-httpd-dev-archive@www.apache.org>; Wed, 21 Oct 2015 14:28:03 +0000 (UTC)
Received: (qmail 32296 invoked by uid 500); 21 Oct 2015 14:28:03 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 31351 invoked by uid 500); 21 Oct 2015 14:28:01 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 31339 invoked by uid 99); 21 Oct 2015 14:28:01 -0000
Received: from Unknown (HELO spamd1-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 21 Oct 2015 14:28:01 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd1-us-west.apache.org (ASF Mail Server at spamd1-us-west.apache.org) with ESMTP id 24A63C4165
	for <dev@httpd.apache.org>; Wed, 21 Oct 2015 14:28:00 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd1-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.12
X-Spam-Level:
X-Spam-Status: No, score=-0.12 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RCVD_IN_MSPIKE_H3=-0.01, RCVD_IN_MSPIKE_WL=-0.01, SPF_PASS=-0.001,
	URIBL_BLOCKED=0.001] autolearn=disabled
Authentication-Results: spamd1-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-us-west.apache.org ([10.40.0.8])
	by localhost (spamd1-us-west.apache.org [10.40.0.7]) (amavisd-new, port 10024)
	with ESMTP id SlXLZtZvFeaP for <dev@httpd.apache.org>;
	Wed, 21 Oct 2015 14:27:55 +0000 (UTC)
Received: from mail-qk0-f170.google.com (mail-qk0-f170.google.com [209.85.220.170])
	by mx1-us-west.apache.org (ASF Mail Server at mx1-us-west.apache.org) with ESMTPS id 2FE8F20FE0
	for <dev@httpd.apache.org>; Wed, 21 Oct 2015 14:27:55 +0000 (UTC)
Received: by qkcy65 with SMTP id y65so36284593qkc.0
        for <dev@httpd.apache.org>; Wed, 21 Oct 2015 07:27:54 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type:content-transfer-encoding;
        bh=d9oLZKnc1mxFBh74mYv3MIsz4btXqH6szRfOwOLuysw=;
        b=XJv/d7l0gLrsIu06Xog84kIXNXldTc5C5L7u0Z9hH53EpbyHgWKTE9Ikm/K9UEQ+1s
         l037+1lWvlbGHudneYAKcB5R5xMDdFbfGzzt0INeKWxvLsiT4tl0A95oFu+YMSBtBAHc
         z790W4takmbma8Nb8paRdYtE9OZH7F39m+EKNb3/QeVdpnOaVyPAenAXrdv1SwvpeqvD
         Misxsa9ycmW75MUhy54zD93u8AxIBuwjgiJC0AG3tIAIPCG1pM8PjcTY/jEDWng9o0D6
         Em8dXAcK7I/uUAuFzxfoiFdGjO+sFmzPYiMT9EkT3f1QaJkJpE6qdXarJURybHuYplKG
         TFoA==
MIME-Version: 1.0
X-Received: by 10.55.192.15 with SMTP id o15mr11886740qki.2.1445437674489;
 Wed, 21 Oct 2015 07:27:54 -0700 (PDT)
Received: by 10.55.156.213 with HTTP; Wed, 21 Oct 2015 07:27:54 -0700 (PDT)
In-Reply-To: <AB1691BE05AE7F4992697F2A0835627AC634A1A9@VOEXM10W.internal.vodafone.com>
References: <5625642E.30708@ptc.com>
	<CAKQ1sVPceAVuDMNgt-qGomU6EARQap5HpCbvaPPiwtYXsUvRpg@mail.gmail.com>
	<CALK=YjM5CvMgWAWT=X67JxBdaJDJ5PCFsHJijSEs0bKovFnQtQ@mail.gmail.com>
	<5625A5E7.2070309@ptc.com>
	<CAKQ1sVPRX_st3SWAnF30C62qxTNqjHiSV3iaCHFPr1HLGp_CxA@mail.gmail.com>
	<AB1691BE05AE7F4992697F2A0835627AC63489F4@VOEXM10W.internal.vodafone.com>
	<CAKQ1sVMhNzYPWHTvhdeV6z+mV2ZNq5vjHj=W1d6R46cOQ_-qhQ@mail.gmail.com>
	<AB1691BE05AE7F4992697F2A0835627AC6348C38@VOEXM10W.internal.vodafone.com>
	<CAKQ1sVNHz_aCLZ3um-NV8cJGnhR3FtE6wz+zGgusvW=MA+cO_A@mail.gmail.com>
	<CAKQ1sVO_E2AZBL9CPfpm=_RQEnHWRDWNg67NFKCqy-vC=uoJBw@mail.gmail.com>
	<562668DA.5060804@ptc.com>
	<56269CBD.5060701@ptc.com>
	<5627853C.4040006@apache.org>
	<CAKQ1sVORFAFNwxw92Xfxhd9pGs3vCgHgoA3SCty29BbvHoPeSQ@mail.gmail.com>
	<AB1691BE05AE7F4992697F2A0835627AC634A1A9@VOEXM10W.internal.vodafone.com>
Date: Wed, 21 Oct 2015 16:27:54 +0200
Message-ID: <CAKQ1sVNpfUzE5ubnHJVa2h-_y45nDSbXS8XbOZJp3x7HFaMb9Q@mail.gmail.com>
Subject: Re: [users@httpd] Chunked transfer delay with httpd 2.4 on Windows.
From: Yann Ylavic <ylavic.dev@gmail.com>
To: dev@httpd.apache.org
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: quoted-printable

On Wed, Oct 21, 2015 at 4:22 PM, Pl=C3=BCm, R=C3=BCdiger, Vodafone Group
<ruediger.pluem@vodafone.com> wrote:
>
>
>> -----Urspr=C3=BCngliche Nachricht-----
>> Von: Yann Ylavic [mailto:ylavic.dev@gmail.com]
>> Gesendet: Mittwoch, 21. Oktober 2015 16:07
>> An: dev@httpd.apache.org
>> Betreff: Re: [users@httpd] Chunked transfer delay with httpd 2.4 on
>> Windows.
>>
>> On Wed, Oct 21, 2015 at 2:29 PM, Ruediger Pluem <rpluem@apache.org>
>> wrote:
>> >
>> > This looks like there is a stray \n in the input queue that causes
>> httpd to think that there is a pipelined request.
>>
>> I think we should tolerate blank lines in check_pipeline(), like
>> read_request_line() does (this is also a RFC compliance).
>>
>> How about the following patch?
>
> In general this looks good, but why not moving the max_blank_lines logic
> into check_pipeline using c->server->limit_req_fields, so that we do not =
need to change
> its prototype?

Hmm, check_pipeline() is static, why bother?
Also c->base_server may be different than r->server (after the first
request), and we probably want to use the value from the last
request's vhost (a bit like we did already for keep_alive_timeout).

Regards,
Yann.

From dev-return-84393-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Wed Oct 21 14:30:15 2015
Return-Path: <dev-return-84393-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id A3A731821F
	for <apmail-httpd-dev-archive@www.apache.org>; Wed, 21 Oct 2015 14:30:15 +0000 (UTC)
Received: (qmail 37860 invoked by uid 500); 21 Oct 2015 14:30:08 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 37746 invoked by uid 500); 21 Oct 2015 14:30:08 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 37736 invoked by uid 99); 21 Oct 2015 14:30:08 -0000
Received: from Unknown (HELO spamd1-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 21 Oct 2015 14:30:08 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd1-us-west.apache.org (ASF Mail Server at spamd1-us-west.apache.org) with ESMTP id 8ED4BC41A0
	for <dev@httpd.apache.org>; Wed, 21 Oct 2015 14:30:07 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd1-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 2
X-Spam-Level: **
X-Spam-Status: No, score=2 tagged_above=-999 required=6.31
	tests=[FREEMAIL_REPLY=1, KAM_LAZY_DOMAIN_SECURITY=1,
	SPF_HELO_PASS=-0.001, URIBL_BLOCKED=0.001] autolearn=disabled
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd1-us-west.apache.org [10.40.0.7]) (amavisd-new, port 10024)
	with ESMTP id IBJLLuFoGpWu for <dev@httpd.apache.org>;
	Wed, 21 Oct 2015 14:29:57 +0000 (UTC)
Received: from mail1.bemta3.messagelabs.com (mail1.bemta3.messagelabs.com [195.245.230.169])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id 9AD12428E4
	for <dev@httpd.apache.org>; Wed, 21 Oct 2015 14:29:56 +0000 (UTC)
Received: from [195.245.230.51] by server-9.bemta-3.messagelabs.com id 2C/2D-10678-D51A7265; Wed, 21 Oct 2015 14:29:49 +0000
X-Env-Sender: ruediger.pluem@vodafone.com
X-Msg-Ref: server-3.tower-33.messagelabs.com!1445437788!25980386!1
X-Originating-IP: [195.232.244.135]
X-StarScan-Received:
X-StarScan-Version: 6.13.16; banners=-,-,-
X-VirusChecked: Checked
Received: (qmail 18348 invoked from network); 21 Oct 2015 14:29:49 -0000
Received: from mailout03.vodafone.com (HELO mailout03.vodafone.com) (195.232.244.135)
  by server-3.tower-33.messagelabs.com with DHE-RSA-AES256-SHA encrypted SMTP; 21 Oct 2015 14:29:49 -0000
Received: from mailint02.vodafone.com (mailint02.vodafone.com [195.232.244.199])
	by mailout03.vodafone.com (Postfix) with ESMTP id 3ngvNX67hwz17HNQ
	for <dev@httpd.apache.org>; Wed, 21 Oct 2015 16:29:48 +0200 (CEST)
Received: from mailint02.vodafone.com (localhost [127.0.0.1])
	by mailint02.vodafone.com (Postfix) with ESMTP id 3ngvNX53XXzQk11
	for <dev@httpd.apache.org>; Wed, 21 Oct 2015 16:29:48 +0200 (CEST)
Received: from VOEXC01W.internal.vodafone.com (voexc01w.dc-ratingen.de [145.230.101.21])
	(using TLSv1 with cipher AES128-SHA (128/128 bits))
	(No client certificate requested)
	by mailint02.vodafone.com (Postfix) with ESMTPS id 3ngvNX503gzQjv4
	for <dev@httpd.apache.org>; Wed, 21 Oct 2015 16:29:48 +0200 (CEST)
Received: from VOEXC13W.internal.vodafone.com (145.230.101.15) by
 VOEXC01W.internal.vodafone.com (145.230.101.21) with Microsoft SMTP Server
 (TLS) id 14.3.224.2; Wed, 21 Oct 2015 16:29:48 +0200
Received: from VOEXM10W.internal.vodafone.com ([169.254.2.88]) by
 voexc13w.internal.vodafone.com ([145.230.101.15]) with mapi id
 14.03.0224.002; Wed, 21 Oct 2015 16:29:47 +0200
From: =?utf-8?B?UGzDvG0sIFLDvGRpZ2VyLCBWb2RhZm9uZSBHcm91cA==?=
	<ruediger.pluem@vodafone.com>
To: "dev@httpd.apache.org" <dev@httpd.apache.org>
Subject: AW: [users@httpd] Chunked transfer delay with httpd 2.4 on Windows.
Thread-Topic: [users@httpd] Chunked transfer delay with httpd 2.4 on Windows.
Thread-Index: AQHRCsKp6VHmLQpuNE+WM3OmAfdh+J5zadyAgAAcCICAAF4bAIAAJXpg///pRwCAAC1QoP//6P4AgAABm4CAAGOhAIAAPdqAgAEVKQCAABswgIAAJQ/Q///gwAAABDz78A==
Date: Wed, 21 Oct 2015 14:29:46 +0000
Message-ID: <AB1691BE05AE7F4992697F2A0835627AC634A1E6@VOEXM10W.internal.vodafone.com>
References: <5625642E.30708@ptc.com>
	<CAKQ1sVPceAVuDMNgt-qGomU6EARQap5HpCbvaPPiwtYXsUvRpg@mail.gmail.com>
	<CALK=YjM5CvMgWAWT=X67JxBdaJDJ5PCFsHJijSEs0bKovFnQtQ@mail.gmail.com>
	<5625A5E7.2070309@ptc.com>
	<CAKQ1sVPRX_st3SWAnF30C62qxTNqjHiSV3iaCHFPr1HLGp_CxA@mail.gmail.com>
	<AB1691BE05AE7F4992697F2A0835627AC63489F4@VOEXM10W.internal.vodafone.com>
	<CAKQ1sVMhNzYPWHTvhdeV6z+mV2ZNq5vjHj=W1d6R46cOQ_-qhQ@mail.gmail.com>
	<AB1691BE05AE7F4992697F2A0835627AC6348C38@VOEXM10W.internal.vodafone.com>
	<CAKQ1sVNHz_aCLZ3um-NV8cJGnhR3FtE6wz+zGgusvW=MA+cO_A@mail.gmail.com>
	<CAKQ1sVO_E2AZBL9CPfpm=_RQEnHWRDWNg67NFKCqy-vC=uoJBw@mail.gmail.com>
	<562668DA.5060804@ptc.com>	<56269CBD.5060701@ptc.com>
	<5627853C.4040006@apache.org>
	<CAKQ1sVORFAFNwxw92Xfxhd9pGs3vCgHgoA3SCty29BbvHoPeSQ@mail.gmail.com>
	<AB1691BE05AE7F4992697F2A0835627AC634A1A9@VOEXM10W.internal.vodafone.com>
 <CAKQ1sVNpfUzE5ubnHJVa2h-_y45nDSbXS8XbOZJp3x7HFaMb9Q@mail.gmail.com>
In-Reply-To: <CAKQ1sVNpfUzE5ubnHJVa2h-_y45nDSbXS8XbOZJp3x7HFaMb9Q@mail.gmail.com>
Accept-Language: en-US
Content-Language: de-DE
X-MS-Has-Attach:
X-MS-TNEF-Correlator:
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
MIME-Version: 1.0

DQoNCj4gLS0tLS1VcnNwcsO8bmdsaWNoZSBOYWNocmljaHQtLS0tLQ0KPiBWb246IFlhbm4gWWxh
dmljIFttYWlsdG86eWxhdmljLmRldkBnbWFpbC5jb21dDQo+IEdlc2VuZGV0OiBNaXR0d29jaCwg
MjEuIE9rdG9iZXIgMjAxNSAxNjoyOA0KPiBBbjogZGV2QGh0dHBkLmFwYWNoZS5vcmcNCj4gQmV0
cmVmZjogUmU6IFt1c2Vyc0BodHRwZF0gQ2h1bmtlZCB0cmFuc2ZlciBkZWxheSB3aXRoIGh0dHBk
IDIuNCBvbg0KPiBXaW5kb3dzLg0KPiANCj4gT24gV2VkLCBPY3QgMjEsIDIwMTUgYXQgNDoyMiBQ
TSwgUGzDvG0sIFLDvGRpZ2VyLCBWb2RhZm9uZSBHcm91cA0KPiA8cnVlZGlnZXIucGx1ZW1Adm9k
YWZvbmUuY29tPiB3cm90ZToNCj4gPg0KPiA+DQo+ID4+IC0tLS0tVXJzcHLDvG5nbGljaGUgTmFj
aHJpY2h0LS0tLS0NCj4gPj4gVm9uOiBZYW5uIFlsYXZpYyBbbWFpbHRvOnlsYXZpYy5kZXZAZ21h
aWwuY29tXQ0KPiA+PiBHZXNlbmRldDogTWl0dHdvY2gsIDIxLiBPa3RvYmVyIDIwMTUgMTY6MDcN
Cj4gPj4gQW46IGRldkBodHRwZC5hcGFjaGUub3JnDQo+ID4+IEJldHJlZmY6IFJlOiBbdXNlcnNA
aHR0cGRdIENodW5rZWQgdHJhbnNmZXIgZGVsYXkgd2l0aCBodHRwZCAyLjQgb24NCj4gPj4gV2lu
ZG93cy4NCj4gPj4NCj4gPj4gT24gV2VkLCBPY3QgMjEsIDIwMTUgYXQgMjoyOSBQTSwgUnVlZGln
ZXIgUGx1ZW0gPHJwbHVlbUBhcGFjaGUub3JnPg0KPiA+PiB3cm90ZToNCj4gPj4gPg0KPiA+PiA+
IFRoaXMgbG9va3MgbGlrZSB0aGVyZSBpcyBhIHN0cmF5IFxuIGluIHRoZSBpbnB1dCBxdWV1ZSB0
aGF0IGNhdXNlcw0KPiA+PiBodHRwZCB0byB0aGluayB0aGF0IHRoZXJlIGlzIGEgcGlwZWxpbmVk
IHJlcXVlc3QuDQo+ID4+DQo+ID4+IEkgdGhpbmsgd2Ugc2hvdWxkIHRvbGVyYXRlIGJsYW5rIGxp
bmVzIGluIGNoZWNrX3BpcGVsaW5lKCksIGxpa2UNCj4gPj4gcmVhZF9yZXF1ZXN0X2xpbmUoKSBk
b2VzICh0aGlzIGlzIGFsc28gYSBSRkMgY29tcGxpYW5jZSkuDQo+ID4+DQo+ID4+IEhvdyBhYm91
dCB0aGUgZm9sbG93aW5nIHBhdGNoPw0KPiA+DQo+ID4gSW4gZ2VuZXJhbCB0aGlzIGxvb2tzIGdv
b2QsIGJ1dCB3aHkgbm90IG1vdmluZyB0aGUgbWF4X2JsYW5rX2xpbmVzDQo+IGxvZ2ljDQo+ID4g
aW50byBjaGVja19waXBlbGluZSB1c2luZyBjLT5zZXJ2ZXItPmxpbWl0X3JlcV9maWVsZHMsIHNv
IHRoYXQgd2UgZG8NCj4gbm90IG5lZWQgdG8gY2hhbmdlDQo+ID4gaXRzIHByb3RvdHlwZT8NCj4g
DQo+IEhtbSwgY2hlY2tfcGlwZWxpbmUoKSBpcyBzdGF0aWMsIHdoeSBib3RoZXI/DQo+IEFsc28g
Yy0+YmFzZV9zZXJ2ZXIgbWF5IGJlIGRpZmZlcmVudCB0aGFuIHItPnNlcnZlciAoYWZ0ZXIgdGhl
IGZpcnN0DQo+IHJlcXVlc3QpLCBhbmQgd2UgcHJvYmFibHkgd2FudCB0byB1c2UgdGhlIHZhbHVl
IGZyb20gdGhlIGxhc3QNCj4gcmVxdWVzdCdzIHZob3N0IChhIGJpdCBsaWtlIHdlIGRpZCBhbHJl
YWR5IGZvciBrZWVwX2FsaXZlX3RpbWVvdXQpLg0KPiANCg0KT0suIEZhaXIgZW5vdWdoLg0KDQpS
ZWdhcmRzDQoNClLDvGRpZ2VyDQo=

From dev-return-84394-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Wed Oct 21 14:31:52 2015
Return-Path: <dev-return-84394-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 0D73718238
	for <apmail-httpd-dev-archive@www.apache.org>; Wed, 21 Oct 2015 14:31:52 +0000 (UTC)
Received: (qmail 42789 invoked by uid 500); 21 Oct 2015 14:31:51 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 42701 invoked by uid 500); 21 Oct 2015 14:31:50 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 42687 invoked by uid 99); 21 Oct 2015 14:31:50 -0000
Received: from Unknown (HELO spamd2-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 21 Oct 2015 14:31:50 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd2-us-west.apache.org (ASF Mail Server at spamd2-us-west.apache.org) with ESMTP id 995DA1A296A
	for <dev@httpd.apache.org>; Wed, 21 Oct 2015 14:31:49 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd2-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.12
X-Spam-Level:
X-Spam-Status: No, score=-0.12 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RCVD_IN_MSPIKE_H3=-0.01, RCVD_IN_MSPIKE_WL=-0.01, SPF_PASS=-0.001,
	URIBL_BLOCKED=0.001] autolearn=disabled
Authentication-Results: spamd2-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd2-us-west.apache.org [10.40.0.9]) (amavisd-new, port 10024)
	with ESMTP id fcO3rPRJKx37 for <dev@httpd.apache.org>;
	Wed, 21 Oct 2015 14:31:45 +0000 (UTC)
Received: from mail-qk0-f182.google.com (mail-qk0-f182.google.com [209.85.220.182])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id A316525465
	for <dev@httpd.apache.org>; Wed, 21 Oct 2015 14:31:44 +0000 (UTC)
Received: by qkfm62 with SMTP id m62so36450986qkf.1
        for <dev@httpd.apache.org>; Wed, 21 Oct 2015 07:31:43 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type:content-transfer-encoding;
        bh=wsIBj9/nfQPO3YGxrk9W96cDYrvrezPwqQoa2uvOtKg=;
        b=zt935oAsDjZSiJM7BGyFk54mhymUqceToz25OSTgFpaeFixefG7zLVsOaFh8e6bMMS
         odNi9vu/R4FB9XBUb8rnuBArxIGqEn3LpIhVZ4SLS1bAnZPDgyMeqgBvRluNzfoGseq9
         OFM4SeNPq+sVVb9XyL1Qh9rCaBT+b65z/TpyHjYZ8j+z1QRWmn6mXx2LQMDoTlIn/6vg
         8b+1vetSr7cA253XfRGBOh7iDHiSoo2Zq+fg20xHZzZgPgV0+fLwrw1l8Ummqwe4hXTc
         hkljdZKTLLmqHDErUqk7vMw0JWmL10gltrGHgn89QMHWYvBfF2Xm8gpoOL/Y9fsSHdra
         kRRg==
MIME-Version: 1.0
X-Received: by 10.55.56.130 with SMTP id f124mr10928730qka.79.1445437903707;
 Wed, 21 Oct 2015 07:31:43 -0700 (PDT)
Received: by 10.55.156.213 with HTTP; Wed, 21 Oct 2015 07:31:43 -0700 (PDT)
In-Reply-To: <AB1691BE05AE7F4992697F2A0835627AC634A1E6@VOEXM10W.internal.vodafone.com>
References: <5625642E.30708@ptc.com>
	<CAKQ1sVPceAVuDMNgt-qGomU6EARQap5HpCbvaPPiwtYXsUvRpg@mail.gmail.com>
	<CALK=YjM5CvMgWAWT=X67JxBdaJDJ5PCFsHJijSEs0bKovFnQtQ@mail.gmail.com>
	<5625A5E7.2070309@ptc.com>
	<CAKQ1sVPRX_st3SWAnF30C62qxTNqjHiSV3iaCHFPr1HLGp_CxA@mail.gmail.com>
	<AB1691BE05AE7F4992697F2A0835627AC63489F4@VOEXM10W.internal.vodafone.com>
	<CAKQ1sVMhNzYPWHTvhdeV6z+mV2ZNq5vjHj=W1d6R46cOQ_-qhQ@mail.gmail.com>
	<AB1691BE05AE7F4992697F2A0835627AC6348C38@VOEXM10W.internal.vodafone.com>
	<CAKQ1sVNHz_aCLZ3um-NV8cJGnhR3FtE6wz+zGgusvW=MA+cO_A@mail.gmail.com>
	<CAKQ1sVO_E2AZBL9CPfpm=_RQEnHWRDWNg67NFKCqy-vC=uoJBw@mail.gmail.com>
	<562668DA.5060804@ptc.com>
	<56269CBD.5060701@ptc.com>
	<5627853C.4040006@apache.org>
	<CAKQ1sVORFAFNwxw92Xfxhd9pGs3vCgHgoA3SCty29BbvHoPeSQ@mail.gmail.com>
	<AB1691BE05AE7F4992697F2A0835627AC634A1A9@VOEXM10W.internal.vodafone.com>
	<CAKQ1sVNpfUzE5ubnHJVa2h-_y45nDSbXS8XbOZJp3x7HFaMb9Q@mail.gmail.com>
	<AB1691BE05AE7F4992697F2A0835627AC634A1E6@VOEXM10W.internal.vodafone.com>
Date: Wed, 21 Oct 2015 16:31:43 +0200
Message-ID: <CAKQ1sVP2jv3q-A8JH977Qtkr+jwb4WjJOo0CdPhGdVv5BmcbKw@mail.gmail.com>
Subject: Re: [users@httpd] Chunked transfer delay with httpd 2.4 on Windows.
From: Yann Ylavic <ylavic.dev@gmail.com>
To: dev@httpd.apache.org
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: quoted-printable

On Wed, Oct 21, 2015 at 4:29 PM, Pl=C3=BCm, R=C3=BCdiger, Vodafone Group
<ruediger.pluem@vodafone.com> wrote:
>
>
>> -----Urspr=C3=BCngliche Nachricht-----
>> Von: Yann Ylavic [mailto:ylavic.dev@gmail.com]
>> Gesendet: Mittwoch, 21. Oktober 2015 16:28
>> An: dev@httpd.apache.org
>> Betreff: Re: [users@httpd] Chunked transfer delay with httpd 2.4 on
>> Windows.
>>
>> On Wed, Oct 21, 2015 at 4:22 PM, Pl=C3=BCm, R=C3=BCdiger, Vodafone Group
>> <ruediger.pluem@vodafone.com> wrote:
>> >
>> >
>> >> -----Urspr=C3=BCngliche Nachricht-----
>> >> Von: Yann Ylavic [mailto:ylavic.dev@gmail.com]
>> >> Gesendet: Mittwoch, 21. Oktober 2015 16:07
>> >> An: dev@httpd.apache.org
>> >> Betreff: Re: [users@httpd] Chunked transfer delay with httpd 2.4 on
>> >> Windows.
>> >>
>> >> On Wed, Oct 21, 2015 at 2:29 PM, Ruediger Pluem <rpluem@apache.org>
>> >> wrote:
>> >> >
>> >> > This looks like there is a stray \n in the input queue that causes
>> >> httpd to think that there is a pipelined request.
>> >>
>> >> I think we should tolerate blank lines in check_pipeline(), like
>> >> read_request_line() does (this is also a RFC compliance).
>> >>
>> >> How about the following patch?
>> >
>> > In general this looks good, but why not moving the max_blank_lines
>> logic
>> > into check_pipeline using c->server->limit_req_fields, so that we do
>> not need to change
>> > its prototype?
>>
>> Hmm, check_pipeline() is static, why bother?
>> Also c->base_server may be different than r->server (after the first
>> request), and we probably want to use the value from the last
>> request's vhost (a bit like we did already for keep_alive_timeout).
>>
>
> OK. Fair enough.

OK, thanks :)

Andy, can you give the proposed patch a try?

From dev-return-84395-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Wed Oct 21 14:49:12 2015
Return-Path: <dev-return-84395-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id EB4231830E
	for <apmail-httpd-dev-archive@www.apache.org>; Wed, 21 Oct 2015 14:49:11 +0000 (UTC)
Received: (qmail 95253 invoked by uid 500); 21 Oct 2015 14:49:06 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 95165 invoked by uid 500); 21 Oct 2015 14:49:06 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 95155 invoked by uid 99); 21 Oct 2015 14:49:06 -0000
Received: from Unknown (HELO spamd2-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 21 Oct 2015 14:49:06 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd2-us-west.apache.org (ASF Mail Server at spamd2-us-west.apache.org) with ESMTP id 0CDCB1A29C9
	for <dev@httpd.apache.org>; Wed, 21 Oct 2015 14:49:06 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd2-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.01
X-Spam-Level:
X-Spam-Status: No, score=-0.01 tagged_above=-999 required=6.31
	tests=[SPF_PASS=-0.001, T_RP_MATCHES_RCVD=-0.01, URIBL_BLOCKED=0.001]
	autolearn=disabled
Received: from mx1-us-west.apache.org ([10.40.0.8])
	by localhost (spamd2-us-west.apache.org [10.40.0.9]) (amavisd-new, port 10024)
	with ESMTP id fxl0irmjNhD5 for <dev@httpd.apache.org>;
	Wed, 21 Oct 2015 14:48:56 +0000 (UTC)
Received: from monica.sharp.fm (monica.sharp.fm [80.168.143.5])
	by mx1-us-west.apache.org (ASF Mail Server at mx1-us-west.apache.org) with ESMTP id 611B323067
	for <dev@httpd.apache.org>; Wed, 21 Oct 2015 14:48:56 +0000 (UTC)
Received: from [10.105.13.226] (unknown [5.56.169.82])
	(using TLSv1 with cipher DHE-RSA-AES256-SHA (256/256 bits))
	(Client did not present a certificate)
	(Authenticated sender: minfrin@sharp.fm)
	by monica.sharp.fm (Postfix) with ESMTPSA id 6102080718
	for <dev@httpd.apache.org>; Wed, 21 Oct 2015 15:48:55 +0100 (BST)
Content-Type: text/plain; charset=utf-8
Mime-Version: 1.0 (Mac OS X Mail 8.2 \(2104\))
Subject: Re: buckets and connections (long post)
From: Graham Leggett <minfrin@sharp.fm>
In-Reply-To: <4D37F1D6-E2FB-408B-9D82-9F7ABABFFE1E@greenbytes.de>
Date: Wed, 21 Oct 2015 16:48:54 +0200
Content-Transfer-Encoding: quoted-printable
Message-Id: <8C00B305-BECC-4A48-9A03-8A7CA99EADE4@sharp.fm>
References: <CAKQ1sVNchFx=egp=Q0tgT+1GcBXiten8mh9STetcZXOfJxhsjQ@mail.gmail.com> <CAKQ1sVPjcA9EYNpjcmM9=AU_LCgAsFntOcZnmGoHymds3S5wmA@mail.gmail.com> <AB1691BE05AE7F4992697F2A0835627AC6348972@VOEXM10W.internal.vodafone.com> <7B24F4D1-6904-4C00-A337-88F712026BE9@greenbytes.de> <0D5B13DA-8642-4662-9606-6B5DF94EB87B@sharp.fm> <D70FBC43-2E52-4BDD-ADA5-88623657CBEC@jaguNET.com> <4D37F1D6-E2FB-408B-9D82-9F7ABABFFE1E@greenbytes.de>
To: dev@httpd.apache.org
X-Mailer: Apple Mail (2.2104)

On 21 Oct 2015, at 4:18 PM, Stefan Eissing =
<stefan.eissing@greenbytes.de> wrote:

> How good does this mechanism work for mod_http2? On the one side it's =
the same, on the other quite different.
>=20
> On the real, main connection, the master connection, where the h2 =
session resides, things are
> pretty similar with some exceptions:
> - it is very bursty. requests continue to come in. There is no pause =
between responses and the next request.
> - pauses, when they happen, will be longer. clients are expected to =
keep open connections around for
>  longer (if we let them).
> - When there is nothing to do, mod_http2 makes a blocking read on the =
connection input. This currently
>  does not lead to the state B) or C). The worker for the http2 =
connection stays assigned. This needs
>  to improve.

The blocking read breaks the spirit of the event MPM.

In theory, as long as you enter the write completion state and then not =
leave until your connection is done, this problem will go away.

If you want to read instead of write, make sure the CONN_SENSE_WANT_READ =
option is set on the connection.

(You may find reasons that stop this working, if so, these need to be =
isolated and fixed).

> This is the way it is implemented now. There may be other ways, but =
this is the way we have. If we
> continue along this path, we have the following obstacles to overcome:
> 1. the master connection probably can play nicer with the MPM so that =
an idle connection uses less
>   resources
> 2. The transfer of buckets from the slave to the master connection is =
a COPY except in case of
>   file buckets (and there is a limit on that as well to not run out of =
handles).
>   All other attempts at avoiding the copy, failed. This may be a =
personal limitation of my APRbilities.

This is how the proxy does it.

Buckets owned by the backend conn_rec are copied and added to the =
frontend conn_rec.

> 3. The amount of buffered bytes should be more flexible per stream and =
redistribute a maximum for=20
>   the whole session depending on load.
> 4. mod_http2 needs a process wide Resource Allocator for file handles. =
A master connection should
>   borrow n handles at start, increase/decrease the amount based on =
load, to give best performance
> 5. similar optimizations should be possible for other bucket types =
(mmap? immortal? heap?)

Right now this task is handled by the core network filter - it is very =
likely this problem is already solved, and you don=E2=80=99t need to do =
anything.

If the problem still needs solving, then the core filter is the place to =
do it. What the core filter does is add up the resources taken up by =
different buckets and if these resources breach limits, blocking writes =
are done until we=E2=80=99re below the limit again. This provides the =
flow control we need.

With the async filters this flow control is now made available to every =
filter in the ap_filter_setaside_brigade() function. When mod_http2 =
handles async filters you=E2=80=99ll get this flow control for free.

> 6. pool buckets are very tricky to optimize, as pool creation/destroy =
is not thread-safe in general
>   and it depends on how the parent pools and their allocators are set =
up.=20
>   Early hopes get easily crushed under load.

As soon as I see =E2=80=9Cbuckets aren=E2=80=99t thread safe=E2=80=9D I =
read it as =E2=80=9Cbuckets are being misused=E2=80=9D or =E2=80=9Cpool =
lifetimes are being mixed up".

Buckets arise from allocators, and you must never try add a bucket from =
one allocator into a brigade sourced from another allocator. For =
example, if you have a bucket allocated from the slave connection, you =
need to copy it into a different bucket allocated from the master =
connection before trying to add it to a master brigade.

Buckets are also allocated from pools, and pools have different =
lifetimes depending on what they were created for. If you allocate a =
bucket from the request pool, that bucket will vanish when the request =
pool is destroyed. Buckets can be passed from one pool to another, that =
is what =E2=80=9Csetaside=E2=80=9D means.

It is really important to get the pool lifetimes right. Allocate =
something accidentally from the master connection pool on a slave =
connection and it appears to work, because generally the master outlives =
the slave. Until the master is cleaned up first, and suddenly memory =
vanishes unexpectedly in the slave connections - and you crash.

There were a number of subtle bugs in the proxy where buckets had been =
allocated from the wrong pool, and all sorts of weirdness ensued. Make =
sure your pool lifetimes are allocated correctly and it will work.

> 7. The buckets passed down on the master connection are using another =
buffer - when on https:// -
>   to influence the SSL record sizes on write. Another COPY is not =
nice, but write performance
>   is better this way. The ssl optimizations in place do not work for =
HTTP/2 as it has other
>   bucket patterns. We should look if we can combine this into =
something without COPY, but with
>   good sized SSL writes.

mod_ssl already worries about buffering on it=E2=80=99s own, there is no =
need to recreate this functionality. Was this not working?

Regards,
Graham
=E2=80=94


From dev-return-84396-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Wed Oct 21 14:55:37 2015
Return-Path: <dev-return-84396-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id ECE7D18375
	for <apmail-httpd-dev-archive@www.apache.org>; Wed, 21 Oct 2015 14:55:37 +0000 (UTC)
Received: (qmail 13558 invoked by uid 500); 21 Oct 2015 14:55:21 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 13478 invoked by uid 500); 21 Oct 2015 14:55:21 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 13468 invoked by uid 99); 21 Oct 2015 14:55:21 -0000
Received: from Unknown (HELO spamd1-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 21 Oct 2015 14:55:21 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd1-us-west.apache.org (ASF Mail Server at spamd1-us-west.apache.org) with ESMTP id 13267C5EFC
	for <dev@httpd.apache.org>; Wed, 21 Oct 2015 14:55:21 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd1-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.1
X-Spam-Level:
X-Spam-Status: No, score=-0.1 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RP_MATCHES_RCVD=0.001, SPF_PASS=-0.001] autolearn=disabled
Authentication-Results: spamd1-us-west.apache.org (amavisd-new);
	dkim=pass (1024-bit key) header.d=ptc.com
Received: from mx1-us-west.apache.org ([10.40.0.8])
	by localhost (spamd1-us-west.apache.org [10.40.0.7]) (amavisd-new, port 10024)
	with ESMTP id mi4sFnI45dJW for <dev@httpd.apache.org>;
	Wed, 21 Oct 2015 14:55:14 +0000 (UTC)
Received: from mx1.ptc.com (mx1.ptc.com [12.11.148.188])
	by mx1-us-west.apache.org (ASF Mail Server at mx1-us-west.apache.org) with ESMTPS id F397822F1F
	for <dev@httpd.apache.org>; Wed, 21 Oct 2015 14:55:13 +0000 (UTC)
DKIM-Signature: v=1; a=rsa-sha256; c=simple/simple;
  d=ptc.com; s=ptc; t=1445439314; x=1476975314;
  h=subject:to:references:from:message-id:date:mime-version:
   in-reply-to:content-transfer-encoding;
  bh=o2pz8QVJODAj0vhR408/0F/U+NBZ0Tx5uDKRMD4eKx8=;
  b=NjHy0Ybl41jVIFp7Ze9tz1YfR9/cgoIb33wUZawaBYP9yzd0i8JEVR7I
   5On4qLh410urDj53LAuAa8KdKFt1gwrZAtlUUMDZ7AKEXhZpY8xbS+lVP
   4gR4AsY6/g9hJ2MvN6LgL/DpyiRnRR4Y68ezGSduNc9FZDz37kdeOB/42
   o=;
X-IronPort-AV: E=Sophos;i="5.17,712,1437451200"; 
   d="scan'208";a="118410476"
Received: from hq-x10prdhub2.ptcnet.ptc.com ([132.253.198.28])
  by mx1-int.ptc.com with ESMTP/TLS/AES128-SHA; 21 Oct 2015 10:54:39 -0400
Received: from awang.ptcnet.ptc.com (132.253.8.73) by
 int-mail-hub2.ptcnet.ptc.com (132.253.201.252) with Microsoft SMTP Server id
 14.3.123.3; Wed, 21 Oct 2015 10:54:39 -0400
Subject: Re: [users@httpd] Chunked transfer delay with httpd 2.4 on Windows.
To: <dev@httpd.apache.org>
References: <5625642E.30708@ptc.com>
 <CALK=YjM5CvMgWAWT=X67JxBdaJDJ5PCFsHJijSEs0bKovFnQtQ@mail.gmail.com>
 <5625A5E7.2070309@ptc.com>
 <CAKQ1sVPRX_st3SWAnF30C62qxTNqjHiSV3iaCHFPr1HLGp_CxA@mail.gmail.com>
 <AB1691BE05AE7F4992697F2A0835627AC63489F4@VOEXM10W.internal.vodafone.com>
 <CAKQ1sVMhNzYPWHTvhdeV6z+mV2ZNq5vjHj=W1d6R46cOQ_-qhQ@mail.gmail.com>
 <AB1691BE05AE7F4992697F2A0835627AC6348C38@VOEXM10W.internal.vodafone.com>
 <CAKQ1sVNHz_aCLZ3um-NV8cJGnhR3FtE6wz+zGgusvW=MA+cO_A@mail.gmail.com>
 <CAKQ1sVO_E2AZBL9CPfpm=_RQEnHWRDWNg67NFKCqy-vC=uoJBw@mail.gmail.com>
 <562668DA.5060804@ptc.com> <56269CBD.5060701@ptc.com>
 <5627853C.4040006@apache.org>
 <CAKQ1sVORFAFNwxw92Xfxhd9pGs3vCgHgoA3SCty29BbvHoPeSQ@mail.gmail.com>
 <AB1691BE05AE7F4992697F2A0835627AC634A1A9@VOEXM10W.internal.vodafone.com>
 <CAKQ1sVNpfUzE5ubnHJVa2h-_y45nDSbXS8XbOZJp3x7HFaMb9Q@mail.gmail.com>
 <AB1691BE05AE7F4992697F2A0835627AC634A1E6@VOEXM10W.internal.vodafone.com>
 <CAKQ1sVP2jv3q-A8JH977Qtkr+jwb4WjJOo0CdPhGdVv5BmcbKw@mail.gmail.com>
From: Andy Wang <awang@ptc.com>
Message-ID: <5627A72B.7050302@ptc.com>
Date: Wed, 21 Oct 2015 09:54:35 -0500
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:38.0) Gecko/20100101
 Thunderbird/38.3.0
MIME-Version: 1.0
In-Reply-To: <CAKQ1sVP2jv3q-A8JH977Qtkr+jwb4WjJOo0CdPhGdVv5BmcbKw@mail.gmail.com>
Content-Type: text/plain; charset="utf-8"; format=flowed
Content-Transfer-Encoding: 7bit
X-Originating-IP: [132.253.8.73]



On 10/21/2015 09:31 AM, Yann Ylavic wrote:

> OK, thanks :)
>
> Andy, can you give the proposed patch a try?
>

I will do that today.

And thank you to Rudiger and yourself, and everyone else on the thread 
for all the help.

I missed the trailing 0x0a in the different wireshark captures.  I was 
trusting wireshark's http dissection rather than looking at the raw hex 
data and it didn't show the trailing \n.

I gotta go back to the basics and lean less on wireshark's "intelligence" :)

Andy

From dev-return-84397-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Wed Oct 21 14:59:30 2015
Return-Path: <dev-return-84397-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 31D4118390
	for <apmail-httpd-dev-archive@www.apache.org>; Wed, 21 Oct 2015 14:59:30 +0000 (UTC)
Received: (qmail 21203 invoked by uid 500); 21 Oct 2015 14:59:29 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 21141 invoked by uid 500); 21 Oct 2015 14:59:29 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 21131 invoked by uid 99); 21 Oct 2015 14:59:29 -0000
Received: from Unknown (HELO spamd4-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 21 Oct 2015 14:59:29 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd4-us-west.apache.org (ASF Mail Server at spamd4-us-west.apache.org) with ESMTP id 209F4C04B9
	for <dev@httpd.apache.org>; Wed, 21 Oct 2015 14:59:29 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd4-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 1.366
X-Spam-Level: *
X-Spam-Status: No, score=1.366 tagged_above=-999 required=6.31
	tests=[FSL_HELO_NON_FQDN_1=0.001, KAM_LAZY_DOMAIN_SECURITY=1,
	RCVD_IN_SORBS_DUL=0.001, RDNS_DYNAMIC=0.363, URIBL_BLOCKED=0.001]
	autolearn=disabled
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd4-us-west.apache.org [10.40.0.11]) (amavisd-new, port 10024)
	with ESMTP id g_-iSEU84GvT for <dev@httpd.apache.org>;
	Wed, 21 Oct 2015 14:59:22 +0000 (UTC)
Received: from baldur (cpc36-newt30-2-0-cust898.19-3.cable.virginm.net [82.32.195.131])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTP id 2970F42B3E
	for <dev@httpd.apache.org>; Wed, 21 Oct 2015 14:59:22 +0000 (UTC)
Received: from baldur (localhost [127.0.0.1])
	by baldur (Postfix) with ESMTP id 93ECEC1B96EA
	for <dev@httpd.apache.org>; Wed, 21 Oct 2015 15:59:20 +0100 (BST)
Date: Wed, 21 Oct 2015 15:59:18 +0100
From: Nick Kew <nick@webthing.com>
To: dev@httpd.apache.org
Subject: Re: Apache Module Development Query on character encodings.
Message-ID: <20151021155918.5f8df6be@baldur>
In-Reply-To: <16ae01d10bc6$57eac990$07c05cb0$@com>
References: <15f001d10b6c$bcbc0ff0$36342fd0$@com>
	<20151020233749.65b41df1@baldur>
	<16ae01d10bc6$57eac990$07c05cb0$@com>
X-Mailer: Claws Mail 3.7.4 (GTK+ 2.20.1; i486-pc-linux-gnu)
Mime-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: quoted-printable

On Wed, 21 Oct 2015 07:04:27 +0100
"John Dougrez-Lewis" <jlewis@lightblue.com> wrote:

> Hi Nick,
>=20
> > Hi, are you by any chance the Raving Loony I once knew at Cambridge?
>=20
> Yes indeed - that must be 35 years ago now - these days I'm a bit more
> sensible (although the legacy of the OMRLP lives on).

OMLRP?  It was =E2=88=87 =E2=88=87 back then (CURLS, if email screws that u=
p).


> > Basically there are three parts to working with character encodings:
> >  * Detecting them in incoming data.
> >  * Converting them to order.
> >  * Correctly labelling outgoing data.
>=20
> > mod_xml2enc will do all that for libxml2-based filters, and could easily
> be tweaked to drop the libxml2-specific optimisations for general-
> > purpose use.  Alternatively the charset-detection from mod_xml2enc could
> probably be folded into mod_charset_lite.
>=20
> So basically mod_xml2enc will detect the incoming encoding (whatever it m=
ay
> be)?

I suggest instead of debating here, take a look at it.
Start with the docs, and then move on to the code if necessary.

--=20
Nick Kew

From dev-return-84398-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Wed Oct 21 15:02:14 2015
Return-Path: <dev-return-84398-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id BBE7F183C2
	for <apmail-httpd-dev-archive@www.apache.org>; Wed, 21 Oct 2015 15:02:14 +0000 (UTC)
Received: (qmail 26868 invoked by uid 500); 21 Oct 2015 15:02:11 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 26796 invoked by uid 500); 21 Oct 2015 15:02:11 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 26786 invoked by uid 99); 21 Oct 2015 15:02:11 -0000
Received: from Unknown (HELO spamd3-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 21 Oct 2015 15:02:11 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd3-us-west.apache.org (ASF Mail Server at spamd3-us-west.apache.org) with ESMTP id 748FF1809BC
	for <dev@httpd.apache.org>; Wed, 21 Oct 2015 15:02:10 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd3-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.111
X-Spam-Level:
X-Spam-Status: No, score=-0.111 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	SPF_PASS=-0.001, T_RP_MATCHES_RCVD=-0.01] autolearn=disabled
Authentication-Results: spamd3-us-west.apache.org (amavisd-new);
	dkim=pass (1024-bit key) header.d=ptc.com
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd3-us-west.apache.org [10.40.0.10]) (amavisd-new, port 10024)
	with ESMTP id i6PBb_swsNEW for <dev@httpd.apache.org>;
	Wed, 21 Oct 2015 15:02:03 +0000 (UTC)
Received: from mx1.ptc.com (mx1.ptc.com [12.11.148.188])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id B1049428E4
	for <dev@httpd.apache.org>; Wed, 21 Oct 2015 15:02:03 +0000 (UTC)
DKIM-Signature: v=1; a=rsa-sha256; c=simple/simple;
  d=ptc.com; s=ptc; t=1445439723; x=1476975723;
  h=subject:to:references:from:message-id:date:mime-version:
   in-reply-to:content-transfer-encoding;
  bh=8Im5TT/9s3MkLYL1BF8hpzXWMAdxwKJ6xEyt9efjEEE=;
  b=rAo1sVtDNhIrOVi40a7La5LQetvfrdJlebcxaoj4s0shMGQxkZImGc5T
   nReehE21oq9XiybMLi+45m0JyuJno+wsd5LMD7sOvYixOvuhOVhwZyfUv
   o/PnK7zxtgoO4rzjieuX9x5/yv5ntLYx6PAVhIRL6HCWngzWclNcoRrL8
   k=;
X-IronPort-AV: E=Sophos;i="5.17,712,1437451200"; 
   d="scan'208";a="118413646"
Received: from hq-x10prdhub2.ptcnet.ptc.com ([132.253.198.28])
  by mx1-int.ptc.com with ESMTP/TLS/AES128-SHA; 21 Oct 2015 11:01:57 -0400
Received: from awang.ptcnet.ptc.com (132.253.8.73) by
 int-mail-hub2.ptcnet.ptc.com (132.253.201.252) with Microsoft SMTP Server id
 14.3.123.3; Wed, 21 Oct 2015 11:01:56 -0400
Subject: Re: [users@httpd] Chunked transfer delay with httpd 2.4 on Windows.
To: <dev@httpd.apache.org>
References: <5625642E.30708@ptc.com> <5625A5E7.2070309@ptc.com>
 <CAKQ1sVPRX_st3SWAnF30C62qxTNqjHiSV3iaCHFPr1HLGp_CxA@mail.gmail.com>
 <AB1691BE05AE7F4992697F2A0835627AC63489F4@VOEXM10W.internal.vodafone.com>
 <CAKQ1sVMhNzYPWHTvhdeV6z+mV2ZNq5vjHj=W1d6R46cOQ_-qhQ@mail.gmail.com>
 <AB1691BE05AE7F4992697F2A0835627AC6348C38@VOEXM10W.internal.vodafone.com>
 <CAKQ1sVNHz_aCLZ3um-NV8cJGnhR3FtE6wz+zGgusvW=MA+cO_A@mail.gmail.com>
 <CAKQ1sVO_E2AZBL9CPfpm=_RQEnHWRDWNg67NFKCqy-vC=uoJBw@mail.gmail.com>
 <562668DA.5060804@ptc.com> <56269CBD.5060701@ptc.com>
 <5627853C.4040006@apache.org>
 <CAKQ1sVORFAFNwxw92Xfxhd9pGs3vCgHgoA3SCty29BbvHoPeSQ@mail.gmail.com>
 <AB1691BE05AE7F4992697F2A0835627AC634A1A9@VOEXM10W.internal.vodafone.com>
 <CAKQ1sVNpfUzE5ubnHJVa2h-_y45nDSbXS8XbOZJp3x7HFaMb9Q@mail.gmail.com>
 <AB1691BE05AE7F4992697F2A0835627AC634A1E6@VOEXM10W.internal.vodafone.com>
 <CAKQ1sVP2jv3q-A8JH977Qtkr+jwb4WjJOo0CdPhGdVv5BmcbKw@mail.gmail.com>
 <5627A72B.7050302@ptc.com>
From: Andy Wang <awang@ptc.com>
Message-ID: <5627A8E4.4010108@ptc.com>
Date: Wed, 21 Oct 2015 10:01:56 -0500
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:38.0) Gecko/20100101
 Thunderbird/38.3.0
MIME-Version: 1.0
In-Reply-To: <5627A72B.7050302@ptc.com>
Content-Type: text/plain; charset="utf-8"; format=flowed
Content-Transfer-Encoding: 7bit
X-Originating-IP: [132.253.8.73]



On 10/21/2015 09:54 AM, Andy Wang wrote:
>
>
> On 10/21/2015 09:31 AM, Yann Ylavic wrote:
>
>> OK, thanks :)
>>
>> Andy, can you give the proposed patch a try?
>>
>
> I will do that today.
>
> And thank you to Rudiger and yourself, and everyone else on the thread
> for all the help.
>
> I missed the trailing 0x0a in the different wireshark captures.  I was
> trusting wireshark's http dissection rather than looking at the raw hex
> data and it didn't show the trailing \n.
>
> I gotta go back to the basics and lean less on wireshark's
> "intelligence" :)

Oh, and the plugin developer actually identified where the \n was coming 
from and has resolved it on the client end.

I do have one question.  Any idea why this only occurs on Windows servers?

Andy


From dev-return-84399-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Thu Oct 22 13:42:10 2015
Return-Path: <dev-return-84399-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id DA5C018E74
	for <apmail-httpd-dev-archive@www.apache.org>; Thu, 22 Oct 2015 13:42:10 +0000 (UTC)
Received: (qmail 54540 invoked by uid 500); 22 Oct 2015 13:42:10 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 54476 invoked by uid 500); 22 Oct 2015 13:42:10 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 54463 invoked by uid 99); 22 Oct 2015 13:42:10 -0000
Received: from Unknown (HELO spamd1-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 22 Oct 2015 13:42:10 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd1-us-west.apache.org (ASF Mail Server at spamd1-us-west.apache.org) with ESMTP id B58EAC60B3
	for <dev@httpd.apache.org>; Thu, 22 Oct 2015 13:42:09 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd1-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.1
X-Spam-Level:
X-Spam-Status: No, score=-0.1 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RP_MATCHES_RCVD=0.001, SPF_PASS=-0.001] autolearn=disabled
Authentication-Results: spamd1-us-west.apache.org (amavisd-new);
	dkim=pass (1024-bit key) header.d=ptc.com
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd1-us-west.apache.org [10.40.0.7]) (amavisd-new, port 10024)
	with ESMTP id IFOuNE1ABL5b for <dev@httpd.apache.org>;
	Thu, 22 Oct 2015 13:42:03 +0000 (UTC)
Received: from mx1.ptc.com (mx1.ptc.com [12.11.148.188])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id D8DB142B79
	for <dev@httpd.apache.org>; Thu, 22 Oct 2015 13:42:02 +0000 (UTC)
DKIM-Signature: v=1; a=rsa-sha256; c=simple/simple;
  d=ptc.com; s=ptc; t=1445521322; x=1477057322;
  h=subject:to:references:from:message-id:date:mime-version:
   in-reply-to:content-transfer-encoding;
  bh=PSKTqdESE7Ngefz017W/JRBTArtlReAWi1ZCF7JEueg=;
  b=g5Sh0JrXIINjCD7iRJETG97qP/7U2Hiz+D1kJqFE0qJEUoA52oMEXXvC
   TMQaMy6rAO9tQ/E3eEHClmj67Oe+jBtZbQus3t24TOs1y3ecfg9zEEkcr
   ZbnUv0Cghhtl8kmuK4WfgPYF37Otkz5tU/0+Np+zm5MZ7Wl+WJPJFxlAg
   I=;
X-IronPort-AV: E=Sophos;i="5.20,182,1444708800"; 
   d="scan'208";a="118799297"
Received: from hq-x10prdhub1.ptcnet.ptc.com ([132.253.198.27])
  by mx1-int.ptc.com with ESMTP/TLS/AES128-SHA; 22 Oct 2015 09:42:01 -0400
Received: from awang.ptcnet.ptc.com (132.253.8.73) by
 int-mail-hub1.ptcnet.ptc.com (132.253.201.252) with Microsoft SMTP Server id
 14.3.123.3; Thu, 22 Oct 2015 09:42:01 -0400
Subject: Re: [users@httpd] Chunked transfer delay with httpd 2.4 on Windows.
To: <dev@httpd.apache.org>
References: <5625642E.30708@ptc.com> <5625A5E7.2070309@ptc.com>
 <CAKQ1sVPRX_st3SWAnF30C62qxTNqjHiSV3iaCHFPr1HLGp_CxA@mail.gmail.com>
 <AB1691BE05AE7F4992697F2A0835627AC63489F4@VOEXM10W.internal.vodafone.com>
 <CAKQ1sVMhNzYPWHTvhdeV6z+mV2ZNq5vjHj=W1d6R46cOQ_-qhQ@mail.gmail.com>
 <AB1691BE05AE7F4992697F2A0835627AC6348C38@VOEXM10W.internal.vodafone.com>
 <CAKQ1sVNHz_aCLZ3um-NV8cJGnhR3FtE6wz+zGgusvW=MA+cO_A@mail.gmail.com>
 <CAKQ1sVO_E2AZBL9CPfpm=_RQEnHWRDWNg67NFKCqy-vC=uoJBw@mail.gmail.com>
 <562668DA.5060804@ptc.com> <56269CBD.5060701@ptc.com>
 <5627853C.4040006@apache.org>
 <CAKQ1sVORFAFNwxw92Xfxhd9pGs3vCgHgoA3SCty29BbvHoPeSQ@mail.gmail.com>
 <AB1691BE05AE7F4992697F2A0835627AC634A1A9@VOEXM10W.internal.vodafone.com>
 <CAKQ1sVNpfUzE5ubnHJVa2h-_y45nDSbXS8XbOZJp3x7HFaMb9Q@mail.gmail.com>
 <AB1691BE05AE7F4992697F2A0835627AC634A1E6@VOEXM10W.internal.vodafone.com>
 <CAKQ1sVP2jv3q-A8JH977Qtkr+jwb4WjJOo0CdPhGdVv5BmcbKw@mail.gmail.com>
 <5627A72B.7050302@ptc.com> <5627A8E4.4010108@ptc.com>
From: Andy Wang <awang@ptc.com>
Message-ID: <5628E7A9.2060708@ptc.com>
Date: Thu, 22 Oct 2015 08:42:01 -0500
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:38.0) Gecko/20100101
 Thunderbird/38.3.0
MIME-Version: 1.0
In-Reply-To: <5627A8E4.4010108@ptc.com>
Content-Type: text/plain; charset="utf-8"; format=flowed
Content-Transfer-Encoding: 7bit
X-Originating-IP: [132.253.8.73]



On 10/21/2015 10:01 AM, Andy Wang wrote:

>> I will do that today.
>>
>> And thank you to Rudiger and yourself, and everyone else on the thread
>> for all the help.
>>
>> I missed the trailing 0x0a in the different wireshark captures.  I was
>> trusting wireshark's http dissection rather than looking at the raw hex
>> data and it didn't show the trailing \n.
>>
>> I gotta go back to the basics and lean less on wireshark's
>> "intelligence" :)
>
> Oh, and the plugin developer actually identified where the \n was coming
> from and has resolved it on the client end.
>
> I do have one question.  Any idea why this only occurs on Windows servers?

Tested with the patch and looks good.
I tried to recreate it using ncat and sending an extra \n but I'm not 
having luck.  I see the extra byte on my pcap.  Still curious what other 
conditions create this but oh well, at this point it's in my 
rear-view-mirror.

Thanks again for all the help and the solution.
Andy

From dev-return-84400-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Thu Oct 22 13:59:34 2015
Return-Path: <dev-return-84400-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 3C0CC18EFA
	for <apmail-httpd-dev-archive@www.apache.org>; Thu, 22 Oct 2015 13:59:34 +0000 (UTC)
Received: (qmail 94692 invoked by uid 500); 22 Oct 2015 13:59:33 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 94632 invoked by uid 500); 22 Oct 2015 13:59:33 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 94622 invoked by uid 99); 22 Oct 2015 13:59:33 -0000
Received: from Unknown (HELO spamd1-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 22 Oct 2015 13:59:33 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd1-us-west.apache.org (ASF Mail Server at spamd1-us-west.apache.org) with ESMTP id DBE2CC4A0D
	for <dev@httpd.apache.org>; Thu, 22 Oct 2015 13:59:32 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd1-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 2.999
X-Spam-Level: **
X-Spam-Status: No, score=2.999 tagged_above=-999 required=6.31
	tests=[HTML_MESSAGE=3, RCVD_IN_MSPIKE_H2=-0.001, SPF_PASS=-0.001,
	URIBL_BLOCKED=0.001] autolearn=disabled
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd1-us-west.apache.org [10.40.0.7]) (amavisd-new, port 10024)
	with ESMTP id QMbil3_RMmqk for <dev@httpd.apache.org>;
	Thu, 22 Oct 2015 13:59:26 +0000 (UTC)
Received: from mail-io0-f177.google.com (mail-io0-f177.google.com [209.85.223.177])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id 58A4024A33
	for <dev@httpd.apache.org>; Thu, 22 Oct 2015 13:59:26 +0000 (UTC)
Received: by iow1 with SMTP id 1so91916785iow.1
        for <dev@httpd.apache.org>; Thu, 22 Oct 2015 06:59:25 -0700 (PDT)
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=1e100.net; s=20130820;
        h=x-gm-message-state:mime-version:in-reply-to:references:date
         :message-id:subject:from:to:content-type;
        bh=8U3aCsVqc8ODLkQ3QamGvOnZESjay4y3xCqlFkTgG8I=;
        b=YiKHv0jqNsEg/3SEyhhV3ZahGBaOSIlg7BpL05H8jtVRDOlT47HDBFX+ooBhREqEBF
         Lqusv+I5zc70ttAKz+ErfqVbyI9G4XyYc/jDUJr2lSfoYO3Xdv/iShgXtuiIl3Wjs6S/
         k6QhZIqEQwBrmGCpsOYnSnbeF5xwny0znS745IS8PivOTd0A1QAqdjSQ517UT0hzcmOD
         4twoHkhwGZrAMqHZfGkku11E7VVOUzsiwgeQqp2Uv7/WNz5BvuU3aPlkPLTTrjjchZOr
         Uq/6yvr6z5VAklhbgydKoh3EaCNbXLZaAtBzxicheTrLzUpMX7V6kyUKhV40196Fwneb
         lvew==
X-Gm-Message-State: ALoCoQnNI+As6tTgCHXe97UcoVIUSzJ61VzVi7kGnuHnUhPTjeeCtDad4VbK43zYX1VTlL0UCIUz
MIME-Version: 1.0
X-Received: by 10.107.166.79 with SMTP id p76mr16187920ioe.163.1445522365238;
 Thu, 22 Oct 2015 06:59:25 -0700 (PDT)
Received: by 10.107.3.88 with HTTP; Thu, 22 Oct 2015 06:59:25 -0700 (PDT)
In-Reply-To: <5628E7A9.2060708@ptc.com>
References: <5625642E.30708@ptc.com>
	<5625A5E7.2070309@ptc.com>
	<CAKQ1sVPRX_st3SWAnF30C62qxTNqjHiSV3iaCHFPr1HLGp_CxA@mail.gmail.com>
	<AB1691BE05AE7F4992697F2A0835627AC63489F4@VOEXM10W.internal.vodafone.com>
	<CAKQ1sVMhNzYPWHTvhdeV6z+mV2ZNq5vjHj=W1d6R46cOQ_-qhQ@mail.gmail.com>
	<AB1691BE05AE7F4992697F2A0835627AC6348C38@VOEXM10W.internal.vodafone.com>
	<CAKQ1sVNHz_aCLZ3um-NV8cJGnhR3FtE6wz+zGgusvW=MA+cO_A@mail.gmail.com>
	<CAKQ1sVO_E2AZBL9CPfpm=_RQEnHWRDWNg67NFKCqy-vC=uoJBw@mail.gmail.com>
	<562668DA.5060804@ptc.com>
	<56269CBD.5060701@ptc.com>
	<5627853C.4040006@apache.org>
	<CAKQ1sVORFAFNwxw92Xfxhd9pGs3vCgHgoA3SCty29BbvHoPeSQ@mail.gmail.com>
	<AB1691BE05AE7F4992697F2A0835627AC634A1A9@VOEXM10W.internal.vodafone.com>
	<CAKQ1sVNpfUzE5ubnHJVa2h-_y45nDSbXS8XbOZJp3x7HFaMb9Q@mail.gmail.com>
	<AB1691BE05AE7F4992697F2A0835627AC634A1E6@VOEXM10W.internal.vodafone.com>
	<CAKQ1sVP2jv3q-A8JH977Qtkr+jwb4WjJOo0CdPhGdVv5BmcbKw@mail.gmail.com>
	<5627A72B.7050302@ptc.com>
	<5627A8E4.4010108@ptc.com>
	<5628E7A9.2060708@ptc.com>
Date: Thu, 22 Oct 2015 08:59:25 -0500
Message-ID: <CACsi253Gt9=E-rqoFyR25S9gfFp5t6ORw=pjjjuRz6cwALE+KQ@mail.gmail.com>
Subject: Re: [users@httpd] Chunked transfer delay with httpd 2.4 on Windows.
From: William A Rowe Jr <wrowe@rowe-clan.net>
To: httpd <dev@httpd.apache.org>
Content-Type: multipart/alternative; boundary=001a1141f37e1870440522b1e70f

--001a1141f37e1870440522b1e70f
Content-Type: text/plain; charset=UTF-8

On Thu, Oct 22, 2015 at 8:42 AM, Andy Wang <awang@ptc.com> wrote:

>
> On 10/21/2015 10:01 AM, Andy Wang wrote:
>
> I will do that today.
>>>
>>> And thank you to Rudiger and yourself, and everyone else on the thread
>>> for all the help.
>>>
>>> I missed the trailing 0x0a in the different wireshark captures.  I was
>>> trusting wireshark's http dissection rather than looking at the raw hex
>>> data and it didn't show the trailing \n.
>>>
>>> I gotta go back to the basics and lean less on wireshark's
>>> "intelligence" :)
>>>
>>
>> Oh, and the plugin developer actually identified where the \n was coming
>> from and has resolved it on the client end.
>>
>> I do have one question.  Any idea why this only occurs on Windows servers?
>>
>
> Tested with the patch and looks good.
> I tried to recreate it using ncat and sending an extra \n but I'm not
> having luck.  I see the extra byte on my pcap.  Still curious what other
> conditions create this but oh well, at this point it's in my
> rear-view-mirror.
>
> Thanks again for all the help and the solution.
> Andy
>


I can't help but wonder if the '\n' is consistent but a '\r' is injected on
Windows... are you sure the variance was strictly a '\n'?

Generally an httpd module emits exactly what it means, whether it is a unix
'\n' line ending, or an http '\r\n' sequence as defined by spec. But with
generated content, you are more likely to see variances based on whatever
API generated the content, and lots of code will generate \n on unix vs.
the \r\n sequence on Windows - httpd didn't influence that.

--001a1141f37e1870440522b1e70f
Content-Type: text/html; charset=UTF-8
Content-Transfer-Encoding: quoted-printable

<div dir=3D"ltr"><div class=3D"gmail_extra"><div class=3D"gmail_quote">On T=
hu, Oct 22, 2015 at 8:42 AM, Andy Wang <span dir=3D"ltr">&lt;<a href=3D"mai=
lto:awang@ptc.com" target=3D"_blank">awang@ptc.com</a>&gt;</span> wrote:<br=
><blockquote class=3D"gmail_quote" style=3D"margin:0 0 0 .8ex;border-left:1=
px #ccc solid;padding-left:1ex"><span class=3D""><br>
On 10/21/2015 10:01 AM, Andy Wang wrote:<br>
<br>
<blockquote class=3D"gmail_quote" style=3D"margin:0 0 0 .8ex;border-left:1p=
x #ccc solid;padding-left:1ex"><blockquote class=3D"gmail_quote" style=3D"m=
argin:0 0 0 .8ex;border-left:1px #ccc solid;padding-left:1ex">
I will do that today.<br>
<br>
And thank you to Rudiger and yourself, and everyone else on the thread<br>
for all the help.<br>
<br>
I missed the trailing 0x0a in the different wireshark captures.=C2=A0 I was=
<br>
trusting wireshark&#39;s http dissection rather than looking at the raw hex=
<br>
data and it didn&#39;t show the trailing \n.<br>
<br>
I gotta go back to the basics and lean less on wireshark&#39;s<br>
&quot;intelligence&quot; :)<br>
</blockquote>
<br>
Oh, and the plugin developer actually identified where the \n was coming<br=
>
from and has resolved it on the client end.<br>
<br>
I do have one question.=C2=A0 Any idea why this only occurs on Windows serv=
ers?<br>
</blockquote>
<br></span>
Tested with the patch and looks good.<br>
I tried to recreate it using ncat and sending an extra \n but I&#39;m not h=
aving luck.=C2=A0 I see the extra byte on my pcap.=C2=A0 Still curious what=
 other conditions create this but oh well, at this point it&#39;s in my rea=
r-view-mirror.<br>
<br>
Thanks again for all the help and the solution.<span class=3D"HOEnZb"><font=
 color=3D"#888888"><br>
Andy<br>
</font></span></blockquote></div><br></div><div class=3D"gmail_extra"><br><=
/div><div class=3D"gmail_extra">I can&#39;t help but wonder if the &#39;\n&=
#39; is consistent but a &#39;\r&#39; is injected on Windows... are you sur=
e the variance was strictly a &#39;\n&#39;?</div><div class=3D"gmail_extra"=
><br></div><div class=3D"gmail_extra">Generally an httpd module emits exact=
ly what it means, whether it is a unix &#39;\n&#39; line ending, or an http=
 &#39;\r\n&#39; sequence as defined by spec. But with generated content, yo=
u are more likely to see variances based on whatever API generated the cont=
ent, and lots of code will generate \n on unix vs. the \r\n sequence on Win=
dows - httpd didn&#39;t influence that.</div><div class=3D"gmail_extra"><br=
></div></div>

--001a1141f37e1870440522b1e70f--

From dev-return-84401-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Thu Oct 22 14:52:53 2015
Return-Path: <dev-return-84401-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 06BD210154
	for <apmail-httpd-dev-archive@www.apache.org>; Thu, 22 Oct 2015 14:52:53 +0000 (UTC)
Received: (qmail 67878 invoked by uid 500); 22 Oct 2015 14:52:52 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 67806 invoked by uid 500); 22 Oct 2015 14:52:52 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 67796 invoked by uid 99); 22 Oct 2015 14:52:52 -0000
Received: from Unknown (HELO spamd1-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 22 Oct 2015 14:52:52 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd1-us-west.apache.org (ASF Mail Server at spamd1-us-west.apache.org) with ESMTP id 1A64AC4A5F
	for <dev@httpd.apache.org>; Thu, 22 Oct 2015 14:52:52 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd1-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.099
X-Spam-Level:
X-Spam-Status: No, score=-0.099 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RP_MATCHES_RCVD=0.001, SPF_PASS=-0.001, URIBL_BLOCKED=0.001]
	autolearn=disabled
Authentication-Results: spamd1-us-west.apache.org (amavisd-new);
	dkim=pass (1024-bit key) header.d=ptc.com
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd1-us-west.apache.org [10.40.0.7]) (amavisd-new, port 10024)
	with ESMTP id r7WtuYBNfQeJ for <dev@httpd.apache.org>;
	Thu, 22 Oct 2015 14:52:41 +0000 (UTC)
Received: from mx2.ptc.com (mx2.ptc.com [12.11.148.189])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id B36FE439B6
	for <dev@httpd.apache.org>; Thu, 22 Oct 2015 14:52:41 +0000 (UTC)
DKIM-Signature: v=1; a=rsa-sha256; c=simple/simple;
  d=ptc.com; s=ptc; t=1445525561; x=1477061561;
  h=subject:to:references:from:message-id:date:mime-version:
   in-reply-to:content-transfer-encoding;
  bh=MGrEw1G9EH2DonGoiMK8B7lJuLQTDLHDQ6zH3jF3zAk=;
  b=WF3IaHnvDdZmg160PBX2yEdSPWB1D97VGnd+/RuS4NopXKm1dyJ2alkQ
   AT7r6ltm1FZEuKVhMwFbhDPNoUqtuymFXaoN3ZyanaduhpbS5/OWNZq19
   szeksL+UdML7AW0ROxRjZNEaRTdxhUWX5Z8UBQN4Ao+PyUgAG03gnLxQG
   w=;
X-IronPort-AV: E=Sophos;i="5.20,182,1444708800"; 
   d="scan'208";a="28554180"
Received: from hq-x10prdhub2.ptcnet.ptc.com ([132.253.198.28])
  by mx2-int.ptc.com with ESMTP/TLS/AES128-SHA; 22 Oct 2015 10:52:35 -0400
Received: from awang.ptcnet.ptc.com (132.253.8.73) by
 int-mail-hub2.ptcnet.ptc.com (132.253.201.252) with Microsoft SMTP Server id
 14.3.123.3; Thu, 22 Oct 2015 10:52:34 -0400
Subject: Re: [users@httpd] Chunked transfer delay with httpd 2.4 on Windows.
To: <dev@httpd.apache.org>
References: <5625642E.30708@ptc.com>
 <AB1691BE05AE7F4992697F2A0835627AC63489F4@VOEXM10W.internal.vodafone.com>
 <CAKQ1sVMhNzYPWHTvhdeV6z+mV2ZNq5vjHj=W1d6R46cOQ_-qhQ@mail.gmail.com>
 <AB1691BE05AE7F4992697F2A0835627AC6348C38@VOEXM10W.internal.vodafone.com>
 <CAKQ1sVNHz_aCLZ3um-NV8cJGnhR3FtE6wz+zGgusvW=MA+cO_A@mail.gmail.com>
 <CAKQ1sVO_E2AZBL9CPfpm=_RQEnHWRDWNg67NFKCqy-vC=uoJBw@mail.gmail.com>
 <562668DA.5060804@ptc.com> <56269CBD.5060701@ptc.com>
 <5627853C.4040006@apache.org>
 <CAKQ1sVORFAFNwxw92Xfxhd9pGs3vCgHgoA3SCty29BbvHoPeSQ@mail.gmail.com>
 <AB1691BE05AE7F4992697F2A0835627AC634A1A9@VOEXM10W.internal.vodafone.com>
 <CAKQ1sVNpfUzE5ubnHJVa2h-_y45nDSbXS8XbOZJp3x7HFaMb9Q@mail.gmail.com>
 <AB1691BE05AE7F4992697F2A0835627AC634A1E6@VOEXM10W.internal.vodafone.com>
 <CAKQ1sVP2jv3q-A8JH977Qtkr+jwb4WjJOo0CdPhGdVv5BmcbKw@mail.gmail.com>
 <5627A72B.7050302@ptc.com> <5627A8E4.4010108@ptc.com>
 <5628E7A9.2060708@ptc.com>
 <CACsi253Gt9=E-rqoFyR25S9gfFp5t6ORw=pjjjuRz6cwALE+KQ@mail.gmail.com>
From: Andy Wang <awang@ptc.com>
Message-ID: <5628F832.7020203@ptc.com>
Date: Thu, 22 Oct 2015 09:52:34 -0500
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:38.0) Gecko/20100101
 Thunderbird/38.3.0
MIME-Version: 1.0
In-Reply-To: <CACsi253Gt9=E-rqoFyR25S9gfFp5t6ORw=pjjjuRz6cwALE+KQ@mail.gmail.com>
Content-Type: text/plain; charset="utf-8"; format=flowed
Content-Transfer-Encoding: 7bit
X-Originating-IP: [132.253.8.73]

So this is the problematic request:
000002D0  6e 74 2d 54 79 70 65 3a  09 74 65 78 74 2f 70 6c nt-Type: .text/pl
000002E0  61 69 6e 0d 0a 0d 0a 0a                          ain.....

This is a "regular" request using HttpPRequester extension or just using 
ncat or curl:
000002D0  6e 74 2d 54 79 70 65 3a  20 74 65 78 74 2f 70 6c nt-Type:  text/pl
000002E0  61 69 6e 0d 0a 0d 0a                             ain....

Ignore the 0x09 and 0x20 difference.  I had him fix that already and it 
didn't make a difference.

I recreate the exact same request as the problematic request by adding a 
0x0a to the end of it but it doesn't recreate the problem.

Andy

On 10/22/2015 08:59 AM, William A Rowe Jr wrote:
> On Thu, Oct 22, 2015 at 8:42 AM, Andy Wang <awang@ptc.com
> <mailto:awang@ptc.com>> wrote:
>
>
>     On 10/21/2015 10:01 AM, Andy Wang wrote:
>
>             I will do that today.
>
>             And thank you to Rudiger and yourself, and everyone else on
>             the thread
>             for all the help.
>
>             I missed the trailing 0x0a in the different wireshark
>             captures.  I was
>             trusting wireshark's http dissection rather than looking at
>             the raw hex
>             data and it didn't show the trailing \n.
>
>             I gotta go back to the basics and lean less on wireshark's
>             "intelligence" :)
>
>
>         Oh, and the plugin developer actually identified where the \n
>         was coming
>         from and has resolved it on the client end.
>
>         I do have one question.  Any idea why this only occurs on
>         Windows servers?
>
>
>     Tested with the patch and looks good.
>     I tried to recreate it using ncat and sending an extra \n but I'm
>     not having luck.  I see the extra byte on my pcap.  Still curious
>     what other conditions create this but oh well, at this point it's in
>     my rear-view-mirror.
>
>     Thanks again for all the help and the solution.
>     Andy
>
>
>
> I can't help but wonder if the '\n' is consistent but a '\r' is injected
> on Windows... are you sure the variance was strictly a '\n'?
>
> Generally an httpd module emits exactly what it means, whether it is a
> unix '\n' line ending, or an http '\r\n' sequence as defined by spec.
> But with generated content, you are more likely to see variances based
> on whatever API generated the content, and lots of code will generate \n
> on unix vs. the \r\n sequence on Windows - httpd didn't influence that.
>

From dev-return-84402-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Thu Oct 22 15:06:26 2015
Return-Path: <dev-return-84402-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 6B023101FC
	for <apmail-httpd-dev-archive@www.apache.org>; Thu, 22 Oct 2015 15:06:26 +0000 (UTC)
Received: (qmail 3091 invoked by uid 500); 22 Oct 2015 15:06:16 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 2993 invoked by uid 500); 22 Oct 2015 15:06:16 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 2983 invoked by uid 99); 22 Oct 2015 15:06:16 -0000
Received: from Unknown (HELO spamd2-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 22 Oct 2015 15:06:16 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd2-us-west.apache.org (ASF Mail Server at spamd2-us-west.apache.org) with ESMTP id 1AA0A1A239B
	for <dev@httpd.apache.org>; Thu, 22 Oct 2015 15:06:16 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd2-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.12
X-Spam-Level:
X-Spam-Status: No, score=-0.12 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RCVD_IN_MSPIKE_H3=-0.01, RCVD_IN_MSPIKE_WL=-0.01, SPF_PASS=-0.001,
	URIBL_BLOCKED=0.001] autolearn=disabled
Authentication-Results: spamd2-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-us-west.apache.org ([10.40.0.8])
	by localhost (spamd2-us-west.apache.org [10.40.0.9]) (amavisd-new, port 10024)
	with ESMTP id X33S8QQwmE9I for <dev@httpd.apache.org>;
	Thu, 22 Oct 2015 15:06:09 +0000 (UTC)
Received: from mail-qk0-f181.google.com (mail-qk0-f181.google.com [209.85.220.181])
	by mx1-us-west.apache.org (ASF Mail Server at mx1-us-west.apache.org) with ESMTPS id 71E0C20751
	for <dev@httpd.apache.org>; Thu, 22 Oct 2015 15:06:09 +0000 (UTC)
Received: by qkcy65 with SMTP id y65so54744991qkc.0
        for <dev@httpd.apache.org>; Thu, 22 Oct 2015 08:06:03 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        bh=AvAqR/ObodLFPbj3koyWiaO5RpmetgQHOF6HWEOFZbs=;
        b=tqxl3pQzDrK+NXoGIkVMwUsFV2jSI1G0AvnU06Z9bIJ689JgozTOaBQ660lb3Xm8Us
         BR7RRwAEVQzd4aPgfi8xKwJus/udItSWSQqsxm0N808652/IeIx+ZYJer4DtNqQl40aI
         KYpvDPsOkySNl+wpxVQ+pIbNlNOKt+BgzHYYqYwarKChR6+Gwc5s6ZLiRA+RBAv9p85p
         yMsEp+svvz2hFaf1xA+a7w4ovSQDSqJCHz3OFimmvR1SivaYzR8B7D8HlwMNm42Ehxjy
         fj9toV6k2baJWwoZE1QPvkPY2wdJvz31KbRHEnt/QmwIbww/35OC7WXoMWlrqzSPRlNE
         x5IA==
MIME-Version: 1.0
X-Received: by 10.55.192.15 with SMTP id o15mr19661559qki.2.1445526363579;
 Thu, 22 Oct 2015 08:06:03 -0700 (PDT)
Received: by 10.55.156.213 with HTTP; Thu, 22 Oct 2015 08:06:03 -0700 (PDT)
In-Reply-To: <5628F832.7020203@ptc.com>
References: <5625642E.30708@ptc.com>
	<AB1691BE05AE7F4992697F2A0835627AC63489F4@VOEXM10W.internal.vodafone.com>
	<CAKQ1sVMhNzYPWHTvhdeV6z+mV2ZNq5vjHj=W1d6R46cOQ_-qhQ@mail.gmail.com>
	<AB1691BE05AE7F4992697F2A0835627AC6348C38@VOEXM10W.internal.vodafone.com>
	<CAKQ1sVNHz_aCLZ3um-NV8cJGnhR3FtE6wz+zGgusvW=MA+cO_A@mail.gmail.com>
	<CAKQ1sVO_E2AZBL9CPfpm=_RQEnHWRDWNg67NFKCqy-vC=uoJBw@mail.gmail.com>
	<562668DA.5060804@ptc.com>
	<56269CBD.5060701@ptc.com>
	<5627853C.4040006@apache.org>
	<CAKQ1sVORFAFNwxw92Xfxhd9pGs3vCgHgoA3SCty29BbvHoPeSQ@mail.gmail.com>
	<AB1691BE05AE7F4992697F2A0835627AC634A1A9@VOEXM10W.internal.vodafone.com>
	<CAKQ1sVNpfUzE5ubnHJVa2h-_y45nDSbXS8XbOZJp3x7HFaMb9Q@mail.gmail.com>
	<AB1691BE05AE7F4992697F2A0835627AC634A1E6@VOEXM10W.internal.vodafone.com>
	<CAKQ1sVP2jv3q-A8JH977Qtkr+jwb4WjJOo0CdPhGdVv5BmcbKw@mail.gmail.com>
	<5627A72B.7050302@ptc.com>
	<5627A8E4.4010108@ptc.com>
	<5628E7A9.2060708@ptc.com>
	<CACsi253Gt9=E-rqoFyR25S9gfFp5t6ORw=pjjjuRz6cwALE+KQ@mail.gmail.com>
	<5628F832.7020203@ptc.com>
Date: Thu, 22 Oct 2015 17:06:03 +0200
Message-ID: <CAKQ1sVPbx6Awyi_w_C=MSNop+SeQxsQDRSdEmLmZj7JMq2QL_g@mail.gmail.com>
Subject: Re: [users@httpd] Chunked transfer delay with httpd 2.4 on Windows.
From: Yann Ylavic <ylavic.dev@gmail.com>
To: dev@httpd.apache.org
Content-Type: text/plain; charset=UTF-8

Does it make a difference with "AcceptFilter http none" configured?
It shouldn't, but since we are in the x-files...

On Thu, Oct 22, 2015 at 4:52 PM, Andy Wang <awang@ptc.com> wrote:
> So this is the problematic request:
> 000002D0  6e 74 2d 54 79 70 65 3a  09 74 65 78 74 2f 70 6c nt-Type: .text/pl
> 000002E0  61 69 6e 0d 0a 0d 0a 0a                          ain.....
>
> This is a "regular" request using HttpPRequester extension or just using
> ncat or curl:
> 000002D0  6e 74 2d 54 79 70 65 3a  20 74 65 78 74 2f 70 6c nt-Type:  text/pl
> 000002E0  61 69 6e 0d 0a 0d 0a                             ain....
>
> Ignore the 0x09 and 0x20 difference.  I had him fix that already and it
> didn't make a difference.
>
> I recreate the exact same request as the problematic request by adding a
> 0x0a to the end of it but it doesn't recreate the problem.
>
> Andy
>
> On 10/22/2015 08:59 AM, William A Rowe Jr wrote:
>>
>> On Thu, Oct 22, 2015 at 8:42 AM, Andy Wang <awang@ptc.com
>> <mailto:awang@ptc.com>> wrote:
>>
>>
>>     On 10/21/2015 10:01 AM, Andy Wang wrote:
>>
>>             I will do that today.
>>
>>             And thank you to Rudiger and yourself, and everyone else on
>>             the thread
>>             for all the help.
>>
>>             I missed the trailing 0x0a in the different wireshark
>>             captures.  I was
>>             trusting wireshark's http dissection rather than looking at
>>             the raw hex
>>             data and it didn't show the trailing \n.
>>
>>             I gotta go back to the basics and lean less on wireshark's
>>             "intelligence" :)
>>
>>
>>         Oh, and the plugin developer actually identified where the \n
>>         was coming
>>         from and has resolved it on the client end.
>>
>>         I do have one question.  Any idea why this only occurs on
>>         Windows servers?
>>
>>
>>     Tested with the patch and looks good.
>>     I tried to recreate it using ncat and sending an extra \n but I'm
>>     not having luck.  I see the extra byte on my pcap.  Still curious
>>     what other conditions create this but oh well, at this point it's in
>>     my rear-view-mirror.
>>
>>     Thanks again for all the help and the solution.
>>     Andy
>>
>>
>>
>> I can't help but wonder if the '\n' is consistent but a '\r' is injected
>> on Windows... are you sure the variance was strictly a '\n'?
>>
>> Generally an httpd module emits exactly what it means, whether it is a
>> unix '\n' line ending, or an http '\r\n' sequence as defined by spec.
>> But with generated content, you are more likely to see variances based
>> on whatever API generated the content, and lots of code will generate \n
>> on unix vs. the \r\n sequence on Windows - httpd didn't influence that.
>>
>

From dev-return-84403-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Thu Oct 22 15:31:56 2015
Return-Path: <dev-return-84403-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 5E3931032D
	for <apmail-httpd-dev-archive@www.apache.org>; Thu, 22 Oct 2015 15:31:56 +0000 (UTC)
Received: (qmail 8071 invoked by uid 500); 22 Oct 2015 15:31:54 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 7918 invoked by uid 500); 22 Oct 2015 15:31:53 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 7857 invoked by uid 99); 22 Oct 2015 15:31:53 -0000
Received: from Unknown (HELO spamd1-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 22 Oct 2015 15:31:53 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd1-us-west.apache.org (ASF Mail Server at spamd1-us-west.apache.org) with ESMTP id 751EAC60D0
	for <dev@httpd.apache.org>; Thu, 22 Oct 2015 15:31:53 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd1-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.1
X-Spam-Level:
X-Spam-Status: No, score=-0.1 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RP_MATCHES_RCVD=0.001, SPF_PASS=-0.001] autolearn=disabled
Authentication-Results: spamd1-us-west.apache.org (amavisd-new);
	dkim=pass (1024-bit key) header.d=ptc.com
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd1-us-west.apache.org [10.40.0.7]) (amavisd-new, port 10024)
	with ESMTP id HcuoUBowIVV8 for <dev@httpd.apache.org>;
	Thu, 22 Oct 2015 15:31:47 +0000 (UTC)
Received: from mx2.ptc.com (mx2.ptc.com [12.11.148.189])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id BADC542BEB
	for <dev@httpd.apache.org>; Thu, 22 Oct 2015 15:31:47 +0000 (UTC)
DKIM-Signature: v=1; a=rsa-sha256; c=simple/simple;
  d=ptc.com; s=ptc; t=1445527907; x=1477063907;
  h=subject:to:references:from:message-id:date:mime-version:
   in-reply-to:content-transfer-encoding;
  bh=NBZvCsCjlq7/Ff7NLQU7dARweOj6deif1EwhnhJLwPU=;
  b=HP3YOaQxGd8RCiMs9yuq6MmByygmk5nMmUDdI/6w5LReCHlVMAnhCyHn
   9gPXv9MHxkAyLJW+C7zGfEwWKTSGfsDbW2H1CwHLjYwcwfdszGKf4dFg5
   C7bFKNY+RUUc/o+h5dpx3dRN1gy5d5Bbc9nqDOP55mjJ0VwUv+mC+hJvm
   U=;
X-IronPort-AV: E=Sophos;i="5.20,182,1444708800"; 
   d="scan'208";a="28559980"
Received: from hq-x10prdhub2.ptcnet.ptc.com ([132.253.198.28])
  by mx2-int.ptc.com with ESMTP/TLS/AES128-SHA; 22 Oct 2015 11:31:47 -0400
Received: from awang.ptcnet.ptc.com (132.253.8.73) by
 int-mail-hub2.ptcnet.ptc.com (132.253.201.252) with Microsoft SMTP Server id
 14.3.123.3; Thu, 22 Oct 2015 11:31:46 -0400
Subject: Re: [users@httpd] Chunked transfer delay with httpd 2.4 on Windows.
To: <dev@httpd.apache.org>
References: <5625642E.30708@ptc.com>
 <AB1691BE05AE7F4992697F2A0835627AC6348C38@VOEXM10W.internal.vodafone.com>
 <CAKQ1sVNHz_aCLZ3um-NV8cJGnhR3FtE6wz+zGgusvW=MA+cO_A@mail.gmail.com>
 <CAKQ1sVO_E2AZBL9CPfpm=_RQEnHWRDWNg67NFKCqy-vC=uoJBw@mail.gmail.com>
 <562668DA.5060804@ptc.com> <56269CBD.5060701@ptc.com>
 <5627853C.4040006@apache.org>
 <CAKQ1sVORFAFNwxw92Xfxhd9pGs3vCgHgoA3SCty29BbvHoPeSQ@mail.gmail.com>
 <AB1691BE05AE7F4992697F2A0835627AC634A1A9@VOEXM10W.internal.vodafone.com>
 <CAKQ1sVNpfUzE5ubnHJVa2h-_y45nDSbXS8XbOZJp3x7HFaMb9Q@mail.gmail.com>
 <AB1691BE05AE7F4992697F2A0835627AC634A1E6@VOEXM10W.internal.vodafone.com>
 <CAKQ1sVP2jv3q-A8JH977Qtkr+jwb4WjJOo0CdPhGdVv5BmcbKw@mail.gmail.com>
 <5627A72B.7050302@ptc.com> <5627A8E4.4010108@ptc.com>
 <5628E7A9.2060708@ptc.com>
 <CACsi253Gt9=E-rqoFyR25S9gfFp5t6ORw=pjjjuRz6cwALE+KQ@mail.gmail.com>
 <5628F832.7020203@ptc.com>
 <CAKQ1sVPbx6Awyi_w_C=MSNop+SeQxsQDRSdEmLmZj7JMq2QL_g@mail.gmail.com>
From: Andy Wang <awang@ptc.com>
Message-ID: <56290162.90406@ptc.com>
Date: Thu, 22 Oct 2015 10:31:46 -0500
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:38.0) Gecko/20100101
 Thunderbird/38.3.0
MIME-Version: 1.0
In-Reply-To: <CAKQ1sVPbx6Awyi_w_C=MSNop+SeQxsQDRSdEmLmZj7JMq2QL_g@mail.gmail.com>
Content-Type: text/plain; charset="utf-8"; format=flowed
Content-Transfer-Encoding: 7bit
X-Originating-IP: [132.253.8.73]



On 10/22/2015 10:06 AM, Yann Ylavic wrote:
> Does it make a difference with "AcceptFilter http none" configured?
> It shouldn't, but since we are in the x-files...

I already had to do that.  We have this weird scenario where when our 
installer installs httpd, httpd hangs.  Packet captures show the request 
arriving but no ACK or any form of response.

If I kill the installer process, the problem goes away.  I have no idea 
how or why that could possibly occur, but Acceptfilter http none 
resolves that issue.

Andy

From dev-return-84404-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Thu Oct 22 15:39:07 2015
Return-Path: <dev-return-84404-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id DD4E4103F0
	for <apmail-httpd-dev-archive@www.apache.org>; Thu, 22 Oct 2015 15:39:06 +0000 (UTC)
Received: (qmail 34445 invoked by uid 500); 22 Oct 2015 15:39:06 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 34367 invoked by uid 500); 22 Oct 2015 15:39:06 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 34353 invoked by uid 99); 22 Oct 2015 15:39:06 -0000
Received: from Unknown (HELO spamd3-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 22 Oct 2015 15:39:06 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd3-us-west.apache.org (ASF Mail Server at spamd3-us-west.apache.org) with ESMTP id 06532180424
	for <dev@httpd.apache.org>; Thu, 22 Oct 2015 15:39:06 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd3-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.01
X-Spam-Level:
X-Spam-Status: No, score=-0.01 tagged_above=-999 required=6.31
	tests=[SPF_PASS=-0.001, T_RP_MATCHES_RCVD=-0.01, URIBL_BLOCKED=0.001]
	autolearn=disabled
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd3-us-west.apache.org [10.40.0.10]) (amavisd-new, port 10024)
	with ESMTP id s97KVWhl96ek for <dev@httpd.apache.org>;
	Thu, 22 Oct 2015 15:38:58 +0000 (UTC)
Received: from monica.sharp.fm (monica.sharp.fm [80.168.143.5])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTP id 7A960439C3
	for <dev@httpd.apache.org>; Thu, 22 Oct 2015 15:38:58 +0000 (UTC)
Received: from [10.40.76.36] (unknown [31.55.13.171])
	(using TLSv1 with cipher DHE-RSA-AES256-SHA (256/256 bits))
	(Client did not present a certificate)
	(Authenticated sender: minfrin@sharp.fm)
	by monica.sharp.fm (Postfix) with ESMTPSA id 95388802F6
	for <dev@httpd.apache.org>; Thu, 22 Oct 2015 16:38:51 +0100 (BST)
Content-Type: text/plain; charset=utf-8
Mime-Version: 1.0 (Mac OS X Mail 8.2 \(2104\))
Subject: Re: [users@httpd] Chunked transfer delay with httpd 2.4 on Windows.
From: Graham Leggett <minfrin@sharp.fm>
In-Reply-To: <56290162.90406@ptc.com>
Date: Thu, 22 Oct 2015 17:38:48 +0200
Content-Transfer-Encoding: quoted-printable
Message-Id: <4EC9C289-E218-4ADE-93D8-41F0CAD802BC@sharp.fm>
References: <5625642E.30708@ptc.com> <AB1691BE05AE7F4992697F2A0835627AC6348C38@VOEXM10W.internal.vodafone.com> <CAKQ1sVNHz_aCLZ3um-NV8cJGnhR3FtE6wz+zGgusvW=MA+cO_A@mail.gmail.com> <CAKQ1sVO_E2AZBL9CPfpm=_RQEnHWRDWNg67NFKCqy-vC=uoJBw@mail.gmail.com> <562668DA.5060804@ptc.com> <56269CBD.5060701@ptc.com> <5627853C.4040006@apache.org> <CAKQ1sVORFAFNwxw92Xfxhd9pGs3vCgHgoA3SCty29BbvHoPeSQ@mail.gmail.com> <AB1691BE05AE7F4992697F2A0835627AC634A1A9@VOEXM10W.internal.vodafone.com> <CAKQ1sVNpfUzE5ubnHJVa2h-_y45nDSbXS8XbOZJp3x7HFaMb9Q@mail.gmail.com> <AB1691BE05AE7F4992697F2A0835627AC634A1E6@VOEXM10W.internal.vodafone.com> <CAKQ1sVP2jv3q-A8JH977Qtkr+jwb4WjJOo0CdPhGdVv5BmcbKw@mail.gmail.com> <5627A72B.7050302@ptc.com> <5627A8E4.4010108@ptc.com> <5628E7A9.2060708@ptc.com> <CACsi253Gt9=E-rqoFyR25S9gfFp5t6ORw=pjjjuRz6cwALE+KQ@mail.gmail.com> <5628F832.7020203@ptc.com> <CAKQ1sVPbx6Awyi_w_C=MSNop+SeQxsQDRSdEmLmZj7JMq2QL_g@mail.gmail.com> <56290162.90406@ptc.com>
To: dev@httpd.apache.org
X-Mailer: Apple Mail (2.2104)

On 22 Oct 2015, at 5:31 PM, Andy Wang <awang@ptc.com> wrote:

> I already had to do that.  We have this weird scenario where when our =
installer installs httpd, httpd hangs.  Packet captures show the request =
arriving but no ACK or any form of response.
>=20
> If I kill the installer process, the problem goes away.  I have no =
idea how or why that could possibly occur, but Acceptfilter http none =
resolves that issue.

Sounds like a request that the http accept filter doesn=E2=80=99t =
believe is complete?

Could be an RFC violation on the client side.

Regards,
Graham
=E2=80=94


From dev-return-84405-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Thu Oct 22 15:43:45 2015
Return-Path: <dev-return-84405-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 5FBA01043D
	for <apmail-httpd-dev-archive@www.apache.org>; Thu, 22 Oct 2015 15:43:45 +0000 (UTC)
Received: (qmail 45714 invoked by uid 500); 22 Oct 2015 15:43:41 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 45643 invoked by uid 500); 22 Oct 2015 15:43:41 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 45633 invoked by uid 99); 22 Oct 2015 15:43:41 -0000
Received: from Unknown (HELO spamd2-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 22 Oct 2015 15:43:41 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd2-us-west.apache.org (ASF Mail Server at spamd2-us-west.apache.org) with ESMTP id 576E91A24E8
	for <dev@httpd.apache.org>; Thu, 22 Oct 2015 15:43:41 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd2-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.11
X-Spam-Level:
X-Spam-Status: No, score=-0.11 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	SPF_PASS=-0.001, T_RP_MATCHES_RCVD=-0.01, URIBL_BLOCKED=0.001]
	autolearn=disabled
Authentication-Results: spamd2-us-west.apache.org (amavisd-new);
	dkim=pass (1024-bit key) header.d=greenbytes.de
Received: from mx1-us-west.apache.org ([10.40.0.8])
	by localhost (spamd2-us-west.apache.org [10.40.0.9]) (amavisd-new, port 10024)
	with ESMTP id Lmn_oy7yzyg4 for <dev@httpd.apache.org>;
	Thu, 22 Oct 2015 15:43:30 +0000 (UTC)
Received: from mail.greenbytes.de (mail.greenbytes.de [217.91.35.233])
	by mx1-us-west.apache.org (ASF Mail Server at mx1-us-west.apache.org) with ESMTPS id 043BB2118F
	for <dev@httpd.apache.org>; Thu, 22 Oct 2015 15:43:29 +0000 (UTC)
Received: from [192.168.1.42] (unknown [217.91.35.233])
	(using TLSv1 with cipher ECDHE-RSA-AES256-SHA (256/256 bits))
	(Client did not present a certificate)
	by mail.greenbytes.de (Postfix) with ESMTPSA id 25E1715A0485
	for <dev@httpd.apache.org>; Thu, 22 Oct 2015 17:43:21 +0200 (CEST)
DKIM-Signature: v=1; a=rsa-sha256; c=simple/simple; d=greenbytes.de; s=mail;
	t=1445528601; bh=a6TlmWAT8utUy5B9y0GlIpcgk0r+Q+ca/X4iiV8pE+c=;
	h=Subject:From:In-Reply-To:Date:References:To:From;
	b=oazWlk58L1MWx/hZEYtP3fQDkok0Ii4p8StIyMWEVG01rJ8a3Kr9ZzXZmwAJK051Y
	 msOQOCT67Bw0kUMP9CbrbYwkh4BCFIT4Vo3ArQY8Axhyaebt0j4sRRiVlxUh2JXoYa
	 KTlEzdM+tyDCwKt4+8iUPAB7mfy8KIKD2E3K7KBI=
Content-Type: text/plain; charset=us-ascii
Mime-Version: 1.0 (Mac OS X Mail 9.1 \(3096.5\))
Subject: Re: buckets and connections (long post)
From: Stefan Eissing <stefan.eissing@greenbytes.de>
In-Reply-To: <8C00B305-BECC-4A48-9A03-8A7CA99EADE4@sharp.fm>
Date: Thu, 22 Oct 2015 17:43:20 +0200
Content-Transfer-Encoding: quoted-printable
Message-Id: <8A016E53-0A95-4766-83FC-00113405AFA2@greenbytes.de>
References: <CAKQ1sVNchFx=egp=Q0tgT+1GcBXiten8mh9STetcZXOfJxhsjQ@mail.gmail.com> <CAKQ1sVPjcA9EYNpjcmM9=AU_LCgAsFntOcZnmGoHymds3S5wmA@mail.gmail.com> <AB1691BE05AE7F4992697F2A0835627AC6348972@VOEXM10W.internal.vodafone.com> <7B24F4D1-6904-4C00-A337-88F712026BE9@greenbytes.de> <0D5B13DA-8642-4662-9606-6B5DF94EB87B@sharp.fm> <D70FBC43-2E52-4BDD-ADA5-88623657CBEC@jaguNET.com> <4D37F1D6-E2FB-408B-9D82-9F7ABABFFE1E@greenbytes.de> <8C00B305-BECC-4A48-9A03-8A7CA99EADE4@sharp.fm>
To: dev@httpd.apache.org
X-Mailer: Apple Mail (2.3096.5)

(I split these up, since answers touch on different topics):



> Am 21.10.2015 um 16:48 schrieb Graham Leggett <minfrin@sharp.fm>:
>=20
> On 21 Oct 2015, at 4:18 PM, Stefan Eissing =
<stefan.eissing@greenbytes.de> wrote:
>=20
>> How good does this mechanism work for mod_http2? On the one side it's =
the same, on the other quite different.
>>=20
>> On the real, main connection, the master connection, where the h2 =
session resides, things are
>> pretty similar with some exceptions:
>> - it is very bursty. requests continue to come in. There is no pause =
between responses and the next request.
>> - pauses, when they happen, will be longer. clients are expected to =
keep open connections around for
>> longer (if we let them).
>> - When there is nothing to do, mod_http2 makes a blocking read on the =
connection input. This currently
>> does not lead to the state B) or C). The worker for the http2 =
connection stays assigned. This needs
>> to improve.
>=20
> The blocking read breaks the spirit of the event MPM.
>=20
> In theory, as long as you enter the write completion state and then =
not leave until your connection is done, this problem will go away.
>=20
> If you want to read instead of write, make sure the =
CONN_SENSE_WANT_READ option is set on the connection.

This does not parse. I do not understand what you are talking about.=20

When all streams have been passed into the output filters, the mod_http2 =
session does a=20

    status =3D ap_get_brigade(io->connection->input_filters,...)  =
(h2_conn_io.c, line 160)

similar to what ap_read_request() -> ap_rgetline_core() does. =
(protocol.c, line 236)

What should mod_http2 do different here?

//Stefan=

From dev-return-84406-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Thu Oct 22 15:52:33 2015
Return-Path: <dev-return-84406-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 52545104B6
	for <apmail-httpd-dev-archive@www.apache.org>; Thu, 22 Oct 2015 15:52:33 +0000 (UTC)
Received: (qmail 73503 invoked by uid 500); 22 Oct 2015 15:52:32 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 73434 invoked by uid 500); 22 Oct 2015 15:52:32 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 73423 invoked by uid 99); 22 Oct 2015 15:52:32 -0000
Received: from Unknown (HELO spamd2-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 22 Oct 2015 15:52:32 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd2-us-west.apache.org (ASF Mail Server at spamd2-us-west.apache.org) with ESMTP id 3E11C1A2B62
	for <dev@httpd.apache.org>; Thu, 22 Oct 2015 15:52:32 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd2-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.109
X-Spam-Level:
X-Spam-Status: No, score=-0.109 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	T_RP_MATCHES_RCVD=-0.01, URIBL_BLOCKED=0.001] autolearn=disabled
Authentication-Results: spamd2-us-west.apache.org (amavisd-new);
	dkim=pass (1024-bit key) header.d=ptc.com
Received: from mx1-us-west.apache.org ([10.40.0.8])
	by localhost (spamd2-us-west.apache.org [10.40.0.9]) (amavisd-new, port 10024)
	with ESMTP id 3rQU_hqN9YUD for <dev@httpd.apache.org>;
	Thu, 22 Oct 2015 15:52:24 +0000 (UTC)
Received: from mx1.ptc.com (mx1.ptc.com [12.11.148.188])
	by mx1-us-west.apache.org (ASF Mail Server at mx1-us-west.apache.org) with ESMTPS id 413F223194
	for <dev@httpd.apache.org>; Thu, 22 Oct 2015 15:52:24 +0000 (UTC)
DKIM-Signature: v=1; a=rsa-sha256; c=simple/simple;
  d=ptc.com; s=ptc; t=1445529144; x=1477065144;
  h=subject:to:references:from:message-id:date:mime-version:
   in-reply-to:content-transfer-encoding;
  bh=pd8ArbW5nnAMtBeFjsvF+0zczubx+wNqvOXsKlMA8AM=;
  b=H7iDrAuX9bcFo677RYIHZGEvXjmTkXV6QumlLF37OaqhoIpk4rlSWCJ4
   0DP9cjbFD8KKbVJjkkslMl28k1qvCKqcyACkoTPYcv9a5QxYJT4PqW3pj
   p6X2jqkiwvk/DY40SUf/q5qIAMg99z0Fy9bUBzl2Bjot/c0tyx1jxClH1
   M=;
X-IronPort-AV: E=Sophos;i="5.20,183,1444708800"; 
   d="scan'208";a="118852685"
Received: from hq-x10prdhub1.ptcnet.ptc.com ([132.253.198.27])
  by mx1-int.ptc.com with ESMTP/TLS/AES128-SHA; 22 Oct 2015 11:52:10 -0400
Received: from awang.ptcnet.ptc.com (132.253.8.73) by
 int-mail-hub1.ptcnet.ptc.com (132.253.201.252) with Microsoft SMTP Server id
 14.3.123.3; Thu, 22 Oct 2015 11:52:09 -0400
Subject: Re: [users@httpd] Chunked transfer delay with httpd 2.4 on Windows.
To: <dev@httpd.apache.org>
References: <5625642E.30708@ptc.com>
 <CAKQ1sVNHz_aCLZ3um-NV8cJGnhR3FtE6wz+zGgusvW=MA+cO_A@mail.gmail.com>
 <CAKQ1sVO_E2AZBL9CPfpm=_RQEnHWRDWNg67NFKCqy-vC=uoJBw@mail.gmail.com>
 <562668DA.5060804@ptc.com> <56269CBD.5060701@ptc.com>
 <5627853C.4040006@apache.org>
 <CAKQ1sVORFAFNwxw92Xfxhd9pGs3vCgHgoA3SCty29BbvHoPeSQ@mail.gmail.com>
 <AB1691BE05AE7F4992697F2A0835627AC634A1A9@VOEXM10W.internal.vodafone.com>
 <CAKQ1sVNpfUzE5ubnHJVa2h-_y45nDSbXS8XbOZJp3x7HFaMb9Q@mail.gmail.com>
 <AB1691BE05AE7F4992697F2A0835627AC634A1E6@VOEXM10W.internal.vodafone.com>
 <CAKQ1sVP2jv3q-A8JH977Qtkr+jwb4WjJOo0CdPhGdVv5BmcbKw@mail.gmail.com>
 <5627A72B.7050302@ptc.com> <5627A8E4.4010108@ptc.com>
 <5628E7A9.2060708@ptc.com>
 <CACsi253Gt9=E-rqoFyR25S9gfFp5t6ORw=pjjjuRz6cwALE+KQ@mail.gmail.com>
 <5628F832.7020203@ptc.com>
 <CAKQ1sVPbx6Awyi_w_C=MSNop+SeQxsQDRSdEmLmZj7JMq2QL_g@mail.gmail.com>
 <56290162.90406@ptc.com> <4EC9C289-E218-4ADE-93D8-41F0CAD802BC@sharp.fm>
From: Andy Wang <awang@ptc.com>
Message-ID: <56290628.60601@ptc.com>
Date: Thu, 22 Oct 2015 10:52:08 -0500
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:38.0) Gecko/20100101
 Thunderbird/38.3.0
MIME-Version: 1.0
In-Reply-To: <4EC9C289-E218-4ADE-93D8-41F0CAD802BC@sharp.fm>
Content-Type: text/plain; charset="utf-8"; format=flowed
Content-Transfer-Encoding: 8bit
X-Originating-IP: [132.253.8.73]



On 10/22/2015 10:38 AM, Graham Leggett wrote:
> On 22 Oct 2015, at 5:31 PM, Andy Wang <awang@ptc.com> wrote:
>
>> I already had to do that.  We have this weird scenario where when our installer installs httpd, httpd hangs.  Packet captures show the request arriving but no ACK or any form of response.
>>
>> If I kill the installer process, the problem goes away.  I have no idea how or why that could possibly occur, but Acceptfilter http none resolves that issue.
>
> Sounds like a request that the http accept filter doesn’t believe is complete?
>
> Could be an RFC violation on the client side.
>

I'm not sure how that's possible.  The TCP stack doesn't even respond to 
the initial SYN.

As soon as we kill the installer process, httpd starts to respond.

Andy

From dev-return-84407-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Thu Oct 22 15:55:50 2015
Return-Path: <dev-return-84407-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id AA82F104F2
	for <apmail-httpd-dev-archive@www.apache.org>; Thu, 22 Oct 2015 15:55:50 +0000 (UTC)
Received: (qmail 86384 invoked by uid 500); 22 Oct 2015 15:55:50 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 86301 invoked by uid 500); 22 Oct 2015 15:55:50 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 86291 invoked by uid 99); 22 Oct 2015 15:55:50 -0000
Received: from Unknown (HELO spamd3-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 22 Oct 2015 15:55:50 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd3-us-west.apache.org (ASF Mail Server at spamd3-us-west.apache.org) with ESMTP id AE8FA180428
	for <dev@httpd.apache.org>; Thu, 22 Oct 2015 15:55:49 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd3-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.11
X-Spam-Level:
X-Spam-Status: No, score=-0.11 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	SPF_PASS=-0.001, T_RP_MATCHES_RCVD=-0.01, URIBL_BLOCKED=0.001]
	autolearn=disabled
Authentication-Results: spamd3-us-west.apache.org (amavisd-new);
	dkim=pass (1024-bit key) header.d=greenbytes.de
Received: from mx1-us-west.apache.org ([10.40.0.8])
	by localhost (spamd3-us-west.apache.org [10.40.0.10]) (amavisd-new, port 10024)
	with ESMTP id OcFRt218kmZW for <dev@httpd.apache.org>;
	Thu, 22 Oct 2015 15:55:40 +0000 (UTC)
Received: from mail.greenbytes.de (mail.greenbytes.de [217.91.35.233])
	by mx1-us-west.apache.org (ASF Mail Server at mx1-us-west.apache.org) with ESMTPS id 5745523033
	for <dev@httpd.apache.org>; Thu, 22 Oct 2015 15:55:40 +0000 (UTC)
Received: from [192.168.1.42] (unknown [217.91.35.233])
	(using TLSv1 with cipher ECDHE-RSA-AES256-SHA (256/256 bits))
	(Client did not present a certificate)
	by mail.greenbytes.de (Postfix) with ESMTPSA id B5D6215A0485
	for <dev@httpd.apache.org>; Thu, 22 Oct 2015 17:55:38 +0200 (CEST)
DKIM-Signature: v=1; a=rsa-sha256; c=simple/simple; d=greenbytes.de; s=mail;
	t=1445529338; bh=wA2Z8TNcHYGRu42GDZ5Gdt3rn6eSGVXMSQJH3gK8/AQ=;
	h=Subject:From:In-Reply-To:Date:References:To:From;
	b=A5iC8C51eKqfJYHE2TpT8PLdGtOSm1TDXWy/VD/GelkEPJc23AxR5uCPT/QFBdg0p
	 fygubEIh+VkPPvBJkG2/QogD+vX06Z/Aq9n5uvLaIIEVtkN0bjY5WQHldbeclpEg0a
	 qFOaga/d32zdVURDgM6sw5DpwYaJXJsCtt89adcw=
Content-Type: text/plain; charset=utf-8
Mime-Version: 1.0 (Mac OS X Mail 9.1 \(3096.5\))
Subject: Re: buckets and connections (long post)
From: Stefan Eissing <stefan.eissing@greenbytes.de>
In-Reply-To: <8C00B305-BECC-4A48-9A03-8A7CA99EADE4@sharp.fm>
Date: Thu, 22 Oct 2015 17:55:38 +0200
Content-Transfer-Encoding: quoted-printable
Message-Id: <B9FD7DE7-1362-4AA2-BCB9-97BA2A3FADB1@greenbytes.de>
References: <CAKQ1sVNchFx=egp=Q0tgT+1GcBXiten8mh9STetcZXOfJxhsjQ@mail.gmail.com> <CAKQ1sVPjcA9EYNpjcmM9=AU_LCgAsFntOcZnmGoHymds3S5wmA@mail.gmail.com> <AB1691BE05AE7F4992697F2A0835627AC6348972@VOEXM10W.internal.vodafone.com> <7B24F4D1-6904-4C00-A337-88F712026BE9@greenbytes.de> <0D5B13DA-8642-4662-9606-6B5DF94EB87B@sharp.fm> <D70FBC43-2E52-4BDD-ADA5-88623657CBEC@jaguNET.com> <4D37F1D6-E2FB-408B-9D82-9F7ABABFFE1E@greenbytes.de> <8C00B305-BECC-4A48-9A03-8A7CA99EADE4@sharp.fm>
To: dev@httpd.apache.org
X-Mailer: Apple Mail (2.3096.5)


> Am 21.10.2015 um 16:48 schrieb Graham Leggett <minfrin@sharp.fm>:
>=20
> On 21 Oct 2015, at 4:18 PM, Stefan Eissing =
<stefan.eissing@greenbytes.de> wrote:
> [...]
>> 3. The amount of buffered bytes should be more flexible per stream =
and redistribute a maximum for=20
>>  the whole session depending on load.
>> 4. mod_http2 needs a process wide Resource Allocator for file =
handles. A master connection should
>>  borrow n handles at start, increase/decrease the amount based on =
load, to give best performance
>> 5. similar optimizations should be possible for other bucket types =
(mmap? immortal? heap?)
>=20
> Right now this task is handled by the core network filter - it is very =
likely this problem is already solved, and you don=E2=80=99t need to do =
anything.
>=20
> If the problem still needs solving, then the core filter is the place =
to do it. What the core filter does is add up the resources taken up by =
different buckets and if these resources breach limits, blocking writes =
are done until we=E2=80=99re below the limit again. This provides the =
flow control we need.

I know that code and it does not help HTTP/2 processing.

> With the async filters this flow control is now made available to =
every filter in the ap_filter_setaside_brigade() function. When =
mod_http2 handles async filters you=E2=80=99ll get this flow control for =
free.

No, it will not. The processing of responses is very different.

Example: there is individual flow control of responses in HTTP/2. =
Clients do small window sizes on images, like 64KB in order to get small =
images completely or only the meta data of large ones. For these large =
files, the client does not send flow-control updates until it has =
received all other
resources it is interested in. *Then* it tells the server to go ahead =
and send the rest of these images.

This means a file bucket for such images will hang around for an =
indefinite amount of time and a filter cannot say, "Oh, I have n file =
buckets queued, let's block write them first before I accept more." The =
server cannot do that.

I certainly do not want to reinvent the wheel here and I am very glad =
about any existing solution and getting told how to use them. But please =
try to understand the specific problems before saying "we must have =
already a solution for that, go find it. you will see..."

//Stefan



From dev-return-84408-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Thu Oct 22 15:57:03 2015
Return-Path: <dev-return-84408-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id EDD4C1051C
	for <apmail-httpd-dev-archive@www.apache.org>; Thu, 22 Oct 2015 15:57:03 +0000 (UTC)
Received: (qmail 89292 invoked by uid 500); 22 Oct 2015 15:57:03 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 89208 invoked by uid 500); 22 Oct 2015 15:57:03 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 89198 invoked by uid 99); 22 Oct 2015 15:57:03 -0000
Received: from Unknown (HELO spamd4-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 22 Oct 2015 15:57:03 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd4-us-west.apache.org (ASF Mail Server at spamd4-us-west.apache.org) with ESMTP id D9088C0EDB
	for <dev@httpd.apache.org>; Thu, 22 Oct 2015 15:57:02 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd4-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.11
X-Spam-Level:
X-Spam-Status: No, score=-0.11 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	SPF_PASS=-0.001, T_RP_MATCHES_RCVD=-0.01, URIBL_BLOCKED=0.001]
	autolearn=disabled
Authentication-Results: spamd4-us-west.apache.org (amavisd-new);
	dkim=pass (1024-bit key) header.d=ptc.com
Received: from mx1-us-west.apache.org ([10.40.0.8])
	by localhost (spamd4-us-west.apache.org [10.40.0.11]) (amavisd-new, port 10024)
	with ESMTP id VW_kmEWIJa_G for <dev@httpd.apache.org>;
	Thu, 22 Oct 2015 15:56:55 +0000 (UTC)
Received: from mx1.ptc.com (mx1.ptc.com [12.11.148.188])
	by mx1-us-west.apache.org (ASF Mail Server at mx1-us-west.apache.org) with ESMTPS id B18D321651
	for <dev@httpd.apache.org>; Thu, 22 Oct 2015 15:56:54 +0000 (UTC)
DKIM-Signature: v=1; a=rsa-sha256; c=simple/simple;
  d=ptc.com; s=ptc; t=1445529414; x=1477065414;
  h=subject:to:references:from:message-id:date:mime-version:
   in-reply-to:content-transfer-encoding;
  bh=0NNRVmB2egjjyFW3t41ZJQKKk+slzRl3WjcmFtAwPQI=;
  b=a97swMNp6n21ePa8wQYhCMePLsHkyFEESG0hNa3HixJ7Sx4b1uVNc2ck
   RTyBpgcHrLjprfRQaPvsGjPoU0M86zvM863k6ECPPZmYtOjfu1V58sU3X
   uCR84ufTFvXUvv50Yj218Ls9VAxKXWHhe1BqSVzvsGeSoAabTBFAFkY2o
   E=;
X-IronPort-AV: E=Sophos;i="5.20,183,1444708800"; 
   d="scan'208";a="118854458"
Received: from hq-x10prdhub1.ptcnet.ptc.com ([132.253.198.27])
  by mx1-int.ptc.com with ESMTP/TLS/AES128-SHA; 22 Oct 2015 11:56:53 -0400
Received: from awang.ptcnet.ptc.com (132.253.8.73) by
 int-mail-hub1.ptcnet.ptc.com (132.253.201.252) with Microsoft SMTP Server id
 14.3.123.3; Thu, 22 Oct 2015 11:56:53 -0400
Subject: Re: [users@httpd] Chunked transfer delay with httpd 2.4 on Windows.
To: <dev@httpd.apache.org>
References: <5625642E.30708@ptc.com>
 <CAKQ1sVNHz_aCLZ3um-NV8cJGnhR3FtE6wz+zGgusvW=MA+cO_A@mail.gmail.com>
 <CAKQ1sVO_E2AZBL9CPfpm=_RQEnHWRDWNg67NFKCqy-vC=uoJBw@mail.gmail.com>
 <562668DA.5060804@ptc.com> <56269CBD.5060701@ptc.com>
 <5627853C.4040006@apache.org>
 <CAKQ1sVORFAFNwxw92Xfxhd9pGs3vCgHgoA3SCty29BbvHoPeSQ@mail.gmail.com>
 <AB1691BE05AE7F4992697F2A0835627AC634A1A9@VOEXM10W.internal.vodafone.com>
 <CAKQ1sVNpfUzE5ubnHJVa2h-_y45nDSbXS8XbOZJp3x7HFaMb9Q@mail.gmail.com>
 <AB1691BE05AE7F4992697F2A0835627AC634A1E6@VOEXM10W.internal.vodafone.com>
 <CAKQ1sVP2jv3q-A8JH977Qtkr+jwb4WjJOo0CdPhGdVv5BmcbKw@mail.gmail.com>
 <5627A72B.7050302@ptc.com> <5627A8E4.4010108@ptc.com>
 <5628E7A9.2060708@ptc.com>
 <CACsi253Gt9=E-rqoFyR25S9gfFp5t6ORw=pjjjuRz6cwALE+KQ@mail.gmail.com>
 <5628F832.7020203@ptc.com>
 <CAKQ1sVPbx6Awyi_w_C=MSNop+SeQxsQDRSdEmLmZj7JMq2QL_g@mail.gmail.com>
 <56290162.90406@ptc.com> <4EC9C289-E218-4ADE-93D8-41F0CAD802BC@sharp.fm>
 <56290628.60601@ptc.com>
From: Andy Wang <awang@ptc.com>
Message-ID: <56290744.2000307@ptc.com>
Date: Thu, 22 Oct 2015 10:56:52 -0500
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:38.0) Gecko/20100101
 Thunderbird/38.3.0
MIME-Version: 1.0
In-Reply-To: <56290628.60601@ptc.com>
Content-Type: text/plain; charset="utf-8"; format=flowed
Content-Transfer-Encoding: 8bit
X-Originating-IP: [132.253.8.73]



On 10/22/2015 10:52 AM, Andy Wang wrote:
>
>
> On 10/22/2015 10:38 AM, Graham Leggett wrote:
>> On 22 Oct 2015, at 5:31 PM, Andy Wang <awang@ptc.com> wrote:
>>
>>> I already had to do that.  We have this weird scenario where when our
>>> installer installs httpd, httpd hangs.  Packet captures show the
>>> request arriving but no ACK or any form of response.
>>>
>>> If I kill the installer process, the problem goes away.  I have no
>>> idea how or why that could possibly occur, but Acceptfilter http none
>>> resolves that issue.
>>
>> Sounds like a request that the http accept filter doesn’t believe is
>> complete?
>>
>> Could be an RFC violation on the client side.
>>
>
> I'm not sure how that's possible.  The TCP stack doesn't even respond to
> the initial SYN.
>
> As soon as we kill the installer process, httpd starts to respond.
>

Oh wait, my bad.
I'm getting problems confused in my head.

The request is to the best of my research complete.

The TCP handshake occurs, but there is no GET response.

Also, used processexplorer to look at the process threads and it shows 
no activity on the threads, and mod_dumpio shows nothing coming in at all.

Even if it was a bad request on the client side, I'd have expected 
something to show up on the httpd side.

As soon as we kill the installer's java.exe process (installanywhere 
installer) httpd starts to respond.'

Andy

From dev-return-84409-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Thu Oct 22 16:03:39 2015
Return-Path: <dev-return-84409-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 4A2721059C
	for <apmail-httpd-dev-archive@www.apache.org>; Thu, 22 Oct 2015 16:03:39 +0000 (UTC)
Received: (qmail 14108 invoked by uid 500); 22 Oct 2015 16:03:38 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 14038 invoked by uid 500); 22 Oct 2015 16:03:38 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 14028 invoked by uid 99); 22 Oct 2015 16:03:38 -0000
Received: from Unknown (HELO spamd2-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 22 Oct 2015 16:03:38 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd2-us-west.apache.org (ASF Mail Server at spamd2-us-west.apache.org) with ESMTP id 5C8761A24D8
	for <dev@httpd.apache.org>; Thu, 22 Oct 2015 16:03:38 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd2-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.109
X-Spam-Level:
X-Spam-Status: No, score=-0.109 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	T_RP_MATCHES_RCVD=-0.01, URIBL_BLOCKED=0.001] autolearn=disabled
Authentication-Results: spamd2-us-west.apache.org (amavisd-new);
	dkim=pass (1024-bit key) header.d=greenbytes.de
Received: from mx1-us-west.apache.org ([10.40.0.8])
	by localhost (spamd2-us-west.apache.org [10.40.0.9]) (amavisd-new, port 10024)
	with ESMTP id oFH-ZF0duvHc for <dev@httpd.apache.org>;
	Thu, 22 Oct 2015 16:03:29 +0000 (UTC)
Received: from mail.greenbytes.de (mail.greenbytes.de [217.91.35.233])
	by mx1-us-west.apache.org (ASF Mail Server at mx1-us-west.apache.org) with ESMTPS id A1ADC20751
	for <dev@httpd.apache.org>; Thu, 22 Oct 2015 16:03:28 +0000 (UTC)
Received: from [192.168.1.42] (unknown [217.91.35.233])
	(using TLSv1 with cipher ECDHE-RSA-AES256-SHA (256/256 bits))
	(Client did not present a certificate)
	by mail.greenbytes.de (Postfix) with ESMTPSA id DA7C715A0485
	for <dev@httpd.apache.org>; Thu, 22 Oct 2015 18:03:26 +0200 (CEST)
DKIM-Signature: v=1; a=rsa-sha256; c=simple/simple; d=greenbytes.de; s=mail;
	t=1445529806; bh=xPrqRxZBin9wJgsvidhme7C7TBdqDzq1nKcwIVIv88w=;
	h=Subject:From:In-Reply-To:Date:References:To:From;
	b=ZE5UMKmr5PW1LfYG7ZwqdrfYWe5plsoPgEl9ir1+wzqdvnWohmBpC2Kxw0+Myjq6B
	 8RN51jfIUWA3X3fH1V8QcEVk4EzHV5nwQnOmfrGCQYDowWp0mH3c7Ox747hO1yu3u0
	 7KoezjKq5x2BEqexhQeHAV4yFyMJZxddPTXkgSMA=
Content-Type: text/plain; charset=utf-8
Mime-Version: 1.0 (Mac OS X Mail 9.1 \(3096.5\))
Subject: Re: buckets and connections (long post)
From: Stefan Eissing <stefan.eissing@greenbytes.de>
In-Reply-To: <8C00B305-BECC-4A48-9A03-8A7CA99EADE4@sharp.fm>
Date: Thu, 22 Oct 2015 18:03:26 +0200
Content-Transfer-Encoding: quoted-printable
Message-Id: <8642583F-79A4-4A8D-A7CF-43CD79029673@greenbytes.de>
References: <CAKQ1sVNchFx=egp=Q0tgT+1GcBXiten8mh9STetcZXOfJxhsjQ@mail.gmail.com> <CAKQ1sVPjcA9EYNpjcmM9=AU_LCgAsFntOcZnmGoHymds3S5wmA@mail.gmail.com> <AB1691BE05AE7F4992697F2A0835627AC6348972@VOEXM10W.internal.vodafone.com> <7B24F4D1-6904-4C00-A337-88F712026BE9@greenbytes.de> <0D5B13DA-8642-4662-9606-6B5DF94EB87B@sharp.fm> <D70FBC43-2E52-4BDD-ADA5-88623657CBEC@jaguNET.com> <4D37F1D6-E2FB-408B-9D82-9F7ABABFFE1E@greenbytes.de> <8C00B305-BECC-4A48-9A03-8A7CA99EADE4@sharp.fm>
To: dev@httpd.apache.org
X-Mailer: Apple Mail (2.3096.5)


> Am 21.10.2015 um 16:48 schrieb Graham Leggett <minfrin@sharp.fm>:
>=20
> On 21 Oct 2015, at 4:18 PM, Stefan Eissing =
<stefan.eissing@greenbytes.de> wrote:
>> 6. pool buckets are very tricky to optimize, as pool creation/destroy =
is not thread-safe in general
>>  and it depends on how the parent pools and their allocators are set =
up.=20
>>  Early hopes get easily crushed under load.
>=20
> As soon as I see =E2=80=9Cbuckets aren=E2=80=99t thread safe=E2=80=9D =
I read it as =E2=80=9Cbuckets are being misused=E2=80=9D or =E2=80=9Cpool =
lifetimes are being mixed up".
>=20
> Buckets arise from allocators, and you must never try add a bucket =
from one allocator into a brigade sourced from another allocator. For =
example, if you have a bucket allocated from the slave connection, you =
need to copy it into a different bucket allocated from the master =
connection before trying to add it to a master brigade.
>=20
> Buckets are also allocated from pools, and pools have different =
lifetimes depending on what they were created for. If you allocate a =
bucket from the request pool, that bucket will vanish when the request =
pool is destroyed. Buckets can be passed from one pool to another, that =
is what =E2=80=9Csetaside=E2=80=9D means.
>=20
> It is really important to get the pool lifetimes right. Allocate =
something accidentally from the master connection pool on a slave =
connection and it appears to work, because generally the master outlives =
the slave. Until the master is cleaned up first, and suddenly memory =
vanishes unexpectedly in the slave connections - and you crash.
>=20
> There were a number of subtle bugs in the proxy where buckets had been =
allocated from the wrong pool, and all sorts of weirdness ensued. Make =
sure your pool lifetimes are allocated correctly and it will work.

This is all true and correct - as long as all this happens in a single =
thread. If you have multiple threads and create sub pools for each from =
a main pool, each and every create and destroy of these sub-pools, plus =
any action on the main pool must be mutex protected. I found out.=20

Similar with buckets. When you create a bucket in one thread, you may =
not destroy it in another - *while* the bucket_allocator is being used. =
bucket_allocators are not thread-safe, which means bucket_brigades are =
not, which means that all buckets from the same brigade must only be =
used inside a single thread.

This means for example that, even though mod_http2 manages the pool =
lifetime correctly, it cannot pass a response bucket from a request pool =
in thread A for writing onto the  main connection in thread B, *as long =
as* the response is not complete and thread A is still producing more =
buckets with the same allocator. etc. etc.

That is what I mean with not-thread-safe.

//Stefan=

From dev-return-84410-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Thu Oct 22 16:04:54 2015
Return-Path: <dev-return-84410-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id CF2F7105B1
	for <apmail-httpd-dev-archive@www.apache.org>; Thu, 22 Oct 2015 16:04:54 +0000 (UTC)
Received: (qmail 20432 invoked by uid 500); 22 Oct 2015 16:04:54 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 20341 invoked by uid 500); 22 Oct 2015 16:04:54 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 20331 invoked by uid 99); 22 Oct 2015 16:04:54 -0000
Received: from Unknown (HELO spamd1-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 22 Oct 2015 16:04:54 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd1-us-west.apache.org (ASF Mail Server at spamd1-us-west.apache.org) with ESMTP id E0F22C4B83
	for <dev@httpd.apache.org>; Thu, 22 Oct 2015 16:04:53 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd1-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.099
X-Spam-Level:
X-Spam-Status: No, score=-0.099 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RP_MATCHES_RCVD=0.001, SPF_PASS=-0.001, URIBL_BLOCKED=0.001]
	autolearn=disabled
Authentication-Results: spamd1-us-west.apache.org (amavisd-new);
	dkim=pass (1024-bit key) header.d=greenbytes.de
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd1-us-west.apache.org [10.40.0.7]) (amavisd-new, port 10024)
	with ESMTP id XNUG-XbQ_juI for <dev@httpd.apache.org>;
	Thu, 22 Oct 2015 16:04:44 +0000 (UTC)
Received: from mail.greenbytes.de (mail.greenbytes.de [217.91.35.233])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id D428042B35
	for <dev@httpd.apache.org>; Thu, 22 Oct 2015 16:04:43 +0000 (UTC)
Received: from [192.168.1.42] (unknown [217.91.35.233])
	(using TLSv1 with cipher ECDHE-RSA-AES256-SHA (256/256 bits))
	(Client did not present a certificate)
	by mail.greenbytes.de (Postfix) with ESMTPSA id 3514715A0485
	for <dev@httpd.apache.org>; Thu, 22 Oct 2015 18:04:36 +0200 (CEST)
DKIM-Signature: v=1; a=rsa-sha256; c=simple/simple; d=greenbytes.de; s=mail;
	t=1445529876; bh=xqrKJYlmrUrL4pLYs/MUxDGd2Y0REWm5I8oRkbD5Wb0=;
	h=Subject:From:In-Reply-To:Date:References:To:From;
	b=slzZcQyVEvG+JSzWOJ7bF86ukJyONKJKBDV/+rV8dlWl9Jgemd06OJymFqhjSum4H
	 +nVU8B8xrRwsGZRs5UY82t5WlXEnjnsEtXuCURBdXVHqUD9O930Ty+lgZUk15e4B2G
	 dWCgC78WnF9u02L7quQeo8WZlo2hKj8gArTP15IQ=
Content-Type: text/plain; charset=utf-8
Mime-Version: 1.0 (Mac OS X Mail 9.1 \(3096.5\))
Subject: Re: buckets and connections (long post)
From: Stefan Eissing <stefan.eissing@greenbytes.de>
In-Reply-To: <8C00B305-BECC-4A48-9A03-8A7CA99EADE4@sharp.fm>
Date: Thu, 22 Oct 2015 18:04:35 +0200
Content-Transfer-Encoding: quoted-printable
Message-Id: <A2EBFA42-EB17-4201-B488-65042C158D35@greenbytes.de>
References: <CAKQ1sVNchFx=egp=Q0tgT+1GcBXiten8mh9STetcZXOfJxhsjQ@mail.gmail.com> <CAKQ1sVPjcA9EYNpjcmM9=AU_LCgAsFntOcZnmGoHymds3S5wmA@mail.gmail.com> <AB1691BE05AE7F4992697F2A0835627AC6348972@VOEXM10W.internal.vodafone.com> <7B24F4D1-6904-4C00-A337-88F712026BE9@greenbytes.de> <0D5B13DA-8642-4662-9606-6B5DF94EB87B@sharp.fm> <D70FBC43-2E52-4BDD-ADA5-88623657CBEC@jaguNET.com> <4D37F1D6-E2FB-408B-9D82-9F7ABABFFE1E@greenbytes.de> <8C00B305-BECC-4A48-9A03-8A7CA99EADE4@sharp.fm>
To: dev@httpd.apache.org
X-Mailer: Apple Mail (2.3096.5)


> Am 21.10.2015 um 16:48 schrieb Graham Leggett <minfrin@sharp.fm>:
>=20
> On 21 Oct 2015, at 4:18 PM, Stefan Eissing =
<stefan.eissing@greenbytes.de> wrote:
>=20
>> 7. The buckets passed down on the master connection are using another =
buffer - when on https:// -
>>  to influence the SSL record sizes on write. Another COPY is not =
nice, but write performance
>>  is better this way. The ssl optimizations in place do not work for =
HTTP/2 as it has other
>>  bucket patterns. We should look if we can combine this into =
something without COPY, but with
>>  good sized SSL writes.
>=20
> mod_ssl already worries about buffering on it=E2=80=99s own, there is =
no need to recreate this functionality. Was this not working?

As I wrote "it has other bucket patterns", which do not get optimized by =
the coalescing filter of mod_ssl.

//Stefan=

From dev-return-84411-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Thu Oct 22 16:12:53 2015
Return-Path: <dev-return-84411-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 42FEE105FC
	for <apmail-httpd-dev-archive@www.apache.org>; Thu, 22 Oct 2015 16:12:53 +0000 (UTC)
Received: (qmail 46188 invoked by uid 500); 22 Oct 2015 16:12:52 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 46119 invoked by uid 500); 22 Oct 2015 16:12:52 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 46109 invoked by uid 99); 22 Oct 2015 16:12:52 -0000
Received: from Unknown (HELO spamd1-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 22 Oct 2015 16:12:52 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd1-us-west.apache.org (ASF Mail Server at spamd1-us-west.apache.org) with ESMTP id 57427C4ABE
	for <dev@httpd.apache.org>; Thu, 22 Oct 2015 16:12:52 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd1-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 0.001
X-Spam-Level:
X-Spam-Status: No, score=0.001 tagged_above=-999 required=6.31
	tests=[RP_MATCHES_RCVD=0.001, SPF_PASS=-0.001, URIBL_BLOCKED=0.001]
	autolearn=disabled
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd1-us-west.apache.org [10.40.0.7]) (amavisd-new, port 10024)
	with ESMTP id juYYw8RYJROf for <dev@httpd.apache.org>;
	Thu, 22 Oct 2015 16:12:43 +0000 (UTC)
Received: from monica.sharp.fm (monica.sharp.fm [80.168.143.5])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTP id EC4CE20751
	for <dev@httpd.apache.org>; Thu, 22 Oct 2015 16:12:42 +0000 (UTC)
Received: from [10.40.76.36] (unknown [31.55.13.171])
	(using TLSv1 with cipher DHE-RSA-AES256-SHA (256/256 bits))
	(Client did not present a certificate)
	(Authenticated sender: minfrin@sharp.fm)
	by monica.sharp.fm (Postfix) with ESMTPSA id 6F4BC80546
	for <dev@httpd.apache.org>; Thu, 22 Oct 2015 17:12:35 +0100 (BST)
Content-Type: text/plain; charset=utf-8
Mime-Version: 1.0 (Mac OS X Mail 8.2 \(2104\))
Subject: Re: buckets and connections (long post)
From: Graham Leggett <minfrin@sharp.fm>
In-Reply-To: <8A016E53-0A95-4766-83FC-00113405AFA2@greenbytes.de>
Date: Thu, 22 Oct 2015 18:12:23 +0200
Content-Transfer-Encoding: quoted-printable
Message-Id: <9A04E9CE-C600-43C7-8A81-1927EBE8C9F2@sharp.fm>
References: <CAKQ1sVNchFx=egp=Q0tgT+1GcBXiten8mh9STetcZXOfJxhsjQ@mail.gmail.com> <CAKQ1sVPjcA9EYNpjcmM9=AU_LCgAsFntOcZnmGoHymds3S5wmA@mail.gmail.com> <AB1691BE05AE7F4992697F2A0835627AC6348972@VOEXM10W.internal.vodafone.com> <7B24F4D1-6904-4C00-A337-88F712026BE9@greenbytes.de> <0D5B13DA-8642-4662-9606-6B5DF94EB87B@sharp.fm> <D70FBC43-2E52-4BDD-ADA5-88623657CBEC@jaguNET.com> <4D37F1D6-E2FB-408B-9D82-9F7ABABFFE1E@greenbytes.de> <8C00B305-BECC-4A48-9A03-8A7CA99EADE4@sharp.fm> <8A016E53-0A95-4766-83FC-00113405AFA2@greenbytes.de>
To: dev@httpd.apache.org
X-Mailer: Apple Mail (2.2104)

On 22 Oct 2015, at 5:43 PM, Stefan Eissing =
<stefan.eissing@greenbytes.de> wrote:

>> The blocking read breaks the spirit of the event MPM.
>>=20
>> In theory, as long as you enter the write completion state and then =
not leave until your connection is done, this problem will go away.
>>=20
>> If you want to read instead of write, make sure the =
CONN_SENSE_WANT_READ option is set on the connection.
>=20
> This does not parse. I do not understand what you are talking about.=20=

>=20
> When all streams have been passed into the output filters, the =
mod_http2 session does a=20
>=20
>    status =3D ap_get_brigade(io->connection->input_filters,...)  =
(h2_conn_io.c, line 160)
>=20
> similar to what ap_read_request() -> ap_rgetline_core() does. =
(protocol.c, line 236)
>=20
> What should mod_http2 do different here?

What ap_read_request does is:

- a) read the request (parse)
- b) handle the request (make decisions on what to do, internally =
redirect, rewrite, etc etc)
- c) exit, and let the MPM complete the request in the write_completion =
phase.

What you want to do is move the request completion into a filter, like =
mod_cache does. You start by setting up your request, you parse headers, =
you do the HTTP2 equivalent of ap_read_request(), then you do the actual =
work inside a filter. Look at the CACHE_OUT and CACHE_SAVE filters as =
examples.

To be more specific, in the handler that detects HTTP/2 you add a filter =
that processes the data, then write an EOS bucket to kick off the =
process and leave. The filter takes over.

The reason for this is you want to escape the handler phase as soon as =
possible, and leave the MPM to do it=E2=80=99s work.

Regards,
Graham
=E2=80=94




From dev-return-84412-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Thu Oct 22 16:26:58 2015
Return-Path: <dev-return-84412-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 3978F106D7
	for <apmail-httpd-dev-archive@www.apache.org>; Thu, 22 Oct 2015 16:26:58 +0000 (UTC)
Received: (qmail 94463 invoked by uid 500); 22 Oct 2015 16:26:52 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 94404 invoked by uid 500); 22 Oct 2015 16:26:52 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 94394 invoked by uid 99); 22 Oct 2015 16:26:52 -0000
Received: from Unknown (HELO spamd1-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 22 Oct 2015 16:26:52 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd1-us-west.apache.org (ASF Mail Server at spamd1-us-west.apache.org) with ESMTP id 2C029C4ABA
	for <dev@httpd.apache.org>; Thu, 22 Oct 2015 16:26:52 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd1-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 0.002
X-Spam-Level:
X-Spam-Status: No, score=0.002 tagged_above=-999 required=6.31
	tests=[RP_MATCHES_RCVD=0.001, URIBL_BLOCKED=0.001] autolearn=disabled
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd1-us-west.apache.org [10.40.0.7]) (amavisd-new, port 10024)
	with ESMTP id KjzX1eSsZzu7 for <dev@httpd.apache.org>;
	Thu, 22 Oct 2015 16:26:44 +0000 (UTC)
Received: from monica.sharp.fm (monica.sharp.fm [80.168.143.5])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTP id B3FB325465
	for <dev@httpd.apache.org>; Thu, 22 Oct 2015 16:26:43 +0000 (UTC)
Received: from [10.40.76.36] (unknown [31.55.13.171])
	(using TLSv1 with cipher DHE-RSA-AES256-SHA (256/256 bits))
	(Client did not present a certificate)
	(Authenticated sender: minfrin@sharp.fm)
	by monica.sharp.fm (Postfix) with ESMTPSA id 9747F80546
	for <dev@httpd.apache.org>; Thu, 22 Oct 2015 17:26:31 +0100 (BST)
Content-Type: text/plain; charset=utf-8
Mime-Version: 1.0 (Mac OS X Mail 8.2 \(2104\))
Subject: Re: buckets and connections (long post)
From: Graham Leggett <minfrin@sharp.fm>
In-Reply-To: <B9FD7DE7-1362-4AA2-BCB9-97BA2A3FADB1@greenbytes.de>
Date: Thu, 22 Oct 2015 18:26:23 +0200
Content-Transfer-Encoding: quoted-printable
Message-Id: <204F3ED5-9786-4339-B9B0-3B860D147AB4@sharp.fm>
References: <CAKQ1sVNchFx=egp=Q0tgT+1GcBXiten8mh9STetcZXOfJxhsjQ@mail.gmail.com> <CAKQ1sVPjcA9EYNpjcmM9=AU_LCgAsFntOcZnmGoHymds3S5wmA@mail.gmail.com> <AB1691BE05AE7F4992697F2A0835627AC6348972@VOEXM10W.internal.vodafone.com> <7B24F4D1-6904-4C00-A337-88F712026BE9@greenbytes.de> <0D5B13DA-8642-4662-9606-6B5DF94EB87B@sharp.fm> <D70FBC43-2E52-4BDD-ADA5-88623657CBEC@jaguNET.com> <4D37F1D6-E2FB-408B-9D82-9F7ABABFFE1E@greenbytes.de> <8C00B305-BECC-4A48-9A03-8A7CA99EADE4@sharp.fm> <B9FD7DE7-1362-4AA2-BCB9-97BA2A3FADB1@greenbytes.de>
To: dev@httpd.apache.org
X-Mailer: Apple Mail (2.2104)

On 22 Oct 2015, at 5:55 PM, Stefan Eissing =
<stefan.eissing@greenbytes.de> wrote:

>> With the async filters this flow control is now made available to =
every filter in the ap_filter_setaside_brigade() function. When =
mod_http2 handles async filters you=E2=80=99ll get this flow control for =
free.
>=20
> No, it will not. The processing of responses is very different.
>=20
> Example: there is individual flow control of responses in HTTP/2. =
Clients do small window sizes on images, like 64KB in order to get small =
images completely or only the meta data of large ones. For these large =
files, the client does not send flow-control updates until it has =
received all other
> resources it is interested in. *Then* it tells the server to go ahead =
and send the rest of these images.
>=20
> This means a file bucket for such images will hang around for an =
indefinite amount of time and a filter cannot say, "Oh, I have n file =
buckets queued, let's block write them first before I accept more." The =
server cannot do that.

What you=E2=80=99re describing is a DoS.

A client can=E2=80=99t tie up resources for an arbitrary amount of time, =
the server needs to be under control of this. If a client wants part of =
a file, the server needs to open the file, send the part, then close the =
file and be done. If the client wants more, then the server opens up the =
file again, sends more, and then is done.

> I certainly do not want to reinvent the wheel here and I am very glad =
about any existing solution and getting told how to use them. But please =
try to understand the specific problems before saying "we must have =
already a solution for that, go find it. you will see=E2=80=A6"

The http2 code needs to fit in with the code that is already there, and =
most importantly it needs to ensure it doesn=E2=80=99t clash with the =
existing mechanisms. If an existing mechanism isn=E2=80=99t enough, it =
can be extended, but they must not be bypassed.

The mechanism in the core keeps track of the number of file buckets, =
in-memory buckets and requests =E2=80=9Cin flight=E2=80=9D, and then =
blocks if this gets too high. Rather block and live to fight another day =
than try an open too many files and get spurious failures as you run out =
of file descriptors.

The async filters gives you the ap_filter_should_yield() function that =
will tell you if downstream is too full and you should hold off sending =
more data. For example, don=E2=80=99t accept another request if you=E2=80=99=
ve already got too many requests in flight.

Regards,
Graham
=E2=80=94


From dev-return-84413-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Thu Oct 22 16:44:55 2015
Return-Path: <dev-return-84413-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 1095210974
	for <apmail-httpd-dev-archive@www.apache.org>; Thu, 22 Oct 2015 16:44:55 +0000 (UTC)
Received: (qmail 81726 invoked by uid 500); 22 Oct 2015 16:44:39 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 81656 invoked by uid 500); 22 Oct 2015 16:44:39 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 81645 invoked by uid 99); 22 Oct 2015 16:44:39 -0000
Received: from Unknown (HELO spamd3-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 22 Oct 2015 16:44:39 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd3-us-west.apache.org (ASF Mail Server at spamd3-us-west.apache.org) with ESMTP id 850A4180992
	for <dev@httpd.apache.org>; Thu, 22 Oct 2015 16:44:38 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd3-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.01
X-Spam-Level:
X-Spam-Status: No, score=-0.01 tagged_above=-999 required=6.31
	tests=[SPF_PASS=-0.001, T_RP_MATCHES_RCVD=-0.01, URIBL_BLOCKED=0.001]
	autolearn=disabled
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd3-us-west.apache.org [10.40.0.10]) (amavisd-new, port 10024)
	with ESMTP id 4EFeSX0MRSa3 for <dev@httpd.apache.org>;
	Thu, 22 Oct 2015 16:44:30 +0000 (UTC)
Received: from monica.sharp.fm (monica.sharp.fm [80.168.143.5])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTP id 5A38A42B60
	for <dev@httpd.apache.org>; Thu, 22 Oct 2015 16:44:30 +0000 (UTC)
Received: from [10.40.76.36] (unknown [31.55.13.171])
	(using TLSv1 with cipher DHE-RSA-AES256-SHA (256/256 bits))
	(Client did not present a certificate)
	(Authenticated sender: minfrin@sharp.fm)
	by monica.sharp.fm (Postfix) with ESMTPSA id 5D37280546
	for <dev@httpd.apache.org>; Thu, 22 Oct 2015 17:44:24 +0100 (BST)
Content-Type: text/plain; charset=utf-8
Mime-Version: 1.0 (Mac OS X Mail 8.2 \(2104\))
Subject: Re: buckets and connections (long post)
From: Graham Leggett <minfrin@sharp.fm>
In-Reply-To: <8642583F-79A4-4A8D-A7CF-43CD79029673@greenbytes.de>
Date: Thu, 22 Oct 2015 18:44:19 +0200
Content-Transfer-Encoding: quoted-printable
Message-Id: <1088C2C9-EC73-4043-934E-B6B14F5DBBAE@sharp.fm>
References: <CAKQ1sVNchFx=egp=Q0tgT+1GcBXiten8mh9STetcZXOfJxhsjQ@mail.gmail.com> <CAKQ1sVPjcA9EYNpjcmM9=AU_LCgAsFntOcZnmGoHymds3S5wmA@mail.gmail.com> <AB1691BE05AE7F4992697F2A0835627AC6348972@VOEXM10W.internal.vodafone.com> <7B24F4D1-6904-4C00-A337-88F712026BE9@greenbytes.de> <0D5B13DA-8642-4662-9606-6B5DF94EB87B@sharp.fm> <D70FBC43-2E52-4BDD-ADA5-88623657CBEC@jaguNET.com> <4D37F1D6-E2FB-408B-9D82-9F7ABABFFE1E@greenbytes.de> <8C00B305-BECC-4A48-9A03-8A7CA99EADE4@sharp.fm> <8642583F-79A4-4A8D-A7CF-43CD79029673@greenbytes.de>
To: dev@httpd.apache.org
X-Mailer: Apple Mail (2.2104)

On 22 Oct 2015, at 6:03 PM, Stefan Eissing =
<stefan.eissing@greenbytes.de> wrote:

> This is all true and correct - as long as all this happens in a single =
thread. If you have multiple threads and create sub pools for each from =
a main pool, each and every create and destroy of these sub-pools, plus =
any action on the main pool must be mutex protected. I found out.=20

Normally if you=E2=80=99ve created a thread from a main pool, you need =
to create a pool cleanup for that thread off the main pool that is =
registered with apr_pool_pre_cleanup_register(). In this cleanup, you =
signal the thread to shut down gracefully and then apr_thread_join to =
wait for the thread to shut down, then the rest of the pool can be =
cleaned up.

The =E2=80=9Cpre=E2=80=9D is key to this - the cleanup must run before =
the subpool is cleared.

> Similar with buckets. When you create a bucket in one thread, you may =
not destroy it in another - *while* the bucket_allocator is being used. =
bucket_allocators are not thread-safe, which means bucket_brigades are =
not, which means that all buckets from the same brigade must only be =
used inside a single thread.

=E2=80=9C=E2=80=A6inside a single thread at a time=E2=80=9D.

The event MPM is an example of this in action.

A connection is handled by an arbitrary thread until that connection =
must poll. At that point it goes back into the pool of connections, and =
when ready is given to another arbitrary thread. In this case the =
threads are handled =E2=80=9Cabove=E2=80=9D the connections, so the =
destruction of a connection doesn=E2=80=99t impact a thread.

> This means for example that, even though mod_http2 manages the pool =
lifetime correctly, it cannot pass a response bucket from a request pool =
in thread A for writing onto the  main connection in thread B, *as long =
as* the response is not complete and thread A is still producing more =
buckets with the same allocator. etc. etc.
>=20
> That is what I mean with not-thread-safe.

In this case you have different allocators, and so must pass the buckets =
over.

Remember that being lock free is a feature, not a bug. As soon as you =
add mutexes you add delay and slow everything down, because the world =
must stop until the condition is fulfilled.

A more efficient way of handling this is to use some kind of IPC so that =
the requests signal the master connection and go =E2=80=9CI=E2=80=99ve =
got data for you=E2=80=9D, after which the requests don=E2=80=99t touch =
that data until the master has said =E2=80=9CI;ve got it, feel free to =
send more=E2=80=9D. That IPC could be a series of mutexes, or a socket =
of some kind. Anything that gets rid of a global lock.

That doesn=E2=80=99t mean request processing must stop dead, that =
request just gets put aside and that thread is free to work on another =
request.

I=E2=80=99m basically describing the event MPM.

Regards,
Graham
=E2=80=94


From dev-return-84414-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Thu Oct 22 16:45:22 2015
Return-Path: <dev-return-84414-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 4F1B21097E
	for <apmail-httpd-dev-archive@www.apache.org>; Thu, 22 Oct 2015 16:45:22 +0000 (UTC)
Received: (qmail 87637 invoked by uid 500); 22 Oct 2015 16:45:21 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 87554 invoked by uid 500); 22 Oct 2015 16:45:21 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 87540 invoked by uid 99); 22 Oct 2015 16:45:21 -0000
Received: from Unknown (HELO spamd4-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 22 Oct 2015 16:45:21 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd4-us-west.apache.org (ASF Mail Server at spamd4-us-west.apache.org) with ESMTP id 64626C00B1
	for <dev@httpd.apache.org>; Thu, 22 Oct 2015 16:45:21 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd4-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.01
X-Spam-Level:
X-Spam-Status: No, score=-0.01 tagged_above=-999 required=6.31
	tests=[SPF_PASS=-0.001, T_RP_MATCHES_RCVD=-0.01, URIBL_BLOCKED=0.001]
	autolearn=disabled
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd4-us-west.apache.org [10.40.0.11]) (amavisd-new, port 10024)
	with ESMTP id Z9f-1E1CA3a7 for <dev@httpd.apache.org>;
	Thu, 22 Oct 2015 16:45:16 +0000 (UTC)
Received: from monica.sharp.fm (monica.sharp.fm [80.168.143.5])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTP id 2FD2325465
	for <dev@httpd.apache.org>; Thu, 22 Oct 2015 16:45:16 +0000 (UTC)
Received: from [10.40.76.36] (unknown [31.55.13.171])
	(using TLSv1 with cipher DHE-RSA-AES256-SHA (256/256 bits))
	(Client did not present a certificate)
	(Authenticated sender: minfrin@sharp.fm)
	by monica.sharp.fm (Postfix) with ESMTPSA id B34EE80546
	for <dev@httpd.apache.org>; Thu, 22 Oct 2015 17:45:11 +0100 (BST)
Content-Type: text/plain; charset=utf-8
Mime-Version: 1.0 (Mac OS X Mail 8.2 \(2104\))
Subject: Re: buckets and connections (long post)
From: Graham Leggett <minfrin@sharp.fm>
In-Reply-To: <A2EBFA42-EB17-4201-B488-65042C158D35@greenbytes.de>
Date: Thu, 22 Oct 2015 18:45:10 +0200
Content-Transfer-Encoding: quoted-printable
Message-Id: <AF66053C-1B16-4728-B566-915A4119843D@sharp.fm>
References: <CAKQ1sVNchFx=egp=Q0tgT+1GcBXiten8mh9STetcZXOfJxhsjQ@mail.gmail.com> <CAKQ1sVPjcA9EYNpjcmM9=AU_LCgAsFntOcZnmGoHymds3S5wmA@mail.gmail.com> <AB1691BE05AE7F4992697F2A0835627AC6348972@VOEXM10W.internal.vodafone.com> <7B24F4D1-6904-4C00-A337-88F712026BE9@greenbytes.de> <0D5B13DA-8642-4662-9606-6B5DF94EB87B@sharp.fm> <D70FBC43-2E52-4BDD-ADA5-88623657CBEC@jaguNET.com> <4D37F1D6-E2FB-408B-9D82-9F7ABABFFE1E@greenbytes.de> <8C00B305-BECC-4A48-9A03-8A7CA99EADE4@sharp.fm> <A2EBFA42-EB17-4201-B488-65042C158D35@greenbytes.de>
To: dev@httpd.apache.org
X-Mailer: Apple Mail (2.2104)

On 22 Oct 2015, at 6:04 PM, Stefan Eissing =
<stefan.eissing@greenbytes.de> wrote:

>> mod_ssl already worries about buffering on it=E2=80=99s own, there is =
no need to recreate this functionality. Was this not working?
>=20
> As I wrote "it has other bucket patterns", which do not get optimized =
by the coalescing filter of mod_ssl.

Then we must fix the coalescing filter in mod_ssl.

Regards,
Graham
=E2=80=94


From dev-return-84415-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Thu Oct 22 17:30:03 2015
Return-Path: <dev-return-84415-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id CF3B810C3D
	for <apmail-httpd-dev-archive@www.apache.org>; Thu, 22 Oct 2015 17:30:03 +0000 (UTC)
Received: (qmail 37906 invoked by uid 500); 22 Oct 2015 17:30:03 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 37839 invoked by uid 500); 22 Oct 2015 17:30:03 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 37829 invoked by uid 99); 22 Oct 2015 17:30:03 -0000
Received: from Unknown (HELO spamd3-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 22 Oct 2015 17:30:03 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd3-us-west.apache.org (ASF Mail Server at spamd3-us-west.apache.org) with ESMTP id D1D6018027C
	for <dev@httpd.apache.org>; Thu, 22 Oct 2015 17:30:02 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd3-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.111
X-Spam-Level:
X-Spam-Status: No, score=-0.111 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	SPF_PASS=-0.001, T_RP_MATCHES_RCVD=-0.01] autolearn=disabled
Authentication-Results: spamd3-us-west.apache.org (amavisd-new);
	dkim=pass (1024-bit key) header.d=ptc.com
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd3-us-west.apache.org [10.40.0.10]) (amavisd-new, port 10024)
	with ESMTP id px_UT63_jKyN for <dev@httpd.apache.org>;
	Thu, 22 Oct 2015 17:29:56 +0000 (UTC)
Received: from mx2.ptc.com (mx2.ptc.com [12.11.148.189])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id 560192770F
	for <dev@httpd.apache.org>; Thu, 22 Oct 2015 17:29:54 +0000 (UTC)
DKIM-Signature: v=1; a=rsa-sha256; c=simple/simple;
  d=ptc.com; s=ptc; t=1445534994; x=1477070994;
  h=subject:to:references:from:message-id:date:mime-version:
   in-reply-to:content-transfer-encoding;
  bh=ZZ+XtDjHeE9SNtVXc2g0AmIvXOlcwaKRbkx58g8+ZUQ=;
  b=BeI/0TPqi+Z7Ymk4zDucqHeNtwyFMzwJ/dtqBIrU6r4A10ZZwwzm5nKx
   GnQKrZWHwqW5qqKkhB1B3rSuw2h3XHYFdleGhcEYoPBeD2oP4z3bSN7x1
   FpRBHRrbbS0oQTLEqng2tyfEVVGdaqWrhPhdsYmZ3EN3Ao2wi6tyfXtQe
   w=;
X-IronPort-AV: E=Sophos;i="5.20,183,1444708800"; 
   d="scan'208";a="28571258"
Received: from hq-x10prdhub2.ptcnet.ptc.com ([132.253.198.28])
  by mx2-int.ptc.com with ESMTP/TLS/AES128-SHA; 22 Oct 2015 13:29:47 -0400
Received: from awang.ptcnet.ptc.com (132.253.8.73) by
 int-mail-hub2.ptcnet.ptc.com (132.253.201.252) with Microsoft SMTP Server id
 14.3.123.3; Thu, 22 Oct 2015 13:29:47 -0400
Subject: Re: [users@httpd] Chunked transfer delay with httpd 2.4 on Windows.
To: <dev@httpd.apache.org>
References: <5625642E.30708@ptc.com>
 <AB1691BE05AE7F4992697F2A0835627AC6348C38@VOEXM10W.internal.vodafone.com>
 <CAKQ1sVNHz_aCLZ3um-NV8cJGnhR3FtE6wz+zGgusvW=MA+cO_A@mail.gmail.com>
 <CAKQ1sVO_E2AZBL9CPfpm=_RQEnHWRDWNg67NFKCqy-vC=uoJBw@mail.gmail.com>
 <562668DA.5060804@ptc.com> <56269CBD.5060701@ptc.com>
 <5627853C.4040006@apache.org>
 <CAKQ1sVORFAFNwxw92Xfxhd9pGs3vCgHgoA3SCty29BbvHoPeSQ@mail.gmail.com>
 <AB1691BE05AE7F4992697F2A0835627AC634A1A9@VOEXM10W.internal.vodafone.com>
 <CAKQ1sVNpfUzE5ubnHJVa2h-_y45nDSbXS8XbOZJp3x7HFaMb9Q@mail.gmail.com>
 <AB1691BE05AE7F4992697F2A0835627AC634A1E6@VOEXM10W.internal.vodafone.com>
 <CAKQ1sVP2jv3q-A8JH977Qtkr+jwb4WjJOo0CdPhGdVv5BmcbKw@mail.gmail.com>
 <5627A72B.7050302@ptc.com> <5627A8E4.4010108@ptc.com>
 <5628E7A9.2060708@ptc.com>
 <CACsi253Gt9=E-rqoFyR25S9gfFp5t6ORw=pjjjuRz6cwALE+KQ@mail.gmail.com>
 <5628F832.7020203@ptc.com>
 <CAKQ1sVPbx6Awyi_w_C=MSNop+SeQxsQDRSdEmLmZj7JMq2QL_g@mail.gmail.com>
 <56290162.90406@ptc.com>
From: Andy Wang <awang@ptc.com>
Message-ID: <56291D0A.90400@ptc.com>
Date: Thu, 22 Oct 2015 12:29:46 -0500
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:38.0) Gecko/20100101
 Thunderbird/38.3.0
MIME-Version: 1.0
In-Reply-To: <56290162.90406@ptc.com>
Content-Type: text/plain; charset="utf-8"; format=flowed
Content-Transfer-Encoding: 7bit
X-Originating-IP: [132.253.8.73]



On 10/22/2015 10:31 AM, Andy Wang wrote:
>
>
> On 10/22/2015 10:06 AM, Yann Ylavic wrote:
>> Does it make a difference with "AcceptFilter http none" configured?
>> It shouldn't, but since we are in the x-files...
>
> I already had to do that.  We have this weird scenario where when our
> installer installs httpd, httpd hangs.  Packet captures show the request
> arriving but no ACK or any form of response.

Just on a whim I decided to try the opposite and remove the AcceptFilter 
http none.

Same problem still (without your patch of course - with your patch 
everything is still happy).

Andy

From dev-return-84416-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Thu Oct 22 21:51:07 2015
Return-Path: <dev-return-84416-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id E58901897A
	for <apmail-httpd-dev-archive@www.apache.org>; Thu, 22 Oct 2015 21:51:07 +0000 (UTC)
Received: (qmail 64948 invoked by uid 500); 22 Oct 2015 21:51:02 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 64886 invoked by uid 500); 22 Oct 2015 21:51:02 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 64876 invoked by uid 99); 22 Oct 2015 21:51:02 -0000
Received: from Unknown (HELO spamd1-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 22 Oct 2015 21:51:02 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd1-us-west.apache.org (ASF Mail Server at spamd1-us-west.apache.org) with ESMTP id D2FCAC4B3C
	for <dev@httpd.apache.org>; Thu, 22 Oct 2015 21:51:01 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd1-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.02
X-Spam-Level:
X-Spam-Status: No, score=-0.02 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	KAM_ASCII_DIVIDERS=0.8, RCVD_IN_DNSWL_LOW=-0.7,
	RCVD_IN_MSPIKE_H3=-0.01, RCVD_IN_MSPIKE_WL=-0.01, SPF_PASS=-0.001,
	URIBL_BLOCKED=0.001] autolearn=disabled
Authentication-Results: spamd1-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd1-us-west.apache.org [10.40.0.7]) (amavisd-new, port 10024)
	with ESMTP id vUPEAoRTwX53 for <dev@httpd.apache.org>;
	Thu, 22 Oct 2015 21:50:55 +0000 (UTC)
Received: from mail-qk0-f169.google.com (mail-qk0-f169.google.com [209.85.220.169])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id ECE1820751
	for <dev@httpd.apache.org>; Thu, 22 Oct 2015 21:50:54 +0000 (UTC)
Received: by qkfm62 with SMTP id m62so60057608qkf.1
        for <dev@httpd.apache.org>; Thu, 22 Oct 2015 14:50:54 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        bh=5UFkIoVu1YwiDt8kpJr0RDQxXkqLsmXbF4HDlGivCvc=;
        b=U1KcY0blpDHyBB8m5R71K4x1uarqIh3mSwhs6N/vG1n77ZiyUTPnokjOSTxaip75O4
         dQYt1ulyyF/+U8akOfBz0HbvtycL049y6urClwn164p5Bo2Yy35uY6f5mfX5bPtYnv+P
         8xcMLLKH3fvUFrf/mw2FdbxLjWjkEbk4RzD6RbtZNRg8AFsSeO5saY6A8sy9tyiFyrzo
         N0TSGkx7YHSM0msLd7p8O5FhYHBdQW8fnk4gVJ8/P6ZQMi/XaRrhjnYc5n8g2JAsky1l
         QWJLLly73Hp3hpsRpc+k3bYy8Hw8UXQpLmoxYU5Tywxw67TO/yPCoObMWLhyfkVxXOUY
         z75A==
MIME-Version: 1.0
X-Received: by 10.55.204.156 with SMTP id n28mr13483548qkl.38.1445550654025;
 Thu, 22 Oct 2015 14:50:54 -0700 (PDT)
Received: by 10.55.156.213 with HTTP; Thu, 22 Oct 2015 14:50:53 -0700 (PDT)
In-Reply-To: <5628E7A9.2060708@ptc.com>
References: <5625642E.30708@ptc.com>
	<5625A5E7.2070309@ptc.com>
	<CAKQ1sVPRX_st3SWAnF30C62qxTNqjHiSV3iaCHFPr1HLGp_CxA@mail.gmail.com>
	<AB1691BE05AE7F4992697F2A0835627AC63489F4@VOEXM10W.internal.vodafone.com>
	<CAKQ1sVMhNzYPWHTvhdeV6z+mV2ZNq5vjHj=W1d6R46cOQ_-qhQ@mail.gmail.com>
	<AB1691BE05AE7F4992697F2A0835627AC6348C38@VOEXM10W.internal.vodafone.com>
	<CAKQ1sVNHz_aCLZ3um-NV8cJGnhR3FtE6wz+zGgusvW=MA+cO_A@mail.gmail.com>
	<CAKQ1sVO_E2AZBL9CPfpm=_RQEnHWRDWNg67NFKCqy-vC=uoJBw@mail.gmail.com>
	<562668DA.5060804@ptc.com>
	<56269CBD.5060701@ptc.com>
	<5627853C.4040006@apache.org>
	<CAKQ1sVORFAFNwxw92Xfxhd9pGs3vCgHgoA3SCty29BbvHoPeSQ@mail.gmail.com>
	<AB1691BE05AE7F4992697F2A0835627AC634A1A9@VOEXM10W.internal.vodafone.com>
	<CAKQ1sVNpfUzE5ubnHJVa2h-_y45nDSbXS8XbOZJp3x7HFaMb9Q@mail.gmail.com>
	<AB1691BE05AE7F4992697F2A0835627AC634A1E6@VOEXM10W.internal.vodafone.com>
	<CAKQ1sVP2jv3q-A8JH977Qtkr+jwb4WjJOo0CdPhGdVv5BmcbKw@mail.gmail.com>
	<5627A72B.7050302@ptc.com>
	<5627A8E4.4010108@ptc.com>
	<5628E7A9.2060708@ptc.com>
Date: Thu, 22 Oct 2015 23:50:53 +0200
Message-ID: <CAKQ1sVPTvuptcpzeEcQcTz3JZD9E=q0vOMT48HZ4zLi8_KAozQ@mail.gmail.com>
Subject: Re: [users@httpd] Chunked transfer delay with httpd 2.4 on Windows.
From: Yann Ylavic <ylavic.dev@gmail.com>
To: dev@httpd.apache.org
Content-Type: multipart/mixed; boundary=001a1146e8843dc19c0522b87d34

--001a1146e8843dc19c0522b87d34
Content-Type: text/plain; charset=UTF-8

On Thu, Oct 22, 2015 at 3:42 PM, Andy Wang <awang@ptc.com> wrote:
>
> Tested with the patch and looks good.

Not that much actually, the patch fails to consume the CRLFs, and
hence can end up in an infinite loop.

So I'm attaching a new one here (committed in trunk with a larger
scope, this version is for 2.4.x and limited to your use case).
Could you give it a (new) try please (I have already done some testing
but it's probably worth passing your tests, before I can propose its
backport to 2.4.x)?
While the previous patch could not handle more than a single
(trailing) [CR]LF, this new one should (up to ten, which is the new
limit for tolerated blank lines in between requests).

Thanks,
Yann.

--001a1146e8843dc19c0522b87d34
Content-Type: text/x-diff; charset=US-ASCII; name="httpd-2.4.x-check_pipeline-blanks.patch"
Content-Disposition: attachment; 
	filename="httpd-2.4.x-check_pipeline-blanks.patch"
Content-Transfer-Encoding: base64
X-Attachment-Id: f_ig2rj5bk0

SW5kZXg6IGluY2x1ZGUvaHR0cGQuaAo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09Ci0tLSBpbmNsdWRlL2h0dHBkLmgJKHJl
dmlzaW9uIDE3MTAxMDUpCisrKyBpbmNsdWRlL2h0dHBkLmgJKHdvcmtpbmcgY29weSkKQEAgLTIw
MCw2ICsyMDAsMTAgQEAgZXh0ZXJuICJDIiB7CiAjaWZuZGVmIERFRkFVTFRfTElNSVRfUkVRVUVT
VF9GSUVMRFMKICNkZWZpbmUgREVGQVVMVF9MSU1JVF9SRVFVRVNUX0ZJRUxEUyAxMDAKICNlbmRp
ZgorLyoqIGRlZmF1bHQvaGFyZCBsaW1pdCBvbiBudW1iZXIgb2YgbGVhZGluZy90cmFpbGluZyBl
bXB0eSBsaW5lcyAqLworI2lmbmRlZiBERUZBVUxUX0xJTUlUX0JMQU5LX0xJTkVTCisjZGVmaW5l
IERFRkFVTFRfTElNSVRfQkxBTktfTElORVMgMTAKKyNlbmRpZgogCiAvKioKICAqIFRoZSBkZWZh
dWx0IGRlZmF1bHQgY2hhcmFjdGVyIHNldCBuYW1lIHRvIGFkZCBpZiBBZGREZWZhdWx0Q2hhcnNl
dCBpcwpJbmRleDogbW9kdWxlcy9odHRwL2h0dHBfcmVxdWVzdC5jCj09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KLS0tIG1v
ZHVsZXMvaHR0cC9odHRwX3JlcXVlc3QuYwkocmV2aXNpb24gMTcxMDEwNSkKKysrIG1vZHVsZXMv
aHR0cC9odHRwX3JlcXVlc3QuYwkod29ya2luZyBjb3B5KQpAQCAtMjMwLDIyICsyMzAsOTEgQEAg
QVBfREVDTEFSRSh2b2lkKSBhcF9kaWUoaW50IHR5cGUsIHJlcXVlc3RfcmVjICpyKQogCiBzdGF0
aWMgdm9pZCBjaGVja19waXBlbGluZShjb25uX3JlYyAqYywgYXByX2J1Y2tldF9icmlnYWRlICpi
YikKIHsKKyAgICBjLT5kYXRhX2luX2lucHV0X2ZpbHRlcnMgPSAwOwogICAgIGlmIChjLT5rZWVw
YWxpdmUgIT0gQVBfQ09OTl9DTE9TRSAmJiAhYy0+YWJvcnRlZCkgewogICAgICAgICBhcHJfc3Rh
dHVzX3QgcnY7CisgICAgICAgIGludCBudW1fYmxhbmtfbGluZXMgPSBERUZBVUxUX0xJTUlUX0JM
QU5LX0xJTkVTOworICAgICAgICBhcF9pbnB1dF9tb2RlX3QgbW9kZSA9IEFQX01PREVfU1BFQ1VM
QVRJVkU7CisgICAgICAgIGFwcl9zaXplX3QgbGVuLCBjciA9IDA7CisgICAgICAgIGNoYXIgYnVm
WzJdOwogCi0gICAgICAgIEFQX0RFQlVHX0FTU0VSVChBUFJfQlJJR0FERV9FTVBUWShiYikpOwot
ICAgICAgICBydiA9IGFwX2dldF9icmlnYWRlKGMtPmlucHV0X2ZpbHRlcnMsIGJiLCBBUF9NT0RF
X1NQRUNVTEFUSVZFLAotICAgICAgICAgICAgICAgICAgICAgICAgICAgIEFQUl9OT05CTE9DS19S
RUFELCAxKTsKLSAgICAgICAgaWYgKHJ2ICE9IEFQUl9TVUNDRVNTIHx8IEFQUl9CUklHQURFX0VN
UFRZKGJiKSkgewotICAgICAgICAgICAgLyoKLSAgICAgICAgICAgICAqIEVycm9yIG9yIGVtcHR5
IGJyaWdhZGU6IFRoZXJlIGlzIG5vIGRhdGEgcHJlc2VudCBpbiB0aGUgaW5wdXQKLSAgICAgICAg
ICAgICAqIGZpbHRlcgorICAgICAgICBkbyB7CisgICAgICAgICAgICBhcHJfYnJpZ2FkZV9jbGVh
bnVwKGJiKTsKKyAgICAgICAgICAgIHJ2ID0gYXBfZ2V0X2JyaWdhZGUoYy0+aW5wdXRfZmlsdGVy
cywgYmIsIG1vZGUsCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEFQUl9OT05CTE9D
S19SRUFELCBjciArIDEpOworICAgICAgICAgICAgaWYgKHJ2ICE9IEFQUl9TVUNDRVNTIHx8IEFQ
Ul9CUklHQURFX0VNUFRZKGJiKSkgeworICAgICAgICAgICAgICAgIC8qCisgICAgICAgICAgICAg
ICAgICogRXJyb3Igb3IgZW1wdHkgYnJpZ2FkZTogVGhlcmUgaXMgbm8gZGF0YSBwcmVzZW50IGlu
IHRoZSBpbnB1dAorICAgICAgICAgICAgICAgICAqIGZpbHRlcgorICAgICAgICAgICAgICAgICAq
LworICAgICAgICAgICAgICAgIGlmIChtb2RlID09IEFQX01PREVfUkVBREJZVEVTKSB7CisgICAg
ICAgICAgICAgICAgICAgIC8qIFVuZXhwZWN0ZWQgZXJyb3IsIHN0b3Agd2l0aCB0aGlzIGNvbm5l
Y3Rpb24gKi8KKyAgICAgICAgICAgICAgICAgICAgYXBfbG9nX2NlcnJvcihBUExPR19NQVJLLCBB
UExPR19FUlIsIHJ2LCBjLCBBUExPR05PKDAyOTY3KQorICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICJDYW4ndCBjb25zdW1lIHBpcGVsaW5lZCBlbXB0eSBsaW5lcyIpOworICAgICAg
ICAgICAgICAgICAgICBjLT5rZWVwYWxpdmUgPSBBUF9DT05OX0NMT1NFOworICAgICAgICAgICAg
ICAgIH0KKyAgICAgICAgICAgICAgICByZXR1cm47CisgICAgICAgICAgICB9CisKKyAgICAgICAg
ICAgIC8qIElnbm9yZSB0cmFpbGluZyBibGFuayBsaW5lcyAod2hpY2ggbXVzdCBub3QgYmUgaW50
ZXJwcmV0ZWQgYXMKKyAgICAgICAgICAgICAqIHBpcGVsaW5lZCByZXF1ZXN0cykgdXAgdG8gdGhl
IGxpbWl0LCBvdGhlcndpc2Ugd2Ugd291bGQgYmxvY2sKKyAgICAgICAgICAgICAqIG9uIHRoZSBu
ZXh0IHJlYWQgd2l0aG91dCBmbHVzaGluZyBkYXRhLCBhbmQgaGVuY2UgcG9zc2libHkgZGVsYXkK
KyAgICAgICAgICAgICAqIHBlbmRpbmcgcmVzcG9uc2UocykgdW50aWwgdGhlIG5leHQvcmVhbCBy
ZXF1ZXN0IGNvbWVzIGluIG9yIHRoZQorICAgICAgICAgICAgICoga2VlcGFsaXZlIHRpbWVvdXQg
ZXhwaXJlcy4KICAgICAgICAgICAgICAqLwotICAgICAgICAgICAgYy0+ZGF0YV9pbl9pbnB1dF9m
aWx0ZXJzID0gMDsKLSAgICAgICAgfQotICAgICAgICBlbHNlIHsKLSAgICAgICAgICAgIGMtPmRh
dGFfaW5faW5wdXRfZmlsdGVycyA9IDE7Ci0gICAgICAgIH0KKyAgICAgICAgICAgIGxlbiA9IGNy
ICsgMTsKKyAgICAgICAgICAgIHJ2ID0gYXByX2JyaWdhZGVfZmxhdHRlbihiYiwgYnVmLCAmbGVu
KTsKKyAgICAgICAgICAgIGlmIChydiAhPSBBUFJfU1VDQ0VTUyB8fCBsZW4gIT0gY3IgKyAxKSB7
CisgICAgICAgICAgICAgICAgaW50IGxldmVsOworICAgICAgICAgICAgICAgIGlmIChtb2RlID09
IEFQX01PREVfUkVBREJZVEVTKSB7CisgICAgICAgICAgICAgICAgICAgIC8qIFVuZXhwZWN0ZWQg
ZXJyb3IsIHN0b3Agd2l0aCB0aGlzIGNvbm5lY3Rpb24gKi8KKyAgICAgICAgICAgICAgICAgICAg
Yy0+a2VlcGFsaXZlID0gQVBfQ09OTl9DTE9TRTsKKyAgICAgICAgICAgICAgICAgICAgbGV2ZWwg
PSBBUExPR19FUlI7CisgICAgICAgICAgICAgICAgfQorICAgICAgICAgICAgICAgIGVsc2Ugewor
ICAgICAgICAgICAgICAgICAgICAvKiBMZXQgb3V0c2lkZSAobm9uLXNwZWN1bGF0aXZlL2Jsb2Nr
aW5nKSByZWFkIGRldGVybWluZQorICAgICAgICAgICAgICAgICAgICAgKiB3aGVyZSB0aGlzIHBv
c3NpYmxlIGZhaWx1cmUgY29tZXMgZnJvbSAobWV0YWRhdGEsCisgICAgICAgICAgICAgICAgICAg
ICAqIG1vcnBoZWQgRU9GIHNvY2tldCA9PiBlbXB0eSBidWNrZXQ/IGRlYnVnIG9ubHkgaGVyZSku
CisgICAgICAgICAgICAgICAgICAgICAqLworICAgICAgICAgICAgICAgICAgICBjLT5kYXRhX2lu
X2lucHV0X2ZpbHRlcnMgPSAxOworICAgICAgICAgICAgICAgICAgICBsZXZlbCA9IEFQTE9HX0RF
QlVHOworICAgICAgICAgICAgICAgIH0KKyAgICAgICAgICAgICAgICBhcF9sb2dfY2Vycm9yKEFQ
TE9HX01BUkssIGxldmVsLCBydiwgYywgQVBMT0dOTygwMjk2OCkKKyAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICJDYW4ndCBjaGVjayBwaXBlbGluZWQgZGF0YSIpOworICAgICAgICAgICAg
ICAgIHJldHVybjsKKyAgICAgICAgICAgIH0KKworICAgICAgICAgICAgaWYgKG1vZGUgPT0gQVBf
TU9ERV9SRUFEQllURVMpIHsKKyAgICAgICAgICAgICAgICBtb2RlID0gQVBfTU9ERV9TUEVDVUxB
VElWRTsKKyAgICAgICAgICAgICAgICBjciA9IDA7CisgICAgICAgICAgICAgICAgY29udGludWU7
CisgICAgICAgICAgICB9CisKKyAgICAgICAgICAgIGlmIChjcikgeworICAgICAgICAgICAgICAg
IEFQX0RFQlVHX0FTU0VSVChsZW4gPT0gMiAmJiBidWZbMF0gPT0gQVBSX0FTQ0lJX0NSKTsKKyAg
ICAgICAgICAgICAgICBpZiAoYnVmWzFdICE9IEFQUl9BU0NJSV9MRikgeworICAgICAgICAgICAg
ICAgICAgICByZXR1cm47CisgICAgICAgICAgICAgICAgfQorICAgICAgICAgICAgICAgIG1vZGUg
PSBBUF9NT0RFX1JFQURCWVRFUzsKKyAgICAgICAgICAgICAgICBudW1fYmxhbmtfbGluZXMtLTsK
KyAgICAgICAgICAgIH0KKyAgICAgICAgICAgIGVsc2UgeworICAgICAgICAgICAgICAgIGlmIChi
dWZbMF0gPT0gQVBSX0FTQ0lJX0NSKSB7CisgICAgICAgICAgICAgICAgICAgIGNyID0gMTsKKyAg
ICAgICAgICAgICAgICB9CisgICAgICAgICAgICAgICAgZWxzZSBpZiAoYnVmWzBdID09IEFQUl9B
U0NJSV9MRikgeworICAgICAgICAgICAgICAgICAgICBtb2RlID0gQVBfTU9ERV9SRUFEQllURVM7
CisgICAgICAgICAgICAgICAgICAgIG51bV9ibGFua19saW5lcy0tOworICAgICAgICAgICAgICAg
IH0KKyAgICAgICAgICAgICAgICBlbHNlIHsKKyAgICAgICAgICAgICAgICAgICAgYy0+ZGF0YV9p
bl9pbnB1dF9maWx0ZXJzID0gMTsKKyAgICAgICAgICAgICAgICAgICAgcmV0dXJuOworICAgICAg
ICAgICAgICAgIH0KKyAgICAgICAgICAgIH0KKyAgICAgICAgfSB3aGlsZSAobnVtX2JsYW5rX2xp
bmVzID49IDApOworCisgICAgICAgIC8qIERvbid0IHJlY3ljbGUgdGhpcyAoYWJ1c2VkKSBjb25u
ZWN0aW9uICovCisgICAgICAgIGMtPmtlZXBhbGl2ZSA9IEFQX0NPTk5fQ0xPU0U7CiAgICAgfQog
fQogCg==
--001a1146e8843dc19c0522b87d34--

From dev-return-84417-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Fri Oct 23 08:42:23 2015
Return-Path: <dev-return-84417-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id E261C18DA2
	for <apmail-httpd-dev-archive@www.apache.org>; Fri, 23 Oct 2015 08:42:22 +0000 (UTC)
Received: (qmail 95750 invoked by uid 500); 23 Oct 2015 08:42:22 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 95688 invoked by uid 500); 23 Oct 2015 08:42:22 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 95678 invoked by uid 99); 23 Oct 2015 08:42:22 -0000
Received: from Unknown (HELO spamd1-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 23 Oct 2015 08:42:22 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd1-us-west.apache.org (ASF Mail Server at spamd1-us-west.apache.org) with ESMTP id DC768C84CE
	for <dev@httpd.apache.org>; Fri, 23 Oct 2015 08:42:21 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd1-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.099
X-Spam-Level:
X-Spam-Status: No, score=-0.099 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RP_MATCHES_RCVD=0.001, SPF_PASS=-0.001, URIBL_BLOCKED=0.001]
	autolearn=disabled
Authentication-Results: spamd1-us-west.apache.org (amavisd-new);
	dkim=pass (1024-bit key) header.d=greenbytes.de
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd1-us-west.apache.org [10.40.0.7]) (amavisd-new, port 10024)
	with ESMTP id sanpr8eNx6LK for <dev@httpd.apache.org>;
	Fri, 23 Oct 2015 08:42:12 +0000 (UTC)
Received: from mail.greenbytes.de (mail.greenbytes.de [217.91.35.233])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id D0ABA204C9
	for <dev@httpd.apache.org>; Fri, 23 Oct 2015 08:42:11 +0000 (UTC)
Received: from [192.168.178.41] (unknown [93.211.97.239])
	(using TLSv1 with cipher ECDHE-RSA-AES256-SHA (256/256 bits))
	(Client did not present a certificate)
	by mail.greenbytes.de (Postfix) with ESMTPSA id DC6D515A0516
	for <dev@httpd.apache.org>; Fri, 23 Oct 2015 10:42:04 +0200 (CEST)
DKIM-Signature: v=1; a=rsa-sha256; c=simple/simple; d=greenbytes.de; s=mail;
	t=1445589724; bh=UGAxwsITaVYhOMh+AuMziIlHcUPFnbLOOfzJs5+9iXk=;
	h=From:Subject:Date:To:From;
	b=USQnBzrAcgWAkYW+SE/Kgn0aKpodqFiJwjSXtajnT+kVYZUjpWITr2v2QwjdAtMEx
	 VqXFcGzF36WztFRiY1jSEIJTIXMAvBjA3XjodGv1YRNVz4fshfLJu3eQRVr/AYEkXR
	 RVRwQS6/Bh/CwBN7cpWEB5VlrfVIAGvdmDVBAAWQ=
From: Stefan Eissing <stefan.eissing@greenbytes.de>
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: quoted-printable
Subject: segfault analysis
Message-Id: <14EF204A-C8E6-406E-A441-9030403297D6@greenbytes.de>
Date: Fri, 23 Oct 2015 10:42:04 +0200
To: dev@httpd.apache.org
Mime-Version: 1.0 (Mac OS X Mail 9.1 \(3096.5\))
X-Mailer: Apple Mail (2.3096.5)

A question to the more experienced httpd debuggers:

In regard to https://bz.apache.org/bugzilla/show_bug.cgi?id=3D58524

Can I recover any files/lines from these
=3D=3D=3D=3D=3D=3D=3D Backtrace: =3D=3D=3D=3D=3D=3D=3D=3D=3D
/lib64/libc.so.6[0x32a507174f]
/lib64/libc.so.6(cfree+0x4b)[0x32a5075a4b]
=
/opt/appl/apr-1.5.2/lib/libapr-1.so.0(apr_allocator_destroy+0x1b)[0x2abbed=
566e6b]
/opt/appl/httpd/modules/mod_http2.so[0x2abbf10e082e]
/opt/appl/httpd/modules/mod_http2.so[0x2abbf10e32ee]
/opt/appl/httpd/modules/mod_http2.so[0x2abbf10db00a]
/opt/appl/httpd/modules/mod_http2.so[0x2abbf10db233]
/opt/appl/httpd/modules/mod_http2.so[0x2abbf10de351]
=
/opt/appl/httpd-2.4.17/bin/httpd(ap_run_process_connection+0x4a)[0x456efa]=

/opt/appl/httpd-2.4.17/bin/httpd[0x468fa0]
/lib64/libpthread.so.0[0x32a5c0683d]
/lib64/libc.so.6(clone+0x6d)[0x32a50d526d]
=3D=3D=3D=3D=3D=3D=3D Memory map: =3D=3D=3D=3D=3D=3D=3D=3D

or do I have to ask the user to run a -g version and report on that?

High load wreckage in production, always tricky...

Thanks,

  Stefan=

From dev-return-84418-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Fri Oct 23 09:18:53 2015
Return-Path: <dev-return-84418-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 1A28618F4C
	for <apmail-httpd-dev-archive@www.apache.org>; Fri, 23 Oct 2015 09:18:53 +0000 (UTC)
Received: (qmail 60282 invoked by uid 500); 23 Oct 2015 09:18:52 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 60201 invoked by uid 500); 23 Oct 2015 09:18:52 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 60191 invoked by uid 99); 23 Oct 2015 09:18:52 -0000
Received: from Unknown (HELO spamd1-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 23 Oct 2015 09:18:52 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd1-us-west.apache.org (ASF Mail Server at spamd1-us-west.apache.org) with ESMTP id 0EFB2C4F79
	for <dev@httpd.apache.org>; Fri, 23 Oct 2015 09:18:52 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd1-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.101
X-Spam-Level:
X-Spam-Status: No, score=-0.101 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	SPF_PASS=-0.001] autolearn=disabled
Authentication-Results: spamd1-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-us-west.apache.org ([10.40.0.8])
	by localhost (spamd1-us-west.apache.org [10.40.0.7]) (amavisd-new, port 10024)
	with ESMTP id 5LfR8H9dQJoM for <dev@httpd.apache.org>;
	Fri, 23 Oct 2015 09:18:36 +0000 (UTC)
Received: from mail-qk0-f177.google.com (mail-qk0-f177.google.com [209.85.220.177])
	by mx1-us-west.apache.org (ASF Mail Server at mx1-us-west.apache.org) with ESMTPS id 957322303D
	for <dev@httpd.apache.org>; Fri, 23 Oct 2015 09:18:36 +0000 (UTC)
Received: by qkcy65 with SMTP id y65so67269550qkc.0
        for <dev@httpd.apache.org>; Fri, 23 Oct 2015 02:18:30 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        bh=m04Rs3spp+DLtPkf9dNWZ7GwQNJYIfa+ntdxdm9erQ0=;
        b=ZVxR332mykwQgeCWdiAmW8Mx8h1XjqOAk56BC3e+ArY+/3ltPZ3ia7jW3nXySextEk
         8lnLRs2wmOxwQTKwjHxahEIcjeN5RENLc5HcL9g34ABmoPK7U9+/z1/p/f7U2S3J8fKb
         4PhFp1PLEBhiohdT4JTT+akVPM30azEBLVG78cOxhiBWq9Qqddy8H7kNwpVCStI7RBzF
         9OwAcxqkjd65QXAGb0QB9aBa7ftJ+m1EwSSiYlJj39Bb+Ft+G1Sx1i56tMLZMo94/4fw
         Z45E5mTWM+q8yyJ6uc9Ydkj9hsjwDQmCG5QvyGynpgzOqvYGUmzGbXCqZ4PIy7iPU9m9
         o6bA==
MIME-Version: 1.0
X-Received: by 10.141.23.9 with SMTP id z9mr25291615qhd.24.1445591909938; Fri,
 23 Oct 2015 02:18:29 -0700 (PDT)
Received: by 10.55.156.213 with HTTP; Fri, 23 Oct 2015 02:18:29 -0700 (PDT)
In-Reply-To: <14EF204A-C8E6-406E-A441-9030403297D6@greenbytes.de>
References: <14EF204A-C8E6-406E-A441-9030403297D6@greenbytes.de>
Date: Fri, 23 Oct 2015 11:18:29 +0200
Message-ID: <CAKQ1sVPVMrUkXemn2S21E7r2NnvGyaikZoPLpri6u9OHCgnBsg@mail.gmail.com>
Subject: Re: segfault analysis
From: Yann Ylavic <ylavic.dev@gmail.com>
To: dev@httpd.apache.org
Content-Type: text/plain; charset=UTF-8

On Fri, Oct 23, 2015 at 10:42 AM, Stefan Eissing
<stefan.eissing@greenbytes.de> wrote:
>
> Can I recover any files/lines from these
> ======= Backtrace: =========
> /lib64/libc.so.6[0x32a507174f]
> /lib64/libc.so.6(cfree+0x4b)[0x32a5075a4b]
> /opt/appl/apr-1.5.2/lib/libapr-1.so.0(apr_allocator_destroy+0x1b)[0x2abbed566e6b]
> /opt/appl/httpd/modules/mod_http2.so[0x2abbf10e082e]
> /opt/appl/httpd/modules/mod_http2.so[0x2abbf10e32ee]
> /opt/appl/httpd/modules/mod_http2.so[0x2abbf10db00a]
> /opt/appl/httpd/modules/mod_http2.so[0x2abbf10db233]
> /opt/appl/httpd/modules/mod_http2.so[0x2abbf10de351]
> /opt/appl/httpd-2.4.17/bin/httpd(ap_run_process_connection+0x4a)[0x456efa]
> /opt/appl/httpd-2.4.17/bin/httpd[0x468fa0]
> /lib64/libpthread.so.0[0x32a5c0683d]
> /lib64/libc.so.6(clone+0x6d)[0x32a50d526d]
> ======= Memory map: ========

That's an apr_pool_destroy() from either h2_mplx_destroy() or
h2_worker_destroy(), the only http2's pools that have their own
allocator.

I think the (++attempts >= 6) case in h2_mplx_release_and_join() could
trigger this, do we really want a timedwait here?
Also, apr_thread_cond_signal() in release() should probably be under
mutex, something like (2.4.x):

Index: modules/http2/h2_mplx.c
===================================================================
--- modules/http2/h2_mplx.c    (revision 1710105)
+++ modules/http2/h2_mplx.c    (working copy)
@@ -143,12 +143,18 @@ static void reference(h2_mplx *m)
     apr_atomic_inc32(&m->refs);
 }

-static void release(h2_mplx *m)
+static void release(h2_mplx *m, int lock)
 {
     if (!apr_atomic_dec32(&m->refs)) {
+        if (lock) {
+            apr_thread_mutex_lock(m->lock);
+        }
         if (m->join_wait) {
             apr_thread_cond_signal(m->join_wait);
         }
+        if (lock) {
+            apr_thread_mutex_lock(m->unlock);
+        }
     }
 }

@@ -158,7 +164,7 @@ void h2_mplx_reference(h2_mplx *m)
 }
 void h2_mplx_release(h2_mplx *m)
 {
-    release(m);
+    release(m, 1);
 }

 static void workers_register(h2_mplx *m) {
@@ -189,7 +195,7 @@ apr_status_t h2_mplx_release_and_join(h2_mplx *m,
     if (APR_SUCCESS == status) {
         int attempts = 0;

-        release(m);
+        release(m, 0);
         while (apr_atomic_read32(&m->refs) > 0) {
             m->join_wait = wait;
             ap_log_cerror(APLOG_MARK, (attempts? APLOG_INFO : APLOG_DEBUG),
--


>
> or do I have to ask the user to run a -g version and report on that?

That could be useful, along with "CoreDumpDirectory /tmp" (and ulimit
-c unlimited for the process launching httpd) which would provide the
corresponding core file.

>
> High load wreckage in production, always tricky...

Indeed...


Regards,
Yann.

From dev-return-84419-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Fri Oct 23 09:23:45 2015
Return-Path: <dev-return-84419-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 4855618F86
	for <apmail-httpd-dev-archive@www.apache.org>; Fri, 23 Oct 2015 09:23:45 +0000 (UTC)
Received: (qmail 73234 invoked by uid 500); 23 Oct 2015 09:23:44 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 73153 invoked by uid 500); 23 Oct 2015 09:23:44 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 73142 invoked by uid 99); 23 Oct 2015 09:23:44 -0000
Received: from Unknown (HELO spamd1-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 23 Oct 2015 09:23:44 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd1-us-west.apache.org (ASF Mail Server at spamd1-us-west.apache.org) with ESMTP id 59F09C8572
	for <dev@httpd.apache.org>; Fri, 23 Oct 2015 09:23:44 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd1-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.101
X-Spam-Level:
X-Spam-Status: No, score=-0.101 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	SPF_PASS=-0.001] autolearn=disabled
Authentication-Results: spamd1-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd1-us-west.apache.org [10.40.0.7]) (amavisd-new, port 10024)
	with ESMTP id YKBLqXY4rDY0 for <dev@httpd.apache.org>;
	Fri, 23 Oct 2015 09:23:29 +0000 (UTC)
Received: from mail-qk0-f175.google.com (mail-qk0-f175.google.com [209.85.220.175])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id 7873C281BE
	for <dev@httpd.apache.org>; Fri, 23 Oct 2015 09:22:04 +0000 (UTC)
Received: by qkca6 with SMTP id a6so67713075qkc.3
        for <dev@httpd.apache.org>; Fri, 23 Oct 2015 02:22:03 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        bh=V39M0BeJF+83mBslWgXMx4by9V4FKiMmlz6fdu9ne04=;
        b=XlsBjvsSMK/j4VZi7kUdFIIPlYdKx0y/PojYOyUcTkgCLXiMMCuhSbr9au9CpI2Qsw
         C7D55BsNR/qyRI6xp3y0RjaUGDOwpQRTt+CrPe2xk9kZDZq577wm7Fnc3hNwJUmtG1Sh
         tpISdi2Q82oCG29zpcPeSrIeHt+sbVQBG343l8o8CYuqgXcMWhH5XRJHHaVKdj57zYxU
         Vo5X3F/RTE2mkfanUI05Lv3CO98lP+mEx+YD2DgneqmTA7V52MOzaI9uffVw5HiXZiva
         kV7/AW16Nm5sZ+OFIiUcZDBXcCxaKTz6Z4eyix/trLljEyqZOv3EkZp+/0o51ify7Ydy
         d+Vg==
MIME-Version: 1.0
X-Received: by 10.140.216.87 with SMTP id m84mr25338708qhb.97.1445592123614;
 Fri, 23 Oct 2015 02:22:03 -0700 (PDT)
Received: by 10.55.156.213 with HTTP; Fri, 23 Oct 2015 02:22:03 -0700 (PDT)
In-Reply-To: <CAKQ1sVPVMrUkXemn2S21E7r2NnvGyaikZoPLpri6u9OHCgnBsg@mail.gmail.com>
References: <14EF204A-C8E6-406E-A441-9030403297D6@greenbytes.de>
	<CAKQ1sVPVMrUkXemn2S21E7r2NnvGyaikZoPLpri6u9OHCgnBsg@mail.gmail.com>
Date: Fri, 23 Oct 2015 11:22:03 +0200
Message-ID: <CAKQ1sVN9UYq2TrFm-wF+0Bh=NsQDH_C82nGC4PqmH7PESVef-w@mail.gmail.com>
Subject: Re: segfault analysis
From: Yann Ylavic <ylavic.dev@gmail.com>
To: dev@httpd.apache.org
Content-Type: text/plain; charset=UTF-8

On Fri, Oct 23, 2015 at 11:18 AM, Yann Ylavic <ylavic.dev@gmail.com> wrote:
>
> Index: modules/http2/h2_mplx.c
> ===================================================================
> --- modules/http2/h2_mplx.c    (revision 1710105)
> +++ modules/http2/h2_mplx.c    (working copy)
> @@ -143,12 +143,18 @@ static void reference(h2_mplx *m)
>      apr_atomic_inc32(&m->refs);
>  }
>
> -static void release(h2_mplx *m)
> +static void release(h2_mplx *m, int lock)
>  {
>      if (!apr_atomic_dec32(&m->refs)) {
> +        if (lock) {
> +            apr_thread_mutex_lock(m->lock);
> +        }
>          if (m->join_wait) {
>              apr_thread_cond_signal(m->join_wait);
>          }
> +        if (lock) {
> +            apr_thread_mutex_lock(m->unlock);

We'd rather unlock here :)

> +        }
>      }
>  }

From dev-return-84420-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Fri Oct 23 10:00:15 2015
Return-Path: <dev-return-84420-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 7AB291812B
	for <apmail-httpd-dev-archive@www.apache.org>; Fri, 23 Oct 2015 10:00:15 +0000 (UTC)
Received: (qmail 47585 invoked by uid 500); 23 Oct 2015 10:00:03 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 47487 invoked by uid 500); 23 Oct 2015 10:00:03 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 47473 invoked by uid 99); 23 Oct 2015 10:00:03 -0000
Received: from Unknown (HELO spamd4-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 23 Oct 2015 10:00:03 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd4-us-west.apache.org (ASF Mail Server at spamd4-us-west.apache.org) with ESMTP id 57E71C0EC9
	for <dev@httpd.apache.org>; Fri, 23 Oct 2015 10:00:03 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd4-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.11
X-Spam-Level:
X-Spam-Status: No, score=-0.11 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	T_RP_MATCHES_RCVD=-0.01] autolearn=disabled
Authentication-Results: spamd4-us-west.apache.org (amavisd-new);
	dkim=pass (1024-bit key) header.d=greenbytes.de
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd4-us-west.apache.org [10.40.0.11]) (amavisd-new, port 10024)
	with ESMTP id ePJwfPgzg4EY for <dev@httpd.apache.org>;
	Fri, 23 Oct 2015 09:59:48 +0000 (UTC)
Received: from mail.greenbytes.de (mail.greenbytes.de [217.91.35.233])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id 7EBE142B60
	for <dev@httpd.apache.org>; Fri, 23 Oct 2015 09:59:48 +0000 (UTC)
Received: from [192.168.178.41] (unknown [93.211.97.239])
	(using TLSv1 with cipher ECDHE-RSA-AES256-SHA (256/256 bits))
	(Client did not present a certificate)
	by mail.greenbytes.de (Postfix) with ESMTPSA id D7FF515A044D
	for <dev@httpd.apache.org>; Fri, 23 Oct 2015 11:59:46 +0200 (CEST)
DKIM-Signature: v=1; a=rsa-sha256; c=simple/simple; d=greenbytes.de; s=mail;
	t=1445594387; bh=gRZ5wTjGO/8Qw+6+HeiOOQVvoavxhSQbiKAUm3I0/xs=;
	h=Subject:From:In-Reply-To:Date:References:To:From;
	b=TkHDMDPefUc2nKZou+TiGKvtd5j3Ty5aEQC60Dm/8hL1WIaxMmN2OmkuoPV/gJ8oY
	 6h1j6sN+e+2sk6x/xz8I8pZ+xA5fJsbx8qCPnxIPDLNUGh+0eux/2C2UTfA7Bm1gF7
	 CTqaHbnK1yqhLJ7H0heBiZICv7RtRkT2I2cgapB4=
Content-Type: text/plain; charset=us-ascii
Mime-Version: 1.0 (Mac OS X Mail 9.1 \(3096.5\))
Subject: Re: segfault analysis
From: Stefan Eissing <stefan.eissing@greenbytes.de>
In-Reply-To: <CAKQ1sVN9UYq2TrFm-wF+0Bh=NsQDH_C82nGC4PqmH7PESVef-w@mail.gmail.com>
Date: Fri, 23 Oct 2015 11:59:46 +0200
Content-Transfer-Encoding: quoted-printable
Message-Id: <BCADC308-1CBA-451E-90E0-13B342435C8B@greenbytes.de>
References: <14EF204A-C8E6-406E-A441-9030403297D6@greenbytes.de> <CAKQ1sVPVMrUkXemn2S21E7r2NnvGyaikZoPLpri6u9OHCgnBsg@mail.gmail.com> <CAKQ1sVN9UYq2TrFm-wF+0Bh=NsQDH_C82nGC4PqmH7PESVef-w@mail.gmail.com>
To: dev@httpd.apache.org
X-Mailer: Apple Mail (2.3096.5)

;-)

The problem with the unlock in release is that the h2_mplx might have =
been destroyed by then, as the signal might give the lock to someone =
waiting. I could move that mutex into h2_session ownership, just lending =
it to h2_mplx...

//Stefan

> Am 23.10.2015 um 11:22 schrieb Yann Ylavic <ylavic.dev@gmail.com>:
>=20
> On Fri, Oct 23, 2015 at 11:18 AM, Yann Ylavic <ylavic.dev@gmail.com> =
wrote:
>>=20
>> Index: modules/http2/h2_mplx.c
>> =3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D
>> --- modules/http2/h2_mplx.c    (revision 1710105)
>> +++ modules/http2/h2_mplx.c    (working copy)
>> @@ -143,12 +143,18 @@ static void reference(h2_mplx *m)
>>     apr_atomic_inc32(&m->refs);
>> }
>>=20
>> -static void release(h2_mplx *m)
>> +static void release(h2_mplx *m, int lock)
>> {
>>     if (!apr_atomic_dec32(&m->refs)) {
>> +        if (lock) {
>> +            apr_thread_mutex_lock(m->lock);
>> +        }
>>         if (m->join_wait) {
>>             apr_thread_cond_signal(m->join_wait);
>>         }
>> +        if (lock) {
>> +            apr_thread_mutex_lock(m->unlock);
>=20
> We'd rather unlock here :)
>=20
>> +        }
>>     }
>> }


From dev-return-84421-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Fri Oct 23 10:05:04 2015
Return-Path: <dev-return-84421-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 9671B1814D
	for <apmail-httpd-dev-archive@www.apache.org>; Fri, 23 Oct 2015 10:05:04 +0000 (UTC)
Received: (qmail 58937 invoked by uid 500); 23 Oct 2015 10:05:01 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 58873 invoked by uid 500); 23 Oct 2015 10:05:01 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 58860 invoked by uid 99); 23 Oct 2015 10:05:01 -0000
Received: from Unknown (HELO spamd1-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 23 Oct 2015 10:05:01 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd1-us-west.apache.org (ASF Mail Server at spamd1-us-west.apache.org) with ESMTP id A7DD5C624B
	for <dev@httpd.apache.org>; Fri, 23 Oct 2015 10:05:00 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd1-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.1
X-Spam-Level:
X-Spam-Status: No, score=-0.1 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RP_MATCHES_RCVD=0.001, SPF_PASS=-0.001] autolearn=disabled
Authentication-Results: spamd1-us-west.apache.org (amavisd-new);
	dkim=pass (1024-bit key) header.d=greenbytes.de
Received: from mx1-us-west.apache.org ([10.40.0.8])
	by localhost (spamd1-us-west.apache.org [10.40.0.7]) (amavisd-new, port 10024)
	with ESMTP id ZbtQ7s5LwLgA for <dev@httpd.apache.org>;
	Fri, 23 Oct 2015 10:04:59 +0000 (UTC)
Received: from mail.greenbytes.de (mail.greenbytes.de [217.91.35.233])
	by mx1-us-west.apache.org (ASF Mail Server at mx1-us-west.apache.org) with ESMTPS id 718922118F
	for <dev@httpd.apache.org>; Fri, 23 Oct 2015 10:04:59 +0000 (UTC)
Received: from [192.168.178.41] (unknown [93.211.97.239])
	(using TLSv1 with cipher ECDHE-RSA-AES256-SHA (256/256 bits))
	(Client did not present a certificate)
	by mail.greenbytes.de (Postfix) with ESMTPSA id 1971015A044D
	for <dev@httpd.apache.org>; Fri, 23 Oct 2015 12:04:57 +0200 (CEST)
DKIM-Signature: v=1; a=rsa-sha256; c=simple/simple; d=greenbytes.de; s=mail;
	t=1445594697; bh=dxzMNLxrNddqXO4EU0isg6O4dgV9S5RO8dW9Oi4M11I=;
	h=Subject:From:In-Reply-To:Date:References:To:From;
	b=loyM1rfhQm/z5OrTo96mVRfgcyLLc+7GkTSgfkvfCXI7mYh2YU7D99psTChgfEfmV
	 4/jHAutia1B7YgqgwQwUOLd8FExBfuk9Rqmr/XpwX0r8T6b1ZrCgVHo91Hbi/h2oi1
	 e/1YkqA+KQjL3/U+GcGwHIdRfOrE+2mxd6LWG6BM=
Content-Type: text/plain; charset=us-ascii
Mime-Version: 1.0 (Mac OS X Mail 9.1 \(3096.5\))
Subject: Re: segfault analysis
From: Stefan Eissing <stefan.eissing@greenbytes.de>
In-Reply-To: <CAKQ1sVN9UYq2TrFm-wF+0Bh=NsQDH_C82nGC4PqmH7PESVef-w@mail.gmail.com>
Date: Fri, 23 Oct 2015 12:04:56 +0200
Content-Transfer-Encoding: quoted-printable
Message-Id: <DF0CFA8C-B4CF-4F5F-A394-1AB707B7BD63@greenbytes.de>
References: <14EF204A-C8E6-406E-A441-9030403297D6@greenbytes.de> <CAKQ1sVPVMrUkXemn2S21E7r2NnvGyaikZoPLpri6u9OHCgnBsg@mail.gmail.com> <CAKQ1sVN9UYq2TrFm-wF+0Bh=NsQDH_C82nGC4PqmH7PESVef-w@mail.gmail.com>
To: dev@httpd.apache.org
X-Mailer: Apple Mail (2.3096.5)

Nice analysis, btw. I think you found the problem. I'll replace the =
timed wait by a simple wait...

> Am 23.10.2015 um 11:22 schrieb Yann Ylavic <ylavic.dev@gmail.com>:
>=20
> On Fri, Oct 23, 2015 at 11:18 AM, Yann Ylavic <ylavic.dev@gmail.com> =
wrote:
>>=20
>> Index: modules/http2/h2_mplx.c
>> =3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D
>> --- modules/http2/h2_mplx.c    (revision 1710105)
>> +++ modules/http2/h2_mplx.c    (working copy)
>> @@ -143,12 +143,18 @@ static void reference(h2_mplx *m)
>>     apr_atomic_inc32(&m->refs);
>> }
>>=20
>> -static void release(h2_mplx *m)
>> +static void release(h2_mplx *m, int lock)
>> {
>>     if (!apr_atomic_dec32(&m->refs)) {
>> +        if (lock) {
>> +            apr_thread_mutex_lock(m->lock);
>> +        }
>>         if (m->join_wait) {
>>             apr_thread_cond_signal(m->join_wait);
>>         }
>> +        if (lock) {
>> +            apr_thread_mutex_lock(m->unlock);
>=20
> We'd rather unlock here :)
>=20
>> +        }
>>     }
>> }


From dev-return-84422-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Fri Oct 23 10:05:47 2015
Return-Path: <dev-return-84422-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 0910818153
	for <apmail-httpd-dev-archive@www.apache.org>; Fri, 23 Oct 2015 10:05:47 +0000 (UTC)
Received: (qmail 60279 invoked by uid 500); 23 Oct 2015 10:05:43 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 60208 invoked by uid 500); 23 Oct 2015 10:05:43 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 60198 invoked by uid 99); 23 Oct 2015 10:05:43 -0000
Received: from Unknown (HELO spamd3-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 23 Oct 2015 10:05:43 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd3-us-west.apache.org (ASF Mail Server at spamd3-us-west.apache.org) with ESMTP id 1AB7A1809AB
	for <dev@httpd.apache.org>; Fri, 23 Oct 2015 10:05:43 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd3-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.12
X-Spam-Level:
X-Spam-Status: No, score=-0.12 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RCVD_IN_MSPIKE_H3=-0.01, RCVD_IN_MSPIKE_WL=-0.01, SPF_PASS=-0.001,
	URIBL_BLOCKED=0.001] autolearn=disabled
Authentication-Results: spamd3-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-us-west.apache.org ([10.40.0.8])
	by localhost (spamd3-us-west.apache.org [10.40.0.10]) (amavisd-new, port 10024)
	with ESMTP id WZffTEd3rtRK for <dev@httpd.apache.org>;
	Fri, 23 Oct 2015 10:05:42 +0000 (UTC)
Received: from mail-qk0-f170.google.com (mail-qk0-f170.google.com [209.85.220.170])
	by mx1-us-west.apache.org (ASF Mail Server at mx1-us-west.apache.org) with ESMTPS id 2B7CC2118F
	for <dev@httpd.apache.org>; Fri, 23 Oct 2015 10:05:42 +0000 (UTC)
Received: by qkca6 with SMTP id a6so68700202qkc.3
        for <dev@httpd.apache.org>; Fri, 23 Oct 2015 03:05:34 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        bh=IAsOSkSuxV9xxE9zJdEGXseso5mDlBEL37ezRGE3jfY=;
        b=a7wCZwyIsfb8SbgQNuD5M1SBeMB09rvH4HLIVwD1RJoufm0xo8BH8b4acZALileE97
         8ZZT5gOTgxZV7wZZrEypaUHHx+dHjtiuSx5cGNcpePHhOZ42/zwCejsrkizzojX6dC1U
         ptpUF5n/EF5Woq0AQdFifEm1gE4/N6fsAint/nMMAxM7eNxFVJFBPsdhAHlrEi7aZpcC
         x3FEmkFs9ibAZQdftNW4lMisgGnfwBY1H4Yq3adyMne5H8+UQf4M5Fki2Xy0Yw/kD8Zp
         hejY3TN/VTnTVMFhW9GyNnhNj9yMkhSTfNO5fVu1pWPTN3ZbiiWosHvid1sNUF2KHB+d
         6tCQ==
MIME-Version: 1.0
X-Received: by 10.140.216.87 with SMTP id m84mr25510571qhb.97.1445594734592;
 Fri, 23 Oct 2015 03:05:34 -0700 (PDT)
Received: by 10.55.156.213 with HTTP; Fri, 23 Oct 2015 03:05:34 -0700 (PDT)
In-Reply-To: <BCADC308-1CBA-451E-90E0-13B342435C8B@greenbytes.de>
References: <14EF204A-C8E6-406E-A441-9030403297D6@greenbytes.de>
	<CAKQ1sVPVMrUkXemn2S21E7r2NnvGyaikZoPLpri6u9OHCgnBsg@mail.gmail.com>
	<CAKQ1sVN9UYq2TrFm-wF+0Bh=NsQDH_C82nGC4PqmH7PESVef-w@mail.gmail.com>
	<BCADC308-1CBA-451E-90E0-13B342435C8B@greenbytes.de>
Date: Fri, 23 Oct 2015 12:05:34 +0200
Message-ID: <CAKQ1sVPuxy__cv0muoJOU3tEcmvJ81b2fpGOUd-OmT18-JEVFQ@mail.gmail.com>
Subject: Re: segfault analysis
From: Yann Ylavic <ylavic.dev@gmail.com>
To: dev@httpd.apache.org
Content-Type: text/plain; charset=UTF-8

On Fri, Oct 23, 2015 at 11:59 AM, Stefan Eissing
<stefan.eissing@greenbytes.de> wrote:
>
> The problem with the unlock in release is that the h2_mplx might have been destroyed by then, as the signal might give the lock to someone waiting.

Hm, h2_mplx_release_and_join() (which destroys the mplx) won't be
woken up until the mutex is released, since
apr_thread_cond_timedwait() acquires the mutex.

From dev-return-84423-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Fri Oct 23 10:09:25 2015
Return-Path: <dev-return-84423-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 8C5A818167
	for <apmail-httpd-dev-archive@www.apache.org>; Fri, 23 Oct 2015 10:09:25 +0000 (UTC)
Received: (qmail 68946 invoked by uid 500); 23 Oct 2015 10:09:25 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 68872 invoked by uid 500); 23 Oct 2015 10:09:25 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 68861 invoked by uid 99); 23 Oct 2015 10:09:25 -0000
Received: from Unknown (HELO spamd1-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 23 Oct 2015 10:09:25 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd1-us-west.apache.org (ASF Mail Server at spamd1-us-west.apache.org) with ESMTP id A2037C8524
	for <dev@httpd.apache.org>; Fri, 23 Oct 2015 10:09:24 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd1-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.099
X-Spam-Level:
X-Spam-Status: No, score=-0.099 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RP_MATCHES_RCVD=0.001, SPF_PASS=-0.001, URIBL_BLOCKED=0.001]
	autolearn=disabled
Authentication-Results: spamd1-us-west.apache.org (amavisd-new);
	dkim=pass (1024-bit key) header.d=greenbytes.de
Received: from mx1-us-west.apache.org ([10.40.0.8])
	by localhost (spamd1-us-west.apache.org [10.40.0.7]) (amavisd-new, port 10024)
	with ESMTP id cN9u4pJZcygm for <dev@httpd.apache.org>;
	Fri, 23 Oct 2015 10:09:16 +0000 (UTC)
Received: from mail.greenbytes.de (mail.greenbytes.de [217.91.35.233])
	by mx1-us-west.apache.org (ASF Mail Server at mx1-us-west.apache.org) with ESMTPS id 4999A20634
	for <dev@httpd.apache.org>; Fri, 23 Oct 2015 10:09:16 +0000 (UTC)
Received: from [192.168.178.41] (unknown [93.211.97.239])
	(using TLSv1 with cipher ECDHE-RSA-AES256-SHA (256/256 bits))
	(Client did not present a certificate)
	by mail.greenbytes.de (Postfix) with ESMTPSA id AF61B15A044D
	for <dev@httpd.apache.org>; Fri, 23 Oct 2015 12:09:14 +0200 (CEST)
DKIM-Signature: v=1; a=rsa-sha256; c=simple/simple; d=greenbytes.de; s=mail;
	t=1445594954; bh=KdBCtMc6I9/kMyswSXlCIfPwGYd2otqMqMTzVe6hpeQ=;
	h=Subject:From:In-Reply-To:Date:References:To:From;
	b=aRPR6jp99FjNiiPSaMF3DntSzEscd0cowtynDZx5VJ2QLvRZjqRU2YUxIPecwglgk
	 x6ov3Jg/wABP/GUIO0qJNJNXxMizSiSs9isugh0hh6UOI3qbkLBcJu+9FRVCf3Kveu
	 ot/ln6GPhwt524n/+wyPAEdD+ajk3W7glHT0kGBs=
Content-Type: text/plain; charset=us-ascii
Mime-Version: 1.0 (Mac OS X Mail 9.1 \(3096.5\))
Subject: Re: segfault analysis
From: Stefan Eissing <stefan.eissing@greenbytes.de>
In-Reply-To: <CAKQ1sVPuxy__cv0muoJOU3tEcmvJ81b2fpGOUd-OmT18-JEVFQ@mail.gmail.com>
Date: Fri, 23 Oct 2015 12:09:14 +0200
Content-Transfer-Encoding: quoted-printable
Message-Id: <E8FD0682-19F3-479C-9AB3-1CE28E365E24@greenbytes.de>
References: <14EF204A-C8E6-406E-A441-9030403297D6@greenbytes.de> <CAKQ1sVPVMrUkXemn2S21E7r2NnvGyaikZoPLpri6u9OHCgnBsg@mail.gmail.com> <CAKQ1sVN9UYq2TrFm-wF+0Bh=NsQDH_C82nGC4PqmH7PESVef-w@mail.gmail.com> <BCADC308-1CBA-451E-90E0-13B342435C8B@greenbytes.de> <CAKQ1sVPuxy__cv0muoJOU3tEcmvJ81b2fpGOUd-OmT18-JEVFQ@mail.gmail.com>
To: dev@httpd.apache.org
X-Mailer: Apple Mail (2.3096.5)

Yes, you are correct. The mutex holds. I had my head in java =
synchronized waits for a second *shudder*...

> Am 23.10.2015 um 12:05 schrieb Yann Ylavic <ylavic.dev@gmail.com>:
>=20
> On Fri, Oct 23, 2015 at 11:59 AM, Stefan Eissing
> <stefan.eissing@greenbytes.de> wrote:
>>=20
>> The problem with the unlock in release is that the h2_mplx might have =
been destroyed by then, as the signal might give the lock to someone =
waiting.
>=20
> Hm, h2_mplx_release_and_join() (which destroys the mplx) won't be
> woken up until the mutex is released, since
> apr_thread_cond_timedwait() acquires the mutex.


From dev-return-84424-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Fri Oct 23 10:13:21 2015
Return-Path: <dev-return-84424-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 023A618180
	for <apmail-httpd-dev-archive@www.apache.org>; Fri, 23 Oct 2015 10:13:21 +0000 (UTC)
Received: (qmail 75300 invoked by uid 500); 23 Oct 2015 10:13:20 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 75237 invoked by uid 500); 23 Oct 2015 10:13:20 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 75223 invoked by uid 99); 23 Oct 2015 10:13:20 -0000
Received: from Unknown (HELO spamd4-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 23 Oct 2015 10:13:20 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd4-us-west.apache.org (ASF Mail Server at spamd4-us-west.apache.org) with ESMTP id E2ACBC082C
	for <dev@httpd.apache.org>; Fri, 23 Oct 2015 10:13:19 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd4-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.12
X-Spam-Level:
X-Spam-Status: No, score=-0.12 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RCVD_IN_MSPIKE_H3=-0.01, RCVD_IN_MSPIKE_WL=-0.01, SPF_PASS=-0.001,
	URIBL_BLOCKED=0.001] autolearn=disabled
Authentication-Results: spamd4-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd4-us-west.apache.org [10.40.0.11]) (amavisd-new, port 10024)
	with ESMTP id 5toiakle52-m for <dev@httpd.apache.org>;
	Fri, 23 Oct 2015 10:13:13 +0000 (UTC)
Received: from mail-qk0-f169.google.com (mail-qk0-f169.google.com [209.85.220.169])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id 16E3128095
	for <dev@httpd.apache.org>; Fri, 23 Oct 2015 10:13:13 +0000 (UTC)
Received: by qkbl190 with SMTP id l190so68462324qkb.2
        for <dev@httpd.apache.org>; Fri, 23 Oct 2015 03:13:12 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        bh=d7jI70eq6YwxaDhveBcwbcXf4P+O1Cg4Wl11fIaLLGk=;
        b=J8YmNL14DAbvN90tA9+UoeQfvNsCrboFXppZVL8EgKaV2G94z9p2IqydjqIgviucfC
         lAq7gw1x2+hstRUYzFI1R6IEPUogOIOUi6krIa+QFFL80bt10XjlUE4z9sG3FknuC9ge
         qwyEdPqwdS5EmSQYyrlgFoCGd2dBsC+KTX/w73gfMCYwNXtumW3Aq4ou3MQSsR/AIsCQ
         /kYfRPBP+4RBPiNbvTM1VffJFg2fvqSmUsdTESy+Sne9M2u9Ih6UdRpZ2yaDZg9Xms0L
         PemP3/xVJW8CbpokrZ6AhTee2vGiGQW5+f/MrsH7319zAAzro4ICinYDo+Pa06P/Bhqm
         23Qw==
MIME-Version: 1.0
X-Received: by 10.140.216.87 with SMTP id m84mr25551776qhb.97.1445595192063;
 Fri, 23 Oct 2015 03:13:12 -0700 (PDT)
Received: by 10.55.156.213 with HTTP; Fri, 23 Oct 2015 03:13:12 -0700 (PDT)
In-Reply-To: <14EF204A-C8E6-406E-A441-9030403297D6@greenbytes.de>
References: <14EF204A-C8E6-406E-A441-9030403297D6@greenbytes.de>
Date: Fri, 23 Oct 2015 12:13:12 +0200
Message-ID: <CAKQ1sVMzW2YuFbqv+PzbJP=JeJ4gHouJaaL0CnkUFW4850p7+A@mail.gmail.com>
Subject: Re: segfault analysis
From: Yann Ylavic <ylavic.dev@gmail.com>
To: dev@httpd.apache.org
Content-Type: text/plain; charset=UTF-8

On Fri, Oct 23, 2015 at 10:42 AM, Stefan Eissing
<stefan.eissing@greenbytes.de> wrote:
>
> In regard to https://bz.apache.org/bugzilla/show_bug.cgi?id=58524

We possibly need this too:

Index: modules/http2/h2_worker.c
===================================================================
--- modules/http2/h2_worker.c    (revision 1710105)
+++ modules/http2/h2_worker.c    (working copy)
@@ -110,7 +110,7 @@ h2_worker *h2_worker_create(int id,
             return NULL;
         }

-        apr_thread_create(&w->thread, attr, execute, w, pool);
+        apr_thread_create(&w->thread, attr, execute, w, parent_pool);
     }
     return w;
 }
--

since the worker destroys itself in its own thread (pool == w->pool).

Also, where are the worker threads joined?

From dev-return-84425-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Fri Oct 23 10:21:25 2015
Return-Path: <dev-return-84425-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 416A7181B1
	for <apmail-httpd-dev-archive@www.apache.org>; Fri, 23 Oct 2015 10:21:25 +0000 (UTC)
Received: (qmail 90566 invoked by uid 500); 23 Oct 2015 10:21:24 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 90492 invoked by uid 500); 23 Oct 2015 10:21:24 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 90482 invoked by uid 99); 23 Oct 2015 10:21:24 -0000
Received: from Unknown (HELO spamd1-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 23 Oct 2015 10:21:24 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd1-us-west.apache.org (ASF Mail Server at spamd1-us-west.apache.org) with ESMTP id 34900C149C
	for <dev@httpd.apache.org>; Fri, 23 Oct 2015 10:21:24 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd1-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.102
X-Spam-Level:
X-Spam-Status: No, score=-0.102 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RCVD_IN_MSPIKE_H2=-0.001, SPF_PASS=-0.001] autolearn=disabled
Authentication-Results: spamd1-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-us-west.apache.org ([10.40.0.8])
	by localhost (spamd1-us-west.apache.org [10.40.0.7]) (amavisd-new, port 10024)
	with ESMTP id VqcIDinwcn5O for <dev@httpd.apache.org>;
	Fri, 23 Oct 2015 10:21:22 +0000 (UTC)
Received: from mail-qk0-f175.google.com (mail-qk0-f175.google.com [209.85.220.175])
	by mx1-us-west.apache.org (ASF Mail Server at mx1-us-west.apache.org) with ESMTPS id 837AE20562
	for <dev@httpd.apache.org>; Fri, 23 Oct 2015 10:21:22 +0000 (UTC)
Received: by qkcy65 with SMTP id y65so68713400qkc.0
        for <dev@httpd.apache.org>; Fri, 23 Oct 2015 03:21:16 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        bh=irgG+h6aK/9ZyBbfyPWmxigs6nn9uvvU7IkOCvLZd44=;
        b=JuBBMoUCI1H/UmQW6j+BRbDUDMWiZKTJi+HgEzdYhdiZe2JWZXK56j3hguACSRLbwq
         Nvnkqwn5oBgCiSeXQdBxEZH2PXGYdFTg073+g50eX+RGb7qCDglosbkmLVoYQfBEdhFY
         iMDNDFmZ2NyKmRqX6vD11RmfybQKqZCFn04ZKQGuYcR0TPwTvqXcuVUghKxtjWQq37Qa
         /dEHfkmammE0I+zEeZX1Ev/990X6Rc5TNHMFHT22FA/2FYvGrozJdKpyUHuGSohL+xTK
         ABE0g9b43pq8FmcrhaCfFOhS1FeA7Bbrgd8wDclQsR7taKA1UN2oBPzBMplKkvLjPrXl
         2ZEQ==
MIME-Version: 1.0
X-Received: by 10.140.96.71 with SMTP id j65mr24107012qge.92.1445595676054;
 Fri, 23 Oct 2015 03:21:16 -0700 (PDT)
Received: by 10.55.156.213 with HTTP; Fri, 23 Oct 2015 03:21:16 -0700 (PDT)
In-Reply-To: <CAKQ1sVMzW2YuFbqv+PzbJP=JeJ4gHouJaaL0CnkUFW4850p7+A@mail.gmail.com>
References: <14EF204A-C8E6-406E-A441-9030403297D6@greenbytes.de>
	<CAKQ1sVMzW2YuFbqv+PzbJP=JeJ4gHouJaaL0CnkUFW4850p7+A@mail.gmail.com>
Date: Fri, 23 Oct 2015 12:21:16 +0200
Message-ID: <CAKQ1sVM=uwOMQa3-yuEM3EN06K_dWF3yjkSgFyZcttFAKP1jNA@mail.gmail.com>
Subject: Re: segfault analysis
From: Yann Ylavic <ylavic.dev@gmail.com>
To: dev@httpd.apache.org
Content-Type: text/plain; charset=UTF-8

On Fri, Oct 23, 2015 at 12:13 PM, Yann Ylavic <ylavic.dev@gmail.com> wrote:
>
> since the worker destroys itself in its own thread (pool == w->pool).
>
> Also, where are the worker threads joined?

Actually I find both joining the worker thread and then
worker_destroy() should be done in h2_workers_destroy(), after
worker->aborted is signalled.

From dev-return-84426-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Fri Oct 23 10:23:59 2015
Return-Path: <dev-return-84426-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id CEC88181BC
	for <apmail-httpd-dev-archive@www.apache.org>; Fri, 23 Oct 2015 10:23:57 +0000 (UTC)
Received: (qmail 92071 invoked by uid 500); 23 Oct 2015 10:23:51 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 91989 invoked by uid 500); 23 Oct 2015 10:23:51 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 91979 invoked by uid 99); 23 Oct 2015 10:23:51 -0000
Received: from Unknown (HELO spamd4-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 23 Oct 2015 10:23:51 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd4-us-west.apache.org (ASF Mail Server at spamd4-us-west.apache.org) with ESMTP id A9190C082C
	for <dev@httpd.apache.org>; Fri, 23 Oct 2015 10:23:50 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd4-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.11
X-Spam-Level:
X-Spam-Status: No, score=-0.11 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	SPF_PASS=-0.001, T_RP_MATCHES_RCVD=-0.01, URIBL_BLOCKED=0.001]
	autolearn=disabled
Authentication-Results: spamd4-us-west.apache.org (amavisd-new);
	dkim=pass (1024-bit key) header.d=greenbytes.de
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd4-us-west.apache.org [10.40.0.11]) (amavisd-new, port 10024)
	with ESMTP id xaYoNT4rWth5 for <dev@httpd.apache.org>;
	Fri, 23 Oct 2015 10:23:43 +0000 (UTC)
Received: from mail.greenbytes.de (mail.greenbytes.de [217.91.35.233])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id 8C358204C9
	for <dev@httpd.apache.org>; Fri, 23 Oct 2015 10:23:42 +0000 (UTC)
Received: from [192.168.178.41] (unknown [93.211.97.239])
	(using TLSv1 with cipher ECDHE-RSA-AES256-SHA (256/256 bits))
	(Client did not present a certificate)
	by mail.greenbytes.de (Postfix) with ESMTPSA id E3B7B15A0485
	for <dev@httpd.apache.org>; Fri, 23 Oct 2015 12:23:41 +0200 (CEST)
DKIM-Signature: v=1; a=rsa-sha256; c=simple/simple; d=greenbytes.de; s=mail;
	t=1445595822; bh=ykmCCCtgquHRA3ngf0yLYw/Tn5StQ9fhuzX5MqMxak8=;
	h=Subject:From:In-Reply-To:Date:References:To:From;
	b=N/rTHk2eK4UXEU2yfXhRBNcw3nppIwkQnOvJq4INfvYPcVzQHWJGu6YgW/U0UEjbd
	 LYt4lhszLsRDcndqQQrjMqFIx5cIM8BLhUYaUBv3yoH0QvZy6kY79nkD8wUc4QubRJ
	 I8dX0rhajojhzJVuyyN841MS32lK+4VCxig7/YrA=
Content-Type: text/plain; charset=us-ascii
Mime-Version: 1.0 (Mac OS X Mail 9.1 \(3096.5\))
Subject: Re: segfault analysis
From: Stefan Eissing <stefan.eissing@greenbytes.de>
In-Reply-To: <CAKQ1sVMzW2YuFbqv+PzbJP=JeJ4gHouJaaL0CnkUFW4850p7+A@mail.gmail.com>
Date: Fri, 23 Oct 2015 12:23:41 +0200
Content-Transfer-Encoding: quoted-printable
Message-Id: <B51B0AFA-8D8B-4ECB-AB5F-FB40F479EE35@greenbytes.de>
References: <14EF204A-C8E6-406E-A441-9030403297D6@greenbytes.de> <CAKQ1sVMzW2YuFbqv+PzbJP=JeJ4gHouJaaL0CnkUFW4850p7+A@mail.gmail.com>
To: dev@httpd.apache.org
X-Mailer: Apple Mail (2.3096.5)

Code review is a fine thing...

Hmm, I think the best way to tackle this is to transfer the worker into =
a zombie set from worker_done(). Then in h2_workers_register(), which is =
called regularly and often, join the threads and destroy the zombie =
workers.

Allocating the worker from parent_pool is not good as workers =
appear/disappear during load changes and the parent pool will just =
continue to grow.

//Stefan

> Am 23.10.2015 um 12:13 schrieb Yann Ylavic <ylavic.dev@gmail.com>:
>=20
> On Fri, Oct 23, 2015 at 10:42 AM, Stefan Eissing
> <stefan.eissing@greenbytes.de> wrote:
>>=20
>> In regard to https://bz.apache.org/bugzilla/show_bug.cgi?id=3D58524
>=20
> We possibly need this too:
>=20
> Index: modules/http2/h2_worker.c
> =3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D
> --- modules/http2/h2_worker.c    (revision 1710105)
> +++ modules/http2/h2_worker.c    (working copy)
> @@ -110,7 +110,7 @@ h2_worker *h2_worker_create(int id,
>             return NULL;
>         }
>=20
> -        apr_thread_create(&w->thread, attr, execute, w, pool);
> +        apr_thread_create(&w->thread, attr, execute, w, parent_pool);
>     }
>     return w;
> }
> --
>=20
> since the worker destroys itself in its own thread (pool =3D=3D =
w->pool).
>=20
> Also, where are the worker threads joined?


From dev-return-84427-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Fri Oct 23 10:29:57 2015
Return-Path: <dev-return-84427-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 5628C18220
	for <apmail-httpd-dev-archive@www.apache.org>; Fri, 23 Oct 2015 10:29:57 +0000 (UTC)
Received: (qmail 14529 invoked by uid 500); 23 Oct 2015 10:29:56 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 14459 invoked by uid 500); 23 Oct 2015 10:29:56 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 14449 invoked by uid 99); 23 Oct 2015 10:29:56 -0000
Received: from Unknown (HELO spamd2-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 23 Oct 2015 10:29:56 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd2-us-west.apache.org (ASF Mail Server at spamd2-us-west.apache.org) with ESMTP id 64B341A2EA9
	for <dev@httpd.apache.org>; Fri, 23 Oct 2015 10:29:56 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd2-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.12
X-Spam-Level:
X-Spam-Status: No, score=-0.12 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RCVD_IN_MSPIKE_H3=-0.01, RCVD_IN_MSPIKE_WL=-0.01, SPF_PASS=-0.001,
	URIBL_BLOCKED=0.001] autolearn=disabled
Authentication-Results: spamd2-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-us-west.apache.org ([10.40.0.8])
	by localhost (spamd2-us-west.apache.org [10.40.0.9]) (amavisd-new, port 10024)
	with ESMTP id jOfPSBogE-p8 for <dev@httpd.apache.org>;
	Fri, 23 Oct 2015 10:29:49 +0000 (UTC)
Received: from mail-qk0-f173.google.com (mail-qk0-f173.google.com [209.85.220.173])
	by mx1-us-west.apache.org (ASF Mail Server at mx1-us-west.apache.org) with ESMTPS id 80A8220562
	for <dev@httpd.apache.org>; Fri, 23 Oct 2015 10:29:49 +0000 (UTC)
Received: by qkbl190 with SMTP id l190so68858061qkb.2
        for <dev@httpd.apache.org>; Fri, 23 Oct 2015 03:29:43 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        bh=y3/FbyUZzCZBo0D1RdGns1baqONerLPH0UeSToz2Nx4=;
        b=svRlG7W02ltQEXgrprsPSQQWjQezE0J+gGNBwddNusvAbRnuFfA/wgLv1DesTdkG5E
         XSGFdkS/FE9w4yq71rPq24x0ZvpPCIoAXJp7w+tz3/NsnZTRa3FnppIigzp7e0n2zHFu
         zG4vBUdetu+6hDquZxa/QP3D47x9ORrHDC4dKClFzBuIl6/vAt9M2sXhbrpbauiJe6q8
         7qO5BrcFdeGHFHGXPW4czhGXtu7bQhUlrch+LCG7UPigVxrsOOzju8Nn8Ne7sysE6Nt8
         dR5adA+MaiTi0l4Js8MLOC8tpBw7gOQ8C7B/z74Ivbvnh5nGVhp3/LIu7ZWdPs78scFv
         ORmA==
MIME-Version: 1.0
X-Received: by 10.140.43.183 with SMTP id e52mr24574439qga.38.1445596183672;
 Fri, 23 Oct 2015 03:29:43 -0700 (PDT)
Received: by 10.55.156.213 with HTTP; Fri, 23 Oct 2015 03:29:43 -0700 (PDT)
In-Reply-To: <B51B0AFA-8D8B-4ECB-AB5F-FB40F479EE35@greenbytes.de>
References: <14EF204A-C8E6-406E-A441-9030403297D6@greenbytes.de>
	<CAKQ1sVMzW2YuFbqv+PzbJP=JeJ4gHouJaaL0CnkUFW4850p7+A@mail.gmail.com>
	<B51B0AFA-8D8B-4ECB-AB5F-FB40F479EE35@greenbytes.de>
Date: Fri, 23 Oct 2015 12:29:43 +0200
Message-ID: <CAKQ1sVOWWfspb6nAuzHQb++UVUsSn7_bjjJeGnDfEr0wN+-p7g@mail.gmail.com>
Subject: Re: segfault analysis
From: Yann Ylavic <ylavic.dev@gmail.com>
To: dev@httpd.apache.org
Content-Type: text/plain; charset=UTF-8

On Fri, Oct 23, 2015 at 12:23 PM, Stefan Eissing
<stefan.eissing@greenbytes.de> wrote:
>
> Hmm, I think the best way to tackle this is to transfer the worker into a zombie set from worker_done(). Then in h2_workers_register(), which is called regularly and often, join the threads and destroy the zombie workers.

That's fine, given that workers are created/destroyed regularly
(didn't see that, h2_workers_create() seems to be called from child
init hook only).

Btw, you could also register the join logic in the worker pool
(pre_cleanup), and simply call apr_pool_destroy(w->pool) in the zombie
collector.

From dev-return-84428-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Fri Oct 23 12:13:51 2015
Return-Path: <dev-return-84428-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 6C83A185AB
	for <apmail-httpd-dev-archive@www.apache.org>; Fri, 23 Oct 2015 12:13:51 +0000 (UTC)
Received: (qmail 64495 invoked by uid 500); 23 Oct 2015 12:13:51 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 64431 invoked by uid 500); 23 Oct 2015 12:13:51 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 64421 invoked by uid 99); 23 Oct 2015 12:13:50 -0000
Received: from Unknown (HELO spamd1-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 23 Oct 2015 12:13:50 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd1-us-west.apache.org (ASF Mail Server at spamd1-us-west.apache.org) with ESMTP id 8C4F8C5060
	for <dev@httpd.apache.org>; Fri, 23 Oct 2015 12:13:50 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd1-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.1
X-Spam-Level:
X-Spam-Status: No, score=-0.1 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	SPF_PASS=-0.001, URIBL_BLOCKED=0.001] autolearn=disabled
Authentication-Results: spamd1-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd1-us-west.apache.org [10.40.0.7]) (amavisd-new, port 10024)
	with ESMTP id isRNlmRSyY1O for <dev@httpd.apache.org>;
	Fri, 23 Oct 2015 12:13:44 +0000 (UTC)
Received: from mail-io0-f172.google.com (mail-io0-f172.google.com [209.85.223.172])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id 21AF542B79
	for <dev@httpd.apache.org>; Fri, 23 Oct 2015 12:13:44 +0000 (UTC)
Received: by iofz202 with SMTP id z202so121645912iof.2
        for <dev@httpd.apache.org>; Fri, 23 Oct 2015 05:13:43 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        bh=ABSU56ppU2waUXLHeei/HJH0XnYWJdQ79l0eGRxuMqc=;
        b=gIV8wdUaIgdNGBl/wMij5IVWcb9MgtqaTPkKlXW45G+/vraMagWfPYjAzchLHkSmht
         wCdOlKDoSGHyCuWrkfGJ0xceUDO3SG2329uzzyd4epv7ruUxjceNVN97L4GepBK0fNtw
         rLYOGHWNZ0lHlYknwPz/aNdRN1gjC80zCJAT6bzYMhFubBgbFitOMyIB0y8YOJnR2+YD
         wnAIfJbTsei/RrWRG2sWkb9BlxocknKMBRDI1YNgXJ8UhXMBbS2icM+RoKP7jGMyPk/c
         7rkiLMeIppDl/RfnbdvAb/tnO/d+GA49r+/m7GzKu/8Y2Wj+WDyHBh0uMRQeLkXku9Ca
         Ll/Q==
MIME-Version: 1.0
X-Received: by 10.107.134.198 with SMTP id q67mr21965488ioi.90.1445602423741;
 Fri, 23 Oct 2015 05:13:43 -0700 (PDT)
Received: by 10.64.112.69 with HTTP; Fri, 23 Oct 2015 05:13:43 -0700 (PDT)
In-Reply-To: <6CC15279-1A67-4155-AC3C-57DF7D329C4E@jaguNET.com>
References: <CAKQ1sVO5if8hoWAES2o5fM-pWcYhRiLG1FOC-=7vKSEDj-5zAA@mail.gmail.com>
	<54F59B19.2040409@redhat.com>
	<6CC15279-1A67-4155-AC3C-57DF7D329C4E@jaguNET.com>
Date: Fri, 23 Oct 2015 08:13:43 -0400
Message-ID: <CALK=YjO07xshMnAgv9V8Ln+fz=6T=rCxUMS2VQV6QCKA4gEK6A@mail.gmail.com>
Subject: Re: mod_proxy's aside connections proposal
From: Eric Covener <covener@gmail.com>
To: Apache HTTP Server Development List <dev@httpd.apache.org>
Content-Type: text/plain; charset=UTF-8

On Tue, Mar 3, 2015 at 9:20 AM, Jim Jagielski <jim@jagunet.com> wrote:
> I guess the main question is what are the actual use-cases?


NTLM at the very least. That's the context it comes up in periodically.

From dev-return-84429-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Fri Oct 23 19:13:06 2015
Return-Path: <dev-return-84429-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 3B77F180FA
	for <apmail-httpd-dev-archive@www.apache.org>; Fri, 23 Oct 2015 19:13:06 +0000 (UTC)
Received: (qmail 54265 invoked by uid 500); 23 Oct 2015 19:13:00 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 54210 invoked by uid 500); 23 Oct 2015 19:13:00 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 54200 invoked by uid 99); 23 Oct 2015 19:13:00 -0000
Received: from Unknown (HELO spamd3-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 23 Oct 2015 19:13:00 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd3-us-west.apache.org (ASF Mail Server at spamd3-us-west.apache.org) with ESMTP id 3EBC61809A8
	for <dev@httpd.apache.org>; Fri, 23 Oct 2015 19:13:00 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd3-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 0.653
X-Spam-Level:
X-Spam-Status: No, score=0.653 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, SPF_NEUTRAL=0.652,
	URIBL_BLOCKED=0.001] autolearn=disabled
Authentication-Results: spamd3-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=comcast.net
Received: from mx1-us-west.apache.org ([10.40.0.8])
	by localhost (spamd3-us-west.apache.org [10.40.0.10]) (amavisd-new, port 10024)
	with ESMTP id f8kveSGpetT6 for <dev@httpd.apache.org>;
	Fri, 23 Oct 2015 19:12:50 +0000 (UTC)
Received: from resqmta-po-03v.sys.comcast.net (resqmta-po-03v.sys.comcast.net [96.114.154.162])
	by mx1-us-west.apache.org (ASF Mail Server at mx1-us-west.apache.org) with ESMTPS id 6062720562
	for <dev@httpd.apache.org>; Fri, 23 Oct 2015 19:12:50 +0000 (UTC)
Received: from resomta-po-16v.sys.comcast.net ([96.114.154.240])
	by resqmta-po-03v.sys.comcast.net with comcast
	id YjCJ1r0015BUCh401jCkS9; Fri, 23 Oct 2015 19:12:44 +0000
Received: from [192.168.199.10] ([69.251.84.114])
	by resomta-po-16v.sys.comcast.net with comcast
	id YjCk1r0012U0RYt01jCkBW; Fri, 23 Oct 2015 19:12:44 +0000
Content-Type: text/plain; charset=us-ascii
Mime-Version: 1.0 (Mac OS X Mail 8.2 \(2104\))
Subject: Re: master connection + mod_ssl + http2
From: Jim Jagielski <jim@jaguNET.com>
In-Reply-To: <CE0233E3-BB06-44B6-9C51-E8909D05C43F@sharp.fm>
Date: Fri, 23 Oct 2015 15:12:43 -0400
Content-Transfer-Encoding: quoted-printable
Message-Id: <E9C21971-1156-4F0B-BAD3-94DB42C7ECD9@jaguNET.com>
References: <AEF6E6A0-2B04-443F-AD62-97AEC4C2B9BB@greenbytes.de> <CE0233E3-BB06-44B6-9C51-E8909D05C43F@sharp.fm>
To: dev@httpd.apache.org
X-Mailer: Apple Mail (2.2104)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=comcast.net;
	s=q20140121; t=1445627564;
	bh=krp20LZZvKrIyR8wuKkGh0UQF2zXkJCo1rEtHGdwqm0=;
	h=Received:Received:Content-Type:Mime-Version:Subject:From:Date:
	 Message-Id:To;
	b=o1gPv32EH6q8LWkANkJlTWlBi42iv6LJyo9CgyFqjE4Mwr78Dx3GjInEcRl8rk8JK
	 nVgMGEIiKJM5l3/4iXBrQvGuVi2OisIl9/dwM2xUAco4U4GUQz5hGpWVfygkyQpH34
	 moi2vBZMaVqkcSrlpCHm9zxv/IErc6qYbNJKB5q4yH1+GzHUNe1E86kAMJxwnHw8ho
	 deGhPFbjxM7lHO/9dbUZYxdGzkOShv+oMos/eX2JEXwuLsdSCGvQUbYdErrhKk1vH9
	 4bG/u10nyWi/nyr99n2QVZPKQGhWnE7FS5oXpQagrc/CgS4ci3nwKOE7t76SlqVweP
	 lxSFSLuRGmnUQ==


> On Oct 21, 2015, at 10:25 AM, Graham Leggett <minfrin@sharp.fm> wrote:
>=20
> On 21 Oct 2015, at 2:42 PM, Stefan Eissing =
<stefan.eissing@greenbytes.de> wrote:
>=20
>> The basic changes:
>> 1. conn_rec->master is NULL for HTTP/1.1 connections, but points to =
the "real" connection for HTTP/2 requests.
>> 2. mod_ssl no longer initalizes any SSLConnRec* for slave connections =
(conn_rec->master !=3D NULL)
>> 3. lookup of ssl variables uses the master's sslconn->ssl if none is =
found on the connection itself
>> 4. ssl_hook_Access() that checks renegotiation fails with a FORBIDDEN =
for a slave connection with a note for the reason.
>>  This should allow mod_http2 to generate the correct HTTP/2 stream =
error
>> 5. ssl_hook_ReadReq() that checks for wrong host names now has an =
additional check for TLS compatiblity which compares
>>  protocol, cipher suite, certificate and key file/path names and =
verify mode of the request server against the
>>  handshake server. This compatibility is strict equality and not as =
sophisticated as the renegotiation checks.
>>=20
>> With these changes, mod_http2 has less work for the slave connection =
setup and no longer needs to disable ssl for those. While mod_ssl =
continues to be ignorant of mod_http2, as the same restrictions would =
apply to any protocol with slave connections. With a minor bump in MMN =
we can have this in the next 2.4.
>=20
> Not having looked at the patch yet, the above seems to make sense.
>=20

Sorry for the lateness:

+1


From dev-return-84430-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Fri Oct 23 19:18:32 2015
Return-Path: <dev-return-84430-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id D86031812B
	for <apmail-httpd-dev-archive@www.apache.org>; Fri, 23 Oct 2015 19:18:32 +0000 (UTC)
Received: (qmail 64111 invoked by uid 500); 23 Oct 2015 19:18:16 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 64045 invoked by uid 500); 23 Oct 2015 19:18:16 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 64035 invoked by uid 99); 23 Oct 2015 19:18:16 -0000
Received: from Unknown (HELO spamd2-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 23 Oct 2015 19:18:16 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd2-us-west.apache.org (ASF Mail Server at spamd2-us-west.apache.org) with ESMTP id 123891A2B54
	for <dev@httpd.apache.org>; Fri, 23 Oct 2015 19:18:16 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd2-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.109
X-Spam-Level:
X-Spam-Status: No, score=-0.109 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	T_RP_MATCHES_RCVD=-0.01, URIBL_BLOCKED=0.001] autolearn=disabled
Authentication-Results: spamd2-us-west.apache.org (amavisd-new);
	dkim=pass (1024-bit key) header.d=ptc.com
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd2-us-west.apache.org [10.40.0.9]) (amavisd-new, port 10024)
	with ESMTP id FPCxWbrVoce3 for <dev@httpd.apache.org>;
	Fri, 23 Oct 2015 19:18:07 +0000 (UTC)
Received: from mx2.ptc.com (mx2.ptc.com [12.11.148.189])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id CF81B42B79
	for <dev@httpd.apache.org>; Fri, 23 Oct 2015 19:18:07 +0000 (UTC)
DKIM-Signature: v=1; a=rsa-sha256; c=simple/simple;
  d=ptc.com; s=ptc; t=1445627887; x=1477163887;
  h=subject:to:references:from:message-id:date:mime-version:
   in-reply-to:content-transfer-encoding;
  bh=I+gUDmGXA9dOyflQBP9ev9sDwDSePGYhBf8C1OoOjZo=;
  b=rRJEbFQkUHTn2YfwX4tQJZlRaPo9C/O9DATdug4VVFDnvRiZf363LyS/
   HrfXc0xcwDaF+mP4fWPgMmUpYpwcfyIUjF2Ih8K4CrQUVtSYhQxsLyFn1
   8i4a0WekdVPIrY08DDZMpEZ9FhcspqdUdnLknMAzuJS3ojxE1yAPf6SpM
   I=;
X-IronPort-AV: E=Sophos;i="5.20,188,1444708800"; 
   d="scan'208";a="28644648"
Received: from hq-x10prdhub1.ptcnet.ptc.com ([132.253.198.27])
  by mx2-int.ptc.com with ESMTP/TLS/AES128-SHA; 23 Oct 2015 15:17:56 -0400
Received: from awang.ptcnet.ptc.com (132.253.8.73) by
 int-mail-hub1.ptcnet.ptc.com (132.253.201.252) with Microsoft SMTP Server id
 14.3.123.3; Fri, 23 Oct 2015 15:17:56 -0400
Subject: Re: [users@httpd] Chunked transfer delay with httpd 2.4 on Windows.
To: <dev@httpd.apache.org>
References: <5625642E.30708@ptc.com>
 <AB1691BE05AE7F4992697F2A0835627AC63489F4@VOEXM10W.internal.vodafone.com>
 <CAKQ1sVMhNzYPWHTvhdeV6z+mV2ZNq5vjHj=W1d6R46cOQ_-qhQ@mail.gmail.com>
 <AB1691BE05AE7F4992697F2A0835627AC6348C38@VOEXM10W.internal.vodafone.com>
 <CAKQ1sVNHz_aCLZ3um-NV8cJGnhR3FtE6wz+zGgusvW=MA+cO_A@mail.gmail.com>
 <CAKQ1sVO_E2AZBL9CPfpm=_RQEnHWRDWNg67NFKCqy-vC=uoJBw@mail.gmail.com>
 <562668DA.5060804@ptc.com> <56269CBD.5060701@ptc.com>
 <5627853C.4040006@apache.org>
 <CAKQ1sVORFAFNwxw92Xfxhd9pGs3vCgHgoA3SCty29BbvHoPeSQ@mail.gmail.com>
 <AB1691BE05AE7F4992697F2A0835627AC634A1A9@VOEXM10W.internal.vodafone.com>
 <CAKQ1sVNpfUzE5ubnHJVa2h-_y45nDSbXS8XbOZJp3x7HFaMb9Q@mail.gmail.com>
 <AB1691BE05AE7F4992697F2A0835627AC634A1E6@VOEXM10W.internal.vodafone.com>
 <CAKQ1sVP2jv3q-A8JH977Qtkr+jwb4WjJOo0CdPhGdVv5BmcbKw@mail.gmail.com>
 <5627A72B.7050302@ptc.com> <5627A8E4.4010108@ptc.com>
 <5628E7A9.2060708@ptc.com>
 <CAKQ1sVPTvuptcpzeEcQcTz3JZD9E=q0vOMT48HZ4zLi8_KAozQ@mail.gmail.com>
From: Andy Wang <awang@ptc.com>
Message-ID: <562A87E4.9020406@ptc.com>
Date: Fri, 23 Oct 2015 14:17:56 -0500
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:38.0) Gecko/20100101
 Thunderbird/38.3.0
MIME-Version: 1.0
In-Reply-To: <CAKQ1sVPTvuptcpzeEcQcTz3JZD9E=q0vOMT48HZ4zLi8_KAozQ@mail.gmail.com>
Content-Type: text/plain; charset="windows-1252"; format=flowed
Content-Transfer-Encoding: 7bit
X-Originating-IP: [132.253.8.73]



On 10/22/2015 04:50 PM, Yann Ylavic wrote:
> On Thu, Oct 22, 2015 at 3:42 PM, Andy Wang <awang@ptc.com> wrote:
>>
>> Tested with the patch and looks good.
>
> Not that much actually, the patch fails to consume the CRLFs, and
> hence can end up in an infinite loop.
>
> So I'm attaching a new one here (committed in trunk with a larger
> scope, this version is for 2.4.x and limited to your use case).
> Could you give it a (new) try please (I have already done some testing
> but it's probably worth passing your tests, before I can propose its
> backport to 2.4.x)?
> While the previous patch could not handle more than a single
> (trailing) [CR]LF, this new one should (up to ten, which is the new
> limit for tolerated blank lines in between requests).


The new one works as well.  My VMs that I use for my actual test cases 
are all in a logistics nightmare right now, so I can't do anything more 
thorough than the specific point test, but hopefully when I build the 
next httpd that contains this they'll be back up and I can put things 
through a more thorough cycle.

I'm pretty much only equipped to reproduce the specific problem right now.

That said, this whole, why does it only happen on Windows and why can't 
I simulate a request using another client has been bugging me, so I 
decided to go back to pre-patch and enable dumpio and try to compare the 
two.

guess what
I cannot get the problem to occur with dumpio enabled now.  As soon as 
it's enabled, the requests respond immediately.

Disable dumpio, 5000ms.

I give up.  The plugin developer fixed their plugin, you made apache 
more accepting (thank you very much again), and I'm going to just 
pretend this whole issue never happened :)

Andy


From dev-return-84431-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Fri Oct 23 19:22:43 2015
Return-Path: <dev-return-84431-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 876AA1815D
	for <apmail-httpd-dev-archive@www.apache.org>; Fri, 23 Oct 2015 19:22:43 +0000 (UTC)
Received: (qmail 78450 invoked by uid 500); 23 Oct 2015 19:22:33 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 78368 invoked by uid 500); 23 Oct 2015 19:22:33 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 78358 invoked by uid 99); 23 Oct 2015 19:22:33 -0000
Received: from Unknown (HELO spamd1-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 23 Oct 2015 19:22:33 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd1-us-west.apache.org (ASF Mail Server at spamd1-us-west.apache.org) with ESMTP id 37A7DC1855
	for <dev@httpd.apache.org>; Fri, 23 Oct 2015 19:22:33 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd1-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.1
X-Spam-Level:
X-Spam-Status: No, score=-0.1 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	SPF_PASS=-0.001, URIBL_BLOCKED=0.001] autolearn=disabled
Authentication-Results: spamd1-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-us-west.apache.org ([10.40.0.8])
	by localhost (spamd1-us-west.apache.org [10.40.0.7]) (amavisd-new, port 10024)
	with ESMTP id xEsun-v5nFlX for <dev@httpd.apache.org>;
	Fri, 23 Oct 2015 19:22:28 +0000 (UTC)
Received: from mail-io0-f178.google.com (mail-io0-f178.google.com [209.85.223.178])
	by mx1-us-west.apache.org (ASF Mail Server at mx1-us-west.apache.org) with ESMTPS id 42D6D2118F
	for <dev@httpd.apache.org>; Fri, 23 Oct 2015 19:22:28 +0000 (UTC)
Received: by ioll68 with SMTP id l68so135022361iol.3
        for <dev@httpd.apache.org>; Fri, 23 Oct 2015 12:22:27 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        bh=OkSxhB2pGLSfKDwH+uKuRAmKf1MVpqTvTxR9GYHemAw=;
        b=GHBSlhDkBiv0RD/k/HplzRr+8FOvQTtnqwskne5cD96ClglO4YDssMuKzhGKgyQh0P
         19b1rVTJaSmz4I92pP2nKOPJm3rVnz6Ec3AydTjimu5vu+m3hFwWOfuMWCxcJfRwoeG0
         ulj4y6okLwLFTwIjZKkNZ0jr57fQWN298ElZk6JStCi579eMwWpiZLOndpRVYhed9uia
         Rs2Ids+ELAz62S1e+cgpMUuOPcsieualKl4P4fgAYr5WNEfBevNfxGVdMnXHafNARyYv
         C2c++ADvqsdtOCu9n5C7C6QdT9KT5VoUnHo/IzfcD2uzJVTuo3Tzfk8Ng8ksvi+ZWeBw
         /Asg==
MIME-Version: 1.0
X-Received: by 10.107.134.198 with SMTP id q67mr24515305ioi.90.1445628147568;
 Fri, 23 Oct 2015 12:22:27 -0700 (PDT)
Received: by 10.64.112.69 with HTTP; Fri, 23 Oct 2015 12:22:27 -0700 (PDT)
In-Reply-To: <bug-57785-7868-m23qZGIuFo@https.bz.apache.org/bugzilla/>
References: <bug-57785-7868@https.bz.apache.org/bugzilla/>
	<bug-57785-7868-m23qZGIuFo@https.bz.apache.org/bugzilla/>
Date: Fri, 23 Oct 2015 15:22:27 -0400
Message-ID: <CALK=YjNd-MXfaWXDx-cxy3n-+4YmrScw=+6HZZgnx7_--EhLHw@mail.gmail.com>
Subject: Fwd: [Bug 57785] REDIRECT_URL is not suitable for use in
 server-generated pages
From: Eric Covener <covener@gmail.com>
To: Apache HTTP Server Development List <dev@httpd.apache.org>
Content-Type: text/plain; charset=UTF-8

My opinion is to make it opt-in before the next 2.4, but I am not
committed to that.

Before I do doc, any other thoughts?

http://people.apache.org/~covener/patches/redirecturl-optin.diff

This adds a directive to core.c called QualifyRedirectURL that  must
be set to ON to run the 2.4.17 code.

---------- Forwarded message ----------
From:  <bugzilla@apache.org>
Date: Fri, Oct 23, 2015 at 12:55 PM
Subject: [Bug 57785] REDIRECT_URL is not suitable for use in
server-generated pages
To: bugs@httpd.apache.org


https://bz.apache.org/bugzilla/show_bug.cgi?id=57785

--- Comment #7 from Jacob P <jacob.perkins@cpanel.net> ---
Here at cPanel we are reverting our 2.4.17 release and are going to re-release
2.4.16. Too many issues with mod_rewrite/REDIRECT_URL causing a *lot* of
applications to stop working.

--
You are receiving this mail because:
You are the assignee for the bug.

---------------------------------------------------------------------
To unsubscribe, e-mail: bugs-unsubscribe@httpd.apache.org
For additional commands, e-mail: bugs-help@httpd.apache.org



-- 
Eric Covener
covener@gmail.com

From dev-return-84432-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Fri Oct 23 19:40:00 2015
Return-Path: <dev-return-84432-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 0595D18296
	for <apmail-httpd-dev-archive@www.apache.org>; Fri, 23 Oct 2015 19:40:00 +0000 (UTC)
Received: (qmail 39322 invoked by uid 500); 23 Oct 2015 19:39:53 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 39256 invoked by uid 500); 23 Oct 2015 19:39:53 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 39246 invoked by uid 99); 23 Oct 2015 19:39:53 -0000
Received: from Unknown (HELO spamd2-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 23 Oct 2015 19:39:53 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd2-us-west.apache.org (ASF Mail Server at spamd2-us-west.apache.org) with ESMTP id E2A141A06F5
	for <dev@httpd.apache.org>; Fri, 23 Oct 2015 19:39:52 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd2-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.121
X-Spam-Level:
X-Spam-Status: No, score=-0.121 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RCVD_IN_MSPIKE_H3=-0.01, RCVD_IN_MSPIKE_WL=-0.01, SPF_PASS=-0.001]
	autolearn=disabled
Authentication-Results: spamd2-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-us-west.apache.org ([10.40.0.8])
	by localhost (spamd2-us-west.apache.org [10.40.0.9]) (amavisd-new, port 10024)
	with ESMTP id h8OuKjfCnBWZ for <dev@httpd.apache.org>;
	Fri, 23 Oct 2015 19:39:52 +0000 (UTC)
Received: from mail-qk0-f173.google.com (mail-qk0-f173.google.com [209.85.220.173])
	by mx1-us-west.apache.org (ASF Mail Server at mx1-us-west.apache.org) with ESMTPS id 1E11421270
	for <dev@httpd.apache.org>; Fri, 23 Oct 2015 19:39:52 +0000 (UTC)
Received: by qkcy65 with SMTP id y65so86681440qkc.0
        for <dev@httpd.apache.org>; Fri, 23 Oct 2015 12:39:51 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        bh=SHKYHtl+Av7noEZa9X6kKxzRKoQ41ZHcX3WAm5/FWm8=;
        b=F0wtkeN0zXEGcoHNvBP9PPRqfxrF90D+VGK+AHCIMfvFYrXE+uKrg+xtcwdlk/Fu6w
         v64y97KpqRXUdznCd47qk43iyBu9khUgFc+LUdaj39MmQ18dm3tDo7dtjhi12UBO5vwO
         +p2bHcal8zNIoxMMVOEipLn7cUVrD2mwkazWnMl62hvMICtvV+Et0KiJgG2gBLf/egy/
         t+nHahcQ1Wv90iUDlxSiYMG7S98BMOVDAmyyp3xImUtWdbUS21rkO4dm5M6tTBoakFtB
         fyckvXCbCPWHea2CfAbRtFI3Lfw+/IC44VKLNoVTcZ/pKBKLORnMYaH2f0M3rRbGndCi
         YIdw==
MIME-Version: 1.0
X-Received: by 10.55.209.93 with SMTP id s90mr27897827qki.55.1445629191461;
 Fri, 23 Oct 2015 12:39:51 -0700 (PDT)
Received: by 10.55.156.213 with HTTP; Fri, 23 Oct 2015 12:39:51 -0700 (PDT)
In-Reply-To: <CALK=YjNd-MXfaWXDx-cxy3n-+4YmrScw=+6HZZgnx7_--EhLHw@mail.gmail.com>
References: <bug-57785-7868@https.bz.apache.org/bugzilla/>
	<bug-57785-7868-m23qZGIuFo@https.bz.apache.org/bugzilla/>
	<CALK=YjNd-MXfaWXDx-cxy3n-+4YmrScw=+6HZZgnx7_--EhLHw@mail.gmail.com>
Date: Fri, 23 Oct 2015 21:39:51 +0200
Message-ID: <CAKQ1sVO9EJH-R5mH+daRjhexnu2EUU3XsXXMU9ed0NZsFVpcpA@mail.gmail.com>
Subject: Re: [Bug 57785] REDIRECT_URL is not suitable for use in
 server-generated pages
From: Yann Ylavic <ylavic.dev@gmail.com>
To: dev@httpd.apache.org
Content-Type: text/plain; charset=UTF-8

On Fri, Oct 23, 2015 at 9:22 PM, Eric Covener <covener@gmail.com> wrote:
> My opinion is to make it opt-in before the next 2.4, but I am not
> committed to that.
>
> Before I do doc, any other thoughts?
>
> http://people.apache.org/~covener/patches/redirecturl-optin.diff

Looks sensible, +1

From dev-return-84433-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Fri Oct 23 20:20:16 2015
Return-Path: <dev-return-84433-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id A621C1842E
	for <apmail-httpd-dev-archive@www.apache.org>; Fri, 23 Oct 2015 20:20:16 +0000 (UTC)
Received: (qmail 36696 invoked by uid 500); 23 Oct 2015 20:20:16 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 36620 invoked by uid 500); 23 Oct 2015 20:20:16 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 36609 invoked by uid 99); 23 Oct 2015 20:20:15 -0000
Received: from Unknown (HELO spamd3-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 23 Oct 2015 20:20:15 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd3-us-west.apache.org (ASF Mail Server at spamd3-us-west.apache.org) with ESMTP id 83018180992
	for <dev@httpd.apache.org>; Fri, 23 Oct 2015 20:20:15 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd3-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 2.989
X-Spam-Level: **
X-Spam-Status: No, score=2.989 tagged_above=-999 required=6.31
	tests=[HTML_MESSAGE=3, SPF_HELO_PASS=-0.001, SPF_PASS=-0.001,
	T_RP_MATCHES_RCVD=-0.01, URIBL_BLOCKED=0.001] autolearn=disabled
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd3-us-west.apache.org [10.40.0.10]) (amavisd-new, port 10024)
	with ESMTP id if9xx-mACvND for <dev@httpd.apache.org>;
	Fri, 23 Oct 2015 20:20:08 +0000 (UTC)
Received: from mx1.cpanel.net (mx1.cpanel.net [208.74.121.68])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id 5C21220750
	for <dev@httpd.apache.org>; Fri, 23 Oct 2015 20:20:07 +0000 (UTC)
Received: from [208.74.121.106] (port=62102 helo=[10.1.4.91])
	by mx1.cpanel.net with esmtpsa (TLSv1:DHE-RSA-AES256-SHA:256)
	(Exim 4.86)
	(envelope-from <jacob.perkins@cpanel.net>)
	id 1Zpioi-000CZM-6M
	for dev@httpd.apache.org; Fri, 23 Oct 2015 15:20:00 -0500
Content-Type: multipart/signed; boundary="Apple-Mail=_CED4E497-6686-4E4D-A335-38D143707F5A"; protocol="application/pgp-signature"; micalg=pgp-sha512
Mime-Version: 1.0 (Mac OS X Mail 9.1 \(3096.5\))
Subject: Re: [Bug 57785] REDIRECT_URL is not suitable for use in server-generated pages
X-Pgp-Agent: GPGMail 2.6b2
From: Jacob Perkins <jacob.perkins@cpanel.net>
In-Reply-To: <CAKQ1sVO9EJH-R5mH+daRjhexnu2EUU3XsXXMU9ed0NZsFVpcpA@mail.gmail.com>
Date: Fri, 23 Oct 2015 15:20:02 -0500
Message-Id: <96E128FA-4C26-4432-A95C-48468C589C80@cpanel.net>
References: <bug-57785-7868@https.bz.apache.org/bugzilla/> <bug-57785-7868-m23qZGIuFo@https.bz.apache.org/bugzilla/> <CALK=YjNd-MXfaWXDx-cxy3n-+4YmrScw=+6HZZgnx7_--EhLHw@mail.gmail.com> <CAKQ1sVO9EJH-R5mH+daRjhexnu2EUU3XsXXMU9ed0NZsFVpcpA@mail.gmail.com>
To: dev@httpd.apache.org
X-Mailer: Apple Mail (2.3096.5)
X-AntiAbuse: This header was added to track abuse, please include it with any abuse report
X-AntiAbuse: Primary Hostname - mx1.cpanel.net
X-AntiAbuse: Original Domain - httpd.apache.org
X-AntiAbuse: Originator/Caller UID/GID - [47 12] / [47 12]
X-AntiAbuse: Sender Address Domain - cpanel.net
X-Get-Message-Sender-Via: mx1.cpanel.net: authenticated_id: jacob.perkins@cpanel.net
X-Authenticated-Sender: mx1.cpanel.net: jacob.perkins@cpanel.net


--Apple-Mail=_CED4E497-6686-4E4D-A335-38D143707F5A
Content-Type: multipart/alternative;
	boundary="Apple-Mail=_26EA5965-5019-4EBF-8522-D16CFD39CCC3"


--Apple-Mail=_26EA5965-5019-4EBF-8522-D16CFD39CCC3
Content-Transfer-Encoding: quoted-printable
Content-Type: text/plain;
	charset=utf-8

+1 on this as well. That looks like a good fix that won=E2=80=99t break =
existing functionality. I know a lot of apps are working on updates now =
to fix these changes, but it=E2=80=99ll still be good to have this =
pushed back a bit.

Thank you!
=E2=80=94
Jacob Perkins
Product Owner
cPanel Inc.

jacob.perkins@cpanel.net <mailto:jacob.perkins@cpanel.net>
Office:  713-529-0800 x 4046
Cell:  713-560-8655

> On Oct 23, 2015, at 2:39 PM, Yann Ylavic <ylavic.dev@gmail.com> wrote:
>=20
> On Fri, Oct 23, 2015 at 9:22 PM, Eric Covener <covener@gmail.com> =
wrote:
>> My opinion is to make it opt-in before the next 2.4, but I am not
>> committed to that.
>>=20
>> Before I do doc, any other thoughts?
>>=20
>> http://people.apache.org/~covener/patches/redirecturl-optin.diff
>=20
> Looks sensible, +1


--Apple-Mail=_26EA5965-5019-4EBF-8522-D16CFD39CCC3
Content-Transfer-Encoding: quoted-printable
Content-Type: text/html;
	charset=utf-8

<html><head><meta http-equiv=3D"Content-Type" content=3D"text/html =
charset=3Dutf-8"></head><body style=3D"word-wrap: break-word; =
-webkit-nbsp-mode: space; -webkit-line-break: after-white-space;" =
class=3D"">+1 on this as well. That looks like a good fix that won=E2=80=99=
t break existing functionality. I know a lot of apps are working on =
updates now to fix these changes, but it=E2=80=99ll still be good to =
have this pushed back a bit.<div class=3D""><br class=3D""></div><div =
class=3D"">Thank you!<div apple-content-edited=3D"true" class=3D""><div =
style=3D"color: rgb(0, 0, 0); font-family: Helvetica; font-size: 12px; =
font-style: normal; font-variant: normal; font-weight: normal; =
letter-spacing: normal; line-height: normal; text-align: -webkit-auto; =
text-indent: 0px; text-transform: none; white-space: normal; =
word-spacing: 0px; -webkit-text-stroke-width: 0px; orphans: 2; widows: =
2; word-wrap: break-word; -webkit-nbsp-mode: space; -webkit-line-break: =
after-white-space;" class=3D"">=E2=80=94</div><div style=3D"color: =
rgb(0, 0, 0); font-family: Helvetica; font-size: 12px; font-style: =
normal; font-variant: normal; font-weight: normal; letter-spacing: =
normal; line-height: normal; text-align: -webkit-auto; text-indent: 0px; =
text-transform: none; white-space: normal; word-spacing: 0px; =
-webkit-text-stroke-width: 0px; orphans: 2; widows: 2; word-wrap: =
break-word; -webkit-nbsp-mode: space; -webkit-line-break: =
after-white-space;" class=3D"">Jacob Perkins<br class=3D""></div><div =
style=3D"color: rgb(0, 0, 0); font-family: Helvetica; font-size: 12px; =
font-style: normal; font-variant: normal; font-weight: normal; =
letter-spacing: normal; line-height: normal; text-align: -webkit-auto; =
text-indent: 0px; text-transform: none; white-space: normal; =
word-spacing: 0px; -webkit-text-stroke-width: 0px; orphans: 2; widows: =
2; word-wrap: break-word; -webkit-nbsp-mode: space; -webkit-line-break: =
after-white-space;" class=3D"">Product Owner</div><div style=3D"color: =
rgb(0, 0, 0); font-family: Helvetica; font-size: 12px; font-style: =
normal; font-variant: normal; font-weight: normal; letter-spacing: =
normal; line-height: normal; text-align: -webkit-auto; text-indent: 0px; =
text-transform: none; white-space: normal; word-spacing: 0px; =
-webkit-text-stroke-width: 0px; orphans: 2; widows: 2; word-wrap: =
break-word; -webkit-nbsp-mode: space; -webkit-line-break: =
after-white-space;" class=3D""><b class=3D""><font color=3D"#ff7c00" =
class=3D"">cPanel Inc.</font></b></div><div style=3D"color: rgb(0, 0, =
0); font-family: Helvetica; font-size: 12px; font-style: normal; =
font-variant: normal; font-weight: normal; letter-spacing: normal; =
line-height: normal; text-align: -webkit-auto; text-indent: 0px; =
text-transform: none; white-space: normal; word-spacing: 0px; =
-webkit-text-stroke-width: 0px; orphans: 2; widows: 2; word-wrap: =
break-word; -webkit-nbsp-mode: space; -webkit-line-break: =
after-white-space;" class=3D""><br class=3D""></div><div style=3D"color: =
rgb(0, 0, 0); font-family: Helvetica; font-size: 12px; font-style: =
normal; font-variant: normal; font-weight: normal; letter-spacing: =
normal; line-height: normal; text-align: -webkit-auto; text-indent: 0px; =
text-transform: none; white-space: normal; word-spacing: 0px; =
-webkit-text-stroke-width: 0px; orphans: 2; widows: 2; word-wrap: =
break-word; -webkit-nbsp-mode: space; -webkit-line-break: =
after-white-space;" class=3D""><a href=3D"mailto:jacob.perkins@cpanel.net"=
 class=3D"">jacob.perkins@cpanel.net</a></div><div style=3D"color: =
rgb(0, 0, 0); font-family: Helvetica; font-size: 12px; font-style: =
normal; font-variant: normal; font-weight: normal; letter-spacing: =
normal; line-height: normal; text-align: -webkit-auto; text-indent: 0px; =
text-transform: none; white-space: normal; word-spacing: 0px; =
-webkit-text-stroke-width: 0px; orphans: 2; widows: 2; word-wrap: =
break-word; -webkit-nbsp-mode: space; -webkit-line-break: =
after-white-space;" class=3D"">Office: &nbsp;713-529-0800 =
x&nbsp;4046</div><div style=3D"color: rgb(0, 0, 0); font-family: =
Helvetica; font-size: 12px; font-style: normal; font-variant: normal; =
font-weight: normal; letter-spacing: normal; line-height: normal; =
text-align: -webkit-auto; text-indent: 0px; text-transform: none; =
white-space: normal; word-spacing: 0px; -webkit-text-stroke-width: 0px; =
orphans: 2; widows: 2; word-wrap: break-word; -webkit-nbsp-mode: space; =
-webkit-line-break: after-white-space;" class=3D"">Cell: =
&nbsp;713-560-8655</div>
</div>
<br class=3D""><div><blockquote type=3D"cite" class=3D""><div =
class=3D"">On Oct 23, 2015, at 2:39 PM, Yann Ylavic &lt;<a =
href=3D"mailto:ylavic.dev@gmail.com" =
class=3D"">ylavic.dev@gmail.com</a>&gt; wrote:</div><br =
class=3D"Apple-interchange-newline"><div class=3D""><div class=3D"">On =
Fri, Oct 23, 2015 at 9:22 PM, Eric Covener &lt;<a =
href=3D"mailto:covener@gmail.com" class=3D"">covener@gmail.com</a>&gt; =
wrote:<br class=3D""><blockquote type=3D"cite" class=3D"">My opinion is =
to make it opt-in before the next 2.4, but I am not<br =
class=3D"">committed to that.<br class=3D""><br class=3D"">Before I do =
doc, any other thoughts?<br class=3D""><br class=3D""><a =
href=3D"http://people.apache.org/~covener/patches/redirecturl-optin.diff" =
class=3D"">http://people.apache.org/~covener/patches/redirecturl-optin.dif=
f</a><br class=3D""></blockquote><br class=3D"">Looks sensible, +1<br =
class=3D""></div></div></blockquote></div><br =
class=3D""></div></body></html>=

--Apple-Mail=_26EA5965-5019-4EBF-8522-D16CFD39CCC3--

--Apple-Mail=_CED4E497-6686-4E4D-A335-38D143707F5A
Content-Transfer-Encoding: 7bit
Content-Disposition: attachment;
	filename=signature.asc
Content-Type: application/pgp-signature;
	name=signature.asc
Content-Description: Message signed with OpenPGP using GPGMail

-----BEGIN PGP SIGNATURE-----
Comment: GPGTools - https://gpgtools.org

iQEcBAEBCgAGBQJWKpZzAAoJEIo8JcFLoqwqGicH/RKIJ5WDk6+rH7ZckMrcI9WZ
LSMXnzGyHfnMmkxYvyMKStR7Yp7V4AnQQ+RySb2ynf35D5zIPd0l90+KmnDeZWD3
dx9Zoigej5U/TG4tO+xfD4sYXbOsgfxpzXR5cgpzB/VErHqvFOnVDxOLpqHJdPk/
+R0RI8F8Wud07SATxLjdBHwrlhFTEKM7KWi67/SZTNlSTCzqzzfwtNWJbRo0jkkO
b790HcYOutJa3PF3EylQDo6ZTCAEo1lg4BwdSgZzuIxpSaKMqvAriEfna5jlm1eq
yqYUHLvOf1XE/8ZjDYBS5Js9etLJTW4PHo/Ly4JTk0toDZLhNMrQIVi8oMGSUu8=
=Ps+Z
-----END PGP SIGNATURE-----

--Apple-Mail=_CED4E497-6686-4E4D-A335-38D143707F5A--

From dev-return-84434-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Fri Oct 23 21:58:49 2015
Return-Path: <dev-return-84434-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 1538C1888C
	for <apmail-httpd-dev-archive@www.apache.org>; Fri, 23 Oct 2015 21:58:49 +0000 (UTC)
Received: (qmail 86508 invoked by uid 500); 23 Oct 2015 21:58:48 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 86429 invoked by uid 500); 23 Oct 2015 21:58:48 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 86419 invoked by uid 99); 23 Oct 2015 21:58:48 -0000
Received: from Unknown (HELO spamd1-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 23 Oct 2015 21:58:48 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd1-us-west.apache.org (ASF Mail Server at spamd1-us-west.apache.org) with ESMTP id 26FD5C632F
	for <dev@httpd.apache.org>; Fri, 23 Oct 2015 21:58:48 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd1-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 3.865
X-Spam-Level: ***
X-Spam-Status: No, score=3.865 tagged_above=-999 required=6.31
	tests=[FSL_HELO_NON_FQDN_1=0.001, KAM_LAZY_DOMAIN_SECURITY=1,
	KAM_LINKBAIT=2.5, RCVD_IN_SORBS_DUL=0.001, RDNS_DYNAMIC=0.363]
	autolearn=disabled
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd1-us-west.apache.org [10.40.0.7]) (amavisd-new, port 10024)
	with ESMTP id 752YyC9MPEkY for <dev@httpd.apache.org>;
	Fri, 23 Oct 2015 21:58:47 +0000 (UTC)
Received: from baldur (cpc36-newt30-2-0-cust898.19-3.cable.virginm.net [82.32.195.131])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTP id EA81B20B89
	for <dev@httpd.apache.org>; Fri, 23 Oct 2015 21:58:46 +0000 (UTC)
Received: from baldur (localhost [127.0.0.1])
	by baldur (Postfix) with ESMTP id 4989FC1B9E50
	for <dev@httpd.apache.org>; Fri, 23 Oct 2015 22:58:39 +0100 (BST)
Date: Fri, 23 Oct 2015 22:58:36 +0100
From: Nick Kew <nick@webthing.com>
To: dev@httpd.apache.org
Subject: Re: [Bug 57785] REDIRECT_URL is not suitable for use in
 server-generated pages
Message-ID: <20151023225836.4adecac2@baldur>
In-Reply-To: <CALK=YjNd-MXfaWXDx-cxy3n-+4YmrScw=+6HZZgnx7_--EhLHw@mail.gmail.com>
References: <bug-57785-7868@https.bz.apache.org/bugzilla/>
	<bug-57785-7868-m23qZGIuFo@https.bz.apache.org/bugzilla/>
	<CALK=YjNd-MXfaWXDx-cxy3n-+4YmrScw=+6HZZgnx7_--EhLHw@mail.gmail.com>
X-Mailer: Claws Mail 3.7.4 (GTK+ 2.20.1; i486-pc-linux-gnu)
Mime-Version: 1.0
Content-Type: text/plain; charset=US-ASCII
Content-Transfer-Encoding: 7bit

On Fri, 23 Oct 2015 15:22:27 -0400
Eric Covener <covener@gmail.com> wrote:

> My opinion is to make it opt-in before the next 2.4, but I am not
> committed to that.

Hehe.  I was leaning towards introducing separate vars for
full URL and fragment.  But your patch looks good to me.

-- 
Nick Kew

From dev-return-84435-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Sat Oct 24 15:49:44 2015
Return-Path: <dev-return-84435-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 03AA318FDD
	for <apmail-httpd-dev-archive@www.apache.org>; Sat, 24 Oct 2015 15:49:44 +0000 (UTC)
Received: (qmail 62612 invoked by uid 500); 24 Oct 2015 15:49:43 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 62545 invoked by uid 500); 24 Oct 2015 15:49:43 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 62535 invoked by uid 99); 24 Oct 2015 15:49:43 -0000
Received: from Unknown (HELO spamd3-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 24 Oct 2015 15:49:43 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd3-us-west.apache.org (ASF Mail Server at spamd3-us-west.apache.org) with ESMTP id CA0D9180992
	for <dev@httpd.apache.org>; Sat, 24 Oct 2015 15:49:42 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd3-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 0.652
X-Spam-Level:
X-Spam-Status: No, score=0.652 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, SPF_NEUTRAL=0.652]
	autolearn=disabled
Authentication-Results: spamd3-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=comcast.net
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd3-us-west.apache.org [10.40.0.10]) (amavisd-new, port 10024)
	with ESMTP id ChocMKj3mNLz for <dev@httpd.apache.org>;
	Sat, 24 Oct 2015 15:49:36 +0000 (UTC)
Received: from resqmta-ch2-01v.sys.comcast.net (resqmta-ch2-01v.sys.comcast.net [69.252.207.33])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id 6B78620751
	for <dev@httpd.apache.org>; Sat, 24 Oct 2015 15:49:35 +0000 (UTC)
Received: from resomta-ch2-11v.sys.comcast.net ([69.252.207.107])
	by resqmta-ch2-01v.sys.comcast.net with comcast
	id Z3pT1r0032Ka2Q5013pTKk; Sat, 24 Oct 2015 15:49:27 +0000
Received: from [192.168.199.10] ([69.251.84.114])
	by resomta-ch2-11v.sys.comcast.net with comcast
	id Z3pT1r0052U0RYt013pTQw; Sat, 24 Oct 2015 15:49:27 +0000
From: Jim Jagielski <jim@jaguNET.com>
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
Subject: Is Apache getting too patchy?
Message-Id: <38B6AA15-AB3C-47AC-B96D-7DA8094F99F9@jaguNET.com>
Date: Sat, 24 Oct 2015 11:49:26 -0400
To: httpd <dev@httpd.apache.org>
Mime-Version: 1.0 (Mac OS X Mail 8.2 \(2104\))
X-Mailer: Apple Mail (2.2104)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=comcast.net;
	s=q20140121; t=1445701767;
	bh=IAMpPH30avY6AQqKvU1W94fCR8KvHJC69eq3z4/H10c=;
	h=Received:Received:From:Content-Type:Subject:Message-Id:Date:To:
	 Mime-Version;
	b=NgT2ahJSFxNTcH4APt8wPnD5b83giD80YulgX0+bzbT/51C21x3vJsGd3WVhJmJ5S
	 Aq6Ps4z8Q8T2UQ7Emnxl2Pe0+nnIlgeLCjUj7hPsguScv/98/nqCPeJ/k4rBA2qfTx
	 NAENaawSd1S6z2pgaak85UTgmL7boEwBIHo1yG16IKLIz/g0gYeVkmnB+GsP1QnW1j
	 gdumYGqvIpn1TNGeXi98Sm1fOsoZv8EuTVtmgUaKglrnvJgzp6x4ezkG3mxP/1tZ6K
	 gqOGqgO8utuwS3zLlk/6xn9I9LOxLaZESdouDHEe1iM+adLsx+K4jgr41aezzL8OzT
	 b7DhC/GsKw41w==

Just some food for thought; let me know if I'm off the rails.

Over the last several months, it's appeared to me that we have
been adding patches that feel, well, very-patchy to me. They
feel like cumbersome add-ons that create some level of fragility
to our code, with special one-off considerations instead of a
deeper more complete fix. In other words, it seems that httpd is
becoming more crufty rather than planned and cohesive and
consistent.

Thoughts? Comments?


From dev-return-84436-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Sat Oct 24 15:50:56 2015
Return-Path: <dev-return-84436-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id A9D0318FEF
	for <apmail-httpd-dev-archive@www.apache.org>; Sat, 24 Oct 2015 15:50:56 +0000 (UTC)
Received: (qmail 67007 invoked by uid 500); 24 Oct 2015 15:50:56 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 66929 invoked by uid 500); 24 Oct 2015 15:50:56 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 66919 invoked by uid 99); 24 Oct 2015 15:50:55 -0000
Received: from Unknown (HELO spamd2-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 24 Oct 2015 15:50:55 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd2-us-west.apache.org (ASF Mail Server at spamd2-us-west.apache.org) with ESMTP id 6A6481A0992
	for <dev@httpd.apache.org>; Sat, 24 Oct 2015 15:50:50 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd2-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 0.001
X-Spam-Level:
X-Spam-Status: No, score=0.001 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, URIBL_BLOCKED=0.001]
	autolearn=disabled
Authentication-Results: spamd2-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=comcast.net
Received: from mx1-us-west.apache.org ([10.40.0.8])
	by localhost (spamd2-us-west.apache.org [10.40.0.9]) (amavisd-new, port 10024)
	with ESMTP id K7-a1EahnupC for <dev@httpd.apache.org>;
	Sat, 24 Oct 2015 15:50:40 +0000 (UTC)
Received: from resqmta-ch2-03v.sys.comcast.net (resqmta-ch2-03v.sys.comcast.net [69.252.207.35])
	by mx1-us-west.apache.org (ASF Mail Server at mx1-us-west.apache.org) with ESMTPS id BC1C920562
	for <dev@httpd.apache.org>; Sat, 24 Oct 2015 15:50:39 +0000 (UTC)
Received: from resomta-ch2-09v.sys.comcast.net ([69.252.207.105])
	by resqmta-ch2-03v.sys.comcast.net with comcast
	id Z3pZ1r0022GyhjZ013qZ0U; Sat, 24 Oct 2015 15:50:33 +0000
Received: from [192.168.199.10] ([69.251.84.114])
	by resomta-ch2-09v.sys.comcast.net with comcast
	id Z3qY1r00C2U0RYt013qYjH; Sat, 24 Oct 2015 15:50:33 +0000
Content-Type: text/plain; charset=us-ascii
Mime-Version: 1.0 (Mac OS X Mail 8.2 \(2104\))
Subject: Re: [Bug 57785] REDIRECT_URL is not suitable for use in server-generated pages
From: Jim Jagielski <jim@jaguNET.com>
In-Reply-To: <CALK=YjNd-MXfaWXDx-cxy3n-+4YmrScw=+6HZZgnx7_--EhLHw@mail.gmail.com>
Date: Sat, 24 Oct 2015 11:50:32 -0400
Content-Transfer-Encoding: quoted-printable
Message-Id: <8E4D5EDE-E9F5-4551-BE25-694E4D9B3C1B@jaguNET.com>
References: <bug-57785-7868@https.bz.apache.org/bugzilla/> <bug-57785-7868-m23qZGIuFo@https.bz.apache.org/bugzilla/> <CALK=YjNd-MXfaWXDx-cxy3n-+4YmrScw=+6HZZgnx7_--EhLHw@mail.gmail.com>
To: dev@httpd.apache.org
X-Mailer: Apple Mail (2.2104)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=comcast.net;
	s=q20140121; t=1445701833;
	bh=axn7W8GbYPeLXtpDtjanjKdrruZDR2ZOf1/zAX/9lS4=;
	h=Received:Received:Content-Type:Mime-Version:Subject:From:Date:
	 Message-Id:To;
	b=YyRRkKJOzdCUr/hgeTOnKE6IlpD+Bzz3ljNOp2T1/YzU3HniqqdyVtzD0vl9+PkrL
	 Acp8GI4eQR8JV1QZcnP+LRNtXVNNzTjCiPp6boU0Jx7IX0WnvwMmjSaTDQoVAEADLr
	 yzQnrYbdgdI9CPzC+1m2sUO5kT9ULaMXPtts94KYCKptOuuC1oD81jLJeud8fPJYqr
	 VAdxczPbd8pHdAtObYU08PwSKsJldNnJ8KlHx9YOg2JdVsDy2KPFwEIm3V3Ur4GCN4
	 x5ht4wo2wXYv2CDudIMDEOqzeBO4pL46miR4/kX+aIWyaaOP1wlTGPLr8MylqPQQka
	 j5qIwM6Y8A25Q==

+1...

I think I'd like to do a 2.4.18 release mid-Nov and pick up
these pieces as well as some http/2 fixes.

> On Oct 23, 2015, at 3:22 PM, Eric Covener <covener@gmail.com> wrote:
>=20
> My opinion is to make it opt-in before the next 2.4, but I am not
> committed to that.
>=20
> Before I do doc, any other thoughts?
>=20
> http://people.apache.org/~covener/patches/redirecturl-optin.diff
>=20
> This adds a directive to core.c called QualifyRedirectURL that  must
> be set to ON to run the 2.4.17 code.
>=20
> ---------- Forwarded message ----------
> From:  <bugzilla@apache.org>
> Date: Fri, Oct 23, 2015 at 12:55 PM
> Subject: [Bug 57785] REDIRECT_URL is not suitable for use in
> server-generated pages
> To: bugs@httpd.apache.org
>=20
>=20
> https://bz.apache.org/bugzilla/show_bug.cgi?id=3D57785
>=20
> --- Comment #7 from Jacob P <jacob.perkins@cpanel.net> ---
> Here at cPanel we are reverting our 2.4.17 release and are going to =
re-release
> 2.4.16. Too many issues with mod_rewrite/REDIRECT_URL causing a *lot* =
of
> applications to stop working.
>=20
> --
> You are receiving this mail because:
> You are the assignee for the bug.
>=20
> ---------------------------------------------------------------------
> To unsubscribe, e-mail: bugs-unsubscribe@httpd.apache.org
> For additional commands, e-mail: bugs-help@httpd.apache.org
>=20
>=20
>=20
> --=20
> Eric Covener
> covener@gmail.com


From dev-return-84437-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Sat Oct 24 18:27:58 2015
Return-Path: <dev-return-84437-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 39B3110421
	for <apmail-httpd-dev-archive@www.apache.org>; Sat, 24 Oct 2015 18:27:58 +0000 (UTC)
Received: (qmail 30930 invoked by uid 500); 24 Oct 2015 18:27:57 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 30857 invoked by uid 500); 24 Oct 2015 18:27:57 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 30847 invoked by uid 99); 24 Oct 2015 18:27:57 -0000
Received: from Unknown (HELO spamd3-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 24 Oct 2015 18:27:57 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd3-us-west.apache.org (ASF Mail Server at spamd3-us-west.apache.org) with ESMTP id 2AF16180E55
	for <dev@httpd.apache.org>; Sat, 24 Oct 2015 18:27:57 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd3-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 2.979
X-Spam-Level: **
X-Spam-Status: No, score=2.979 tagged_above=-999 required=6.31
	tests=[HTML_MESSAGE=3, RCVD_IN_MSPIKE_H3=-0.01,
	RCVD_IN_MSPIKE_WL=-0.01, SPF_PASS=-0.001] autolearn=disabled
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd3-us-west.apache.org [10.40.0.10]) (amavisd-new, port 10024)
	with ESMTP id RJcK-fJFTYRk for <dev@httpd.apache.org>;
	Sat, 24 Oct 2015 18:27:55 +0000 (UTC)
Received: from mail-ig0-f177.google.com (mail-ig0-f177.google.com [209.85.213.177])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id D359C439BC
	for <dev@httpd.apache.org>; Sat, 24 Oct 2015 18:27:54 +0000 (UTC)
Received: by igbkq10 with SMTP id kq10so35456023igb.0
        for <dev@httpd.apache.org>; Sat, 24 Oct 2015 11:27:54 -0700 (PDT)
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=1e100.net; s=20130820;
        h=x-gm-message-state:mime-version:date:message-id:subject:from:to
         :content-type;
        bh=h6sY/IcyziBmakHmguH+2D1TEWSu43+g5Nt3LmAQJ6A=;
        b=ks7eWOuIZbJgmBacSAfuPpLBV9dx4NIXdf4+mxO4uyq8NBjtOC1UTDt7nBpZ1k9ifd
         EBob8WDKJf4Envtz5FmV/awDgR3zE2pjwifnsKmPGpSCL1Qlf/OIk43RPgK9ZubkafvQ
         h1n+zRtqkM6+pr3gW//uwa1YE7hpSr7d807y6KrJwhrKg58jajob6gLAkYdd7s/s0OWM
         fssd8JS38uQT6uSYnS3Z/no0ND/oE04oXZqWsLPTrQhT7NQL1z9za7pbmd53J7frrNyS
         buOV4BpWkrEs9CiiZOA+n9WElq2a+sExIIoFR9FjP/JIJtgcwBal9w7Tha/quE9kyeWK
         hBMQ==
X-Gm-Message-State: ALoCoQklH4/oKGJsBHZp5WGveggRlLLF+5MOSlcbWO5Yus4hdVi2TnzAPpIROrYDIAlRSXjp0KaJ
MIME-Version: 1.0
X-Received: by 10.50.50.40 with SMTP id z8mr11015405ign.85.1445711274302; Sat,
 24 Oct 2015 11:27:54 -0700 (PDT)
Received: by 10.36.72.137 with HTTP; Sat, 24 Oct 2015 11:27:54 -0700 (PDT)
Date: Sat, 24 Oct 2015 20:27:54 +0200
Message-ID: <CAECPfcxaz-4KULwXzx06g2=uH0YZLPrPjugF4vT=wfh8S4oXQQ@mail.gmail.com>
Subject: Patch review for proxy request trailers
From: Daniil Iaitskov <diaitskov@egnyte.com>
To: dev@httpd.apache.org
Content-Type: multipart/mixed; boundary=089e0118320cf4c21f0522dde269

--089e0118320cf4c21f0522dde269
Content-Type: multipart/alternative; boundary=089e0118320cf4c21b0522dde267

--089e0118320cf4c21b0522dde267
Content-Type: text/plain; charset=UTF-8

Hi List,

At last I braced myself and completed a patch which, I hope, makes httpd a
bit closer to RFCs. Trailers was declared decades ago but they are still
only a theory.
Though don't think this an academic patch.
I need this feature in a practical job.

The patch allows a client to send trailing headers to an origin server
through an httpd in the proxy mode. It filters headers which are not
declared in the Trailer header.

The patch is in the scope of the following ticket.

https://bz.apache.org/bugzilla/show_bug.cgi?id=58177

There are 2 patches for 2.4.16 and trunk.
I tested only 2.4.16. Trunk doesn't have the configure script.
I read that buildconf can generate it, but ubuntu currently has some issue
with the libtool package.


-- 


Daneel Yaitskov

--089e0118320cf4c21b0522dde267
Content-Type: text/html; charset=UTF-8
Content-Transfer-Encoding: quoted-printable

<div dir=3D"ltr">Hi List,<div><br></div><div>At last I braced myself and co=
mpleted a patch which, I hope, makes httpd a bit closer to RFCs. Trailers w=
as declared decades ago but they are still only a theory.</div><div>Though =
don&#39;t think this an academic patch.</div><div>I need this feature in a =
practical job.</div><div><br></div><div>The patch allows a client to send t=
railing headers to an origin server through an httpd in the proxy mode. It =
filters headers which are not declared in the Trailer header.</div><div>=C2=
=A0</div><div>The patch is in the scope of the following ticket.<br></div><=
div><br></div><div><a href=3D"https://bz.apache.org/bugzilla/show_bug.cgi?i=
d=3D58177">https://bz.apache.org/bugzilla/show_bug.cgi?id=3D58177</a>=C2=A0=
</div><div><br></div><div>There are 2 patches for 2.4.16 and trunk.</div><d=
iv>I tested only 2.4.16. Trunk doesn&#39;t have the configure script.</div>=
<div>I read that buildconf can generate it, but ubuntu currently has some i=
ssue with the libtool package.</div><div>=C2=A0=C2=A0</div><div><div><br></=
div>-- <br><div class=3D"gmail_signature"><div dir=3D"ltr"><div dir=3D"ltr"=
><br><div><br></div><div>Daneel Yaitskov</div><div><br></div><div><br></div=
></div></div></div>
</div></div>

--089e0118320cf4c21b0522dde267--
--089e0118320cf4c21f0522dde269
Content-Type: text/x-patch; charset=US-ASCII; name="trunk-trailer.patch"
Content-Disposition: attachment; filename="trunk-trailer.patch"
Content-Transfer-Encoding: base64
X-Attachment-Id: f_ig5eumb20

SW5kZXg6IG1vZHVsZXMvcHJveHkvbW9kX3Byb3h5X2h0dHAuYwo9PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09Ci0tLSBtb2R1
bGVzL3Byb3h5L21vZF9wcm94eV9odHRwLmMJKHJldmlzaW9uIDE3MTAzNDUpCisrKyBtb2R1bGVz
L3Byb3h5L21vZF9wcm94eV9odHRwLmMJKHdvcmtpbmcgY29weSkKQEAgLTE5Niw2ICsxOTYsMzkg
QEAKICAgICBBUFJfQlJJR0FERV9JTlNFUlRfVEFJTChoZWFkZXJfYnJpZ2FkZSwgZSk7CiB9CiAK
K3N0YXRpYyB2b2lkIGFkZF90cmFpbGVyX2xpbmUoY29uc3QgY2hhciAqIGtleSwgY29uc3QgY2hh
ciAqdmFsLCBhcHJfcG9vbF90ICpwLAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhcHJf
YnVja2V0X2FsbG9jX3QgKmJ1Y2tldF9hbGxvYywKKyAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgYXByX2J1Y2tldF9icmlnYWRlICpiYikKK3sKKyAgICBhcHJfYnVja2V0ICplOworICAgIGNo
YXIgKmJ1ZjsKKworICAgIGJ1ZiA9IGFwcl9wc3RyY2F0KHAsIGtleSwgIjogIiwgdmFsLCBDUkxG
LCBOVUxMKTsKKyAgICBhcF94bGF0ZV9wcm90b190b19hc2NpaShidWYsIHN0cmxlbihidWYpKTsK
KworICAgIGUgPSBhcHJfYnVja2V0X2ltbW9ydGFsX2NyZWF0ZShidWYsIHN0cmxlbihidWYpLCBi
dWNrZXRfYWxsb2MpOworICAgIEFQUl9CUklHQURFX0lOU0VSVF9UQUlMKGJiLCBlKTsKK30KKwor
c3RhdGljIHZvaWQgZm9yd2FyZF9kZWNsYXJlZF90cmFpbGVycyhhcHJfcG9vbF90ICpwLCBjb25z
dCByZXF1ZXN0X3JlYyAqciwKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
YXByX2J1Y2tldF9hbGxvY190ICpidWNrZXRfYWxsb2MsCisgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgIGFwcl9idWNrZXRfYnJpZ2FkZSAqYmIpCit7CisgICAgY29uc3QgY2hh
ciAqZGVjbGFyZWRfdHJhaWxlcnMgPSBhcHJfdGFibGVfZ2V0KHItPmhlYWRlcnNfaW4sICJUcmFp
bGVyIik7CisgICAgaWYgKGRlY2xhcmVkX3RyYWlsZXJzKSB7CisgICAgICAgIGNoYXIgKm1vZF90
cmFpbGVycyA9IGFwcl9wc3RyY2F0KHAsIGRlY2xhcmVkX3RyYWlsZXJzLCBOVUxMKTsKKyAgICAg
ICAgY2hhciAqa2V5OworICAgICAgICBjaGFyICpsYXN0ID0gTlVMTDsKKyAgICAgICAgd2hpbGUg
KChrZXkgPSBhcHJfc3RydG9rKG1vZF90cmFpbGVycywgIiwgIiwgJmxhc3QpKSkgeworICAgICAg
ICAgICAgY29uc3QgY2hhciAqdmFsdWUgPSBhcHJfdGFibGVfZ2V0KHItPnRyYWlsZXJzX2luLCBr
ZXkpOworICAgICAgICAgICAgaWYgKHZhbHVlKSB7CisgICAgICAgICAgICAgICAgYWRkX3RyYWls
ZXJfbGluZShrZXksIHZhbHVlLCBwLCBidWNrZXRfYWxsb2MsIGJiKTsKKyAgICAgICAgICAgIH0K
KyAgICAgICAgICAgIG1vZF90cmFpbGVycyA9IGxhc3Q7CisgICAgICAgIH0KKyAgICB9Cit9CisK
IHN0YXRpYyB2b2lkIGFkZF9jbChhcHJfcG9vbF90ICpwLAogICAgICAgICAgICAgICAgICAgIGFw
cl9idWNrZXRfYWxsb2NfdCAqYnVja2V0X2FsbG9jLAogICAgICAgICAgICAgICAgICAgIGFwcl9i
dWNrZXRfYnJpZ2FkZSAqaGVhZGVyX2JyaWdhZGUsCkBAIC0zNTcsMTAgKzM5MCwxOCBAQAogICAg
ICAgICBiYiA9IGlucHV0X2JyaWdhZGU7CiAgICAgfQogCi0gICAgZSA9IGFwcl9idWNrZXRfaW1t
b3J0YWxfY3JlYXRlKEFTQ0lJX1pFUk8gQVNDSUlfQ1JMRgotICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAvKiA8dHJhaWxlcnM+ICovCi0gICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIEFTQ0lJX0NSTEYsCi0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
IDUsIGJ1Y2tldF9hbGxvYyk7CisgICAgaWYgKGFwcl9pc19lbXB0eV90YWJsZShyLT50cmFpbGVy
c19pbikpIHsKKyAgICAgICAgZSA9IGFwcl9idWNrZXRfaW1tb3J0YWxfY3JlYXRlKEFTQ0lJX1pF
Uk8gQVNDSUlfQ1JMRgorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAvKiA8dHJhaWxlcnM+ICovCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIEFTQ0lJX0NSTEYsCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICA1LCBidWNrZXRfYWxsb2MpOworICAgIH0gZWxzZSB7CisgICAgICAgIGUgPSBhcHJf
YnVja2V0X2ltbW9ydGFsX2NyZWF0ZShBU0NJSV9aRVJPIEFTQ0lJX0NSTEYsCisgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAzLCBidWNrZXRfYWxsb2MpOworICAgICAgICBB
UFJfQlJJR0FERV9JTlNFUlRfVEFJTChiYiwgZSk7CisgICAgICAgIGZvcndhcmRfZGVjbGFyZWRf
dHJhaWxlcnMocCwgciwgYnVja2V0X2FsbG9jLCBiYik7CisgICAgICAgIGUgPSBhcHJfYnVja2V0
X2ltbW9ydGFsX2NyZWF0ZShBU0NJSV9DUkxGLCAyLCBidWNrZXRfYWxsb2MpOworICAgIH0KICAg
ICBBUFJfQlJJR0FERV9JTlNFUlRfVEFJTChiYiwgZSk7CiAKICAgICBpZiAoYXByX3RhYmxlX2dl
dChyLT5zdWJwcm9jZXNzX2VudiwgInByb3h5LXNlbmRleHRyYWNybGYiKSkgewpAQCAtOTgyLDYg
KzEwMjMsMTggQEAKICAgICAgICAgZSA9IGFwcl9idWNrZXRfcG9vbF9jcmVhdGUoYnVmLCBzdHJs
ZW4oYnVmKSwgcCwgYy0+YnVja2V0X2FsbG9jKTsKICAgICAgICAgQVBSX0JSSUdBREVfSU5TRVJU
X1RBSUwoaGVhZGVyX2JyaWdhZGUsIGUpOwogICAgIH0KKyAgICAvKiogcGFzcyB0YWlsZXIgaGVh
ZGVyIGFuZCBlbmZvcmNlIGNodW5rZWQgKi8KKyAgICBpZiAoKm9sZF90ZV92YWwpIHsKKyAgICAg
ICAgY29uc3QgY2hhciAqdHJhaWxlciA9IGFwcl90YWJsZV9nZXQoci0+aGVhZGVyc19pbiwgIlRy
YWlsZXIiKTsKKyAgICAgICAgaWYgKHRyYWlsZXIpIHsKKyAgICAgICAgICAgIGNoYXIgKmJ1ZiA9
IGFwcl9wc3RyY2F0KHAsICJUcmFpbGVyOiAiLCB0cmFpbGVyLCBDUkxGLCBOVUxMKTsKKyAgICAg
ICAgICAgIGFwX3hsYXRlX3Byb3RvX3RvX2FzY2lpKGJ1Ziwgc3RybGVuKGJ1ZikpOworICAgICAg
ICAgICAgQVBSX0JSSUdBREVfSU5TRVJUX1RBSUwoaGVhZGVyX2JyaWdhZGUsCisgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICBhcHJfYnVja2V0X3Bvb2xfY3JlYXRlKGJ1Ziwgc3Ry
bGVuKGJ1ZiksCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIHAsIGJ1Y2tldF9hbGxvYykpOworICAgICAgICAgICAgKnJiX21ldGhvZCA9
IFJCX1NUUkVBTV9DSFVOS0VEOworICAgICAgICB9CisgICAgfQogCiAgICAgcmV0dXJuIE9LOwog
fQo=
--089e0118320cf4c21f0522dde269
Content-Type: text/x-patch; charset=US-ASCII; name="2.4.16-trailer.patch"
Content-Disposition: attachment; filename="2.4.16-trailer.patch"
Content-Transfer-Encoding: base64
X-Attachment-Id: f_ig5eumbm1

ZGlmZiAtLWdpdCBhL21vZHVsZXMvcHJveHkvbW9kX3Byb3h5X2h0dHAuYyBiL21vZHVsZXMvcHJv
eHkvbW9kX3Byb3h5X2h0dHAuYwppbmRleCAzMTk3MjFmLi4zNjkxMmVkIDEwMDY0NAotLS0gYS9t
b2R1bGVzL3Byb3h5L21vZF9wcm94eV9odHRwLmMKKysrIGIvbW9kdWxlcy9wcm94eS9tb2RfcHJv
eHlfaHR0cC5jCkBAIC0xOTYsNiArMTk2LDM5IEBAIHN0YXRpYyB2b2lkIGFkZF90ZV9jaHVua2Vk
KGFwcl9wb29sX3QgKnAsCiAgICAgQVBSX0JSSUdBREVfSU5TRVJUX1RBSUwoaGVhZGVyX2JyaWdh
ZGUsIGUpOwogfQogCitzdGF0aWMgdm9pZCBhZGRfdHJhaWxlcl9saW5lKGNvbnN0IGNoYXIgKiBr
ZXksIGNvbnN0IGNoYXIgKnZhbCwgYXByX3Bvb2xfdCAqcCwKKyAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgYXByX2J1Y2tldF9hbGxvY190ICpidWNrZXRfYWxsb2MsCisgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgIGFwcl9idWNrZXRfYnJpZ2FkZSAqYmIpCit7CisgICAgYXByX2J1Y2tl
dCAqZTsKKyAgICBjaGFyICpidWY7CisKKyAgICBidWYgPSBhcHJfcHN0cmNhdChwLCBrZXksICI6
ICIsIHZhbCwgQ1JMRiwgTlVMTCk7CisgICAgYXBfeGxhdGVfcHJvdG9fdG9fYXNjaWkoYnVmLCBz
dHJsZW4oYnVmKSk7CisKKyAgICBlID0gYXByX2J1Y2tldF9pbW1vcnRhbF9jcmVhdGUoYnVmLCBz
dHJsZW4oYnVmKSwgYnVja2V0X2FsbG9jKTsKKyAgICBBUFJfQlJJR0FERV9JTlNFUlRfVEFJTChi
YiwgZSk7Cit9CisKK3N0YXRpYyB2b2lkIGZvcndhcmRfZGVjbGFyZWRfdHJhaWxlcnMoYXByX3Bv
b2xfdCAqcCwgY29uc3QgcmVxdWVzdF9yZWMgKnIsCisgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIGFwcl9idWNrZXRfYWxsb2NfdCAqYnVja2V0X2FsbG9jLAorICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhcHJfYnVja2V0X2JyaWdhZGUgKmJiKQorewor
ICAgIGNvbnN0IGNoYXIgKmRlY2xhcmVkX3RyYWlsZXJzID0gYXByX3RhYmxlX2dldChyLT5oZWFk
ZXJzX2luLCAiVHJhaWxlciIpOworICAgIGlmIChkZWNsYXJlZF90cmFpbGVycykgeworICAgICAg
ICBjaGFyICptb2RfdHJhaWxlcnMgPSBhcHJfcHN0cmNhdChwLCBkZWNsYXJlZF90cmFpbGVycywg
TlVMTCk7CisgICAgICAgIGNoYXIgKmtleTsKKyAgICAgICAgY2hhciAqbGFzdCA9IE5VTEw7Cisg
ICAgICAgIHdoaWxlICgoa2V5ID0gYXByX3N0cnRvayhtb2RfdHJhaWxlcnMsICIsICIsICZsYXN0
KSkpIHsKKyAgICAgICAgICAgIGNvbnN0IGNoYXIgKnZhbHVlID0gYXByX3RhYmxlX2dldChyLT50
cmFpbGVyc19pbiwga2V5KTsKKyAgICAgICAgICAgIGlmICh2YWx1ZSkgeworICAgICAgICAgICAg
ICAgIGFkZF90cmFpbGVyX2xpbmUoa2V5LCB2YWx1ZSwgcCwgYnVja2V0X2FsbG9jLCBiYik7Cisg
ICAgICAgICAgICB9CisgICAgICAgICAgICBtb2RfdHJhaWxlcnMgPSBsYXN0OworICAgICAgICB9
CisgICAgfQorfQorCiBzdGF0aWMgdm9pZCBhZGRfY2woYXByX3Bvb2xfdCAqcCwKICAgICAgICAg
ICAgICAgICAgICBhcHJfYnVja2V0X2FsbG9jX3QgKmJ1Y2tldF9hbGxvYywKICAgICAgICAgICAg
ICAgICAgICBhcHJfYnVja2V0X2JyaWdhZGUgKmhlYWRlcl9icmlnYWRlLApAQCAtMzQ0LDEwICsz
NzcsMTggQEAgc3RhdGljIGludCBzdHJlYW1fcmVxYm9keV9jaHVua2VkKGFwcl9wb29sX3QgKnAs
CiAgICAgICAgIGJiID0gaW5wdXRfYnJpZ2FkZTsKICAgICB9CiAKLSAgICBlID0gYXByX2J1Y2tl
dF9pbW1vcnRhbF9jcmVhdGUoQVNDSUlfWkVSTyBBU0NJSV9DUkxGCisgICAgaWYgKGFwcl9pc19l
bXB0eV90YWJsZShyLT50cmFpbGVyc19pbikpIHsKKyAgICAgICAgZSA9IGFwcl9idWNrZXRfaW1t
b3J0YWxfY3JlYXRlKEFTQ0lJX1pFUk8gQVNDSUlfQ1JMRgogICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAvKiA8dHJhaWxlcnM+ICovCiAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIEFTQ0lJX0NSTEYsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
IDUsIGJ1Y2tldF9hbGxvYyk7CisgICAgfSBlbHNlIHsKKyAgICAgICAgZSA9IGFwcl9idWNrZXRf
aW1tb3J0YWxfY3JlYXRlKEFTQ0lJX1pFUk8gQVNDSUlfQ1JMRiwKKyAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgMywgYnVja2V0X2FsbG9jKTsKKyAgICAgICAgQVBSX0JSSUdBREVf
SU5TRVJUX1RBSUwoYmIsIGUpOworICAgICAgICBmb3J3YXJkX2RlY2xhcmVkX3RyYWlsZXJzKHAs
IHIsIGJ1Y2tldF9hbGxvYywgYmIpOworICAgICAgICBlID0gYXByX2J1Y2tldF9pbW1vcnRhbF9j
cmVhdGUoQVNDSUlfQ1JMRiwgMiwgYnVja2V0X2FsbG9jKTsKKyAgICB9CiAgICAgQVBSX0JSSUdB
REVfSU5TRVJUX1RBSUwoYmIsIGUpOwogCiAgICAgaWYgKGFwcl90YWJsZV9nZXQoci0+c3VicHJv
Y2Vzc19lbnYsICJwcm94eS1zZW5kZXh0cmFjcmxmIikpIHsKQEAgLTkzMiw3ICs5NzMsMTggQEAg
c2tpcF9ib2R5OgogICAgICAgICBlID0gYXByX2J1Y2tldF9wb29sX2NyZWF0ZShidWYsIHN0cmxl
bihidWYpLCBwLCBjLT5idWNrZXRfYWxsb2MpOwogICAgICAgICBBUFJfQlJJR0FERV9JTlNFUlRf
VEFJTChoZWFkZXJfYnJpZ2FkZSwgZSk7CiAgICAgfQotCisgICAgLyoqIHBhc3MgdGFpbGVyIGhl
YWRlciBhbmQgZW5mb3JjZSBjaHVua2VkICovCisgICAgaWYgKG9sZF90ZV92YWwpIHsKKyAgICAg
ICAgY29uc3QgY2hhciAqdHJhaWxlciA9IGFwcl90YWJsZV9nZXQoci0+aGVhZGVyc19pbiwgIlRy
YWlsZXIiKTsKKyAgICAgICAgaWYgKHRyYWlsZXIpIHsKKyAgICAgICAgICAgIGNoYXIgKmJ1ZiA9
IGFwcl9wc3RyY2F0KHAsICJUcmFpbGVyOiAiLCB0cmFpbGVyLCBDUkxGLCBOVUxMKTsKKyAgICAg
ICAgICAgIGFwX3hsYXRlX3Byb3RvX3RvX2FzY2lpKGJ1Ziwgc3RybGVuKGJ1ZikpOworICAgICAg
ICAgICAgQVBSX0JSSUdBREVfSU5TRVJUX1RBSUwoaGVhZGVyX2JyaWdhZGUsCisgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICBhcHJfYnVja2V0X3Bvb2xfY3JlYXRlKGJ1Ziwgc3Ry
bGVuKGJ1ZiksCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIHAsIGJ1Y2tldF9hbGxvYykpOworICAgICAgICAgICAgcmJfbWV0aG9kID0g
UkJfU1RSRUFNX0NIVU5LRUQ7CisgICAgICAgIH0KKyAgICB9CiAgICAgLyogc2VuZCB0aGUgcmVx
dWVzdCBib2R5LCBpZiBhbnkuICovCiAgICAgc3dpdGNoKHJiX21ldGhvZCkgewogICAgIGNhc2Ug
UkJfU1RSRUFNX0NIVU5LRUQ6Cg==
--089e0118320cf4c21f0522dde269
Content-Type: application/x-sh; name="chunked-request.sh"
Content-Disposition: attachment; filename="chunked-request.sh"
Content-Transfer-Encoding: base64
X-Attachment-Id: f_ig5f4eha2

IyEvYmluL2Jhc2gKCmVjaG8gLWVuICJQT1NUIGh0dHA6Ly9sb2NhbGhvc3Q6OTk5OS8gSFRUUC8x
LjFcclxuVXNlci1BZ2VudDogY3VybC83LjM1LjBcclxuSG9zdDogbG9jYWxob3N0Ojk5OTlcclxu
QWNjZXB0OiAqLypcclxuVHJhbnNmZXItRW5jb2Rpbmc6IGNodW5rZWRcclxuVHJhaWxlcjogSEVB
XHJcblxyXG4zXHJcbnh5elxyXG4wXHJcbkhFQTogeHh4XHJcblxyXG4iID4gL2Rldi90Y3AvbG9j
YWxob3N0Lzg4MDgKCg==
--089e0118320cf4c21f0522dde269--

From dev-return-84438-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Sat Oct 24 20:32:44 2015
Return-Path: <dev-return-84438-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 71D84107EE
	for <apmail-httpd-dev-archive@www.apache.org>; Sat, 24 Oct 2015 20:32:44 +0000 (UTC)
Received: (qmail 69226 invoked by uid 500); 24 Oct 2015 20:32:43 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 69160 invoked by uid 500); 24 Oct 2015 20:32:43 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 69150 invoked by uid 99); 24 Oct 2015 20:32:43 -0000
Received: from Unknown (HELO spamd2-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 24 Oct 2015 20:32:43 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd2-us-west.apache.org (ASF Mail Server at spamd2-us-west.apache.org) with ESMTP id 6401F1A2728
	for <dev@httpd.apache.org>; Sat, 24 Oct 2015 20:32:43 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd2-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 0.99
X-Spam-Level:
X-Spam-Status: No, score=0.99 tagged_above=-999 required=6.31
	tests=[KAM_LAZY_DOMAIN_SECURITY=1, T_RP_MATCHES_RCVD=-0.01]
	autolearn=disabled
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd2-us-west.apache.org [10.40.0.9]) (amavisd-new, port 10024)
	with ESMTP id M0omxALau1Sq for <dev@httpd.apache.org>;
	Sat, 24 Oct 2015 20:32:42 +0000 (UTC)
Received: from eru.sfritsch.de (eru.sfritsch.de [188.40.99.202])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id AC23720751
	for <dev@httpd.apache.org>; Sat, 24 Oct 2015 20:32:41 +0000 (UTC)
From: Stefan Fritsch <sf@sfritsch.de>
To: httpd <dev@httpd.apache.org>
Subject: Update bugzilla for 2.4.17
Date: Sat, 24 Oct 2015 22:32:29 +0200
Message-ID: <3366461.Sg1y3aIt4e@k>
User-Agent: KMail/4.14.10 (Linux/4.1.0-2-amd64; KDE/4.14.13; x86_64; ; )
MIME-Version: 1.0
Content-Transfer-Encoding: 7Bit
Content-Type: text/plain; charset="us-ascii"

Hi,

can anyone with bugzilla fu please add 2.4.17 and mod_http2 to the 
bugzilla selections? Thanks.

Cheers,
Stefan

From dev-return-84439-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Sat Oct 24 20:37:11 2015
Return-Path: <dev-return-84439-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 0A2E7107F7
	for <apmail-httpd-dev-archive@www.apache.org>; Sat, 24 Oct 2015 20:37:10 +0000 (UTC)
Received: (qmail 70720 invoked by uid 500); 24 Oct 2015 20:37:10 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 70660 invoked by uid 500); 24 Oct 2015 20:37:09 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 70650 invoked by uid 99); 24 Oct 2015 20:37:09 -0000
Received: from Unknown (HELO spamd4-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 24 Oct 2015 20:37:09 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd4-us-west.apache.org (ASF Mail Server at spamd4-us-west.apache.org) with ESMTP id 7ACC2C0B79
	for <dev@httpd.apache.org>; Sat, 24 Oct 2015 20:37:09 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd4-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.12
X-Spam-Level:
X-Spam-Status: No, score=-0.12 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RCVD_IN_MSPIKE_H3=-0.01, RCVD_IN_MSPIKE_WL=-0.01, SPF_PASS=-0.001,
	URIBL_BLOCKED=0.001] autolearn=disabled
Authentication-Results: spamd4-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd4-us-west.apache.org [10.40.0.11]) (amavisd-new, port 10024)
	with ESMTP id F-4SVSdxyyUN for <dev@httpd.apache.org>;
	Sat, 24 Oct 2015 20:37:02 +0000 (UTC)
Received: from mail-ig0-f178.google.com (mail-ig0-f178.google.com [209.85.213.178])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id 079FA20751
	for <dev@httpd.apache.org>; Sat, 24 Oct 2015 20:37:01 +0000 (UTC)
Received: by igbkq10 with SMTP id kq10so53204439igb.0
        for <dev@httpd.apache.org>; Sat, 24 Oct 2015 13:37:00 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        bh=TkbX9Zb466UBIDlEdC4J4B5zcnaL12qpPSZnkjyVevQ=;
        b=boV60GDiaDrs41UyoK0mNbFrkmQU7XD/FqnrIfJtCXjTwVxS8JmPkxZVyfPoDhlXji
         BSKHyDnbAyIVY0zRlmBh3cKC7vfDBCo7opSTAKALWapMYpWzio7N2MgGgaFcP9v3ibUc
         9BQBPq6PcV/65GzCXszEHOiu117obGOxmV/oE5Qrvsc1rgHtSpcRlCOsz14YKDhZivbA
         jbLh6ekQMRxrLWuhqmPJCRd0tfB66qXn/hhz3wJ6AWJCcrKXFYnRFKkqu4ae6Hc2RWXr
         mramNbQqygK6PM45GqnIk1JLyw6Qd61WUXyVNkmRnqHXIwjSK7f677kjwehSFUdihJNG
         m8fw==
MIME-Version: 1.0
X-Received: by 10.51.17.39 with SMTP id gb7mr10679673igd.36.1445719020044;
 Sat, 24 Oct 2015 13:37:00 -0700 (PDT)
Received: by 10.64.112.69 with HTTP; Sat, 24 Oct 2015 13:36:59 -0700 (PDT)
In-Reply-To: <3366461.Sg1y3aIt4e@k>
References: <3366461.Sg1y3aIt4e@k>
Date: Sat, 24 Oct 2015 16:36:59 -0400
Message-ID: <CALK=YjNbtwP1d0HJfrv0qe8zw_Zt2nySVv8PS8DCFj2LTfkkGg@mail.gmail.com>
Subject: Re: Update bugzilla for 2.4.17
From: Eric Covener <covener@gmail.com>
To: Apache HTTP Server Development List <dev@httpd.apache.org>
Content-Type: text/plain; charset=UTF-8

On Sat, Oct 24, 2015 at 4:32 PM, Stefan Fritsch <sf@sfritsch.de> wrote:
> can anyone with bugzilla fu please add 2.4.17 and mod_http2 to the
> bugzilla selections? Thanks.

Both available now

From dev-return-84440-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Sat Oct 24 21:22:14 2015
Return-Path: <dev-return-84440-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 1EDD410936
	for <apmail-httpd-dev-archive@www.apache.org>; Sat, 24 Oct 2015 21:22:14 +0000 (UTC)
Received: (qmail 10246 invoked by uid 500); 24 Oct 2015 21:22:13 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 10170 invoked by uid 500); 24 Oct 2015 21:22:13 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 10160 invoked by uid 99); 24 Oct 2015 21:22:13 -0000
Received: from Unknown (HELO spamd2-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 24 Oct 2015 21:22:13 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd2-us-west.apache.org (ASF Mail Server at spamd2-us-west.apache.org) with ESMTP id 371151A2628
	for <dev@httpd.apache.org>; Sat, 24 Oct 2015 21:22:13 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd2-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 1
X-Spam-Level: *
X-Spam-Status: No, score=1 tagged_above=-999 required=6.31
	tests=[KAM_LAZY_DOMAIN_SECURITY=1] autolearn=disabled
Received: from mx1-us-west.apache.org ([10.40.0.8])
	by localhost (spamd2-us-west.apache.org [10.40.0.9]) (amavisd-new, port 10024)
	with ESMTP id W8ClAixvVJy6 for <dev@httpd.apache.org>;
	Sat, 24 Oct 2015 21:22:11 +0000 (UTC)
Received: from node176.itex.at (mail.123x.at [194.242.35.176])
	by mx1-us-west.apache.org (ASF Mail Server at mx1-us-west.apache.org) with ESMTPS id 6FD5A20754
	for <dev@httpd.apache.org>; Sat, 24 Oct 2015 21:22:10 +0000 (UTC)
Received: from localhost (localhost [127.0.0.1])
	by node176.itex.at (Postfix) with ESMTP id 0853E22B96
	for <dev@httpd.apache.org>; Sat, 24 Oct 2015 23:22:03 +0200 (CEST)
X-Virus-Scanned: Debian amavisd-new at node176.itex.at
Received: from node176.itex.at ([127.0.0.1])
	by localhost (node176.itex.at [127.0.0.1]) (amavisd-new, port 10024)
	with ESMTP id wnDGbR_ZfE6h for <dev@httpd.apache.org>;
	Sat, 24 Oct 2015 23:22:02 +0200 (CEST)
Received: from [10.0.0.1] (CPE-120-146-85-182.lns9.cht.bigpond.net.au [120.146.85.182])
	(Authenticated sender: normw@gknw.net)
	by node176.itex.at (Postfix) with ESMTPSA id F00C1229A5
	for <dev@httpd.apache.org>; Sat, 24 Oct 2015 23:22:01 +0200 (CEST)
To: "dev@httpd.apache.org" <dev@httpd.apache.org>
From: NormW <normw@gknw.net>
Subject: Latest httpd-trunk updates....
Message-ID: <562BF670.90901@gknw.net>
Date: Sun, 25 Oct 2015 08:21:52 +1100
User-Agent: Mozilla/5.0 (Windows NT 5.1; rv:38.0) Gecko/20100101
 Thunderbird/38.3.0
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8; format=flowed
Content-Transfer-Encoding: 7bit

G/M from D/U,
Compiling httpd-trunk this morning after an svn update and note the 
followings...um....oops
> CC   server/protocol.c
> ### mwccnlm Compiler:
> #    File: server\protocol.c
> # --------------------------
> #    2007:              for (int i = 0; i < conf->protocols->nelts; ++i) {
> #   Error:                   ^^^
> #   expression syntax error
> #   Too many errors printed, aborting program
>
> User break, cancelled...
> D:/Projects/svn/httpd-trunk/build/NWGNUtail.inc:125: recipe for target 'obj_release/protocol.o' failed
> make: *** [obj_release/protocol.o] Error 2
> CC   server/provider.c
[snip,snip,snip...]
> CC   server/util_script.c
> ### mwccnlm Compiler:
> #    File: server\util_script.c
> # -----------------------------
> #     289:          if (conf->fully_qualify_redirect_url != AP_CORE_CONFIG_ON) {
> #   Error:                    ^^^^^^^^^^^^^^^^^^^^^^^^^^
> #   'fully_qualify_redirect_url' is not a struct/union/class member
> #   Too many errors printed, aborting program

The protocol.c oops needs the int i predeclared before the for-loop, the 
util_script.c is a bit more obscure.

HTH,
Norm

From dev-return-84441-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Sat Oct 24 21:36:21 2015
Return-Path: <dev-return-84441-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id ABF59109A2
	for <apmail-httpd-dev-archive@www.apache.org>; Sat, 24 Oct 2015 21:36:21 +0000 (UTC)
Received: (qmail 28823 invoked by uid 500); 24 Oct 2015 21:36:20 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 28752 invoked by uid 500); 24 Oct 2015 21:36:20 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 28742 invoked by uid 99); 24 Oct 2015 21:36:20 -0000
Received: from Unknown (HELO spamd4-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 24 Oct 2015 21:36:20 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd4-us-west.apache.org (ASF Mail Server at spamd4-us-west.apache.org) with ESMTP id 45769C0E0E
	for <dev@httpd.apache.org>; Sat, 24 Oct 2015 21:36:20 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd4-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.12
X-Spam-Level:
X-Spam-Status: No, score=-0.12 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RCVD_IN_MSPIKE_H3=-0.01, RCVD_IN_MSPIKE_WL=-0.01, SPF_PASS=-0.001,
	URIBL_BLOCKED=0.001] autolearn=disabled
Authentication-Results: spamd4-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd4-us-west.apache.org [10.40.0.11]) (amavisd-new, port 10024)
	with ESMTP id Xvzd6fgdVQle for <dev@httpd.apache.org>;
	Sat, 24 Oct 2015 21:36:12 +0000 (UTC)
Received: from mail-ig0-f182.google.com (mail-ig0-f182.google.com [209.85.213.182])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id 2102742B32
	for <dev@httpd.apache.org>; Sat, 24 Oct 2015 21:36:11 +0000 (UTC)
Received: by igbhv6 with SMTP id hv6so35612584igb.0
        for <dev@httpd.apache.org>; Sat, 24 Oct 2015 14:36:10 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        bh=yE2psspC2F2CCWs6wQibLJ6RXY+8fPZqbugm0jI/c6o=;
        b=dU2JeuipADMubqeNOHVvGz2tN9pUYJzU4yhhj39ubHbyRyZl4fchn3a3EsMEYTEP5C
         U+cxWiKUFXWGbWV2Uc0HKKZx7boDvnReq+4DpH/88dAUUb27a30TXU0FKejakAg4uf18
         sc0mMXOaEa4edttBZ1Oem1DV0u7Ga4wrO4cby+iP5quBl9i30xNyiouNOx1BDUAwexF6
         7eIWGwCapgdgzSFLGQytkXxJS/h3zE2fYCVjnD6qg8TTWXLi9AGyufLTTZfc6ic/XpAD
         mcps/6q8Ep5AWU2/F2iupK2DVisISB9UAGGEUGYMVknmlo1eAsmQOUHFY3YWpDHcmk1m
         WQ5w==
MIME-Version: 1.0
X-Received: by 10.50.78.194 with SMTP id d2mr10971374igx.72.1445722570771;
 Sat, 24 Oct 2015 14:36:10 -0700 (PDT)
Received: by 10.64.112.69 with HTTP; Sat, 24 Oct 2015 14:36:10 -0700 (PDT)
In-Reply-To: <562BF670.90901@gknw.net>
References: <562BF670.90901@gknw.net>
Date: Sat, 24 Oct 2015 17:36:10 -0400
Message-ID: <CALK=YjOxFV2THsbF1MDwhPfDOqieKb7BkSA0JVuxpixf+H=imA@mail.gmail.com>
Subject: Re: Latest httpd-trunk updates....
From: Eric Covener <covener@gmail.com>
To: Apache HTTP Server Development List <dev@httpd.apache.org>
Content-Type: text/plain; charset=UTF-8

On Sat, Oct 24, 2015 at 5:21 PM, NormW <normw@gknw.net> wrote:
>> #     289:          if (conf->fully_qualify_redirect_url !=
>> AP_CORE_CONFIG_ON) {

Fixed now, didn't get rebuilt when I changed the name in the header.

From dev-return-84442-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Sat Oct 24 21:41:38 2015
Return-Path: <dev-return-84442-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 3B66E109BE
	for <apmail-httpd-dev-archive@www.apache.org>; Sat, 24 Oct 2015 21:41:38 +0000 (UTC)
Received: (qmail 32359 invoked by uid 500); 24 Oct 2015 21:41:37 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 32294 invoked by uid 500); 24 Oct 2015 21:41:37 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 32280 invoked by uid 99); 24 Oct 2015 21:41:37 -0000
Received: from Unknown (HELO spamd4-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 24 Oct 2015 21:41:37 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd4-us-west.apache.org (ASF Mail Server at spamd4-us-west.apache.org) with ESMTP id 5094CC0C5B
	for <dev@httpd.apache.org>; Sat, 24 Oct 2015 21:41:37 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd4-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 0.001
X-Spam-Level:
X-Spam-Status: No, score=0.001 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, URIBL_BLOCKED=0.001]
	autolearn=disabled
Authentication-Results: spamd4-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=comcast.net
Received: from mx1-us-west.apache.org ([10.40.0.8])
	by localhost (spamd4-us-west.apache.org [10.40.0.11]) (amavisd-new, port 10024)
	with ESMTP id VCVUgI3Vd4c3 for <dev@httpd.apache.org>;
	Sat, 24 Oct 2015 21:41:27 +0000 (UTC)
Received: from resqmta-ch2-03v.sys.comcast.net (resqmta-ch2-03v.sys.comcast.net [69.252.207.35])
	by mx1-us-west.apache.org (ASF Mail Server at mx1-us-west.apache.org) with ESMTPS id 9BAEB20754
	for <dev@httpd.apache.org>; Sat, 24 Oct 2015 21:41:27 +0000 (UTC)
Received: from resomta-ch2-04v.sys.comcast.net ([69.252.207.100])
	by resqmta-ch2-03v.sys.comcast.net with comcast
	id Z9gu1r0012AWL2D019hSzb; Sat, 24 Oct 2015 21:41:26 +0000
Received: from [192.168.199.10] ([69.251.84.114])
	by resomta-ch2-04v.sys.comcast.net with comcast
	id Z9hS1r0012U0RYt019hSx2; Sat, 24 Oct 2015 21:41:26 +0000
Content-Type: text/plain; charset=us-ascii
Mime-Version: 1.0 (Mac OS X Mail 8.2 \(2104\))
Subject: Re: Update bugzilla for 2.4.17
From: Jim Jagielski <jim@jaguNET.com>
In-Reply-To: <CALK=YjNbtwP1d0HJfrv0qe8zw_Zt2nySVv8PS8DCFj2LTfkkGg@mail.gmail.com>
Date: Sat, 24 Oct 2015 17:41:25 -0400
Content-Transfer-Encoding: 7bit
Message-Id: <5FE4ED5A-0C7B-4E0F-8435-C421DA4BC939@jaguNET.com>
References: <3366461.Sg1y3aIt4e@k> <CALK=YjNbtwP1d0HJfrv0qe8zw_Zt2nySVv8PS8DCFj2LTfkkGg@mail.gmail.com>
To: dev@httpd.apache.org
X-Mailer: Apple Mail (2.2104)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=comcast.net;
	s=q20140121; t=1445722886;
	bh=zcYj+mD6YtyjWhPpRdvo/Bl1yItttUt2pHZ72jZZHxs=;
	h=Received:Received:Content-Type:Mime-Version:Subject:From:Date:
	 Message-Id:To;
	b=tTXNt03ESt48Iyi+8A+SlrcDRY6YxBsnz5nJtE/ehKFU7qXCkBaKQKFJHVjnrUPPN
	 9yl0ZtJFyvNzHNUwFxqQSmDkbKZpHflz3LzHDsRUuRSNNwI32xq3nlaSxYluTt3uA1
	 auh0fZS6QPazAgleEkPYAJ/C3kX6fd8HESDMZ0DrPEKAn9SogopZRU6ow79jU6C5uA
	 AScTeBeptNwxOqP3N6O/FHYM9Eb1Jt3l3mh5ao2eGsuE/4MpcUksgizu0aPWPs2qdm
	 UCIYMf7LJhgSz3/EOlf+HSIHknMhfx2Ou3ADKFLA7sy0btVkDIpvrPiGDibr/ylMBR
	 sC7NSC3QrtqRQ==

How does one do this? I should add this to the T&R and Release
guide.

which itself needs to be majorly updated :)

> On Oct 24, 2015, at 4:36 PM, Eric Covener <covener@gmail.com> wrote:
> 
> On Sat, Oct 24, 2015 at 4:32 PM, Stefan Fritsch <sf@sfritsch.de> wrote:
>> can anyone with bugzilla fu please add 2.4.17 and mod_http2 to the
>> bugzilla selections? Thanks.
> 
> Both available now


From dev-return-84443-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Sat Oct 24 21:53:56 2015
Return-Path: <dev-return-84443-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 37094109E9
	for <apmail-httpd-dev-archive@www.apache.org>; Sat, 24 Oct 2015 21:53:56 +0000 (UTC)
Received: (qmail 38832 invoked by uid 500); 24 Oct 2015 21:53:55 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 38765 invoked by uid 500); 24 Oct 2015 21:53:55 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 38755 invoked by uid 99); 24 Oct 2015 21:53:55 -0000
Received: from Unknown (HELO spamd4-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 24 Oct 2015 21:53:55 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd4-us-west.apache.org (ASF Mail Server at spamd4-us-west.apache.org) with ESMTP id 47798C0B79
	for <dev@httpd.apache.org>; Sat, 24 Oct 2015 21:53:55 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd4-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.101
X-Spam-Level:
X-Spam-Status: No, score=-0.101 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RCVD_IN_MSPIKE_H2=-0.001, SPF_PASS=-0.001, URIBL_BLOCKED=0.001]
	autolearn=disabled
Authentication-Results: spamd4-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-us-west.apache.org ([10.40.0.8])
	by localhost (spamd4-us-west.apache.org [10.40.0.11]) (amavisd-new, port 10024)
	with ESMTP id MX4mp3gWcSkm for <dev@httpd.apache.org>;
	Sat, 24 Oct 2015 21:53:47 +0000 (UTC)
Received: from mail-io0-f176.google.com (mail-io0-f176.google.com [209.85.223.176])
	by mx1-us-west.apache.org (ASF Mail Server at mx1-us-west.apache.org) with ESMTPS id B623D20562
	for <dev@httpd.apache.org>; Sat, 24 Oct 2015 21:53:46 +0000 (UTC)
Received: by iodv82 with SMTP id v82so154057189iod.0
        for <dev@httpd.apache.org>; Sat, 24 Oct 2015 14:53:40 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        bh=2ubYpWs/4c5hYE5OtJwPY1ur+9gR8iPx7K7ksT1QKfs=;
        b=iN0BuQSQ3xauag/b+z68fpVB4Vofx1Xo6f8Dw5TVCLz6zv2X3Io63pK2NDXLHIPW2X
         IjapdhEjX3B2z7Xqte3ZkP8VyXkqDb4BXFZ6P+9XaqAJs/OZFhOPFWTtSGB3qgDXLK9x
         9nrL3W7UTDtRttn4fWXhfGXgV3sUaAfS69CiTIiXDkJY7rSDDScoSAQMBfoF2izr00/S
         qTTV3d/pVR0bQH7nzX2sBIu5t0G8Z8Wwnq1L0bSfaSH2X8d2UXMgfaGjmTVAIviaeDSu
         VSzB1I41NDSei40dMmZPAKxyu0PqPa0db8eaET0smz64CreU/RdZV+r98KonQ5P0F75D
         D+DA==
MIME-Version: 1.0
X-Received: by 10.107.14.4 with SMTP id 4mr2785480ioo.169.1445723620468; Sat,
 24 Oct 2015 14:53:40 -0700 (PDT)
Received: by 10.64.112.69 with HTTP; Sat, 24 Oct 2015 14:53:40 -0700 (PDT)
In-Reply-To: <5FE4ED5A-0C7B-4E0F-8435-C421DA4BC939@jaguNET.com>
References: <3366461.Sg1y3aIt4e@k>
	<CALK=YjNbtwP1d0HJfrv0qe8zw_Zt2nySVv8PS8DCFj2LTfkkGg@mail.gmail.com>
	<5FE4ED5A-0C7B-4E0F-8435-C421DA4BC939@jaguNET.com>
Date: Sat, 24 Oct 2015 17:53:40 -0400
Message-ID: <CALK=YjN=+eg_A_1Geak0gvv3rrPGXgGEfUKxyN2eLt4xmaYZvw@mail.gmail.com>
Subject: Re: Update bugzilla for 2.4.17
From: Eric Covener <covener@gmail.com>
To: Apache HTTP Server Development List <dev@httpd.apache.org>
Content-Type: text/plain; charset=UTF-8

On Sat, Oct 24, 2015 at 5:41 PM, Jim Jagielski <jim@jagunet.com> wrote:
> How does one do this? I should add this to the T&R and Release
> guide.
>

Direct link is https://bz.apache.org/bugzilla/editversions.cgi?action=add&product=Apache%20httpd-2
You can get there by selecting Administration from the top of BZ, the
product, httpd-2, versions, then a tiny asy to miss "add" hyperlink.

From dev-return-84444-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Sun Oct 25 04:32:53 2015
Return-Path: <dev-return-84444-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 3D974180DE
	for <apmail-httpd-dev-archive@www.apache.org>; Sun, 25 Oct 2015 04:32:53 +0000 (UTC)
Received: (qmail 51772 invoked by uid 500); 25 Oct 2015 04:32:52 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 51698 invoked by uid 500); 25 Oct 2015 04:32:52 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 51688 invoked by uid 99); 25 Oct 2015 04:32:52 -0000
Received: from Unknown (HELO spamd3-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 25 Oct 2015 04:32:52 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd3-us-west.apache.org (ASF Mail Server at spamd3-us-west.apache.org) with ESMTP id 1E48F180EA5
	for <dev@httpd.apache.org>; Sun, 25 Oct 2015 04:32:52 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd3-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 3.731
X-Spam-Level: ***
X-Spam-Status: No, score=3.731 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, HTML_MESSAGE=3,
	KAM_INFOUSMEBIZ=0.75, RCVD_IN_MSPIKE_H3=-0.01,
	RCVD_IN_MSPIKE_WL=-0.01, URIBL_BLOCKED=0.001] autolearn=disabled
Authentication-Results: spamd3-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=skepticism_us.20150623.gappssmtp.com
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd3-us-west.apache.org [10.40.0.10]) (amavisd-new, port 10024)
	with ESMTP id aXNv2_91nohL for <dev@httpd.apache.org>;
	Sun, 25 Oct 2015 04:32:45 +0000 (UTC)
Received: from mail-lf0-f50.google.com (mail-lf0-f50.google.com [209.85.215.50])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id 00F8F20751
	for <dev@httpd.apache.org>; Sun, 25 Oct 2015 04:32:44 +0000 (UTC)
Received: by lfaz124 with SMTP id z124so117900126lfa.1
        for <dev@httpd.apache.org>; Sat, 24 Oct 2015 21:32:38 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=skepticism_us.20150623.gappssmtp.com; s=20150623;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        bh=hxdKUtleyUhbWzj237iXkUgOn4FymwW6Jko3EGsAlQA=;
        b=bVi9w4PdfoCAEKdGMZUbk3FwsxETZAH9Kic36hk4jEnYDPnv9zqZsQ5jOiosRye7ya
         cr8BP5LgPMavd7BZ4HR2Y7+eyEjAW8xcZVK29/61RaIrA1G5Xq5bMOcsA6yRwVReWVQA
         jHKuBEy6Sn5AS7AWKIK18cP2ce1QA52HylAa8MTU/v5gHCMa4laxxxM+jmiFfkcgljfm
         2NB/VFoZABgpy+yEh8lqg5TO1y1nrfpctv+cKc5QQtj6Jej9zkSiBNAf0o0N3JjJDUUo
         QCU5uLMxTIWzjPA1Qp1G725EsLJZUzjQkB6lUZQ1gZBlfE+S0ApDR4Pl+DdzMU1HVrA+
         xhkA==
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=1e100.net; s=20130820;
        h=x-gm-message-state:mime-version:in-reply-to:references:date
         :message-id:subject:from:to:content-type;
        bh=hxdKUtleyUhbWzj237iXkUgOn4FymwW6Jko3EGsAlQA=;
        b=LJHo0MIDrImp4AKDw4rzYqABRFaclMKzGyXpd1iLw6vd0h/JAr7BWrNJ7R2eWq9jTJ
         ubUJXD+548o5jZswym3ddk0jWUhGweW1FSvhnZj2CUG/2hg2r/uguuu612+wJmy0F+lF
         +A8ng2hWx/vY4OQ+ptyjtcD3YXnVHh4/nZYbn4pQzhSQaED8WQKlPSJwaj+U2xoYA7K4
         XeslkpRwHSdye7sb3POfchcWoan67JvEJImpShoaYNTD3i0OlMGm4lTr1ND9gijLTp7B
         hh0LUMq8WuTnt4QbjPt6H70X2s4bajhJYOsNNWsADGwhYp5uPGvLprju5KsyVfScSecL
         CGhw==
X-Gm-Message-State: ALoCoQnu4Zo6Xo7TJJ1kYwKPUobLTugzqwFvc3Tbw1SsyzUdJUEw4X49sF7u6omlU4aJ27+5EPZx
MIME-Version: 1.0
X-Received: by 10.25.166.140 with SMTP id p134mr4991907lfe.114.1445747558298;
 Sat, 24 Oct 2015 21:32:38 -0700 (PDT)
Received: by 10.112.72.34 with HTTP; Sat, 24 Oct 2015 21:32:38 -0700 (PDT)
In-Reply-To: <38B6AA15-AB3C-47AC-B96D-7DA8094F99F9@jaguNET.com>
References: <38B6AA15-AB3C-47AC-B96D-7DA8094F99F9@jaguNET.com>
Date: Sat, 24 Oct 2015 21:32:38 -0700
Message-ID: <CABx2=D_JU19ztacoifzhTJfX5sb_UOfdVrTEmWpPcTwwOsy4vA@mail.gmail.com>
Subject: Re: Is Apache getting too patchy?
From: Kurtis Rader <krader@skepticism.us>
To: dev@httpd.apache.org
Content-Type: multipart/alternative; boundary=001a114118c6a5ce1a0522e655ef

--001a114118c6a5ce1a0522e655ef
Content-Type: text/plain; charset=UTF-8

On Sat, Oct 24, 2015 at 8:49 AM, Jim Jagielski <jim@jagunet.com> wrote:

> Just some food for thought; let me know if I'm off the rails.
>
> Over the last several months, it's appeared to me that we have
> been adding patches that feel, well, very-patchy to me. They
> feel like cumbersome add-ons that create some level of fragility
> to our code, with special one-off considerations instead of a
> deeper more complete fix. In other words, it seems that httpd is
> becoming more crufty rather than planned and cohesive and
> consistent.
>
> Thoughts? Comments?
>

I agree. I recently contributed to the improvement of the Apache HTTP
server source code when I noticed that mod_dumpio.c was badly broken (it
does not correctly handle null bytes). Which caused me to subscribe to the
dev mailing list and read some earlier messages. I have been underwhelmed
with the quality of the arguments for a given change or the code itself.
Frankly, I would not allow almost all of the proposed changes I've seen
(including my first patch to mod_dumpio.c) to be accepted.

People reviewing changes to the existing code base have to be hard-nosed
assholes. You have to reject changes that are problematic unless there is
a) a "TODO" comment explaining the unresolved issues and b) a reason to
believe the contributor or someone might resolve those issues in the near
future. Similarly style issues are not just nitpicking. They are show
stoppers for accepting a change. Every time I look at code that has a style
different from the surrounding code it makes it more likely I'll overlook a
bug or misinterpret what the code does.

-- 
Kurtis Rader
Caretaker of the exceptional canines Junior and Hank

--001a114118c6a5ce1a0522e655ef
Content-Type: text/html; charset=UTF-8
Content-Transfer-Encoding: quoted-printable

<div dir=3D"ltr"><div class=3D"gmail_extra"><div class=3D"gmail_quote">On S=
at, Oct 24, 2015 at 8:49 AM, Jim Jagielski <span dir=3D"ltr">&lt;<a href=3D=
"mailto:jim@jagunet.com" target=3D"_blank">jim@jagunet.com</a>&gt;</span> w=
rote:<br><blockquote class=3D"gmail_quote" style=3D"margin:0 0 0 .8ex;borde=
r-left:1px #ccc solid;padding-left:1ex">Just some food for thought; let me =
know if I&#39;m off the rails.<br>
<br>
Over the last several months, it&#39;s appeared to me that we have<br>
been adding patches that feel, well, very-patchy to me. They<br>
feel like cumbersome add-ons that create some level of fragility<br>
to our code, with special one-off considerations instead of a<br>
deeper more complete fix. In other words, it seems that httpd is<br>
becoming more crufty rather than planned and cohesive and<br>
consistent.<br>
<br>
Thoughts? Comments?<br></blockquote><div><br></div><div>I agree. I recently=
 contributed to the improvement of the Apache HTTP server source code when =
I noticed that mod_dumpio.c was badly broken (it does not correctly handle =
null bytes). Which caused me to subscribe to the dev mailing list and read =
some earlier messages. I have been underwhelmed with the quality of the arg=
uments for a given change or the code itself. Frankly, I would not allow al=
most all of the proposed changes I&#39;ve seen (including my first patch to=
 mod_dumpio.c) to be accepted.</div><div><br></div><div>People reviewing ch=
anges to the existing code base have to be hard-nosed assholes. You have to=
 reject changes that are problematic unless there is a) a &quot;TODO&quot; =
comment explaining the unresolved issues and b) a reason to believe the con=
tributor or someone might resolve those issues in the near future. Similarl=
y style issues are not just nitpicking. They are show stoppers for acceptin=
g a change. Every time I look at code that has a style different from the s=
urrounding code it makes it more likely I&#39;ll overlook a bug or misinter=
pret what the code does.</div></div><div><br></div>-- <br><div class=3D"gma=
il_signature"><div dir=3D"ltr">Kurtis Rader<div>Caretaker of the exceptiona=
l canines Junior and Hank</div></div></div>
</div></div>

--001a114118c6a5ce1a0522e655ef--

From dev-return-84445-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Sun Oct 25 07:16:24 2015
Return-Path: <dev-return-84445-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 8352D18322
	for <apmail-httpd-dev-archive@www.apache.org>; Sun, 25 Oct 2015 07:16:24 +0000 (UTC)
Received: (qmail 78515 invoked by uid 500); 25 Oct 2015 07:16:23 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 78448 invoked by uid 500); 25 Oct 2015 07:16:23 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 78436 invoked by uid 99); 25 Oct 2015 07:16:23 -0000
Received: from mail-relay.apache.org (HELO mail-relay.apache.org) (140.211.11.15)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 25 Oct 2015 07:16:23 +0000
Received: from asf-bz1-us-mid.priv.apache.org (nat1-us-mid.apache.org [23.253.172.122])
	by mail-relay.apache.org (ASF Mail Server at mail-relay.apache.org) with ESMTPS id 3D0C41A0094
	for <dev@httpd.apache.org>; Sun, 25 Oct 2015 07:16:23 +0000 (UTC)
Received: by asf-bz1-us-mid.priv.apache.org (ASF Mail Server at asf-bz1-us-mid.priv.apache.org, from userid 0)
	id B983D60C6F; Sun, 25 Oct 2015 07:15:55 +0000 (UTC)
From: bugzilla@apache.org
To: dev@httpd.apache.org
Subject: Bug report for Apache httpd-2 [2015/10/25]
Message-Id: <20151025071620.B983D60C6F@asf-bz1-us-mid.priv.apache.org>
Date: Sun, 25 Oct 2015 07:15:46 +0000 (UTC)

+---------------------------------------------------------------------------+
| Bugzilla Bug ID                                                           |
|     +---------------------------------------------------------------------+
|     | Status: UNC=Unconfirmed NEW=New         ASS=Assigned                |
|     |         OPN=Reopened    VER=Verified    (Skipped Closed/Resolved)   |
|     |   +-----------------------------------------------------------------+
|     |   | Severity: BLK=Blocker CRI=Critical  REG=Regression  MAJ=Major   |
|     |   |           MIN=Minor   NOR=Normal    ENH=Enhancement TRV=Trivial |
|     |   |   +-------------------------------------------------------------+
|     |   |   | Date Posted                                                 |
|     |   |   |          +--------------------------------------------------+
|     |   |   |          | Description                                      |
|     |   |   |          |                                                  |
| 7483|Ass|Enh|2002-03-26|Add FileAction directive to assign a cgi interpret|
| 8713|Inf|Min|2002-05-01|No Errorlog on PROPFIND/Depth:Infinity            |
| 8867|Opn|Cri|2002-05-07|exports.c generation fails when using a symlink to|
|10747|New|Maj|2002-07-12|ftp SIZE command and 'smart' ftp servers results i|
|11294|New|Enh|2002-07-30|desired vhost_alias option                        |
|11580|Opn|Enh|2002-08-09|generate Content-Location headers                 |
|12033|Opn|Nor|2002-08-26|Graceful restart immediately result in [warn] long|
|12680|New|Enh|2002-09-16|Digest authentication with integrity protection   |
|13599|Inf|Nor|2002-10-14|autoindex formating broken for multibyte sequences|
|13661|Ass|Enh|2002-10-15|Apache cannot not handle dynamic IP reallocation  |
|14104|Opn|Enh|2002-10-30|not documented: must restart server to load new CR|
|14496|New|Enh|2002-11-13|Cannot upgrade any version on Windows. Must uninst|
|14922|Inf|Enh|2002-11-28|<target> is currently hardcoded to 'apache2'      |
|15719|Inf|Nor|2002-12-30|WebDAV MOVE to destination URI which is content-ne|
|16761|Inf|Nor|2003-02-04|CustomLog with pipe spawns process during config  |
|16802|New|Enh|2003-02-05|Additional AllowOverride directive "Restrict"     |
|16811|Ass|Maj|2003-02-05|mod_autoindex always return webpages in UTF-8.    |
|17107|New|Min|2003-02-16|Windows should not install printenv               |
|17114|New|Enh|2003-02-17|Please add strip and install-strip targets to Make|
|17244|Ass|Nor|2003-02-20|./configure --help gives false information regardi|
|17497|Opn|Nor|2003-02-27|mod_mime_magic generates incorrect response header|
|18325|New|Enh|2003-03-25|PAM support for suEXEC                            |
|18334|Inf|Cri|2003-03-25|Server crashes when authenticating users against L|
|18497|New|Min|2003-03-30|configure --help gives wrong default for sysconfdi|
|19043|New|Min|2003-04-15|Interesting interaction between cern_meta module a|
|19670|New|Enh|2003-05-05|content type header supplied upon PUT is thrown aw|
|20036|Ass|Nor|2003-05-19|Trailing Dots stripped from PATH_INFO environment |
|21253|New|Nor|2003-07-01|Mime magic doesn't continue if type is specifed fo|
|21260|New|Nor|2003-07-02|CacheMaxExpire directive not enforced !           |
|21533|Ass|Cri|2003-07-11|Multiple levels of htacces files can cause mod_aut|
|22138|Inf|Cri|2003-08-05|Webdav is not preccessing special chars right.    |
|22237|New|Enh|2003-08-08|option to disable ServerSignature on index pages  |
|22484|Opn|Maj|2003-08-16|semaphore problem takes httpd down                |
|22686|Opn|Nor|2003-08-25|ab: apr_poll: The timeout specified has expired (7|
|22898|Opn|Nor|2003-09-02|nph scripts with two HTTP header                  |
|23167|Inf|Cri|2003-09-14|--enable-layout never goes to apr apr-util        |
|23181|New|Nor|2003-09-15|Status 304 (Not modified) and chunking leads to an|
|23238|New|Cri|2003-09-18|non-async-signal-safe operations from signal handl|
|23330|New|Enh|2003-09-22|Enhance ApacheMonitor to view and control Tomcat s|
|23911|Opn|Cri|2003-10-18|CGI processes left defunct/zombie under 2.0.54    |
|24031|New|Enh|2003-10-23|Passphrase protected private key in SSLProxyMachin|
|24095|Opn|Cri|2003-10-24|ERROR "Parent: child process exited with status 32|
|24437|Opn|Nor|2003-11-05|mod_auth_ldap doubly-escapes backslash (\) charact|
|24890|Opn|Nor|2003-11-21|Apache config parser should not be local aware ( g|
|25014|New|Enh|2003-11-26|A flexible interface for mod_log_config           |
|25201|New|Enh|2003-12-04|Provide Cache Purge operation                     |
|25240|Inf|Enh|2003-12-05|SSL Library Error: 336105671 logged as information|
|25435|New|Enh|2003-12-11|sethandler and directoryindex not playing nice    |
|25469|Opn|Enh|2003-12-12|create AuthRoot for defining paths to auth files  |
|25484|Ass|Nor|2003-12-12|Non-service Apache cannot be stopped in WinXP     |
|25543|Inf|Nor|2003-12-15|mod_proxy_ajp overwrites existing response headers|
|25667|New|Nor|2003-12-19|Memory leak in function ssl_scache_dbm_retrieve().|
|25863|New|Enh|2004-01-02|new per-host initialization hooks                 |
|26005|New|Nor|2004-01-08|SERVER_NAME incorrect when using IPv6 address in U|
|26142|New|Maj|2004-01-14|EnableSendFile Off for Windows XP Home            |
|26153|Opn|Cri|2004-01-15|Apache cygwin directory traversal vulnerability   |
|26368|New|Min|2004-01-23|File extensions in AddDescription treated as part |
|26446|New|Nor|2004-01-26|flush buckets followed by eos bucket emit multiple|
|26478|New|Enh|2004-01-28|mod_dav does not expose a method for setting the D|
|26835|New|Enh|2004-02-10|[PATCH] Mod_status Readability & Browser Side Tabl|
|27257|Ass|Enh|2004-02-26|rotatelogs with getopt and setuid                 |
|27578|New|Enh|2004-03-10|made getlastmodified a writable property          |
|27715|Ass|Enh|2004-03-16|Client sending misformed Range "bytes = 0-100" ins|
|27791|Inf|Nor|2004-03-18|mod_cache doesn't re-cache expired content        |
|27835|New|Enh|2004-03-22|When proxying FTP, all errors turns into 404      |
|27869|New|Enh|2004-03-23|stopping and starting httpd again immediately caus|
|28854|Inf|Nor|2004-05-09|Build fails with missing library call on Solaris i|
|28903|New|Enh|2004-05-11|Hooks to add environment variables to CGI and othe|
|29090|Ass|Enh|2004-05-19|MultiviewsMatch NegotiatedOnly extensions not resp|
|29165|New|Nor|2004-05-24|Parent directory icon not correct                 |
|29446|New|Enh|2004-06-08|want directive for setting content negotiation qua|
|29449|New|Enh|2004-06-09|Limit length of specified fields in LogFormat     |
|29450|New|Enh|2004-06-09|Improved logging for mod_access                   |
|29510|Ass|Enh|2004-06-10|ab does not support multiple cookies              |
|29644|Ver|Nor|2004-06-17|mod_proxy keeps downloading even after the client |
|29755|Opn|Nor|2004-06-23|mod_usertrack should use err_headers_out          |
|29822|New|Enh|2004-06-26|implement FTP 'PUT' support in proxy_ftp.c        |
|29941|Ass|Enh|2004-07-06|log files are not tested for availability on confi|
|30259|Ass|Enh|2004-07-22|When proxy connects to backend, a DNS lookup is do|
|30505|Ass|Enh|2004-08-05|Apache uses 'Error', and not lower level event typ|
|30730|Inf|Nor|2004-08-18|[PatchAvailable] mod_actions and Server-Status    |
|30865|Inf|Maj|2004-08-26|mod_disk_cache leaves many temporary files slowing|
|31302|Opn|Cri|2004-09-19|suexec doesn't execute commands if they're not in |
|31311|New|Enh|2004-09-20|Remote user not logged in reverse proxy scenario  |
|31352|Ass|Enh|2004-09-21|RFE, Bind to LDAP server with browser supplier use|
|31418|Opn|Nor|2004-09-25|SSLUserName is not usable by other modules        |
|31484|New|Maj|2004-09-30|Custom environment variables not passed to content|
|31490|New|Nor|2004-09-30|mod_proxy_ftp renders filenames with spaces badly |
|31565|New|Enh|2004-10-06|Won't start correctly if parent closed stdin, stdo|
|31679|New|Enh|2004-10-12|If the argument of a CGI has two or more consecuti|
|31709|Inf|Nor|2004-10-13|Raises an error on SSL name based virtualhosts (wi|
|31712|New|Enh|2004-10-14|config_file is NULL at ap_walk_config etc         |
|31952|New|Enh|2004-10-29|mod_proxy and RealPlayer: audio content streaming |
|32051|Opn|Nor|2004-11-04|mod_example is not thread safe                    |
|32328|Opn|Enh|2004-11-19|Make mod_rewrite escaping optional / expose intern|
|32346|New|Enh|2004-11-22|mod_include/include virtual checks content-type is|
|32524|New|Enh|2004-12-03|ab: add an option to specify a source address     |
|32703|Inf|Enh|2004-12-14|Cannot determine that Apache is frozen if /var fil|
|32750|Ass|Maj|2004-12-17|mod_proxy + Win32DisableAcceptEx = memory leak    |
|32877|New|Enh|2004-12-29|wrong utf-8 encoding/escaping in a href for umlaut|
|33084|New|Enh|2005-01-13|Optional certificate validity period check on SSLV|
|33089|New|Nor|2005-01-13|mod_include: Options +Includes (or IncludesNoExec)|
|33207|New|Nor|2005-01-23|Results of my suexec.c code audit                 |
|33215|New|Nor|2005-01-24|Cygwin build/install.sh fix (OSTYPE => ext=.exe)  |
|33512|Inf|Maj|2005-02-11|mod_mem_cache and possibly mod_deflate            |
|33627|New|Nor|2005-02-18|Bite-sized changes making progress towards compila|
|33685|New|Maj|2005-02-22|Unable to install in the path containing non engli|
|34270|Inf|Nor|2005-04-01|Large POSTs over SSL from Internet Explorer do not|
|34375|New|Enh|2005-04-08|enhancements for mod_include                      |
|34377|New|Enh|2005-04-08|Allow the overriding of 401 Unauthorized returns f|
|34405|New|Enh|2005-04-11|adds DOCUMENT_NAME_WITHOUT_SUFFIX to mod_include  |
|34508|New|Nor|2005-04-19|Randomly slow graceful restart, not accepting new |
|34519|New|Enh|2005-04-19|Directory index should emit valid XHTML           |
|35049|New|Nor|2005-05-24|let AddDefaultCharset apply to text/css and applic|
|35077|New|Nor|2005-05-26|mod_dav passes incorrect paths with LocationMatch |
|35083|Inf|Enh|2005-05-26|Certificate validation problems trapping          |
|35098|Ver|Maj|2005-05-27|Install fails using --prefix                      |
|35154|New|Nor|2005-06-01|Support for NID_serialNumber, etc. in SSLUserName |
|35245|New|Nor|2005-06-06|cache ignores max-age cache-directive in requests |
|35250|New|Enh|2005-06-07|[PatchAvailable] add logging to mod_proxy_connect |
|35280|New|Nor|2005-06-09|FTP proxy breaks RFC 2428 when trying to fall back|
|35556|Inf|Nor|2005-06-30|CRL files not re-read by HUP                      |
|35652|Opn|Min|2005-07-07|Improve error message: "pcfg_openfile: unable to c|
|35702|New|Nor|2005-07-12|Using with https URL, ab freezes or gets SIGSEGV o|
|35781|New|Nor|2005-07-18|ap_sub_req_method_uri() bypasses Limit security co|
|35981|Inf|Maj|2005-08-02|mod_dav overrides dav_fs response on PUT failure  |
|36286|New|Enh|2005-08-20|configtest doesn't check SSL certificates         |
|36492|New|Nor|2005-09-04|split-logfile script dies when splitting log of ma|
|36495|Inf|Nor|2005-09-05|mod_proxy_ajp: ajp_check_msg_header() got bad sign|
|36564|New|Enh|2005-09-08|make mod_ldap really universal                    |
|36636|New|Maj|2005-09-13|database write lock taken for PROPFIND operations |
|36676|New|Nor|2005-09-15|time() bug in httpd/os/win32/util_win32.c:wait_for|
|36710|Opn|Blk|2005-09-19|CGI output not captured                           |
|36724|New|Nor|2005-09-20|Don't install Apache Monitor by default           |
|37110|New|Nor|2005-10-17|Build fails when source tree is read-only         |
|37196|Inf|Min|2005-10-21|Wrong "Parent directory" link                     |
|37201|New|Enh|2005-10-21|Add <IfInterface IP> syntax to apache configuratio|
|37290|Opn|Min|2005-10-28|DirectoryIndex don't work in scriptaliased directo|
|37307|New|Enh|2005-10-31|Can't suppress error messages                     |
|37355|New|Enh|2005-11-04|Allow to specify Proxy-Authorization in ProxyRemot|
|37360|New|Maj|2005-11-04|Install fails on Windows XP x64 when program files|
|37402|New|Nor|2005-11-08|mod_proxy has stopped allowing POST sub-requests  |
|37514|Inf|Nor|2005-11-15|mod_proxy buffers chunked data.                   |
|37564|New|Enh|2005-11-19|Suggestion: mod_suexec SuexecUserGroup directive i|
|37587|Inf|Min|2005-11-22|mod_status Total Traffic value goes up then down? |
|37823|Inf|Nor|2005-12-07|The openssl library linked is different between ht|
|37920|New|Maj|2005-12-15|mod_proxy does not flush data on POST requests fro|
|38116|New|Enh|2006-01-04|Chroot-Patch for SuExec                           |
|38164|New|Nor|2006-01-06|wrong status code for failed COPY/MOVE            |
|38182|New|Nor|2006-01-08|COPY ignores authority in Destination header      |
|38218|New|Enh|2006-01-10|Multiline Comments for *.conf files               |
|38240|Inf|Nor|2006-01-12|apache restart segfault with mutliple Include dire|
|38325|Opn|Nor|2006-01-20|impossible to determine AUTH_TYPE of interpreted r|
|38355|Unc|Enh|2006-01-23|DSO support for mod_rewrite                       |
|38369|New|Enh|2006-01-24|mod_proxy keeps alive connections that should be b|
|38408|New|Nor|2006-01-27|SSI environment vars not set in spawned processes |
|38419|New|Nor|2006-01-27|Problems with large WebDAV properties             |
|38478|New|Maj|2006-02-01|A client starting a SSL renegotiation can crash th|
|38515|New|Enh|2006-02-05|Dynamic LDAP Group Support                        |
|38550|New|Enh|2006-02-07|Setting headers based on proxied data             |
|38571|New|Enh|2006-02-08|CustomLog directive checked by apachectl configtes|
|38756|Inf|Nor|2006-02-22|errors with running make                          |
|38786|New|Nor|2006-02-26|"IndexOption VersionSort" has problems with traili|
|38827|New|Reg|2006-03-02|mod_disk_cache trying to rename locked tempfile on|
|38864|Inf|Enh|2006-03-06|ProxyPassReverse fails in <Location>              |
|38903|New|Maj|2006-03-09|r->allowed does not affect Allow response header  |
|38923|New|Min|2006-03-10|mod_speling incorrectly escapes linked URLs       |
|38928|New|Min|2006-03-11|propose removing "VARIANTS" feature               |
|38995|New|Nor|2006-03-16|httpd tries to communicate with the CGI daemon eve|
|39111|New|Nor|2006-03-27|Potential bug brought by mmapfile (mod_file_cache)|
|39128|Inf|Maj|2006-03-28|Apache 2.2 will not compile mod_ssl library's corr|
|39185|Inf|Nor|2006-04-03|Approximately in 1-2 weeks of work the server hang|
|39216|New|Maj|2006-04-05|mod_disk_cache trying to rename locked file, decre|
|39238|New|Nor|2006-04-07|mod_auth_dbm requires mod_auth or "no groups file?|
|39275|Opn|Nor|2006-04-11|slow child_init causes MaxClients warning         |
|39287|New|Nor|2006-04-12|Incorrect If-Modified-Since validation (due to syn|
|39299|New|Nor|2006-04-13|Internal Server Error (500) on COPY               |
|39329|Inf|Nor|2006-04-17|mod_dbd reconnection and prepared statements      |
|39370|New|Nor|2006-04-20|SSL session will be removed if the client is sendi|
|39380|Inf|Nor|2006-04-21|mod_disk_cache eats memory, has no LFS support, et|
|39418|New|Nor|2006-04-26|CacheMaxExpire directive not enforced             |
|39448|New|Min|2006-04-29|old-style <directory proxy:*> doesn't give any war|
|39498|New|Nor|2006-05-06|accept_filter in apr assumes if found in sys/socke|
|39517|New|Nor|2006-05-08|Corrupt chunked transfer-encoding with Content Neg|
|39658|Opn|Nor|2006-05-25|mod_proxy_ajp SSL Key Size Bug                    |
|39673|New|Nor|2006-05-29|mod_proxy opens connections that disturb NTLM     |
|39692|New|Nor|2006-05-31|mod_proxy_balancer doesn't retry a failed request |
|39723|Inf|Enh|2006-06-05|Forward proxy does not work in tranparent mode    |
|39727|Ass|Nor|2006-06-05|Incorrect ETag on gzip:ed content                 |
|39730|New|Nor|2006-06-06|LanguagePriority and DefaultLanguage are Case Sens|
|39737|New|Nor|2006-06-06|LogFormat "%{tid}P" reports wrong thread id on Win|
|39748|New|Enh|2006-06-07|Header and POST support for mod_include           |
|39753|New|Nor|2006-06-07|incorrect source for LOCALE Decimal Symbol in Win2|
|39785|Inf|Nor|2006-06-12|Status code 408 (Request Timeout) is not logged   |
|39807|Opn|Enh|2006-06-13|large files / filesystem corruption can cause apac|
|39902|New|Nor|2006-06-27|HeaderName directive breaks mod_filter somehow    |
|39904|New|Nor|2006-06-27|graceful restart error and cpu load               |
|39913|Ass|Blk|2006-06-27|detection of static OpenSSL libraries requiring li|
|39916|New|Nor|2006-06-28|Core Filters & non-blocking Sendfile              |
|39923|New|Nor|2006-06-28|AddDescription doesn't work in server config with |
|39928|New|Nor|2006-06-28|port no detected when file name not in URL        |
|39935|New|Nor|2006-06-29|AddDescription does not do literal comparisons on |
|39973|Ass|Enh|2006-07-06|apache software folder should be movable          |
|40035|New|Cri|2006-07-13|Windows Server 2003 "("R2")" 64-Bit Edition no cgi|
|40060|New|Nor|2006-07-17|AuthGroupFile should accept /etc/group syntax     |
|40075|New|Enh|2006-07-19|unable to use ldap groups that contain DNs and use|
|40102|Opn|Nor|2006-07-24|SCRIPT_NAME set incorrectly with mod_rewrite      |
|40146|New|Nor|2006-07-31|mod_ssl info in server_info is blank              |
|40174|New|Min|2006-08-03|Unable to get IndexOptionis ScanHTMLTitles to work|
|40180|Inf|Maj|2006-08-03|Mod_dav and remove folder doesn't work with Micros|
|40190|New|Nor|2006-08-05|translate file                                    |
|40196|New|Nor|2006-08-06|EILSEQ handling, NoImplicitAdd should work, and so|
|40217|Opn|Nor|2006-08-08|mod_dav PROPFIND ignores access restrictions on it|
|40266|Inf|Blk|2006-08-16|berkeley db support in httpd is screwed           |
|40312|New|Nor|2006-08-24|ssl_engine_init.c, ssl_init_ctx_verify contains a |
|40373|New|Nor|2006-08-31|mod_dir adds trailing slash after internal redirec|
|40408|New|Blk|2006-09-04|Apache 2.2.3 is not starting                      |
|40416|New|Maj|2006-09-05|mod_proxy_ftp cannot connect under http load in fo|
|40441|New|Enh|2006-09-08|intelligently handling dynamic subdomains         |
|40453|New|Nor|2006-09-09|lexicographic compare in RewriteCond isn't lexicog|
|40463|New|Nor|2006-09-11|piped logging causes some weird kill()ing         |
|40513|Opn|Maj|2006-09-14|Seeding PRNG with 0 bytes of entropy              |
|40514|New|Nor|2006-09-14|would like GracefulShutdownTimeout to work for gra|
|40540|Inf|Nor|2006-09-19|Bad interaction between MultiViews and SetOutputFi|
|40541|New|Nor|2006-09-19|Action rewrites URI used by Location?             |
|40571|New|Nor|2006-09-21|mod_proxy_ajp don't works with mod_usertrack      |
|40586|New|Enh|2006-09-22|Add option to supress default '-' output          |
|40746|New|Enh|2006-10-12|Feature request: ProxyAllow directive             |
|40749|New|Min|2006-10-12|magic file with string and "%n" causes Apache chil|
|40781|New|Nor|2006-10-17|PATH_TRANSLATED: 'redirect:/~jablko/gallery2/main.|
|40808|New|Enh|2006-10-23|ProxyRemote with optional proxy authentication    |
|40859|New|Enh|2006-11-01|[PATCH] Support -F force option to 'ab' support to|
|40917|New|Nor|2006-11-07|configure does not detect OpenSSL shared lib on HP|
|40953|New|Min|2006-11-12|Should not send any data in 1xx/204/304 reply from|
|40984|Inf|Enh|2006-11-16|AddIcon, AddIconByType for OpenDocument format    |
|40987|Opn|Enh|2006-11-16|ProxyVia Block doesn't remove Via: header for reve|
|41000|New|Nor|2006-11-19|mod_authn_dbd have an error, in function 'authn_db|
|41025|New|Nor|2006-11-23|ROBOTS META-Tag directive needed in mod_autoindex |
|41088|New|Nor|2006-11-30|installation backcolor is wrong (white)           |
|41111|New|Enh|2006-12-05|New option for filters: run only if there are spar|
|41114|New|Blk|2006-12-06|ACL HTTP method is rejected by mod_proxy_ajp      |
|41130|New|Nor|2006-12-07|mod_mime and mod_negotiation type-map both clobber|
|41143|Opn|Nor|2006-12-10|Incorrect ap_getline assumption in mod_proxy_http |
|41195|New|Nor|2006-12-17|properly set the parent pid on shutdown           |
|41196|New|Nor|2006-12-17|worker mpm usage of apr's memory pools is not thre|
|41200|Inf|Maj|2006-12-18|SSI include, prevent client from receiving full ou|
|41240|Inf|Enh|2006-12-25|BRF files support                                 |
|41262|Inf|Nor|2006-12-29|Embedded pcre causes runtime segfault             |
|41362|Inf|Maj|2007-01-14|mod_disk_cache and mod_include conflict generating|
|41375|Inf|Min|2007-01-15|Using same SSL Certificate with different ServerNa|
|41391|New|Min|2007-01-17|too long period setting makes max-age overflow    |
|41412|New|Enh|2007-01-19|RewriteRule Skip should take negative arguments   |
|41435|New|Nor|2007-01-22|Authentication fails with 500 Server Error        |
|41450|Inf|Cri|2007-01-24|Empty page (200 OK) while max-age is empty        |
|41485|New|Nor|2007-01-28|LDAP client certificates not usable in 2.2.x/trunk|
|41529|New|Enh|2007-02-02|Accept BOM in .htaccess                           |
|41556|New|Enh|2007-02-07|Feature Request: format string for masking ip addr|
|41621|New|Maj|2007-02-15|Apache 2.2.4 backend problem with Apache 2.0.59 Re|
|41646|New|Nor|2007-02-16|wrong headers are sent for HEAD requests when Prox|
|41676|Opn|Enh|2007-02-22|Refactor mod_proxy_ftp                            |
|41685|New|Enh|2007-02-22|Implement optional HTTP Authentication in a standa|
|41712|Inf|Nor|2007-02-26|threads locked at logging state                   |
|41729|New|Maj|2007-02-28|error message: ap_get_scoreboard_lb(130) failed in|
|41744|Inf|Maj|2007-03-01|SSI resolves includes but removes original HTML   |
|41763|Opn|Nor|2007-03-05|mod_disk_cache ignores CacheDirLevels and CacheDir|
|41764|New|Nor|2007-03-05|error state and conf                              |
|41771|Inf|Nor|2007-03-06|Erro with mod_proxy_ajp or mod_prox_balancer      |
|41867|New|Nor|2007-03-16|<DirectoryMatch> Matches Files                    |
|41925|New|Nor|2007-03-21|trivial patch to add automatic crypting to 'dbmman|
|41929|New|Nor|2007-03-22|ISAPI ssl variables                               |
|41953|New|Nor|2007-03-26|pidfile remains when 2nd pass of post-config retur|
|41962|New|Min|2007-03-27|Need mod_auth_ldap to authenticate with Active Dir|
|42001|New|Cri|2007-03-30|LINUX : Could not set LDAP_OPT_X_TLS to LDAP_OPT_X|
|42027|Inf|Nor|2007-04-02|FileETag directive appears to be ignored          |
|42054|New|Nor|2007-04-04|service name and parameter issues                 |
|42079|New|Nor|2007-04-10|SSLRequire: Additional access in sub-directoies   |
|42082|New|Nor|2007-04-10|filter_init is called multiple times after an INCL|
|42182|Inf|Nor|2007-04-22|Mime types for cached proxied content             |
|42216|New|Enh|2007-04-24|RFE -- external overload procedure                |
|42262|Inf|Nor|2007-04-26|mod_dav /  worker fails to allocate memory and seg|
|42287|Inf|Nor|2007-04-28|chunked encoded response to POST request to cgi sc|
|42368|Inf|Nor|2007-05-09|httpd is crashing if conf/extra/httpd-manual.conf |
|42373|Inf|Maj|2007-05-09|REPORT request fails over mod_proxy               |
|42404|New|Enh|2007-05-13|Filename/info for disk-cached proxied remote URLs |
|42425|Inf|Nor|2007-05-15|Additional freshness checks in mod_cache.c cause m|
|42471|Inf|Nor|2007-05-21|clients with IE7 take 3megs per page load. httpd.e|
|42492|Inf|Nor|2007-05-22|mod_proxy_ajp with SSL front end: data corruption |
|42499|Inf|Nor|2007-05-23|Backslash produces a 404 error instead of going to|
|42548|New|Nor|2007-05-30|INCLUDE negotiating language aborts with APR_POOL_|
|42561|New|Enh|2007-05-31|[PATCH] AuthLDAPRemoteUserAttribute only applies i|
|42633|New|Min|2007-06-11|mod_info gives wrong information about actual conf|
|42665|New|Nor|2007-06-14|spurious attempt to open ".../file.html/.htaccess"|
|42666|New|Nor|2007-06-14|code & docs corrections for FollowSymLinks and Sym|
|42667|New|Nor|2007-06-14|mod_proxy_balancer not reporting when workers are |
|42668|Inf|Nor|2007-06-14|balancer_manager shows Ok status for the workers t|
|42687|New|Nor|2007-06-18|Fully delegate certificate & key semantics to the |
|42688|New|Enh|2007-06-18|engine managed keys: per process openssl context  |
|42690|New|Nor|2007-06-18|realm is not set for each configured directory whe|
|42695|Opn|Cri|2007-06-18|mod_proxy balancer problem                        |
|42699|New|Enh|2007-06-20|share mod_logio data with other modules           |
|42711|New|Enh|2007-06-20|format string for whole log entries not just id   |
|42732|Opn|Maj|2007-06-25|Authentication against database issue.            |
|42763|New|Nor|2007-06-28|graceful-stop/restart loops go loop too far       |
|42923|Inf|Maj|2007-07-17|vhost certificate NOT overriding cert from the _de|
|42972|Inf|Nor|2007-07-25|Certificate list in mod_ssl module context are not|
|42977|New|Nor|2007-07-25|DAV locking is busted when apr-util is built with |
|42987|New|Nor|2007-07-27|Weak Etags in Apache are useless and violate RFC 2|
|43012|New|Nor|2007-08-02|AIX instdso.sh libphp5.so                         |
|43027|New|Enh|2007-08-03|Header in default language                        |
|43033|New|Nor|2007-08-04|apxs does not correctly detect module name (w/o -n|
|43177|New|Nor|2007-08-21|child pid xxxxx exit signal Segmentation fault    |
|43218|New|Nor|2007-08-27|Wrong cert used for vhost if ServerName is same   |
|43220|Opn|Cri|2007-08-27|mod_proxy truncating ajp output                   |
|43249|Inf|Maj|2007-08-30|ldap_simple_bind_s failed when using SUN LDAP Libs|
|43275|New|Enh|2007-08-31|Remove avoidable network transactions in mod_proxy|
|43289|New|Nor|2007-09-02|XBitHack full g+x returns zero sized response on I|
|43308|New|Nor|2007-09-04|Persistent backend connections not supported for R|
|43352|New|Nor|2007-09-11|Apache2: out of memory during heavy webdav files c|
|43441|New|Nor|2007-09-20|Incorrect HTTP status for pre-commit-blocked autov|
|43471|New|Min|2007-09-25|no need to create a global pool on open_scoreboard|
|43481|New|Cri|2007-09-26|AuthLDAPURL must contain a final path of branch?(l|
|43494|New|Nor|2007-09-26|mod_cgid does not kill never ending scripts       |
|43502|New|Enh|2007-09-28|httpd fails to start if log directory does not exi|
|43513|New|Nor|2007-09-29|Persistent backend connections for ProxyPassMatch |
|43532|Inf|Cri|2007-10-02|Error while compiling Apache 2.2.3 on HPUX        |
|43533|Opn|Nor|2007-10-02|Frequent crashes in mod_include's bndm()          |
|43561|New|Nor|2007-10-05|apxs -q anomaly                                   |
|43577|Inf|Blk|2007-10-09|mod_authnz_ldap not working under WLDAP32 (novell/|
|43607|New|Nor|2007-10-11|mod_proxy sends data on closed connections without|
|43649|Opn|Trv|2007-10-18|mod_autoindex is generating invalid XHTML markup  |
|43652|New|Enh|2007-10-18|Suggest small change for big fix with SuExec & Vir|
|43666|New|Nor|2007-10-20|CGI works, but client denied error messages in err|
|43679|New|Enh|2007-10-23|Contributed tests for checking that subrequests ta|
|43723|Inf|Cri|2007-10-29|Apache 2.2.6 segfault when using mod_dbd          |
|43724|New|Cri|2007-10-29|Apache 2.2.6 segfault on url wich not in cache    |
|43755|New|Enh|2007-10-31|Add a SSLOptions to don't fill SSL_CLIENT_VERIFY  |
|43762|New|Enh|2007-10-31|Misleading tips in an error message about internal|
|43777|New|Nor|2007-11-01|Wrong encoding of <href> element in response      |
|43778|New|Nor|2007-11-01|Wrong responses if httpd has not access to some el|
|43785|New|Enh|2007-11-02|Tracking the per-hit impact of mod_include        |
|43792|New|Enh|2007-11-04|Feature proposal - bind phase                     |
|43818|New|Nor|2007-11-08|PROPFIND on -w- collections returns 207 MULTI-STAT|
|43838|New|Enh|2007-11-11|If-Modified-Since request and htcacheclean conflic|
|43895|New|Nor|2007-11-18|mod_mbox improvements                             |
|43897|Inf|Cri|2007-11-18|Huge memory consumption httpd 2.2.6, mod_proxy - m|
|43931|New|Enh|2007-11-21|OpenSSL autoconfig support for mod_ssl            |
|43943|New|Nor|2007-11-22|SHMCB crash due to misalignment and GCC 4 optimiza|
|43958|Inf|Maj|2007-11-26|mod_proxy_balancer not balancing correct in combin|
|43997|Opn|Min|2007-11-29|Only issue "Init: SSL server IP/Port conflict" if |
|44025|Inf|Nor|2007-12-05|Apache 2.2.6 fails to configure on OpenBSD 4.1    |
|44027|Ass|Enh|2007-12-05|Internationalized Domain Name (IDN) support       |
|44031|Opn|Maj|2007-12-06|RemoveHandler inside subdir location              |
|44034|Ass|Enh|2007-12-06|mpm_winnt doesn't call monitor hook               |
|44105|New|Nor|2007-12-19|Core dumps when using Proxy Keepalive             |
|44155|New|Enh|2007-12-31|smarter retry for LDAP_UNAVAILABLE, LDAP_BUSY, etc|
|44181|Opn|Enh|2008-01-07|add UnAlias                                       |
|44188|Inf|Cri|2008-01-08|Empty response for certain requests (mod_proxy as |
|44218|New|Min|2008-01-13|mod_autoindex shows the default icon for files wit|
|44221|Opn|Cri|2008-01-14|CheckCaseOnly On does not stop Multiple Choices ba|
|44250|New|Nor|2008-01-16|OSX 10.5: __THE_PROCESS_HAS_FORKED_AND_YOU_CANNOT_|
|44279|New|Enh|2008-01-22|Add "iterate" flag to apply rule in a loop while p|
|44302|New|Nor|2008-01-27|AuthLDAPURL does not accept ldapi:// urls         |
|44305|New|Nor|2008-01-28|Inconsistent configuration for suexec path        |
|44316|New|Nor|2008-01-28|httpd 2.0 does not follow ScriptAliases when invok|
|44322|New|Enh|2008-01-29|mod_proxy ProxyPassReverseCookieDomain with no dom|
|44351|New|Nor|2008-02-04|File descriptor leak when using prg RewriteMap    |
|44363|Inf|Maj|2008-02-05|Slow file transfers                               |
|44384|Ass|Nor|2008-02-09|mod_ssl on MacOS X 10.5.1 does not work because of|
|44453|New|Nor|2008-02-19|list_hooks.pl doesn't parse declarations that span|
|44476|New|Maj|2008-02-23|Apache service fails to start due to missing depen|
|44503|Inf|Blk|2008-02-27|Errors during SSL handshake                       |
|44518|New|Enh|2008-03-02|Don't set expires header on HTTP redirect.        |
|44578|New|Enh|2008-03-11|mod_authn_dbd option to let database validate pass|
|44601|New|Trv|2008-03-13|Add a lowercase value to Vary header for consisten|
|44602|New|Enh|2008-03-13|Options for modfying Content-Location (relative OR|
|44622|Inf|Nor|2008-03-17|POST fails to SSL vhost with proxy to HTTP backend|
|44631|New|Nor|2008-03-18|with-included-apr fails to work when using a separ|
|44638|New|Nor|2008-03-19|sed error in httpd.spec.in                        |
|44656|New|Nor|2008-03-22|Tries to retrive error document 404 instead of 406|
|44657|New|Enh|2008-03-22|prefer-type, -encoding, and -charset cookie? (as p|
|44670|New|Min|2008-03-25|Apache httpd 2.2.8 : Cannot ./configure when curre|
|44696|Inf|Nor|2008-03-27|mod_cache sometimes serves old content despite hav|
|44730|New|Nor|2008-04-01|duplicate query string in remote server url when u|
|44752|New|Nor|2008-04-03|Suexec does not correctly check that scripts are i|
|44757|New|Enh|2008-04-04|adding stderr buckets to mod_cgi                  |
|44758|New|Enh|2008-04-04|LimitRequestBody undocumented behaviour with proxi|
|44779|New|Enh|2008-04-08|Using commas and semicolons for content negotiatio|
|44855|New|Nor|2008-04-22|irregular balancing with sticky-session after re-e|
|44865|Ass|Nor|2008-04-23|mod_dav's lock database becomes consistently corru|
|44870|Inf|Nor|2008-04-24|process spinning on 100% cpu                      |
|44923|Inf|Min|2008-05-02|consequences of multiple LDAPTrustedGlobalCert    |
|44924|New|Enh|2008-05-02|allow 'CACERTDIR' in mod_ldap                     |
|44940|New|Maj|2008-05-06|Httpd randomly breaks when verifying client certif|
|44981|New|Enh|2008-05-12|Digital Certificates (CN Based) for Authorization |
|45022|New|Nor|2008-05-16|Processing of escaped glob patterns in "Include" d|
|45023|Opn|Reg|2008-05-16|DEFLATE preventing 304 NOT MODIFIED response      |
|45049|Opn|Nor|2008-05-20|mod_mem_cache caches partial content when client c|
|45054|New|Nor|2008-05-21|SSLVerifyClient optional_no_ca is broken          |
|45058|New|Nor|2008-05-21|Mod_SSL does not set AUTH_TYPE with client certifi|
|45078|New|Nor|2008-05-27|mod_proxy stalls when uploading files             |
|45103|Ass|Min|2008-05-30|apachectl should do config test before reload/rest|
|45111|New|Enh|2008-06-01|make mod_usertrack use mod_unique_id if available |
|45116|New|Nor|2008-06-02|fail to check return value of apr_file_dup2() in /|
|45148|New|Enh|2008-06-06|The actual host of the request will be more helpfu|
|45184|New|Enh|2008-06-11|Regular Expression in directive ServerAlias       |
|45187|New|Maj|2008-06-11|Long File name requests gives FORBIDDEN response  |
|45225|New|Nor|2008-06-17|XBitHack breaks DirectoryIndex + MultiViews conten|
|45253|New|Nor|2008-06-23|Unable to build httpd 2.2.9 on Solaris/SPARC      |
|45257|New|Enh|2008-06-23|add (en)force option for UseCanonicalName         |
|45259|New|Enh|2008-06-23|Add /home/[a-z]/* scheme to UserDir conf          |
|45275|New|Maj|2008-06-25|Locked files during expired page renew in disk cac|
|45281|New|Enh|2008-06-25|SITE CHMOD/SEARCH                                 |
|45287|Inf|Min|2008-06-26|build failure because of difference between BSD an|
|45297|New|Min|2008-06-27|mod_dir does not manage correctly the user (r->use|
|45302|New|Enh|2008-06-28|ServerRoot directive                              |
|45355|New|Nor|2008-07-07|ab text and html output jumbo unification         |
|45356|New|Nor|2008-07-07|ab: optionally reduce resource usage (qsort and me|
|45371|New|Nor|2008-07-10|MSI installer requires uninstall of previous versi|
|45374|New|Blk|2008-07-10|Shared memory error on starting httpd with mod_lda|
|45379|Inf|Nor|2008-07-11|[Bug] svn merge, apache and trailing slashes      |
|45385|Inf|Nor|2008-07-11|unable to compile/make 2.2.9 with --enable-ldap   |
|45393|New|Nor|2008-07-14|Apache returns 500 Error when no LDAP credentials |
|45402|New|Nor|2008-07-15|mod_autoindex incorrectly fails to list files     |
|45405|New|Enh|2008-07-16|Allow binding port to be set for individual worker|
|45449|New|Nor|2008-07-21|[PATCH] Add support to WebDav to MOVE/COPY to remo|
|45456|New|Enh|2008-07-22|mod_dbd don't allow more then one database pool   |
|45487|New|Trv|2008-07-27|broken log messages on startup in win32 version   |
|45497|New|Nor|2008-07-29|Scoreboard slot leaked using MaxRequestsPerChild a|
|45512|Ass|Maj|2008-07-31|Bad Performance of mod_proxy with SSL on Solaris 1|
|45524|New|Enh|2008-08-01|Specifying multiple vhost aliases                 |
|45525|New|Enh|2008-08-01|Switch mod_autoindex to Tango icons               |
|45579|New|Nor|2008-08-06|unknown URI scheme in request-URI ignored         |
|45674|New|Enh|2008-08-22|Allow to change error code returned by "Require ld|
|45726|New|Enh|2008-09-02|Build in a maintenance functionallity             |
|45736|New|Nor|2008-09-03|mod_dav needs a directory for its locks and one sh|
|45754|New|Enh|2008-09-06|autoconf macros                                   |
|45763|New|Nor|2008-09-08|No openssl.cnf defined by default causes OpenSSL c|
|45773|New|Nor|2008-09-09|pcre build generates sources to srcdir rather than|
|45788|New|Nor|2008-09-11|mod_log_forensic output shouldn't be buffered when|
|45801|Opn|Nor|2008-09-13|SSLRequireSSL with strictrequire and satisfy any d|
|45838|New|Nor|2008-09-18|mod_authz_owner & directories                     |
|45868|New|Nor|2008-09-23|mod_mem_cache update of headers in cache object is|
|45900|New|Nor|2008-09-26|"make install" fails from read-only filesystem    |
|45905|New|Enh|2008-09-26|ErrorDocument and default URL                     |
|45922|New|Enh|2008-09-30|Expand the conditions under which "SSLVerifyClient|
|45923|New|Nor|2008-09-30|htpasswd tries to open(file, O_RDONLY | O_APPEND) |
|45926|Inf|Nor|2008-10-01|Unable to start apache 2.2.9                      |
|45986|New|Nor|2008-10-10|[info]...Invalid argument: core_output_filter: wri|
|46024|Opn|Nor|2008-10-16|--enable-static is not available in apache's confi|
|46037|Inf|Nor|2008-10-18|Configuration of trusted OCSP responder certificat|
|46040|New|Enh|2008-10-20|Check for existing version of Apache while install|
|46054|New|Nor|2008-10-21|Running httpd returns the error "bad user name nob|
|46070|New|Nor|2008-10-22|MSI installer does not validate custom installatio|
|46071|New|Enh|2008-10-22|Allowing space in between comma and last option in|
|46074|New|Enh|2008-10-23|Need of friendly and easy to use configuration gra|
|46139|New|Nor|2008-11-02|Apache Restart option is not working              |
|46140|New|Enh|2008-11-03|Change error state in balancer manager            |
|46188|Inf|Nor|2008-11-11|Core dumps in apache 2.0.59                       |
|46195|Opn|Nor|2008-11-12|ProxyPass fails with literal IPv6 address         |
|46215|New|Nor|2008-11-14|Race condition in bybusyness algorithm            |
|46231|New|Maj|2008-11-18|Connection Pooling with ajp depends on syntax ?   |
|46241|New|Enh|2008-11-19|mod_expires - ExpiresByPattern or ExpiresIf       |
|46267|New|Nor|2008-11-22|No shared modules build if use --with-apr and --wi|
|46270|New|Enh|2008-11-23|Add FIPS 140-2 mode for mod_ssl for FIPS 1.2 modul|
|46282|New|Nor|2008-11-24|apache2.2 reverse proxy causing full memory and sw|
|46316|New|Maj|2008-12-01|Proxied SSI ProxyTimeout render failure           |
|46317|Inf|Nor|2008-12-01|mod_authnz_ldap.c(373)  seg fault                 |
|46412|New|Nor|2008-12-17|make_child return value not checked               |
|46417|New|Cri|2008-12-19|[notice] Parent: child process exited with status |
|46428|Opn|Nor|2008-12-21|Spaces in URI doesn't encode in proxy-requests    |
|46442|New|Nor|2008-12-29|Semicolon in allow/deny all rules cause reverse lo|
|46449|New|Maj|2008-12-30|Output out of order from SSI include virtual      |
|46454|New|Min|2008-12-30|escaping wildcards in AddIcon filename matching   |
|46475|New|Nor|2009-01-04|build warnings.                                   |
|46499|New|Maj|2009-01-09|httpd accept() return EAGAIN error                |
|46521|New|Nor|2009-01-13|mod_dav doesn't show symlinks                     |
|46529|Ass|Nor|2009-01-14|Child httpd processes crash with Segmentation faul|
|46534|New|Nor|2009-01-14|mod_proxy_ajp scheme and port do not follow UseCan|
|46578|New|Nor|2009-01-21|Flawed header                                     |
|46582|Ver|Min|2009-01-22|RewriteMap internal functions are not well documen|
|46604|New|Nor|2009-01-26|Error thrown when trying to rpmbuild -tb httpd sou|
|46629|New|Maj|2009-01-29|Apache hanging on system calls for php and perl   |
|46634|Ass|Nor|2009-01-30|Requests sometimes take too long, wrong time taken|
|46644|New|Enh|2009-01-31|Clean way to pass custom environment variables to |
|46646|Ass|Nor|2009-02-01|check group membership is sometimes case sensitive|
|46650|Opn|Nor|2009-02-02|CustomLog enviroment condition SCRIPT_FILENAME    |
|46656|New|Enh|2009-02-03|ProxyErrorOverride inside location                |
|46669|New|Enh|2009-02-06|rotatelogs doesn't autocreate directories         |
|46671|Opn|Cri|2009-02-07|Apache periodicaly crashes .                      |
|46678|New|Nor|2009-02-09|Fixed Content-Length using mod_ext_filter with mod|
|46682|New|Nor|2009-02-09|mod_proxy EAI_AGAIN DNS failure                   |
|46685|Opn|Nor|2009-02-09|401 sent without WWW-Authenticate header when requ|
|46709|Opn|Reg|2009-02-12|Expect: 100-continue to an HTTP/1.0 server change |
|46724|Inf|Cri|2009-02-17|WinXP SP3 - Apache crashes on startup in libapr-1.|
|46743|New|Nor|2009-02-19|Inconsistent behavior of "RewriteOptions inherit" |
|46745|New|Maj|2009-02-20|ab.c error :  undefined reference to `BIO_set_call|
|46751|New|Nor|2009-02-21|Can passenv variables who's name contain '(' or ')|
|46762|New|Nor|2009-02-24|Error, SSL/TLS libraries were missing or unusable |
|46765|Opn|Nor|2009-02-25|doubled HTTP header leads to error (Redmine)      |
|46785|Inf|Nor|2009-03-02|Child process increases to 100% (CPU)             |
|46788|New|Nor|2009-03-02|Set resource limits to avoid denial of service att|
|46810|New|Nor|2009-03-05|apxs / apu-1-config outputting erroneous include p|
|46824|New|Nor|2009-03-09|RemoveOutputFilter will not work for Filters added|
|46845|Inf|Cri|2009-03-12|Apache crashes in Windows when using subversion(pr|
|46847|New|Nor|2009-03-13|WebDAV methods with encoding other than "identity"|
|46873|New|Nor|2009-03-18|feature request: connection count on balancer-mana|
|46884|New|Min|2009-03-20|Call to apu_dso_load Fails In apr_ldap_stub.c On O|
|46946|Inf|Nor|2009-03-31|mod_mbox shows email addresses in plain text      |
|46963|New|Nor|2009-04-03|KeepAliveTimout prevents child process from exitin|
|46969|New|Nor|2009-04-05|CustomLog format %m always GET on errors with loca|
|46970|New|Nor|2009-04-05|CustomLog %X does not record aborted connections w|
|47011|New|Reg|2009-04-09|mod_proxy/mod_proxy_balancer hot-standby BalancerM|
|47055|New|Blk|2009-04-20|SSLVerifyClient + Directory doesn't use cache sess|
|47063|New|Nor|2009-04-21|mod_proxy doesn't call post_request handler when t|
|47134|New|Nor|2009-05-01|Last resolve handling when sending client certific|
|47138|New|Nor|2009-05-01|Reverse Proxy & Balancer generate error fault when|
|47152|New|Maj|2009-05-04|Apache is only serving the first character in the |
|47159|New|Nor|2009-05-06|2.2.x logresolve doesn't support ipv6             |
|47167|New|Nor|2009-05-07|Authenticated sessions being switched by reverse p|
|47170|New|Enh|2009-05-08|rotatelogs ring buffer option                     |
|47180|New|Nor|2009-05-11|DBM ssl_scache setting can cause extreme performan|
|47220|Opn|Enh|2009-05-19|Access to environment variables                   |
|47256|New|Enh|2009-05-23|Enable SSL on a per-port basis                    |
|47289|New|Nor|2009-05-30|Can't build with dynamic libraries on Mac OS 10.4 |
|47295|New|Nor|2009-06-01|AuthDBDUserPWQueryFmt/AuthDBDUserRealmQueryFmt in |
|47329|New|Nor|2009-06-07|SSLCADNRequest* & SSLCACertificate* silently do no|
|47340|New|Nor|2009-06-09|uldap_cache_comparedn() called without a lock     |
|47344|New|Enh|2009-06-10|[FEATURE REQUEST] RedirectCanonicalName           |
|47345|New|Enh|2009-06-10|rotatelogs timeout patch                          |
|47346|New|Maj|2009-06-10|mod_cache doesn't re-cache expired content when La|
|47387|Inf|Nor|2009-06-18|SSL_CLIENT_I_DN and SSL_CLIENT_S_DN use Email inst|
|47392|Opn|Nor|2009-06-18|<FilesMatch> is using the wrong directory         |
|47435|New|Nor|2009-06-26|mod_authz_host does reading of /etc/hosts on each |
|47438|Inf|Enh|2009-06-27|how to create a non-html "listing generated by the|
|47447|New|Enh|2009-06-29|Add possibility to use client IP as a value in Req|
|47484|New|Nor|2009-07-06|Spurious RewriteLock warning when using external m|
|47485|New|Enh|2009-07-06|HTML5 Websocket implementation                    |
|47514|New|Enh|2009-07-12|Personal data and restrictions based on subject di|
|47528|New|Maj|2009-07-14|Worker process won't restart more than once using |
|47542|New|Nor|2009-07-16|Piped logging processes killed before other proces|
|47562|Inf|Nor|2009-07-23|Apache/2.2.3 (Win32) mod_perl/2.0.3-rc1           |
|47578|New|Nor|2009-07-24|compile ERROR with ssl                            |
|47580|Opn|Nor|2009-07-25|mod_cache sends 200 response instead of 304       |
|47586|New|Nor|2009-07-27|httpd -k start doesn't start service when rotatelo|
|47591|New|Min|2009-07-27|show current HTTP_HOST in mod_status scoreboard   |
|47601|New|Enh|2009-07-29|Support X-Forwarded-For in forward proxy requests |
|47625|New|Nor|2009-08-02|2.2.12 win32 msi installer missing                |
|47634|New|Maj|2009-08-04|mod_ldap connection pool session keepalive not imp|
|47643|New|Enh|2009-08-04|added meta tags to xhtml output for ease of search|
|47650|Opn|Trv|2009-08-05|httxt2dbm calculates value size incorrectly       |
|47657|New|Nor|2009-08-06|Make WebDAV MOVE atomic when replacing files on sa|
|47659|New|Nor|2009-08-07|makefile.win needs check for DBM_LIST, dies on bui|
|47664|New|Nor|2009-08-07|ap_proxy_canonenc: does not recode all high-byte c|
|47665|Inf|Blk|2009-08-09|Apache service well launched but blank Screen     |
|47691|New|Enh|2009-08-12|libtool invocations should use --tag              |
|47693|Opn|Nor|2009-08-13|GET request has race condition w.r.t. replacement |
|47706|Inf|Nor|2009-08-19|(20014)Internal error: proxy: error reading status|
|47716|New|Min|2009-08-20|LimitRequestFieldSize and friends not merged well |
|47719|Opn|Enh|2009-08-20|Broken symbolic link (symlink) causes wrong ErrorD|
|47723|New|Nor|2009-08-22|suEXEC and low RLimitMem gives "crit: invalid uid"|
|47743|Inf|Nor|2009-08-26|mod_so segfaults at server startup in ap_find_load|
|47753|New|Nor|2009-08-27|output and error channels not explicitly passed fo|
|47778|Opn|Enh|2009-09-03|wrong exit value on graceful restart              |
|47780|New|Nor|2009-09-03|Critical errors should be marked by time and level|
|47807|Inf|Nor|2009-09-09|Proxy dialog error with Apache 2.2.13             |
|47808|New|Maj|2009-09-09|Child process core dumps when enabling CRL        |
|47814|Inf|Maj|2009-09-10|openssl_pkcs7_sign error                          |
|47838|New|Enh|2009-09-14|Ability to Dynamically Inject Current Time Into a |
|47874|New|Nor|2009-09-18|mod_fcgid crashes if added during restart         |
|47895|New|Maj|2009-09-24|Incorrect 413 error handling                      |
|47908|New|Min|2009-09-27|'invalid result code' in error_log                |
|47981|New|Nor|2009-10-12|allow language specific html-versions (index.html.|
|47982|New|Nor|2009-10-12|correctly interprete non-standard HTTP_ACCEPT_LANG|
|47988|New|Nor|2009-10-12|Segmentation fault                                |
|47989|New|Nor|2009-10-13|Junk string appended to compressed dynamic content|
|47994|New|Enh|2009-10-14|ScriptInterpreterSource apparently broken in Windo|
|48020|New|Nor|2009-10-17|KCP+ Opera support for mod_auth_digest            |
|48037|Inf|Nor|2009-10-21|mod_proxy_http does not handle asynchronous keepal|
|48045|New|Nor|2009-10-23|Apache 2 initgroups alert, Max OS X, abnormal exit|
|48057|New|Nor|2009-10-26|mod_fcgid creates 1 more process then allowed     |
|48094|New|Nor|2009-11-01|Avoid a race condition in close_worker_sockets()  |
|48107|New|Maj|2009-11-02|Mutual Authentication: Order in ca-bundle influenc|
|48115|New|Enh|2009-11-03|Duration to receive the request, generate response|
|48130|New|Maj|2009-11-04|DAV operations on large filesets consume all the O|
|48154|New|Nor|2009-11-06|Requests through mod_isapi are not parsed by HTTP_|
|48164|New|Enh|2009-11-09|add new parameters to rotatelogs                  |
|48219|New|Nor|2009-11-17|Retrying the worker for seems to omit POST variabl|
|48228|New|Nor|2009-11-18|Renegocation requires multiple client authenticati|
|48246|New|Enh|2009-11-19|Check permissions on file/directory specified for |
|48254|New|Trv|2009-11-20|Bogus "DocumentRoot does not exist" warning when s|
|48283|New|Nor|2009-11-25|Proxy errors since httpd 2.2.12 with Tomcat 6.0.20|
|48291|New|Maj|2009-11-26|mod_substitute loops                              |
|48295|Opn|Nor|2009-11-27|ProxyPassReverseCookiePath: Not changing path corr|
|48301|New|Enh|2009-11-30|Feature request: improved connection status report|
|48309|New|Maj|2009-11-30|libapreq2-2.12: "make test" fails at request.t and|
|48312|Opn|Nor|2009-11-30|ProxyPassReverseCookiePath: Not changing path corr|
|48316|Inf|Nor|2009-12-01|ap_run_insert_filter doesn't work in cache_url_han|
|48354|New|Enh|2009-12-08|void ap_custom_response is not supporting the bina|
|48360|New|Enh|2009-12-09|provide sample configuration file for inclusion in|
|48361|New|Enh|2009-12-09|Add global server option for specifying desired DS|
|48364|Opn|Nor|2009-12-10|PHP-generated pages are not cached in spite of per|
|48369|New|Enh|2009-12-10|add option to automatically restart if a script is|
|48431|New|Nor|2009-12-22|Error logging doesn't work when configured to use |
|48440|Inf|Cri|2009-12-23|Segmentation Fault                                |
|48449|Inf|Nor|2009-12-28|make distclean removes core.c and core_filters.c  |
|48465|Opn|Enh|2009-12-30|Support TCP to connect to backends                |
|48499|New|Nor|2010-01-06|mod_rewrite can't redirect to files with ? in them|
|48500|New|Nor|2010-01-06|mod_mbox mishandles right-click to open msg in new|
|48508|New|Nor|2010-01-07|BalancerMember doesn't accept nocanon directive   |
|48549|New|Enh|2010-01-14|Add Cache-Control s-maxage support                |
|48576|New|Nor|2010-01-19|MOVE or COPY in WebDAV fails with 404 when file ex|
|48585|New|Enh|2010-01-20|mod_cache no longer caches expired content        |
|48602|New|Enh|2010-01-23|use asynch ldap_compare so LDAPTimeout applies    |
|48623|New|Maj|2010-01-26|AuthLDAPURL syntax is not RFC-compliant, prevents |
|48639|New|Enh|2010-01-29|Add htcacheclean as a core monitored process      |
|48652|New|Maj|2010-02-01|"AuthType form" fails if a password contains  '&' |
|48659|New|Maj|2010-02-02|Problem with accents in filename and byte serving |
|48687|New|Nor|2010-02-05|mod_rewrite ignores trailing dot in request URI on|
|48705|New|Enh|2010-02-08|flag to allow newlines in the error log as opposed|
|48712|New|Enh|2010-02-09|Add UID and GID to status page                    |
|48719|New|Nor|2010-02-09|[BUG] mod_proxy_ajp return wrong error message whe|
|48721|New|Nor|2010-02-10|[Patch] Add ProxyAllow to mod_proxy               |
|48731|New|Maj|2010-02-11|Prefork not creating processes after 10 servers ar|
|48732|New|Nor|2010-02-12|[BUG] environment variable SCRIPT_NAME output erro|
|48769|New|Nor|2010-02-18|[PATCH] Processes in the busy list should not be k|
|48777|New|Maj|2010-02-19|proxy balancer not detecting correctly when host (|
|48780|New|Enh|2010-02-19|Enable mod_authnz_ldap to accept valid client cert|
|48792|New|Enh|2010-02-22|httpd util apachectl returns wrong status informat|
|48805|New|Nor|2010-02-23|Corrupted response for HTTPS + KEEPALIVE=ON       |
|48808|New|Enh|2010-02-24|mod_authz_owner support for POSIX access control l|
|48819|Inf|Nor|2010-02-25|After users login on the web page, the page does n|
|48842|Inf|Nor|2010-03-02|mod_log_config logs the full size of the file inst|
|48880|Opn|Nor|2010-03-09|error on make                                     |
|48888|New|Nor|2010-03-10|DOCTYPE definitions nearly 11 years out-of-date   |
|48920|New|Enh|2010-03-15|Breadcrumbs on mod_autoindex path                 |
|48921|Inf|Nor|2010-03-16|mod_mem_cache crash, version 2.2.15.0             |
|48937|New|Enh|2010-03-18|Feature proposal - support sasl_bind              |
|48949|Inf|Cri|2010-03-20|fcgid processes never get killed after graceful re|
|48958|New|Nor|2010-03-22|mod_ldap, ldap credential cache & graceful restart|
|48987|New|Trv|2010-03-25|typo in polish translation of HTTP_UNAUTHORIZED.ht|
|49037|New|Enh|2010-04-02|SSLVerifyClient require_no_ca                     |
|49043|New|Maj|2010-04-04|Using ssi include directive overwrites QUERY_STRIN|
|49058|New|Nor|2010-04-06|Prefork MPM tries to accept on closed listener soc|
|49067|New|Nor|2010-04-08|FTPOptions ShowUnAuthorizedFiles does not work    |
|49068|New|Nor|2010-04-08|UTF-8 URL Encode error                            |
|49087|New|Maj|2010-04-11|MSI installation reports "interrupted installation|
|49114|New|Maj|2010-04-13|NTFS junction directories missing from directory l|
|49123|New|Nor|2010-04-14|mod_proxy_ajp does not send the client's SSL chain|
|49131|New|Nor|2010-04-15|Very long URLs cause 404 or 403 errors with SetAct|
|49133|New|Maj|2010-04-16|Windows service recovery options do not work for A|
|49157|New|Nor|2010-04-20|Issues with xml interface for balancer manager    |
|49187|New|Nor|2010-04-26|Crash mod_mem_cache and mod_svn                   |
|49199|New|Enh|2010-04-27|Implement LDAP scope-aware caching in mod_ldap    |
|49220|New|Nor|2010-04-29|feature request for being able to disable FcgidWra|
|49239|New|Blk|2010-05-01|Apache mod_ssl gives coredump with openssl 0.9.8  |
|49277|New|Nor|2010-05-12|Expose a variable to identify SSL Session renegoti|
|49283|New|Nor|2010-05-12|Language of dates on SSI                          |
|49285|New|Enh|2010-05-13|Relative (local to current directory) URLs do not |
|49348|New|Enh|2010-05-27|[mod_log_config] Output log file name format capab|
|49385|New|Maj|2010-06-03|mod_disk_cache server side included files are inte|
|49387|Inf|Cri|2010-06-03|Unable to modify default charset setting to UTF-8 |
|49391|New|Nor|2010-06-05|mod_disk_cache needs to register a cleanup to kill|
|49396|New|Enh|2010-06-06|PATH_INFO normalization, especially relating to vo|
|49427|New|Nor|2010-06-11|mod_cgid and mod_cgi do not return proper value wh|
|49433|New|Enh|2010-06-13|improving info in server status                   |
|49439|New|Nor|2010-06-14|Bug in mod_userdir which prevents suexec from runn|
|49504|New|Nor|2010-06-25|Solaris 10/x64 worker graceful restart problem    |
|49532|New|Nor|2010-06-30|mod_cache: Set-Cookie headers are appended to cach|
|49553|New|Min|2010-07-05|Set QoS bits via APR2 API instead                 |
|49568|New|Maj|2010-07-07|Apache mod_authnz_ldap built with the MS LDAPSDK d|
|49632|Inf|Nor|2010-07-21|mod_authnz_ldap denies users when search is perfor|
|49633|New|Enh|2010-07-21|Handle AD primary groups in mod_authnz_ldap       |
|49642|New|Nor|2010-07-23|mod_rewrite mistakes encoded question mark as path|
|49643|New|Nor|2010-07-23|WebDav plus mod Negotiation causes directory creat|
|49676|New|Nor|2010-07-30|directory with german umlauts are indented by one |
|49680|New|Maj|2010-07-30|Perl script are not running on Win32, Apache 2.2.1|
|49684|New|Enh|2010-08-01|enhancement for ipv6 implementation               |
|49699|New|Nor|2010-08-03|Inconsistent Keep-alive from proxy to the origin s|
|49715|New|Maj|2010-08-06|ProxyPassMatch Url Encoder Problem                |
|49717|New|Enh|2010-08-06|PATCH: Enable SSL Timeout                         |
|49737|Inf|Nor|2010-08-10|order allow,deny does not work on IPv6            |
|49743|New|Maj|2010-08-12|SSI 'echo encoding="(url/none)"' bug              |
|49746|Opn|Enh|2010-08-12|mod_rewrite urlencode option                      |
|49766|New|Maj|2010-08-17|POST request on CGI script generating empty body c|
|49771|New|Nor|2010-08-17|After graceful restart using mod_proxy_ajp, couldn|
|49772|New|Nor|2010-08-18|mod_deflate kicks itself out on Content-Range resp|
|49798|Opn|Nor|2010-08-22|[mod_log_config] Piped Log scripts process cause w|
|49807|New|Enh|2010-08-23|hard to force Content-Type header for non static f|
|49810|New|Nor|2010-08-23|Mod_autoindex output of header/body/footer scrambl|
|49815|New|Enh|2010-08-24|Enable caching for HTTP Range requests / 206 respo|
|49829|New|Trv|2010-08-26|CGI index command line arguments excessively escap|
|49832|New|Enh|2010-08-26|void ap_custom_response is not supporting the bina|
|49859|Opn|Nor|2010-09-01|url with additional filepath generates bad environ|
|49921|New|Nor|2010-09-13|Trailers in chunked http requests are not handled |
|49926|New|Enh|2010-09-14|New option for mod_log_forensics or mod_log_config|
|49980|New|Nor|2010-09-22|can't use a FIFO for SSL key file; mod_ssl checks |
|49981|New|Enh|2010-09-22|Requesting SSLCertificateKeyFile Dialog functional|
|49990|New|Nor|2010-09-23|Feature request: implement ExpiresActive reset    |
|49996|New|Nor|2010-09-24|Proxied ErrorDocument returns 200 OK response code|
|49997|New|Nor|2010-09-24|wrowe promised me...                              |
|50004|New|Nor|2010-09-26|per-dir rewrite without DocumentRoot or RewriteBas|
|50011|New|Cri|2010-09-27|error running apache, and installing apache as a s|
|50024|New|Min|2010-09-29|Mod_cache/mod_mem_cache and mod_security combinati|
|50038|New|Enh|2010-10-01|What Directives apply to a file/directory? Resulta|
|50041|New|Min|2010-10-04|(9)Bad file descriptor: apr_socket_accept: (client|
|50051|New|Nor|2010-10-07|Log PID in first entry logged for each request    |
|50061|New|Nor|2010-10-08|Semicolon character '%3B' seems to be decoded to '|
|50082|New|Nor|2010-10-12|apachectl status returns incorrect exit code      |
|50112|New|Nor|2010-10-18|buildconf broken in two places                    |
|50116|New|Nor|2010-10-19|Apache fragments packets unnecessarily            |
|50151|New|Nor|2010-10-25|Software caused connection abort and apache proces|
|50155|Inf|Nor|2010-10-25|httpd -s attempts to read SSL certificates        |
|50172|Inf|Nor|2010-10-28|Digest allows access bypassing secuity            |
|50227|New|Enh|2010-11-07|Option to fail SSL handshake for diverted SNI conn|
|50237|Inf|Nor|2010-11-08|webdav LOCK access with multiple threads to same f|
|50261|New|Nor|2010-11-12|graceful restart with multiple listeners using pre|
|50262|New|Nor|2010-11-12|mod_rewrite log ip address vs hostname            |
|50274|New|Nor|2010-11-15|always pass CONTENT_LENGTH to the application     |
|50278|New|Nor|2010-11-16|-DFOREGROUND and ap_unixd_killpg()/ap_os_killpg() |
|50290|Inf|Nor|2010-11-18|vanilla apache 2.2.17 installation crashes (lib-ap|
|50296|New|Nor|2010-11-18|LDAPVerifyServerCert and possibly LDAPTrustedMode |
|50317|New|Nor|2010-11-22|Possible error in mod_cache's "Avoiding the Thunde|
|50336|New|Min|2010-11-25|PUT failures do not emit Allow:                   |
|50344|New|Nor|2010-11-26|ProxyPass does not handle different protocols when|
|50357|New|Enh|2010-11-28|improve matching mechanisms for mime type and enco|
|50372|New|Enh|2010-11-29|any reason for allowing ModMimeUsePathInfo only in|
|50390|New|Nor|2010-11-30|WARNING: Unrecognized options : --disable-ipv6    |
|50402|New|Nor|2010-12-02|SetEnv proxy-sendchunks is ignored for small amoun|
|50412|New|Nor|2010-12-04|if IndexOptions +XHTML, the correct MIME type shou|
|50423|Inf|Nor|2010-12-06|Apache is terminated with signal 11, Segmentation |
|50427|New|Nor|2010-12-07|Windows>=Vista+mod_auth_digest+command line=proble|
|50432|New|Enh|2010-12-08|add PCRE-mode for file based matches              |
|50436|New|Enh|2010-12-08|VirtualHost could behave like people expect it to |
|50444|New|Enh|2010-12-09|Pre-close logging handles in cgid agent           |
|50456|Inf|Nor|2010-12-10|Invalid Error 413 crash Apache                    |
|50464|New|Blk|2010-12-13|undefined reference to `BIO_set_callback' `BIO_set|
|50466|Inf|Maj|2010-12-13|httpd process doesn't recycle                     |
|50473|New|Maj|2010-12-14|zlib.dll Problem                                  |
|50521|New|Nor|2010-12-25|Comment at top of sample main config file is wrong|
|50525|New|Nor|2010-12-28|Header directive won't edit Location header from P|
|50530|New|Enh|2010-12-29|Provide rate limiting for failed authentication at|
|50532|New|Enh|2010-12-30|Mail protection                                   |
|50551|New|Nor|2011-01-06|Some proxied connections ignore ttl setting       |
|50562|Opn|Cri|2011-01-09|wrong PATH_INFO CGI environment with non-ASCII UTF|
|50584|New|Enh|2011-01-14|Add error message when RequestReadTimeout triggere|
|50592|New|Maj|2011-01-15|httpd dumps core on an IPv6 only system           |
|50602|New|Nor|2011-01-17|non thread safe functions used in apache httpd pro|
|50619|New|Min|2011-01-19|After changing resolv.conf signaling httpd doesn't|
|50628|New|Blk|2011-01-21|Core dump happens with Apache 2.2.15 using openssl|
|50630|New|Nor|2011-01-21|Apache return 500 error with authentication by LDA|
|50644|New|Enh|2011-01-24|Add support for maximum number of requests per Kee|
|50654|New|Nor|2011-01-25|FileETag ContentMD5 & Filename, optimisation to Co|
|50693|New|Nor|2011-01-31|AllowOverride Options=(not Foo) should permit no-o|
|50704|Inf|Nor|2011-02-01|mod_cache doesn't cache MultiViews                |
|50712|New|Maj|2011-02-02|Restart button only stops the server ...and do not|
|50727|New|Nor|2011-02-07|ISAPI EXTENSION_CONTROL_BLOCK Missing PostData wit|
|50765|New|Enh|2011-02-11|Runtime Backend Pinning via balancer-manager      |
|50770|New|Nor|2011-02-14|a rotatelogs issue, if time changed               |
|50773|Inf|Nor|2011-02-14|Dav lock database corruption                      |
|50774|New|Enh|2011-02-14|Have a way to invalidate cache without other reque|
|50777|New|Nor|2011-02-14|Back port buildconf specifies AC_PREREQ(2.13) fix |
|50796|New|Enh|2011-02-16|record time between keepalives in access log      |
|50807|New|Maj|2011-02-18|mod_proxy fails to send FIN response when a FIN is|
|50814|New|Nor|2011-02-21|SSI exec not working on Windows (Apache 2.x)      |
|50848|New|Enh|2011-03-01|Content Negotiation type map file precedence could|
|50869|New|Enh|2011-03-04|Need directive to control use and timeout of sessi|
|50873|New|Nor|2011-03-04|httpd does not start properly when built from sour|
|50878|New|Nor|2011-03-05|redundant operation when calling apr_stat         |
|50891|New|Nor|2011-03-08|Apache rewrites WWW-Authenticate headers from CGI |
|50902|Inf|Maj|2011-03-09|on major load on the server, poll() hangs         |
|50916|New|Nor|2011-03-11|RewriteMap program: mod_rewrite sends request but |
|50926|New|Nor|2011-03-14|unexpected <Directory> file-matching behavior     |
|50942|New|Maj|2011-03-17|Apache 2.2.16 forward proxy is 5x times slower tha|
|50945|Opn|Nor|2011-03-18|AJP: Missing support for ErrorOverride            |
|50948|Opn|Nor|2011-03-19|Connection not closed when CGI dies waiting for PO|
|50954|New|Nor|2011-03-21|ProxyRemote doesnt use CONNECT method with https s|
|50959|New|Enh|2011-03-23|Add cache-manifest to the mime type list          |
|50976|New|Nor|2011-03-26|Apache losts client's ip (%a or %h) sometimes.    |
|50999|Opn|Nor|2011-03-30|it seems the configure wrong detect my apr-util ve|
|51001|New|Nor|2011-03-31|patch for hook ap_lua_run_lua_open                |
|51005|New|Enh|2011-04-01|Allow to use username in LDAP filter              |
|51006|New|Blk|2011-04-01|Apache consume all memory and swap when setup as r|
|51019|New|Enh|2011-04-04|[PATCH] Implementation of Asynchronous processing |
|51020|Opn|Nor|2011-04-04|[PATCH] Apache/mod_fcgid.so does not start in comp|
|51022|New|Nor|2011-04-05|Segmentation fault on PUT request                 |
|51030|New|Enh|2011-04-06|Way to terminate CGI immediatly after closing conn|
|51078|Inf|Nor|2011-04-18|[PATCH] mod_fcgid spawned CGI Processes gets orpha|
|51079|New|Enh|2011-04-18|[PATCH] mod_fcgid spawned CGI Process cannot imper|
|51080|New|Nor|2011-04-18|[PATCH] mod_isapi does not support Except:100-Cont|
|51103|Opn|Nor|2011-04-21|mod_reqtimeout does not drop connection and return|
|51104|Opn|Maj|2011-04-21|C++ support about httpd_config.h                  |
|51107|New|Min|2011-04-22|SetOutputFilter and SetInputFilter should allow "n|
|51118|New|Nor|2011-04-26|LDAP cache is cleared after graceful/restart and o|
|51127|New|Nor|2011-04-27|Make ProxyPassReverseCookiePath work as expected  |
|51168|New|Nor|2011-05-08|mod_status Total Traffic won't take account of int|
|51170|New|Nor|2011-05-09|I/O errors when using keep-alive + mod_ssl        |
|51174|New|Min|2011-05-09|SSLRequire predicates using OIDs unknown to openss|
|51186|New|Blk|2011-05-11|NEw Openssl 1.0.1 with new FIPS                   |
|51190|New|Min|2011-05-12|::/0 does not work with allow from and deny from  |
|51194|New|Nor|2011-05-13|FcgidWrapper does not support paths containing a s|
|51201|Inf|Nor|2011-05-15|Strange behavior REQUEST_METHOD & GET in mod_rewri|
|51223|New|Nor|2011-05-18|304 HTTP Not Modified strips out CORS headers     |
|51224|New|Nor|2011-05-18|mod_dav_fs should respect FileETag                |
|51239|New|Nor|2011-05-21|ap_get_client_block may block continuously sometim|
|51257|New|Nor|2011-05-24|Build failed when cross-compiling: ./gen_test_char|
|51258|Opn|Enh|2011-05-24|new features for mod_substitute                   |
|51296|New|Enh|2011-05-31|Dynamic engine support using SSLCryptoDevice suppo|
|51297|New|Nor|2011-05-31|Improve error handling during "UNLOCK"            |
|51303|New|Nor|2011-05-31|TraceEnable 500 error                             |
|51312|New|Nor|2011-06-01|mod_filter should support adding to the Vary heade|
|51322|New|Enh|2011-06-04|Prepend and append string to LDAP search parameter|
|51359|Inf|Enh|2011-06-11|Added shebang check for //! so that .js scripts wo|
|51365|New|Nor|2011-06-13|Mod_proxy mangles query string with mod_security  |
|51402|New|Nor|2011-06-21|"ForceLanguagePriority Fallback" not working as im|
|51406|New|Maj|2011-06-21|When listing files in subdirectories, the path is |
|51409|New|Nor|2011-06-21|Sorting options accepted by ls, but ignored       |
|51471|New|Nor|2011-07-04|<DirectoryMatch>ed IndexIgnore doesn't            |
|51479|New|Enh|2011-07-05|[PATCH] AB feature to optionally read in a reusabl|
|51491|New|Nor|2011-07-08|mod_dir breaks POSTs to URLs not ending in /      |
|51495|New|Nor|2011-07-11|mod_substitute cpu and memory limit               |
|51517|New|Maj|2011-07-16|mod_proxy_fcgi is not RFC 3875 compliant (SCRIPT_F|
|51522|Ver|Trv|2011-07-18|Wrong French translation in mpm.html ("Certains Mo|
|51542|New|Nor|2011-07-22|Apache HTTP Server vs PVS-Studio                  |
|51543|New|Nor|2011-07-22|Space in username not properly escaped in log file|
|51552|Inf|Cri|2011-07-25|Apache is not starting (2.2.15)                   |
|51573|New|Enh|2011-07-28|Easy way to erase log files                       |
|51576|Inf|Nor|2011-07-28|mod_rewrite rule stopped working                  |
|51600|New|Enh|2011-08-02|Loading the same certificate in multiple virtual h|
|51603|Inf|Maj|2011-08-02|Apache accepts completely bogus HTTP requests (pos|
|51607|Inf|Nor|2011-08-03|DBDPrepareSQL ( ap_dbd_prepare ) does not work cor|
|51629|New|Nor|2011-08-05|DocumentRoot check incorrect when running under ch|
|51674|New|Blk|2011-08-18|AJP Module Bad Request                            |
|51679|New|Min|2011-08-18|Code signature key expired                        |
|51689|New|Trv|2011-08-19|Cross compiling causes multiple Listen directives |
|51695|New|Trv|2011-08-20|Code clean up (ap_rputs merge)                    |
|51707|New|Nor|2011-08-22|ProxyPassReverse issues within <Location> (differe|
|51709|New|Nor|2011-08-23|ServerName/ServerAlias don't work if Host: header |
|51711|New|Nor|2011-08-23|mod_auth_digest have broken shared mem (nonce) cod|
|51718|New|Enh|2011-08-24|Feature Request: Add shorthand to redirect any Ser|
|51725|New|Nor|2011-08-26|Multiple Range: request accepted as "Range: n-m"  |
|51732|New|Nor|2011-08-29|Inconsistencies in log messages' verbosity levels |
|51747|New|Blk|2011-08-31|mod_fcgid loads entire request into memory while p|
|51757|Inf|Enh|2011-09-02|Add support for SASL auth in LDAP                 |
|51778|Inf|Cri|2011-09-07|while buliding(make) a unix source "httpd-2.2.20.t|
|51797|Inf|Maj|2011-09-10|Crash HTTPD(Windows)                              |
|51814|New|Enh|2011-09-14|mod_proxy in Apache HTTP 2.2 FIN_WAIT2 in server s|
|51858|Inf|Nor|2011-09-21|weird error for mod_rewrite with more then 3 param|
|51864|New|Nor|2011-09-22|mod_cache returns entire entity from origin server|
|51904|New|Nor|2011-09-28|output to stderr from cgi script causes script to |
|51951|New|Nor|2011-10-04|mod_mbox hang on some e-mails on press@a.o - was I|
|51964|Ver|Nor|2011-10-05|Documentation of RewriteRule flag skip unclear    |
|51965|New|Nor|2011-10-05|--with-z=DIR not being honored                    |
|51982|Opn|Nor|2011-10-06|ProxyPassReverse / balancer://cluster/ adds slash |
|51987|Inf|Nor|2011-10-07|RewriteRule doesn't work correctly with apache 2.3|
|51994|New|Enh|2011-10-07|Mod_authn_socache should have some way to flush th|
|52004|Ver|Trv|2011-10-10|Typo "indexe" in French translation of mpm.html   |
|52007|New|Nor|2011-10-10|Content-Length: 0 not set on proxy response       |
|52038|New|Nor|2011-10-16|NameWidth works incorrectly together with Charset=|
|52039|Inf|Nor|2011-10-16|Browser mode does not always work                 |
|52043|New|Nor|2011-10-17|Directories ".", "..", and "/" do not work correct|
|52081|New|Nor|2011-10-24|segfault if mbox files have unexpected names      |
|52090|New|Maj|2011-10-26|Apache thread hangs with error 500 when sending a |
|52120|Opn|Nor|2011-11-01|mod_cache edge case: uncacheable 304 sends cached |
|52123|New|Maj|2011-11-02|DoS: High memory usage in propfind                |
|52132|New|Nor|2011-11-03|[PATCH] process activity score calculated incorrec|
|52139|New|Nor|2011-11-05|Never Syntax Error on non-existent DocumentRoot   |
|52171|Ver|Nor|2011-11-13|confusing documentation of request phases         |
|52174|New|Enh|2011-11-13|Allow hard lower-limits on the number of fcgi serv|
|52178|New|Nor|2011-11-14|IPv6 IPs as ServerName not allowed                |
|52181|Ver|Nor|2011-11-14|mod_rewrite Technical Details Ruleset Processing d|
|52195|Inf|Nor|2011-11-16|Japanese texts are garbled on mailing list archive|
|52196|Inf|Nor|2011-11-16|winnt mpm, others mpm also have this bug. pool sha|
|52207|Inf|Maj|2011-11-18|Upgrade apache version from 2.0.59 to 2.2.12 or ab|
|52222|New|Nor|2011-11-21|IndexIgnore ignores parent directories in argument|
|52247|New|Nor|2011-11-26|mod_mbox gives up on unexpected message format    |
|52248|New|Nor|2011-11-26|Bugzilla version drop-down list does not offer "un|
|52252|New|Nor|2011-11-27|luajit support broken for (at least) luajit 2.0   |
|52253|Inf|Nor|2011-11-28|Timeout doesn't work. mod_proxy_balancer strongly |
|52264|New|Enh|2011-11-30|Update and complete balancer-manager XML output   |
|52269|Inf|Nor|2011-12-01|[mod_proxy] Apache reverse proxy status code trans|
|52275|New|Nor|2011-12-02|memory leak in proxy_ajp_handler                  |
|52298|Inf|Nor|2011-12-07|Can't enter website with client certificate on an |
|52301|New|Enh|2011-12-07|Error message "RSA server certificate ... CN ... d|
|52302|New|Enh|2011-12-07|Better documentation of how server name is determi|
|52304|New|Nor|2011-12-08|<Limit> Does Not Apply When URI Is Folder         |
|52313|New|Enh|2011-12-09|htdbm enhancement: options for colon-in-username, |
|52322|Inf|Enh|2011-12-13|Providing BBC developed httpd modules for inclusio|
|52342|New|Nor|2011-12-15|ap_internal_redirect dropping filters means incons|
|52370|New|Nor|2011-12-19|apreq_decode/url_decode length miscalculation     |
|52377|New|Enh|2011-12-20|Add Directives to assert user, group, and permissi|
|52383|New|Trv|2011-12-24|Instllation log typo                              |
|52391|New|Cri|2011-12-27|100% CPU usage while using Forward Proxy          |
|52395|New|Nor|2011-12-29|reload results in different end environment to res|
|52403|New|Nor|2011-12-31|FallbackResource doesn't work for non-existent PHP|
|52408|New|Nor|2012-01-01|Directoryindex matching automatically redirects   |
|52415|New|Nor|2012-01-03|LockFile placed inappropriately                   |
|52417|New|Nor|2012-01-03|HEADERS information in the file                   |
|52435|New|Nor|2012-01-06|Apache shutdown automatically                     |
|52439|New|Nor|2012-01-09|It should be possible to treat errors in .htaccess|
|52453|New|Enh|2012-01-11|Ability to configure --logfiledir                 |
|52465|New|Nor|2012-01-13|mod_dir is allowed to redirect proxy requests     |
|52481|New|Nor|2012-01-18|Rotatelog.exe crashes Apache after setting 256MB r|
|52485|New|Nor|2012-01-19|CPU load 100%                                     |
|52494|New|Enh|2012-01-22|allow the Action directive to point in the filesys|
|52495|New|Enh|2012-01-22|CACertificate, CADNCertificate, CARevocation, Cert|
|52501|New|Cri|2012-01-23|child pid 10824 exit signal Segmentation fault (11|
|52505|New|Nor|2012-01-23|Include with directory wildcards gives errors for |
|52509|New|Nor|2012-01-23|Resources protected by .htaccess file may not be a|
|52510|New|Cri|2012-01-23|Segmentation Fault 11                             |
|52520|New|Nor|2012-01-24|ProxyRemote & NoProxy directive can not take IPv6 |
|52532|New|Trv|2012-01-26|VirtualHost added TWICE to name-virtual-host list |
|52539|New|Nor|2012-01-26|Apache mod_dav 400 Bad Request for non-existent co|
|52546|New|Nor|2012-01-27|overwrite SERVER_PROTOCOL environment             |
|52573|New|Nor|2012-02-01|mod_speling case correction fails when URI has dou|
|52578|Opn|Enh|2012-02-02|Wrong "bytes sent" logged when connection is close|
|52594|New|Nor|2012-02-03|rpmbuild -ba errors out with "File not found by gl|
|52595|New|Nor|2012-02-03|requests with gzip+chunked encoded body don't prox|
|52605|Inf|Min|2012-02-05|Please allow request lines longer than 8k         |
|52612|New|Nor|2012-02-06|Default Service Account                           |
|52616|Opn|Enh|2012-02-07|SSLUserName uses SSL_CLIENT_S_DN insted of SSL_CLI|
|52617|New|Maj|2012-02-07|Visit the rewrite page from ServerAlias domain vho|
|52623|New|Nor|2012-02-08|does not build with pcre-8.30                     |
|52644|New|Nor|2012-02-12|document how SSL FakeBasicAuth works with strange |
|52668|New|Trv|2012-02-14|More future safe patch for old MSIE ssl-unclean-sh|
|52670|New|Trv|2012-02-15|please clarify the effect of SSLStrictSNIVHostChec|
|52683|New|Enh|2012-02-16|add a symlink option that rechecks the access perm|
|52700|Inf|Blk|2012-02-17|Not rendering html content instead displaying clie|
|52703|Inf|Maj|2012-02-18|SSL+SNI+client-auth "lost" after some time        |
|52710|New|Nor|2012-02-19|mod_fcgid should set PATH_INFO when configured in |
|52756|Inf|Trv|2012-02-24|proxy_html_module LoadModule line not created in h|
|52759|New|Cri|2012-02-24|Apache httpd child process consuming high CPU Util|
|52790|New|Nor|2012-02-28|ldap caching not sufficient                       |
|52795|Opn|Nor|2012-02-29|mod_fcgid fails to spawn process in C:\Program Fil|
|52806|New|Nor|2012-03-01|configure: --with-included-apr is not supported in|
|52807|New|Nor|2012-03-01|some random strings are accepted by "configure" as|
|52816|New|Nor|2012-03-03|Potential segfault in socache_shmcb_create        |
|52817|New|Nor|2012-03-03|Long directory path sucks (but it's really a valid|
|52822|New|Nor|2012-03-04|Quiet installation not fully quiet                |
|52824|Inf|Nor|2012-03-04|Conflicts between AllowOverride and AllowOverrideL|
|52828|New|Maj|2012-03-05|Child process is not replaced in Windows, after a |
|52832|New|Nor|2012-03-05|numerical configuration entry can be mistakenly in|
|52841|Opn|Nor|2012-03-06|[proxy_balancer:emerg] [pid 25593] AH01177: Failed|
|52851|New|Nor|2012-03-07|Core TimeOut directive doesn't work               |
|52860|New|Enh|2012-03-08|Support Transfer-Encoding: gzip                   |
|52865|New|Nor|2012-03-09|Crash by segmentation fault in mod_authn_core in A|
|52870|New|Cri|2012-03-09|100% CPU usage while using Forward Proxy          |
|52874|New|Enh|2012-03-09|Support Use TrustedFirst checking when verifying c|
|52884|New|Nor|2012-03-12|"localhost" leads to start failure                |
|52890|Inf|Nor|2012-03-12|--with-included-apr doesn't work when srclib/apr a|
|52891|New|Nor|2012-03-12|2.2 doesn't perform as well as 1.3                |
|52894|Inf|Nor|2012-03-13|Apache aborts abnormally when ChrootDir is set    |
|52927|Inf|Nor|2012-03-16|[Bug in httpd 2.2.4] [error] (70014)End of file fo|
|52933|New|Nor|2012-03-17|Child survives '-k stop', consuming lots of CPU   |
|52950|New|Nor|2012-03-20|Error when set AuthType to None with valid-user   |
|52963|New|Nor|2012-03-21|Typo in AuthLDAPURL RFC 2255 error message        |
|52975|New|Nor|2012-03-23|Receiving files is suboptimal                     |
|52976|New|Min|2012-03-23|Gratuitous string-duplication in module-configurat|
|52978|New|Enh|2012-03-23|Binding to an interface instead of an address     |
|52995|New|Nor|2012-03-28|httpd -V does not print the default Mutex         |
|53002|New|Nor|2012-03-29|<Location> and auth_form (trailing slash problem?)|
|53015|New|Nor|2012-03-31|missing apr_socket_close                          |
|53016|New|Nor|2012-03-31|missing apr_brigade_destroy                       |
|53023|New|Nor|2012-04-02|mod_rewrite RewriteCond parser error and documenta|
|53037|New|Enh|2012-04-05|clarify mod_ssl documentation on the UID/GID conte|
|53059|New|Nor|2012-04-10|Make httpd easier relocatable by using a variable |
|53098|New|Nor|2012-04-18|mod_proxy_ajp: patch to set worker secret passed t|
|53099|New|Enh|2012-04-18|feature request for mod_remoteip                  |
|53108|New|Enh|2012-04-19|clarification on url-path vs full filesystem path |
|53111|New|Nor|2012-04-20|1% of CMS sites expose database passwords         |
|53121|New|Nor|2012-04-22|Confusing documentation, gzip and deflate         |
|53149|New|Enh|2012-04-25|mod_ldap should/could use mod_socache             |
|53152|Opn|Nor|2012-04-26|RewriteRule documentation: Error about per-directo|
|53156|New|Enh|2012-04-27|CRL validation fails if CRL is missing            |
|53160|New|Cri|2012-04-29|Reverse Proxy mod_deflate doesn't zip back content|
|53183|New|Min|2012-05-03|mod_apreq2 entry point is apreq_module and not apr|
|53193|New|Nor|2012-05-04|SLVerifyClient optional_no_ca + SSLSessionCache = |
|53218|New|Blk|2012-05-11|ProxyPass worker name　(http://localhost:3128/...|
|53233|New|Maj|2012-05-15|Internal error: proxy: error reading status line f|
|53239|New|Maj|2012-05-16|Httpd has problems delivering data on rate-limited|
|53253|New|Maj|2012-05-17|TCP_NOPUSH used with sendfile(2), cause transfers |
|53284|New|Nor|2012-05-24|crash                                             |
|53290|New|Maj|2012-05-24|memory usage                                      |
|53292|New|Min|2012-05-25|add support for HTTP status code 308              |
|53305|New|Nor|2012-05-28|404 errors when adding query string in a balancer |
|53313|New|Nor|2012-05-28|SSI #echo VAR fails (#include OK) if URI/URL has f|
|53319|New|Nor|2012-05-29|Multiple DirectoryIndex statements in the same con|
|53332|New|Nor|2012-05-30|Requests with chunked encoding have no body availa|
|53350|New|Nor|2012-06-01|mod_cache caching 403 responses Apahce 2.2.22     |
|53351|New|Nor|2012-06-02|make fails if layout begins on first line of confi|
|53388|Opn|Nor|2012-06-08|mod_proxy_balanser generates 503 when proxying to |
|53402|New|Trv|2012-06-12|Incorrect error message for mod_ldap params       |
|53461|Inf|Cri|2012-06-23|Compilation problems                              |
|53462|New|Nor|2012-06-25|mod_rewrite does not remove trailing slash when as|
|53479|New|Nor|2012-06-27|mod_rewrite [B] flag should percent-encode the spa|
|53483|New|Enh|2012-06-29|dangerous PCRE patterns in *Match directives      |
|53539|New|Maj|2012-07-12|content type and character set are changing when t|
|53554|New|Nor|2012-07-16|Wrong case for hexadecimal percent encoding [patch|
|53555|New|Maj|2012-07-17|Scoreboard full error with event/ssl              |
|53579|New|Cri|2012-07-20|httpd looping writing on a pipe and unresponsive (|
|53581|New|Blk|2012-07-21|FollowSymlinks doesn't work with DirectoryMatch an|
|53594|New|Enh|2012-07-24|ipad as webserver                                 |
|53595|New|Nor|2012-07-24|Media type qs parameters for MultiViews sent in Co|
|53612|Inf|Nor|2012-07-27|Reverse Proxy causing 500 error SSL proxy 1.0.1c O|
|53618|New|Nor|2012-07-29|proxy_worker_shared fields not maintained in threa|
|53634|New|Nor|2012-08-01|mod_cache returning HTTP 200 for nonexistent resou|
|53638|New|Nor|2012-08-02|Problem with shortcuts to bugzilla in http://httpd|
|53640|Inf|Maj|2012-08-02|make: Fatal error: Command failed for target `htpa|
|53643|New|Cri|2012-08-02|apache segfaults with mod_authn_dbd when dbd_min i|
|53646|New|Nor|2012-08-02|Invalid uniformly distributed balancing of request|
|53651|New|Nor|2012-08-03|Worker failure doesn't have same behaviour as work|
|53667|New|Enh|2012-08-07|Add an equivalent option to "JkOptions ForwardLoca|
|53669|New|Nor|2012-08-07|IndexOptions Incremental IndexOptions documentatio|
|53686|New|Enh|2012-08-09|Status "501 Not Implemented" sent very late       |
|53690|New|Nor|2012-08-09|Calls to semctl() trigger "uninitialized memory" w|
|53692|New|Nor|2012-08-10|mod_auth_form loses request body before login page|
|53693|Opn|Nor|2012-08-10|mod_fcgid performance suffers under increase in re|
|53704|New|Enh|2012-08-13|True online configuration is needed - via LDAP?   |
|53705|New|Nor|2012-08-13|Align server-status balancer display to balancer-m|
|53706|New|Enh|2012-08-13|Include a status display for mod_ldap when present|
|53722|New|Nor|2012-08-15|when -D NO_DETACH is used, no PID file should be c|
|53736|New|Nor|2012-08-17|/balancer-manager doesn't save runtime adjusted se|
|53757|New|Enh|2012-08-21|RewriteMap of type txt should allow specifying col|
|53767|New|Nor|2012-08-23|htcacheclean deletes stale "vary" header files eve|
|53772|New|Nor|2012-08-24|REDIRECT_URL not accessible in mod_proxy          |
|53787|New|Reg|2012-08-28|In forward proxy, doesn't cache disk anymore      |
|53823|New|Nor|2012-09-03|[patch] pure IPv6 only host fix (server/config.c) |
|53835|New|Cri|2012-09-06|mod_proxy_ajp truncate output when using deflate i|
|53870|New|Maj|2012-09-13|Deadlock in CRYPTO_add_lock with Apache 2.2.22 wor|
|53886|New|Nor|2012-09-18|can't start apache control in Redhat Linux 3 X64  |
|53899|New|Nor|2012-09-19|SSL_OP_ALL disables the mitigation code for CVE-20|
|53915|New|Nor|2012-09-21|Colon lost when :port is used in CacheKeyBaseURL  |
|53919|Inf|Enh|2012-09-21|DEFAULT_LOG_FORMAT is not RFC6302 compliant       |
|53923|New|Min|2012-09-23|Overriding CustomLog directive seems impossible   |
|53932|New|Nor|2012-09-25|PROPFIND doesn't support If, If-Match ETag predica|
|53947|New|Enh|2012-09-29|Feature Request, RewriteRule - ProxyPreserveHost f|
|53961|New|Nor|2012-10-04|Null sessions to the default vhost                |
|53970|New|Nor|2012-10-05|Network control directives affects internal subreq|
|53981|New|Nor|2012-10-08|move def of log_request_state from mod_log_config.|
|53988|New|Enh|2012-10-10|Missing FCGIWrapper script should not be a critica|
|53999|Opn|Nor|2012-10-13|Deadlock between procmgr_send_spawn_cmd()/proctabl|
|54030|New|Enh|2012-10-19|Support subjectAltName when (reverse-)proxying    |
|54033|New|Enh|2012-10-21|Parent languages are not ordered according to Acce|
|54072|New|Reg|2012-10-30|Syntax error front-end virtual-path too long      |
|54102|New|Enh|2012-11-05|new feature: automatic route detection            |
|54118|New|Nor|2012-11-08|Handle leak on parent httpd process when rotatelog|
|54126|New|Maj|2012-11-09|Mod_rewrite failing because of url in query string|
|54134|New|Enh|2012-11-11|new feature: ability to use multiple routes in sti|
|54136|New|Min|2012-11-11|balancer-handler shows xml not, when only xml para|
|54158|New|Nor|2012-11-16|Suggestion regarding 2.0 to 2.2 Upgrade Documentat|
|54183|Inf|Nor|2012-11-21|PROPFIND doesn't report getcontenttype property   |
|54215|New|Maj|2012-11-27|configure fails for httpd 2.2.3 with openssl 1.0.1|
|54221|Opn|Nor|2012-11-28|no ErrorLog prefix on CGI errors                  |
|54222|New|Min|2012-11-28|ServerTokens checking is not complete             |
|54223|New|Nor|2012-11-29|AH00554 error when runtime configuration Includes |
|54252|New|Nor|2012-12-05|acinclude.m4 requires -lz when linking with ssl st|
|54253|New|Nor|2012-12-05|mod_proxy_ftp doesn't handle/log partial or cancel|
|54255|New|Nor|2012-12-06|mod_deflate adjusts the headers "too late", should|
|54269|New|Maj|2012-12-09|mod_proxy_html documentation misses several things|
|54276|New|Nor|2012-12-10|rotatelogs not getting killed on graceful restart |
|54280|New|Nor|2012-12-11|mod_auth_form inline login not working with traili|
|54281|New|Nor|2012-12-11|Stick use Partial parameters from query string    |
|54289|New|Nor|2012-12-13|"ap_get_brigade" api is failing in "AP_MODE_SPECUL|
|54306|New|Enh|2012-12-15|add regexp versions of ProxyPassReverse, ProxyPass|
|54309|New|Trv|2012-12-15|clarification on the <Location> directive when use|
|54310|Opn|Nor|2012-12-15|mod_proxy_html drops meta elements with http-equiv|
|54319|New|Reg|2012-12-17|ProxyPass has no effect in <Location> if rewrite o|
|54339|New|Nor|2012-12-21|piped log entries > PIPE_BUF can be interleaved   |
|54342|New|Nor|2012-12-22|AuthnCacheSOCache can't pass args to socache provi|
|54343|New|Maj|2012-12-22|Add sanity checks for malloc() in mpm_winnt.c and |
|54358|New|Nor|2012-12-29|Status 500 when using ldap on Solaris because apr_|
|54363|New|Nor|2012-12-31|make time conversion caching functions thread-safe|
|54364|New|Nor|2012-12-31|Add ref to mod_fcgid docs                         |
|54365|New|Nor|2013-01-02|Connection closed by server during file transfer  |
|54366|New|Nor|2013-01-02|$sysconfdir/extra/httpd-dav.conf is not built base|
|54367|Opn|Maj|2013-01-02|Location header in response to PUT is not %-escape|
|54385|New|Enh|2013-01-08|SSL configuration independent from virtual hosts, |
|54401|New|Nor|2013-01-10|Suggest to make ProxyPassReverseCookieDomain accep|
|54415|New|Enh|2013-01-14|Please tell the root cause of mutex and scoreboard|
|54431|Inf|Blk|2013-01-16|Unable to start the Apache 2.4.3 windows service. |
|54498|New|Nor|2013-01-28|apache crash on any cgi request with certain http |
|54502|New|Nor|2013-01-29|Apache deadlock on epoll_ctl error (1000 process l|
|54512|Inf|Cri|2013-01-31|Apache hung                                       |
|54517|New|Nor|2013-02-01|proxy balancer: timeout or partial failure of back|
|54518|New|Nor|2013-02-01|mod_rewrite not adding Vary header                |
|54519|New|Nor|2013-02-02|httpd already running                             |
|54526|New|Nor|2013-02-05|mod_proxy_http ignores request abortion           |
|54543|New|Enh|2013-02-10|Compile regex only when need                      |
|54546|New|Nor|2013-02-11|httpd crashes on first HUP after change Listen dir|
|54549|New|Nor|2013-02-11|mod_mime AddEncoding and mod_negotiation fix_encod|
|54556|New|Enh|2013-02-13|New flag to add default rule in rule chain        |
|54560|New|Nor|2013-02-13|Potential segfault on return from ap_server_root_r|
|54563|New|Maj|2013-02-15|mod_webdav ignores quota                          |
|54578|New|Nor|2013-02-18|Bad docs or unchecked code for "LimitRequestFields|
|54605|New|Enh|2013-02-24|mod_negotiation should cache the info it generates|
|54608|New|Enh|2013-02-25|Support an option to allow page caching when using|
|54622|New|Nor|2013-02-28|shared memory cleanup                             |
|54626|New|Nor|2013-03-01|mod_authnz_ldap through util_ldap.c does not suppo|
|54633|New|Nor|2013-03-04|Invalid % encoding not rejected                   |
|54637|New|Nor|2013-03-05|Digest: secret not used                           |
|54640|New|Nor|2013-03-05|Slow transaction on a balance member is holding su|
|54649|New|Nor|2013-03-06|Incorrect PIDFILE prevent httpd restart           |
|54653|New|Min|2013-03-08|Suggestion to add https example for forward proxy |
|54656|New|Maj|2013-03-09|SNI and SSLProxyCheckPeerCN based on "connection" |
|54657|New|Nor|2013-03-09|DNS lookup failure for load balancer member does n|
|54683|New|Min|2013-03-13|Ignor directive ErrorDocument with null byte      |
|54699|Opn|Enh|2013-03-15|[feature request] cli webaccess tester            |
|54701|New|Cri|2013-03-15|Apache 2.4.3 Migration Issue Not loading the pages|
|54704|New|Nor|2013-03-15|Web Services stalling on it's own                 |
|54719|New|Nor|2013-03-18|httpd should check for and eventually create pid f|
|54752|New|Nor|2013-03-25|mod_ssl should not use uninitialized memory as ran|
|54782|New|Nor|2013-04-02|Memory Corruption errors - mpm_worker mod_perl    |
|54785|New|Nor|2013-04-02|Random crash when httpd server is stopped         |
|54793|New|Nor|2013-04-03|Socket timeout handler can delete uploaded files P|
|54794|New|Reg|2013-04-03|mod_wsgi|fcgid and subversion >= 1.7 issues       |
|54795|New|Nor|2013-04-03|'apxs -g -n' should be self-referring             |
|54796|Inf|Enh|2013-04-03|CustomLog should be able to use syslog as ErrorLog|
|54804|New|Nor|2013-04-05|mod_fcgid sends a Continue 100 response automatica|
|54813|New|Nor|2013-04-08|documnt the Require args used by authz_dbm includi|
|54816|Inf|Nor|2013-04-08|AH00566: request failed: invalid characters in URI|
|54817|New|Nor|2013-04-09|if prefix and sysconfdir are the same then http.co|
|54820|Inf|Cri|2013-04-09|REwriterule stops working                         |
|54824|New|Nor|2013-04-10|Spec file is missing libuuid-devel requirement    |
|54830|New|Enh|2013-04-11|Make SSLPProxyMachineCertificateFile configurable |
|54848|New|Nor|2013-04-15|Client field too short for IPv6 addresses         |
|54856|Inf|Enh|2013-04-17|NSCreateObjectFileImageFromFile                   |
|54858|New|Nor|2013-04-17|ld duplicate                                      |
|54861|New|Blk|2013-04-18|The number of connections with mysql is more      |
|54869|Inf|Nor|2013-04-19|Non-breaking space characters cause httpd to choke|
|54875|New|Nor|2013-04-23|Conditional request predicated on another URL's ET|
|54878|New|Nor|2013-04-23|Multiple Listen directives prevent server to start|
|54905|Inf|Cri|2013-04-29|Apache2 loops in child Segfaults                  |
|54910|New|Enh|2013-04-30|Format %{Foobar}o cannot be used to log Date and S|
|54911|New|Enh|2013-04-30|Allow logging of fields set by a backend server in|
|54914|New|Nor|2013-04-30|mod_dir DirectoryIndex breaks WebDAV PROPFIND / DE|
|54915|New|Nor|2013-04-30|GET on a WebDAV-enabled collection, with Directory|
|54918|New|Enh|2013-05-02|Implement RFC 6797 HTTP Strict Transport Security |
|54919|Inf|Nor|2013-05-02|*** glibc detected *** /usr/sbin/httpd: double fre|
|54930|New|Nor|2013-05-06|Allow empty message in ErrorDocument directive    |
|54934|Inf|Cri|2013-05-07|Apache is crashing intermittently with a message "|
|54936|New|Nor|2013-05-08|Some potential bugs reported by static analysis to|
|54949|New|Nor|2013-05-10|[PATCH] mod_cache: fix uninitialized tmppath varia|
|54952|Inf|Cri|2013-05-10|[Fri May 10 17:39:01 2013] [error] proxy: CLUSTER:|
|54953|New|Nor|2013-05-11|<VirtualHost 0.0.0.0:80> matches IPv6             |
|54958|New|Nor|2013-05-13|mod_deflate + mod_mime with SSI gives mixed compre|
|54962|New|Maj|2013-05-14|Apache will set incorrect Content-Length header an|
|54965|New|Enh|2013-05-14|Allow ProxyPassMatch in Directory context         |
|54976|New|Nor|2013-05-15|ProxyPass parameter "acquire" and "ttl" ignored in|
|54986|New|Maj|2013-05-16|httpd hanging on large form submit in ap_run_handl|
|54989|New|Nor|2013-05-17|Apache Segfaults on OS X at random - how can I dia|
|54993|New|Nor|2013-05-20|Critical error: File descriptor in bad state: apr_|
|54998|Ver|Nor|2013-05-21|Apache 2.4 terminates all SSL connections using an|
|55000|New|Nor|2013-05-21|Memory usage per process doubles when Apache is co|
|55021|New|Enh|2013-05-28|Support arbitrary sql to authentication username/p|
|55022|Inf|Cri|2013-05-28|child pid 3123 exit signal Bus error (10) - Apache|
|55034|Inf|Maj|2013-05-31|Apache 2.4.4 won't open more that 32k VH file hand|
|55039|New|Enh|2013-05-31|"RequestHeader edit" can't access environment vari|
|55045|New|Nor|2013-06-01|calls to gets() in test_find.c and test_parser.c  |
|55068|New|Enh|2013-06-06|root permissions when writing to per vhosts errorl|
|55069|New|Min|2013-06-06|notice message in error_log even when LogLevel err|
|55070|Opn|Enh|2013-06-06|mod_fcgid stderr always goes to main error log    |
|55072|New|Nor|2013-06-07|ErrorLog doesn't work well when apache shutdown   |
|55093|New|Nor|2013-06-12|[PATCH] mod_fcgid 2.3.7 truncates large posts on R|
|55096|New|Nor|2013-06-12|Make not running on httpd configure Solaris       |
|55098|New|Nor|2013-06-13|does not listen to IP4 when both IP4 address and I|
|55106|New|Enh|2013-06-17|ProxyErrorOverride considers response codes >= 400|
|55117|New|Nor|2013-06-18|GracefullTimeout for worker threads               |
|55148|Inf|Nor|2013-06-26|Error during SSL Handshake with remote server     |
|55152|New|Nor|2013-06-28|graceful restart adjusts to new balancer members, |
|55156|New|Nor|2013-06-28|mod_cache not respecting s-maxage cache-control he|
|55178|New|Nor|2013-07-01|[PATCH] mod_authnz_ldap SASL authentication suppor|
|55192|New|Trv|2013-07-03|htaccess error messages missing request context   |
|55193|New|Min|2013-07-03|ErrorLogFormat is ignored by some modules         |
|55226|New|Enh|2013-07-09|Request for "domain cluster" feature for mod_proxy|
|55234|New|Maj|2013-07-10|Working of attribute "protocol" attribute "protoco|
|55276|Inf|Enh|2013-07-17|Add REST API for load balancer for dynamic registr|
|55278|New|Nor|2013-07-18|mod_session's cookie may be empty, is repeated twi|
|55284|New|Nor|2013-07-20|repeatable segv                                   |
|55286|New|Nor|2013-07-21|Floating point exception (8) in mod_auth_digest   |
|55293|New|Nor|2013-07-22|Incorrect default MIME type for .woff fonts       |
|55306|New|Nor|2013-07-25|Error when copying svn repository, which contains |
|55323|New|Nor|2013-07-29|Double unescaped uri in sub request handler       |
|55327|New|Nor|2013-07-30|Segmentation fault when stopping Apache 2.4.6 norm|
|55340|New|Maj|2013-08-01|Listen for valid, unconfigured IP address passes c|
|55344|New|Nor|2013-08-02|missing ap_hook_monitor on windows                |
|55346|New|Nor|2013-08-02|When on filled quota filesystem, mod_fcgid init in|
|55348|New|Nor|2013-08-02|%h is not changed in logging, only %a             |
|55351|New|Enh|2013-08-04|allow ProxyPassReverseCookieDomain to automaticall|
|55362|New|Nor|2013-08-05|Apache httpd sends "400 Bad Request" to client due|
|55379|New|Min|2013-08-07|htdigest -c doesn't behave as described anymore   |
|55394|New|Nor|2013-08-09|apache 2.4 randomy crashes with signal 6          |
|55401|New|Enh|2013-08-11|document that force-proxy-request-1.0 implies prox|
|55415|New|Maj|2013-08-14|Proxy loop caused by ProxyErrorOverride and ErrorD|
|55431|New|Nor|2013-08-16|mod_negotation does not force the mime type listed|
|55433|New|Nor|2013-08-16|mod_proxy ignores final status code for aborted re|
|55443|Inf|Maj|2013-08-17|never gives 300 multiple choices                  |
|55445|New|Maj|2013-08-18|mod_socache_memcache ignores expiry, creating eter|
|55447|New|Enh|2013-08-18|make type-maps usable again, by making them access|
|55448|New|Nor|2013-08-19|segfault in set_max_workers at event.c:3194 on SIG|
|55449|New|Maj|2013-08-19|AH01185: worker slotmem_create failed --> slotmem |
|55452|New|Maj|2013-08-19|Redirect                                          |
|55458|New|Enh|2013-08-20|allow to configure what mod_ssl responds when one |
|55460|New|Enh|2013-08-21|allow service names to be used in the Listen direc|
|55467|New|Nor|2013-08-21|Support for OpenSSL custom TLS extensions and supp|
|55523|New|Trv|2013-09-04|auth_groupfile error log on access even though suc|
|55535|Inf|Nor|2013-09-08|incorrect check state parametr                    |
|55540|New|Cri|2013-09-09|mod_proxy gzip chunked issue (sample site provided|
|55549|New|Min|2013-09-11|AuthLDAPSubGroupAttribute doesn't do anything     |
|55550|New|Nor|2013-09-11|AuthLDAPSubGroupClass checking is very inefficient|
|55556|New|Nor|2013-09-13|apachebench (ab) doesn't use so_reuseaddr         |
|55557|New|Nor|2013-09-14|Some cppcheck reports                             |
|55573|New|Enh|2013-09-19|FileETag needs MTimeSeconds, MTime with granularit|
|55581|New|Enh|2013-09-22|Support concurrent connections to same FastCGI pro|
|55590|Inf|Maj|2013-09-24|second commit is failing if space is in file name |
|55596|New|Enh|2013-09-25|Add date format used by Expires header            |
|55607|New|Enh|2013-09-28|Re-set HOME environment variable to directory from|
|55615|New|Nor|2013-09-30|Connections are starved and not balanced when conc|
|55619|New|Nor|2013-10-02|Apache httpd reported 500 internal error when uplo|
|55627|New|Min|2013-10-04|Remove unnecessary APLOGNO() for trace logging per|
|55636|Inf|Cri|2013-10-07|long lost child came home - Apache is not respondi|
|55646|Inf|Nor|2013-10-10|non-2xx responses are not considered errors       |
|55654|New|Nor|2013-10-15|Extract variables from configuration without start|
|55670|New|Min|2013-10-18|Startup may fail silently at post_config          |
|55673|New|Nor|2013-10-18|httpd fails to start with SSLProxyMachineCertifica|
|55680|New|Enh|2013-10-20|online manual directory option doesn't exist      |
|55698|New|Maj|2013-10-24|Apache 2.2 + mod_fcgid 2.3.7 (CentOS 6.4) graceful|
|55700|New|Enh|2013-10-24|add something like RewriteOptions InheritDown     |
|55707|New|Nor|2013-10-25|SSLProtocol directive seem to be ignored over diff|
|55708|New|Nor|2013-10-25|Access violation in msvcrt.dll when calling getenv|
|55711|New|Min|2013-10-28|--enable-foo doesn't enable foo                   |
|55712|New|Nor|2013-10-28|Relative <!--#include virtual="../file.shtml"--> g|
|55720|New|Enh|2013-10-29|separate LDAP Bind timeout from LDAPTimeout       |
|55738|New|Nor|2013-11-03|PVS-Studio: few issues                            |
|55763|New|Nor|2013-11-09|raise roots soft RLIMIT_NPROC on linux for high ma|
|55774|New|Nor|2013-11-13|ab: optionally accept tls client certificate      |
|55781|New|Nor|2013-11-15|ajp_read_header: ajp_ilink_receive failed; 120006)|
|55786|New|Maj|2013-11-16|SSLVerifyClient and OptRenegotiate result in a 403|
|55787|New|Maj|2013-11-16|Chroot fails with "Cannot chroot when not started |
|55790|New|Maj|2013-11-17|mod_fcgid lockfile hardcoded to be in /tmp        |
|55793|New|Enh|2013-11-18|DTrace/SystemTap support                          |
|55808|New|Nor|2013-11-21|File integrity verification using MD5 and SHA1    |
|55819|Inf|Nor|2013-11-27|Closing connection behaviour                      |
|55828|New|Cri|2013-11-28|Httpd not start if use ProxyPass balancer://      |
|55834|New|Maj|2013-12-02|Apache does not honor the openssl library path giv|
|55838|New|Nor|2013-12-03|PHP files are being executed instead of downloaded|
|55841|New|Nor|2013-12-04|Misleading news items on bugfix releases ("This ve|
|55856|New|Nor|2013-12-08|YYEMPTY (-2) used as index into yytname (const arr|
|55866|New|Nor|2013-12-11|When ProxyPreserveHost is on, SSL expects the wron|
|55878|New|Nor|2013-12-12|mod_fcgid kills spawned processes too early       |
|55881|New|Nor|2013-12-13|segmentation fault at proxy_util.c:1546           |
|55883|New|Enh|2013-12-14|string callers of ap_expr should be able to transf|
|55887|New|Maj|2013-12-16|In Windows apache, when user access to /con, apach|
|55898|New|Enh|2013-12-17|[RFE] listen on unix socket?                      |
|55914|New|Reg|2013-12-20|child exit segmentation fault after apache gracefu|
|55919|New|Nor|2013-12-22|EPREFIX and dynamic modules                       |
|55942|New|Nor|2014-01-01|400 - Bad Request on POST (Windows Server 2012 Hyp|
|55952|New|Nor|2014-01-05|ab: SSL keep-alive fails with apr_pollset_poll: Th|
|55962|New|Enh|2014-01-06|mod_remoteip should not allow an external proxy to|
|55963|New|Nor|2014-01-07|Add application/ld+json to mime.types             |
|55981|Opn|Nor|2014-01-09|mod_mbox hang on some e-mails on user@openoffice.a|
|55985|Opn|Nor|2014-01-10|apache does not reopen logs when multiple graceful|
|55989|Opn|Enh|2014-01-11|write to error log upon RewriteRule [F]orbidden   |
|55991|New|Nor|2014-01-12|mod_charset_lite doesn't bail out on non-identity |
|56009|Inf|Cri|2014-01-14|Memory leak in httpd 2.4.3 over time with persista|
|56014|New|Nor|2014-01-15|MOd rewrite CO Cookie method the lifetime flag not|
|56028|New|Enh|2014-01-17|Add http/1.0, http/1.1 NPN advertisement to enable|
|56034|New|Nor|2014-01-20|CPU consumption due to circular linked list in ap_|
|56040|New|Enh|2014-01-21|should be able to remove Max-Age cookie parameter |
|56041|New|Enh|2014-01-21|should be able to disable session expiry increment|
|56052|New|Nor|2014-01-22|ap_session_load called multiple times for expired |
|56055|New|Nor|2014-01-23|Route is not extracted properly when a session coo|
|56064|New|Enh|2014-01-25|Optimize PNGs                                     |
|56067|New|Nor|2014-01-27|FallbackResource doesn't work if directory exists |
|56081|New|Maj|2014-01-28|Apache 2.2.26 SIGSEGVs when POST'ing data         |
|56091|Inf|Nor|2014-01-30|SSL handshake error when httpd compiled on Oracle |
|56098|New|Nor|2014-02-01|duplicate cookie                                  |
|56101|New|Cri|2014-02-03|Apache 2.4.6 ceases processing requests (scoreboar|
|56102|New|Nor|2014-02-03|SSL_CLIENT_S_DN_x509_0 is undefined in the environ|
|56109|New|Nor|2014-02-05|Cannot increase the read limit                    |
|56113|New|Nor|2014-02-06|dist commit messages missing from mail-archives di|
|56131|New|Nor|2014-02-12|ProxyPassReverse / zealously replaces Location hea|
|56135|New|Nor|2014-02-13|Add DC to list of x509 components                 |
|56152|New|Nor|2014-02-18|ProxyBlock does not accept network addresses      |
|56176|New|Nor|2014-02-21|mod_substitute truncates the response body if the |
|56188|New|Nor|2014-02-25|mod_proxy_fcgi does not send FCGI_ABORT_REQUEST on|
|56209|New|Nor|2014-03-03|Uninitialised variables in os/win32/ap_regkey.c   |
|56226|Ver|Nor|2014-03-06|per VirtualHost KeepAliveTimeout is not recognized|
|56229|New|Enh|2014-03-06|ocsp ProxyHost and ProxyPort support              |
|56230|New|Nor|2014-03-07|mod_access_compat can log a bogus client denied me|
|56235|New|Nor|2014-03-07|quotes should be optional around expr             |
|56247|New|Cri|2014-03-12|semaphore creation for proxypass                  |
|56250|New|Nor|2014-03-12|sbindir in config.layout for Apache has bin instea|
|56251|New|Nor|2014-03-12|Increase maximum length of FcgidInitialEnv string |
|56252|New|Enh|2014-03-12|make install as privileged user creates files not |
|56262|New|Nor|2014-03-14|ab does not work with extremely long cookies      |
|56264|New|Trv|2014-03-14|Confusing error with .htaccess rewrite to proxy wh|
|56270|New|Enh|2014-03-15|--with-ssl=/foo w/o pkgconfig needs help on AIX 64|
|56288|New|Enh|2014-03-19|rewrite URLs in style attributes                  |
|56289|New|Nor|2014-03-19|Buffer overflow in mod_proxy_html's string replace|
|56308|New|Nor|2014-03-24|1 second delay in handle request kills performance|
|56312|New|Nor|2014-03-25|Can't configure different balancing workers that c|
|56314|New|Nor|2014-03-25|exiting from MPM-worker child caused assert in apr|
|56326|New|Nor|2014-03-27|cache_quick_handler does not serve responses with |
|56331|New|Nor|2014-03-29|windows 'access denied' during revalidaton of reso|
|56333|New|Enh|2014-03-31|API to resume a SUSPENDED connection              |
|56362|New|Maj|2014-04-08|ldaps only works with port 636. Non-standard port |
|56379|New|Nor|2014-04-09|Number of columns in the results returned from pgs|
|56395|New|Enh|2014-04-11|Allow SERVER_ADDR environment variable to be optio|
|56404|New|Nor|2014-04-12|endless loop  when connect to a website(https)  wh|
|56413|New|Blk|2014-04-15|can not restart httpd on centos 5.10 64bit        |
|56422|New|Nor|2014-04-17|authnz_ldap with other forms of authn can fail req|
|56457|New|Nor|2014-04-25|mod_proxy_html.c: 2 * cut'n'paste errors          |
|56473|New|Nor|2014-04-30|ETags don't change when headers do                |
|56475|New|Enh|2014-04-30|Allow TLS record size to be configured            |
|56483|New|Enh|2014-05-02|add disableKeepAlivePercentage similar to tomcat h|
|56493|New|Min|2014-05-06|mod_expires should not set expires in future for s|
|56495|New|Nor|2014-05-06|Application behind mod_proxy does not get SessionH|
|56500|Opn|Enh|2014-05-07|vhosts priority order with wildcard               |
|56504|New|Nor|2014-05-08|cannot build static support binaries              |
|56508|New|Nor|2014-05-09|Requiring SNI - SSLStrictSNIVHostCheck semantics  |
|56517|New|Enh|2014-05-12|Virtualhosts cannot inherit parent CustomLog      |
|56528|New|Enh|2014-05-15|"bad flags delimiter" - improve helpfulness       |
|56541|New|Nor|2014-05-18|Proxy 502's on large file post requests           |
|56559|New|Nor|2014-05-25|multiple unix sockets in one virtualhost fails    |
|56569|New|Nor|2014-05-27|Null CRC in gzip footer with mod_cgid and ErrorDoc|
|56587|New|Nor|2014-06-03|Many VirtualHost's with SSLEngine On              |
|56590|New|Enh|2014-06-04|(REST-) API for configuring balancer manager remot|
|56594|Inf|Nor|2014-06-05|mod_authn_dbd, mod_dbd and mod_ssl                |
|56598|New|Nor|2014-06-06|Content-Length header should be always interpreted|
|56621|New|Nor|2014-06-13|Rotatelogs.exe first start                        |
|56622|New|Nor|2014-06-13|mod_reqtimeout incorrectly applies timeouts to CON|
|56626|New|Nor|2014-06-15|Add info about rotatelogs to log rotation document|
|56633|New|Nor|2014-06-16|mod_auth_basic breaks mod_autoindex               |
|56645|New|Maj|2014-06-19|socket callback with timeout callback causes infin|
|56664|New|Nor|2014-06-24|Proxy retry timeout does not cope with system time|
|56697|New|Maj|2014-07-04|status page still shown while blocked             |
|56718|New|Nor|2014-07-14|Cleanup request Host headers when absolute URI are|
|56719|New|Nor|2014-07-14|parallel requests get served with delays          |
|56738|New|Enh|2014-07-17|Ability to extract route from cookie with regexp  |
|56740|New|Nor|2014-07-18|suspended_count not maintained properly with wstun|
|56750|New|Enh|2014-07-20|SuexecUserGroup replacement                       |
|56751|New|Maj|2014-07-20|Fails to properly mitigate Slow Post DoS attack   |
|56753|New|Nor|2014-07-21|mod_lua.so: symbol luaL_openlib: referenced symbol|
|56778|New|Nor|2014-07-28|while running make command i got this error       |
|56794|New|Nor|2014-07-31|Added AuthDBDFullAuthQuery option                 |
|56795|Inf|Nor|2014-07-31|Apache 2.4.10 Program received signal SIGPIPE, Bro|
|56818|Inf|Nor|2014-08-05|SetEnvIf may set invalid string length on empty st|
|56843|New|Enh|2014-08-12|Support different OCSP stapling max ages          |
|56868|New|Nor|2014-08-18|relative LuaRoot broken                           |
|56879|New|Nor|2014-08-22|Information disclosure                            |
|56889|New|Nor|2014-08-26|Close state never dies                            |
|56918|Opn|Blk|2014-09-06|error: 'ap_copy_scoreboard_worker' undeclared here|
|56926|New|Nor|2014-09-08|Filename causes AH02599 slotmem issue             |
|56933|New|Min|2014-09-09|not sure it's an appache bug : some browser want t|
|56942|New|Reg|2014-09-10|Unable to implement TRANSFER-CHUNKED:ENCODING with|
|56943|New|Nor|2014-09-10|mod_proxy_connect - AH02447: err/hup on backconn  |
|56977|New|Maj|2014-09-12|segfaults when using mod_mem_cache + mod_disk_cach|
|56986|New|Blk|2014-09-17|chunked Transfer-Encoding forbidden: /test/test.dl|
|57014|New|Cri|2014-09-24|Incorrect test for CC_FOR_BUILD prevents build (on|
|57023|New|Nor|2014-09-26|Socache shmcb don't cache file bigger than 11k    |
|57028|New|Enh|2014-09-27|mod_spdy - support Apache 2.4                     |
|57044|New|Nor|2014-09-29|[PatchAvailable] Use base64url in mod_unique_id ('|
|57045|New|Nor|2014-09-30|dumpio output strings are missing                 |
|57046|New|Enh|2014-09-30|Add additional parameter to enable check URL befor|
|57056|New|Maj|2014-10-03|Rewrite port is taken into hostname               |
|57067|New|Nor|2014-10-08|A proxy worker both standalone and balancer member|
|57069|New|Nor|2014-10-08|apache ssl timeout during chunked request in rever|
|57073|New|Cri|2014-10-09|Intermittent Connection Issues using default httpd|
|57085|New|Enh|2014-10-14|Implement Proxy Protocol in httpd                 |
|57087|New|Nor|2014-10-14|mod_proxy_fcgi doesn't send cgi CONTENT_LENGTH var|
|57100|Ver|Nor|2014-10-16|"SSLProtocol ALL" is ignored for virtual hosts    |
|57101|New|Enh|2014-10-16|[PATCH] Better error reporting when child spawn fa|
|57109|New|Nor|2014-10-17|GPG verification examples are wrong               |
|57119|Opn|Enh|2014-10-20|Suppress address reuse / DNS cache in mod_proxy   |
|57121|New|Nor|2014-10-21|ocsp stapling should not pass temporary server out|
|57131|New|Nor|2014-10-22|OCSP Stapling scalability concern                 |
|57159|New|Min|2014-10-28|mod_ssl OCSP Stapling directives don't support per|
|57160|New|Nor|2014-10-29|httxt2dbm doesn't generate files on NAS           |
|57174|New|Nor|2014-10-31|Update windows visual studio build                |
|57210|New|Nor|2014-11-14|LuaHookMapToStorage not firing in per-directory co|
|57211|New|Enh|2014-11-14|Config-time options                               |
|57212|Opn|Nor|2014-11-14|Headers returned by scripts are limited to 8190 by|
|57218|New|Nor|2014-11-15|[Feature Request] Apache Bench (AB) to output a cs|
|57219|New|Nor|2014-11-15|ApacheBench quits unexpectedly with high concurren|
|57220|New|Nor|2014-11-15|[Feature Request] Add option to ApacheBench to giv|
|57228|New|Nor|2014-11-17|glibc detected *** httpd: double free or corruptio|
|57229|New|Maj|2014-11-17|mod_sed dies on long lines                        |
|57286|New|Nor|2014-11-29|Symbolic links are not honoured                   |
|57298|New|Min|2014-12-02|RewriteBase inside FilesMatch behaves oddly       |
|57299|New|Enh|2014-12-02|mod_session_dbd should not make a database call pe|
|57300|New|Enh|2014-12-02|mod_session_dbd should not save the session at eac|
|57301|New|Enh|2014-12-02|Add SessionMaxAgeAbsolute Directive               |
|57304|Inf|Nor|2014-12-03|MySQL DBD Authentication Incompatible with SSL    |
|57311|New|Nor|2014-12-04|BalancerMember enclosed by <If> gives syntax error|
|57313|New|Nor|2014-12-05|The DefaultType directive has been removed        |
|57327|New|Nor|2014-12-08|mod_ssl seg fault on exit                         |
|57334|Ver|Maj|2014-12-09|Segmentation fault in SSL_renegotiate at ssl_lib.c|
|57337|New|Nor|2014-12-10|Content negotiation fails with conditional Redirec|
|57339|New|Enh|2014-12-10|ErrorLogFormat doesn't allow logging in Internet d|
|57360|New|Nor|2014-12-17|Fail gracefully on certificate/key mismatch       |
|57372|New|Nor|2014-12-19|httpd will lookup every home directory while start|
|57374|Ver|Nor|2014-12-19|Event MPM: Wrong KeepAliveTimeout when system cloc|
|57379|New|Nor|2014-12-20|[patch] Makefile.in  with mpm-shared, cgi and cgid|
|57383|New|Cri|2014-12-21|Error retrieving Report: An Existing connection wa|
|57386|New|Blk|2014-12-22|html5 lost some comments                          |
|57398|New|Maj|2014-12-26|AH01075: Error dispatching request to : (passing b|
|57399|New|Nor|2014-12-28|Many unnecessary CPU wakeups per second           |
|57406|New|Nor|2014-12-31|cgi-bin script is not executing                   |
|57412|New|Maj|2015-01-04|rewrite rules causes duplicate requests           |
|57416|New|Nor|2015-01-06|htcacheclean thinks the cache is smaller than it a|
|57424|Opn|Nor|2015-01-07|mod_rewrite not using ap_context_document_root    |
|57436|New|Enh|2015-01-12|Option to strip extra data after websocket request|
|57439|New|Enh|2015-01-13|Allow to change body timeout per location         |
|57448|New|Nor|2015-01-16|SSI <!--#set --> cannot capture backreferences fro|
|57453|New|Maj|2015-01-17|403 error when virtualhost configured with non-exi|
|57471|New|Nor|2015-01-20|Apache 2.4.10 Compilation fails when compiling aga|
|57477|New|Nor|2015-01-21|mod_auth_digest AH00052: child pid $pid exit signa|
|57483|New|Nor|2015-01-22|Omit "Keep-Alive" header on 1.1 connections       |
|57492|New|Nor|2015-01-24|incomplete chunked-transfered request body is not |
|57506|New|Nor|2015-01-27|<If> directive doesn't work within a <Location> se|
|57510|New|Enh|2015-01-28|Engine keyform support for private keys           |
|57511|New|Maj|2015-01-28|Opening plain TCP Socket on SSL port causes denial|
|57515|New|Nor|2015-01-30|Define/Undefine don't work reasonably outside of g|
|57519|New|Nor|2015-02-01|change SSLv2 to SSLv3 or remove SSLv2 support allt|
|57526|Opn|Maj|2015-02-03|Apache 2.2.29_openssl-1.0.1k_x86_64 Error creating|
|57529|Opn|Nor|2015-02-03|htcacheclean doesn't show the cached URL with '-a'|
|57585|New|Nor|2015-02-13|httpd fails to start if there is an IncludeOptiona|
|57590|New|Nor|2015-02-18|loading mod_proxy_http makes rewriteRule's [proxy]|
|57591|New|Nor|2015-02-18|DirectoryIndex directive cannot be overwritten    |
|57616|New|Maj|2015-02-23|AB - DNS roundrobin support                       |
|57624|New|Enh|2015-02-23|Provide support for http/2.0                      |
|57631|New|Nor|2015-02-24|Useless test in acinclude.m4                      |
|57632|New|Nor|2015-02-24|mod_systemd passes invalid default to APACHE_MODUL|
|57635|New|Nor|2015-02-25|meta-refresh is not rewritten by mod_proxy_html   |
|57636|New|Nor|2015-02-25|URLs without protocol are not rewriten by mod_prox|
|57641|New|Maj|2015-02-27|mod_substitute: Invalid merge order               |
|57646|New|Enh|2015-02-27|SSLEngine inside If directive                     |
|57660|New|Trv|2015-03-04|AB - free memory allocated by xmalloc and xcalloc |
|57680|New|Nor|2015-03-09|SSLSessionCacheTimeout has no effect              |
|57685|New|Nor|2015-03-10|Requests are denied while the mod_cgid daemon star|
|57691|New|Nor|2015-03-12|mod_proxy/proxy_util confuses UDS scheme with HTTP|
|57695|New|Nor|2015-03-12|[core:warn] [pid 1120] (101)Network is unreachable|
|57710|New|Nor|2015-03-15|Wildcard matching for logging headers             |
|57725|New|Enh|2015-03-18|ApacheBench: include http status code in gnuplot o|
|57742|New|Nor|2015-03-23|"reliable piped logging" doesn't work for ErrorLog|
|57745|New|Nor|2015-03-23|httpd exits 1 with no stderr when proxy_balancer_m|
|57746|New|Nor|2015-03-23|Apache hangs on startup using MPM event           |
|57751|Inf|Maj|2015-03-24|Problems with proxy reverse to websockets         |
|57756|New|Enh|2015-03-25|Config options for handling of pipelined request  |
|57757|New|Cri|2015-03-25|extern apr_xlate_t *ap_locale_to_ascii variable gi|
|57771|New|Nor|2015-03-27|cleanup_script uses incorrect connection ID       |
|57774|Inf|Nor|2015-03-28|httpd.conf <IfModule proxy_html_module> content er|
|57777|New|Nor|2015-03-30|Security concerns with documentation of AddHandler|
|57781|New|Nor|2015-03-31|disable reconnection after connection error       |
|57784|New|Enh|2015-03-31|[RFE] Multiple ErrorLog directives                |
|57785|Opn|Nor|2015-04-01|REDIRECT_URL is not suitable for use in server-gen|
|57795|Opn|Maj|2015-04-07|mod_proxy_wstunnel sometimes does not connect and |
|57800|New|Nor|2015-04-09|High CPU usage in ap_core_output_filter           |
|57807|New|Enh|2015-04-13|Build-configurable environment variable length    |
|57810|New|Nor|2015-04-13|Should apache ignore difference in trailing dot be|
|57813|New|Nor|2015-04-14|Rewrite 'pre-compressed content' recipe using 2.4 |
|57814|New|Nor|2015-04-14|Teach mod_deflate how to serve pre-comressed conte|
|57819|New|Nor|2015-04-15|Need a conventions document                       |
|57832|New|Enh|2015-04-19|Reduction of response splitting attacks consequenc|
|57853|Inf|Nor|2015-04-24|mod_proxy_http sends request with header 'Expect: |
|57876|New|Reg|2015-04-30|logresolve.exe on any Windows immediately crashes |
|57878|New|Nor|2015-04-30|Using UTF-8 for all languages, and avoiding html-e|
|57895|New|Min|2015-05-05|missing m4a mimeType in mime.types                |
|57911|New|Min|2015-05-09|Rewrite documentation unclear or wrong about what |
|57927|New|Maj|2015-05-13|Segmentation Fault at proxy_util.c:994            |
|57933|New|Min|2015-05-18|apr_port_t returns constant                       |
|57941|New|Nor|2015-05-21|config.status: line 331: syntax error near unexpec|
|57949|New|Enh|2015-05-25|new mod_ssl environment variable SSL_{CLIENT|SERVE|
|57950|New|Nor|2015-05-26|[patch] buildconf change hint in build to newer ap|
|57960|New|Nor|2015-05-27|PUT truncates response body; status_line appears t|
|57976|New|Cri|2015-05-30|Server threads stale when sending 500 status with |
|57978|New|Nor|2015-06-01|unix:/ works with any number of / slashes  except |
|57979|New|Nor|2015-06-01|can not turn change log level for mod_filter      |
|57996|New|Nor|2015-06-03|Symlinks erroneously not followed when target inod|
|57997|New|Nor|2015-06-03|Threads started during child_init don't block sign|
|57999|New|Nor|2015-06-04|ap_getparents() may remove start slash of uri     |
|58001|New|Enh|2015-06-04|Implement Forwarded header (RFC 7239) to mod_proxy|
|58007|New|Nor|2015-06-06|400 Bad Request with fully qualified domain name o|
|58025|New|Enh|2015-06-11|mod_authz_dbd : new dbd-query and AuthzDBDQuery op|
|58026|New|Nor|2015-06-11|return 421 status code when SNI and Host: header d|
|58044|New|Cri|2015-06-16|Error sintax 'lua_dump'                           |
|58050|New|Nor|2015-06-17|ErrorDocument does not always work                |
|58073|New|Nor|2015-06-24|Extremely long time for graceful restart          |
|58089|New|Nor|2015-07-01|mod_authz_host uses proxy IP even when mod_remotei|
|58097|New|Enh|2015-07-03|[feat] Preserve original connecting IP            |
|58101|New|Nor|2015-07-05|DeflateCompressionLevel inside vhost resets logfor|
|58107|New|Blk|2015-07-06|Httpd crashes on startup every time, dump file att|
|58109|New|Nor|2015-07-06|Apache on windows cannot handle the hash symbol (#|
|58118|Inf|Min|2015-07-09|mod_proxy_fcgi logs 503 when user aborts connectio|
|58120|New|Nor|2015-07-10|ProxyPassInherit does not work as expect          |
|58121|New|Nor|2015-07-10|ProxyHTMLMeta seems to ignore all <meta http-equiv|
|58129|New|Nor|2015-07-12|man pages are not generated correctly             |
|58132|New|Nor|2015-07-12|non-standard, non-traditional man page layout make|
|58135|New|Nor|2015-07-14|mod_cache sends client "if-Modified-Since" to back|
|58141|New|Nor|2015-07-15|Apache Service doesn't start when rotatlogs.exe pa|
|58142|New|Nor|2015-07-15|authz_core ignores loglevel                       |
|58158|New|Nor|2015-07-21|Not honoring HTTP spec with regard to Accept-Encod|
|58168|New|Enh|2015-07-21|Would like full request evaluation support in Rewr|
|58171|New|Nor|2015-07-22|ap_session_save saves the wrong session after a de|
|58177|New|Enh|2015-07-24|Mod Proxy forward trailers in http chunked request|
|58180|New|Enh|2015-07-24|ErrorDocument original URL in subsequent <Location|
|58181|New|Enh|2015-07-25|mod_expire should allow "minus" keyword same like |
|58188|New|Nor|2015-07-28|http2 mod_lua: support build with lua 5.2+        |
|58197|New|Nor|2015-07-31|apr-util-1.5.4 build against openldap - "could not|
|58225|New|Reg|2015-08-08|intermitant segfault 11 in session_identity_encode|
|58226|New|Nor|2015-08-08|XSS in Error Page                                 |
|58231|New|Nor|2015-08-11|RewriteCond can add "Host" to the Vary-Header     |
|58235|New|Enh|2015-08-12|Ability to allow from domain but with using forwar|
|58243|New|Nor|2015-08-14|rotatelogs goes infinite at startup               |
|58248|New|Nor|2015-08-17|Error 404 in use some characters of utf8 in url   |
|58257|New|Nor|2015-08-18|require ldap-group does not work if account-fullna|
|58278|Inf|Blk|2015-08-24|apache - mod_security Issue : apache no releasing |
|58280|New|Nor|2015-08-24|Backend connection not closed until timeout if cli|
|58288|New|Blk|2015-08-27|Semaphore amount increase until crash when enablin|
|58292|New|Nor|2015-08-27|FallbackResource breaks chunked encoding sometimes|
|58304|New|Nor|2015-08-30|Unexpected Warnings from Macro Use in 2.4         |
|58305|New|Nor|2015-08-30|mod_cgi documentation not clear about what is pass|
|58306|New|Nor|2015-08-30|documentation needs to make it clear which directi|
|58307|New|Nor|2015-08-31|Segmentation fault in child in "read(__nbytes, __b|
|58317|New|Min|2015-09-02|Error message AH01630 is missing file name on deny|
|58334|New|Min|2015-09-06|WebDAV HTTP access does not include meta tag for c|
|58335|New|Nor|2015-09-07|mod_authnz_ldap mismatch                          |
|58343|New|Nor|2015-09-08|The pdf files come up as a blank page.            |
|58354|New|Maj|2015-09-10|(20014)Internal error (specific information not av|
|58356|New|Blk|2015-09-10|Session jumping due to incorrect route            |
|58364|New|Reg|2015-09-11|Apache Server is restarted time to time (Release 2|
|58417|New|Min|2015-09-16|ApacheBench (ab) won't display Server Software of |
|58419|New|Nor|2015-09-16|ApacheBench (ab) doesn't work with keep-alives aga|
|58423|New|Reg|2015-09-17|Apache >= 2.4.8 PCRE_DUPNAMES causes build failure|
|58454|New|Nor|2015-09-24|Invalid FB (first byte) logging when using SSL/TLS|
|58467|New|Maj|2015-09-29|Environment Variables in ProxyHTMLURLMap produces |
|58475|New|Nor|2015-10-03|Support append/merge with semicolon-separated head|
|58488|New|Nor|2015-10-08|Stoped PHP-FPM pool in multi-pool system with comu|
|58491|New|Maj|2015-10-09|Core dumps appear when the load increases         |
|58492|Inf|Nor|2015-10-09|I think LDAPConnectionPoolTTL is not being honored|
|58498|New|Nor|2015-10-16|Apache 2.4.17: Regression with mod_autoindex (in c|
|58500|New|Nor|2015-10-16|dav_fs not enabled by default                     |
|58503|New|Cri|2015-10-16|segfault in apr_brigade_cleanup() under high load |
|58509|New|Trv|2015-10-20|2.4.17-dev introduces second core.c handler at sta|
|58513|New|Maj|2015-10-21|httpd code documentation is missing               |
|58524|New|Nor|2015-10-23|mod_http2 segfaults when under heavy load         |
|58528|New|Nor|2015-10-23|.htaccess access with default settings, probably m|
|58529|New|Maj|2015-10-23|Segmentation fault after modifying a proxy Balance|
+-----+---+---+----------+--------------------------------------------------+
| Total 1547 bugs                                                           |
+---------------------------------------------------------------------------+

From dev-return-84446-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Sun Oct 25 21:44:59 2015
Return-Path: <dev-return-84446-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id C71971823A
	for <apmail-httpd-dev-archive@www.apache.org>; Sun, 25 Oct 2015 21:44:59 +0000 (UTC)
Received: (qmail 45114 invoked by uid 500); 25 Oct 2015 21:44:59 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 45032 invoked by uid 500); 25 Oct 2015 21:44:59 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 45021 invoked by uid 99); 25 Oct 2015 21:44:59 -0000
Received: from Unknown (HELO spamd3-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 25 Oct 2015 21:44:59 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd3-us-west.apache.org (ASF Mail Server at spamd3-us-west.apache.org) with ESMTP id A16FF180F51
	for <dev@httpd.apache.org>; Sun, 25 Oct 2015 21:44:58 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd3-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 3.501
X-Spam-Level: ***
X-Spam-Status: No, score=3.501 tagged_above=-999 required=6.31
	tests=[KAM_LAZY_DOMAIN_SECURITY=1, KAM_LINKBAIT=2.5,
	URIBL_BLOCKED=0.001] autolearn=disabled
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd3-us-west.apache.org [10.40.0.10]) (amavisd-new, port 10024)
	with ESMTP id yFcBkoWFAO8b for <dev@httpd.apache.org>;
	Sun, 25 Oct 2015 21:44:51 +0000 (UTC)
Received: from node176.itex.at (mail.123x.at [194.242.35.176])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id 9BC1820751
	for <dev@httpd.apache.org>; Sun, 25 Oct 2015 21:44:50 +0000 (UTC)
Received: from localhost (localhost [127.0.0.1])
	by node176.itex.at (Postfix) with ESMTP id A2A8D22BA1
	for <dev@httpd.apache.org>; Sun, 25 Oct 2015 22:44:44 +0100 (CET)
X-Virus-Scanned: Debian amavisd-new at node176.itex.at
Received: from node176.itex.at ([127.0.0.1])
	by localhost (node176.itex.at [127.0.0.1]) (amavisd-new, port 10024)
	with ESMTP id 7pS2Z0G3kFom for <dev@httpd.apache.org>;
	Sun, 25 Oct 2015 22:44:44 +0100 (CET)
Received: from [10.0.0.1] (CPE-124-183-121-138.lns15.ken.bigpond.net.au [124.183.121.138])
	(Authenticated sender: normw@gknw.net)
	by node176.itex.at (Postfix) with ESMTPSA id 5B32522819
	for <dev@httpd.apache.org>; Sun, 25 Oct 2015 22:44:42 +0100 (CET)
Subject: Re: Latest httpd-trunk updates....
To: dev@httpd.apache.org
References: <562BF670.90901@gknw.net>
 <CALK=YjOxFV2THsbF1MDwhPfDOqieKb7BkSA0JVuxpixf+H=imA@mail.gmail.com>
From: NormW <normw@gknw.net>
Message-ID: <562D4D41.1050805@gknw.net>
Date: Mon, 26 Oct 2015 08:44:33 +1100
User-Agent: Mozilla/5.0 (Windows NT 5.1; rv:38.0) Gecko/20100101
 Thunderbird/38.3.0
MIME-Version: 1.0
In-Reply-To: <CALK=YjOxFV2THsbF1MDwhPfDOqieKb7BkSA0JVuxpixf+H=imA@mail.gmail.com>
Content-Type: text/plain; charset=utf-8; format=flowed
Content-Transfer-Encoding: 7bit

On 25/10/2015 8:36 AM, Eric Covener wrote:
> On Sat, Oct 24, 2015 at 5:21 PM, NormW <normw@gknw.net> wrote:
>>> #     289:          if (conf->fully_qualify_redirect_url !=
>>> AP_CORE_CONFIG_ON) {
>
> Fixed now, didn't get rebuilt when I changed the name in the header.
>
As of this morning (Monday 8.35 AEST) see a clean build of httpd-trunk, 
includng nghttp2 1.4.0.

Norm


From dev-return-84447-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Mon Oct 26 07:06:05 2015
Return-Path: <dev-return-84447-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 7C95618DEF
	for <apmail-httpd-dev-archive@www.apache.org>; Mon, 26 Oct 2015 07:06:05 +0000 (UTC)
Received: (qmail 33363 invoked by uid 500); 26 Oct 2015 07:06:04 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 33287 invoked by uid 500); 26 Oct 2015 07:06:04 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 33277 invoked by uid 99); 26 Oct 2015 07:06:04 -0000
Received: from Unknown (HELO spamd1-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 26 Oct 2015 07:06:04 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd1-us-west.apache.org (ASF Mail Server at spamd1-us-west.apache.org) with ESMTP id 57458C88E4
	for <dev@httpd.apache.org>; Mon, 26 Oct 2015 07:06:04 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd1-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 0.247
X-Spam-Level:
X-Spam-Status: No, score=0.247 tagged_above=-999 required=6.31
	tests=[HEADER_FROM_DIFFERENT_DOMAINS=0.25, RP_MATCHES_RCVD=-0.001,
	SPF_HELO_PASS=-0.001, SPF_PASS=-0.001] autolearn=disabled
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd1-us-west.apache.org [10.40.0.7]) (amavisd-new, port 10024)
	with ESMTP id 7ITraI_Xd9XO for <dev@httpd.apache.org>;
	Mon, 26 Oct 2015 07:06:03 +0000 (UTC)
Received: from plane.gmane.org (plane.gmane.org [80.91.229.3])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id 4DE0E2085F
	for <dev@httpd.apache.org>; Mon, 26 Oct 2015 07:06:03 +0000 (UTC)
Received: from list by plane.gmane.org with local (Exim 4.69)
	(envelope-from <apache-dev@m.gmane.org>)
	id 1Zqbqy-0007c2-7k
	for dev@httpd.apache.org; Mon, 26 Oct 2015 08:06:00 +0100
Received: from aorleans-552-1-121-107.w92-140.abo.wanadoo.fr ([92.140.248.107])
        by main.gmane.org with esmtp (Gmexim 0.1 (Debian))
        id 1AlnuQ-0007hv-00
        for <dev@httpd.apache.org>; Mon, 26 Oct 2015 08:06:00 +0100
Received: from christophe.jaillet by aorleans-552-1-121-107.w92-140.abo.wanadoo.fr with local (Gmexim 0.1 (Debian))
        id 1AlnuQ-0007hv-00
        for <dev@httpd.apache.org>; Mon, 26 Oct 2015 08:06:00 +0100
X-Injected-Via-Gmane: http://gmane.org/
To: dev@httpd.apache.org
From: Christophe JAILLET <christophe.jaillet@wanadoo.fr>
Subject: Question about CACHE_SEPARATOR in modules/cache/cache_util.h
Date: Mon, 26 Oct 2015 08:05:50 +0100
Lines: 17
Message-ID: <n0kjcg$nu9$1@ger.gmane.org>
Mime-Version: 1.0
Content-Type: text/plain; charset=utf-8; format=flowed
Content-Transfer-Encoding: 7bit
X-Complaints-To: usenet@ger.gmane.org
X-Gmane-NNTP-Posting-Host: aorleans-552-1-121-107.w92-140.abo.wanadoo.fr
X-Mozilla-News-Host: news://news.gmane.org:119
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:38.0) Gecko/20100101
 Thunderbird/38.3.0
X-Antivirus: avast! (VPS 151025-3, 25/10/2015), Outbound message
X-Antivirus-Status: Clean

Hi,

in modules/cache/cache_util.h, CACHE_SEPARATOR is defined as:

      #define CACHE_SEPARATOR ",   "


I don't see any reason to have 3 spaces here.
It is only used within calls to 'cache_strqtok' and scanning 3 times for 
the same thing is just a waste of time.

Did I miss something obvious, or can it be turned in:

      #define CACHE_SEPARATOR ", "

Best regards,
CJ


From dev-return-84448-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Mon Oct 26 08:48:23 2015
Return-Path: <dev-return-84448-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 952D6180CA
	for <apmail-httpd-dev-archive@www.apache.org>; Mon, 26 Oct 2015 08:48:23 +0000 (UTC)
Received: (qmail 89460 invoked by uid 500); 26 Oct 2015 08:47:49 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 89385 invoked by uid 500); 26 Oct 2015 08:47:48 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 89375 invoked by uid 99); 26 Oct 2015 08:47:48 -0000
Received: from Unknown (HELO spamd4-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 26 Oct 2015 08:47:48 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd4-us-west.apache.org (ASF Mail Server at spamd4-us-west.apache.org) with ESMTP id 7A1A7C0C5B
	for <dev@httpd.apache.org>; Mon, 26 Oct 2015 08:47:48 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd4-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 2.969
X-Spam-Level: **
X-Spam-Status: No, score=2.969 tagged_above=-999 required=6.31
	tests=[HTML_MESSAGE=3, RCVD_IN_MSPIKE_H3=-0.01,
	RCVD_IN_MSPIKE_WL=-0.01, SPF_PASS=-0.001, T_RP_MATCHES_RCVD=-0.01]
	autolearn=disabled
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd4-us-west.apache.org [10.40.0.11]) (amavisd-new, port 10024)
	with ESMTP id jWOV4CCnNUz6 for <dev@httpd.apache.org>;
	Mon, 26 Oct 2015 08:47:41 +0000 (UTC)
Received: from smtp.checkpoint.com (smtp.checkpoint.com [194.29.34.68])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id EDC8E439F2
	for <dev@httpd.apache.org>; Mon, 26 Oct 2015 08:47:40 +0000 (UTC)
x-m-msg: CPCHECK
Received: from DAG-EX10.ad.checkpoint.com ([194.29.34.150])
	by smtp.checkpoint.com (8.13.8/8.13.8) with ESMTP id t9Q8lcpu003622
	for <dev@httpd.apache.org>; Mon, 26 Oct 2015 10:47:38 +0200
Received: from IL-EX10.ad.checkpoint.com ([169.254.2.36]) by
 DAG-EX10.ad.checkpoint.com ([169.254.3.11]) with mapi id 14.03.0248.002; Mon,
 26 Oct 2015 10:45:59 +0200
From: Yehezkel Horowitz <horowity@checkpoint.com>
To: "dev@httpd.apache.org" <dev@httpd.apache.org>
Subject: RE: Improve Apache performance on high load (prefork MPM) with
 multiple Accept mutexes (Patch attached)
Thread-Topic: Improve Apache performance on high load (prefork MPM) with
 multiple Accept mutexes (Patch attached)
Thread-Index: AdEKfWuZhdmjohBKS/yAuQ98J4a/oQFTL8YQ
Date: Mon, 26 Oct 2015 08:45:58 +0000
Message-ID: <6A49427F0EB5B44F9F1006B09A0A28F4F8B0B3E3@IL-EX10.ad.checkpoint.com>
Accept-Language: en-US
Content-Language: en-US
X-MS-Has-Attach: yes
X-MS-TNEF-Correlator: 
x-originating-ip: [194.29.34.193]
x-kse-antivirus-interceptor-info: scan successful
x-kse-antivirus-info: Clean
x-cpdlp: 11e5decac299745da54d91840302aaf20fb181791f
Content-Type: multipart/mixed;
	boundary="_004_6A49427F0EB5B44F9F1006B09A0A28F4F8B0B3E3ILEX10adcheckpo_"
MIME-Version: 1.0

--_004_6A49427F0EB5B44F9F1006B09A0A28F4F8B0B3E3ILEX10adcheckpo_
Content-Type: multipart/alternative;
	boundary="_000_6A49427F0EB5B44F9F1006B09A0A28F4F8B0B3E3ILEX10adcheckpo_"

--_000_6A49427F0EB5B44F9F1006B09A0A28F4F8B0B3E3ILEX10adcheckpo_
Content-Type: text/plain; charset="us-ascii"
Content-Transfer-Encoding: quoted-printable

Any chance someone could take a short look and provide me a feedback (of an=
y kind)?

I know your focus is on 2.4 and trunk, but there are still many 2.2 servers=
 out there...

Patch attached again for you convenience....

Yehezkel Horowitz
Check Point Software Technologies Ltd.
From: Yehezkel Horowitz
Sent: Monday, October 19, 2015 6:14 PM
To: dev@httpd.apache.org
Subject: Improve Apache performance on high load (prefork MPM) with multipl=
e Accept mutexes (Patch attached)

Hello Apache gurus.

I was working on a project which used Apache 2.2.x with prefork MPM (using =
flock as mutex method) on Linux machine (with 20 cores), and run into the f=
ollowing problem.

During load, when number of Apache child processes get beyond some point (~=
3000 processes) - Apache didn't accept the incoming connections in reasonab=
le time (seen in netstat as SYN_RECV).

I found a document about Apache Performance Tuning [1], in which there is a=
n idea to improve the performance by:
"Another solution that has been considered but never implemented is to part=
ially serialize the loop -- that is, let in a certain number of processes. =
This would only be of interest on multiprocessor boxes where it's possible =
that multiple children could run simultaneously, and the serialization actu=
ally doesn't take advantage of the full bandwidth. This is a possible area =
of future investigation, but priority remains low because highly parallel w=
eb servers are not the norm."

I wrote a small patch (aligned to 2.2.31) that implements this idea - creat=
e 4 mutexes and spread the child processes across the mutexes (by getpid() =
% mutex_number).

So in any given time - 4 ideal child processes are expected [2] to wait in =
the "select loop".
Once a new connection arrive - 4 processes are awake by the OS: 1 will succ=
eed to accept the socket (and will release his mutex) and 3 will return to =
the "select loop".

This solved my specific problem and allowed me to get more load on the mach=
ine.

My questions to this forum are:


1.       Do you think this is a good implementation of the suggested idea?



2.       Any pitfalls I missed?


3.       Would you consider accepting this patch to the project?
If so, could you guide me what else needs to be done for acceptances?
I know there is a need for configuration & documentation work - I'll work o=
n once the patch will be approved...


4.       Do you think '4' is a good default for the mutexes number? What sh=
ould be the considerations to set the default?



5.       Does such implementation relevant for other MPMs (worker/event)?

Any other feedback is welcome.

[1] http://httpd.apache.org/docs/2.2/misc/perf-tuning.html, accept Serializ=
ation - Multiple Sockets section.
[2] There is no guarantee that exactly 4 processes will wait as all process=
es of "getpid() % mutex_number =3D=3D 0" might be busy in a given time. But=
 this sounds to me like a fair limitation.

Note: flock give me the best results, still it seems to be with n^2 complex=
ity (where 'n' is the number of waiting processes), so reducing the number =
of processes waiting on each mutex give exponential improvement.

Regards,

Yehezkel Horowitz
Check Point Software Technologies Ltd.

--_000_6A49427F0EB5B44F9F1006B09A0A28F4F8B0B3E3ILEX10adcheckpo_
Content-Type: text/html; charset="us-ascii"
Content-Transfer-Encoding: quoted-printable

<html xmlns:v=3D"urn:schemas-microsoft-com:vml" xmlns:o=3D"urn:schemas-micr=
osoft-com:office:office" xmlns:w=3D"urn:schemas-microsoft-com:office:word" =
xmlns:m=3D"http://schemas.microsoft.com/office/2004/12/omml" xmlns=3D"http:=
//www.w3.org/TR/REC-html40">
<head>
<meta http-equiv=3D"Content-Type" content=3D"text/html; charset=3Dus-ascii"=
>
<meta name=3D"Generator" content=3D"Microsoft Word 14 (filtered medium)">
<style><!--
/* Font Definitions */
@font-face
	{font-family:Calibri;
	panose-1:2 15 5 2 2 2 4 3 2 4;}
@font-face
	{font-family:Tahoma;
	panose-1:2 11 6 4 3 5 4 4 2 4;}
/* Style Definitions */
p.MsoNormal, li.MsoNormal, div.MsoNormal
	{margin:0in;
	margin-bottom:.0001pt;
	font-size:11.0pt;
	font-family:"Calibri","sans-serif";}
a:link, span.MsoHyperlink
	{mso-style-priority:99;
	color:blue;
	text-decoration:underline;}
a:visited, span.MsoHyperlinkFollowed
	{mso-style-priority:99;
	color:purple;
	text-decoration:underline;}
p.MsoListParagraph, li.MsoListParagraph, div.MsoListParagraph
	{mso-style-priority:34;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:.5in;
	margin-bottom:.0001pt;
	font-size:11.0pt;
	font-family:"Calibri","sans-serif";}
span.EmailStyle18
	{mso-style-type:personal;
	font-family:"Calibri","sans-serif";
	color:windowtext;}
span.EmailStyle19
	{mso-style-type:personal-reply;
	font-family:"Calibri","sans-serif";
	color:#1F497D;}
.MsoChpDefault
	{mso-style-type:export-only;
	font-size:10.0pt;}
@page WordSection1
	{size:8.5in 11.0in;
	margin:1.0in 1.0in 1.0in 1.0in;}
div.WordSection1
	{page:WordSection1;}
/* List Definitions */
@list l0
	{mso-list-id:1169976873;
	mso-list-type:hybrid;
	mso-list-template-ids:1360162746 67698703 67698713 67698715 67698703 67698=
713 67698715 67698703 67698713 67698715;}
@list l0:level1
	{mso-level-tab-stop:none;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l0:level2
	{mso-level-number-format:alpha-lower;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l0:level3
	{mso-level-number-format:roman-lower;
	mso-level-tab-stop:none;
	mso-level-number-position:right;
	text-indent:-9.0pt;}
@list l0:level4
	{mso-level-tab-stop:none;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l0:level5
	{mso-level-number-format:alpha-lower;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l0:level6
	{mso-level-number-format:roman-lower;
	mso-level-tab-stop:none;
	mso-level-number-position:right;
	text-indent:-9.0pt;}
@list l0:level7
	{mso-level-tab-stop:none;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l0:level8
	{mso-level-number-format:alpha-lower;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l0:level9
	{mso-level-number-format:roman-lower;
	mso-level-tab-stop:none;
	mso-level-number-position:right;
	text-indent:-9.0pt;}
ol
	{margin-bottom:0in;}
ul
	{margin-bottom:0in;}
--></style><!--[if gte mso 9]><xml>
<o:shapedefaults v:ext=3D"edit" spidmax=3D"1026" />
</xml><![endif]--><!--[if gte mso 9]><xml>
<o:shapelayout v:ext=3D"edit">
<o:idmap v:ext=3D"edit" data=3D"1" />
</o:shapelayout></xml><![endif]-->
</head>
<body lang=3D"EN-US" link=3D"blue" vlink=3D"purple">
<div class=3D"WordSection1">
<p class=3D"MsoNormal"><span style=3D"color:#1F497D">Any chance someone cou=
ld take a short look and provide me a feedback (of any kind)?<o:p></o:p></s=
pan></p>
<p class=3D"MsoNormal"><span style=3D"color:#1F497D"><o:p>&nbsp;</o:p></spa=
n></p>
<p class=3D"MsoNormal"><span style=3D"color:#1F497D">I know your focus is o=
n 2.4 and trunk, but there are still many 2.2 servers out there&#8230;<o:p>=
</o:p></span></p>
<p class=3D"MsoNormal"><span style=3D"color:#1F497D"><o:p>&nbsp;</o:p></spa=
n></p>
<p class=3D"MsoNormal"><span style=3D"color:#1F497D">Patch attached again f=
or you convenience.&#8230;<o:p></o:p></span></p>
<p class=3D"MsoNormal"><span style=3D"color:#1F497D"><o:p>&nbsp;</o:p></spa=
n></p>
<div>
<p class=3D"MsoNormal"><span style=3D"font-size:12.0pt;color:navy">Yehezkel=
 Horowitz<o:p></o:p></span></p>
</div>
<p class=3D"MsoNormal"><span style=3D"font-size:10.0pt;color:navy">Check Po=
int Software Technologies Ltd.</span><span style=3D"color:#1F497D"><o:p></o=
:p></span></p>
<div>
<div style=3D"border:none;border-top:solid #B5C4DF 1.0pt;padding:3.0pt 0in =
0in 0in">
<p class=3D"MsoNormal"><b><span style=3D"font-size:10.0pt;font-family:&quot=
;Tahoma&quot;,&quot;sans-serif&quot;">From:</span></b><span style=3D"font-s=
ize:10.0pt;font-family:&quot;Tahoma&quot;,&quot;sans-serif&quot;"> Yehezkel=
 Horowitz
<br>
<b>Sent:</b> Monday, October 19, 2015 6:14 PM<br>
<b>To:</b> dev@httpd.apache.org<br>
<b>Subject:</b> Improve Apache performance on high load (prefork MPM) with =
multiple Accept mutexes (Patch attached)<o:p></o:p></span></p>
</div>
</div>
<p class=3D"MsoNormal"><o:p>&nbsp;</o:p></p>
<p class=3D"MsoNormal">Hello Apache gurus.<o:p></o:p></p>
<p class=3D"MsoNormal"><o:p>&nbsp;</o:p></p>
<p class=3D"MsoNormal">I was working on a project which used Apache 2.2.x w=
ith prefork MPM (using flock as mutex method) on Linux machine (with 20 cor=
es), and run into the following problem.<o:p></o:p></p>
<p class=3D"MsoNormal"><o:p>&nbsp;</o:p></p>
<p class=3D"MsoNormal">During load, when number of Apache child processes g=
et beyond some point (~3000 processes) - Apache didn&#8217;t accept the inc=
oming connections in reasonable time (seen in netstat as SYN_RECV).<o:p></o=
:p></p>
<p class=3D"MsoNormal"><o:p>&nbsp;</o:p></p>
<p class=3D"MsoNormal">I found a document about Apache Performance Tuning [=
1], in which there is an idea to improve the performance by:<o:p></o:p></p>
<p class=3D"MsoNormal">&#8220;Another solution that has been considered but=
 never implemented is to partially serialize the loop -- that is, let in a =
certain number of processes. This would only be of interest on multiprocess=
or boxes where it's possible that multiple
 children could run simultaneously, and the serialization actually doesn't =
take advantage of the full bandwidth. This is a possible area of future inv=
estigation, but priority remains low because highly parallel web servers ar=
e not the norm.&#8221;<o:p></o:p></p>
<p class=3D"MsoNormal"><o:p>&nbsp;</o:p></p>
<p class=3D"MsoNormal">I wrote a small patch (aligned to 2.2.31) that imple=
ments this idea &#8211; create 4 mutexes and spread the child processes acr=
oss the mutexes (by getpid() % mutex_number).
<o:p></o:p></p>
<p class=3D"MsoNormal"><o:p>&nbsp;</o:p></p>
<p class=3D"MsoNormal">So in any given time - 4 ideal child processes are e=
xpected [2] to wait in the &#8220;select loop&#8221;.
<o:p></o:p></p>
<p class=3D"MsoNormal">Once a new connection arrive - 4 processes are awake=
 by the OS: 1 will succeed to accept the socket (and will release his mutex=
) and 3 will return to the &#8220;select loop&#8221;.<o:p></o:p></p>
<p class=3D"MsoNormal"><o:p>&nbsp;</o:p></p>
<p class=3D"MsoNormal">This solved my specific problem and allowed me to ge=
t more load on the machine.<o:p></o:p></p>
<p class=3D"MsoNormal"><o:p>&nbsp;</o:p></p>
<p class=3D"MsoNormal">My questions to this forum are:<o:p></o:p></p>
<p class=3D"MsoNormal"><o:p>&nbsp;</o:p></p>
<p class=3D"MsoListParagraph" style=3D"text-indent:-.25in;mso-list:l0 level=
1 lfo2"><![if !supportLists]><span style=3D"mso-list:Ignore">1.<span style=
=3D"font:7.0pt &quot;Times New Roman&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&=
nbsp;
</span></span><![endif]><span dir=3D"LTR"></span>Do you think this is a goo=
d implementation of the suggested idea?
<o:p></o:p></p>
<p class=3D"MsoListParagraph"><o:p>&nbsp;</o:p></p>
<p class=3D"MsoListParagraph" style=3D"text-indent:-.25in;mso-list:l0 level=
1 lfo2"><![if !supportLists]><span style=3D"mso-list:Ignore">2.<span style=
=3D"font:7.0pt &quot;Times New Roman&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&=
nbsp;
</span></span><![endif]><span dir=3D"LTR"></span>Any pitfalls I missed?<o:p=
></o:p></p>
<p class=3D"MsoNormal"><o:p>&nbsp;</o:p></p>
<p class=3D"MsoListParagraph" style=3D"text-indent:-.25in;mso-list:l0 level=
1 lfo2"><![if !supportLists]><span style=3D"mso-list:Ignore">3.<span style=
=3D"font:7.0pt &quot;Times New Roman&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&=
nbsp;
</span></span><![endif]><span dir=3D"LTR"></span>Would you consider accepti=
ng this patch to the project?
<br>
If so, could you guide me what else needs to be done for acceptances?<br>
I know there is a need for configuration &amp; documentation work - I&#8217=
;ll work on once the patch will be approved&#8230;<o:p></o:p></p>
<p class=3D"MsoNormal"><o:p>&nbsp;</o:p></p>
<p class=3D"MsoListParagraph" style=3D"text-indent:-.25in;mso-list:l0 level=
1 lfo2"><![if !supportLists]><span style=3D"mso-list:Ignore">4.<span style=
=3D"font:7.0pt &quot;Times New Roman&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&=
nbsp;
</span></span><![endif]><span dir=3D"LTR"></span>Do you think &#8216;4&#821=
7; is a good default for the mutexes number? What should be the considerati=
ons to set the default?<o:p></o:p></p>
<p class=3D"MsoListParagraph"><o:p>&nbsp;</o:p></p>
<p class=3D"MsoListParagraph" style=3D"text-indent:-.25in;mso-list:l0 level=
1 lfo2"><![if !supportLists]><span style=3D"mso-list:Ignore">5.<span style=
=3D"font:7.0pt &quot;Times New Roman&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&=
nbsp;
</span></span><![endif]><span dir=3D"LTR"></span>Does such implementation r=
elevant for other MPMs (worker/event)?<o:p></o:p></p>
<p class=3D"MsoNormal"><o:p>&nbsp;</o:p></p>
<p class=3D"MsoNormal">Any other feedback is welcome.<o:p></o:p></p>
<p class=3D"MsoNormal"><o:p>&nbsp;</o:p></p>
<p class=3D"MsoNormal">[1] <a href=3D"http://httpd.apache.org/docs/2.2/misc=
/perf-tuning.html">
http://httpd.apache.org/docs/2.2/misc/perf-tuning.html</a>, accept Serializ=
ation - Multiple Sockets section.
<o:p></o:p></p>
<p class=3D"MsoNormal">[2] There is no guarantee that exactly 4 processes w=
ill wait as all processes of &#8220;getpid() % mutex_number =3D=3D 0&#8221;=
 might be busy in a given time. But this sounds to me like a fair limitatio=
n.<o:p></o:p></p>
<p class=3D"MsoNormal"><o:p>&nbsp;</o:p></p>
<p class=3D"MsoNormal">Note: flock give me the best results, still it seems=
 to be with n^2 complexity (where &#8216;n&#8217; is the number of waiting =
processes), so reducing the number of processes waiting on each mutex give =
exponential improvement.<o:p></o:p></p>
<p class=3D"MsoNormal"><o:p>&nbsp;</o:p></p>
<p class=3D"MsoNormal">Regards,<o:p></o:p></p>
<p class=3D"MsoNormal"><o:p>&nbsp;</o:p></p>
<p class=3D"MsoNormal"><span style=3D"font-size:12.0pt;color:navy">Yehezkel=
 Horowitz<o:p></o:p></span></p>
<p class=3D"MsoNormal"><span style=3D"font-size:10.0pt;color:navy">Check Po=
int Software Technologies Ltd.</span><o:p></o:p></p>
</div>
</body>
</html>

--_000_6A49427F0EB5B44F9F1006B09A0A28F4F8B0B3E3ILEX10adcheckpo_--

--_004_6A49427F0EB5B44F9F1006B09A0A28F4F8B0B3E3ILEX10adcheckpo_
Content-Type: application/octet-stream; name="multi-accept-mutexes.patch"
Content-Description: multi-accept-mutexes.patch
Content-Disposition: attachment; filename="multi-accept-mutexes.patch";
	size=5180; creation-date="Mon, 26 Oct 2015 08:43:17 GMT";
	modification-date="Mon, 26 Oct 2015 08:43:17 GMT"
Content-Transfer-Encoding: base64

ZGlmZiAtLWdpdCBhL3NlcnZlci9tcG0vcHJlZm9yay9wcmVmb3JrLmMgYi9zZXJ2ZXIvbXBtL3By
ZWZvcmsvcHJlZm9yay5jCmluZGV4IDlmODAwMDYuLjVkNGRlYjUgMTAwNjQ0Ci0tLSBhL3NlcnZl
ci9tcG0vcHJlZm9yay9wcmVmb3JrLmMKKysrIGIvc2VydmVyL21wbS9wcmVmb3JrL3ByZWZvcmsu
YwpAQCAtOTAsOCArOTAsMTIgQEAKIAogLyogY29uZmlnIGdsb2JhbHMgKi8KIAorI2RlZmluZSBU
T1RBTF9BQ0NFUFRfTVVURVhfTlVNQkVSIDQKKwogaW50IGFwX3RocmVhZHNfcGVyX2NoaWxkPTA7
ICAgICAgICAgLyogV29ya2VyIHRocmVhZHMgcGVyIGNoaWxkICovCi1zdGF0aWMgYXByX3Byb2Nf
bXV0ZXhfdCAqYWNjZXB0X211dGV4Oworc3RhdGljIGFwcl9wcm9jX211dGV4X3QqIGFjY2VwdF9t
dXRleF9hcnJheVtUT1RBTF9BQ0NFUFRfTVVURVhfTlVNQkVSXTsKK3N0YXRpYyBpbnQgbXlfbXV0
ZXhfYnlfcGlkID0gMDsKK3N0YXRpYyBjb25zdCBjaGFyICpteV9hcF9sb2NrX2ZuYW1lID0gTlVM
TDsgIAogc3RhdGljIGludCBhcF9kYWVtb25zX3RvX3N0YXJ0PTA7CiBzdGF0aWMgaW50IGFwX2Rh
ZW1vbnNfbWluX2ZyZWU9MDsKIHN0YXRpYyBpbnQgYXBfZGFlbW9uc19tYXhfZnJlZT0wOwpAQCAt
MjAyLDcgKzIwNiw3IEBAIHN0YXRpYyB2b2lkIGNsZWFuX2NoaWxkX2V4aXQoaW50IGNvZGUpCiAK
IHN0YXRpYyB2b2lkIGFjY2VwdF9tdXRleF9vbih2b2lkKQogewotICAgIGFwcl9zdGF0dXNfdCBy
diA9IGFwcl9wcm9jX211dGV4X2xvY2soYWNjZXB0X211dGV4KTsKKyAgICBhcHJfc3RhdHVzX3Qg
cnYgPSBhcHJfcHJvY19tdXRleF9sb2NrKGFjY2VwdF9tdXRleF9hcnJheVtteV9tdXRleF9ieV9w
aWRdKTsKICAgICBpZiAocnYgIT0gQVBSX1NVQ0NFU1MpIHsKICAgICAgICAgY29uc3QgY2hhciAq
bXNnID0gImNvdWxkbid0IGdyYWIgdGhlIGFjY2VwdCBtdXRleCI7CiAKQEAgLTIyMCw3ICsyMjQs
NyBAQCBzdGF0aWMgdm9pZCBhY2NlcHRfbXV0ZXhfb24odm9pZCkKIAogc3RhdGljIHZvaWQgYWNj
ZXB0X211dGV4X29mZih2b2lkKQogewotICAgIGFwcl9zdGF0dXNfdCBydiA9IGFwcl9wcm9jX211
dGV4X3VubG9jayhhY2NlcHRfbXV0ZXgpOworICAgIGFwcl9zdGF0dXNfdCBydiA9IGFwcl9wcm9j
X211dGV4X3VubG9jayhhY2NlcHRfbXV0ZXhfYXJyYXlbbXlfbXV0ZXhfYnlfcGlkXSk7CiAgICAg
aWYgKHJ2ICE9IEFQUl9TVUNDRVNTKSB7CiAgICAgICAgIGNvbnN0IGNoYXIgKm1zZyA9ICJjb3Vs
ZG4ndCByZWxlYXNlIHRoZSBhY2NlcHQgbXV0ZXgiOwogCkBAIC01MDMsMTEgKzUwNywxNiBAQCBz
dGF0aWMgdm9pZCBjaGlsZF9tYWluKGludCBjaGlsZF9udW1fYXJnKQogCiAgICAgLyogbmVlZHMg
dG8gYmUgZG9uZSBiZWZvcmUgd2Ugc3dpdGNoIFVJRHMgc28gd2UgaGF2ZSBwZXJtaXNzaW9ucyAq
LwogICAgIGFwX3Jlb3Blbl9zY29yZWJvYXJkKHBjaGlsZCwgTlVMTCwgMCk7Ci0gICAgc3RhdHVz
ID0gYXByX3Byb2NfbXV0ZXhfY2hpbGRfaW5pdCgmYWNjZXB0X211dGV4LCBhcF9sb2NrX2ZuYW1l
LCBwY2hpbGQpOworCisgICAgbXlfbXV0ZXhfYnlfcGlkID0gYXBfbXlfcGlkICUgVE9UQUxfQUND
RVBUX01VVEVYX05VTUJFUjsKKyAgICAKKyAgICBteV9hcF9sb2NrX2ZuYW1lID0gYXByX3BzcHJp
bnRmKHBjaGlsZCwgIiVzXyVkIiwgYXBfbG9ja19mbmFtZSwgbXlfbXV0ZXhfYnlfcGlkKTsKKwkK
KyAgICBzdGF0dXMgPSBhcHJfcHJvY19tdXRleF9jaGlsZF9pbml0KCZhY2NlcHRfbXV0ZXhfYXJy
YXlbbXlfbXV0ZXhfYnlfcGlkXSwgbXlfYXBfbG9ja19mbmFtZSwgcGNoaWxkKTsKICAgICBpZiAo
c3RhdHVzICE9IEFQUl9TVUNDRVNTKSB7CiAgICAgICAgIGFwX2xvZ19lcnJvcihBUExPR19NQVJL
LCBBUExPR19FTUVSRywgc3RhdHVzLCBhcF9zZXJ2ZXJfY29uZiwKICAgICAgICAgICAgICAgICAg
ICAgICJDb3VsZG4ndCBpbml0aWFsaXplIGNyb3NzLXByb2Nlc3MgbG9jayBpbiBjaGlsZCAiCi0g
ICAgICAgICAgICAgICAgICAgICAiKCVzKSAoJWQpIiwgYXBfbG9ja19mbmFtZSwgYXBfYWNjZXB0
X2xvY2tfbWVjaCk7CisgICAgICAgICAgICAgICAgICAgICAiKCVzKSAoJWQpIiwgbXlfYXBfbG9j
a19mbmFtZSwgYXBfYWNjZXB0X2xvY2tfbWVjaCk7CiAgICAgICAgIGNsZWFuX2NoaWxkX2V4aXQo
QVBFWElUX0NISUxERkFUQUwpOwogICAgIH0KIApAQCAtOTI4LDYgKzkzNyw4IEBAIGludCBhcF9t
cG1fcnVuKGFwcl9wb29sX3QgKl9wY29uZiwgYXByX3Bvb2xfdCAqcGxvZywgc2VydmVyX3JlYyAq
cykKICAgICBpbnQgaW5kZXg7CiAgICAgaW50IHJlbWFpbmluZ19jaGlsZHJlbl90b19zdGFydDsK
ICAgICBhcHJfc3RhdHVzX3QgcnY7CisgICAgaW50IGk7CisgICAgY2hhciAqIHRtcF9sb2NrX2Zu
YW1lOwogCiAgICAgYXBfbG9nX3BpZChwY29uZiwgYXBfcGlkX2ZuYW1lKTsKIApAQCAtOTQ0LDMx
ICs5NTUsMzcgQEAgaW50IGFwX21wbV9ydW4oYXByX3Bvb2xfdCAqX3Bjb25mLCBhcHJfcG9vbF90
ICpwbG9nLCBzZXJ2ZXJfcmVjICpzKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
YXBfc2VydmVyX3Jvb3RfcmVsYXRpdmUoX3Bjb25mLCBhcF9sb2NrX2ZuYW1lKSwKICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIGFwX215X3BpZCk7CiAKLSAgICBydiA9IGFwcl9wcm9j
X211dGV4X2NyZWF0ZSgmYWNjZXB0X211dGV4LCBhcF9sb2NrX2ZuYW1lLAotICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgIGFwX2FjY2VwdF9sb2NrX21lY2gsIF9wY29uZik7Ci0gICAgaWYg
KHJ2ICE9IEFQUl9TVUNDRVNTKSB7Ci0gICAgICAgIGFwX2xvZ19lcnJvcihBUExPR19NQVJLLCBB
UExPR19FTUVSRywgcnYsIHMsCi0gICAgICAgICAgICAgICAgICAgICAiQ291bGRuJ3QgY3JlYXRl
IGFjY2VwdCBsb2NrICglcykgKCVkKSIsCi0gICAgICAgICAgICAgICAgICAgICBhcF9sb2NrX2Zu
YW1lLCBhcF9hY2NlcHRfbG9ja19tZWNoKTsKLSAgICAgICAgbXBtX3N0YXRlID0gQVBfTVBNUV9T
VE9QUElORzsKLSAgICAgICAgcmV0dXJuIDE7CisgICAgZm9yIChpID0gMCA7IGkgPCBUT1RBTF9B
Q0NFUFRfTVVURVhfTlVNQkVSIDsgKytpKSB7CisJCQkJCQkJCQkgCisgICAgICAgdG1wX2xvY2tf
Zm5hbWUgPSBhcHJfcHNwcmludGYoX3Bjb25mLCAiJXNfJWQiLCBhcF9sb2NrX2ZuYW1lLCBpKTsK
KyAgICAKKyAgICAgICBydiA9IGFwcl9wcm9jX211dGV4X2NyZWF0ZSgmYWNjZXB0X211dGV4X2Fy
cmF5W2ldLCB0bXBfbG9ja19mbmFtZSwKKwkJCQkJCQkJICAgYXBfYWNjZXB0X2xvY2tfbWVjaCwg
X3Bjb25mKTsKKyAgICAgICBpZiAocnYgIT0gQVBSX1NVQ0NFU1MpIHsKKyAgICAgICAgICBhcF9s
b2dfZXJyb3IoQVBMT0dfTUFSSywgQVBMT0dfRU1FUkcsIHJ2LCBzLAorICAgICAgICAgICAgICAg
ICAgICAgICAiQ291bGRuJ3QgY3JlYXRlIGFjY2VwdCBsb2NrICglcykgKCVkKSIsCisgICAgICAg
ICAgICAgICAgICAgICAgIHRtcF9sb2NrX2ZuYW1lLCBhcF9hY2NlcHRfbG9ja19tZWNoKTsKKyAg
ICAgICAgICBtcG1fc3RhdGUgPSBBUF9NUE1RX1NUT1BQSU5HOworICAgICAgICAgIHJldHVybiAx
OwogICAgIH0KKwkKIAogI2lmIEFQUl9VU0VfU1lTVlNFTV9TRVJJQUxJWkUKLSAgICBpZiAoYXBf
YWNjZXB0X2xvY2tfbWVjaCA9PSBBUFJfTE9DS19ERUZBVUxUIHx8Ci0gICAgICAgIGFwX2FjY2Vw
dF9sb2NrX21lY2ggPT0gQVBSX0xPQ0tfU1lTVlNFTSkgeworCQlpZiAoYXBfYWNjZXB0X2xvY2tf
bWVjaCA9PSBBUFJfTE9DS19ERUZBVUxUIHx8CisJCQlhcF9hY2NlcHRfbG9ja19tZWNoID09IEFQ
Ul9MT0NLX1NZU1ZTRU0pIHsKICNlbHNlCi0gICAgaWYgKGFwX2FjY2VwdF9sb2NrX21lY2ggPT0g
QVBSX0xPQ0tfU1lTVlNFTSkgeworCQlpZiAoYXBfYWNjZXB0X2xvY2tfbWVjaCA9PSBBUFJfTE9D
S19TWVNWU0VNKSB7CiAjZW5kaWYKLSAgICAgICAgcnYgPSB1bml4ZF9zZXRfcHJvY19tdXRleF9w
ZXJtcyhhY2NlcHRfbXV0ZXgpOwotICAgICAgICBpZiAocnYgIT0gQVBSX1NVQ0NFU1MpIHsKLSAg
ICAgICAgICAgIGFwX2xvZ19lcnJvcihBUExPR19NQVJLLCBBUExPR19FTUVSRywgcnYsIHMsCi0g
ICAgICAgICAgICAgICAgICAgICAgICAgIkNvdWxkbid0IHNldCBwZXJtaXNzaW9ucyBvbiBjcm9z
cy1wcm9jZXNzIGxvY2s7ICIKLSAgICAgICAgICAgICAgICAgICAgICAgICAiY2hlY2sgVXNlciBh
bmQgR3JvdXAgZGlyZWN0aXZlcyIpOwotICAgICAgICAgICAgbXBtX3N0YXRlID0gQVBfTVBNUV9T
VE9QUElORzsKLSAgICAgICAgICAgIHJldHVybiAxOwotICAgICAgICB9Ci0gICAgfQorCQkJcnYg
PSB1bml4ZF9zZXRfcHJvY19tdXRleF9wZXJtcyhhY2NlcHRfbXV0ZXhfYXJyYXlbaV0pOworCQkJ
aWYgKHJ2ICE9IEFQUl9TVUNDRVNTKSB7CisJCQkJYXBfbG9nX2Vycm9yKEFQTE9HX01BUkssIEFQ
TE9HX0VNRVJHLCBydiwgcywKKwkJCQkJCQkgIkNvdWxkbid0IHNldCBwZXJtaXNzaW9ucyBvbiBj
cm9zcy1wcm9jZXNzIGxvY2s7ICIKKwkJCQkJCQkgImNoZWNrIFVzZXIgYW5kIEdyb3VwIGRpcmVj
dGl2ZXMiKTsKKwkJCQltcG1fc3RhdGUgPSBBUF9NUE1RX1NUT1BQSU5HOworCQkJCXJldHVybiAx
OworCQkJfQorCQl9CisJfQogCiAgICAgaWYgKCFpc19ncmFjZWZ1bCkgewogICAgICAgICBpZiAo
YXBfcnVuX3ByZV9tcG0ocy0+cHJvY2Vzcy0+cG9vbCwgU0JfU0hBUkVEKSAhPSBPSykgewpAQCAt
MTAyMiw3ICsxMDM5LDcgQEAgaW50IGFwX21wbV9ydW4oYXByX3Bvb2xfdCAqX3Bjb25mLCBhcHJf
cG9vbF90ICpwbG9nLCBzZXJ2ZXJfcmVjICpzKQogI2lmZGVmIEFQX01QTV9XQU5UX1NFVF9BQ0NF
UFRfTE9DS19NRUNICiAgICAgYXBfbG9nX2Vycm9yKEFQTE9HX01BUkssIEFQTE9HX0RFQlVHLCAw
LCBhcF9zZXJ2ZXJfY29uZiwKICAgICAgICAgICAgICAgICAiQWNjZXB0TXV0ZXg6ICVzIChkZWZh
dWx0OiAlcykiLAotICAgICAgICAgICAgICAgIGFwcl9wcm9jX211dGV4X25hbWUoYWNjZXB0X211
dGV4KSwKKyAgICAgICAgICAgICAgICBhcHJfcHJvY19tdXRleF9uYW1lKGFjY2VwdF9tdXRleF9h
cnJheVswXSksCiAgICAgICAgICAgICAgICAgYXByX3Byb2NfbXV0ZXhfZGVmbmFtZSgpKTsKICNl
bmRpZgogICAgIHJlc3RhcnRfcGVuZGluZyA9IHNodXRkb3duX3BlbmRpbmcgPSAwOwo=

--_004_6A49427F0EB5B44F9F1006B09A0A28F4F8B0B3E3ILEX10adcheckpo_--

From dev-return-84449-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Mon Oct 26 08:55:21 2015
Return-Path: <dev-return-84449-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 6008F180E7
	for <apmail-httpd-dev-archive@www.apache.org>; Mon, 26 Oct 2015 08:55:21 +0000 (UTC)
Received: (qmail 96087 invoked by uid 500); 26 Oct 2015 08:55:21 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 95998 invoked by uid 500); 26 Oct 2015 08:55:20 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 95988 invoked by uid 99); 26 Oct 2015 08:55:20 -0000
Received: from Unknown (HELO spamd4-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 26 Oct 2015 08:55:20 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd4-us-west.apache.org (ASF Mail Server at spamd4-us-west.apache.org) with ESMTP id 562C7C0720
	for <dev@httpd.apache.org>; Mon, 26 Oct 2015 08:55:20 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd4-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 0.979
X-Spam-Level:
X-Spam-Status: No, score=0.979 tagged_above=-999 required=6.31
	tests=[KAM_LAZY_DOMAIN_SECURITY=1, RCVD_IN_MSPIKE_H4=-0.01,
	RCVD_IN_MSPIKE_WL=-0.01, SPF_HELO_PASS=-0.001] autolearn=disabled
Received: from mx1-us-west.apache.org ([10.40.0.8])
	by localhost (spamd4-us-west.apache.org [10.40.0.11]) (amavisd-new, port 10024)
	with ESMTP id y-hgrGqh5VBD for <dev@httpd.apache.org>;
	Mon, 26 Oct 2015 08:55:09 +0000 (UTC)
Received: from mail1.bemta5.messagelabs.com (mail1.bemta5.messagelabs.com [195.245.231.140])
	by mx1-us-west.apache.org (ASF Mail Server at mx1-us-west.apache.org) with ESMTPS id AD3D820751
	for <dev@httpd.apache.org>; Mon, 26 Oct 2015 08:55:08 +0000 (UTC)
Received: from [85.158.139.163] by server-4.bemta-5.messagelabs.com id 72/FB-24856-56AED265; Mon, 26 Oct 2015 08:55:01 +0000
X-Env-Sender: ruediger.pluem@vodafone.com
X-Msg-Ref: server-16.tower-188.messagelabs.com!1445849700!312186!1
X-Originating-IP: [195.232.244.136]
X-StarScan-Received:
X-StarScan-Version: 7.19.2; banners=-,-,-
X-VirusChecked: Checked
Received: (qmail 15160 invoked from network); 26 Oct 2015 08:55:00 -0000
Received: from mailout04.vodafone.com (HELO mailout04.vodafone.com) (195.232.244.136)
  by server-16.tower-188.messagelabs.com with DHE-RSA-AES256-SHA encrypted SMTP; 26 Oct 2015 08:55:00 -0000
Received: from mailint02.vodafone.com (mailint02.vodafone.com [195.232.244.199])
	by mailout04.vodafone.com (Postfix) with ESMTP id 3nkqjw4SRdznTYq
	for <dev@httpd.apache.org>; Mon, 26 Oct 2015 09:55:00 +0100 (CET)
Received: from mailint02.vodafone.com (localhost [127.0.0.1])
	by mailint02.vodafone.com (Postfix) with ESMTP id 3nkqjw3XhMzQkbD
	for <dev@httpd.apache.org>; Mon, 26 Oct 2015 09:55:00 +0100 (CET)
Received: from VOEXC05W.internal.vodafone.com (mail5.nl.mx.vodafone.com [145.230.101.25])
	(using TLSv1 with cipher AES128-SHA (128/128 bits))
	(No client certificate requested)
	by mailint02.vodafone.com (Postfix) with ESMTPS id 3nkqjw3SQLzQlnf
	for <dev@httpd.apache.org>; Mon, 26 Oct 2015 09:55:00 +0100 (CET)
Received: from VOEXC08W.internal.vodafone.com (145.230.101.28) by
 VOEXC05W.internal.vodafone.com (145.230.101.25) with Microsoft SMTP Server
 (TLS) id 14.3.224.2; Mon, 26 Oct 2015 09:54:59 +0100
Received: from VOEXM10W.internal.vodafone.com ([169.254.2.167]) by
 voexc08w.internal.vodafone.com ([145.230.101.28]) with mapi id
 14.03.0224.002; Mon, 26 Oct 2015 09:54:55 +0100
From: =?utf-8?B?UGzDvG0sIFLDvGRpZ2VyLCBWb2RhZm9uZSBHcm91cA==?=
	<ruediger.pluem@vodafone.com>
To: "dev@httpd.apache.org" <dev@httpd.apache.org>
Subject: RE: Question about CACHE_SEPARATOR in modules/cache/cache_util.h
Thread-Topic: Question about CACHE_SEPARATOR in modules/cache/cache_util.h
Thread-Index: AQHRD7zNhC7lbL6k3kmakzw6aU3m9Z59d86Q
Date: Mon, 26 Oct 2015 08:54:54 +0000
Message-ID: <AB1691BE05AE7F4992697F2A0835627AC636DA9D@VOEXM10W.internal.vodafone.com>
References: <n0kjcg$nu9$1@ger.gmane.org>
In-Reply-To: <n0kjcg$nu9$1@ger.gmane.org>
Accept-Language: en-US
Content-Language: en-US
X-MS-Has-Attach:
X-MS-TNEF-Correlator:
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
MIME-Version: 1.0

DQoNCj4gLS0tLS1PcmlnaW5hbCBNZXNzYWdlLS0tLS0NCj4gRnJvbTogQ2hyaXN0b3BoZSBKQUlM
TEVUIFttYWlsdG86Y2hyaXN0b3BoZS5qYWlsbGV0QHdhbmFkb28uZnJdDQo+IFNlbnQ6IE1vbnRh
ZywgMjYuIE9rdG9iZXIgMjAxNSAwODowNg0KPiBUbzogZGV2QGh0dHBkLmFwYWNoZS5vcmcNCj4g
U3ViamVjdDogUXVlc3Rpb24gYWJvdXQgQ0FDSEVfU0VQQVJBVE9SIGluIG1vZHVsZXMvY2FjaGUv
Y2FjaGVfdXRpbC5oDQo+IA0KPiBIaSwNCj4gDQo+IGluIG1vZHVsZXMvY2FjaGUvY2FjaGVfdXRp
bC5oLCBDQUNIRV9TRVBBUkFUT1IgaXMgZGVmaW5lZCBhczoNCj4gDQo+ICAgICAgICNkZWZpbmUg
Q0FDSEVfU0VQQVJBVE9SICIsICAgIg0KPiANCj4gDQo+IEkgZG9uJ3Qgc2VlIGFueSByZWFzb24g
dG8gaGF2ZSAzIHNwYWNlcyBoZXJlLg0KPiBJdCBpcyBvbmx5IHVzZWQgd2l0aGluIGNhbGxzIHRv
ICdjYWNoZV9zdHJxdG9rJyBhbmQgc2Nhbm5pbmcgMyB0aW1lcyBmb3INCj4gdGhlIHNhbWUgdGhp
bmcgaXMganVzdCBhIHdhc3RlIG9mIHRpbWUuDQo+IA0KPiBEaWQgSSBtaXNzIHNvbWV0aGluZyBv
YnZpb3VzLCBvciBjYW4gaXQgYmUgdHVybmVkIGluOg0KDQpJIGNhbm5vdCBzZWUgYW55IG9idmlv
dXMgaGVyZSBlaXRoZXIuDQpJZiBpdCBpcyBuZWVkZWQgZm9yIHdoYXRldmVyIHJlYXNvbiBpdCBh
dCBsZWFzdCBkZXNlcnZlcyBhIGNvbW1lbnQgdG8gYXZvaWQgdGhpcyBxdWVzdGlvbiBpbiB0aGUg
ZnV0dXJlIDotKS4NCg0KUmVnYXJkcw0KDQpSw7xkaWdlcg0KDQo=

From dev-return-84450-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Mon Oct 26 09:12:04 2015
Return-Path: <dev-return-84450-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 96A10181A9
	for <apmail-httpd-dev-archive@www.apache.org>; Mon, 26 Oct 2015 09:12:03 +0000 (UTC)
Received: (qmail 37558 invoked by uid 500); 26 Oct 2015 09:12:03 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 37488 invoked by uid 500); 26 Oct 2015 09:12:03 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 37478 invoked by uid 99); 26 Oct 2015 09:12:02 -0000
Received: from Unknown (HELO spamd4-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 26 Oct 2015 09:12:02 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd4-us-west.apache.org (ASF Mail Server at spamd4-us-west.apache.org) with ESMTP id 95491C0720
	for <dev@httpd.apache.org>; Mon, 26 Oct 2015 09:12:02 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd4-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.011
X-Spam-Level:
X-Spam-Status: No, score=-0.011 tagged_above=-999 required=6.31
	tests=[SPF_PASS=-0.001, T_RP_MATCHES_RCVD=-0.01] autolearn=disabled
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd4-us-west.apache.org [10.40.0.11]) (amavisd-new, port 10024)
	with ESMTP id q-Ruw2DqrAvS for <dev@httpd.apache.org>;
	Mon, 26 Oct 2015 09:12:01 +0000 (UTC)
Received: from monica.sharp.fm (monica.sharp.fm [80.168.143.5])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTP id CE75620604
	for <dev@httpd.apache.org>; Mon, 26 Oct 2015 09:12:00 +0000 (UTC)
Received: from [192.168.220.234] (unknown [192.168.220.234])
	(using TLSv1 with cipher DHE-RSA-AES256-SHA (256/256 bits))
	(Client did not present a certificate)
	(Authenticated sender: minfrin@sharp.fm)
	by monica.sharp.fm (Postfix) with ESMTPSA id 5E7EC80BC7
	for <dev@httpd.apache.org>; Mon, 26 Oct 2015 09:11:54 +0000 (GMT)
Content-Type: text/plain; charset=utf-8
Mime-Version: 1.0 (Mac OS X Mail 8.2 \(2104\))
Subject: Re: Question about CACHE_SEPARATOR in modules/cache/cache_util.h
From: Graham Leggett <minfrin@sharp.fm>
In-Reply-To: <n0kjcg$nu9$1@ger.gmane.org>
Date: Mon, 26 Oct 2015 11:11:53 +0200
Content-Transfer-Encoding: quoted-printable
Message-Id: <2F0F1428-539D-48AB-94B1-CB3FC739797B@sharp.fm>
References: <n0kjcg$nu9$1@ger.gmane.org>
To: dev@httpd.apache.org
X-Mailer: Apple Mail (2.2104)

On 26 Oct 2015, at 9:05 AM, Christophe JAILLET =
<christophe.jaillet@wanadoo.fr> wrote:

> in modules/cache/cache_util.h, CACHE_SEPARATOR is defined as:
>=20
>     #define CACHE_SEPARATOR ",   "
>=20
>=20
> I don't see any reason to have 3 spaces here.
> It is only used within calls to 'cache_strqtok' and scanning 3 times =
for the same thing is just a waste of time.
>=20
> Did I miss something obvious, or can it be turned in:
>=20
>     #define CACHE_SEPARATOR ", =E2=80=9C

Double check whether the spaces are significant, it might be a space and =
a tab (which would be weird, because it should just say /t then).

This might have RFC compliance issues if it was changed, we need to =
verify what the code does.

Regards,
Graham
=E2=80=94


From dev-return-84451-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Mon Oct 26 11:14:39 2015
Return-Path: <dev-return-84451-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 9A21E18788
	for <apmail-httpd-dev-archive@www.apache.org>; Mon, 26 Oct 2015 11:14:39 +0000 (UTC)
Received: (qmail 19410 invoked by uid 500); 26 Oct 2015 11:14:31 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 19351 invoked by uid 500); 26 Oct 2015 11:14:31 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 19341 invoked by uid 99); 26 Oct 2015 11:14:31 -0000
Received: from Unknown (HELO spamd4-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 26 Oct 2015 11:14:31 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd4-us-west.apache.org (ASF Mail Server at spamd4-us-west.apache.org) with ESMTP id C54ECC0720
	for <dev@httpd.apache.org>; Mon, 26 Oct 2015 11:14:30 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd4-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 1.363
X-Spam-Level: *
X-Spam-Status: No, score=1.363 tagged_above=-999 required=6.31
	tests=[KAM_LAZY_DOMAIN_SECURITY=1, RDNS_DYNAMIC=0.363]
	autolearn=disabled
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd4-us-west.apache.org [10.40.0.11]) (amavisd-new, port 10024)
	with ESMTP id x8o9FshRVxqm for <dev@httpd.apache.org>;
	Mon, 26 Oct 2015 11:14:26 +0000 (UTC)
Received: from gungnir.webthing.com (209-20-83-52.slicehost.net [209.20.83.52])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTP id 74AA520B66
	for <dev@httpd.apache.org>; Mon, 26 Oct 2015 11:14:25 +0000 (UTC)
Received: from [192.168.0.127] (cpc36-newt30-2-0-cust898.19-3.cable.virginm.net [82.32.195.131])
	by gungnir.webthing.com (Postfix) with ESMTPSA id 85F97E8C51
	for <dev@httpd.apache.org>; Mon, 26 Oct 2015 11:14:18 +0000 (UTC)
Message-ID: <1445858056.3909.113.camel@mimir.webthing.com>
Subject: Re: Improve Apache performance on high load (prefork MPM) with
 multiple Accept mutexes (Patch attached)
From: Nick Kew <nick@webthing.com>
To: dev@httpd.apache.org
Date: Mon, 26 Oct 2015 11:14:16 +0000
In-Reply-To: <6A49427F0EB5B44F9F1006B09A0A28F4F8B0B3E3@IL-EX10.ad.checkpoint.com>
References: 
	<6A49427F0EB5B44F9F1006B09A0A28F4F8B0B3E3@IL-EX10.ad.checkpoint.com>
Content-Type: text/plain; charset="UTF-8"
X-Mailer: Evolution 3.4.4-3 
Mime-Version: 1.0
Content-Transfer-Encoding: 8bit

On Mon, 2015-10-26 at 08:45 +0000, Yehezkel Horowitz wrote:
> Any chance someone could take a short look and provide me a feedback
> (of any kind)?

A patch posted here may get lost, especially if it's
not simple and obvious enough for instant review and
understanding.  Posting it as an Enhancement request
in Bugzilla would leave a record of it.

> 1.      Do you think this is a good implementation of the suggested
> idea? 

If a threaded MPM really isn't an option (for most users the
obvious solution), then the question is what works for you.

> 3.      Would you consider accepting this patch to the project? 
> If so, could you guide me what else needs to be done for acceptances?
> I know there is a need for configuration & documentation work - I’ll
> work on once the patch will be approved…

Unlikely it would get in to a future 2.2 release unless it
fixed something much more than an arcane performance problem
(arcane because because it only happens when you reject
conventional ways to boost performance, like another MPM). 

How well does your patch apply to trunk?

If you don't want to go in that direction, you could
post somewhere always available for anyone interested.
Our bugzilla would serve, as would somewhere else you
publish from, like github or a personal site.

-- 
Nick Kew



From dev-return-84452-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Mon Oct 26 11:27:33 2015
Return-Path: <dev-return-84452-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id EC9DB18893
	for <apmail-httpd-dev-archive@www.apache.org>; Mon, 26 Oct 2015 11:27:33 +0000 (UTC)
Received: (qmail 62699 invoked by uid 500); 26 Oct 2015 11:27:33 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 62623 invoked by uid 500); 26 Oct 2015 11:27:33 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 62613 invoked by uid 99); 26 Oct 2015 11:27:33 -0000
Received: from Unknown (HELO spamd4-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 26 Oct 2015 11:27:33 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd4-us-west.apache.org (ASF Mail Server at spamd4-us-west.apache.org) with ESMTP id B6609C0720
	for <dev@httpd.apache.org>; Mon, 26 Oct 2015 11:27:32 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd4-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 2.991
X-Spam-Level: **
X-Spam-Status: No, score=2.991 tagged_above=-999 required=6.31
	tests=[HTML_MESSAGE=3, T_RP_MATCHES_RCVD=-0.01, URIBL_BLOCKED=0.001]
	autolearn=disabled
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd4-us-west.apache.org [10.40.0.11]) (amavisd-new, port 10024)
	with ESMTP id HrDvI3B2TJOi for <dev@httpd.apache.org>;
	Mon, 26 Oct 2015 11:27:19 +0000 (UTC)
Received: from monica.sharp.fm (monica.sharp.fm [80.168.143.5])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTP id EB85F20CB7
	for <dev@httpd.apache.org>; Mon, 26 Oct 2015 11:27:18 +0000 (UTC)
Received: from [10.105.13.220] (unknown [5.56.169.82])
	(using TLSv1 with cipher DHE-RSA-AES256-SHA (256/256 bits))
	(Client did not present a certificate)
	(Authenticated sender: minfrin@sharp.fm)
	by monica.sharp.fm (Postfix) with ESMTPSA id 94F6680BC7
	for <dev@httpd.apache.org>; Mon, 26 Oct 2015 11:27:18 +0000 (GMT)
From: Graham Leggett <minfrin@sharp.fm>
Content-Type: multipart/alternative; boundary="Apple-Mail=_97588727-2492-45C3-8B05-E24F03E8BB2D"
Message-Id: <E55B3A8D-3FB3-47CE-8937-162CF265F115@sharp.fm>
Mime-Version: 1.0 (Mac OS X Mail 8.2 \(2104\))
Subject: Re: Improve Apache performance on high load (prefork MPM) with multiple Accept mutexes (Patch attached)
Date: Mon, 26 Oct 2015 13:27:17 +0200
References: <6A49427F0EB5B44F9F1006B09A0A28F4F8B0B3E3@IL-EX10.ad.checkpoint.com>
To: dev@httpd.apache.org
In-Reply-To: <6A49427F0EB5B44F9F1006B09A0A28F4F8B0B3E3@IL-EX10.ad.checkpoint.com>
X-Mailer: Apple Mail (2.2104)


--Apple-Mail=_97588727-2492-45C3-8B05-E24F03E8BB2D
Content-Transfer-Encoding: quoted-printable
Content-Type: text/plain;
	charset=utf-8

On 26 Oct 2015, at 10:45 AM, Yehezkel Horowitz <horowity@checkpoint.com> =
wrote:

> Any chance someone could take a short look and provide me a feedback =
(of any kind)?
> =20
> I know your focus is on 2.4 and trunk, but there are still many 2.2 =
servers out there=E2=80=A6
> =20
> Patch attached again for you convenience.=E2=80=A6

Just to clarify, all updates to httpd need to be made to trunk first, =
which then allow it to be backported to v2.4, and then v2.2.

The reason for this is we don=E2=80=99t want features added to v2.2 that =
then subsequently vanish when v2.4 comes out (and so on).

The following patch was recently backported to v2.4, how similar is your =
patch to this one?

  *) MPMs: Support SO_REUSEPORT to create multiple duplicated listener
     records for scalability. [Yingqi Lu <yingqi.lu@intel.com>,
     Jeff Trawick, Jim Jagielski, Yann Ylavic]

Regards,
Graham
=E2=80=94


--Apple-Mail=_97588727-2492-45C3-8B05-E24F03E8BB2D
Content-Transfer-Encoding: quoted-printable
Content-Type: text/html;
	charset=utf-8

<html><head><meta http-equiv=3D"Content-Type" content=3D"text/html =
charset=3Dutf-8"></head><body style=3D"word-wrap: break-word; =
-webkit-nbsp-mode: space; -webkit-line-break: after-white-space;" =
class=3D"">On 26 Oct 2015, at 10:45 AM, Yehezkel Horowitz &lt;<a =
href=3D"mailto:horowity@checkpoint.com" =
class=3D"">horowity@checkpoint.com</a>&gt; wrote:<div class=3D""><br =
class=3D""><div><blockquote type=3D"cite" class=3D""><div class=3D"">

<meta http-equiv=3D"Content-Type" content=3D"text/html; =
charset=3Dus-ascii" class=3D"">
<meta name=3D"Generator" content=3D"Microsoft Word 14 (filtered medium)" =
class=3D"">
<style class=3D""><!--
/* Font Definitions */
@font-face
	{font-family:Calibri;
	panose-1:2 15 5 2 2 2 4 3 2 4;}
@font-face
	{font-family:Tahoma;
	panose-1:2 11 6 4 3 5 4 4 2 4;}
/* Style Definitions */
p.MsoNormal, li.MsoNormal, div.MsoNormal
	{margin:0in;
	margin-bottom:.0001pt;
	font-size:11.0pt;
	font-family:"Calibri","sans-serif";}
a:link, span.MsoHyperlink
	{mso-style-priority:99;
	color:blue;
	text-decoration:underline;}
a:visited, span.MsoHyperlinkFollowed
	{mso-style-priority:99;
	color:purple;
	text-decoration:underline;}
p.MsoListParagraph, li.MsoListParagraph, div.MsoListParagraph
	{mso-style-priority:34;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:.5in;
	margin-bottom:.0001pt;
	font-size:11.0pt;
	font-family:"Calibri","sans-serif";}
span.EmailStyle18
	{mso-style-type:personal;
	font-family:"Calibri","sans-serif";
	color:windowtext;}
span.EmailStyle19
	{mso-style-type:personal-reply;
	font-family:"Calibri","sans-serif";
	color:#1F497D;}
.MsoChpDefault
	{mso-style-type:export-only;
	font-size:10.0pt;}
@page WordSection1
	{size:8.5in 11.0in;
	margin:1.0in 1.0in 1.0in 1.0in;}
div.WordSection1
	{page:WordSection1;}
/* List Definitions */
@list l0
	{mso-list-id:1169976873;
	mso-list-type:hybrid;
	mso-list-template-ids:1360162746 67698703 67698713 67698715 =
67698703 67698713 67698715 67698703 67698713 67698715;}
@list l0:level1
	{mso-level-tab-stop:none;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l0:level2
	{mso-level-number-format:alpha-lower;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l0:level3
	{mso-level-number-format:roman-lower;
	mso-level-tab-stop:none;
	mso-level-number-position:right;
	text-indent:-9.0pt;}
@list l0:level4
	{mso-level-tab-stop:none;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l0:level5
	{mso-level-number-format:alpha-lower;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l0:level6
	{mso-level-number-format:roman-lower;
	mso-level-tab-stop:none;
	mso-level-number-position:right;
	text-indent:-9.0pt;}
@list l0:level7
	{mso-level-tab-stop:none;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l0:level8
	{mso-level-number-format:alpha-lower;
	mso-level-tab-stop:none;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l0:level9
	{mso-level-number-format:roman-lower;
	mso-level-tab-stop:none;
	mso-level-number-position:right;
	text-indent:-9.0pt;}
ol
	{margin-bottom:0in;}
ul
	{margin-bottom:0in;}
--></style><!--[if gte mso 9]><xml>
<o:shapedefaults v:ext=3D"edit" spidmax=3D"1026" />
</xml><![endif]--><!--[if gte mso 9]><xml>
<o:shapelayout v:ext=3D"edit">
<o:idmap v:ext=3D"edit" data=3D"1" />
</o:shapelayout></xml><![endif]-->

<div lang=3D"EN-US" link=3D"blue" vlink=3D"purple" class=3D"">
<div class=3D"WordSection1"><p class=3D"MsoNormal"><span =
style=3D"color:#1F497D" class=3D"">Any chance someone could take a short =
look and provide me a feedback (of any kind)?<o:p =
class=3D""></o:p></span></p><p class=3D"MsoNormal"><span =
style=3D"color:#1F497D" class=3D"">&nbsp;</span></p><p =
class=3D"MsoNormal"><span style=3D"color:#1F497D" class=3D"">I know your =
focus is on 2.4 and trunk, but there are still many 2.2 servers out =
there=E2=80=A6<o:p class=3D""></o:p></span></p><p =
class=3D"MsoNormal"><span style=3D"color:#1F497D" =
class=3D"">&nbsp;</span></p><p class=3D"MsoNormal"><span =
style=3D"color:#1F497D" class=3D"">Patch attached again for you =
convenience.=E2=80=A6</span></p></div></div></div></blockquote><div><br =
class=3D""></div><div>Just to clarify, all updates to httpd need to be =
made to trunk first, which then allow it to be backported to v2.4, and =
then v2.2.</div><div><br class=3D""></div><div>The reason for this is we =
don=E2=80=99t want features added to v2.2 that then subsequently vanish =
when v2.4 comes out (and so on).</div><div><br class=3D""></div><div>The =
following patch was recently backported to v2.4, how similar is your =
patch to this one?</div><div><br class=3D""></div><div><div =
style=3D"margin: 0px; font-size: 10px; font-family: Monaco;" =
class=3D""><div style=3D"margin: 0px;" class=3D"">&nbsp;&nbsp;*) MPMs: =
Support SO_REUSEPORT to create multiple duplicated listener</div><div =
style=3D"margin: 0px;" class=3D"">&nbsp;&nbsp; &nbsp; records for =
scalability. [Yingqi Lu &lt;<a href=3D"mailto:yingqi.lu@intel.com" =
class=3D"">yingqi.lu@intel.com</a>&gt;,</div><div style=3D"margin: 0px;" =
class=3D"">&nbsp;&nbsp; &nbsp; Jeff Trawick, Jim Jagielski, Yann =
Ylavic]</div><div class=3D""><br class=3D""></div></div><div =
class=3D"">Regards,</div><div class=3D"">Graham</div><div =
class=3D"">=E2=80=94</div><div class=3D""><br =
class=3D""></div></div></div></div></body></html>=

--Apple-Mail=_97588727-2492-45C3-8B05-E24F03E8BB2D--

From dev-return-84453-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Mon Oct 26 11:37:35 2015
Return-Path: <dev-return-84453-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 29F42188E8
	for <apmail-httpd-dev-archive@www.apache.org>; Mon, 26 Oct 2015 11:37:35 +0000 (UTC)
Received: (qmail 80667 invoked by uid 500); 26 Oct 2015 11:37:34 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 80580 invoked by uid 500); 26 Oct 2015 11:37:34 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 80570 invoked by uid 99); 26 Oct 2015 11:37:34 -0000
Received: from Unknown (HELO spamd3-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 26 Oct 2015 11:37:34 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd3-us-west.apache.org (ASF Mail Server at spamd3-us-west.apache.org) with ESMTP id 2F976180F5B
	for <dev@httpd.apache.org>; Mon, 26 Oct 2015 11:37:34 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd3-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.031
X-Spam-Level:
X-Spam-Status: No, score=-0.031 tagged_above=-999 required=6.31
	tests=[RCVD_IN_MSPIKE_H3=-0.01, RCVD_IN_MSPIKE_WL=-0.01,
	SPF_PASS=-0.001, T_RP_MATCHES_RCVD=-0.01] autolearn=disabled
Received: from mx1-us-west.apache.org ([10.40.0.8])
	by localhost (spamd3-us-west.apache.org [10.40.0.10]) (amavisd-new, port 10024)
	with ESMTP id 92iyocGudd6Y for <dev@httpd.apache.org>;
	Mon, 26 Oct 2015 11:37:27 +0000 (UTC)
Received: from smtp.checkpoint.com (smtp.checkpoint.com [194.29.34.68])
	by mx1-us-west.apache.org (ASF Mail Server at mx1-us-west.apache.org) with ESMTPS id EC6B223057
	for <dev@httpd.apache.org>; Mon, 26 Oct 2015 11:37:26 +0000 (UTC)
x-m-msg: CPCHECK
Received: from DAG-EX10.ad.checkpoint.com ([194.29.34.150])
	by smtp.checkpoint.com (8.13.8/8.13.8) with ESMTP id t9QBbOEe024947
	for <dev@httpd.apache.org>; Mon, 26 Oct 2015 13:37:24 +0200
Received: from IL-EX10.ad.checkpoint.com ([169.254.2.36]) by
 DAG-EX10.ad.checkpoint.com ([169.254.3.11]) with mapi id 14.03.0248.002; Mon,
 26 Oct 2015 13:37:24 +0200
From: Yehezkel Horowitz <horowity@checkpoint.com>
To: "dev@httpd.apache.org" <dev@httpd.apache.org>
Subject: RE: Improve Apache performance on high load (prefork MPM) with
 multiple Accept mutexes (Patch attached)
Thread-Topic: Improve Apache performance on high load (prefork MPM) with
 multiple Accept mutexes (Patch attached)
Thread-Index: AdEKfWuZhdmjohBKS/yAuQ98J4a/oQFTL8YQAAEhUAAABJta4A==
Date: Mon, 26 Oct 2015 11:37:23 +0000
Message-ID: <6A49427F0EB5B44F9F1006B09A0A28F4F8B0B591@IL-EX10.ad.checkpoint.com>
References: <6A49427F0EB5B44F9F1006B09A0A28F4F8B0B3E3@IL-EX10.ad.checkpoint.com>
 <1445858056.3909.113.camel@mimir.webthing.com>
In-Reply-To: <1445858056.3909.113.camel@mimir.webthing.com>
Accept-Language: en-US
Content-Language: en-US
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
x-originating-ip: [194.29.34.193]
x-kse-antivirus-interceptor-info: scan successful
x-kse-antivirus-info: Clean
x-cpdlp: 11d9d90ccb0fbb6e246250c7eef1a536bee69f10b7
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
MIME-Version: 1.0

Rmlyc3QsIHRoYW5rcyBOaWNrIGZvciB0aGUgZmVlZGJhY2suDQoNCkkgaGF2ZSBzdWJtaXR0ZWQg
aHR0cHM6Ly9iei5hcGFjaGUub3JnL2J1Z3ppbGxhL3Nob3dfYnVnLmNnaT9pZD01ODU1MCBhcyB5
b3Ugc3VnZ2VzdGVkLg0KDQo+SWYgYSB0aHJlYWRlZCBNUE0gcmVhbGx5IGlzbid0IGFuIG9wdGlv
biAoZm9yIG1vc3QgdXNlcnMgdGhlIG9idmlvdXMgc29sdXRpb24pLCB0aGVuIHRoZSBxdWVzdGlv
biBpcyB3aGF0IHdvcmtzIGZvciB5b3UuDQoNCkkgY2FuJ3QgdXNlIHRocmVhZGVkIE1QTSBhcyBQ
SFAgKGF0IGxlYXN0IG15IHZlcnNpb24pIGRvZXNuJ3Qgc3VwcG9ydCBpdC4gDQoNClRoZSBwYXRj
aCB3b3JrZWQgZm9yIG1lIHZlcnkgd2VsbCwgYnV0IEknbSBub3Qgc3VyZSBJIGRpZG4ndCBtaXNz
ZWQgc29tZSBwaXRmYWxscywgd2hpY2ggc29tZW9uZSB3aXRoIG11Y2ggbW9yZSBrbm93bGVkZ2Ug
YWJvdXQgQXBhY2hlIGludGVybmFscyAoc3BlY2lhbGx5IG9uIExpbnV4KSB3aWxsIGVhc2lseSBz
ZWUuDQoNCj5Ib3cgd2VsbCBkb2VzIHlvdXIgcGF0Y2ggYXBwbHkgdG8gdHJ1bms/DQpZb3UgY2Fu
J3QgYXBwbHkgbXkgcGF0Y2ggdG8gMi40IG9yIHRydW5rLCBhcyBzaW5jZSAyLjQgdGhlcmUgaXMg
YSAicHJlZm9ya19jaGlsZF9idWNrZXQiIGNvbmNlcHQsIHdoaWNoIEkgZG9uJ3QgZnVsbHkgdW5k
ZXJzdGFuZCBpdHMgcm9sZSAoYW5kIGhvdyBpdCByZWxhdGUgdG8gb3RoZXIgTVBNcykuDQoNCkkn
bGwgYmUgaGFwcHkgdG8gd3JpdGUgYW4gdXBkYXRlZCBwYXRjaCBpZiBzb21lb25lIGNvdWxkIGV4
cGxhaW4gbWUgdGhlIHJvbGUgb2YgdGhlICJwcmVmb3JrX2NoaWxkX2J1Y2tldCIuDQoNClJlZ2Fy
ZHMsDQoNClllaGV6a2VsIEhvcm93aXR6DQpDaGVjayBQb2ludCBTb2Z0d2FyZSBUZWNobm9sb2dp
ZXMgTHRkLg0K

From dev-return-84454-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Mon Oct 26 11:45:36 2015
Return-Path: <dev-return-84454-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id DB3031892F
	for <apmail-httpd-dev-archive@www.apache.org>; Mon, 26 Oct 2015 11:45:35 +0000 (UTC)
Received: (qmail 3040 invoked by uid 500); 26 Oct 2015 11:45:22 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 2967 invoked by uid 500); 26 Oct 2015 11:45:22 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 2957 invoked by uid 99); 26 Oct 2015 11:45:22 -0000
Received: from Unknown (HELO spamd3-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 26 Oct 2015 11:45:22 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd3-us-west.apache.org (ASF Mail Server at spamd3-us-west.apache.org) with ESMTP id 61DA1180F5B
	for <dev@httpd.apache.org>; Mon, 26 Oct 2015 11:45:22 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd3-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 2.97
X-Spam-Level: **
X-Spam-Status: No, score=2.97 tagged_above=-999 required=6.31
	tests=[HTML_MESSAGE=3, RCVD_IN_MSPIKE_H3=-0.01,
	RCVD_IN_MSPIKE_WL=-0.01, SPF_PASS=-0.001, T_RP_MATCHES_RCVD=-0.01,
	URIBL_BLOCKED=0.001] autolearn=disabled
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd3-us-west.apache.org [10.40.0.10]) (amavisd-new, port 10024)
	with ESMTP id 9IjwQ3O_ijb9 for <dev@httpd.apache.org>;
	Mon, 26 Oct 2015 11:45:11 +0000 (UTC)
Received: from smtp.checkpoint.com (smtp.checkpoint.com [194.29.34.68])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id 7AB0C20F4F
	for <dev@httpd.apache.org>; Mon, 26 Oct 2015 11:45:09 +0000 (UTC)
x-m-msg: CPCHECK
Received: from DAG-EX10.ad.checkpoint.com ([194.29.34.150])
	by smtp.checkpoint.com (8.13.8/8.13.8) with ESMTP id t9QBj7ti028958
	for <dev@httpd.apache.org>; Mon, 26 Oct 2015 13:45:07 +0200
Received: from IL-EX10.ad.checkpoint.com ([169.254.2.36]) by
 DAG-EX10.ad.checkpoint.com ([169.254.3.11]) with mapi id 14.03.0248.002; Mon,
 26 Oct 2015 13:45:07 +0200
From: Yehezkel Horowitz <horowity@checkpoint.com>
To: "dev@httpd.apache.org" <dev@httpd.apache.org>
Subject: RE: Improve Apache performance on high load (prefork MPM) with
 multiple Accept mutexes (Patch attached)
Thread-Topic: Improve Apache performance on high load (prefork MPM) with
 multiple Accept mutexes (Patch attached)
Thread-Index: AdEKfWuZhdmjohBKS/yAuQ98J4a/oQFTL8YQAAGVsYAABKV8YA==
Date: Mon, 26 Oct 2015 11:45:07 +0000
Message-ID: <6A49427F0EB5B44F9F1006B09A0A28F4F8B0B5A4@IL-EX10.ad.checkpoint.com>
References: <6A49427F0EB5B44F9F1006B09A0A28F4F8B0B3E3@IL-EX10.ad.checkpoint.com>
 <E55B3A8D-3FB3-47CE-8937-162CF265F115@sharp.fm>
In-Reply-To: <E55B3A8D-3FB3-47CE-8937-162CF265F115@sharp.fm>
Accept-Language: en-US
Content-Language: en-US
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
x-originating-ip: [194.29.34.193]
x-kse-antivirus-interceptor-info: scan successful
x-kse-antivirus-info: Clean
x-cpdlp: 11d4b98dd2d24c703b080c5ac8b0b04179630e01d4
Content-Type: multipart/alternative;
	boundary="_000_6A49427F0EB5B44F9F1006B09A0A28F4F8B0B5A4ILEX10adcheckpo_"
MIME-Version: 1.0

--_000_6A49427F0EB5B44F9F1006B09A0A28F4F8B0B5A4ILEX10adcheckpo_
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64

Pkp1c3QgdG8gY2xhcmlmeSwgYWxsIHVwZGF0ZXMgdG8gaHR0cGQgbmVlZCB0byBiZSBtYWRlIHRv
IHRydW5rIGZpcnN0LCB3aGljaCB0aGVuIGFsbG93IGl0IHRvIGJlIGJhY2twb3J0ZWQgdG8gdjIu
NCwgYW5kIHRoZW4gdjIuMi4NCj5UaGUgcmVhc29uIGZvciB0aGlzIGlzIHdlIGRvbuKAmXQgd2Fu
dCBmZWF0dXJlcyBhZGRlZCB0byB2Mi4yIHRoYXQgdGhlbiBzdWJzZXF1ZW50bHkgdmFuaXNoIHdo
ZW4gdjIuNCBjb21lcyBvdXQgKGFuZCBzbyBvbikuDQoNClVuZGVyc3Rvb2QuIEkganVzdCB3YW50
IHRvIGdldCBzb21lIGZlZWRiYWNrIGFib3V0IG15IGluaXRpYWwgaW1wbGVtZW50YXRpb24uDQpJ
ZiB0aGVyZSB3aWxsIGJlIGludGVyZXN0IOKAkyBJ4oCZbGwgYmUgZ2xhZCB0byB3cml0ZSBhbiB1
cGRhdGVkIHBhdGNoIHRvIGJlIGFwcGxpZWQgdG8gdHJ1bmsuDQoNCj5UaGUgZm9sbG93aW5nIHBh
dGNoIHdhcyByZWNlbnRseSBiYWNrcG9ydGVkIHRvIHYyLjQsIGhvdyBzaW1pbGFyIGlzIHlvdXIg
cGF0Y2ggdG8gdGhpcyBvbmU/DQo+ICopIE1QTXM6IFN1cHBvcnQgU09fUkVVU0VQT1JUIHRvIGNy
ZWF0ZSBtdWx0aXBsZSBkdXBsaWNhdGVkIGxpc3RlbmVyDQogICAgIHJlY29yZHMgZm9yIHNjYWxh
YmlsaXR5LiBbWWluZ3FpIEx1IDx5aW5ncWkubHVAaW50ZWwuY29tPG1haWx0bzp5aW5ncWkubHVA
aW50ZWwuY29tPj4sDQogICAgIEplZmYgVHJhd2ljaywgSmltIEphZ2llbHNraSwgWWFubiBZbGF2
aWNdDQpCb3RoIHBhdGNoZXMgbWlnaHQgY29tZSB0byBzb2x2ZSBzaW1pbGFyIHByb2JsZW0sIGJ1
dCBTT19SRVVTRVBPUlQgcmVxdWlyZXMgTGludXggMy45ICh3aGljaCBpcyBxdWl0ZSBuZXcgaW4g
TGludXggdGVybXMpLg0KDQpUaGFua3MgZm9yIHRoZSBmZWVkYmFjaywNCg0KWWVoZXprZWwgSG9y
b3dpdHoNCkNoZWNrIFBvaW50IFNvZnR3YXJlIFRlY2hub2xvZ2llcyBMdGQuDQo=

--_000_6A49427F0EB5B44F9F1006B09A0A28F4F8B0B5A4ILEX10adcheckpo_
Content-Type: text/html; charset="utf-8"
Content-Transfer-Encoding: base64

PGh0bWwgeG1sbnM6dj0idXJuOnNjaGVtYXMtbWljcm9zb2Z0LWNvbTp2bWwiIHhtbG5zOm89InVy
bjpzY2hlbWFzLW1pY3Jvc29mdC1jb206b2ZmaWNlOm9mZmljZSIgeG1sbnM6dz0idXJuOnNjaGVt
YXMtbWljcm9zb2Z0LWNvbTpvZmZpY2U6d29yZCIgeG1sbnM6bT0iaHR0cDovL3NjaGVtYXMubWlj
cm9zb2Z0LmNvbS9vZmZpY2UvMjAwNC8xMi9vbW1sIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcv
VFIvUkVDLWh0bWw0MCI+DQo8aGVhZD4NCjxtZXRhIGh0dHAtZXF1aXY9IkNvbnRlbnQtVHlwZSIg
Y29udGVudD0idGV4dC9odG1sOyBjaGFyc2V0PXV0Zi04Ij4NCjxtZXRhIG5hbWU9IkdlbmVyYXRv
ciIgY29udGVudD0iTWljcm9zb2Z0IFdvcmQgMTQgKGZpbHRlcmVkIG1lZGl1bSkiPg0KPHN0eWxl
PjwhLS0NCi8qIEZvbnQgRGVmaW5pdGlvbnMgKi8NCkBmb250LWZhY2UNCgl7Zm9udC1mYW1pbHk6
Q2FsaWJyaTsNCglwYW5vc2UtMToyIDE1IDUgMiAyIDIgNCAzIDIgNDt9DQpAZm9udC1mYWNlDQoJ
e2ZvbnQtZmFtaWx5Ok1vbmFjbzsNCglwYW5vc2UtMTowIDAgMCAwIDAgMCAwIDAgMCAwO30NCi8q
IFN0eWxlIERlZmluaXRpb25zICovDQpwLk1zb05vcm1hbCwgbGkuTXNvTm9ybWFsLCBkaXYuTXNv
Tm9ybWFsDQoJe21hcmdpbjowaW47DQoJbWFyZ2luLWJvdHRvbTouMDAwMXB0Ow0KCWZvbnQtc2l6
ZToxMS4wcHQ7DQoJZm9udC1mYW1pbHk6IkNhbGlicmkiLCJzYW5zLXNlcmlmIjt9DQphOmxpbmss
IHNwYW4uTXNvSHlwZXJsaW5rDQoJe21zby1zdHlsZS1wcmlvcml0eTo5OTsNCgljb2xvcjpibHVl
Ow0KCXRleHQtZGVjb3JhdGlvbjp1bmRlcmxpbmU7fQ0KYTp2aXNpdGVkLCBzcGFuLk1zb0h5cGVy
bGlua0ZvbGxvd2VkDQoJe21zby1zdHlsZS1wcmlvcml0eTo5OTsNCgljb2xvcjpwdXJwbGU7DQoJ
dGV4dC1kZWNvcmF0aW9uOnVuZGVybGluZTt9DQpwLk1zb0xpc3RQYXJhZ3JhcGgsIGxpLk1zb0xp
c3RQYXJhZ3JhcGgsIGRpdi5Nc29MaXN0UGFyYWdyYXBoDQoJe21zby1zdHlsZS1wcmlvcml0eToz
NDsNCgltYXJnaW4tdG9wOjBpbjsNCgltYXJnaW4tcmlnaHQ6MGluOw0KCW1hcmdpbi1ib3R0b206
MGluOw0KCW1hcmdpbi1sZWZ0Oi41aW47DQoJbWFyZ2luLWJvdHRvbTouMDAwMXB0Ow0KCWZvbnQt
c2l6ZToxMS4wcHQ7DQoJZm9udC1mYW1pbHk6IkNhbGlicmkiLCJzYW5zLXNlcmlmIjt9DQpzcGFu
LkVtYWlsU3R5bGUxOA0KCXttc28tc3R5bGUtdHlwZTpwZXJzb25hbDsNCglmb250LWZhbWlseToi
Q2FsaWJyaSIsInNhbnMtc2VyaWYiOw0KCWNvbG9yOndpbmRvd3RleHQ7fQ0Kc3Bhbi5FbWFpbFN0
eWxlMTkNCgl7bXNvLXN0eWxlLXR5cGU6cGVyc29uYWw7DQoJZm9udC1mYW1pbHk6IkNhbGlicmki
LCJzYW5zLXNlcmlmIjsNCgljb2xvcjojMUY0OTdEO30NCnNwYW4uRW1haWxTdHlsZTIwDQoJe21z
by1zdHlsZS10eXBlOnBlcnNvbmFsLXJlcGx5Ow0KCWZvbnQtZmFtaWx5OiJDYWxpYnJpIiwic2Fu
cy1zZXJpZiI7DQoJY29sb3I6IzFGNDk3RDt9DQouTXNvQ2hwRGVmYXVsdA0KCXttc28tc3R5bGUt
dHlwZTpleHBvcnQtb25seTsNCglmb250LXNpemU6MTAuMHB0O30NCkBwYWdlIFdvcmRTZWN0aW9u
MQ0KCXtzaXplOjguNWluIDExLjBpbjsNCgltYXJnaW46MS4waW4gMS4waW4gMS4waW4gMS4waW47
fQ0KZGl2LldvcmRTZWN0aW9uMQ0KCXtwYWdlOldvcmRTZWN0aW9uMTt9DQotLT48L3N0eWxlPjwh
LS1baWYgZ3RlIG1zbyA5XT48eG1sPg0KPG86c2hhcGVkZWZhdWx0cyB2OmV4dD0iZWRpdCIgc3Bp
ZG1heD0iMTAyNiIgLz4NCjwveG1sPjwhW2VuZGlmXS0tPjwhLS1baWYgZ3RlIG1zbyA5XT48eG1s
Pg0KPG86c2hhcGVsYXlvdXQgdjpleHQ9ImVkaXQiPg0KPG86aWRtYXAgdjpleHQ9ImVkaXQiIGRh
dGE9IjEiIC8+DQo8L286c2hhcGVsYXlvdXQ+PC94bWw+PCFbZW5kaWZdLS0+DQo8L2hlYWQ+DQo8
Ym9keSBsYW5nPSJFTi1VUyIgbGluaz0iYmx1ZSIgdmxpbms9InB1cnBsZSI+DQo8ZGl2IGNsYXNz
PSJXb3JkU2VjdGlvbjEiPg0KPHAgY2xhc3M9Ik1zb05vcm1hbCI+PHNwYW4gc3R5bGU9ImZvbnQt
c2l6ZToxMi4wcHQ7Zm9udC1mYW1pbHk6JnF1b3Q7VGltZXMgTmV3IFJvbWFuJnF1b3Q7LCZxdW90
O3NlcmlmJnF1b3Q7O2NvbG9yOiMxRjQ5N0QiPiZndDs8L3NwYW4+PHNwYW4gc3R5bGU9ImZvbnQt
c2l6ZToxMi4wcHQ7Zm9udC1mYW1pbHk6JnF1b3Q7VGltZXMgTmV3IFJvbWFuJnF1b3Q7LCZxdW90
O3NlcmlmJnF1b3Q7Ij5KdXN0IHRvIGNsYXJpZnksIGFsbCB1cGRhdGVzIHRvIGh0dHBkIG5lZWQg
dG8gYmUgbWFkZSB0byB0cnVuayBmaXJzdCwgd2hpY2gNCiB0aGVuIGFsbG93IGl0IHRvIGJlIGJh
Y2twb3J0ZWQgdG8gdjIuNCwgYW5kIHRoZW4gdjIuMi48bzpwPjwvbzpwPjwvc3Bhbj48L3A+DQo8
ZGl2Pg0KPHAgY2xhc3M9Ik1zb05vcm1hbCI+PHNwYW4gc3R5bGU9ImZvbnQtc2l6ZToxMi4wcHQ7
Zm9udC1mYW1pbHk6JnF1b3Q7VGltZXMgTmV3IFJvbWFuJnF1b3Q7LCZxdW90O3NlcmlmJnF1b3Q7
O2NvbG9yOiMxRjQ5N0QiPiZndDs8L3NwYW4+PHNwYW4gc3R5bGU9ImZvbnQtc2l6ZToxMi4wcHQ7
Zm9udC1mYW1pbHk6JnF1b3Q7VGltZXMgTmV3IFJvbWFuJnF1b3Q7LCZxdW90O3NlcmlmJnF1b3Q7
Ij5UaGUgcmVhc29uIGZvciB0aGlzIGlzIHdlIGRvbuKAmXQgd2FudCBmZWF0dXJlcyBhZGRlZCB0
byB2Mi4yIHRoYXQgdGhlbiBzdWJzZXF1ZW50bHkNCiB2YW5pc2ggd2hlbiB2Mi40IGNvbWVzIG91
dCAoYW5kIHNvIG9uKS48bzpwPjwvbzpwPjwvc3Bhbj48L3A+DQo8L2Rpdj4NCjxkaXY+DQo8cCBj
bGFzcz0iTXNvTm9ybWFsIj48c3BhbiBzdHlsZT0iZm9udC1zaXplOjEyLjBwdDtmb250LWZhbWls
eTomcXVvdDtUaW1lcyBOZXcgUm9tYW4mcXVvdDssJnF1b3Q7c2VyaWYmcXVvdDs7Y29sb3I6IzFG
NDk3RCI+PG86cD4mbmJzcDs8L286cD48L3NwYW4+PC9wPg0KPHAgY2xhc3M9Ik1zb05vcm1hbCI+
PHNwYW4gc3R5bGU9ImNvbG9yOiMxRjQ5N0QiPlVuZGVyc3Rvb2QuIEkganVzdCB3YW50IHRvIGdl
dCBzb21lIGZlZWRiYWNrIGFib3V0IG15IGluaXRpYWwgaW1wbGVtZW50YXRpb24uDQo8bzpwPjwv
bzpwPjwvc3Bhbj48L3A+DQo8cCBjbGFzcz0iTXNvTm9ybWFsIj48c3BhbiBzdHlsZT0iY29sb3I6
IzFGNDk3RCI+SWYgdGhlcmUgd2lsbCBiZSBpbnRlcmVzdCDigJMgSeKAmWxsIGJlIGdsYWQgdG8g
d3JpdGUgYW4gdXBkYXRlZCBwYXRjaCB0byBiZSBhcHBsaWVkIHRvIHRydW5rLjxvOnA+PC9vOnA+
PC9zcGFuPjwvcD4NCjxwIGNsYXNzPSJNc29Ob3JtYWwiPjxzcGFuIHN0eWxlPSJjb2xvcjojMUY0
OTdEIj48bzpwPiZuYnNwOzwvbzpwPjwvc3Bhbj48L3A+DQo8L2Rpdj4NCjxkaXY+DQo8cCBjbGFz
cz0iTXNvTm9ybWFsIj48c3BhbiBzdHlsZT0iZm9udC1zaXplOjEyLjBwdDtmb250LWZhbWlseTom
cXVvdDtUaW1lcyBOZXcgUm9tYW4mcXVvdDssJnF1b3Q7c2VyaWYmcXVvdDs7Y29sb3I6IzFGNDk3
RCI+Jmd0Ozwvc3Bhbj48c3BhbiBzdHlsZT0iZm9udC1zaXplOjEyLjBwdDtmb250LWZhbWlseTom
cXVvdDtUaW1lcyBOZXcgUm9tYW4mcXVvdDssJnF1b3Q7c2VyaWYmcXVvdDsiPlRoZSBmb2xsb3dp
bmcgcGF0Y2ggd2FzIHJlY2VudGx5IGJhY2twb3J0ZWQgdG8gdjIuNCwgaG93IHNpbWlsYXIgaXMg
eW91ciBwYXRjaA0KIHRvIHRoaXMgb25lPzxvOnA+PC9vOnA+PC9zcGFuPjwvcD4NCjwvZGl2Pg0K
PGRpdj4NCjxkaXY+DQo8ZGl2Pg0KPHAgY2xhc3M9Ik1zb05vcm1hbCI+PHNwYW4gc3R5bGU9ImZv
bnQtc2l6ZToxMi4wcHQ7Zm9udC1mYW1pbHk6JnF1b3Q7VGltZXMgTmV3IFJvbWFuJnF1b3Q7LCZx
dW90O3NlcmlmJnF1b3Q7O2NvbG9yOiMxRjQ5N0QiPiZndDs8L3NwYW4+PHNwYW4gc3R5bGU9ImZv
bnQtc2l6ZTo3LjVwdDtmb250LWZhbWlseTomcXVvdDtNb25hY28mcXVvdDssJnF1b3Q7c2VyaWYm
cXVvdDsiPiZuYnNwOyopIE1QTXM6IFN1cHBvcnQgU09fUkVVU0VQT1JUIHRvIGNyZWF0ZSBtdWx0
aXBsZSBkdXBsaWNhdGVkIGxpc3RlbmVyPG86cD48L286cD48L3NwYW4+PC9wPg0KPC9kaXY+DQo8
ZGl2Pg0KPHAgY2xhc3M9Ik1zb05vcm1hbCI+PHNwYW4gc3R5bGU9ImZvbnQtc2l6ZTo3LjVwdDtm
b250LWZhbWlseTomcXVvdDtNb25hY28mcXVvdDssJnF1b3Q7c2VyaWYmcXVvdDsiPiZuYnNwOyZu
YnNwOyAmbmJzcDsgcmVjb3JkcyBmb3Igc2NhbGFiaWxpdHkuIFtZaW5ncWkgTHUgJmx0OzxhIGhy
ZWY9Im1haWx0bzp5aW5ncWkubHVAaW50ZWwuY29tIj55aW5ncWkubHVAaW50ZWwuY29tPC9hPiZn
dDssPG86cD48L286cD48L3NwYW4+PC9wPg0KPC9kaXY+DQo8ZGl2Pg0KPHAgY2xhc3M9Ik1zb05v
cm1hbCI+PHNwYW4gc3R5bGU9ImZvbnQtc2l6ZTo3LjVwdDtmb250LWZhbWlseTomcXVvdDtNb25h
Y28mcXVvdDssJnF1b3Q7c2VyaWYmcXVvdDsiPiZuYnNwOyZuYnNwOyAmbmJzcDsgSmVmZiBUcmF3
aWNrLCBKaW0gSmFnaWVsc2tpLCBZYW5uIFlsYXZpY108bzpwPjwvbzpwPjwvc3Bhbj48L3A+DQo8
cCBjbGFzcz0iTXNvTm9ybWFsIj48c3BhbiBzdHlsZT0iY29sb3I6IzFGNDk3RCI+Qm90aCBwYXRj
aGVzIG1pZ2h0IGNvbWUgdG8gc29sdmUgc2ltaWxhciBwcm9ibGVtLCBidXQNCjwvc3Bhbj48c3Bh
biBzdHlsZT0iZm9udC1zaXplOjcuNXB0O2ZvbnQtZmFtaWx5OiZxdW90O01vbmFjbyZxdW90Oywm
cXVvdDtzZXJpZiZxdW90OyI+U09fUkVVU0VQT1JUIDwvc3Bhbj4NCjxzcGFuIHN0eWxlPSJjb2xv
cjojMUY0OTdEIj5yZXF1aXJlcyBMaW51eCAzLjkgKHdoaWNoIGlzIHF1aXRlIG5ldyBpbiBMaW51
eCB0ZXJtcykuPG86cD48L286cD48L3NwYW4+PC9wPg0KPHAgY2xhc3M9Ik1zb05vcm1hbCI+PHNw
YW4gc3R5bGU9ImNvbG9yOiMxRjQ5N0QiPjxvOnA+Jm5ic3A7PC9vOnA+PC9zcGFuPjwvcD4NCjxw
IGNsYXNzPSJNc29Ob3JtYWwiPjxzcGFuIHN0eWxlPSJjb2xvcjojMUY0OTdEIj5UaGFua3MgZm9y
IHRoZSBmZWVkYmFjayw8bzpwPjwvbzpwPjwvc3Bhbj48L3A+DQo8cCBjbGFzcz0iTXNvTm9ybWFs
Ij48c3BhbiBzdHlsZT0iY29sb3I6IzFGNDk3RCI+PG86cD4mbmJzcDs8L286cD48L3NwYW4+PC9w
Pg0KPHAgY2xhc3M9Ik1zb05vcm1hbCI+PHNwYW4gc3R5bGU9ImNvbG9yOiMxRjQ5N0QiPlllaGV6
a2VsIEhvcm93aXR6PG86cD48L286cD48L3NwYW4+PC9wPg0KPHAgY2xhc3M9Ik1zb05vcm1hbCI+
PHNwYW4gc3R5bGU9ImNvbG9yOiMxRjQ5N0QiPkNoZWNrIFBvaW50IFNvZnR3YXJlIFRlY2hub2xv
Z2llcyBMdGQuPG86cD48L286cD48L3NwYW4+PC9wPg0KPC9kaXY+DQo8L2Rpdj4NCjwvZGl2Pg0K
PC9kaXY+DQo8L2JvZHk+DQo8L2h0bWw+DQo=

--_000_6A49427F0EB5B44F9F1006B09A0A28F4F8B0B5A4ILEX10adcheckpo_--

From dev-return-84455-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Mon Oct 26 12:15:49 2015
Return-Path: <dev-return-84455-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 4B02C18AC3
	for <apmail-httpd-dev-archive@www.apache.org>; Mon, 26 Oct 2015 12:15:49 +0000 (UTC)
Received: (qmail 73258 invoked by uid 500); 26 Oct 2015 12:15:43 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 73194 invoked by uid 500); 26 Oct 2015 12:15:43 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 73184 invoked by uid 99); 26 Oct 2015 12:15:43 -0000
Received: from Unknown (HELO spamd4-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 26 Oct 2015 12:15:43 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd4-us-west.apache.org (ASF Mail Server at spamd4-us-west.apache.org) with ESMTP id 6824BC0720
	for <dev@httpd.apache.org>; Mon, 26 Oct 2015 12:15:43 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd4-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.011
X-Spam-Level:
X-Spam-Status: No, score=-0.011 tagged_above=-999 required=6.31
	tests=[SPF_PASS=-0.001, T_RP_MATCHES_RCVD=-0.01] autolearn=disabled
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd4-us-west.apache.org [10.40.0.11]) (amavisd-new, port 10024)
	with ESMTP id TN-l5E2JnN1N for <dev@httpd.apache.org>;
	Mon, 26 Oct 2015 12:15:42 +0000 (UTC)
Received: from mailserver.kippdata.de (capsella.kippdata.de [195.227.30.149])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTP id C058E439B6
	for <dev@httpd.apache.org>; Mon, 26 Oct 2015 12:15:41 +0000 (UTC)
Received: from [10.0.110.6] ([192.168.10.45])
	by mailserver.kippdata.de (8.13.5/8.13.5) with ESMTP id t9QCFXo3007493
	for <dev@httpd.apache.org>; Mon, 26 Oct 2015 13:15:34 +0100 (CET)
Subject: Re: Question about CACHE_SEPARATOR in modules/cache/cache_util.h
To: dev@httpd.apache.org
References: <n0kjcg$nu9$1@ger.gmane.org>
 <2F0F1428-539D-48AB-94B1-CB3FC739797B@sharp.fm>
From: Rainer Jung <rainer.jung@kippdata.de>
Message-ID: <562E195E.70107@kippdata.de>
Date: Mon, 26 Oct 2015 13:15:26 +0100
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:38.0) Gecko/20100101
 Thunderbird/38.3.0
MIME-Version: 1.0
In-Reply-To: <2F0F1428-539D-48AB-94B1-CB3FC739797B@sharp.fm>
Content-Type: text/plain; charset=utf-8; format=flowed
Content-Transfer-Encoding: 8bit

Am 26.10.2015 um 10:11 schrieb Graham Leggett:
> On 26 Oct 2015, at 9:05 AM, Christophe JAILLET <christophe.jaillet@wanadoo.fr> wrote:
>
>> in modules/cache/cache_util.h, CACHE_SEPARATOR is defined as:
>>
>>      #define CACHE_SEPARATOR ",   "
>>
>>
>> I don't see any reason to have 3 spaces here.
>> It is only used within calls to 'cache_strqtok' and scanning 3 times for the same thing is just a waste of time.
>>
>> Did I miss something obvious, or can it be turned in:
>>
>>      #define CACHE_SEPARATOR ", “
>
> Double check whether the spaces are significant, it might be a space and a tab (which would be weird, because it should just say /t then).
>
> This might have RFC compliance issues if it was changed, we need to verify what the code does.

The line goes back to

https://bz.apache.org/bugzilla/show_bug.cgi?id=50199

where Nick reported the problem and Graham provided the initial patch.

The defined tokenizer chars were "comma-space-space-space" from the 
beginning. But I think Graham pointed into the right direction, probably 
it should have been "comma-space-tab".

Regards,

Rainer

From dev-return-84456-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Mon Oct 26 12:29:10 2015
Return-Path: <dev-return-84456-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 831A718B3D
	for <apmail-httpd-dev-archive@www.apache.org>; Mon, 26 Oct 2015 12:29:10 +0000 (UTC)
Received: (qmail 92787 invoked by uid 500); 26 Oct 2015 12:29:05 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 92723 invoked by uid 500); 26 Oct 2015 12:29:04 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 92713 invoked by uid 99); 26 Oct 2015 12:29:04 -0000
Received: from Unknown (HELO spamd1-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 26 Oct 2015 12:29:04 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd1-us-west.apache.org (ASF Mail Server at spamd1-us-west.apache.org) with ESMTP id 6D2E8C57A2
	for <dev@httpd.apache.org>; Mon, 26 Oct 2015 12:28:59 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd1-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.001
X-Spam-Level:
X-Spam-Status: No, score=-0.001 tagged_above=-999 required=6.31
	tests=[RP_MATCHES_RCVD=-0.001, SPF_PASS=-0.001, URIBL_BLOCKED=0.001]
	autolearn=disabled
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd1-us-west.apache.org [10.40.0.7]) (amavisd-new, port 10024)
	with ESMTP id 3X48jar0J20E for <dev@httpd.apache.org>;
	Mon, 26 Oct 2015 12:28:50 +0000 (UTC)
Received: from monica.sharp.fm (monica.sharp.fm [80.168.143.5])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTP id 975A8439E9
	for <dev@httpd.apache.org>; Mon, 26 Oct 2015 12:28:50 +0000 (UTC)
Received: from [10.105.13.220] (unknown [5.56.169.82])
	(using TLSv1 with cipher DHE-RSA-AES256-SHA (256/256 bits))
	(Client did not present a certificate)
	(Authenticated sender: minfrin@sharp.fm)
	by monica.sharp.fm (Postfix) with ESMTPSA id 1494A807BA
	for <dev@httpd.apache.org>; Mon, 26 Oct 2015 12:28:43 +0000 (GMT)
Content-Type: text/plain; charset=utf-8
Mime-Version: 1.0 (Mac OS X Mail 8.2 \(2104\))
Subject: Re: Question about CACHE_SEPARATOR in modules/cache/cache_util.h
From: Graham Leggett <minfrin@sharp.fm>
In-Reply-To: <562E195E.70107@kippdata.de>
Date: Mon, 26 Oct 2015 14:28:43 +0200
Content-Transfer-Encoding: quoted-printable
Message-Id: <D7702C30-54B5-4983-93EF-2E45EFE0E92C@sharp.fm>
References: <n0kjcg$nu9$1@ger.gmane.org> <2F0F1428-539D-48AB-94B1-CB3FC739797B@sharp.fm> <562E195E.70107@kippdata.de>
To: dev@httpd.apache.org
X-Mailer: Apple Mail (2.2104)

On 26 Oct 2015, at 2:15 PM, Rainer Jung <rainer.jung@kippdata.de> wrote:

> The line goes back to
>=20
> https://bz.apache.org/bugzilla/show_bug.cgi?id=3D50199
>=20
> where Nick reported the problem and Graham provided the initial patch.
>=20
> The defined tokenizer chars were "comma-space-space-space" from the =
beginning. But I think Graham pointed into the right direction, probably =
it should have been "comma-space-tab=E2=80=9D.

Following the links further into the RFC, this corresponds with LWS, =
which is either a space or a tab:

#define CACHE_SEPARATOR =E2=80=9C, \t"

Regards,
Graham
=E2=80=94


From dev-return-84457-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Mon Oct 26 16:52:05 2015
Return-Path: <dev-return-84457-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 2BD9718737
	for <apmail-httpd-dev-archive@www.apache.org>; Mon, 26 Oct 2015 16:52:05 +0000 (UTC)
Received: (qmail 74523 invoked by uid 500); 26 Oct 2015 16:51:55 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 74444 invoked by uid 500); 26 Oct 2015 16:51:55 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 74434 invoked by uid 99); 26 Oct 2015 16:51:54 -0000
Received: from Unknown (HELO spamd4-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 26 Oct 2015 16:51:54 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd4-us-west.apache.org (ASF Mail Server at spamd4-us-west.apache.org) with ESMTP id 90626C0257
	for <dev@httpd.apache.org>; Mon, 26 Oct 2015 16:51:54 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd4-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.102
X-Spam-Level:
X-Spam-Status: No, score=-0.102 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RCVD_IN_MSPIKE_H2=-0.001, SPF_PASS=-0.001] autolearn=disabled
Authentication-Results: spamd4-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd4-us-west.apache.org [10.40.0.11]) (amavisd-new, port 10024)
	with ESMTP id vwe9U_GUaDqh for <dev@httpd.apache.org>;
	Mon, 26 Oct 2015 16:51:53 +0000 (UTC)
Received: from mail-pa0-f51.google.com (mail-pa0-f51.google.com [209.85.220.51])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id F299E439BC
	for <dev@httpd.apache.org>; Mon, 26 Oct 2015 16:51:52 +0000 (UTC)
Received: by pacfv9 with SMTP id fv9so202049807pac.3
        for <dev@httpd.apache.org>; Mon, 26 Oct 2015 09:51:46 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=subject:to:references:from:message-id:date:user-agent:mime-version
         :in-reply-to:content-type:content-transfer-encoding;
        bh=YVjrN7stb+ZJSUWutTdw7EZ6F8JLK226F6tizM0LLj8=;
        b=tnMEAu4K7LFymiP59b8NYSl1EGCqMoGmAf+vIWsBX6xlu6sRTXbECpuTn5NtwzlVee
         jPJSot56ymbM0xVQs6gErxN0/Pis+OzJxZZsDZqek8ON1FwQqgkYNLuiUcbVClmc4DuK
         2K2o9jZHACzw/8WcST3/90m5npME7mV55lxItxSJfDSd7k6SH7lTb8zeos2vCsohiL1y
         n1Xe8T0zauqvm02eDEvjfTWw7e+/yMclnGquImKp5gXc1hXUYRvh9L6RkgQXOGx0CkDf
         I+xdj08ahxpt7H5KQABlJQJB/2lzXyCe4imVy/MsdP2IqMw2MZt7yebKT1zXp5IQxSbD
         Q/SQ==
X-Received: by 10.68.103.161 with SMTP id fx1mr23127145pbb.42.1445878306108;
        Mon, 26 Oct 2015 09:51:46 -0700 (PDT)
Received: from [192.168.1.4] (static-50-43-55-221.bvtn.or.frontiernet.net. [50.43.55.221])
        by smtp.gmail.com with ESMTPSA id xm9sm34914175pbc.32.2015.10.26.09.51.44
        for <dev@httpd.apache.org>
        (version=TLSv1/SSLv3 cipher=OTHER);
        Mon, 26 Oct 2015 09:51:44 -0700 (PDT)
Subject: Re: Is Apache getting too patchy?
To: dev@httpd.apache.org
References: <38B6AA15-AB3C-47AC-B96D-7DA8094F99F9@jaguNET.com>
From: Jacob Champion <champion.p@gmail.com>
Message-ID: <562E5A1F.9080201@gmail.com>
Date: Mon, 26 Oct 2015 09:51:43 -0700
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:38.0) Gecko/20100101
 Thunderbird/38.3.0
MIME-Version: 1.0
In-Reply-To: <38B6AA15-AB3C-47AC-B96D-7DA8094F99F9@jaguNET.com>
Content-Type: text/plain; charset=windows-1252; format=flowed
Content-Transfer-Encoding: 7bit

On 10/24/2015 08:49 AM, Jim Jagielski wrote:
> Thoughts? Comments?

Jim,

I'm somewhat on the outside looking in, as an httpd newbie. But my 
standard experience (it's happened two or three times now) is this:

1) Non-trivial patch is proposed to the list with calls for 
discussion/debate.
2) Nothing happens.
3) List is pinged for comments.
4) Silence.
5) Patch author either gives up or pings relentlessly until...
6) ...patch is applied directly to trunk without discussion.

This being a volunteer project, I don't actually mind steps 1-5 so much. 
You're busy people, and my patches shouldn't be priority one for anyone. 
I'm more concerned about step 6, where conversations wither on the vine 
in favor of just applying the patch and seeing what happens. I think 
that could contribute to the "cruft instead of cohesion" that you're seeing.

I'd rather not feel like I'm just annoying dev@ until you submit my 
stuff -- I want to *talk* about it, and improve the server.

HTH,
--Jacob

From dev-return-84458-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Mon Oct 26 16:56:10 2015
Return-Path: <dev-return-84458-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 911AB18763
	for <apmail-httpd-dev-archive@www.apache.org>; Mon, 26 Oct 2015 16:56:10 +0000 (UTC)
Received: (qmail 91605 invoked by uid 500); 26 Oct 2015 16:56:07 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 91519 invoked by uid 500); 26 Oct 2015 16:56:07 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 91503 invoked by uid 99); 26 Oct 2015 16:56:07 -0000
Received: from Unknown (HELO spamd1-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 26 Oct 2015 16:56:07 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd1-us-west.apache.org (ASF Mail Server at spamd1-us-west.apache.org) with ESMTP id A90B4C288C
	for <dev@httpd.apache.org>; Mon, 26 Oct 2015 16:56:06 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd1-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.102
X-Spam-Level:
X-Spam-Status: No, score=-0.102 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RCVD_IN_MSPIKE_H2=-0.001, SPF_PASS=-0.001] autolearn=disabled
Authentication-Results: spamd1-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-us-west.apache.org ([10.40.0.8])
	by localhost (spamd1-us-west.apache.org [10.40.0.7]) (amavisd-new, port 10024)
	with ESMTP id 5tn8cADT3Nzh for <dev@httpd.apache.org>;
	Mon, 26 Oct 2015 16:56:06 +0000 (UTC)
Received: from mail-pa0-f48.google.com (mail-pa0-f48.google.com [209.85.220.48])
	by mx1-us-west.apache.org (ASF Mail Server at mx1-us-west.apache.org) with ESMTPS id 11CE326673
	for <dev@httpd.apache.org>; Mon, 26 Oct 2015 16:56:06 +0000 (UTC)
Received: by pasz6 with SMTP id z6so193321280pas.2
        for <dev@httpd.apache.org>; Mon, 26 Oct 2015 09:56:05 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=subject:to:references:from:message-id:date:user-agent:mime-version
         :in-reply-to:content-type:content-transfer-encoding;
        bh=1An2TrLjsomv1s2Wjf3r7Fpr6Pc4V8XpQWGaaDSRL/A=;
        b=yCDqwQuxkxFT0FjPLBg6jiVUO9Dyoe+gGqTH8yEPWPFfcWNWEeoj2eZ67c/dYXd6wy
         XQjsgodt7HXmd6NT5antNC1oH33bp5KmnwFc/TTxCX4n5f1JKvgkHa+d+yMycm/KhTYJ
         yYim9J+njvR4yT5H5UDcrL9Dv0PIBpel0Oi4gcQFhKtSknr4/KCTfcOrqMc2DF33L+q+
         PjmX7LyRjzsqiDAHYC1QsVBNzEqtXajpu21K3GXIzaIbtbXjXza49fDpmkCLtGeFIDnP
         YWey52fPAhxAHRdF2uy176teTqMkd0tGLs/+sUwVvpJ7Poyhl/mcjY4s89OkVKoTokDd
         SKUQ==
X-Received: by 10.66.123.9 with SMTP id lw9mr21377531pab.119.1445878565844;
        Mon, 26 Oct 2015 09:56:05 -0700 (PDT)
Received: from [192.168.1.4] (static-50-43-55-221.bvtn.or.frontiernet.net. [50.43.55.221])
        by smtp.gmail.com with ESMTPSA id w9sm34912916pbt.29.2015.10.26.09.56.04
        for <dev@httpd.apache.org>
        (version=TLSv1.2 cipher=ECDHE-RSA-AES128-GCM-SHA256 bits=128/128);
        Mon, 26 Oct 2015 09:56:04 -0700 (PDT)
Subject: Re: Is Apache getting too patchy?
To: dev@httpd.apache.org
References: <38B6AA15-AB3C-47AC-B96D-7DA8094F99F9@jaguNET.com>
 <CABx2=D_JU19ztacoifzhTJfX5sb_UOfdVrTEmWpPcTwwOsy4vA@mail.gmail.com>
From: Jacob Champion <champion.p@gmail.com>
Message-ID: <562E5B23.6030203@gmail.com>
Date: Mon, 26 Oct 2015 09:56:03 -0700
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:38.0) Gecko/20100101
 Thunderbird/38.3.0
MIME-Version: 1.0
In-Reply-To: <CABx2=D_JU19ztacoifzhTJfX5sb_UOfdVrTEmWpPcTwwOsy4vA@mail.gmail.com>
Content-Type: text/plain; charset=utf-8; format=flowed
Content-Transfer-Encoding: 7bit

On 10/24/2015 09:32 PM, Kurtis Rader wrote:
> People reviewing changes to the existing code base have to be hard-nosed
> assholes.

Kurtis,

I agree with everything you said except this. IMHO, you've traded one 
bad extreme (where few people care about the quality of the codebase) 
for another (where the people who care about the codebase are rude and 
uncooperative). You can be hard-nosed about code standards without being 
a jerk.

Maybe you didn't mean it like that, but I feel like there are way too 
many people in open source communities who take an "I have to be an 
asshole" mantra to heart.

--Jacob

From dev-return-84459-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Mon Oct 26 17:34:00 2015
Return-Path: <dev-return-84459-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 3335418926
	for <apmail-httpd-dev-archive@www.apache.org>; Mon, 26 Oct 2015 17:34:00 +0000 (UTC)
Received: (qmail 28062 invoked by uid 500); 26 Oct 2015 17:33:47 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 27980 invoked by uid 500); 26 Oct 2015 17:33:47 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 27970 invoked by uid 99); 26 Oct 2015 17:33:47 -0000
Received: from Unknown (HELO spamd3-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 26 Oct 2015 17:33:47 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd3-us-west.apache.org (ASF Mail Server at spamd3-us-west.apache.org) with ESMTP id 905C7180DFA
	for <dev@httpd.apache.org>; Mon, 26 Oct 2015 17:33:46 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd3-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.102
X-Spam-Level:
X-Spam-Status: No, score=-0.102 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RCVD_IN_MSPIKE_H2=-0.001, SPF_PASS=-0.001] autolearn=disabled
Authentication-Results: spamd3-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd3-us-west.apache.org [10.40.0.10]) (amavisd-new, port 10024)
	with ESMTP id cP7JRzNWeujX for <dev@httpd.apache.org>;
	Mon, 26 Oct 2015 17:33:45 +0000 (UTC)
Received: from mail-pa0-f43.google.com (mail-pa0-f43.google.com [209.85.220.43])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id 02C4A20927
	for <dev@httpd.apache.org>; Mon, 26 Oct 2015 17:33:45 +0000 (UTC)
Received: by pabla5 with SMTP id la5so1201422pab.0
        for <dev@httpd.apache.org>; Mon, 26 Oct 2015 10:33:38 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=from:subject:to:references:message-id:date:user-agent:mime-version
         :in-reply-to:content-type:content-transfer-encoding;
        bh=ORl+t2W4FBxjjmB++f1nYGh/s1sFs28Sq5dbcN/AIbw=;
        b=nVrwrnEfQJs5ayOSgxu74FfYl5wg4b2XCbGczECXKhvTmL4OqjQjW3gh7H2+0eInL2
         ARpkdgaRCDndZp5F96H571uZfTE8dGZCUCYnEaHieXH0xoDb5b/t0GQ/DNy/pVLLaRRz
         +NhSR1E8uSfTmha93CO5LHevD5Wug4Hr7VqN5YHSwEAWq87NIKSFtPWXmDQokhx/wcMn
         cxiPzYZ7OCGAfe5RWrAUGZxaeWQBAb7FJqy7p/RUvHKSgtX+h8pYmpBSoX2UlNjNNEx5
         K9fATRmI+tBXRuRn3yzMM0wc3baNp6B9zFbT5rqumwf8RP3sLz54hfKjX8MHi718Qkyh
         wBeg==
X-Received: by 10.68.170.4 with SMTP id ai4mr22841976pbc.52.1445880817893;
        Mon, 26 Oct 2015 10:33:37 -0700 (PDT)
Received: from [192.168.1.4] (static-50-43-55-221.bvtn.or.frontiernet.net. [50.43.55.221])
        by smtp.gmail.com with ESMTPSA id sz9sm35128238pab.13.2015.10.26.10.33.36
        for <dev@httpd.apache.org>
        (version=TLSv1.2 cipher=ECDHE-RSA-AES128-GCM-SHA256 bits=128/128);
        Mon, 26 Oct 2015 10:33:36 -0700 (PDT)
From: Jacob Champion <champion.p@gmail.com>
Subject: Re: Enforce rewriting of Host header when an absolue URI is given
To: dev@httpd.apache.org
References: <CAKQ1sVPQHikv6Cv+vfpMM4wSDr2oYVPwaLfJEMG9S6AZdAZHUA@mail.gmail.com>
Message-ID: <562E63EF.8070006@gmail.com>
Date: Mon, 26 Oct 2015 10:33:35 -0700
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:38.0) Gecko/20100101
 Thunderbird/38.3.0
MIME-Version: 1.0
In-Reply-To: <CAKQ1sVPQHikv6Cv+vfpMM4wSDr2oYVPwaLfJEMG9S6AZdAZHUA@mail.gmail.com>
Content-Type: text/plain; charset=utf-8; format=flowed
Content-Transfer-Encoding: 7bit

Yann,

I found this while trying to understand the corner cases for Origin 
header checks for mod_websocket, and I do actually have some thoughts on 
it...

On 03/04/2015 07:21 AM, Yann Ylavic wrote:
> (by default, not only with "HttpProtocol strict", which is trunk only btw).
>
> Per RFC7230#section-5.4 :
>     When a proxy receives a request with an absolute-form of
>     request-target, the proxy MUST ignore the received Host header field
>     (if any) and instead replace it with the host information of the
>     request-target.  A proxy that forwards such a request MUST generate a
>     new Host field-value based on the received request-target rather than
>     forward the received Host field-value.
>
> The first part is already honored, but not the forwarding part: the
> Host header is not rewritten with the one extracted from the absolute
> URI, neither at the protocol (core) level nor at proxy level.
>
> There are PR56718 (and duplicate PR57563) about this.
> Still the same question about whether providing the headers to some
> CGI or module is a forward or not,

I don't buy this. IMO, CGI/plugins/modules/etc. are implementation 
details of the server.

> I think personally it would be sane
> to do this at the protocol level (beginning of the request).
> I proposed a patch there and refined it a bit (attached), so that
> section 5.4 is applied in vhost.c::fix_hostname().
>
> It also implements this part of section 5.4 (second point, _underlined_) :
>     A server MUST respond with a 400 (Bad Request) status code to any
>     HTTP/1.1 request message that lacks a Host header field and _to any
>     request message that contains more than one Host header field_ or a
>     Host header field with an invalid field-value.
>
> The first point is already handled, and the third is "HttpProtocol
> strict" dependent (which is enough I think, but maybe deserve a
> backport too).
>
>
> Thoughts?

I have conflicting feelings on your approach, but I haven't pinned down 
a good argument against it. So here's an alternative for the sake of 
discussion: instead of rewriting the request to try to prevent 
downstream security issues (and allowing a request that is probably 
malicious to stay alive), why not reject the request outright? Any 
non-malicious uses of a mismatched Host will be broken by this patch 
anyway, right?

--Jacob

From dev-return-84460-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Mon Oct 26 17:51:47 2015
Return-Path: <dev-return-84460-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id B009618A99
	for <apmail-httpd-dev-archive@www.apache.org>; Mon, 26 Oct 2015 17:51:47 +0000 (UTC)
Received: (qmail 7332 invoked by uid 500); 26 Oct 2015 17:51:47 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 7259 invoked by uid 500); 26 Oct 2015 17:51:47 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 7248 invoked by uid 99); 26 Oct 2015 17:51:47 -0000
Received: from Unknown (HELO spamd4-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 26 Oct 2015 17:51:47 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd4-us-west.apache.org (ASF Mail Server at spamd4-us-west.apache.org) with ESMTP id 93BE0C0720
	for <dev@httpd.apache.org>; Mon, 26 Oct 2015 17:51:46 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd4-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 0.999
X-Spam-Level:
X-Spam-Status: No, score=0.999 tagged_above=-999 required=6.31
	tests=[KAM_LAZY_DOMAIN_SECURITY=1, RCVD_IN_MSPIKE_H2=-0.001]
	autolearn=disabled
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd4-us-west.apache.org [10.40.0.11]) (amavisd-new, port 10024)
	with ESMTP id SnjKebFfAXJW for <dev@httpd.apache.org>;
	Mon, 26 Oct 2015 17:51:45 +0000 (UTC)
Received: from homiemail-a88.g.dreamhost.com (sub4.mail.dreamhost.com [69.163.253.135])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTP id 34DF420924
	for <dev@httpd.apache.org>; Mon, 26 Oct 2015 17:51:34 +0000 (UTC)
Received: from homiemail-a88.g.dreamhost.com (localhost [127.0.0.1])
	by homiemail-a88.g.dreamhost.com (Postfix) with ESMTP id 1D7E0264103
	for <dev@httpd.apache.org>; Mon, 26 Oct 2015 10:51:02 -0700 (PDT)
Received: from [192.168.1.2] (ip68-228-71-159.oc.oc.cox.net [68.228.71.159])
	(using TLSv1 with cipher DHE-RSA-AES256-SHA (256/256 bits))
	(No client certificate requested)
	(Authenticated sender: fielding@gbiv.com)
	by homiemail-a88.g.dreamhost.com (Postfix) with ESMTPSA id 6BF552640AE
	for <dev@httpd.apache.org>; Mon, 26 Oct 2015 10:51:01 -0700 (PDT)
Content-Type: text/plain; charset=us-ascii
Mime-Version: 1.0 (Mac OS X Mail 8.2 \(2104\))
Subject: Re: Enforce rewriting of Host header when an absolue URI is given
From: "Roy T. Fielding" <fielding@gbiv.com>
In-Reply-To: <562E63EF.8070006@gmail.com>
Date: Mon, 26 Oct 2015 10:50:54 -0700
Content-Transfer-Encoding: quoted-printable
Message-Id: <01A048E8-07A9-48E3-B589-DA3B3282FB5E@gbiv.com>
References: <CAKQ1sVPQHikv6Cv+vfpMM4wSDr2oYVPwaLfJEMG9S6AZdAZHUA@mail.gmail.com> <562E63EF.8070006@gmail.com>
To: dev@httpd.apache.org
X-Mailer: Apple Mail (2.2104)

> On Oct 26, 2015, at 10:33 AM, Jacob Champion <champion.p@gmail.com> =
wrote:
>=20
> Yann,
>=20
> I found this while trying to understand the corner cases for Origin =
header checks for mod_websocket, and I do actually have some thoughts on =
it...
>=20
> On 03/04/2015 07:21 AM, Yann Ylavic wrote:
>> (by default, not only with "HttpProtocol strict", which is trunk only =
btw).
>>=20
>> Per RFC7230#section-5.4 :
>>    When a proxy receives a request with an absolute-form of
>>    request-target, the proxy MUST ignore the received Host header =
field
>>    (if any) and instead replace it with the host information of the
>>    request-target.  A proxy that forwards such a request MUST =
generate a
>>    new Host field-value based on the received request-target rather =
than
>>    forward the received Host field-value.
>>=20
>> The first part is already honored, but not the forwarding part: the
>> Host header is not rewritten with the one extracted from the absolute
>> URI, neither at the protocol (core) level nor at proxy level.
>>=20
>> There are PR56718 (and duplicate PR57563) about this.
>> Still the same question about whether providing the headers to some
>> CGI or module is a forward or not,
>=20
> I don't buy this. IMO, CGI/plugins/modules/etc. are implementation =
details of the server.

Correct.  The word "proxy" in HTTP only applies to to the forwarding of =
HTTP
messages by a client-selected (forward) proxy.  There was no such thing =
as
a "reverse proxy" (an idiotic marketing term invented by Netscape) when =
the
original HTTP specs were written.  Those are gateways (as in Common =
Gateway Interface).

>> I think personally it would be sane
>> to do this at the protocol level (beginning of the request).
>> I proposed a patch there and refined it a bit (attached), so that
>> section 5.4 is applied in vhost.c::fix_hostname().
>>=20
>> It also implements this part of section 5.4 (second point, =
_underlined_) :
>>    A server MUST respond with a 400 (Bad Request) status code to any
>>    HTTP/1.1 request message that lacks a Host header field and _to =
any
>>    request message that contains more than one Host header field_ or =
a
>>    Host header field with an invalid field-value.
>>=20
>> The first point is already handled, and the third is "HttpProtocol
>> strict" dependent (which is enough I think, but maybe deserve a
>> backport too).

We should always be strict on received Host handling because misplaced =
routing
information is often used to bypass security filters.  That is, we =
should not allow
an invalid Host header field to pass through. It should at least be =
rejected
by default (if non-reject is configurable).

....Roy


From dev-return-84461-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Mon Oct 26 17:52:33 2015
Return-Path: <dev-return-84461-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 00C5F18AAA
	for <apmail-httpd-dev-archive@www.apache.org>; Mon, 26 Oct 2015 17:52:33 +0000 (UTC)
Received: (qmail 9024 invoked by uid 500); 26 Oct 2015 17:52:26 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 8951 invoked by uid 500); 26 Oct 2015 17:52:26 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 8939 invoked by uid 99); 26 Oct 2015 17:52:26 -0000
Received: from Unknown (HELO spamd1-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 26 Oct 2015 17:52:26 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd1-us-west.apache.org (ASF Mail Server at spamd1-us-west.apache.org) with ESMTP id D6080C2A10
	for <dev@httpd.apache.org>; Mon, 26 Oct 2015 17:52:25 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd1-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 3.73
X-Spam-Level: ***
X-Spam-Status: No, score=3.73 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, HTML_MESSAGE=3,
	KAM_INFOUSMEBIZ=0.75, RCVD_IN_MSPIKE_H3=-0.01,
	RCVD_IN_MSPIKE_WL=-0.01] autolearn=disabled
Authentication-Results: spamd1-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=skepticism_us.20150623.gappssmtp.com
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd1-us-west.apache.org [10.40.0.7]) (amavisd-new, port 10024)
	with ESMTP id 8008s0eSjY4H for <dev@httpd.apache.org>;
	Mon, 26 Oct 2015 17:52:24 +0000 (UTC)
Received: from mail-lf0-f45.google.com (mail-lf0-f45.google.com [209.85.215.45])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id 88E3820604
	for <dev@httpd.apache.org>; Mon, 26 Oct 2015 17:52:23 +0000 (UTC)
Received: by lffz202 with SMTP id z202so158641664lff.3
        for <dev@httpd.apache.org>; Mon, 26 Oct 2015 10:52:23 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=skepticism_us.20150623.gappssmtp.com; s=20150623;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        bh=UXh7MCvTAdWPrUMEslu2kEg9JSgyyGVTure4bukVg/Q=;
        b=xLjSKX67ccX/0yBnLIavxObLQphMV4dd4FzCId7pQPgepawLDu3xK5pJIbzNLLREV9
         Vkd9Eo1BZcNHBy+DAI/XRshy77X5aJpYByojaPdkULLGBFfGqCkmX0jEtlqUguA1jMpX
         umT6/Hvu+fNO2o8jQ8v1wqvZCLWb6131K5xS/Stj40cR66GGF5GfebLrcZx7M+j3L0JE
         19Ia+N2UNsnSxMtu+St3HhII9QA1U5Huz5Qy/xaj/jnMaKuklfqwSyJ53GQY+KCfw6l9
         p/Pz+tQLxk/FiapjJtUbuQ+4udQZsV64/W/WhT59aC8MfbGTkqJi1yZ2mvtJISnsbHIE
         nBjQ==
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=1e100.net; s=20130820;
        h=x-gm-message-state:mime-version:in-reply-to:references:date
         :message-id:subject:from:to:content-type;
        bh=UXh7MCvTAdWPrUMEslu2kEg9JSgyyGVTure4bukVg/Q=;
        b=mckWunN8GxKc+uJU6TYqLW7U5Xi2ljTKTHwXl9l0gqkohb0PaCJzhQAGVO7tg2sEs9
         GamCcyaCY4qQtNqR0bAc/pMWxb4tFd4KjKAOX5+RWcGhrc9gFIawV5lK6nWMrI1uqqRI
         /6Lwijemzo6R9xg0ICq0W1Ijz4ULWaqUHdS1k4Am3Sfcf92D+dRXTT19n1JFqRM+XIYM
         RpkEY8NE1GLuw8/9Ifmzh5j33JK/UTkPIhcE4jnbhn9KKwqrwyWy5e61N/l/Q3TFAF71
         jEaDJj8RLyqRCh+d+Gd5GxnlLMYUTHxQ2N13+kDQHM62sW5TkvBoRR92EXDKEAQmbeuM
         YPhw==
X-Gm-Message-State: ALoCoQl8QP6hLLng6M3V54pL+421FWFhIoE9wRXkaBD2KDp3Qo1LmPnjsAhuyuqzDHMML5+MGSsR
MIME-Version: 1.0
X-Received: by 10.25.89.210 with SMTP id n201mr1266282lfb.87.1445881942745;
 Mon, 26 Oct 2015 10:52:22 -0700 (PDT)
Received: by 10.112.72.34 with HTTP; Mon, 26 Oct 2015 10:52:22 -0700 (PDT)
In-Reply-To: <562E5B23.6030203@gmail.com>
References: <38B6AA15-AB3C-47AC-B96D-7DA8094F99F9@jaguNET.com>
	<CABx2=D_JU19ztacoifzhTJfX5sb_UOfdVrTEmWpPcTwwOsy4vA@mail.gmail.com>
	<562E5B23.6030203@gmail.com>
Date: Mon, 26 Oct 2015 10:52:22 -0700
Message-ID: <CABx2=D8xj+gjtUKUqz1Xp_rpKDpMdHc6cK2EWCcCOmoajw7Q2Q@mail.gmail.com>
Subject: Re: Is Apache getting too patchy?
From: Kurtis Rader <krader@skepticism.us>
To: dev@httpd.apache.org
Content-Type: multipart/alternative; boundary=001a114002c895c1e40523059faf

--001a114002c895c1e40523059faf
Content-Type: text/plain; charset=UTF-8

On Mon, Oct 26, 2015 at 9:56 AM, Jacob Champion <champion.p@gmail.com>
wrote:

> On 10/24/2015 09:32 PM, Kurtis Rader wrote:
>
>> People reviewing changes to the existing code base have to be hard-nosed
>> assholes.
>>
>
> Kurtis,
>
> I agree with everything you said except this. IMHO, you've traded one bad
> extreme (where few people care about the quality of the codebase) for
> another (where the people who care about the codebase are rude and
> uncooperative). You can be hard-nosed about code standards without being a
> jerk.
>
> Maybe you didn't mean it like that, but I feel like there are way too many
> people in open source communities who take an "I have to be an asshole"
> mantra to heart.


Asshole was probably not the best term. I meant it in the sense that you
shouldn't be afraid to tell someone in plain language what the problems are
with their proposed change. Yes, the reviewer should be polite. No, they
should not sugar-coat their feedback. I've seen way too many instances (not
limited to this project) of ill-advised or badly implemented changes being
accepted because no one was willing to be the "bad guy" and say "No, that
change will not be accepted." This has been a major problem with the Zsh
project, for example. To the point where I'm seriously considering
switching shells. I'd hate to see that happen to this project.

-- 
Kurtis Rader
Caretaker of the exceptional canines Junior and Hank

--001a114002c895c1e40523059faf
Content-Type: text/html; charset=UTF-8
Content-Transfer-Encoding: quoted-printable

<div dir=3D"ltr"><div class=3D"gmail_extra"><div class=3D"gmail_quote">On M=
on, Oct 26, 2015 at 9:56 AM, Jacob Champion <span dir=3D"ltr">&lt;<a href=
=3D"mailto:champion.p@gmail.com" target=3D"_blank">champion.p@gmail.com</a>=
&gt;</span> wrote:<br><blockquote class=3D"gmail_quote" style=3D"margin:0 0=
 0 .8ex;border-left:1px #ccc solid;padding-left:1ex"><span class=3D"">On 10=
/24/2015 09:32 PM, Kurtis Rader wrote:<br>
<blockquote class=3D"gmail_quote" style=3D"margin:0 0 0 .8ex;border-left:1p=
x #ccc solid;padding-left:1ex">
People reviewing changes to the existing code base have to be hard-nosed<br=
>
assholes.<br>
</blockquote>
<br></span>
Kurtis,<br>
<br>
I agree with everything you said except this. IMHO, you&#39;ve traded one b=
ad extreme (where few people care about the quality of the codebase) for an=
other (where the people who care about the codebase are rude and uncooperat=
ive). You can be hard-nosed about code standards without being a jerk.<br>
<br>
Maybe you didn&#39;t mean it like that, but I feel like there are way too m=
any people in open source communities who take an &quot;I have to be an ass=
hole&quot; mantra to heart.</blockquote><div><br></div><div>Asshole was pro=
bably not the best term. I meant it in the sense that you shouldn&#39;t be =
afraid to tell someone in plain language what the problems are with their p=
roposed change. Yes, the reviewer should be polite. No, they should not sug=
ar-coat their feedback. I&#39;ve seen way too many instances (not limited t=
o this project) of ill-advised or badly implemented changes being accepted =
because no one was willing to be the &quot;bad guy&quot; and say &quot;No, =
that change will not be accepted.&quot; This has been a major problem with =
the Zsh project, for example. To the point where I&#39;m seriously consider=
ing switching shells. I&#39;d hate to see that happen to this project.</div=
></div><div><br></div>-- <br><div class=3D"gmail_signature"><div dir=3D"ltr=
">Kurtis Rader<div>Caretaker of the exceptional canines Junior and Hank</di=
v></div></div>
</div></div>

--001a114002c895c1e40523059faf--

From dev-return-84462-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Mon Oct 26 18:20:07 2015
Return-Path: <dev-return-84462-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id EF53118D4A
	for <apmail-httpd-dev-archive@www.apache.org>; Mon, 26 Oct 2015 18:20:06 +0000 (UTC)
Received: (qmail 48535 invoked by uid 500); 26 Oct 2015 18:20:06 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 48480 invoked by uid 500); 26 Oct 2015 18:20:06 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 48470 invoked by uid 99); 26 Oct 2015 18:20:06 -0000
Received: from Unknown (HELO spamd4-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 26 Oct 2015 18:20:06 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd4-us-west.apache.org (ASF Mail Server at spamd4-us-west.apache.org) with ESMTP id E609CC0720
	for <dev@httpd.apache.org>; Mon, 26 Oct 2015 18:20:05 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd4-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.1
X-Spam-Level:
X-Spam-Status: No, score=-0.1 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1]
	autolearn=disabled
Authentication-Results: spamd4-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-us-west.apache.org ([10.40.0.8])
	by localhost (spamd4-us-west.apache.org [10.40.0.11]) (amavisd-new, port 10024)
	with ESMTP id jJyHaK8smr11 for <dev@httpd.apache.org>;
	Mon, 26 Oct 2015 18:19:47 +0000 (UTC)
Received: from mail-pa0-f45.google.com (mail-pa0-f45.google.com [209.85.220.45])
	by mx1-us-west.apache.org (ASF Mail Server at mx1-us-west.apache.org) with ESMTPS id 8E27123086
	for <dev@httpd.apache.org>; Mon, 26 Oct 2015 18:19:47 +0000 (UTC)
Received: by pabla5 with SMTP id la5so2199862pab.0
        for <dev@httpd.apache.org>; Mon, 26 Oct 2015 11:19:47 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=subject:to:references:from:message-id:date:user-agent:mime-version
         :in-reply-to:content-type:content-transfer-encoding;
        bh=XMP5UouCYRKderjmLLJHTQOvKl6Bm5WF1Qu0e49OWDM=;
        b=de1Fb+R+a9M/SA8XMTOUXFjCDt59qM+QPKoc8UzpSLY5IC7nRpOoo/lKGLn/GCRYhg
         xkkJ0rU3U9U2RLwu6Gs7n8kgn1LVhfAdlJPPUvOuYE6rdo0fFRnACv4078+pHhQkg14V
         +EXMIIQScDdFdGrt+anb9ZQTb5Odrm8/rvcLjTo64gf8qp2YcABlZ89Fs7Qb1mxNk1Xs
         3Q2bci2l6wwJLxnSYmF6kg8BwAOlq+QCWvbPUy+cA1mFXI8NlAcdf+8c4Wi0470WRDFq
         19V1Hez9y45tVqNMyRSYoXFtVzLauX9F4vWOxQZ7yF6Eh/+1+LqFQgPWdcRzN8vJCmlQ
         m+HA==
X-Received: by 10.68.134.232 with SMTP id pn8mr22743826pbb.47.1445883587309;
        Mon, 26 Oct 2015 11:19:47 -0700 (PDT)
Received: from [192.168.1.4] (static-50-43-55-221.bvtn.or.frontiernet.net. [50.43.55.221])
        by smtp.gmail.com with ESMTPSA id fb1sm35245294pab.9.2015.10.26.11.19.46
        for <dev@httpd.apache.org>
        (version=TLSv1.2 cipher=ECDHE-RSA-AES128-GCM-SHA256 bits=128/128);
        Mon, 26 Oct 2015 11:19:46 -0700 (PDT)
Subject: Re: Is Apache getting too patchy?
To: dev@httpd.apache.org
References: <38B6AA15-AB3C-47AC-B96D-7DA8094F99F9@jaguNET.com>
 <CABx2=D_JU19ztacoifzhTJfX5sb_UOfdVrTEmWpPcTwwOsy4vA@mail.gmail.com>
 <562E5B23.6030203@gmail.com>
 <CABx2=D8xj+gjtUKUqz1Xp_rpKDpMdHc6cK2EWCcCOmoajw7Q2Q@mail.gmail.com>
From: Jacob Champion <champion.p@gmail.com>
Message-ID: <562E6EC1.2000507@gmail.com>
Date: Mon, 26 Oct 2015 11:19:45 -0700
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:38.0) Gecko/20100101
 Thunderbird/38.3.0
MIME-Version: 1.0
In-Reply-To: <CABx2=D8xj+gjtUKUqz1Xp_rpKDpMdHc6cK2EWCcCOmoajw7Q2Q@mail.gmail.com>
Content-Type: text/plain; charset=utf-8; format=flowed
Content-Transfer-Encoding: 7bit

On 10/26/2015 10:52 AM, Kurtis Rader wrote:
> Asshole was probably not the best term. I meant it in the sense that you
> shouldn't be afraid to tell someone in plain language what the problems
> are with their proposed change. Yes, the reviewer should be polite. No,
> they should not sugar-coat their feedback.

Cool, we're in agreement then.

--Jacob


From dev-return-84463-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Mon Oct 26 18:21:34 2015
Return-Path: <dev-return-84463-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 6F2BA18D78
	for <apmail-httpd-dev-archive@www.apache.org>; Mon, 26 Oct 2015 18:21:34 +0000 (UTC)
Received: (qmail 60564 invoked by uid 500); 26 Oct 2015 18:21:29 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 60418 invoked by uid 500); 26 Oct 2015 18:21:29 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 60331 invoked by uid 99); 26 Oct 2015 18:21:29 -0000
Received: from Unknown (HELO spamd3-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 26 Oct 2015 18:21:29 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd3-us-west.apache.org (ASF Mail Server at spamd3-us-west.apache.org) with ESMTP id 8F9EA180234
	for <dev@httpd.apache.org>; Mon, 26 Oct 2015 18:21:28 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd3-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.109
X-Spam-Level:
X-Spam-Status: No, score=-0.109 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	T_RP_MATCHES_RCVD=-0.01, URIBL_BLOCKED=0.001] autolearn=disabled
Authentication-Results: spamd3-us-west.apache.org (amavisd-new);
	dkim=pass (1024-bit key) header.d=greenbytes.de
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd3-us-west.apache.org [10.40.0.10]) (amavisd-new, port 10024)
	with ESMTP id YAQcnoygJQx5 for <dev@httpd.apache.org>;
	Mon, 26 Oct 2015 18:21:14 +0000 (UTC)
Received: from mail.greenbytes.de (mail.greenbytes.de [217.91.35.233])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id B7FF7429AA
	for <dev@httpd.apache.org>; Mon, 26 Oct 2015 18:21:13 +0000 (UTC)
Received: from [192.168.178.56] (unknown [84.189.84.157])
	(using TLSv1 with cipher ECDHE-RSA-AES256-SHA (256/256 bits))
	(Client did not present a certificate)
	by mail.greenbytes.de (Postfix) with ESMTPSA id 9A75A15A01AD;
	Mon, 26 Oct 2015 19:21:05 +0100 (CET)
DKIM-Signature: v=1; a=rsa-sha256; c=simple/simple; d=greenbytes.de; s=mail;
	t=1445883666; bh=79gyitr+vtVpWi7xO3Sk91RGgQvKXp1tlH+qs0d+j3k=;
	h=Subject:From:In-Reply-To:Date:Cc:References:To:From;
	b=NGHmnIuMEGRz8SYNdElXBkO3gmMWU56ecqeFbIssi94wTlrbWijOBJ0WZprhQNwv2
	 iyNr3YK87+kPY27446mjLnE7O8caYB2kQ22TWC+iRdoSHNFiROceI3RInEot51zbqO
	 sUOl9n2hDAbbzGQ0omL32iCxJBhlwlyeU0nCCVWA=
Content-Type: text/plain;
	charset=utf-8
Mime-Version: 1.0 (1.0)
Subject: Re: Thx and merit
From: Stefan Eissing <stefan.eissing@greenbytes.de>
X-Mailer: iPhone Mail (13B143)
In-Reply-To: <AM3PR04MB500CBA55DCFE1952557942BCB230@AM3PR04MB500.eurprd04.prod.outlook.com>
Date: Mon, 26 Oct 2015 19:21:04 +0100
Cc: "dev@httpd.apache.org" <dev@httpd.apache.org>,
 Dan Druta <dd5826@att.com>,
 OSCAR DE DIOS GONZALEZ <oscar.gonzalezdedios@telefonica.com>,
 Reschke Julian <julian.reschke@greenbytes.de>,
 =?utf-8?Q?B=C3=B6ttcher_Martin?= <martin.boettcher@greenbytes.de>
Content-Transfer-Encoding: quoted-printable
Message-Id: <2336CECF-26D8-442F-99E7-E814C4F3CB10@greenbytes.de>
References: <EE2ED063-8F6F-4ABA-BE87-49F1751F8D54@jaguNET.com> <CAKQ1sVMoSEXQXVmL8roAXMDvCmRJ_Bb0-=+A7Sr-w+-Ju86iQw@mail.gmail.com> <7709DF56-5A1F-4E31-A7BB-411171737C58@greenbytes.de> <AM3PR04MB500CBA55DCFE1952557942BCB230@AM3PR04MB500.eurprd04.prod.outlook.com>
To: Istvan Lajtos <ilajtos@gsma.com>

Hi Istvan,

the module has been released as part of the httpd server in version 2.4.17 a=
nd can be downloaded from here: http://httpd.apache.org/download.cgi

Best Regards,

  Stefan

> Am 26.10.2015 um 18:05 schrieb Istvan Lajtos <ilajtos@gsma.com>:
>=20
> Hello Stefan
>=20
> I would appreciate if you can check with Jim and let us know the exact URL=
 where the Apache 2.1.4 H2C module can be accessed from.
>=20
> Many thanks
> Istvan
>=20
> -----Original Message-----
> From: Stefan Eissing [mailto:stefan.eissing@greenbytes.de]
> Sent: 14 October 2015 15:55
> To: dev@httpd.apache.org
> Cc: Dan Druta <dd5826@att.com>; Istvan Lajtos <ilajtos@gsma.com>; OSCAR DE=
 DIOS GONZALEZ <oscar.gonzalezdedios@telefonica.com>; Reschke Julian <julian=
.reschke@greenbytes.de>; B=C3=B6ttcher Martin <martin.boettcher@greenbytes.d=
e>
> Subject: Re: Thx and merit
>=20
> Thanks to everyone for the kind words. It has been my pleasure to contribu=
te to such a community as Apache and I plan on continuing doing so as much a=
s possible.
>=20
> Many thanks to Jim, Eric, Yann, Rainer, Kaspar and all the others that hav=
e made me welcome here right from the start and who helped me settle in. It'=
s a project with an immense history and there is always something more to le=
arn about it.
>=20
> When Apache httpd now speaks HTTP/2, then it's mainly Tatsuhiro Tsujikawa'=
s work in nghttp2 that made this feasible.
> Many thanks to his excellent work and his nice support!
>=20
> As Jeff wrote: this all would not have happened if not for the sponsoring o=
f the GSMA and Telefonica. Particularly Dan Druta and Istvan Lajtos have bee=
n driving the idea from the start and Oscar Gonzalez accompanied the project=
 in its execution phase. Great work!
>=20
> My employer, greenbytes, is also partly my company, so I could thank mysel=
f. However my partners, Julian Reschke and Martin B=C3=B6ttcher, also deserv=
e thanks for supporting this endeavor.
>=20
> We are but a very small company and it is not possible to sponsor a full t=
ime person for a long duration. We will continue looking for sponsors to do w=
ork in Apache. Such projects really give the greatest worth for all parties i=
nvolved as can be seen today.
>=20
> Again, Thanks!
>=20
> //Stefan
>=20
>> Am 14.10.2015 um 16:20 schrieb Yann Ylavic <ylavic.dev@gmail.com>:
>>=20
>> +1, thanks Stefan!
>>=20
>>> On Wed, Oct 14, 2015 at 2:58 PM, Jim Jagielski <jim@jagunet.com> wrote:
>>> The ASF is all about recognizing and rewarding merit. The whole
>>> "Apache Way" started here, with this project, and httpd has always
>>> been the sort of "guiding light" and example of how Apache projects
>>> (should) work.
>>>=20
>>> Inclusion of the HTTP/2 implementation for httpd, especially for the
>>> 2.4.x branch, is a substantial feather in our cap. But we would have
>>> been far behind the 8-ball if not for the funding by the GSM
>>> Association on greenbytes GmbH's mod_h2 work, and for the donation of
>>> that module to the ASF.
>>>=20
>>> Once again, I'd like to thank them personally!
>=20
> This email and its attachments are intended for the above named only and m=
ay be confidential. If they have come to you in error you must take no actio=
n based on them, nor must you copy or show them to anyone; please reply to t=
his email or call +44 207 356 0600 and highlight the error.

From dev-return-84464-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Mon Oct 26 21:30:30 2015
Return-Path: <dev-return-84464-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 5A8E018758
	for <apmail-httpd-dev-archive@www.apache.org>; Mon, 26 Oct 2015 21:30:30 +0000 (UTC)
Received: (qmail 12755 invoked by uid 500); 26 Oct 2015 21:30:29 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 12694 invoked by uid 500); 26 Oct 2015 21:30:29 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 12683 invoked by uid 99); 26 Oct 2015 21:30:29 -0000
Received: from Unknown (HELO spamd2-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 26 Oct 2015 21:30:29 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd2-us-west.apache.org (ASF Mail Server at spamd2-us-west.apache.org) with ESMTP id 4613E1A2858
	for <dev@httpd.apache.org>; Mon, 26 Oct 2015 21:30:29 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd2-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 2.98
X-Spam-Level: **
X-Spam-Status: No, score=2.98 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, HTML_MESSAGE=3,
	RCVD_IN_MSPIKE_H3=-0.01, RCVD_IN_MSPIKE_WL=-0.01, SPF_PASS=-0.001,
	URIBL_BLOCKED=0.001] autolearn=disabled
Authentication-Results: spamd2-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=rowe-clan_net.20150623.gappssmtp.com
Received: from mx1-us-west.apache.org ([10.40.0.8])
	by localhost (spamd2-us-west.apache.org [10.40.0.9]) (amavisd-new, port 10024)
	with ESMTP id VxoPl0nADGzm for <dev@httpd.apache.org>;
	Mon, 26 Oct 2015 21:30:21 +0000 (UTC)
Received: from mail-ig0-f181.google.com (mail-ig0-f181.google.com [209.85.213.181])
	by mx1-us-west.apache.org (ASF Mail Server at mx1-us-west.apache.org) with ESMTPS id 0E37C23086
	for <dev@httpd.apache.org>; Mon, 26 Oct 2015 21:30:20 +0000 (UTC)
Received: by igbhv6 with SMTP id hv6so66244134igb.0
        for <dev@httpd.apache.org>; Mon, 26 Oct 2015 14:30:20 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=rowe-clan_net.20150623.gappssmtp.com; s=20150623;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        bh=P0TQLTMeDpK6WCt6/Ci5Y0Kea3fZ/FUwR8QLrC9IPZg=;
        b=ihef/sWrMGZNVW4Bn6zXAdreanc1POMhf6QpUg5ralBco6TPIN18flQcf79Mk04uTR
         7+3wbiDEXJZHYKzS5d/KeZr9o02XqxEOyyel+jvSbpW3daJnpZS696idCHxKe9EpTTWi
         jzGbsekiWAXKWa5w57gwBPOQdO6fBHwGIfe6xoR6TpeG70bNiMsPDD0yxL2rPLFTvt5n
         Lan/Hd+SN6MmBZmnTQ4C2uUJNuq74heVlX3MMIglFG+tUAvdD9BT1oa1H/0IE0Lk9m4B
         Fc/WJ8nGK+W2PABTjJ3gZrucIEQBXVI9TgFZ9b3eenrkrjmq5zxtRBCMdydgOLSWpBro
         6NdA==
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=1e100.net; s=20130820;
        h=x-gm-message-state:mime-version:in-reply-to:references:date
         :message-id:subject:from:to:content-type;
        bh=P0TQLTMeDpK6WCt6/Ci5Y0Kea3fZ/FUwR8QLrC9IPZg=;
        b=X2kKy8dXPtaV3idepApQmssQsXZHhETiXBsH6ZCx8J7qHwXvTvrF7Kz1l++5HQ238V
         LTyds/nsuSxET2qpUAoB9QAIyOcljCCYLsm8GZxD3ZcOkkIIIUMQAVOEc5LOOSuavRLT
         zkwO5Cqu4m5RueTxgAJYiQMv0NSbM7ojEoHFwv0KsG3vNaQjZdpPTGLqtV88ZF4Ztwrs
         wWlCS0odq3/kDC2wLz+zEcmHhtkfwZa6IXP4TH0+d1wR5YbLkHoLJa9EWhD6QX+ihxY7
         dZpW23E4xFQu3FexK5dZmmDzibcRGJ35WVGu05PF5lBgpEcf7s49RbKjUblV7cu0T7kt
         Xwgw==
X-Gm-Message-State: ALoCoQmnRHvbhyZ0+lyjmTNXmmXkTZdPBNUQCE6WdKZe6uR3D6lc5xDMvP+MX5JsDNLK6ggNraXD
MIME-Version: 1.0
X-Received: by 10.50.43.134 with SMTP id w6mr22368241igl.32.1445895020109;
 Mon, 26 Oct 2015 14:30:20 -0700 (PDT)
Received: by 10.107.3.88 with HTTP; Mon, 26 Oct 2015 14:30:20 -0700 (PDT)
In-Reply-To: <38B6AA15-AB3C-47AC-B96D-7DA8094F99F9@jaguNET.com>
References: <38B6AA15-AB3C-47AC-B96D-7DA8094F99F9@jaguNET.com>
Date: Mon, 26 Oct 2015 16:30:20 -0500
Message-ID: <CACsi252GLXuB1dcNjJ332HJAHtKZkt9S55bQTY-wCibD5nfO0A@mail.gmail.com>
Subject: Re: Is Apache getting too patchy?
From: William A Rowe Jr <wrowe@rowe-clan.net>
To: httpd <dev@httpd.apache.org>
Content-Type: multipart/alternative; boundary=089e01184b0c0e833f052308abea

--089e01184b0c0e833f052308abea
Content-Type: text/plain; charset=UTF-8

On Sat, Oct 24, 2015 at 10:49 AM, Jim Jagielski <jim@jagunet.com> wrote:

> Just some food for thought; let me know if I'm off the rails.
>

Well, that depends on what you are commenting on...

Over the last several months, it's appeared to me that we have
> been adding patches that feel, well, very-patchy to me. They
> feel like cumbersome add-ons that create some level of fragility
> to our code, with special one-off considerations instead of a
> deeper more complete fix. In other words, it seems that httpd is
> becoming more crufty rather than planned and cohesive and
> consistent.
>

So over an arbitrary window of time (several months = 12 weeks?)
there are patches that you are uncomfortable with on trunk? 2.4?
Perhaps even 2.2? They seem to be fingers in the dam, rather than
reinforcing the wall of a solid code base?

Rather than 'vaugebooking' (to borrow a phrase from another
context), it might be helpful to point out the specific commits
that have you concerned, and register specific complaints or
feedback? If a -1 is called for, of course put that forward, but
perhaps some coaching/coaxing might get the specific fixes
into the sort of shape you feel is appropriate?

If there is a pattern from specific committers, pointing out any
issues on one patch is probably sufficient to coax them into
reviewing their other patches for similar issues and avoid any
similar issues in the future?

Some parts of trunk are certainly due for refactoring, but that
can be a multi-week task rather than the obvious quick fix. If
there is a better or more comprehensive fix, calling it out on
the list might solicit rework from yet another committer who
is interested in the same issue at hand?

As a committer and PMC member, it is yours, and mine, and
all the rest of the project participants to point out problematic
commits individually. That's the definition of commit-then-review,
something you recently championed an expansion of for more
aspects of the 2.4 branch. Please pipe up on the -r phase so
we all learn which patches concerns you, and why?

--089e01184b0c0e833f052308abea
Content-Type: text/html; charset=UTF-8
Content-Transfer-Encoding: quoted-printable

<div dir=3D"ltr"><div class=3D"gmail_extra"><div class=3D"gmail_quote">On S=
at, Oct 24, 2015 at 10:49 AM, Jim Jagielski <span dir=3D"ltr">&lt;<a href=
=3D"mailto:jim@jagunet.com" target=3D"_blank">jim@jagunet.com</a>&gt;</span=
> wrote:<br><blockquote class=3D"gmail_quote" style=3D"margin:0 0 0 .8ex;bo=
rder-left:1px #ccc solid;padding-left:1ex">Just some food for thought; let =
me know if I&#39;m off the rails.<br></blockquote><div>=C2=A0</div><div>Wel=
l, that depends on what you are commenting on...</div><div><br></div><block=
quote class=3D"gmail_quote" style=3D"margin:0 0 0 .8ex;border-left:1px #ccc=
 solid;padding-left:1ex">
Over the last several months, it&#39;s appeared to me that we have<br>
been adding patches that feel, well, very-patchy to me. They<br>
feel like cumbersome add-ons that create some level of fragility<br>
to our code, with special one-off considerations instead of a<br>
deeper more complete fix. In other words, it seems that httpd is<br>
becoming more crufty rather than planned and cohesive and<br>
consistent.<br></blockquote><div><br></div><div>So over an arbitrary window=
 of time (several months =3D 12 weeks?)</div><div>there are patches that yo=
u are uncomfortable with on trunk? 2.4?</div><div>Perhaps even 2.2? They se=
em to be fingers in the dam, rather than</div><div>reinforcing the wall of =
a solid code base?</div><div><br></div><div>Rather than &#39;vaugebooking&#=
39; (to borrow a phrase from another</div><div>context), it might be helpfu=
l to point out the specific commits</div><div>that have you concerned, and =
register specific complaints or</div><div>feedback? If a -1 is called for, =
of course put that forward, but</div><div>perhaps some coaching/coaxing mig=
ht get the specific fixes=C2=A0</div><div>into the sort of shape you feel i=
s appropriate?</div><div><br></div><div>If there is a pattern from specific=
 committers, pointing out any</div><div>issues on one patch is probably suf=
ficient to coax them into</div><div>reviewing their other patches for simil=
ar issues and avoid any</div><div>similar issues in the future?</div><div><=
br></div><div>Some parts of trunk are certainly due for refactoring, but th=
at</div><div>can be a multi-week task rather than the obvious quick fix. If=
=C2=A0</div><div>there is a better or more comprehensive fix, calling it ou=
t on=C2=A0</div><div>the list might solicit rework from yet another committ=
er who=C2=A0</div><div>is interested in the same issue at hand?</div><div><=
br></div><div>As a committer and PMC member, it is yours, and mine, and</di=
v><div>all the rest of the project participants to point out problematic</d=
iv><div>commits individually. That&#39;s the definition of commit-then-revi=
ew,</div><div>something you recently championed an expansion of for more</d=
iv><div>aspects of the 2.4 branch. Please pipe up on the -r phase so</div><=
div>we all learn which patches concerns you, and why?</div><div><br></div><=
/div></div></div>

--089e01184b0c0e833f052308abea--

From dev-return-84465-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Mon Oct 26 22:23:30 2015
Return-Path: <dev-return-84465-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 8003E18A19
	for <apmail-httpd-dev-archive@www.apache.org>; Mon, 26 Oct 2015 22:23:30 +0000 (UTC)
Received: (qmail 71119 invoked by uid 500); 26 Oct 2015 22:23:29 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 71056 invoked by uid 500); 26 Oct 2015 22:23:29 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 71046 invoked by uid 99); 26 Oct 2015 22:23:29 -0000
Received: from Unknown (HELO spamd4-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 26 Oct 2015 22:23:29 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd4-us-west.apache.org (ASF Mail Server at spamd4-us-west.apache.org) with ESMTP id BC7B9C0720
	for <dev@httpd.apache.org>; Mon, 26 Oct 2015 22:23:28 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd4-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 1.365
X-Spam-Level: *
X-Spam-Status: No, score=1.365 tagged_above=-999 required=6.31
	tests=[FSL_HELO_NON_FQDN_1=0.001, KAM_LAZY_DOMAIN_SECURITY=1,
	RCVD_IN_SORBS_DUL=0.001, RDNS_DYNAMIC=0.363] autolearn=disabled
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd4-us-west.apache.org [10.40.0.11]) (amavisd-new, port 10024)
	with ESMTP id qFH5UjwAsdTO for <dev@httpd.apache.org>;
	Mon, 26 Oct 2015 22:23:27 +0000 (UTC)
Received: from baldur (cpc36-newt30-2-0-cust898.19-3.cable.virginm.net [82.32.195.131])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTP id 4F2382095A
	for <dev@httpd.apache.org>; Mon, 26 Oct 2015 22:23:27 +0000 (UTC)
Received: from baldur (localhost [127.0.0.1])
	by baldur (Postfix) with ESMTP id D31B4C1C8F67
	for <dev@httpd.apache.org>; Mon, 26 Oct 2015 22:23:24 +0000 (GMT)
Date: Mon, 26 Oct 2015 22:23:22 +0000
From: Nick Kew <nick@webthing.com>
To: dev@httpd.apache.org
Subject: Re: Is Apache getting too patchy?
Message-ID: <20151026222322.232ef884@baldur>
In-Reply-To: <562E5A1F.9080201@gmail.com>
References: <38B6AA15-AB3C-47AC-B96D-7DA8094F99F9@jaguNET.com>
	<562E5A1F.9080201@gmail.com>
X-Mailer: Claws Mail 3.7.4 (GTK+ 2.20.1; i486-pc-linux-gnu)
Mime-Version: 1.0
Content-Type: text/plain; charset=US-ASCII
Content-Transfer-Encoding: 7bit

On Mon, 26 Oct 2015 09:51:43 -0700
Jacob Champion <champion.p@gmail.com> wrote:


> I'm somewhat on the outside looking in, as an httpd newbie. But my 
> standard experience (it's happened two or three times now) is this:
> 
> 1) Non-trivial patch is proposed to the list with calls for 
> discussion/debate.
> 2) Nothing happens.
> 3) List is pinged for comments.
> 4) Silence.
> 5) Patch author either gives up or pings relentlessly until...
> 6) ...patch is applied directly to trunk without discussion.

Thanks for the perspective.  Yes, it's sometimes uncomfortable.

> I'd rather not feel like I'm just annoying dev@ until you submit my 
> stuff -- I want to *talk* about it, and improve the server.

That may not be easy.  You need to find someone who'll be
interested in an idea or patch, and has the time to review it.
Plus, the community as a whole to agree it's a good idea,
or at least not actively oppose it.

I wonder if workflow would be improved if we had named
maintainers for particular parts of the codebase - for
example individual modules?  Not necessarily to do all
the work, but to take primary responsibility to see that
your ideas don't just fall through the gaps and get ignored?

-- 
Nick Kew

From dev-return-84466-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Mon Oct 26 22:54:24 2015
Return-Path: <dev-return-84466-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 2791F18AA9
	for <apmail-httpd-dev-archive@www.apache.org>; Mon, 26 Oct 2015 22:54:24 +0000 (UTC)
Received: (qmail 96457 invoked by uid 500); 26 Oct 2015 22:40:23 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 96377 invoked by uid 500); 26 Oct 2015 22:40:22 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 96346 invoked by uid 99); 26 Oct 2015 22:40:22 -0000
Received: from Unknown (HELO spamd4-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 26 Oct 2015 22:40:22 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd4-us-west.apache.org (ASF Mail Server at spamd4-us-west.apache.org) with ESMTP id 970D0C0720
	for <dev@httpd.apache.org>; Mon, 26 Oct 2015 22:40:20 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd4-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 1.353
X-Spam-Level: *
X-Spam-Status: No, score=1.353 tagged_above=-999 required=6.31
	tests=[KAM_LAZY_DOMAIN_SECURITY=1, RDNS_DYNAMIC=0.363,
	SPF_HELO_PASS=-0.001, T_RP_MATCHES_RCVD=-0.01, URIBL_BLOCKED=0.001]
	autolearn=disabled
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd4-us-west.apache.org [10.40.0.11]) (amavisd-new, port 10024)
	with ESMTP id 4Jvu4E6_Uo7i for <dev@httpd.apache.org>;
	Mon, 26 Oct 2015 22:40:12 +0000 (UTC)
Received: from nebula.c8h10n4o2.org.uk (nebula.c8h10n4o2.org.uk [80.68.88.207])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id B9C93439BC
	for <dev@httpd.apache.org>; Mon, 26 Oct 2015 22:40:11 +0000 (UTC)
Received: from consume.c8h10n4o2.org.uk ([2001:8b0:caee:2::2])
	by nebula.c8h10n4o2.org.uk with esmtpsa (TLS1.0:ECDHE_RSA_AES_256_CBC_SHA384:256)
	(Exim 4.84)
	(envelope-from <isoma@c8h10n4o2.org.uk>)
	id 1ZqqQt-00044s-Ik
	for dev@httpd.apache.org; Mon, 26 Oct 2015 22:40:03 +0000
Content-Type: text/plain; charset=utf-8
Mime-Version: 1.0 (Mac OS X Mail 9.1 \(3096.5\))
Subject: Re: Is Apache getting too patchy?
From: Tim Bannister <isoma@c8h10n4o2.org.uk>
In-Reply-To: <20151026222322.232ef884@baldur>
Date: Mon, 26 Oct 2015 22:40:03 +0000
Content-Transfer-Encoding: quoted-printable
Message-Id: <40FF7659-3F5A-4010-9A4B-D7E09B9ACF95@c8h10n4o2.org.uk>
References: <38B6AA15-AB3C-47AC-B96D-7DA8094F99F9@jaguNET.com> <562E5A1F.9080201@gmail.com> <20151026222322.232ef884@baldur>
To: dev@httpd.apache.org
X-Mailer: Apple Mail (2.3096.5)

On 26 Oct 2015, at 22:23, Nick Kew <nick@webthing.com> wrote:
> On Mon, 26 Oct 2015 09:51:43 -0700
> Jacob Champion <champion.p@gmail.com> wrote:
>=20
>> I'd rather not feel like I'm just annoying dev@ until you submit my=20=

>> stuff -- I want to *talk* about it, and improve the server.
>=20
> That may not be easy.  You need to find someone who'll be interested =
in an idea or patch, and has the time to review it.
> Plus, the community as a whole to agree it's a good idea, or at least =
not actively oppose it.
>=20
> I wonder if workflow would be improved if we had named maintainers for =
particular parts of the codebase - for example individual modules?  Not =
necessarily to do all the work, but to take primary responsibility to =
see that your ideas don't just fall through the gaps and get ignored?

How does the word =E2=80=9Csponsor=E2=80=9D sound?

Someone who encourages and champions the development activity around a =
particular feature (and is also very welcome to contribute). The =
existing and more formal mechanisms for approving commits seem to work =
fine as a way of controlling the quality of code.


Improving the workflow means, to me, coaching and leadership, and =
different kinds of code review. Someone who isn't very good at C (like =
me) might well want to make a code contribution but not be sure how. I =
saw recently how much perseverance Yingqi Lu put in towards getting =
SO_REUSEPORT support into trunk and then into 2.4.17 =E2=80=93 and =
that's great. It's unfortunate that the same perseverance also offers a =
lesson about the kind of barriers that a would-be contributor might =
encounter.

So, sponsorship can be about encouraging participation and progress. I'm =
imagining someone who rarely has to settle a decision =E2=80=93 those =
should stay consensual and democratic - but often leads discussions and =
moves things on.

Comments very welcome.


--=20
Tim Bannister =E2=80=93 isoma@c8h10n4o2.org.uk


From dev-return-84467-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Mon Oct 26 23:33:13 2015
Return-Path: <dev-return-84467-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 8597A18FC1
	for <apmail-httpd-dev-archive@www.apache.org>; Mon, 26 Oct 2015 23:33:13 +0000 (UTC)
Received: (qmail 33011 invoked by uid 500); 26 Oct 2015 23:33:04 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 32951 invoked by uid 500); 26 Oct 2015 23:33:03 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 32941 invoked by uid 99); 26 Oct 2015 23:33:03 -0000
Received: from Unknown (HELO spamd4-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 26 Oct 2015 23:33:03 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd4-us-west.apache.org (ASF Mail Server at spamd4-us-west.apache.org) with ESMTP id 75046C0F8E
	for <dev@httpd.apache.org>; Mon, 26 Oct 2015 23:33:03 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd4-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.1
X-Spam-Level:
X-Spam-Status: No, score=-0.1 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	SPF_PASS=-0.001, URIBL_BLOCKED=0.001] autolearn=disabled
Authentication-Results: spamd4-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-us-west.apache.org ([10.40.0.8])
	by localhost (spamd4-us-west.apache.org [10.40.0.11]) (amavisd-new, port 10024)
	with ESMTP id 0NUf4GzuzgC6 for <dev@httpd.apache.org>;
	Mon, 26 Oct 2015 23:32:54 +0000 (UTC)
Received: from mail-qk0-f172.google.com (mail-qk0-f172.google.com [209.85.220.172])
	by mx1-us-west.apache.org (ASF Mail Server at mx1-us-west.apache.org) with ESMTPS id 7617220562
	for <dev@httpd.apache.org>; Mon, 26 Oct 2015 23:32:54 +0000 (UTC)
Received: by qkfq3 with SMTP id q3so20406111qkf.3
        for <dev@httpd.apache.org>; Mon, 26 Oct 2015 16:32:46 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        bh=BtYQKQIQgHJKmmwTkfyBNLO6nBA1DwOq+fxHGkJ3llY=;
        b=V+gDgT7SEhX+4ypQVwaGLfDW0QBz5+mPVjxptkRb78mxpd1Qs7r/RyF/hpXuXukUq2
         x2VEsycXq9C5TxXUbIxZyfgYmuIBo8NRsa0gfv8uwvGyj1/HWvUjSW0podi2SKRXH6nb
         P/ldINgf/sUhi274O/LQ5G/5uNE4Kopb6Q3OWLWskiPg/4zfG4FWp3SPw84U/aFlUrFI
         PPiCCQh/4diMrkA0Lp/9890+yehbsg4vgX54/ucRDgkcXGvHgcJGFTtBo95DHgoSMx50
         6OMRaTiVNhZu+KKrcpDgSBkXWAvl83nxctnvnF8V9X17eEVOVsOu869jTvjYZhEsRC8U
         g3IA==
MIME-Version: 1.0
X-Received: by 10.55.74.197 with SMTP id x188mr3993qka.38.1445902366772; Mon,
 26 Oct 2015 16:32:46 -0700 (PDT)
Received: by 10.55.101.196 with HTTP; Mon, 26 Oct 2015 16:32:46 -0700 (PDT)
In-Reply-To: <6A49427F0EB5B44F9F1006B09A0A28F4F8B0B5A4@IL-EX10.ad.checkpoint.com>
References: <6A49427F0EB5B44F9F1006B09A0A28F4F8B0B3E3@IL-EX10.ad.checkpoint.com>
	<E55B3A8D-3FB3-47CE-8937-162CF265F115@sharp.fm>
	<6A49427F0EB5B44F9F1006B09A0A28F4F8B0B5A4@IL-EX10.ad.checkpoint.com>
Date: Tue, 27 Oct 2015 00:32:46 +0100
Message-ID: <CAKQ1sVPyvciqoxu2fDM4Y6Yk2V+sCNA1z73WR0pmuonW5Y=YsQ@mail.gmail.com>
Subject: Re: Improve Apache performance on high load (prefork MPM) with
 multiple Accept mutexes (Patch attached)
From: Yann Ylavic <ylavic.dev@gmail.com>
To: dev@httpd.apache.org
Content-Type: text/plain; charset=UTF-8

On Mon, Oct 26, 2015 at 12:45 PM, Yehezkel Horowitz
<horowity@checkpoint.com> wrote:
>
>>The following patch was recently backported to v2.4, how similar is your
>> patch to this one?
>
>> *) MPMs: Support SO_REUSEPORT to create multiple duplicated listener
>
>      records for scalability. [Yingqi Lu <yingqi.lu@intel.com>,
>
>      Jeff Trawick, Jim Jagielski, Yann Ylavic]
>
> Both patches might come to solve similar problem, but SO_REUSEPORT requires
> Linux 3.9 (which is quite new in Linux terms).

Maybe this requirement could be relaxed so that the listeners buckets
(and their own accept mutex) would be available even without the
SO_REUSEPORT option.

Could you test this?

Regards,
Yann.

From dev-return-84468-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Tue Oct 27 00:20:23 2015
Return-Path: <dev-return-84468-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 47D62181B1
	for <apmail-httpd-dev-archive@www.apache.org>; Tue, 27 Oct 2015 00:20:23 +0000 (UTC)
Received: (qmail 20930 invoked by uid 500); 27 Oct 2015 00:20:17 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 20849 invoked by uid 500); 27 Oct 2015 00:20:17 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 20837 invoked by uid 99); 27 Oct 2015 00:20:17 -0000
Received: from Unknown (HELO spamd4-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 27 Oct 2015 00:20:17 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd4-us-west.apache.org (ASF Mail Server at spamd4-us-west.apache.org) with ESMTP id 2A5B9C13D3
	for <dev@httpd.apache.org>; Tue, 27 Oct 2015 00:20:17 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd4-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.012
X-Spam-Level:
X-Spam-Status: No, score=-0.012 tagged_above=-999 required=6.31
	tests=[RCVD_IN_MSPIKE_H2=-0.001, SPF_PASS=-0.001,
	T_RP_MATCHES_RCVD=-0.01] autolearn=disabled
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd4-us-west.apache.org [10.40.0.11]) (amavisd-new, port 10024)
	with ESMTP id gPgBcHfmNcH4 for <dev@httpd.apache.org>;
	Tue, 27 Oct 2015 00:20:08 +0000 (UTC)
Received: from aserp1040.oracle.com (aserp1040.oracle.com [141.146.126.69])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id 137C8439B6
	for <dev@httpd.apache.org>; Tue, 27 Oct 2015 00:20:08 +0000 (UTC)
Received: from userv0021.oracle.com (userv0021.oracle.com [156.151.31.71])
	by aserp1040.oracle.com (Sentrion-MTA-4.3.2/Sentrion-MTA-4.3.2) with ESMTP id t9R0K6U9023059
	(version=TLSv1 cipher=DHE-RSA-AES256-SHA bits=256 verify=OK)
	for <dev@httpd.apache.org>; Tue, 27 Oct 2015 00:20:07 GMT
Received: from aserv0122.oracle.com (aserv0122.oracle.com [141.146.126.236])
	by userv0021.oracle.com (8.13.8/8.13.8) with ESMTP id t9R0K6ZP008020
	(version=TLSv1/SSLv3 cipher=DHE-RSA-AES256-SHA bits=256 verify=FAIL)
	for <dev@httpd.apache.org>; Tue, 27 Oct 2015 00:20:06 GMT
Received: from abhmp0018.oracle.com (abhmp0018.oracle.com [141.146.116.24])
	by aserv0122.oracle.com (8.13.8/8.13.8) with ESMTP id t9R0K63J030580
	for <dev@httpd.apache.org>; Tue, 27 Oct 2015 00:20:06 GMT
Received: from [10.159.149.184] (/10.159.149.184)
	by default (Oracle Beehive Gateway v4.0)
	with ESMTP ; Mon, 26 Oct 2015 17:20:06 -0700
Subject: Re: Is Apache getting too patchy?
To: dev@httpd.apache.org
References: <38B6AA15-AB3C-47AC-B96D-7DA8094F99F9@jaguNET.com>
From: Mike Rumph <mike.rumph@oracle.com>
Organization: Oracle Corporation
Message-ID: <562EC32A.2000907@oracle.com>
Date: Mon, 26 Oct 2015 17:19:54 -0700
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:38.0) Gecko/20100101
 Thunderbird/38.3.0
MIME-Version: 1.0
In-Reply-To: <38B6AA15-AB3C-47AC-B96D-7DA8094F99F9@jaguNET.com>
Content-Type: text/plain; charset=windows-1252; format=flowed
Content-Transfer-Encoding: 7bit
X-Source-IP: userv0021.oracle.com [156.151.31.71]

Hello Jim,

As Bill pointed out, it would be helpful if you could identify some 
specific details within the general trend you are observing.

But the kind of thing that you are mentioning is something that I would 
expect to happen far more often than can be observed in the Apache HTTP 
Server project.
If individual contributors are each trying to "scratch their own itch", 
then there would be a tendency for code to become less coherent over time.
What keeps things from growing into chaos is the review by experienced 
contributors who are looking at the overall purpose and direction of the 
project as a whole.
Another thing that helps the Apache HTTP Server project is the modular 
design of the code base.  New and diverse features can be isolated into 
separate modules, be given time to mature and then eventually be better 
integrated with the core code.

Over the last few months there simply has been a lot of activity.
But there has also been a lot of quality debate around this activity.
Some very impressive new functionality has been attempted.
I personally have not had enough time (and possibly not enough skill) to 
know if the quality of the code is good or not.  But from my limited 
perspective the discussions seem to be going in a good direction.

Thanks,

Mike Rumph


On 10/24/2015 8:49 AM, Jim Jagielski wrote:
> Just some food for thought; let me know if I'm off the rails.
>
> Over the last several months, it's appeared to me that we have
> been adding patches that feel, well, very-patchy to me. They
> feel like cumbersome add-ons that create some level of fragility
> to our code, with special one-off considerations instead of a
> deeper more complete fix. In other words, it seems that httpd is
> becoming more crufty rather than planned and cohesive and
> consistent.
>
> Thoughts? Comments?
>
>


From dev-return-84469-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Tue Oct 27 00:28:05 2015
Return-Path: <dev-return-84469-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 7F4AF1821E
	for <apmail-httpd-dev-archive@www.apache.org>; Tue, 27 Oct 2015 00:28:05 +0000 (UTC)
Received: (qmail 38875 invoked by uid 500); 27 Oct 2015 00:28:04 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 38796 invoked by uid 500); 27 Oct 2015 00:28:04 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 38786 invoked by uid 99); 27 Oct 2015 00:28:04 -0000
Received: from Unknown (HELO spamd1-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 27 Oct 2015 00:28:04 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd1-us-west.apache.org (ASF Mail Server at spamd1-us-west.apache.org) with ESMTP id 336F2C5812
	for <dev@httpd.apache.org>; Tue, 27 Oct 2015 00:28:04 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd1-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.12
X-Spam-Level:
X-Spam-Status: No, score=-0.12 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RCVD_IN_MSPIKE_H3=-0.01, RCVD_IN_MSPIKE_WL=-0.01, SPF_PASS=-0.001,
	URIBL_BLOCKED=0.001] autolearn=disabled
Authentication-Results: spamd1-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd1-us-west.apache.org [10.40.0.7]) (amavisd-new, port 10024)
	with ESMTP id RWsINZ4bKRDQ for <dev@httpd.apache.org>;
	Tue, 27 Oct 2015 00:27:57 +0000 (UTC)
Received: from mail-pa0-f54.google.com (mail-pa0-f54.google.com [209.85.220.54])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id 2EA8120604
	for <dev@httpd.apache.org>; Tue, 27 Oct 2015 00:27:56 +0000 (UTC)
Received: by pacfv9 with SMTP id fv9so212219009pac.3
        for <dev@httpd.apache.org>; Mon, 26 Oct 2015 17:27:54 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=subject:to:references:from:message-id:date:user-agent:mime-version
         :in-reply-to:content-type:content-transfer-encoding;
        bh=rDytuPMo4fGvEg4JPeU71lvQvXaWK/paTxl9iNphoXM=;
        b=wIncpZMnfm/vJSVGSv8DvTJxMSwsbl4+WqEdZsGouEVYqQDCeFHBZt09prgbkxNWzY
         2cZ68e2PfiREQFkmzdixf0OwbeDDphasg7g0A3k5N9cVzDHQwqyQbkF3kEFWB8likMve
         tOx8byM7+S9uTrNwuuoKEPqS7tP5ExO0gjdumIH5M+/rfIdoOme4/WnneQquwSAcgQOb
         cxPMIuwW7deWikbRMuGB+Or2QDZt8jbkjJGxYKbbsJ1VezX8+84FfXDYs+/mtoNXklnc
         3dVDBhWd8AhkQfbwToWe9QorbK2GZwtg3eA4bVHxFFibCBxHrdqHAlt+yOHhJdgRJI1a
         WQvg==
X-Received: by 10.68.182.161 with SMTP id ef1mr25040428pbc.79.1445905674745;
        Mon, 26 Oct 2015 17:27:54 -0700 (PDT)
Received: from [192.168.1.4] (static-50-43-55-221.bvtn.or.frontiernet.net. [50.43.55.221])
        by smtp.gmail.com with ESMTPSA id ou3sm36029912pbb.44.2015.10.26.17.27.53
        for <dev@httpd.apache.org>
        (version=TLSv1/SSLv3 cipher=OTHER);
        Mon, 26 Oct 2015 17:27:53 -0700 (PDT)
Subject: Re: Is Apache getting too patchy?
To: dev@httpd.apache.org
References: <38B6AA15-AB3C-47AC-B96D-7DA8094F99F9@jaguNET.com>
 <562E5A1F.9080201@gmail.com> <20151026222322.232ef884@baldur>
 <40FF7659-3F5A-4010-9A4B-D7E09B9ACF95@c8h10n4o2.org.uk>
From: Jacob Champion <champion.p@gmail.com>
Message-ID: <562EC508.3060401@gmail.com>
Date: Mon, 26 Oct 2015 17:27:52 -0700
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:38.0) Gecko/20100101
 Thunderbird/38.3.0
MIME-Version: 1.0
In-Reply-To: <40FF7659-3F5A-4010-9A4B-D7E09B9ACF95@c8h10n4o2.org.uk>
Content-Type: text/plain; charset=utf-8; format=flowed
Content-Transfer-Encoding: 8bit

On 10/26/2015 03:40 PM, Tim Bannister wrote:
> On 26 Oct 2015, at 22:23, Nick Kew <nick@webthing.com> wrote:
>> I wonder if workflow would be improved if we had named maintainers
>> for particular parts of the codebase - for example individual
>> modules?  Not necessarily to do all the work, but to take primary
>> responsibility to see that your ideas don't just fall through the
>> gaps and get ignored?
>
> How does the word “sponsor” sound?
>
> Someone who encourages and champions the development activity around
> a particular feature (and is also very welcome to contribute). The
> existing and more formal mechanisms for approving commits seem to
> work fine as a way of controlling the quality of code.

I like "sponsor". In contrast, "primary maintainer" implies (at least to 
me) a lot of ownership over a section of code, which doesn't seem to fit 
into the Apache style.

> Improving the workflow means, to me, coaching and leadership, and
> different kinds of code review. Someone who isn't very good at C
> (like me) might well want to make a code contribution but not be sure
> how. I saw recently how much perseverance Yingqi Lu put in towards
> getting SO_REUSEPORT support into trunk and then into 2.4.17 – and
> that's great. It's unfortunate that the same perseverance also offers
> a lesson about the kind of barriers that a would-be contributor might
> encounter.
>
> So, sponsorship can be about encouraging participation and progress.
> I'm imagining someone who rarely has to settle a decision – those
> should stay consensual and democratic - but often leads discussions
> and moves things on.

I like this. So your sponsor's qualities (coaching/servant 
leadership/facilitation) are primarily to break down the barriers to 
contribution.

I think there are now two topics of conversation, though. To wrap this 
back around to Jim's question, which was about the "patchiness" of the 
server (sorry, Jim, for somewhat derailing your thread)...

In addition to a sponsor, having someone with "the grand vision" for a 
section of the server would be good too. Someone who tries to be 
involved with related patches, to ensure that work in one area does not 
conflict with other (un)related work... basically, to make sure that a 
piece of the server is moving in one direction at once. (I would call 
such a person an "architect", though I think that term is probably 
loaded with a lot of baggage for those of you in the corporate world.)

I don't know if a sponsor and an architect could/should/would be the 
same person in httpd's case; I don't even know if either of those roles 
makes sense in Apache culture. And I understand that this is a volunteer 
project and not a corporation. But from the outside looking in, it would 
be nice if both roles were filled for various parts of the server. Maybe 
they already are filled, and I just can't see them?

--Jacob

From dev-return-84470-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Tue Oct 27 00:28:23 2015
Return-Path: <dev-return-84470-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 5C73F18221
	for <apmail-httpd-dev-archive@www.apache.org>; Tue, 27 Oct 2015 00:28:23 +0000 (UTC)
Received: (qmail 39945 invoked by uid 500); 27 Oct 2015 00:28:22 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 39876 invoked by uid 500); 27 Oct 2015 00:28:22 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 39866 invoked by uid 99); 27 Oct 2015 00:28:22 -0000
Received: from Unknown (HELO spamd4-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 27 Oct 2015 00:28:22 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd4-us-west.apache.org (ASF Mail Server at spamd4-us-west.apache.org) with ESMTP id 34AD6C13D0
	for <dev@httpd.apache.org>; Tue, 27 Oct 2015 00:28:22 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd4-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.102
X-Spam-Level:
X-Spam-Status: No, score=-0.102 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RCVD_IN_MSPIKE_H2=-0.001, SPF_PASS=-0.001] autolearn=disabled
Authentication-Results: spamd4-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd4-us-west.apache.org [10.40.0.11]) (amavisd-new, port 10024)
	with ESMTP id jK6SVxVb8ImR for <dev@httpd.apache.org>;
	Tue, 27 Oct 2015 00:28:21 +0000 (UTC)
Received: from mail-pa0-f47.google.com (mail-pa0-f47.google.com [209.85.220.47])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id AA1FE20C4B
	for <dev@httpd.apache.org>; Tue, 27 Oct 2015 00:28:20 +0000 (UTC)
Received: by padhk11 with SMTP id hk11so203366796pad.1
        for <dev@httpd.apache.org>; Mon, 26 Oct 2015 17:28:19 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=subject:to:references:from:message-id:date:user-agent:mime-version
         :in-reply-to:content-type:content-transfer-encoding;
        bh=YfVkBMvLNOFvwUrsMZRIokggEkzmLE8xNk9Q89cND4Y=;
        b=bUmx/PqSe/zZpVy481yqaXDIYdZNuE5A5kIijdmCZePDW78houMgmrX+e0jGH6LDJ5
         ez5LX4jXKc9psCWyEidFafXac/RHajJM1sGqCyqg6JelZoHTY8vIeM6VngqKDYSBVGZb
         JwnKJRMz5YPjiKzaZwjxfi5HZigubEVZfYkPuFZZkXa0KInREW8UXux0I6SkrVyjXY4A
         nY8uLY8NiFMNawmorRckuLd39hQItxLYG/JHSOhxq2Kr9DU6P8spze2j6vvhrkh/TiJ5
         Zp312Cump8J+MzeRYbcdZcRx7k4BHNfzGPhST4MCRqi4GbhMSKoNsvykqLzYcSkKBuB+
         Bzog==
X-Received: by 10.68.131.36 with SMTP id oj4mr24745828pbb.141.1445905699416;
        Mon, 26 Oct 2015 17:28:19 -0700 (PDT)
Received: from [192.168.1.4] (static-50-43-55-221.bvtn.or.frontiernet.net. [50.43.55.221])
        by smtp.gmail.com with ESMTPSA id be3sm36005767pbc.88.2015.10.26.17.28.18
        for <dev@httpd.apache.org>
        (version=TLSv1/SSLv3 cipher=OTHER);
        Mon, 26 Oct 2015 17:28:18 -0700 (PDT)
Subject: Re: Is Apache getting too patchy?
To: dev@httpd.apache.org
References: <38B6AA15-AB3C-47AC-B96D-7DA8094F99F9@jaguNET.com>
 <562E5A1F.9080201@gmail.com> <20151026222322.232ef884@baldur>
From: Jacob Champion <champion.p@gmail.com>
Message-ID: <562EC521.9020309@gmail.com>
Date: Mon, 26 Oct 2015 17:28:17 -0700
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:38.0) Gecko/20100101
 Thunderbird/38.3.0
MIME-Version: 1.0
In-Reply-To: <20151026222322.232ef884@baldur>
Content-Type: text/plain; charset=windows-1252; format=flowed
Content-Transfer-Encoding: 7bit

On 10/26/2015 03:23 PM, Nick Kew wrote:
> On Mon, 26 Oct 2015 09:51:43 -0700
> Jacob Champion <champion.p@gmail.com> wrote:
>> I'd rather not feel like I'm just annoying dev@ until you submit my
>> stuff -- I want to *talk* about it, and improve the server.
>
> That may not be easy.  You need to find someone who'll be
> interested in an idea or patch, and has the time to review it.
> Plus, the community as a whole to agree it's a good idea,
> or at least not actively oppose it.

That's fine by me. I don't think it necessarily needs to be _easy_ -- 
making it too easy to submit code loosens the codebase, which I think is 
what Jim's original mail is asking about -- but at the same time it 
shouldn't be like talking to a wall.

In other words, I find it very difficult to keep a conversation going 
here, and in my experience, it's the conversations that keep codebases 
healthy.

> I wonder if workflow would be improved if we had named
> maintainers for particular parts of the codebase - for
> example individual modules?  Not necessarily to do all
> the work, but to take primary responsibility to see that
> your ideas don't just fall through the gaps and get ignored?

See my reply to Tim.

--Jacob

From dev-return-84471-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Tue Oct 27 10:27:14 2015
Return-Path: <dev-return-84471-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 0E8541862E
	for <apmail-httpd-dev-archive@www.apache.org>; Tue, 27 Oct 2015 10:27:14 +0000 (UTC)
Received: (qmail 61835 invoked by uid 500); 27 Oct 2015 10:27:10 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 61734 invoked by uid 500); 27 Oct 2015 10:27:10 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 61724 invoked by uid 99); 27 Oct 2015 10:27:10 -0000
Received: from Unknown (HELO spamd2-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 27 Oct 2015 10:27:10 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd2-us-west.apache.org (ASF Mail Server at spamd2-us-west.apache.org) with ESMTP id EE6201A2CEB
	for <dev@httpd.apache.org>; Tue, 27 Oct 2015 10:27:09 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd2-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.01
X-Spam-Level:
X-Spam-Status: No, score=-0.01 tagged_above=-999 required=6.31
	tests=[SPF_PASS=-0.001, T_RP_MATCHES_RCVD=-0.01, URIBL_BLOCKED=0.001]
	autolearn=disabled
Received: from mx1-us-west.apache.org ([10.40.0.8])
	by localhost (spamd2-us-west.apache.org [10.40.0.9]) (amavisd-new, port 10024)
	with ESMTP id 8XNznkS4lYxw for <dev@httpd.apache.org>;
	Tue, 27 Oct 2015 10:27:02 +0000 (UTC)
Received: from monica.sharp.fm (monica.sharp.fm [80.168.143.5])
	by mx1-us-west.apache.org (ASF Mail Server at mx1-us-west.apache.org) with ESMTP id D4CE520751
	for <dev@httpd.apache.org>; Tue, 27 Oct 2015 10:27:01 +0000 (UTC)
Received: from [10.105.13.202] (unknown [5.56.169.82])
	(using TLSv1 with cipher DHE-RSA-AES256-SHA (256/256 bits))
	(Client did not present a certificate)
	(Authenticated sender: minfrin@sharp.fm)
	by monica.sharp.fm (Postfix) with ESMTPSA id 3DFFB80546
	for <dev@httpd.apache.org>; Tue, 27 Oct 2015 10:26:55 +0000 (GMT)
Content-Type: text/plain; charset=utf-8
Mime-Version: 1.0 (Mac OS X Mail 8.2 \(2104\))
Subject: Re: Is Apache getting too patchy?
From: Graham Leggett <minfrin@sharp.fm>
In-Reply-To: <40FF7659-3F5A-4010-9A4B-D7E09B9ACF95@c8h10n4o2.org.uk>
Date: Tue, 27 Oct 2015 12:26:54 +0200
Content-Transfer-Encoding: quoted-printable
Message-Id: <995B8E3C-91B1-4A36-9940-A91EE86AE9B1@sharp.fm>
References: <38B6AA15-AB3C-47AC-B96D-7DA8094F99F9@jaguNET.com> <562E5A1F.9080201@gmail.com> <20151026222322.232ef884@baldur> <40FF7659-3F5A-4010-9A4B-D7E09B9ACF95@c8h10n4o2.org.uk>
To: dev@httpd.apache.org
X-Mailer: Apple Mail (2.2104)

On 27 Oct 2015, at 12:40 AM, Tim Bannister <isoma@c8h10n4o2.org.uk> =
wrote:

>> That may not be easy.  You need to find someone who'll be interested =
in an idea or patch, and has the time to review it.
>> Plus, the community as a whole to agree it's a good idea, or at least =
not actively oppose it.
>>=20
>> I wonder if workflow would be improved if we had named maintainers =
for particular parts of the codebase - for example individual modules?  =
Not necessarily to do all the work, but to take primary responsibility =
to see that your ideas don't just fall through the gaps and get ignored?
>=20
> How does the word =E2=80=9Csponsor=E2=80=9D sound?

It rhymes with =E2=80=9Cbureaucracy=E2=80=9D. :)

Remember the end goal is to improve quality without causing stagnation, =
and giving people the impression that they need to ask a =E2=80=9Csponsor=E2=
=80=9D first who may no longer be involved with the project will cause =
that stagnation.

The most exciting work on httpd for me has been Christophe Jaillet=E2=80=99=
s memory optimisation patches. With each patch the code gets cleaner and =
the server gets faster. We need more of this kind of stuff.

Regards,
Graham
=E2=80=94


From dev-return-84472-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Tue Oct 27 10:38:24 2015
Return-Path: <dev-return-84472-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 04AA018A79
	for <apmail-httpd-dev-archive@www.apache.org>; Tue, 27 Oct 2015 10:38:24 +0000 (UTC)
Received: (qmail 16758 invoked by uid 500); 27 Oct 2015 10:38:23 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 16685 invoked by uid 500); 27 Oct 2015 10:38:23 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 16675 invoked by uid 99); 27 Oct 2015 10:38:23 -0000
Received: from Unknown (HELO spamd3-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 27 Oct 2015 10:38:23 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd3-us-west.apache.org (ASF Mail Server at spamd3-us-west.apache.org) with ESMTP id E254F1809F8
	for <dev@httpd.apache.org>; Tue, 27 Oct 2015 10:38:22 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd3-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.1
X-Spam-Level:
X-Spam-Status: No, score=-0.1 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	SPF_PASS=-0.001, URIBL_BLOCKED=0.001] autolearn=disabled
Authentication-Results: spamd3-us-west.apache.org (amavisd-new);
	dkim=pass (1024-bit key) header.d=maven.pl
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd3-us-west.apache.org [10.40.0.10]) (amavisd-new, port 10024)
	with ESMTP id 2fIKcLjc95HP for <dev@httpd.apache.org>;
	Tue, 27 Oct 2015 10:38:12 +0000 (UTC)
Received: from mail-wi0-f180.google.com (mail-wi0-f180.google.com [209.85.212.180])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id BD60520924
	for <dev@httpd.apache.org>; Tue, 27 Oct 2015 10:38:11 +0000 (UTC)
Received: by wicll6 with SMTP id ll6so152975199wic.0
        for <dev@httpd.apache.org>; Tue, 27 Oct 2015 03:38:11 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=maven.pl; s=maven;
        h=from:to:subject:date:user-agent:references:in-reply-to:mime-version
         :content-type:content-transfer-encoding:message-id;
        bh=vRuPyvcYINe4xtjCh+aex3K2SGfJOaBhDccgjHIKIZc=;
        b=E/mPhmW20fMSZzjJn2DALwi0BASuVLb9L6pYKueimn+C8S4hEOFWg60KnZa8sZEu4k
         20Qla8wlCamRMTxvaa656eJJ6O1SWqtbgxqu8hPh5KnnsrMiF1ftvEhCfBWQVkHakwRU
         lAL/eY29unq1nSp1gIXHVh7tFcU8ihR9ucTQo=
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=1e100.net; s=20130820;
        h=x-gm-message-state:from:to:subject:date:user-agent:references
         :in-reply-to:mime-version:content-type:content-transfer-encoding
         :message-id;
        bh=vRuPyvcYINe4xtjCh+aex3K2SGfJOaBhDccgjHIKIZc=;
        b=ftTlLK/5pvMbk+B47QY2R5fz0qR6UeXp9jxHHnUaofQ8YTZRACVKujPHS60dMWHZ/b
         XmrspIvbtMySrMYKM/fgE+wejcFeyiNW2+xWoZ5OCkxHK8F8FR+5qbzu11dGSFaeFgnU
         3tgI5S+0h/ovs4ZmXEdsBKMCaToKnbwFNk7t51+gcQT/26fx/DSXur+EmZLjwOLX0sI4
         HbGOa6P84gixWpJ0+dwb13kJV75/XSBGTzT88zrqoOrByhUauOnG5RZIPIACnfNekFSd
         90v4Xp6fILcHNpfaE0XmdkuDl/AjUppz2j9ti+BnSR6KgG+HxIm2P+G2EaufCN1krZk8
         J2Vg==
X-Gm-Message-State: ALoCoQlNO4GFbNDl7Sy3bP8d9noRd4kvTKS3HyHkJwAp7A8hivPuw61WBBfqsBTfSq69PRFGiZIC
X-Received: by 10.194.174.202 with SMTP id bu10mr31909824wjc.74.1445942291161;
        Tue, 27 Oct 2015 03:38:11 -0700 (PDT)
Received: from xps.localnet ([91.234.176.248])
        by smtp.gmail.com with ESMTPSA id he3sm44082210wjc.48.2015.10.27.03.38.09
        for <dev@httpd.apache.org>
        (version=TLSv1.2 cipher=ECDHE-RSA-AES128-GCM-SHA256 bits=128/128);
        Tue, 27 Oct 2015 03:38:10 -0700 (PDT)
From: Arkadiusz =?utf-8?q?Mi=C5=9Bkiewicz?= <arekm@maven.pl>
To: dev@httpd.apache.org
Subject: Re: Improve Apache performance on high load (prefork MPM) with multiple Accept mutexes (Patch attached)
Date: Tue, 27 Oct 2015 11:38:07 +0100
User-Agent: KMail/1.13.7 (Linux/4.3.0-rc7; KDE/4.14.13; x86_64; ; )
References: <6A49427F0EB5B44F9F1006B09A0A28F4F8B0B3E3@IL-EX10.ad.checkpoint.com> <1445858056.3909.113.camel@mimir.webthing.com> <6A49427F0EB5B44F9F1006B09A0A28F4F8B0B591@IL-EX10.ad.checkpoint.com>
In-Reply-To: <6A49427F0EB5B44F9F1006B09A0A28F4F8B0B591@IL-EX10.ad.checkpoint.com>
MIME-Version: 1.0
Content-Type: Text/Plain;
  charset="utf-8"
Content-Transfer-Encoding: quoted-printable
Message-Id: <201510271138.07476.arekm@maven.pl>

On Monday 26 of October 2015, Yehezkel Horowitz wrote:
> First, thanks Nick for the feedback.
>=20
> I have submitted https://bz.apache.org/bugzilla/show_bug.cgi?id=3D58550 as
> you suggested.
>=20
> >If a threaded MPM really isn't an option (for most users the obvious
> >solution), then the question is what works for you.
>=20
> I can't use threaded MPM as PHP (at least my version) doesn't support it.

Not only yours. php doesn't support thread safety for normal usage... it's=
=20
marked experimental for ages:

=46rom php 5.6/7.0 configure help:

"  --enable-maintainer-zts Enable thread safety - for code maintainers only=
!!"

=2D-=20
Arkadiusz Mi=C5=9Bkiewicz, arekm / ( maven.pl | pld-linux.org )

From dev-return-84473-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Tue Oct 27 16:10:16 2015
Return-Path: <dev-return-84473-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id B7AD91895D
	for <apmail-httpd-dev-archive@www.apache.org>; Tue, 27 Oct 2015 16:10:16 +0000 (UTC)
Received: (qmail 40488 invoked by uid 500); 27 Oct 2015 16:10:16 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 40409 invoked by uid 500); 27 Oct 2015 16:10:16 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 40396 invoked by uid 99); 27 Oct 2015 16:10:16 -0000
Received: from Unknown (HELO spamd1-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 27 Oct 2015 16:10:16 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd1-us-west.apache.org (ASF Mail Server at spamd1-us-west.apache.org) with ESMTP id A1F41C5B3F
	for <dev@httpd.apache.org>; Tue, 27 Oct 2015 16:10:15 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd1-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 3
X-Spam-Level: ***
X-Spam-Status: No, score=3 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, HTML_MESSAGE=3,
	SPF_PASS=-0.001, URIBL_BLOCKED=0.001] autolearn=disabled
Authentication-Results: spamd1-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=rowe-clan_net.20150623.gappssmtp.com
Received: from mx1-us-west.apache.org ([10.40.0.8])
	by localhost (spamd1-us-west.apache.org [10.40.0.7]) (amavisd-new, port 10024)
	with ESMTP id 9CyXRUhaq96l for <dev@httpd.apache.org>;
	Tue, 27 Oct 2015 16:10:09 +0000 (UTC)
Received: from mail-ig0-f171.google.com (mail-ig0-f171.google.com [209.85.213.171])
	by mx1-us-west.apache.org (ASF Mail Server at mx1-us-west.apache.org) with ESMTPS id 54A8620751
	for <dev@httpd.apache.org>; Tue, 27 Oct 2015 16:10:09 +0000 (UTC)
Received: by igbhv6 with SMTP id hv6so82811217igb.0
        for <dev@httpd.apache.org>; Tue, 27 Oct 2015 09:10:08 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=rowe-clan_net.20150623.gappssmtp.com; s=20150623;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        bh=m/Az7gOVTYd69QWFAvPF8GJr4DLONpHf/JSQrLKu8hs=;
        b=biqQIsJrEj2N/bZExeV+On+Ni2Dh4RrF24QoQKEcT6n8PFZiDAoDKQXXnIfAlhAbjZ
         6FJX74ffaYquIQ/ZkIRnhxbCEX1apk1hyRiCX1U9SyaYu5SbqP+e+fNZ78fdSDPkD9en
         Rcnm0oHvXS6NK9bdXm0Qz8pkaeI3gDnFSaiA9UO7qxcgSxSjL0WSRIXB9NiTPPlkY4ft
         iwUD0jd4ipeLwkcpbH2sp1a9fqEqfoji6GNZH/Gq4WnVafbfUgk1BhSjNVYHHlHq9lPo
         MTolEhStYkr9iqEWNe0qaNjsHDajlpiegqDT8Bi4uFm/JxG/Y0xYW60XTlM21BGz8/jW
         oQcw==
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=1e100.net; s=20130820;
        h=x-gm-message-state:mime-version:in-reply-to:references:date
         :message-id:subject:from:to:content-type;
        bh=m/Az7gOVTYd69QWFAvPF8GJr4DLONpHf/JSQrLKu8hs=;
        b=N1HhukR5zKMliT+VmvdJDJjqoBWC2HDmKfPvV5fGpNIK+3cL8j4Ge1g7u/3VFwTJn9
         +CRIEXISpiECtfJeETNf8DwLGCqAeejdAYYQ6WvEpqjslQX0w/VJtNLxm+4qiPZPLiAr
         QITlp/t28MMR2CU0JIWIMod8TfJV0bFZGU4SqDxbrn4vz1YDefg2W4Dt2MKkOTrwa2JE
         K10NrnP3XPN2elkbv5l6qOEQNSnqMPPjyCZ0XCIeoPBJBIi6gRfeG1WA+RSHqGP8d7I5
         1eM1+kbuTVxhc/cNH5sQYxMftetGubynMmyplSv5qsW+BVyjB3U2RdLoraqzCF4B9PYM
         VTbQ==
X-Gm-Message-State: ALoCoQkzYULe1qVLzENG0AXf+ShEcyfUK2GE05uhu6q6RRzUVH50EhfeorkAJ2GN4E+XcxodSiCw
MIME-Version: 1.0
X-Received: by 10.50.32.69 with SMTP id g5mr26859356igi.35.1445962208339; Tue,
 27 Oct 2015 09:10:08 -0700 (PDT)
Received: by 10.107.3.88 with HTTP; Tue, 27 Oct 2015 09:10:08 -0700 (PDT)
Received: by 10.107.3.88 with HTTP; Tue, 27 Oct 2015 09:10:08 -0700 (PDT)
In-Reply-To: <201510271138.07476.arekm@maven.pl>
References: <6A49427F0EB5B44F9F1006B09A0A28F4F8B0B3E3@IL-EX10.ad.checkpoint.com>
	<1445858056.3909.113.camel@mimir.webthing.com>
	<6A49427F0EB5B44F9F1006B09A0A28F4F8B0B591@IL-EX10.ad.checkpoint.com>
	<201510271138.07476.arekm@maven.pl>
Date: Tue, 27 Oct 2015 11:10:08 -0500
Message-ID: <CACsi250rmJNAYhSAPVTubUtz8=MBgqeZfSF6zr3MC=3U+b5kZw@mail.gmail.com>
Subject: Re: Improve Apache performance on high load (prefork MPM) with
 multiple Accept mutexes (Patch attached)
From: William A Rowe Jr <wrowe@rowe-clan.net>
To: httpd <dev@httpd.apache.org>
Content-Type: multipart/alternative; boundary=047d7b10d0dfc986f30523184fe2

--047d7b10d0dfc986f30523184fe2
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: quoted-printable

On Oct 27, 2015 05:38, "Arkadiusz Mi=C5=9Bkiewicz" <arekm@maven.pl> wrote:
>
> On Monday 26 of October 2015, Yehezkel Horowitz wrote:
> > First, thanks Nick for the feedback.
> >
> > I have submitted https://bz.apache.org/bugzilla/show_bug.cgi?id=3D58550=
 as
> > you suggested.
> >
> > >If a threaded MPM really isn't an option (for most users the obvious
> > >solution), then the question is what works for you.
> >
> > I can't use threaded MPM as PHP (at least my version) doesn't support
it.
>
> Not only yours. php doesn't support thread safety for normal usage... it'=
s
> marked experimental for ages:
>
> From php 5.6/7.0 configure help:
>
> "  --enable-maintainer-zts Enable thread safety - for code maintainers
only!!"

In general, the thread safety does work, but is not as efficient as it
could be.

Which is why most php developers and users rely on fastcgi (in httpd,
either through mod_fcgid or mod_proxy_fcgi).  It is generally cleaner and
more efficient to run a smaller pool of php fcgi responders to service most
applications, keep the benefits of the event (or worker) mpm in httpd.
mod_php is a bit heavyweight to hold memory reservations on every httpd
worker.

Properly tuned you should see excellent performance, depending on whether
your php scripts tend to block (remote SQL access, for example) - but
efficient php can probably be tuned at 2 workers per core and adjust from
there.

--047d7b10d0dfc986f30523184fe2
Content-Type: text/html; charset=UTF-8
Content-Transfer-Encoding: quoted-printable

<p dir=3D"ltr">On Oct 27, 2015 05:38, &quot;Arkadiusz Mi=C5=9Bkiewicz&quot;=
 &lt;<a href=3D"mailto:arekm@maven.pl">arekm@maven.pl</a>&gt; wrote:<br>
&gt;<br>
&gt; On Monday 26 of October 2015, Yehezkel Horowitz wrote:<br>
&gt; &gt; First, thanks Nick for the feedback.<br>
&gt; &gt;<br>
&gt; &gt; I have submitted <a href=3D"https://bz.apache.org/bugzilla/show_b=
ug.cgi?id=3D58550">https://bz.apache.org/bugzilla/show_bug.cgi?id=3D58550</=
a> as<br>
&gt; &gt; you suggested.<br>
&gt; &gt;<br>
&gt; &gt; &gt;If a threaded MPM really isn&#39;t an option (for most users =
the obvious<br>
&gt; &gt; &gt;solution), then the question is what works for you.<br>
&gt; &gt;<br>
&gt; &gt; I can&#39;t use threaded MPM as PHP (at least my version) doesn&#=
39;t support it.<br>
&gt;<br>
&gt; Not only yours. php doesn&#39;t support thread safety for normal usage=
... it&#39;s<br>
&gt; marked experimental for ages:<br>
&gt;<br>
&gt; From php 5.6/7.0 configure help:<br>
&gt;<br>
&gt; &quot;=C2=A0 --enable-maintainer-zts Enable thread safety - for code m=
aintainers only!!&quot;</p>
<p dir=3D"ltr">In general, the thread safety does work, but is not as effic=
ient as it could be.</p>
<p dir=3D"ltr">Which is why most php developers and users rely on fastcgi (=
in httpd, either through mod_fcgid or mod_proxy_fcgi).=C2=A0 It is generall=
y cleaner and more efficient to run a smaller pool of php fcgi responders t=
o service most applications, keep the benefits of the event (or worker) mpm=
 in httpd. mod_php is a bit heavyweight to hold memory reservations on ever=
y httpd worker.</p>
<p dir=3D"ltr">Properly tuned you should see excellent performance, dependi=
ng on whether your php scripts tend to block (remote SQL access, for exampl=
e) - but efficient php can probably be tuned at 2 workers per core and adju=
st from there.</p>

--047d7b10d0dfc986f30523184fe2--

From dev-return-84474-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Tue Oct 27 16:28:29 2015
Return-Path: <dev-return-84474-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 1FFD818A62
	for <apmail-httpd-dev-archive@www.apache.org>; Tue, 27 Oct 2015 16:28:29 +0000 (UTC)
Received: (qmail 93533 invoked by uid 500); 27 Oct 2015 16:28:06 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 93460 invoked by uid 500); 27 Oct 2015 16:28:06 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 93450 invoked by uid 99); 27 Oct 2015 16:28:06 -0000
Received: from Unknown (HELO spamd2-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 27 Oct 2015 16:28:06 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd2-us-west.apache.org (ASF Mail Server at spamd2-us-west.apache.org) with ESMTP id 2F2DA1A1F2C
	for <dev@httpd.apache.org>; Tue, 27 Oct 2015 16:28:06 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd2-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.099
X-Spam-Level:
X-Spam-Status: No, score=-0.099 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	URIBL_BLOCKED=0.001] autolearn=disabled
Authentication-Results: spamd2-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd2-us-west.apache.org [10.40.0.9]) (amavisd-new, port 10024)
	with ESMTP id AsCp7UZ6G4P7 for <dev@httpd.apache.org>;
	Tue, 27 Oct 2015 16:27:54 +0000 (UTC)
Received: from mail-pa0-f49.google.com (mail-pa0-f49.google.com [209.85.220.49])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id 9153E43CD2
	for <dev@httpd.apache.org>; Tue, 27 Oct 2015 16:27:54 +0000 (UTC)
Received: by pabla5 with SMTP id la5so34008532pab.0
        for <dev@httpd.apache.org>; Tue, 27 Oct 2015 09:27:54 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=subject:to:references:from:message-id:date:user-agent:mime-version
         :in-reply-to:content-type:content-transfer-encoding;
        bh=/NptK3JYGEMfSZcPLNzWE9Ihhks6YUp/9Lj5V4EkyQA=;
        b=aBW5ulXaYxmshtRVo8vY6YqPK4hZWgwAg/Vm1bBpjso0glLKGWXVVYWZTJv+i4kzSv
         HAxUIbxHPniTcC8xsZ6os5YSaDZflYmiNZlPqNWLMF/cCaBk9v3rN26/apvkYgLib2XP
         bRIUpqTuCVNjBSRwCB+F5tAvLzWJ4ueSLyZt0O17nUE9y5LAPYsThf2zXFqlHip5SQJ7
         WV8JYyw26DOBXavuA7ikvwbdx6qiHVycld5r2g1olXL8guWS4prxONuZ9RRDEiXz+ElC
         LhPNxKRQlDpvLhOctDVSa9U8VHat7XTMUGY1NKmXwGXBkQQfEXdoiEpCa9a767IIzvb/
         QPsw==
X-Received: by 10.66.132.37 with SMTP id or5mr47743030pab.5.1445963273890;
        Tue, 27 Oct 2015 09:27:53 -0700 (PDT)
Received: from [192.168.1.4] (static-50-43-55-221.bvtn.or.frontiernet.net. [50.43.55.221])
        by smtp.gmail.com with ESMTPSA id q8sm40729593pap.34.2015.10.27.09.27.52
        for <dev@httpd.apache.org>
        (version=TLSv1.2 cipher=ECDHE-RSA-AES128-GCM-SHA256 bits=128/128);
        Tue, 27 Oct 2015 09:27:52 -0700 (PDT)
Subject: Re: Is Apache getting too patchy?
To: dev@httpd.apache.org
References: <38B6AA15-AB3C-47AC-B96D-7DA8094F99F9@jaguNET.com>
 <562E5A1F.9080201@gmail.com> <20151026222322.232ef884@baldur>
 <40FF7659-3F5A-4010-9A4B-D7E09B9ACF95@c8h10n4o2.org.uk>
 <995B8E3C-91B1-4A36-9940-A91EE86AE9B1@sharp.fm>
From: Jacob Champion <champion.p@gmail.com>
Message-ID: <562FA608.8020501@gmail.com>
Date: Tue, 27 Oct 2015 09:27:52 -0700
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:38.0) Gecko/20100101
 Thunderbird/38.3.0
MIME-Version: 1.0
In-Reply-To: <995B8E3C-91B1-4A36-9940-A91EE86AE9B1@sharp.fm>
Content-Type: text/plain; charset=utf-8; format=flowed
Content-Transfer-Encoding: 8bit

On 10/27/2015 03:26 AM, Graham Leggett wrote:
> On 27 Oct 2015, at 12:40 AM, Tim Bannister <isoma@c8h10n4o2.org.uk>
> wrote:
>
>>> That may not be easy.  You need to find someone who'll be
>>> interested in an idea or patch, and has the time to review it.
>>> Plus, the community as a whole to agree it's a good idea, or at
>>> least not actively oppose it.
>>>
>>> I wonder if workflow would be improved if we had named
>>> maintainers for particular parts of the codebase - for example
>>> individual modules?  Not necessarily to do all the work, but to
>>> take primary responsibility to see that your ideas don't just
>>> fall through the gaps and get ignored?
>>
>> How does the word “sponsor” sound?
>
> It rhymes with “bureaucracy”. :)
>
> Remember the end goal is to improve quality without causing
> stagnation,

I agree that adding process always carries the risk of red tape (more so 
when people like me, outside an organization, propose processes for 
people inside it). We all want to avoid a stagnant codebase. I would 
also like to de-stagnate the communication, that's all.

> and giving people the impression that they need to ask a “sponsor”
> first who may no longer be involved with the project will cause that
> stagnation.

My first thought is, "then don't give people that impression." To me,
Nick and Tim's suggestions sounded more like "community liaison" than 
"code owner".

> The most exciting work on httpd for me has been Christophe Jaillet’s
> memory optimisation patches. With each patch the code gets cleaner
> and the server gets faster. We need more of this kind of stuff.

How would you improve the process and encourage those sorts of patches, 
then, from someone who _isn't_ in the httpd committers list? It seems to 
me that optimization needs to be done by experts in a codebase, not by 
newbies. And code cleanup is difficult when you don't already have a 
clear direction to push the code in.

--Jacob

From dev-return-84475-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Tue Oct 27 17:55:05 2015
Return-Path: <dev-return-84475-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 9952B172B3
	for <apmail-httpd-dev-archive@www.apache.org>; Tue, 27 Oct 2015 17:55:05 +0000 (UTC)
Received: (qmail 31561 invoked by uid 500); 27 Oct 2015 17:54:58 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 31497 invoked by uid 500); 27 Oct 2015 17:54:58 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 31487 invoked by uid 99); 27 Oct 2015 17:54:58 -0000
Received: from Unknown (HELO spamd2-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 27 Oct 2015 17:54:58 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd2-us-west.apache.org (ASF Mail Server at spamd2-us-west.apache.org) with ESMTP id D12911A28C8
	for <dev@httpd.apache.org>; Tue, 27 Oct 2015 17:54:57 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd2-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 1.364
X-Spam-Level: *
X-Spam-Status: No, score=1.364 tagged_above=-999 required=6.31
	tests=[KAM_LAZY_DOMAIN_SECURITY=1, RDNS_DYNAMIC=0.363,
	URIBL_BLOCKED=0.001] autolearn=disabled
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd2-us-west.apache.org [10.40.0.9]) (amavisd-new, port 10024)
	with ESMTP id 2IldvFYAv1HK for <dev@httpd.apache.org>;
	Tue, 27 Oct 2015 17:54:49 +0000 (UTC)
Received: from gungnir.webthing.com (209-20-83-52.slicehost.net [209.20.83.52])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTP id A86DA439E9
	for <dev@httpd.apache.org>; Tue, 27 Oct 2015 17:54:49 +0000 (UTC)
Received: from baldur (cpc36-newt30-2-0-cust898.19-3.cable.virginm.net [82.32.195.131])
	by gungnir.webthing.com (Postfix) with ESMTPSA id 9ACE2E8C51
	for <dev@httpd.apache.org>; Tue, 27 Oct 2015 17:54:42 +0000 (UTC)
Date: Tue, 27 Oct 2015 17:54:38 +0000
From: Nick Kew <nick@webthing.com>
To: dev@httpd.apache.org
Subject: Re: Improve Apache performance on high load (prefork MPM) with
 multiple Accept mutexes (Patch attached)
Message-ID: <20151027175438.110a4191@baldur>
In-Reply-To: <CACsi250rmJNAYhSAPVTubUtz8=MBgqeZfSF6zr3MC=3U+b5kZw@mail.gmail.com>
References: <6A49427F0EB5B44F9F1006B09A0A28F4F8B0B3E3@IL-EX10.ad.checkpoint.com>
	<1445858056.3909.113.camel@mimir.webthing.com>
	<6A49427F0EB5B44F9F1006B09A0A28F4F8B0B591@IL-EX10.ad.checkpoint.com>
	<201510271138.07476.arekm@maven.pl>
	<CACsi250rmJNAYhSAPVTubUtz8=MBgqeZfSF6zr3MC=3U+b5kZw@mail.gmail.com>
X-Mailer: Claws Mail 3.7.4 (GTK+ 2.20.1; i486-pc-linux-gnu)
Mime-Version: 1.0
Content-Type: text/plain; charset=US-ASCII
Content-Transfer-Encoding: 7bit

On Tue, 27 Oct 2015 11:10:08 -0500
William A Rowe Jr <wrowe@rowe-clan.net> wrote:


> In general, the thread safety does work, but is not as efficient as it
> could be.

Last I looked, PHP throws in quite a kitchen-sink, including
components like old libraries (like libgif, libjpeg) written
back in the 1980s for commandline and desktop programs.
Far from thread-safe.

It also did some Bad Things like global customisation of
libraries like libxml2, so that another application might
unintentionally get PHP's substitute handlers leading 
usually to segfault and potentially worse.  Though that
is very out-of-date.

Hence, always best to use it in its own fastcgi environment
where it won't mess with anything else in the server.

-- 
Nick Kew

From dev-return-84476-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Tue Oct 27 17:57:38 2015
Return-Path: <dev-return-84476-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id E8018172CF
	for <apmail-httpd-dev-archive@www.apache.org>; Tue, 27 Oct 2015 17:57:37 +0000 (UTC)
Received: (qmail 40458 invoked by uid 500); 27 Oct 2015 17:57:37 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 40394 invoked by uid 500); 27 Oct 2015 17:57:37 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 40384 invoked by uid 99); 27 Oct 2015 17:57:36 -0000
Received: from Unknown (HELO spamd4-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 27 Oct 2015 17:57:36 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd4-us-west.apache.org (ASF Mail Server at spamd4-us-west.apache.org) with ESMTP id 8D629C09DF
	for <dev@httpd.apache.org>; Tue, 27 Oct 2015 17:57:36 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd4-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.102
X-Spam-Level:
X-Spam-Status: No, score=-0.102 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RCVD_IN_MSPIKE_H2=-0.001, SPF_PASS=-0.001] autolearn=disabled
Authentication-Results: spamd4-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-us-west.apache.org ([10.40.0.8])
	by localhost (spamd4-us-west.apache.org [10.40.0.11]) (amavisd-new, port 10024)
	with ESMTP id M7KDAIqmJ5dq for <dev@httpd.apache.org>;
	Tue, 27 Oct 2015 17:57:36 +0000 (UTC)
Received: from mail-io0-f174.google.com (mail-io0-f174.google.com [209.85.223.174])
	by mx1-us-west.apache.org (ASF Mail Server at mx1-us-west.apache.org) with ESMTPS id E069D20F1E
	for <dev@httpd.apache.org>; Tue, 27 Oct 2015 17:57:35 +0000 (UTC)
Received: by iofz202 with SMTP id z202so229672049iof.2
        for <dev@httpd.apache.org>; Tue, 27 Oct 2015 10:57:35 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=mime-version:date:message-id:subject:from:to:content-type;
        bh=DPL+B6qI9pBqttzoly8fwDmhfb6XbSurmGHaGQ85R2o=;
        b=h9xItxUqbrM5I91tC7l68IEUTEkxqf0Oxd5Idz94YvdFBQ4tswRNn7uj4ChMkI8ANd
         bvOfEd8xwMguSB2ex1MHEyvLJP/hdh14DJQN0TTlAukVXIpNb4KGpYC9Qklrz38+8UF7
         3Txh1xVLBiwkbXc7Yksze0w0+o3q2gKkM2X0Ua9POOdL/iWqv5DQvJdHnWhDi3huPBJ4
         OGbuZM29P0/pR9aGwV0BGyIVRVgvnTsKbsGK3upzqdiH/2XABTMvi0uirhFHLjDzSGCU
         Hf/4T+ifQvUJS+Hklq4urKDuozAsB4gbSWLY3DDd4/egU1y2KBUzUOlWqS2gtI2BDA7o
         Te4g==
MIME-Version: 1.0
X-Received: by 10.107.167.16 with SMTP id q16mr12171544ioe.169.1445968655390;
 Tue, 27 Oct 2015 10:57:35 -0700 (PDT)
Received: by 10.64.112.69 with HTTP; Tue, 27 Oct 2015 10:57:35 -0700 (PDT)
Date: Tue, 27 Oct 2015 13:57:35 -0400
Message-ID: <CALK=YjOwDPyAwsBv15AHF3YF3PSFFb_rt8yE8QnbuydNRH8W=w@mail.gmail.com>
Subject: ap_init_rng / apr_random question
From: Eric Covener <covener@gmail.com>
To: Apache HTTP Server Development List <dev@httpd.apache.org>
Content-Type: text/plain; charset=UTF-8

IIUC, it takes something like 32k of /dev/random to initialize apr_random.

APR_RANDOM_DEFAULT_POOLS*APR_RANDOM_DEFAULT_RESEED_SIZE*APR_RANDOM_DEFAULT_G_FOR_INSECURE
(32*32*32)

But ap_init_rng() does this with ~4000 8-byte reads of /dev/random.

I am working on a platform where access to the crypto facility
underneath /dev/random is sometimes audited.  Does anyone have any
hints about whether larger reads from /dev/random would be better
elsewhere? Or if the startup requirement is really this high for data
from /dev/random?

From dev-return-84477-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Tue Oct 27 18:18:11 2015
Return-Path: <dev-return-84477-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 39632173E4
	for <apmail-httpd-dev-archive@www.apache.org>; Tue, 27 Oct 2015 18:18:11 +0000 (UTC)
Received: (qmail 301 invoked by uid 500); 27 Oct 2015 18:18:10 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 229 invoked by uid 500); 27 Oct 2015 18:18:10 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 219 invoked by uid 99); 27 Oct 2015 18:18:10 -0000
Received: from Unknown (HELO spamd2-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 27 Oct 2015 18:18:10 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd2-us-west.apache.org (ASF Mail Server at spamd2-us-west.apache.org) with ESMTP id E240B1A0A0B
	for <dev@httpd.apache.org>; Tue, 27 Oct 2015 18:18:09 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd2-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.101
X-Spam-Level:
X-Spam-Status: No, score=-0.101 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RCVD_IN_MSPIKE_H2=-0.001] autolearn=disabled
Authentication-Results: spamd2-us-west.apache.org (amavisd-new);
	dkim=pass (1024-bit key) header.d=gbiv.com
Received: from mx1-us-west.apache.org ([10.40.0.8])
	by localhost (spamd2-us-west.apache.org [10.40.0.9]) (amavisd-new, port 10024)
	with ESMTP id B2Wg9F_7KeTx for <dev@httpd.apache.org>;
	Tue, 27 Oct 2015 18:18:09 +0000 (UTC)
Received: from homiemail-a106.g.dreamhost.com (sub4.mail.dreamhost.com [69.163.253.135])
	by mx1-us-west.apache.org (ASF Mail Server at mx1-us-west.apache.org) with ESMTP id 738F520F43
	for <dev@httpd.apache.org>; Tue, 27 Oct 2015 18:18:07 +0000 (UTC)
Received: from homiemail-a106.g.dreamhost.com (localhost [127.0.0.1])
	by homiemail-a106.g.dreamhost.com (Postfix) with ESMTP id 0C3112005D033
	for <dev@httpd.apache.org>; Tue, 27 Oct 2015 11:17:52 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha1; c=relaxed; d=gbiv.com; h=content-type
	:mime-version:subject:from:in-reply-to:date
	:content-transfer-encoding:message-id:references:to; s=gbiv.com;
	 bh=yLsAvsCwt0BU8+bzZ0bvwhnDT3M=; b=ZdWEAcZpw6+DgTNRv4yF9SHRx/wm
	yKqcyEMJZ307+S7KvHfH9ZGsaqNsUpIKFa89+olEbaoWxJcarpnBP0BlSxeiUDkp
	ZWWtlHsjrAhV1Bazt81ih/saOUY5RU/uYyrZKTgLHRijT0jitSbmxNoolljC0WLc
	DV6b7HbyVLL1zAk=
Received: from [192.168.1.2] (ip68-228-71-159.oc.oc.cox.net [68.228.71.159])
	(using TLSv1 with cipher ECDHE-RSA-AES256-SHA (256/256 bits))
	(No client certificate requested)
	(Authenticated sender: fielding@gbiv.com)
	by homiemail-a106.g.dreamhost.com (Postfix) with ESMTPSA id 4542D2005D01E
	for <dev@httpd.apache.org>; Tue, 27 Oct 2015 11:17:51 -0700 (PDT)
Content-Type: text/plain; charset=us-ascii
Mime-Version: 1.0 (Mac OS X Mail 8.2 \(2104\))
Subject: Re: svn commit: r1710723 - in /httpd/httpd/trunk: CHANGES modules/cache/cache_util.h
From: "Roy T. Fielding" <fielding@gbiv.com>
In-Reply-To: <20151027064504.2771C3A0910@svn01-us-west.apache.org>
Date: Tue, 27 Oct 2015 11:17:45 -0700
Content-Transfer-Encoding: quoted-printable
Message-Id: <A7987303-0342-46E0-8400-6B76F8CF7F85@gbiv.com>
References: <20151027064504.2771C3A0910@svn01-us-west.apache.org>
To: dev@httpd.apache.org
X-Mailer: Apple Mail (2.2104)

> On Oct 26, 2015, at 11:45 PM, jailletc36@apache.org wrote:
>=20
> Author: jailletc36
> Date: Tue Oct 27 06:45:03 2015
> New Revision: 1710723
>=20
> URL: http://svn.apache.org/viewvc?rev=3D1710723&view=3Drev
> Log:
> RFC2616 defines #rules as:
>   #rule
>      A construct "#" is defined, similar to "*", for defining lists of
>      elements. The full form is "<n>#<m>element" indicating at least
>      <n> and at most <m> elements, each separated by one or more =
commas
>      (",") and OPTIONAL linear white space (LWS). This makes the usual
>      form of lists very easy; a rule such as
>         ( *LWS element *( *LWS "," *LWS element ))
>      can be shown as
>         1#element
>=20
> It also defines Linear White Space (LWS) as:
>   LWS            =3D [CRLF] 1*( SP | HT )
>=20
>=20
> The actual implementation only accepts SP (Space) and not HT =
(Horizontal Tab) when parsing cache related header fields (i.e. "Vary", =
"Cache-Control" and "Pragma")

Well, to be more accurate: RFC7230 defines these (2616 no longer =
applies) and
the original algorithm did handle HT.  My bet is that someone screwed up =
an
automated TAB -> two space conversion and the code change got lost in =
the noise.

Your fix looks right, though.

....Roy


From dev-return-84478-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Wed Oct 28 00:00:28 2015
Return-Path: <dev-return-84478-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id B0DF41862F
	for <apmail-httpd-dev-archive@www.apache.org>; Wed, 28 Oct 2015 00:00:28 +0000 (UTC)
Received: (qmail 39928 invoked by uid 500); 28 Oct 2015 00:00:06 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 39850 invoked by uid 500); 28 Oct 2015 00:00:06 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 39840 invoked by uid 99); 28 Oct 2015 00:00:05 -0000
Received: from Unknown (HELO spamd3-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 28 Oct 2015 00:00:05 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd3-us-west.apache.org (ASF Mail Server at spamd3-us-west.apache.org) with ESMTP id 970E21809D2
	for <dev@httpd.apache.org>; Wed, 28 Oct 2015 00:00:05 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd3-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.102
X-Spam-Level:
X-Spam-Status: No, score=-0.102 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RCVD_IN_MSPIKE_H2=-0.001, SPF_PASS=-0.001] autolearn=disabled
Authentication-Results: spamd3-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd3-us-west.apache.org [10.40.0.10]) (amavisd-new, port 10024)
	with ESMTP id pqSb2TC2xpqn for <dev@httpd.apache.org>;
	Wed, 28 Oct 2015 00:00:05 +0000 (UTC)
Received: from mail-qk0-f176.google.com (mail-qk0-f176.google.com [209.85.220.176])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id C5663439E9
	for <dev@httpd.apache.org>; Wed, 28 Oct 2015 00:00:04 +0000 (UTC)
Received: by qkgb2 with SMTP id b2so7616761qkg.0
        for <dev@httpd.apache.org>; Tue, 27 Oct 2015 17:00:04 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        bh=WfPRjADOfSs77SWWcstz57TVghBNlRg2lr3pWX51e3U=;
        b=R9Vzw5rX1I6/U/gjE6kFzrVPCg1drd1CEJ+0+ly8Uzr/ooPwVYuefPS2LBaz+B9zW8
         FTKj4bFQVDYFXlWhZz6wM/z84BUqYHhX7IoZjqeKO7/F8gYaLUSFbJ7SZHyJRSbOOSAf
         uilZk41pQVTfjYeH0Y2kGAYOjv2zl7cw22O8oMKv/3OVb0PXh8gzS9BbLdMZFpqCTtIY
         cNNdfbSwwyaMgmxpjxe7JRBAq3s4Xm9YmKyNHcRquJHK1KapyCgJ448DZDraDcBIBBXg
         sAL69RR+ML2rcqDtYMf8tC2FMDR+HCFB9PtIbqmcxwHd2DQnz457mTE3hYgBPGf8WDFi
         VOQg==
MIME-Version: 1.0
X-Received: by 10.55.209.93 with SMTP id s90mr54160114qki.55.1445990404364;
 Tue, 27 Oct 2015 17:00:04 -0700 (PDT)
Received: by 10.55.101.196 with HTTP; Tue, 27 Oct 2015 17:00:04 -0700 (PDT)
In-Reply-To: <CALK=YjOwDPyAwsBv15AHF3YF3PSFFb_rt8yE8QnbuydNRH8W=w@mail.gmail.com>
References: <CALK=YjOwDPyAwsBv15AHF3YF3PSFFb_rt8yE8QnbuydNRH8W=w@mail.gmail.com>
Date: Wed, 28 Oct 2015 01:00:04 +0100
Message-ID: <CAKQ1sVPpaboK5CNRTK4s07jv7sKpScyKti-JmDQ3fs_iANxpSA@mail.gmail.com>
Subject: Re: ap_init_rng / apr_random question
From: Yann Ylavic <ylavic.dev@gmail.com>
To: dev@httpd.apache.org
Content-Type: text/plain; charset=UTF-8

On Tue, Oct 27, 2015 at 6:57 PM, Eric Covener <covener@gmail.com> wrote:
> IIUC, it takes something like 32k of /dev/random to initialize apr_random.
>
> APR_RANDOM_DEFAULT_POOLS*APR_RANDOM_DEFAULT_RESEED_SIZE*APR_RANDOM_DEFAULT_G_FOR_INSECURE
> (32*32*32)
>
> But ap_init_rng() does this with ~4000 8-byte reads of /dev/random.
>
> I am working on a platform where access to the crypto facility
> underneath /dev/random is sometimes audited.  Does anyone have any
> hints about whether larger reads from /dev/random would be better
> elsewhere? Or if the startup requirement is really this high for data
> from /dev/random?

AFAICT, /dev/urandom itself only requires 256 bits (32 bytes) of
(secret) entropy to be secure (cryptographically strong), so I don't
think more would be needed for httpd (or APR).
It seems to me that asking for more than 32 bytes of random bytes by
something like a minute is not very sound (both for the requester AND
the "others"), so IMHO we should really take that into consideration.

From dev-return-84479-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Wed Oct 28 13:09:00 2015
Return-Path: <dev-return-84479-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 96D3018236
	for <apmail-httpd-dev-archive@www.apache.org>; Wed, 28 Oct 2015 13:09:00 +0000 (UTC)
Received: (qmail 14908 invoked by uid 500); 28 Oct 2015 13:08:53 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 14684 invoked by uid 500); 28 Oct 2015 13:08:48 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 14646 invoked by uid 99); 28 Oct 2015 13:08:48 -0000
Received: from Unknown (HELO spamd1-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 28 Oct 2015 13:08:46 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd1-us-west.apache.org (ASF Mail Server at spamd1-us-west.apache.org) with ESMTP id 2CBA9C5E92
	for <dev@httpd.apache.org>; Wed, 28 Oct 2015 13:08:44 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd1-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 3
X-Spam-Level: ***
X-Spam-Status: No, score=3 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, HTML_MESSAGE=3,
	SPF_PASS=-0.001, URIBL_BLOCKED=0.001] autolearn=disabled
Authentication-Results: spamd1-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=rowe-clan_net.20150623.gappssmtp.com
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd1-us-west.apache.org [10.40.0.7]) (amavisd-new, port 10024)
	with ESMTP id D-wVDCJ8JAAt for <dev@httpd.apache.org>;
	Wed, 28 Oct 2015 13:08:37 +0000 (UTC)
Received: from mail-ig0-f176.google.com (mail-ig0-f176.google.com [209.85.213.176])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id 738B021602
	for <dev@httpd.apache.org>; Wed, 28 Oct 2015 13:08:37 +0000 (UTC)
Received: by igbhv6 with SMTP id hv6so6473972igb.0
        for <dev@httpd.apache.org>; Wed, 28 Oct 2015 06:08:36 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=rowe-clan_net.20150623.gappssmtp.com; s=20150623;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        bh=TLTCSDrZPb9HH23WMFsMZlu39C6vKq9CMEDG80wb4bc=;
        b=NUL1OcPyndeU74lKgI/xvYFMwChwrsZjcbA93pXDwRjcnzoblEeMd6QxheHoQORU6H
         74CUxsfLSzovsVO/COdaszcUwZmjkJLjpijk/+n2ZboCehhC7gK79xBkJk4WY+WT+Fh1
         qm9WQJVuos+idmIS2B3gQCXKsMxwcDCG+XGznj+TEjTlu+RKx+89xGbGFj0mn6Te5+pC
         BKI4hu3QldiTb40quZ+Szb43g7mJ1sQ4i7tgCdVBxbYtdn2cujc7fPoMVvMCAUTUstGH
         oq5XNL5eviGo8/LFNjD7SBd82duOmp8VQ5obBkin/Ci11UruCBOYgAvJEu+OpdB4LQQf
         d+Yg==
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=1e100.net; s=20130820;
        h=x-gm-message-state:mime-version:in-reply-to:references:date
         :message-id:subject:from:to:content-type;
        bh=TLTCSDrZPb9HH23WMFsMZlu39C6vKq9CMEDG80wb4bc=;
        b=OrZ784ihfa4kvg2aSJaulBe5wrO+9+VwAmLE2zaUT5JjOhJDFzBXs8PDZryKTPrnSv
         LPUD+GLG4iZYviHPXfZEfenuZpDG11SG7dTZiuWHAPBA3SI99RhKLIcyOJdNzjwI95Tj
         hikx6CRDAxMm+661pJ+f7SS/M4IXl7q2jmeI5xAfPMAypc8mN4w2pZ1Ya/DDxDfbGRUP
         +K807i6CpcVaDOr3OZfRkHOJ71xrG+yBKVofqxJh4bJMbgpZsiZo2DKHih0kD16Y+jIH
         XCpLunbSUzSJyiKsvGmFrxeHzka75h5TIdsbPn2Wto31bT5SIjfZvR3vn5APkKc2OXlT
         nzWQ==
X-Gm-Message-State: ALoCoQlRanHD2QwsKXYopRCqpZHgaBVaNkdWTvhjX3pJF4DZZjVmKyxM3PHPjnlqx7ygYckdqUMD
MIME-Version: 1.0
X-Received: by 10.50.32.69 with SMTP id g5mr2953229igi.35.1446037716319; Wed,
 28 Oct 2015 06:08:36 -0700 (PDT)
Received: by 10.107.3.88 with HTTP; Wed, 28 Oct 2015 06:08:36 -0700 (PDT)
In-Reply-To: <A7987303-0342-46E0-8400-6B76F8CF7F85@gbiv.com>
References: <20151027064504.2771C3A0910@svn01-us-west.apache.org>
	<A7987303-0342-46E0-8400-6B76F8CF7F85@gbiv.com>
Date: Wed, 28 Oct 2015 08:08:36 -0500
Message-ID: <CACsi252px-Pzr5zDJnJ==VHonvp4eZDAe1oRhzJmQRJNU8TGVw@mail.gmail.com>
Subject: Re: svn commit: r1710723 - in /httpd/httpd/trunk: CHANGES modules/cache/cache_util.h
From: William A Rowe Jr <wrowe@rowe-clan.net>
To: httpd <dev@httpd.apache.org>
Content-Type: multipart/alternative; boundary=047d7b10d0df69e431052329e4f5

--047d7b10d0df69e431052329e4f5
Content-Type: text/plain; charset=UTF-8

On Tue, Oct 27, 2015 at 1:17 PM, Roy T. Fielding <fielding@gbiv.com> wrote:

> > On Oct 26, 2015, at 11:45 PM, jailletc36@apache.org wrote:
> >
> > Author: jailletc36
> > Date: Tue Oct 27 06:45:03 2015
> > New Revision: 1710723
> >
> > URL: http://svn.apache.org/viewvc?rev=1710723&view=rev
> > Log:
> > RFC2616 defines #rules as:
> >   #rule
> >      A construct "#" is defined, similar to "*", for defining lists of
> >      elements. The full form is "<n>#<m>element" indicating at least
> >      <n> and at most <m> elements, each separated by one or more commas
> >      (",") and OPTIONAL linear white space (LWS). This makes the usual
> >      form of lists very easy; a rule such as
> >         ( *LWS element *( *LWS "," *LWS element ))
> >      can be shown as
> >         1#element
> >
> > It also defines Linear White Space (LWS) as:
> >   LWS            = [CRLF] 1*( SP | HT )
> >
> >
> > The actual implementation only accepts SP (Space) and not HT (Horizontal
> Tab) when parsing cache related header fields (i.e. "Vary", "Cache-Control"
> and "Pragma")
>
> Well, to be more accurate: RFC7230 defines these (2616 no longer applies)
> and
> the original algorithm did handle HT.  My bet is that someone screwed up an
> automated TAB -> two space conversion and the code change got lost in the
> noise.
>

Interestingly it was only introduced in a recent commit (2 yrs ago) with
the defect,
one might guess that the vi/emacs template did the damage when the text was
pasted in.

See also server.c/protocol.c@920 on trunk, which has the correct HT
handling,
explicitly.

--047d7b10d0df69e431052329e4f5
Content-Type: text/html; charset=UTF-8
Content-Transfer-Encoding: quoted-printable

<div dir=3D"ltr"><div class=3D"gmail_extra"><div class=3D"gmail_quote">On T=
ue, Oct 27, 2015 at 1:17 PM, Roy T. Fielding <span dir=3D"ltr">&lt;<a href=
=3D"mailto:fielding@gbiv.com" target=3D"_blank">fielding@gbiv.com</a>&gt;</=
span> wrote:<br><blockquote class=3D"gmail_quote" style=3D"margin:0 0 0 .8e=
x;border-left:1px #ccc solid;padding-left:1ex"><span class=3D"">&gt; On Oct=
 26, 2015, at 11:45 PM, <a href=3D"mailto:jailletc36@apache.org">jailletc36=
@apache.org</a> wrote:<br>
&gt;<br>
&gt; Author: jailletc36<br>
&gt; Date: Tue Oct 27 06:45:03 2015<br>
&gt; New Revision: 1710723<br>
&gt;<br>
&gt; URL: <a href=3D"http://svn.apache.org/viewvc?rev=3D1710723&amp;view=3D=
rev" rel=3D"noreferrer" target=3D"_blank">http://svn.apache.org/viewvc?rev=
=3D1710723&amp;view=3Drev</a><br>
&gt; Log:<br>
&gt; RFC2616 defines #rules as:<br>
&gt;=C2=A0 =C2=A0#rule<br>
&gt;=C2=A0 =C2=A0 =C2=A0 A construct &quot;#&quot; is defined, similar to &=
quot;*&quot;, for defining lists of<br>
&gt;=C2=A0 =C2=A0 =C2=A0 elements. The full form is &quot;&lt;n&gt;#&lt;m&g=
t;element&quot; indicating at least<br>
&gt;=C2=A0 =C2=A0 =C2=A0 &lt;n&gt; and at most &lt;m&gt; elements, each sep=
arated by one or more commas<br>
&gt;=C2=A0 =C2=A0 =C2=A0 (&quot;,&quot;) and OPTIONAL linear white space (L=
WS). This makes the usual<br>
&gt;=C2=A0 =C2=A0 =C2=A0 form of lists very easy; a rule such as<br>
&gt;=C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0( *LWS element *( *LWS &quot;,&quot; =
*LWS element ))<br>
&gt;=C2=A0 =C2=A0 =C2=A0 can be shown as<br>
&gt;=C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A01#element<br>
&gt;<br>
&gt; It also defines Linear White Space (LWS) as:<br>
&gt;=C2=A0 =C2=A0LWS=C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =3D [CRLF] 1*=
( SP | HT )<br>
&gt;<br>
&gt;<br>
&gt; The actual implementation only accepts SP (Space) and not HT (Horizont=
al Tab) when parsing cache related header fields (i.e. &quot;Vary&quot;, &q=
uot;Cache-Control&quot; and &quot;Pragma&quot;)<br>
<br>
</span>Well, to be more accurate: RFC7230 defines these (2616 no longer app=
lies) and<br>
the original algorithm did handle HT.=C2=A0 My bet is that someone screwed =
up an<br>
automated TAB -&gt; two space conversion and the code change got lost in th=
e noise.<br></blockquote><div><br></div><div>Interestingly it was only intr=
oduced in a recent commit (2 yrs ago) with the defect,</div><div>one might =
guess that the vi/emacs template did the damage when the text was</div><div=
>pasted in.</div><div><br></div><div>See also server.c/protocol.c@920 on tr=
unk, which has the correct HT handling,</div><div>explicitly.</div><div><br=
></div><div><br></div></div></div></div>

--047d7b10d0df69e431052329e4f5--

From dev-return-84480-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Wed Oct 28 14:38:31 2015
Return-Path: <dev-return-84480-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 4677618623
	for <apmail-httpd-dev-archive@www.apache.org>; Wed, 28 Oct 2015 14:38:31 +0000 (UTC)
Received: (qmail 10063 invoked by uid 500); 28 Oct 2015 14:38:30 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 9997 invoked by uid 500); 28 Oct 2015 14:38:30 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 9987 invoked by uid 99); 28 Oct 2015 14:38:30 -0000
Received: from Unknown (HELO spamd2-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 28 Oct 2015 14:38:30 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd2-us-west.apache.org (ASF Mail Server at spamd2-us-west.apache.org) with ESMTP id CB8A71A2963
	for <dev@httpd.apache.org>; Wed, 28 Oct 2015 14:38:29 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd2-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.102
X-Spam-Level:
X-Spam-Status: No, score=-0.102 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RCVD_IN_MSPIKE_H2=-0.001, SPF_PASS=-0.001] autolearn=disabled
Authentication-Results: spamd2-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-us-west.apache.org ([10.40.0.8])
	by localhost (spamd2-us-west.apache.org [10.40.0.9]) (amavisd-new, port 10024)
	with ESMTP id JjSbgADQI5HS for <dev@httpd.apache.org>;
	Wed, 28 Oct 2015 14:38:28 +0000 (UTC)
Received: from mail-io0-f169.google.com (mail-io0-f169.google.com [209.85.223.169])
	by mx1-us-west.apache.org (ASF Mail Server at mx1-us-west.apache.org) with ESMTPS id 58A4220F6D
	for <dev@httpd.apache.org>; Wed, 28 Oct 2015 14:38:28 +0000 (UTC)
Received: by iofz202 with SMTP id z202so12385880iof.2
        for <dev@httpd.apache.org>; Wed, 28 Oct 2015 07:38:27 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        bh=H3gtu5YwZeVtkk80saNWv+6rx/4YkJiZGKMDWMnJBmM=;
        b=Qio4xHo0ctVgVUolpudxEz9GFbmeHSyVwJT8OSq1RwO+xGVxEYDrinIHmSBNOKfkhe
         hqPrHqdwB4vyFr16Lp4nPCp3QNMeQKHBt5NiWXf+J72FoUgV4scW3peU/OYc5YK8sOz0
         xb25HcsLz/o5+qfz03hT0NRcUQjAWEyqi6gzZj3Ubq8XWi95o/R/NfhmIl4PEbJ4NFF/
         3Byyx7A+EVL5vQHnIzIZ0e/kH5BLfu8RuR9xcze575aUOphhSMmHL8NncC6PIvBnGH5g
         5DRuPQeqz+Aj+gKQRmKPpLeXbx29RVZTQJ8MQVI3hEu6s9X/rUbvx3XtZfgPX9ch4AfF
         dF6A==
MIME-Version: 1.0
X-Received: by 10.107.167.16 with SMTP id q16mr17676661ioe.169.1446043107826;
 Wed, 28 Oct 2015 07:38:27 -0700 (PDT)
Received: by 10.64.112.69 with HTTP; Wed, 28 Oct 2015 07:38:27 -0700 (PDT)
In-Reply-To: <CAKQ1sVPpaboK5CNRTK4s07jv7sKpScyKti-JmDQ3fs_iANxpSA@mail.gmail.com>
References: <CALK=YjOwDPyAwsBv15AHF3YF3PSFFb_rt8yE8QnbuydNRH8W=w@mail.gmail.com>
	<CAKQ1sVPpaboK5CNRTK4s07jv7sKpScyKti-JmDQ3fs_iANxpSA@mail.gmail.com>
Date: Wed, 28 Oct 2015 10:38:27 -0400
Message-ID: <CALK=YjMDyrXbi4qSs7MojnqeBXBaYQc4YzrGMy=V-BwTrGb2OA@mail.gmail.com>
Subject: Re: ap_init_rng / apr_random question
From: Eric Covener <covener@gmail.com>
To: Apache HTTP Server Development List <dev@httpd.apache.org>, "dev@apr.apache.org" <dev@apr.apache.org>
Content-Type: text/plain; charset=UTF-8

On Tue, Oct 27, 2015 at 8:00 PM, Yann Ylavic <ylavic.dev@gmail.com> wrote:
> On Tue, Oct 27, 2015 at 6:57 PM, Eric Covener <covener@gmail.com> wrote:
>> IIUC, it takes something like 32k of /dev/random to initialize apr_random.
>>
>> APR_RANDOM_DEFAULT_POOLS*APR_RANDOM_DEFAULT_RESEED_SIZE*APR_RANDOM_DEFAULT_G_FOR_INSECURE
>> (32*32*32)
>>
>> But ap_init_rng() does this with ~4000 8-byte reads of /dev/random.
>>
>> I am working on a platform where access to the crypto facility
>> underneath /dev/random is sometimes audited.  Does anyone have any
>> hints about whether larger reads from /dev/random would be better
>> elsewhere? Or if the startup requirement is really this high for data
>> from /dev/random?
>
> AFAICT, /dev/urandom itself only requires 256 bits (32 bytes) of
> (secret) entropy to be secure (cryptographically strong), so I don't
> think more would be needed for httpd (or APR).
> It seems to me that asking for more than 32 bytes of random bytes by
> something like a minute is not very sound (both for the requester AND
> the "others"), so IMHO we should really take that into consideration.

Addng dev@apr in case anyone with knowledge in this area is only watching there.

From dev-return-84481-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Wed Oct 28 20:03:56 2015
Return-Path: <dev-return-84481-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id A120D18822
	for <apmail-httpd-dev-archive@www.apache.org>; Wed, 28 Oct 2015 20:03:56 +0000 (UTC)
Received: (qmail 86908 invoked by uid 500); 28 Oct 2015 20:03:56 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 86840 invoked by uid 500); 28 Oct 2015 20:03:56 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 86831 invoked by uid 99); 28 Oct 2015 20:03:56 -0000
Received: from mail-relay.apache.org (HELO mail-relay.apache.org) (140.211.11.15)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 28 Oct 2015 20:03:56 +0000
Received: from gauss.localdomain (v4-86134dad.pool.vitroconnect.de [134.19.77.173])
	by mail-relay.apache.org (ASF Mail Server at mail-relay.apache.org) with ESMTPSA id D62951A009C
	for <dev@httpd.apache.org>; Wed, 28 Oct 2015 20:03:55 +0000 (UTC)
Received: from [IPv6:::1] (localhost [IPv6:::1])
	by gauss.localdomain (Postfix) with ESMTP id 23C8D1D8
	for <dev@httpd.apache.org>; Wed, 28 Oct 2015 21:03:54 +0100 (CET)
Subject: Re: svn commit: r1711044 - in /httpd/httpd/trunk/modules/http2:
 h2_io.h h2_mplx.c h2_mplx.h h2_session.c h2_session.h h2_stream.c h2_stream.h
 h2_task.c h2_task.h h2_task_queue.c h2_task_queue.h h2_version.h
To: dev@httpd.apache.org
References: <20151028155307.D89DD3A01A5@svn01-us-west.apache.org>
From: Ruediger Pluem <rpluem@apache.org>
Message-ID: <56312A29.7080204@apache.org>
Date: Wed, 28 Oct 2015 21:03:53 +0100
User-Agent: Mozilla/5.0 (X11; Linux i686 on x86_64; rv:41.0) Gecko/20100101
 Firefox/41.0 SeaMonkey/2.38
MIME-Version: 1.0
In-Reply-To: <20151028155307.D89DD3A01A5@svn01-us-west.apache.org>
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 8bit



On 10/28/2015 04:53 PM, icing@apache.org wrote:
> Author: icing
> Date: Wed Oct 28 15:53:07 2015
> New Revision: 1711044
> 
> URL: http://svn.apache.org/viewvc?rev=1711044&view=rev
> Log:
> http2 priority based scheduling of stream execution in each session
> 
> Modified:
>     httpd/httpd/trunk/modules/http2/h2_io.h
>     httpd/httpd/trunk/modules/http2/h2_mplx.c
>     httpd/httpd/trunk/modules/http2/h2_mplx.h
>     httpd/httpd/trunk/modules/http2/h2_session.c
>     httpd/httpd/trunk/modules/http2/h2_session.h
>     httpd/httpd/trunk/modules/http2/h2_stream.c
>     httpd/httpd/trunk/modules/http2/h2_stream.h
>     httpd/httpd/trunk/modules/http2/h2_task.c
>     httpd/httpd/trunk/modules/http2/h2_task.h
>     httpd/httpd/trunk/modules/http2/h2_task_queue.c
>     httpd/httpd/trunk/modules/http2/h2_task_queue.h
>     httpd/httpd/trunk/modules/http2/h2_version.h
> 
> Modified: httpd/httpd/trunk/modules/http2/h2_io.h

> Modified: httpd/httpd/trunk/modules/http2/h2_mplx.c
> URL: http://svn.apache.org/viewvc/httpd/httpd/trunk/modules/http2/h2_mplx.c?rev=1711044&r1=1711043&r2=1711044&view=diff
> ==============================================================================
> --- httpd/httpd/trunk/modules/http2/h2_mplx.c (original)
> +++ httpd/httpd/trunk/modules/http2/h2_mplx.c Wed Oct 28 15:53:07 2015
> @@ -128,7 +128,7 @@ h2_mplx *h2_mplx_create(conn_rec *c, apr
>          
>          m->bucket_alloc = apr_bucket_alloc_create(m->pool);
>          
> -        m->q = h2_tq_create(m->id, m->pool);
> +        m->q = h2_tq_create(m->pool, 23);

I thought the answer to the last question was 42 :-). Seriously using a hardcoded value that is not done via a #define
with a descriptive name and that is not documented is IMHO bad.

>          m->stream_ios = h2_io_set_create(m->pool);
>          m->ready_ios = h2_io_set_create(m->pool);
>          m->closed = h2_stream_set_create(m->pool);

Regards

Rüdiger

From dev-return-84482-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Thu Oct 29 09:09:37 2015
Return-Path: <dev-return-84482-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 711A4175E3
	for <apmail-httpd-dev-archive@www.apache.org>; Thu, 29 Oct 2015 09:09:37 +0000 (UTC)
Received: (qmail 15355 invoked by uid 500); 29 Oct 2015 09:09:36 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 15276 invoked by uid 500); 29 Oct 2015 09:09:36 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 15265 invoked by uid 99); 29 Oct 2015 09:09:36 -0000
Received: from Unknown (HELO spamd4-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 29 Oct 2015 09:09:36 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd4-us-west.apache.org (ASF Mail Server at spamd4-us-west.apache.org) with ESMTP id E2115C040B
	for <dev@httpd.apache.org>; Thu, 29 Oct 2015 09:09:35 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd4-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.111
X-Spam-Level:
X-Spam-Status: No, score=-0.111 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	SPF_PASS=-0.001, T_RP_MATCHES_RCVD=-0.01] autolearn=disabled
Authentication-Results: spamd4-us-west.apache.org (amavisd-new);
	dkim=pass (1024-bit key) header.d=greenbytes.de
Received: from mx1-us-west.apache.org ([10.40.0.8])
	by localhost (spamd4-us-west.apache.org [10.40.0.11]) (amavisd-new, port 10024)
	with ESMTP id ngvOi8T09jOR for <dev@httpd.apache.org>;
	Thu, 29 Oct 2015 09:09:34 +0000 (UTC)
Received: from mail.greenbytes.de (mail.greenbytes.de [217.91.35.233])
	by mx1-us-west.apache.org (ASF Mail Server at mx1-us-west.apache.org) with ESMTPS id 92D3B2115A
	for <dev@httpd.apache.org>; Thu, 29 Oct 2015 09:09:34 +0000 (UTC)
Received: from [192.168.1.150] (unknown [217.91.35.233])
	(using TLSv1 with cipher ECDHE-RSA-AES256-SHA (256/256 bits))
	(Client did not present a certificate)
	by mail.greenbytes.de (Postfix) with ESMTPSA id 7792615A03B9
	for <dev@httpd.apache.org>; Thu, 29 Oct 2015 10:09:25 +0100 (CET)
DKIM-Signature: v=1; a=rsa-sha256; c=simple/simple; d=greenbytes.de; s=mail;
	t=1446109765; bh=8p/V901c3fMcs3BuVjaPTD60qFzgE1Ut3LMtMIogQCc=;
	h=Subject:From:In-Reply-To:Date:References:To:From;
	b=opb7kM+UIafwHBbFqYU2+Eti+/Us97mmAxFJNszjRJP6QKylTDZPj1KXFKuuDAPL8
	 VkHWkrqQGdruQbKtapEqkCK+0GunWReD++iO9e4xw0lBb3B3NmMIsQUEAtoh2WweFC
	 dm9KXfij743oC9peHnzFi3UU9+Ulrm3C5xxpCDvs=
Content-Type: text/plain; charset=us-ascii
Mime-Version: 1.0 (Mac OS X Mail 9.1 \(3096.5\))
Subject: Re: svn commit: r1711044 - in /httpd/httpd/trunk/modules/http2: h2_io.h h2_mplx.c h2_mplx.h h2_session.c h2_session.h h2_stream.c h2_stream.h h2_task.c h2_task.h h2_task_queue.c h2_task_queue.h h2_version.h
From: Stefan Eissing <stefan.eissing@greenbytes.de>
In-Reply-To: <56312A29.7080204@apache.org>
Date: Thu, 29 Oct 2015 10:09:31 +0100
Content-Transfer-Encoding: quoted-printable
Message-Id: <6861A85C-DA34-4A47-9072-E4871FF94E12@greenbytes.de>
References: <20151028155307.D89DD3A01A5@svn01-us-west.apache.org> <56312A29.7080204@apache.org>
To: dev@httpd.apache.org
X-Mailer: Apple Mail (2.3096.5)


> Am 28.10.2015 um 21:03 schrieb Ruediger Pluem <rpluem@apache.org>:
> On 10/28/2015 04:53 PM, icing@apache.org wrote:
>> [Modified: httpd/httpd/trunk/modules/http2/h2_mplx.c
>> URL: =
http://svn.apache.org/viewvc/httpd/httpd/trunk/modules/http2/h2_mplx.c?rev=
=3D1711044&r1=3D1711043&r2=3D1711044&view=3Ddiff
>> =
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D
>> --- httpd/httpd/trunk/modules/http2/h2_mplx.c (original)
>> +++ httpd/httpd/trunk/modules/http2/h2_mplx.c Wed Oct 28 15:53:07 =
2015
>> @@ -128,7 +128,7 @@ h2_mplx *h2_mplx_create(conn_rec *c, apr
>>=20
>>         m->bucket_alloc =3D apr_bucket_alloc_create(m->pool);
>>=20
>> -        m->q =3D h2_tq_create(m->id, m->pool);
>> +        m->q =3D h2_tq_create(m->pool, 23);
>=20
> I thought the answer to the last question was 42 :-). Seriously using =
a hardcoded value that is not done via a #define
> with a descriptive name and that is not documented is IMHO bad.

You are correct. I need to give this change a rework anyway, so this =
number will disappear.

//Stefan=

From dev-return-84483-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Fri Oct 30 06:06:15 2015
Return-Path: <dev-return-84483-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 0091817F0B
	for <apmail-httpd-dev-archive@www.apache.org>; Fri, 30 Oct 2015 06:06:15 +0000 (UTC)
Received: (qmail 78058 invoked by uid 500); 30 Oct 2015 06:06:14 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 77986 invoked by uid 500); 30 Oct 2015 06:06:14 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 77976 invoked by uid 99); 30 Oct 2015 06:06:14 -0000
Received: from Unknown (HELO spamd1-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 30 Oct 2015 06:06:14 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd1-us-west.apache.org (ASF Mail Server at spamd1-us-west.apache.org) with ESMTP id E68F4C4C26
	for <dev@httpd.apache.org>; Fri, 30 Oct 2015 06:06:13 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd1-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 0.982
X-Spam-Level:
X-Spam-Status: No, score=0.982 tagged_above=-999 required=6.31
	tests=[HEADER_FROM_DIFFERENT_DOMAINS=0.234, KAM_INFOUSMEBIZ=0.75,
	RP_MATCHES_RCVD=-0.001, SPF_HELO_PASS=-0.001, SPF_PASS=-0.001,
	URIBL_BLOCKED=0.001] autolearn=disabled
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd1-us-west.apache.org [10.40.0.7]) (amavisd-new, port 10024)
	with ESMTP id SKsw0Bhd_RQo for <dev@httpd.apache.org>;
	Fri, 30 Oct 2015 06:06:06 +0000 (UTC)
Received: from plane.gmane.org (plane.gmane.org [80.91.229.3])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id 8322820F26
	for <dev@httpd.apache.org>; Fri, 30 Oct 2015 06:06:05 +0000 (UTC)
Received: from list by plane.gmane.org with local (Exim 4.69)
	(envelope-from <apache-dev@m.gmane.org>)
	id 1Zs2p2-0000cy-QK
	for dev@httpd.apache.org; Fri, 30 Oct 2015 07:05:56 +0100
Received: from aorleans-552-1-105-207.w92-140.abo.wanadoo.fr ([92.140.232.207])
        by main.gmane.org with esmtp (Gmexim 0.1 (Debian))
        id 1AlnuQ-0007hv-00
        for <dev@httpd.apache.org>; Fri, 30 Oct 2015 07:05:56 +0100
Received: from christophe.jaillet by aorleans-552-1-105-207.w92-140.abo.wanadoo.fr with local (Gmexim 0.1 (Debian))
        id 1AlnuQ-0007hv-00
        for <dev@httpd.apache.org>; Fri, 30 Oct 2015 07:05:56 +0100
X-Injected-Via-Gmane: http://gmane.org/
To: dev@httpd.apache.org
From: Christophe JAILLET <christophe.jaillet@wanadoo.fr>
Subject: Re: Is Apache getting too patchy?
Date: Fri, 30 Oct 2015 07:05:47 +0100
Lines: 114
Message-ID: <n0v1bv$5ng$1@ger.gmane.org>
References: <38B6AA15-AB3C-47AC-B96D-7DA8094F99F9@jaguNET.com>
 <562E5A1F.9080201@gmail.com> <20151026222322.232ef884@baldur>
 <40FF7659-3F5A-4010-9A4B-D7E09B9ACF95@c8h10n4o2.org.uk>
 <995B8E3C-91B1-4A36-9940-A91EE86AE9B1@sharp.fm> <562FA608.8020501@gmail.com>
Mime-Version: 1.0
Content-Type: text/plain; charset=utf-8; format=flowed
Content-Transfer-Encoding: 8bit
X-Complaints-To: usenet@ger.gmane.org
X-Gmane-NNTP-Posting-Host: aorleans-552-1-105-207.w92-140.abo.wanadoo.fr
X-Mozilla-News-Host: news://news.gmane.org
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:38.0) Gecko/20100101
 Thunderbird/38.3.0
In-Reply-To: <562FA608.8020501@gmail.com>
X-Antivirus: avast! (VPS 151029-2, 29/10/2015), Outbound message
X-Antivirus-Status: Clean


Le 27/10/2015 17:27, Jacob Champion a écrit :
 >
 >> The most exciting work on httpd for me has been Christophe Jaillet’s
 >> memory optimisation patches. With each patch the code gets cleaner
 >> and the server gets faster. We need more of this kind of stuff.
 >
 > How would you improve the process and encourage those sorts of 
patches, then, from someone who _isn't_ in the httpd committers list? It 
seems to me that optimization needs to be done by experts in a codebase, 
not by newbies. And code cleanup is difficult when you don't already 
have a clear direction to push the code in.
 >
 > --Jacob
 >

Hi,

I understand your point.
Personally, when I first looked at httpd, it was more or less in the same
spirit as what is done on the kernel Janitor project. This project is aimed
at cleaning and fixing potential issues in Linux kernel.
So I started looking at what could, according to me, be improved in httpd.

Not an easy task when, as you say, you don't have any direction to push.


To give you some ideas of what can be looked at easily by new comers:

EASY
====
    - Fix coding style issue: [1]
      (even if I don't really think that the 'indent' command line given 
there
      is that good. It generates way too much changes)
         --> See http://svn.apache.org/r1700332
    - Identify where standard C functions or apr_ or ap_ functions can 
be used
      in order to remove code duplication.
      If familiar with it, 'coccinelle' can be used for that.
         --> See PR 39518 or 42006 as some examples
    - Speedup/cleanup code
         --> See http://svn.apache.org/r1701717
    - Some parts of the server generate some HTML pages (in 
modules/generators,
      mod_proxy_balancer...). The generated output does not always 
comply with
      the HTML standard and could be clean-up.
         --> See http://marc.info/?l=apache-httpd-dev&m=142593723110939&w=2
    - Improve existing documentation [2]
    - Improve (or sometimes fix) code documentation generated with doxygen
    - Look at comments added by users in the online documentation and 
propose
      patches to take these comments into account

MEDIUM
======
    - Identify and improve memory usage. For that, you must first know and
      understand the way APR memory pools work.
         --> see PR 52648 or http://svn.apache.org/r1681685
    - Identify places where 'varbuf' could be used to improve memory usage
    - Fix compilation warning (if any)
    - Use and fix items reported by static analyzer such as cpp_check or 
sparse
    - Check bug reports in bugzilla, try to reproduce the issues, try the
      (sometimes) proposed patch. Mark bug reports with the 'PatchAvailable'
      keyword when it is missing
    - Look at differences between trunk and 2.4.x branch to identify and 
propose
      what can be backported. The closer they are, the easier it will be to
      backport other proposals

HARD
====
    - Write tests to add in the test framework [3]


It could also be a good idea to tag some bugzilla reports with something 
like
[good first bug] (such as what is done in the bugzilla project itself or
LibreOffice). This would give the opportunity to new comers to have a 
starting
point.
This mean that some maintainers should tag these bugs report and LEAVE THEM
OPEN, EVEN IF EASY TO FIX.



The best is to open a report on bugzilla for each individual patch you 
submit
(see [4]). You can use the Keyword 'PatchAvailable' to identify them 
even more
easily.
It help us tracking them and they don't get lost in a mailing list.


I'll be glad (and I know some others will also) to have a look at it and 
push
it to the repository.

If you are interested by one of the few ideas above and need more inputs on
where/how exactly to start, do not hesitate to ask.


Other (old) ideas can be found at http://httpd.apache.org/dev/todo.html

Hoping these few lines can help or can be a starting point for new comers.


[1] http://httpd.apache.org/dev/styleguide.html
[2] https://httpd.apache.org/docs/2.4/
[3] http://httpd.apache.org/test/
[4] http://httpd.apache.org/dev/patches.html



From dev-return-84484-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Fri Oct 30 08:02:30 2015
Return-Path: <dev-return-84484-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 445E4182E6
	for <apmail-httpd-dev-archive@www.apache.org>; Fri, 30 Oct 2015 08:02:30 +0000 (UTC)
Received: (qmail 65988 invoked by uid 500); 30 Oct 2015 08:02:29 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 65921 invoked by uid 500); 30 Oct 2015 08:02:29 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 65909 invoked by uid 99); 30 Oct 2015 08:02:29 -0000
Received: from Unknown (HELO spamd4-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 30 Oct 2015 08:02:29 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd4-us-west.apache.org (ASF Mail Server at spamd4-us-west.apache.org) with ESMTP id 930C1C0F8F
	for <dev@httpd.apache.org>; Fri, 30 Oct 2015 08:02:28 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd4-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 4.605
X-Spam-Level: ****
X-Spam-Status: No, score=4.605 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, HTML_MESSAGE=3,
	RCVD_IN_MSPIKE_H3=-0.01, RCVD_IN_MSPIKE_WL=-0.01, SUBJ_ALL_CAPS=1.625]
	autolearn=disabled
Authentication-Results: spamd4-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=egnyte_com.20150623.gappssmtp.com
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd4-us-west.apache.org [10.40.0.11]) (amavisd-new, port 10024)
	with ESMTP id 08KhP5ARvgWk for <dev@httpd.apache.org>;
	Fri, 30 Oct 2015 08:02:16 +0000 (UTC)
Received: from mail-ig0-f170.google.com (mail-ig0-f170.google.com [209.85.213.170])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id 2DAAC439C5
	for <dev@httpd.apache.org>; Fri, 30 Oct 2015 08:02:16 +0000 (UTC)
Received: by igpw7 with SMTP id w7so6212369igp.0
        for <dev@httpd.apache.org>; Fri, 30 Oct 2015 01:02:09 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=egnyte_com.20150623.gappssmtp.com; s=20150623;
        h=mime-version:date:message-id:subject:from:to:content-type;
        bh=/tQ/FuqiY9UdIlyYnWG+UTn2WRe8A31GBfGRnYpjCEM=;
        b=FGYWSt80vFPKNKs9aXKb+ysh7dXfr/c+WqJjG6P0bBo/bVzvdMsgl5/8iISh9DU6KJ
         uCkuUFuv6SKtOVUTOeaXSFsn8n57VFyXdhmZPXlH7GaP3ikFPbNJL8+aQmu4Ut1Io6sP
         ydZkIYfwvHaZO3e0KY5j+b7+PLSFC47D9r+GLwwWYEOEx6Z1arx0vMepZZzuPZqfH74M
         QCkCw7lcfLBTBrfTyZkB5+VAx9/ngjKqekt/cjpcqxIYIrEMou3DH91fY2NZv83E9pua
         tfsJo9SkXq9yL42EAzORXiTZQcqsbAfjqLHGM28xuWI837dsmuqiFFWuK9iDYpuybhqK
         et4A==
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=1e100.net; s=20130820;
        h=x-gm-message-state:mime-version:date:message-id:subject:from:to
         :content-type;
        bh=/tQ/FuqiY9UdIlyYnWG+UTn2WRe8A31GBfGRnYpjCEM=;
        b=fNSX0RCYAkqOSl9K2dHX4l0mG9E3EOr+LNnVi+qbmXXoKCXA4lkdnX+nBsLHKC2krO
         9FvfpHKfMxt7Tlkzj2myNsiVNRZmVQjoVrLlaHD9bhcRHcOYliBmbtVB/i2G8Qho7Zz1
         DlhVaK8T2rOooH5shZv4t8IVZgOGV4Jh1Wd5lNCs3j4sfzIrkbZB4KmVoZW93hLnjmr3
         NI98QqZaR140B1ZpSS9fF9X9o3qjnEpHXfJBq4AobOOZ+kOZRrAkvLDYt5brVVwFJ55J
         Cyb3ve/3E5xe1sHu2lKH3DHVco6DiGESDY5/h30IiAux2ZDPgruFdXRIYoJ08de9toWw
         reJg==
X-Gm-Message-State: ALoCoQmKUCmgucwxrd4cQaBvRgP0v0boMHVBSRhGq/mQaQoSNoKyEku4U0Pkli6itoef3LZOIa7N
MIME-Version: 1.0
X-Received: by 10.50.60.40 with SMTP id e8mr1513295igr.85.1446192129383; Fri,
 30 Oct 2015 01:02:09 -0700 (PDT)
Received: by 10.36.72.137 with HTTP; Fri, 30 Oct 2015 01:02:09 -0700 (PDT)
Date: Fri, 30 Oct 2015 09:02:09 +0100
Message-ID: <CAECPfcyhnFUL1dxkm7q0Y_7zvXWw6U2VY1ytCYJZ0au12dr=pA@mail.gmail.com>
Subject: PATCH 58177
From: Daniil Iaitskov <diaitskov@egnyte.com>
To: dev@httpd.apache.org
Content-Type: multipart/mixed; boundary=047d7b1117b7269c4605234dd8e5

--047d7b1117b7269c4605234dd8e5
Content-Type: multipart/alternative; boundary=047d7b1117b7269c4105234dd8e3

--047d7b1117b7269c4105234dd8e3
Content-Type: text/plain; charset=UTF-8

Hi List,


The patch allows an HTTP client to send trailing headers to an origin
server through an httpd in the HTTP proxy mode.
It filters headers which are not declared in the Trailer header.
The patch is applicable to 2.4.16 and 2.4.17.


-- 


Daneel Yaitskov

--047d7b1117b7269c4105234dd8e3
Content-Type: text/html; charset=UTF-8
Content-Transfer-Encoding: quoted-printable

<div dir=3D"ltr">Hi List,<div><br></div><div><div style=3D"font-size:12.8px=
"><br class=3D"">The patch allows an HTTP client to send trailing headers t=
o an origin server through an httpd in the HTTP proxy mode.=C2=A0</div><div=
 style=3D"font-size:12.8px">It filters headers which are not declared in th=
e Trailer header.</div><div style=3D"font-size:12.8px">The patch is applica=
ble to 2.4.16 and 2.4.17.</div><div><br></div><div><div style=3D"font-size:=
12.8px"><br class=3D""></div></div>-- <br><div class=3D"gmail_signature"><d=
iv dir=3D"ltr"><div dir=3D"ltr"><br><div><br></div><div>Daneel Yaitskov</di=
v><div><br></div></div></div></div>
</div></div>

--047d7b1117b7269c4105234dd8e3--
--047d7b1117b7269c4605234dd8e5
Content-Type: text/x-patch; charset=US-ASCII; name="trailer.diff.patch"
Content-Disposition: attachment; filename="trailer.diff.patch"
Content-Transfer-Encoding: base64
X-Attachment-Id: f_igdcnbz90

ZGlmZiAtLWdpdCBhL21vZHVsZXMvcHJveHkvbW9kX3Byb3h5X2h0dHAuYyBiL21vZHVsZXMvcHJv
eHkvbW9kX3Byb3h5X2h0dHAuYwppbmRleCAzMTk3MjFmLi4zNjkxMmVkIDEwMDY0NAotLS0gYS9t
b2R1bGVzL3Byb3h5L21vZF9wcm94eV9odHRwLmMKKysrIGIvbW9kdWxlcy9wcm94eS9tb2RfcHJv
eHlfaHR0cC5jCkBAIC0xOTYsNiArMTk2LDM5IEBAIHN0YXRpYyB2b2lkIGFkZF90ZV9jaHVua2Vk
KGFwcl9wb29sX3QgKnAsCiAgICAgQVBSX0JSSUdBREVfSU5TRVJUX1RBSUwoaGVhZGVyX2JyaWdh
ZGUsIGUpOwogfQogCitzdGF0aWMgdm9pZCBhZGRfdHJhaWxlcl9saW5lKGNvbnN0IGNoYXIgKiBr
ZXksIGNvbnN0IGNoYXIgKnZhbCwgYXByX3Bvb2xfdCAqcCwKKyAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgYXByX2J1Y2tldF9hbGxvY190ICpidWNrZXRfYWxsb2MsCisgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgIGFwcl9idWNrZXRfYnJpZ2FkZSAqYmIpCit7CisgICAgYXByX2J1Y2tl
dCAqZTsKKyAgICBjaGFyICpidWY7CisKKyAgICBidWYgPSBhcHJfcHN0cmNhdChwLCBrZXksICI6
ICIsIHZhbCwgQ1JMRiwgTlVMTCk7CisgICAgYXBfeGxhdGVfcHJvdG9fdG9fYXNjaWkoYnVmLCBz
dHJsZW4oYnVmKSk7CisKKyAgICBlID0gYXByX2J1Y2tldF9pbW1vcnRhbF9jcmVhdGUoYnVmLCBz
dHJsZW4oYnVmKSwgYnVja2V0X2FsbG9jKTsKKyAgICBBUFJfQlJJR0FERV9JTlNFUlRfVEFJTChi
YiwgZSk7Cit9CisKK3N0YXRpYyB2b2lkIGZvcndhcmRfZGVjbGFyZWRfdHJhaWxlcnMoYXByX3Bv
b2xfdCAqcCwgY29uc3QgcmVxdWVzdF9yZWMgKnIsCisgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIGFwcl9idWNrZXRfYWxsb2NfdCAqYnVja2V0X2FsbG9jLAorICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhcHJfYnVja2V0X2JyaWdhZGUgKmJiKQorewor
ICAgIGNvbnN0IGNoYXIgKmRlY2xhcmVkX3RyYWlsZXJzID0gYXByX3RhYmxlX2dldChyLT5oZWFk
ZXJzX2luLCAiVHJhaWxlciIpOworICAgIGlmIChkZWNsYXJlZF90cmFpbGVycykgeworICAgICAg
ICBjaGFyICptb2RfdHJhaWxlcnMgPSBhcHJfcHN0cmNhdChwLCBkZWNsYXJlZF90cmFpbGVycywg
TlVMTCk7CisgICAgICAgIGNoYXIgKmtleTsKKyAgICAgICAgY2hhciAqbGFzdCA9IE5VTEw7Cisg
ICAgICAgIHdoaWxlICgoa2V5ID0gYXByX3N0cnRvayhtb2RfdHJhaWxlcnMsICIsICIsICZsYXN0
KSkpIHsKKyAgICAgICAgICAgIGNvbnN0IGNoYXIgKnZhbHVlID0gYXByX3RhYmxlX2dldChyLT50
cmFpbGVyc19pbiwga2V5KTsKKyAgICAgICAgICAgIGlmICh2YWx1ZSkgeworICAgICAgICAgICAg
ICAgIGFkZF90cmFpbGVyX2xpbmUoa2V5LCB2YWx1ZSwgcCwgYnVja2V0X2FsbG9jLCBiYik7Cisg
ICAgICAgICAgICB9CisgICAgICAgICAgICBtb2RfdHJhaWxlcnMgPSBsYXN0OworICAgICAgICB9
CisgICAgfQorfQorCiBzdGF0aWMgdm9pZCBhZGRfY2woYXByX3Bvb2xfdCAqcCwKICAgICAgICAg
ICAgICAgICAgICBhcHJfYnVja2V0X2FsbG9jX3QgKmJ1Y2tldF9hbGxvYywKICAgICAgICAgICAg
ICAgICAgICBhcHJfYnVja2V0X2JyaWdhZGUgKmhlYWRlcl9icmlnYWRlLApAQCAtMzQ0LDEwICsz
NzcsMTggQEAgc3RhdGljIGludCBzdHJlYW1fcmVxYm9keV9jaHVua2VkKGFwcl9wb29sX3QgKnAs
CiAgICAgICAgIGJiID0gaW5wdXRfYnJpZ2FkZTsKICAgICB9CiAKLSAgICBlID0gYXByX2J1Y2tl
dF9pbW1vcnRhbF9jcmVhdGUoQVNDSUlfWkVSTyBBU0NJSV9DUkxGCisgICAgaWYgKGFwcl9pc19l
bXB0eV90YWJsZShyLT50cmFpbGVyc19pbikpIHsKKyAgICAgICAgZSA9IGFwcl9idWNrZXRfaW1t
b3J0YWxfY3JlYXRlKEFTQ0lJX1pFUk8gQVNDSUlfQ1JMRgogICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAvKiA8dHJhaWxlcnM+ICovCiAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIEFTQ0lJX0NSTEYsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
IDUsIGJ1Y2tldF9hbGxvYyk7CisgICAgfSBlbHNlIHsKKyAgICAgICAgZSA9IGFwcl9idWNrZXRf
aW1tb3J0YWxfY3JlYXRlKEFTQ0lJX1pFUk8gQVNDSUlfQ1JMRiwKKyAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgMywgYnVja2V0X2FsbG9jKTsKKyAgICAgICAgQVBSX0JSSUdBREVf
SU5TRVJUX1RBSUwoYmIsIGUpOworICAgICAgICBmb3J3YXJkX2RlY2xhcmVkX3RyYWlsZXJzKHAs
IHIsIGJ1Y2tldF9hbGxvYywgYmIpOworICAgICAgICBlID0gYXByX2J1Y2tldF9pbW1vcnRhbF9j
cmVhdGUoQVNDSUlfQ1JMRiwgMiwgYnVja2V0X2FsbG9jKTsKKyAgICB9CiAgICAgQVBSX0JSSUdB
REVfSU5TRVJUX1RBSUwoYmIsIGUpOwogCiAgICAgaWYgKGFwcl90YWJsZV9nZXQoci0+c3VicHJv
Y2Vzc19lbnYsICJwcm94eS1zZW5kZXh0cmFjcmxmIikpIHsKQEAgLTkzMiw3ICs5NzMsMTggQEAg
c2tpcF9ib2R5OgogICAgICAgICBlID0gYXByX2J1Y2tldF9wb29sX2NyZWF0ZShidWYsIHN0cmxl
bihidWYpLCBwLCBjLT5idWNrZXRfYWxsb2MpOwogICAgICAgICBBUFJfQlJJR0FERV9JTlNFUlRf
VEFJTChoZWFkZXJfYnJpZ2FkZSwgZSk7CiAgICAgfQotCisgICAgLyoqIHBhc3MgdGFpbGVyIGhl
YWRlciBhbmQgZW5mb3JjZSBjaHVua2VkICovCisgICAgaWYgKG9sZF90ZV92YWwpIHsKKyAgICAg
ICAgY29uc3QgY2hhciAqdHJhaWxlciA9IGFwcl90YWJsZV9nZXQoci0+aGVhZGVyc19pbiwgIlRy
YWlsZXIiKTsKKyAgICAgICAgaWYgKHRyYWlsZXIpIHsKKyAgICAgICAgICAgIGNoYXIgKmJ1ZiA9
IGFwcl9wc3RyY2F0KHAsICJUcmFpbGVyOiAiLCB0cmFpbGVyLCBDUkxGLCBOVUxMKTsKKyAgICAg
ICAgICAgIGFwX3hsYXRlX3Byb3RvX3RvX2FzY2lpKGJ1Ziwgc3RybGVuKGJ1ZikpOworICAgICAg
ICAgICAgQVBSX0JSSUdBREVfSU5TRVJUX1RBSUwoaGVhZGVyX2JyaWdhZGUsCisgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICBhcHJfYnVja2V0X3Bvb2xfY3JlYXRlKGJ1Ziwgc3Ry
bGVuKGJ1ZiksCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIHAsIGJ1Y2tldF9hbGxvYykpOworICAgICAgICAgICAgcmJfbWV0aG9kID0g
UkJfU1RSRUFNX0NIVU5LRUQ7CisgICAgICAgIH0KKyAgICB9CiAgICAgLyogc2VuZCB0aGUgcmVx
dWVzdCBib2R5LCBpZiBhbnkuICovCiAgICAgc3dpdGNoKHJiX21ldGhvZCkgewogICAgIGNhc2Ug
UkJfU1RSRUFNX0NIVU5LRUQ6Cg==
--047d7b1117b7269c4605234dd8e5--

From dev-return-84485-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Fri Oct 30 14:40:50 2015
Return-Path: <dev-return-84485-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id CD6F2183D5
	for <apmail-httpd-dev-archive@www.apache.org>; Fri, 30 Oct 2015 14:40:50 +0000 (UTC)
Received: (qmail 26180 invoked by uid 500); 30 Oct 2015 14:39:52 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 26104 invoked by uid 500); 30 Oct 2015 14:39:52 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 26094 invoked by uid 99); 30 Oct 2015 14:39:51 -0000
Received: from Unknown (HELO spamd4-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 30 Oct 2015 14:39:51 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd4-us-west.apache.org (ASF Mail Server at spamd4-us-west.apache.org) with ESMTP id 85703C0FCF
	for <dev@httpd.apache.org>; Fri, 30 Oct 2015 14:39:51 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd4-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.121
X-Spam-Level:
X-Spam-Status: No, score=-0.121 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RCVD_IN_MSPIKE_H3=-0.01, RCVD_IN_MSPIKE_WL=-0.01, SPF_PASS=-0.001]
	autolearn=disabled
Authentication-Results: spamd4-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-us-west.apache.org ([10.40.0.8])
	by localhost (spamd4-us-west.apache.org [10.40.0.11]) (amavisd-new, port 10024)
	with ESMTP id u4Zfj5__A80h for <dev@httpd.apache.org>;
	Fri, 30 Oct 2015 14:39:51 +0000 (UTC)
Received: from mail-qk0-f181.google.com (mail-qk0-f181.google.com [209.85.220.181])
	by mx1-us-west.apache.org (ASF Mail Server at mx1-us-west.apache.org) with ESMTPS id BE44F20634
	for <dev@httpd.apache.org>; Fri, 30 Oct 2015 14:39:50 +0000 (UTC)
Received: by qkbl190 with SMTP id l190so31401259qkb.2
        for <dev@httpd.apache.org>; Fri, 30 Oct 2015 07:39:50 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        bh=Isvo0+lBiMXgpOA4ClOUmHNLxMXr5Lpcrwxy3CDdhBQ=;
        b=r01KmLBMJ4arWLYButEKrFaiQ65uZZGZitfvV5uv/W8PRGptCF7BY06c4C5iAHAaxm
         jW+rgFEsBKA1oBZ7u6od4l8Y3SHXFZiWAcMSCQhFK6yBr8Yxsuz+EDzcvDws1ZEWFvbF
         6Z3LgXYXnCcAwrQYwyNIqkSyDuwt6d5XF4kMNSkuhcxEgKAMjcct6E7AIWI8OSFtX/4i
         3vqq/Njv7DvS4O6Vtwawpdzl2JrsqFV/zsvVJqjUECMT7JwVc36Y9IvoAnAtU5CU9ast
         vJnyq9uOoqiD1AAtJwwHk2pxMzX+j3CUwhPYtFTym0bzumhHY+jtVwGRfhhMZVDqZIgb
         dhlA==
MIME-Version: 1.0
X-Received: by 10.55.74.197 with SMTP id x188mr10351773qka.38.1446215989962;
 Fri, 30 Oct 2015 07:39:49 -0700 (PDT)
Received: by 10.55.101.196 with HTTP; Fri, 30 Oct 2015 07:39:49 -0700 (PDT)
In-Reply-To: <20151030140728.824EF3A0288@svn01-us-west.apache.org>
References: <20151030140728.824EF3A0288@svn01-us-west.apache.org>
Date: Fri, 30 Oct 2015 15:39:49 +0100
Message-ID: <CAKQ1sVMO_RAQmOOVj=43b7ouq8UOHSbnRNu5O8y92o__L2kP_A@mail.gmail.com>
Subject: Re: svn commit: r1711479 - in /httpd/httpd/trunk/server/mpm:
 event/event.c prefork/prefork.c worker/worker.c
From: Yann Ylavic <ylavic.dev@gmail.com>
To: dev@httpd.apache.org
Content-Type: text/plain; charset=UTF-8

Hi Jan,

On Fri, Oct 30, 2015 at 3:07 PM,  <jkaluza@apache.org> wrote:
> Author: jkaluza
> Date: Fri Oct 30 14:07:28 2015
> New Revision: 1711479
>
> URL: http://svn.apache.org/viewvc?rev=1711479&view=rev
> Log:
> Fix crash in ap_mpm_pod_check call caused by NULL dereference of its parameter
> when starting httpd as single process (httpd -X).
>
> Modified:
>     httpd/httpd/trunk/server/mpm/event/event.c
>     httpd/httpd/trunk/server/mpm/prefork/prefork.c
>     httpd/httpd/trunk/server/mpm/worker/worker.c

Is that change also needed for event and worker?
The old code (previous to r1705492 in 2.4.x) did not create the POD in
one-process mode for those.

Regards,
Yann.

From dev-return-84486-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Fri Oct 30 15:04:53 2015
Return-Path: <dev-return-84486-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 98230184A3
	for <apmail-httpd-dev-archive@www.apache.org>; Fri, 30 Oct 2015 15:04:53 +0000 (UTC)
Received: (qmail 95143 invoked by uid 500); 30 Oct 2015 15:04:40 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 95079 invoked by uid 500); 30 Oct 2015 15:04:40 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 95069 invoked by uid 99); 30 Oct 2015 15:04:40 -0000
Received: from Unknown (HELO spamd3-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 30 Oct 2015 15:04:40 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd3-us-west.apache.org (ASF Mail Server at spamd3-us-west.apache.org) with ESMTP id B63EE180983
	for <dev@httpd.apache.org>; Fri, 30 Oct 2015 15:04:39 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd3-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 1.998
X-Spam-Level: *
X-Spam-Status: No, score=1.998 tagged_above=-999 required=6.31
	tests=[FREEMAIL_REPLY=1, KAM_LAZY_DOMAIN_SECURITY=1,
	RCVD_IN_MSPIKE_H2=-0.001, SPF_HELO_PASS=-0.001] autolearn=disabled
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd3-us-west.apache.org [10.40.0.10]) (amavisd-new, port 10024)
	with ESMTP id eha0cnEzLOEq for <dev@httpd.apache.org>;
	Fri, 30 Oct 2015 15:04:26 +0000 (UTC)
Received: from mail1.bemta3.messagelabs.com (mail1.bemta3.messagelabs.com [195.245.230.176])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id 40F4D20F26
	for <dev@httpd.apache.org>; Fri, 30 Oct 2015 15:04:26 +0000 (UTC)
Received: from [195.245.230.51] by server-16.bemta-3.messagelabs.com id 77/6B-03763-3F683365; Fri, 30 Oct 2015 15:04:19 +0000
X-Env-Sender: ruediger.pluem@vodafone.com
X-Msg-Ref: server-4.tower-33.messagelabs.com!1446217459!251762!1
X-Originating-IP: [195.232.244.135]
X-StarScan-Received:
X-StarScan-Version: 7.19.2; banners=-,-,-
X-VirusChecked: Checked
Received: (qmail 15441 invoked from network); 30 Oct 2015 15:04:19 -0000
Received: from mailout03.vodafone.com (HELO mailout03.vodafone.com) (195.232.244.135)
  by server-4.tower-33.messagelabs.com with AES256-SHA encrypted SMTP; 30 Oct 2015 15:04:19 -0000
Received: from mailint01.vodafone.com (mailint01.vodafone.com [195.232.244.198])
	by mailout03.vodafone.com (Postfix) with ESMTP id 3nnRkC1lbqz17HNR
	for <dev@httpd.apache.org>; Fri, 30 Oct 2015 16:04:19 +0100 (CET)
Received: from mailint01.vodafone.com (localhost [127.0.0.1])
	by mailint01.vodafone.com (Postfix) with ESMTP id 3nnRkC0qDnzxPs6
	for <dev@httpd.apache.org>; Fri, 30 Oct 2015 16:04:19 +0100 (CET)
Received: from VOEXC04W.internal.vodafone.com (voexc04w.dc-ratingen.de [145.230.101.24])
	(using TLSv1 with cipher AES128-SHA (128/128 bits))
	(No client certificate requested)
	by mailint01.vodafone.com (Postfix) with ESMTPS id 3nnRkC0Tt4zxPZx
	for <dev@httpd.apache.org>; Fri, 30 Oct 2015 16:04:19 +0100 (CET)
Received: from VOEXC18W.internal.vodafone.com (145.230.101.20) by
 VOEXC04W.internal.vodafone.com (145.230.101.24) with Microsoft SMTP Server
 (TLS) id 14.3.224.2; Fri, 30 Oct 2015 16:04:18 +0100
Received: from VOEXM10W.internal.vodafone.com ([169.254.2.167]) by
 voexc18w.internal.vodafone.com ([145.230.101.20]) with mapi id
 14.03.0224.002; Fri, 30 Oct 2015 16:04:18 +0100
From: =?utf-8?B?UGzDvG0sIFLDvGRpZ2VyLCBWb2RhZm9uZSBHcm91cA==?=
	<ruediger.pluem@vodafone.com>
To: "dev@httpd.apache.org" <dev@httpd.apache.org>
Subject: AW: svn commit: r1711479 - in /httpd/httpd/trunk/server/mpm:
 event/event.c prefork/prefork.c worker/worker.c
Thread-Topic: svn commit: r1711479 - in /httpd/httpd/trunk/server/mpm:
 event/event.c prefork/prefork.c worker/worker.c
Thread-Index: AQHREyDay8dXpTeBvkSUcQDLOQrLuJ6EIdpA
Date: Fri, 30 Oct 2015 15:04:17 +0000
Message-ID: <AB1691BE05AE7F4992697F2A0835627AC638D185@VOEXM10W.internal.vodafone.com>
References: <20151030140728.824EF3A0288@svn01-us-west.apache.org>
 <CAKQ1sVMO_RAQmOOVj=43b7ouq8UOHSbnRNu5O8y92o__L2kP_A@mail.gmail.com>
In-Reply-To: <CAKQ1sVMO_RAQmOOVj=43b7ouq8UOHSbnRNu5O8y92o__L2kP_A@mail.gmail.com>
Accept-Language: en-US
Content-Language: de-DE
X-MS-Has-Attach:
X-MS-TNEF-Correlator:
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
MIME-Version: 1.0

DQoNCj4gLS0tLS1VcnNwcsO8bmdsaWNoZSBOYWNocmljaHQtLS0tLQ0KPiBWb246IFlhbm4gWWxh
dmljIFttYWlsdG86eWxhdmljLmRldkBnbWFpbC5jb21dDQo+IEdlc2VuZGV0OiBGcmVpdGFnLCAz
MC4gT2t0b2JlciAyMDE1IDE1OjQwDQo+IEFuOiBkZXZAaHR0cGQuYXBhY2hlLm9yZw0KPiBCZXRy
ZWZmOiBSZTogc3ZuIGNvbW1pdDogcjE3MTE0NzkgLSBpbiAvaHR0cGQvaHR0cGQvdHJ1bmsvc2Vy
dmVyL21wbToNCj4gZXZlbnQvZXZlbnQuYyBwcmVmb3JrL3ByZWZvcmsuYyB3b3JrZXIvd29ya2Vy
LmMNCj4gDQo+IEhpIEphbiwNCj4gDQo+IE9uIEZyaSwgT2N0IDMwLCAyMDE1IGF0IDM6MDcgUE0s
ICA8amthbHV6YUBhcGFjaGUub3JnPiB3cm90ZToNCj4gPiBBdXRob3I6IGprYWx1emENCj4gPiBE
YXRlOiBGcmkgT2N0IDMwIDE0OjA3OjI4IDIwMTUNCj4gPiBOZXcgUmV2aXNpb246IDE3MTE0NzkN
Cj4gPg0KPiA+IFVSTDogaHR0cDovL3N2bi5hcGFjaGUub3JnL3ZpZXd2Yz9yZXY9MTcxMTQ3OSZ2
aWV3PXJldg0KPiA+IExvZzoNCj4gPiBGaXggY3Jhc2ggaW4gYXBfbXBtX3BvZF9jaGVjayBjYWxs
IGNhdXNlZCBieSBOVUxMIGRlcmVmZXJlbmNlIG9mIGl0cw0KPiBwYXJhbWV0ZXINCj4gPiB3aGVu
IHN0YXJ0aW5nIGh0dHBkIGFzIHNpbmdsZSBwcm9jZXNzIChodHRwZCAtWCkuDQo+ID4NCj4gPiBN
b2RpZmllZDoNCj4gPiAgICAgaHR0cGQvaHR0cGQvdHJ1bmsvc2VydmVyL21wbS9ldmVudC9ldmVu
dC5jDQo+ID4gICAgIGh0dHBkL2h0dHBkL3RydW5rL3NlcnZlci9tcG0vcHJlZm9yay9wcmVmb3Jr
LmMNCj4gPiAgICAgaHR0cGQvaHR0cGQvdHJ1bmsvc2VydmVyL21wbS93b3JrZXIvd29ya2VyLmMN
Cj4gDQo+IElzIHRoYXQgY2hhbmdlIGFsc28gbmVlZGVkIGZvciBldmVudCBhbmQgd29ya2VyPw0K
PiBUaGUgb2xkIGNvZGUgKHByZXZpb3VzIHRvIHIxNzA1NDkyIGluIDIuNC54KSBkaWQgbm90IGNy
ZWF0ZSB0aGUgUE9EIGluDQo+IG9uZS1wcm9jZXNzIG1vZGUgZm9yIHRob3NlLg0KDQpXZSBvbmx5
IGNhbGwgYXBfbXBtX3BvZF9jaGVjayBpbiBwcmVmb3JrIGFuZCBtb3RvcnouIFNvIHdoeSBpcyB0
aGlzIG5lZWRlZCBmb3INCndvcmtlciBhbmQgZXZlbnQ/DQoNClJlZ2FyZHMNCg0KUsO8ZGlnZXIN
Cg0K

From dev-return-84487-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Fri Oct 30 15:32:47 2015
Return-Path: <dev-return-84487-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 5861A185D5
	for <apmail-httpd-dev-archive@www.apache.org>; Fri, 30 Oct 2015 15:32:47 +0000 (UTC)
Received: (qmail 70626 invoked by uid 500); 30 Oct 2015 15:32:30 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 70550 invoked by uid 500); 30 Oct 2015 15:32:30 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 70540 invoked by uid 99); 30 Oct 2015 15:32:30 -0000
Received: from Unknown (HELO spamd4-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 30 Oct 2015 15:32:30 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd4-us-west.apache.org (ASF Mail Server at spamd4-us-west.apache.org) with ESMTP id 04CF4C0F94
	for <dev@httpd.apache.org>; Fri, 30 Oct 2015 15:32:30 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd4-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.101
X-Spam-Level:
X-Spam-Status: No, score=-0.101 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RCVD_IN_MSPIKE_H2=-0.001, SPF_PASS=-0.001, URIBL_BLOCKED=0.001]
	autolearn=disabled
Authentication-Results: spamd4-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd4-us-west.apache.org [10.40.0.11]) (amavisd-new, port 10024)
	with ESMTP id R01py8Vn_lh2 for <dev@httpd.apache.org>;
	Fri, 30 Oct 2015 15:32:23 +0000 (UTC)
Received: from mail-ig0-f175.google.com (mail-ig0-f175.google.com [209.85.213.175])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id D638A44496
	for <dev@httpd.apache.org>; Fri, 30 Oct 2015 15:32:22 +0000 (UTC)
Received: by igpw7 with SMTP id w7so14188357igp.0
        for <dev@httpd.apache.org>; Fri, 30 Oct 2015 08:32:22 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type:content-transfer-encoding;
        bh=sBAwL9Xu+1hL90bFIBtwHZgZVwo0qIJGangy1XWNJNY=;
        b=FAbVn0Rtn/r+7lrfsGOOEdhT0mvctmk3KIK3LFszuoY1mZ2W64kh5dpAIu+oBh19pP
         fNkWTlxJQZi3HBRh4xuIQjDDIm+U/uHN5I9QfCsDS8H0Qf41pFzkJvqQ2b+8ICoT8vbj
         984JXq22exVMTlrsgTS1JzvAfzh/ynTImDIZhfcGDOkepd2ZX98Hhcev4LCyZ2Q2LWvS
         en/EPjt1yT9KBkCZADaPjp/Rt8qCjcpfZhMD2EBG6AFVRfcWGFrQEmRgPzXbnY1kx5k9
         +oKtSIQhuo5s72V3ltOxwKs7mXujnYmquS7mj67uKJl3rU7TzCvJgyxn99d4ZAopkP3B
         9XcQ==
MIME-Version: 1.0
X-Received: by 10.50.122.68 with SMTP id lq4mr3852058igb.87.1446219142475;
 Fri, 30 Oct 2015 08:32:22 -0700 (PDT)
Received: by 10.64.39.100 with HTTP; Fri, 30 Oct 2015 08:32:22 -0700 (PDT)
In-Reply-To: <AB1691BE05AE7F4992697F2A0835627AC638D185@VOEXM10W.internal.vodafone.com>
References: <20151030140728.824EF3A0288@svn01-us-west.apache.org>
	<CAKQ1sVMO_RAQmOOVj=43b7ouq8UOHSbnRNu5O8y92o__L2kP_A@mail.gmail.com>
	<AB1691BE05AE7F4992697F2A0835627AC638D185@VOEXM10W.internal.vodafone.com>
Date: Fri, 30 Oct 2015 16:32:22 +0100
Message-ID: <CAKQ1sVPuqasvY8qWPJEao3oh9ozFAO_PJXBt+_yyHnZTgZeqiA@mail.gmail.com>
Subject: Re: svn commit: r1711479 - in /httpd/httpd/trunk/server/mpm:
 event/event.c prefork/prefork.c worker/worker.c
From: Yann Ylavic <ylavic.dev@gmail.com>
To: dev@httpd.apache.org
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: quoted-printable

On Fri, Oct 30, 2015 at 4:04 PM, Pl=C3=BCm, R=C3=BCdiger, Vodafone Group
<ruediger.pluem@vodafone.com> wrote:
>
>
>> -----Urspr=C3=BCngliche Nachricht-----
>> Von: Yann Ylavic [mailto:ylavic.dev@gmail.com]
>> Gesendet: Freitag, 30. Oktober 2015 15:40
>> An: dev@httpd.apache.org
>> Betreff: Re: svn commit: r1711479 - in /httpd/httpd/trunk/server/mpm:
>> event/event.c prefork/prefork.c worker/worker.c
>>
>> Hi Jan,
>>
>> On Fri, Oct 30, 2015 at 3:07 PM,  <jkaluza@apache.org> wrote:
>> > Author: jkaluza
>> > Date: Fri Oct 30 14:07:28 2015
>> > New Revision: 1711479
>> >
>> > URL: http://svn.apache.org/viewvc?rev=3D1711479&view=3Drev
>> > Log:
>> > Fix crash in ap_mpm_pod_check call caused by NULL dereference of its
>> parameter
>> > when starting httpd as single process (httpd -X).
>> >
>> > Modified:
>> >     httpd/httpd/trunk/server/mpm/event/event.c
>> >     httpd/httpd/trunk/server/mpm/prefork/prefork.c
>> >     httpd/httpd/trunk/server/mpm/worker/worker.c
>>
>> Is that change also needed for event and worker?
>> The old code (previous to r1705492 in 2.4.x) did not create the POD in
>> one-process mode for those.
>
> We only call ap_mpm_pod_check in prefork and motorz.

We use the podx variant for worker and event.

> So why is this needed for
> worker and event?

Sorry, I may have not been clear enough.
My point is that this change/commit is *not* needed for event and
worker, because (AFAICT) we don't touch the POD(x) in one-process
mode, so we don't need to create it for these MPMs.

Regards,
Yann.

From dev-return-84488-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Fri Oct 30 22:23:33 2015
Return-Path: <dev-return-84488-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id AF8BC1802E
	for <apmail-httpd-dev-archive@www.apache.org>; Fri, 30 Oct 2015 22:23:30 +0000 (UTC)
Received: (qmail 34214 invoked by uid 500); 30 Oct 2015 22:23:30 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 34059 invoked by uid 500); 30 Oct 2015 22:23:30 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 34026 invoked by uid 99); 30 Oct 2015 22:23:29 -0000
Received: from Unknown (HELO spamd3-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 30 Oct 2015 22:23:29 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd3-us-west.apache.org (ASF Mail Server at spamd3-us-west.apache.org) with ESMTP id 67D98180974;
	Fri, 30 Oct 2015 22:23:29 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd3-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 2.89
X-Spam-Level: **
X-Spam-Status: No, score=2.89 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	HTML_MESSAGE=3, SPF_PASS=-0.001, T_RP_MATCHES_RCVD=-0.01,
	URIBL_BLOCKED=0.001] autolearn=disabled
Authentication-Results: spamd3-us-west.apache.org (amavisd-new);
	dkim=pass (1024-bit key) header.d=fmr.com
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd3-us-west.apache.org [10.40.0.10]) (amavisd-new, port 10024)
	with ESMTP id exAug_iUG-ax; Fri, 30 Oct 2015 22:23:15 +0000 (UTC)
Received: from msgimsm103vapp.fmr.com (msgimsm103vapp.fmr.com [192.223.198.36])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id DE5E342ABE;
	Fri, 30 Oct 2015 22:23:14 +0000 (UTC)
Received: from MSGRTP1DAG01E.DMN1.FMR.com (MSGRTP1DAG01E.dmn1.fmr.com [10.95.186.12])
	by msgimsm103vapp.fmr.com (Sentrion-MTA-4.3.2/Sentrion-MTA-4.3.2) with ESMTP id t9UMN7Rk024922
	(version=TLSv1.2 cipher=ECDHE-RSA-AES256-SHA384 bits=256 verify=FAIL);
	Fri, 30 Oct 2015 22:23:07 GMT
DKIM-Filter: OpenDKIM Filter v2.7.5 msgimsm103vapp.fmr.com t9UMN7Rk024922
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=fmr.com;
	s=2015-02-19-fmr-com; t=1446243788;
	bh=o2vYgXXbOmqgs+PCap4P6ZFKTSEIi5c14o2dS7TSKvM=;
	h=From:To:CC:Subject:Date;
	b=zR8FZ6bAZsS9yGaef2hD8E8wamoabYNJeGvWKAZ59WhX+zDxzeXrgpxBq9LFOC0V7
	 nRVygfnaIIxTFHMeBWVFk36rgq/TmShwwFEDt6Ne5r08cRl1i8zBZb/GY7l3QU/Une
	 o/65fPlNMmui0O2fSh60w5ov6+t9Jt/YuUJh0fNM=
Received: from MSGRTP1DAG01A.DMN1.FMR.com (10.95.186.11) by
 MSGRTP1DAG01E.DMN1.FMR.com (10.95.186.12) with Microsoft SMTP Server (TLS) id
 15.0.1130.7; Fri, 30 Oct 2015 18:23:06 -0400
Received: from MSGRTP1DAG01A.DMN1.FMR.com ([fe80::9163:469:bebf:780]) by
 MSGRTP1DAG01A.DMN1.FMR.com ([fe80::9163:469:bebf:780%18]) with mapi id
 15.00.1130.005; Fri, 30 Oct 2015 18:23:06 -0400
From: "Greenberg, Adam" <Adam.Greenberg@FMR.COM>
To: "dev@httpd.apache.org" <dev@httpd.apache.org>,
        "users@httpd.apache.org"
	<users@httpd.apache.org>
CC: "wrowe@apache.org" <wrowe@apache.org>,
        "William A. Rowe Jr."
	<wrowe@pivotal.io>,
        "PAN, JIN" <Jin.Pan@fmr.com>
Subject: RE: merging Apache <Directory> context
Thread-Topic: merging Apache <Directory> context
Thread-Index: AdETYX2GPjeDgm/CSau1sAL1AfIRgg==
Date: Fri, 30 Oct 2015 22:23:06 +0000
Message-ID: <adfc9e96fd3d41d88ff3059182439031@MSGRTP1DAG01A.DMN1.FMR.com>
Accept-Language: en-US
Content-Language: en-US
X-MS-Has-Attach: yes
X-MS-TNEF-Correlator:
x-ms-exchange-transport-fromentityheader: Hosted
x-originating-ip: [10.25.1.114]
Content-Type: multipart/mixed;
	boundary="_004_adfc9e96fd3d41d88ff3059182439031MSGRTP1DAG01ADMN1FMRcom_"
MIME-Version: 1.0

--_004_adfc9e96fd3d41d88ff3059182439031MSGRTP1DAG01ADMN1FMRcom_
Content-Type: multipart/alternative;
	boundary="_000_adfc9e96fd3d41d88ff3059182439031MSGRTP1DAG01ADMN1FMRcom_"

--_000_adfc9e96fd3d41d88ff3059182439031MSGRTP1DAG01ADMN1FMRcom_
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64

SGkgQmlsbCAodGhpcyBpcyBhIHJlc2VuZCB0byBpbmNsdWRlIHRoZSBkZXYgYW5kIHVzZXIgY29t
bXVuaXRpZXMsIHBlciB5b3VyIGluc3RydWN0aW9ucyk6DQoNClRoYW5rcyB2ZXJ5IG11Y2ggZm9y
IHRoZSBwcm9tcHQgcmVzcG9uc2UuIEkgYmVsaWV2ZSB3ZSBoYXZlIGNvdmVyZWQgYWxsIG9mIHRo
ZSBzdGVwcyB5b3UgaW5kaWNhdGUgYmVsb3cuIEF0dGFjaGVkIHBsZWFzZSBmaW5kIGEgdGFyIGZp
bGUgdGhhdCBjb250YWlucyBhIHNpbXBsZSBDKysgbW9kdWxlIGFuZCBhIG1ha2VmaWxlIHRvIGJ1
aWxkIGl0Lg0KDQpPdXIgdGVzdCBzZXJ2ZXIgaHR0cC5jb25mIGhhcyBhIExvYWRNb2R1bGUgbGlu
ZSBmb3IgdGhlIG1vZHVsZSBhbmQgdGhlbiB0aGUgZm9sbG93aW5nIHNldCBvZiBkaXJlY3Rvcnkg
c2VjdGlvbnM6DQoNCjxEaXJlY3RvcnkgL2Zvbz4NCiAgZGlyQ29uZmlnIC9mb28NCjwvRGlyZWN0
b3J5Pg0KDQo8RGlyZWN0b3J5IC8+DQogIGRpckNvbmZpZyAvDQo8L0RpcmVjdG9yeT4NCg0KPERp
cmVjdG9yeSAvZm9vL2Jhcj4NCiAgZGlyQ29uZmlnIC9mb28vYmFyDQo8L0RpcmVjdG9yeT4NCg0K
V2hlbiB3ZSBleGVjdXRlIHRoZSBzZXJ2ZXIsIHdlIHNlZSB0aGlzIG9uIHRoZSBjb25zb2xlOg0K
DQojIGJpbi9hcGFjaGVjdGwgc3RhcnQNCkNyZWF0ZWQgZGlyQ29uZmlnIGZvciBjb250ZXh0OiB1
bnNldA0KQ3JlYXRlZCBkaXJDb25maWcgZm9yIGNvbnRleHQ6IC9mb28vDQpJbnNlcnRlZCBkaXJD
b25maWcgd2l0aCBtZXNzYWdlOiAvZm9vDQpDcmVhdGVkIGRpckNvbmZpZyBmb3IgY29udGV4dDog
Lw0KSW5zZXJ0ZWQgZGlyQ29uZmlnIHdpdGggbWVzc2FnZTogLw0KQ3JlYXRlZCBkaXJDb25maWcg
Zm9yIGNvbnRleHQ6IC9mb28vYmFyLw0KSW5zZXJ0ZWQgZGlyQ29uZmlnIHdpdGggbWVzc2FnZTog
L2Zvby9iYXINCkNyZWF0ZWQgZGlyQ29uZmlnIGZvciBjb250ZXh0OiB1bnNldA0KDQpBbmQgdGhp
cyBpbiB0aGUgbG9nOg0KDQpNZXJnZWQgY29uZmlnOiB1bnNldDovDQrigKYNCmhvb2tGdW5jOiBm
b3IgcmVxdWVzdCAvZm9vL2Jhci9mb28uaHRtbCB0aGUgY29udGV4dCBpczogdW5zZXQ6Lw0KDQpX
ZSBkbyBub3Qgc2VlIGFueSBvdGhlciBtZXNzYWdlcy4gVGhlIGZpbGUgL2Zvby9iYXIvZm9vLmh0
bWwgZXhpc3RzIGFuZCB0aGUgYnJvd3NlciBkaXNwbGF5cyBpdC4gVGhpcyBzdWdnZXN0cyB0aGF0
IHRoZSBtZXJnZSBzZXF1ZW5jZSBmb3IgdGhlIGxhc3QgZGlyZWN0b3J5IHNlY3Rpb24gc3RvcHBl
ZCB3aXRoIHRoZSBjb25maWd1cmF0aW9uIGZvciB0aGUg4oCcL+KAnSBzZWN0aW9uLiAgUGVyaGFw
cyB5b3UgY291bGQgcG9pbnQgb3V0IHdoYXQgd291bGQgY2F1c2UgdGhpcyBiZWhhdmlvcj8NCg0K
VGhhbmtzOg0KQWRhbQ0KDQoNCkZyb206IFdpbGxpYW0gQS4gUm93ZSBKci4gW21haWx0bzp3cm93
ZUBwaXZvdGFsLmlvXQ0KU2VudDogVGh1cnNkYXksIE9jdG9iZXIgMjksIDIwMTUgNjowNCBQTQ0K
VG86IFBBTiwgSklODQpDYzogd3Jvd2VAYXBhY2hlLm9yZzsgR3JlZW5iZXJnLCBBZGFtDQpTdWJq
ZWN0OiBSZTogbWVyZ2luZyBBcGFjaGUgPERpcmVjdG9yeT4gY29udGV4dA0KDQpIaSBKaW4sDQoN
CnRoZXJlIG1pZ2h0IGJlIG1vcmUgdGhhbiBvbmUgdGhpbmcgZ29pbmcgb24gaGVyZS4NCg0KRmly
c3QsIGl0IGlzIGNyaXRpY2FsIHRoYXQgYSBkaXJlY3RpdmUgYmVsb25naW5nIHRvIHRoZSBtb2R1
bGUgb2NjdXJzIGluIGVhY2ggb2YgdGhlIDxzZWN0aW9uID4gYmxvY2tzIHlvdSBhcmUgbWVyZ2lu
Zy4NCg0KUmVtZW1iZXIgaHR0cGQgaXMgbm90IGdvaW5nIHRvIGV2ZW4gY3JlYXRlIGEgY29uZmln
IHNlY3Rpb24sIG5ldmVyIG1pbmQgbWVyZ2UgdGhlbSwgZm9yIGV2ZXJ5IG1vZHVsZSB3aG9zZSBk
aXJlY3RpdmVzIGRvIG5vdCBhcHBlYXIgaW4gYSBnaXZlbiA8c2VjdGlvbiA+IC0gdGhpcyBpcyB3
aGF0IG1ha2VzIGh0dHBkIHNvIGVmZmljaWVudC4NCg0KU2Vjb25kLCBpZiB0aGVyZSBpcyBhIGJ1
ZyBpbiB0aGUgY21kIGhhbmRsZXIsIHlvdXIgY3R4IG1lbWJlciBtaWdodCBub3QgYmUgY29ycmVj
dGx5IHVwZGF0ZWQgZm9yIGEgc2VjdGlvbiwgc2FtZSBpcyB0cnVlIGZvciBhIGJ1ZyBpbiB0aGUg
Y3JlYXRlIG9yIG1lcmdlIGZ1bmN0aW9uLg0KDQpUaGlyZCwgaHR0cGQgZG9lcyBwZXJmb3JtIHNv
bWUgb3B0aW1pemF0aW9uLCBpdCBtYXkgcHJlbWVyZ2UgZ2xvYmFsIGNvbmZpZ3MgYW5kIG1heSBy
ZXN1bWUgYSBtZXJnZSBmcm9tIHByZXZpb3VzbHkgbWVyZ2VkIHNlY3Rpb25zIHdoZW4gdGhleSBh
cmUgZW5jb3VudGVyZWQgaW4gYSBzdWJyZXF1ZXN0Lg0KDQpJcyB0aGUgcmVzdWx0aW5nIC0+Y3R4
IG1lbWJlciBjb3JyZWN0IGZvciB0aGUgcmVzdWx0aW5nIDxEaXJlY3RvcnkgPiBjb250ZXh0PyAg
SXMgaXQgc2ltcGx5IHRoYXQgdGhlIG1lcmdlIGlzbid0IGNhbGxlZCBhcyBvZnRlbiBhcyBleHBl
Y3RlZD8gIE9wdGltaXphdGlvbiBtYXkgYmUgdGhlIGNhdXNlLg0KDQpJcyB0aGUgY21kIHJlY29y
ZCBmb3IgeW91ciBkaXJlY3RpdmUgc2V0IHRvIE9SX0FDQ0VTUyAodGVsbGluZyBodHRwZCB0aGF0
IGl0IGlzIGEgcGVyLWRpciBhbmQgbm90IHBlci1zZXJ2ZXIgY29uZmlnPykNCg0KSXMgdGhlcmUg
YSBidWcgaW4geW91ciBjcmVhdGUgY29kZSB0aGF0IGlzIHJldHVybmluZyBOVUxMIGluc3RlYWQg
b2YgYSBuZXdseSBpbml0aWFsaXplZCBjb25maWcgc2VjdGlvbj8NCg0KSWYgd2UgbG9vayBhdCB0
aGUgZXhhbXBsZSBvZiBtb2RfZGlyLmMsIGhlcmUgYXJlIHRoZSBrZXkgcG9pbnRzLi4uDQoNCg0K
QVBfREVDTEFSRV9NT0RVTEUoZGlyKSA9IHsNCg0KICAgIFNUQU5EQVJEMjBfTU9EVUxFX1NUVUZG
LA0KDQogICAgY3JlYXRlX2Rpcl9jb25maWcsICAgICAgICAgIC8qIGNyZWF0ZSBwZXItZGlyZWN0
b3J5IGNvbmZpZyBzdHJ1Y3R1cmUgKi8NCg0KICAgIG1lcmdlX2Rpcl9jb25maWdzLCAgICAgICAg
ICAvKiBtZXJnZSBwZXItZGlyZWN0b3J5IGNvbmZpZyBzdHJ1Y3R1cmVzICovDQpBbGwgaXMgd2Vs
bCwgd2UgaGF2ZSBhIGNyZWF0ZSArIG1lcmdlIGhhbmRsZXIuLi4NCg0KDQpzdGF0aWMgdm9pZCAq
Y3JlYXRlX2Rpcl9jb25maWcoYXByX3Bvb2xfdCAqcCwgY2hhciAqZHVtbXkpDQoNCnsNCg0KICAg
IGRpcl9jb25maWdfcmVjICpuZXcgPSBhcHJfcGNhbGxvYyhwLCBzaXplb2YoZGlyX2NvbmZpZ19y
ZWMpKTsNCg0KDQoNCiAgICBuZXctPmluZGV4X25hbWVzID0gTlVMTDsNCg0KICAgIG5ldy0+ZG9f
c2xhc2ggPSBNT0RESVJfVU5TRVQ7DQoNCiAgICBuZXctPmNoZWNraGFuZGxlciA9IE1PRERJUl9V
TlNFVDsNCg0KICAgIG5ldy0+cmVkaXJlY3RfaW5kZXggPSBSRURJUkVDVF9VTlNFVDsNCg0KICAg
IHJldHVybiAodm9pZCAqKSBuZXc7DQoNCn0NCnRoZSBjb3JyZWN0IHN0cnVjdHVyZSBzaXplIGlz
IGNyZWF0ZWQgYW5kIG1lbWJlcnMgaW5pdGlhbGl6ZWQgdG8gZW1wdHkgKGUuZy4gJ3Vuc2V0Jykg
LSB0aGUgbmV3IGFsbG9jYXRpb24gaXMgcmV0dXJuZWQuDQoNCg0Kc3RhdGljIHZvaWQgKm1lcmdl
X2Rpcl9jb25maWdzKGFwcl9wb29sX3QgKnAsIHZvaWQgKmJhc2V2LCB2b2lkICphZGR2KQ0KDQp7
DQoNCiAgICBkaXJfY29uZmlnX3JlYyAqbmV3ID0gYXByX3BjYWxsb2MocCwgc2l6ZW9mKGRpcl9j
b25maWdfcmVjKSk7DQoNCiAgICBkaXJfY29uZmlnX3JlYyAqYmFzZSA9IChkaXJfY29uZmlnX3Jl
YyAqKWJhc2V2Ow0KDQogICAgZGlyX2NvbmZpZ19yZWMgKmFkZCA9IChkaXJfY29uZmlnX3JlYyAq
KWFkZHY7DQoNCg0KDQogICAgbmV3LT5pbmRleF9uYW1lcyA9IGFkZC0+aW5kZXhfbmFtZXMgPyBh
ZGQtPmluZGV4X25hbWVzIDogYmFzZS0+aW5kZXhfbmFtZXM7DQoNCiAgICBuZXctPmRvX3NsYXNo
ID0NCg0KICAgICAgICAoYWRkLT5kb19zbGFzaCA9PSBNT0RESVJfVU5TRVQpID8gYmFzZS0+ZG9f
c2xhc2ggOiBhZGQtPmRvX3NsYXNoOw0KDQogICAgbmV3LT5jaGVja2hhbmRsZXIgPQ0KDQogICAg
ICAgIChhZGQtPmNoZWNraGFuZGxlciA9PSBNT0RESVJfVU5TRVQpID8gYmFzZS0+Y2hlY2toYW5k
bGVyIDogYWRkLT5jaGVja2hhbmRsZXI7DQoNCiAgICBuZXctPnJlZGlyZWN0X2luZGV4PQ0KDQog
ICAgICAgIChhZGQtPnJlZGlyZWN0X2luZGV4ID09IFJFRElSRUNUX1VOU0VUKSA/IGJhc2UtPnJl
ZGlyZWN0X2luZGV4IDogYWRkLT5yZWRpcmVjdF9pbmRleDsNCg0KICAgIG5ldy0+ZGZsdCA9IGFk
ZC0+ZGZsdCA/IGFkZC0+ZGZsdCA6IGJhc2UtPmRmbHQ7DQoNCiAgICByZXR1cm4gbmV3Ow0KDQp9
DQpBIG5ldyBjb25maWcgaXMgY3JlYXRlZCwgdGhlIHZhcmlvdXMgcGVyLWRpciB2YWx1ZXMgdXBk
YXRlZCwgYW5kIHRoZSByZXN1bHRpbmcgbmV3IGFsbG9jYXRpb24gaXMgcmV0dXJuZWQuDQoNCg0K
c3RhdGljIGNvbnN0IGNvbW1hbmRfcmVjIGRpcl9jbWRzW10gPQ0KDQp7DQoNCi4uLg0KDQogICAg
QVBfSU5JVF9SQVdfQVJHUygiRGlyZWN0b3J5SW5kZXgiLCBhZGRfaW5kZXgsIE5VTEwsIERJUl9D
TURfUEVSTVMsDQoNCiAgICAgICAgICAgICAgICAgICAgImEgbGlzdCBvZiBmaWxlIG5hbWVzIiks
DQpUaGUgRElSX0NNRF9QRVJNUyAoZGVmaW5lZCBhcyBPUl9JTkRFWEVTKSBhc3N1cmVzIGh0dHBk
IHRoYXQgdGhpcyBpcyBhIHBlci1kaXIgY29uZmlnIGRpcmVjdGl2ZSBhbGxvd2VkIHdoZXJldmVy
IHRoZSAnQWxsb3dPdmVycmlkZSBJbmRleGVzJyBpcyBzZXQuDQoNCg0Kc3RhdGljIGNvbnN0IGNo
YXIgKmFkZF9pbmRleChjbWRfcGFybXMgKmNtZCwgdm9pZCAqZHVtbXksIGNvbnN0IGNoYXIgKmFy
ZykNCg0Kew0KDQogICAgZGlyX2NvbmZpZ19yZWMgKmQgPSBkdW1teTsNCg0KICAgIGNvbnN0IGNo
YXIgKnQsICp3Ow0KDQogICAgaW50IGNvdW50ID0gMDsNCg0KDQoNCiAgICBpZiAoIWQtPmluZGV4
X25hbWVzKSB7DQoNCiAgICAgICAgZC0+aW5kZXhfbmFtZXMgPSBhcHJfYXJyYXlfbWFrZShjbWQt
PnBvb2wsIDIsIHNpemVvZihjaGFyICopKTsNCg0KICAgIH0NCg0KDQoNCiAgICB0ID0gYXJnOw0K
DQogICAgd2hpbGUgKCh3ID0gYXBfZ2V0d29yZF9jb25mKGNtZC0+cG9vbCwgJnQpKSAmJiB3WzBd
KSB7DQoNCiAgICAgICAgaWYgKGNvdW50ID09IDAgJiYgIXN0cmNhc2VjbXAodywgImRpc2FibGVk
IikpIHsNCg0KICAgICAgICAgICAgLyogcGVlayB0byBzZWUgaWYgImRpc2FibGVkIiBpcyBmaXJz
dCBpbiBhIHNlcmllcyBvZiBhcmd1bWVudHMgKi8NCg0KICAgICAgICAgICAgY29uc3QgY2hhciAq
dHQgPSB0Ow0KDQogICAgICAgICAgICBjb25zdCBjaGFyICp3dyA9IGFwX2dldHdvcmRfY29uZihj
bWQtPnRlbXBfcG9vbCwgJnR0KTsNCg0KICAgICAgICAgICAgaWYgKHd3WzBdID09ICdcMCcpIHsN
Cg0KICAgICAgICAgICAgICAgLyogImRpc2FibGVkIiBpcyBmaXJzdCwgYW5kIGFsb25lICovDQoN
CiAgICAgICAgICAgICAgIGFwcl9hcnJheV9jbGVhcihkLT5pbmRleF9uYW1lcyk7DQoNCiAgICAg
ICAgICAgICAgIGJyZWFrOw0KDQogICAgICAgICAgICB9DQoNCiAgICAgICAgfQ0KDQogICAgICAg
ICooY29uc3QgY2hhciAqKilhcHJfYXJyYXlfcHVzaChkLT5pbmRleF9uYW1lcykgPSB3Ow0KDQog
ICAgICAgIGNvdW50Kys7DQoNCiAgICB9DQoNCg0KDQogICAgcmV0dXJuIE5VTEw7DQoNCn0NCkhl
cmUgd2UgaXRlcmF0ZSB0aGUgc3RyaW5nIChSQVdfQVJHUykgcGFzc2VkIGJ5IERpcmVjdG9yeUlu
ZGV4IGFuZCBwYXJzZSBpdCB0byBidWlsZCBhbiBhcnJheSBvZiBpbmRleCBzdHJpbmdzLCBhbmQg
c2VlIHdoZXJlIHRoZSBkaXJfY29uZmlnX3JlYyBpcyBkZXJpdmVkIGZyb20gdGhlIGR1bW15IGFy
ZyAoaXQgd291bGQgYmUgZ2l2ZW4gYSBuZXdseS9yZWNlbnRseSBjcmVhdGVkIGRpciBjb25maWcp
LiBOb3RlIGFsc28gdGhhdCBhIHNlY29uZCBvY2N1cmFuY2Ugb2YgRGlyZWN0b3J5SW5kZXgga2Vl
cHMgYnVpbGRpbmcgdGhpcyA8c2VjdGlvbiA+J3MgaW5kZXhfbmFtZSBsaXN0Lg0KDQpCYWNrIHVw
IGluIHRoZSBtZXJnZSBlaXRoZXIga2VlcCB0aGUgcGFyZW50IGxpc3QsIG9yIHJlcGxhY2UgaXQg
aWYgYSBuZXcgbGlzdCB3YXMgY3JlYXRlZCB3aXRoIHRoZSBhZGRfaW5kZXggZGlyZWN0aXZlLg0K
DQpQbGVhc2UgY2hlY2sgc29tZSBvZiB0aGUgaXRlbXMgaWRlbnRpZmllZCBhYm92ZSB0byBzZWUg
aWYgeW91IGNhbiB3b3JrIG91dCB0aGUgY2F1c2Ugb2YgeW91ciBidWcuDQoNCllvdXJzLA0KDQpC
aWxsDQoNCltGWUkgSSBkbyBpZ25vcmUgcGVyc29uYWwgYXBwZWFscyBmb3IgaGVscCBhdCBteSBA
YXBhY2hlLm9yZzxodHRwOi8vYXBhY2hlLm9yZz4gYWNjb3VudCwga2luZGx5IHJlcXVlc3Rpbmcg
dGhhdCB0aGUgdXNlciByZXN0YXRlIHRoZWlyIHF1ZXN0aW9uIHB1YmxpY2x5IG9uIHRoZSB1c2Vy
c0Agb3IgZGV2QCBsaXN0IGFzIGFwcHJvcHJpYXRlLiBUaGlzIGxldHMgbWUgYW5zd2VyIHRoZSBz
YW1lIHF1ZXN0aW9uIGZvciBtYW55IGVuZCB1c2VycyB3aG8gZ29vZ2xlIGZvciByZWxldmFudCBr
ZXl3b3JkcyBvZiB0aGUgcXVlc3Rpb24gb3IgYW5zd2VyLiAgRm9yIHByaXZhdGUgaW5xdWlyaWVz
IGFib3V0IGh0dHBkIG1vZHVsZSBhdXRob3JpbmcgdW5kZXIgeW91ciBzdXBwb3J0IGVuZ2FnZW1l
bnQsIHBsZWFzZSBjb250aW51ZSB0byB1c2Ugd3Jvd2VAcGl2b3RhbC5pbzxtYWlsdG86d3Jvd2VA
cGl2b3RhbC5pbz4sIGJ1dCBJJ20gY2VydGFpbmx5IGhhcHB5IHRvIHB1YmxpY2x5IGFuc3dlciBx
dWVzdGlvbnMgaWYgeW91IGxpa2UgLSB0aGlzIGJlY29tZXMgaW50ZXJlc3Rpbmcgd2hlbiB0aGVy
ZSBpcyBhIHByb2JhYmxlIGRlc2lnbiBkZWZlY3QgZm9yIHRoZSBlbnRpcmUgZGV2QCB0ZWFtIHRv
IGNvbnNpZGVyLl0NCg0KDQoNCk9uIFRodSwgT2N0IDI5LCAyMDE1IGF0IDI6MzIgUE0sIFBBTiwg
SklOIDxKaW4uUGFuQGZtci5jb208bWFpbHRvOkppbi5QYW5AZm1yLmNvbT4+IHdyb3RlOg0KSGkg
QmlsbCwNCg0KVGhpcyBpcyBKaW4gZnJvbSBGaWRlbGl0eSwgbmV3IEhhbXBzaGlyZSBjYW1wdXMu
IFZlcnkgc29ycnkgYWJvdXQgdGhlIGRvdWJsZSBlbWFpbHMsIEkgd2FudGVkIHRvIG1ha2Ugc3Vy
ZSB0aGlzIGVtYWlsIGNhbiBnZXQgdG8geW91IGZyb20gYWxsIGFuZ2xlcy4gV2XigJlkIGdyZWF0
bHkgYXBwcmVjaWF0ZSBhbnkgY29tbWVudHMgb24gdGhpcyBwcm9ibGVtIHdlIGFyZSBwZXJwbGV4
ZWQgd2l0aC4NCg0KVGhlIGlzc3VlIGlzIHJlZ2FyZGluZyB0aGUgQXBhY2hlIDxEaXJlY3Rvcnk+
IG1lcmdpbmcuIFdlIHdhbnQgdG8gY29uc3RydWN0IGEgYnJlYWRjcnVtYiB0cmFpbCBmcm9tIG11
bHRpcGxlIDxEaXJlY3Rvcnk+IGNvbnRleHRzIGZvciBlYWNoIHJlcXVlc3QgYXMgYmVsb3cuIFdl
IHRyaWVkIHRvIHVzZSB0aGUgZGlyZWN0b3J5IG1lcmdlIGZ1bmN0aW9uIHRvIGNvbmNhdGVuYXRl
IGRpZmZlcmVudCBjb250ZXh0IGFzIHRoZSBtZXJnZSBmdW5jdGlvbiBpcyBpbnZva2VkIGJ5IEFw
YWNoZSBhcyBpdCB3YWxrcyB0byBldmVyeSA8RGlyZWN0b3J5PiBibG9jay4gV2Ugb2JzZXJ2ZWQg
dGhhdCBBcGFjaGUgZG9lcyBub3QgcHJvdmlkZSB0aGUgQkFTRSBhbmQgTkVXIHBvaW50ZXIgY29u
dGVudCB0byB0aGUgbWVyZ2UgaG9vayBmb3IgPERpcmVjdG9yeT4sIHNvIHRoYXQgYXQgdGhlIGVu
ZCBvZiB0aGUgbGFzdCA8RGlyZWN0b3J5PiBibG9jaywgd2UgYXJlIHVuYWJsZSB0byBnZXQgYSBj
b21iaW5lZCDigJwvOi9mb286L2Zvby9iYXLigJ0gdHJhaWwgcmVzdWx0LiBIb3dldmVyLCB0aGUg
c2FtZSBtZXJnZSBob29rIGRvZXMgZ2V0IHRoZSBCQVNFIGFuZCBORVcgcG9pbnRlciBjb250ZW50
IGZvciA8TG9jYXRpb24+IGJsb2NrcywgZm9yIHdoaWNoIHdlIGRvIHNlZSB0aGUgZGVzaXJlZCBj
b21iaW5hdGlvbiB0cmFpbCBhZnRlciBhbGwgPExvY2F0aW9uPiBibG9ja3MuDQoNClF1ZXN0aW9u
IGlzLCBpcyB0aGVyZSBhbnkgd2F5IHRvIG1lcmdlIHRoZSBkaWZmZXJlbnQgPERpcmVjdG9yeT4g
Y29udGV4dCB0b2dldGhlcj8NCg0KQ29uZmlnOg0KICAgICAgICAgICAgICAgIDxEaXJlY3Rvcnkg
L2Zvbz4NCiAgICAgICAgICAgICAgICAgICAgSGVhZGVyIG1lcmdlIHNvbWVIZWFkZXIgIi9mb28i
IDwtLSBtb2RfaGVhZGVycyBzZWVtcyB0byBzdWZmZXIgdGhlIHNhbWUsIG5vIEJBU0Ugb3IgTkVX
IHRvIG1lcmdlIHdpdGgNCiAgICAgICAgICAgICAgICAgICAgZGlyQ29uZmlnIC9mb28NCiAgICAg
ICAgICAgICAgICA8L0RpcmVjdG9yeT4NCg0KICAgICAgICAgICAgICAgIDxEaXJlY3RvcnkgLz4N
CiAgICAgICAgICAgICAgICAgICAgSGVhZGVyIG1lcmdlIHNvbWVIZWFkZXIgIi8iDQogICAgICAg
ICAgICAgICAgICAgIGRpckNvbmZpZyAvDQogICAgICAgICAgICAgICAgPC9EaXJlY3Rvcnk+DQoN
CiAgICAgICAgICAgICAgICA8RGlyZWN0b3J5IC9mb28vYmFyPg0KICAgICAgICAgICAgICAgICAg
ICBIZWFkZXIgbWVyZ2Ugc29tZUhlYWRlciAiL2Zvby9iYXIiDQogICAgICAgICAgICAgICAgICAg
IGRpckNvbmZpZyAvZm9vL2Jhcg0KICAgICAgICAgICAgICAgIDwvRGlyZWN0b3J5Pg0KDQpTb21l
IGNvZGUgc25pcHBldCB0byBleHBsYWluIHdoYXQgd2XigJlyZSBkb2luZ+KApg0KDQogICAgICAg
ICAgICAgICAgQVBfREVDTEFSRV9NT0RVTEUoZGlyY29uZmlnKSA9DQogICAgICAgICAgICAgICAg
ew0KICAgICAgICAgICAgICAgICAgICBTVEFOREFSRDIwX01PRFVMRV9TVFVGRiwNCiAgICAgICAg
ICAgICAgICAgICAgY3JlYXRlX2RpciwNCiAgICAgICAgICAgICAgICAgICAgbWVyZ2VfZGlyLA0K
ICAgICAgICAgICAgICAgICAgICBOVUxMLA0KICAgICAgICAgICAgICAgICAgICBOVUxMLA0KICAg
ICAgICAgICAgICAgICAgICBjbWRzLA0KICAgICAgICAgICAgICAgICAgICByZWdpc3Rlcl9ob29r
cw0KICAgICAgICAgICAgICAgIH07DQoNCiAgICAgICAgICAgICAgICB0eXBlZGVmIHN0cnVjdA0K
ICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgICAgY2hhciogY3h0Ow0KICAgICAg
ICAgICAgICAgIH0gc2NmZzsNCg0KICAgICAgICAgICAgICAgIHN0YXRpYyB2b2lkICptZXJnZV9k
aXIoYXByX3Bvb2xfdCAqcG9vbCwgdm9pZCAqQkFTRSwgdm9pZCAqTkVXKQ0KICAgICAgICAgICAg
ICAgIHsNCiAgICAgICAgICAgICAgICAgICAgc2NmZyAqbSA9IGFwcl9wY2FsbG9jKHBvb2wsIHNp
emVvZigqbSkpOw0KICAgICAgICAgICAgICAgICAgICBzY2ZnICpwID0gQkFTRTsgPC0tcG9pbnRz
IHRvIHRoZSBwcm9wZXIg4oCcL2Zvby9iYXLigJ0gY29udGVudCBpZiBpbiA8TG9jYXRpb24+IGJ1
dCBlbXB0eSBpZiBpbiA8RGlyZWN0b3J5PiBXaHk/DQogICAgICAgICAgICAgICAgICAgIHNjZmcg
KmMgPSBORVc7DQoNCiAgICAgICAgICAgICAgICAgICAgbS0+Y3h0ID0gYXByX3BzdHJjYXQocG9v
bCwgcC0+Y3h0LCAiOiIsIGMtPmN4dCwgTlVMTCk7DQoNCiAgICAgICAgICAgICAgICAgICAgcmV0
dXJuIG07DQogICAgICAgICAgICAgICAgfQ0KDQpUaGFuayB5b3UhDQpKaW4NCg0K

--_000_adfc9e96fd3d41d88ff3059182439031MSGRTP1DAG01ADMN1FMRcom_
Content-Type: text/html; charset="utf-8"
Content-Transfer-Encoding: base64

PGh0bWwgeG1sbnM6dj0idXJuOnNjaGVtYXMtbWljcm9zb2Z0LWNvbTp2bWwiIHhtbG5zOm89InVy
bjpzY2hlbWFzLW1pY3Jvc29mdC1jb206b2ZmaWNlOm9mZmljZSIgeG1sbnM6dz0idXJuOnNjaGVt
YXMtbWljcm9zb2Z0LWNvbTpvZmZpY2U6d29yZCIgeG1sbnM6bT0iaHR0cDovL3NjaGVtYXMubWlj
cm9zb2Z0LmNvbS9vZmZpY2UvMjAwNC8xMi9vbW1sIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcv
VFIvUkVDLWh0bWw0MCI+DQo8aGVhZD4NCjxtZXRhIGh0dHAtZXF1aXY9IkNvbnRlbnQtVHlwZSIg
Y29udGVudD0idGV4dC9odG1sOyBjaGFyc2V0PXV0Zi04Ij4NCjxtZXRhIG5hbWU9IkdlbmVyYXRv
ciIgY29udGVudD0iTWljcm9zb2Z0IFdvcmQgMTQgKGZpbHRlcmVkIG1lZGl1bSkiPg0KPHN0eWxl
PjwhLS0NCi8qIEZvbnQgRGVmaW5pdGlvbnMgKi8NCkBmb250LWZhY2UNCgl7Zm9udC1mYW1pbHk6
V2luZ2RpbmdzOw0KCXBhbm9zZS0xOjUgMCAwIDAgMCAwIDAgMCAwIDA7fQ0KQGZvbnQtZmFjZQ0K
CXtmb250LWZhbWlseTpXaW5nZGluZ3M7DQoJcGFub3NlLTE6NSAwIDAgMCAwIDAgMCAwIDAgMDt9
DQpAZm9udC1mYWNlDQoJe2ZvbnQtZmFtaWx5OkNhbGlicmk7DQoJcGFub3NlLTE6MiAxNSA1IDIg
MiAyIDQgMyAyIDQ7fQ0KQGZvbnQtZmFjZQ0KCXtmb250LWZhbWlseTpUYWhvbWE7DQoJcGFub3Nl
LTE6MiAxMSA2IDQgMyA1IDQgNCAyIDQ7fQ0KQGZvbnQtZmFjZQ0KCXtmb250LWZhbWlseTpDb25z
b2xhczsNCglwYW5vc2UtMToyIDExIDYgOSAyIDIgNCAzIDIgNDt9DQovKiBTdHlsZSBEZWZpbml0
aW9ucyAqLw0KcC5Nc29Ob3JtYWwsIGxpLk1zb05vcm1hbCwgZGl2Lk1zb05vcm1hbA0KCXttYXJn
aW46MGluOw0KCW1hcmdpbi1ib3R0b206LjAwMDFwdDsNCglmb250LXNpemU6MTIuMHB0Ow0KCWZv
bnQtZmFtaWx5OiJUaW1lcyBOZXcgUm9tYW4iLCJzZXJpZiI7fQ0KYTpsaW5rLCBzcGFuLk1zb0h5
cGVybGluaw0KCXttc28tc3R5bGUtcHJpb3JpdHk6OTk7DQoJY29sb3I6Ymx1ZTsNCgl0ZXh0LWRl
Y29yYXRpb246dW5kZXJsaW5lO30NCmE6dmlzaXRlZCwgc3Bhbi5Nc29IeXBlcmxpbmtGb2xsb3dl
ZA0KCXttc28tc3R5bGUtcHJpb3JpdHk6OTk7DQoJY29sb3I6cHVycGxlOw0KCXRleHQtZGVjb3Jh
dGlvbjp1bmRlcmxpbmU7fQ0KcHJlDQoJe21zby1zdHlsZS1wcmlvcml0eTo5OTsNCgltc28tc3R5
bGUtbGluazoiSFRNTCBQcmVmb3JtYXR0ZWQgQ2hhciI7DQoJbWFyZ2luOjBpbjsNCgltYXJnaW4t
Ym90dG9tOi4wMDAxcHQ7DQoJZm9udC1zaXplOjEwLjBwdDsNCglmb250LWZhbWlseToiQ291cmll
ciBOZXciO30NCnNwYW4uSFRNTFByZWZvcm1hdHRlZENoYXINCgl7bXNvLXN0eWxlLW5hbWU6IkhU
TUwgUHJlZm9ybWF0dGVkIENoYXIiOw0KCW1zby1zdHlsZS1wcmlvcml0eTo5OTsNCgltc28tc3R5
bGUtbGluazoiSFRNTCBQcmVmb3JtYXR0ZWQiOw0KCWZvbnQtZmFtaWx5OkNvbnNvbGFzO30NCnNw
YW4uaG9lbnpiDQoJe21zby1zdHlsZS1uYW1lOmhvZW56Yjt9DQpzcGFuLkVtYWlsU3R5bGUyMA0K
CXttc28tc3R5bGUtdHlwZTpwZXJzb25hbC1yZXBseTsNCglmb250LWZhbWlseToiQ2FsaWJyaSIs
InNhbnMtc2VyaWYiOw0KCWNvbG9yOiMxRjQ5N0Q7fQ0KLk1zb0NocERlZmF1bHQNCgl7bXNvLXN0
eWxlLXR5cGU6ZXhwb3J0LW9ubHk7DQoJZm9udC1zaXplOjEwLjBwdDt9DQpAcGFnZSBXb3JkU2Vj
dGlvbjENCgl7c2l6ZTo4LjVpbiAxMS4waW47DQoJbWFyZ2luOjEuMGluIDEuMGluIDEuMGluIDEu
MGluO30NCmRpdi5Xb3JkU2VjdGlvbjENCgl7cGFnZTpXb3JkU2VjdGlvbjE7fQ0KLS0+PC9zdHls
ZT48IS0tW2lmIGd0ZSBtc28gOV0+PHhtbD4NCjxvOnNoYXBlZGVmYXVsdHMgdjpleHQ9ImVkaXQi
IHNwaWRtYXg9IjEwMjYiIC8+DQo8L3htbD48IVtlbmRpZl0tLT48IS0tW2lmIGd0ZSBtc28gOV0+
PHhtbD4NCjxvOnNoYXBlbGF5b3V0IHY6ZXh0PSJlZGl0Ij4NCjxvOmlkbWFwIHY6ZXh0PSJlZGl0
IiBkYXRhPSIxIiAvPg0KPC9vOnNoYXBlbGF5b3V0PjwveG1sPjwhW2VuZGlmXS0tPg0KPC9oZWFk
Pg0KPGJvZHkgbGFuZz0iRU4tVVMiIGxpbms9ImJsdWUiIHZsaW5rPSJwdXJwbGUiPg0KPGRpdiBj
bGFzcz0iV29yZFNlY3Rpb24xIj4NCjxwIGNsYXNzPSJNc29Ob3JtYWwiPjxzcGFuIHN0eWxlPSJm
b250LXNpemU6MTEuMHB0O2ZvbnQtZmFtaWx5OiZxdW90O0NhbGlicmkmcXVvdDssJnF1b3Q7c2Fu
cy1zZXJpZiZxdW90Oztjb2xvcjojMUY0OTdEIj5IaSBCaWxsICh0aGlzIGlzIGEgcmVzZW5kIHRv
IGluY2x1ZGUgdGhlIGRldiBhbmQgdXNlciBjb21tdW5pdGllcywgcGVyIHlvdXIgaW5zdHJ1Y3Rp
b25zKTo8bzpwPjwvbzpwPjwvc3Bhbj48L3A+DQo8cCBjbGFzcz0iTXNvTm9ybWFsIj48c3BhbiBz
dHlsZT0iZm9udC1zaXplOjExLjBwdDtmb250LWZhbWlseTomcXVvdDtDYWxpYnJpJnF1b3Q7LCZx
dW90O3NhbnMtc2VyaWYmcXVvdDs7Y29sb3I6IzFGNDk3RCI+PG86cD4mbmJzcDs8L286cD48L3Nw
YW4+PC9wPg0KPHAgY2xhc3M9Ik1zb05vcm1hbCI+PHNwYW4gc3R5bGU9ImZvbnQtc2l6ZToxMS4w
cHQ7Zm9udC1mYW1pbHk6JnF1b3Q7Q2FsaWJyaSZxdW90OywmcXVvdDtzYW5zLXNlcmlmJnF1b3Q7
O2NvbG9yOiMxRjQ5N0QiPlRoYW5rcyB2ZXJ5IG11Y2ggZm9yIHRoZSBwcm9tcHQgcmVzcG9uc2Uu
IEkgYmVsaWV2ZSB3ZSBoYXZlIGNvdmVyZWQgYWxsIG9mIHRoZSBzdGVwcyB5b3UgaW5kaWNhdGUg
YmVsb3cuIEF0dGFjaGVkIHBsZWFzZSBmaW5kIGEgdGFyIGZpbGUgdGhhdCBjb250YWlucyBhIHNp
bXBsZQ0KIEMmIzQzOyYjNDM7IG1vZHVsZSBhbmQgYSBtYWtlZmlsZSB0byBidWlsZCBpdC48bzpw
PjwvbzpwPjwvc3Bhbj48L3A+DQo8cCBjbGFzcz0iTXNvTm9ybWFsIj48c3BhbiBzdHlsZT0iZm9u
dC1zaXplOjExLjBwdDtmb250LWZhbWlseTomcXVvdDtDYWxpYnJpJnF1b3Q7LCZxdW90O3NhbnMt
c2VyaWYmcXVvdDs7Y29sb3I6IzFGNDk3RCI+PG86cD4mbmJzcDs8L286cD48L3NwYW4+PC9wPg0K
PHAgY2xhc3M9Ik1zb05vcm1hbCI+PHNwYW4gc3R5bGU9ImZvbnQtc2l6ZToxMS4wcHQ7Zm9udC1m
YW1pbHk6JnF1b3Q7Q2FsaWJyaSZxdW90OywmcXVvdDtzYW5zLXNlcmlmJnF1b3Q7O2NvbG9yOiMx
RjQ5N0QiPk91ciB0ZXN0IHNlcnZlciBodHRwLmNvbmYgaGFzIGEgTG9hZE1vZHVsZSBsaW5lIGZv
ciB0aGUgbW9kdWxlIGFuZCB0aGVuIHRoZSBmb2xsb3dpbmcgc2V0IG9mIGRpcmVjdG9yeSBzZWN0
aW9uczo8bzpwPjwvbzpwPjwvc3Bhbj48L3A+DQo8cCBjbGFzcz0iTXNvTm9ybWFsIj48c3BhbiBz
dHlsZT0iZm9udC1zaXplOjExLjBwdDtmb250LWZhbWlseTomcXVvdDtDYWxpYnJpJnF1b3Q7LCZx
dW90O3NhbnMtc2VyaWYmcXVvdDs7Y29sb3I6IzFGNDk3RCI+PG86cD4mbmJzcDs8L286cD48L3Nw
YW4+PC9wPg0KPHAgY2xhc3M9Ik1zb05vcm1hbCI+PHNwYW4gc3R5bGU9ImZvbnQtc2l6ZToxMS4w
cHQ7Zm9udC1mYW1pbHk6JnF1b3Q7Q2FsaWJyaSZxdW90OywmcXVvdDtzYW5zLXNlcmlmJnF1b3Q7
O2NvbG9yOiMxRjQ5N0QiPiZsdDtEaXJlY3RvcnkgL2ZvbyZndDs8bzpwPjwvbzpwPjwvc3Bhbj48
L3A+DQo8cCBjbGFzcz0iTXNvTm9ybWFsIj48c3BhbiBzdHlsZT0iZm9udC1zaXplOjExLjBwdDtm
b250LWZhbWlseTomcXVvdDtDYWxpYnJpJnF1b3Q7LCZxdW90O3NhbnMtc2VyaWYmcXVvdDs7Y29s
b3I6IzFGNDk3RCI+Jm5ic3A7IGRpckNvbmZpZyAvZm9vPG86cD48L286cD48L3NwYW4+PC9wPg0K
PHAgY2xhc3M9Ik1zb05vcm1hbCI+PHNwYW4gc3R5bGU9ImZvbnQtc2l6ZToxMS4wcHQ7Zm9udC1m
YW1pbHk6JnF1b3Q7Q2FsaWJyaSZxdW90OywmcXVvdDtzYW5zLXNlcmlmJnF1b3Q7O2NvbG9yOiMx
RjQ5N0QiPiZsdDsvRGlyZWN0b3J5Jmd0OzxvOnA+PC9vOnA+PC9zcGFuPjwvcD4NCjxwIGNsYXNz
PSJNc29Ob3JtYWwiPjxzcGFuIHN0eWxlPSJmb250LXNpemU6MTEuMHB0O2ZvbnQtZmFtaWx5OiZx
dW90O0NhbGlicmkmcXVvdDssJnF1b3Q7c2Fucy1zZXJpZiZxdW90Oztjb2xvcjojMUY0OTdEIj48
bzpwPiZuYnNwOzwvbzpwPjwvc3Bhbj48L3A+DQo8cCBjbGFzcz0iTXNvTm9ybWFsIj48c3BhbiBz
dHlsZT0iZm9udC1zaXplOjExLjBwdDtmb250LWZhbWlseTomcXVvdDtDYWxpYnJpJnF1b3Q7LCZx
dW90O3NhbnMtc2VyaWYmcXVvdDs7Y29sb3I6IzFGNDk3RCI+Jmx0O0RpcmVjdG9yeSAvJmd0Ozxv
OnA+PC9vOnA+PC9zcGFuPjwvcD4NCjxwIGNsYXNzPSJNc29Ob3JtYWwiPjxzcGFuIHN0eWxlPSJm
b250LXNpemU6MTEuMHB0O2ZvbnQtZmFtaWx5OiZxdW90O0NhbGlicmkmcXVvdDssJnF1b3Q7c2Fu
cy1zZXJpZiZxdW90Oztjb2xvcjojMUY0OTdEIj4mbmJzcDsgZGlyQ29uZmlnIC88bzpwPjwvbzpw
Pjwvc3Bhbj48L3A+DQo8cCBjbGFzcz0iTXNvTm9ybWFsIj48c3BhbiBzdHlsZT0iZm9udC1zaXpl
OjExLjBwdDtmb250LWZhbWlseTomcXVvdDtDYWxpYnJpJnF1b3Q7LCZxdW90O3NhbnMtc2VyaWYm
cXVvdDs7Y29sb3I6IzFGNDk3RCI+Jmx0Oy9EaXJlY3RvcnkmZ3Q7PG86cD48L286cD48L3NwYW4+
PC9wPg0KPHAgY2xhc3M9Ik1zb05vcm1hbCI+PHNwYW4gc3R5bGU9ImZvbnQtc2l6ZToxMS4wcHQ7
Zm9udC1mYW1pbHk6JnF1b3Q7Q2FsaWJyaSZxdW90OywmcXVvdDtzYW5zLXNlcmlmJnF1b3Q7O2Nv
bG9yOiMxRjQ5N0QiPjxvOnA+Jm5ic3A7PC9vOnA+PC9zcGFuPjwvcD4NCjxwIGNsYXNzPSJNc29O
b3JtYWwiPjxzcGFuIHN0eWxlPSJmb250LXNpemU6MTEuMHB0O2ZvbnQtZmFtaWx5OiZxdW90O0Nh
bGlicmkmcXVvdDssJnF1b3Q7c2Fucy1zZXJpZiZxdW90Oztjb2xvcjojMUY0OTdEIj4mbHQ7RGly
ZWN0b3J5IC9mb28vYmFyJmd0OzxvOnA+PC9vOnA+PC9zcGFuPjwvcD4NCjxwIGNsYXNzPSJNc29O
b3JtYWwiPjxzcGFuIHN0eWxlPSJmb250LXNpemU6MTEuMHB0O2ZvbnQtZmFtaWx5OiZxdW90O0Nh
bGlicmkmcXVvdDssJnF1b3Q7c2Fucy1zZXJpZiZxdW90Oztjb2xvcjojMUY0OTdEIj4mbmJzcDsg
ZGlyQ29uZmlnIC9mb28vYmFyPG86cD48L286cD48L3NwYW4+PC9wPg0KPHAgY2xhc3M9Ik1zb05v
cm1hbCI+PHNwYW4gc3R5bGU9ImZvbnQtc2l6ZToxMS4wcHQ7Zm9udC1mYW1pbHk6JnF1b3Q7Q2Fs
aWJyaSZxdW90OywmcXVvdDtzYW5zLXNlcmlmJnF1b3Q7O2NvbG9yOiMxRjQ5N0QiPiZsdDsvRGly
ZWN0b3J5Jmd0OzxvOnA+PC9vOnA+PC9zcGFuPjwvcD4NCjxwIGNsYXNzPSJNc29Ob3JtYWwiPjxz
cGFuIHN0eWxlPSJmb250LXNpemU6MTEuMHB0O2ZvbnQtZmFtaWx5OiZxdW90O0NhbGlicmkmcXVv
dDssJnF1b3Q7c2Fucy1zZXJpZiZxdW90Oztjb2xvcjojMUY0OTdEIj48bzpwPiZuYnNwOzwvbzpw
Pjwvc3Bhbj48L3A+DQo8cCBjbGFzcz0iTXNvTm9ybWFsIj48c3BhbiBzdHlsZT0iZm9udC1zaXpl
OjExLjBwdDtmb250LWZhbWlseTomcXVvdDtDYWxpYnJpJnF1b3Q7LCZxdW90O3NhbnMtc2VyaWYm
cXVvdDs7Y29sb3I6IzFGNDk3RCI+V2hlbiB3ZSBleGVjdXRlIHRoZSBzZXJ2ZXIsIHdlIHNlZSB0
aGlzIG9uIHRoZSBjb25zb2xlOjxvOnA+PC9vOnA+PC9zcGFuPjwvcD4NCjxwIGNsYXNzPSJNc29O
b3JtYWwiPjxzcGFuIHN0eWxlPSJmb250LXNpemU6MTEuMHB0O2ZvbnQtZmFtaWx5OiZxdW90O0Nh
bGlicmkmcXVvdDssJnF1b3Q7c2Fucy1zZXJpZiZxdW90Oztjb2xvcjojMUY0OTdEIj48bzpwPiZu
YnNwOzwvbzpwPjwvc3Bhbj48L3A+DQo8cCBjbGFzcz0iTXNvTm9ybWFsIj48c3BhbiBzdHlsZT0i
Zm9udC1zaXplOjExLjBwdDtmb250LWZhbWlseTomcXVvdDtDYWxpYnJpJnF1b3Q7LCZxdW90O3Nh
bnMtc2VyaWYmcXVvdDs7Y29sb3I6IzFGNDk3RCI+IyBiaW4vYXBhY2hlY3RsIHN0YXJ0PG86cD48
L286cD48L3NwYW4+PC9wPg0KPHAgY2xhc3M9Ik1zb05vcm1hbCI+PHNwYW4gc3R5bGU9ImZvbnQt
c2l6ZToxMS4wcHQ7Zm9udC1mYW1pbHk6JnF1b3Q7Q2FsaWJyaSZxdW90OywmcXVvdDtzYW5zLXNl
cmlmJnF1b3Q7O2NvbG9yOiMxRjQ5N0QiPkNyZWF0ZWQgZGlyQ29uZmlnIGZvciBjb250ZXh0OiB1
bnNldDxvOnA+PC9vOnA+PC9zcGFuPjwvcD4NCjxwIGNsYXNzPSJNc29Ob3JtYWwiPjxzcGFuIHN0
eWxlPSJmb250LXNpemU6MTEuMHB0O2ZvbnQtZmFtaWx5OiZxdW90O0NhbGlicmkmcXVvdDssJnF1
b3Q7c2Fucy1zZXJpZiZxdW90Oztjb2xvcjojMUY0OTdEIj5DcmVhdGVkIGRpckNvbmZpZyBmb3Ig
Y29udGV4dDogL2Zvby88bzpwPjwvbzpwPjwvc3Bhbj48L3A+DQo8cCBjbGFzcz0iTXNvTm9ybWFs
Ij48c3BhbiBzdHlsZT0iZm9udC1zaXplOjExLjBwdDtmb250LWZhbWlseTomcXVvdDtDYWxpYnJp
JnF1b3Q7LCZxdW90O3NhbnMtc2VyaWYmcXVvdDs7Y29sb3I6IzFGNDk3RCI+SW5zZXJ0ZWQgZGly
Q29uZmlnIHdpdGggbWVzc2FnZTogL2ZvbzxvOnA+PC9vOnA+PC9zcGFuPjwvcD4NCjxwIGNsYXNz
PSJNc29Ob3JtYWwiPjxzcGFuIHN0eWxlPSJmb250LXNpemU6MTEuMHB0O2ZvbnQtZmFtaWx5OiZx
dW90O0NhbGlicmkmcXVvdDssJnF1b3Q7c2Fucy1zZXJpZiZxdW90Oztjb2xvcjojMUY0OTdEIj5D
cmVhdGVkIGRpckNvbmZpZyBmb3IgY29udGV4dDogLzxvOnA+PC9vOnA+PC9zcGFuPjwvcD4NCjxw
IGNsYXNzPSJNc29Ob3JtYWwiPjxzcGFuIHN0eWxlPSJmb250LXNpemU6MTEuMHB0O2ZvbnQtZmFt
aWx5OiZxdW90O0NhbGlicmkmcXVvdDssJnF1b3Q7c2Fucy1zZXJpZiZxdW90Oztjb2xvcjojMUY0
OTdEIj5JbnNlcnRlZCBkaXJDb25maWcgd2l0aCBtZXNzYWdlOiAvPG86cD48L286cD48L3NwYW4+
PC9wPg0KPHAgY2xhc3M9Ik1zb05vcm1hbCI+PHNwYW4gc3R5bGU9ImZvbnQtc2l6ZToxMS4wcHQ7
Zm9udC1mYW1pbHk6JnF1b3Q7Q2FsaWJyaSZxdW90OywmcXVvdDtzYW5zLXNlcmlmJnF1b3Q7O2Nv
bG9yOiMxRjQ5N0QiPkNyZWF0ZWQgZGlyQ29uZmlnIGZvciBjb250ZXh0OiAvZm9vL2Jhci88bzpw
PjwvbzpwPjwvc3Bhbj48L3A+DQo8cCBjbGFzcz0iTXNvTm9ybWFsIj48c3BhbiBzdHlsZT0iZm9u
dC1zaXplOjExLjBwdDtmb250LWZhbWlseTomcXVvdDtDYWxpYnJpJnF1b3Q7LCZxdW90O3NhbnMt
c2VyaWYmcXVvdDs7Y29sb3I6IzFGNDk3RCI+SW5zZXJ0ZWQgZGlyQ29uZmlnIHdpdGggbWVzc2Fn
ZTogL2Zvby9iYXI8bzpwPjwvbzpwPjwvc3Bhbj48L3A+DQo8cCBjbGFzcz0iTXNvTm9ybWFsIj48
c3BhbiBzdHlsZT0iZm9udC1zaXplOjExLjBwdDtmb250LWZhbWlseTomcXVvdDtDYWxpYnJpJnF1
b3Q7LCZxdW90O3NhbnMtc2VyaWYmcXVvdDs7Y29sb3I6IzFGNDk3RCI+Q3JlYXRlZCBkaXJDb25m
aWcgZm9yIGNvbnRleHQ6IHVuc2V0PG86cD48L286cD48L3NwYW4+PC9wPg0KPHAgY2xhc3M9Ik1z
b05vcm1hbCI+PHNwYW4gc3R5bGU9ImZvbnQtc2l6ZToxMS4wcHQ7Zm9udC1mYW1pbHk6JnF1b3Q7
Q2FsaWJyaSZxdW90OywmcXVvdDtzYW5zLXNlcmlmJnF1b3Q7O2NvbG9yOiMxRjQ5N0QiPjxvOnA+
Jm5ic3A7PC9vOnA+PC9zcGFuPjwvcD4NCjxwIGNsYXNzPSJNc29Ob3JtYWwiPjxzcGFuIHN0eWxl
PSJmb250LXNpemU6MTEuMHB0O2ZvbnQtZmFtaWx5OiZxdW90O0NhbGlicmkmcXVvdDssJnF1b3Q7
c2Fucy1zZXJpZiZxdW90Oztjb2xvcjojMUY0OTdEIj5BbmQgdGhpcyBpbiB0aGUgbG9nOjxvOnA+
PC9vOnA+PC9zcGFuPjwvcD4NCjxwIGNsYXNzPSJNc29Ob3JtYWwiPjxzcGFuIHN0eWxlPSJmb250
LXNpemU6MTEuMHB0O2ZvbnQtZmFtaWx5OiZxdW90O0NhbGlicmkmcXVvdDssJnF1b3Q7c2Fucy1z
ZXJpZiZxdW90Oztjb2xvcjojMUY0OTdEIj48bzpwPiZuYnNwOzwvbzpwPjwvc3Bhbj48L3A+DQo8
cCBjbGFzcz0iTXNvTm9ybWFsIj48c3BhbiBzdHlsZT0iZm9udC1zaXplOjExLjBwdDtmb250LWZh
bWlseTomcXVvdDtDYWxpYnJpJnF1b3Q7LCZxdW90O3NhbnMtc2VyaWYmcXVvdDs7Y29sb3I6IzFG
NDk3RCI+TWVyZ2VkIGNvbmZpZzogdW5zZXQ6LzxvOnA+PC9vOnA+PC9zcGFuPjwvcD4NCjxwIGNs
YXNzPSJNc29Ob3JtYWwiPjxzcGFuIHN0eWxlPSJmb250LXNpemU6MTEuMHB0O2ZvbnQtZmFtaWx5
OiZxdW90O0NhbGlicmkmcXVvdDssJnF1b3Q7c2Fucy1zZXJpZiZxdW90Oztjb2xvcjojMUY0OTdE
Ij7igKY8bzpwPjwvbzpwPjwvc3Bhbj48L3A+DQo8cCBjbGFzcz0iTXNvTm9ybWFsIj48c3BhbiBz
dHlsZT0iZm9udC1zaXplOjExLjBwdDtmb250LWZhbWlseTomcXVvdDtDYWxpYnJpJnF1b3Q7LCZx
dW90O3NhbnMtc2VyaWYmcXVvdDs7Y29sb3I6IzFGNDk3RCI+aG9va0Z1bmM6IGZvciByZXF1ZXN0
IC9mb28vYmFyL2Zvby5odG1sIHRoZSBjb250ZXh0IGlzOiB1bnNldDovPG86cD48L286cD48L3Nw
YW4+PC9wPg0KPHAgY2xhc3M9Ik1zb05vcm1hbCI+PHNwYW4gc3R5bGU9ImZvbnQtc2l6ZToxMS4w
cHQ7Zm9udC1mYW1pbHk6JnF1b3Q7Q2FsaWJyaSZxdW90OywmcXVvdDtzYW5zLXNlcmlmJnF1b3Q7
O2NvbG9yOiMxRjQ5N0QiPjxvOnA+Jm5ic3A7PC9vOnA+PC9zcGFuPjwvcD4NCjxwIGNsYXNzPSJN
c29Ob3JtYWwiPjxzcGFuIHN0eWxlPSJmb250LXNpemU6MTEuMHB0O2ZvbnQtZmFtaWx5OiZxdW90
O0NhbGlicmkmcXVvdDssJnF1b3Q7c2Fucy1zZXJpZiZxdW90Oztjb2xvcjojMUY0OTdEIj5XZSBk
byBub3Qgc2VlIGFueSBvdGhlciBtZXNzYWdlcy4gVGhlIGZpbGUgL2Zvby9iYXIvZm9vLmh0bWwg
ZXhpc3RzIGFuZCB0aGUgYnJvd3NlciBkaXNwbGF5cyBpdC4gVGhpcyBzdWdnZXN0cyB0aGF0IHRo
ZSBtZXJnZSBzZXF1ZW5jZSBmb3IgdGhlIGxhc3QgZGlyZWN0b3J5DQogc2VjdGlvbiBzdG9wcGVk
IHdpdGggdGhlIGNvbmZpZ3VyYXRpb24gZm9yIHRoZSDigJwv4oCdIHNlY3Rpb24uJm5ic3A7IFBl
cmhhcHMgeW91IGNvdWxkIHBvaW50IG91dCB3aGF0IHdvdWxkIGNhdXNlIHRoaXMgYmVoYXZpb3I/
PG86cD48L286cD48L3NwYW4+PC9wPg0KPHAgY2xhc3M9Ik1zb05vcm1hbCI+PHNwYW4gc3R5bGU9
ImZvbnQtc2l6ZToxMS4wcHQ7Zm9udC1mYW1pbHk6JnF1b3Q7Q2FsaWJyaSZxdW90OywmcXVvdDtz
YW5zLXNlcmlmJnF1b3Q7O2NvbG9yOiMxRjQ5N0QiPjxvOnA+Jm5ic3A7PC9vOnA+PC9zcGFuPjwv
cD4NCjxwIGNsYXNzPSJNc29Ob3JtYWwiPjxzcGFuIHN0eWxlPSJmb250LXNpemU6MTEuMHB0O2Zv
bnQtZmFtaWx5OiZxdW90O0NhbGlicmkmcXVvdDssJnF1b3Q7c2Fucy1zZXJpZiZxdW90Oztjb2xv
cjojMUY0OTdEIj5UaGFua3M6PG86cD48L286cD48L3NwYW4+PC9wPg0KPHAgY2xhc3M9Ik1zb05v
cm1hbCI+PHNwYW4gc3R5bGU9ImZvbnQtc2l6ZToxMS4wcHQ7Zm9udC1mYW1pbHk6JnF1b3Q7Q2Fs
aWJyaSZxdW90OywmcXVvdDtzYW5zLXNlcmlmJnF1b3Q7O2NvbG9yOiMxRjQ5N0QiPkFkYW08bzpw
PjwvbzpwPjwvc3Bhbj48L3A+DQo8cCBjbGFzcz0iTXNvTm9ybWFsIj48c3BhbiBzdHlsZT0iZm9u
dC1zaXplOjExLjBwdDtmb250LWZhbWlseTomcXVvdDtDYWxpYnJpJnF1b3Q7LCZxdW90O3NhbnMt
c2VyaWYmcXVvdDs7Y29sb3I6IzFGNDk3RCI+PG86cD4mbmJzcDs8L286cD48L3NwYW4+PC9wPg0K
PHAgY2xhc3M9Ik1zb05vcm1hbCI+PHNwYW4gc3R5bGU9ImZvbnQtc2l6ZToxMS4wcHQ7Zm9udC1m
YW1pbHk6JnF1b3Q7Q2FsaWJyaSZxdW90OywmcXVvdDtzYW5zLXNlcmlmJnF1b3Q7O2NvbG9yOiMx
RjQ5N0QiPjxvOnA+Jm5ic3A7PC9vOnA+PC9zcGFuPjwvcD4NCjxwIGNsYXNzPSJNc29Ob3JtYWwi
IHN0eWxlPSJtYXJnaW4tbGVmdDouNWluIj48Yj48c3BhbiBzdHlsZT0iZm9udC1zaXplOjEwLjBw
dDtmb250LWZhbWlseTomcXVvdDtUYWhvbWEmcXVvdDssJnF1b3Q7c2Fucy1zZXJpZiZxdW90OyI+
RnJvbTo8L3NwYW4+PC9iPjxzcGFuIHN0eWxlPSJmb250LXNpemU6MTAuMHB0O2ZvbnQtZmFtaWx5
OiZxdW90O1RhaG9tYSZxdW90OywmcXVvdDtzYW5zLXNlcmlmJnF1b3Q7Ij4gV2lsbGlhbSBBLiBS
b3dlIEpyLiBbbWFpbHRvOndyb3dlQHBpdm90YWwuaW9dDQo8YnI+DQo8Yj5TZW50OjwvYj4gVGh1
cnNkYXksIE9jdG9iZXIgMjksIDIwMTUgNjowNCBQTTxicj4NCjxiPlRvOjwvYj4gUEFOLCBKSU48
YnI+DQo8Yj5DYzo8L2I+IHdyb3dlQGFwYWNoZS5vcmc7IEdyZWVuYmVyZywgQWRhbTxicj4NCjxi
PlN1YmplY3Q6PC9iPiBSZTogbWVyZ2luZyBBcGFjaGUgJmx0O0RpcmVjdG9yeSZndDsgY29udGV4
dDxvOnA+PC9vOnA+PC9zcGFuPjwvcD4NCjxwIGNsYXNzPSJNc29Ob3JtYWwiIHN0eWxlPSJtYXJn
aW4tbGVmdDouNWluIj48bzpwPiZuYnNwOzwvbzpwPjwvcD4NCjxkaXY+DQo8ZGl2Pg0KPHAgY2xh
c3M9Ik1zb05vcm1hbCIgc3R5bGU9Im1hcmdpbi1sZWZ0Oi41aW4iPkhpIEppbiw8bzpwPjwvbzpw
PjwvcD4NCjwvZGl2Pg0KPGRpdj4NCjxwIGNsYXNzPSJNc29Ob3JtYWwiIHN0eWxlPSJtYXJnaW4t
bGVmdDouNWluIj48bzpwPiZuYnNwOzwvbzpwPjwvcD4NCjwvZGl2Pg0KPGRpdj4NCjxwIGNsYXNz
PSJNc29Ob3JtYWwiIHN0eWxlPSJtYXJnaW4tbGVmdDouNWluIj50aGVyZSBtaWdodCBiZSBtb3Jl
IHRoYW4gb25lIHRoaW5nIGdvaW5nIG9uIGhlcmUuICZuYnNwOzxvOnA+PC9vOnA+PC9wPg0KPC9k
aXY+DQo8ZGl2Pg0KPHAgY2xhc3M9Ik1zb05vcm1hbCIgc3R5bGU9Im1hcmdpbi1sZWZ0Oi41aW4i
PjxvOnA+Jm5ic3A7PC9vOnA+PC9wPg0KPC9kaXY+DQo8ZGl2Pg0KPHAgY2xhc3M9Ik1zb05vcm1h
bCIgc3R5bGU9Im1hcmdpbi1sZWZ0Oi41aW4iPkZpcnN0LCBpdCBpcyBjcml0aWNhbCB0aGF0IGEg
ZGlyZWN0aXZlIGJlbG9uZ2luZyB0byB0aGUgbW9kdWxlIG9jY3VycyBpbiBlYWNoIG9mIHRoZSAm
bHQ7c2VjdGlvbiAmZ3Q7IGJsb2NrcyB5b3UgYXJlIG1lcmdpbmcuPG86cD48L286cD48L3A+DQo8
L2Rpdj4NCjxkaXY+DQo8cCBjbGFzcz0iTXNvTm9ybWFsIiBzdHlsZT0ibWFyZ2luLWxlZnQ6LjVp
biI+PG86cD4mbmJzcDs8L286cD48L3A+DQo8L2Rpdj4NCjxkaXY+DQo8cCBjbGFzcz0iTXNvTm9y
bWFsIiBzdHlsZT0ibWFyZ2luLWxlZnQ6LjVpbiI+UmVtZW1iZXIgaHR0cGQgaXMgbm90IGdvaW5n
IHRvIGV2ZW4gY3JlYXRlIGEgY29uZmlnIHNlY3Rpb24sIG5ldmVyIG1pbmQgbWVyZ2UgdGhlbSwg
Zm9yIGV2ZXJ5IG1vZHVsZSB3aG9zZSBkaXJlY3RpdmVzIGRvIG5vdCBhcHBlYXIgaW4gYSBnaXZl
biAmbHQ7c2VjdGlvbiAmZ3Q7IC0gdGhpcyBpcyB3aGF0IG1ha2VzIGh0dHBkIHNvIGVmZmljaWVu
dC48bzpwPjwvbzpwPjwvcD4NCjwvZGl2Pg0KPGRpdj4NCjxwIGNsYXNzPSJNc29Ob3JtYWwiIHN0
eWxlPSJtYXJnaW4tbGVmdDouNWluIj48bzpwPiZuYnNwOzwvbzpwPjwvcD4NCjwvZGl2Pg0KPGRp
dj4NCjxwIGNsYXNzPSJNc29Ob3JtYWwiIHN0eWxlPSJtYXJnaW4tbGVmdDouNWluIj5TZWNvbmQs
IGlmIHRoZXJlIGlzIGEgYnVnIGluIHRoZSBjbWQgaGFuZGxlciwgeW91ciBjdHggbWVtYmVyIG1p
Z2h0IG5vdCBiZSBjb3JyZWN0bHkgdXBkYXRlZCBmb3IgYSBzZWN0aW9uLCBzYW1lIGlzIHRydWUg
Zm9yIGEgYnVnIGluIHRoZSBjcmVhdGUgb3IgbWVyZ2UgZnVuY3Rpb24uPG86cD48L286cD48L3A+
DQo8L2Rpdj4NCjxkaXY+DQo8cCBjbGFzcz0iTXNvTm9ybWFsIiBzdHlsZT0ibWFyZ2luLWxlZnQ6
LjVpbiI+PG86cD4mbmJzcDs8L286cD48L3A+DQo8L2Rpdj4NCjxkaXY+DQo8cCBjbGFzcz0iTXNv
Tm9ybWFsIiBzdHlsZT0ibWFyZ2luLWxlZnQ6LjVpbiI+VGhpcmQsIGh0dHBkIGRvZXMgcGVyZm9y
bSBzb21lIG9wdGltaXphdGlvbiwgaXQgbWF5IHByZW1lcmdlIGdsb2JhbCBjb25maWdzIGFuZCBt
YXkgcmVzdW1lIGEgbWVyZ2UgZnJvbSBwcmV2aW91c2x5IG1lcmdlZCBzZWN0aW9ucyB3aGVuIHRo
ZXkgYXJlIGVuY291bnRlcmVkIGluIGEgc3VicmVxdWVzdC48bzpwPjwvbzpwPjwvcD4NCjwvZGl2
Pg0KPGRpdj4NCjxwIGNsYXNzPSJNc29Ob3JtYWwiIHN0eWxlPSJtYXJnaW4tbGVmdDouNWluIj48
bzpwPiZuYnNwOzwvbzpwPjwvcD4NCjwvZGl2Pg0KPGRpdj4NCjxwIGNsYXNzPSJNc29Ob3JtYWwi
IHN0eWxlPSJtYXJnaW4tbGVmdDouNWluIj5JcyB0aGUgcmVzdWx0aW5nIC0mZ3Q7Y3R4IG1lbWJl
ciBjb3JyZWN0IGZvciB0aGUgcmVzdWx0aW5nICZsdDtEaXJlY3RvcnkgJmd0OyBjb250ZXh0PyZu
YnNwOyBJcyBpdCBzaW1wbHkgdGhhdCB0aGUgbWVyZ2UgaXNuJ3QgY2FsbGVkIGFzIG9mdGVuIGFz
IGV4cGVjdGVkPyZuYnNwOyBPcHRpbWl6YXRpb24gbWF5IGJlIHRoZSBjYXVzZS48bzpwPjwvbzpw
PjwvcD4NCjwvZGl2Pg0KPGRpdj4NCjxwIGNsYXNzPSJNc29Ob3JtYWwiIHN0eWxlPSJtYXJnaW4t
bGVmdDouNWluIj48bzpwPiZuYnNwOzwvbzpwPjwvcD4NCjwvZGl2Pg0KPGRpdj4NCjxwIGNsYXNz
PSJNc29Ob3JtYWwiIHN0eWxlPSJtYXJnaW4tbGVmdDouNWluIj5JcyB0aGUgY21kIHJlY29yZCBm
b3IgeW91ciBkaXJlY3RpdmUgc2V0IHRvIE9SX0FDQ0VTUyAodGVsbGluZyBodHRwZCB0aGF0IGl0
IGlzIGEgcGVyLWRpciBhbmQgbm90IHBlci1zZXJ2ZXIgY29uZmlnPyk8bzpwPjwvbzpwPjwvcD4N
CjwvZGl2Pg0KPGRpdj4NCjxwIGNsYXNzPSJNc29Ob3JtYWwiIHN0eWxlPSJtYXJnaW4tbGVmdDou
NWluIj48bzpwPiZuYnNwOzwvbzpwPjwvcD4NCjwvZGl2Pg0KPGRpdj4NCjxwIGNsYXNzPSJNc29O
b3JtYWwiIHN0eWxlPSJtYXJnaW4tbGVmdDouNWluIj5JcyB0aGVyZSBhIGJ1ZyBpbiB5b3VyIGNy
ZWF0ZSBjb2RlIHRoYXQgaXMgcmV0dXJuaW5nIE5VTEwgaW5zdGVhZCBvZiBhIG5ld2x5IGluaXRp
YWxpemVkIGNvbmZpZyBzZWN0aW9uPzxvOnA+PC9vOnA+PC9wPg0KPC9kaXY+DQo8ZGl2Pg0KPHAg
Y2xhc3M9Ik1zb05vcm1hbCIgc3R5bGU9Im1hcmdpbi1sZWZ0Oi41aW4iPjxvOnA+Jm5ic3A7PC9v
OnA+PC9wPg0KPC9kaXY+DQo8ZGl2Pg0KPHAgY2xhc3M9Ik1zb05vcm1hbCIgc3R5bGU9Im1hcmdp
bi1sZWZ0Oi41aW4iPklmIHdlIGxvb2sgYXQgdGhlIGV4YW1wbGUgb2YgbW9kX2Rpci5jLCBoZXJl
IGFyZSB0aGUga2V5IHBvaW50cy4uLjxvOnA+PC9vOnA+PC9wPg0KPC9kaXY+DQo8ZGl2Pg0KPHAg
Y2xhc3M9Ik1zb05vcm1hbCIgc3R5bGU9Im1hcmdpbi1sZWZ0Oi41aW4iPjxvOnA+Jm5ic3A7PC9v
OnA+PC9wPg0KPC9kaXY+DQo8ZGl2Pg0KPHByZSBzdHlsZT0ibWFyZ2luLWxlZnQ6LjVpbjt3b3Jk
LXdyYXA6YnJlYWstd29yZDt3aGl0ZS1zcGFjZTpwcmUtd3JhcCI+PHNwYW4gc3R5bGU9ImNvbG9y
OmJsYWNrIj5BUF9ERUNMQVJFX01PRFVMRShkaXIpID0gezxvOnA+PC9vOnA+PC9zcGFuPjwvcHJl
Pg0KPHByZSBzdHlsZT0ibWFyZ2luLWxlZnQ6LjVpbiI+PHNwYW4gc3R5bGU9ImNvbG9yOmJsYWNr
Ij4mbmJzcDsmbmJzcDsmbmJzcDsgU1RBTkRBUkQyMF9NT0RVTEVfU1RVRkYsPG86cD48L286cD48
L3NwYW4+PC9wcmU+DQo8cHJlIHN0eWxlPSJtYXJnaW4tbGVmdDouNWluIj48c3BhbiBzdHlsZT0i
Y29sb3I6YmxhY2siPiZuYnNwOyZuYnNwOyZuYnNwOyBjcmVhdGVfZGlyX2NvbmZpZywmbmJzcDsm
bmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsgLyogY3JlYXRl
IHBlci1kaXJlY3RvcnkgY29uZmlnIHN0cnVjdHVyZSAqLzxvOnA+PC9vOnA+PC9zcGFuPjwvcHJl
Pg0KPHByZSBzdHlsZT0ibWFyZ2luLWxlZnQ6LjVpbiI+PHNwYW4gc3R5bGU9ImNvbG9yOmJsYWNr
Ij4mbmJzcDsmbmJzcDsmbmJzcDsgbWVyZ2VfZGlyX2NvbmZpZ3MsJm5ic3A7Jm5ic3A7Jm5ic3A7
Jm5ic3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7IC8qIG1lcmdlIHBlci1kaXJlY3Rv
cnkgY29uZmlnIHN0cnVjdHVyZXMgKi88bzpwPjwvbzpwPjwvc3Bhbj48L3ByZT4NCjwvZGl2Pg0K
PGRpdj4NCjxwIGNsYXNzPSJNc29Ob3JtYWwiIHN0eWxlPSJtYXJnaW4tbGVmdDouNWluIj5BbGwg
aXMgd2VsbCwgd2UgaGF2ZSBhIGNyZWF0ZSAmIzQzOyBtZXJnZSBoYW5kbGVyLi4uPG86cD48L286
cD48L3A+DQo8L2Rpdj4NCjxkaXY+DQo8cCBjbGFzcz0iTXNvTm9ybWFsIiBzdHlsZT0ibWFyZ2lu
LWxlZnQ6LjVpbiI+PG86cD4mbmJzcDs8L286cD48L3A+DQo8L2Rpdj4NCjxkaXY+DQo8cHJlIHN0
eWxlPSJtYXJnaW4tbGVmdDouNWluO3dvcmQtd3JhcDpicmVhay13b3JkO3doaXRlLXNwYWNlOnBy
ZS13cmFwIj48c3BhbiBzdHlsZT0iY29sb3I6YmxhY2siPnN0YXRpYyB2b2lkICpjcmVhdGVfZGly
X2NvbmZpZyhhcHJfcG9vbF90ICpwLCBjaGFyICpkdW1teSk8bzpwPjwvbzpwPjwvc3Bhbj48L3By
ZT4NCjxwcmUgc3R5bGU9Im1hcmdpbi1sZWZ0Oi41aW4iPjxzcGFuIHN0eWxlPSJjb2xvcjpibGFj
ayI+ezxvOnA+PC9vOnA+PC9zcGFuPjwvcHJlPg0KPHByZSBzdHlsZT0ibWFyZ2luLWxlZnQ6LjVp
biI+PHNwYW4gc3R5bGU9ImNvbG9yOmJsYWNrIj4mbmJzcDsmbmJzcDsmbmJzcDsgZGlyX2NvbmZp
Z19yZWMgKm5ldyA9IGFwcl9wY2FsbG9jKHAsIHNpemVvZihkaXJfY29uZmlnX3JlYykpOzxvOnA+
PC9vOnA+PC9zcGFuPjwvcHJlPg0KPHByZSBzdHlsZT0ibWFyZ2luLWxlZnQ6LjVpbiI+PHNwYW4g
c3R5bGU9ImNvbG9yOmJsYWNrIj48bzpwPiZuYnNwOzwvbzpwPjwvc3Bhbj48L3ByZT4NCjxwcmUg
c3R5bGU9Im1hcmdpbi1sZWZ0Oi41aW4iPjxzcGFuIHN0eWxlPSJjb2xvcjpibGFjayI+Jm5ic3A7
Jm5ic3A7Jm5ic3A7IG5ldy0mZ3Q7aW5kZXhfbmFtZXMgPSBOVUxMOzxvOnA+PC9vOnA+PC9zcGFu
PjwvcHJlPg0KPHByZSBzdHlsZT0ibWFyZ2luLWxlZnQ6LjVpbiI+PHNwYW4gc3R5bGU9ImNvbG9y
OmJsYWNrIj4mbmJzcDsmbmJzcDsmbmJzcDsgbmV3LSZndDtkb19zbGFzaCA9IE1PRERJUl9VTlNF
VDs8bzpwPjwvbzpwPjwvc3Bhbj48L3ByZT4NCjxwcmUgc3R5bGU9Im1hcmdpbi1sZWZ0Oi41aW4i
PjxzcGFuIHN0eWxlPSJjb2xvcjpibGFjayI+Jm5ic3A7Jm5ic3A7Jm5ic3A7IG5ldy0mZ3Q7Y2hl
Y2toYW5kbGVyID0gTU9ERElSX1VOU0VUOzxvOnA+PC9vOnA+PC9zcGFuPjwvcHJlPg0KPHByZSBz
dHlsZT0ibWFyZ2luLWxlZnQ6LjVpbiI+PHNwYW4gc3R5bGU9ImNvbG9yOmJsYWNrIj4mbmJzcDsm
bmJzcDsmbmJzcDsgbmV3LSZndDtyZWRpcmVjdF9pbmRleCA9IFJFRElSRUNUX1VOU0VUOzxvOnA+
PC9vOnA+PC9zcGFuPjwvcHJlPg0KPHByZSBzdHlsZT0ibWFyZ2luLWxlZnQ6LjVpbiI+PHNwYW4g
c3R5bGU9ImNvbG9yOmJsYWNrIj4mbmJzcDsmbmJzcDsmbmJzcDsgcmV0dXJuICh2b2lkICopIG5l
dzs8bzpwPjwvbzpwPjwvc3Bhbj48L3ByZT4NCjxwcmUgc3R5bGU9Im1hcmdpbi1sZWZ0Oi41aW4i
PjxzcGFuIHN0eWxlPSJjb2xvcjpibGFjayI+fTxvOnA+PC9vOnA+PC9zcGFuPjwvcHJlPg0KPC9k
aXY+DQo8ZGl2Pg0KPHAgY2xhc3M9Ik1zb05vcm1hbCIgc3R5bGU9Im1hcmdpbi1sZWZ0Oi41aW4i
PnRoZSBjb3JyZWN0IHN0cnVjdHVyZSBzaXplIGlzIGNyZWF0ZWQgYW5kIG1lbWJlcnMgaW5pdGlh
bGl6ZWQgdG8gZW1wdHkgKGUuZy4gJ3Vuc2V0JykgLSB0aGUgbmV3IGFsbG9jYXRpb24gaXMgcmV0
dXJuZWQuPG86cD48L286cD48L3A+DQo8L2Rpdj4NCjxkaXY+DQo8cCBjbGFzcz0iTXNvTm9ybWFs
IiBzdHlsZT0ibWFyZ2luLWxlZnQ6LjVpbiI+PG86cD4mbmJzcDs8L286cD48L3A+DQo8L2Rpdj4N
CjxkaXY+DQo8cHJlIHN0eWxlPSJtYXJnaW4tbGVmdDouNWluO3dvcmQtd3JhcDpicmVhay13b3Jk
O3doaXRlLXNwYWNlOnByZS13cmFwIj48c3BhbiBzdHlsZT0iY29sb3I6YmxhY2siPnN0YXRpYyB2
b2lkICptZXJnZV9kaXJfY29uZmlncyhhcHJfcG9vbF90ICpwLCB2b2lkICpiYXNldiwgdm9pZCAq
YWRkdik8bzpwPjwvbzpwPjwvc3Bhbj48L3ByZT4NCjxwcmUgc3R5bGU9Im1hcmdpbi1sZWZ0Oi41
aW4iPjxzcGFuIHN0eWxlPSJjb2xvcjpibGFjayI+ezxvOnA+PC9vOnA+PC9zcGFuPjwvcHJlPg0K
PHByZSBzdHlsZT0ibWFyZ2luLWxlZnQ6LjVpbiI+PHNwYW4gc3R5bGU9ImNvbG9yOmJsYWNrIj4m
bmJzcDsmbmJzcDsmbmJzcDsgZGlyX2NvbmZpZ19yZWMgKm5ldyA9IGFwcl9wY2FsbG9jKHAsIHNp
emVvZihkaXJfY29uZmlnX3JlYykpOzxvOnA+PC9vOnA+PC9zcGFuPjwvcHJlPg0KPHByZSBzdHls
ZT0ibWFyZ2luLWxlZnQ6LjVpbiI+PHNwYW4gc3R5bGU9ImNvbG9yOmJsYWNrIj4mbmJzcDsmbmJz
cDsmbmJzcDsgZGlyX2NvbmZpZ19yZWMgKmJhc2UgPSAoZGlyX2NvbmZpZ19yZWMgKiliYXNldjs8
bzpwPjwvbzpwPjwvc3Bhbj48L3ByZT4NCjxwcmUgc3R5bGU9Im1hcmdpbi1sZWZ0Oi41aW4iPjxz
cGFuIHN0eWxlPSJjb2xvcjpibGFjayI+Jm5ic3A7Jm5ic3A7Jm5ic3A7IGRpcl9jb25maWdfcmVj
ICphZGQgPSAoZGlyX2NvbmZpZ19yZWMgKilhZGR2OzxvOnA+PC9vOnA+PC9zcGFuPjwvcHJlPg0K
PHByZSBzdHlsZT0ibWFyZ2luLWxlZnQ6LjVpbiI+PHNwYW4gc3R5bGU9ImNvbG9yOmJsYWNrIj48
bzpwPiZuYnNwOzwvbzpwPjwvc3Bhbj48L3ByZT4NCjxwcmUgc3R5bGU9Im1hcmdpbi1sZWZ0Oi41
aW4iPjxzcGFuIHN0eWxlPSJjb2xvcjpibGFjayI+Jm5ic3A7Jm5ic3A7Jm5ic3A7IG5ldy0mZ3Q7
aW5kZXhfbmFtZXMgPSBhZGQtJmd0O2luZGV4X25hbWVzID8gYWRkLSZndDtpbmRleF9uYW1lcyA6
IGJhc2UtJmd0O2luZGV4X25hbWVzOzxvOnA+PC9vOnA+PC9zcGFuPjwvcHJlPg0KPHByZSBzdHls
ZT0ibWFyZ2luLWxlZnQ6LjVpbiI+PHNwYW4gc3R5bGU9ImNvbG9yOmJsYWNrIj4mbmJzcDsmbmJz
cDsmbmJzcDsgbmV3LSZndDtkb19zbGFzaCA9PG86cD48L286cD48L3NwYW4+PC9wcmU+DQo8cHJl
IHN0eWxlPSJtYXJnaW4tbGVmdDouNWluIj48c3BhbiBzdHlsZT0iY29sb3I6YmxhY2siPiZuYnNw
OyZuYnNwOyZuYnNwOyZuYnNwOyZuYnNwOyZuYnNwOyZuYnNwOyAoYWRkLSZndDtkb19zbGFzaCA9
PSBNT0RESVJfVU5TRVQpID8gYmFzZS0mZ3Q7ZG9fc2xhc2ggOiBhZGQtJmd0O2RvX3NsYXNoOzxv
OnA+PC9vOnA+PC9zcGFuPjwvcHJlPg0KPHByZSBzdHlsZT0ibWFyZ2luLWxlZnQ6LjVpbiI+PHNw
YW4gc3R5bGU9ImNvbG9yOmJsYWNrIj4mbmJzcDsmbmJzcDsmbmJzcDsgbmV3LSZndDtjaGVja2hh
bmRsZXIgPTxvOnA+PC9vOnA+PC9zcGFuPjwvcHJlPg0KPHByZSBzdHlsZT0ibWFyZ2luLWxlZnQ6
LjVpbiI+PHNwYW4gc3R5bGU9ImNvbG9yOmJsYWNrIj4mbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsm
bmJzcDsmbmJzcDsmbmJzcDsgKGFkZC0mZ3Q7Y2hlY2toYW5kbGVyID09IE1PRERJUl9VTlNFVCkg
PyBiYXNlLSZndDtjaGVja2hhbmRsZXIgOiBhZGQtJmd0O2NoZWNraGFuZGxlcjs8bzpwPjwvbzpw
Pjwvc3Bhbj48L3ByZT4NCjxwcmUgc3R5bGU9Im1hcmdpbi1sZWZ0Oi41aW4iPjxzcGFuIHN0eWxl
PSJjb2xvcjpibGFjayI+Jm5ic3A7Jm5ic3A7Jm5ic3A7IG5ldy0mZ3Q7cmVkaXJlY3RfaW5kZXg9
PG86cD48L286cD48L3NwYW4+PC9wcmU+DQo8cHJlIHN0eWxlPSJtYXJnaW4tbGVmdDouNWluIj48
c3BhbiBzdHlsZT0iY29sb3I6YmxhY2siPiZuYnNwOyZuYnNwOyZuYnNwOyZuYnNwOyZuYnNwOyZu
YnNwOyZuYnNwOyAoYWRkLSZndDtyZWRpcmVjdF9pbmRleCA9PSBSRURJUkVDVF9VTlNFVCkgPyBi
YXNlLSZndDtyZWRpcmVjdF9pbmRleCA6IGFkZC0mZ3Q7cmVkaXJlY3RfaW5kZXg7PG86cD48L286
cD48L3NwYW4+PC9wcmU+DQo8cHJlIHN0eWxlPSJtYXJnaW4tbGVmdDouNWluIj48c3BhbiBzdHls
ZT0iY29sb3I6YmxhY2siPiZuYnNwOyZuYnNwOyZuYnNwOyBuZXctJmd0O2RmbHQgPSBhZGQtJmd0
O2RmbHQgPyBhZGQtJmd0O2RmbHQgOiBiYXNlLSZndDtkZmx0OzxvOnA+PC9vOnA+PC9zcGFuPjwv
cHJlPg0KPHByZSBzdHlsZT0ibWFyZ2luLWxlZnQ6LjVpbiI+PHNwYW4gc3R5bGU9ImNvbG9yOmJs
YWNrIj4mbmJzcDsmbmJzcDsmbmJzcDsgcmV0dXJuIG5ldzs8bzpwPjwvbzpwPjwvc3Bhbj48L3By
ZT4NCjxwcmUgc3R5bGU9Im1hcmdpbi1sZWZ0Oi41aW4iPjxzcGFuIHN0eWxlPSJjb2xvcjpibGFj
ayI+fTxvOnA+PC9vOnA+PC9zcGFuPjwvcHJlPg0KPC9kaXY+DQo8ZGl2Pg0KPHAgY2xhc3M9Ik1z
b05vcm1hbCIgc3R5bGU9Im1hcmdpbi1sZWZ0Oi41aW4iPkEgbmV3IGNvbmZpZyBpcyBjcmVhdGVk
LCB0aGUgdmFyaW91cyBwZXItZGlyIHZhbHVlcyB1cGRhdGVkLCBhbmQgdGhlIHJlc3VsdGluZyBu
ZXcgYWxsb2NhdGlvbiBpcyByZXR1cm5lZC48bzpwPjwvbzpwPjwvcD4NCjwvZGl2Pg0KPGRpdj4N
CjxwIGNsYXNzPSJNc29Ob3JtYWwiIHN0eWxlPSJtYXJnaW4tbGVmdDouNWluIj48bzpwPiZuYnNw
OzwvbzpwPjwvcD4NCjwvZGl2Pg0KPGRpdj4NCjxwcmUgc3R5bGU9Im1hcmdpbi1sZWZ0Oi41aW47
d29yZC13cmFwOmJyZWFrLXdvcmQ7d2hpdGUtc3BhY2U6cHJlLXdyYXAiPjxzcGFuIHN0eWxlPSJj
b2xvcjpibGFjayI+c3RhdGljIGNvbnN0IGNvbW1hbmRfcmVjIGRpcl9jbWRzW10gPTxvOnA+PC9v
OnA+PC9zcGFuPjwvcHJlPg0KPHByZSBzdHlsZT0ibWFyZ2luLWxlZnQ6LjVpbiI+PHNwYW4gc3R5
bGU9ImNvbG9yOmJsYWNrIj57PG86cD48L286cD48L3NwYW4+PC9wcmU+DQo8cHJlIHN0eWxlPSJt
YXJnaW4tbGVmdDouNWluIj48c3BhbiBzdHlsZT0iY29sb3I6YmxhY2siPi4uLjxvOnA+PC9vOnA+
PC9zcGFuPjwvcHJlPg0KPHByZSBzdHlsZT0ibWFyZ2luLWxlZnQ6LjVpbiI+PHNwYW4gc3R5bGU9
ImNvbG9yOmJsYWNrIj4mbmJzcDsmbmJzcDsmbmJzcDsgQVBfSU5JVF9SQVdfQVJHUygmcXVvdDtE
aXJlY3RvcnlJbmRleCZxdW90OywgYWRkX2luZGV4LCBOVUxMLCBESVJfQ01EX1BFUk1TLDxvOnA+
PC9vOnA+PC9zcGFuPjwvcHJlPg0KPHByZSBzdHlsZT0ibWFyZ2luLWxlZnQ6LjVpbiI+PHNwYW4g
c3R5bGU9ImNvbG9yOmJsYWNrIj4mbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsm
bmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJz
cDsmbmJzcDsmbmJzcDsmbmJzcDsgJnF1b3Q7YSBsaXN0IG9mIGZpbGUgbmFtZXMmcXVvdDspLDxv
OnA+PC9vOnA+PC9zcGFuPjwvcHJlPg0KPC9kaXY+DQo8ZGl2Pg0KPHAgY2xhc3M9Ik1zb05vcm1h
bCIgc3R5bGU9Im1hcmdpbi1sZWZ0Oi41aW4iPlRoZSBESVJfQ01EX1BFUk1TIChkZWZpbmVkIGFz
Jm5ic3A7PHNwYW4gc3R5bGU9ImNvbG9yOmJsYWNrIj5PUl9JTkRFWEVTKTwvc3Bhbj4mbmJzcDth
c3N1cmVzIGh0dHBkIHRoYXQgdGhpcyBpcyBhIHBlci1kaXIgY29uZmlnIGRpcmVjdGl2ZSBhbGxv
d2VkIHdoZXJldmVyIHRoZSAnQWxsb3dPdmVycmlkZSBJbmRleGVzJyBpcyBzZXQuPG86cD48L286
cD48L3A+DQo8L2Rpdj4NCjxkaXY+DQo8cCBjbGFzcz0iTXNvTm9ybWFsIiBzdHlsZT0ibWFyZ2lu
LWxlZnQ6LjVpbiI+PG86cD4mbmJzcDs8L286cD48L3A+DQo8L2Rpdj4NCjxkaXY+DQo8cHJlIHN0
eWxlPSJtYXJnaW4tbGVmdDouNWluO3dvcmQtd3JhcDpicmVhay13b3JkO3doaXRlLXNwYWNlOnBy
ZS13cmFwIj48c3BhbiBzdHlsZT0iY29sb3I6YmxhY2siPnN0YXRpYyBjb25zdCBjaGFyICphZGRf
aW5kZXgoY21kX3Bhcm1zICpjbWQsIHZvaWQgKmR1bW15LCBjb25zdCBjaGFyICphcmcpPG86cD48
L286cD48L3NwYW4+PC9wcmU+DQo8cHJlIHN0eWxlPSJtYXJnaW4tbGVmdDouNWluIj48c3BhbiBz
dHlsZT0iY29sb3I6YmxhY2siPns8bzpwPjwvbzpwPjwvc3Bhbj48L3ByZT4NCjxwcmUgc3R5bGU9
Im1hcmdpbi1sZWZ0Oi41aW4iPjxzcGFuIHN0eWxlPSJjb2xvcjpibGFjayI+Jm5ic3A7Jm5ic3A7
Jm5ic3A7IGRpcl9jb25maWdfcmVjICpkID0gZHVtbXk7PG86cD48L286cD48L3NwYW4+PC9wcmU+
DQo8cHJlIHN0eWxlPSJtYXJnaW4tbGVmdDouNWluIj48c3BhbiBzdHlsZT0iY29sb3I6YmxhY2si
PiZuYnNwOyZuYnNwOyZuYnNwOyBjb25zdCBjaGFyICp0LCAqdzs8bzpwPjwvbzpwPjwvc3Bhbj48
L3ByZT4NCjxwcmUgc3R5bGU9Im1hcmdpbi1sZWZ0Oi41aW4iPjxzcGFuIHN0eWxlPSJjb2xvcjpi
bGFjayI+Jm5ic3A7Jm5ic3A7Jm5ic3A7IGludCBjb3VudCA9IDA7PG86cD48L286cD48L3NwYW4+
PC9wcmU+DQo8cHJlIHN0eWxlPSJtYXJnaW4tbGVmdDouNWluIj48c3BhbiBzdHlsZT0iY29sb3I6
YmxhY2siPjxvOnA+Jm5ic3A7PC9vOnA+PC9zcGFuPjwvcHJlPg0KPHByZSBzdHlsZT0ibWFyZ2lu
LWxlZnQ6LjVpbiI+PHNwYW4gc3R5bGU9ImNvbG9yOmJsYWNrIj4mbmJzcDsmbmJzcDsmbmJzcDsg
aWYgKCFkLSZndDtpbmRleF9uYW1lcykgezxvOnA+PC9vOnA+PC9zcGFuPjwvcHJlPg0KPHByZSBz
dHlsZT0ibWFyZ2luLWxlZnQ6LjVpbiI+PHNwYW4gc3R5bGU9ImNvbG9yOmJsYWNrIj4mbmJzcDsm
bmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsgZC0mZ3Q7aW5kZXhfbmFtZXMgPSBh
cHJfYXJyYXlfbWFrZShjbWQtJmd0O3Bvb2wsIDIsIHNpemVvZihjaGFyICopKTs8bzpwPjwvbzpw
Pjwvc3Bhbj48L3ByZT4NCjxwcmUgc3R5bGU9Im1hcmdpbi1sZWZ0Oi41aW4iPjxzcGFuIHN0eWxl
PSJjb2xvcjpibGFjayI+Jm5ic3A7Jm5ic3A7Jm5ic3A7IH08bzpwPjwvbzpwPjwvc3Bhbj48L3By
ZT4NCjxwcmUgc3R5bGU9Im1hcmdpbi1sZWZ0Oi41aW4iPjxzcGFuIHN0eWxlPSJjb2xvcjpibGFj
ayI+PG86cD4mbmJzcDs8L286cD48L3NwYW4+PC9wcmU+DQo8cHJlIHN0eWxlPSJtYXJnaW4tbGVm
dDouNWluIj48c3BhbiBzdHlsZT0iY29sb3I6YmxhY2siPiZuYnNwOyZuYnNwOyZuYnNwOyB0ID0g
YXJnOzxvOnA+PC9vOnA+PC9zcGFuPjwvcHJlPg0KPHByZSBzdHlsZT0ibWFyZ2luLWxlZnQ6LjVp
biI+PHNwYW4gc3R5bGU9ImNvbG9yOmJsYWNrIj4mbmJzcDsmbmJzcDsmbmJzcDsgd2hpbGUgKCh3
ID0gYXBfZ2V0d29yZF9jb25mKGNtZC0mZ3Q7cG9vbCwgJmFtcDt0KSkgJmFtcDsmYW1wOyB3WzBd
KSB7PG86cD48L286cD48L3NwYW4+PC9wcmU+DQo8cHJlIHN0eWxlPSJtYXJnaW4tbGVmdDouNWlu
Ij48c3BhbiBzdHlsZT0iY29sb3I6YmxhY2siPiZuYnNwOyZuYnNwOyZuYnNwOyZuYnNwOyZuYnNw
OyZuYnNwOyZuYnNwOyBpZiAoY291bnQgPT0gMCAmYW1wOyZhbXA7ICFzdHJjYXNlY21wKHcsICZx
dW90O2Rpc2FibGVkJnF1b3Q7KSkgezxvOnA+PC9vOnA+PC9zcGFuPjwvcHJlPg0KPHByZSBzdHls
ZT0ibWFyZ2luLWxlZnQ6LjVpbiI+PHNwYW4gc3R5bGU9ImNvbG9yOmJsYWNrIj4mbmJzcDsmbmJz
cDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsg
LyogcGVlayB0byBzZWUgaWYgJnF1b3Q7ZGlzYWJsZWQmcXVvdDsgaXMgZmlyc3QgaW4gYSBzZXJp
ZXMgb2YgYXJndW1lbnRzICovPG86cD48L286cD48L3NwYW4+PC9wcmU+DQo8cHJlIHN0eWxlPSJt
YXJnaW4tbGVmdDouNWluIj48c3BhbiBzdHlsZT0iY29sb3I6YmxhY2siPiZuYnNwOyZuYnNwOyZu
YnNwOyZuYnNwOyZuYnNwOyZuYnNwOyZuYnNwOyZuYnNwOyZuYnNwOyZuYnNwOyZuYnNwOyBjb25z
dCBjaGFyICp0dCA9IHQ7PG86cD48L286cD48L3NwYW4+PC9wcmU+DQo8cHJlIHN0eWxlPSJtYXJn
aW4tbGVmdDouNWluIj48c3BhbiBzdHlsZT0iY29sb3I6YmxhY2siPiZuYnNwOyZuYnNwOyZuYnNw
OyZuYnNwOyZuYnNwOyZuYnNwOyZuYnNwOyZuYnNwOyZuYnNwOyZuYnNwOyZuYnNwOyBjb25zdCBj
aGFyICp3dyA9IGFwX2dldHdvcmRfY29uZihjbWQtJmd0O3RlbXBfcG9vbCwgJmFtcDt0dCk7PG86
cD48L286cD48L3NwYW4+PC9wcmU+DQo8cHJlIHN0eWxlPSJtYXJnaW4tbGVmdDouNWluIj48c3Bh
biBzdHlsZT0iY29sb3I6YmxhY2siPiZuYnNwOyZuYnNwOyZuYnNwOyZuYnNwOyZuYnNwOyZuYnNw
OyZuYnNwOyZuYnNwOyZuYnNwOyZuYnNwOyZuYnNwOyBpZiAod3dbMF0gPT0gJ1wwJykgezxvOnA+
PC9vOnA+PC9zcGFuPjwvcHJlPg0KPHByZSBzdHlsZT0ibWFyZ2luLWxlZnQ6LjVpbiI+PHNwYW4g
c3R5bGU9ImNvbG9yOmJsYWNrIj4mbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsm
bmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsgLyogJnF1b3Q7
ZGlzYWJsZWQmcXVvdDsgaXMgZmlyc3QsIGFuZCBhbG9uZSAqLzxvOnA+PC9vOnA+PC9zcGFuPjwv
cHJlPg0KPHByZSBzdHlsZT0ibWFyZ2luLWxlZnQ6LjVpbiI+PHNwYW4gc3R5bGU9ImNvbG9yOmJs
YWNrIj4mbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJz
cDsmbmJzcDsmbmJzcDsmbmJzcDsgJm5ic3A7Jm5ic3A7YXByX2FycmF5X2NsZWFyKGQtJmd0O2lu
ZGV4X25hbWVzKTsgPG86cD48L286cD48L3NwYW4+PC9wcmU+DQo8cHJlIHN0eWxlPSJtYXJnaW4t
bGVmdDouNWluIj48c3BhbiBzdHlsZT0iY29sb3I6YmxhY2siPiZuYnNwOyZuYnNwOyZuYnNwOyZu
YnNwOyZuYnNwOyZuYnNwOyZuYnNwOyZuYnNwOyZuYnNwOyZuYnNwOyZuYnNwOyZuYnNwOyZuYnNw
OyZuYnNwOyZuYnNwO2JyZWFrOzxvOnA+PC9vOnA+PC9zcGFuPjwvcHJlPg0KPHByZSBzdHlsZT0i
bWFyZ2luLWxlZnQ6LjVpbiI+PHNwYW4gc3R5bGU9ImNvbG9yOmJsYWNrIj4mbmJzcDsmbmJzcDsm
bmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsgfTxv
OnA+PC9vOnA+PC9zcGFuPjwvcHJlPg0KPHByZSBzdHlsZT0ibWFyZ2luLWxlZnQ6LjVpbiI+PHNw
YW4gc3R5bGU9ImNvbG9yOmJsYWNrIj4mbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJz
cDsmbmJzcDsgfTxvOnA+PC9vOnA+PC9zcGFuPjwvcHJlPg0KPHByZSBzdHlsZT0ibWFyZ2luLWxl
ZnQ6LjVpbiI+PHNwYW4gc3R5bGU9ImNvbG9yOmJsYWNrIj4mbmJzcDsmbmJzcDsmbmJzcDsmbmJz
cDsmbmJzcDsmbmJzcDsmbmJzcDsgKihjb25zdCBjaGFyICoqKWFwcl9hcnJheV9wdXNoKGQtJmd0
O2luZGV4X25hbWVzKSA9IHc7PG86cD48L286cD48L3NwYW4+PC9wcmU+DQo8cHJlIHN0eWxlPSJt
YXJnaW4tbGVmdDouNWluIj48c3BhbiBzdHlsZT0iY29sb3I6YmxhY2siPiZuYnNwOyZuYnNwOyZu
YnNwOyZuYnNwOyZuYnNwOyZuYnNwOyZuYnNwOyBjb3VudCYjNDM7JiM0Mzs7PG86cD48L286cD48
L3NwYW4+PC9wcmU+DQo8cHJlIHN0eWxlPSJtYXJnaW4tbGVmdDouNWluIj48c3BhbiBzdHlsZT0i
Y29sb3I6YmxhY2siPiZuYnNwOyZuYnNwOyZuYnNwOyB9PG86cD48L286cD48L3NwYW4+PC9wcmU+
DQo8cHJlIHN0eWxlPSJtYXJnaW4tbGVmdDouNWluIj48c3BhbiBzdHlsZT0iY29sb3I6YmxhY2si
PjxvOnA+Jm5ic3A7PC9vOnA+PC9zcGFuPjwvcHJlPg0KPHByZSBzdHlsZT0ibWFyZ2luLWxlZnQ6
LjVpbiI+PHNwYW4gc3R5bGU9ImNvbG9yOmJsYWNrIj4mbmJzcDsmbmJzcDsmbmJzcDsgcmV0dXJu
IE5VTEw7PG86cD48L286cD48L3NwYW4+PC9wcmU+DQo8cHJlIHN0eWxlPSJtYXJnaW4tbGVmdDou
NWluIj48c3BhbiBzdHlsZT0iY29sb3I6YmxhY2siPn08bzpwPjwvbzpwPjwvc3Bhbj48L3ByZT4N
CjwvZGl2Pg0KPGRpdj4NCjxwIGNsYXNzPSJNc29Ob3JtYWwiIHN0eWxlPSJtYXJnaW4tbGVmdDou
NWluIj5IZXJlIHdlIGl0ZXJhdGUgdGhlIHN0cmluZyAoUkFXX0FSR1MpIHBhc3NlZCBieSBEaXJl
Y3RvcnlJbmRleCBhbmQgcGFyc2UgaXQgdG8gYnVpbGQgYW4gYXJyYXkgb2YgaW5kZXggc3RyaW5n
cywgYW5kIHNlZSB3aGVyZSB0aGUgZGlyX2NvbmZpZ19yZWMgaXMgZGVyaXZlZCBmcm9tIHRoZSBk
dW1teSBhcmcgKGl0IHdvdWxkIGJlIGdpdmVuIGEgbmV3bHkvcmVjZW50bHkNCiBjcmVhdGVkIGRp
ciBjb25maWcpLiBOb3RlIGFsc28gdGhhdCBhIHNlY29uZCBvY2N1cmFuY2Ugb2YgRGlyZWN0b3J5
SW5kZXgga2VlcHMgYnVpbGRpbmcgdGhpcyAmbHQ7c2VjdGlvbiAmZ3Q7J3MgaW5kZXhfbmFtZSBs
aXN0LjxvOnA+PC9vOnA+PC9wPg0KPC9kaXY+DQo8ZGl2Pg0KPHAgY2xhc3M9Ik1zb05vcm1hbCIg
c3R5bGU9Im1hcmdpbi1sZWZ0Oi41aW4iPjxvOnA+Jm5ic3A7PC9vOnA+PC9wPg0KPC9kaXY+DQo8
ZGl2Pg0KPHAgY2xhc3M9Ik1zb05vcm1hbCIgc3R5bGU9Im1hcmdpbi1sZWZ0Oi41aW4iPkJhY2sg
dXAgaW4gdGhlIG1lcmdlIGVpdGhlciBrZWVwIHRoZSBwYXJlbnQgbGlzdCwgb3IgcmVwbGFjZSBp
dCBpZiBhIG5ldyBsaXN0IHdhcyBjcmVhdGVkIHdpdGggdGhlIGFkZF9pbmRleCBkaXJlY3RpdmUu
PG86cD48L286cD48L3A+DQo8L2Rpdj4NCjxkaXY+DQo8cCBjbGFzcz0iTXNvTm9ybWFsIiBzdHls
ZT0ibWFyZ2luLWxlZnQ6LjVpbiI+PG86cD4mbmJzcDs8L286cD48L3A+DQo8L2Rpdj4NCjxkaXY+
DQo8cCBjbGFzcz0iTXNvTm9ybWFsIiBzdHlsZT0ibWFyZ2luLWxlZnQ6LjVpbiI+UGxlYXNlIGNo
ZWNrIHNvbWUgb2YgdGhlIGl0ZW1zIGlkZW50aWZpZWQgYWJvdmUgdG8gc2VlIGlmIHlvdSBjYW4g
d29yayBvdXQgdGhlIGNhdXNlIG9mIHlvdXIgYnVnLjxvOnA+PC9vOnA+PC9wPg0KPC9kaXY+DQo8
ZGl2Pg0KPHAgY2xhc3M9Ik1zb05vcm1hbCIgc3R5bGU9Im1hcmdpbi1sZWZ0Oi41aW4iPjxvOnA+
Jm5ic3A7PC9vOnA+PC9wPg0KPC9kaXY+DQo8ZGl2Pg0KPHAgY2xhc3M9Ik1zb05vcm1hbCIgc3R5
bGU9Im1hcmdpbi1sZWZ0Oi41aW4iPllvdXJzLDxvOnA+PC9vOnA+PC9wPg0KPC9kaXY+DQo8ZGl2
Pg0KPHAgY2xhc3M9Ik1zb05vcm1hbCIgc3R5bGU9Im1hcmdpbi1sZWZ0Oi41aW4iPjxvOnA+Jm5i
c3A7PC9vOnA+PC9wPg0KPC9kaXY+DQo8ZGl2Pg0KPHAgY2xhc3M9Ik1zb05vcm1hbCIgc3R5bGU9
Im1hcmdpbi1sZWZ0Oi41aW4iPkJpbGw8bzpwPjwvbzpwPjwvcD4NCjwvZGl2Pg0KPGRpdj4NCjxw
IGNsYXNzPSJNc29Ob3JtYWwiIHN0eWxlPSJtYXJnaW4tbGVmdDouNWluIj48bzpwPiZuYnNwOzwv
bzpwPjwvcD4NCjwvZGl2Pg0KPGRpdj4NCjxwIGNsYXNzPSJNc29Ob3JtYWwiIHN0eWxlPSJtYXJn
aW4tbGVmdDouNWluIj5bRllJIEkgZG8gaWdub3JlIHBlcnNvbmFsIGFwcGVhbHMgZm9yIGhlbHAg
YXQgbXkgQDxhIGhyZWY9Imh0dHA6Ly9hcGFjaGUub3JnIiB0YXJnZXQ9Il9ibGFuayI+YXBhY2hl
Lm9yZzwvYT4gYWNjb3VudCwga2luZGx5IHJlcXVlc3RpbmcgdGhhdCB0aGUgdXNlciByZXN0YXRl
IHRoZWlyIHF1ZXN0aW9uIHB1YmxpY2x5IG9uIHRoZSB1c2Vyc0Agb3IgZGV2QCBsaXN0IGFzDQog
YXBwcm9wcmlhdGUuIFRoaXMgbGV0cyBtZSBhbnN3ZXIgdGhlIHNhbWUgcXVlc3Rpb24gZm9yIG1h
bnkgZW5kIHVzZXJzIHdobyBnb29nbGUgZm9yIHJlbGV2YW50IGtleXdvcmRzIG9mIHRoZSBxdWVz
dGlvbiBvciBhbnN3ZXIuJm5ic3A7IEZvciBwcml2YXRlIGlucXVpcmllcyBhYm91dCBodHRwZCBt
b2R1bGUgYXV0aG9yaW5nIHVuZGVyIHlvdXIgc3VwcG9ydCBlbmdhZ2VtZW50LCBwbGVhc2UgY29u
dGludWUgdG8gdXNlDQo8YSBocmVmPSJtYWlsdG86d3Jvd2VAcGl2b3RhbC5pbyI+d3Jvd2VAcGl2
b3RhbC5pbzwvYT4sIGJ1dCBJJ20gY2VydGFpbmx5IGhhcHB5IHRvIHB1YmxpY2x5IGFuc3dlciBx
dWVzdGlvbnMgaWYgeW91IGxpa2UgLSB0aGlzIGJlY29tZXMgaW50ZXJlc3Rpbmcgd2hlbiB0aGVy
ZSBpcyBhIHByb2JhYmxlIGRlc2lnbiBkZWZlY3QgZm9yIHRoZSBlbnRpcmUgZGV2QCB0ZWFtIHRv
IGNvbnNpZGVyLl08bzpwPjwvbzpwPjwvcD4NCjwvZGl2Pg0KPGRpdj4NCjxwIGNsYXNzPSJNc29O
b3JtYWwiIHN0eWxlPSJtYXJnaW4tbGVmdDouNWluIj48bzpwPiZuYnNwOzwvbzpwPjwvcD4NCjwv
ZGl2Pg0KPGRpdj4NCjxwIGNsYXNzPSJNc29Ob3JtYWwiIHN0eWxlPSJtYXJnaW4tbGVmdDouNWlu
Ij48bzpwPiZuYnNwOzwvbzpwPjwvcD4NCjwvZGl2Pg0KPC9kaXY+DQo8ZGl2Pg0KPHAgY2xhc3M9
Ik1zb05vcm1hbCIgc3R5bGU9Im1hcmdpbi1sZWZ0Oi41aW4iPjxvOnA+Jm5ic3A7PC9vOnA+PC9w
Pg0KPGRpdj4NCjxwIGNsYXNzPSJNc29Ob3JtYWwiIHN0eWxlPSJtYXJnaW4tbGVmdDouNWluIj5P
biBUaHUsIE9jdCAyOSwgMjAxNSBhdCAyOjMyIFBNLCBQQU4sIEpJTiAmbHQ7PGEgaHJlZj0ibWFp
bHRvOkppbi5QYW5AZm1yLmNvbSIgdGFyZ2V0PSJfYmxhbmsiPkppbi5QYW5AZm1yLmNvbTwvYT4m
Z3Q7IHdyb3RlOjxvOnA+PC9vOnA+PC9wPg0KPGRpdj4NCjxkaXY+DQo8cCBjbGFzcz0iTXNvTm9y
bWFsIiBzdHlsZT0ibXNvLW1hcmdpbi10b3AtYWx0OmF1dG87bXNvLW1hcmdpbi1ib3R0b20tYWx0
OmF1dG87bWFyZ2luLWxlZnQ6LjVpbiI+DQpIaSBCaWxsLDxvOnA+PC9vOnA+PC9wPg0KPHAgY2xh
c3M9Ik1zb05vcm1hbCIgc3R5bGU9Im1zby1tYXJnaW4tdG9wLWFsdDphdXRvO21zby1tYXJnaW4t
Ym90dG9tLWFsdDphdXRvO21hcmdpbi1sZWZ0Oi41aW4iPg0KJm5ic3A7PG86cD48L286cD48L3A+
DQo8cCBjbGFzcz0iTXNvTm9ybWFsIiBzdHlsZT0ibXNvLW1hcmdpbi10b3AtYWx0OmF1dG87bXNv
LW1hcmdpbi1ib3R0b20tYWx0OmF1dG87bWFyZ2luLWxlZnQ6LjVpbiI+DQpUaGlzIGlzIEppbiBm
cm9tIEZpZGVsaXR5LCBuZXcgSGFtcHNoaXJlIGNhbXB1cy4gVmVyeSBzb3JyeSBhYm91dCB0aGUg
ZG91YmxlIGVtYWlscywgSSB3YW50ZWQgdG8gbWFrZSBzdXJlIHRoaXMgZW1haWwgY2FuIGdldCB0
byB5b3UgZnJvbSBhbGwgYW5nbGVzLiBXZeKAmWQgZ3JlYXRseSBhcHByZWNpYXRlIGFueSBjb21t
ZW50cyBvbiB0aGlzIHByb2JsZW0gd2UgYXJlIHBlcnBsZXhlZCB3aXRoLjxvOnA+PC9vOnA+PC9w
Pg0KPHAgY2xhc3M9Ik1zb05vcm1hbCIgc3R5bGU9Im1zby1tYXJnaW4tdG9wLWFsdDphdXRvO21z
by1tYXJnaW4tYm90dG9tLWFsdDphdXRvO21hcmdpbi1sZWZ0Oi41aW4iPg0KJm5ic3A7PG86cD48
L286cD48L3A+DQo8cCBjbGFzcz0iTXNvTm9ybWFsIiBzdHlsZT0ibXNvLW1hcmdpbi10b3AtYWx0
OmF1dG87bXNvLW1hcmdpbi1ib3R0b20tYWx0OmF1dG87bWFyZ2luLWxlZnQ6LjVpbiI+DQpUaGUg
aXNzdWUgaXMgcmVnYXJkaW5nIHRoZSBBcGFjaGUgJmx0O0RpcmVjdG9yeSZndDsgbWVyZ2luZy4g
V2Ugd2FudCB0byBjb25zdHJ1Y3QgYSBicmVhZGNydW1iIHRyYWlsIGZyb20gbXVsdGlwbGUgJmx0
O0RpcmVjdG9yeSZndDsgY29udGV4dHMgZm9yIGVhY2ggcmVxdWVzdCBhcyBiZWxvdy4gV2UgdHJp
ZWQgdG8gdXNlIHRoZSBkaXJlY3RvcnkgbWVyZ2UgZnVuY3Rpb24gdG8gY29uY2F0ZW5hdGUgZGlm
ZmVyZW50IGNvbnRleHQgYXMgdGhlIG1lcmdlIGZ1bmN0aW9uDQogaXMgaW52b2tlZCBieSBBcGFj
aGUgYXMgaXQgd2Fsa3MgdG8gZXZlcnkgJmx0O0RpcmVjdG9yeSZndDsgYmxvY2suIFdlIG9ic2Vy
dmVkIHRoYXQgQXBhY2hlIGRvZXMgbm90IHByb3ZpZGUgdGhlIEJBU0UgYW5kIE5FVyBwb2ludGVy
IGNvbnRlbnQgdG8gdGhlIG1lcmdlIGhvb2sgZm9yICZsdDtEaXJlY3RvcnkmZ3Q7LCBzbyB0aGF0
IGF0IHRoZSBlbmQgb2YgdGhlIGxhc3QgJmx0O0RpcmVjdG9yeSZndDsgYmxvY2ssIHdlIGFyZSB1
bmFibGUgdG8gZ2V0IGEgY29tYmluZWQg4oCcLzovZm9vOi9mb28vYmFy4oCdDQogdHJhaWwgcmVz
dWx0LiBIb3dldmVyLCB0aGUgc2FtZSBtZXJnZSBob29rIGRvZXMgZ2V0IHRoZSBCQVNFIGFuZCBO
RVcgcG9pbnRlciBjb250ZW50IGZvciAmbHQ7TG9jYXRpb24mZ3Q7IGJsb2NrcywgZm9yIHdoaWNo
IHdlIGRvIHNlZSB0aGUgZGVzaXJlZCBjb21iaW5hdGlvbiB0cmFpbCBhZnRlciBhbGwgJmx0O0xv
Y2F0aW9uJmd0OyBibG9ja3MuPG86cD48L286cD48L3A+DQo8cCBjbGFzcz0iTXNvTm9ybWFsIiBz
dHlsZT0ibXNvLW1hcmdpbi10b3AtYWx0OmF1dG87bXNvLW1hcmdpbi1ib3R0b20tYWx0OmF1dG87
bWFyZ2luLWxlZnQ6LjVpbiI+DQombmJzcDs8bzpwPjwvbzpwPjwvcD4NCjxwIGNsYXNzPSJNc29O
b3JtYWwiIHN0eWxlPSJtc28tbWFyZ2luLXRvcC1hbHQ6YXV0bzttc28tbWFyZ2luLWJvdHRvbS1h
bHQ6YXV0bzttYXJnaW4tbGVmdDouNWluIj4NClF1ZXN0aW9uIGlzLCBpcyB0aGVyZSBhbnkgd2F5
IHRvIG1lcmdlIHRoZSBkaWZmZXJlbnQgJmx0O0RpcmVjdG9yeSZndDsgY29udGV4dCB0b2dldGhl
cj88bzpwPjwvbzpwPjwvcD4NCjxwIGNsYXNzPSJNc29Ob3JtYWwiIHN0eWxlPSJtc28tbWFyZ2lu
LXRvcC1hbHQ6YXV0bzttc28tbWFyZ2luLWJvdHRvbS1hbHQ6YXV0bzttYXJnaW4tbGVmdDouNWlu
Ij4NCiZuYnNwOzxvOnA+PC9vOnA+PC9wPg0KPHAgY2xhc3M9Ik1zb05vcm1hbCIgc3R5bGU9Im1z
by1tYXJnaW4tdG9wLWFsdDphdXRvO21zby1tYXJnaW4tYm90dG9tLWFsdDphdXRvO21hcmdpbi1s
ZWZ0Oi41aW4iPg0KQ29uZmlnOjxvOnA+PC9vOnA+PC9wPg0KPHAgY2xhc3M9Ik1zb05vcm1hbCIg
c3R5bGU9Im1zby1tYXJnaW4tdG9wLWFsdDphdXRvO21zby1tYXJnaW4tYm90dG9tLWFsdDphdXRv
O21hcmdpbi1sZWZ0Oi41aW4iPg0KJm5ic3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7
Jm5ic3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7ICZs
dDtEaXJlY3RvcnkgL2ZvbyZndDs8bzpwPjwvbzpwPjwvcD4NCjxwIGNsYXNzPSJNc29Ob3JtYWwi
IHN0eWxlPSJtc28tbWFyZ2luLXRvcC1hbHQ6YXV0bzttc28tbWFyZ2luLWJvdHRvbS1hbHQ6YXV0
bzttYXJnaW4tbGVmdDouNWluIj4NCiZuYnNwOyZuYnNwOyZuYnNwOyZuYnNwOyZuYnNwOyZuYnNw
OyZuYnNwOyZuYnNwOyZuYnNwOyZuYnNwOyZuYnNwOyZuYnNwOyZuYnNwOyZuYnNwOyZuYnNwOyAm
bmJzcDsmbmJzcDsmbmJzcDsgSGVhZGVyIG1lcmdlIHNvbWVIZWFkZXIgJnF1b3Q7L2ZvbyZxdW90
OyA8c3BhbiBzdHlsZT0iZm9udC1mYW1pbHk6V2luZ2RpbmdzIj4NCsOfPC9zcGFuPiBtb2RfaGVh
ZGVycyBzZWVtcyB0byBzdWZmZXIgdGhlIHNhbWUsIG5vIEJBU0Ugb3IgTkVXIHRvIG1lcmdlIHdp
dGg8bzpwPjwvbzpwPjwvcD4NCjxwIGNsYXNzPSJNc29Ob3JtYWwiIHN0eWxlPSJtc28tbWFyZ2lu
LXRvcC1hbHQ6YXV0bzttc28tbWFyZ2luLWJvdHRvbS1hbHQ6YXV0bzttYXJnaW4tbGVmdDouNWlu
Ij4NCiZuYnNwOyZuYnNwOyZuYnNwOyZuYnNwOyZuYnNwOyZuYnNwOyZuYnNwOyZuYnNwOyZuYnNw
OyZuYnNwOyZuYnNwOyZuYnNwOyZuYnNwOyZuYnNwOyZuYnNwOyAmbmJzcDsmbmJzcDsmbmJzcDsg
ZGlyQ29uZmlnIC9mb288bzpwPjwvbzpwPjwvcD4NCjxwIGNsYXNzPSJNc29Ob3JtYWwiIHN0eWxl
PSJtc28tbWFyZ2luLXRvcC1hbHQ6YXV0bzttc28tbWFyZ2luLWJvdHRvbS1hbHQ6YXV0bzttYXJn
aW4tbGVmdDouNWluIj4NCiZuYnNwOyZuYnNwOyZuYnNwOyZuYnNwOyZuYnNwOyZuYnNwOyZuYnNw
OyZuYnNwOyZuYnNwOyZuYnNwOyZuYnNwOyZuYnNwOyZuYnNwOyZuYnNwOyZuYnNwOyAmbHQ7L0Rp
cmVjdG9yeSZndDs8bzpwPjwvbzpwPjwvcD4NCjxwIGNsYXNzPSJNc29Ob3JtYWwiIHN0eWxlPSJt
c28tbWFyZ2luLXRvcC1hbHQ6YXV0bzttc28tbWFyZ2luLWJvdHRvbS1hbHQ6YXV0bzttYXJnaW4t
bGVmdDouNWluIj4NCiZuYnNwOzxvOnA+PC9vOnA+PC9wPg0KPHAgY2xhc3M9Ik1zb05vcm1hbCIg
c3R5bGU9Im1zby1tYXJnaW4tdG9wLWFsdDphdXRvO21zby1tYXJnaW4tYm90dG9tLWFsdDphdXRv
O21hcmdpbi1sZWZ0Oi41aW4iPg0KJm5ic3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7
Jm5ic3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7ICZs
dDtEaXJlY3RvcnkgLyZndDs8bzpwPjwvbzpwPjwvcD4NCjxwIGNsYXNzPSJNc29Ob3JtYWwiIHN0
eWxlPSJtc28tbWFyZ2luLXRvcC1hbHQ6YXV0bzttc28tbWFyZ2luLWJvdHRvbS1hbHQ6YXV0bztt
YXJnaW4tbGVmdDouNWluIj4NCiZuYnNwOyZuYnNwOyZuYnNwOyZuYnNwOyZuYnNwOyZuYnNwOyZu
YnNwOyZuYnNwOyZuYnNwOyZuYnNwOyZuYnNwOyZuYnNwOyZuYnNwOyZuYnNwOyZuYnNwOyAmbmJz
cDsmbmJzcDsmbmJzcDsgSGVhZGVyIG1lcmdlIHNvbWVIZWFkZXIgJnF1b3Q7LyZxdW90OzxvOnA+
PC9vOnA+PC9wPg0KPHAgY2xhc3M9Ik1zb05vcm1hbCIgc3R5bGU9Im1zby1tYXJnaW4tdG9wLWFs
dDphdXRvO21zby1tYXJnaW4tYm90dG9tLWFsdDphdXRvO21hcmdpbi1sZWZ0Oi41aW4iPg0KJm5i
c3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7
Jm5ic3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7ICZuYnNwOyZuYnNwOyZuYnNwOyBkaXJDb25m
aWcgLzxvOnA+PC9vOnA+PC9wPg0KPHAgY2xhc3M9Ik1zb05vcm1hbCIgc3R5bGU9Im1zby1tYXJn
aW4tdG9wLWFsdDphdXRvO21zby1tYXJnaW4tYm90dG9tLWFsdDphdXRvO21hcmdpbi1sZWZ0Oi41
aW4iPg0KJm5ic3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7Jm5i
c3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7ICZsdDsvRGlyZWN0b3J5Jmd0
OzxvOnA+PC9vOnA+PC9wPg0KPHAgY2xhc3M9Ik1zb05vcm1hbCIgc3R5bGU9Im1zby1tYXJnaW4t
dG9wLWFsdDphdXRvO21zby1tYXJnaW4tYm90dG9tLWFsdDphdXRvO21hcmdpbi1sZWZ0Oi41aW4i
Pg0KJm5ic3A7PG86cD48L286cD48L3A+DQo8cCBjbGFzcz0iTXNvTm9ybWFsIiBzdHlsZT0ibXNv
LW1hcmdpbi10b3AtYWx0OmF1dG87bXNvLW1hcmdpbi1ib3R0b20tYWx0OmF1dG87bWFyZ2luLWxl
ZnQ6LjVpbiI+DQombmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJz
cDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsgJmx0O0RpcmVjdG9y
eSAvZm9vL2JhciZndDs8bzpwPjwvbzpwPjwvcD4NCjxwIGNsYXNzPSJNc29Ob3JtYWwiIHN0eWxl
PSJtc28tbWFyZ2luLXRvcC1hbHQ6YXV0bzttc28tbWFyZ2luLWJvdHRvbS1hbHQ6YXV0bzttYXJn
aW4tbGVmdDouNWluIj4NCiZuYnNwOyZuYnNwOyZuYnNwOyZuYnNwOyZuYnNwOyZuYnNwOyZuYnNw
OyZuYnNwOyZuYnNwOyZuYnNwOyZuYnNwOyZuYnNwOyZuYnNwOyZuYnNwOyZuYnNwOyAmbmJzcDsm
bmJzcDsmbmJzcDsgSGVhZGVyIG1lcmdlIHNvbWVIZWFkZXIgJnF1b3Q7L2Zvby9iYXImcXVvdDs8
bzpwPjwvbzpwPjwvcD4NCjxwIGNsYXNzPSJNc29Ob3JtYWwiIHN0eWxlPSJtc28tbWFyZ2luLXRv
cC1hbHQ6YXV0bzttc28tbWFyZ2luLWJvdHRvbS1hbHQ6YXV0bzttYXJnaW4tbGVmdDouNWluIj4N
CiZuYnNwOyZuYnNwOyZuYnNwOyZuYnNwOyZuYnNwOyZuYnNwOyZuYnNwOyZuYnNwOyZuYnNwOyZu
YnNwOyZuYnNwOyZuYnNwOyZuYnNwOyZuYnNwOyZuYnNwOyAmbmJzcDsmbmJzcDsmbmJzcDsgZGly
Q29uZmlnIC9mb28vYmFyPG86cD48L286cD48L3A+DQo8cCBjbGFzcz0iTXNvTm9ybWFsIiBzdHls
ZT0ibXNvLW1hcmdpbi10b3AtYWx0OmF1dG87bXNvLW1hcmdpbi1ib3R0b20tYWx0OmF1dG87bWFy
Z2luLWxlZnQ6LjVpbiI+DQombmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJz
cDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsgJmx0Oy9E
aXJlY3RvcnkmZ3Q7PG86cD48L286cD48L3A+DQo8cCBjbGFzcz0iTXNvTm9ybWFsIiBzdHlsZT0i
bXNvLW1hcmdpbi10b3AtYWx0OmF1dG87bXNvLW1hcmdpbi1ib3R0b20tYWx0OmF1dG87bWFyZ2lu
LWxlZnQ6LjVpbiI+DQombmJzcDs8bzpwPjwvbzpwPjwvcD4NCjxwIGNsYXNzPSJNc29Ob3JtYWwi
IHN0eWxlPSJtc28tbWFyZ2luLXRvcC1hbHQ6YXV0bzttc28tbWFyZ2luLWJvdHRvbS1hbHQ6YXV0
bzttYXJnaW4tbGVmdDouNWluIj4NClNvbWUgY29kZSBzbmlwcGV0IHRvIGV4cGxhaW4gd2hhdCB3
ZeKAmXJlIGRvaW5n4oCmPG86cD48L286cD48L3A+DQo8cCBjbGFzcz0iTXNvTm9ybWFsIiBzdHls
ZT0ibXNvLW1hcmdpbi10b3AtYWx0OmF1dG87bXNvLW1hcmdpbi1ib3R0b20tYWx0OmF1dG87bWFy
Z2luLWxlZnQ6LjVpbiI+DQombmJzcDs8bzpwPjwvbzpwPjwvcD4NCjxwIGNsYXNzPSJNc29Ob3Jt
YWwiIHN0eWxlPSJtc28tbWFyZ2luLXRvcC1hbHQ6YXV0bzttc28tbWFyZ2luLWJvdHRvbS1hbHQ6
YXV0bzttYXJnaW4tbGVmdDouNWluIj4NCiZuYnNwOyZuYnNwOyZuYnNwOyZuYnNwOyZuYnNwOyZu
YnNwOyZuYnNwOyZuYnNwOyZuYnNwOyZuYnNwOyZuYnNwOyZuYnNwOyZuYnNwOyZuYnNwOyZuYnNw
OyBBUF9ERUNMQVJFX01PRFVMRShkaXJjb25maWcpID08bzpwPjwvbzpwPjwvcD4NCjxwIGNsYXNz
PSJNc29Ob3JtYWwiIHN0eWxlPSJtc28tbWFyZ2luLXRvcC1hbHQ6YXV0bzttc28tbWFyZ2luLWJv
dHRvbS1hbHQ6YXV0bzttYXJnaW4tbGVmdDouNWluIj4NCiZuYnNwOyZuYnNwOyZuYnNwOyZuYnNw
OyZuYnNwOyZuYnNwOyZuYnNwOyZuYnNwOyZuYnNwOyZuYnNwOyZuYnNwOyZuYnNwOyZuYnNwOyZu
YnNwOyZuYnNwOyB7PG86cD48L286cD48L3A+DQo8cCBjbGFzcz0iTXNvTm9ybWFsIiBzdHlsZT0i
bXNvLW1hcmdpbi10b3AtYWx0OmF1dG87bXNvLW1hcmdpbi1ib3R0b20tYWx0OmF1dG87bWFyZ2lu
LWxlZnQ6LjVpbiI+DQombmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsm
bmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsgJm5ic3A7Jm5i
c3A7Jm5ic3A7IFNUQU5EQVJEMjBfTU9EVUxFX1NUVUZGLDxvOnA+PC9vOnA+PC9wPg0KPHAgY2xh
c3M9Ik1zb05vcm1hbCIgc3R5bGU9Im1zby1tYXJnaW4tdG9wLWFsdDphdXRvO21zby1tYXJnaW4t
Ym90dG9tLWFsdDphdXRvO21hcmdpbi1sZWZ0Oi41aW4iPg0KJm5ic3A7Jm5ic3A7Jm5ic3A7Jm5i
c3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7
Jm5ic3A7Jm5ic3A7ICZuYnNwOyZuYnNwOyZuYnNwOyBjcmVhdGVfZGlyLDxvOnA+PC9vOnA+PC9w
Pg0KPHAgY2xhc3M9Ik1zb05vcm1hbCIgc3R5bGU9Im1zby1tYXJnaW4tdG9wLWFsdDphdXRvO21z
by1tYXJnaW4tYm90dG9tLWFsdDphdXRvO21hcmdpbi1sZWZ0Oi41aW4iPg0KJm5ic3A7Jm5ic3A7
Jm5ic3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7Jm5i
c3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7ICZuYnNwOyZuYnNwOyZuYnNwOyBtZXJnZV9kaXIsPG86cD48
L286cD48L3A+DQo8cCBjbGFzcz0iTXNvTm9ybWFsIiBzdHlsZT0ibXNvLW1hcmdpbi10b3AtYWx0
OmF1dG87bXNvLW1hcmdpbi1ib3R0b20tYWx0OmF1dG87bWFyZ2luLWxlZnQ6LjVpbiI+DQombmJz
cDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsm
bmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsgJm5ic3A7Jm5ic3A7Jm5ic3A7IE5VTEwsPG86
cD48L286cD48L3A+DQo8cCBjbGFzcz0iTXNvTm9ybWFsIiBzdHlsZT0ibXNvLW1hcmdpbi10b3At
YWx0OmF1dG87bXNvLW1hcmdpbi1ib3R0b20tYWx0OmF1dG87bWFyZ2luLWxlZnQ6LjVpbiI+DQom
bmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJz
cDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsgJm5ic3A7Jm5ic3A7Jm5ic3A7IE5VTEws
PG86cD48L286cD48L3A+DQo8cCBjbGFzcz0iTXNvTm9ybWFsIiBzdHlsZT0ibXNvLW1hcmdpbi10
b3AtYWx0OmF1dG87bXNvLW1hcmdpbi1ib3R0b20tYWx0OmF1dG87bWFyZ2luLWxlZnQ6LjVpbiI+
DQombmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsm
bmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsgJm5ic3A7Jm5ic3A7Jm5ic3A7IGNt
ZHMsPG86cD48L286cD48L3A+DQo8cCBjbGFzcz0iTXNvTm9ybWFsIiBzdHlsZT0ibXNvLW1hcmdp
bi10b3AtYWx0OmF1dG87bXNvLW1hcmdpbi1ib3R0b20tYWx0OmF1dG87bWFyZ2luLWxlZnQ6LjVp
biI+DQombmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJz
cDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsgJm5ic3A7Jm5ic3A7Jm5ic3A7
IHJlZ2lzdGVyX2hvb2tzPG86cD48L286cD48L3A+DQo8cCBjbGFzcz0iTXNvTm9ybWFsIiBzdHls
ZT0ibXNvLW1hcmdpbi10b3AtYWx0OmF1dG87bXNvLW1hcmdpbi1ib3R0b20tYWx0OmF1dG87bWFy
Z2luLWxlZnQ6LjVpbiI+DQombmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJz
cDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsgfTs8bzpw
PjwvbzpwPjwvcD4NCjxwIGNsYXNzPSJNc29Ob3JtYWwiIHN0eWxlPSJtc28tbWFyZ2luLXRvcC1h
bHQ6YXV0bzttc28tbWFyZ2luLWJvdHRvbS1hbHQ6YXV0bzttYXJnaW4tbGVmdDouNWluIj4NCiZu
YnNwOzxvOnA+PC9vOnA+PC9wPg0KPHAgY2xhc3M9Ik1zb05vcm1hbCIgc3R5bGU9Im1zby1tYXJn
aW4tdG9wLWFsdDphdXRvO21zby1tYXJnaW4tYm90dG9tLWFsdDphdXRvO21hcmdpbi1sZWZ0Oi41
aW4iPg0KJm5ic3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7Jm5i
c3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7IHR5cGVkZWYgc3RydWN0PG86
cD48L286cD48L3A+DQo8cCBjbGFzcz0iTXNvTm9ybWFsIiBzdHlsZT0ibXNvLW1hcmdpbi10b3At
YWx0OmF1dG87bXNvLW1hcmdpbi1ib3R0b20tYWx0OmF1dG87bWFyZ2luLWxlZnQ6LjVpbiI+DQom
bmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJz
cDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsgezxvOnA+PC9vOnA+PC9wPg0KPHAgY2xh
c3M9Ik1zb05vcm1hbCIgc3R5bGU9Im1zby1tYXJnaW4tdG9wLWFsdDphdXRvO21zby1tYXJnaW4t
Ym90dG9tLWFsdDphdXRvO21hcmdpbi1sZWZ0Oi41aW4iPg0KJm5ic3A7Jm5ic3A7Jm5ic3A7Jm5i
c3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7
Jm5ic3A7Jm5ic3A7ICZuYnNwOyZuYnNwOyZuYnNwOyBjaGFyKiBjeHQ7PG86cD48L286cD48L3A+
DQo8cCBjbGFzcz0iTXNvTm9ybWFsIiBzdHlsZT0ibXNvLW1hcmdpbi10b3AtYWx0OmF1dG87bXNv
LW1hcmdpbi1ib3R0b20tYWx0OmF1dG87bWFyZ2luLWxlZnQ6LjVpbiI+DQombmJzcDsmbmJzcDsm
bmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJz
cDsmbmJzcDsmbmJzcDsmbmJzcDsgfSBzY2ZnOzxvOnA+PC9vOnA+PC9wPg0KPHAgY2xhc3M9Ik1z
b05vcm1hbCIgc3R5bGU9Im1zby1tYXJnaW4tdG9wLWFsdDphdXRvO21zby1tYXJnaW4tYm90dG9t
LWFsdDphdXRvO21hcmdpbi1sZWZ0Oi41aW4iPg0KJm5ic3A7PG86cD48L286cD48L3A+DQo8cCBj
bGFzcz0iTXNvTm9ybWFsIiBzdHlsZT0ibXNvLW1hcmdpbi10b3AtYWx0OmF1dG87bXNvLW1hcmdp
bi1ib3R0b20tYWx0OmF1dG87bWFyZ2luLWxlZnQ6LjVpbiI+DQombmJzcDsmbmJzcDsmbmJzcDsm
bmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJz
cDsmbmJzcDsmbmJzcDsgc3RhdGljIHZvaWQgKm1lcmdlX2RpcihhcHJfcG9vbF90ICpwb29sLCB2
b2lkICpCQVNFLCB2b2lkICpORVcpPG86cD48L286cD48L3A+DQo8cCBjbGFzcz0iTXNvTm9ybWFs
IiBzdHlsZT0ibXNvLW1hcmdpbi10b3AtYWx0OmF1dG87bXNvLW1hcmdpbi1ib3R0b20tYWx0OmF1
dG87bWFyZ2luLWxlZnQ6LjVpbiI+DQombmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJz
cDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsg
ezxvOnA+PC9vOnA+PC9wPg0KPHAgY2xhc3M9Ik1zb05vcm1hbCIgc3R5bGU9Im1zby1tYXJnaW4t
dG9wLWFsdDphdXRvO21zby1tYXJnaW4tYm90dG9tLWFsdDphdXRvO21hcmdpbi1sZWZ0Oi41aW4i
Pg0KJm5ic3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7
Jm5ic3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7ICZuYnNwOyZuYnNwOyZuYnNwOyBz
Y2ZnICptID0gYXByX3BjYWxsb2MocG9vbCwgc2l6ZW9mKCptKSk7PG86cD48L286cD48L3A+DQo8
cCBjbGFzcz0iTXNvTm9ybWFsIiBzdHlsZT0ibXNvLW1hcmdpbi10b3AtYWx0OmF1dG87bXNvLW1h
cmdpbi1ib3R0b20tYWx0OmF1dG87bWFyZ2luLWxlZnQ6LjVpbiI+DQombmJzcDsmbmJzcDsmbmJz
cDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsm
bmJzcDsmbmJzcDsmbmJzcDsgJm5ic3A7Jm5ic3A7Jm5ic3A7IHNjZmcgKnAgPSBCQVNFOyA8c3Bh
biBzdHlsZT0iZm9udC1mYW1pbHk6V2luZ2RpbmdzO2NvbG9yOnJlZCI+DQrDnzwvc3Bhbj48c3Bh
biBzdHlsZT0iY29sb3I6cmVkIj5wb2ludHMgdG8gdGhlIHByb3BlciDigJwvZm9vL2JhcuKAnSBj
b250ZW50IGlmIGluICZsdDtMb2NhdGlvbiZndDsgYnV0IGVtcHR5IGlmIGluICZsdDtEaXJlY3Rv
cnkmZ3Q7IFdoeT88L3NwYW4+PG86cD48L286cD48L3A+DQo8cCBjbGFzcz0iTXNvTm9ybWFsIiBz
dHlsZT0ibXNvLW1hcmdpbi10b3AtYWx0OmF1dG87bXNvLW1hcmdpbi1ib3R0b20tYWx0OmF1dG87
bWFyZ2luLWxlZnQ6LjVpbiI+DQombmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsm
bmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsgJm5i
c3A7Jm5ic3A7Jm5ic3A7IHNjZmcgKmMgPSBORVc7PG86cD48L286cD48L3A+DQo8cCBjbGFzcz0i
TXNvTm9ybWFsIiBzdHlsZT0ibXNvLW1hcmdpbi10b3AtYWx0OmF1dG87bXNvLW1hcmdpbi1ib3R0
b20tYWx0OmF1dG87bWFyZ2luLWxlZnQ6LjVpbiI+DQombmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsm
bmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJz
cDsmbmJzcDsgPG86cD48L286cD48L3A+DQo8cCBjbGFzcz0iTXNvTm9ybWFsIiBzdHlsZT0ibXNv
LW1hcmdpbi10b3AtYWx0OmF1dG87bXNvLW1hcmdpbi1ib3R0b20tYWx0OmF1dG87bWFyZ2luLWxl
ZnQ6LjVpbiI+DQombmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJz
cDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsgJm5ic3A7Jm5ic3A7
Jm5ic3A7IG0tJmd0O2N4dCA9IGFwcl9wc3RyY2F0KHBvb2wsIHAtJmd0O2N4dCwgJnF1b3Q7OiZx
dW90OywgYy0mZ3Q7Y3h0LCBOVUxMKTsgPG86cD48L286cD48L3A+DQo8cCBjbGFzcz0iTXNvTm9y
bWFsIiBzdHlsZT0ibXNvLW1hcmdpbi10b3AtYWx0OmF1dG87bXNvLW1hcmdpbi1ib3R0b20tYWx0
OmF1dG87bWFyZ2luLWxlZnQ6LjVpbiI+DQombmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsm
bmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJz
cDsgPG86cD48L286cD48L3A+DQo8cCBjbGFzcz0iTXNvTm9ybWFsIiBzdHlsZT0ibXNvLW1hcmdp
bi10b3AtYWx0OmF1dG87bXNvLW1hcmdpbi1ib3R0b20tYWx0OmF1dG87bWFyZ2luLWxlZnQ6LjVp
biI+DQombmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJz
cDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsmbmJzcDsgJm5ic3A7Jm5ic3A7Jm5ic3A7
IHJldHVybiBtOzxvOnA+PC9vOnA+PC9wPg0KPHAgY2xhc3M9Ik1zb05vcm1hbCIgc3R5bGU9Im1z
by1tYXJnaW4tdG9wLWFsdDphdXRvO21zby1tYXJnaW4tYm90dG9tLWFsdDphdXRvO21hcmdpbi1s
ZWZ0Oi41aW4iPg0KJm5ic3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7Jm5i
c3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7Jm5ic3A7IH08bzpwPjwvbzpw
PjwvcD4NCjxwIGNsYXNzPSJNc29Ob3JtYWwiIHN0eWxlPSJtc28tbWFyZ2luLXRvcC1hbHQ6YXV0
bzttc28tbWFyZ2luLWJvdHRvbS1hbHQ6YXV0bzttYXJnaW4tbGVmdDouNWluIj4NCiZuYnNwOzxv
OnA+PC9vOnA+PC9wPg0KPHAgY2xhc3M9Ik1zb05vcm1hbCIgc3R5bGU9Im1zby1tYXJnaW4tdG9w
LWFsdDphdXRvO21zby1tYXJnaW4tYm90dG9tLWFsdDphdXRvO21hcmdpbi1sZWZ0Oi41aW4iPg0K
VGhhbmsgeW91ITxvOnA+PC9vOnA+PC9wPg0KPHAgY2xhc3M9Ik1zb05vcm1hbCIgc3R5bGU9Im1z
by1tYXJnaW4tdG9wLWFsdDphdXRvO21zby1tYXJnaW4tYm90dG9tLWFsdDphdXRvO21hcmdpbi1s
ZWZ0Oi41aW4iPg0KPHNwYW4gc3R5bGU9ImNvbG9yOiM4ODg4ODgiPkppbjxvOnA+PC9vOnA+PC9z
cGFuPjwvcD4NCjwvZGl2Pg0KPC9kaXY+DQo8L2Rpdj4NCjxwIGNsYXNzPSJNc29Ob3JtYWwiIHN0
eWxlPSJtYXJnaW4tbGVmdDouNWluIj48bzpwPiZuYnNwOzwvbzpwPjwvcD4NCjwvZGl2Pg0KPC9k
aXY+DQo8L2JvZHk+DQo8L2h0bWw+DQo=

--_000_adfc9e96fd3d41d88ff3059182439031MSGRTP1DAG01ADMN1FMRcom_--

--_004_adfc9e96fd3d41d88ff3059182439031MSGRTP1DAG01ADMN1FMRcom_
Content-Type: application/octet-stream; name="dir-config-tar"
Content-Description: dir-config-tar
Content-Disposition: attachment; filename="dir-config-tar"; size=10240;
	creation-date="Fri, 30 Oct 2015 22:11:19 GMT";
	modification-date="Fri, 30 Oct 2015 22:10:44 GMT"
Content-Transfer-Encoding: base64

bWFrZWZpbGUtZGlyY29uZmlnAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAwMDA2NDQAMDA2Nzcw
MgAwMDAwMTQ0ADAwMDAwMDAwMzUzADEyNjEyNzI3NDUyADAxMzM2NgAgMAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB1c3RhciAgAGEyNDgyMTQAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAdXNlcnMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABB
UEFDSEVfRElSIDo9IC91c3IvbG9jYWwvYXBhY2hlMgpBUEFDSEVfSU5DX0RJUiA6PSAtSSQoQVBB
Q0hFX0RJUikvaW5jbHVkZSAjLUkkKEFQQUNIRV9ESVIpL2luY2x1ZGUvYXByLTEKQ0NGTEFHUyA6
PSAtZzMgLW0zMiAtcHRocmVhZCAtc2hhcmVkCmFsbDogbW9kRGlyQ29uZmlnLmNwcAoJZysrICQo
Q0NGTEFHUykgLW8gbW9kRGlyQ29uZmlnLnNvICQoQVBBQ0hFX0lOQ19ESVIpIG1vZERpckNvbmZp
Zy5jcHAKAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAG1v
ZERpckNvbmZpZy5jcHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwMDAwNjQ0ADAwNjc3MDIA
MDAwMDE0NAAwMDAwMDAxMjA0NAAxMjYxNDc2NDM0MgAwMTI3NzUAIDAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAdXN0YXIgIABhMjQ4MjE0AAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAHVzZXJzAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAALyoK
ICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKgogKgogKiBAKCMpIG1vZERpckNvbmZpZy5jcHAgCiAqCiAq
IENvcHlyaWdodCAyMDE1LCBGTVIgQ29ycC4gQWxsIHJpZ2h0cyByZXNlcnZlZC4KICogRmlkZWxp
dHkgQ29uZmlkZW50aWFsIEluZm9ybWF0aW9uCiAqCiAqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioKICov
CgojaW5jbHVkZSA8aHR0cGQuaD4KCiNpbmNsdWRlIDxhcF9jb25maWcuaD4KI2luY2x1ZGUgPGFw
cl9wb29scy5oPgoKI2luY2x1ZGUgPGh0dHBfY29uZmlnLmg+CiNpbmNsdWRlIDxodHRwX3JlcXVl
c3QuaD4KI2luY2x1ZGUgPGh0dHBfbG9nLmg+CgojaW5jbHVkZSA8c3RyaW5nPgojaW5jbHVkZSA8
aW9zdHJlYW0+CgojaW5jbHVkZSA8YXNzZXJ0Lmg+CgpuYW1lc3BhY2UgdGVzdF8KewogICAgZXh0
ZXJuICJDIgogICAgewoJLyoqCgkgKiBBbiBBcGFjaGUgY29tcGF0aWJsZSB0eXBlIGZvciBkaXJl
Y3RvcnkgY29uZmlndXJhdGlvbiBjcmVhdGlvbi4KCSAqLwoJdHlwZWRlZiB2b2lkICogKCogZGly
Q29uZmlnX2RjX3QpICggYXByX3Bvb2xfdCAqIHAsIGNoYXIgKiBkaXIgKTsKCgkvKioKCSAqIEFu
IEFwYWNoZSBjb21wYXRpYmxlIHR5cGUgZm9yIGRpcmVjdG9yeSBjb25maWd1cmF0aW9uIG1lcmdp
bmcuCgkgKi8KCXR5cGVkZWYgdm9pZCAqICgqIGRpckNvbmZpZ19kbV90KSAoIGFwcl9wb29sX3Qg
KiBwb29sLAoJCQkJCSAgICB2b2lkICogYmFzZV9jb25mLAoJCQkJCSAgICB2b2lkICogbmV3X2Nv
bmYgKTsKCgkvKioKCSAqIEFuIEFwYWNoZSBjb21wYXRpYmxlIHR5cGUgZm9yIHNlcnZlciBjb25m
aWd1cmF0aW9uIGNyZWF0aW9uLgoJICovCgl0eXBlZGVmIHZvaWQgKiAoKiBkaXJDb25maWdfc2Nf
dCkgKCBhcHJfcG9vbF90ICogcG9vbCwKCQkJCQkgICAgc2VydmVyX3JlYyAqIHMgKTsKCgkvKioK
CSAqIEFuIEFwYWNoZSBjb21wYXRpYmxlIHR5cGUgZm9yIHNlcnZlciBjb25maWd1cmF0aW9uIG1l
cmdpbmcuCgkgKi8KCXR5cGVkZWYgdm9pZCAqICgqIGRpckNvbmZpZ19zbV90KSAoIGFwcl9wb29s
X3QgKiBwb29sLAoJCQkJCSAgICB2b2lkICogYmFzZV9jb25mLAoJCQkJCSAgICB2b2lkICogbmV3
X2NvbmYgKTsKCS8qKgoJICogQW4gQXBhY2hlIGNvbXBhdGlibGUgdHlwZSBmb3IgaG9vayByZWdp
c3RyYXRpb24uCgkgKi8KCXR5cGVkZWYgdm9pZCAoKiBkaXJDb25maWdfcmhfdCkoIGFwcl9wb29s
X3QgKiBwb29sICk7CiAgICB9IC8vIGV4dGVybiAiQyIKCiAgICB0eXBlZGVmIGFwcl9zdGF0dXNf
dCAoKiBSZXFIb29rRnVuY190KSAoIHJlcXVlc3RfcmVjICogciApOwogICAgCiAgICBjbGFzcyBk
aXJDb25maWcKICAgIHsKICAgIHB1YmxpYzoKCWRpckNvbmZpZygpOwoJdmlydHVhbCB+ZGlyQ29u
ZmlnKCk7CgoJc3RhdGljIHZvaWQgKiBjcmVhdGVfZGMoIGFwcl9wb29sX3QgKiBwb29sLCBjaGFy
ICogY29udGV4dCApOwoJc3RhdGljIHZvaWQgKiBtZXJnZV9kYyggYXByX3Bvb2xfdCAqIHBvb2ws
IHZvaWQgKiBwYXJlbnQsCgkJCQl2b2lkICogY2hpbGQgKTsKCglzdGQ6OnN0cmluZyAmIGdldENv
bnRleHQoKTsKCXZvaWQgc2V0Q29udGV4dCggc3RkOjpzdHJpbmcgJiBjb250ZXh0ICk7CgoJc3Rk
OjpzdHJpbmcgJiBnZXRNZXNzYWdlKCk7Cgl2b2lkIHNldE1lc3NhZ2UoIHN0ZDo6c3RyaW5nICYg
Y29udGV4dCApOwoJCglzdGF0aWMgY29uc3QgY2hhciAqIGluc2VydCggY21kX3Bhcm1zICogcGFy
bXMsIHZvaWQgKiBjb25maWcsCgkJCQkgICAgY29uc3QgY2hhciAqIGFyZ3MgKTsKCglzdGF0aWMg
YXByX3N0YXR1c190IGhvb2tGdW5jKCByZXF1ZXN0X3JlYyAqIHIgKTsKCXN0YXRpYyB2b2lkIHJl
Z2lzdGVySG9va3MoIGFwcl9wb29sX3QgKiBwb29sICk7CgkKICAgIHByaXZhdGU6CglzdGQ6OnN0
cmluZyBfY29udGV4dDsKCXN0ZDo6c3RyaW5nIF9tZXNzYWdlOwogICAgfTsKCiAgICBzdGF0aWMg
Y29uc3QgY29tbWFuZF9yZWMgZGlyQ29uZmlnRGlyZWN0aXZlc1tdID0KICAgIHsKCUFQX0lOSVRf
UkFXX0FSR1MoICJkaXJDb25maWciLCAoY21kX2Z1bmMpIHRlc3RfOjpkaXJDb25maWc6Omluc2Vy
dCwKCQkJICBOVUxMLCBBQ0NFU1NfQ09ORiB8IFJTUkNfQ09ORiwgIkluc2VydCBkaXJDb25maWci
ICksCgl7IE5VTEwgfQogICAgfTsKCiAgICBleHRlcm4gIkMiCiAgICB7CgkvKioKCSAqIFRoZSBB
cGFjaGUgbW9kdWxlIGRlY2xhcmF0aW9uIGZvciBXU1RLX0NQLgoJICovCglBUF9ERUNMQVJFX01P
RFVMRSggRGlyQ29uZmlnICkgPQoJewoJICAgIFNUQU5EQVJEMjBfTU9EVUxFX1NUVUZGLAoJICAg
IChkaXJDb25maWdfZGNfdCkgZGlyQ29uZmlnOjpjcmVhdGVfZGMsCgkgICAgKGRpckNvbmZpZ19k
bV90KSBkaXJDb25maWc6Om1lcmdlX2RjLAoJICAgIE5VTEwsCgkgICAgTlVMTCwKCSAgICBkaXJD
b25maWdEaXJlY3RpdmVzLAoJICAgIChkaXJDb25maWdfcmhfdCkgZGlyQ29uZmlnOjpyZWdpc3Rl
ckhvb2tzCgl9OwogICAgfSAvLyBleHRlcm4gIkMiCgogICAgZGlyQ29uZmlnOjpkaXJDb25maWco
KSA6IF9jb250ZXh0KCksIF9tZXNzYWdlKCkKICAgIHsKICAgIH0KCiAgICBkaXJDb25maWc6On5k
aXJDb25maWcoKQogICAgewogICAgfQoKICAgIHZvaWQgKiBkaXJDb25maWc6OmNyZWF0ZV9kYygg
YXByX3Bvb2xfdCAqIHBvb2wsIGNoYXIgKiBjb250ZXh0ICkKICAgIHsKCS8vIENyZWF0ZSB0aGUg
Y29uZmlndXJhdGlvbiBvYmplY3QuCglkaXJDb25maWcgKiBjZmcgPSBuZXcgZGlyQ29uZmlnKCk7
CglpZiAoTlVMTCA9PSBjZmcpCgl7CgkgICAgLy8gQW4gYWxsb2NhdGlvbiBlcnJvci4KCSAgICBy
ZXR1cm4gTlVMTDsKCX0KCgkvLyBLZWVwIHRoZSBjb250ZXh0IG5hbWUuCglzdGQ6OnN0cmluZyB0
ZW1wID0gInVuc2V0IjsKCglpZiAoTlVMTCAhPSBjb250ZXh0KQoJewoJICAgIHRlbXAgPSBjb250
ZXh0OwoJfQoJY2ZnLT5zZXRDb250ZXh0KCB0ZW1wICk7CgoJc3RkOjpjZXJyIDw8ICJDcmVhdGVk
IGRpckNvbmZpZyBmb3IgY29udGV4dDogIiA8PCB0ZW1wIDw8IHN0ZDo6ZW5kbDsKCXJldHVybiAo
dm9pZCAqKSBjZmc7CiAgICB9CgogICAgdm9pZCAqIGRpckNvbmZpZzo6bWVyZ2VfZGMoIGFwcl9w
b29sX3QgKiBwb29sLCB2b2lkICogcGFyZW50LAoJCQkJdm9pZCAqIGNoaWxkICkKICAgIHsKCWRp
ckNvbmZpZyAqIHAgPSAoZGlyQ29uZmlnICopIHBhcmVudDsKCWRpckNvbmZpZyAqIGMgPSAoZGly
Q29uZmlnICopIGNoaWxkOwoJZGlyQ29uZmlnICogbSA9IG5ldyBkaXJDb25maWcoKTsKCglhc3Nl
cnQoIE5VTEwgIT0gcCApOwoJYXNzZXJ0KCBOVUxMICE9IGMgKTsKCWFzc2VydCggTlVMTCAhPSBt
ICk7CgoJLy8gQ3JlYXRlIGEgYnJlYWQgY3J1bWIgY29udGV4dCBmb3IgdGhlIG1lcmdlZCBjb25m
aWd1cmF0aW9uLgoJc3RkOjpzdHJpbmcgY3RlbXAgPSBwLT5nZXRDb250ZXh0KCk7CgljdGVtcC5h
cHBlbmQoICI6IiApLmFwcGVuZCggYy0+Z2V0Q29udGV4dCgpICk7CgltLT5zZXRDb250ZXh0KCBj
dGVtcCApOwoKCS8vIFNldCB0aGUgbWVzc2FnZSB0byB0aGUgY2hpbGQgdmFsdWUuCgltLT5zZXRN
ZXNzYWdlKCBjLT5nZXRNZXNzYWdlKCkgKTsKCQoJc3RkOjpjZXJyIDw8ICJNZXJnZWQgY29uZmln
OiAiIDw8IGN0ZW1wIDw8IHN0ZDo6ZW5kbDsKCXJldHVybiAodm9pZCAqKSBtOwogICAgfQoKICAg
IHN0ZDo6c3RyaW5nICYgZGlyQ29uZmlnOjpnZXRDb250ZXh0KCkKICAgIHsKCXJldHVybiBfY29u
dGV4dDsKICAgIH0KCiAgICB2b2lkIGRpckNvbmZpZzo6c2V0Q29udGV4dCggc3RkOjpzdHJpbmcg
JiBjb250ZXh0ICkKICAgIHsKCV9jb250ZXh0ID0gY29udGV4dDsKICAgIH0KCiAgICBzdGQ6OnN0
cmluZyAmIGRpckNvbmZpZzo6Z2V0TWVzc2FnZSgpCiAgICB7CglyZXR1cm4gX21lc3NhZ2U7CiAg
ICB9CgogICAgdm9pZCBkaXJDb25maWc6OnNldE1lc3NhZ2UoIHN0ZDo6c3RyaW5nICYgbWVzc2Fn
ZSApCiAgICB7CglfbWVzc2FnZSA9IG1lc3NhZ2U7CiAgICB9CgogICAgY29uc3QgY2hhciAqIGRp
ckNvbmZpZzo6aW5zZXJ0KCBjbWRfcGFybXMgKiBwYXJtcywgdm9pZCAqIGNvbmZpZywKCQkJCSAg
ICBjb25zdCBjaGFyICogYXJncyApCiAgICB7CglpZiAoTlVMTCA9PSBwYXJtcykKCXsKCSAgICBy
ZXR1cm4gImluc2VydCBOVUxMIGNvbW1hbmQgcGFyYW1ldGVycyI7Cgl9CgoJaWYgKE5VTEwgPT0g
Y29uZmlnKQoJewoJICAgIHJldHVybiAiaW5zZXJ0IE5VTEwgY29uZmlndXJhdGlvbiI7Cgl9CgoJ
aWYgKChOVUxMID09IGFyZ3MpIHx8ICgoKiBhcmdzKSA9PSAnXDAnKSkKCXsKCSAgICByZXR1cm4g
Imluc2VydCBOVUxMIG9yIGVtcHR5IGFyZ3VtZW50cyI7Cgl9CgoJLy8gT2J0YWluIHRoZSBkaXJl
Y3RvcnkgY29uZmlndXJhdGlvbi4KCWRpckNvbmZpZyAqIGRjZmcgPSAoZGlyQ29uZmlnICopIGNv
bmZpZzsKCXN0ZDo6c3RyaW5nIHRlbXAgPSBhcmdzOwoKCXN0ZDo6Y2VyciA8PCAiSW5zZXJ0ZWQg
ZGlyQ29uZmlnIHdpdGggbWVzc2FnZTogIiA8PCB0ZW1wCgkJICA8PCBzdGQ6OmVuZGw7CglkY2Zn
LT5zZXRNZXNzYWdlKCB0ZW1wICk7CglyZXR1cm4gTlVMTDsKICAgIH0KICAgIAogICAgYXByX3N0
YXR1c190IGRpckNvbmZpZzo6aG9va0Z1bmMoIHJlcXVlc3RfcmVjICogciApCiAgICB7CglkaXJD
b25maWcgKiBkY2ZnID0KCSAgICAoZGlyQ29uZmlnICopIGFwX2dldF9tb2R1bGVfY29uZmlnKCBy
LT5wZXJfZGlyX2NvbmZpZywKCQkJCQkJJiBEaXJDb25maWdfbW9kdWxlICk7CgoJc3RkOjpjZXJy
IDw8ICJob29rRnVuYzogZm9yIHJlcXVlc3QgIiA8PCByLT51cmkgPDwgIiB0aGUgY29udGV4dCBp
czogIgoJCSAgPDwgZGNmZy0+Z2V0Q29udGV4dCgpIDw8IHN0ZDo6ZW5kbDsKCXJldHVybiBERUNM
SU5FRDsKICAgIH0KICAgIAogICAgdm9pZCBkaXJDb25maWc6OnJlZ2lzdGVySG9va3MoIGFwcl9w
b29sX3QgKiBwb29sICkKICAgIHsKCWFwX2hvb2tfZml4dXBzKCAoUmVxSG9va0Z1bmNfdCkgaG9v
a0Z1bmMsIE5VTEwsIE5VTEwsCgkJCUFQUl9IT09LX01JRERMRSApOwogICAgfQoKfSAvLyBuYW1l
c3BhY2UgRkVCVEtfTkFNRVNQQUNFXwoAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA==

--_004_adfc9e96fd3d41d88ff3059182439031MSGRTP1DAG01ADMN1FMRcom_--

From dev-return-84489-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Sat Oct 31 02:58:38 2015
Return-Path: <dev-return-84489-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 8430D18A42
	for <apmail-httpd-dev-archive@www.apache.org>; Sat, 31 Oct 2015 02:58:38 +0000 (UTC)
Received: (qmail 13485 invoked by uid 500); 31 Oct 2015 02:58:38 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 13407 invoked by uid 500); 31 Oct 2015 02:58:38 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 13397 invoked by uid 99); 31 Oct 2015 02:58:37 -0000
Received: from Unknown (HELO spamd4-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 31 Oct 2015 02:58:37 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd4-us-west.apache.org (ASF Mail Server at spamd4-us-west.apache.org) with ESMTP id 6AFAEC1040
	for <dev@httpd.apache.org>; Sat, 31 Oct 2015 02:58:37 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd4-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 2.98
X-Spam-Level: **
X-Spam-Status: No, score=2.98 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, HTML_MESSAGE=3,
	RCVD_IN_MSPIKE_H3=-0.01, RCVD_IN_MSPIKE_WL=-0.01, SPF_PASS=-0.001,
	URIBL_BLOCKED=0.001] autolearn=disabled
Authentication-Results: spamd4-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=rowe-clan_net.20150623.gappssmtp.com
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd4-us-west.apache.org [10.40.0.11]) (amavisd-new, port 10024)
	with ESMTP id PwTtiiIOwEjA for <dev@httpd.apache.org>;
	Sat, 31 Oct 2015 02:58:32 +0000 (UTC)
Received: from mail-ig0-f174.google.com (mail-ig0-f174.google.com [209.85.213.174])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id C2D7F44162
	for <dev@httpd.apache.org>; Sat, 31 Oct 2015 02:58:31 +0000 (UTC)
Received: by igvi2 with SMTP id i2so21447337igv.0
        for <dev@httpd.apache.org>; Fri, 30 Oct 2015 19:58:31 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=rowe-clan_net.20150623.gappssmtp.com; s=20150623;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        bh=gXUxseTxBCZ9QiGauaFxWFkiEnelzbqfAqgrHJ67gaM=;
        b=i2pyITH3Yf2zPPfdI/z4qxhZH82lfz+y21/5cOAzFVEKxL7gxyd3WD5mZnl733s0+g
         PKyo8qgKDc9aVfloedOPMie8rGbr//Sp+IFY44RANkfqq/YQ4DtGx3qjs9lH7Z21q+FZ
         mwRU2Yz0OHZRl2LC6uFojvY0GJPjryTD09NAyTJSx77bKhcnU0e82hQyFsmUMcebP7Ao
         Z0sXx8+shadbOgTpSkCkhnqO+Ks3lz+ZZPAlFEgTUZ3xU/f4CyAtKzLbHyvxzI44a1y1
         bunB6a17tKpylwVn7iS1aIudrDn1wgfx/i/fqKiFzlwQp1v2Dpi1LPLsuoxm7jmo7J8a
         nD8Q==
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=1e100.net; s=20130820;
        h=x-gm-message-state:mime-version:in-reply-to:references:date
         :message-id:subject:from:to:content-type;
        bh=gXUxseTxBCZ9QiGauaFxWFkiEnelzbqfAqgrHJ67gaM=;
        b=YDk8fYJ9YX+Tnae4XVSc9g/98h1PhbyW12IqBJ+g79wgztpZ/s8OVtyQTKqckD9FZY
         aDrfT70jMxspIKcjXVcM2A5975zRSZIvVNtu+ey7azSmcdwuibSXEpp4VKkOcGlMBskA
         DjvGeBvACPuTL7zly2tBDsfDj3kjQWYTaYbPQDRqbd5TIN9ILP4RlbrQOjJpB1oxQYqv
         y+dGTVVbERbsFFwRq+m3jtvPq8zIYGkdcsYSDvcIgTU7WK+J8Wm3VMECGWku2A0H9avY
         xcpeiMua85N3Dm3+l8OEl4wNHzqpUJJAPWhieO55oVo6DQ6ioXTW/bOl1gsdm+7kvHVn
         r9Rw==
X-Gm-Message-State: ALoCoQlUN1KrcK8GDIf0QY5PbzL2tkZsEBx5/F+cjt0xryaEVeeOQIA+31dorlH/3tdaHwopQknf
MIME-Version: 1.0
X-Received: by 10.50.43.134 with SMTP id w6mr1548248igl.32.1446260310826; Fri,
 30 Oct 2015 19:58:30 -0700 (PDT)
Received: by 10.107.3.88 with HTTP; Fri, 30 Oct 2015 19:58:30 -0700 (PDT)
In-Reply-To: <adfc9e96fd3d41d88ff3059182439031@MSGRTP1DAG01A.DMN1.FMR.com>
References: <adfc9e96fd3d41d88ff3059182439031@MSGRTP1DAG01A.DMN1.FMR.com>
Date: Fri, 30 Oct 2015 21:58:30 -0500
Message-ID: <CACsi253abxUGo6jr7rfOTMuei3khkZfsEc9CBNitf9n69L8emA@mail.gmail.com>
Subject: Re: merging Apache <Directory> context
From: William A Rowe Jr <wrowe@rowe-clan.net>
To: httpd <dev@httpd.apache.org>
Content-Type: multipart/alternative; boundary=089e01184b0c149ca205235db80f

--089e01184b0c149ca205235db80f
Content-Type: text/plain; charset=UTF-8

On Fri, Oct 30, 2015 at 5:23 PM, Greenberg, Adam <Adam.Greenberg@fmr.com>
wrote:

> Hi Bill (this is a resend to include the dev and user communities, per
> your instructions):
>
>
Replied over on users@ since this seems to be a using-the-API sort of
discussion.

--089e01184b0c149ca205235db80f
Content-Type: text/html; charset=UTF-8
Content-Transfer-Encoding: quoted-printable

<div dir=3D"ltr"><div class=3D"gmail_extra"><div class=3D"gmail_quote">On F=
ri, Oct 30, 2015 at 5:23 PM, Greenberg, Adam <span dir=3D"ltr">&lt;<a href=
=3D"mailto:Adam.Greenberg@fmr.com" target=3D"_blank">Adam.Greenberg@fmr.com=
</a>&gt;</span> wrote:<br><blockquote class=3D"gmail_quote" style=3D"margin=
:0 0 0 .8ex;border-left:1px #ccc solid;padding-left:1ex">





<div lang=3D"EN-US" link=3D"blue" vlink=3D"purple">
<div>
<p class=3D"MsoNormal"><span style=3D"font-size:11.0pt;font-family:&quot;Ca=
libri&quot;,&quot;sans-serif&quot;;color:#1f497d">Hi Bill (this is a resend=
 to include the dev and user communities, per your instructions):<u></u><u>=
</u></span></p>
<p class=3D"MsoNormal"><span style=3D"font-size:11.0pt;font-family:&quot;Ca=
libri&quot;,&quot;sans-serif&quot;;color:#1f497d"><u></u></span></p></div><=
/div></blockquote></div><br></div><div class=3D"gmail_extra">Replied over o=
n users@ since this seems to be a using-the-API sort of discussion.</div></=
div>

--089e01184b0c149ca205235db80f--

