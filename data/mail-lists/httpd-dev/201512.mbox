From dev-return-84811-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Tue Dec  1 04:05:19 2015
Return-Path: <dev-return-84811-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 6A168187FE
	for <apmail-httpd-dev-archive@www.apache.org>; Tue,  1 Dec 2015 04:05:19 +0000 (UTC)
Received: (qmail 80342 invoked by uid 500); 1 Dec 2015 04:05:18 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 80250 invoked by uid 500); 1 Dec 2015 04:05:18 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 80240 invoked by uid 99); 1 Dec 2015 04:05:18 -0000
Received: from Unknown (HELO spamd3-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 01 Dec 2015 04:05:18 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd3-us-west.apache.org (ASF Mail Server at spamd3-us-west.apache.org) with ESMTP id 341C3180A99
	for <dev@httpd.apache.org>; Tue,  1 Dec 2015 04:05:18 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd3-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 2.98
X-Spam-Level: **
X-Spam-Status: No, score=2.98 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, HTML_MESSAGE=3,
	RCVD_IN_MSPIKE_H3=-0.01, RCVD_IN_MSPIKE_WL=-0.01, SPF_PASS=-0.001,
	URIBL_BLOCKED=0.001] autolearn=disabled
Authentication-Results: spamd3-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=rowe-clan-net.20150623.gappssmtp.com
Received: from mx1-us-west.apache.org ([10.40.0.8])
	by localhost (spamd3-us-west.apache.org [10.40.0.10]) (amavisd-new, port 10024)
	with ESMTP id TDRHYIseWB1E for <dev@httpd.apache.org>;
	Tue,  1 Dec 2015 04:05:12 +0000 (UTC)
Received: from mail-ig0-f177.google.com (mail-ig0-f177.google.com [209.85.213.177])
	by mx1-us-west.apache.org (ASF Mail Server at mx1-us-west.apache.org) with ESMTPS id DAA6722F1D
	for <dev@httpd.apache.org>; Tue,  1 Dec 2015 04:05:11 +0000 (UTC)
Received: by igbxm8 with SMTP id xm8so89035353igb.1
        for <dev@httpd.apache.org>; Mon, 30 Nov 2015 20:05:11 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=rowe-clan-net.20150623.gappssmtp.com; s=20150623;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        bh=LUXEriQJUnCOEW0y1aWBrsKgej/kk11PX8tlWXyvBKU=;
        b=mLMkYUwmLygnjFZC7lgnFQCeUsdJHCOyXUZYKEM0GRAISYpCoTzIBSp8rxkoyuoF81
         oKYAPGpij0h0rmlyiIb2vgQcSmPZDEtttbgBURvhZCWWUWC+vAeLSZAMg1LCWhUaagUt
         +HKdWN3tmj7n04q+b0xC58TYxm6csslzFmRcUwir36wXIO/X1v2Rw7MWK/OOrUTAuofp
         MpDg9FT5zXcznVmgu1gjhmu3BkHUG+ZTCWtMT8sy9Ikv80GFN6Peu03FFT8nZMwWV5TU
         unqboidTul5STxnVoELh+ZF0oPi9k2N0sA0JrxnUB6/60EDhMkNk3I3injK7U49s6vDo
         bkLw==
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=1e100.net; s=20130820;
        h=x-gm-message-state:mime-version:in-reply-to:references:date
         :message-id:subject:from:to:content-type;
        bh=LUXEriQJUnCOEW0y1aWBrsKgej/kk11PX8tlWXyvBKU=;
        b=AsvGcWna8LI/6MgHhDuETVYeZOmiRFDko+RqUbiT6OQbMlViYE06/N6t3/NDL8aUt2
         pYYdY7YyTqNv4qodRFlBlgNYkFozRQhIcKNasc2bODDbYejFgslV+FKMkJ/b9eRdrd3G
         e6FNcT9aQ6BQ1hBaS0XHM5zSxD5Rd3YD2PTD995MHFCOSfRhhb3vsQsGD8h30qAavdYh
         +3fLNSZUG/OXXcMF8PXo4EbgcoU9xWrwQKgErkXUVcwC82VdbAT99ukYMQW9c7zvweuq
         agnZCvVyr5ndBuTtqT0ukTyJtcjTAGcJ+FMeVuUM3LUG3+ex6ipyTMbWUbcuUBuzti8R
         lpdQ==
X-Gm-Message-State: ALoCoQmod3d8zy0EBINn/dbk8hSTf3s8wLnkuvQf7u1X3ASJIiFSsdKzYHrd35I205kD+wsaltpr
MIME-Version: 1.0
X-Received: by 10.50.20.163 with SMTP id o3mr25591148ige.35.1448942711034;
 Mon, 30 Nov 2015 20:05:11 -0800 (PST)
Received: by 10.107.62.136 with HTTP; Mon, 30 Nov 2015 20:05:10 -0800 (PST)
Received: by 10.107.62.136 with HTTP; Mon, 30 Nov 2015 20:05:10 -0800 (PST)
In-Reply-To: <menp5btal5gqib4phhf7j8a6dp5cs2qqq4@4ax.com>
References: <02f401d12912$fcba4130$f62ec390$@qqmail.nl>
	<030501d12916$cf7e1120$6e7a3360$@qqmail.nl>
	<56599792.3060402@greenbytes.de>
	<03a401d129dd$fafdbfe0$f0f93fa0$@qqmail.nl>
	<03aa01d129e1$2d49d990$87dd8cb0$@qqmail.nl>
	<040101d12a23$ced65530$6c82ff90$@qqmail.nl>
	<40F35186-1FFF-48EF-BB67-DAE432526244@greenbytes.de>
	<46014DD1-B5DA-4920-B0E2-C43B43EB4816@jaguNET.com>
	<menp5btal5gqib4phhf7j8a6dp5cs2qqq4@4ax.com>
Date: Mon, 30 Nov 2015 22:05:10 -0600
Message-ID: <CACsi252eN3n_K+8wPvz+rPccCLAerhwvjQfgf5aMjRcgxRaLqw@mail.gmail.com>
Subject: Re: No H2 Window updates!
From: William A Rowe Jr <wrowe@rowe-clan.net>
To: httpd <dev@httpd.apache.org>
Content-Type: multipart/alternative; boundary=047d7bd75dec9775d20525ce438e

--047d7bd75dec9775d20525ce438e
Content-Type: text/plain; charset=UTF-8

1.0.8 is known problematic, 1.0.5 mod_h2 is known good.  I wouldn't expect
any change there
On Nov 30, 2015 17:41, "Jan Ehrhardt" <phpdev@ehrhardt.nl> wrote:

> Jim Jagielski in gmane.comp.apache.devel (Mon, 30 Nov 2015 07:24:07 -0500):
> >I'm assuming that the brokenness also shows up on trunk,
> >right?
> >
> >Bert, Jan, can you check if trunk shows the same behavior?
> >I would prefer not hacking away on 2.4 directly and independently.
>
> FYI: the only differences between trunk and mod_http2 1.0.8 were
> ap_strcasecmp
> vs. strcasecmp and 1.0.9-dev vs 1.0.8.
> --
> Jan
>
>

--047d7bd75dec9775d20525ce438e
Content-Type: text/html; charset=UTF-8
Content-Transfer-Encoding: quoted-printable

<p dir=3D"ltr">1.0.8 is known problematic, 1.0.5 mod_h2 is known good.=C2=
=A0 I wouldn&#39;t expect any change there <br>
</p>
<div class=3D"gmail_quote">On Nov 30, 2015 17:41, &quot;Jan Ehrhardt&quot; =
&lt;<a href=3D"mailto:phpdev@ehrhardt.nl">phpdev@ehrhardt.nl</a>&gt; wrote:=
<br type=3D"attribution"><blockquote class=3D"gmail_quote" style=3D"margin:=
0 0 0 .8ex;border-left:1px #ccc solid;padding-left:1ex">Jim Jagielski in gm=
ane.comp.apache.devel (Mon, 30 Nov 2015 07:24:07 -0500):<br>
&gt;I&#39;m assuming that the brokenness also shows up on trunk,<br>
&gt;right?<br>
&gt;<br>
&gt;Bert, Jan, can you check if trunk shows the same behavior?<br>
&gt;I would prefer not hacking away on 2.4 directly and independently.<br>
<br>
FYI: the only differences between trunk and mod_http2 1.0.8 were ap_strcase=
cmp<br>
vs. strcasecmp and 1.0.9-dev vs 1.0.8.<br>
--<br>
Jan<br>
<br>
</blockquote></div>

--047d7bd75dec9775d20525ce438e--

From dev-return-84812-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Tue Dec  1 04:53:52 2015
Return-Path: <dev-return-84812-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 21DDC18937
	for <apmail-httpd-dev-archive@www.apache.org>; Tue,  1 Dec 2015 04:53:52 +0000 (UTC)
Received: (qmail 38106 invoked by uid 500); 1 Dec 2015 04:53:51 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 38032 invoked by uid 500); 1 Dec 2015 04:53:51 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 38013 invoked by uid 99); 1 Dec 2015 04:53:51 -0000
Received: from Unknown (HELO spamd4-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 01 Dec 2015 04:53:51 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd4-us-west.apache.org (ASF Mail Server at spamd4-us-west.apache.org) with ESMTP id E70BFC0472
	for <dev@httpd.apache.org>; Tue,  1 Dec 2015 04:53:50 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd4-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 2.979
X-Spam-Level: **
X-Spam-Status: No, score=2.979 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, HTML_MESSAGE=3,
	RCVD_IN_MSPIKE_H3=-0.01, RCVD_IN_MSPIKE_WL=-0.01, SPF_PASS=-0.001]
	autolearn=disabled
Authentication-Results: spamd4-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=rowe-clan-net.20150623.gappssmtp.com
Received: from mx1-us-west.apache.org ([10.40.0.8])
	by localhost (spamd4-us-west.apache.org [10.40.0.11]) (amavisd-new, port 10024)
	with ESMTP id qXby1tscEOF8 for <dev@httpd.apache.org>;
	Tue,  1 Dec 2015 04:53:50 +0000 (UTC)
Received: from mail-ig0-f170.google.com (mail-ig0-f170.google.com [209.85.213.170])
	by mx1-us-west.apache.org (ASF Mail Server at mx1-us-west.apache.org) with ESMTPS id F03D420FF5
	for <dev@httpd.apache.org>; Tue,  1 Dec 2015 04:53:49 +0000 (UTC)
Received: by igcto18 with SMTP id to18so88018075igc.0
        for <dev@httpd.apache.org>; Mon, 30 Nov 2015 20:53:49 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=rowe-clan-net.20150623.gappssmtp.com; s=20150623;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        bh=EVU4Mfc8S0FukUw/fN6cB0wBj/S5LZogKbpZPzTYk8s=;
        b=xxSzov69pqP6Z/GOPNT6PEO+9vtAAQuipD/5PsivUbuZheiq9UFoHMGZZfi2Ylazgm
         BDYg48leJ+GvKwB7vsRamd+RojRtD4dMIW+lC28Rs8y8wUaWduCJUv98SKvZSm8SbQ3X
         /KJG6+q1B8C7IRXL7u3bWgrfLlwEJLP5wC0a581pVQmXAFLc+LICaGYb/qPlTBT9h9ep
         aRgkU4aDssXVxAu1Q+89sTt9nUBlGY5jxu3FOkE3YFI841HER3zVzmV/R90ULepY0TtD
         KyqGSVtqo/tWLfULk63ZPrvnu7mA1ButNPknAQV/LY6ZlzebBSZJjB6wgcwDjfdQow22
         argA==
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=1e100.net; s=20130820;
        h=x-gm-message-state:mime-version:in-reply-to:references:date
         :message-id:subject:from:to:content-type;
        bh=EVU4Mfc8S0FukUw/fN6cB0wBj/S5LZogKbpZPzTYk8s=;
        b=XA+CIaen1Eqk4VnVMFnTx8K7mO6y6S5CJnAx+fcVucFGrM6yiSbhI+tsG4Uvt3oDzl
         UuWyjTGAkDdmUKGHM6MZ2Du523AtEvG5QrQsMICyQRwpSK6NX6xmFV+uAo5kz0MbEQTB
         HUfGSqxrGbowVp8xLQZ6bZt4Zza4WV0mV9P0kiCokaGWpz+Od9dMPIwqlR74zlON1sOR
         KrW/p4wLcajz3SP53dgFsnPqCApy5iwSyx3ZutcZt7Q78hXY2JEs13+fGKkjjNC1RHOK
         T2Xx7K0GaeG6JfWr1CltYmhn1T4AFp2xF/4gfWFQeGNmK1oN4SOsUZKixqcVTs7PoUHX
         y0Kg==
X-Gm-Message-State: ALoCoQkF43JOBvoVYgxfEl5CirzG1eujocZjaSuKHJJKOMsd2Io1n6WcE3/+5pBOmB46RQiCGFQJ
MIME-Version: 1.0
X-Received: by 10.50.143.5 with SMTP id sa5mr26092288igb.77.1448945629409;
 Mon, 30 Nov 2015 20:53:49 -0800 (PST)
Received: by 10.107.62.136 with HTTP; Mon, 30 Nov 2015 20:53:49 -0800 (PST)
Received: by 10.107.62.136 with HTTP; Mon, 30 Nov 2015 20:53:49 -0800 (PST)
In-Reply-To: <CAKQ1sVOU7xmY-_PaQb0et0GXO-NxtTPBsD4ZU_UbtUzWYOUVTg@mail.gmail.com>
References: <CACsi253BCKpDOTmShACc3K1KCXeTBb1ugAgaioPXHvDCM+AGiw@mail.gmail.com>
	<CAKQ1sVOU7xmY-_PaQb0et0GXO-NxtTPBsD4ZU_UbtUzWYOUVTg@mail.gmail.com>
Date: Mon, 30 Nov 2015 22:53:49 -0600
Message-ID: <CACsi252FqXPkLrXXD=65Dtqw5-b3TeWhn6z3KqdAELRXOgJLtw@mail.gmail.com>
Subject: Re: apr_token_* conclusions (was: Better casecmpstr[n]?)
From: William A Rowe Jr <wrowe@rowe-clan.net>
To: httpd <dev@httpd.apache.org>
Content-Type: multipart/alternative; boundary=001a1134c2e68a4edd0525cef1ad

--001a1134c2e68a4edd0525cef1ad
Content-Type: text/plain; charset=UTF-8

I've hijacked Yann's thoughts and replied on a dev@apr thread.  There is
merit in httpd's deliberations but the issue is sufficiently larger than
'just us ourselves'.

--001a1134c2e68a4edd0525cef1ad
Content-Type: text/html; charset=UTF-8
Content-Transfer-Encoding: quoted-printable

<p dir=3D"ltr">I&#39;ve hijacked Yann&#39;s thoughts and replied on a dev@a=
pr thread.=C2=A0 There is merit in httpd&#39;s deliberations but the issue =
is sufficiently larger than &#39;just us ourselves&#39;.</p>

--001a1134c2e68a4edd0525cef1ad--

From dev-return-84813-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Tue Dec  1 06:31:44 2015
Return-Path: <dev-return-84813-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 1C93A18D34
	for <apmail-httpd-dev-archive@www.apache.org>; Tue,  1 Dec 2015 06:31:44 +0000 (UTC)
Received: (qmail 32522 invoked by uid 500); 1 Dec 2015 06:31:01 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 13050 invoked by uid 500); 1 Dec 2015 06:30:41 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 98355 invoked by uid 500); 1 Dec 2015 06:30:26 -0000
Delivered-To: apmail-dev-all@apache.org
Received: (qmail 98345 invoked by uid 99); 1 Dec 2015 06:30:26 -0000
Received: from mail-relay.apache.org (HELO mail-relay.apache.org) (140.211.11.15)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 01 Dec 2015 06:30:26 +0000
Received: from usxxshaporm1.corp.emc.com (c-24-130-232-25.hsd1.ca.comcast.net [24.130.232.25])
	by mail-relay.apache.org (ASF Mail Server at mail-relay.apache.org) with ESMTPSA id 37E401A01A7;
	Tue,  1 Dec 2015 06:30:26 +0000 (UTC)
Date: Mon, 30 Nov 2015 22:30:21 -0800
From: Roman Shaposhnik <rvs@apache.org>
To: rvs@apache.org
Subject: FOSDEM 2016 - take action by 4th of December 2015
Message-ID: <20151201063021.GA38185@usxxshaporm1.corp.emc.com>
MIME-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Disposition: inline
User-Agent: Mutt/1.5.22 (2013-10-16)

As most of you probably know FOSDEM 2016 (the biggest,
100% free open source developer conference) is right 
around the corner:
   https://fosdem.org/2016/

We hope to have an ASF booth and we would love to see as
many ASF projects as possible present at various tracks
(AKA Developer rooms):
   https://fosdem.org/2016/schedule/#devrooms

This year, for the first time, we are running a dedicated
Big Data and HPC Developer Room and given how much of that
open source development is done at ASF it would be great
to have folks submit talks to:
   https://hpc-bigdata-fosdem16.github.io

While the CFPs for different Developer Rooms follow slightly 
different schedules, but if you submit by the end of this week 
you should be fine.

Finally if you don't want to fish for CFP submission URL,
here it is:
   https://fosdem.org/submit

If you have any questions -- please email me *directly* and
hope to see as many of you as possible in two months! 

Thanks,
Roman.

From dev-return-84814-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Tue Dec  1 12:39:31 2015
Return-Path: <dev-return-84814-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id DCAEF18CC1
	for <apmail-httpd-dev-archive@www.apache.org>; Tue,  1 Dec 2015 12:39:30 +0000 (UTC)
Received: (qmail 52411 invoked by uid 500); 1 Dec 2015 12:39:06 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 52333 invoked by uid 500); 1 Dec 2015 12:39:06 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 52323 invoked by uid 99); 1 Dec 2015 12:39:06 -0000
Received: from Unknown (HELO spamd3-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 01 Dec 2015 12:39:06 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd3-us-west.apache.org (ASF Mail Server at spamd3-us-west.apache.org) with ESMTP id 19BDB180183
	for <dev@httpd.apache.org>; Tue,  1 Dec 2015 12:39:06 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd3-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 0.653
X-Spam-Level:
X-Spam-Status: No, score=0.653 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, SPF_NEUTRAL=0.652,
	URIBL_BLOCKED=0.001] autolearn=disabled
Authentication-Results: spamd3-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=comcast.net
Received: from mx1-us-west.apache.org ([10.40.0.8])
	by localhost (spamd3-us-west.apache.org [10.40.0.10]) (amavisd-new, port 10024)
	with ESMTP id OicBv1tWztfM for <dev@httpd.apache.org>;
	Tue,  1 Dec 2015 12:38:54 +0000 (UTC)
Received: from resqmta-po-02v.sys.comcast.net (resqmta-po-02v.sys.comcast.net [96.114.154.161])
	by mx1-us-west.apache.org (ASF Mail Server at mx1-us-west.apache.org) with ESMTPS id B2D1A2026E
	for <dev@httpd.apache.org>; Tue,  1 Dec 2015 12:38:54 +0000 (UTC)
Received: from resomta-po-12v.sys.comcast.net ([96.114.154.236])
	by resqmta-po-02v.sys.comcast.net with comcast
	id oCeo1r00356HXL001Ceorb; Tue, 01 Dec 2015 12:38:48 +0000
Received: from [192.168.199.10] ([69.251.84.114])
	by resomta-po-12v.sys.comcast.net with comcast
	id oCen1r0082U0RYt01CenaQ; Tue, 01 Dec 2015 12:38:48 +0000
Content-Type: text/plain; charset=us-ascii
Mime-Version: 1.0 (Mac OS X Mail 8.2 \(2104\))
Subject: Re: No H2 Window updates!
From: Jim Jagielski <jim@jaguNET.com>
In-Reply-To: <mnjp5b1qdm4sgu56t413p2bmblsqjpd9og@4ax.com>
Date: Tue, 1 Dec 2015 07:38:47 -0500
Content-Transfer-Encoding: 7bit
Message-Id: <78BF1B01-16EE-4071-803B-A174432C9503@jaguNET.com>
References: <02f401d12912$fcba4130$f62ec390$@qqmail.nl> <030501d12916$cf7e1120$6e7a3360$@qqmail.nl> <56599792.3060402@greenbytes.de> <03a401d129dd$fafdbfe0$f0f93fa0$@qqmail.nl> <03aa01d129e1$2d49d990$87dd8cb0$@qqmail.nl> <040101d12a23$ced65530$6c82ff90$@qqmail.nl> <40F35186-1FFF-48EF-BB67-DAE432526244@greenbytes.de> <46014DD1-B5DA-4920-B0E2-C43B43EB4816@jaguNET.com> <mnjp5b1qdm4sgu56t413p2bmblsqjpd9og@4ax.com>
To: dev@httpd.apache.org
X-Mailer: Apple Mail (2.2104)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=comcast.net;
	s=q20140121; t=1448973528;
	bh=LisGVt8U01q11ymxd/8MkR4/o4esDSyon3hWXpY1HOA=;
	h=Received:Received:Content-Type:Mime-Version:Subject:From:Date:
	 Message-Id:To;
	b=fGvW/dyF+3GGIHRjIN8vs+fL/W6OZVKlfmuxqHi9g17h9sP7LZw9jhtA7x3ciKz8X
	 TVfRxfIxxbv8wHF24ZbfIMiS7WFagUfDV2ZyFB7iWF1nRQCAK3QNwPZIxvpOxv759G
	 q6HwYvkpkO9TnXhCrFwAbr59Qh5AAU52Ms1PVUU81D8y6X2j9iyob3PsuBxiDycMWl
	 mVn1CLV7H+FOP6kRPK+RnIhT7MfTi6/DfOyH64/vtT8GYE3by7tNAquDUiuQ5g81az
	 t1pAo9LfGZo3gzY9ZVw9RF+Q6A/HvNJ4kkXICEW9MWQfXnTuZYkmGKTTPGRQmYsfFk
	 da8wWTkXqfOUQ==


> On Nov 30, 2015, at 5:53 PM, Jan Ehrhardt <phpdev@ehrhardt.nl> wrote:
> 
> Jim Jagielski in gmane.comp.apache.devel (Mon, 30 Nov 2015 07:24:07 -0500):
>> I'm assuming that the brokenness also shows up on trunk,
>> right?
>> 
>> Bert, Jan, can you check if trunk shows the same behavior?
>> I would prefer not hacking away on 2.4 directly and independently.
> 
> I checked out revision 1717334 from trunk and tried to update mod_http2
> without updating the other sources. Surprise:
> 
> Creating library .\Release/mod_http2.lib and object .\Release/mod_http2.exp
> 1>h2_from_h1.obj : error LNK2019: unresolved external symbol _ap_casecmpstr
>   referenced in function _create_response
> 1>.\Release\mod_http2.so : fatal error LNK1120: 1 unresolved externals
> 
> Somebody followed your advice and actually wrote some code! I cannot easily
> test mod_http2 from trunk, because it involves updating APR as well.

Sounds like you needed to do a make clean and rebuild... ap_casecmpstr()
is httpd not APR :)

Thanks for the test! 


From dev-return-84815-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Tue Dec  1 13:16:30 2015
Return-Path: <dev-return-84815-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 1B8E418E3E
	for <apmail-httpd-dev-archive@www.apache.org>; Tue,  1 Dec 2015 13:16:30 +0000 (UTC)
Received: (qmail 53913 invoked by uid 500); 1 Dec 2015 13:16:20 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 53822 invoked by uid 500); 1 Dec 2015 13:16:20 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 53812 invoked by uid 99); 1 Dec 2015 13:16:19 -0000
Received: from Unknown (HELO spamd1-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 01 Dec 2015 13:16:19 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd1-us-west.apache.org (ASF Mail Server at spamd1-us-west.apache.org) with ESMTP id 7C8D0C89B4
	for <dev@httpd.apache.org>; Tue,  1 Dec 2015 13:16:19 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd1-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.009
X-Spam-Level:
X-Spam-Status: No, score=-0.009 tagged_above=-999 required=6.31
	tests=[HEADER_FROM_DIFFERENT_DOMAINS=0.001, SPF_PASS=-0.001,
	T_RP_MATCHES_RCVD=-0.01, URIBL_BLOCKED=0.001] autolearn=disabled
Received: from mx1-us-west.apache.org ([10.40.0.8])
	by localhost (spamd1-us-west.apache.org [10.40.0.7]) (amavisd-new, port 10024)
	with ESMTP id F4e4qFNfr8RC for <dev@httpd.apache.org>;
	Tue,  1 Dec 2015 13:16:09 +0000 (UTC)
Received: from plane.gmane.org (plane.gmane.org [80.91.229.3])
	by mx1-us-west.apache.org (ASF Mail Server at mx1-us-west.apache.org) with ESMTPS id 5871F20C34
	for <dev@httpd.apache.org>; Tue,  1 Dec 2015 13:16:08 +0000 (UTC)
Received: from list by plane.gmane.org with local (Exim 4.69)
	(envelope-from <apache-dev@m.gmane.org>)
	id 1a3kmq-0003sN-Dg
	for dev@httpd.apache.org; Tue, 01 Dec 2015 14:16:04 +0100
Received: from 227-116.citynet.ftth.internl.net ([85.223.116.227])
        by main.gmane.org with esmtp (Gmexim 0.1 (Debian))
        id 1AlnuQ-0007hv-00
        for <dev@httpd.apache.org>; Tue, 01 Dec 2015 14:16:04 +0100
Received: from phpdev by 227-116.citynet.ftth.internl.net with local (Gmexim 0.1 (Debian))
        id 1AlnuQ-0007hv-00
        for <dev@httpd.apache.org>; Tue, 01 Dec 2015 14:16:04 +0100
X-Injected-Via-Gmane: http://gmane.org/
To: dev@httpd.apache.org
From: Jan Ehrhardt <phpdev@ehrhardt.nl>
Subject: Re: No H2 Window updates!
Date: Tue, 01 Dec 2015 14:15:44 +0100
Lines: 28
Message-ID: <b47r5b5n1mf2oeeb33tidnsdvvr5dckjvf@4ax.com>
References: <02f401d12912$fcba4130$f62ec390$@qqmail.nl> <030501d12916$cf7e1120$6e7a3360$@qqmail.nl> <56599792.3060402@greenbytes.de> <03a401d129dd$fafdbfe0$f0f93fa0$@qqmail.nl> <03aa01d129e1$2d49d990$87dd8cb0$@qqmail.nl> <040101d12a23$ced65530$6c82ff90$@qqmail.nl> <40F35186-1FFF-48EF-BB67-DAE432526244@greenbytes.de> <46014DD1-B5DA-4920-B0E2-C43B43EB4816@jaguNET.com> <mnjp5b1qdm4sgu56t413p2bmblsqjpd9og@4ax.com> <78BF1B01-16EE-4071-803B-A174432C9503@jaguNET.com>
Mime-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Complaints-To: usenet@ger.gmane.org
X-Gmane-NNTP-Posting-Host: 227-116.citynet.ftth.internl.net
X-Newsreader: Forte Agent 3.3/32.846

Jim Jagielski in gmane.comp.apache.devel (Tue, 1 Dec 2015 07:38:47 -0500):
>
>> On Nov 30, 2015, at 5:53 PM, Jan Ehrhardt <phpdev@ehrhardt.nl> wrote:
>> 
>> Creating library .\Release/mod_http2.lib and object .\Release/mod_http2.exp
>> 1>h2_from_h1.obj : error LNK2019: unresolved external symbol _ap_casecmpstr
>>   referenced in function _create_response
>> 1>.\Release\mod_http2.so : fatal error LNK1120: 1 unresolved externals
>
>Sounds like you needed to do a make clean and rebuild... ap_casecmpstr()
>is httpd not APR :)

If only it was that simple on Windows. Replacing all sources of 2.4.x with
those from trunk leads to oher errors. For instance:

1>------ Build started: Project: mod_ssl, Configuration: Release Win32 ------
1>  mod_ssl.c
1>mod_ssl.c(43): error C2491: 'ssl_run_pre_handshake': definition of dllimport
function not allowed
1>  ssl_engine_config.c
1>  ssl_engine_init.c
1>ssl_engine_init.c(39): error C2491: 'ssl_run_init_server': definition of
dllimport function not allowed
etc 

I do not have the time now to solve things like this.
-- 
Jan


From dev-return-84816-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Tue Dec  1 13:31:26 2015
Return-Path: <dev-return-84816-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id D683B18EC1
	for <apmail-httpd-dev-archive@www.apache.org>; Tue,  1 Dec 2015 13:31:26 +0000 (UTC)
Received: (qmail 78774 invoked by uid 500); 1 Dec 2015 13:31:23 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 78683 invoked by uid 500); 1 Dec 2015 13:31:23 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 78671 invoked by uid 99); 1 Dec 2015 13:31:23 -0000
Received: from Unknown (HELO spamd2-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 01 Dec 2015 13:31:23 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd2-us-west.apache.org (ASF Mail Server at spamd2-us-west.apache.org) with ESMTP id D76EE1A41C7
	for <dev@httpd.apache.org>; Tue,  1 Dec 2015 13:31:22 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd2-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 0.652
X-Spam-Level:
X-Spam-Status: No, score=0.652 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, SPF_NEUTRAL=0.652]
	autolearn=disabled
Authentication-Results: spamd2-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=comcast.net
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd2-us-west.apache.org [10.40.0.9]) (amavisd-new, port 10024)
	with ESMTP id nUNCTxknzk4d for <dev@httpd.apache.org>;
	Tue,  1 Dec 2015 13:31:16 +0000 (UTC)
Received: from resqmta-po-06v.sys.comcast.net (resqmta-po-06v.sys.comcast.net [96.114.154.165])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id 6CA2B2160F
	for <dev@httpd.apache.org>; Tue,  1 Dec 2015 13:31:15 +0000 (UTC)
Received: from resomta-po-20v.sys.comcast.net ([96.114.154.244])
	by resqmta-po-06v.sys.comcast.net with comcast
	id oDWp1r0065Geu2801DX7yl; Tue, 01 Dec 2015 13:31:07 +0000
Received: from [192.168.199.10] ([69.251.84.114])
	by resomta-po-20v.sys.comcast.net with comcast
	id oDX61r00Y2U0RYt01DX7P7; Tue, 01 Dec 2015 13:31:07 +0000
Content-Type: text/plain; charset=us-ascii
Mime-Version: 1.0 (Mac OS X Mail 8.2 \(2104\))
Subject: Re: No H2 Window updates!
From: Jim Jagielski <jim@jaguNET.com>
In-Reply-To: <b47r5b5n1mf2oeeb33tidnsdvvr5dckjvf@4ax.com>
Date: Tue, 1 Dec 2015 08:31:06 -0500
Content-Transfer-Encoding: 7bit
Message-Id: <CE0877D1-C285-44F2-A9AD-DB1025CF78F2@jaguNET.com>
References: <02f401d12912$fcba4130$f62ec390$@qqmail.nl> <030501d12916$cf7e1120$6e7a3360$@qqmail.nl> <56599792.3060402@greenbytes.de> <03a401d129dd$fafdbfe0$f0f93fa0$@qqmail.nl> <03aa01d129e1$2d49d990$87dd8cb0$@qqmail.nl> <040101d12a23$ced65530$6c82ff90$@qqmail.nl> <40F35186-1FFF-48EF-BB67-DAE432526244@greenbytes.de> <46014DD1-B5DA-4920-B0E2-C43B43EB4816@jaguNET.com> <mnjp5b1qdm4sgu56t413p2bmblsqjpd9og@4ax.com> <78BF1B01-16EE-4071-803B-A174432C9503@jaguNET.com> <b47r5b5n1mf2oeeb33tidnsdvvr5dckjvf@4ax.com>
To: dev@httpd.apache.org
X-Mailer: Apple Mail (2.2104)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=comcast.net;
	s=q20140121; t=1448976667;
	bh=yw8raPmedeB6pJb4TkAVZ8UtjaL9mxA2uL8JxjfytkU=;
	h=Received:Received:Content-Type:Mime-Version:Subject:From:Date:
	 Message-Id:To;
	b=flVUQy+aeJMMgqsVDZtpRCZbwSDRVNtxBN6zqcmE7rgi5jrcUHwbe+84wHngoQ83A
	 n0XSY8Fzy98uZgUHlQnSJfE/X/YIDumh/oyD11XrhxNk2HcJT0WSS3kea0qGlFhsDn
	 83DlYxyQ/LTSuVHNXi6CwKKcmyEZ0q3g3FjSGSM5qaRkY5fpZyvVz/g+M7NLJ3Llku
	 lvRXdudUDWZGQEx0JAnhgwybvYMiEfjvRoGgAa93eNE58+i9lOU2SP9IYr+M2QLYf3
	 Vz0jeRcmAfQ/s1dXMaJ6VESjUD7nASlRngqrMYQVjthl8eZU6q6YbrfLSp3G2Q+r3C
	 DsXuxZ+hcUkLg==

Can you (or someone) provide a test case or explanation of
how to recreate the issue?

tia

From dev-return-84817-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Tue Dec  1 14:32:41 2015
Return-Path: <dev-return-84817-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id BCF28181D6
	for <apmail-httpd-dev-archive@www.apache.org>; Tue,  1 Dec 2015 14:32:41 +0000 (UTC)
Received: (qmail 22909 invoked by uid 500); 1 Dec 2015 14:32:41 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 22830 invoked by uid 500); 1 Dec 2015 14:32:41 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 22820 invoked by uid 99); 1 Dec 2015 14:32:41 -0000
Received: from Unknown (HELO spamd4-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 01 Dec 2015 14:32:41 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd4-us-west.apache.org (ASF Mail Server at spamd4-us-west.apache.org) with ESMTP id B65B9C059B
	for <dev@httpd.apache.org>; Tue,  1 Dec 2015 14:32:40 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd4-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 3.001
X-Spam-Level: ***
X-Spam-Status: No, score=3.001 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, HTML_MESSAGE=3,
	URIBL_BLOCKED=0.001] autolearn=disabled
Authentication-Results: spamd4-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=rowe-clan-net.20150623.gappssmtp.com
Received: from mx1-us-west.apache.org ([10.40.0.8])
	by localhost (spamd4-us-west.apache.org [10.40.0.11]) (amavisd-new, port 10024)
	with ESMTP id zdihMuCqGxNF for <dev@httpd.apache.org>;
	Tue,  1 Dec 2015 14:32:25 +0000 (UTC)
Received: from mail-ig0-f180.google.com (mail-ig0-f180.google.com [209.85.213.180])
	by mx1-us-west.apache.org (ASF Mail Server at mx1-us-west.apache.org) with ESMTPS id 9E6D0215CF
	for <dev@httpd.apache.org>; Tue,  1 Dec 2015 14:32:25 +0000 (UTC)
Received: by igcph11 with SMTP id ph11so88425532igc.1
        for <dev@httpd.apache.org>; Tue, 01 Dec 2015 06:32:25 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=rowe-clan-net.20150623.gappssmtp.com; s=20150623;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        bh=iDnlvL538GiUo/kDaMKW3dCHK+j+x2jTWlgulxAQig8=;
        b=P6qwL+J7xBJi97WH7Yg6vtlvfECVTytXZR657M/OBMovRC4Du4nhsws77PKsLE/uCn
         URi7muDu8YT7Psu7sB9Tqw28chM5sCy9yudaxMxknwhfZ5JMH/YO7zr7abArGFtKlsOc
         OYD/hyUl+RcE0T9+BuRQgBJjVlzVIhJY6NBKumDZelDR1Xd2/0x2bi1x4dKE4aeRmTWb
         cr3XbJ5JP9uik7oyWhQL/bMduGdk/gws250yrENa6Jy3IeeMm4u2PnrA2CMrnEVQv2tw
         etfuVgbTfXr/kWKKsoFtVHMoMr7pXSkeGLFdq/dvH7mkTuev+uX9wHT9tx3ddXFiFumS
         lMqQ==
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=1e100.net; s=20130820;
        h=x-gm-message-state:mime-version:in-reply-to:references:date
         :message-id:subject:from:to:content-type;
        bh=iDnlvL538GiUo/kDaMKW3dCHK+j+x2jTWlgulxAQig8=;
        b=cJ54S4RazNUxDNoHxOnXLQclcD5ToiciEw6DwGaeWR74RZp5kDZFV7SEGdtmytDlhu
         5LOGA0Kjp8Ik6+qURWPZix9Lzyz3zcf3AwTxE3n9DeI8uKlrf+RH8fSHVq+5w5M2UpaR
         F5NNwD1LkcPvGCBb/uALhi2rgMZkd8euU65GL6siun1EbGUMZ7pFlXdiUcta3fa14VjX
         vpivls1JGvGE1dH5EhTaQ4lowKCWRiJfzhSv2yQROCJTFmDcCcQxPNmYiRlM0MDnDk8z
         t4N/oIIM5B/jrYNXy37HUi/3yrbo8l0+y0Hm3gCJz4e9e7nGPfS4+L8VYvW7qlZ/qEMy
         BM4w==
X-Gm-Message-State: ALoCoQnrFBFpKEPaHCr5WfDvgg8zgR02SANMV4Qv2u0+ybgF80Z8tFAWIgOhaC6V2WxrS4gVrWGT
MIME-Version: 1.0
X-Received: by 10.50.20.163 with SMTP id o3mr27873855ige.35.1448980344904;
 Tue, 01 Dec 2015 06:32:24 -0800 (PST)
Received: by 10.107.62.136 with HTTP; Tue, 1 Dec 2015 06:32:24 -0800 (PST)
In-Reply-To: <b47r5b5n1mf2oeeb33tidnsdvvr5dckjvf@4ax.com>
References: <02f401d12912$fcba4130$f62ec390$@qqmail.nl>
	<030501d12916$cf7e1120$6e7a3360$@qqmail.nl>
	<56599792.3060402@greenbytes.de>
	<03a401d129dd$fafdbfe0$f0f93fa0$@qqmail.nl>
	<03aa01d129e1$2d49d990$87dd8cb0$@qqmail.nl>
	<040101d12a23$ced65530$6c82ff90$@qqmail.nl>
	<40F35186-1FFF-48EF-BB67-DAE432526244@greenbytes.de>
	<46014DD1-B5DA-4920-B0E2-C43B43EB4816@jaguNET.com>
	<mnjp5b1qdm4sgu56t413p2bmblsqjpd9og@4ax.com>
	<78BF1B01-16EE-4071-803B-A174432C9503@jaguNET.com>
	<b47r5b5n1mf2oeeb33tidnsdvvr5dckjvf@4ax.com>
Date: Tue, 1 Dec 2015 08:32:24 -0600
Message-ID: <CACsi253Egm-K71wTd5Ff3gD6AFdhAgm1pHXafE5Kobzb4WejBQ@mail.gmail.com>
Subject: Re: No H2 Window updates!
From: William A Rowe Jr <wrowe@rowe-clan.net>
To: httpd <dev@httpd.apache.org>
Content-Type: multipart/alternative; boundary=047d7bd75decbeb9c20525d7066c

--047d7bd75decbeb9c20525d7066c
Content-Type: text/plain; charset=UTF-8

On Tue, Dec 1, 2015 at 7:15 AM, Jan Ehrhardt <phpdev@ehrhardt.nl> wrote:

> Jim Jagielski in gmane.comp.apache.devel (Tue, 1 Dec 2015 07:38:47 -0500):
> >
> >> On Nov 30, 2015, at 5:53 PM, Jan Ehrhardt <phpdev@ehrhardt.nl> wrote:
> >>
> >> Creating library .\Release/mod_http2.lib and object
> .\Release/mod_http2.exp
> >> 1>h2_from_h1.obj : error LNK2019: unresolved external symbol
> _ap_casecmpstr
> >>   referenced in function _create_response
> >> 1>.\Release\mod_http2.so : fatal error LNK1120: 1 unresolved externals
> >
> >Sounds like you needed to do a make clean and rebuild... ap_casecmpstr()
> >is httpd not APR :)
>
> If only it was that simple on Windows. Replacing all sources of 2.4.x with
> those from trunk leads to oher errors.


Hi Jan - it isn't possible to build httpd trunk sources using httpd 2.4.x
build
files, and this goes for windows or unix.  How were you trying to build? ...


> For instance:
>
> 1>------ Build started: Project: mod_ssl, Configuration: Release Win32
> ------
> 1>  mod_ssl.c
> 1>mod_ssl.c(43): error C2491: 'ssl_run_pre_handshake': definition of
> dllimport
> function not allowed
> 1>  ssl_engine_config.c
> 1>  ssl_engine_init.c
> 1>ssl_engine_init.c(39): error C2491: 'ssl_run_init_server': definition of
> dllimport function not allowed
> etc
>

Right now, SSL_DECLARE_EXPORT is defined in both mod_ssl.dsp, from
the ancient build schema, and in CMakeFiles.txt, for our new and still
evolving cmake-based build schema.  It seems like you may have been
trying to build mod_ssl in trunk using the mod_ssl.mak file from 2.4.x?

Someone can generate you the .mak files for trunk, we just don't check
them in during trunk development because they are a more rapidly moving
target that doesn't settle down till we are about ready to release trunk as
some 2.6 or 3.0 version.  That's what the cmake effort is all about.

See the README.cmake in the root httpd trunk directory for guidance
on how to use that.  If that is what you did, then we have a bigger issue
to resolve, but I compared the use of SSL_DECLARE_EXPORT to the
long-existing DAV_DECLARE_EXPORT and it seems to be consistent.

Cheers,

Bill

--047d7bd75decbeb9c20525d7066c
Content-Type: text/html; charset=UTF-8
Content-Transfer-Encoding: quoted-printable

<div dir=3D"ltr"><div class=3D"gmail_extra"><div class=3D"gmail_quote">On T=
ue, Dec 1, 2015 at 7:15 AM, Jan Ehrhardt <span dir=3D"ltr">&lt;<a href=3D"m=
ailto:phpdev@ehrhardt.nl" target=3D"_blank">phpdev@ehrhardt.nl</a>&gt;</spa=
n> wrote:<br><blockquote class=3D"gmail_quote" style=3D"margin:0px 0px 0px =
0.8ex;border-left-width:1px;border-left-color:rgb(204,204,204);border-left-=
style:solid;padding-left:1ex">Jim Jagielski in gmane.comp.apache.devel (Tue=
, 1 Dec 2015 07:38:47 -0500):<br>
<span class=3D"">&gt;<br>
&gt;&gt; On Nov 30, 2015, at 5:53 PM, Jan Ehrhardt &lt;<a href=3D"mailto:ph=
pdev@ehrhardt.nl">phpdev@ehrhardt.nl</a>&gt; wrote:<br>
&gt;&gt;<br>
</span><span class=3D"">&gt;&gt; Creating library .\Release/mod_http2.lib a=
nd object .\Release/mod_http2.exp<br>
&gt;&gt; 1&gt;h2_from_h1.obj : error LNK2019: unresolved external symbol _a=
p_casecmpstr<br>
&gt;&gt;=C2=A0 =C2=A0referenced in function _create_response<br>
&gt;&gt; 1&gt;.\Release\mod_http2.so : fatal error LNK1120: 1 unresolved ex=
ternals<br>
&gt;<br>
</span><span class=3D"">&gt;Sounds like you needed to do a make clean and r=
ebuild... ap_casecmpstr()<br>
&gt;is httpd not APR :)<br>
<br>
</span>If only it was that simple on Windows. Replacing all sources of 2.4.=
x with<br>
those from trunk leads to oher errors.</blockquote><div><br></div><div>Hi J=
an - it isn&#39;t possible to build httpd trunk sources using httpd 2.4.x b=
uild=C2=A0</div><div>files, and this goes for windows or unix.=C2=A0 How we=
re you trying to build? ...</div><div>=C2=A0</div><blockquote class=3D"gmai=
l_quote" style=3D"margin:0px 0px 0px 0.8ex;border-left-width:1px;border-lef=
t-color:rgb(204,204,204);border-left-style:solid;padding-left:1ex"> For ins=
tance:<br>
<br>
1&gt;------ Build started: Project: mod_ssl, Configuration: Release Win32 -=
-----<br>
1&gt;=C2=A0 mod_ssl.c<br>
1&gt;mod_ssl.c(43): error C2491: &#39;ssl_run_pre_handshake&#39;: definitio=
n of dllimport<br>
function not allowed<br>
1&gt;=C2=A0 ssl_engine_config.c<br>
1&gt;=C2=A0 ssl_engine_init.c<br>
1&gt;ssl_engine_init.c(39): error C2491: &#39;ssl_run_init_server&#39;: def=
inition of<br>
dllimport function not allowed<br>
etc<br></blockquote><div><br></div><div>Right now, SSL_DECLARE_EXPORT is de=
fined in both mod_ssl.dsp, from</div><div>the ancient build schema, and in =
CMakeFiles.txt, for our new and still</div><div>evolving cmake-based build =
schema.=C2=A0 It seems like you may have been</div><div>trying to build mod=
_ssl in trunk using the mod_ssl.mak file from 2.4.x?</div><div><br></div><d=
iv>Someone can generate you the .mak files for trunk, we just don&#39;t che=
ck</div><div>them in during trunk development because they are a more rapid=
ly moving</div><div>target that doesn&#39;t settle down till we are about r=
eady to release trunk as</div><div>some 2.6 or 3.0 version.=C2=A0 That&#39;=
s what the cmake effort is all about.</div><div><br></div><div>See the READ=
ME.cmake in the root httpd trunk directory for guidance</div><div>on how to=
 use that.=C2=A0 If that is what you did, then we have a bigger issue</div>=
<div>to resolve, but I compared the use of SSL_DECLARE_EXPORT to the</div><=
div>long-existing DAV_DECLARE_EXPORT and it seems to be consistent.</div><d=
iv><br></div><div>Cheers,</div><div><br></div><div>Bill</div><div><br></div=
><div>=C2=A0</div></div><br></div></div>

--047d7bd75decbeb9c20525d7066c--

From dev-return-84818-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Tue Dec  1 15:09:03 2015
Return-Path: <dev-return-84818-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 6CF5A18353
	for <apmail-httpd-dev-archive@www.apache.org>; Tue,  1 Dec 2015 15:09:03 +0000 (UTC)
Received: (qmail 15728 invoked by uid 500); 1 Dec 2015 15:09:03 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 15652 invoked by uid 500); 1 Dec 2015 15:09:02 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 15642 invoked by uid 99); 1 Dec 2015 15:09:02 -0000
Received: from Unknown (HELO spamd1-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 01 Dec 2015 15:09:02 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd1-us-west.apache.org (ASF Mail Server at spamd1-us-west.apache.org) with ESMTP id 7A339C8AE4
	for <dev@httpd.apache.org>; Tue,  1 Dec 2015 15:09:02 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd1-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.01
X-Spam-Level:
X-Spam-Status: No, score=-0.01 tagged_above=-999 required=6.31
	tests=[HEADER_FROM_DIFFERENT_DOMAINS=0.001, SPF_PASS=-0.001,
	T_RP_MATCHES_RCVD=-0.01] autolearn=disabled
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd1-us-west.apache.org [10.40.0.7]) (amavisd-new, port 10024)
	with ESMTP id XCsulzLEcIQs for <dev@httpd.apache.org>;
	Tue,  1 Dec 2015 15:08:58 +0000 (UTC)
Received: from plane.gmane.org (plane.gmane.org [80.91.229.3])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id A1A7520ECF
	for <dev@httpd.apache.org>; Tue,  1 Dec 2015 15:08:57 +0000 (UTC)
Received: from list by plane.gmane.org with local (Exim 4.69)
	(envelope-from <apache-dev@m.gmane.org>)
	id 1a3mXu-0004Hh-SH
	for dev@httpd.apache.org; Tue, 01 Dec 2015 16:08:46 +0100
Received: from sd44031cd.adsl.online.nl ([212.64.49.205])
        by main.gmane.org with esmtp (Gmexim 0.1 (Debian))
        id 1AlnuQ-0007hv-00
        for <dev@httpd.apache.org>; Tue, 01 Dec 2015 16:08:41 +0100
Received: from phpdev by sd44031cd.adsl.online.nl with local (Gmexim 0.1 (Debian))
        id 1AlnuQ-0007hv-00
        for <dev@httpd.apache.org>; Tue, 01 Dec 2015 16:08:41 +0100
X-Injected-Via-Gmane: http://gmane.org/
To: dev@httpd.apache.org
From: Jan Ehrhardt <phpdev@ehrhardt.nl>
Subject: Re: No H2 Window updates!
Date: Tue, 01 Dec 2015 16:08:27 +0100
Lines: 9
Message-ID: <bqdr5blheuoccudj4sc7jql6e4dn8furd9@4ax.com>
References: <56599792.3060402@greenbytes.de> <03a401d129dd$fafdbfe0$f0f93fa0$@qqmail.nl> <03aa01d129e1$2d49d990$87dd8cb0$@qqmail.nl> <040101d12a23$ced65530$6c82ff90$@qqmail.nl> <40F35186-1FFF-48EF-BB67-DAE432526244@greenbytes.de> <46014DD1-B5DA-4920-B0E2-C43B43EB4816@jaguNET.com> <mnjp5b1qdm4sgu56t413p2bmblsqjpd9og@4ax.com> <78BF1B01-16EE-4071-803B-A174432C9503@jaguNET.com> <b47r5b5n1mf2oeeb33tidnsdvvr5dckjvf@4ax.com> <CACsi253Egm-K71wTd5Ff3gD6AFdhAgm1pHXafE5Kobzb4WejBQ@mail.gmail.com>
Mime-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Complaints-To: usenet@ger.gmane.org
X-Gmane-NNTP-Posting-Host: sd44031cd.adsl.online.nl
X-Newsreader: Forte Agent 3.3/32.846

William A Rowe Jr in gmane.comp.apache.devel (Tue, 1 Dec 2015 08:32:24 -0600):
>Hi Jan - it isn't possible to build httpd trunk sources using httpd 2.4.x build
>files, and this goes for windows or unix.  How were you trying to build? ...

That was exactly what I was doing. I did not replace my working *.vcxproj
files. But, sorry guys, really no time ATM. I will check in as soon as I have
some spare time.
-- 
Jan


From dev-return-84819-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Tue Dec  1 15:54:29 2015
Return-Path: <dev-return-84819-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id DB0FD185B2
	for <apmail-httpd-dev-archive@www.apache.org>; Tue,  1 Dec 2015 15:54:28 +0000 (UTC)
Received: (qmail 87401 invoked by uid 500); 1 Dec 2015 15:52:19 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 87308 invoked by uid 500); 1 Dec 2015 15:52:18 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 87282 invoked by uid 99); 1 Dec 2015 15:52:18 -0000
Received: from Unknown (HELO spamd4-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 01 Dec 2015 15:52:18 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd4-us-west.apache.org (ASF Mail Server at spamd4-us-west.apache.org) with ESMTP id 90410C54EF
	for <dev@httpd.apache.org>; Tue,  1 Dec 2015 15:50:57 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd4-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.102
X-Spam-Level:
X-Spam-Status: No, score=-0.102 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RCVD_IN_MSPIKE_H2=-0.001, SPF_PASS=-0.001] autolearn=disabled
Authentication-Results: spamd4-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-us-west.apache.org ([10.40.0.8])
	by localhost (spamd4-us-west.apache.org [10.40.0.11]) (amavisd-new, port 10024)
	with ESMTP id lfPZQOUUq_wF for <dev@httpd.apache.org>;
	Tue,  1 Dec 2015 15:50:57 +0000 (UTC)
Received: from mail-io0-f173.google.com (mail-io0-f173.google.com [209.85.223.173])
	by mx1-us-west.apache.org (ASF Mail Server at mx1-us-west.apache.org) with ESMTPS id B614220D02
	for <dev@httpd.apache.org>; Tue,  1 Dec 2015 15:50:56 +0000 (UTC)
Received: by ioc74 with SMTP id 74so13465940ioc.2
        for <dev@httpd.apache.org>; Tue, 01 Dec 2015 07:50:56 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=mime-version:date:message-id:subject:from:to:content-type;
        bh=mGAqcbnQ3lhMt5RnqJAoC49fdcCB6cLmZWMD+cRSJMk=;
        b=Q9cZa/pv0z7JmaOxd38/cY2skHf9d1/cEGAQ4lkkP3Cx+AgrTS/LmFEYznQtTUhTJh
         uL5U2IjCCXhPNcFOYiSS7PmkCdJqMRScqflO8sVtnQs0y5ZLgApr0iOu0RrRKz7MpBx1
         vyQL0jTftpV0uxMG0Bm7h+PBWgvzGbTv59S8wFJDv1EvqnnE2KU2rCVx0+WRePGPAexl
         ySwC48Jae9JIoI3/bZzB66+SoaZs62NMxxkC5LzBByBECQI5WJbmCG/h+eTsiApohD6/
         jLO9okGOB1fsGZO/N0bTuMG3EMSqQovdYSTGB9+pjd6eTCXp2G/6ELyVu6F9nHshcfFr
         Qb1A==
MIME-Version: 1.0
X-Received: by 10.107.134.103 with SMTP id i100mr65680165iod.90.1448985056232;
 Tue, 01 Dec 2015 07:50:56 -0800 (PST)
Received: by 10.64.114.199 with HTTP; Tue, 1 Dec 2015 07:50:56 -0800 (PST)
Date: Tue, 1 Dec 2015 10:50:56 -0500
Message-ID: <CALK=YjN3zwEYDTAEzDWbK-LJc69FQ1QBy-UhnJOBaRnCU5_KbQ@mail.gmail.com>
Subject: issue with "uncacheable" cache revalidations
From: Eric Covener <covener@gmail.com>
To: Apache HTTP Server Development List <dev@httpd.apache.org>
Content-Type: text/plain; charset=UTF-8

I've been looking at an issue where a revalidation
of a stale cache entry fails because the 304 response
on the revalidation doesn't contain its own CC or Expires
but the URL has a query string.  This kicks the revalidation
response out of the cache save filter early and we never
get to look at the stale handle and update the headers.

This is also one of the FIXME cases where the 304 still leaks
out to a non-conditional request.

Part of me wants to merge the Expires/CC headers earlier, or
load up the local variables with what we'd end up merged for
Expires and CC.  But since it's just two headers, part of me wants
to peek at them earlier but leave them as distinct things being
tracked in that early if/else/ for the various reasons.

In the same neighborhood, we are missing a httpbis clarification
about not using Expires when we have parsed CC: s-maxage.  On
this fork of the problem I looked at, some third-party component
had added a mystery Expires: $longago to the response to
accompany a cookie.

Anyone with strong feelings or insight about either of these cases?

I might not come back to it until the new year.

From dev-return-84820-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Tue Dec  1 16:41:23 2015
Return-Path: <dev-return-84820-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 3EA351881B
	for <apmail-httpd-dev-archive@www.apache.org>; Tue,  1 Dec 2015 16:41:23 +0000 (UTC)
Received: (qmail 72411 invoked by uid 500); 1 Dec 2015 16:41:13 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 72345 invoked by uid 500); 1 Dec 2015 16:41:13 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 72335 invoked by uid 99); 1 Dec 2015 16:41:13 -0000
Received: from Unknown (HELO spamd1-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 01 Dec 2015 16:41:13 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd1-us-west.apache.org (ASF Mail Server at spamd1-us-west.apache.org) with ESMTP id 97393C39C1
	for <dev@httpd.apache.org>; Tue,  1 Dec 2015 16:41:12 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd1-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.011
X-Spam-Level:
X-Spam-Status: No, score=-0.011 tagged_above=-999 required=6.31
	tests=[HEADER_FROM_DIFFERENT_DOMAINS=0.001, SPF_HELO_PASS=-0.001,
	SPF_PASS=-0.001, T_RP_MATCHES_RCVD=-0.01] autolearn=disabled
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd1-us-west.apache.org [10.40.0.7]) (amavisd-new, port 10024)
	with ESMTP id eRWknlAqi02J for <dev@httpd.apache.org>;
	Tue,  1 Dec 2015 16:41:11 +0000 (UTC)
Received: from plane.gmane.org (plane.gmane.org [80.91.229.3])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id 5431242ABE
	for <dev@httpd.apache.org>; Tue,  1 Dec 2015 16:41:10 +0000 (UTC)
Received: from list by plane.gmane.org with local (Exim 4.69)
	(envelope-from <apache-dev@m.gmane.org>)
	id 1a3nzB-0002tw-Py
	for dev@httpd.apache.org; Tue, 01 Dec 2015 17:41:01 +0100
Received: from sd44031cd.adsl.online.nl ([212.64.49.205])
        by main.gmane.org with esmtp (Gmexim 0.1 (Debian))
        id 1AlnuQ-0007hv-00
        for <dev@httpd.apache.org>; Tue, 01 Dec 2015 17:41:01 +0100
Received: from phpdev by sd44031cd.adsl.online.nl with local (Gmexim 0.1 (Debian))
        id 1AlnuQ-0007hv-00
        for <dev@httpd.apache.org>; Tue, 01 Dec 2015 17:41:01 +0100
X-Injected-Via-Gmane: http://gmane.org/
To: dev@httpd.apache.org
From: Jan Ehrhardt <phpdev@ehrhardt.nl>
Subject: Re: issue with "uncacheable" cache revalidations
Date: Tue, 01 Dec 2015 17:40:51 +0100
Lines: 32
Message-ID: <a3jr5btueftcqcavb6ab8jjmqg84iue979@4ax.com>
References: <CALK=YjN3zwEYDTAEzDWbK-LJc69FQ1QBy-UhnJOBaRnCU5_KbQ@mail.gmail.com>
Mime-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Complaints-To: usenet@ger.gmane.org
X-Gmane-NNTP-Posting-Host: sd44031cd.adsl.online.nl
X-Newsreader: Forte Agent 3.3/32.846

Eric Covener in gmane.comp.apache.devel (Tue, 1 Dec 2015 10:50:56 -0500):
>I've been looking at an issue where a revalidation
>of a stale cache entry fails because the 304 response
>on the revalidation doesn't contain its own CC or Expires
>but the URL has a query string.  This kicks the revalidation
>response out of the cache save filter early and we never
>get to look at the stale handle and update the headers.
>
>This is also one of the FIXME cases where the 304 still leaks
>out to a non-conditional request.
>
>Part of me wants to merge the Expires/CC headers earlier, or
>load up the local variables with what we'd end up merged for
>Expires and CC.  But since it's just two headers, part of me wants
>to peek at them earlier but leave them as distinct things being
>tracked in that early if/else/ for the various reasons.
>
>In the same neighborhood, we are missing a httpbis clarification
>about not using Expires when we have parsed CC: s-maxage.  On
>this fork of the problem I looked at, some third-party component
>had added a mystery Expires: $longago to the response to
>accompany a cookie.

Quick remark: in Drupal7 with mod_http2 1.0.8 I got the feeling that I was
seeing a lot of 304's. And many URL's in the Drupal-themes have a query
string.

>I might not come back to it until the new year.

Druk, druk, druk ;-)
-- 
Jan


From dev-return-84821-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Tue Dec  1 17:15:19 2015
Return-Path: <dev-return-84821-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 140B218A18
	for <apmail-httpd-dev-archive@www.apache.org>; Tue,  1 Dec 2015 17:15:19 +0000 (UTC)
Received: (qmail 98414 invoked by uid 500); 1 Dec 2015 17:15:18 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 98337 invoked by uid 500); 1 Dec 2015 17:15:18 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 98327 invoked by uid 99); 1 Dec 2015 17:15:18 -0000
Received: from Unknown (HELO spamd4-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 01 Dec 2015 17:15:18 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd4-us-west.apache.org (ASF Mail Server at spamd4-us-west.apache.org) with ESMTP id 25291C54EA
	for <dev@httpd.apache.org>; Tue,  1 Dec 2015 17:15:18 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd4-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.555
X-Spam-Level:
X-Spam-Status: No, score=-0.555 tagged_above=-999 required=6.31
	tests=[RP_MATCHES_RCVD=-0.554, SPF_PASS=-0.001] autolearn=disabled
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd4-us-west.apache.org [10.40.0.11]) (amavisd-new, port 10024)
	with ESMTP id kBXopfj7ouF2 for <dev@httpd.apache.org>;
	Tue,  1 Dec 2015 17:15:17 +0000 (UTC)
Received: from monica.sharp.fm (monica.sharp.fm [80.168.143.5])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTP id 1A7182588E
	for <dev@httpd.apache.org>; Tue,  1 Dec 2015 17:15:17 +0000 (UTC)
Received: from [10.6.37.176] (dab-ntm1-h-2-6.dab.02.net [82.132.230.67])
	(using TLSv1 with cipher DHE-RSA-AES256-SHA (256/256 bits))
	(Client did not present a certificate)
	(Authenticated sender: minfrin@sharp.fm)
	by monica.sharp.fm (Postfix) with ESMTPSA id DECA580C88
	for <dev@httpd.apache.org>; Tue,  1 Dec 2015 17:15:10 +0000 (GMT)
From: Graham Leggett <minfrin@sharp.fm>
Content-Type: text/plain;
	charset=us-ascii
Content-Transfer-Encoding: quoted-printable
Mime-Version: 1.0 (1.0)
Subject: Re: issue with "uncacheable" cache revalidations
Message-Id: <0C061438-5AE5-40C2-9D21-4A189537E449@sharp.fm>
Date: Tue, 1 Dec 2015 17:15:07 +0000
References: <CALK=YjN3zwEYDTAEzDWbK-LJc69FQ1QBy-UhnJOBaRnCU5_KbQ@mail.gmail.com>
In-Reply-To: <CALK=YjN3zwEYDTAEzDWbK-LJc69FQ1QBy-UhnJOBaRnCU5_KbQ@mail.gmail.com>
To: dev@httpd.apache.org
X-Mailer: iPhone Mail (13B143)

On 1 Dec 2015, at 15:50, Eric Covener <covener@gmail.com> wrote:

> I've been looking at an issue where a revalidation
> of a stale cache entry fails because the 304 response
> on the revalidation doesn't contain its own CC or Expires
> but the URL has a query string.  This kicks the revalidation
> response out of the cache save filter early and we never
> get to look at the stale handle and update the headers.

As I recall there is a specific code path for responses that say "we've aske=
d for revalidation, revalidation was successful but not cacheable. Return ca=
ched data but invalidate it, it is the best we can do".

Regards,
Graham
--


From dev-return-84822-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Tue Dec  1 18:13:09 2015
Return-Path: <dev-return-84822-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 6CFB518D77
	for <apmail-httpd-dev-archive@www.apache.org>; Tue,  1 Dec 2015 18:13:09 +0000 (UTC)
Received: (qmail 31177 invoked by uid 500); 1 Dec 2015 18:13:08 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 31094 invoked by uid 500); 1 Dec 2015 18:13:08 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 31084 invoked by uid 99); 1 Dec 2015 18:13:08 -0000
Received: from Unknown (HELO spamd3-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 01 Dec 2015 18:13:08 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd3-us-west.apache.org (ASF Mail Server at spamd3-us-west.apache.org) with ESMTP id 329A5180185
	for <dev@httpd.apache.org>; Tue,  1 Dec 2015 18:13:08 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd3-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.101
X-Spam-Level:
X-Spam-Status: No, score=-0.101 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RCVD_IN_MSPIKE_H2=-0.001, SPF_PASS=-0.001, URIBL_BLOCKED=0.001]
	autolearn=disabled
Authentication-Results: spamd3-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd3-us-west.apache.org [10.40.0.10]) (amavisd-new, port 10024)
	with ESMTP id CjBkDW1O2fxy for <dev@httpd.apache.org>;
	Tue,  1 Dec 2015 18:13:02 +0000 (UTC)
Received: from mail-io0-f181.google.com (mail-io0-f181.google.com [209.85.223.181])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id 50474428ED
	for <dev@httpd.apache.org>; Tue,  1 Dec 2015 18:13:02 +0000 (UTC)
Received: by iouu10 with SMTP id u10so18932250iou.0
        for <dev@httpd.apache.org>; Tue, 01 Dec 2015 10:13:02 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        bh=OyEyyd+J5HQHQ4sv1APK3dRT7M/Kp4fDEeY3a55O1eY=;
        b=qozt6ro8AYdXBFB4X4v67ThY31J6cHdxOzgflpdFJjC3uz8kyJrGOgx9eOrYpLOUL8
         XPsz9ZnFlYBT6/VLfOvQUr2ZhDHIRc/85dq0P4f9Ysmn7V6BPbafzfVJxIrpEoPWltIc
         g9RkoZlFyVm1JbLsmSQ0+973bwjOmYbLDu6GkC6YzaNBMTA99+Iw9tGQJ78nmQTmk2gV
         J7VqRfAJW72483meWPmLMik/ZMsKSNGB5gjZWL/1SI6t1ZR31Gb7Mkp9WJDFa2oEnRb7
         dkTV4Tbvz7Lu3rPf7Vm43uWS37WkXRFeqPq6U02Zzjv1RnnfdcW25RflmBW55roYm9ES
         lqIw==
MIME-Version: 1.0
X-Received: by 10.107.134.103 with SMTP id i100mr66373395iod.90.1448993581987;
 Tue, 01 Dec 2015 10:13:01 -0800 (PST)
Received: by 10.64.114.199 with HTTP; Tue, 1 Dec 2015 10:13:01 -0800 (PST)
In-Reply-To: <0C061438-5AE5-40C2-9D21-4A189537E449@sharp.fm>
References: <CALK=YjN3zwEYDTAEzDWbK-LJc69FQ1QBy-UhnJOBaRnCU5_KbQ@mail.gmail.com>
	<0C061438-5AE5-40C2-9D21-4A189537E449@sharp.fm>
Date: Tue, 1 Dec 2015 13:13:01 -0500
Message-ID: <CALK=YjOur-Z1ntf2grAvZ1F1AMjc613aoZfGTpft1EcicyyVww@mail.gmail.com>
Subject: Re: issue with "uncacheable" cache revalidations
From: Eric Covener <covener@gmail.com>
To: Apache HTTP Server Development List <dev@httpd.apache.org>
Content-Type: text/plain; charset=UTF-8

On Tue, Dec 1, 2015 at 12:15 PM, Graham Leggett <minfrin@sharp.fm> wrote:
>> I've been looking at an issue where a revalidation
>> of a stale cache entry fails because the 304 response
>> on the revalidation doesn't contain its own CC or Expires
>> but the URL has a query string.  This kicks the revalidation
>> response out of the cache save filter early and we never
>> get to look at the stale handle and update the headers.
>
> As I recall there is a specific code path for responses that say "we've asked for revalidation, revalidation was successful but not cacheable. Return cached data but invalidate it, it is the best we can do".


You're right, I missed that when comparing to my snapshot. It's
prefixed by the "Hold the phone..." comment.

-- 
Eric Covener
covener@gmail.com

From dev-return-84823-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Wed Dec  2 14:28:50 2015
Return-Path: <dev-return-84823-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 7BB7D188FD
	for <apmail-httpd-dev-archive@www.apache.org>; Wed,  2 Dec 2015 14:28:50 +0000 (UTC)
Received: (qmail 68655 invoked by uid 500); 2 Dec 2015 14:28:50 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 68572 invoked by uid 500); 2 Dec 2015 14:28:50 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 68562 invoked by uid 99); 2 Dec 2015 14:28:50 -0000
Received: from Unknown (HELO spamd3-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 02 Dec 2015 14:28:49 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd3-us-west.apache.org (ASF Mail Server at spamd3-us-west.apache.org) with ESMTP id 92B9C180975
	for <dev@httpd.apache.org>; Wed,  2 Dec 2015 14:28:49 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd3-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.556
X-Spam-Level:
X-Spam-Status: No, score=-0.556 tagged_above=-999 required=6.31
	tests=[RCVD_IN_MSPIKE_H2=-0.001, RP_MATCHES_RCVD=-0.554,
	SPF_PASS=-0.001] autolearn=disabled
Received: from mx1-us-west.apache.org ([10.40.0.8])
	by localhost (spamd3-us-west.apache.org [10.40.0.10]) (amavisd-new, port 10024)
	with ESMTP id Q0CMSiT2fVCB for <dev@httpd.apache.org>;
	Wed,  2 Dec 2015 14:28:40 +0000 (UTC)
Received: from aserp1040.oracle.com (aserp1040.oracle.com [141.146.126.69])
	by mx1-us-west.apache.org (ASF Mail Server at mx1-us-west.apache.org) with ESMTPS id 7C69C2021C
	for <dev@httpd.apache.org>; Wed,  2 Dec 2015 14:28:40 +0000 (UTC)
Received: from aserv0022.oracle.com (aserv0022.oracle.com [141.146.126.234])
	by aserp1040.oracle.com (Sentrion-MTA-4.3.2/Sentrion-MTA-4.3.2) with ESMTP id tB2ESd4h008437
	(version=TLSv1 cipher=DHE-RSA-AES256-SHA bits=256 verify=OK)
	for <dev@httpd.apache.org>; Wed, 2 Dec 2015 14:28:39 GMT
Received: from userv0121.oracle.com (userv0121.oracle.com [156.151.31.72])
	by aserv0022.oracle.com (8.13.8/8.13.8) with ESMTP id tB2ESdFL002705
	(version=TLSv1/SSLv3 cipher=DHE-RSA-AES256-SHA bits=256 verify=FAIL)
	for <dev@httpd.apache.org>; Wed, 2 Dec 2015 14:28:39 GMT
Received: from abhmp0003.oracle.com (abhmp0003.oracle.com [141.146.116.9])
	by userv0121.oracle.com (8.13.8/8.13.8) with ESMTP id tB2EScMc005010
	for <dev@httpd.apache.org>; Wed, 2 Dec 2015 14:28:38 GMT
Received: from [10.159.143.151] (/10.159.143.151)
	by default (Oracle Beehive Gateway v4.0)
	with ESMTP ; Wed, 02 Dec 2015 06:28:38 -0800
Subject: Re: svn commit: r1717123 -
 /httpd/httpd/trunk/docs/manual/mod/mod_allowmethods.xml
To: dev@httpd.apache.org
References: <20151129210033.1D4663A0234@svn01-us-west.apache.org>
From: Mike Rumph <mike.rumph@oracle.com>
Organization: Oracle Corporation
Message-ID: <565F0010.2060407@oracle.com>
Date: Wed, 2 Dec 2015 06:28:32 -0800
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:38.0) Gecko/20100101
 Thunderbird/38.3.0
MIME-Version: 1.0
In-Reply-To: <20151129210033.1D4663A0234@svn01-us-west.apache.org>
Content-Type: text/plain; charset=utf-8; format=flowed
Content-Transfer-Encoding: 7bit
X-Source-IP: aserv0022.oracle.com [141.146.126.234]

Comment below.

On 11/29/2015 1:00 PM, jailletc36@apache.org wrote:
> Author: jailletc36
> Date: Sun Nov 29 21:00:32 2015
> New Revision: 1717123
>
> URL: http://svn.apache.org/viewvc?rev=1717123&view=rev
> Log:
> Fix doc as spotted by mat in online doc
>
> Modified:
>      httpd/httpd/trunk/docs/manual/mod/mod_allowmethods.xml
>
> Modified: httpd/httpd/trunk/docs/manual/mod/mod_allowmethods.xml
> URL: http://svn.apache.org/viewvc/httpd/httpd/trunk/docs/manual/mod/mod_allowmethods.xml?rev=1717123&r1=1717122&r2=1717123&view=diff
> ==============================================================================
> --- httpd/httpd/trunk/docs/manual/mod/mod_allowmethods.xml (original)
> +++ httpd/httpd/trunk/docs/manual/mod/mod_allowmethods.xml Sun Nov 29 21:00:32 2015
> @@ -39,7 +39,7 @@ in order for it to rebuild correctly.
>   
>   
>   <summary>
> -<p>This module makes it easy to restrict what HTTP methods can
> +<p>This module makes it easy to restrict what HTTP methods can be
>   used on an server. The most common configuration would be:</p>
Should be "on a server".
>   
>   <highlight language="config">
>
>
>


From dev-return-84824-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Wed Dec  2 14:45:08 2015
Return-Path: <dev-return-84824-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 5612E189AD
	for <apmail-httpd-dev-archive@www.apache.org>; Wed,  2 Dec 2015 14:45:08 +0000 (UTC)
Received: (qmail 9588 invoked by uid 500); 2 Dec 2015 14:45:07 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 9512 invoked by uid 500); 2 Dec 2015 14:45:07 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 9414 invoked by uid 99); 2 Dec 2015 14:45:07 -0000
Received: from Unknown (HELO spamd2-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 02 Dec 2015 14:45:07 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd2-us-west.apache.org (ASF Mail Server at spamd2-us-west.apache.org) with ESMTP id 3F97E1A5BE5
	for <dev@httpd.apache.org>; Wed,  2 Dec 2015 14:45:07 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd2-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.655
X-Spam-Level:
X-Spam-Status: No, score=-0.655 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RP_MATCHES_RCVD=-0.554, SPF_PASS=-0.001] autolearn=disabled
Authentication-Results: spamd2-us-west.apache.org (amavisd-new);
	dkim=pass (1024-bit key) header.d=greenbytes.de
Received: from mx1-us-west.apache.org ([10.40.0.8])
	by localhost (spamd2-us-west.apache.org [10.40.0.9]) (amavisd-new, port 10024)
	with ESMTP id EnvFEY68mh3t for <dev@httpd.apache.org>;
	Wed,  2 Dec 2015 14:45:03 +0000 (UTC)
Received: from mail.greenbytes.de (mail.greenbytes.de [217.91.35.233])
	by mx1-us-west.apache.org (ASF Mail Server at mx1-us-west.apache.org) with ESMTPS id EBC5F20C34
	for <dev@httpd.apache.org>; Wed,  2 Dec 2015 14:45:02 +0000 (UTC)
Received: from [192.168.178.41] (unknown [93.211.117.183])
	(using TLSv1 with cipher ECDHE-RSA-AES256-SHA (256/256 bits))
	(Client did not present a certificate)
	by mail.greenbytes.de (Postfix) with ESMTPSA id 85A5B15A0445
	for <dev@httpd.apache.org>; Wed,  2 Dec 2015 15:44:54 +0100 (CET)
DKIM-Signature: v=1; a=rsa-sha256; c=simple/simple; d=greenbytes.de; s=mail;
	t=1449067494; bh=DPlW02qfwXLSicXESh27otswd4guQQOJ98hoO09gfNg=;
	h=Subject:From:In-Reply-To:Date:References:To:From;
	b=OwBse96TMKp6Qh1kROkdHgdO9Tr5gAD+cRL02MOTAXrFnl92IvrgYiCCGw5hHQwP6
	 G8+BgQGW4T8s4SyFttHI9v8F5epBHXE/hes/7KM4N2TD+26sAYGS5tY9Oxmyb7qdPL
	 EO8eyNi83MHMsCwkbWmDMsZ23cXyA9AfXBwOPAh4=
Content-Type: text/plain; charset=us-ascii
Mime-Version: 1.0 (Mac OS X Mail 9.1 \(3096.5\))
Subject: Re: No H2 Window updates!
From: Stefan Eissing <stefan.eissing@greenbytes.de>
In-Reply-To: <bqdr5blheuoccudj4sc7jql6e4dn8furd9@4ax.com>
Date: Wed, 2 Dec 2015 15:44:53 +0100
Content-Transfer-Encoding: quoted-printable
Message-Id: <1D08ECCD-A26B-4D3D-8F12-BE97018059B7@greenbytes.de>
References: <56599792.3060402@greenbytes.de> <03a401d129dd$fafdbfe0$f0f93fa0$@qqmail.nl> <03aa01d129e1$2d49d990$87dd8cb0$@qqmail.nl> <040101d12a23$ced65530$6c82ff90$@qqmail.nl> <40F35186-1FFF-48EF-BB67-DAE432526244@greenbytes.de> <46014DD1-B5DA-4920-B0E2-C43B43EB4816@jaguNET.com> <mnjp5b1qdm4sgu56t413p2bmblsqjpd9og@4ax.com> <78BF1B01-16EE-4071-803B-A174432C9503@jaguNET.com> <b47r5b5n1mf2oeeb33tidnsdvvr5dckjvf@4ax.com> <CACsi253Egm-K71wTd5Ff3gD6AFdhAgm1pHXafE5Kobzb4WejBQ@mail.gmail.com> <bqdr5blheuoccudj4sc7jql6e4dn8furd9@4ax.com>
To: dev@httpd.apache.org
X-Mailer: Apple Mail (2.3096.5)

Please find with r1717641 version 1.0.9-DEV of mod_http2 in trunk and =
branches/2.4.x
that fixes the issue of streams with smallish inputs and lost =
WINDOW_UPDATEs.

Please report back if this works for you. I have another time slot on =
Friday
where I can follow up on it. Thanks.

//Stefan


From dev-return-84825-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Wed Dec  2 15:11:59 2015
Return-Path: <dev-return-84825-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 5309518B0D
	for <apmail-httpd-dev-archive@www.apache.org>; Wed,  2 Dec 2015 15:11:59 +0000 (UTC)
Received: (qmail 93898 invoked by uid 500); 2 Dec 2015 15:11:53 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 93833 invoked by uid 500); 2 Dec 2015 15:11:53 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 93823 invoked by uid 99); 2 Dec 2015 15:11:53 -0000
Received: from Unknown (HELO spamd3-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 02 Dec 2015 15:11:53 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd3-us-west.apache.org (ASF Mail Server at spamd3-us-west.apache.org) with ESMTP id 64158180975
	for <dev@httpd.apache.org>; Wed,  2 Dec 2015 15:11:53 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd3-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 0.653
X-Spam-Level:
X-Spam-Status: No, score=0.653 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, SPF_NEUTRAL=0.652,
	URIBL_BLOCKED=0.001] autolearn=disabled
Authentication-Results: spamd3-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=comcast.net
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd3-us-west.apache.org [10.40.0.10]) (amavisd-new, port 10024)
	with ESMTP id asYCg213Nm6R for <dev@httpd.apache.org>;
	Wed,  2 Dec 2015 15:11:44 +0000 (UTC)
Received: from resqmta-po-12v.sys.comcast.net (resqmta-po-12v.sys.comcast.net [96.114.154.171])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id CCD2824E19
	for <dev@httpd.apache.org>; Wed,  2 Dec 2015 15:11:43 +0000 (UTC)
Received: from resomta-po-18v.sys.comcast.net ([96.114.154.242])
	by resqmta-po-12v.sys.comcast.net with comcast
	id ofAW1r0095E3ZMc01fBb8s; Wed, 02 Dec 2015 15:11:35 +0000
Received: from [192.168.199.10] ([69.251.84.114])
	by resomta-po-18v.sys.comcast.net with comcast
	id ofBa1r00E2U0RYt01fBbkZ; Wed, 02 Dec 2015 15:11:35 +0000
Content-Type: text/plain; charset=us-ascii
Mime-Version: 1.0 (Mac OS X Mail 8.2 \(2104\))
Subject: Re: No H2 Window updates!
From: Jim Jagielski <jim@jaguNET.com>
In-Reply-To: <1D08ECCD-A26B-4D3D-8F12-BE97018059B7@greenbytes.de>
Date: Wed, 2 Dec 2015 10:11:34 -0500
Content-Transfer-Encoding: quoted-printable
Message-Id: <C35350D5-7A6F-44FE-9746-CAD05C346E25@jaguNET.com>
References: <56599792.3060402@greenbytes.de> <03a401d129dd$fafdbfe0$f0f93fa0$@qqmail.nl> <03aa01d129e1$2d49d990$87dd8cb0$@qqmail.nl> <040101d12a23$ced65530$6c82ff90$@qqmail.nl> <40F35186-1FFF-48EF-BB67-DAE432526244@greenbytes.de> <46014DD1-B5DA-4920-B0E2-C43B43EB4816@jaguNET.com> <mnjp5b1qdm4sgu56t413p2bmblsqjpd9og@4ax.com> <78BF1B01-16EE-4071-803B-A174432C9503@jaguNET.com> <b47r5b5n1mf2oeeb33tidnsdvvr5dckjvf@4ax.com> <CACsi253Egm-K71wTd5Ff3gD6AFdhAgm1pHXafE5Kobzb4WejBQ@mail.gmail.com> <bqdr5blheuoccudj4sc7jql6e4dn8furd9@4ax.com> <1D08ECCD-A26B-4D3D-8F12-BE97018059B7@greenbytes.de>
To: dev@httpd.apache.org
X-Mailer: Apple Mail (2.2104)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=comcast.net;
	s=q20140121; t=1449069095;
	bh=+HGs7GU7Z8l9w2esISmjH6VXhJHFCeR8I4RNHJviDWw=;
	h=Received:Received:Content-Type:Mime-Version:Subject:From:Date:
	 Message-Id:To;
	b=WX6yXxVzXL2B/gUtPGz324SG2VLd2NwB5efwljGzpprVhbvWgHHOXxFJwI+U64/Mo
	 GMaP2eOwzAoHQwX+9N9/nYY0l5+W5ZIULoLWnCE2MvWrUbEhar0KQi16Sz2bYDWH9t
	 PbPrLzpqIF+MOPFHdkFD3GYxoS3AISvzE6K1LFb4JIjw4LEYj6htwRKBKUlkksbRHg
	 mYwLmuBERKtMi/pEmkji+lhjZyZ/qP7b9AMYqwM0BAVYFWCWqwefx58QVCOQRR/fn5
	 3dCCWkvy1KXltgv3lOjnIkQxLI7kBqucxRz6B5tIhAbo/ODzVigl2I7YKiQqxPtteu
	 Dm37u8M+CoZ7A==

Passes all tests: OSX and CentOS6.

> On Dec 2, 2015, at 9:44 AM, Stefan Eissing =
<stefan.eissing@greenbytes.de> wrote:
>=20
> Please find with r1717641 version 1.0.9-DEV of mod_http2 in trunk and =
branches/2.4.x
> that fixes the issue of streams with smallish inputs and lost =
WINDOW_UPDATEs.
>=20
> Please report back if this works for you. I have another time slot on =
Friday
> where I can follow up on it. Thanks.
>=20
> //Stefan
>=20


From dev-return-84826-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Wed Dec  2 16:50:36 2015
Return-Path: <dev-return-84826-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 676F51801F
	for <apmail-httpd-dev-archive@www.apache.org>; Wed,  2 Dec 2015 16:50:36 +0000 (UTC)
Received: (qmail 95712 invoked by uid 500); 2 Dec 2015 16:50:32 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 95643 invoked by uid 500); 2 Dec 2015 16:50:32 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 95633 invoked by uid 99); 2 Dec 2015 16:50:32 -0000
Received: from Unknown (HELO spamd2-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 02 Dec 2015 16:50:32 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd2-us-west.apache.org (ASF Mail Server at spamd2-us-west.apache.org) with ESMTP id 5D6841A20DC
	for <dev@httpd.apache.org>; Wed,  2 Dec 2015 16:50:32 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd2-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.555
X-Spam-Level:
X-Spam-Status: No, score=-0.555 tagged_above=-999 required=6.31
	tests=[HEADER_FROM_DIFFERENT_DOMAINS=0.001, RP_MATCHES_RCVD=-0.554,
	SPF_HELO_PASS=-0.001, SPF_PASS=-0.001] autolearn=disabled
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd2-us-west.apache.org [10.40.0.9]) (amavisd-new, port 10024)
	with ESMTP id wpZyh3VT7VEJ for <dev@httpd.apache.org>;
	Wed,  2 Dec 2015 16:50:31 +0000 (UTC)
Received: from plane.gmane.org (plane.gmane.org [80.91.229.3])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id F037F42AD1
	for <dev@httpd.apache.org>; Wed,  2 Dec 2015 16:50:30 +0000 (UTC)
Received: from list by plane.gmane.org with local (Exim 4.69)
	(envelope-from <apache-dev@m.gmane.org>)
	id 1a4Abl-00047r-VT
	for dev@httpd.apache.org; Wed, 02 Dec 2015 17:50:22 +0100
Received: from 227-116.citynet.ftth.internl.net ([85.223.116.227])
        by main.gmane.org with esmtp (Gmexim 0.1 (Debian))
        id 1AlnuQ-0007hv-00
        for <dev@httpd.apache.org>; Wed, 02 Dec 2015 17:50:21 +0100
Received: from phpdev by 227-116.citynet.ftth.internl.net with local (Gmexim 0.1 (Debian))
        id 1AlnuQ-0007hv-00
        for <dev@httpd.apache.org>; Wed, 02 Dec 2015 17:50:21 +0100
X-Injected-Via-Gmane: http://gmane.org/
To: dev@httpd.apache.org
From: Jan Ehrhardt <phpdev@ehrhardt.nl>
Subject: Re: No H2 Window updates!
Date: Wed, 02 Dec 2015 17:50:10 +0100
Lines: 16
Message-ID: <ss7u5b5rr9afr5emng9cctrktb0itin964@4ax.com>
References: <040101d12a23$ced65530$6c82ff90$@qqmail.nl> <40F35186-1FFF-48EF-BB67-DAE432526244@greenbytes.de> <46014DD1-B5DA-4920-B0E2-C43B43EB4816@jaguNET.com> <mnjp5b1qdm4sgu56t413p2bmblsqjpd9og@4ax.com> <78BF1B01-16EE-4071-803B-A174432C9503@jaguNET.com> <b47r5b5n1mf2oeeb33tidnsdvvr5dckjvf@4ax.com> <CACsi253Egm-K71wTd5Ff3gD6AFdhAgm1pHXafE5Kobzb4WejBQ@mail.gmail.com> <bqdr5blheuoccudj4sc7jql6e4dn8furd9@4ax.com> <1D08ECCD-A26B-4D3D-8F12-BE97018059B7@greenbytes.de>
Mime-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Complaints-To: usenet@ger.gmane.org
X-Gmane-NNTP-Posting-Host: 227-116.citynet.ftth.internl.net
X-Newsreader: Forte Agent 3.3/32.846

Stefan Eissing in gmane.comp.apache.devel (Wed, 2 Dec 2015 15:44:53
+0100):
>Please find with r1717641 version 1.0.9-DEV of mod_http2 in trunk and branches/2.4.x
>that fixes the issue of streams with smallish inputs and lost WINDOW_UPDATEs.

I checked out 2.4.x which gave me revision 1717657.

>Please report back if this works for you. I have another time slot on Friday
>where I can follow up on it. Thanks.

Quick test: it did not solve my problems (and I do not have time slots
yet).
BTW: it is still called 1.0.8 in 2.4.x:
http://svn.apache.org/viewvc/httpd/httpd/branches/2.4.x/modules/http2/h2_version.h?view=markup
-- 
Jan


From dev-return-84827-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Wed Dec  2 18:37:26 2015
Return-Path: <dev-return-84827-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id E665418657
	for <apmail-httpd-dev-archive@www.apache.org>; Wed,  2 Dec 2015 18:37:25 +0000 (UTC)
Received: (qmail 62767 invoked by uid 500); 2 Dec 2015 18:37:25 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 62694 invoked by uid 500); 2 Dec 2015 18:37:24 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 62684 invoked by uid 99); 2 Dec 2015 18:37:24 -0000
Received: from Unknown (HELO spamd2-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 02 Dec 2015 18:37:24 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd2-us-west.apache.org (ASF Mail Server at spamd2-us-west.apache.org) with ESMTP id 79CBE1A5BFF
	for <dev@httpd.apache.org>; Wed,  2 Dec 2015 18:37:24 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd2-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 0.999
X-Spam-Level:
X-Spam-Status: No, score=0.999 tagged_above=-999 required=6.31
	tests=[KAM_LAZY_DOMAIN_SECURITY=1, RCVD_IN_MSPIKE_H2=-0.001]
	autolearn=disabled
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd2-us-west.apache.org [10.40.0.9]) (amavisd-new, port 10024)
	with ESMTP id eT6laFfjE-OD for <dev@httpd.apache.org>;
	Wed,  2 Dec 2015 18:37:23 +0000 (UTC)
Received: from smtp.smtpout.orange.fr (smtp02.smtpout.orange.fr [80.12.242.124])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id C769521270
	for <dev@httpd.apache.org>; Wed,  2 Dec 2015 18:37:22 +0000 (UTC)
Received: from [127.0.0.1] ([92.140.249.156])
	by mwinf5d25 with ME
	id oidG1r0093PCbas03idG19; Wed, 02 Dec 2015 19:37:16 +0100
X-ME-Helo: [127.0.0.1]
X-ME-Date: Wed, 02 Dec 2015 19:37:16 +0100
X-ME-IP: 92.140.249.156
Subject: Re: svn commit: r1717123 -
 /httpd/httpd/trunk/docs/manual/mod/mod_allowmethods.xml
To: dev@httpd.apache.org
References: <20151129210033.1D4663A0234@svn01-us-west.apache.org>
 <565F0010.2060407@oracle.com>
From: Marion & Christophe JAILLET <christophe.jaillet@wanadoo.fr>
Message-ID: <565F3A5A.6050400@wanadoo.fr>
Date: Wed, 2 Dec 2015 19:37:14 +0100
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:38.0) Gecko/20100101
 Thunderbird/38.4.0
MIME-Version: 1.0
In-Reply-To: <565F0010.2060407@oracle.com>
Content-Type: text/plain; charset=utf-8; format=flowed
Content-Transfer-Encoding: 8bit
X-Antivirus: avast! (VPS 151202-1, 02/12/2015), Outbound message
X-Antivirus-Status: Clean

Will fix.
Sorry for not seeing it myself.

CJ

Le 02/12/2015 15:28, Mike Rumph a crit :
> Comment below.
>
> On 11/29/2015 1:00 PM, jailletc36@apache.org wrote:
>> Author: jailletc36
>> Date: Sun Nov 29 21:00:32 2015
>> New Revision: 1717123
>>
>> URL: http://svn.apache.org/viewvc?rev=1717123&view=rev
>> Log:
>> Fix doc as spotted by mat in online doc
>>
>> Modified:
>>      httpd/httpd/trunk/docs/manual/mod/mod_allowmethods.xml
>>
>> Modified: httpd/httpd/trunk/docs/manual/mod/mod_allowmethods.xml
>> URL: 
>> http://svn.apache.org/viewvc/httpd/httpd/trunk/docs/manual/mod/mod_allowmethods.xml?rev=1717123&r1=1717122&r2=1717123&view=diff
>> ============================================================================== 
>>
>> --- httpd/httpd/trunk/docs/manual/mod/mod_allowmethods.xml (original)
>> +++ httpd/httpd/trunk/docs/manual/mod/mod_allowmethods.xml Sun Nov 29 
>> 21:00:32 2015
>> @@ -39,7 +39,7 @@ in order for it to rebuild correctly.
>>       <summary>
>> -<p>This module makes it easy to restrict what HTTP methods can
>> +<p>This module makes it easy to restrict what HTTP methods can be
>>   used on an server. The most common configuration would be:</p>
> Should be "on a server".
>>     <highlight language="config">
>>
>>
>>
>
>


From dev-return-84828-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Wed Dec  2 20:53:47 2015
Return-Path: <dev-return-84828-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 83E2A18D80
	for <apmail-httpd-dev-archive@www.apache.org>; Wed,  2 Dec 2015 20:53:47 +0000 (UTC)
Received: (qmail 11188 invoked by uid 500); 2 Dec 2015 20:53:44 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 11112 invoked by uid 500); 2 Dec 2015 20:53:44 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 11102 invoked by uid 99); 2 Dec 2015 20:53:43 -0000
Received: from Unknown (HELO spamd3-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 02 Dec 2015 20:53:43 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd3-us-west.apache.org (ASF Mail Server at spamd3-us-west.apache.org) with ESMTP id 85BA818028D
	for <dev@httpd.apache.org>; Wed,  2 Dec 2015 20:53:43 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd3-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 3
X-Spam-Level: ***
X-Spam-Status: No, score=3 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, HTML_MESSAGE=3,
	RCVD_IN_MSPIKE_H2=-0.001, SPF_PASS=-0.001, URIBL_BLOCKED=0.001,
	WEIRD_PORT=0.001] autolearn=disabled
Authentication-Results: spamd3-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=rowe-clan-net.20150623.gappssmtp.com
Received: from mx1-us-west.apache.org ([10.40.0.8])
	by localhost (spamd3-us-west.apache.org [10.40.0.10]) (amavisd-new, port 10024)
	with ESMTP id xQN3g-HThgqz for <dev@httpd.apache.org>;
	Wed,  2 Dec 2015 20:53:36 +0000 (UTC)
Received: from mail-io0-f179.google.com (mail-io0-f179.google.com [209.85.223.179])
	by mx1-us-west.apache.org (ASF Mail Server at mx1-us-west.apache.org) with ESMTPS id DDC0320267
	for <dev@httpd.apache.org>; Wed,  2 Dec 2015 20:53:35 +0000 (UTC)
Received: by ioc74 with SMTP id 74so59279898ioc.2
        for <dev@httpd.apache.org>; Wed, 02 Dec 2015 12:53:35 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=rowe-clan-net.20150623.gappssmtp.com; s=20150623;
        h=mime-version:date:message-id:subject:from:to:content-type;
        bh=gnaaROB4/pvN54+NvsBwo+DOtgDp+Mix70BfB1nfErw=;
        b=fBgsj2vhXIhSukuYl3hGrGYztZxe/ql8bS0HhK838DrX3dl2RzZUAC4UFtDsSYleJF
         GtwQ8KmOhZhOyk4ly2+9s14yidn4OF7ym+90INq2SqjBTyX4AcL5cByUiYwXIXBNFpCO
         J/GY1wjVAOQ3fenmnyAox3lSQV7mUN/AuWDW6tDvyJS6zgyo3hQCJdusq3oHgeaYDX7A
         9oup6P/iw2B6RSSOQbMtYXzh6KplLWdtY6P2LqzGApYqCJAGMlI5udF1BflBA66mkRAV
         AR6MVuF+d/PWuMVVvmZ/2R4pE+HTRQcLZ+X9k6pwgSqvW8UxklRbWIivFJ7y7lWk4nwS
         oKcw==
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=1e100.net; s=20130820;
        h=x-gm-message-state:mime-version:date:message-id:subject:from:to
         :content-type;
        bh=gnaaROB4/pvN54+NvsBwo+DOtgDp+Mix70BfB1nfErw=;
        b=BgdEig2QuN6IRLms7uFQ5K2yuHLcCV1iMd3v0EGTbAZfIcV5jatC72G0eGytYhosDY
         gGL5kuy2/VTMEKeb/lYT5Gna9Ct/nTUnJkqD+RDLGCUUSXP0uXgEjJvWjBQpHfER9LEa
         hljIEOEsWhOV5D0lTK+BUNVhQSPjRZkDcb48gO+bhojfmfchnlZ+Ur3vEGbp5LliOWVT
         lM5IvYYzxmvdGdsoRSNPzo1Oz/gzNBT67LHnE+0d6nOhGbQNzshs7qj58b8eVz7tOQ7/
         quhdjGmcomy5UP0PWO0QtzprNUaMUtoiaaiDkGFefD4IDO4p8W57POhq7CXCNyDx33Z3
         vBJA==
X-Gm-Message-State: ALoCoQmbrdIkfrTHEon7aUCJUstCe4n0QzNxmA2BXpkwtXsvPKPt8dco+ecSyOVcULyhtCFWqNpU
MIME-Version: 1.0
X-Received: by 10.107.156.6 with SMTP id f6mr5480621ioe.163.1449089615271;
 Wed, 02 Dec 2015 12:53:35 -0800 (PST)
Received: by 10.107.62.136 with HTTP; Wed, 2 Dec 2015 12:53:35 -0800 (PST)
Date: Wed, 2 Dec 2015 14:53:35 -0600
Message-ID: <CACsi253w59mfpPJ96wE4Xc8S4sLSiifCCH-MxPrcx244g=dHyw@mail.gmail.com>
Subject: Broken 2.4 ./configure
From: William A Rowe Jr <wrowe@rowe-clan.net>
To: httpd <dev@httpd.apache.org>
Content-Type: multipart/alternative; boundary=001a1140ccc0c431a10525f077e3

--001a1140ccc0c431a10525f077e3
Content-Type: text/plain; charset=UTF-8

It seems nghttp2 1.2.1 is no longer supported?  If we are missing an
#include,
let's fix, and if we want to drop support, that's fine too, but ./configure
needs
to reject the invalid version of nghttp2.  This is the version shipping on
FC22...
nghttp2.x86_64                       1.2.1-1.fc22


checking for nghttp2... checking for user-provided nghttp2 base
directory... none
checking for pkg-config along ...   setting MOD_CFLAGS to ""
  setting ab_CFLAGS to ""
  setting MOD_LDFLAGS to ""
  setting MOD_LDFLAGS to ""
checking for nghttp2 version >= 1.0.0... OK
  setting MOD_LDFLAGS to "-lnghttp2   -luuid -lrt -lcrypt  -lpthread -ldl"
  setting LIBS to "-lnghttp2   -luuid -lrt -lcrypt  -lpthread -ldl"
  forcing ab_LDFLAGS to "-lnghttp2   -luuid -lrt -lcrypt  -lpthread -ldl"
checking nghttp2/nghttp2.h usability... yes
checking nghttp2/nghttp2.h presence... yes
checking for nghttp2/nghttp2.h... yes
checking for nghttp2_session_server_new2... yes
checking for nghttp2_session_change_stream_priority... no
yes
  setting MOD_HTTP2_LDADD to "-export-symbols-regex http2_module"
checking whether to enable mod_http2... shared (all)


/home/wrowe/dev/httpd-2.4/modules/http2/h2_session.c:104:31: error: unknown
type name 'nghttp2_stream'
 static int spri_cmp(int sid1, nghttp2_stream *s1,
                               ^
/home/wrowe/dev/httpd-2.4/modules/http2/h2_session.c:105:31: error: unknown
type name 'nghttp2_stream'
                     int sid2, nghttp2_stream *s2, h2_session *session)
                               ^
/home/wrowe/dev/httpd-2.4/modules/http2/h2_session.c: In function
'stream_pri_cmp':
/home/wrowe/dev/httpd-2.4/modules/http2/h2_session.c:133:5: error: unknown
type name 'nghttp2_stream'
     nghttp2_stream *s1, *s2;
     ^
/home/wrowe/dev/httpd-2.4/modules/http2/h2_session.c:135:10: warning:
implicit declaration of function 'nghttp2_session_find_stream'
[-Wimplicit-function-declaration]
     s1 = nghttp2_session_find_stream(session->ngh2, sid1);
          ^
/home/wrowe/dev/httpd-2.4/modules/http2/h2_session.c:135:8: warning:
assignment makes pointer from integer without a cast [-Wint-conversion]
     s1 = nghttp2_session_find_stream(session->ngh2, sid1);
        ^
/home/wrowe/dev/httpd-2.4/modules/http2/h2_session.c:136:8: warning:
assignment makes pointer from integer without a cast [-Wint-conversion]
     s2 = nghttp2_session_find_stream(session->ngh2, sid2);
        ^
/home/wrowe/dev/httpd-2.4/modules/http2/h2_session.c:147:12: warning:
implicit declaration of function 'spri_cmp'
[-Wimplicit-function-declaration]
     return spri_cmp(sid1, s1, sid2, s2, session);
            ^
/home/wrowe/dev/build/httpd24-apr15-ossl102/build/rules.mk:212: recipe for
target 'h2_session.slo' failed

--001a1140ccc0c431a10525f077e3
Content-Type: text/html; charset=UTF-8
Content-Transfer-Encoding: quoted-printable

<div dir=3D"ltr"><div>It seems nghttp2 1.2.1 is no longer supported?=C2=A0 =
If we are missing an #include,</div><div>let&#39;s fix, and if we want to d=
rop support, that&#39;s fine too, but ./configure needs</div><div>to reject=
 the invalid version of nghttp2.=C2=A0 This is the version shipping on FC22=
...</div><div>nghttp2.x86_64 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=
=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 1.2.1-1.fc22<br></div><div><br></div><div><=
br></div><div><div>checking for nghttp2... checking for user-provided nghtt=
p2 base directory... none</div><div>checking for pkg-config along ... =C2=
=A0 setting MOD_CFLAGS to &quot;&quot;</div><div>=C2=A0 setting ab_CFLAGS t=
o &quot;&quot;</div><div>=C2=A0 setting MOD_LDFLAGS to &quot;&quot;</div><d=
iv>=C2=A0 setting MOD_LDFLAGS to &quot;&quot;</div><div>checking for nghttp=
2 version &gt;=3D 1.0.0... OK</div><div>=C2=A0 setting MOD_LDFLAGS to &quot=
;-lnghttp2 =C2=A0 -luuid -lrt -lcrypt =C2=A0-lpthread -ldl&quot;</div><div>=
=C2=A0 setting LIBS to &quot;-lnghttp2 =C2=A0 -luuid -lrt -lcrypt =C2=A0-lp=
thread -ldl&quot;</div><div>=C2=A0 forcing ab_LDFLAGS to &quot;-lnghttp2 =
=C2=A0 -luuid -lrt -lcrypt =C2=A0-lpthread -ldl&quot;</div><div>checking ng=
http2/nghttp2.h usability... yes</div><div>checking nghttp2/nghttp2.h prese=
nce... yes</div><div>checking for nghttp2/nghttp2.h... yes</div><div>checki=
ng for nghttp2_session_server_new2... yes</div><div>checking for nghttp2_se=
ssion_change_stream_priority... no</div><div>yes</div><div>=C2=A0 setting M=
OD_HTTP2_LDADD to &quot;-export-symbols-regex http2_module&quot;</div><div>=
checking whether to enable mod_http2... shared (all)</div></div><div><br></=
div><div><br></div><div>/home/wrowe/dev/httpd-2.4/modules/http2/h2_session.=
c:104:31: error: unknown type name &#39;nghttp2_stream&#39;</div><div>=C2=
=A0static int spri_cmp(int sid1, nghttp2_stream *s1,=C2=A0</div><div>=C2=A0=
 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=
=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0^</div><div>/home/wrowe/dev/httpd-2.4/module=
s/http2/h2_session.c:105:31: error: unknown type name &#39;nghttp2_stream&#=
39;</div><div>=C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=
=A0 =C2=A0 =C2=A0int sid2, nghttp2_stream *s2, h2_session *session)</div><d=
iv>=C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =
=C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0^</div><div>/home/wrowe/dev/httpd-=
2.4/modules/http2/h2_session.c: In function &#39;stream_pri_cmp&#39;:</div>=
<div>/home/wrowe/dev/httpd-2.4/modules/http2/h2_session.c:133:5: error: unk=
nown type name &#39;nghttp2_stream&#39;</div><div>=C2=A0 =C2=A0 =C2=A0nghtt=
p2_stream *s1, *s2;</div><div>=C2=A0 =C2=A0 =C2=A0^</div><div>/home/wrowe/d=
ev/httpd-2.4/modules/http2/h2_session.c:135:10: warning: implicit declarati=
on of function &#39;nghttp2_session_find_stream&#39; [-Wimplicit-function-d=
eclaration]</div><div>=C2=A0 =C2=A0 =C2=A0s1 =3D nghttp2_session_find_strea=
m(session-&gt;ngh2, sid1);</div><div>=C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 ^</=
div><div>/home/wrowe/dev/httpd-2.4/modules/http2/h2_session.c:135:8: warnin=
g: assignment makes pointer from integer without a cast [-Wint-conversion]<=
/div><div>=C2=A0 =C2=A0 =C2=A0s1 =3D nghttp2_session_find_stream(session-&g=
t;ngh2, sid1);</div><div>=C2=A0 =C2=A0 =C2=A0 =C2=A0 ^</div><div>/home/wrow=
e/dev/httpd-2.4/modules/http2/h2_session.c:136:8: warning: assignment makes=
 pointer from integer without a cast [-Wint-conversion]</div><div>=C2=A0 =
=C2=A0 =C2=A0s2 =3D nghttp2_session_find_stream(session-&gt;ngh2, sid2);</d=
iv><div>=C2=A0 =C2=A0 =C2=A0 =C2=A0 ^</div><div>/home/wrowe/dev/httpd-2.4/m=
odules/http2/h2_session.c:147:12: warning: implicit declaration of function=
 &#39;spri_cmp&#39; [-Wimplicit-function-declaration]</div><div>=C2=A0 =C2=
=A0 =C2=A0return spri_cmp(sid1, s1, sid2, s2, session);</div><div>=C2=A0 =
=C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 ^</div><div>/home/wrowe/dev/build/httpd2=
4-apr15-ossl102/build/<a href=3D"http://rules.mk:212">rules.mk:212</a>: rec=
ipe for target &#39;h2_session.slo&#39; failed</div><div><br></div></div>

--001a1140ccc0c431a10525f077e3--

From dev-return-84829-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Wed Dec  2 21:06:39 2015
Return-Path: <dev-return-84829-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id C442F18E3D
	for <apmail-httpd-dev-archive@www.apache.org>; Wed,  2 Dec 2015 21:06:39 +0000 (UTC)
Received: (qmail 58487 invoked by uid 500); 2 Dec 2015 21:06:38 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 58422 invoked by uid 500); 2 Dec 2015 21:06:38 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 58404 invoked by uid 99); 2 Dec 2015 21:06:38 -0000
Received: from Unknown (HELO spamd1-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 02 Dec 2015 21:06:38 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd1-us-west.apache.org (ASF Mail Server at spamd1-us-west.apache.org) with ESMTP id B44EBC5F38
	for <dev@httpd.apache.org>; Wed,  2 Dec 2015 21:06:37 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd1-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.011
X-Spam-Level:
X-Spam-Status: No, score=-0.011 tagged_above=-999 required=6.31
	tests=[SPF_HELO_PASS=-0.001, SPF_PASS=-0.001, T_RP_MATCHES_RCVD=-0.01,
	URIBL_BLOCKED=0.001] autolearn=disabled
Received: from mx1-us-west.apache.org ([10.40.0.8])
	by localhost (spamd1-us-west.apache.org [10.40.0.7]) (amavisd-new, port 10024)
	with ESMTP id BEphNl_g7dGn for <dev@httpd.apache.org>;
	Wed,  2 Dec 2015 21:06:31 +0000 (UTC)
Received: from mail.thelounge.net (mail.thelounge.net [91.118.73.15])
	by mx1-us-west.apache.org (ASF Mail Server at mx1-us-west.apache.org) with ESMTPS id E16B220C34
	for <dev@httpd.apache.org>; Wed,  2 Dec 2015 21:06:30 +0000 (UTC)
Subject: Re: Broken 2.4 ./configure
To: dev@httpd.apache.org
References: <CACsi253w59mfpPJ96wE4Xc8S4sLSiifCCH-MxPrcx244g=dHyw@mail.gmail.com>
From: Reindl Harald <h.reindl@thelounge.net>
Openpgp: id=13540402D67A7F71C6E974EA866063CF7F780279;
 url=https://arrakis.thelounge.net/gpg/h.reindl_thelounge.net.pub.txt
X-Enigmail-Draft-Status: N1110
Organization: the lounge interactive design
Message-ID: <565F5D55.5020309@thelounge.net>
Date: Wed, 2 Dec 2015 22:06:29 +0100
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:38.0) Gecko/20100101
 Thunderbird/38.4.0
MIME-Version: 1.0
In-Reply-To: <CACsi253w59mfpPJ96wE4Xc8S4sLSiifCCH-MxPrcx244g=dHyw@mail.gmail.com>
Content-Type: multipart/signed; micalg=pgp-sha1;
 protocol="application/pgp-signature";
 boundary="cNkn6eaIJE8xcE7L21eEwumW0BgaBCTj2"

This is an OpenPGP/MIME signed message (RFC 4880 and 3156)
--cNkn6eaIJE8xcE7L21eEwumW0BgaBCTj2
Content-Type: text/plain; charset=utf-8; format=flowed
Content-Transfer-Encoding: quoted-printable



Am 02.12.2015 um 21:53 schrieb William A Rowe Jr:
> It seems nghttp2 1.2.1 is no longer supported?  If we are missing an
> #include,
> let's fix, and if we want to drop support, that's fine too, but
> ./configure needs
> to reject the invalid version of nghttp2.  This is the version shipping=

> on FC22...
> nghttp2.x86_64                       1.2.1-1.fc22

unconfirmed

[builduser@buildserver:~]$ rpm -q httpd
httpd-2.4.17-2.fc22.20151012.rh.x86_64

[builduser@buildserver:~]$ rpm -q libnghttp2-devel
libnghttp2-devel-1.2.1-1.fc22.x86_64

[builduser@buildserver:~]$ ls=20
/repo/fc22/x86_64/mod_http2-2.4.17-2.fc22.20151012.rh.x86_64.rpm
-rw-r--r-- 1 builduser builduser 81K 2015-10-12 12:44=20
/repo/fc22/x86_64/mod_http2-2.4.17-2.fc22.20151012.rh.x86_64.rpm

[builduser@buildserver:~]$ cat /rpmbuild/SPECS/httpd.spec | grep http2
BuildRequires:     libnghttp2-devel
%package -n        mod_http2
Summary:           mod_http2 for the Apache HTTP Server
Provides:          mod_http2 =3D %{version}-%{release}
%description -n    mod_http2
%files -n mod_http2
%{_libdir}/%{name}/modules/mod_http2.so


--cNkn6eaIJE8xcE7L21eEwumW0BgaBCTj2
Content-Type: application/pgp-signature; name="signature.asc"
Content-Description: OpenPGP digital signature
Content-Disposition: attachment; filename="signature.asc"

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v2

iEYEARECAAYFAlZfXVUACgkQhmBjz394Anmi1gCeKZ2KwqmC0deb0nuXpNEWrNM6
VgwAn1jexLa+WsguH2OUuh8fyAoG2Bqa
=+rGq
-----END PGP SIGNATURE-----

--cNkn6eaIJE8xcE7L21eEwumW0BgaBCTj2--

From dev-return-84830-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Wed Dec  2 22:16:36 2015
Return-Path: <dev-return-84830-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 4558B182BD
	for <apmail-httpd-dev-archive@www.apache.org>; Wed,  2 Dec 2015 22:16:36 +0000 (UTC)
Received: (qmail 10396 invoked by uid 500); 2 Dec 2015 22:16:30 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 10313 invoked by uid 500); 2 Dec 2015 22:16:30 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 10303 invoked by uid 99); 2 Dec 2015 22:16:30 -0000
Received: from Unknown (HELO spamd3-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 02 Dec 2015 22:16:30 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd3-us-west.apache.org (ASF Mail Server at spamd3-us-west.apache.org) with ESMTP id 6187518028B
	for <dev@httpd.apache.org>; Wed,  2 Dec 2015 22:16:30 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd3-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 2.999
X-Spam-Level: **
X-Spam-Status: No, score=2.999 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, HTML_MESSAGE=3,
	RCVD_IN_MSPIKE_H2=-0.001, SPF_PASS=-0.001, URIBL_BLOCKED=0.001]
	autolearn=disabled
Authentication-Results: spamd3-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=rowe-clan-net.20150623.gappssmtp.com
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd3-us-west.apache.org [10.40.0.10]) (amavisd-new, port 10024)
	with ESMTP id hs3tQU8HTRLE for <dev@httpd.apache.org>;
	Wed,  2 Dec 2015 22:16:23 +0000 (UTC)
Received: from mail-io0-f180.google.com (mail-io0-f180.google.com [209.85.223.180])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id 1244A2160F
	for <dev@httpd.apache.org>; Wed,  2 Dec 2015 22:16:23 +0000 (UTC)
Received: by iofh3 with SMTP id h3so61824230iof.3
        for <dev@httpd.apache.org>; Wed, 02 Dec 2015 14:16:22 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=rowe-clan-net.20150623.gappssmtp.com; s=20150623;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        bh=81YzynCAAssAkX3XTFeEauJ3/utBz6//rSxKobNWK6w=;
        b=ZbWJIaonZ7UjQI2tb7cpMtueg/toP2OpZtKT1piEbH6DfMwgjcEEygVpUYHjlDvvnx
         l+nSzPCxNs+qT7Sd5fiYz6KfJBQgtL4VEkU+WU0AmyxTD3koW15GVz3zV+ZEzSvcVTDs
         Z6vyljuV5nJ/rorj+AFtDhzFcXyIZy5lS7mjnV37rfSCnInnGY3F2QTH8epIahsWkY7m
         QpghVLeP87I9xVRonPGdKLp2p3i8TcuSHZOUqidJb2/TeZwggSG02fW0LzqMhHjoZH/s
         QCP7RUNGWSHm+4dy8BJeTq2U/irb1qrQkeYefvRAv+qKBoF1rXl/ODh8a7hzE4MeH9vI
         gEkQ==
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=1e100.net; s=20130820;
        h=x-gm-message-state:mime-version:in-reply-to:references:date
         :message-id:subject:from:to:content-type;
        bh=81YzynCAAssAkX3XTFeEauJ3/utBz6//rSxKobNWK6w=;
        b=RV6uoc4dSNqU5BJb60jH9U2TTN17WhZnKGxFbU1gnKdO5G8kMDj2/Jze4RUoz9zp1f
         7jMwnzRxGizwd2/KHV2aohhFhVI8eXw94fUQt62Dgy1QpVolH88EvTdoAWcun8ImlQEF
         NhcT4/yTxx/QzQdPpaCzPmoKSLkUQ4vIHWgF1tcJmqBt5T3Dx1IGtw+voVbRvyrKoUta
         Lc4rASOx6NWTAKTXaCIxITCHpEKBAp+ekXa+D8cGg+aym5TNjwhWvsE5zVrWFTlBGPEL
         dtXcCqSC6KlwJVAbuz08zdDD4g+b2NQ3goQb7MKpv+ZjqvbYo1VSX2VE6aS99PxFE1Lr
         ZibA==
X-Gm-Message-State: ALoCoQm8am3mqKSu1tIJiDU07OC/FY9Eli4d0lUFS6oqTnnrHLmCvCt66UsQBJotPiNcHXbOp9FZ
MIME-Version: 1.0
X-Received: by 10.107.34.199 with SMTP id i190mr6027073ioi.150.1449094581999;
 Wed, 02 Dec 2015 14:16:21 -0800 (PST)
Received: by 10.107.62.136 with HTTP; Wed, 2 Dec 2015 14:16:21 -0800 (PST)
In-Reply-To: <565F5D55.5020309@thelounge.net>
References: <CACsi253w59mfpPJ96wE4Xc8S4sLSiifCCH-MxPrcx244g=dHyw@mail.gmail.com>
	<565F5D55.5020309@thelounge.net>
Date: Wed, 2 Dec 2015 16:16:21 -0600
Message-ID: <CACsi252Cwx0HbA-9F+4kBirkkFVD6LD-fDmHSWMer_4rJ6GmTA@mail.gmail.com>
Subject: Re: Broken 2.4 ./configure
From: William A Rowe Jr <wrowe@rowe-clan.net>
To: httpd <dev@httpd.apache.org>
Content-Type: multipart/alternative; boundary=001a1140d944ce782a0525f19f07

--001a1140d944ce782a0525f19f07
Content-Type: text/plain; charset=UTF-8

On Wed, Dec 2, 2015 at 3:06 PM, Reindl Harald <h.reindl@thelounge.net>
wrote:

>
> Am 02.12.2015 um 21:53 schrieb William A Rowe Jr:
>
>> It seems nghttp2 1.2.1 is no longer supported?  If we are missing an
>> #include, let's fix, and if we want to drop support, that's fine too, but
>> ./configure needs to reject the invalid version of nghttp2.
>
>
Note that we couldn't normally drop support for an older nghttp2,
but mod_http2 was clearly tagged as experimental, so packagers
who pick it up and enable it are responsible for keeping up.

Reindl identifies one distribution that will be immediately burned
by picking up 2.4.18 without also bumping nghttp2 to 1.3 or later...

This is the version shipping on FC22...
>> nghttp2.x86_64                       1.2.1-1.fc22
>>
>
> unconfirmed
>
> [builduser@buildserver:~]$ rpm -q httpd
> httpd-2.4.17-2.fc22.20151012.rh.x86_64
>

We are on two different pages, I'm speaking of branches/2.4.x at 2.4.18-dev,
based on current backports.  I wasn't commenting on the previous release.

--001a1140d944ce782a0525f19f07
Content-Type: text/html; charset=UTF-8
Content-Transfer-Encoding: quoted-printable

<div dir=3D"ltr"><div class=3D"gmail_extra"><div class=3D"gmail_quote">On W=
ed, Dec 2, 2015 at 3:06 PM, Reindl Harald <span dir=3D"ltr">&lt;<a href=3D"=
mailto:h.reindl@thelounge.net" target=3D"_blank">h.reindl@thelounge.net</a>=
&gt;</span> wrote:<br><blockquote class=3D"gmail_quote" style=3D"margin:0 0=
 0 .8ex;border-left:1px #ccc solid;padding-left:1ex"><span class=3D""><br>
Am 02.12.2015 um 21:53 schrieb William A Rowe Jr:<br>
<blockquote class=3D"gmail_quote" style=3D"margin:0 0 0 .8ex;border-left:1p=
x #ccc solid;padding-left:1ex">
It seems nghttp2 1.2.1 is no longer supported?=C2=A0 If we are missing an<b=
r>
#include,=C2=A0let&#39;s fix, and if we want to drop support, that&#39;s fi=
ne too, but<br>
./configure needs=C2=A0to reject the invalid version of nghttp2.</blockquot=
e></span></blockquote><div>=C2=A0</div><div>Note that we couldn&#39;t norma=
lly drop support for an older nghttp2,=C2=A0</div><div>but mod_http2 was cl=
early tagged as experimental, so packagers</div><div>who pick it up and ena=
ble it are responsible for keeping up.</div><div><br></div><div>Reindl iden=
tifies one distribution that will be immediately burned</div><div>by pickin=
g up 2.4.18 without also bumping nghttp2 to 1.3 or later...</div><div><br><=
/div><blockquote class=3D"gmail_quote" style=3D"margin:0 0 0 .8ex;border-le=
ft:1px #ccc solid;padding-left:1ex"><span class=3D""><blockquote class=3D"g=
mail_quote" style=3D"margin:0 0 0 .8ex;border-left:1px #ccc solid;padding-l=
eft:1ex">This is the version shipping=C2=A0on FC22...<br>
nghttp2.x86_64=C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=
=A0 =C2=A0 =C2=A0 =C2=A01.2.1-1.fc22<br>
</blockquote>
<br></span>
unconfirmed<br>
<br>
[builduser@buildserver:~]$ rpm -q httpd<br>
httpd-2.4.17-2.fc22.20151012.rh.x86_64<br></blockquote><div><br></div><div>=
We are on two different pages, I&#39;m speaking of branches/2.4.x at 2.4.18=
-dev,</div><div>based on current backports.=C2=A0 I wasn&#39;t commenting o=
n the previous release.=C2=A0</div></div><br></div></div>

--001a1140d944ce782a0525f19f07--

From dev-return-84831-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Wed Dec  2 23:25:13 2015
Return-Path: <dev-return-84831-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 50781186EE
	for <apmail-httpd-dev-archive@www.apache.org>; Wed,  2 Dec 2015 23:25:13 +0000 (UTC)
Received: (qmail 4913 invoked by uid 500); 2 Dec 2015 23:25:00 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 4826 invoked by uid 500); 2 Dec 2015 23:25:00 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 4814 invoked by uid 99); 2 Dec 2015 23:25:00 -0000
Received: from Unknown (HELO spamd4-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 02 Dec 2015 23:25:00 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd4-us-west.apache.org (ASF Mail Server at spamd4-us-west.apache.org) with ESMTP id B2667C059B
	for <dev@httpd.apache.org>; Wed,  2 Dec 2015 23:24:59 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd4-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 2.347
X-Spam-Level: **
X-Spam-Status: No, score=2.347 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	HTML_MESSAGE=3, MIME_QP_LONG_LINE=0.001, RP_MATCHES_RCVD=-0.554,
	SPF_PASS=-0.001, URIBL_BLOCKED=0.001] autolearn=disabled
Authentication-Results: spamd4-us-west.apache.org (amavisd-new);
	dkim=pass (1024-bit key) header.d=greenbytes.de
Received: from mx1-us-west.apache.org ([10.40.0.8])
	by localhost (spamd4-us-west.apache.org [10.40.0.11]) (amavisd-new, port 10024)
	with ESMTP id hHMTyDdBQhnU for <dev@httpd.apache.org>;
	Wed,  2 Dec 2015 23:24:50 +0000 (UTC)
Received: from mail.greenbytes.de (mail.greenbytes.de [217.91.35.233])
	by mx1-us-west.apache.org (ASF Mail Server at mx1-us-west.apache.org) with ESMTPS id ADF7621627
	for <dev@httpd.apache.org>; Wed,  2 Dec 2015 23:24:49 +0000 (UTC)
Received: from [192.168.178.61] (unknown [93.211.117.183])
	(using TLSv1 with cipher ECDHE-RSA-AES256-SHA (256/256 bits))
	(Client did not present a certificate)
	by mail.greenbytes.de (Postfix) with ESMTPSA id 3BF0E15A035E
	for <dev@httpd.apache.org>; Thu,  3 Dec 2015 00:24:47 +0100 (CET)
DKIM-Signature: v=1; a=rsa-sha256; c=simple/simple; d=greenbytes.de; s=mail;
	t=1449098687; bh=WIRhsX+zodJgL5uaYW2+0DuALJ04gpNt/FCD7GnnyUQ=;
	h=From:Subject:Date:References:In-Reply-To:To:From;
	b=HdcwYozxsJ6ETc5aW/M16PbctpGJpvu9xl69waMfleiTh4UEeqLMGUjF6nq+6570n
	 rEtN+Ak5O+i3fCyS4xJRehykqWUb8YKTTj8VVYjEhPiCtUI8zxPLIfSFJ7yEqMp/pp
	 seqbiTd7MOfjYLu3yIfVnsl1HimecA8U/wozS9z0=
From: Stefan Eissing <stefan.eissing@greenbytes.de>
Content-Type: multipart/alternative;
	boundary=Apple-Mail-5158210A-3ACE-4A0B-BCA8-BF23BE68DCF1
Content-Transfer-Encoding: 7bit
Mime-Version: 1.0 (1.0)
Subject: Re: Broken 2.4 ./configure
Message-Id: <07B73602-4BB5-42E1-B02E-F0F7DA202AA2@greenbytes.de>
Date: Thu, 3 Dec 2015 00:24:46 +0100
References: <CACsi253w59mfpPJ96wE4Xc8S4sLSiifCCH-MxPrcx244g=dHyw@mail.gmail.com> <565F5D55.5020309@thelounge.net> <CACsi252Cwx0HbA-9F+4kBirkkFVD6LD-fDmHSWMer_4rJ6GmTA@mail.gmail.com>
In-Reply-To: <CACsi252Cwx0HbA-9F+4kBirkkFVD6LD-fDmHSWMer_4rJ6GmTA@mail.gmail.com>
To: dev@httpd.apache.org
X-Mailer: iPhone Mail (13B143)


--Apple-Mail-5158210A-3ACE-4A0B-BCA8-BF23BE68DCF1
Content-Type: text/plain;
	charset=us-ascii
Content-Transfer-Encoding: quoted-printable

I put it on my TODO for friday, maybe I can conf/ifdef around it without too=
 much pain.=20

> Am 02.12.2015 um 23:16 schrieb William A Rowe Jr <wrowe@rowe-clan.net>:
>=20
>> On Wed, Dec 2, 2015 at 3:06 PM, Reindl Harald <h.reindl@thelounge.net> wr=
ote:
>>=20
>>> Am 02.12.2015 um 21:53 schrieb William A Rowe Jr:
>>> It seems nghttp2 1.2.1 is no longer supported?  If we are missing an
>>> #include, let's fix, and if we want to drop support, that's fine too, bu=
t
>>> ./configure needs to reject the invalid version of nghttp2.
> =20
> Note that we couldn't normally drop support for an older nghttp2,=20
> but mod_http2 was clearly tagged as experimental, so packagers
> who pick it up and enable it are responsible for keeping up.
>=20
> Reindl identifies one distribution that will be immediately burned
> by picking up 2.4.18 without also bumping nghttp2 to 1.3 or later...
>=20
>>> This is the version shipping on FC22...
>>> nghttp2.x86_64                       1.2.1-1.fc22
>>=20
>> unconfirmed
>>=20
>> [builduser@buildserver:~]$ rpm -q httpd
>> httpd-2.4.17-2.fc22.20151012.rh.x86_64
>=20
> We are on two different pages, I'm speaking of branches/2.4.x at 2.4.18-de=
v,
> based on current backports.  I wasn't commenting on the previous release.=20=

>=20

--Apple-Mail-5158210A-3ACE-4A0B-BCA8-BF23BE68DCF1
Content-Type: text/html;
	charset=utf-8
Content-Transfer-Encoding: 7bit

<html><head><meta http-equiv="content-type" content="text/html; charset=utf-8"></head><body dir="auto"><div></div><div>I put it on my TODO for friday, maybe I can conf/ifdef around it without too much pain.&nbsp;</div><div><br>Am 02.12.2015 um 23:16 schrieb William A Rowe Jr &lt;<a href="mailto:wrowe@rowe-clan.net">wrowe@rowe-clan.net</a>&gt;:<br><br></div><blockquote type="cite"><div><div dir="ltr"><div class="gmail_extra"><div class="gmail_quote">On Wed, Dec 2, 2015 at 3:06 PM, Reindl Harald <span dir="ltr">&lt;<a href="mailto:h.reindl@thelounge.net" target="_blank">h.reindl@thelounge.net</a>&gt;</span> wrote:<br><blockquote class="gmail_quote" style="margin:0 0 0 .8ex;border-left:1px #ccc solid;padding-left:1ex"><span class=""><br>
Am 02.12.2015 um 21:53 schrieb William A Rowe Jr:<br>
<blockquote class="gmail_quote" style="margin:0 0 0 .8ex;border-left:1px #ccc solid;padding-left:1ex">
It seems nghttp2 1.2.1 is no longer supported?&nbsp; If we are missing an<br>
#include,&nbsp;let's fix, and if we want to drop support, that's fine too, but<br>
./configure needs&nbsp;to reject the invalid version of nghttp2.</blockquote></span></blockquote><div>&nbsp;</div><div>Note that we couldn't normally drop support for an older nghttp2,&nbsp;</div><div>but mod_http2 was clearly tagged as experimental, so packagers</div><div>who pick it up and enable it are responsible for keeping up.</div><div><br></div><div>Reindl identifies one distribution that will be immediately burned</div><div>by picking up 2.4.18 without also bumping nghttp2 to 1.3 or later...</div><div><br></div><blockquote class="gmail_quote" style="margin:0 0 0 .8ex;border-left:1px #ccc solid;padding-left:1ex"><span class=""><blockquote class="gmail_quote" style="margin:0 0 0 .8ex;border-left:1px #ccc solid;padding-left:1ex">This is the version shipping&nbsp;on FC22...<br>
nghttp2.x86_64&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;1.2.1-1.fc22<br>
</blockquote>
<br></span>
unconfirmed<br>
<br>
[builduser@buildserver:~]$ rpm -q httpd<br>
httpd-2.4.17-2.fc22.20151012.rh.x86_64<br></blockquote><div><br></div><div>We are on two different pages, I'm speaking of branches/2.4.x at 2.4.18-dev,</div><div>based on current backports.&nbsp; I wasn't commenting on the previous release.&nbsp;</div></div><br></div></div>
</div></blockquote></body></html>
--Apple-Mail-5158210A-3ACE-4A0B-BCA8-BF23BE68DCF1--

From dev-return-84832-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Thu Dec  3 00:34:44 2015
Return-Path: <dev-return-84832-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 4AF1218A29
	for <apmail-httpd-dev-archive@www.apache.org>; Thu,  3 Dec 2015 00:34:44 +0000 (UTC)
Received: (qmail 62645 invoked by uid 500); 3 Dec 2015 00:34:43 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 62563 invoked by uid 500); 3 Dec 2015 00:34:43 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 62553 invoked by uid 99); 3 Dec 2015 00:34:43 -0000
Received: from Unknown (HELO spamd4-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 03 Dec 2015 00:34:43 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd4-us-west.apache.org (ASF Mail Server at spamd4-us-west.apache.org) with ESMTP id 4D4B1C0473
	for <dev@httpd.apache.org>; Thu,  3 Dec 2015 00:34:43 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd4-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 2.999
X-Spam-Level: **
X-Spam-Status: No, score=2.999 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, HTML_MESSAGE=3,
	RCVD_IN_MSPIKE_H2=-0.001, SPF_PASS=-0.001, URIBL_BLOCKED=0.001]
	autolearn=disabled
Authentication-Results: spamd4-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=rowe-clan-net.20150623.gappssmtp.com
Received: from mx1-us-west.apache.org ([10.40.0.8])
	by localhost (spamd4-us-west.apache.org [10.40.0.11]) (amavisd-new, port 10024)
	with ESMTP id RAmivP1bawWY for <dev@httpd.apache.org>;
	Thu,  3 Dec 2015 00:34:37 +0000 (UTC)
Received: from mail-io0-f169.google.com (mail-io0-f169.google.com [209.85.223.169])
	by mx1-us-west.apache.org (ASF Mail Server at mx1-us-west.apache.org) with ESMTPS id 19D0230E1E
	for <dev@httpd.apache.org>; Thu,  3 Dec 2015 00:34:37 +0000 (UTC)
Received: by iofh3 with SMTP id h3so64819455iof.3
        for <dev@httpd.apache.org>; Wed, 02 Dec 2015 16:34:36 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=rowe-clan-net.20150623.gappssmtp.com; s=20150623;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        bh=pfmd43aSZItHUv5i9gmb7+t8iWG19d04ZQcklYpcKAg=;
        b=oG+BumE9JA3IJcJft7L0kLmB/pfEFX+m5ppOJe4ppu4ImYOTIF2FROYHraPNEMA9nm
         1pHvY/Ax1w4Pt2IFKFmfMVUF7WYvDGrekqSFh5TvHy2gTn6iRGnQfoOkObT5xE03K2dY
         orJOD1JSGoNtFiiZLYIuOK7JhXT0v45GaBSsPnkoMhk83ZavsLN7tqFvS/tsBsBeGe/P
         qybHuHjhcpvhjJz4I9xNRjODKl+ZEIp4xA7XVou9j0GOr+hCbN7IprtFUN7M7TuMVHRZ
         MWzhMfrj87L30AOMnW8yCXfwzi82FBE8R4oxrbKbIuYUKkI69Y+MiP/6SH1mpE010/rg
         c3nQ==
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=1e100.net; s=20130820;
        h=x-gm-message-state:mime-version:in-reply-to:references:date
         :message-id:subject:from:to:content-type;
        bh=pfmd43aSZItHUv5i9gmb7+t8iWG19d04ZQcklYpcKAg=;
        b=mp+asVoM2FEKhrXeytEhdK+m03gIX/PRO3OV58yCZYr8JmaWHqIQN9K6DhAm82KNqw
         lDgEveSX1Owa3YWDmWwBVl+Bd0N22j5IbHqf9YL/L9vrgiyPzltqEpBBO1k4UuyzEQJn
         +PPkxR35EPj6XQosnQ0HsARs8LHaGcK7iEnlDHAA/V8DYU3bD1M//mwn3Ywo56oQMmGC
         j1rj4OxYxC33KhN7h+tlc4z2RLQog3sJXj/zv6mQMbRqF3uvdya0hadVKWQNipTr2IzA
         GATnU6kTTqQzvC0tGZwpqCVqJCBdA3t3hHkBmey/y0TybSoV2IlAZdVgWOs1sV056cN3
         gUVg==
X-Gm-Message-State: ALoCoQkBKeDwetA64dObPPyTqsvX5xsqHi9N1mhWQ5zaEMIjqqLm4qxk/W/2Z6iwg/kCjVTEm/Mx
MIME-Version: 1.0
X-Received: by 10.107.10.66 with SMTP id u63mr5886831ioi.86.1449102876490;
 Wed, 02 Dec 2015 16:34:36 -0800 (PST)
Received: by 10.107.62.136 with HTTP; Wed, 2 Dec 2015 16:34:36 -0800 (PST)
Received: by 10.107.62.136 with HTTP; Wed, 2 Dec 2015 16:34:36 -0800 (PST)
In-Reply-To: <07B73602-4BB5-42E1-B02E-F0F7DA202AA2@greenbytes.de>
References: <CACsi253w59mfpPJ96wE4Xc8S4sLSiifCCH-MxPrcx244g=dHyw@mail.gmail.com>
	<565F5D55.5020309@thelounge.net>
	<CACsi252Cwx0HbA-9F+4kBirkkFVD6LD-fDmHSWMer_4rJ6GmTA@mail.gmail.com>
	<07B73602-4BB5-42E1-B02E-F0F7DA202AA2@greenbytes.de>
Date: Wed, 2 Dec 2015 18:34:36 -0600
Message-ID: <CACsi252KwqGLx461wAABpSSmOUpncj-FCMUReuWf+0=VjUrepg@mail.gmail.com>
Subject: Re: Broken 2.4 ./configure
From: William A Rowe Jr <wrowe@rowe-clan.net>
To: httpd <dev@httpd.apache.org>
Content-Type: multipart/alternative; boundary=001a113f93be3256e90525f38ec6

--001a113f93be3256e90525f38ec6
Content-Type: text/plain; charset=UTF-8

On Dec 2, 2015 17:25, "Stefan Eissing" <stefan.eissing@greenbytes.de> wrote:
>
> I put it on my TODO for friday, maybe I can conf/ifdef around it without
too much pain.

If we lose functionality between nghttp2 1.x (bare minimum) and 1.y
(optimal, supports all mod_http2 functionality), we might set the minimum
rev 1.x allowed to enable mod_http2, but emit a stderr warning at configure
(and perhaps compilation) if version 1.y is not detected.

--001a113f93be3256e90525f38ec6
Content-Type: text/html; charset=UTF-8
Content-Transfer-Encoding: quoted-printable

<p dir=3D"ltr">On Dec 2, 2015 17:25, &quot;Stefan Eissing&quot; &lt;<a href=
=3D"mailto:stefan.eissing@greenbytes.de">stefan.eissing@greenbytes.de</a>&g=
t; wrote:<br>
&gt;<br>
&gt; I put it on my TODO for friday, maybe I can conf/ifdef around it witho=
ut too much pain.=C2=A0</p>
<p dir=3D"ltr">If we lose functionality between nghttp2 1.x (bare minimum) =
and 1.y (optimal, supports all mod_http2 functionality), we might set the m=
inimum rev 1.x allowed to enable mod_http2, but emit a stderr warning at co=
nfigure (and perhaps compilation) if version 1.y is not detected.</p>

--001a113f93be3256e90525f38ec6--

From dev-return-84833-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Thu Dec  3 14:59:20 2015
Return-Path: <dev-return-84833-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 32ECA188FE
	for <apmail-httpd-dev-archive@www.apache.org>; Thu,  3 Dec 2015 14:59:20 +0000 (UTC)
Received: (qmail 23428 invoked by uid 500); 3 Dec 2015 14:59:16 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 23351 invoked by uid 500); 3 Dec 2015 14:59:16 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 23341 invoked by uid 99); 3 Dec 2015 14:59:16 -0000
Received: from Unknown (HELO spamd1-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 03 Dec 2015 14:59:16 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd1-us-west.apache.org (ASF Mail Server at spamd1-us-west.apache.org) with ESMTP id 2F2D2C44AD
	for <dev@httpd.apache.org>; Thu,  3 Dec 2015 14:59:16 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd1-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 0.652
X-Spam-Level:
X-Spam-Status: No, score=0.652 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, SPF_NEUTRAL=0.652]
	autolearn=disabled
Authentication-Results: spamd1-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=comcast.net
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd1-us-west.apache.org [10.40.0.7]) (amavisd-new, port 10024)
	with ESMTP id WWDc76TtgKxW for <dev@httpd.apache.org>;
	Thu,  3 Dec 2015 14:59:09 +0000 (UTC)
Received: from resqmta-ch2-07v.sys.comcast.net (resqmta-ch2-07v.sys.comcast.net [69.252.207.39])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id C40062050F
	for <dev@httpd.apache.org>; Thu,  3 Dec 2015 14:59:08 +0000 (UTC)
Received: from resomta-ch2-04v.sys.comcast.net ([69.252.207.100])
	by resqmta-ch2-07v.sys.comcast.net with comcast
	id p2yD1r0042AWL2D012z1kR; Thu, 03 Dec 2015 14:59:01 +0000
Received: from [192.168.199.10] ([69.251.84.114])
	by resomta-ch2-04v.sys.comcast.net with comcast
	id p2z01r00E2U0RYt012z09t; Thu, 03 Dec 2015 14:59:01 +0000
From: Jim Jagielski <jim@jaguNET.com>
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
Subject: reverse proxy wishlist
Message-Id: <288293CD-6D82-42E0-BFC9-9DC25F969ED6@jaguNET.com>
Date: Thu, 3 Dec 2015 09:59:00 -0500
To: httpd <dev@httpd.apache.org>
Mime-Version: 1.0 (Mac OS X Mail 8.2 \(2104\))
X-Mailer: Apple Mail (2.2104)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=comcast.net;
	s=q20140121; t=1449154741;
	bh=l46zLWvBGk05W1yJrgaingUbvA/mfPFNGthmF/h+WkM=;
	h=Received:Received:From:Content-Type:Subject:Message-Id:Date:To:
	 Mime-Version;
	b=EmotJUhsPLGezTSit8CDlM169QdqGGlg7p7RWHxSKSOzOFm1K+c215VL8cxscQpHx
	 TDodhwnXGWqP0ByNmFoADeG3q931m7Zwdd9KC2E2ZbXSnRlZ3+CpbSEIwuPjQOGgKH
	 7fMa91N9zmJrWU9DZVNMFoXT31CPVmTWLOX/g1PHo9aM5GIE0wb3bf1FkmHG3MagdZ
	 RAfKxcf0ex+7iU04AZfQ8j4xbjVrkvCdlBIL/vHkCCCUMK8Lpa5HgqU0YDhd3xdNtk
	 iJVIT7VpcO5LcmBfQQWfKWvFu9fvmAVWsns/WBqABGs5ulQbcVQbQcIXBy9xqeHbv5
	 1kPollsKK8Thw==

I put out a call on Twitter regarding this, but wanted to
close the loop here as well.

What would *you* like to see as new features or enhancements
w/ mod_proxy, esp reverse proxy. I was thinking about some
sort of active backend monitoring, utilizing watchdog, which
could also maybe, eventually, pull in performance and load
data for the backend for a more accurate LB provider. But
what about new LB methods? Any ideas there?

tia.

From dev-return-84834-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Thu Dec  3 15:50:50 2015
Return-Path: <dev-return-84834-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 6C9D618B23
	for <apmail-httpd-dev-archive@www.apache.org>; Thu,  3 Dec 2015 15:50:50 +0000 (UTC)
Received: (qmail 80613 invoked by uid 500); 3 Dec 2015 15:50:49 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 80521 invoked by uid 500); 3 Dec 2015 15:50:49 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 80511 invoked by uid 99); 3 Dec 2015 15:50:49 -0000
Received: from Unknown (HELO spamd4-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 03 Dec 2015 15:50:49 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd4-us-west.apache.org (ASF Mail Server at spamd4-us-west.apache.org) with ESMTP id 3F3D5C059C
	for <dev@httpd.apache.org>; Thu,  3 Dec 2015 15:50:49 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd4-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 0.998
X-Spam-Level:
X-Spam-Status: No, score=0.998 tagged_above=-999 required=6.31
	tests=[KAM_LAZY_DOMAIN_SECURITY=1, RCVD_IN_MSPIKE_H2=-0.001,
	SPF_HELO_PASS=-0.001] autolearn=disabled
Received: from mx1-us-west.apache.org ([10.40.0.8])
	by localhost (spamd4-us-west.apache.org [10.40.0.11]) (amavisd-new, port 10024)
	with ESMTP id V_DDsa9uUx3D for <dev@httpd.apache.org>;
	Thu,  3 Dec 2015 15:50:38 +0000 (UTC)
Received: from mail1.bemta14.messagelabs.com (mail1.bemta14.messagelabs.com [193.109.254.113])
	by mx1-us-west.apache.org (ASF Mail Server at mx1-us-west.apache.org) with ESMTPS id 91431201F7
	for <dev@httpd.apache.org>; Thu,  3 Dec 2015 15:50:37 +0000 (UTC)
Received: from [193.109.254.3] by server-9.bemta-14.messagelabs.com id F7/FA-13475-6C460665; Thu, 03 Dec 2015 15:50:30 +0000
X-Env-Sender: ruediger.pluem@vodafone.com
X-Msg-Ref: server-5.tower-184.messagelabs.com!1449157829!8749126!1
X-Originating-IP: [195.232.244.136]
X-StarScan-Received:
X-StarScan-Version: 7.35; banners=-,-,-
X-VirusChecked: Checked
Received: (qmail 25641 invoked from network); 3 Dec 2015 15:50:30 -0000
Received: from mailout04.vodafone.com (HELO mailout04.vodafone.com) (195.232.244.136)
  by server-5.tower-184.messagelabs.com with DHE-RSA-AES256-SHA encrypted SMTP; 3 Dec 2015 15:50:30 -0000
Received: from mailint04.vodafone.com (mailint04.vodafone.com [195.232.244.201])
	by mailout04.vodafone.com (Postfix) with ESMTP id 3pBM7n60ldznTZ3
	for <dev@httpd.apache.org>; Thu,  3 Dec 2015 16:50:29 +0100 (CET)
Received: from mailint04.vodafone.com (localhost [127.0.0.1])
	by mailint04.vodafone.com (Postfix) with ESMTP id 3pBM7n50w3zfZJJ
	for <dev@httpd.apache.org>; Thu,  3 Dec 2015 16:50:29 +0100 (CET)
Received: from VOEXC03W.internal.vodafone.com (voexc03w.dc-ratingen.de [145.230.101.23])
	(using TLSv1 with cipher AES128-SHA (128/128 bits))
	(No client certificate requested)
	by mailint04.vodafone.com (Postfix) with ESMTPS id 3pBM7n3lB3zfb5Z
	for <dev@httpd.apache.org>; Thu,  3 Dec 2015 16:50:29 +0100 (CET)
Received: from VOEXC26W.internal.vodafone.com (145.230.103.198) by
 VOEXC03W.internal.vodafone.com (145.230.101.23) with Microsoft SMTP Server
 (TLS) id 14.3.224.2; Thu, 3 Dec 2015 16:50:27 +0100
Received: from VOEXM10W.internal.vodafone.com ([169.254.2.138]) by voexc26w
 ([145.230.103.198]) with mapi id 14.03.0224.002; Thu, 3 Dec 2015 16:50:26
 +0100
From: =?iso-8859-1?Q?Pl=FCm=2C_R=FCdiger=2C_Vodafone_Group?=
	<ruediger.pluem@vodafone.com>
To: "dev@httpd.apache.org" <dev@httpd.apache.org>
Subject: AW: reverse proxy wishlist
Thread-Topic: reverse proxy wishlist
Thread-Index: AQHRLduD1o/yAsMyvkq08CJ4vkw8xZ65aMgA
Date: Thu, 3 Dec 2015 15:50:25 +0000
Message-ID: <AB1691BE05AE7F4992697F2A0835627AC63B8989@VOEXM10W.internal.vodafone.com>
References: <288293CD-6D82-42E0-BFC9-9DC25F969ED6@jaguNET.com>
In-Reply-To: <288293CD-6D82-42E0-BFC9-9DC25F969ED6@jaguNET.com>
Accept-Language: en-US
Content-Language: de-DE
X-MS-Has-Attach:
X-MS-TNEF-Correlator:
Content-Type: text/plain; charset="iso-8859-1"
Content-Transfer-Encoding: quoted-printable
MIME-Version: 1.0

How about an async proxy that frees up the thread while waiting on a slow b=
ackend?

Regards

R=FCdiger

> -----Urspr=FCngliche Nachricht-----
> Von: Jim Jagielski [mailto:jim@jaguNET.com]
> Gesendet: Donnerstag, 3. Dezember 2015 15:59
> An: httpd <dev@httpd.apache.org>
> Betreff: reverse proxy wishlist
>=20
> I put out a call on Twitter regarding this, but wanted to
> close the loop here as well.
>=20
> What would *you* like to see as new features or enhancements
> w/ mod_proxy, esp reverse proxy. I was thinking about some
> sort of active backend monitoring, utilizing watchdog, which
> could also maybe, eventually, pull in performance and load
> data for the backend for a more accurate LB provider. But
> what about new LB methods? Any ideas there?
>=20
> tia.

From dev-return-84835-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Thu Dec  3 16:09:26 2015
Return-Path: <dev-return-84835-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 0EDC518C41
	for <apmail-httpd-dev-archive@www.apache.org>; Thu,  3 Dec 2015 16:09:26 +0000 (UTC)
Received: (qmail 64627 invoked by uid 500); 3 Dec 2015 16:09:25 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 64557 invoked by uid 500); 3 Dec 2015 16:09:25 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 64547 invoked by uid 99); 3 Dec 2015 16:09:25 -0000
Received: from Unknown (HELO spamd2-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 03 Dec 2015 16:09:25 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd2-us-west.apache.org (ASF Mail Server at spamd2-us-west.apache.org) with ESMTP id 171FA1A5CF3
	for <dev@httpd.apache.org>; Thu,  3 Dec 2015 16:09:25 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd2-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 3.001
X-Spam-Level: ***
X-Spam-Status: No, score=3.001 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, HTML_MESSAGE=3,
	URIBL_BLOCKED=0.001] autolearn=disabled
Authentication-Results: spamd2-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=rowe-clan-net.20150623.gappssmtp.com
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd2-us-west.apache.org [10.40.0.9]) (amavisd-new, port 10024)
	with ESMTP id 3Kcq54d-310k for <dev@httpd.apache.org>;
	Thu,  3 Dec 2015 16:09:10 +0000 (UTC)
Received: from mail-ig0-f178.google.com (mail-ig0-f178.google.com [209.85.213.178])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id 6B4CA42AD9
	for <dev@httpd.apache.org>; Thu,  3 Dec 2015 16:09:10 +0000 (UTC)
Received: by igcmv3 with SMTP id mv3so16161590igc.0
        for <dev@httpd.apache.org>; Thu, 03 Dec 2015 08:09:10 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=rowe-clan-net.20150623.gappssmtp.com; s=20150623;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        bh=LFQae4sQ69VJh2TqeLTlTlqYYjdoJIagsuSj/UGKdUU=;
        b=Qd4zd6V5Pi8o/Ey57A53eYalcs6r5f2RPqbxudcr7xi6b7FWnk3SoDroTnN23JYq0/
         Ms2wgK97jaBpqoA2Mw3/wQW051QOgmJqncESDzHUnX0SeI7hmwHHE8XaQA9yJE4WaC02
         5s4VfzhQb60MKJUipI4Z48+XUj4wK/4C5HhKDxKWGPezSRyq7gmXbpKSOcUkFwUAIo9Q
         fG05aFm3AyqgGrt4d7EMkgtWu8mA+xuQySY7iguKYpQe7an5701LGVMUMejSHSEYnMyb
         MvWZjf8POOneV6LUXuu42dQVIyEfnR8IHh32FKzlnINdORrLqpumxgX0BJCNhU3H/3px
         LwMg==
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=1e100.net; s=20130820;
        h=x-gm-message-state:mime-version:in-reply-to:references:date
         :message-id:subject:from:to:content-type;
        bh=LFQae4sQ69VJh2TqeLTlTlqYYjdoJIagsuSj/UGKdUU=;
        b=kQYp1IfMOyuef0L9ku/3yoKzHU5/vfAzeHrLgOqpUBPd2VIbPD7WwGPWd4g0ZSuJd1
         iwOO+9wO/YOAFhTcdGkDyB96+ywop8BRR0yp4AGdmmv7aWekFtFFfQSb8xUeEOjMWEIw
         hgrDe5dyoLWaw9V3fnK0sf1uBFKuXuRmEnscuja7PrOp1/WFX/wE7Sh4gYUXJrapsI11
         maV4+9FMAEsCzQJ73SWLPKZPYoXqyojcYYMrjDIy2+IQLEeyweBgDo+JgXHsI8UEB0gB
         JCG/R4/yIyJ4wCDTYpYTYI4IgZNTktY3c53uCXuueBv1kgLzcuzeaoopH2Ejj1kvia1H
         WVLA==
X-Gm-Message-State: ALoCoQmKlRnrM9N4bL6Gcy+ovykqDYAN9nTb3MBqID4H4W5xWaySVfd6CVhYg/RRyi8N+PnFH6jJ
MIME-Version: 1.0
X-Received: by 10.50.20.163 with SMTP id o3mr10398135ige.35.1449158948460;
 Thu, 03 Dec 2015 08:09:08 -0800 (PST)
Received: by 10.107.62.136 with HTTP; Thu, 3 Dec 2015 08:09:08 -0800 (PST)
In-Reply-To: <288293CD-6D82-42E0-BFC9-9DC25F969ED6@jaguNET.com>
References: <288293CD-6D82-42E0-BFC9-9DC25F969ED6@jaguNET.com>
Date: Thu, 3 Dec 2015 10:09:08 -0600
Message-ID: <CACsi250e5arsm+EzN1KDJMOD-vAmTyM8M0utTuEfedUGSUfXJw@mail.gmail.com>
Subject: Re: reverse proxy wishlist
From: William A Rowe Jr <wrowe@rowe-clan.net>
To: httpd <dev@httpd.apache.org>
Content-Type: multipart/alternative; boundary=047d7bd75dec58b6ac0526009c44

--047d7bd75dec58b6ac0526009c44
Content-Type: text/plain; charset=UTF-8

On Thu, Dec 3, 2015 at 8:59 AM, Jim Jagielski <jim@jagunet.com> wrote:

>
> What would *you* like to see as new features or enhancements
> w/ mod_proxy, esp reverse proxy.


HTTP/2 support, of course :)  It will be interesting to be able to leverage
and compare a mod_proxy_serf vs a mod_proxy_http2 (nghttp2-based)
engine, as mentioned in another thread - multiple implementations
are always good for ferreting out protocol anomalies.

AIUI in the TLS age of HTTP, there is no forward proxy use case for
HTTP/2 that I can surmise, except as a CONNECT tunnel which 1.1
handled just fine already (AIUI that tunnel can then be a multiplexed
HTTP/2 conversation to the tunneled server.)  So this whole discussion
seems to revolve around reverse proxy backend connection. Windowing
might prove effective at reducing huge connection pools to app servers,
if they can be multiplexed over more heavily loaded fast TCP
connections.

My personal wish list is that we eliminate module bloat by coalescing
alternative "standard" implementations into a single module again in
2.next, and not just limited to lbmethod, but also the core socache
and slotmem providers. Most stock/core implementations shouldn't
change if a user wants to plug in 'yet another' option, but there is really
no excuse for us to map so many ldobjects and text pages into the
memory map of a given process, when the actual program text page
of each is a few hundred opcodes, max.

(You can submit that the user could want to replace the bytraffic
implementation, for example, but I'd counter that they can certainly
rebuild any mod_lbmethod_core module with the others still using
stock sources, and deploy their alternative, or they can give their
custom fork of a provide yet another provider name.)

I'm not asking anyone to coalesce these, though.  It was already
on my rather long list of 'nice to have' along with supporting multiple
conf mergers per module (effectively allowing 'multiple modules' to
be a single module and splitting our monstrous core server and dir
configs into related digestible pieces that rarely need to be merged,
and optimizing away modules with no conf merge at all).  And along
with cleaning up the httpd 2.next API, and i18n of error output
which I am continuing on first once the mod_ssl issues for mod_ftp
are resolved (my current project).

I was thinking about some
> sort of active backend monitoring, utilizing watchdog, which
> could also maybe, eventually, pull in performance and load
> data for the backend for a more accurate LB provider.
>

I had the impression there was some effort out there to create a
schema for backend servers to report load in a standardized way,
beyond heartbeat? But I've lost my references.

Last thought, you might want to share your question with users@?

Cheers,

Bill

--047d7bd75dec58b6ac0526009c44
Content-Type: text/html; charset=UTF-8
Content-Transfer-Encoding: quoted-printable

<div dir=3D"ltr"><div>On Thu, Dec 3, 2015 at 8:59 AM, Jim Jagielski=C2=A0<s=
pan dir=3D"ltr">&lt;<a href=3D"mailto:jim@jagunet.com" target=3D"_blank">ji=
m@jagunet.com</a>&gt;</span>=C2=A0wrote:<br><blockquote class=3D"gmail_quot=
e" style=3D"margin:0px 0px 0px 0.8ex;border-left-width:1px;border-left-colo=
r:rgb(204,204,204);border-left-style:solid;padding-left:1ex"><br>What would=
 *you* like to see as new features or enhancements<br>w/ mod_proxy, esp rev=
erse proxy.</blockquote><div>=C2=A0</div></div>HTTP/2 support, of course :)=
 =C2=A0It will be interesting to be able to leverage<div>and compare a mod_=
proxy_serf vs a mod_proxy_http2 (nghttp2-based)</div><div>engine, as mentio=
ned in another thread - multiple implementations=C2=A0</div><div>are always=
 good for ferreting out protocol anomalies.</div><div><br></div><div>AIUI i=
n the TLS age of HTTP, there is no forward proxy use case for</div><div>HTT=
P/2 that I can surmise, except as a CONNECT tunnel which 1.1</div><div>hand=
led just fine already (AIUI that tunnel can then be a multiplexed</div><div=
>HTTP/2 conversation to the tunneled server.) =C2=A0So this whole discussio=
n=C2=A0</div><div>seems to revolve around reverse proxy backend connection.=
 Windowing=C2=A0</div><div>might prove effective at reducing huge connectio=
n pools to app servers,=C2=A0</div><div>if they can be multiplexed over mor=
e heavily loaded fast TCP=C2=A0</div><div>connections.</div><div><br></div>=
<div>My personal wish list is that we eliminate module bloat by coalescing<=
/div><div>alternative &quot;standard&quot; implementations into a single mo=
dule again in=C2=A0</div><div>2.next, and not just limited to lbmethod, but=
 also the core socache=C2=A0</div><div>and slotmem providers. Most stock/co=
re implementations shouldn&#39;t=C2=A0</div><div>change if a user wants to =
plug in &#39;yet another&#39; option, but there is really=C2=A0</div><div>n=
o excuse for us to map so many ldobjects and text pages into the=C2=A0</div=
><div>memory map of a given process, when the actual program text page=C2=
=A0</div><div>of each is a few hundred opcodes, max.</div><div><br></div><d=
iv><div>(You can submit that the user could want to replace the bytraffic=
=C2=A0</div><div>implementation, for example, but I&#39;d counter that they=
 can certainly=C2=A0</div><div>rebuild any mod_lbmethod_core module with th=
e others still using=C2=A0</div><div>stock sources, and deploy their altern=
ative, or they can give their=C2=A0</div><div>custom fork of a provide yet =
another provider name.)</div><div><br></div></div><div>I&#39;m not asking a=
nyone to coalesce these, though.=C2=A0 It was already=C2=A0</div><div>on my=
 rather long list of &#39;nice to have&#39; along with supporting multiple<=
/div><div>conf mergers per module (effectively allowing &#39;multiple modul=
es&#39; to</div><div>be a single module and splitting our monstrous core se=
rver and dir</div><div>configs into related digestible pieces that rarely n=
eed to be merged,</div><div>and optimizing away modules with no conf merge =
at all).=C2=A0 And along=C2=A0</div><div>with cleaning up the httpd 2.next =
API, and i18n of error output=C2=A0</div><div>which I am continuing on firs=
t once the mod_ssl issues for mod_ftp=C2=A0</div><div>are resolved (my curr=
ent project).</div><div><br></div><div class=3D"gmail_extra"><div class=3D"=
gmail_quote"><blockquote class=3D"gmail_quote" style=3D"margin:0px 0px 0px =
0.8ex;border-left-width:1px;border-left-color:rgb(204,204,204);border-left-=
style:solid;padding-left:1ex">I was thinking about some<br>
sort of active backend monitoring, utilizing watchdog, which<br>
could also maybe, eventually, pull in performance and load<br>
data for the backend for a more accurate LB provider.<br></blockquote><div>=
<br></div><div>I had the impression there was some effort out there to crea=
te a</div><div>schema for backend servers to report load in a standardized =
way,</div><div>beyond heartbeat? But I&#39;ve lost my references.</div><div=
>=C2=A0=C2=A0</div><div>Last thought, you might want to share your question=
 with users@?</div><div><br></div><div>Cheers,</div><div><br></div><div>Bil=
l</div></div></div></div>

--047d7bd75dec58b6ac0526009c44--

From dev-return-84836-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Thu Dec  3 16:32:44 2015
Return-Path: <dev-return-84836-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 58A8918D08
	for <apmail-httpd-dev-archive@www.apache.org>; Thu,  3 Dec 2015 16:32:44 +0000 (UTC)
Received: (qmail 25645 invoked by uid 500); 3 Dec 2015 16:32:43 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 25573 invoked by uid 500); 3 Dec 2015 16:32:43 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 25563 invoked by uid 99); 3 Dec 2015 16:32:43 -0000
Received: from Unknown (HELO spamd1-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 03 Dec 2015 16:32:43 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd1-us-west.apache.org (ASF Mail Server at spamd1-us-west.apache.org) with ESMTP id 42FBAC4973
	for <dev@httpd.apache.org>; Thu,  3 Dec 2015 16:32:43 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd1-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 1.364
X-Spam-Level: *
X-Spam-Status: No, score=1.364 tagged_above=-999 required=6.31
	tests=[KAM_LAZY_DOMAIN_SECURITY=1, RDNS_DYNAMIC=0.363,
	URIBL_BLOCKED=0.001] autolearn=disabled
Received: from mx1-us-west.apache.org ([10.40.0.8])
	by localhost (spamd1-us-west.apache.org [10.40.0.7]) (amavisd-new, port 10024)
	with ESMTP id sC4DH5z8k2cQ for <dev@httpd.apache.org>;
	Thu,  3 Dec 2015 16:32:32 +0000 (UTC)
Received: from gungnir.webthing.com (209-20-83-52.slicehost.net [209.20.83.52])
	by mx1-us-west.apache.org (ASF Mail Server at mx1-us-west.apache.org) with ESMTP id D8AA7201F7
	for <dev@httpd.apache.org>; Thu,  3 Dec 2015 16:32:31 +0000 (UTC)
Received: from bifrost.webthing.com (cpc36-newt30-2-0-cust898.19-3.cable.virginm.net [82.32.195.131])
	by gungnir.webthing.com (Postfix) with ESMTPSA id 3F59DE8C51
	for <dev@httpd.apache.org>; Thu,  3 Dec 2015 16:32:31 +0000 (UTC)
Date: Thu, 3 Dec 2015 16:32:27 +0000
From: Nick Kew <niq@apache.org>
To: dev@httpd.apache.org
Subject: Re: reverse proxy wishlist
Message-ID: <20151203163227.64a94c9d@bifrost.webthing.com>
In-Reply-To: <CACsi250e5arsm+EzN1KDJMOD-vAmTyM8M0utTuEfedUGSUfXJw@mail.gmail.com>
References: <288293CD-6D82-42E0-BFC9-9DC25F969ED6@jaguNET.com>
	<CACsi250e5arsm+EzN1KDJMOD-vAmTyM8M0utTuEfedUGSUfXJw@mail.gmail.com>
X-Mailer: Claws Mail 3.11.1 (GTK+ 2.24.25; x86_64-pc-linux-gnu)
MIME-Version: 1.0
Content-Type: text/plain; charset=US-ASCII
Content-Transfer-Encoding: 7bit

On Thu, 3 Dec 2015 10:09:08 -0600
William A Rowe Jr <wrowe@rowe-clan.net> wrote:

>  Most stock/core implementations shouldn't
> change if a user wants to plug in 'yet another' option, but there is
> really no excuse for us to map so many ldobjects and text pages into
> the memory map of a given process, when the actual program text page
> of each is a few hundred opcodes, max.

Extensibility.  Flexibility.

They're our biggest single strength when compared to
the likes of nginx/tengine.

> (You can submit that the user could want to replace the bytraffic
> implementation, for example, but I'd counter that they can certainly
> rebuild any mod_lbmethod_core module with the others still using
> stock sources, and deploy their alternative, or they can give their
> custom fork of a provide yet another provider name.)

Someone wanting different functionality shouldn't have to
take on the maintenance headache of hacking into one of
our modules.  We have our API/ABI promise to make life easy
for them introducing their own modules.

> I'm not asking anyone to coalesce these, though.  It was already
> on my rather long list of 'nice to have' along with supporting
> multiple conf mergers per module (effectively allowing 'multiple
> modules' to be a single module and splitting our monstrous core
> server and dir configs into related digestible pieces that rarely
> need to be merged, and optimizing away modules with no conf merge at
> all).  And along with cleaning up the httpd 2.next API, and i18n of
> error output which I am continuing on first once the mod_ssl issues
> for mod_ftp are resolved (my current project).

Hmmm.  There's some nice-to-have in there, but it also sounds like
a big hack.

> Last thought, you might want to share your question with users@?

+1

-- 
Nick Kew

From dev-return-84837-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Thu Dec  3 16:49:41 2015
Return-Path: <dev-return-84837-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 24A3F18E2F
	for <apmail-httpd-dev-archive@www.apache.org>; Thu,  3 Dec 2015 16:49:41 +0000 (UTC)
Received: (qmail 98101 invoked by uid 500); 3 Dec 2015 16:49:24 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 98029 invoked by uid 500); 3 Dec 2015 16:49:24 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 98019 invoked by uid 99); 3 Dec 2015 16:49:24 -0000
Received: from Unknown (HELO spamd4-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 03 Dec 2015 16:49:24 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd4-us-west.apache.org (ASF Mail Server at spamd4-us-west.apache.org) with ESMTP id 57673C059B
	for <dev@httpd.apache.org>; Thu,  3 Dec 2015 16:49:24 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd4-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.556
X-Spam-Level:
X-Spam-Status: No, score=-0.556 tagged_above=-999 required=6.31
	tests=[RCVD_IN_MSPIKE_H2=-0.001, RP_MATCHES_RCVD=-0.554,
	SPF_PASS=-0.001] autolearn=disabled
Received: from mx1-us-west.apache.org ([10.40.0.8])
	by localhost (spamd4-us-west.apache.org [10.40.0.11]) (amavisd-new, port 10024)
	with ESMTP id b6Nu7dFPxnnj for <dev@httpd.apache.org>;
	Thu,  3 Dec 2015 16:49:14 +0000 (UTC)
Received: from aserp1040.oracle.com (aserp1040.oracle.com [141.146.126.69])
	by mx1-us-west.apache.org (ASF Mail Server at mx1-us-west.apache.org) with ESMTPS id DE79320267
	for <dev@httpd.apache.org>; Thu,  3 Dec 2015 16:49:13 +0000 (UTC)
Received: from userv0022.oracle.com (userv0022.oracle.com [156.151.31.74])
	by aserp1040.oracle.com (Sentrion-MTA-4.3.2/Sentrion-MTA-4.3.2) with ESMTP id tB3Gn6kQ022697
	(version=TLSv1 cipher=DHE-RSA-AES256-SHA bits=256 verify=OK)
	for <dev@httpd.apache.org>; Thu, 3 Dec 2015 16:49:07 GMT
Received: from userv0121.oracle.com (userv0121.oracle.com [156.151.31.72])
	by userv0022.oracle.com (8.13.8/8.13.8) with ESMTP id tB3Gn6El030941
	(version=TLSv1/SSLv3 cipher=DHE-RSA-AES256-SHA bits=256 verify=FAIL)
	for <dev@httpd.apache.org>; Thu, 3 Dec 2015 16:49:06 GMT
Received: from abhmp0016.oracle.com (abhmp0016.oracle.com [141.146.116.22])
	by userv0121.oracle.com (8.13.8/8.13.8) with ESMTP id tB3Gn6bn002508
	for <dev@httpd.apache.org>; Thu, 3 Dec 2015 16:49:06 GMT
Received: from [10.132.185.154] (/10.132.185.154)
	by default (Oracle Beehive Gateway v4.0)
	with ESMTP ; Thu, 03 Dec 2015 08:49:05 -0800
Subject: Re: svn commit: r1717123 -
 /httpd/httpd/trunk/docs/manual/mod/mod_allowmethods.xml
To: dev@httpd.apache.org
References: <20151129210033.1D4663A0234@svn01-us-west.apache.org>
 <565F0010.2060407@oracle.com> <565F3A5A.6050400@wanadoo.fr>
From: Mike Rumph <mike.rumph@oracle.com>
Organization: Oracle Corporation
Message-ID: <5660727C.2040101@oracle.com>
Date: Thu, 3 Dec 2015 08:49:00 -0800
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:38.0) Gecko/20100101
 Thunderbird/38.3.0
MIME-Version: 1.0
In-Reply-To: <565F3A5A.6050400@wanadoo.fr>
Content-Type: text/plain; charset=utf-8; format=flowed
Content-Transfer-Encoding: 8bit
X-Source-IP: userv0022.oracle.com [156.151.31.74]

No problem.
I took care of this along with other typos and grammar corrections in 
r1717786 and r1717800.

Thanks,

Mike

On 12/2/2015 10:37 AM, Marion & Christophe JAILLET wrote:
> Will fix.
> Sorry for not seeing it myself.
>
> CJ
>
> Le 02/12/2015 15:28, Mike Rumph a crit :
>> Comment below.
>>
>> On 11/29/2015 1:00 PM, jailletc36@apache.org wrote:
>>> Author: jailletc36
>>> Date: Sun Nov 29 21:00:32 2015
>>> New Revision: 1717123
>>>
>>> URL: http://svn.apache.org/viewvc?rev=1717123&view=rev
>>> Log:
>>> Fix doc as spotted by mat in online doc
>>>
>>> Modified:
>>>      httpd/httpd/trunk/docs/manual/mod/mod_allowmethods.xml
>>>
>>> Modified: httpd/httpd/trunk/docs/manual/mod/mod_allowmethods.xml
>>> URL: 
>>> http://svn.apache.org/viewvc/httpd/httpd/trunk/docs/manual/mod/mod_allowmethods.xml?rev=1717123&r1=1717122&r2=1717123&view=diff
>>> ============================================================================== 
>>>
>>> --- httpd/httpd/trunk/docs/manual/mod/mod_allowmethods.xml (original)
>>> +++ httpd/httpd/trunk/docs/manual/mod/mod_allowmethods.xml Sun Nov 
>>> 29 21:00:32 2015
>>> @@ -39,7 +39,7 @@ in order for it to rebuild correctly.
>>>       <summary>
>>> -<p>This module makes it easy to restrict what HTTP methods can
>>> +<p>This module makes it easy to restrict what HTTP methods can be
>>>   used on an server. The most common configuration would be:</p>
>> Should be "on a server".
>>>     <highlight language="config">
>>>
>>>
>>>
>>
>>
>
>


From dev-return-84838-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Thu Dec  3 17:36:47 2015
Return-Path: <dev-return-84838-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id E8E9E181E9
	for <apmail-httpd-dev-archive@www.apache.org>; Thu,  3 Dec 2015 17:36:46 +0000 (UTC)
Received: (qmail 91826 invoked by uid 500); 3 Dec 2015 17:36:43 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 91735 invoked by uid 500); 3 Dec 2015 17:36:43 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 91725 invoked by uid 99); 3 Dec 2015 17:36:43 -0000
Received: from Unknown (HELO spamd3-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 03 Dec 2015 17:36:43 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd3-us-west.apache.org (ASF Mail Server at spamd3-us-west.apache.org) with ESMTP id E7F66180975
	for <dev@httpd.apache.org>; Thu,  3 Dec 2015 17:36:42 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd3-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.001
X-Spam-Level:
X-Spam-Status: No, score=-0.001 tagged_above=-999 required=6.31
	tests=[SPF_PASS=-0.001] autolearn=disabled
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd3-us-west.apache.org [10.40.0.10]) (amavisd-new, port 10024)
	with ESMTP id vzVEkDXTGIPR for <dev@httpd.apache.org>;
	Thu,  3 Dec 2015 17:36:41 +0000 (UTC)
Received: from mgap1c-mgmt.jacksonnational.com (mgap1c-mgmt.jacksonnational.com [12.34.36.38])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id 7478320273
	for <dev@httpd.apache.org>; Thu,  3 Dec 2015 17:36:41 +0000 (UTC)
X-IronPort-AV: E=Sophos;i="5.20,378,1444708800"; 
   d="scan'208";a="229112323"
Received: from vtunpep1c.jacksonnational.com (HELO DC03PXMBP003.jacksonnational.com) ([10.12.111.24])
  by mgap1c-mgmt.jacksonnational.com with ESMTP; 03 Dec 2015 12:36:33 -0500
Received: from DC01PXMBP007.jacksonnational.com (10.8.105.36) by
 DC03PXMBP003.jacksonnational.com (10.12.105.32) with Microsoft SMTP Server
 (TLS) id 15.0.1044.25; Thu, 3 Dec 2015 09:36:33 -0800
Received: from DC01PXMBP007.jacksonnational.com ([10.8.105.36]) by
 DC01PXMBP007.jacksonnational.com ([10.8.105.36]) with mapi id 15.00.1044.021;
 Thu, 3 Dec 2015 12:36:33 -0500
From: "Houser, Rick" <rick.houser@jackson.com>
To: "dev@httpd.apache.org" <dev@httpd.apache.org>
Subject: RE: reverse proxy wishlist
Thread-Topic: reverse proxy wishlist
Thread-Index: AQHRLdsvM4DomsTpDEyZS7B3OcNp8p65vMGA///IuGA=
Date: Thu, 3 Dec 2015 17:36:33 +0000
Message-ID: <a138da8b6df34d42a588f5a729ede044@DC01PXMBP007.jacksonnational.com>
References: <288293CD-6D82-42E0-BFC9-9DC25F969ED6@jaguNET.com>
 <AB1691BE05AE7F4992697F2A0835627AC63B8989@VOEXM10W.internal.vodafone.com>
In-Reply-To: <AB1691BE05AE7F4992697F2A0835627AC63B8989@VOEXM10W.internal.vodafone.com>
Accept-Language: en-US
Content-Language: en-US
X-MS-Has-Attach:
X-MS-TNEF-Correlator:
x-ms-exchange-transport-fromentityheader: Hosted
x-originating-ip: [10.6.30.191]
x-tm-as-product-ver: SMEX-11.0.0.1251-8.000.1202-21980.000
x-tm-as-result: No--47.441500-0.000000-31
x-tm-as-user-approved-sender: Yes
x-tm-as-user-blocked-sender: No
Content-Type: text/plain; charset="iso-8859-1"
Content-Transfer-Encoding: quoted-printable
MIME-Version: 1.0
X-DLP-JNL: Passed

An async mod_proxy backend would be huge for my workloads.  In the JEE spac=
e I deal with, much more time is spent waiting on the application backends =
then with the clients, especially now that we have the event mpm.  Somethin=
g like this would allow me to drastically reduce thread counts and free up =
a lot of associated memory.


Rick Houser
Web Administration
(517)367-3516


> -----Original Message-----
> From: Pl=FCm, R=FCdiger, Vodafone Group [mailto:ruediger.pluem@vodafone.c=
om]
> Sent: Thursday, December 03, 2015 10:50 AM
> To: dev@httpd.apache.org
> Subject: AW: reverse proxy wishlist
>=20
> How about an async proxy that frees up the thread while waiting on a slow
> backend?
>=20
> Regards
>=20
> R=FCdiger
>=20
> > -----Urspr=FCngliche Nachricht-----
> > Von: Jim Jagielski [mailto:jim@jaguNET.com]
> > Gesendet: Donnerstag, 3. Dezember 2015 15:59
> > An: httpd <dev@httpd.apache.org>
> > Betreff: reverse proxy wishlist
> >
> > I put out a call on Twitter regarding this, but wanted to
> > close the loop here as well.
> >
> > What would *you* like to see as new features or enhancements
> > w/ mod_proxy, esp reverse proxy. I was thinking about some
> > sort of active backend monitoring, utilizing watchdog, which
> > could also maybe, eventually, pull in performance and load
> > data for the backend for a more accurate LB provider. But
> > what about new LB methods? Any ideas there?
> >
> > tia.

From dev-return-84839-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Thu Dec  3 17:39:55 2015
Return-Path: <dev-return-84839-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 012B018233
	for <apmail-httpd-dev-archive@www.apache.org>; Thu,  3 Dec 2015 17:39:55 +0000 (UTC)
Received: (qmail 7654 invoked by uid 500); 3 Dec 2015 17:39:54 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 7581 invoked by uid 500); 3 Dec 2015 17:39:54 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 7571 invoked by uid 99); 3 Dec 2015 17:39:54 -0000
Received: from Unknown (HELO spamd1-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 03 Dec 2015 17:39:54 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd1-us-west.apache.org (ASF Mail Server at spamd1-us-west.apache.org) with ESMTP id 1D0E3CC6D6
	for <dev@httpd.apache.org>; Thu,  3 Dec 2015 17:39:54 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd1-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.1
X-Spam-Level:
X-Spam-Status: No, score=-0.1 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	SPF_PASS=-0.001, URIBL_BLOCKED=0.001] autolearn=disabled
Authentication-Results: spamd1-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-us-west.apache.org ([10.40.0.8])
	by localhost (spamd1-us-west.apache.org [10.40.0.7]) (amavisd-new, port 10024)
	with ESMTP id w1GeozfH-bdl for <dev@httpd.apache.org>;
	Thu,  3 Dec 2015 17:39:48 +0000 (UTC)
Received: from mail-ig0-f176.google.com (mail-ig0-f176.google.com [209.85.213.176])
	by mx1-us-west.apache.org (ASF Mail Server at mx1-us-west.apache.org) with ESMTPS id E63FB30E17
	for <dev@httpd.apache.org>; Thu,  3 Dec 2015 17:39:47 +0000 (UTC)
Received: by igcto18 with SMTP id to18so17402435igc.0
        for <dev@httpd.apache.org>; Thu, 03 Dec 2015 09:39:41 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type:content-transfer-encoding;
        bh=j5T5t2pbFDFQbELxu3xeaut4DMMdDQv5tzfn3XjhPPI=;
        b=VG/vXzC8+ZTGnOZ0JXfl9zwxnYXBYBnI+DASYbIY9w2d2KjkBF66M5fHC6FU9DHrTz
         4ZSPfhcwCdf2sQ2RUekFZ1kYN5t8OZCCbQDjypQQ6aJeYn/14GR5cIvy4uh8ACYRC0gX
         peA3E9Vwq5JIkWXv10+D7mvDSPZFa3Aqtwt/gEoAxCDpFwDvYbjxqD2/YGrkBJyM3PoT
         1cQhwb5ksTyYlDsr2GrsT/bzeakJpASj09kkGq6R58cHgjqUBLgIadmWLitLGH9wGZos
         Fqn2E9iO6/FpIlETOBsPy0yuo6n6oFVK3hsnTlAl64kfGQ0EGG5HhlVBQky9tHPFfzt9
         rUJw==
MIME-Version: 1.0
X-Received: by 10.50.73.9 with SMTP id h9mr36211328igv.36.1449164381728; Thu,
 03 Dec 2015 09:39:41 -0800 (PST)
Received: by 10.64.114.199 with HTTP; Thu, 3 Dec 2015 09:39:41 -0800 (PST)
In-Reply-To: <a138da8b6df34d42a588f5a729ede044@DC01PXMBP007.jacksonnational.com>
References: <288293CD-6D82-42E0-BFC9-9DC25F969ED6@jaguNET.com>
	<AB1691BE05AE7F4992697F2A0835627AC63B8989@VOEXM10W.internal.vodafone.com>
	<a138da8b6df34d42a588f5a729ede044@DC01PXMBP007.jacksonnational.com>
Date: Thu, 3 Dec 2015 12:39:41 -0500
Message-ID: <CALK=YjO=POeknBmC-SiBKD+ZmnsaP74SOwu25UBgCdh5VGBjOQ@mail.gmail.com>
Subject: Re: reverse proxy wishlist
From: Eric Covener <covener@gmail.com>
To: Apache HTTP Server Development List <dev@httpd.apache.org>
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: quoted-printable

On Thu, Dec 3, 2015 at 12:36 PM, Houser, Rick <rick.houser@jackson.com> wro=
te:
> An async mod_proxy backend would be huge for my workloads.  In the JEE sp=
ace I deal with, much more time is spent waiting on the application backend=
s then with the clients, especially now that we have the event mpm.  Someth=
ing like this would allow me to drastically reduce thread counts and free u=
p a lot of associated memory.

Out of curiosity, is it usually time to first byte where the delays show up=
?
I am wondering if there is a big bang-for-the-buck enhancement possible the=
re
that doesn't prereq changes to some of the areas where hopping on and off t=
he
thread is more complicated.

From dev-return-84840-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Thu Dec  3 17:49:01 2015
Return-Path: <dev-return-84840-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id DA833182C4
	for <apmail-httpd-dev-archive@www.apache.org>; Thu,  3 Dec 2015 17:49:00 +0000 (UTC)
Received: (qmail 41840 invoked by uid 500); 3 Dec 2015 17:49:00 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 41772 invoked by uid 500); 3 Dec 2015 17:49:00 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 41762 invoked by uid 99); 3 Dec 2015 17:49:00 -0000
Received: from Unknown (HELO spamd2-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 03 Dec 2015 17:49:00 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd2-us-west.apache.org (ASF Mail Server at spamd2-us-west.apache.org) with ESMTP id EE45B1A23AD
	for <dev@httpd.apache.org>; Thu,  3 Dec 2015 17:48:59 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd2-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.554
X-Spam-Level:
X-Spam-Status: No, score=-0.554 tagged_above=-999 required=6.31
	tests=[RP_MATCHES_RCVD=-0.554, SPF_PASS=-0.001, URIBL_BLOCKED=0.001]
	autolearn=disabled
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd2-us-west.apache.org [10.40.0.9]) (amavisd-new, port 10024)
	with ESMTP id vv_Wlxa3bw99 for <dev@httpd.apache.org>;
	Thu,  3 Dec 2015 17:48:49 +0000 (UTC)
Received: from monica.sharp.fm (monica.sharp.fm [80.168.143.5])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTP id D388725E3C
	for <dev@httpd.apache.org>; Thu,  3 Dec 2015 17:48:47 +0000 (UTC)
Received: from [10.10.2.247] (dab-yat1-h-1-8.dab.02.net [82.132.214.244])
	(using TLSv1 with cipher DHE-RSA-AES256-SHA (256/256 bits))
	(Client did not present a certificate)
	(Authenticated sender: minfrin@sharp.fm)
	by monica.sharp.fm (Postfix) with ESMTPSA id D087F8204C
	for <dev@httpd.apache.org>; Thu,  3 Dec 2015 17:48:40 +0000 (GMT)
From: Graham Leggett <minfrin@sharp.fm>
Content-Type: text/plain;
	charset=utf-8
Content-Transfer-Encoding: quoted-printable
Mime-Version: 1.0 (1.0)
Subject: Re: AW: reverse proxy wishlist
Message-Id: <084C34B9-1055-4D94-8CCE-C774E1C178D6@sharp.fm>
Date: Thu, 3 Dec 2015 17:48:34 +0000
References: <288293CD-6D82-42E0-BFC9-9DC25F969ED6@jaguNET.com> <AB1691BE05AE7F4992697F2A0835627AC63B8989@VOEXM10W.internal.vodafone.com>
In-Reply-To: <AB1691BE05AE7F4992697F2A0835627AC63B8989@VOEXM10W.internal.vodafone.com>
To: dev@httpd.apache.org
X-Mailer: iPhone Mail (13B143)

On 3 Dec 2015, at 15:50, Pl=C3=BCm, R=C3=BCdiger, Vodafone Group <ruediger.p=
luem@vodafone.com> wrote:

> How about an async proxy that frees up the thread while waiting on a slow b=
ackend?

This is generic httpd thing, not restricted to mod_proxy.

=46rom what I have seen it shouldn't be difficult, we just need a way for EA=
GAIN to be properly handled with the ability to skip forward back to a hook w=
hen we come back.

I looked at doing this in the filter stack, which is also possible, but doin=
g this generically across the server is better.

Regards,
Graham
--


From dev-return-84841-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Thu Dec  3 17:49:15 2015
Return-Path: <dev-return-84841-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 6EAE3182CD
	for <apmail-httpd-dev-archive@www.apache.org>; Thu,  3 Dec 2015 17:49:15 +0000 (UTC)
Received: (qmail 44587 invoked by uid 500); 3 Dec 2015 17:49:15 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 44525 invoked by uid 500); 3 Dec 2015 17:49:14 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 44515 invoked by uid 99); 3 Dec 2015 17:49:14 -0000
Received: from Unknown (HELO spamd2-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 03 Dec 2015 17:49:14 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd2-us-west.apache.org (ASF Mail Server at spamd2-us-west.apache.org) with ESMTP id 88BC71A20D0
	for <dev@httpd.apache.org>; Thu,  3 Dec 2015 17:49:14 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd2-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.555
X-Spam-Level:
X-Spam-Status: No, score=-0.555 tagged_above=-999 required=6.31
	tests=[RP_MATCHES_RCVD=-0.554, SPF_PASS=-0.001] autolearn=disabled
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd2-us-west.apache.org [10.40.0.9]) (amavisd-new, port 10024)
	with ESMTP id XZY40Mqafrtk for <dev@httpd.apache.org>;
	Thu,  3 Dec 2015 17:49:13 +0000 (UTC)
Received: from mailserver.kippdata.de (capsella.kippdata.de [195.227.30.149])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTP id CE0B42059B
	for <dev@httpd.apache.org>; Thu,  3 Dec 2015 17:49:12 +0000 (UTC)
Received: from [10.0.110.6] ([192.168.2.104])
	by mailserver.kippdata.de (8.13.5/8.13.5) with ESMTP id tB3Hn5kP011603
	for <dev@httpd.apache.org>; Thu, 3 Dec 2015 18:49:05 +0100 (CET)
To: "dev@httpd.apache.org" <dev@httpd.apache.org>
From: Rainer Jung <rainer.jung@kippdata.de>
Subject: DER encoded cert no longer supported in 2.4 since 2.4.8
Message-ID: <5660808D.4070508@kippdata.de>
Date: Thu, 3 Dec 2015 18:49:01 +0100
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:38.0) Gecko/20100101
 Thunderbird/38.3.0
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8; format=flowed
Content-Transfer-Encoding: 7bit

I did a 2.2 to 2.4 migration today. The old 2.2 server was using a 
certificate file, which was DER encoded and the new 2.4 one didn't like it.

It seems support for DER encoded certs was removed in 2.4.8 as a side 
effect of r1573360 (bckport of r1553824). The certificate in 2.2 is read 
using SSL_read_X509() which tries PEM but also DER. After the change, 
the OpenSSL API SSL_read_X509() is used, which only accepts PEM.

Is that problem analysis right? If so we'd need to decide, whether we 
keep it as is (no one complained, so DER seems to be rare) and simply 
document the change in the changelog and migration guide, or whether we 
still need to support DER encoded certs.

IMHO documenting the change would be enough.

Regards,

Rainer

From dev-return-84842-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Thu Dec  3 18:23:37 2015
Return-Path: <dev-return-84842-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id AE55718571
	for <apmail-httpd-dev-archive@www.apache.org>; Thu,  3 Dec 2015 18:23:37 +0000 (UTC)
Received: (qmail 14336 invoked by uid 500); 3 Dec 2015 18:23:34 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 14257 invoked by uid 500); 3 Dec 2015 18:23:34 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 14247 invoked by uid 99); 3 Dec 2015 18:23:34 -0000
Received: from Unknown (HELO spamd1-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 03 Dec 2015 18:23:34 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd1-us-west.apache.org (ASF Mail Server at spamd1-us-west.apache.org) with ESMTP id B801DCC72B
	for <dev@httpd.apache.org>; Thu,  3 Dec 2015 18:23:33 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd1-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 3
X-Spam-Level: ***
X-Spam-Status: No, score=3 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, HTML_MESSAGE=3,
	SPF_PASS=-0.001, URIBL_BLOCKED=0.001] autolearn=disabled
Authentication-Results: spamd1-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=rowe-clan-net.20150623.gappssmtp.com
Received: from mx1-us-west.apache.org ([10.40.0.8])
	by localhost (spamd1-us-west.apache.org [10.40.0.7]) (amavisd-new, port 10024)
	with ESMTP id mF8LVYHOhe4Y for <dev@httpd.apache.org>;
	Thu,  3 Dec 2015 18:23:25 +0000 (UTC)
Received: from mail-io0-f174.google.com (mail-io0-f174.google.com [209.85.223.174])
	by mx1-us-west.apache.org (ASF Mail Server at mx1-us-west.apache.org) with ESMTPS id 26B4B20CF5
	for <dev@httpd.apache.org>; Thu,  3 Dec 2015 18:23:25 +0000 (UTC)
Received: by iouu10 with SMTP id u10so92150699iou.0
        for <dev@httpd.apache.org>; Thu, 03 Dec 2015 10:23:24 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=rowe-clan-net.20150623.gappssmtp.com; s=20150623;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        bh=h48wKPj0HHBNzdrMQsHE2wEd/GZqenSB+tcs0o0bDvU=;
        b=0qL4t3/XXBbsIh5NO/EmHzDLacCwWqesBtyUHiFOc5Tsw7tsStApyypTAMkD4uwU8v
         7RrzJjRBp1Fvw5GYogqfQDCfQZenpz5OsWM4X5zWtBw47xTo4h2w4cCj6qKaQrMMSf6b
         8smckmIC/bEN+e+xyEcZaOz9BroPgus0484sfXvUvg56/oNer20ye3MRWNATTl5M4uj+
         8v7/tIxQ1ZQmpseutm1QLob4LERTSjBrRM/6lVoKDOL9mARKt/Ulb3yLAnbDmJpre54q
         99PoJZZ3kVRCdoqvTGombz6CnL3kGtk/rLNBN/d74CqRlssBkvpMc8ybPvrYbY/5/Tlz
         CBlA==
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=1e100.net; s=20130820;
        h=x-gm-message-state:mime-version:in-reply-to:references:date
         :message-id:subject:from:to:content-type;
        bh=h48wKPj0HHBNzdrMQsHE2wEd/GZqenSB+tcs0o0bDvU=;
        b=D/Nec/PDDZDiKvYJefN+bzhqOgsdzUD+JPaqnQqcoRkcZYyMpUkQqGBzFJwCpNjzDq
         kphispx7yq0jP7O296IvgwHSReVBdhZrD2jRjtu7J3zXJV04JaW1CqhWaTGjqAWcqyqe
         BshNuuXI0ybOMK9OWl5Zq+KBRHqwcdFjGTUzPJwpZxz0C+W0wdp2nX6gfnKs/gxqWLTQ
         1nxX3p6k6zdKNey54JU261oAHtSCVWn21fKWgguw7IZYWRGeSgPKL4AEHrVUzrI6X0U2
         aRDqmXKUDVnLeFWiBkHoASZNvoLJbGZDIO7XkNGyxdz0pty37Xvt1WMwXVMxJVyN7hqu
         eJcw==
X-Gm-Message-State: ALoCoQkR1D3k8lnmrrQla93BWWNmNghbKtFsRuOyl50V4AGp6mH2sRjrhLCZlBPL9gNezSjzw3Fn
MIME-Version: 1.0
X-Received: by 10.107.156.6 with SMTP id f6mr10080682ioe.163.1449167004519;
 Thu, 03 Dec 2015 10:23:24 -0800 (PST)
Received: by 10.107.62.136 with HTTP; Thu, 3 Dec 2015 10:23:24 -0800 (PST)
In-Reply-To: <20151203163227.64a94c9d@bifrost.webthing.com>
References: <288293CD-6D82-42E0-BFC9-9DC25F969ED6@jaguNET.com>
	<CACsi250e5arsm+EzN1KDJMOD-vAmTyM8M0utTuEfedUGSUfXJw@mail.gmail.com>
	<20151203163227.64a94c9d@bifrost.webthing.com>
Date: Thu, 3 Dec 2015 12:23:24 -0600
Message-ID: <CACsi2538wJ=w99Emp86rfC-pJC6GF4J6wUPsqQi0vT8prnd4DA@mail.gmail.com>
Subject: Re: reverse proxy wishlist
From: William A Rowe Jr <wrowe@rowe-clan.net>
To: httpd <dev@httpd.apache.org>
Content-Type: multipart/alternative; boundary=001a1140ccc08662460526027c84

--001a1140ccc08662460526027c84
Content-Type: text/plain; charset=UTF-8

On Thu, Dec 3, 2015 at 10:32 AM, Nick Kew <niq@apache.org> wrote:

> On Thu, 3 Dec 2015 10:09:08 -0600
> William A Rowe Jr <wrowe@rowe-clan.net> wrote:
>
> >  Most stock/core implementations shouldn't
> > change if a user wants to plug in 'yet another' option, but there is
> > really no excuse for us to map so many ldobjects and text pages into
> > the memory map of a given process, when the actual program text page
> > of each is a few hundred opcodes, max.
>
> Extensibility.  Flexibility.
>
> They're our biggest single strength when compared to
> the likes of nginx/tengine.
>

Yup, and I'm not proposing to eliminate the mechanism, I'm proposing
that the existing 'core' subset be codified in fewer, still lightweight
modules.


> > (You can submit that the user could want to replace the bytraffic
> > implementation, for example, but I'd counter that they can certainly
> > rebuild any mod_lbmethod_core module with the others still using
> > stock sources, and deploy their alternative, or they can give their
> > custom fork of a provide yet another provider name.)
>
> Someone wanting different functionality shouldn't have to
> take on the maintenance headache of hacking into one of
> our modules.  We have our API/ABI promise to make life easy
> for them introducing their own modules.
>

If they are *replacing* our tokens, that's on them.  They can add their
own lbname, e.g. bytraffic-hacked, without rebuilding a core provider.
And I'm not going to propose any of this for backport, in fact I don't plan
to condense the source files at all, only simplify their hook registration
and compile the several providers under a core module umbrella.

> I'm not asking anyone to coalesce these, though.  It was already
> > on my rather long list of 'nice to have' along with supporting
> > multiple conf mergers per module (effectively allowing 'multiple
> > modules' to be a single module and splitting our monstrous core
> > server and dir configs into related digestible pieces that rarely
> > need to be merged, and optimizing away modules with no conf merge at
> > all).  And along with cleaning up the httpd 2.next API, and i18n of
> > error output which I am continuing on first once the mod_ssl issues
> > for mod_ftp are resolved (my current project).
>
> Hmmm.  There's some nice-to-have in there, but it also sounds like
> a big hack.
>

Actually they are the ideas and justifications;

 1. multiple conf sections) right now, a module such as core or mod_ssl
     has a small subset of "key" config directives that change often,
     perhaps in nearly every <VirtualHost > block or <Directory > level.
     Then there is a majority of directives that never change from either
     the global or first-triggered block (e.g. toggling auth from denied to
     a site-wide global permitted state).  These are merges that just
     should not have to happen on each and every merge.  Directory is
     obviously the worst offender, while Server blocks are merged at
     startup and don't enjoy nearly as much optimization.  Dropping
     any module from the merge list that has a NULL merge should
     speed up directory merges, too.  Unsuitable for backport.

 2. API cleanup) I'm looking at a util_compat.h that would map all of
     our long-deprecated ap_ functions into their apr_ or newer _ex
     equivalents.  And busting up httpd.h, starting with util_strings.h
     Unsuitable for backport.

 3. i18n) You ask about our "strengths", we have little globally until
     we actually internationalize error output.  Most servers beat us
     a long time ago in this respect.  Errors are more confusing than
     learning the few tokens you need to write a config (however, some
     internationalized .conf.in files for descriptive text would be a help.)
     The specific error lookup has can be overridden per-server, giving
     shared hosting providers the ability to let vhost admins grok the
     errors their site is receiving.  It's nothing more than a hash table
     now that we have decorated APnnnnn throughout the 2.x and 2.4
     error output, so this one can be considered for backport.

 4. mod_ssl) yes, I know my last Upgrade: TLS/1.0 patch doesn't
     interact with the Protocols directive and h2c, since Protocols
     directive patch failed to pick up the existing mod_ssl Upgrade/
     Connection logic.  Working on that fix right now so that both
     options present just one unified Upgrade/Connection message.
     That fix aught to be backported for completeness.

 5. mod_ftp) several recent mod_ssl changes busted mod_ftp's
     AUTH TLS support - and possibly due to my implicit HOST
     command hack (the result of a HOST command is the same
     221 welcome as an initial connection, so this was a fakeout
     to cause that initial greeting - based on the SNI hostname in
     the case of explicit SSL.)  Both the implicit port 995 and
     plaintext port 21 flavors were and are still working, so it is
     just a matter of better coupling mod_ftp AUTH TLS to the
     upgrade mechanisms of mod_ssl. Hopefully minimal or no
     core mod_ssl changes are needed.

I'm looking, none of these seem like huge hacks, wondering
which of them trigger your concern?

Cheers,

Bill

--001a1140ccc08662460526027c84
Content-Type: text/html; charset=UTF-8
Content-Transfer-Encoding: quoted-printable

<div dir=3D"ltr"><div class=3D"gmail_extra"><div class=3D"gmail_quote">On T=
hu, Dec 3, 2015 at 10:32 AM, Nick Kew <span dir=3D"ltr">&lt;<a href=3D"mail=
to:niq@apache.org" target=3D"_blank">niq@apache.org</a>&gt;</span> wrote:<b=
r><blockquote class=3D"gmail_quote" style=3D"margin:0px 0px 0px 0.8ex;borde=
r-left-width:1px;border-left-color:rgb(204,204,204);border-left-style:solid=
;padding-left:1ex"><span class=3D"">On Thu, 3 Dec 2015 10:09:08 -0600<br>
William A Rowe Jr &lt;<a href=3D"mailto:wrowe@rowe-clan.net">wrowe@rowe-cla=
n.net</a>&gt; wrote:<br>
<br>
&gt;=C2=A0 Most stock/core implementations shouldn&#39;t<br>
&gt; change if a user wants to plug in &#39;yet another&#39; option, but th=
ere is<br>
&gt; really no excuse for us to map so many ldobjects and text pages into<b=
r>
&gt; the memory map of a given process, when the actual program text page<b=
r>
&gt; of each is a few hundred opcodes, max.<br>
<br>
</span>Extensibility.=C2=A0 Flexibility.<br>
<br>
They&#39;re our biggest single strength when compared to<br>
the likes of nginx/tengine.<span class=3D""><br></span></blockquote><div><b=
r></div><div>Yup, and I&#39;m not proposing to eliminate the mechanism, I&#=
39;m proposing</div><div>that the existing &#39;core&#39; subset be codifie=
d in fewer, still lightweight</div><div>modules.</div><div>=C2=A0</div><blo=
ckquote class=3D"gmail_quote" style=3D"margin:0px 0px 0px 0.8ex;border-left=
-width:1px;border-left-color:rgb(204,204,204);border-left-style:solid;paddi=
ng-left:1ex"><span class=3D"">
&gt; (You can submit that the user could want to replace the bytraffic<br>
&gt; implementation, for example, but I&#39;d counter that they can certain=
ly<br>
&gt; rebuild any mod_lbmethod_core module with the others still using<br>
&gt; stock sources, and deploy their alternative, or they can give their<br=
>
&gt; custom fork of a provide yet another provider name.)<br>
<br>
</span>Someone wanting different functionality shouldn&#39;t have to<br>
take on the maintenance headache of hacking into one of<br>
our modules.=C2=A0 We have our API/ABI promise to make life easy<br>
for them introducing their own modules.<span class=3D""><br></span></blockq=
uote><div>=C2=A0</div><div>If they are *replacing* our tokens, that&#39;s o=
n them.=C2=A0 They can add their</div><div>own lbname, e.g. bytraffic-hacke=
d, without rebuilding a core provider.</div><div>And I&#39;m not going to p=
ropose any of this for backport, in fact I don&#39;t plan=C2=A0</div><div>t=
o condense the source files at all, only simplify their hook registration</=
div><div>and compile the several providers under a core module umbrella.</d=
iv><div><br></div><blockquote class=3D"gmail_quote" style=3D"margin:0px 0px=
 0px 0.8ex;border-left-width:1px;border-left-color:rgb(204,204,204);border-=
left-style:solid;padding-left:1ex"><span class=3D"">
&gt; I&#39;m not asking anyone to coalesce these, though.=C2=A0 It was alre=
ady<br>
&gt; on my rather long list of &#39;nice to have&#39; along with supporting=
<br>
&gt; multiple conf mergers per module (effectively allowing &#39;multiple<b=
r>
&gt; modules&#39; to be a single module and splitting our monstrous core<br=
>
&gt; server and dir configs into related digestible pieces that rarely<br>
&gt; need to be merged, and optimizing away modules with no conf merge at<b=
r>
&gt; all).=C2=A0 And along with cleaning up the httpd 2.next API, and i18n =
of<br>
&gt; error output which I am continuing on first once the mod_ssl issues<br=
>
&gt; for mod_ftp are resolved (my current project).<br>
<br>
</span>Hmmm.=C2=A0 There&#39;s some nice-to-have in there, but it also soun=
ds like<br>
a big hack.<span class=3D""><br></span></blockquote><div>=C2=A0</div><div>A=
ctually they are the ideas and justifications;</div><div><br></div><div>=C2=
=A01. multiple conf sections) right now, a module such as core or mod_ssl</=
div><div>=C2=A0 =C2=A0 =C2=A0has a small subset of &quot;key&quot; config d=
irectives that change often,</div><div>=C2=A0 =C2=A0 =C2=A0perhaps in nearl=
y every &lt;VirtualHost &gt; block or &lt;Directory &gt; level.</div><div>=
=C2=A0 =C2=A0 =C2=A0Then there is a majority of directives that never chang=
e from either</div><div>=C2=A0 =C2=A0 =C2=A0the global or first-triggered b=
lock (e.g. toggling auth from denied to</div><div>=C2=A0 =C2=A0 =C2=A0a sit=
e-wide global permitted state).=C2=A0 These are merges that just</div><div>=
=C2=A0 =C2=A0 =C2=A0should not have to happen on each and every merge.=C2=
=A0 Directory is</div><div>=C2=A0 =C2=A0 =C2=A0obviously the worst offender=
, while Server blocks are merged at</div><div>=C2=A0 =C2=A0 =C2=A0startup a=
nd don&#39;t enjoy nearly as much optimization.=C2=A0 Dropping</div><div>=
=C2=A0 =C2=A0 =C2=A0any module from the merge list that has a NULL merge sh=
ould=C2=A0</div><div>=C2=A0 =C2=A0 =C2=A0speed up directory merges, too.=C2=
=A0 Unsuitable for backport.</div><div><br></div><div>=C2=A02. API cleanup)=
 I&#39;m looking at a util_compat.h that would map all of</div><div>=C2=A0 =
=C2=A0 =C2=A0our long-deprecated ap_ functions into their apr_ or newer _ex=
</div><div>=C2=A0 =C2=A0 =C2=A0equivalents.=C2=A0 And busting up httpd.h, s=
tarting with util_strings.h</div><div>=C2=A0 =C2=A0 =C2=A0Unsuitable for ba=
ckport.<br></div><div><br></div><div>=C2=A03. i18n) You ask about our &quot=
;strengths&quot;, we have little globally until</div><div>=C2=A0 =C2=A0 =C2=
=A0we actually internationalize error output.=C2=A0 Most servers beat us</d=
iv><div>=C2=A0 =C2=A0 =C2=A0a long time ago in this respect.=C2=A0 Errors a=
re more confusing than</div><div>=C2=A0 =C2=A0 =C2=A0learning the few token=
s you need to write a config (however, some</div><div>=C2=A0 =C2=A0 =C2=A0i=
nternationalized .<a href=3D"http://conf.in">conf.in</a> files for descript=
ive text would be a help.)</div><div>=C2=A0 =C2=A0 =C2=A0The specific error=
 lookup has can be overridden per-server, giving</div><div>=C2=A0 =C2=A0 =
=C2=A0shared hosting providers the ability to let vhost admins grok the</di=
v><div>=C2=A0 =C2=A0 =C2=A0errors their site is receiving.=C2=A0 It&#39;s n=
othing more than a hash table</div><div>=C2=A0 =C2=A0 =C2=A0now that we hav=
e decorated APnnnnn throughout the 2.x and 2.4</div><div>=C2=A0 =C2=A0 =C2=
=A0error output, so this one can be considered for backport.</div><div><br>=
</div><div>=C2=A04. mod_ssl) yes, I know my last Upgrade: TLS/1.0 patch doe=
sn&#39;t</div><div>=C2=A0 =C2=A0 =C2=A0interact with the Protocols directiv=
e and h2c, since Protocols</div><div>=C2=A0 =C2=A0 =C2=A0directive patch fa=
iled to pick up the existing mod_ssl Upgrade/</div><div>=C2=A0 =C2=A0 =C2=
=A0Connection logic.=C2=A0 Working on that fix right now so that both</div>=
<div>=C2=A0 =C2=A0 =C2=A0options present just one unified Upgrade/Connectio=
n message.</div><div><div>=C2=A0 =C2=A0 =C2=A0That fix aught to be backport=
ed for completeness.</div></div><div><br></div><div>=C2=A05. mod_ftp) sever=
al recent mod_ssl changes busted mod_ftp&#39;s</div><div>=C2=A0 =C2=A0 =C2=
=A0AUTH TLS support - and possibly due to my implicit HOST</div><div>=C2=A0=
 =C2=A0 =C2=A0command hack (the result of a HOST command is the same</div><=
div>=C2=A0 =C2=A0 =C2=A0221 welcome as an initial connection, so this was a=
 fakeout</div><div>=C2=A0 =C2=A0 =C2=A0to cause that initial greeting - bas=
ed on the SNI hostname in</div><div>=C2=A0 =C2=A0 =C2=A0the case of explici=
t SSL.) =C2=A0Both the implicit port 995 and=C2=A0</div><div>=C2=A0 =C2=A0 =
=C2=A0plaintext port 21 flavors were and are still working, so it is</div><=
div>=C2=A0 =C2=A0 =C2=A0just a matter of better coupling mod_ftp AUTH TLS t=
o the</div><div>=C2=A0 =C2=A0 =C2=A0upgrade mechanisms of mod_ssl. Hopefull=
y minimal or no</div><div>=C2=A0 =C2=A0 =C2=A0core mod_ssl changes are need=
ed.</div><div><br></div><div>I&#39;m looking, none of these seem like huge =
hacks, wondering</div><div>which of them trigger your concern?</div><div><b=
r></div><div>Cheers,</div><div><br></div><div>Bill</div><div><br></div></di=
v></div></div>

--001a1140ccc08662460526027c84--

From dev-return-84843-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Thu Dec  3 18:39:28 2015
Return-Path: <dev-return-84843-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 85AB018645
	for <apmail-httpd-dev-archive@www.apache.org>; Thu,  3 Dec 2015 18:39:28 +0000 (UTC)
Received: (qmail 60046 invoked by uid 500); 3 Dec 2015 18:39:23 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 59980 invoked by uid 500); 3 Dec 2015 18:39:23 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 59970 invoked by uid 99); 3 Dec 2015 18:39:22 -0000
Received: from Unknown (HELO spamd2-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 03 Dec 2015 18:39:22 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd2-us-west.apache.org (ASF Mail Server at spamd2-us-west.apache.org) with ESMTP id 81C871A5D1A
	for <dev@httpd.apache.org>; Thu,  3 Dec 2015 18:39:22 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd2-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 0
X-Spam-Level:
X-Spam-Status: No, score=0 tagged_above=-999 required=6.31
	tests=[SPF_PASS=-0.001, URIBL_BLOCKED=0.001] autolearn=disabled
Received: from mx1-us-west.apache.org ([10.40.0.8])
	by localhost (spamd2-us-west.apache.org [10.40.0.9]) (amavisd-new, port 10024)
	with ESMTP id Wx-dygV1a_U6 for <dev@httpd.apache.org>;
	Thu,  3 Dec 2015 18:39:14 +0000 (UTC)
Received: from mgap1a-mgmt.jacksonnational.com (mgap1a-mgmt.jacksonnational.com [12.34.36.39])
	by mx1-us-west.apache.org (ASF Mail Server at mx1-us-west.apache.org) with ESMTPS id F07A3202C2
	for <dev@httpd.apache.org>; Thu,  3 Dec 2015 18:39:13 +0000 (UTC)
X-IronPort-AV: E=Sophos;i="5.20,378,1444708800"; 
   d="scan'208";a="225828309"
Received: from vtunpep1a.jacksonnational.com (HELO DC03PXMBP003.jacksonnational.com) ([10.8.111.30])
  by mgap1a-mgmt.jacksonnational.com with ESMTP; 03 Dec 2015 13:39:08 -0500
Received: from DC01PXMBP007.jacksonnational.com (10.8.105.36) by
 DC03PXMBP003.jacksonnational.com (10.12.105.32) with Microsoft SMTP Server
 (TLS) id 15.0.1044.25; Thu, 3 Dec 2015 10:39:07 -0800
Received: from DC01PXMBP007.jacksonnational.com ([10.8.105.36]) by
 DC01PXMBP007.jacksonnational.com ([10.8.105.36]) with mapi id 15.00.1044.021;
 Thu, 3 Dec 2015 13:39:07 -0500
From: "Houser, Rick" <rick.houser@jackson.com>
To: Apache HTTP Server Development List <dev@httpd.apache.org>
Subject: RE: reverse proxy wishlist
Thread-Topic: reverse proxy wishlist
Thread-Index: AQHRLdsvM4DomsTpDEyZS7B3OcNp8p65vMGA///IuGCAAFXPgP//rJaw
Date: Thu, 3 Dec 2015 18:39:07 +0000
Message-ID: <72469bbdabd24f17a14f79729985cc4d@DC01PXMBP007.jacksonnational.com>
References: <288293CD-6D82-42E0-BFC9-9DC25F969ED6@jaguNET.com>
	<AB1691BE05AE7F4992697F2A0835627AC63B8989@VOEXM10W.internal.vodafone.com>
	<a138da8b6df34d42a588f5a729ede044@DC01PXMBP007.jacksonnational.com>
 <CALK=YjO=POeknBmC-SiBKD+ZmnsaP74SOwu25UBgCdh5VGBjOQ@mail.gmail.com>
In-Reply-To: <CALK=YjO=POeknBmC-SiBKD+ZmnsaP74SOwu25UBgCdh5VGBjOQ@mail.gmail.com>
Accept-Language: en-US
Content-Language: en-US
X-MS-Has-Attach:
X-MS-TNEF-Correlator:
x-ms-exchange-transport-fromentityheader: Hosted
x-originating-ip: [10.6.30.191]
x-tm-as-product-ver: SMEX-11.0.0.1251-8.000.1202-21980.002
x-tm-as-result: No--45.720600-0.000000-31
x-tm-as-user-approved-sender: Yes
x-tm-as-user-blocked-sender: No
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
MIME-Version: 1.0
X-DLP-JNL: Passed

PiBPdXQgb2YgY3VyaW9zaXR5LCBpcyBpdCB1c3VhbGx5IHRpbWUgdG8gZmlyc3QgYnl0ZSB3aGVy
ZSB0aGUgZGVsYXlzIHNob3cgdXA/DQo+IEkgYW0gd29uZGVyaW5nIGlmIHRoZXJlIGlzIGEgYmln
IGJhbmctZm9yLXRoZS1idWNrIGVuaGFuY2VtZW50IHBvc3NpYmxlIHRoZXJlDQo+IHRoYXQgZG9l
c24ndCBwcmVyZXEgY2hhbmdlcyB0byBzb21lIG9mIHRoZSBhcmVhcyB3aGVyZSBob3BwaW5nIG9u
IGFuZCBvZmYgdGhlDQo+IHRocmVhZCBpcyBtb3JlIGNvbXBsaWNhdGVkLg0KDQpVbHRpbWF0ZWx5
LCBtb3N0IG9mIHRoaXMgc3R1ZmYgaXMgZ2V0dGluZyBib3R0bGVuZWNrZWQgb24gZGF0YWJhc2Ug
YWNjZXNzZXMgKG9yIHNpbWlsYXIgcmVzb3VyY2VzKSBzb21ld2hlcmUgaW4gdGhlIGJhY2tlbmQu
ICBUaGUgcHJvYmxlbSBpcywgSSBkZWFsIHdpdGggaHVuZHJlZHMgb2YgZGlmZmVyZW50IGFwcGxp
Y2F0aW9ucyAod2l0aCBib3RoIEpCb3NzIGFuZCBUb21jYXQgdXNpbmcgdGhlIG1vZF9wcm94eSBi
YWNrZW5kKSBhbmQgZWFjaCBvbmUgcGVyZm9ybXMgc2xpZ2h0bHkgZGlmZmVyZW50LiAgSXQgd291
bGQgdGFrZSBtb3JlIHRoYW4gYSB0cml2aWFsIGFtb3VudCBvZiBlZmZvcnQgdG8gZ2V0IHNwZWNp
ZmljcyBvbiB3aGV0aGVyIHRoZXNlIGFyZSBibG9ja2luZyBiZWZvcmUgdGhlIGZpcnN0IGJ5dGUg
b2YgdGhlIGhlYWRlciBvciBiZWZvcmUgdGhlIGZpcnN0IGJ5dGUgb2YgdGhlIGNvbnRlbnQgaXRz
ZWxmICggYXMgaW4gaHR0cHM6Ly9kb2NzLm9yYWNsZS5jb20vamF2YWVlLzYvYXBpL2phdmF4L3Nl
cnZsZXQvU2VydmxldFJlc3BvbnNlLmh0bWwjaXNDb21taXR0ZWQlMjglMjkgKS4gIEluIGF0IGxl
YXN0IHRoZSBjYXNlIG9mIFdlYlNwaGVyZSBBcHBsaWNhdGlvbiBTZXJ2ZXIgKGdyYW50ZWQsIGEg
bm9uLW1vZF9wcm94eSBiYWNrZW5kKSwgSSB0aGluayB0aGVyZSB3YXMgZXZlbiBhbiBvcHRpb24g
dG8gY29udHJvbCB0aGUgZGF0YSBjaHVua2luZyB0byBoYXZlIHRoZSBzZXJ2ZXIgZWl0aGVyIHdh
aXQgZm9yIGEgY29tcGxldGUgcmVzcG9uc2Ugb3IgdG8gc3RhcnQgc2VuZGluZyBpdCBvdXQgaW4g
cGllY2VzLg0KDQpIb3cgdGhlIEpFRSB0aWVycyB0eXBpY2FsbHkgd29yayBpcyB0aGF0IG9uZSBv
ciBtb3JlIG5vbi1wcmVzZW50YXRpb24gbGF5ZXJzIGZpcnN0IGNvbGxlY3QgYWxsIHRoZSBkYXRh
IG5lZWRlZCBhbmQgcGVyZm9ybSB0aGUgYnVzaW5lc3MgbG9naWMgLS0gdGhpcyB3b3VsZCB0eXBp
Y2FsbHkgZ2V0IGNhbGxlZCBmcm9tIHRoZSBTZXJ2bGV0IGl0c2VsZiAoZXguIGRvR2V0IG1ldGhv
ZCAtLSBvciBhbiBlcXVpdmFsZW50IHNwb3QgaW4gYSBmcmFtZXdvcmspLiAgVGhlbiwgdGhhdCBk
aXNwbGF5IG9iamVjdCBnZXRzIHNlbnQgdG8gdGhlIHByZXNlbnRhdGlvbiBsYXllciAoSlNQIG9y
IHRoZSBsaWtlKSBpbiB0aGUgZm9ybSBvZiBhbiBvYmplY3QsIHdoZXJlIHRoZSBmaW5hbCBmb3Jt
IGlzIHJlbmRlcmVkIChYSFRNTCwgSFRNTCwgZXRjLikgc3RyaWN0bHkgZnJvbSB0aGUgY29udGVu
dHMgb2YgdGhhdCBvYmplY3QuICBBcyB0aGUgcHJlc2VudGF0aW9uIGxvZ2ljIGlzIGEgdmVyeSBz
bWFsbCBwYXJ0IG9mIHRoZSBvdmVyYWxsIGV4ZWN1dGlvbiB0aW1lbGluZSAoYW5kIHNob3VsZCBu
b3QgYmUgbWFraW5nIGJhY2tlbmQgY2FsbHMgaXRzZWxmKSwgdXNlcnMgdHlwaWNhbGx5IHNlZSBu
b3RoaW5nIGZvciBhIHdoaWxlLCB0aGVuIHRoZSB3aG9sZSBwYWdlIGp1c3QgcG9wcyB1cC4gIFRo
ZSBoZWFkZXJzIGFyZSBhIHNpbWlsYXIgc3RhdGUsIGFuZCBJIHN1c3BlY3QgKGJ1dCBoYXZlIG5v
dCBjb25maXJtZWQpIHRoZXkgb25seSBsZWF2ZSB0aGUgc2VydmVyIGFzIGEgY29tcGxldGUgc2V0
IChoZW5jZSB0aGUgaXNDb21taXR0ZWQgbWV0aG9kIGFib3ZlKS4gIFRoaXMgaXMgaW4gZGlyZWN0
IGNvbnRyYXN0IHRvIHR5cGljYWwgTEFNUCBzdGFjayBzZXR1cHMgd2l0aG91dCBhIGRlZGljYXRl
ZCBwcmVzZW50YXRpb24gdGllciAobGlrZSBhIHNpbXBsZSBQSFAgc2l0ZSksIHdoZXJlIGVuZCB1
c2VycyBvZnRlbiBzZWUgYSBwYWdlIHBhcnRpYWxseSByZW5kZXIgb3V0cHV0LCBwYXVzaW5nIGF0
IHNwZWNpZmljIGRhdGFiYXNlIHF1ZXJpZXMuDQoNCkkgd291bGQgZGVmaW5pdGVseSBleHBlY3Qg
dG8gc2VlIGEgc3Vic3RhbnRpYWwgaW1wcm92ZW1lbnQgaWYgdGhlIHRocmVhZCByZXNlcnZhdGlv
biBjb3VsZCBiZSBkZWxheWVkIHVudGlsIHRoZSByZXNwb25zZSBoZWFkZXJzIGFyZSBmdWxseSBy
ZWNlaXZlZC4gIEhvd2V2ZXIsIGl0IHdvdWxkIHRha2Ugc29tZSBhZGRpdGlvbmFsIHJlc2VhcmNo
IHRvIGZpZ3VyZSBvdXQgaG93IG11Y2ggaWYgYW55IG9mIHRoYXQgc2F2aW5ncyBjb3VsZCBhbHNv
IGJlIGdhaW5lZCBieSBhbGxvY2F0aW5nIHRoZSB0aHJlYWQgd2hlbiB0aGUgcmVzcG9uc2UgaGVh
ZGVycyBmaXJzdCBzdGFydCBjb21pbmcgaW4uICBUaGF0IGFkZGl0aW9uYWwgcmVzZWFyY2ggbWF5
IGFsc28gYmUgaGlnaGx5IGRlcGVuZGVudCBvbiB0aGUgc3BlY2lmaWMgYmFja2VuZCBpbiBxdWVz
dGlvbiBhbmQgYW55IG9wdGlvbnMgaW4gdXNlLiAgQXQgbGVhc3QgdW5kZXIgdGhpcyB0eXBlIG9m
IEpFRSB3b3JrbG9hZCwgaG93ZXZlciwgSSB3b3VsZCBub3QgZXhwZWN0IHRvIHNlZSBhIG5vdGlj
YWJsZSBiZW5lZml0IHRvIGJlaW5nIGFibGUgdG8gZGV0YWNoIGFuZCByZS1hdHRhY2ggdGhlIHdv
cmtlciB0aHJlYWRzIGFmdGVyIHdlIHN0YXJ0IHByb2Nlc3NpbmcgdGhlIHJlc3BvbnNlIGJvZHku
DQoNCg0KDQpSaWNrIEhvdXNlcg0KV2ViIEFkbWluaXN0cmF0aW9uDQoNCj4gLS0tLS1PcmlnaW5h
bCBNZXNzYWdlLS0tLS0NCj4gRnJvbTogRXJpYyBDb3ZlbmVyIFttYWlsdG86Y292ZW5lckBnbWFp
bC5jb21dDQo+IFNlbnQ6IFRodXJzZGF5LCBEZWNlbWJlciAwMywgMjAxNSAxMjo0MCBQTQ0KPiBU
bzogQXBhY2hlIEhUVFAgU2VydmVyIERldmVsb3BtZW50IExpc3QgPGRldkBodHRwZC5hcGFjaGUu
b3JnPg0KPiBTdWJqZWN0OiBSZTogcmV2ZXJzZSBwcm94eSB3aXNobGlzdA0KPiANCj4gT24gVGh1
LCBEZWMgMywgMjAxNSBhdCAxMjozNiBQTSwgSG91c2VyLCBSaWNrIDxyaWNrLmhvdXNlckBqYWNr
c29uLmNvbT4NCj4gd3JvdGU6DQo+ID4gQW4gYXN5bmMgbW9kX3Byb3h5IGJhY2tlbmQgd291bGQg
YmUgaHVnZSBmb3IgbXkgd29ya2xvYWRzLiAgSW4gdGhlIEpFRQ0KPiBzcGFjZSBJIGRlYWwgd2l0
aCwgbXVjaCBtb3JlIHRpbWUgaXMgc3BlbnQgd2FpdGluZyBvbiB0aGUgYXBwbGljYXRpb24gYmFj
a2VuZHMNCj4gdGhlbiB3aXRoIHRoZSBjbGllbnRzLCBlc3BlY2lhbGx5IG5vdyB0aGF0IHdlIGhh
dmUgdGhlIGV2ZW50IG1wbS4gIFNvbWV0aGluZw0KPiBsaWtlIHRoaXMgd291bGQgYWxsb3cgbWUg
dG8gZHJhc3RpY2FsbHkgcmVkdWNlIHRocmVhZCBjb3VudHMgYW5kIGZyZWUgdXAgYSBsb3Qgb2YN
Cj4gYXNzb2NpYXRlZCBtZW1vcnkuDQo+IA0KPiBPdXQgb2YgY3VyaW9zaXR5LCBpcyBpdCB1c3Vh
bGx5IHRpbWUgdG8gZmlyc3QgYnl0ZSB3aGVyZSB0aGUgZGVsYXlzIHNob3cgdXA/DQo+IEkgYW0g
d29uZGVyaW5nIGlmIHRoZXJlIGlzIGEgYmlnIGJhbmctZm9yLXRoZS1idWNrIGVuaGFuY2VtZW50
IHBvc3NpYmxlIHRoZXJlDQo+IHRoYXQgZG9lc24ndCBwcmVyZXEgY2hhbmdlcyB0byBzb21lIG9m
IHRoZSBhcmVhcyB3aGVyZSBob3BwaW5nIG9uIGFuZCBvZmYgdGhlDQo+IHRocmVhZCBpcyBtb3Jl
IGNvbXBsaWNhdGVkLg0K

From dev-return-84844-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Thu Dec  3 20:26:31 2015
Return-Path: <dev-return-84844-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 757EA18D2E
	for <apmail-httpd-dev-archive@www.apache.org>; Thu,  3 Dec 2015 20:26:31 +0000 (UTC)
Received: (qmail 74010 invoked by uid 500); 3 Dec 2015 20:26:24 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 73936 invoked by uid 500); 3 Dec 2015 20:26:24 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 73926 invoked by uid 99); 3 Dec 2015 20:26:24 -0000
Received: from Unknown (HELO spamd4-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 03 Dec 2015 20:26:24 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd4-us-west.apache.org (ASF Mail Server at spamd4-us-west.apache.org) with ESMTP id 5FC57C023B
	for <dev@httpd.apache.org>; Thu,  3 Dec 2015 20:26:24 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd4-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 2.455
X-Spam-Level: **
X-Spam-Status: No, score=2.455 tagged_above=-999 required=6.31
	tests=[FROM_MISSP_EH_MATCH=1.998, KAM_LAZY_DOMAIN_SECURITY=1,
	RP_MATCHES_RCVD=-0.554, T_FROM_MISSP_DKIM=0.01, URIBL_BLOCKED=0.001]
	autolearn=disabled
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd4-us-west.apache.org [10.40.0.11]) (amavisd-new, port 10024)
	with ESMTP id nU9OVtrIE_Ga for <dev@httpd.apache.org>;
	Thu,  3 Dec 2015 20:26:17 +0000 (UTC)
Received: from mailrelay1-us-west.apache.org (mailrelay1-us-west.apache.org [209.188.14.139])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTP id A4A6E2156B
	for <dev@httpd.apache.org>; Thu,  3 Dec 2015 20:26:16 +0000 (UTC)
Received: from pony-poc.apache.org (pony-poc.apache.org [195.154.156.166])
	by mailrelay1-us-west.apache.org (ASF Mail Server at mailrelay1-us-west.apache.org) with ESMTP id ABC11E0280
	for <dev@httpd.apache.org>; Thu,  3 Dec 2015 20:26:15 +0000 (UTC)
Received: from localhost (localhost [127.0.0.1])
	by pony-poc.apache.org (ASF Mail Server at pony-poc.apache.org) with ESMTP id C0B8D2603FE
	for <dev@httpd.apache.org>; Thu,  3 Dec 2015 20:26:38 +0000 (UTC)
X-Mailer: LuaSocket 3.0-rc1
From: "Mark Thomas"<markt@apache.org>
Message-ID: <pony-5b137cbc596d31499706aa6aa103e13b58a11a55-4185771ec4fdc59f83c07e169578d800e806806f@dev.httpd.apache.org>
Content-Type: text/plain; charset="iso-8859-1"
To: <dev@httpd.apache.org>
x-ponymail-agent: PonyMail/0.1a
References: <288293CD-6D82-42E0-BFC9-9DC25F969ED6@jaguNET.com> 
Subject: Re: reverse proxy wishlist
MIME-Version: 1.0
x-ponymail-sender: 5b137cbc596d31499706aa6aa103e13b58a11a55
In-Reply-To: <288293CD-6D82-42E0-BFC9-9DC25F969ED6@jaguNET.com>
Date: Thu, 03 Dec 2015 20:26:38 -0000



On 2015-12-03 14:59, Jim Jagielski <jim@jaguNET.com> wrote: 
> I put out a call on Twitter regarding this, but wanted to
> close the loop here as well.
> 
> What would *you* like to see as new features or enhancements
> w/ mod_proxy, esp reverse proxy. I was thinking about some
> sort of active backend monitoring, utilizing watchdog, which
> could also maybe, eventually, pull in performance and load
> data for the backend for a more accurate LB provider. But
> what about new LB methods? Any ideas there?
> 
> tia.

With my Tomcat hat on:

HTTP/2 support for mod_proxy_http
HTTP upgrade support for mod_proxy_ajp (we'll need to do work on the Tomcat side as well)
Improved WebSocket support in mod_proxy_wstunnel [1].

I'm happy to help out on the Tomcat side of things where required.

Mark

[1] The mod_wstunnel assumes (at least it did the last time I looked at it) that all requests under a given URL space will be WebSocket requests. That doesn't seem to be the way many apps are being implemented. It would be great if mod_proxy would allow both mod_proxy_[ajp|http] and mod_proxy_wstunnel to be mapped to the same URL space with the 'right' one being selected based on the request.
------
Sent via Pony Mail for dev@httpd.apache.org. 
View this email online at:
https://pony-poc.apache.org/list.html?dev@httpd.apache.org

From dev-return-84845-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Thu Dec  3 21:20:23 2015
Return-Path: <dev-return-84845-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 8283318FC5
	for <apmail-httpd-dev-archive@www.apache.org>; Thu,  3 Dec 2015 21:20:23 +0000 (UTC)
Received: (qmail 44660 invoked by uid 500); 3 Dec 2015 21:20:22 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 44588 invoked by uid 500); 3 Dec 2015 21:20:22 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 44576 invoked by uid 99); 3 Dec 2015 21:20:22 -0000
Received: from Unknown (HELO spamd1-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 03 Dec 2015 21:20:22 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd1-us-west.apache.org (ASF Mail Server at spamd1-us-west.apache.org) with ESMTP id 14B36CC7BA
	for <dev@httpd.apache.org>; Thu,  3 Dec 2015 21:20:22 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd1-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 0.653
X-Spam-Level:
X-Spam-Status: No, score=0.653 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, SPF_NEUTRAL=0.652,
	URIBL_BLOCKED=0.001] autolearn=disabled
Authentication-Results: spamd1-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=comcast.net
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd1-us-west.apache.org [10.40.0.7]) (amavisd-new, port 10024)
	with ESMTP id 5TuR1rpmFJfI for <dev@httpd.apache.org>;
	Thu,  3 Dec 2015 21:20:10 +0000 (UTC)
Received: from resqmta-ch2-08v.sys.comcast.net (resqmta-ch2-08v.sys.comcast.net [69.252.207.40])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id 113682059B
	for <dev@httpd.apache.org>; Thu,  3 Dec 2015 21:20:09 +0000 (UTC)
Received: from resomta-ch2-08v.sys.comcast.net ([69.252.207.104])
	by resqmta-ch2-08v.sys.comcast.net with comcast
	id p9KY1r0042Fh1PH019L2mR; Thu, 03 Dec 2015 21:20:02 +0000
Received: from [192.168.199.10] ([69.251.84.114])
	by resomta-ch2-08v.sys.comcast.net with comcast
	id p9L11r00N2U0RYt019L1pK; Thu, 03 Dec 2015 21:20:02 +0000
Content-Type: text/plain; charset=us-ascii
Mime-Version: 1.0 (Mac OS X Mail 8.2 \(2104\))
Subject: Re: reverse proxy wishlist
From: Jim Jagielski <jim@jaguNET.com>
In-Reply-To: <CACsi250e5arsm+EzN1KDJMOD-vAmTyM8M0utTuEfedUGSUfXJw@mail.gmail.com>
Date: Thu, 3 Dec 2015 16:20:01 -0500
Content-Transfer-Encoding: 7bit
Message-Id: <289205B6-21EA-4277-9E05-3EF0DA6566DA@jaguNET.com>
References: <288293CD-6D82-42E0-BFC9-9DC25F969ED6@jaguNET.com> <CACsi250e5arsm+EzN1KDJMOD-vAmTyM8M0utTuEfedUGSUfXJw@mail.gmail.com>
To: dev@httpd.apache.org
X-Mailer: Apple Mail (2.2104)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=comcast.net;
	s=q20140121; t=1449177602;
	bh=fetQ7BNWbIYvVDbKj7VsKmfblhD/gdFiHDSxtzMZAHc=;
	h=Received:Received:Content-Type:Mime-Version:Subject:From:Date:
	 Message-Id:To;
	b=Pz460OiKMpbjwMaEefLmMgxTzJufVwdsNKbSsClikpsAo3kezUV4/iIJdIBhGEpva
	 yXZHnyTANhvfYyKjUd8IgBcUzY9xVZQMrpfL4NgY+LCm9IjdVt/3AqJT/PwXLjja35
	 iwV4YHlJdMP7ifvDWT2jqsPj+LJZx3+UC1pl0WHgn2xXiFmbP4GzXBQJmLMiEPvVVU
	 pvOrC8ZABkW5CKpMC+D1SarRq03V5w+9c0lM8bh3ob0qNLLIXTmhMiIe5RTm9Mgy3V
	 pSMhzJKXpmqk3LiJ4xp4edZqk3ZO4F0Te+jB9J2GwXTa6/um5VgDQJAJ8yak14opiY
	 gbuV9bANlybxQ==


> On Dec 3, 2015, at 11:09 AM, William A Rowe Jr <wrowe@rowe-clan.net> wrote:
> 
> On Thu, Dec 3, 2015 at 8:59 AM, Jim Jagielski <jim@jagunet.com> wrote:
> 
> What would *you* like to see as new features or enhancements
> w/ mod_proxy, esp reverse proxy.
>  
> HTTP/2 support, of course :)  It will be interesting to be able to leverage
> and compare a mod_proxy_serf vs a mod_proxy_http2 (nghttp2-based)
> engine, as mentioned in another thread - multiple implementations 
> are always good for ferreting out protocol anomalies.
> 

It's kind of funny... the "need" for http/2 between proxy and
origin seems pretty non-existant. There is a blog post by Cloudflare
somewhere about how they don't see servers talking http/2 to the
backend as anywhere near a driver, since all the things that make
it "important" (koff koff!) between browser and server don't really
apply.

Even so, I do think that re-looking into leveraging serf might
be useful, even if for other reasons.



From dev-return-84846-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Thu Dec  3 21:40:40 2015
Return-Path: <dev-return-84846-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 7714E18121
	for <apmail-httpd-dev-archive@www.apache.org>; Thu,  3 Dec 2015 21:40:40 +0000 (UTC)
Received: (qmail 16766 invoked by uid 500); 3 Dec 2015 21:40:33 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 16683 invoked by uid 500); 3 Dec 2015 21:40:33 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 16673 invoked by uid 99); 3 Dec 2015 21:40:33 -0000
Received: from Unknown (HELO spamd3-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 03 Dec 2015 21:40:33 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd3-us-west.apache.org (ASF Mail Server at spamd3-us-west.apache.org) with ESMTP id 6E0C3180AFA
	for <dev@httpd.apache.org>; Thu,  3 Dec 2015 21:40:33 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd3-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 0.653
X-Spam-Level:
X-Spam-Status: No, score=0.653 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, SPF_NEUTRAL=0.652,
	URIBL_BLOCKED=0.001] autolearn=disabled
Authentication-Results: spamd3-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=comcast.net
Received: from mx1-us-west.apache.org ([10.40.0.8])
	by localhost (spamd3-us-west.apache.org [10.40.0.10]) (amavisd-new, port 10024)
	with ESMTP id ZXsgdw02By64 for <dev@httpd.apache.org>;
	Thu,  3 Dec 2015 21:40:21 +0000 (UTC)
Received: from resqmta-po-06v.sys.comcast.net (resqmta-po-06v.sys.comcast.net [96.114.154.165])
	by mx1-us-west.apache.org (ASF Mail Server at mx1-us-west.apache.org) with ESMTPS id DA2F9232E0
	for <dev@httpd.apache.org>; Thu,  3 Dec 2015 21:40:20 +0000 (UTC)
Received: from resomta-po-09v.sys.comcast.net ([96.114.154.233])
	by resqmta-po-06v.sys.comcast.net with comcast
	id p9gE1r00352QWKC019gEhT; Thu, 03 Dec 2015 21:40:14 +0000
Received: from [192.168.199.10] ([69.251.84.114])
	by resomta-po-09v.sys.comcast.net with comcast
	id p9gD1r00C2U0RYt019gD6o; Thu, 03 Dec 2015 21:40:14 +0000
Content-Type: text/plain; charset=us-ascii
Mime-Version: 1.0 (Mac OS X Mail 8.2 \(2104\))
Subject: Re: reverse proxy wishlist
From: Jim Jagielski <jim@jaguNET.com>
In-Reply-To: <CACsi250e5arsm+EzN1KDJMOD-vAmTyM8M0utTuEfedUGSUfXJw@mail.gmail.com>
Date: Thu, 3 Dec 2015 16:40:13 -0500
Content-Transfer-Encoding: quoted-printable
Message-Id: <77E6470A-4FAD-4DAD-BE9E-E11F54388E2C@jaguNET.com>
References: <288293CD-6D82-42E0-BFC9-9DC25F969ED6@jaguNET.com> <CACsi250e5arsm+EzN1KDJMOD-vAmTyM8M0utTuEfedUGSUfXJw@mail.gmail.com>
To: dev@httpd.apache.org
X-Mailer: Apple Mail (2.2104)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=comcast.net;
	s=q20140121; t=1449178814;
	bh=lldoxOxvbRHprSOU/hsUjElA4ycpP4VxDqNKbEk4qyg=;
	h=Received:Received:Content-Type:Mime-Version:Subject:From:Date:
	 Message-Id:To;
	b=s7ZKaz399ePWOH2iPAhRoxCD0JwbZN1zOewUazfZtJATKR74fkB17hXHRit/Z7Jq8
	 cpxfz7mtfrJ1YZV2TWS5s3jImlsnqyo1UupFY+CPk+J172tUXlzIGRLhoMDNNq1qze
	 EMj28EyQ4Cw5TgKEvDVo9d0LDzFQTmmsG0ThiFFXrhN9wvzofHL85zhH9OGVfTd/3K
	 F1ZM7KxLL6jPsD8d78x1rUwFGombbd6xuw6RB/0kxlMImI4/CIfvjqGlL0eSJfW5No
	 zJtEYaC34EmeiS16TETcwzWTBWaN3cW15xcl5sVVVl0t0fCAyZuGpNd2LEJY0h/gyP
	 ALI4amoq3ogbw==


> On Dec 3, 2015, at 11:09 AM, William A Rowe Jr <wrowe@rowe-clan.net> =
wrote:
>=20
> My personal wish list is that we eliminate module bloat by coalescing
> alternative "standard" implementations into a single module again in=20=

> 2.next, and not just limited to lbmethod, but also the core socache=20
> and slotmem providers. Most stock/core implementations shouldn't=20
> change if a user wants to plug in 'yet another' option, but there is =
really=20
> no excuse for us to map so many ldobjects and text pages into the=20
> memory map of a given process, when the actual program text page=20
> of each is a few hundred opcodes, max.
>=20

Not following you there... what do you mean? You mention the
lbmethods; do you mean instead of having each method be its
own module, making them all one?


From dev-return-84847-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Thu Dec  3 21:42:38 2015
Return-Path: <dev-return-84847-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 21BB518140
	for <apmail-httpd-dev-archive@www.apache.org>; Thu,  3 Dec 2015 21:42:38 +0000 (UTC)
Received: (qmail 29256 invoked by uid 500); 3 Dec 2015 21:42:36 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 29157 invoked by uid 500); 3 Dec 2015 21:42:36 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 29096 invoked by uid 99); 3 Dec 2015 21:42:35 -0000
Received: from Unknown (HELO spamd2-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 03 Dec 2015 21:42:35 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd2-us-west.apache.org (ASF Mail Server at spamd2-us-west.apache.org) with ESMTP id 6790C1A5D2F
	for <dev@httpd.apache.org>; Thu,  3 Dec 2015 21:42:35 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd2-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 0.653
X-Spam-Level:
X-Spam-Status: No, score=0.653 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, SPF_NEUTRAL=0.652,
	URIBL_BLOCKED=0.001] autolearn=disabled
Authentication-Results: spamd2-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=comcast.net
Received: from mx1-us-west.apache.org ([10.40.0.8])
	by localhost (spamd2-us-west.apache.org [10.40.0.9]) (amavisd-new, port 10024)
	with ESMTP id TkTJHmVBMpqZ for <dev@httpd.apache.org>;
	Thu,  3 Dec 2015 21:42:26 +0000 (UTC)
Received: from resqmta-po-03v.sys.comcast.net (resqmta-po-03v.sys.comcast.net [96.114.154.162])
	by mx1-us-west.apache.org (ASF Mail Server at mx1-us-west.apache.org) with ESMTPS id 4B586232AA
	for <dev@httpd.apache.org>; Thu,  3 Dec 2015 21:42:26 +0000 (UTC)
Received: from resomta-po-10v.sys.comcast.net ([96.114.154.234])
	by resqmta-po-03v.sys.comcast.net with comcast
	id p9hs1r00353iAfU019iKhP; Thu, 03 Dec 2015 21:42:19 +0000
Received: from [192.168.199.10] ([69.251.84.114])
	by resomta-po-10v.sys.comcast.net with comcast
	id p9iK1r0072U0RYt019iKWz; Thu, 03 Dec 2015 21:42:19 +0000
Content-Type: text/plain; charset=iso-8859-1
Mime-Version: 1.0 (Mac OS X Mail 8.2 \(2104\))
Subject: Re: reverse proxy wishlist
From: Jim Jagielski <jim@jaguNET.com>
In-Reply-To: <a138da8b6df34d42a588f5a729ede044@DC01PXMBP007.jacksonnational.com>
Date: Thu, 3 Dec 2015 16:42:18 -0500
Content-Transfer-Encoding: quoted-printable
Message-Id: <3BCAF888-2CF5-4965-A644-C42B3211F6BC@jaguNET.com>
References: <288293CD-6D82-42E0-BFC9-9DC25F969ED6@jaguNET.com> <AB1691BE05AE7F4992697F2A0835627AC63B8989@VOEXM10W.internal.vodafone.com> <a138da8b6df34d42a588f5a729ede044@DC01PXMBP007.jacksonnational.com>
To: dev@httpd.apache.org
X-Mailer: Apple Mail (2.2104)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=comcast.net;
	s=q20140121; t=1449178939;
	bh=xT+UK+OCa4Zy5mdfoDzI6Spoz4taFUTjjrXR3h5NvOg=;
	h=Received:Received:Content-Type:Mime-Version:Subject:From:Date:
	 Message-Id:To;
	b=R7jKmOE13tb1Mp5fZNl0uNjpXp8CxyQm6/cTw3k6q+9hsMJddS3WKvyTWM1y9GTop
	 7XTDA83Vt0ZLuN7aTk4FUsor0ESXsYmwVphpTEwiFdu4UvWAQuYJisDREsl1d/mzSV
	 GpukkKH6SqcQc6c4RI7xLec1vbFcbgFJxba/h1nSnFZqnz1vE4weGcVrzs6iH5ATNJ
	 oTLxCV5MdVkr0tN1SyN36VP5TrFy6sAjOODNROERcUKIBBXX1NLiZ7ZdNU4Jc9Ere1
	 zv7ntACGbj3hP2FFDeN2pgyMzrDXkrz7uM5XukJ/QYIlsENv9AUSwweNYMca9bCdt8
	 pkVu0gOJPbxwQ==

Thx! assuming slow backends, how would you like httpd to
handle it: should it just slurp in the data from the backend
and buffer it and send it to the client all in one go? Should
it instead forward data as soon as it gets it?
> On Dec 3, 2015, at 12:36 PM, Houser, Rick <rick.houser@jackson.com> =
wrote:
>=20
> An async mod_proxy backend would be huge for my workloads.  In the JEE =
space I deal with, much more time is spent waiting on the application =
backends then with the clients, especially now that we have the event =
mpm.  Something like this would allow me to drastically reduce thread =
counts and free up a lot of associated memory.
>=20
>=20
> Rick Houser
> Web Administration
> (517)367-3516
>=20
>=20
>> -----Original Message-----
>> From: Pl=FCm, R=FCdiger, Vodafone Group =
[mailto:ruediger.pluem@vodafone.com]
>> Sent: Thursday, December 03, 2015 10:50 AM
>> To: dev@httpd.apache.org
>> Subject: AW: reverse proxy wishlist
>>=20
>> How about an async proxy that frees up the thread while waiting on a =
slow
>> backend?
>>=20
>> Regards
>>=20
>> R=FCdiger
>>=20
>>> -----Urspr=FCngliche Nachricht-----
>>> Von: Jim Jagielski [mailto:jim@jaguNET.com]
>>> Gesendet: Donnerstag, 3. Dezember 2015 15:59
>>> An: httpd <dev@httpd.apache.org>
>>> Betreff: reverse proxy wishlist
>>>=20
>>> I put out a call on Twitter regarding this, but wanted to
>>> close the loop here as well.
>>>=20
>>> What would *you* like to see as new features or enhancements
>>> w/ mod_proxy, esp reverse proxy. I was thinking about some
>>> sort of active backend monitoring, utilizing watchdog, which
>>> could also maybe, eventually, pull in performance and load
>>> data for the backend for a more accurate LB provider. But
>>> what about new LB methods? Any ideas there?
>>>=20
>>> tia.


From dev-return-84848-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Thu Dec  3 22:05:54 2015
Return-Path: <dev-return-84848-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 72F8718286
	for <apmail-httpd-dev-archive@www.apache.org>; Thu,  3 Dec 2015 22:05:54 +0000 (UTC)
Received: (qmail 6156 invoked by uid 500); 3 Dec 2015 22:05:54 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 6083 invoked by uid 500); 3 Dec 2015 22:05:54 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 6073 invoked by uid 99); 3 Dec 2015 22:05:53 -0000
Received: from Unknown (HELO spamd3-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 03 Dec 2015 22:05:53 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd3-us-west.apache.org (ASF Mail Server at spamd3-us-west.apache.org) with ESMTP id 85925180AFA
	for <dev@httpd.apache.org>; Thu,  3 Dec 2015 22:05:53 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd3-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 0
X-Spam-Level:
X-Spam-Status: No, score=0 tagged_above=-999 required=6.31
	tests=[SPF_PASS=-0.001, URIBL_BLOCKED=0.001] autolearn=disabled
Received: from mx1-us-west.apache.org ([10.40.0.8])
	by localhost (spamd3-us-west.apache.org [10.40.0.10]) (amavisd-new, port 10024)
	with ESMTP id qNdbeqM-_Eo2 for <dev@httpd.apache.org>;
	Thu,  3 Dec 2015 22:05:45 +0000 (UTC)
Received: from mgap1a-mgmt.jacksonnational.com (mgap1a-mgmt.jacksonnational.com [12.148.227.39])
	by mx1-us-west.apache.org (ASF Mail Server at mx1-us-west.apache.org) with ESMTPS id 4266D20CF5
	for <dev@httpd.apache.org>; Thu,  3 Dec 2015 22:05:45 +0000 (UTC)
X-IronPort-AV: E=Sophos;i="5.20,378,1444708800"; 
   d="scan'208";a="225836973"
Received: from vtunpep1a.jacksonnational.com (HELO DC03PXMBP003.jacksonnational.com) ([10.8.111.30])
  by mgap1a-mgmt.jacksonnational.com with ESMTP; 03 Dec 2015 17:05:39 -0500
Received: from DC01PXMBP007.jacksonnational.com (10.8.105.36) by
 DC03PXMBP003.jacksonnational.com (10.12.105.32) with Microsoft SMTP Server
 (TLS) id 15.0.1044.25; Thu, 3 Dec 2015 14:05:37 -0800
Received: from DC01PXMBP007.jacksonnational.com ([10.8.105.36]) by
 DC01PXMBP007.jacksonnational.com ([10.8.105.36]) with mapi id 15.00.1044.021;
 Thu, 3 Dec 2015 17:05:37 -0500
From: "Houser, Rick" <rick.houser@jackson.com>
To: "dev@httpd.apache.org" <dev@httpd.apache.org>
Subject: RE: reverse proxy wishlist
Thread-Topic: reverse proxy wishlist
Thread-Index: AQHRLdsvM4DomsTpDEyZS7B3OcNp8p65vMGA///IuGCAAJmZAP//r7Bw
Date: Thu, 3 Dec 2015 22:05:37 +0000
Message-ID: <11e505e045f14dbca9bd539d9fda7d2b@DC01PXMBP007.jacksonnational.com>
References: <288293CD-6D82-42E0-BFC9-9DC25F969ED6@jaguNET.com>
 <AB1691BE05AE7F4992697F2A0835627AC63B8989@VOEXM10W.internal.vodafone.com>
 <a138da8b6df34d42a588f5a729ede044@DC01PXMBP007.jacksonnational.com>
 <3BCAF888-2CF5-4965-A644-C42B3211F6BC@jaguNET.com>
In-Reply-To: <3BCAF888-2CF5-4965-A644-C42B3211F6BC@jaguNET.com>
Accept-Language: en-US
Content-Language: en-US
X-MS-Has-Attach:
X-MS-TNEF-Correlator:
x-ms-exchange-transport-fromentityheader: Hosted
x-originating-ip: [10.6.30.191]
x-tm-as-product-ver: SMEX-11.0.0.1251-8.000.1202-21980.003
x-tm-as-result: No--54.309700-0.000000-31
x-tm-as-user-approved-sender: Yes
x-tm-as-user-blocked-sender: No
Content-Type: text/plain; charset="iso-8859-1"
Content-Transfer-Encoding: quoted-printable
MIME-Version: 1.0
X-DLP-JNL: Passed

> assuming slow backends=20

My workload isn't so much backends slowly and steadily producing data on ea=
ch connection, but significantly long pauses before delivering any content =
at all.  The "slow" vs "paused" backend seems more applicable to something =
like a PHP backend without a View/Presentation tier (as in MVC).

> how would you like httpd to handle it: should it just slurp in the data f=
rom the backend and buffer it and send it to the client all in one go? Shou=
ld it instead forward data as soon as it gets it?

I would think any such backend should forward the response body (or complet=
e request without a body) as soon as it comes in, streaming if the content =
is large enough (ex. a PDF).

If I desired to buffer all the data before sending to clients (not applicab=
le to me, but I can imagine some use cases), that would be the job of a sep=
arate module sitting on the output filter chain, wouldn't it?


Rick Houser
Web Administration
(517)367-3516


> -----Original Message-----
> From: Jim Jagielski [mailto:jim@jaguNET.com]
> Sent: Thursday, December 03, 2015 4:42 PM
> To: dev@httpd.apache.org
> Subject: Re: reverse proxy wishlist
>=20
> Thx! assuming slow backends, how would you like httpd to
> handle it: should it just slurp in the data from the backend
> and buffer it and send it to the client all in one go? Should
> it instead forward data as soon as it gets it?
> > On Dec 3, 2015, at 12:36 PM, Houser, Rick <rick.houser@jackson.com>
> wrote:
> >
> > An async mod_proxy backend would be huge for my workloads.  In the JEE
> space I deal with, much more time is spent waiting on the application bac=
kends
> then with the clients, especially now that we have the event mpm.  Someth=
ing
> like this would allow me to drastically reduce thread counts and free up =
a lot of
> associated memory.
> >
> >
> > Rick Houser
> > Web Administration
> > (517)367-3516
> >
> >
> >> -----Original Message-----
> >> From: Pl=FCm, R=FCdiger, Vodafone Group
> [mailto:ruediger.pluem@vodafone.com]
> >> Sent: Thursday, December 03, 2015 10:50 AM
> >> To: dev@httpd.apache.org
> >> Subject: AW: reverse proxy wishlist
> >>
> >> How about an async proxy that frees up the thread while waiting on a s=
low
> >> backend?
> >>
> >> Regards
> >>
> >> R=FCdiger
> >>
> >>> -----Urspr=FCngliche Nachricht-----
> >>> Von: Jim Jagielski [mailto:jim@jaguNET.com]
> >>> Gesendet: Donnerstag, 3. Dezember 2015 15:59
> >>> An: httpd <dev@httpd.apache.org>
> >>> Betreff: reverse proxy wishlist
> >>>
> >>> I put out a call on Twitter regarding this, but wanted to
> >>> close the loop here as well.
> >>>
> >>> What would *you* like to see as new features or enhancements
> >>> w/ mod_proxy, esp reverse proxy. I was thinking about some
> >>> sort of active backend monitoring, utilizing watchdog, which
> >>> could also maybe, eventually, pull in performance and load
> >>> data for the backend for a more accurate LB provider. But
> >>> what about new LB methods? Any ideas there?
> >>>
> >>> tia.


From dev-return-84849-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Thu Dec  3 23:43:52 2015
Return-Path: <dev-return-84849-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 7597518658
	for <apmail-httpd-dev-archive@www.apache.org>; Thu,  3 Dec 2015 23:43:52 +0000 (UTC)
Received: (qmail 29311 invoked by uid 500); 3 Dec 2015 23:39:22 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 27616 invoked by uid 500); 3 Dec 2015 23:39:21 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 27029 invoked by uid 99); 3 Dec 2015 23:36:29 -0000
Received: from Unknown (HELO spamd1-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 03 Dec 2015 23:36:29 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd1-us-west.apache.org (ASF Mail Server at spamd1-us-west.apache.org) with ESMTP id 32728CC7FB
	for <dev@httpd.apache.org>; Thu,  3 Dec 2015 23:28:48 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd1-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 3
X-Spam-Level: ***
X-Spam-Status: No, score=3 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, HTML_MESSAGE=3,
	SPF_PASS=-0.001, URIBL_BLOCKED=0.001] autolearn=disabled
Authentication-Results: spamd1-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=rowe-clan-net.20150623.gappssmtp.com
Received: from mx1-us-west.apache.org ([10.40.0.8])
	by localhost (spamd1-us-west.apache.org [10.40.0.7]) (amavisd-new, port 10024)
	with ESMTP id 8wM9jVbd0Qfd for <dev@httpd.apache.org>;
	Thu,  3 Dec 2015 23:28:39 +0000 (UTC)
Received: from mail-io0-f174.google.com (mail-io0-f174.google.com [209.85.223.174])
	by mx1-us-west.apache.org (ASF Mail Server at mx1-us-west.apache.org) with ESMTPS id 5DB64232AA
	for <dev@httpd.apache.org>; Thu,  3 Dec 2015 23:28:39 +0000 (UTC)
Received: by ioir85 with SMTP id r85so98621244ioi.1
        for <dev@httpd.apache.org>; Thu, 03 Dec 2015 15:28:38 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=rowe-clan-net.20150623.gappssmtp.com; s=20150623;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        bh=KqDAs+SgoyaGeZuxvJC1O5+WmqqUc7kJHEDMIL5v7S8=;
        b=N/oG+Pxn3zhos3KJikElhCUzFyFcMImEwW5JKNnHs4G+YCm+NhhhfhwA2/6d3mVS68
         CmNcatMA2EHXSZPvV/4a8Tc0pXig0PASZq3NIBuw9BQns73R+vQE8jCLSLxVitOs7iUy
         +yYsWFlhjDB/wFyXl+BKjd/qxiEtnOgN0qaZUO6g7crIrgMumTaEefxogXofS6kAFzW2
         rUCM19dSunTZomednEsuLl6guXddWvO8rYQ6veb66Y7aNhB6DRIno9hFNBzh+2+rMVtM
         KSvXpnGZHqLsHwvgZ366XNMQx7KKPiP9RmUkst0aUF6x968QCE1LIOwZJvvfBLpqCtKb
         LHZQ==
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=1e100.net; s=20130820;
        h=x-gm-message-state:mime-version:in-reply-to:references:date
         :message-id:subject:from:to:content-type;
        bh=KqDAs+SgoyaGeZuxvJC1O5+WmqqUc7kJHEDMIL5v7S8=;
        b=XuwsA7EOnRoz5EyYytBtxeuuHiIfKp9LZsO97nRdNQEi4ca20u13B34RMpKJrQuGhF
         0nJLqFUmnJRIOOPoax8pt4lsIib3IMZx4HRIJMd8BsMUu/mdw2hzX3mRoq3JJVpLktj+
         cw4kR6ORuPDX6jicEQVniguNxDIay2dudjGEjXbEujM0fp7zUnZF+RXv+3o0xXeyFuXD
         qmGlNrcIaZkVCt/pHIleUPFfAyQg8sFSjJ22DywgYJh5IBP6zCTgWHT5AfN46urAlK9/
         Crz2vdOhZEu5lI2uykjFvQ8Bfozwg/vMm3m79YdwV755VTId782OvaFmMvQ+Dpq4RS2E
         AI+w==
X-Gm-Message-State: ALoCoQnovY7IMijnG9BwjxkFW9UW4eVstLRuPMqHFJYASGx/XuDlaMR/WLmgSLItcHZvRta0u5zh
MIME-Version: 1.0
X-Received: by 10.107.156.6 with SMTP id f6mr11212075ioe.163.1449185318872;
 Thu, 03 Dec 2015 15:28:38 -0800 (PST)
Received: by 10.107.62.136 with HTTP; Thu, 3 Dec 2015 15:28:38 -0800 (PST)
In-Reply-To: <289205B6-21EA-4277-9E05-3EF0DA6566DA@jaguNET.com>
References: <288293CD-6D82-42E0-BFC9-9DC25F969ED6@jaguNET.com>
	<CACsi250e5arsm+EzN1KDJMOD-vAmTyM8M0utTuEfedUGSUfXJw@mail.gmail.com>
	<289205B6-21EA-4277-9E05-3EF0DA6566DA@jaguNET.com>
Date: Thu, 3 Dec 2015 17:28:38 -0600
Message-ID: <CACsi251_R89dSCpyLgX6aqYCKoQqGRy3VhX35sNX+kgRYUGeTw@mail.gmail.com>
Subject: Re: reverse proxy wishlist
From: William A Rowe Jr <wrowe@rowe-clan.net>
To: httpd <dev@httpd.apache.org>
Content-Type: multipart/alternative; boundary=001a1140ccc0254608052606c02b

--001a1140ccc0254608052606c02b
Content-Type: text/plain; charset=UTF-8

On Thu, Dec 3, 2015 at 3:20 PM, Jim Jagielski <jim@jagunet.com> wrote:

>
> > On Dec 3, 2015, at 11:09 AM, William A Rowe Jr <wrowe@rowe-clan.net>
> wrote:
> >
> > On Thu, Dec 3, 2015 at 8:59 AM, Jim Jagielski <jim@jagunet.com> wrote:
> >
> > What would *you* like to see as new features or enhancements
> > w/ mod_proxy, esp reverse proxy.
> >
> > HTTP/2 support, of course :)  It will be interesting to be able to
> leverage
> > and compare a mod_proxy_serf vs a mod_proxy_http2 (nghttp2-based)
> > engine, as mentioned in another thread - multiple implementations
> > are always good for ferreting out protocol anomalies.
> >
>
> It's kind of funny... the "need" for http/2 between proxy and
> origin seems pretty non-existant. There is a blog post by Cloudflare
> somewhere about how they don't see servers talking http/2 to the
> backend as anywhere near a driver, since all the things that make
> it "important" (koff koff!) between browser and server don't really
> apply.
>

AIUI the reason for http/2 to ignore the OSI Network definition was that
they knew better, and there is a demand for concurrent requests and
responses.  It seems that fits the fat-pipe of 400 concurrent requests
between a gateway and backend app server more than the few pipes
needed between a web browser and the gateway.  /shrug :)


> Even so, I do think that re-looking into leveraging serf might
> be useful, even if for other reasons.
>

I'd agree, either as the h2, h2c or http/1.1 provider.

--001a1140ccc0254608052606c02b
Content-Type: text/html; charset=UTF-8
Content-Transfer-Encoding: quoted-printable

<div dir=3D"ltr"><div class=3D"gmail_extra"><div class=3D"gmail_quote">On T=
hu, Dec 3, 2015 at 3:20 PM, Jim Jagielski <span dir=3D"ltr">&lt;<a href=3D"=
mailto:jim@jagunet.com" target=3D"_blank">jim@jagunet.com</a>&gt;</span> wr=
ote:<br><blockquote class=3D"gmail_quote" style=3D"margin:0 0 0 .8ex;border=
-left:1px #ccc solid;padding-left:1ex"><span class=3D""><br>
&gt; On Dec 3, 2015, at 11:09 AM, William A Rowe Jr &lt;<a href=3D"mailto:w=
rowe@rowe-clan.net">wrowe@rowe-clan.net</a>&gt; wrote:<br>
&gt;<br>
&gt; On Thu, Dec 3, 2015 at 8:59 AM, Jim Jagielski &lt;<a href=3D"mailto:ji=
m@jagunet.com">jim@jagunet.com</a>&gt; wrote:<br>
&gt;<br>
&gt; What would *you* like to see as new features or enhancements<br>
&gt; w/ mod_proxy, esp reverse proxy.<br>
&gt;<br>
&gt; HTTP/2 support, of course :)=C2=A0 It will be interesting to be able t=
o leverage<br>
&gt; and compare a mod_proxy_serf vs a mod_proxy_http2 (nghttp2-based)<br>
&gt; engine, as mentioned in another thread - multiple implementations<br>
&gt; are always good for ferreting out protocol anomalies.<br>
&gt;<br>
<br>
</span>It&#39;s kind of funny... the &quot;need&quot; for http/2 between pr=
oxy and<br>
origin seems pretty non-existant. There is a blog post by Cloudflare<br>
somewhere about how they don&#39;t see servers talking http/2 to the<br>
backend as anywhere near a driver, since all the things that make<br>
it &quot;important&quot; (koff koff!) between browser and server don&#39;t =
really<br>
apply.<br></blockquote><div><br></div><div>AIUI the reason for http/2 to ig=
nore the OSI Network definition was that=C2=A0</div><div>they knew better, =
and there is a demand for concurrent requests and</div><div>responses.=C2=
=A0 It seems that fits the fat-pipe of 400 concurrent requests</div><div>be=
tween a gateway and backend app server more than the few pipes</div><div>ne=
eded between a web browser and the gateway. =C2=A0/shrug :)</div><div>=C2=
=A0</div><blockquote class=3D"gmail_quote" style=3D"margin:0 0 0 .8ex;borde=
r-left:1px #ccc solid;padding-left:1ex">
Even so, I do think that re-looking into leveraging serf might<br>
be useful, even if for other reasons.<br></blockquote><div><br></div><div>I=
&#39;d agree, either as the h2, h2c or http/1.1 provider.=C2=A0</div></div>=
</div></div>

--001a1140ccc0254608052606c02b--

From dev-return-84850-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Thu Dec  3 23:45:30 2015
Return-Path: <dev-return-84850-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 6FB3C1868C
	for <apmail-httpd-dev-archive@www.apache.org>; Thu,  3 Dec 2015 23:45:30 +0000 (UTC)
Received: (qmail 42447 invoked by uid 500); 3 Dec 2015 23:42:08 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 42368 invoked by uid 500); 3 Dec 2015 23:42:08 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 42315 invoked by uid 99); 3 Dec 2015 23:42:07 -0000
Received: from Unknown (HELO spamd2-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 03 Dec 2015 23:42:07 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd2-us-west.apache.org (ASF Mail Server at spamd2-us-west.apache.org) with ESMTP id 94F9D1A5D55
	for <dev@httpd.apache.org>; Thu,  3 Dec 2015 23:25:47 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd2-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 3
X-Spam-Level: ***
X-Spam-Status: No, score=3 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, HTML_MESSAGE=3,
	SPF_PASS=-0.001, URIBL_BLOCKED=0.001] autolearn=disabled
Authentication-Results: spamd2-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=rowe-clan-net.20150623.gappssmtp.com
Received: from mx1-us-west.apache.org ([10.40.0.8])
	by localhost (spamd2-us-west.apache.org [10.40.0.9]) (amavisd-new, port 10024)
	with ESMTP id K9p1LPhxnttH for <dev@httpd.apache.org>;
	Thu,  3 Dec 2015 23:25:36 +0000 (UTC)
Received: from mail-io0-f171.google.com (mail-io0-f171.google.com [209.85.223.171])
	by mx1-us-west.apache.org (ASF Mail Server at mx1-us-west.apache.org) with ESMTPS id 5DDB221621
	for <dev@httpd.apache.org>; Thu,  3 Dec 2015 23:25:36 +0000 (UTC)
Received: by ioir85 with SMTP id r85so98560739ioi.1
        for <dev@httpd.apache.org>; Thu, 03 Dec 2015 15:25:35 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=rowe-clan-net.20150623.gappssmtp.com; s=20150623;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        bh=P6lOqn2G+cVxRDMx4jYBajnErZNi4ZZSnugb/rWUepQ=;
        b=YuekGAU+iyGTla6Mv+HtqqyKL+J9c+XNA3lgp/83AUDcQvzv+C+nVF4ut0es9e6L8u
         5Cn2F3ftizR8N318GMsd3dlz3xaF63Vs/oHZEWOzDCRF7eimnMMiNLrCJ8nVuPO1KHCI
         BRiUx0G9EnBB+rc5Iudok5WL+RCDnckuq/NYAQXWG9h+FikJR7iT5egI4kSQPkoEWByc
         TNCqJ19OirnpZtX1837yD913bZoEymsOCEZP4b3Oko+D9g/EqGH9i3t9PLS3FbTv9/ud
         jhAb5YrTAtIw+kZq/7acTKMXX0WDxvbi/7a7wHYlJzn8ZDpMdl/mhDpcykPheF2goIKN
         lymQ==
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=1e100.net; s=20130820;
        h=x-gm-message-state:mime-version:in-reply-to:references:date
         :message-id:subject:from:to:content-type;
        bh=P6lOqn2G+cVxRDMx4jYBajnErZNi4ZZSnugb/rWUepQ=;
        b=YYyRAJq5EEskCBAVuOA3ppt6F1gIou566qPUFUd3BZJxHsqcVDV2N84/Q/8oSXOr7+
         zNzFtff1pGeqdtow1lJ9sQQNL9zRTjORJR3LdkGT/3K3YaJ8qTUktfgSbr2Qpwh5j/ce
         uvSDBPkEeKstQW8fxJgIoBVETDVjBbw3gq5Fv//QHxJJzj5R7cDTnPLF0KvVTQz4W1Dn
         8KF6J+QGXTgRgBqqHa7SsosM5Pfg12R3/QiV31V9eYWxxrpnPUAZJjVCvz8emePqq8Il
         ioj3ZMbubzQ1fN2K/+jbqDMfark+HW4LoA6DD+kRtaP/jb/Mq2VnherfYYo6eea6p3y7
         c/aw==
X-Gm-Message-State: ALoCoQnQjlOKfy0cz2fyGv8pnn/xWKQzP9e7ix+8vR1oL3sg3PWc60jXDbYfDTM0pclkFbvfNpA/
MIME-Version: 1.0
X-Received: by 10.107.34.199 with SMTP id i190mr11625304ioi.150.1449185135491;
 Thu, 03 Dec 2015 15:25:35 -0800 (PST)
Received: by 10.107.62.136 with HTTP; Thu, 3 Dec 2015 15:25:35 -0800 (PST)
In-Reply-To: <77E6470A-4FAD-4DAD-BE9E-E11F54388E2C@jaguNET.com>
References: <288293CD-6D82-42E0-BFC9-9DC25F969ED6@jaguNET.com>
	<CACsi250e5arsm+EzN1KDJMOD-vAmTyM8M0utTuEfedUGSUfXJw@mail.gmail.com>
	<77E6470A-4FAD-4DAD-BE9E-E11F54388E2C@jaguNET.com>
Date: Thu, 3 Dec 2015 17:25:35 -0600
Message-ID: <CACsi250wpsmUsC5kEWfJOAoYKHG28m2N6NrizHXsHFjU7_nVYQ@mail.gmail.com>
Subject: Re: reverse proxy wishlist
From: William A Rowe Jr <wrowe@rowe-clan.net>
To: httpd <dev@httpd.apache.org>
Content-Type: multipart/alternative; boundary=001a1140d9443711bb052606b5a2

--001a1140d9443711bb052606b5a2
Content-Type: text/plain; charset=UTF-8

On Thu, Dec 3, 2015 at 3:40 PM, Jim Jagielski <jim@jagunet.com> wrote:

>
> > On Dec 3, 2015, at 11:09 AM, William A Rowe Jr <wrowe@rowe-clan.net>
> wrote:
> >
> > My personal wish list is that we eliminate module bloat by coalescing
> > alternative "standard" implementations into a single module again in
> > 2.next, and not just limited to lbmethod, but also the core socache
> > and slotmem providers. Most stock/core implementations shouldn't
> > change if a user wants to plug in 'yet another' option, but there is
> really
> > no excuse for us to map so many ldobjects and text pages into the
> > memory map of a given process, when the actual program text page
> > of each is a few hundred opcodes, max.
> >
>
> Not following you there... what do you mean? You mention the
> lbmethods; do you mean instead of having each method be its
> own module, making them all one?
>

Not specific to lbmethods but yes, one mod_lbmethod_core.so provider
of the basic set of 3-4 methods that right now eat up a lot of 64kb process
page mappings for no particular benefit.  The builder could even decide
these
are compiled-in to the base httpd.  We don't dismiss the loadable approach,
we simply decide this subset is effectively baked, and then use the loadable
lbmethod to extend yet another experimental/dynamic/evolving method, from
the ASF or third parties.

--001a1140d9443711bb052606b5a2
Content-Type: text/html; charset=UTF-8
Content-Transfer-Encoding: quoted-printable

<div dir=3D"ltr"><div class=3D"gmail_extra"><div class=3D"gmail_quote">On T=
hu, Dec 3, 2015 at 3:40 PM, Jim Jagielski <span dir=3D"ltr">&lt;<a href=3D"=
mailto:jim@jagunet.com" target=3D"_blank">jim@jagunet.com</a>&gt;</span> wr=
ote:<br><blockquote class=3D"gmail_quote" style=3D"margin:0 0 0 .8ex;border=
-left:1px #ccc solid;padding-left:1ex"><span class=3D""><br>
&gt; On Dec 3, 2015, at 11:09 AM, William A Rowe Jr &lt;<a href=3D"mailto:w=
rowe@rowe-clan.net">wrowe@rowe-clan.net</a>&gt; wrote:<br>
&gt;<br>
</span><span class=3D"">&gt; My personal wish list is that we eliminate mod=
ule bloat by coalescing<br>
&gt; alternative &quot;standard&quot; implementations into a single module =
again in<br>
&gt; 2.next, and not just limited to lbmethod, but also the core socache<br=
>
&gt; and slotmem providers. Most stock/core implementations shouldn&#39;t<b=
r>
&gt; change if a user wants to plug in &#39;yet another&#39; option, but th=
ere is really<br>
&gt; no excuse for us to map so many ldobjects and text pages into the<br>
&gt; memory map of a given process, when the actual program text page<br>
&gt; of each is a few hundred opcodes, max.<br>
&gt;<br>
<br>
</span>Not following you there... what do you mean? You mention the<br>
lbmethods; do you mean instead of having each method be its<br>
own module, making them all one?<br></blockquote><div><br></div><div>Not sp=
ecific to lbmethods but yes, one mod_lbmethod_core.so provider</div><div>of=
 the basic set of 3-4 methods that right now eat up a lot of 64kb process</=
div><div>page mappings for no particular benefit.=C2=A0 The builder could e=
ven decide these</div><div>are compiled-in to the base httpd.=C2=A0 We don&=
#39;t dismiss the loadable approach,</div><div>we simply decide this subset=
 is effectively baked, and then use the loadable</div><div>lbmethod to exte=
nd yet another experimental/dynamic/evolving method, from</div><div>the ASF=
 or third parties.</div><div>=C2=A0</div></div><br></div></div>

--001a1140d9443711bb052606b5a2--

From dev-return-84851-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Fri Dec  4 00:05:23 2015
Return-Path: <dev-return-84851-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id AFA9A18793
	for <apmail-httpd-dev-archive@www.apache.org>; Fri,  4 Dec 2015 00:05:23 +0000 (UTC)
Received: (qmail 22072 invoked by uid 500); 4 Dec 2015 00:05:22 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 21992 invoked by uid 500); 4 Dec 2015 00:05:22 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 21982 invoked by uid 99); 4 Dec 2015 00:05:22 -0000
Received: from Unknown (HELO spamd1-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 04 Dec 2015 00:05:22 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd1-us-west.apache.org (ASF Mail Server at spamd1-us-west.apache.org) with ESMTP id 3F0E1C4C3C
	for <dev@httpd.apache.org>; Fri,  4 Dec 2015 00:05:22 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd1-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.1
X-Spam-Level:
X-Spam-Status: No, score=-0.1 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	SPF_PASS=-0.001, URIBL_BLOCKED=0.001] autolearn=disabled
Authentication-Results: spamd1-us-west.apache.org (amavisd-new);
	dkim=pass (1024-bit key) header.d=qqmail.nl
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd1-us-west.apache.org [10.40.0.7]) (amavisd-new, port 10024)
	with ESMTP id LpMlO0X3w67Q for <dev@httpd.apache.org>;
	Fri,  4 Dec 2015 00:05:12 +0000 (UTC)
Received: from mail-wm0-f46.google.com (mail-wm0-f46.google.com [74.125.82.46])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id B26DB42AD1
	for <dev@httpd.apache.org>; Fri,  4 Dec 2015 00:05:12 +0000 (UTC)
Received: by wmvv187 with SMTP id v187so51655254wmv.1
        for <dev@httpd.apache.org>; Thu, 03 Dec 2015 16:05:11 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=qqmail.nl; s=google;
        h=from:to:references:in-reply-to:subject:date:message-id:mime-version
         :content-type:content-transfer-encoding:thread-index
         :content-language;
        bh=e9HJiJ2Rw0EhRlowp3B+2Iq//ka4DeFmTuHhTj/CCQI=;
        b=FjPPGLkmPRaKdMjg1GXYftzjVK4lOs+EYcw0YTz44lzzTFL34U22B5WLiXWSWcx7Tn
         MkoBCeT1dWXpKZRti0gCaWcUvFt3au6VnnHeinNMyzbWm5yDdyFmU45FGW3k5GXsqZAS
         SJ/oMsVNf3pjypiuAn66mgAIE8x/atFhALTks=
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=1e100.net; s=20130820;
        h=x-gm-message-state:from:to:references:in-reply-to:subject:date
         :message-id:mime-version:content-type:content-transfer-encoding
         :thread-index:content-language;
        bh=e9HJiJ2Rw0EhRlowp3B+2Iq//ka4DeFmTuHhTj/CCQI=;
        b=jsAbVRj72ci8/FrKXWdbCmmwqosAXTqdBhQkJK7o2Eox9KsZu36/I21GU8T9GcwfCm
         u0CkGHGpvs2F2C3D3Yx9Czyzl4GsckRQ7S9SOA0MmZjYjk0ddlOnXcn0ZX7QRnvMDb3x
         DHMkVFBSpMVOaZAtkWyzHn257Uq/sYQK/5xOMScPsWN2fNavZqCcM9lsyQmLeCo7KUtI
         TUTj6MISsJa2szFkpSuGhkxCVuWaQdPny3pFpwA7fHoThy0STfg2A83qbMwTDhJvk+eu
         BUiGKkdkLubWktKCNu+XjzMIIsxDNDHJde/5XqMD/D75KRYwyjufkz6tm2Fn8BAB70no
         ePOQ==
X-Gm-Message-State: ALoCoQkDfjEzsX6lHRfp5+4bl5qDYpd25s0/FGLmKmrEya9LCZ+uOp1/mUGbISViZ+j6ZzBrFE13XUkUHR99Cu01Xkktg+Tj3Q==
X-Received: by 10.28.65.213 with SMTP id o204mr1266282wma.83.1449187511839;
        Thu, 03 Dec 2015 16:05:11 -0800 (PST)
Received: from i72600 ([2001:610:66e:0:52e5:49ff:fee1:96b7])
        by smtp.gmail.com with ESMTPSA id hp9sm9658544wjb.43.2015.12.03.16.05.10
        for <dev@httpd.apache.org>
        (version=TLSv1/SSLv3 cipher=OTHER);
        Thu, 03 Dec 2015 16:05:11 -0800 (PST)
From: "Bert Huijben" <bert@qqmail.nl>
To: <dev@httpd.apache.org>
References: <288293CD-6D82-42E0-BFC9-9DC25F969ED6@jaguNET.com> <CACsi250e5arsm+EzN1KDJMOD-vAmTyM8M0utTuEfedUGSUfXJw@mail.gmail.com> <289205B6-21EA-4277-9E05-3EF0DA6566DA@jaguNET.com>
In-Reply-To: <289205B6-21EA-4277-9E05-3EF0DA6566DA@jaguNET.com>
Subject: RE: reverse proxy wishlist
Date: Fri, 4 Dec 2015 01:05:08 +0100
Message-ID: <042e01d12e27$70f9db00$52ed9100$@qqmail.nl>
MIME-Version: 1.0
Content-Type: text/plain;
	charset="us-ascii"
Content-Transfer-Encoding: 7bit
X-Mailer: Microsoft Outlook 16.0
Thread-Index: AQKIc0Ipz12+IUJKrSck3sh4mmMlkwK5RiigArdsXC6dH+Gu0A==
Content-Language: nl



> -----Original Message-----
> From: Jim Jagielski [mailto:jim@jaguNET.com]
> Sent: donderdag 3 december 2015 22:20
> To: dev@httpd.apache.org
> Subject: Re: reverse proxy wishlist
> 
> 
> > On Dec 3, 2015, at 11:09 AM, William A Rowe Jr <wrowe@rowe-clan.net>
> wrote:
> >
> > On Thu, Dec 3, 2015 at 8:59 AM, Jim Jagielski <jim@jagunet.com> wrote:
> >
> > What would *you* like to see as new features or enhancements
> > w/ mod_proxy, esp reverse proxy.
> >
> > HTTP/2 support, of course :)  It will be interesting to be able to
leverage
> > and compare a mod_proxy_serf vs a mod_proxy_http2 (nghttp2-based)
> > engine, as mentioned in another thread - multiple implementations
> > are always good for ferreting out protocol anomalies.
> >
> 
> It's kind of funny... the "need" for http/2 between proxy and
> origin seems pretty non-existant. There is a blog post by Cloudflare
> somewhere about how they don't see servers talking http/2 to the
> backend as anywhere near a driver, since all the things that make
> it "important" (koff koff!) between browser and server don't really
> apply.

After having implemented fcgi (server support) and http/2 (server and
client) in Apache Serf I was thinking that it would be nice if H2 would
replace the existing server side protocols.

http/1.1 requires chunking or explicit content-length, while http/2 and fcgi
don't have that requirement.



The reason I implemented the server side of those protocols in Apache Serf
was exactly to allow writing such origins with Serf...

Adding such a backend server process is one of the (many) possible
directions Subversion might take in the future.

	Bert


From dev-return-84852-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Fri Dec  4 01:36:41 2015
Return-Path: <dev-return-84852-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id E7C8B18A55
	for <apmail-httpd-dev-archive@www.apache.org>; Fri,  4 Dec 2015 01:36:41 +0000 (UTC)
Received: (qmail 73739 invoked by uid 500); 4 Dec 2015 01:36:41 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 73655 invoked by uid 500); 4 Dec 2015 01:36:41 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 73645 invoked by uid 99); 4 Dec 2015 01:36:41 -0000
Received: from Unknown (HELO spamd1-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 04 Dec 2015 01:36:41 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd1-us-west.apache.org (ASF Mail Server at spamd1-us-west.apache.org) with ESMTP id EB95DCC977
	for <dev@httpd.apache.org>; Fri,  4 Dec 2015 01:36:40 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd1-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.101
X-Spam-Level:
X-Spam-Status: No, score=-0.101 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	SPF_PASS=-0.001] autolearn=disabled
Authentication-Results: spamd1-us-west.apache.org (amavisd-new);
	dkim=pass (1024-bit key) header.d=qqmail.nl
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd1-us-west.apache.org [10.40.0.7]) (amavisd-new, port 10024)
	with ESMTP id AWMl817dEw2n for <dev@httpd.apache.org>;
	Fri,  4 Dec 2015 01:36:36 +0000 (UTC)
Received: from mail-wm0-f50.google.com (mail-wm0-f50.google.com [74.125.82.50])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id C6E72441C2
	for <dev@httpd.apache.org>; Fri,  4 Dec 2015 01:36:35 +0000 (UTC)
Received: by wmuu63 with SMTP id u63so44043235wmu.0
        for <dev@httpd.apache.org>; Thu, 03 Dec 2015 17:36:34 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=qqmail.nl; s=google;
        h=from:to:references:in-reply-to:subject:date:message-id:mime-version
         :content-type:content-transfer-encoding:thread-index
         :content-language;
        bh=SfaydB1Yu61K8yH7T/yThA4aoHEO1hZ2vH+UhQt5y8o=;
        b=K/H3XbLSxCC5gQ2zRJ7OfwTdIeL4rK15+6f+V+BEUJcpkSPZgJoa8wTyPvReWbj1lo
         i1mlkIL2kX4NgMQJkEtACk3yDhu+6aFeOgFlxkG0eoa/EmzgTHlY1gsMM/9RyEt+H1pj
         nzHJ9IloGz8gypUAcovwfUmZlMswKo0tW9LFk=
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=1e100.net; s=20130820;
        h=x-gm-message-state:from:to:references:in-reply-to:subject:date
         :message-id:mime-version:content-type:content-transfer-encoding
         :thread-index:content-language;
        bh=SfaydB1Yu61K8yH7T/yThA4aoHEO1hZ2vH+UhQt5y8o=;
        b=L9B5rYzX1t4uOrqM2fGn5cwPt8IGxRsoCFJUb6H9C1mbKdaOYDzGlSvNFZoQkMqGyU
         F9bJJauGGZJIxYAeSR5V8DjVZxP1YLo+HtRRMnC5OLc5Nnej9I1/ZYIIiqJEO/dxgjo/
         7i1Jf7hzhG43txoURmjvYjifvGyP8c9cWdVWp7tZn0gSsLXcYe8i4PfsndF3uB/o0uFP
         S4BqolHWnogOmf7SwwI9glkm9naefqUpkeuGijHCPL8PPL8IrnIBr7CV/DD2RrqfnUbg
         P/64ewbYLYLWXym12JHXn4BKovp8dozGMDdMAEpyLPbEw7ckiWAvtXZGi6puClr6TSsi
         XdZQ==
X-Gm-Message-State: ALoCoQmCeXHFy5nU0edPGew0nU8wCLsD2HAyYrtPFQOZLGV2KEGz9J6Zs1y3mEDiIojPaUGmznl8
X-Received: by 10.194.121.7 with SMTP id lg7mr13782828wjb.90.1449192994761;
        Thu, 03 Dec 2015 17:36:34 -0800 (PST)
Received: from i72600 ([2001:610:66e:0:52e5:49ff:fee1:96b7])
        by smtp.gmail.com with ESMTPSA id r74sm1351848wmb.2.2015.12.03.17.36.33
        for <dev@httpd.apache.org>
        (version=TLSv1/SSLv3 cipher=OTHER);
        Thu, 03 Dec 2015 17:36:33 -0800 (PST)
From: "Bert Huijben" <bert@qqmail.nl>
To: <dev@httpd.apache.org>
References: <56599792.3060402@greenbytes.de> <03a401d129dd$fafdbfe0$f0f93fa0$@qqmail.nl> <03aa01d129e1$2d49d990$87dd8cb0$@qqmail.nl> <040101d12a23$ced65530$6c82ff90$@qqmail.nl> <40F35186-1FFF-48EF-BB67-DAE432526244@greenbytes.de> <46014DD1-B5DA-4920-B0E2-C43B43EB4816@jaguNET.com> <mnjp5b1qdm4sgu56t413p2bmblsqjpd9og@4ax.com> <78BF1B01-16EE-4071-803B-A174432C9503@jaguNET.com> <b47r5b5n1mf2oeeb33tidnsdvvr5dckjvf@4ax.com> <CACsi253Egm-K71wTd5Ff3gD6AFdhAgm1pHXafE5Kobzb4WejBQ@mail.gmail.com> <bqdr5blheuoccudj4sc7jql6e4dn8furd9@4ax.com> <1D08ECCD-A26B-4D3D-8F12-BE97018059B7@greenbytes.de>
In-Reply-To: <1D08ECCD-A26B-4D3D-8F12-BE97018059B7@greenbytes.de>
Subject: RE: No H2 Window updates!
Date: Fri, 4 Dec 2015 02:36:31 +0100
Message-ID: <043901d12e34$34d311c0$9e793540$@qqmail.nl>
MIME-Version: 1.0
Content-Type: text/plain;
	charset="us-ascii"
Content-Transfer-Encoding: 7bit
X-Mailer: Microsoft Outlook 16.0
Thread-Index: AQGXGGWJK51+8wmg6dya3z8sXP1eVQLJjD3WAYllbXMBus9ogwKvsD/MAwKh+zsBpLTtNQHfE9rNAXh0TekCRD5t/wJkXKwcAdb2BCSedFeAoA==
Content-Language: nl

> -----Original Message-----
> From: Stefan Eissing [mailto:stefan.eissing@greenbytes.de]
> Sent: woensdag 2 december 2015 15:45
> To: dev@httpd.apache.org
> Subject: Re: No H2 Window updates!
> 
> Please find with r1717641 version 1.0.9-DEV of mod_http2 in trunk and
> branches/2.4.x
> that fixes the issue of streams with smallish inputs and lost
> WINDOW_UPDATEs.
> 
> Please report back if this works for you. I have another time slot on
Friday
> where I can follow up on it. Thanks.

I haven't traced for other problems yet, but the current
^/httpd/httpd/branches/2.4.x branch does *NOT* the windowing issue for me.

My Subversion testrun still gets stuck on that same 'svnmover' test, unless
I set H2WindowSize to a higher value.

	Bert



From dev-return-84853-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Fri Dec  4 08:19:45 2015
Return-Path: <dev-return-84853-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 24737105EE
	for <apmail-httpd-dev-archive@www.apache.org>; Fri,  4 Dec 2015 08:19:45 +0000 (UTC)
Received: (qmail 42429 invoked by uid 500); 4 Dec 2015 08:19:44 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 42354 invoked by uid 500); 4 Dec 2015 08:19:44 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 42341 invoked by uid 99); 4 Dec 2015 08:19:44 -0000
Received: from Unknown (HELO spamd3-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 04 Dec 2015 08:19:44 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd3-us-west.apache.org (ASF Mail Server at spamd3-us-west.apache.org) with ESMTP id 389A0180A34
	for <dev@httpd.apache.org>; Fri,  4 Dec 2015 08:19:44 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd3-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 3.001
X-Spam-Level: ***
X-Spam-Status: No, score=3.001 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, HTML_MESSAGE=3,
	URIBL_BLOCKED=0.001] autolearn=disabled
Authentication-Results: spamd3-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=rowe-clan-net.20150623.gappssmtp.com
Received: from mx1-us-west.apache.org ([10.40.0.8])
	by localhost (spamd3-us-west.apache.org [10.40.0.10]) (amavisd-new, port 10024)
	with ESMTP id mEe_hjYn0f82 for <dev@httpd.apache.org>;
	Fri,  4 Dec 2015 08:19:34 +0000 (UTC)
Received: from mail-ig0-f176.google.com (mail-ig0-f176.google.com [209.85.213.176])
	by mx1-us-west.apache.org (ASF Mail Server at mx1-us-west.apache.org) with ESMTPS id DE2AD2059E
	for <dev@httpd.apache.org>; Fri,  4 Dec 2015 08:19:33 +0000 (UTC)
Received: by igcph11 with SMTP id ph11so28237983igc.1
        for <dev@httpd.apache.org>; Fri, 04 Dec 2015 00:19:33 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=rowe-clan-net.20150623.gappssmtp.com; s=20150623;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        bh=jM2D0+qvswIpTZI72K6ShUBq5VE8aRNFnYYtX7x2220=;
        b=P77yp6HfoFR1lPbnlBsm6Hz1yoTF/7krEyH1iV/M2YlpQYJJ1Y/1tI2nlbsUL7SToL
         MxwvOedgZIqmEjRji/VAB//P5F11jOXivIEVCcbuQr0oFaHXUWeRHEpJGRAj+gpSylK8
         vPaHuNFV/g1MCgdHETz43ikatKGg2eHOyMhWPs+cRtjZ9jqBVKdY8WHWGvJOoG04XQnM
         xVgeDH3WSZaN/sF0kDdW/uA7ntya7eHl/8OQMkzho00lvTctj24GtUESCslvO+VTDtmV
         6L4AZ+dvBvhk/aueruyBbqg9NiztWD+/Ae47CwzCDrpfsUvSQyKFiMD0H2ayTeUfThQg
         LAIw==
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=1e100.net; s=20130820;
        h=x-gm-message-state:mime-version:in-reply-to:references:date
         :message-id:subject:from:to:content-type;
        bh=jM2D0+qvswIpTZI72K6ShUBq5VE8aRNFnYYtX7x2220=;
        b=kaAOheC3xRdlpwi1lUQ8gO1Q+ttHLuPZijFjn5Ii3m00Z5eHGBk6b+RKgaWeCZ3Lc+
         FEvweSNsYoAIL/A8vbJGmpMbtUU/p7QUaYfby6TsPSykNNRZMOz+B5pTtpgmULOD/gj1
         s2aLl8KP8VOGGlswfaxEhSGSw6aXlEH9BQGltRVVqjlj7YuSazNUo7Vj+cqssf8ymf10
         Mw1TuauBC1NfNCwU5Z5QFj8UPBDmOR+CMrt2X4SqETk0xr2QmzsrVqulrPDP+/EvLQIs
         vfY0QtSbF1xlG9YM5T1G/KAnFktD9dpNXfxo3TLlFQS2MAHFjUNweX1M6WG3gP/ClkZS
         msSw==
X-Gm-Message-State: ALoCoQlLWQrai3BsHJKsTjpkdkRbPVyBjjnfkPrAh2MHgBfBYZ3nF8W1MSV4dKVWtrvYknQd6iJA
MIME-Version: 1.0
X-Received: by 10.50.79.196 with SMTP id l4mr2778639igx.77.1449217173203; Fri,
 04 Dec 2015 00:19:33 -0800 (PST)
Received: by 10.107.62.136 with HTTP; Fri, 4 Dec 2015 00:19:33 -0800 (PST)
In-Reply-To: <07B73602-4BB5-42E1-B02E-F0F7DA202AA2@greenbytes.de>
References: <CACsi253w59mfpPJ96wE4Xc8S4sLSiifCCH-MxPrcx244g=dHyw@mail.gmail.com>
	<565F5D55.5020309@thelounge.net>
	<CACsi252Cwx0HbA-9F+4kBirkkFVD6LD-fDmHSWMer_4rJ6GmTA@mail.gmail.com>
	<07B73602-4BB5-42E1-B02E-F0F7DA202AA2@greenbytes.de>
Date: Fri, 4 Dec 2015 02:19:33 -0600
Message-ID: <CACsi253jH+yLL8wNKyxcDPZ7yWmxrS=fjXp7PovbWozuQDiGuA@mail.gmail.com>
Subject: Re: Broken 2.4 ./configure
From: William A Rowe Jr <wrowe@rowe-clan.net>
To: httpd <dev@httpd.apache.org>
Content-Type: multipart/alternative; boundary=089e01183f48cfcefa05260e2ad3

--089e01183f48cfcefa05260e2ad3
Content-Type: text/plain; charset=UTF-8

On Wed, Dec 2, 2015 at 5:24 PM, Stefan Eissing <stefan.eissing@greenbytes.de
> wrote:

> I put it on my TODO for friday, maybe I can conf/ifdef around it without
> too much pain.
>
> Am 02.12.2015 um 23:16 schrieb William A Rowe Jr <wrowe@rowe-clan.net>:
>
> On Wed, Dec 2, 2015 at 3:06 PM, Reindl Harald <h.reindl@thelounge.net>
> wrote:
>
>>
>> Am 02.12.2015 um 21:53 schrieb William A Rowe Jr:
>>
>>> It seems nghttp2 1.2.1 is no longer supported?  If we are missing an
>>> #include, let's fix, and if we want to drop support, that's fine too, but
>>> ./configure needs to reject the invalid version of nghttp2.
>>
>>
> Note that we couldn't normally drop support for an older nghttp2,
> but mod_http2 was clearly tagged as experimental, so packagers
> who pick it up and enable it are responsible for keeping up.
>
> Reindl identifies one distribution that will be immediately burned
> by picking up 2.4.18 without also bumping nghttp2 to 1.3 or later...
>
> This is the version shipping on FC22...
>>> nghttp2.x86_64                       1.2.1-1.fc22
>>>
>>
>> unconfirmed
>>
>> [builduser@buildserver:~]$ rpm -q httpd
>> httpd-2.4.17-2.fc22.20151012.rh.x86_64
>>
>
> We are on two different pages, I'm speaking of branches/2.4.x at
> 2.4.18-dev,
> based on current backports.  I wasn't commenting on the previous release.
>
>
I'm glad you can look at this over the weekend. I am just fine with
demanding a different version of nghttp2, or deciding on a baseline
and then offering "more correct" functionality on another rev level.
I expect most of dev@httpd will agree since we declared this all
experimental.

Off topic, can you explain why core Upgrade requests are dealt with
as a 'handler', since they are protocol layer details? the "core upgrade"
''handler'' is sort of oxymoronic, since upgrade is one protocol to another
in the course of a specific received request, and it the implementation
appears to break all http rfcs?  There is no way to incorporate the
prior/initial TLS/n.n upgrade, per spec, in this current schema as
implemented.

I hope we can revert/fix/enhance prior to 2.4.18 'working' release?

Cheers,

Bill

--089e01183f48cfcefa05260e2ad3
Content-Type: text/html; charset=UTF-8
Content-Transfer-Encoding: quoted-printable

<div dir=3D"ltr"><div class=3D"gmail_extra"><div class=3D"gmail_quote">On W=
ed, Dec 2, 2015 at 5:24 PM, Stefan Eissing <span dir=3D"ltr">&lt;<a href=3D=
"mailto:stefan.eissing@greenbytes.de" target=3D"_blank">stefan.eissing@gree=
nbytes.de</a>&gt;</span> wrote:<br><blockquote class=3D"gmail_quote" style=
=3D"margin:0px 0px 0px 0.8ex;border-left-width:1px;border-left-color:rgb(20=
4,204,204);border-left-style:solid;padding-left:1ex"><div dir=3D"auto"><div=
></div><div>I put it on my TODO for friday, maybe I can conf/ifdef around i=
t without too much pain.=C2=A0</div><div><div class=3D"h5"><div><br>Am 02.1=
2.2015 um 23:16 schrieb William A Rowe Jr &lt;<a href=3D"mailto:wrowe@rowe-=
clan.net" target=3D"_blank">wrowe@rowe-clan.net</a>&gt;:<br><br></div><bloc=
kquote type=3D"cite"><div><div dir=3D"ltr"><div class=3D"gmail_extra"><div =
class=3D"gmail_quote">On Wed, Dec 2, 2015 at 3:06 PM, Reindl Harald <span d=
ir=3D"ltr">&lt;<a href=3D"mailto:h.reindl@thelounge.net" target=3D"_blank">=
h.reindl@thelounge.net</a>&gt;</span> wrote:<br><blockquote class=3D"gmail_=
quote" style=3D"margin:0px 0px 0px 0.8ex;border-left-width:1px;border-left-=
color:rgb(204,204,204);border-left-style:solid;padding-left:1ex"><span><br>
Am 02.12.2015 um 21:53 schrieb William A Rowe Jr:<br>
<blockquote class=3D"gmail_quote" style=3D"margin:0px 0px 0px 0.8ex;border-=
left-width:1px;border-left-color:rgb(204,204,204);border-left-style:solid;p=
adding-left:1ex">
It seems nghttp2 1.2.1 is no longer supported?=C2=A0 If we are missing an<b=
r>
#include,=C2=A0let&#39;s fix, and if we want to drop support, that&#39;s fi=
ne too, but<br>
./configure needs=C2=A0to reject the invalid version of nghttp2.</blockquot=
e></span></blockquote><div>=C2=A0</div><div>Note that we couldn&#39;t norma=
lly drop support for an older nghttp2,=C2=A0</div><div>but mod_http2 was cl=
early tagged as experimental, so packagers</div><div>who pick it up and ena=
ble it are responsible for keeping up.</div><div><br></div><div>Reindl iden=
tifies one distribution that will be immediately burned</div><div>by pickin=
g up 2.4.18 without also bumping nghttp2 to 1.3 or later...</div><div><br><=
/div><blockquote class=3D"gmail_quote" style=3D"margin:0px 0px 0px 0.8ex;bo=
rder-left-width:1px;border-left-color:rgb(204,204,204);border-left-style:so=
lid;padding-left:1ex"><span><blockquote class=3D"gmail_quote" style=3D"marg=
in:0px 0px 0px 0.8ex;border-left-width:1px;border-left-color:rgb(204,204,20=
4);border-left-style:solid;padding-left:1ex">This is the version shipping=
=C2=A0on FC22...<br>
nghttp2.x86_64=C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=
=A0 =C2=A0 =C2=A0 =C2=A01.2.1-1.fc22<br>
</blockquote>
<br></span>
unconfirmed<br>
<br>
[builduser@buildserver:~]$ rpm -q httpd<br>
httpd-2.4.17-2.fc22.20151012.rh.x86_64<br></blockquote><div><br></div><div>=
We are on two different pages, I&#39;m speaking of branches/2.4.x at 2.4.18=
-dev,</div><div>based on current backports.=C2=A0 I wasn&#39;t commenting o=
n the previous release.=C2=A0</div></div><br></div></div>
</div></blockquote></div></div></div></blockquote></div><br></div><div clas=
s=3D"gmail_extra">I&#39;m glad you can look at this over the weekend. I am =
just fine with</div><div class=3D"gmail_extra">demanding a different versio=
n of nghttp2, or deciding on a baseline</div><div class=3D"gmail_extra">and=
 then offering &quot;more correct&quot; functionality on another rev level.=
</div><div class=3D"gmail_extra">I expect most of dev@httpd will agree sinc=
e we declared this all</div><div class=3D"gmail_extra">experimental.<br><di=
v><br></div><div class=3D"gmail_extra">Off topic, can you explain why core =
Upgrade requests are dealt with</div><div class=3D"gmail_extra">as a &#39;h=
andler&#39;, since they are protocol layer details? the &quot;core upgrade&=
quot;</div><div class=3D"gmail_extra">&#39;&#39;handler&#39;&#39; is sort o=
f oxymoronic, since upgrade is one protocol to another</div><div class=3D"g=
mail_extra">in the course of a specific received request, and it the implem=
entation</div><div class=3D"gmail_extra">appears to break all http rfcs?=C2=
=A0 There is no way to incorporate the=C2=A0</div><div class=3D"gmail_extra=
">prior/initial TLS/n.n upgrade, per spec, in this current schema as</div><=
div class=3D"gmail_extra">implemented.</div><div class=3D"gmail_extra"><br>=
</div><div class=3D"gmail_extra">I hope we can revert/fix/enhance prior to =
2.4.18 &#39;working&#39; release?</div><div class=3D"gmail_extra"><br></div=
><div class=3D"gmail_extra">Cheers,</div><div class=3D"gmail_extra"><br></d=
iv><div class=3D"gmail_extra">Bill</div><div class=3D"gmail_extra"><br></di=
v><div class=3D"gmail_extra"><br></div></div></div>

--089e01183f48cfcefa05260e2ad3--

From dev-return-84854-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Fri Dec  4 09:18:34 2015
Return-Path: <dev-return-84854-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 1570910817
	for <apmail-httpd-dev-archive@www.apache.org>; Fri,  4 Dec 2015 09:18:34 +0000 (UTC)
Received: (qmail 42667 invoked by uid 500); 4 Dec 2015 09:18:33 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 42584 invoked by uid 500); 4 Dec 2015 09:18:33 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 42574 invoked by uid 99); 4 Dec 2015 09:18:32 -0000
Received: from Unknown (HELO spamd4-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 04 Dec 2015 09:18:32 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd4-us-west.apache.org (ASF Mail Server at spamd4-us-west.apache.org) with ESMTP id 3D133C0FFA
	for <dev@httpd.apache.org>; Fri,  4 Dec 2015 09:18:32 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd4-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.654
X-Spam-Level:
X-Spam-Status: No, score=-0.654 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RP_MATCHES_RCVD=-0.554, SPF_PASS=-0.001, URIBL_BLOCKED=0.001]
	autolearn=disabled
Authentication-Results: spamd4-us-west.apache.org (amavisd-new);
	dkim=pass (1024-bit key) header.d=greenbytes.de
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd4-us-west.apache.org [10.40.0.11]) (amavisd-new, port 10024)
	with ESMTP id ny-RhgsF-dsV for <dev@httpd.apache.org>;
	Fri,  4 Dec 2015 09:18:17 +0000 (UTC)
Received: from mail.greenbytes.de (mail.greenbytes.de [217.91.35.233])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id 6716624E19
	for <dev@httpd.apache.org>; Fri,  4 Dec 2015 09:18:16 +0000 (UTC)
Received: from [192.168.178.61] (unknown [93.211.117.216])
	(using TLSv1 with cipher ECDHE-RSA-AES256-SHA (256/256 bits))
	(Client did not present a certificate)
	by mail.greenbytes.de (Postfix) with ESMTPSA id E821B15A035E
	for <dev@httpd.apache.org>; Fri,  4 Dec 2015 10:18:09 +0100 (CET)
DKIM-Signature: v=1; a=rsa-sha256; c=simple/simple; d=greenbytes.de; s=mail;
	t=1449220689; bh=IrNIwMG2AAjBEmFyTlNjCzPoMBL9/GL4ddeEJPBeb3U=;
	h=From:Subject:Date:References:In-Reply-To:To:From;
	b=C7gTOn6M6mFtYiXcEB/8JfvKIoUMR/p3c0YNyB4TxhZe6bzI8Qx6LBOeO1cLoH/+V
	 aQZP2uhg2AZNSaCVjkwC+IHHTDPxZPspZZd6JKSVOxpqazU93DIKbRgi0yH10YcHIK
	 3s/2jSGhldOhpIj8EudX7P2DoNCeCESTAohM15cs=
From: Stefan Eissing <stefan.eissing@greenbytes.de>
Content-Type: text/plain;
	charset=us-ascii
Content-Transfer-Encoding: quoted-printable
Mime-Version: 1.0 (1.0)
Subject: Re: No H2 Window updates!
Message-Id: <10770C7F-5C8D-42EB-9E76-DC91160FDA89@greenbytes.de>
Date: Fri, 4 Dec 2015 10:18:09 +0100
References: <56599792.3060402@greenbytes.de> <03a401d129dd$fafdbfe0$f0f93fa0$@qqmail.nl> <03aa01d129e1$2d49d990$87dd8cb0$@qqmail.nl> <040101d12a23$ced65530$6c82ff90$@qqmail.nl> <40F35186-1FFF-48EF-BB67-DAE432526244@greenbytes.de> <46014DD1-B5DA-4920-B0E2-C43B43EB4816@jaguNET.com> <mnjp5b1qdm4sgu56t413p2bmblsqjpd9og@4ax.com> <78BF1B01-16EE-4071-803B-A174432C9503@jaguNET.com> <b47r5b5n1mf2oeeb33tidnsdvvr5dckjvf@4ax.com> <CACsi253Egm-K71wTd5Ff3gD6AFdhAgm1pHXafE5Kobzb4WejBQ@mail.gmail.com> <bqdr5blheuoccudj4sc7jql6e4dn8furd9@4ax.com> <1D08ECCD-A26B-4D3D-8F12-BE97018059B7@greenbytes.de> <043901d12e34$34d311c0$9e793540$@qqmail.nl>
In-Reply-To: <043901d12e34$34d311c0$9e793540$@qqmail.nl>
To: dev@httpd.apache.org
X-Mailer: iPhone Mail (13B143)

That is unfortunate. I added a test case which reproduced window exhaustion b=
efore I fixed it. What sort of requests do still miss window updates? conten=
t-length? response codes?
thx.=20

Am 04.12.2015 um 02:36 schrieb Bert Huijben <bert@qqmail.nl>:

>> -----Original Message-----
>> From: Stefan Eissing [mailto:stefan.eissing@greenbytes.de]
>> Sent: woensdag 2 december 2015 15:45
>> To: dev@httpd.apache.org
>> Subject: Re: No H2 Window updates!
>>=20
>> Please find with r1717641 version 1.0.9-DEV of mod_http2 in trunk and
>> branches/2.4.x
>> that fixes the issue of streams with smallish inputs and lost
>> WINDOW_UPDATEs.
>>=20
>> Please report back if this works for you. I have another time slot on
> Friday
>> where I can follow up on it. Thanks.
>=20
> I haven't traced for other problems yet, but the current
> ^/httpd/httpd/branches/2.4.x branch does *NOT* the windowing issue for me.=

>=20
> My Subversion testrun still gets stuck on that same 'svnmover' test, unles=
s
> I set H2WindowSize to a higher value.
>=20
>    Bert
>=20
>=20

From dev-return-84855-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Fri Dec  4 09:51:19 2015
Return-Path: <dev-return-84855-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 6A3DD10943
	for <apmail-httpd-dev-archive@www.apache.org>; Fri,  4 Dec 2015 09:51:19 +0000 (UTC)
Received: (qmail 2024 invoked by uid 500); 4 Dec 2015 09:51:19 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 1953 invoked by uid 500); 4 Dec 2015 09:51:18 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 1943 invoked by uid 99); 4 Dec 2015 09:51:18 -0000
Received: from Unknown (HELO spamd3-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 04 Dec 2015 09:51:18 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd3-us-west.apache.org (ASF Mail Server at spamd3-us-west.apache.org) with ESMTP id 57ADF1809AB
	for <dev@httpd.apache.org>; Fri,  4 Dec 2015 09:51:18 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd3-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.1
X-Spam-Level:
X-Spam-Status: No, score=-0.1 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	SPF_PASS=-0.001, URIBL_BLOCKED=0.001] autolearn=disabled
Authentication-Results: spamd3-us-west.apache.org (amavisd-new);
	dkim=pass (1024-bit key) header.d=qqmail.nl
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd3-us-west.apache.org [10.40.0.10]) (amavisd-new, port 10024)
	with ESMTP id NUU1RM5TQ-ym for <dev@httpd.apache.org>;
	Fri,  4 Dec 2015 09:51:10 +0000 (UTC)
Received: from mail-wm0-f54.google.com (mail-wm0-f54.google.com [74.125.82.54])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id F015442AD1
	for <dev@httpd.apache.org>; Fri,  4 Dec 2015 09:51:09 +0000 (UTC)
Received: by wmec201 with SMTP id c201so65926637wme.0
        for <dev@httpd.apache.org>; Fri, 04 Dec 2015 01:51:03 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=qqmail.nl; s=google;
        h=from:to:references:in-reply-to:subject:date:message-id:mime-version
         :content-type:content-transfer-encoding:thread-index
         :content-language;
        bh=l8xNIcqUr5+Iti1x7RH1yfIXxSpyOOYyXEz6FXMMz7I=;
        b=alq2wHVZUsHQdBj+ggweXBDjntv8mEtJsmdD9lyrUGStGJWL8dcVhsMCXlCGYG4NiU
         ABNsX+A+35SRPsK7ZVNolpzmTt5lzP3uRxXcugNTj+GE9ClsCXDgQBRDWXrCHk+Q4ihx
         K+ELX91GEettA4/bKJzyGRf/2iJr81HpDpbDk=
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=1e100.net; s=20130820;
        h=x-gm-message-state:from:to:references:in-reply-to:subject:date
         :message-id:mime-version:content-type:content-transfer-encoding
         :thread-index:content-language;
        bh=l8xNIcqUr5+Iti1x7RH1yfIXxSpyOOYyXEz6FXMMz7I=;
        b=fzvAARNhvF4w5O7nduOEljG1+xjUKuVdZj4Qp4W2t4vZkKBSDxxZNYm5eqe/pSiEx5
         j1KXLJLlChw1fR5O+9k+1yKGgoP+8qzYywcEVZPO0LnJ8a0EGzXrAnlUhVoDyYXUpMQj
         VLZFO4oKaR6P8jAMC+FHewOesMUceeseuXWd+hmobMPxT8XUkcYiEIjv+4/ntv2LfLfD
         3gadOAb5m48Qq8iomRcGenB4i2ufuUTQb+lb7Vv++0l/lgHgTvfete977t4ANay5iMvT
         IJNUjJF4iUjYfofBytJJ0rORnmNp7pq9Ydmf2oRo9cDm8fMU9nBeRlMsh1flfjNZrMDL
         /yxw==
X-Gm-Message-State: ALoCoQn9qIdLJpLLxpWwF407tkkhiRZ3hNpSW+kLOVluQAOxjeED9SIZjxVwxbqePlh/HF3AGrYJtcLZ9vENHZu8VJ/hfAVx1g==
X-Received: by 10.28.99.214 with SMTP id x205mr3788172wmb.20.1449222663448;
        Fri, 04 Dec 2015 01:51:03 -0800 (PST)
Received: from i72600 ([2001:610:66e:0:52e5:49ff:fee1:96b7])
        by smtp.gmail.com with ESMTPSA id ot9sm11349201wjc.12.2015.12.04.01.51.02
        for <dev@httpd.apache.org>
        (version=TLSv1/SSLv3 cipher=OTHER);
        Fri, 04 Dec 2015 01:51:02 -0800 (PST)
From: "Bert Huijben" <bert@qqmail.nl>
To: <dev@httpd.apache.org>
References: <56599792.3060402@greenbytes.de> <03a401d129dd$fafdbfe0$f0f93fa0$@qqmail.nl> <03aa01d129e1$2d49d990$87dd8cb0$@qqmail.nl> <040101d12a23$ced65530$6c82ff90$@qqmail.nl> <40F35186-1FFF-48EF-BB67-DAE432526244@greenbytes.de> <46014DD1-B5DA-4920-B0E2-C43B43EB4816@jaguNET.com> <mnjp5b1qdm4sgu56t413p2bmblsqjpd9og@4ax.com> <78BF1B01-16EE-4071-803B-A174432C9503@jaguNET.com> <b47r5b5n1mf2oeeb33tidnsdvvr5dckjvf@4ax.com> <CACsi253Egm-K71wTd5Ff3gD6AFdhAgm1pHXafE5Kobzb4WejBQ@mail.gmail.com> <bqdr5blheuoccudj4sc7jql6e4dn8furd9@4ax.com> <1D08ECCD-A26B-4D3D-8F12-BE97018059B7@greenbytes.de> <043901d12e34$34d311c0$9e793540$@qqmail.nl> <10770C7F-5C8D-42EB-9E76-DC91160FDA89@greenbytes.de>
In-Reply-To: <10770C7F-5C8D-42EB-9E76-DC91160FDA89@greenbytes.de>
Subject: RE: No H2 Window updates!
Date: Fri, 4 Dec 2015 10:50:58 +0100
Message-ID: <045e01d12e79$493fe620$dbbfb260$@qqmail.nl>
MIME-Version: 1.0
Content-Type: text/plain;
	charset="us-ascii"
Content-Transfer-Encoding: 7bit
X-Mailer: Microsoft Outlook 16.0
Thread-Index: AQGXGGWJK51+8wmg6dya3z8sXP1eVQLJjD3WAYllbXMBus9ogwKvsD/MAwKh+zsBpLTtNQHfE9rNAXh0TekCRD5t/wJkXKwcAdb2BCQBbeFkWgFQGgpgnl7qGBA=
Content-Language: nl

> -----Original Message-----
> From: Stefan Eissing [mailto:stefan.eissing@greenbytes.de]
> Sent: vrijdag 4 december 2015 10:18
> To: dev@httpd.apache.org
> Subject: Re: No H2 Window updates!
> 
> That is unfortunate. I added a test case which reproduced window
> exhaustion before I fixed it. What sort of requests do still miss window
> updates? content-length? response codes?

I don't think we send content-length headers... (see older problem). I fixed
Subversion to always send Content-Type though.

I'm going to add some more tracing to get the details again, but from what I
remember is that I had requests with 113 and 128 bytes +- over and over.

[The tool experiencing this problem is a tool that tries to replicate some
behavior we can't express in Subversion yet. To implement this it asks the
server for similar things over and over. If we decide that we go this way we
would probably send one advanced request and get one response from the
server... But currently it is a nice tool to test the network IO limits :-)]

These requests are always 1 HEADERS (/endofheaders) + 1 DATA (/eos) and the
response is not much either (Certainly less than 1 Kbyte, so probably just
HEADERS+1 DATA as well)


----------------------
Ok, added some logging back.

I still don't see a lot of window updates, but I do see some.

After my connection windows is slightly below 32767... I receive a single
connection window update to bring it back to exactly 32767. In all cases in
this log this update is < 100 bytes. (1 <= update < 256).

But then I don't receive further window updates until my connection window
is almost depleted... And then I get another 255 bytes or so. Not enough to
get through the test.

The log I just used is on:
https://lpt1.nl/f/2015/201512-NoWindow.txt 
(Search for 'DBG: Connection window update' to find the updates between the
allocations)

	Bert


From dev-return-84856-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Fri Dec  4 11:40:18 2015
Return-Path: <dev-return-84856-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 1F77D10D42
	for <apmail-httpd-dev-archive@www.apache.org>; Fri,  4 Dec 2015 11:40:18 +0000 (UTC)
Received: (qmail 9589 invoked by uid 500); 4 Dec 2015 11:39:54 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 9508 invoked by uid 500); 4 Dec 2015 11:39:54 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 9498 invoked by uid 99); 4 Dec 2015 11:39:54 -0000
Received: from Unknown (HELO spamd4-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 04 Dec 2015 11:39:54 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd4-us-west.apache.org (ASF Mail Server at spamd4-us-west.apache.org) with ESMTP id E4C08C1273
	for <dev@httpd.apache.org>; Fri,  4 Dec 2015 11:39:53 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd4-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.654
X-Spam-Level:
X-Spam-Status: No, score=-0.654 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RP_MATCHES_RCVD=-0.554, SPF_PASS=-0.001, URIBL_BLOCKED=0.001]
	autolearn=disabled
Authentication-Results: spamd4-us-west.apache.org (amavisd-new);
	dkim=pass (1024-bit key) header.d=greenbytes.de
Received: from mx1-us-west.apache.org ([10.40.0.8])
	by localhost (spamd4-us-west.apache.org [10.40.0.11]) (amavisd-new, port 10024)
	with ESMTP id OQ2ZbR6VeuCT for <dev@httpd.apache.org>;
	Fri,  4 Dec 2015 11:39:43 +0000 (UTC)
Received: from mail.greenbytes.de (mail.greenbytes.de [217.91.35.233])
	by mx1-us-west.apache.org (ASF Mail Server at mx1-us-west.apache.org) with ESMTPS id CD1B62021D
	for <dev@httpd.apache.org>; Fri,  4 Dec 2015 11:39:42 +0000 (UTC)
Received: from [192.168.178.41] (unknown [93.211.117.216])
	(using TLSv1 with cipher ECDHE-RSA-AES256-SHA (256/256 bits))
	(Client did not present a certificate)
	by mail.greenbytes.de (Postfix) with ESMTPSA id A83F015A0455
	for <dev@httpd.apache.org>; Fri,  4 Dec 2015 12:39:34 +0100 (CET)
DKIM-Signature: v=1; a=rsa-sha256; c=simple/simple; d=greenbytes.de; s=mail;
	t=1449229174; bh=/I4WBSlLLwo5vESsot6gvptjAGdpo1WXKw/qU9UnmZM=;
	h=Subject:From:In-Reply-To:Date:References:To:From;
	b=r5Dpi4UtjI0ehLspkccBFfJMbtIfoeVt8otnCqL4YPkcbNpDufoSl+wh5OpS6BbC6
	 YHnqJNiZJ8O+hxNFcPp4PrNK0T/bzveu/XnttTB7cliLwgCNAczi8ofA3KglzyWBcf
	 kmB/gEWYGJl9weEPI5H/HO4uBp3o67qwRc7W6GbQ=
Content-Type: text/plain; charset=us-ascii
Mime-Version: 1.0 (Mac OS X Mail 9.1 \(3096.5\))
Subject: Re: Broken 2.4 ./configure
From: Stefan Eissing <stefan.eissing@greenbytes.de>
In-Reply-To: <CACsi253jH+yLL8wNKyxcDPZ7yWmxrS=fjXp7PovbWozuQDiGuA@mail.gmail.com>
Date: Fri, 4 Dec 2015 12:39:34 +0100
Content-Transfer-Encoding: quoted-printable
Message-Id: <6B925418-FB4D-4F77-8E3D-E65FE38DF469@greenbytes.de>
References: <CACsi253w59mfpPJ96wE4Xc8S4sLSiifCCH-MxPrcx244g=dHyw@mail.gmail.com> <565F5D55.5020309@thelounge.net> <CACsi252Cwx0HbA-9F+4kBirkkFVD6LD-fDmHSWMer_4rJ6GmTA@mail.gmail.com> <07B73602-4BB5-42E1-B02E-F0F7DA202AA2@greenbytes.de> <CACsi253jH+yLL8wNKyxcDPZ7yWmxrS=fjXp7PovbWozuQDiGuA@mail.gmail.com>
To: dev@httpd.apache.org
X-Mailer: Apple Mail (2.3096.5)

mod_http2 in /trunk now checks for a minimum nghttp2 version of 1.2.1 =
and #ifdefs code accordingly. Will backport to 2.4.x later together with =
other changes.

> Am 04.12.2015 um 09:19 schrieb William A Rowe Jr =
<wrowe@rowe-clan.net>:
>=20
> On Wed, Dec 2, 2015 at 5:24 PM, Stefan Eissing =
<stefan.eissing@greenbytes.de> wrote:
> I put it on my TODO for friday, maybe I can conf/ifdef around it =
without too much pain.=20
>=20
> Am 02.12.2015 um 23:16 schrieb William A Rowe Jr =
<wrowe@rowe-clan.net>:
>=20
>> On Wed, Dec 2, 2015 at 3:06 PM, Reindl Harald =
<h.reindl@thelounge.net> wrote:
>>=20
>> Am 02.12.2015 um 21:53 schrieb William A Rowe Jr:
>> It seems nghttp2 1.2.1 is no longer supported?  If we are missing an
>> #include, let's fix, and if we want to drop support, that's fine too, =
but
>> ./configure needs to reject the invalid version of nghttp2.
>> =20
>> Note that we couldn't normally drop support for an older nghttp2,=20
>> but mod_http2 was clearly tagged as experimental, so packagers
>> who pick it up and enable it are responsible for keeping up.
>>=20
>> Reindl identifies one distribution that will be immediately burned
>> by picking up 2.4.18 without also bumping nghttp2 to 1.3 or later...
>>=20
>> This is the version shipping on FC22...
>> nghttp2.x86_64                       1.2.1-1.fc22
>>=20
>> unconfirmed
>>=20
>> [builduser@buildserver:~]$ rpm -q httpd
>> httpd-2.4.17-2.fc22.20151012.rh.x86_64
>>=20
>> We are on two different pages, I'm speaking of branches/2.4.x at =
2.4.18-dev,
>> based on current backports.  I wasn't commenting on the previous =
release.=20
>>=20
>=20
> I'm glad you can look at this over the weekend. I am just fine with
> demanding a different version of nghttp2, or deciding on a baseline
> and then offering "more correct" functionality on another rev level.
> I expect most of dev@httpd will agree since we declared this all
> experimental.
>=20
> Off topic, can you explain why core Upgrade requests are dealt with
> as a 'handler', since they are protocol layer details? the "core =
upgrade"
> ''handler'' is sort of oxymoronic, since upgrade is one protocol to =
another
> in the course of a specific received request, and it the =
implementation
> appears to break all http rfcs?  There is no way to incorporate the=20
> prior/initial TLS/n.n upgrade, per spec, in this current schema as
> implemented.
>=20
> I hope we can revert/fix/enhance prior to 2.4.18 'working' release?
>=20
> Cheers,
>=20
> Bill
>=20
>=20


From dev-return-84857-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Fri Dec  4 13:33:20 2015
Return-Path: <dev-return-84857-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id E53A81817A
	for <apmail-httpd-dev-archive@www.apache.org>; Fri,  4 Dec 2015 13:33:20 +0000 (UTC)
Received: (qmail 32288 invoked by uid 500); 4 Dec 2015 13:33:20 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 32201 invoked by uid 500); 4 Dec 2015 13:33:19 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 32191 invoked by uid 99); 4 Dec 2015 13:33:19 -0000
Received: from Unknown (HELO spamd3-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 04 Dec 2015 13:33:19 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd3-us-west.apache.org (ASF Mail Server at spamd3-us-west.apache.org) with ESMTP id 46B9B1809E4
	for <dev@httpd.apache.org>; Fri,  4 Dec 2015 13:33:19 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd3-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 0.653
X-Spam-Level:
X-Spam-Status: No, score=0.653 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, SPF_NEUTRAL=0.652,
	URIBL_BLOCKED=0.001] autolearn=disabled
Authentication-Results: spamd3-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=comcast.net
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd3-us-west.apache.org [10.40.0.10]) (amavisd-new, port 10024)
	with ESMTP id LnW4qcjGXYLh for <dev@httpd.apache.org>;
	Fri,  4 Dec 2015 13:33:07 +0000 (UTC)
Received: from resqmta-po-07v.sys.comcast.net (resqmta-po-07v.sys.comcast.net [96.114.154.166])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id 8339024C66
	for <dev@httpd.apache.org>; Fri,  4 Dec 2015 13:33:06 +0000 (UTC)
Received: from resomta-po-01v.sys.comcast.net ([96.114.154.225])
	by resqmta-po-07v.sys.comcast.net with comcast
	id pRYq1r0044s37d401RYznm; Fri, 04 Dec 2015 13:32:59 +0000
Received: from [192.168.199.10] ([69.251.84.114])
	by resomta-po-01v.sys.comcast.net with comcast
	id pRYy1r00B2U0RYt01RYys9; Fri, 04 Dec 2015 13:32:59 +0000
Content-Type: text/plain; charset=us-ascii
Mime-Version: 1.0 (Mac OS X Mail 8.2 \(2104\))
Subject: Re: reverse proxy wishlist
From: Jim Jagielski <jim@jaguNET.com>
In-Reply-To: <CACsi250wpsmUsC5kEWfJOAoYKHG28m2N6NrizHXsHFjU7_nVYQ@mail.gmail.com>
Date: Fri, 4 Dec 2015 08:32:58 -0500
Content-Transfer-Encoding: quoted-printable
Message-Id: <23420A92-4983-40B9-86FD-7B0681983601@jaguNET.com>
References: <288293CD-6D82-42E0-BFC9-9DC25F969ED6@jaguNET.com> <CACsi250e5arsm+EzN1KDJMOD-vAmTyM8M0utTuEfedUGSUfXJw@mail.gmail.com> <77E6470A-4FAD-4DAD-BE9E-E11F54388E2C@jaguNET.com> <CACsi250wpsmUsC5kEWfJOAoYKHG28m2N6NrizHXsHFjU7_nVYQ@mail.gmail.com>
To: dev@httpd.apache.org
X-Mailer: Apple Mail (2.2104)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=comcast.net;
	s=q20140121; t=1449235979;
	bh=N8b0+LDrJOTMd0Y4QFutzVbl70duEQRTgTF9Ly6IcDs=;
	h=Received:Received:Content-Type:Mime-Version:Subject:From:Date:
	 Message-Id:To;
	b=OKCSNRfP50cbx2Vhs77o2VvOc62GoCMoo4jWtXpMyrEvzHgNH6XW6CZbkWC/s8hOR
	 HmGp8mPSfRPeJAG95Z92+STeA3yLpMsJM+5sCA82O7y/mo3esvo838PQ3vgQq4VJG5
	 EMDvDZEdVu6nMxHLPMQ3dw03Yxoeo3gQxXAEZGQCjP2rAfXeoa5X8MTFCQys/KjpQQ
	 +xhNXVjL6EX1RUTC+7Wmp7k0L52YbGgMZIrp2L22V6OIjGb/ak15H8/pKQA4U4U+tP
	 xIiH0Zd+ioNX5+crCS32EqDETzNbm2Rn/NVHFtMcHQ6QZg2cLyQWyCEOGiUWuA3xwx
	 NynPhp8+J80mA==

I thought the idea of providers and submodules were so
that, for example, if someone only used byrequests, for
example, they only needed to build and load that specific
submodule and nothing else... Not seeing what issue exactly
you're trying to address.

> On Dec 3, 2015, at 6:25 PM, William A Rowe Jr <wrowe@rowe-clan.net> =
wrote:
>=20
> On Thu, Dec 3, 2015 at 3:40 PM, Jim Jagielski <jim@jagunet.com> wrote:
>=20
> > On Dec 3, 2015, at 11:09 AM, William A Rowe Jr <wrowe@rowe-clan.net> =
wrote:
> >
> > My personal wish list is that we eliminate module bloat by =
coalescing
> > alternative "standard" implementations into a single module again in
> > 2.next, and not just limited to lbmethod, but also the core socache
> > and slotmem providers. Most stock/core implementations shouldn't
> > change if a user wants to plug in 'yet another' option, but there is =
really
> > no excuse for us to map so many ldobjects and text pages into the
> > memory map of a given process, when the actual program text page
> > of each is a few hundred opcodes, max.
> >
>=20
> Not following you there... what do you mean? You mention the
> lbmethods; do you mean instead of having each method be its
> own module, making them all one?
>=20
> Not specific to lbmethods but yes, one mod_lbmethod_core.so provider
> of the basic set of 3-4 methods that right now eat up a lot of 64kb =
process
> page mappings for no particular benefit.  The builder could even =
decide these
> are compiled-in to the base httpd.  We don't dismiss the loadable =
approach,
> we simply decide this subset is effectively baked, and then use the =
loadable
> lbmethod to extend yet another experimental/dynamic/evolving method, =
from
> the ASF or third parties.
> =20
>=20


From dev-return-84858-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Fri Dec  4 13:37:48 2015
Return-Path: <dev-return-84858-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 6B489181A8
	for <apmail-httpd-dev-archive@www.apache.org>; Fri,  4 Dec 2015 13:37:48 +0000 (UTC)
Received: (qmail 45447 invoked by uid 500); 4 Dec 2015 13:37:48 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 45376 invoked by uid 500); 4 Dec 2015 13:37:47 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 45366 invoked by uid 99); 4 Dec 2015 13:37:47 -0000
Received: from Unknown (HELO spamd1-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 04 Dec 2015 13:37:47 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd1-us-west.apache.org (ASF Mail Server at spamd1-us-west.apache.org) with ESMTP id C1AA1C81E6
	for <dev@httpd.apache.org>; Fri,  4 Dec 2015 13:37:46 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd1-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 0.001
X-Spam-Level:
X-Spam-Status: No, score=0.001 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, URIBL_BLOCKED=0.001]
	autolearn=disabled
Authentication-Results: spamd1-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=comcast.net
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd1-us-west.apache.org [10.40.0.7]) (amavisd-new, port 10024)
	with ESMTP id IgFtf1oacvMa for <dev@httpd.apache.org>;
	Fri,  4 Dec 2015 13:37:33 +0000 (UTC)
Received: from resqmta-ch2-01v.sys.comcast.net (resqmta-ch2-01v.sys.comcast.net [69.252.207.33])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id C2E432059A
	for <dev@httpd.apache.org>; Fri,  4 Dec 2015 13:37:32 +0000 (UTC)
Received: from resomta-ch2-13v.sys.comcast.net ([69.252.207.109])
	by resqmta-ch2-01v.sys.comcast.net with comcast
	id pRbl1r0012N9P4d01RdRxP; Fri, 04 Dec 2015 13:37:25 +0000
Received: from [192.168.199.10] ([69.251.84.114])
	by resomta-ch2-13v.sys.comcast.net with comcast
	id pRdQ1r00H2U0RYt01RdR6W; Fri, 04 Dec 2015 13:37:25 +0000
Content-Type: text/plain; charset=us-ascii
Mime-Version: 1.0 (Mac OS X Mail 8.2 \(2104\))
Subject: Re: reverse proxy wishlist
From: Jim Jagielski <jim@jaguNET.com>
In-Reply-To: <042e01d12e27$70f9db00$52ed9100$@qqmail.nl>
Date: Fri, 4 Dec 2015 08:37:24 -0500
Content-Transfer-Encoding: quoted-printable
Message-Id: <0A22CCE0-95AE-42EA-8994-66CB2559B9CB@jaguNET.com>
References: <288293CD-6D82-42E0-BFC9-9DC25F969ED6@jaguNET.com> <CACsi250e5arsm+EzN1KDJMOD-vAmTyM8M0utTuEfedUGSUfXJw@mail.gmail.com> <289205B6-21EA-4277-9E05-3EF0DA6566DA@jaguNET.com> <042e01d12e27$70f9db00$52ed9100$@qqmail.nl>
To: dev@httpd.apache.org
X-Mailer: Apple Mail (2.2104)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=comcast.net;
	s=q20140121; t=1449236245;
	bh=1lA0V8QiTtnfnd90ABJn8MVp47xIdSqNd8eXt2jvqU4=;
	h=Received:Received:Content-Type:Mime-Version:Subject:From:Date:
	 Message-Id:To;
	b=saP6iHMzRgGbnAHw82G0iwHZQoAp2tphzZB6fG3YSQ6wpj7UBh9VMTOIYIwlYEMif
	 Begz4sV5ipzxAlW10uaFT3Id9L0i4pgrhaJ85+MzelAYrWm8CThR1XPSuXdmvlYmAP
	 8fPm+/krAwsBmDqmAMtOimADTxemYcARFpMJOKZnoWUOdsclnfBSluaYdri/+K8APy
	 SeKJuJyxSdNmoasFiuIngkJyQnqstlKeEbrIYC9W6PseTSRSYsKcgmLMUL5o2aaqRd
	 pZr73siZwpN7Xjw33Ld9U6PquE8315YNHjjv5pje0alaBrDdhqsd3zDkPLCOTXJIop
	 X1t6f3k/pUFOA==

afaik, we aren't tied to nghttp2, in that if there
is a more viable solution and it's easier to implement/use
that than, without a whole lot of work, it's something to
consider. Back then, and for now, nghttp2 made the whole
thing possible. If serf gets to the point where it
could be used, then cool.

The issue has always been that except for a handful of
people, *how* serf works has always been a mystery. It's
documentation is awful and even though its used in svn,
there is still limited knowledge externally on how it
can, and should, be used.

> On Dec 3, 2015, at 7:05 PM, Bert Huijben <bert@qqmail.nl> wrote:
>=20
>=20
>=20
>> -----Original Message-----
>> From: Jim Jagielski [mailto:jim@jaguNET.com]
>> Sent: donderdag 3 december 2015 22:20
>> To: dev@httpd.apache.org
>> Subject: Re: reverse proxy wishlist
>>=20
>>=20
>>> On Dec 3, 2015, at 11:09 AM, William A Rowe Jr <wrowe@rowe-clan.net>
>> wrote:
>>>=20
>>> On Thu, Dec 3, 2015 at 8:59 AM, Jim Jagielski <jim@jagunet.com> =
wrote:
>>>=20
>>> What would *you* like to see as new features or enhancements
>>> w/ mod_proxy, esp reverse proxy.
>>>=20
>>> HTTP/2 support, of course :)  It will be interesting to be able to
> leverage
>>> and compare a mod_proxy_serf vs a mod_proxy_http2 (nghttp2-based)
>>> engine, as mentioned in another thread - multiple implementations
>>> are always good for ferreting out protocol anomalies.
>>>=20
>>=20
>> It's kind of funny... the "need" for http/2 between proxy and
>> origin seems pretty non-existant. There is a blog post by Cloudflare
>> somewhere about how they don't see servers talking http/2 to the
>> backend as anywhere near a driver, since all the things that make
>> it "important" (koff koff!) between browser and server don't really
>> apply.
>=20
> After having implemented fcgi (server support) and http/2 (server and
> client) in Apache Serf I was thinking that it would be nice if H2 =
would
> replace the existing server side protocols.
>=20
> http/1.1 requires chunking or explicit content-length, while http/2 =
and fcgi
> don't have that requirement.
>=20
>=20
>=20
> The reason I implemented the server side of those protocols in Apache =
Serf
> was exactly to allow writing such origins with Serf...
>=20
> Adding such a backend server process is one of the (many) possible
> directions Subversion might take in the future.
>=20
> 	Bert


From dev-return-84859-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Fri Dec  4 15:23:39 2015
Return-Path: <dev-return-84859-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id D19BE18580
	for <apmail-httpd-dev-archive@www.apache.org>; Fri,  4 Dec 2015 15:23:39 +0000 (UTC)
Received: (qmail 97040 invoked by uid 500); 4 Dec 2015 15:23:39 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 96955 invoked by uid 500); 4 Dec 2015 15:23:39 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 96945 invoked by uid 99); 4 Dec 2015 15:23:39 -0000
Received: from Unknown (HELO spamd3-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 04 Dec 2015 15:23:39 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd3-us-west.apache.org (ASF Mail Server at spamd3-us-west.apache.org) with ESMTP id B8809180998
	for <dev@httpd.apache.org>; Fri,  4 Dec 2015 15:23:38 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd3-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.654
X-Spam-Level:
X-Spam-Status: No, score=-0.654 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RP_MATCHES_RCVD=-0.554, SPF_PASS=-0.001, URIBL_BLOCKED=0.001]
	autolearn=disabled
Authentication-Results: spamd3-us-west.apache.org (amavisd-new);
	dkim=pass (1024-bit key) header.d=greenbytes.de
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd3-us-west.apache.org [10.40.0.10]) (amavisd-new, port 10024)
	with ESMTP id CG0Ac-TUZf6L for <dev@httpd.apache.org>;
	Fri,  4 Dec 2015 15:23:28 +0000 (UTC)
Received: from mail.greenbytes.de (mail.greenbytes.de [217.91.35.233])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id F3DE242BB8
	for <dev@httpd.apache.org>; Fri,  4 Dec 2015 15:23:27 +0000 (UTC)
Received: from [192.168.178.41] (unknown [93.211.117.216])
	(using TLSv1 with cipher ECDHE-RSA-AES256-SHA (256/256 bits))
	(Client did not present a certificate)
	by mail.greenbytes.de (Postfix) with ESMTPSA id 62CA615A0455
	for <dev@httpd.apache.org>; Fri,  4 Dec 2015 16:23:20 +0100 (CET)
DKIM-Signature: v=1; a=rsa-sha256; c=simple/simple; d=greenbytes.de; s=mail;
	t=1449242600; bh=QcBIuROwKIw3/i6buuWUGpeDYjpnlp0CZEeqG0oocLw=;
	h=Subject:From:In-Reply-To:Date:References:To:From;
	b=Bw0590LvYgR0a31fBqRPWTCMeakOj55FVhWuQr7Mb3tF/RGSCrNMnRfivzlY/s3zm
	 Lp7c8WZ0CWNPJSXrsoYN6pwsJA1goR6psKHgkFGz8mCWAPUxG6rzN30dgK7FZpOOfu
	 m1FaCmxEX/6Wsr0BJl5VpzRkq01ZPyzLwxi2Yq00=
Content-Type: text/plain; charset=us-ascii
Mime-Version: 1.0 (Mac OS X Mail 9.1 \(3096.5\))
Subject: Re: No H2 Window updates!
From: Stefan Eissing <stefan.eissing@greenbytes.de>
In-Reply-To: <045e01d12e79$493fe620$dbbfb260$@qqmail.nl>
Date: Fri, 4 Dec 2015 16:23:19 +0100
Content-Transfer-Encoding: quoted-printable
Message-Id: <039D4360-8E2F-455D-8CC2-8405FC7FC272@greenbytes.de>
References: <56599792.3060402@greenbytes.de> <03a401d129dd$fafdbfe0$f0f93fa0$@qqmail.nl> <03aa01d129e1$2d49d990$87dd8cb0$@qqmail.nl> <040101d12a23$ced65530$6c82ff90$@qqmail.nl> <40F35186-1FFF-48EF-BB67-DAE432526244@greenbytes.de> <46014DD1-B5DA-4920-B0E2-C43B43EB4816@jaguNET.com> <mnjp5b1qdm4sgu56t413p2bmblsqjpd9og@4ax.com> <78BF1B01-16EE-4071-803B-A174432C9503@jaguNET.com> <b47r5b5n1mf2oeeb33tidnsdvvr5dckjvf@4ax.com> <CACsi253Egm-K71wTd5Ff3gD6AFdhAgm1pHXafE5Kobzb4WejBQ@mail.gmail.com> <bqdr5blheuoccudj4sc7jql6e4dn8furd9@4ax.com> <1D08ECCD-A26B-4D3D-8F12-BE97018059B7@greenbytes.de> <043901d12e34$34d311c0$9e793540$@qqmail.nl> <10770C7F-5C8D-42EB-9E76-DC91160FDA89@greenbytes.de> <045e01d12e79$493fe620$dbbfb260$@qqmail.nl>
To: dev@httpd.apache.org
X-Mailer: Apple Mail (2.3096.5)

If you find the time, the lastest v1.0.10 mod_http2 in 2.4.x sets the =
connection window to max which addresses for me the window starvation =
issues I was able to reproduce (and put into my test suite). I hope this =
works for you as well, otherwise I'd need more detailed data on how to =
reproduce the hanger.

//Stefan

> Am 04.12.2015 um 10:50 schrieb Bert Huijben <bert@qqmail.nl>:
>=20
>> -----Original Message-----
>> From: Stefan Eissing [mailto:stefan.eissing@greenbytes.de]
>> Sent: vrijdag 4 december 2015 10:18
>> To: dev@httpd.apache.org
>> Subject: Re: No H2 Window updates!
>>=20
>> That is unfortunate. I added a test case which reproduced window
>> exhaustion before I fixed it. What sort of requests do still miss =
window
>> updates? content-length? response codes?
>=20
> I don't think we send content-length headers... (see older problem). I =
fixed
> Subversion to always send Content-Type though.
>=20
> I'm going to add some more tracing to get the details again, but from =
what I
> remember is that I had requests with 113 and 128 bytes +- over and =
over.
>=20
> [The tool experiencing this problem is a tool that tries to replicate =
some
> behavior we can't express in Subversion yet. To implement this it asks =
the
> server for similar things over and over. If we decide that we go this =
way we
> would probably send one advanced request and get one response from the
> server... But currently it is a nice tool to test the network IO =
limits :-)]
>=20
> These requests are always 1 HEADERS (/endofheaders) + 1 DATA (/eos) =
and the
> response is not much either (Certainly less than 1 Kbyte, so probably =
just
> HEADERS+1 DATA as well)
>=20
>=20
> ----------------------
> Ok, added some logging back.
>=20
> I still don't see a lot of window updates, but I do see some.
>=20
> After my connection windows is slightly below 32767... I receive a =
single
> connection window update to bring it back to exactly 32767. In all =
cases in
> this log this update is < 100 bytes. (1 <=3D update < 256).
>=20
> But then I don't receive further window updates until my connection =
window
> is almost depleted... And then I get another 255 bytes or so. Not =
enough to
> get through the test.
>=20
> The log I just used is on:
> https://lpt1.nl/f/2015/201512-NoWindow.txt=20
> (Search for 'DBG: Connection window update' to find the updates =
between the
> allocations)
>=20
> 	Bert
>=20


From dev-return-84860-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Fri Dec  4 15:25:43 2015
Return-Path: <dev-return-84860-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 6B01B1858F
	for <apmail-httpd-dev-archive@www.apache.org>; Fri,  4 Dec 2015 15:25:43 +0000 (UTC)
Received: (qmail 1387 invoked by uid 500); 4 Dec 2015 15:25:43 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 1323 invoked by uid 500); 4 Dec 2015 15:25:42 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 1313 invoked by uid 99); 4 Dec 2015 15:25:42 -0000
Received: from Unknown (HELO spamd1-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 04 Dec 2015 15:25:42 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd1-us-west.apache.org (ASF Mail Server at spamd1-us-west.apache.org) with ESMTP id 7636BC14F2
	for <dev@httpd.apache.org>; Fri,  4 Dec 2015 15:25:42 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd1-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 3.001
X-Spam-Level: ***
X-Spam-Status: No, score=3.001 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, HTML_MESSAGE=3,
	URIBL_BLOCKED=0.001] autolearn=disabled
Authentication-Results: spamd1-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=rowe-clan-net.20150623.gappssmtp.com
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd1-us-west.apache.org [10.40.0.7]) (amavisd-new, port 10024)
	with ESMTP id n1NWW7--OmRi for <dev@httpd.apache.org>;
	Fri,  4 Dec 2015 15:25:29 +0000 (UTC)
Received: from mail-ig0-f173.google.com (mail-ig0-f173.google.com [209.85.213.173])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id 88A3842AD4
	for <dev@httpd.apache.org>; Fri,  4 Dec 2015 15:25:29 +0000 (UTC)
Received: by igcmv3 with SMTP id mv3so37916855igc.0
        for <dev@httpd.apache.org>; Fri, 04 Dec 2015 07:25:29 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=rowe-clan-net.20150623.gappssmtp.com; s=20150623;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        bh=Ai7YC5ZK5Ba/SLcBhfkI0TBpnkbalaCmBwIhgEX0jUw=;
        b=OI8sSrBo1LB7Q9Xadp/T8i5IpkWTby8n+sGTjjhJ6BMqZyH7Spzgqd1rgfbwAan0IK
         Wimfg4BcmPE9ByWIwkRsKZUkCgaKz6YQB5BEW+G9YpzEGv8PW390hfiId9OQRp/j17db
         oClOqsNwTeRhRbHI0eGXdFHipLoKEjjcmNrwzDQGchDF2BKZaExedi8mF13a0M2rxUXp
         UpCHIjwMuwvWm9DD23MN1kHB6TrJqrqBGTQw6X2RkkalfNQMJeD/s30wC0odEUnjGOMM
         PjQQih1Zdnrl+MqzMkKN0iVcrOjXs7qn8iH/HH5p5xQMPuAwclvhOLOmnWtuYrb8R4G4
         A61Q==
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=1e100.net; s=20130820;
        h=x-gm-message-state:mime-version:in-reply-to:references:date
         :message-id:subject:from:to:content-type;
        bh=Ai7YC5ZK5Ba/SLcBhfkI0TBpnkbalaCmBwIhgEX0jUw=;
        b=I4z6BljKh6SwuVE/4UtK7O4DVl4ORZSBgf7/zwMctlZ73iWZyk17PG+FN5ao+umcli
         007rYdG8sQC0xjMYb6iAkB4mp4Fv/q0ouw6VDU34LRrzKT4waRi1EEjCFUYbj+z0oDti
         eOgkrOHmblUSE/eI3EEoryybhCgO+fuw19WrhewAWekhHHBPH7b3/DbBIQX6vWEEKL7p
         4hYSjFjxVOSXwFciT7CqXIQq50KsPpJSGeRTEeEzWB9Tf99EoO8d+2nRbrFCvmzMDo02
         oHdghbsu4Y8X44hNp+1sdNkejJ4wv7397xJzaufP/HRkHGYmZ9ntGgMmtB9KYt88T42b
         Gh+w==
X-Gm-Message-State: ALoCoQkIKY4TaDdHqkXgWQf8rcFBA2zpgs2pdf//QyBpxD2vAPLTTs1B6vr+VHel53p6b5E80v2Bc+jHgQLOCO6zI72iiwiE3vrdttWSlkDq2z9eW1HyK40=
MIME-Version: 1.0
X-Received: by 10.50.142.7 with SMTP id rs7mr4755765igb.35.1449242729103; Fri,
 04 Dec 2015 07:25:29 -0800 (PST)
Received: by 10.107.62.136 with HTTP; Fri, 4 Dec 2015 07:25:28 -0800 (PST)
Received: by 10.107.62.136 with HTTP; Fri, 4 Dec 2015 07:25:28 -0800 (PST)
In-Reply-To: <23420A92-4983-40B9-86FD-7B0681983601@jaguNET.com>
References: <288293CD-6D82-42E0-BFC9-9DC25F969ED6@jaguNET.com>
	<CACsi250e5arsm+EzN1KDJMOD-vAmTyM8M0utTuEfedUGSUfXJw@mail.gmail.com>
	<77E6470A-4FAD-4DAD-BE9E-E11F54388E2C@jaguNET.com>
	<CACsi250wpsmUsC5kEWfJOAoYKHG28m2N6NrizHXsHFjU7_nVYQ@mail.gmail.com>
	<23420A92-4983-40B9-86FD-7B0681983601@jaguNET.com>
Date: Fri, 4 Dec 2015 09:25:28 -0600
Message-ID: <CACsi250w43S9-GLmPWeFAUS3wRte81tc=g3f5cWxLLf+Q7Mx5g@mail.gmail.com>
Subject: Re: reverse proxy wishlist
From: William A Rowe Jr <wrowe@rowe-clan.net>
To: httpd <dev@httpd.apache.org>
Content-Type: multipart/alternative; boundary=001a11c2eb5a0fea190526141e56

--001a11c2eb5a0fea190526141e56
Content-Type: text/plain; charset=UTF-8

My observation was that that the mapped pages for 2-6 fundamental socache,
lbmethod or slotmem providers are the same as for a single module due to
page alignment - load any two and you are already wasting kernel resources
and memory.

I agree that any user agent or content facing modules should remain
distinct - only load those you use and trust.  These core feature sets,
when used, only face the conf file or in the case of lbmethod, the admin
console.  So they should be safe to load in parallel, when leveraged for a
given module.  They should even be safe to compile static, if the user
likes.
On Dec 4, 2015 07:33, "Jim Jagielski" <jim@jagunet.com> wrote:

> I thought the idea of providers and submodules were so
> that, for example, if someone only used byrequests, for
> example, they only needed to build and load that specific
> submodule and nothing else... Not seeing what issue exactly
> you're trying to address.
>
> > On Dec 3, 2015, at 6:25 PM, William A Rowe Jr <wrowe@rowe-clan.net>
> wrote:
> >
> > On Thu, Dec 3, 2015 at 3:40 PM, Jim Jagielski <jim@jagunet.com> wrote:
> >
> > > On Dec 3, 2015, at 11:09 AM, William A Rowe Jr <wrowe@rowe-clan.net>
> wrote:
> > >
> > > My personal wish list is that we eliminate module bloat by coalescing
> > > alternative "standard" implementations into a single module again in
> > > 2.next, and not just limited to lbmethod, but also the core socache
> > > and slotmem providers. Most stock/core implementations shouldn't
> > > change if a user wants to plug in 'yet another' option, but there is
> really
> > > no excuse for us to map so many ldobjects and text pages into the
> > > memory map of a given process, when the actual program text page
> > > of each is a few hundred opcodes, max.
> > >
> >
> > Not following you there... what do you mean? You mention the
> > lbmethods; do you mean instead of having each method be its
> > own module, making them all one?
> >
> > Not specific to lbmethods but yes, one mod_lbmethod_core.so provider
> > of the basic set of 3-4 methods that right now eat up a lot of 64kb
> process
> > page mappings for no particular benefit.  The builder could even decide
> these
> > are compiled-in to the base httpd.  We don't dismiss the loadable
> approach,
> > we simply decide this subset is effectively baked, and then use the
> loadable
> > lbmethod to extend yet another experimental/dynamic/evolving method, from
> > the ASF or third parties.
> >
> >
>
>

--001a11c2eb5a0fea190526141e56
Content-Type: text/html; charset=UTF-8
Content-Transfer-Encoding: quoted-printable

<p dir=3D"ltr">My observation was that that the mapped pages for 2-6 fundam=
ental socache, lbmethod or slotmem providers are the same as for a single m=
odule due to page alignment - load any two and you are already wasting kern=
el resources and memory.</p>
<p dir=3D"ltr">I agree that any user agent or content facing modules should=
 remain distinct - only load those you use and trust.=C2=A0 These core feat=
ure sets, when used, only face the conf file or in the case of lbmethod, th=
e admin console.=C2=A0 So they should be safe to load in parallel, when lev=
eraged for a given module.=C2=A0 They should even be safe to compile static=
, if the user likes.<br>
</p>
<div class=3D"gmail_quote">On Dec 4, 2015 07:33, &quot;Jim Jagielski&quot; =
&lt;<a href=3D"mailto:jim@jagunet.com">jim@jagunet.com</a>&gt; wrote:<br ty=
pe=3D"attribution"><blockquote class=3D"gmail_quote" style=3D"margin:0 0 0 =
.8ex;border-left:1px #ccc solid;padding-left:1ex">I thought the idea of pro=
viders and submodules were so<br>
that, for example, if someone only used byrequests, for<br>
example, they only needed to build and load that specific<br>
submodule and nothing else... Not seeing what issue exactly<br>
you&#39;re trying to address.<br>
<br>
&gt; On Dec 3, 2015, at 6:25 PM, William A Rowe Jr &lt;<a href=3D"mailto:wr=
owe@rowe-clan.net">wrowe@rowe-clan.net</a>&gt; wrote:<br>
&gt;<br>
&gt; On Thu, Dec 3, 2015 at 3:40 PM, Jim Jagielski &lt;<a href=3D"mailto:ji=
m@jagunet.com">jim@jagunet.com</a>&gt; wrote:<br>
&gt;<br>
&gt; &gt; On Dec 3, 2015, at 11:09 AM, William A Rowe Jr &lt;<a href=3D"mai=
lto:wrowe@rowe-clan.net">wrowe@rowe-clan.net</a>&gt; wrote:<br>
&gt; &gt;<br>
&gt; &gt; My personal wish list is that we eliminate module bloat by coales=
cing<br>
&gt; &gt; alternative &quot;standard&quot; implementations into a single mo=
dule again in<br>
&gt; &gt; 2.next, and not just limited to lbmethod, but also the core socac=
he<br>
&gt; &gt; and slotmem providers. Most stock/core implementations shouldn&#3=
9;t<br>
&gt; &gt; change if a user wants to plug in &#39;yet another&#39; option, b=
ut there is really<br>
&gt; &gt; no excuse for us to map so many ldobjects and text pages into the=
<br>
&gt; &gt; memory map of a given process, when the actual program text page<=
br>
&gt; &gt; of each is a few hundred opcodes, max.<br>
&gt; &gt;<br>
&gt;<br>
&gt; Not following you there... what do you mean? You mention the<br>
&gt; lbmethods; do you mean instead of having each method be its<br>
&gt; own module, making them all one?<br>
&gt;<br>
&gt; Not specific to lbmethods but yes, one mod_lbmethod_core.so provider<b=
r>
&gt; of the basic set of 3-4 methods that right now eat up a lot of 64kb pr=
ocess<br>
&gt; page mappings for no particular benefit.=C2=A0 The builder could even =
decide these<br>
&gt; are compiled-in to the base httpd.=C2=A0 We don&#39;t dismiss the load=
able approach,<br>
&gt; we simply decide this subset is effectively baked, and then use the lo=
adable<br>
&gt; lbmethod to extend yet another experimental/dynamic/evolving method, f=
rom<br>
&gt; the ASF or third parties.<br>
&gt;<br>
&gt;<br>
<br>
</blockquote></div>

--001a11c2eb5a0fea190526141e56--

From dev-return-84861-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Fri Dec  4 16:17:38 2015
Return-Path: <dev-return-84861-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 8A40E187C8
	for <apmail-httpd-dev-archive@www.apache.org>; Fri,  4 Dec 2015 16:17:38 +0000 (UTC)
Received: (qmail 43283 invoked by uid 500); 4 Dec 2015 16:17:38 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 43215 invoked by uid 500); 4 Dec 2015 16:17:37 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 43205 invoked by uid 99); 4 Dec 2015 16:17:37 -0000
Received: from Unknown (HELO spamd2-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 04 Dec 2015 16:17:37 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd2-us-west.apache.org (ASF Mail Server at spamd2-us-west.apache.org) with ESMTP id 8657A1A5F75
	for <dev@httpd.apache.org>; Fri,  4 Dec 2015 16:17:37 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd2-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 0.364
X-Spam-Level:
X-Spam-Status: No, score=0.364 tagged_above=-999 required=6.31
	tests=[RDNS_DYNAMIC=0.363, URIBL_BLOCKED=0.001] autolearn=disabled
Received: from mx1-us-west.apache.org ([10.40.0.8])
	by localhost (spamd2-us-west.apache.org [10.40.0.9]) (amavisd-new, port 10024)
	with ESMTP id 9LzS9J4MUGg5 for <dev@httpd.apache.org>;
	Fri,  4 Dec 2015 16:17:27 +0000 (UTC)
Received: from gungnir.webthing.com (209-20-83-52.slicehost.net [209.20.83.52])
	by mx1-us-west.apache.org (ASF Mail Server at mx1-us-west.apache.org) with ESMTP id E126420221
	for <dev@httpd.apache.org>; Fri,  4 Dec 2015 16:17:26 +0000 (UTC)
Received: from bifrost.webthing.com (cpc36-newt30-2-0-cust898.19-3.cable.virginm.net [82.32.195.131])
	by gungnir.webthing.com (Postfix) with ESMTPSA id 22AB5E8C51
	for <dev@httpd.apache.org>; Fri,  4 Dec 2015 16:17:25 +0000 (UTC)
Date: Fri, 4 Dec 2015 16:17:22 +0000
From: Nick Kew <nick@webthing.com>
To: dev@httpd.apache.org
Subject: Re: reverse proxy wishlist
Message-ID: <20151204161722.3b753797@bifrost.webthing.com>
In-Reply-To: <CACsi2538wJ=w99Emp86rfC-pJC6GF4J6wUPsqQi0vT8prnd4DA@mail.gmail.com>
References: <288293CD-6D82-42E0-BFC9-9DC25F969ED6@jaguNET.com>
	<CACsi250e5arsm+EzN1KDJMOD-vAmTyM8M0utTuEfedUGSUfXJw@mail.gmail.com>
	<20151203163227.64a94c9d@bifrost.webthing.com>
	<CACsi2538wJ=w99Emp86rfC-pJC6GF4J6wUPsqQi0vT8prnd4DA@mail.gmail.com>
X-Mailer: Claws Mail 3.11.1 (GTK+ 2.24.25; x86_64-pc-linux-gnu)
MIME-Version: 1.0
Content-Type: text/plain; charset=US-ASCII
Content-Transfer-Encoding: 7bit

On Thu, 3 Dec 2015 12:23:24 -0600
William A Rowe Jr <wrowe@rowe-clan.net> wrote:

> On Thu, Dec 3, 2015 at 10:32 AM, Nick Kew <niq@apache.org> wrote:

> Yup, and I'm not proposing to eliminate the mechanism, I'm proposing
> that the existing 'core' subset be codified in fewer, still
> lightweight modules.

Fairy nuff.  At this level of detail I can't really tell
if you're proposing anything that would concern me.

> I'm looking, none of these seem like huge hacks, wondering
> which of them trigger your concern?

Well, your talk of refactoring config led me to wonder
whether you were proposing another tilt at the whole directory
walk stuff.  While that may have merit, past experience
tells us it's not going to be easy!

-- 
Nick Kew

From dev-return-84862-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Fri Dec  4 16:41:00 2015
Return-Path: <dev-return-84862-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id E3F79188A9
	for <apmail-httpd-dev-archive@www.apache.org>; Fri,  4 Dec 2015 16:41:00 +0000 (UTC)
Received: (qmail 95757 invoked by uid 500); 4 Dec 2015 16:40:51 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 95674 invoked by uid 500); 4 Dec 2015 16:40:51 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 95653 invoked by uid 99); 4 Dec 2015 16:40:51 -0000
Received: from Unknown (HELO spamd4-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 04 Dec 2015 16:40:51 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd4-us-west.apache.org (ASF Mail Server at spamd4-us-west.apache.org) with ESMTP id C23F5C103F
	for <dev@httpd.apache.org>; Fri,  4 Dec 2015 16:40:50 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd4-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 2.999
X-Spam-Level: **
X-Spam-Status: No, score=2.999 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, HTML_MESSAGE=3,
	RCVD_IN_MSPIKE_H2=-0.001, SPF_PASS=-0.001, URIBL_BLOCKED=0.001]
	autolearn=disabled
Authentication-Results: spamd4-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=rowe-clan-net.20150623.gappssmtp.com
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd4-us-west.apache.org [10.40.0.11]) (amavisd-new, port 10024)
	with ESMTP id Z__jMVSoj_ZH for <dev@httpd.apache.org>;
	Fri,  4 Dec 2015 16:40:44 +0000 (UTC)
Received: from mail-ig0-f171.google.com (mail-ig0-f171.google.com [209.85.213.171])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id C3EF620273
	for <dev@httpd.apache.org>; Fri,  4 Dec 2015 16:40:43 +0000 (UTC)
Received: by igbxm8 with SMTP id xm8so40748320igb.1
        for <dev@httpd.apache.org>; Fri, 04 Dec 2015 08:40:42 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=rowe-clan-net.20150623.gappssmtp.com; s=20150623;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        bh=JuKKYTkWCOICO6npDhHi2y3Ke1SpIj7+5EzewmYXzNM=;
        b=b04ET4XuvBqmHGBWF5vuOI7jBzTa47U0v9/W4zMbga5zzdaB5CkdDw2Dz+b26gCpRe
         jputz0FN80DzFjw4+hAZ7SZ2TwsmtQf4bvGzNl/8EA1LNAGzo4tgx4CskC7GJB1aT3Jw
         xbQhAytERPL2bjhiOQmjsqQWBjaidjVd2DMcRXXTYNAHdKdGhqVAoA7lzS3W5mBoH+l2
         zkyEqv95nd1HK+ZkZ6Tda7S6+d2ABz7iT8CXCAWXcmXdIjtDRqpkCoC/DIdPCtt08Re2
         YkuKgo5eJoGLaIdpah6fGqnXWi2sS6fn9/2CbIVCHRwfsG38ftZlFVcWpMpHu73jui8F
         rp5g==
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=1e100.net; s=20130820;
        h=x-gm-message-state:mime-version:in-reply-to:references:date
         :message-id:subject:from:to:content-type;
        bh=JuKKYTkWCOICO6npDhHi2y3Ke1SpIj7+5EzewmYXzNM=;
        b=CNednIX28SRC+gdQz4qZ99x/ddUCANhY+E7iZdtgGgZu12gWkpRBh2ljl73ec/8yfK
         j2Chsm8tYwtElqysrseN35otcZ9ZY74f6XaOWejyQ33qJkmNbgwSyTO4Sxy0Cpd/Flvl
         bGAFr4Bj9Qt+DSRy2vpE22z2/M1s+Wv9sXdkjpud8uw6yIHsxDujc7Udx2ZsJw5JDuh1
         DWtg+1bk9ZAn4wVEtqgwIXlNkx09cRWyAFMV01C/H3MW+XKNniDQBoGFUh8fjf/8kJSZ
         wHFyuY8XzFAoOt6+E6+iyo1HZ21/p5r2N/dx5jzrBoF7/hft0r+aiNwkW5pUXgAjR7bi
         1zkw==
X-Gm-Message-State: ALoCoQnHdt4DLteqIK+BO5jmE7N+MDzO7+fOeil46OkmZP7aSbmQcQm7a/+lsDOfE2L+LJl9PMSPMK3FvXjrXYDoQeC8tXsJztGx1FjJlFxyTA/JtnWoCPc=
MIME-Version: 1.0
X-Received: by 10.50.142.7 with SMTP id rs7mr5113645igb.35.1449247242701; Fri,
 04 Dec 2015 08:40:42 -0800 (PST)
Received: by 10.107.62.136 with HTTP; Fri, 4 Dec 2015 08:40:42 -0800 (PST)
In-Reply-To: <20151204161722.3b753797@bifrost.webthing.com>
References: <288293CD-6D82-42E0-BFC9-9DC25F969ED6@jaguNET.com>
	<CACsi250e5arsm+EzN1KDJMOD-vAmTyM8M0utTuEfedUGSUfXJw@mail.gmail.com>
	<20151203163227.64a94c9d@bifrost.webthing.com>
	<CACsi2538wJ=w99Emp86rfC-pJC6GF4J6wUPsqQi0vT8prnd4DA@mail.gmail.com>
	<20151204161722.3b753797@bifrost.webthing.com>
Date: Fri, 4 Dec 2015 10:40:42 -0600
Message-ID: <CACsi253zTyJ8KWDy3erhAvDcyS8cK-LGL=q9W2gB8nDRMcrBRQ@mail.gmail.com>
Subject: Re: reverse proxy wishlist
From: William A Rowe Jr <wrowe@rowe-clan.net>
To: httpd <dev@httpd.apache.org>
Content-Type: multipart/alternative; boundary=001a11c2eb5a17eb740526152bb9

--001a11c2eb5a17eb740526152bb9
Content-Type: text/plain; charset=UTF-8

On Fri, Dec 4, 2015 at 10:17 AM, Nick Kew <nick@webthing.com> wrote:

>
> > I'm looking, none of these seem like huge hacks, wondering
> > which of them trigger your concern?
>
> Well, your talk of refactoring config led me to wonder
> whether you were proposing another tilt at the whole directory
> walk stuff.  While that may have merit, past experience
> tells us it's not going to be easy!
>

If I never have to refactor that code again, it will still be too soon :-/

More likely that someone enthusiastic could take the base/short
unique <Directory> blocks and pre-merge those to global/vhost
scope, as the shortcut to a more specific scope as the first-match
hit.  Deeper pre-merge optimizations would be rough and all of it
presupposes there are no request-specific eval blocks and no
directory permitting an .htaccess could be optimized that way.

So... no... much like the non-iterating fnmatch implementation, I'd
prefer to let others wrap their heads around that puzzle and come
up with something new and more efficient.  All I was thinking of
doing was extending the core concept of 'compiled in modules'
to allow a module-of-modules, and build unique create/merge
call tables at the end of register_hooks, instead of the slightly
odd way we we presume that each module does or does not have
one of each such creater/merger, skipping along the NULL refs.

When we last tried to optimize this, hooks were attempted and
proved to have much too much overhead. A startup-time straight
array of function pointer/conf index pointer elements will be
the only way to keep the logic as efficient as it is today, and
then build upon that model.  I don't expect we will allow the
create/merge table to change after the register_hooks phase.

--001a11c2eb5a17eb740526152bb9
Content-Type: text/html; charset=UTF-8
Content-Transfer-Encoding: quoted-printable

<div dir=3D"ltr"><div class=3D"gmail_extra"><div class=3D"gmail_quote">On F=
ri, Dec 4, 2015 at 10:17 AM, Nick Kew <span dir=3D"ltr">&lt;<a href=3D"mail=
to:nick@webthing.com" target=3D"_blank">nick@webthing.com</a>&gt;</span> wr=
ote:<br><blockquote class=3D"gmail_quote" style=3D"margin:0 0 0 .8ex;border=
-left:1px #ccc solid;padding-left:1ex"><span class=3D""><br>
&gt; I&#39;m looking, none of these seem like huge hacks, wondering<br>
&gt; which of them trigger your concern?<br>
<br>
</span>Well, your talk of refactoring config led me to wonder<br>
whether you were proposing another tilt at the whole directory<br>
walk stuff.=C2=A0 While that may have merit, past experience<br>
tells us it&#39;s not going to be easy!<br></blockquote><div><br></div><div=
>If I never have to refactor that code again, it will still be too soon :-/=
</div><div><br></div><div>More likely that someone enthusiastic could take =
the base/short</div><div>unique &lt;Directory&gt; blocks and pre-merge thos=
e to global/vhost</div><div>scope, as the shortcut to a more specific scope=
 as the first-match=C2=A0</div><div>hit.=C2=A0 Deeper pre-merge optimizatio=
ns would be rough and all of it</div><div>presupposes there are no request-=
specific eval blocks and no</div><div>directory permitting an .htaccess cou=
ld be optimized that way.</div><div><br></div><div>So... no... much like th=
e non-iterating fnmatch implementation, I&#39;d</div><div>prefer to let oth=
ers wrap their heads around that puzzle and come</div><div>up with somethin=
g new and more efficient.=C2=A0 All I was thinking of</div><div>doing was e=
xtending the core concept of &#39;compiled in modules&#39;</div><div>to all=
ow a module-of-modules, and build unique create/merge</div><div>call tables=
 at the end of register_hooks, instead of the slightly</div><div>odd way we=
 we presume that each module does or does not have</div><div>one of each su=
ch creater/merger, skipping along the NULL refs.</div><div><br></div><div>W=
hen we last tried to optimize this, hooks were attempted and</div><div>prov=
ed to have much too much overhead. A startup-time straight=C2=A0</div><div>=
array of function pointer/conf index pointer elements will be</div><div>the=
 only way to keep the logic as efficient as it is today, and=C2=A0</div><di=
v>then build upon that model.=C2=A0 I don&#39;t expect we will allow the</d=
iv><div>create/merge table to change after the register_hooks phase.</div><=
div><br></div><div><br></div></div></div></div>

--001a11c2eb5a17eb740526152bb9--

From dev-return-84863-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Fri Dec  4 17:01:53 2015
Return-Path: <dev-return-84863-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id E15F2189CB
	for <apmail-httpd-dev-archive@www.apache.org>; Fri,  4 Dec 2015 17:01:53 +0000 (UTC)
Received: (qmail 62985 invoked by uid 500); 4 Dec 2015 17:01:53 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 62910 invoked by uid 500); 4 Dec 2015 17:01:53 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 62900 invoked by uid 99); 4 Dec 2015 17:01:53 -0000
Received: from Unknown (HELO spamd1-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 04 Dec 2015 17:01:53 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd1-us-west.apache.org (ASF Mail Server at spamd1-us-west.apache.org) with ESMTP id EDB4ECCDB2
	for <dev@httpd.apache.org>; Fri,  4 Dec 2015 17:01:52 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd1-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 3
X-Spam-Level: ***
X-Spam-Status: No, score=3 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, HTML_MESSAGE=3,
	SPF_PASS=-0.001, URIBL_BLOCKED=0.001] autolearn=disabled
Authentication-Results: spamd1-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=rowe-clan-net.20150623.gappssmtp.com
Received: from mx1-us-west.apache.org ([10.40.0.8])
	by localhost (spamd1-us-west.apache.org [10.40.0.7]) (amavisd-new, port 10024)
	with ESMTP id 7CxNwwixN6ur for <dev@httpd.apache.org>;
	Fri,  4 Dec 2015 17:01:42 +0000 (UTC)
Received: from mail-io0-f169.google.com (mail-io0-f169.google.com [209.85.223.169])
	by mx1-us-west.apache.org (ASF Mail Server at mx1-us-west.apache.org) with ESMTPS id 2B8BE20267
	for <dev@httpd.apache.org>; Fri,  4 Dec 2015 17:01:42 +0000 (UTC)
Received: by iouu10 with SMTP id u10so124668251iou.0
        for <dev@httpd.apache.org>; Fri, 04 Dec 2015 09:01:41 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=rowe-clan-net.20150623.gappssmtp.com; s=20150623;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        bh=v5e3kkYV7M8oAs+dEkze8wQVrBHuO8tX7H7eKReXx94=;
        b=H4XNjEr8pwvwtTkrU1ONJeYleIIbx8+0i+F8iP9pajLNIfSFLAdR/4fP7ZewVAN4Z9
         wQf2tsXWuh9PuwuI5pTTgx6yyL4JDWeHwD6Wh6rlemnE22nhbl9Tku/9qMVDeJ6h1McN
         LBKcNS3N5UbI/q98egj57UFaZCaUzEY0A5Ro5OAINPJqYdQMEYScquBjqPU/i/05/f6b
         LaSr14k/Yazlr8skNRixX7JJLWuTb86ZW04Fzz+r44/Vs512GBYGf8g3wf8LgO3AbKyu
         LG3IlFeTJhCpTR+tfeHU0+5eqcMjKwtwNvuQUp/DotT7+UrBv2ICZdyR/E5MhypClQ8C
         IQMw==
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=1e100.net; s=20130820;
        h=x-gm-message-state:mime-version:in-reply-to:references:date
         :message-id:subject:from:to:content-type;
        bh=v5e3kkYV7M8oAs+dEkze8wQVrBHuO8tX7H7eKReXx94=;
        b=f7ItzYFRhbqg0jbjTO/TZN2Lokh5H/6xFm4cp7UTQcr4bXuxLZGhcYA5oe9DSFjLlp
         DrUtY5X8W0VaumeVnTQsKVaOsZ/kLWkOjebAW8SWPWyLpvNr7Tmss0vlowO/uNVnFVeJ
         XA4tUXW4K2Lkd9s65P9f31tOYkJPj9mV3og6DNhb7rTZSpn08Xc/Z1QTT9ERIw94ZLxu
         qSSaW7dsOHkDCZz9V5lXOHM+IJ/oz5IM4PseaHIUTynOWY7KQbifnaNZy0Ts8tAjZDg+
         GAJWdZL4e0KNraGDK1ibD0+OIC0C+m3GJXVJZTPU+GzK4MoF4/4mdK3fIHCwM9BRFcqt
         EStQ==
X-Gm-Message-State: ALoCoQnVdRfegsXGku6NFxy0u0d73c7BkWtBUpt7r5hrppc+K1ztB13rTGjMAly3EreDT5mQxnCF
MIME-Version: 1.0
X-Received: by 10.107.10.66 with SMTP id u63mr13897683ioi.86.1449248501533;
 Fri, 04 Dec 2015 09:01:41 -0800 (PST)
Received: by 10.107.62.136 with HTTP; Fri, 4 Dec 2015 09:01:41 -0800 (PST)
In-Reply-To: <5660808D.4070508@kippdata.de>
References: <5660808D.4070508@kippdata.de>
Date: Fri, 4 Dec 2015 11:01:41 -0600
Message-ID: <CACsi2516X1LkXzxY+2LUuC3xntn9O=dhUAoYEJWxYpMya2qgng@mail.gmail.com>
Subject: Re: DER encoded cert no longer supported in 2.4 since 2.4.8
From: William A Rowe Jr <wrowe@rowe-clan.net>
To: httpd <dev@httpd.apache.org>
Content-Type: multipart/alternative; boundary=001a113f93be20364a05261576a3

--001a113f93be20364a05261576a3
Content-Type: text/plain; charset=UTF-8

On Thu, Dec 3, 2015 at 11:49 AM, Rainer Jung <rainer.jung@kippdata.de>
wrote:

> I did a 2.2 to 2.4 migration today. The old 2.2 server was using a
> certificate file, which was DER encoded and the new 2.4 one didn't like it.
>
> It seems support for DER encoded certs was removed in 2.4.8 as a side
> effect of r1573360 (bckport of r1553824). The certificate in 2.2 is read
> using SSL_read_X509() which tries PEM but also DER. After the change, the
> OpenSSL API SSL_read_X509() is used, which only accepts PEM.
>
> Is that problem analysis right? If so we'd need to decide, whether we keep
> it as is (no one complained, so DER seems to be rare) and simply document
> the change in the changelog and migration guide, or whether we still need
> to support DER encoded certs.
>

I think you meant PEM_read_bio_* and  PEM_X509_INFO_read_bio
in the 2.4.8+ implementation.

What I don't grok is why there are no corresponding DER_ functions
exposed by openssl?  If there were, fail-over seems simple enough.


> IMHO documenting the change would be enough.
>

That's a good start for anyone tripping over 2.4.8-2.4.x, whether
it is fixed or not.

--001a113f93be20364a05261576a3
Content-Type: text/html; charset=UTF-8
Content-Transfer-Encoding: quoted-printable

<div dir=3D"ltr"><div class=3D"gmail_extra"><div class=3D"gmail_quote">On T=
hu, Dec 3, 2015 at 11:49 AM, Rainer Jung <span dir=3D"ltr">&lt;<a href=3D"m=
ailto:rainer.jung@kippdata.de" target=3D"_blank">rainer.jung@kippdata.de</a=
>&gt;</span> wrote:<br><blockquote class=3D"gmail_quote" style=3D"margin:0p=
x 0px 0px 0.8ex;border-left-width:1px;border-left-color:rgb(204,204,204);bo=
rder-left-style:solid;padding-left:1ex">I did a 2.2 to 2.4 migration today.=
 The old 2.2 server was using a certificate file, which was DER encoded and=
 the new 2.4 one didn&#39;t like it.<br>
<br>
It seems support for DER encoded certs was removed in 2.4.8 as a side effec=
t of r1573360 (bckport of r1553824). The certificate in 2.2 is read using S=
SL_read_X509() which tries PEM but also DER. After the change, the OpenSSL =
API SSL_read_X509() is used, which only accepts PEM.<br>
<br>
Is that problem analysis right? If so we&#39;d need to decide, whether we k=
eep it as is (no one complained, so DER seems to be rare) and simply docume=
nt the change in the changelog and migration guide, or whether we still nee=
d to support DER encoded certs.<br></blockquote><div><br></div><div>I think=
 you meant PEM_read_bio_* and=C2=A0=C2=A0PEM_X509_INFO_read_bio</div><div>i=
n the 2.4.8+ implementation.</div><div><br></div><div>What I don&#39;t grok=
 is why there are no corresponding DER_ functions</div><div>exposed by open=
ssl?=C2=A0 If there were, fail-over seems simple enough.</div><div>=C2=A0</=
div><blockquote class=3D"gmail_quote" style=3D"margin:0px 0px 0px 0.8ex;bor=
der-left-width:1px;border-left-color:rgb(204,204,204);border-left-style:sol=
id;padding-left:1ex">
IMHO documenting the change would be enough.<br></blockquote><div><br></div=
><div>That&#39;s a good start for anyone tripping over 2.4.8-2.4.x, whether=
</div><div>it is fixed or not.=C2=A0</div><div><br></div></div></div></div>

--001a113f93be20364a05261576a3--

From dev-return-84864-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Fri Dec  4 17:43:03 2015
Return-Path: <dev-return-84864-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 60DD518D12
	for <apmail-httpd-dev-archive@www.apache.org>; Fri,  4 Dec 2015 17:43:03 +0000 (UTC)
Received: (qmail 24267 invoked by uid 500); 4 Dec 2015 17:42:52 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 24198 invoked by uid 500); 4 Dec 2015 17:42:52 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 24188 invoked by uid 99); 4 Dec 2015 17:42:52 -0000
Received: from Unknown (HELO spamd1-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 04 Dec 2015 17:42:52 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd1-us-west.apache.org (ASF Mail Server at spamd1-us-west.apache.org) with ESMTP id 3C08DCCE29
	for <dev@httpd.apache.org>; Fri,  4 Dec 2015 17:42:52 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd1-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.12
X-Spam-Level:
X-Spam-Status: No, score=-0.12 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RCVD_IN_MSPIKE_H3=-0.01, RCVD_IN_MSPIKE_WL=-0.01, SPF_PASS=-0.001,
	URIBL_BLOCKED=0.001] autolearn=disabled
Authentication-Results: spamd1-us-west.apache.org (amavisd-new);
	dkim=pass (1024-bit key) header.d=qqmail.nl
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd1-us-west.apache.org [10.40.0.7]) (amavisd-new, port 10024)
	with ESMTP id IJ6-7sQMlxJx for <dev@httpd.apache.org>;
	Fri,  4 Dec 2015 17:42:42 +0000 (UTC)
Received: from mail-wm0-f51.google.com (mail-wm0-f51.google.com [74.125.82.51])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id E06E121231
	for <dev@httpd.apache.org>; Fri,  4 Dec 2015 17:42:41 +0000 (UTC)
Received: by wmww144 with SMTP id w144so71249547wmw.1
        for <dev@httpd.apache.org>; Fri, 04 Dec 2015 09:42:41 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=qqmail.nl; s=google;
        h=from:to:references:in-reply-to:subject:date:message-id:mime-version
         :content-type:content-transfer-encoding:thread-index
         :content-language;
        bh=iHutQX2FQVMvxfFke4tOdDdt4pWyMghxAC9V75Xn/qU=;
        b=Ilw54dUTpqC5jplL2TvTtbw5upDY4zJ+v6mawbWk/1QWWYd7KZLt8S4w1DJ/f1okAg
         EMUe+9kY8XvHjANq4naZhrM5PExotS+Ew5nMN55MAG0Mzq53fW5qN/QqWmmM5xk3L5em
         Hp0hgw7KadOTgSIXEiFJbyZC3p7izke48Qv6w=
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=1e100.net; s=20130820;
        h=x-gm-message-state:from:to:references:in-reply-to:subject:date
         :message-id:mime-version:content-type:content-transfer-encoding
         :thread-index:content-language;
        bh=iHutQX2FQVMvxfFke4tOdDdt4pWyMghxAC9V75Xn/qU=;
        b=Tyo3lXvLFZLmd2f72s8TOALT/QdoJeHd45fqSNUMksBtOOBKJPPrfpNSej6WUNehwh
         ZACUgTbP1MIZzGpfEsA+YqEoAc86IBqy9b0WPxSymPy/vCLnrtXcEiEVVwqrfu0Stzn7
         mx7BcWvRBOIdT6KFNR+kwVPQKUrAtua5gZgpQmlqdaV47AnVcZ+nh95/Rb+UNSxrsUVm
         oKHZa3fGjLJ1lm87rcPpwW3NReygb2ZzEVcyyUr0gnTJQ4K7JL7yABSuddv/bo7fxfpf
         Y0zmtzsG/lUzaBUvHYQxmqFgmVzsqir+wfEmlSTSP0eI//kyWKTI4EZzgIa3z+mmMUV8
         HMmA==
X-Gm-Message-State: ALoCoQmtKfzfjqe4bH39NAMJjTFLu1GQDZVInFiJRZBO4km2dm2J+4hc4yU6OLaXm1l2mJGYZCAYxv7X20aHUnQUzQFWRSrOWA==
X-Received: by 10.28.95.193 with SMTP id t184mr6741848wmb.7.1449250961572;
        Fri, 04 Dec 2015 09:42:41 -0800 (PST)
Received: from i72600 ([2001:610:66e:0:52e5:49ff:fee1:96b7])
        by smtp.gmail.com with ESMTPSA id jh4sm13091395wjb.33.2015.12.04.09.42.40
        for <dev@httpd.apache.org>
        (version=TLSv1/SSLv3 cipher=OTHER);
        Fri, 04 Dec 2015 09:42:40 -0800 (PST)
From: "Bert Huijben" <bert@qqmail.nl>
To: <dev@httpd.apache.org>
References: <56599792.3060402@greenbytes.de> <03a401d129dd$fafdbfe0$f0f93fa0$@qqmail.nl> <03aa01d129e1$2d49d990$87dd8cb0$@qqmail.nl> <040101d12a23$ced65530$6c82ff90$@qqmail.nl> <40F35186-1FFF-48EF-BB67-DAE432526244@greenbytes.de> <46014DD1-B5DA-4920-B0E2-C43B43EB4816@jaguNET.com> <mnjp5b1qdm4sgu56t413p2bmblsqjpd9og@4ax.com> <78BF1B01-16EE-4071-803B-A174432C9503@jaguNET.com> <b47r5b5n1mf2oeeb33tidnsdvvr5dckjvf@4ax.com> <CACsi253Egm-K71wTd5Ff3gD6AFdhAgm1pHXafE5Kobzb4WejBQ@mail.gmail.com> <bqdr5blheuoccudj4sc7jql6e4dn8furd9@4ax.com> <1D08ECCD-A26B-4D3D-8F12-BE97018059B7@greenbytes.de> <043901d12e34$34d311c0$9e793540$@qqmail.nl> <10770C7F-5C8D-42EB-9E76-DC91160FDA89@greenbytes.de> <045e01d12e79$493fe620$dbbfb260$@qqmail.nl> <039D4360-8E2F-455D-8CC2-8405FC7FC272@greenbytes.de>
In-Reply-To: <039D4360-8E2F-455D-8CC2-8405FC7FC272@greenbytes.de>
Subject: RE: No H2 Window updates!
Date: Fri, 4 Dec 2015 18:42:38 +0100
Message-ID: <001601d12ebb$2c3f4100$84bdc300$@qqmail.nl>
MIME-Version: 1.0
Content-Type: text/plain;
	charset="us-ascii"
Content-Transfer-Encoding: 7bit
X-Mailer: Microsoft Outlook 16.0
Thread-Index: AQGXGGWJK51+8wmg6dya3z8sXP1eVQLJjD3WAYllbXMBus9ogwKvsD/MAwKh+zsBpLTtNQHfE9rNAXh0TekCRD5t/wJkXKwcAdb2BCQBbeFkWgFQGgpgApgN1RsCCDMJQJ46cg+A
Content-Language: nl



> -----Original Message-----
> From: Stefan Eissing [mailto:stefan.eissing@greenbytes.de]
> Sent: vrijdag 4 december 2015 16:23
> To: dev@httpd.apache.org
> Subject: Re: No H2 Window updates!
> 
> If you find the time, the lastest v1.0.10 mod_http2 in 2.4.x sets the
> connection window to max which addresses for me the window starvation
> issues I was able to reproduce (and put into my test suite). I hope this
works
> for you as well, otherwise I'd need more detailed data on how to reproduce
> the hanger.

The latest version gives me immediately a connection window update of the
maximum allowed value.

But given that the initial connection window was already set via the
settings window, adding this value is not allowed.

The code has his comment copied from the RFC:
/* A sender MUST NOT allow a flow-control window to exceed 2^31-1
         octets.  If a sender receives a WINDOW_UPDATE that causes a flow-
         control window to exceed this maximum, it MUST terminate either the
         stream or the connection, as appropriate.  For streams, the sender
         sends a RST_STREAM with an error code of FLOW_CONTROL_ERROR; for
the
         connection, a GOAWAY frame with an error code of FLOW_CONTROL_ERROR
         is sent.*/

Serf does exactly this... it terminates the connection.

So it gets nowhere near the original point of failure in the test.
It fails around the first stream created the test, while the original
failure is after thousands of requests.

	Bert

-- 
With the same logging enabled as on that older url, this is the whole test
output now:


START: svnmover_tests.py
I: CMD: svnadmin.exe create svn-test-work\local_tmp\repos
--compatible-version=1.10 --fs-type=fsfs
I: <TIME = 0.016000>
I: CMD: svn.exe import -m "Log message for revision 1."
svn-test-work\local_tmp\greekfiles
https://localhost:7829/svn-test-work/local_tmp/repos --config-dir
R:\subversion\tests\cmdline\svn-test-work\local_tmp\config --password
rayjandom --no-auth-cache --username jrandom
I: CMD: R:\subversion\svn/svn.exe import -m "Log message for revision 1."
svn-test-work\local_tmp\greekfiles
https://localhost:7829/svn-test-work/local_tmp/repos --config-dir
R:\subversion\tests\cmdline\svn-test-work\local_tmp\config --password
rayjandom --no-auth-cache --username jrandom exited with 1
I: <TIME = 0.547000>
I: DBG: Allocated 131 bytes for window on stream 0x1 (left: 65404, 65404)
I: DBG: Connection window update of 2147483392 to -2147418500
I: ..\..\..\subversion\svn\import-cmd.c:129,
I: ..\..\..\subversion\libsvn_client\import.c:868,
I: ..\..\..\subversion\libsvn_client\ra.c:509,
I: ..\..\..\subversion\libsvn_client\ra.c:488,
I: ..\..\..\subversion\libsvn_ra\ra_loader.c:404:
(apr_err=SVN_ERR_RA_CANNOT_CREATE_SESSION)
I: svn: E170013: Unable to connect to a repository at URL
'https://localhost:7829/svn-test-work/local_tmp/repos'
I: ..\..\..\subversion\libsvn_ra_serf\serf.c:603,
I: ..\..\..\subversion\libsvn_ra_serf\options.c:538,
I: ..\..\..\subversion\libsvn_ra_serf\util.c:1032,
I: ..\..\..\subversion\libsvn_ra_serf\util.c:981,
I: ..\..\..\subversion\libsvn_ra_serf\util.c:958: (apr_err=120153)
I: svn: E120153: Error running context: HTTP2 flow control limits exceeded
W: ..\..\..\subversion\svn\import-cmd.c:129,
W: ..\..\..\subversion\libsvn_client\import.c:868,
W: ..\..\..\subversion\libsvn_client\ra.c:509,
W: ..\..\..\subversion\libsvn_client\ra.c:488,
W: ..\..\..\subversion\libsvn_ra\ra_loader.c:404:
(apr_err=SVN_ERR_RA_CANNOT_CREATE_SESSION)
W: svn: E170013: Unable to connect to a repository at URL
'https://localhost:7829/svn-test-work/local_tmp/repos'
W: ..\..\..\subversion\libsvn_ra_serf\serf.c:603,
W: ..\..\..\subversion\libsvn_ra_serf\options.c:538,
W: ..\..\..\subversion\libsvn_ra_serf\util.c:1032,
W: ..\..\..\subversion\libsvn_ra_serf\util.c:981,
W: ..\..\..\subversion\libsvn_ra_serf\util.c:958: (apr_err=120153)
W: svn: E120153: Error running context: HTTP2 flow control limits exceeded
END: svnmover_tests.py
ELAPSED: svnmover_tests.py 0:00:00.609000



From dev-return-84865-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Fri Dec  4 17:51:42 2015
Return-Path: <dev-return-84865-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 63A0118DAA
	for <apmail-httpd-dev-archive@www.apache.org>; Fri,  4 Dec 2015 17:51:42 +0000 (UTC)
Received: (qmail 59177 invoked by uid 500); 4 Dec 2015 17:51:41 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 59092 invoked by uid 500); 4 Dec 2015 17:51:41 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 59082 invoked by uid 99); 4 Dec 2015 17:51:41 -0000
Received: from Unknown (HELO spamd2-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 04 Dec 2015 17:51:41 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd2-us-west.apache.org (ASF Mail Server at spamd2-us-west.apache.org) with ESMTP id F2D481A5F89
	for <dev@httpd.apache.org>; Fri,  4 Dec 2015 17:51:40 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd2-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.1
X-Spam-Level:
X-Spam-Status: No, score=-0.1 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	SPF_PASS=-0.001, URIBL_BLOCKED=0.001] autolearn=disabled
Authentication-Results: spamd2-us-west.apache.org (amavisd-new);
	dkim=pass (1024-bit key) header.d=qqmail.nl
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd2-us-west.apache.org [10.40.0.9]) (amavisd-new, port 10024)
	with ESMTP id s1EMUvxOINMQ for <dev@httpd.apache.org>;
	Fri,  4 Dec 2015 17:51:29 +0000 (UTC)
Received: from mail-wm0-f49.google.com (mail-wm0-f49.google.com [74.125.82.49])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id 57DEE2059B
	for <dev@httpd.apache.org>; Fri,  4 Dec 2015 17:51:29 +0000 (UTC)
Received: by wmww144 with SMTP id w144so71538855wmw.1
        for <dev@httpd.apache.org>; Fri, 04 Dec 2015 09:51:29 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=qqmail.nl; s=google;
        h=from:to:references:in-reply-to:subject:date:message-id:mime-version
         :content-type:content-transfer-encoding:thread-index
         :content-language;
        bh=C7smCBx1pEafUqc90yOfZMOe/ZslTQp1KJ2DT/oPLcU=;
        b=Wy4t9MmJrY1uaJoKWG8vTfIOVMOkrtC8omwGHEqPKfN3KEbDIYbXXkgxhRFgvpOvHu
         gKj0QtZXhmaD4ivz3mmpOOeoYsk3P11XLgFjGzIeg4t7Os5yQncad0YMKbhnxLFLe5jT
         9lPDk2DRd1momwccC1zGzszGJfi6B90+lK2jg=
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=1e100.net; s=20130820;
        h=x-gm-message-state:from:to:references:in-reply-to:subject:date
         :message-id:mime-version:content-type:content-transfer-encoding
         :thread-index:content-language;
        bh=C7smCBx1pEafUqc90yOfZMOe/ZslTQp1KJ2DT/oPLcU=;
        b=PzqR7yus+rlFFaCJNbc7pPzSLueu6iE9bxOaiTdey5cwakFzEZrUWxlgDXEPJ835zH
         ex6MKyt1aAUoh8limXe5SPAfeZKGVNr2xPFw3GLhBn/M/2QKjfk1Up+88VIW78q68UxD
         lfy/eazuvl/a1druCUGM737rzDAeUav7OzbH7JaR7XyAmTd7Q3zCEDkmVLFz9zM50iD4
         AtP9BbLwUjlRtdMpdoE8cZdAVby47khDX1AypIfBzcYBL6n0vnBkIUN2l/C6DmYpnrRn
         c22OLysRw182s33FgpbNhWaOasFoGUw3bALNg7xAHsrTyJTIvhZabD9ckxW/ROlM78KO
         MDWg==
X-Gm-Message-State: ALoCoQnFSB5TdkNLnpyZsk/AVQB6mIfkgrR0UaKRC1T0hmxCyoDV9UJSkZaoJGEnhY2ALdbQRMsf
X-Received: by 10.194.200.134 with SMTP id js6mr21602275wjc.114.1449251489058;
        Fri, 04 Dec 2015 09:51:29 -0800 (PST)
Received: from i72600 ([2001:610:66e:0:52e5:49ff:fee1:96b7])
        by smtp.gmail.com with ESMTPSA id u139sm4416712wmu.22.2015.12.04.09.51.28
        for <dev@httpd.apache.org>
        (version=TLSv1/SSLv3 cipher=OTHER);
        Fri, 04 Dec 2015 09:51:28 -0800 (PST)
From: "Bert Huijben" <bert@qqmail.nl>
To: <dev@httpd.apache.org>
References: <20151204142554.253BB3A02EE@svn01-us-west.apache.org>
In-Reply-To: <20151204142554.253BB3A02EE@svn01-us-west.apache.org>
Subject: RE: svn commit: r1717970 - /httpd/test/mod_h2/trunk/test/test_window_update.sh
Date: Fri, 4 Dec 2015 18:51:25 +0100
Message-ID: <001701d12ebc$66969910$33c3cb30$@qqmail.nl>
MIME-Version: 1.0
Content-Type: text/plain;
	charset="UTF-8"
Content-Transfer-Encoding: quoted-printable
X-Mailer: Microsoft Outlook 16.0
Thread-Index: AQKRZf9j80yOLW3qQzQ4dWv2FI55ZJ06rCnA
Content-Language: nl



> -----Original Message-----
> From: icing@apache.org [mailto:icing@apache.org]
> Sent: vrijdag 4 december 2015 15:26
> To: cvs@httpd.apache.org
> Subject: svn commit: r1717970 -
> /httpd/test/mod_h2/trunk/test/test_window_update.sh
>=20
> Author: icing
> Date: Fri Dec  4 14:25:53 2015
> New Revision: 1717970
>=20
> URL: http://svn.apache.org/viewvc?rev=3D1717970&view=3Drev
> Log:
> adding to window_update tests to verify connection window exhaustion =
(or
> lack of it)
>=20
> Modified:
>     httpd/test/mod_h2/trunk/test/test_window_update.sh
>=20
> Modified: httpd/test/mod_h2/trunk/test/test_window_update.sh
> URL:
> http://svn.apache.org/viewvc/httpd/test/mod_h2/trunk/test/test_window
> _update.sh?rev=3D1717970&r1=3D1717969&r2=3D1717970&view=3Ddiff
> =
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D
> =3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D
> --- httpd/test/mod_h2/trunk/test/test_window_update.sh (original)
> +++ httpd/test/mod_h2/trunk/test/test_window_update.sh Fri Dec  4
> 14:25:53 2015
> @@ -34,19 +34,18 @@ fi
>  # test if small uploads trigger window_udpate(s) and do not let =
connection
>  # windows shrink to 0.
>  #
> -echo -n "POSTing 10 x 10k to server, MUST not hang"
> +echo -n "POSTing 10 x 10k, m=3D1"
>  ${H2LOAD} -p h2c -c 1 -t 1 -m 1 -n 10 -d $GEN/data-10k ${URL_PREFIX} =
|
> -while read line; do echo -n "."; done
> -echo "ok."
> +while read line; do echo -n "."; done; echo "ok."
>=20
> -echo -n "POSTing 10 x 100k to server, which are READ by app"
> -${H2LOAD} -p h2c -c 1 -t 1 -m 1 -n 100 -d $GEN/data-100k
> ${URL_PREFIX}/upload.py |
> -while read line; do echo -n "."; done
> -echo "ok."
> +echo -n "POSTing 1000 x 1k, m=3D100"
> +${H2LOAD} -p h2c -c 1 -t 1 -m 100 -n 1000 -d $GEN/data-1k =
${URL_PREFIX} |
> +while read line; do echo -n "."; done; echo "ok."
>=20
> -# FIXME: this does not work reliably for n >=3D 100
> -#
> -#echo -n "POSTing 10 x 100k to server, which are NOTREAD by app"
> -#${H2LOAD} -p h2c -c 1 -t 1 -m 1 -n 10 -d $GEN/data-100k =
${URL_PREFIX} |
> -#while read line; do echo -n "."; done
> -#echo "ok."
> \ No newline at end of file
> +echo -n "POSTing 100 x 100k, m=3D5, READ"
> +${H2LOAD} -p h2c -c 1 -t 1 -m 5 -n 100 -d $GEN/data-100k
> ${URL_PREFIX}/upload.py |
> +while read line; do echo -n "."; done; echo "ok."
> +
> +echo -n "POSTing 100 x 100k, m=3D50, NOT READ explicitly"
> +${H2LOAD} -p h2c -c 1 -t 1 -m 50 -n 100 -d $GEN/data-100k =
${URL_PREFIX} |
> +while read line; do echo -n "."; done; echo "ok."


The Subversion test I try is more like sending 2000 requests of 100 =
bytes over a single connection.

	Bert=20



From dev-return-84866-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Fri Dec  4 17:55:25 2015
Return-Path: <dev-return-84866-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id A0B5F18DE6
	for <apmail-httpd-dev-archive@www.apache.org>; Fri,  4 Dec 2015 17:55:25 +0000 (UTC)
Received: (qmail 86131 invoked by uid 500); 4 Dec 2015 17:55:25 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 86055 invoked by uid 500); 4 Dec 2015 17:55:25 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 86045 invoked by uid 99); 4 Dec 2015 17:55:25 -0000
Received: from Unknown (HELO spamd3-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 04 Dec 2015 17:55:25 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd3-us-west.apache.org (ASF Mail Server at spamd3-us-west.apache.org) with ESMTP id 90BD21809AB
	for <dev@httpd.apache.org>; Fri,  4 Dec 2015 17:55:24 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd3-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.1
X-Spam-Level:
X-Spam-Status: No, score=-0.1 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	SPF_PASS=-0.001, URIBL_BLOCKED=0.001] autolearn=disabled
Authentication-Results: spamd3-us-west.apache.org (amavisd-new);
	dkim=pass (1024-bit key) header.d=qqmail.nl
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd3-us-west.apache.org [10.40.0.10]) (amavisd-new, port 10024)
	with ESMTP id l-xNzIJhsqW7 for <dev@httpd.apache.org>;
	Fri,  4 Dec 2015 17:55:12 +0000 (UTC)
Received: from mail-wm0-f42.google.com (mail-wm0-f42.google.com [74.125.82.42])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id 72E3A21195
	for <dev@httpd.apache.org>; Fri,  4 Dec 2015 17:55:12 +0000 (UTC)
Received: by wmec201 with SMTP id c201so85342262wme.0
        for <dev@httpd.apache.org>; Fri, 04 Dec 2015 09:55:06 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=qqmail.nl; s=google;
        h=from:to:references:in-reply-to:subject:date:message-id:mime-version
         :content-type:content-transfer-encoding:thread-index
         :content-language;
        bh=gwospI4SwAZj6sjJuzOyQ3FMihTTGAv2HrCHmrjqrGk=;
        b=Y1lRykxInejL5rl+3JbiEuBHEx5t4TLEHjLsp1+ZHYMPTcR+kW3wAyl5s0Geg+FGIS
         ULZXGTkXcL69YrdT1+HYsOkL3FX27nofdI8otdEy8E8+LcG48/kEltO7sWh3VgC0BTFB
         0bu3TrMy2Lj7CreRwI2/kJte0oe3SyQsGRC04=
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=1e100.net; s=20130820;
        h=x-gm-message-state:from:to:references:in-reply-to:subject:date
         :message-id:mime-version:content-type:content-transfer-encoding
         :thread-index:content-language;
        bh=gwospI4SwAZj6sjJuzOyQ3FMihTTGAv2HrCHmrjqrGk=;
        b=W3Y8b1fXzmIryUZSrO6Zso+IU63RIRT3EeiJE+NCZV5XoXHTq7HRYrpm8saGDb4oAe
         BBxuvQyACtcWQ00Pll57Qea0z7NmFFKX+XcysDykjTErsSVTOcBmwwchGagV2lb5ATGz
         MTzCE5aR3dmw2Q7J/86L8nE9JMKKGGUVm3dOS9lf6rJoz0r7/Chzq8b4svhGyGOUuDHm
         hprUi3nO/y/Q+Gk6gioA2gQHnzv+VA08RGrVzMhmONYTKyel9zHOBnaUaTzpWoQAVE3z
         lT8sMLm87JW18qDP5mLpzrJn3uJAbMUsQKLTjsPeo5dARKUlr15ZFZwBwX/ZBy8Ajr3P
         Po2w==
X-Gm-Message-State: ALoCoQlxfaWgxnsD96IcQZOrPWVyF2kCnHByIxaO+VHh+F1d/Z7uny36nn8Zp9MDUOjm3j0deXM3
X-Received: by 10.28.54.21 with SMTP id d21mr6415481wma.20.1449251706185;
        Fri, 04 Dec 2015 09:55:06 -0800 (PST)
Received: from i72600 ([2001:610:66e:0:52e5:49ff:fee1:96b7])
        by smtp.gmail.com with ESMTPSA id gj2sm13066904wjb.40.2015.12.04.09.55.05
        for <dev@httpd.apache.org>
        (version=TLSv1/SSLv3 cipher=OTHER);
        Fri, 04 Dec 2015 09:55:05 -0800 (PST)
From: "Bert Huijben" <bert@qqmail.nl>
To: <dev@httpd.apache.org>
References: <20151204142554.253BB3A02EE@svn01-us-west.apache.org> <001701d12ebc$66969910$33c3cb30$@qqmail.nl>
In-Reply-To: <001701d12ebc$66969910$33c3cb30$@qqmail.nl>
Subject: RE: svn commit: r1717970 - /httpd/test/mod_h2/trunk/test/test_window_update.sh
Date: Fri, 4 Dec 2015 18:55:04 +0100
Message-ID: <001801d12ebc$e8387b00$b8a97100$@qqmail.nl>
MIME-Version: 1.0
Content-Type: text/plain;
	charset="UTF-8"
Content-Transfer-Encoding: quoted-printable
X-Mailer: Microsoft Outlook 16.0
Thread-Index: AQKRZf9j80yOLW3qQzQ4dWv2FI55ZAL7GifnnSLUIpA=
Content-Language: nl



> -----Original Message-----
> From: Bert Huijben [mailto:bert@qqmail.nl]
> Sent: vrijdag 4 december 2015 18:51
> To: dev@httpd.apache.org
> Subject: RE: svn commit: r1717970 -
> /httpd/test/mod_h2/trunk/test/test_window_update.sh
>=20
>=20
>=20
> > -----Original Message-----
> > From: icing@apache.org [mailto:icing@apache.org]
> > Sent: vrijdag 4 december 2015 15:26
> > To: cvs@httpd.apache.org
> > Subject: svn commit: r1717970 -
> > /httpd/test/mod_h2/trunk/test/test_window_update.sh
> >
> > Author: icing
> > Date: Fri Dec  4 14:25:53 2015
> > New Revision: 1717970
> >
> > URL: http://svn.apache.org/viewvc?rev=3D1717970&view=3Drev
> > Log:
> > adding to window_update tests to verify connection window exhaustion
> (or
> > lack of it)
> >
> > Modified:
> >     httpd/test/mod_h2/trunk/test/test_window_update.sh
> >
> > Modified: httpd/test/mod_h2/trunk/test/test_window_update.sh
> > URL:
> >
> http://svn.apache.org/viewvc/httpd/test/mod_h2/trunk/test/test_window
> > _update.sh?rev=3D1717970&r1=3D1717969&r2=3D1717970&view=3Ddiff
> >
> =
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D
> > =3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D
> > --- httpd/test/mod_h2/trunk/test/test_window_update.sh (original)
> > +++ httpd/test/mod_h2/trunk/test/test_window_update.sh Fri Dec  4
> > 14:25:53 2015
> > @@ -34,19 +34,18 @@ fi
> >  # test if small uploads trigger window_udpate(s) and do not let =
connection
> >  # windows shrink to 0.
> >  #
> > -echo -n "POSTing 10 x 10k to server, MUST not hang"
> > +echo -n "POSTing 10 x 10k, m=3D1"
> >  ${H2LOAD} -p h2c -c 1 -t 1 -m 1 -n 10 -d $GEN/data-10k =
${URL_PREFIX} |
> > -while read line; do echo -n "."; done
> > -echo "ok."
> > +while read line; do echo -n "."; done; echo "ok."
> >
> > -echo -n "POSTing 10 x 100k to server, which are READ by app"
> > -${H2LOAD} -p h2c -c 1 -t 1 -m 1 -n 100 -d $GEN/data-100k
> > ${URL_PREFIX}/upload.py |
> > -while read line; do echo -n "."; done
> > -echo "ok."
> > +echo -n "POSTing 1000 x 1k, m=3D100"
> > +${H2LOAD} -p h2c -c 1 -t 1 -m 100 -n 1000 -d $GEN/data-1k =
${URL_PREFIX}
> |
> > +while read line; do echo -n "."; done; echo "ok."
> >
> > -# FIXME: this does not work reliably for n >=3D 100
> > -#
> > -#echo -n "POSTing 10 x 100k to server, which are NOTREAD by app"
> > -#${H2LOAD} -p h2c -c 1 -t 1 -m 1 -n 10 -d $GEN/data-100k =
${URL_PREFIX} |
> > -#while read line; do echo -n "."; done
> > -#echo "ok."
> > \ No newline at end of file
> > +echo -n "POSTing 100 x 100k, m=3D5, READ"
> > +${H2LOAD} -p h2c -c 1 -t 1 -m 5 -n 100 -d $GEN/data-100k
> > ${URL_PREFIX}/upload.py |
> > +while read line; do echo -n "."; done; echo "ok."
> > +
> > +echo -n "POSTing 100 x 100k, m=3D50, NOT READ explicitly"
> > +${H2LOAD} -p h2c -c 1 -t 1 -m 50 -n 100 -d $GEN/data-100k =
${URL_PREFIX}
> |
> > +while read line; do echo -n "."; done; echo "ok."
>=20
>=20
> The Subversion test I try is more like sending 2000 requests of 100 =
bytes over
> a single connection.

And most likely (in this test) Subversion still waits for every request =
to be handled before sending out the next request.

Perhaps it sends two requests at once, but it is unlikely to have more =
requests in flight during this test than this.

(In update/checkout scenarios it can have many more... but not in the =
failing test)

	Bert


From dev-return-84867-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Fri Dec  4 19:51:57 2015
Return-Path: <dev-return-84867-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 50D671854B
	for <apmail-httpd-dev-archive@www.apache.org>; Fri,  4 Dec 2015 19:51:57 +0000 (UTC)
Received: (qmail 33989 invoked by uid 500); 4 Dec 2015 19:51:56 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 33915 invoked by uid 500); 4 Dec 2015 19:51:56 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 33905 invoked by uid 99); 4 Dec 2015 19:51:56 -0000
Received: from Unknown (HELO spamd2-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 04 Dec 2015 19:51:56 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd2-us-west.apache.org (ASF Mail Server at spamd2-us-west.apache.org) with ESMTP id 0F1241A223B
	for <dev@httpd.apache.org>; Fri,  4 Dec 2015 19:51:56 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd2-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.554
X-Spam-Level:
X-Spam-Status: No, score=-0.554 tagged_above=-999 required=6.31
	tests=[HEADER_FROM_DIFFERENT_DOMAINS=0.001, RP_MATCHES_RCVD=-0.554,
	SPF_PASS=-0.001] autolearn=disabled
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd2-us-west.apache.org [10.40.0.9]) (amavisd-new, port 10024)
	with ESMTP id Yty53SyAUZBL for <dev@httpd.apache.org>;
	Fri,  4 Dec 2015 19:51:51 +0000 (UTC)
Received: from plane.gmane.org (plane.gmane.org [80.91.229.3])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id 9ECDF42AD1
	for <dev@httpd.apache.org>; Fri,  4 Dec 2015 19:51:51 +0000 (UTC)
Received: from list by plane.gmane.org with local (Exim 4.69)
	(envelope-from <apache-dev@m.gmane.org>)
	id 1a4wON-0002ax-Bj
	for dev@httpd.apache.org; Fri, 04 Dec 2015 20:51:43 +0100
Received: from 227-116.citynet.ftth.internl.net ([85.223.116.227])
        by main.gmane.org with esmtp (Gmexim 0.1 (Debian))
        id 1AlnuQ-0007hv-00
        for <dev@httpd.apache.org>; Fri, 04 Dec 2015 20:51:43 +0100
Received: from phpdev by 227-116.citynet.ftth.internl.net with local (Gmexim 0.1 (Debian))
        id 1AlnuQ-0007hv-00
        for <dev@httpd.apache.org>; Fri, 04 Dec 2015 20:51:43 +0100
X-Injected-Via-Gmane: http://gmane.org/
To: dev@httpd.apache.org
From: Jan Ehrhardt <phpdev@ehrhardt.nl>
Subject: Re: No H2 Window updates!
Date: Fri, 04 Dec 2015 20:51:37 +0100
Lines: 11
Message-ID: <1jr36b5oa182lb9mupjfm6st4o9qbbr78o@4ax.com>
References: <78BF1B01-16EE-4071-803B-A174432C9503@jaguNET.com> <b47r5b5n1mf2oeeb33tidnsdvvr5dckjvf@4ax.com> <CACsi253Egm-K71wTd5Ff3gD6AFdhAgm1pHXafE5Kobzb4WejBQ@mail.gmail.com> <bqdr5blheuoccudj4sc7jql6e4dn8furd9@4ax.com> <1D08ECCD-A26B-4D3D-8F12-BE97018059B7@greenbytes.de> <043901d12e34$34d311c0$9e793540$@qqmail.nl> <10770C7F-5C8D-42EB-9E76-DC91160FDA89@greenbytes.de> <045e01d12e79$493fe620$dbbfb260$@qqmail.nl> <039D4360-8E2F-455D-8CC2-8405FC7FC272@greenbytes.de>
Mime-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Complaints-To: usenet@ger.gmane.org
X-Gmane-NNTP-Posting-Host: 227-116.citynet.ftth.internl.net
X-Newsreader: Forte Agent 3.3/32.846

Stefan Eissing in gmane.comp.apache.devel (Fri, 4 Dec 2015 16:23:19
+0100):
>If you find the time, the lastest v1.0.10 mod_http2 in 2.4.x sets the
>connection window to max which addresses for me the window starvation
>issues I was able to reproduce (and put into my test suite). I hope this
>works for you as well, otherwise I'd need more detailed data on how to
>reproduce the hanger.

1.0.10 did not solve my problems with the admin menu in Drupal7. Sorry.
-- 
Jan


From dev-return-84868-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Fri Dec  4 20:36:10 2015
Return-Path: <dev-return-84868-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 0C072188E2
	for <apmail-httpd-dev-archive@www.apache.org>; Fri,  4 Dec 2015 20:36:10 +0000 (UTC)
Received: (qmail 96619 invoked by uid 500); 4 Dec 2015 20:36:09 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 96545 invoked by uid 500); 4 Dec 2015 20:36:09 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 96535 invoked by uid 99); 4 Dec 2015 20:36:09 -0000
Received: from Unknown (HELO spamd4-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 04 Dec 2015 20:36:09 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd4-us-west.apache.org (ASF Mail Server at spamd4-us-west.apache.org) with ESMTP id 15C89C0BE2
	for <dev@httpd.apache.org>; Fri,  4 Dec 2015 20:36:09 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd4-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.654
X-Spam-Level:
X-Spam-Status: No, score=-0.654 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RP_MATCHES_RCVD=-0.554, SPF_PASS=-0.001, URIBL_BLOCKED=0.001]
	autolearn=disabled
Authentication-Results: spamd4-us-west.apache.org (amavisd-new);
	dkim=pass (1024-bit key) header.d=greenbytes.de
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd4-us-west.apache.org [10.40.0.11]) (amavisd-new, port 10024)
	with ESMTP id qGvXh5pcQ0VU for <dev@httpd.apache.org>;
	Fri,  4 Dec 2015 20:35:58 +0000 (UTC)
Received: from mail.greenbytes.de (mail.greenbytes.de [217.91.35.233])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id DF5002156B
	for <dev@httpd.apache.org>; Fri,  4 Dec 2015 20:35:57 +0000 (UTC)
Received: from [192.168.178.61] (unknown [93.211.117.216])
	(using TLSv1 with cipher ECDHE-RSA-AES256-SHA (256/256 bits))
	(Client did not present a certificate)
	by mail.greenbytes.de (Postfix) with ESMTPSA id 14EF015A0934
	for <dev@httpd.apache.org>; Fri,  4 Dec 2015 21:35:55 +0100 (CET)
DKIM-Signature: v=1; a=rsa-sha256; c=simple/simple; d=greenbytes.de; s=mail;
	t=1449261356; bh=8H4YJ7vxM844RlG1D7c1piFmVnaPDLiCUaD/N3yDVZU=;
	h=From:Subject:Date:References:In-Reply-To:To:From;
	b=azHl7lZcHY9MXZOLg185yEk3yw/v4i6fWQ0ey7EkQTWj6dzs63odyNm9fKiRcVAkM
	 q7FhkCnQ6xvumO2drxT4FgL5lXQsaoF/0boGC/02N+eoOi2W3MMFwWhvcnnc6EXkrY
	 638qFy2U9lQy4FC+us157YfLf8raMkh+5cnok+vo=
From: Stefan Eissing <stefan.eissing@greenbytes.de>
Content-Type: text/plain;
	charset=us-ascii
Content-Transfer-Encoding: quoted-printable
Mime-Version: 1.0 (1.0)
Subject: Re: No H2 Window updates!
Message-Id: <04DAEF9A-FBD8-4C5B-9572-45EDBBE5AB39@greenbytes.de>
Date: Fri, 4 Dec 2015 21:35:56 +0100
References: <56599792.3060402@greenbytes.de> <03a401d129dd$fafdbfe0$f0f93fa0$@qqmail.nl> <03aa01d129e1$2d49d990$87dd8cb0$@qqmail.nl> <040101d12a23$ced65530$6c82ff90$@qqmail.nl> <40F35186-1FFF-48EF-BB67-DAE432526244@greenbytes.de> <46014DD1-B5DA-4920-B0E2-C43B43EB4816@jaguNET.com> <mnjp5b1qdm4sgu56t413p2bmblsqjpd9og@4ax.com> <78BF1B01-16EE-4071-803B-A174432C9503@jaguNET.com> <b47r5b5n1mf2oeeb33tidnsdvvr5dckjvf@4ax.com> <CACsi253Egm-K71wTd5Ff3gD6AFdhAgm1pHXafE5Kobzb4WejBQ@mail.gmail.com> <bqdr5blheuoccudj4sc7jql6e4dn8furd9@4ax.com> <1D08ECCD-A26B-4D3D-8F12-BE97018059B7@greenbytes.de> <043901d12e34$34d311c0$9e793540$@qqmail.nl> <10770C7F-5C8D-42EB-9E76-DC91160FDA89@greenbytes.de> <045e01d12e79$493fe620$dbbfb260$@qqmail.nl> <039D4360-8E2F-455D-8CC2-8405FC7FC272@greenbytes.de> <001601d12ebb$2c3f4100$84bdc300$@qqmail.nl>
In-Reply-To: <001601d12ebb$2c3f4100$84bdc300$@qqmail.nl>
To: dev@httpd.apache.org
X-Mailer: iPhone Mail (13B143)

The code increases the window by the difference between max and current so t=
hat the client has exactly the max value. nghttp2 accepts this on the client=
 side. It rejects any larger value as you described.=20

So we seem to have a difference in calculation between nghttp2 and serf. whi=
ch values do you see? some data would be helpful here.=20

> Am 04.12.2015 um 18:42 schrieb Bert Huijben <bert@qqmail.nl>:
>=20
>=20
>=20
>> -----Original Message-----
>> From: Stefan Eissing [mailto:stefan.eissing@greenbytes.de]
>> Sent: vrijdag 4 december 2015 16:23
>> To: dev@httpd.apache.org
>> Subject: Re: No H2 Window updates!
>>=20
>> If you find the time, the lastest v1.0.10 mod_http2 in 2.4.x sets the
>> connection window to max which addresses for me the window starvation
>> issues I was able to reproduce (and put into my test suite). I hope this
> works
>> for you as well, otherwise I'd need more detailed data on how to reproduc=
e
>> the hanger.
>=20
> The latest version gives me immediately a connection window update of the
> maximum allowed value.
>=20
> But given that the initial connection window was already set via the
> settings window, adding this value is not allowed.
>=20
> The code has his comment copied from the RFC:
> /* A sender MUST NOT allow a flow-control window to exceed 2^31-1
>         octets.  If a sender receives a WINDOW_UPDATE that causes a flow-
>         control window to exceed this maximum, it MUST terminate either th=
e
>         stream or the connection, as appropriate.  For streams, the sender=

>         sends a RST_STREAM with an error code of FLOW_CONTROL_ERROR; for
> the
>         connection, a GOAWAY frame with an error code of FLOW_CONTROL_ERRO=
R
>         is sent.*/
>=20
> Serf does exactly this... it terminates the connection.
>=20
> So it gets nowhere near the original point of failure in the test.
> It fails around the first stream created the test, while the original
> failure is after thousands of requests.
>=20
>    Bert
>=20
> --=20
> With the same logging enabled as on that older url, this is the whole test=

> output now:
>=20
>=20
> START: svnmover_tests.py
> I: CMD: svnadmin.exe create svn-test-work\local_tmp\repos
> --compatible-version=3D1.10 --fs-type=3Dfsfs
> I: <TIME =3D 0.016000>
> I: CMD: svn.exe import -m "Log message for revision 1."
> svn-test-work\local_tmp\greekfiles
> https://localhost:7829/svn-test-work/local_tmp/repos --config-dir
> R:\subversion\tests\cmdline\svn-test-work\local_tmp\config --password
> rayjandom --no-auth-cache --username jrandom
> I: CMD: R:\subversion\svn/svn.exe import -m "Log message for revision 1."
> svn-test-work\local_tmp\greekfiles
> https://localhost:7829/svn-test-work/local_tmp/repos --config-dir
> R:\subversion\tests\cmdline\svn-test-work\local_tmp\config --password
> rayjandom --no-auth-cache --username jrandom exited with 1
> I: <TIME =3D 0.547000>
> I: DBG: Allocated 131 bytes for window on stream 0x1 (left: 65404, 65404)
> I: DBG: Connection window update of 2147483392 to -2147418500
> I: ..\..\..\subversion\svn\import-cmd.c:129,
> I: ..\..\..\subversion\libsvn_client\import.c:868,
> I: ..\..\..\subversion\libsvn_client\ra.c:509,
> I: ..\..\..\subversion\libsvn_client\ra.c:488,
> I: ..\..\..\subversion\libsvn_ra\ra_loader.c:404:
> (apr_err=3DSVN_ERR_RA_CANNOT_CREATE_SESSION)
> I: svn: E170013: Unable to connect to a repository at URL
> 'https://localhost:7829/svn-test-work/local_tmp/repos'
> I: ..\..\..\subversion\libsvn_ra_serf\serf.c:603,
> I: ..\..\..\subversion\libsvn_ra_serf\options.c:538,
> I: ..\..\..\subversion\libsvn_ra_serf\util.c:1032,
> I: ..\..\..\subversion\libsvn_ra_serf\util.c:981,
> I: ..\..\..\subversion\libsvn_ra_serf\util.c:958: (apr_err=3D120153)
> I: svn: E120153: Error running context: HTTP2 flow control limits exceeded=

> W: ..\..\..\subversion\svn\import-cmd.c:129,
> W: ..\..\..\subversion\libsvn_client\import.c:868,
> W: ..\..\..\subversion\libsvn_client\ra.c:509,
> W: ..\..\..\subversion\libsvn_client\ra.c:488,
> W: ..\..\..\subversion\libsvn_ra\ra_loader.c:404:
> (apr_err=3DSVN_ERR_RA_CANNOT_CREATE_SESSION)
> W: svn: E170013: Unable to connect to a repository at URL
> 'https://localhost:7829/svn-test-work/local_tmp/repos'
> W: ..\..\..\subversion\libsvn_ra_serf\serf.c:603,
> W: ..\..\..\subversion\libsvn_ra_serf\options.c:538,
> W: ..\..\..\subversion\libsvn_ra_serf\util.c:1032,
> W: ..\..\..\subversion\libsvn_ra_serf\util.c:981,
> W: ..\..\..\subversion\libsvn_ra_serf\util.c:958: (apr_err=3D120153)
> W: svn: E120153: Error running context: HTTP2 flow control limits exceeded=

> END: svnmover_tests.py
> ELAPSED: svnmover_tests.py 0:00:00.609000
>=20
>=20

From dev-return-84869-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Fri Dec  4 20:38:05 2015
Return-Path: <dev-return-84869-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 5B3C118904
	for <apmail-httpd-dev-archive@www.apache.org>; Fri,  4 Dec 2015 20:38:05 +0000 (UTC)
Received: (qmail 6876 invoked by uid 500); 4 Dec 2015 20:37:55 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 6811 invoked by uid 500); 4 Dec 2015 20:37:55 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 6800 invoked by uid 99); 4 Dec 2015 20:37:55 -0000
Received: from Unknown (HELO spamd1-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 04 Dec 2015 20:37:55 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd1-us-west.apache.org (ASF Mail Server at spamd1-us-west.apache.org) with ESMTP id C55BEC1623
	for <dev@httpd.apache.org>; Fri,  4 Dec 2015 20:37:54 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd1-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.11
X-Spam-Level:
X-Spam-Status: No, score=-0.11 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	SPF_PASS=-0.001, T_RP_MATCHES_RCVD=-0.01, URIBL_BLOCKED=0.001]
	autolearn=disabled
Authentication-Results: spamd1-us-west.apache.org (amavisd-new);
	dkim=pass (1024-bit key) header.d=greenbytes.de
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd1-us-west.apache.org [10.40.0.7]) (amavisd-new, port 10024)
	with ESMTP id 46vBZTjvOMGC for <dev@httpd.apache.org>;
	Fri,  4 Dec 2015 20:37:47 +0000 (UTC)
Received: from mail.greenbytes.de (mail.greenbytes.de [217.91.35.233])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id E1D712304B
	for <dev@httpd.apache.org>; Fri,  4 Dec 2015 20:37:46 +0000 (UTC)
Received: from [192.168.178.61] (unknown [93.211.117.216])
	(using TLSv1 with cipher ECDHE-RSA-AES256-SHA (256/256 bits))
	(Client did not present a certificate)
	by mail.greenbytes.de (Postfix) with ESMTPSA id 2056615A043A
	for <dev@httpd.apache.org>; Fri,  4 Dec 2015 21:37:46 +0100 (CET)
DKIM-Signature: v=1; a=rsa-sha256; c=simple/simple; d=greenbytes.de; s=mail;
	t=1449261466; bh=ceUGwg8I+pK4mDH8Ut2KG1VYpK5FBif2B+aGVRzWkiI=;
	h=From:Subject:Date:References:In-Reply-To:To:From;
	b=l1EsM/QmOVnIQIipFBCNApG/BN5cHHdZ3K9PkVAa9Z9NA7OgIJHJFaqrRHYN3A97C
	 14LwBphPnemJkImnJW5C4N29ZVJm7TUt2MeR0O0OmnSsxSoKRYfNjX0UGW4IyavBxG
	 y03UXshhsq8JSiD3xhaKCoJJaXpLXI5EuIO41NQw=
From: Stefan Eissing <stefan.eissing@greenbytes.de>
Content-Type: text/plain;
	charset=us-ascii
Content-Transfer-Encoding: quoted-printable
Mime-Version: 1.0 (1.0)
Subject: Re: No H2 Window updates!
Message-Id: <DA07528F-19ED-44AD-BBDA-DE3301F9F9EC@greenbytes.de>
Date: Fri, 4 Dec 2015 21:37:46 +0100
References: <78BF1B01-16EE-4071-803B-A174432C9503@jaguNET.com> <b47r5b5n1mf2oeeb33tidnsdvvr5dckjvf@4ax.com> <CACsi253Egm-K71wTd5Ff3gD6AFdhAgm1pHXafE5Kobzb4WejBQ@mail.gmail.com> <bqdr5blheuoccudj4sc7jql6e4dn8furd9@4ax.com> <1D08ECCD-A26B-4D3D-8F12-BE97018059B7@greenbytes.de> <043901d12e34$34d311c0$9e793540$@qqmail.nl> <10770C7F-5C8D-42EB-9E76-DC91160FDA89@greenbytes.de> <045e01d12e79$493fe620$dbbfb260$@qqmail.nl> <039D4360-8E2F-455D-8CC2-8405FC7FC272@greenbytes.de> <1jr36b5oa182lb9mupjfm6st4o9qbbr78o@4ax.com>
In-Reply-To: <1jr36b5oa182lb9mupjfm6st4o9qbbr78o@4ax.com>
To: dev@httpd.apache.org
X-Mailer: iPhone Mail (13B143)



> Am 04.12.2015 um 20:51 schrieb Jan Ehrhardt <phpdev@ehrhardt.nl>:
>=20
> Stefan Eissing in gmane.comp.apache.devel (Fri, 4 Dec 2015 16:23:19
> +0100):
>> If you find the time, the lastest v1.0.10 mod_http2 in 2.4.x sets the
>> connection window to max which addresses for me the window starvation
>> issues I was able to reproduce (and put into my test suite). I hope this
>> works for you as well, otherwise I'd need more detailed data on how to
>> reproduce the hanger.
>=20
> 1.0.10 did not solve my problems with the admin menu in Drupal7. Sorry.

Do you have any advice how to reproduce the problem, so that I might see wha=
t it is? I am not familiar with drupal7, unfortunately.=20=

From dev-return-84870-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Fri Dec  4 20:45:03 2015
Return-Path: <dev-return-84870-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 479E318942
	for <apmail-httpd-dev-archive@www.apache.org>; Fri,  4 Dec 2015 20:45:03 +0000 (UTC)
Received: (qmail 28254 invoked by uid 500); 4 Dec 2015 20:45:02 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 28186 invoked by uid 500); 4 Dec 2015 20:45:02 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 28176 invoked by uid 99); 4 Dec 2015 20:45:02 -0000
Received: from Unknown (HELO spamd1-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 04 Dec 2015 20:45:02 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd1-us-west.apache.org (ASF Mail Server at spamd1-us-west.apache.org) with ESMTP id 51CD9C1720
	for <dev@httpd.apache.org>; Fri,  4 Dec 2015 20:45:02 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd1-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.1
X-Spam-Level:
X-Spam-Status: No, score=-0.1 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	SPF_PASS=-0.001, URIBL_BLOCKED=0.001] autolearn=disabled
Authentication-Results: spamd1-us-west.apache.org (amavisd-new);
	dkim=pass (1024-bit key) header.d=qqmail.nl
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd1-us-west.apache.org [10.40.0.7]) (amavisd-new, port 10024)
	with ESMTP id bOU4UO91T-1A for <dev@httpd.apache.org>;
	Fri,  4 Dec 2015 20:44:52 +0000 (UTC)
Received: from mail-wm0-f48.google.com (mail-wm0-f48.google.com [74.125.82.48])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id 8FE7B2156B
	for <dev@httpd.apache.org>; Fri,  4 Dec 2015 20:44:51 +0000 (UTC)
Received: by wmec201 with SMTP id c201so91052628wme.0
        for <dev@httpd.apache.org>; Fri, 04 Dec 2015 12:44:51 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=qqmail.nl; s=google;
        h=from:to:references:in-reply-to:subject:date:message-id:mime-version
         :content-type:content-transfer-encoding:thread-index
         :content-language;
        bh=CBykTmOnhKhe579FUP7SQCvH0b5djwVA1iMyZe4ICnc=;
        b=Rla3FRDQ5DC7sbKwAOFLy8Nq8flH696i4FbY/axt7JE0ICqBiJpsI3aUaWsfvZKl0V
         37PasYErUNtrTgEUSZtX8kJp+jK92fdyUcsOBbkop76XuAKeX5244uCSs+ej6JEiT7Y9
         b/qevX/AT6L6weCUFwyRGF0+pvE7Rc3cs3IFM=
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=1e100.net; s=20130820;
        h=x-gm-message-state:from:to:references:in-reply-to:subject:date
         :message-id:mime-version:content-type:content-transfer-encoding
         :thread-index:content-language;
        bh=CBykTmOnhKhe579FUP7SQCvH0b5djwVA1iMyZe4ICnc=;
        b=eAKw3KVgTJ3UgKfK0akwdHa5wqVDVn4LXM9O3pTP3qMJSxGlrW9TZ9aMNIRoFbb/iC
         CgRQSsEjVAS8TNWt8rHTu+OqSW8cAUPnPM4UoGHg92fY1Ui1DbG3goTkBquKUiq1zXC5
         g6xKQLXFOpVmlDZU8sZrzzKNRouUAt44OpoIySDJ5TsqBNEZkwusJ8Jlv1X4mXdmZzDw
         E6hxYqfqK5EvOFgR+V5nnR/kAKr1IqGoNyIU+2I2qV9YtBuo3G/7k+DqA1SeK517C+bd
         jyA9C6IEKtZ+D5dCDaZbvIOUVvGATteKtWpEIZ8REpdhX1nznti1DGVRE2lMMWIyAyZg
         JG9A==
X-Gm-Message-State: ALoCoQnprkA+620JtnbglOvajN6NFQoaBIzmb5p5qVJ2yg90shFHPw5R2QvnJw0iJKCaBHfv9xU8
X-Received: by 10.194.82.99 with SMTP id h3mr22656124wjy.41.1449261891231;
        Fri, 04 Dec 2015 12:44:51 -0800 (PST)
Received: from i72600 ([2001:610:66e:0:52e5:49ff:fee1:96b7])
        by smtp.gmail.com with ESMTPSA id t194sm5003195wmt.11.2015.12.04.12.44.49
        for <dev@httpd.apache.org>
        (version=TLSv1/SSLv3 cipher=OTHER);
        Fri, 04 Dec 2015 12:44:50 -0800 (PST)
From: "Bert Huijben" <bert@qqmail.nl>
To: <dev@httpd.apache.org>
References: <56599792.3060402@greenbytes.de> <03a401d129dd$fafdbfe0$f0f93fa0$@qqmail.nl> <03aa01d129e1$2d49d990$87dd8cb0$@qqmail.nl> <040101d12a23$ced65530$6c82ff90$@qqmail.nl> <40F35186-1FFF-48EF-BB67-DAE432526244@greenbytes.de> <46014DD1-B5DA-4920-B0E2-C43B43EB4816@jaguNET.com> <mnjp5b1qdm4sgu56t413p2bmblsqjpd9og@4ax.com> <78BF1B01-16EE-4071-803B-A174432C9503@jaguNET.com> <b47r5b5n1mf2oeeb33tidnsdvvr5dckjvf@4ax.com> <CACsi253Egm-K71wTd5Ff3gD6AFdhAgm1pHXafE5Kobzb4WejBQ@mail.gmail.com> <bqdr5blheuoccudj4sc7jql6e4dn8furd9@4ax.com> <1D08ECCD-A26B-4D3D-8F12-BE97018059B7@greenbytes.de> <043901d12e34$34d311c0$9e793540$@qqmail.nl> <10770C7F-5C8D-42EB-9E76-DC91160FDA89@greenbytes.de> <045e01d12e79$493fe620$dbbfb260$@qqmail.nl> <039D4360-8E2F-455D-8CC2-8405FC7FC272@greenbytes.de> <001601d12ebb$2c3f4100$84bdc300$@qqmail.nl> <04DAEF9A-FBD8-4C5B-9572-45EDBBE5AB39@greenbytes.de>
In-Reply-To: <04DAEF9A-FBD8-4C5B-9572-45EDBBE5AB39@greenbytes.de>
Subject: RE: No H2 Window updates!
Date: Fri, 4 Dec 2015 21:44:47 +0100
Message-ID: <002e01d12ed4$9e3cbc60$dab63520$@qqmail.nl>
MIME-Version: 1.0
Content-Type: text/plain;
	charset="us-ascii"
Content-Transfer-Encoding: 7bit
X-Mailer: Microsoft Outlook 16.0
Thread-Index: AQGXGGWJK51+8wmg6dya3z8sXP1eVQLJjD3WAYllbXMBus9ogwKvsD/MAwKh+zsBpLTtNQHfE9rNAXh0TekCRD5t/wJkXKwcAdb2BCQBbeFkWgFQGgpgApgN1RsCCDMJQAEC2lHFAkgMFcueIE7AQA==
Content-Language: nl



> -----Original Message-----
> From: Stefan Eissing [mailto:stefan.eissing@greenbytes.de]
> Sent: vrijdag 4 december 2015 21:36
> To: dev@httpd.apache.org
> Subject: Re: No H2 Window updates!
> 
> The code increases the window by the difference between max and current
> so that the client has exactly the max value. nghttp2 accepts this on the
client
> side. It rejects any larger value as you described.
> 
> So we seem to have a difference in calculation between nghttp2 and serf.
> which values do you see? some data would be helpful here.

The values are completely in the log file at the bottom of this mail.

I open a connection and the server announces a default window of 65535.

> > I: DBG: Allocated 131 bytes for window on stream 0x1 (left: 65404,
65404)
I send a request with a DATA frame with a payload of 131 bytes, which
updates the stream and windows size with -131.

So both the stream and connection windows are no longer default, but 65404.
Logged for easy reading


Then I receive a WINDOW_UPDATE frame
> > I: DBG: Connection window update of 2147483392 to -2147418500
Which tries to add 2147483392 to the existing window.

Which doesn't fit, because the total outgoing window has to fit in 2^31-1...
See the RFC.


That is all that happens.
(The windowing in the other direction is completely uninteresting here... as
it happens completely independent)

	Bert



> 
> > Am 04.12.2015 um 18:42 schrieb Bert Huijben <bert@qqmail.nl>:
> >
> >
> >
> >> -----Original Message-----
> >> From: Stefan Eissing [mailto:stefan.eissing@greenbytes.de]
> >> Sent: vrijdag 4 december 2015 16:23
> >> To: dev@httpd.apache.org
> >> Subject: Re: No H2 Window updates!
> >>
> >> If you find the time, the lastest v1.0.10 mod_http2 in 2.4.x sets the
> >> connection window to max which addresses for me the window
> starvation
> >> issues I was able to reproduce (and put into my test suite). I hope
this
> > works
> >> for you as well, otherwise I'd need more detailed data on how to
> reproduce
> >> the hanger.
> >
> > The latest version gives me immediately a connection window update of
> the
> > maximum allowed value.
> >
> > But given that the initial connection window was already set via the
> > settings window, adding this value is not allowed.
> >
> > The code has his comment copied from the RFC:
> > /* A sender MUST NOT allow a flow-control window to exceed 2^31-1
> >         octets.  If a sender receives a WINDOW_UPDATE that causes a
flow-
> >         control window to exceed this maximum, it MUST terminate either
the
> >         stream or the connection, as appropriate.  For streams, the
sender
> >         sends a RST_STREAM with an error code of FLOW_CONTROL_ERROR;
> for
> > the
> >         connection, a GOAWAY frame with an error code of
> FLOW_CONTROL_ERROR
> >         is sent.*/
> >
> > Serf does exactly this... it terminates the connection.
> >
> > So it gets nowhere near the original point of failure in the test.
> > It fails around the first stream created the test, while the original
> > failure is after thousands of requests.
> >
> >    Bert
> >
> > --
> > With the same logging enabled as on that older url, this is the whole
test
> > output now:
> >
> >
> > START: svnmover_tests.py
> > I: CMD: svnadmin.exe create svn-test-work\local_tmp\repos
> > --compatible-version=1.10 --fs-type=fsfs
> > I: <TIME = 0.016000>
> > I: CMD: svn.exe import -m "Log message for revision 1."
> > svn-test-work\local_tmp\greekfiles
> > https://localhost:7829/svn-test-work/local_tmp/repos --config-dir
> > R:\subversion\tests\cmdline\svn-test-work\local_tmp\config --password
> > rayjandom --no-auth-cache --username jrandom
> > I: CMD: R:\subversion\svn/svn.exe import -m "Log message for revision
1."
> > svn-test-work\local_tmp\greekfiles
> > https://localhost:7829/svn-test-work/local_tmp/repos --config-dir
> > R:\subversion\tests\cmdline\svn-test-work\local_tmp\config --password
> > rayjandom --no-auth-cache --username jrandom exited with 1
> > I: <TIME = 0.547000>
> > I: DBG: Allocated 131 bytes for window on stream 0x1 (left: 65404,
65404)
> > I: DBG: Connection window update of 2147483392 to -2147418500
> > I: ..\..\..\subversion\svn\import-cmd.c:129,
> > I: ..\..\..\subversion\libsvn_client\import.c:868,
> > I: ..\..\..\subversion\libsvn_client\ra.c:509,
> > I: ..\..\..\subversion\libsvn_client\ra.c:488,
> > I: ..\..\..\subversion\libsvn_ra\ra_loader.c:404:
> > (apr_err=SVN_ERR_RA_CANNOT_CREATE_SESSION)
> > I: svn: E170013: Unable to connect to a repository at URL
> > 'https://localhost:7829/svn-test-work/local_tmp/repos'
> > I: ..\..\..\subversion\libsvn_ra_serf\serf.c:603,
> > I: ..\..\..\subversion\libsvn_ra_serf\options.c:538,
> > I: ..\..\..\subversion\libsvn_ra_serf\util.c:1032,
> > I: ..\..\..\subversion\libsvn_ra_serf\util.c:981,
> > I: ..\..\..\subversion\libsvn_ra_serf\util.c:958: (apr_err=120153)
> > I: svn: E120153: Error running context: HTTP2 flow control limits
exceeded
> > W: ..\..\..\subversion\svn\import-cmd.c:129,
> > W: ..\..\..\subversion\libsvn_client\import.c:868,
> > W: ..\..\..\subversion\libsvn_client\ra.c:509,
> > W: ..\..\..\subversion\libsvn_client\ra.c:488,
> > W: ..\..\..\subversion\libsvn_ra\ra_loader.c:404:
> > (apr_err=SVN_ERR_RA_CANNOT_CREATE_SESSION)
> > W: svn: E170013: Unable to connect to a repository at URL
> > 'https://localhost:7829/svn-test-work/local_tmp/repos'
> > W: ..\..\..\subversion\libsvn_ra_serf\serf.c:603,
> > W: ..\..\..\subversion\libsvn_ra_serf\options.c:538,
> > W: ..\..\..\subversion\libsvn_ra_serf\util.c:1032,
> > W: ..\..\..\subversion\libsvn_ra_serf\util.c:981,
> > W: ..\..\..\subversion\libsvn_ra_serf\util.c:958: (apr_err=120153)
> > W: svn: E120153: Error running context: HTTP2 flow control limits
exceeded
> > END: svnmover_tests.py
> > ELAPSED: svnmover_tests.py 0:00:00.609000
> >
> >


From dev-return-84871-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Fri Dec  4 20:51:53 2015
Return-Path: <dev-return-84871-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 9EDB41898A
	for <apmail-httpd-dev-archive@www.apache.org>; Fri,  4 Dec 2015 20:51:53 +0000 (UTC)
Received: (qmail 41213 invoked by uid 500); 4 Dec 2015 20:51:47 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 41156 invoked by uid 500); 4 Dec 2015 20:51:46 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 41146 invoked by uid 99); 4 Dec 2015 20:51:46 -0000
Received: from Unknown (HELO spamd3-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 04 Dec 2015 20:51:46 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd3-us-west.apache.org (ASF Mail Server at spamd3-us-west.apache.org) with ESMTP id 7880D180A8F
	for <dev@httpd.apache.org>; Fri,  4 Dec 2015 20:51:46 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd3-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.653
X-Spam-Level:
X-Spam-Status: No, score=-0.653 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	MIME_QP_LONG_LINE=0.001, RP_MATCHES_RCVD=-0.554, SPF_PASS=-0.001,
	URIBL_BLOCKED=0.001] autolearn=disabled
Authentication-Results: spamd3-us-west.apache.org (amavisd-new);
	dkim=pass (1024-bit key) header.d=greenbytes.de
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd3-us-west.apache.org [10.40.0.10]) (amavisd-new, port 10024)
	with ESMTP id WxfDdwQuKFaP for <dev@httpd.apache.org>;
	Fri,  4 Dec 2015 20:51:33 +0000 (UTC)
Received: from mail.greenbytes.de (mail.greenbytes.de [217.91.35.233])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id BD78421195
	for <dev@httpd.apache.org>; Fri,  4 Dec 2015 20:51:32 +0000 (UTC)
Received: from [192.168.178.61] (unknown [93.211.117.216])
	(using TLSv1 with cipher ECDHE-RSA-AES256-SHA (256/256 bits))
	(Client did not present a certificate)
	by mail.greenbytes.de (Postfix) with ESMTPSA id F3B3E15A0338
	for <dev@httpd.apache.org>; Fri,  4 Dec 2015 21:51:30 +0100 (CET)
DKIM-Signature: v=1; a=rsa-sha256; c=simple/simple; d=greenbytes.de; s=mail;
	t=1449262292; bh=ror6bBajFnzmaUkednAPe7a0jEXsMKEIExIx/lyDaO0=;
	h=From:Subject:Date:References:In-Reply-To:To:From;
	b=m2TMrflNR+iN3gEM7rZmnkYg8PGoaXCgMYmTDqA5MplDACOok3EDbPHnTZ9YJbQC7
	 JiClTVknJYwYmKgEoqqEfgl2xeT05QInFYZijzLusyJMeXLT7tqWxtkKcY4kY4vVbF
	 BQVo6RaTvgAUTpqD3oNys5LoB8s0Hp5C7JvW0rVE=
From: Stefan Eissing <stefan.eissing@greenbytes.de>
Content-Type: text/plain;
	charset=us-ascii
Content-Transfer-Encoding: quoted-printable
Mime-Version: 1.0 (1.0)
Subject: Re: svn commit: r1717970 - /httpd/test/mod_h2/trunk/test/test_window_update.sh
Message-Id: <04C48450-4650-4159-8DFE-67692798DF9E@greenbytes.de>
Date: Fri, 4 Dec 2015 21:51:31 +0100
References: <20151204142554.253BB3A02EE@svn01-us-west.apache.org> <001701d12ebc$66969910$33c3cb30$@qqmail.nl> <001801d12ebc$e8387b00$b8a97100$@qqmail.nl>
In-Reply-To: <001801d12ebc$e8387b00$b8a97100$@qqmail.nl>
To: dev@httpd.apache.org
X-Mailer: iPhone Mail (13B143)

I can certainly try more scenarios. The ones there in the tests reflect the p=
roblems I have seen and verify the fixes I did.

If you have a h2load scenario that reproduces what you see, that could be ve=
ry helpful. Alternatively, what would I have to do to run your test on my ma=
chine?

> Am 04.12.2015 um 18:55 schrieb Bert Huijben <bert@qqmail.nl>:
>=20
>=20
>=20
>> -----Original Message-----
>> From: Bert Huijben [mailto:bert@qqmail.nl]
>> Sent: vrijdag 4 december 2015 18:51
>> To: dev@httpd.apache.org
>> Subject: RE: svn commit: r1717970 -
>> /httpd/test/mod_h2/trunk/test/test_window_update.sh
>>=20
>>=20
>>=20
>>> -----Original Message-----
>>> From: icing@apache.org [mailto:icing@apache.org]
>>> Sent: vrijdag 4 december 2015 15:26
>>> To: cvs@httpd.apache.org
>>> Subject: svn commit: r1717970 -
>>> /httpd/test/mod_h2/trunk/test/test_window_update.sh
>>>=20
>>> Author: icing
>>> Date: Fri Dec  4 14:25:53 2015
>>> New Revision: 1717970
>>>=20
>>> URL: http://svn.apache.org/viewvc?rev=3D1717970&view=3Drev
>>> Log:
>>> adding to window_update tests to verify connection window exhaustion
>> (or
>>> lack of it)
>>>=20
>>> Modified:
>>>    httpd/test/mod_h2/trunk/test/test_window_update.sh
>>>=20
>>> Modified: httpd/test/mod_h2/trunk/test/test_window_update.sh
>>> URL:
>> http://svn.apache.org/viewvc/httpd/test/mod_h2/trunk/test/test_window
>>> _update.sh?rev=3D1717970&r1=3D1717969&r2=3D1717970&view=3Ddiff
>> =3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D
>>> =3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D
>>> --- httpd/test/mod_h2/trunk/test/test_window_update.sh (original)
>>> +++ httpd/test/mod_h2/trunk/test/test_window_update.sh Fri Dec  4
>>> 14:25:53 2015
>>> @@ -34,19 +34,18 @@ fi
>>> # test if small uploads trigger window_udpate(s) and do not let connecti=
on
>>> # windows shrink to 0.
>>> #
>>> -echo -n "POSTing 10 x 10k to server, MUST not hang"
>>> +echo -n "POSTing 10 x 10k, m=3D1"
>>> ${H2LOAD} -p h2c -c 1 -t 1 -m 1 -n 10 -d $GEN/data-10k ${URL_PREFIX} |
>>> -while read line; do echo -n "."; done
>>> -echo "ok."
>>> +while read line; do echo -n "."; done; echo "ok."
>>>=20
>>> -echo -n "POSTing 10 x 100k to server, which are READ by app"
>>> -${H2LOAD} -p h2c -c 1 -t 1 -m 1 -n 100 -d $GEN/data-100k
>>> ${URL_PREFIX}/upload.py |
>>> -while read line; do echo -n "."; done
>>> -echo "ok."
>>> +echo -n "POSTing 1000 x 1k, m=3D100"
>>> +${H2LOAD} -p h2c -c 1 -t 1 -m 100 -n 1000 -d $GEN/data-1k ${URL_PREFIX}=

>> |
>>> +while read line; do echo -n "."; done; echo "ok."
>>>=20
>>> -# FIXME: this does not work reliably for n >=3D 100
>>> -#
>>> -#echo -n "POSTing 10 x 100k to server, which are NOTREAD by app"
>>> -#${H2LOAD} -p h2c -c 1 -t 1 -m 1 -n 10 -d $GEN/data-100k ${URL_PREFIX} |=

>>> -#while read line; do echo -n "."; done
>>> -#echo "ok."
>>> \ No newline at end of file
>>> +echo -n "POSTing 100 x 100k, m=3D5, READ"
>>> +${H2LOAD} -p h2c -c 1 -t 1 -m 5 -n 100 -d $GEN/data-100k
>>> ${URL_PREFIX}/upload.py |
>>> +while read line; do echo -n "."; done; echo "ok."
>>> +
>>> +echo -n "POSTing 100 x 100k, m=3D50, NOT READ explicitly"
>>> +${H2LOAD} -p h2c -c 1 -t 1 -m 50 -n 100 -d $GEN/data-100k ${URL_PREFIX}=

>> |
>>> +while read line; do echo -n "."; done; echo "ok."
>>=20
>>=20
>> The Subversion test I try is more like sending 2000 requests of 100 bytes=
 over
>> a single connection.
>=20
> And most likely (in this test) Subversion still waits for every request to=
 be handled before sending out the next request.
>=20
> Perhaps it sends two requests at once, but it is unlikely to have more req=
uests in flight during this test than this.
>=20
> (In update/checkout scenarios it can have many more... but not in the fail=
ing test)
>=20
>    Bert
>=20

From dev-return-84872-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Fri Dec  4 21:27:31 2015
Return-Path: <dev-return-84872-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 2EBB518C5D
	for <apmail-httpd-dev-archive@www.apache.org>; Fri,  4 Dec 2015 21:27:31 +0000 (UTC)
Received: (qmail 57368 invoked by uid 500); 4 Dec 2015 21:27:30 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 57292 invoked by uid 500); 4 Dec 2015 21:27:30 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 57270 invoked by uid 99); 4 Dec 2015 21:27:30 -0000
Received: from Unknown (HELO spamd3-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 04 Dec 2015 21:27:30 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd3-us-west.apache.org (ASF Mail Server at spamd3-us-west.apache.org) with ESMTP id D34B9180A75
	for <dev@httpd.apache.org>; Fri,  4 Dec 2015 21:27:29 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd3-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.121
X-Spam-Level:
X-Spam-Status: No, score=-0.121 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RCVD_IN_MSPIKE_H3=-0.01, RCVD_IN_MSPIKE_WL=-0.01, SPF_PASS=-0.001]
	autolearn=disabled
Authentication-Results: spamd3-us-west.apache.org (amavisd-new);
	dkim=pass (1024-bit key) header.d=qqmail.nl
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd3-us-west.apache.org [10.40.0.10]) (amavisd-new, port 10024)
	with ESMTP id 26FK3VJyjyrn for <dev@httpd.apache.org>;
	Fri,  4 Dec 2015 21:27:28 +0000 (UTC)
Received: from mail-wm0-f44.google.com (mail-wm0-f44.google.com [74.125.82.44])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id 15F6042B82
	for <dev@httpd.apache.org>; Fri,  4 Dec 2015 21:27:27 +0000 (UTC)
Received: by wmww144 with SMTP id w144so81141771wmw.0
        for <dev@httpd.apache.org>; Fri, 04 Dec 2015 13:27:27 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=qqmail.nl; s=google;
        h=from:to:subject:date:message-id:mime-version:content-type
         :content-transfer-encoding:thread-index:content-language;
        bh=aphMRIma7i0sVGgg6s309W8MfysrjwCvSBpHDHXsgrk=;
        b=Ctv/QQ+qy2XY5IbFLnQrlHzLML9lLi9MEdM8ilSI7sLzzAUcyYbgjANViKQDvmwjPB
         jqYRQmnwqxjVtXT9Cg8UBS2MrQUo+rWSx6hu7SOf72jtaNN4/gkbiICx0tVa0/gExx9A
         712irY2Tc3AsRJKh+zR6InjqVNXaob6PD4ltc=
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=1e100.net; s=20130820;
        h=x-gm-message-state:from:to:subject:date:message-id:mime-version
         :content-type:content-transfer-encoding:thread-index
         :content-language;
        bh=aphMRIma7i0sVGgg6s309W8MfysrjwCvSBpHDHXsgrk=;
        b=eiEhzR6VHuXnBKK9bgpKMmtStjpqveMLBKxh3EIMzKp6AAsVnyH/k8m5YHU4sPzNbo
         ynVIAfhUpeS3Qkr9cjhtmFhtAaFjpZeNWeyDPUzxF212k4uKhpslNhhaCjeyXO/ubGcH
         fuQjDRADHBQhbr9PLy8eIkRbHxLA1a715qWbevL3D+9eJWzC4w6wQ4oOuGzPsoWAPcvH
         m3GPZeUzlLWXxCihXQDj5vXZI1COtziKCYD3Cxm2zu6JP67+zEdGF0dkGUuxxfQ3+Qc0
         SgY9GeklM/BrIdtky2sI5ZW62ycGUAPMyaF4tX6cZEG8dq7q4mByxmfx8jWgywgsX4Yo
         KD3g==
X-Gm-Message-State: ALoCoQl9JYNHPQQdGyy7ZClCHcUpcB6NQDoRhBl6mZIkqPod8d4kSD7blvH9Fvo7c9jS1HNDa/keGawZnMysP841RAMcuUC4zA==
X-Received: by 10.28.195.10 with SMTP id t10mr6956529wmf.11.1449264447051;
        Fri, 04 Dec 2015 13:27:27 -0800 (PST)
Received: from i72600 ([2001:610:66e:0:52e5:49ff:fee1:96b7])
        by smtp.gmail.com with ESMTPSA id bk2sm13849609wjc.3.2015.12.04.13.27.26
        for <dev@httpd.apache.org>
        (version=TLSv1/SSLv3 cipher=OTHER);
        Fri, 04 Dec 2015 13:27:26 -0800 (PST)
From: "Bert Huijben" <bert@qqmail.nl>
To: <dev@httpd.apache.org>
Subject: RE: No H2 Window updates! (Probably a Serf issue!)
Date: Fri, 4 Dec 2015 22:27:23 +0100
Message-ID: <000201d12eda$9220b3e0$b6621ba0$@qqmail.nl>
MIME-Version: 1.0
Content-Type: text/plain;
	charset="us-ascii"
Content-Transfer-Encoding: 7bit
X-Mailer: Microsoft Outlook 16.0
Thread-Index: AdEu2pBN3gy6BeG8SVueBI9z4KfUvg==
Content-Language: nl



> -----Original Message-----
> From: Bert Huijben [mailto:bert@qqmail.nl]
> Sent: vrijdag 4 december 2015 21:45
> To: dev@httpd.apache.org
> Subject: RE: No H2 Window updates!
> 
> 
> 
> > -----Original Message-----
> > From: Stefan Eissing [mailto:stefan.eissing@greenbytes.de]
> > Sent: vrijdag 4 december 2015 21:36
> > To: dev@httpd.apache.org
> > Subject: Re: No H2 Window updates!
> >
> > The code increases the window by the difference between max and
> current
> > so that the client has exactly the max value. nghttp2 accepts this on
the
> client
> > side. It rejects any larger value as you described.
> >
> > So we seem to have a difference in calculation between nghttp2 and serf.
> > which values do you see? some data would be helpful here.
> 
> The values are completely in the log file at the bottom of this mail.
> 
> I open a connection and the server announces a default window of 65535.
> 
> > > I: DBG: Allocated 131 bytes for window on stream 0x1 (left: 65404,
> 65404)
> I send a request with a DATA frame with a payload of 131 bytes, which
> updates the stream and windows size with -131.
> 
> So both the stream and connection windows are no longer default, but
> 65404.
> Logged for easy reading
> 
> 
> Then I receive a WINDOW_UPDATE frame
> > > I: DBG: Connection window update of 2147483392 to -2147418500
> Which tries to add 2147483392 to the existing window.
> 
> Which doesn't fit, because the total outgoing window has to fit in
2^31-1...
> See the RFC.

Ok, I think I found a -and provably THE- problem in serf...

There is a bug in decoding the window update frames... 


Reviewing and testing some bits there now.

	Bert



From dev-return-84873-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Fri Dec  4 21:46:12 2015
Return-Path: <dev-return-84873-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id DD8B018D35
	for <apmail-httpd-dev-archive@www.apache.org>; Fri,  4 Dec 2015 21:46:12 +0000 (UTC)
Received: (qmail 98476 invoked by uid 500); 4 Dec 2015 21:46:12 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 98410 invoked by uid 500); 4 Dec 2015 21:46:12 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 98397 invoked by uid 99); 4 Dec 2015 21:46:12 -0000
Received: from Unknown (HELO spamd3-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 04 Dec 2015 21:46:12 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd3-us-west.apache.org (ASF Mail Server at spamd3-us-west.apache.org) with ESMTP id 9EB2B180A75
	for <dev@httpd.apache.org>; Fri,  4 Dec 2015 21:46:11 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd3-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.121
X-Spam-Level:
X-Spam-Status: No, score=-0.121 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RCVD_IN_MSPIKE_H3=-0.01, RCVD_IN_MSPIKE_WL=-0.01, SPF_PASS=-0.001]
	autolearn=disabled
Authentication-Results: spamd3-us-west.apache.org (amavisd-new);
	dkim=pass (1024-bit key) header.d=qqmail.nl
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd3-us-west.apache.org [10.40.0.10]) (amavisd-new, port 10024)
	with ESMTP id AI6nz4W1I2ip for <dev@httpd.apache.org>;
	Fri,  4 Dec 2015 21:46:10 +0000 (UTC)
Received: from mail-wm0-f42.google.com (mail-wm0-f42.google.com [74.125.82.42])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id 9A62B428DC
	for <dev@httpd.apache.org>; Fri,  4 Dec 2015 21:46:09 +0000 (UTC)
Received: by wmww144 with SMTP id w144so78120475wmw.1
        for <dev@httpd.apache.org>; Fri, 04 Dec 2015 13:46:03 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=qqmail.nl; s=google;
        h=from:to:references:in-reply-to:subject:date:message-id:mime-version
         :content-type:content-transfer-encoding:thread-index
         :content-language;
        bh=HgoR8A4Bj6bW/m/aUxX6IICd7WrvOlMjCEJUGzCNwVg=;
        b=aAzubc8E76KZ/ZXkgzpFoP4dlMzU55Kr5ravYMwMwci8bco2IJZjjD+S9W2JEn0jK+
         bWP6eMNRRLtz6mbFaDc/FN486/ZeeZu1PdhErzmxOD3HaM+teb9KGFLTOhS56PBWPE3y
         ZLex8hLnsbDcuro1FahP59pQRakkE07nqulD8=
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=1e100.net; s=20130820;
        h=x-gm-message-state:from:to:references:in-reply-to:subject:date
         :message-id:mime-version:content-type:content-transfer-encoding
         :thread-index:content-language;
        bh=HgoR8A4Bj6bW/m/aUxX6IICd7WrvOlMjCEJUGzCNwVg=;
        b=j9y6RVQYmPgM+XMYmYB+MgCkx61N76+92BPOXhSS0v/0z8CGCn24rkD4CIl+Dr9X2/
         ilkSlRtjfykPHfSVqoiFIkW2MQq4sV/EVzJQUz+YtInxJfakhLsaR7YFqqTNM2SshkK1
         x/Abxaf0mj1pHf1fYZnuGyM7rAiS6jk6AuhfNvkidJK0mXwqmiTdxgy4drjMiOxugvPP
         lKTfGY5SnAqJz52LrCDsp83iwg79vars30biDV0UQRJH6JwjRtBXIiUDNODhzQWzSNzR
         Ldz8USzZouMX30WGGpiqEyUN/kSa6tORVYwiH1HjRkpaaeJt6Dqampz/qJdshLcSEXNz
         Tw8g==
X-Gm-Message-State: ALoCoQkYV5sYNc1ifsERu+ypP2qS4fTZ7TrGOE40pkWm9S1xO+A7koVmXbRHUJzSoNfeOPvHwrePOoEOjcNV5Ns2D+QyAT9RaQ==
X-Received: by 10.28.170.66 with SMTP id t63mr7414453wme.40.1449265563167;
        Fri, 04 Dec 2015 13:46:03 -0800 (PST)
Received: from i72600 ([2001:610:66e:0:52e5:49ff:fee1:96b7])
        by smtp.gmail.com with ESMTPSA id w6sm13818235wjy.31.2015.12.04.13.46.02
        for <dev@httpd.apache.org>
        (version=TLSv1/SSLv3 cipher=OTHER);
        Fri, 04 Dec 2015 13:46:02 -0800 (PST)
From: "Bert Huijben" <bert@qqmail.nl>
To: <dev@httpd.apache.org>
References: <000201d12eda$9220b3e0$b6621ba0$@qqmail.nl>
In-Reply-To: <000201d12eda$9220b3e0$b6621ba0$@qqmail.nl>
Subject: RE: No H2 Window updates! (Probably a Serf issue!)
Date: Fri, 4 Dec 2015 22:46:00 +0100
Message-ID: <000f01d12edd$2b622f00$82268d00$@qqmail.nl>
MIME-Version: 1.0
Content-Type: text/plain;
	charset="us-ascii"
Content-Transfer-Encoding: 7bit
X-Mailer: Microsoft Outlook 16.0
Thread-Index: AQKWTs07vTVyM/KA4YfKqKNRvr/tpZ0xGjWA
Content-Language: nl



> -----Original Message-----
> From: Bert Huijben [mailto:bert@qqmail.nl]
> Sent: vrijdag 4 december 2015 22:27
> To: dev@httpd.apache.org
> Subject: RE: No H2 Window updates! (Probably a Serf issue!)
> 
> 
> 
> > -----Original Message-----
> > From: Bert Huijben [mailto:bert@qqmail.nl]
> > Sent: vrijdag 4 december 2015 21:45
> > To: dev@httpd.apache.org
> > Subject: RE: No H2 Window updates!
> >
> >
> >
> > > -----Original Message-----
> > > From: Stefan Eissing [mailto:stefan.eissing@greenbytes.de]
> > > Sent: vrijdag 4 december 2015 21:36
> > > To: dev@httpd.apache.org
> > > Subject: Re: No H2 Window updates!
> > >
> > > The code increases the window by the difference between max and
> > current
> > > so that the client has exactly the max value. nghttp2 accepts this on
> the
> > client
> > > side. It rejects any larger value as you described.
> > >
> > > So we seem to have a difference in calculation between nghttp2 and
serf.
> > > which values do you see? some data would be helpful here.
> >
> > The values are completely in the log file at the bottom of this mail.
> >
> > I open a connection and the server announces a default window of 65535.
> >
> > > > I: DBG: Allocated 131 bytes for window on stream 0x1 (left: 65404,
> > 65404)
> > I send a request with a DATA frame with a payload of 131 bytes, which
> > updates the stream and windows size with -131.
> >
> > So both the stream and connection windows are no longer default, but
> > 65404.
> > Logged for easy reading
> >
> >
> > Then I receive a WINDOW_UPDATE frame
> > > > I: DBG: Connection window update of 2147483392 to -2147418500
> > Which tries to add 2147483392 to the existing window.
> >
> > Which doesn't fit, because the total outgoing window has to fit in
> 2^31-1...
> > See the RFC.
> 
> Ok, I think I found a -and provably THE- problem in serf...
> 
> There is a bug in decoding the window update frames...
> 
> 
> Reviewing and testing some bits there now.

>From r1718038

[[
--- serf/trunk/protocols/http2_protocol.c (original)
+++ serf/trunk/protocols/http2_protocol.c Fri Dec  4 21:35:11 2015
@@ -619,7 +619,7 @@ http2_handle_stream_window_update(void *
     window_update = (const void *)data;
 
     value = (window_update->v3 << 24) | (window_update->v2 << 16)
-        | (window_update->v2 << 8) | window_update->v0;
+        | (window_update->v1 << 8) | window_update->v0;
 
     value &= HTTP2_WINDOW_MAX_ALLOWED; /* The highest bit is reserved */
]]

This bug (also copied in another location) also explains the unusually small
window updates I received earlier... Most likely I missed a few interesting
bits in that second byte of the value, while the small window in httpd kept
the highest two bytes at 0.


The overflow of the max value is resolved by this patch... and the current
2.4.x code goes through the test now without any windowing delays. 


You might want to change the initial window back to something like 1MB or
16MB now, to at least test cases where a further update is necessary.


I certainly don't get connection window updates after the first one now in
my usual testing. I don't test uploading over 2 GB in a usual Subversion
test run.


	Bert 


From dev-return-84874-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Fri Dec  4 21:50:59 2015
Return-Path: <dev-return-84874-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 5A7AA18D79
	for <apmail-httpd-dev-archive@www.apache.org>; Fri,  4 Dec 2015 21:50:59 +0000 (UTC)
Received: (qmail 16046 invoked by uid 500); 4 Dec 2015 21:50:58 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 15960 invoked by uid 500); 4 Dec 2015 21:50:58 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 15950 invoked by uid 99); 4 Dec 2015 21:50:58 -0000
Received: from Unknown (HELO spamd4-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 04 Dec 2015 21:50:58 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd4-us-west.apache.org (ASF Mail Server at spamd4-us-west.apache.org) with ESMTP id 475C1C0BE2
	for <dev@httpd.apache.org>; Fri,  4 Dec 2015 21:50:58 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd4-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.654
X-Spam-Level:
X-Spam-Status: No, score=-0.654 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RP_MATCHES_RCVD=-0.554, SPF_PASS=-0.001, URIBL_BLOCKED=0.001]
	autolearn=disabled
Authentication-Results: spamd4-us-west.apache.org (amavisd-new);
	dkim=pass (1024-bit key) header.d=greenbytes.de
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd4-us-west.apache.org [10.40.0.11]) (amavisd-new, port 10024)
	with ESMTP id 7MBvNOcrfj9l for <dev@httpd.apache.org>;
	Fri,  4 Dec 2015 21:50:46 +0000 (UTC)
Received: from mail.greenbytes.de (mail.greenbytes.de [217.91.35.233])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id 4B64D21195
	for <dev@httpd.apache.org>; Fri,  4 Dec 2015 21:50:45 +0000 (UTC)
Received: from [192.168.178.61] (unknown [93.211.117.216])
	(using TLSv1 with cipher ECDHE-RSA-AES256-SHA (256/256 bits))
	(Client did not present a certificate)
	by mail.greenbytes.de (Postfix) with ESMTPSA id 7DBD115A05C8
	for <dev@httpd.apache.org>; Fri,  4 Dec 2015 22:50:44 +0100 (CET)
DKIM-Signature: v=1; a=rsa-sha256; c=simple/simple; d=greenbytes.de; s=mail;
	t=1449265844; bh=6T2muQYHUgLxb0pmla3yn412jZCyUk36lNygCCZRJaI=;
	h=From:Subject:Date:References:In-Reply-To:To:From;
	b=NDRQLJh+qWq63ZYoJYAhSvLXm9X1/q6UNii6ZyCac72fS/EwpJ9a9Dup7fue/L3Ag
	 G5eKKOHlO64q+cOuHkAOdfYV7UsUutgiKHclEk4sx1nm3tJlyDiUiu7T7hOedaUcCm
	 xNTrlySZDKIpz0BxTP+oW9NzxBAtgWQAohWyTjVg=
From: Stefan Eissing <stefan.eissing@greenbytes.de>
Content-Type: text/plain;
	charset=us-ascii
Content-Transfer-Encoding: quoted-printable
Mime-Version: 1.0 (1.0)
Subject: Re: No H2 Window updates! (Probably a Serf issue!)
Message-Id: <7A0120A1-2B0E-4709-8EA7-236550746C43@greenbytes.de>
Date: Fri, 4 Dec 2015 22:50:44 +0100
References: <000201d12eda$9220b3e0$b6621ba0$@qqmail.nl> <000f01d12edd$2b622f00$82268d00$@qqmail.nl>
In-Reply-To: <000f01d12edd$2b622f00$82268d00$@qqmail.nl>
To: dev@httpd.apache.org
X-Mailer: iPhone Mail (13B143)

Thanks for the quick update and the good news.=20

> Am 04.12.2015 um 22:46 schrieb Bert Huijben <bert@qqmail.nl>:
>=20
>=20
>=20
>> -----Original Message-----
>> From: Bert Huijben [mailto:bert@qqmail.nl]
>> Sent: vrijdag 4 december 2015 22:27
>> To: dev@httpd.apache.org
>> Subject: RE: No H2 Window updates! (Probably a Serf issue!)
>>=20
>>=20
>>=20
>>> -----Original Message-----
>>> From: Bert Huijben [mailto:bert@qqmail.nl]
>>> Sent: vrijdag 4 december 2015 21:45
>>> To: dev@httpd.apache.org
>>> Subject: RE: No H2 Window updates!
>>>=20
>>>=20
>>>=20
>>>> -----Original Message-----
>>>> From: Stefan Eissing [mailto:stefan.eissing@greenbytes.de]
>>>> Sent: vrijdag 4 december 2015 21:36
>>>> To: dev@httpd.apache.org
>>>> Subject: Re: No H2 Window updates!
>>>>=20
>>>> The code increases the window by the difference between max and
>>> current
>>>> so that the client has exactly the max value. nghttp2 accepts this on
>> the
>>> client
>>>> side. It rejects any larger value as you described.
>>>>=20
>>>> So we seem to have a difference in calculation between nghttp2 and
> serf.
>>>> which values do you see? some data would be helpful here.
>>>=20
>>> The values are completely in the log file at the bottom of this mail.
>>>=20
>>> I open a connection and the server announces a default window of 65535.
>>>=20
>>>>> I: DBG: Allocated 131 bytes for window on stream 0x1 (left: 65404,
>>> 65404)
>>> I send a request with a DATA frame with a payload of 131 bytes, which
>>> updates the stream and windows size with -131.
>>>=20
>>> So both the stream and connection windows are no longer default, but
>>> 65404.
>>> Logged for easy reading
>>>=20
>>>=20
>>> Then I receive a WINDOW_UPDATE frame
>>>>> I: DBG: Connection window update of 2147483392 to -2147418500
>>> Which tries to add 2147483392 to the existing window.
>>>=20
>>> Which doesn't fit, because the total outgoing window has to fit in
>> 2^31-1...
>>> See the RFC.
>>=20
>> Ok, I think I found a -and provably THE- problem in serf...
>>=20
>> There is a bug in decoding the window update frames...
>>=20
>>=20
>> Reviewing and testing some bits there now.
>=20
> =46rom r1718038
>=20
> [[
> --- serf/trunk/protocols/http2_protocol.c (original)
> +++ serf/trunk/protocols/http2_protocol.c Fri Dec  4 21:35:11 2015
> @@ -619,7 +619,7 @@ http2_handle_stream_window_update(void *
>     window_update =3D (const void *)data;
>=20
>     value =3D (window_update->v3 << 24) | (window_update->v2 << 16)
> -        | (window_update->v2 << 8) | window_update->v0;
> +        | (window_update->v1 << 8) | window_update->v0;
>=20
>     value &=3D HTTP2_WINDOW_MAX_ALLOWED; /* The highest bit is reserved */=

> ]]
>=20
> This bug (also copied in another location) also explains the unusually sma=
ll
> window updates I received earlier... Most likely I missed a few interestin=
g
> bits in that second byte of the value, while the small window in httpd kep=
t
> the highest two bytes at 0.
>=20
>=20
> The overflow of the max value is resolved by this patch... and the current=

> 2.4.x code goes through the test now without any windowing delays.=20
>=20
>=20
> You might want to change the initial window back to something like 1MB or
> 16MB now, to at least test cases where a further update is necessary.
>=20
>=20
> I certainly don't get connection window updates after the first one now in=

> my usual testing. I don't test uploading over 2 GB in a usual Subversion
> test run.
>=20
>=20
>    Bert=20
>=20

From dev-return-84875-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Sat Dec  5 03:19:10 2015
Return-Path: <dev-return-84875-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 69DA8189AD
	for <apmail-httpd-dev-archive@www.apache.org>; Sat,  5 Dec 2015 03:19:10 +0000 (UTC)
Received: (qmail 79933 invoked by uid 500); 5 Dec 2015 03:19:09 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 79857 invoked by uid 500); 5 Dec 2015 03:19:09 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 79847 invoked by uid 99); 5 Dec 2015 03:19:09 -0000
Received: from Unknown (HELO spamd4-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 05 Dec 2015 03:19:09 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd4-us-west.apache.org (ASF Mail Server at spamd4-us-west.apache.org) with ESMTP id 5475DC0BE2
	for <dev@httpd.apache.org>; Sat,  5 Dec 2015 03:19:09 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd4-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 2.327
X-Spam-Level: **
X-Spam-Status: No, score=2.327 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	FROM_MISSP_XPRIO=0.001, HTML_MESSAGE=3, RCVD_IN_MSPIKE_H4=-0.01,
	RCVD_IN_MSPIKE_WL=-0.01, RP_MATCHES_RCVD=-0.554, SPF_PASS=-0.001,
	URIBL_BLOCKED=0.001] autolearn=disabled
Authentication-Results: spamd4-us-west.apache.org (amavisd-new);
	dkim=pass (1024-bit key) header.d=163.com
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd4-us-west.apache.org [10.40.0.11]) (amavisd-new, port 10024)
	with ESMTP id VQgv3Dr-Wbj1 for <dev@httpd.apache.org>;
	Sat,  5 Dec 2015 03:19:01 +0000 (UTC)
Received: from m13-245.163.com (m13-245.163.com [220.181.13.245])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTP id 5E37F20273
	for <dev@httpd.apache.org>; Sat,  5 Dec 2015 03:19:00 +0000 (UTC)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=163.com;
	s=s110527; h=Date:From:Message-ID:Subject:MIME-Version; bh=e7ih2
	RWDjyjcz8Ay6jWBz9D3bdmi55T3aKpRCEYtcKc=; b=eUbbcx8UOshBkQSjuqxIK
	VcAzJ6ioklzws9MEQH1Um1RtbFF9YDXUlgQjq64HqFe7iCFErt+6KrCafdipO9Ex
	sPGUVu0OptCwxq6QIRHTNweuRqUFXbAKsOgzzJT/DlUw61X1R1Anq8Y0xiSO9Awl
	FWCD1laPRGhBsBJhMG4dE0=
Received: from franktom$163.com ( [59.53.18.58] ) by ajax-webmail-sdy11
 (Coremail) ; Sat, 5 Dec 2015 11:18:51 +0800 (GMT+08:00)
Date: Sat, 5 Dec 2015 11:18:51 +0800
From: "franktom"<franktom@163.com>
To: "dev"<dev@httpd.apache.org>
Message-ID: <4185cb1d.19e98c.1517026366b.Coremail.franktom@163.com>
In-Reply-To: <001801d12ebc$e8387b00$b8a97100$@qqmail.nl>
References: <20151204142554.253BB3A02EE@svn01-us-west.apache.org> <001701d12ebc$66969910$33c3cb30$@qqmail.nl><001801d12ebc$e8387b00$b8a97100$@qqmail.nl>
Subject: Re:  RE: svn commit: r1717970 - /httpd/test/mod_h2/trunk/test/test_window_update.sh
MIME-Version: 1.0
Content-Type: multipart/alternative;
	boundary="__=_Part_Boundary_003_009222.031132"
X-Mailer: MailMaster PC 1.1.1.20
X-Priority: 3 (Normal)
X-Originating-IP: [59.53.18.58]
X-CM-TRANSID:7MKowABXlqSbV2JWXysDAA--.20852W
X-CM-SenderInfo: xiud0yxwrpqiywtou0bp/1tbiow7HU1UL3IbJWAABst
X-Coremail-Antispam: 1U5529EdanIXcx71UUUUU7vcSsGvfC2KfnxnUU==

--__=_Part_Boundary_003_009222.031132
Content-Type: text/plain;
	charset="UTF-8"
Content-Transfer-Encoding: base64

dW5zdWJzY3JpYmU=
--__=_Part_Boundary_003_009222.031132
Content-Type: text/html;
	charset="UTF-8"
Content-Transfer-Encoding: base64

PCFET0NUWVBFIEhUTUwgUFVCTElDICItLy9XM0MvL0RURCBIVE1MIDQuMCBUcmFuc2l0aW9uYWwv
L0VOIj4NCjxIVE1MPjxIRUFEPg0KPE1FVEEgY29udGVudD0idGV4dC9odG1sOyBjaGFyc2V0PXV0
Zi04IiBodHRwLWVxdWl2PUNvbnRlbnQtVHlwZT48IS0tIGZsYXNobWFpbCBzdHlsZSBiZWdpbiAt
LT4NCjxTVFlMRSB0eXBlPXRleHQvY3NzPgpib2R5IHtib3JkZXItd2lkdGg6MDttYXJnaW46MH0K
aW1nIHtib3JkZXI6MDttYXJnaW46MDtwYWRkaW5nOjB9CjwvU1RZTEU+DQo8QkFTRSB0YXJnZXQ9
X2JsYW5rPjwhLS0gZmxhc2htYWlsIHN0eWxlIGVuZCAtLT4NCjxNRVRBIG5hbWU9R0VORVJBVE9S
IGNvbnRlbnQ9Ik1TSFRNTCA4LjAwLjc2MDEuMTg4OTYiPjwvSEVBRD4NCjxCT0RZIA0Kc3R5bGU9
IkxJTkUtSEVJR0hUOiAxLjU7IEJPUkRFUi1SSUdIVC1XSURUSDogMHB4OyBNQVJHSU46IDEycHg7
IEZPTlQtRkFNSUxZOiDlvq7ova/pm4Xpu5E7IEJPUkRFUi1UT1AtV0lEVEg6IDBweDsgQk9SREVS
LUJPVFRPTS1XSURUSDogMHB4OyBDT0xPUjogIzAwMDAwMDsgRk9OVC1TSVpFOiAxMC41cHQ7IEJP
UkRFUi1MRUZULVdJRFRIOiAwcHgiIA0KbWFyZ2luaGVpZ2h0PSIwIiBtYXJnaW53aWR0aD0iMCI+
DQo8RElWPnVuc3Vic2NyaWJlPC9ESVY+PC9CT0RZPjwvSFRNTD4=
--__=_Part_Boundary_003_009222.031132--


From dev-return-84876-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Sat Dec  5 10:00:18 2015
Return-Path: <dev-return-84876-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id E297118F4B
	for <apmail-httpd-dev-archive@www.apache.org>; Sat,  5 Dec 2015 10:00:17 +0000 (UTC)
Received: (qmail 80670 invoked by uid 500); 5 Dec 2015 10:00:16 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 80595 invoked by uid 500); 5 Dec 2015 10:00:16 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 80585 invoked by uid 99); 5 Dec 2015 10:00:16 -0000
Received: from Unknown (HELO spamd1-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 05 Dec 2015 10:00:16 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd1-us-west.apache.org (ASF Mail Server at spamd1-us-west.apache.org) with ESMTP id 6B59AC7D11
	for <dev@httpd.apache.org>; Sat,  5 Dec 2015 10:00:15 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd1-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 0.99
X-Spam-Level:
X-Spam-Status: No, score=0.99 tagged_above=-999 required=6.31
	tests=[KAM_LAZY_DOMAIN_SECURITY=1, T_RP_MATCHES_RCVD=-0.01]
	autolearn=disabled
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd1-us-west.apache.org [10.40.0.7]) (amavisd-new, port 10024)
	with ESMTP id uqg7mbqEVaq1 for <dev@httpd.apache.org>;
	Sat,  5 Dec 2015 10:00:14 +0000 (UTC)
Received: from eru.sfritsch.de (eru.sfritsch.de [188.40.99.202])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id 2071020C64
	for <dev@httpd.apache.org>; Sat,  5 Dec 2015 10:00:14 +0000 (UTC)
From: Stefan Fritsch <sf@sfritsch.de>
To: httpd <dev@httpd.apache.org>
Subject: Re: DER encoded cert no longer supported in 2.4 since 2.4.8
Date: Sat, 05 Dec 2015 10:59:59 +0100
Message-ID: <2049373.9A9pcfdX1X@k>
User-Agent: KMail/4.14.10 (Linux/4.3.0-trunk-amd64; KDE/4.14.13; x86_64; ; )
In-Reply-To: <CACsi2516X1LkXzxY+2LUuC3xntn9O=dhUAoYEJWxYpMya2qgng@mail.gmail.com>
References: <5660808D.4070508@kippdata.de> <CACsi2516X1LkXzxY+2LUuC3xntn9O=dhUAoYEJWxYpMya2qgng@mail.gmail.com>
MIME-Version: 1.0
Content-Transfer-Encoding: 7Bit
Content-Type: text/plain; charset="us-ascii"

On Friday 04 December 2015 11:01:41, William A Rowe Jr wrote:
> > IMHO documenting the change would be enough.
> 
> That's a good start for anyone tripping over 2.4.8-2.4.x, whether
> it is fixed or not.

Personally, I didn't know DER was supported. The docs only speak about 
PEM, too. I agree that documenting the change is enough.

From dev-return-84877-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Sat Dec  5 11:02:15 2015
Return-Path: <dev-return-84877-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 833BF18038
	for <apmail-httpd-dev-archive@www.apache.org>; Sat,  5 Dec 2015 11:02:15 +0000 (UTC)
Received: (qmail 22487 invoked by uid 500); 5 Dec 2015 11:02:14 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 22408 invoked by uid 500); 5 Dec 2015 11:02:14 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 22398 invoked by uid 99); 5 Dec 2015 11:02:14 -0000
Received: from Unknown (HELO spamd2-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 05 Dec 2015 11:02:14 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd2-us-west.apache.org (ASF Mail Server at spamd2-us-west.apache.org) with ESMTP id 1EFAB1A2553
	for <dev@httpd.apache.org>; Sat,  5 Dec 2015 11:02:14 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd2-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 0.81
X-Spam-Level:
X-Spam-Status: No, score=0.81 tagged_above=-999 required=6.31
	tests=[KAM_LAZY_DOMAIN_SECURITY=1, RDNS_DYNAMIC=0.363,
	RP_MATCHES_RCVD=-0.554, URIBL_BLOCKED=0.001] autolearn=disabled
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd2-us-west.apache.org [10.40.0.9]) (amavisd-new, port 10024)
	with ESMTP id pTFb4c1dUHui for <dev@httpd.apache.org>;
	Sat,  5 Dec 2015 11:02:06 +0000 (UTC)
Received: from nebula.c8h10n4o2.org.uk (nebula.c8h10n4o2.org.uk [80.68.88.207])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id 1F42220F4F
	for <dev@httpd.apache.org>; Sat,  5 Dec 2015 11:02:06 +0000 (UTC)
Received: from [81.2.91.97] (helo=[192.168.115.226])
	by nebula.c8h10n4o2.org.uk with esmtpsa (TLS1.2:ECDHE_RSA_AES_256_CBC_SHA1:256)
	(Exim 4.84)
	(envelope-from <isoma@c8h10n4o2.org.uk>)
	id 1a5AbF-00043U-SN
	for dev@httpd.apache.org; Sat, 05 Dec 2015 11:01:58 +0000
User-Agent: K-9 Mail for Android
In-Reply-To: <288293CD-6D82-42E0-BFC9-9DC25F969ED6@jaguNET.com>
References: <288293CD-6D82-42E0-BFC9-9DC25F969ED6@jaguNET.com>
MIME-Version: 1.0
Content-Transfer-Encoding: 8bit
Content-Type: text/plain;
 charset=UTF-8
Subject: Re: reverse proxy wishlist
From: Tim Bannister <isoma@c8h10n4o2.org.uk>
Date: Sat, 05 Dec 2015 11:01:54 +0000
To: dev@httpd.apache.org
Message-ID: <22283CFB-00E5-4773-9BE8-52A2D020AEC5@c8h10n4o2.org.uk>

On 3 December 2015 14:59:00 GMT, Jim Jagielski wrote:

>What would *you* like to see as new features or enhancements
>w/ mod_proxy, esp reverse proxy.

I'd like to have more options about error responses. Where httpd is reverse proxy for an application that may fail, and I want to have httpd send nicer 5xx responses.

ProxyErrorOverride is a good starting point. Often I want to let through only some error pages: the ones explicitly coded to be shown to this website's visitors. If the backend fails and produces an unstyled page of jargon and diagnostics, I want httpd to intervene.

The application could signal to httpd that its response has a user-friendly body via a special header.

I don't think httpd can do what I have in mind yet (maybe with mod_lua, but that's too much for many webmasters).

Tim


-- 
Tim Bannister  isoma@c8h10n4o2.org.uk

From dev-return-84878-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Sat Dec  5 12:19:24 2015
Return-Path: <dev-return-84878-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 14919181B7
	for <apmail-httpd-dev-archive@www.apache.org>; Sat,  5 Dec 2015 12:19:24 +0000 (UTC)
Received: (qmail 80396 invoked by uid 500); 5 Dec 2015 12:19:23 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 80321 invoked by uid 500); 5 Dec 2015 12:19:23 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 80311 invoked by uid 99); 5 Dec 2015 12:19:23 -0000
Received: from Unknown (HELO spamd1-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 05 Dec 2015 12:19:23 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd1-us-west.apache.org (ASF Mail Server at spamd1-us-west.apache.org) with ESMTP id C5229CD009
	for <dev@httpd.apache.org>; Sat,  5 Dec 2015 12:19:22 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd1-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.01
X-Spam-Level:
X-Spam-Status: No, score=-0.01 tagged_above=-999 required=6.31
	tests=[SPF_PASS=-0.001, T_RP_MATCHES_RCVD=-0.01, URIBL_BLOCKED=0.001]
	autolearn=disabled
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd1-us-west.apache.org [10.40.0.7]) (amavisd-new, port 10024)
	with ESMTP id r3IgC_sQkP4r for <dev@httpd.apache.org>;
	Sat,  5 Dec 2015 12:19:15 +0000 (UTC)
Received: from mail.netnea.com (gstserv.netnea.com [213.200.225.210])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id 9F1842059A
	for <dev@httpd.apache.org>; Sat,  5 Dec 2015 12:19:14 +0000 (UTC)
Received: from localhost (localhost [127.0.0.1])
	by mail.netnea.com (Postfix) with ESMTP id EDBCB4005A
	for <dev@httpd.apache.org>; Sat,  5 Dec 2015 13:19:07 +0100 (CET)
X-Virus-Scanned: Debian amavisd-new at neanet.com
Received: from mail.netnea.com ([127.0.0.1])
	by localhost (x28.netnea.com [127.0.0.1]) (amavisd-new, port 10024)
	with ESMTP id MX70sf5XscvM for <dev@httpd.apache.org>;
	Sat,  5 Dec 2015 13:19:07 +0100 (CET)
Received: from elias (unknown [93.94.243.179])
	(using TLSv1.2 with cipher ECDHE-RSA-AES256-GCM-SHA384 (256/256 bits))
	(Client did not present a certificate)
	by mail.netnea.com (Postfix) with ESMTPSA id C62B740057
	for <dev@httpd.apache.org>; Sat,  5 Dec 2015 13:19:07 +0100 (CET)
Received: by elias (Postfix, from userid 1000)
	id 3CE8C6407CC; Sat,  5 Dec 2015 13:19:07 +0100 (CET)
Date: Sat, 5 Dec 2015 13:19:07 +0100
From: Christian Folini <christian.folini@netnea.com>
To: dev@httpd.apache.org
Subject: Re: reverse proxy wishlist
Message-ID: <20151205121907.GA17459@elias>
References: <288293CD-6D82-42E0-BFC9-9DC25F969ED6@jaguNET.com>
 <22283CFB-00E5-4773-9BE8-52A2D020AEC5@c8h10n4o2.org.uk>
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8
Content-Disposition: inline
In-Reply-To: <22283CFB-00E5-4773-9BE8-52A2D020AEC5@c8h10n4o2.org.uk>
User-Agent: Mutt/1.5.21 (2010-09-15)

On Sat, Dec 05, 2015 at 11:01:54AM +0000, Tim Bannister wrote:
> ProxyErrorOverride is a good starting point. Often I want to let through only some error pages: the ones explicitly coded to be shown to this website's visitors. If the backend fails and produces an unstyled page of jargon and diagnostics, I want httpd to intervene.

I'd like to follow up on that. The last time I checked,
ProxyErrorOverride was silent in the logs. A notice- or warning-level
message when it intervenes would be helpful in many situations.  The
typical conversation around ProxyErrorOverride starts with "It's the
error page of the proxy, so the proxy must have caused the error." That
discussion could be cut short with a log message stating
~"ProxyErrorOverride applied after receiving status XXX from the
backend."
 
> The application could signal to httpd that its response has a user-friendly body via a special header.

I thought about this before. I think a more general, more flexible
approach would be very helpful. In the end it boils down to something 
like rewrite rules on the response.
You can to this with ModSecurity, but that is too late for 
ProxyErrorOverride AFAICT.

Ahoj,

Christian Folini

-- 
Christian Folini - <christian.folini@netnea.com>

From dev-return-84879-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Sat Dec  5 21:43:17 2015
Return-Path: <dev-return-84879-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 7560318B78
	for <apmail-httpd-dev-archive@www.apache.org>; Sat,  5 Dec 2015 21:43:17 +0000 (UTC)
Received: (qmail 89596 invoked by uid 500); 5 Dec 2015 21:43:04 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 89507 invoked by uid 500); 5 Dec 2015 21:43:04 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 89497 invoked by uid 99); 5 Dec 2015 21:43:04 -0000
Received: from Unknown (HELO spamd4-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 05 Dec 2015 21:43:04 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd4-us-west.apache.org (ASF Mail Server at spamd4-us-west.apache.org) with ESMTP id 08D58C1382
	for <dev@httpd.apache.org>; Sat,  5 Dec 2015 21:43:04 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd4-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 0.652
X-Spam-Level:
X-Spam-Status: No, score=0.652 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, SPF_NEUTRAL=0.652]
	autolearn=disabled
Authentication-Results: spamd4-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=comcast.net
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd4-us-west.apache.org [10.40.0.11]) (amavisd-new, port 10024)
	with ESMTP id PjmDjmE7osBx for <dev@httpd.apache.org>;
	Sat,  5 Dec 2015 21:42:49 +0000 (UTC)
Received: from resqmta-po-04v.sys.comcast.net (resqmta-po-04v.sys.comcast.net [96.114.154.163])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id 92F0C334EA
	for <dev@httpd.apache.org>; Sat,  5 Dec 2015 21:42:47 +0000 (UTC)
Received: from resomta-po-17v.sys.comcast.net ([96.114.154.241])
	by resqmta-po-04v.sys.comcast.net with comcast
	id pxib1r0085Clt1L01xieB5; Sat, 05 Dec 2015 21:42:38 +0000
Received: from [192.168.199.10] ([69.251.84.114])
	by resomta-po-17v.sys.comcast.net with comcast
	id pxid1r00J2U0RYt01xieYj; Sat, 05 Dec 2015 21:42:38 +0000
Content-Type: text/plain; charset=us-ascii
Mime-Version: 1.0 (Mac OS X Mail 9.1 \(3096.5\))
Subject: Re: NOTICE: Intent to T&R 2.4.18
From: Jim Jagielski <jim@jaguNET.com>
In-Reply-To: <43B47722-1E9C-45AE-9B8A-A7BBE8466201@greenbytes.de>
Date: Sat, 5 Dec 2015 16:42:37 -0500
Content-Transfer-Encoding: 7bit
Message-Id: <A56F00DC-9A93-4473-9DB8-817EA8F73BBF@jaguNET.com>
References: <D72D7108-D156-4B96-A136-0BD46E709438@jaguNET.com> <43B47722-1E9C-45AE-9B8A-A7BBE8466201@greenbytes.de>
To: httpd <dev@httpd.apache.org>
X-Mailer: Apple Mail (2.3096.5)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=comcast.net;
	s=q20140121; t=1449351758;
	bh=n5umpnSzT+71J5L0MnFH2u9eqt/HgYna3uRKEn6HE/U=;
	h=Received:Received:Content-Type:Mime-Version:Subject:From:Date:
	 Message-Id:To;
	b=nMnk3qokUFGDa384sN4i9fv34m32R6YdPbnIREpNiv5SQwKEA78s7GgBsJbHPREUa
	 f8wQXiV32o+PbEwpDHBk9gr9RhdVdZF/Fhy6ZghWaCctd40oPmXfzfK3nO/Ze6XL3q
	 GW9D+ptQT9OoThR9t9VBfjjM1mSWcMXnrxA9M+FX3ggJl4BodGZTk+YnmnotL49Eq5
	 rJBuUg8IabBBh28Zy0F4aqCPs7UjJO8Qhqup6QsbJLQPNTdCWtZgTudhxkj96QzIet
	 jkXAssz+9spKbsfsZw2zbIkm68R/e000Ojs2vxmnXJ+qi0BPYAu8cTJHXQLSoz+tfO
	 X+QsOTcdsT1wg==

With the latest patches, I think we are in good shape.
With that in mind, I plan to T&R on Tues (Dec 8)

From dev-return-84880-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Sat Dec  5 21:49:16 2015
Return-Path: <dev-return-84880-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 3A8BC18BA1
	for <apmail-httpd-dev-archive@www.apache.org>; Sat,  5 Dec 2015 21:49:16 +0000 (UTC)
Received: (qmail 98548 invoked by uid 500); 5 Dec 2015 21:49:15 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 98486 invoked by uid 500); 5 Dec 2015 21:49:15 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 98476 invoked by uid 99); 5 Dec 2015 21:49:15 -0000
Received: from Unknown (HELO spamd3-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 05 Dec 2015 21:49:15 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd3-us-west.apache.org (ASF Mail Server at spamd3-us-west.apache.org) with ESMTP id 489E31809A4
	for <dev@httpd.apache.org>; Sat,  5 Dec 2015 21:49:15 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd3-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 0.653
X-Spam-Level:
X-Spam-Status: No, score=0.653 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, SPF_NEUTRAL=0.652,
	URIBL_BLOCKED=0.001] autolearn=disabled
Authentication-Results: spamd3-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=comcast.net
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd3-us-west.apache.org [10.40.0.10]) (amavisd-new, port 10024)
	with ESMTP id vMgV62d3bf8z for <dev@httpd.apache.org>;
	Sat,  5 Dec 2015 21:49:03 +0000 (UTC)
Received: from resqmta-po-11v.sys.comcast.net (resqmta-po-11v.sys.comcast.net [96.114.154.170])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id 8CAEC42AA8
	for <dev@httpd.apache.org>; Sat,  5 Dec 2015 21:49:03 +0000 (UTC)
Received: from resomta-po-03v.sys.comcast.net ([96.114.154.227])
	by resqmta-po-11v.sys.comcast.net with comcast
	id pxov1r0024ueUHc01xowjF; Sat, 05 Dec 2015 21:48:56 +0000
Received: from [192.168.199.10] ([69.251.84.114])
	by resomta-po-03v.sys.comcast.net with comcast
	id pxow1r0022U0RYt01xows0; Sat, 05 Dec 2015 21:48:56 +0000
Content-Type: text/plain; charset=us-ascii
Mime-Version: 1.0 (Mac OS X Mail 9.1 \(3096.5\))
Subject: Re: reverse proxy wishlist
From: Jim Jagielski <jim@jaguNET.com>
In-Reply-To: <CACsi250w43S9-GLmPWeFAUS3wRte81tc=g3f5cWxLLf+Q7Mx5g@mail.gmail.com>
Date: Sat, 5 Dec 2015 16:48:55 -0500
Content-Transfer-Encoding: quoted-printable
Message-Id: <36B2DCA6-40CF-4FC7-B265-4927C24BE745@jaguNET.com>
References: <288293CD-6D82-42E0-BFC9-9DC25F969ED6@jaguNET.com> <CACsi250e5arsm+EzN1KDJMOD-vAmTyM8M0utTuEfedUGSUfXJw@mail.gmail.com> <77E6470A-4FAD-4DAD-BE9E-E11F54388E2C@jaguNET.com> <CACsi250wpsmUsC5kEWfJOAoYKHG28m2N6NrizHXsHFjU7_nVYQ@mail.gmail.com> <23420A92-4983-40B9-86FD-7B0681983601@jaguNET.com> <CACsi250w43S9-GLmPWeFAUS3wRte81tc=g3f5cWxLLf+Q7Mx5g@mail.gmail.com>
To: dev@httpd.apache.org
X-Mailer: Apple Mail (2.3096.5)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=comcast.net;
	s=q20140121; t=1449352137;
	bh=1sjDiKd1scC8QvTXkTpbeBQ1lSW5GuSmGIIRukWTp1M=;
	h=Received:Received:Content-Type:Mime-Version:Subject:From:Date:
	 Message-Id:To;
	b=enPClSsv/RNzvZjz/fJe6NrakXkWuRhpbluJprY77HHvkSmG+GYiXHgBxCfDbX1Co
	 SusWaWc90Oor7CXHZr0L7VyZpfy6oRlKna5WF+Lr5oO8RKDcq5XQA0abEn1mWKG+6e
	 zjnk3qkazDGGWYSs6ODe7Lz0C2CEJODB4j4q3+mimBkrBr9b2oLm8k34eZ6SnjmFS4
	 jVwJdE4f8hZ619myNitxaiGyJItYdOXRYNaSlfOM7B+8Jov3iDB6flswUqvInP3Fzb
	 wbBauIZKux7EfRuEJ3DRs3i7SHJkvMaIZSqszMd1mch+EPPjIDaUEKVoisoQ8cLnDv
	 Tl/Eye7ZRNjKg==


> On Dec 4, 2015, at 10:25 AM, William A Rowe Jr <wrowe@rowe-clan.net> =
wrote:
>=20
> My observation was that that the mapped pages for 2-6 fundamental =
socache, lbmethod or slotmem providers are the same as for a single =
module due to page alignment - load any two and you are already wasting =
kernel resources and memory.
>=20

Since you refer to these 3 modules, what to you recommend? That
we bundle all providers into 1 module? That's fine with me but
my point was that the whole idea of submodules and providers,
whether from us or not, was that the admin only needs to load
the ones they use. This recommendation seems to ignore this
basic advice.


From dev-return-84881-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Sat Dec  5 22:27:11 2015
Return-Path: <dev-return-84881-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 2CB1618C1E
	for <apmail-httpd-dev-archive@www.apache.org>; Sat,  5 Dec 2015 22:27:11 +0000 (UTC)
Received: (qmail 38274 invoked by uid 500); 5 Dec 2015 22:27:05 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 38183 invoked by uid 500); 5 Dec 2015 22:27:05 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 38173 invoked by uid 99); 5 Dec 2015 22:27:05 -0000
Received: from Unknown (HELO spamd4-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 05 Dec 2015 22:27:05 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd4-us-west.apache.org (ASF Mail Server at spamd4-us-west.apache.org) with ESMTP id 4FDFEC0FFE
	for <dev@httpd.apache.org>; Sat,  5 Dec 2015 22:27:05 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd4-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.654
X-Spam-Level:
X-Spam-Status: No, score=-0.654 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RP_MATCHES_RCVD=-0.554, SPF_PASS=-0.001, URIBL_BLOCKED=0.001]
	autolearn=disabled
Authentication-Results: spamd4-us-west.apache.org (amavisd-new);
	dkim=pass (1024-bit key) header.d=greenbytes.de
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd4-us-west.apache.org [10.40.0.11]) (amavisd-new, port 10024)
	with ESMTP id aB1u_dGLVzeX for <dev@httpd.apache.org>;
	Sat,  5 Dec 2015 22:26:57 +0000 (UTC)
Received: from mail.greenbytes.de (mail.greenbytes.de [217.91.35.233])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id D2DFE43A00
	for <dev@httpd.apache.org>; Sat,  5 Dec 2015 22:26:55 +0000 (UTC)
Received: from [192.168.0.130] (unknown [87.78.176.104])
	(using TLSv1 with cipher ECDHE-RSA-AES256-SHA (256/256 bits))
	(Client did not present a certificate)
	by mail.greenbytes.de (Postfix) with ESMTPSA id CA2B715A043A
	for <dev@httpd.apache.org>; Sat,  5 Dec 2015 23:26:47 +0100 (CET)
DKIM-Signature: v=1; a=rsa-sha256; c=simple/simple; d=greenbytes.de; s=mail;
	t=1449354407; bh=x59qPRWqr5OLBC3OKDyHfs0FG5oGx1inOWjsrjDWebQ=;
	h=From:Subject:Date:References:In-Reply-To:To:From;
	b=AQe8Lg1s1CEd+2yGovNyUT0JrUBtnCIQeIdAXj1lWZuDudOZckkLKmvK1b6kZHQnd
	 fLjXFFbWBs09dmtA5A+sOTc2f+i6ZjSiyHk82Xkj9YWnLOKL7usbpXFZMID0SrnRzM
	 8dzyC8QrLaTW76NwzjTPKuncqrx62qq60Ht6PE90=
From: Stefan Eissing <stefan.eissing@greenbytes.de>
Content-Type: text/plain;
	charset=us-ascii
Content-Transfer-Encoding: quoted-printable
Mime-Version: 1.0 (1.0)
Subject: Re: NOTICE: Intent to T&R 2.4.18
Message-Id: <A897D925-E81B-48C4-A7AC-7004AB52B9D0@greenbytes.de>
Date: Sat, 5 Dec 2015 23:26:47 +0100
References: <D72D7108-D156-4B96-A136-0BD46E709438@jaguNET.com> <43B47722-1E9C-45AE-9B8A-A7BBE8466201@greenbytes.de> <A56F00DC-9A93-4473-9DB8-817EA8F73BBF@jaguNET.com>
In-Reply-To: <A56F00DC-9A93-4473-9DB8-817EA8F73BBF@jaguNET.com>
To: dev@httpd.apache.org
X-Mailer: iPhone Mail (13B143)

Excellent! I have one proposed backport regarding ssl vars and slave connect=
ions. If someone finds the time to look at it, that'd be great. It makes htt=
p2 work better with var checks for HTTPS in .htaccess files.

> Am 05.12.2015 um 22:42 schrieb Jim Jagielski <jim@jaguNET.com>:
>=20
> With the latest patches, I think we are in good shape.
> With that in mind, I plan to T&R on Tues (Dec 8)

From dev-return-84882-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Sun Dec  6 00:35:07 2015
Return-Path: <dev-return-84882-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id A589618F79
	for <apmail-httpd-dev-archive@www.apache.org>; Sun,  6 Dec 2015 00:35:07 +0000 (UTC)
Received: (qmail 42929 invoked by uid 500); 6 Dec 2015 00:35:06 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 42847 invoked by uid 500); 6 Dec 2015 00:35:06 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 42837 invoked by uid 99); 6 Dec 2015 00:35:06 -0000
Received: from Unknown (HELO spamd3-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 06 Dec 2015 00:35:06 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd3-us-west.apache.org (ASF Mail Server at spamd3-us-west.apache.org) with ESMTP id 6E77B180A34
	for <dev@httpd.apache.org>; Sun,  6 Dec 2015 00:35:06 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd3-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.554
X-Spam-Level:
X-Spam-Status: No, score=-0.554 tagged_above=-999 required=6.31
	tests=[HEADER_FROM_DIFFERENT_DOMAINS=0.001, RP_MATCHES_RCVD=-0.554,
	SPF_HELO_PASS=-0.001] autolearn=disabled
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd3-us-west.apache.org [10.40.0.10]) (amavisd-new, port 10024)
	with ESMTP id 0rt2x_g5ksC9 for <dev@httpd.apache.org>;
	Sun,  6 Dec 2015 00:35:02 +0000 (UTC)
Received: from plane.gmane.org (plane.gmane.org [80.91.229.3])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id 9202821195
	for <dev@httpd.apache.org>; Sun,  6 Dec 2015 00:35:01 +0000 (UTC)
Received: from list by plane.gmane.org with local (Exim 4.69)
	(envelope-from <apache-dev@m.gmane.org>)
	id 1a5NI3-00030t-Be
	for dev@httpd.apache.org; Sun, 06 Dec 2015 01:34:59 +0100
Received: from ip-213-127-155-185.ip.prioritytelecom.net ([213.127.155.185])
        by main.gmane.org with esmtp (Gmexim 0.1 (Debian))
        id 1AlnuQ-0007hv-00
        for <dev@httpd.apache.org>; Sun, 06 Dec 2015 01:34:59 +0100
Received: from phpdev by ip-213-127-155-185.ip.prioritytelecom.net with local (Gmexim 0.1 (Debian))
        id 1AlnuQ-0007hv-00
        for <dev@httpd.apache.org>; Sun, 06 Dec 2015 01:34:59 +0100
X-Injected-Via-Gmane: http://gmane.org/
To: dev@httpd.apache.org
From: Jan Ehrhardt <phpdev@ehrhardt.nl>
Subject: Re: No H2 Window updates!
Date: Sun, 06 Dec 2015 01:34:47 +0100
Lines: 34
Message-ID: <unu66bptvbt2o9g4po12md8mdsleho74fc@4ax.com>
References: <CACsi253Egm-K71wTd5Ff3gD6AFdhAgm1pHXafE5Kobzb4WejBQ@mail.gmail.com> <bqdr5blheuoccudj4sc7jql6e4dn8furd9@4ax.com> <1D08ECCD-A26B-4D3D-8F12-BE97018059B7@greenbytes.de> <043901d12e34$34d311c0$9e793540$@qqmail.nl> <10770C7F-5C8D-42EB-9E76-DC91160FDA89@greenbytes.de> <045e01d12e79$493fe620$dbbfb260$@qqmail.nl> <039D4360-8E2F-455D-8CC2-8405FC7FC272@greenbytes.de> <1jr36b5oa182lb9mupjfm6st4o9qbbr78o@4ax.com> <DA07528F-19ED-44AD-BBDA-DE3301F9F9EC@greenbytes.de>
Mime-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Complaints-To: usenet@ger.gmane.org
X-Gmane-NNTP-Posting-Host: ip-213-127-155-185.ip.prioritytelecom.net
X-Newsreader: Forte Agent 3.3/32.846

Stefan Eissing in gmane.comp.apache.devel (Fri, 4 Dec 2015 21:37:46
+0100):
>> 
>> 1.0.10 did not solve my problems with the admin menu in Drupal7. Sorry.
>
>Do you have any advice how to reproduce the problem, so that I might see
>what it is? I am not familiar with drupal7, unfortunately. 

I finally found out how it goes wrong. The admin menu is a compressed file
of 16899 bytes, which should be decoded into something of 216000+ html
content.

With mod_http2 1.0.7+ Chrome bails out with a ERR_CONTENT_DECODING_FAILED.
See the logs:

GET /js/admin_menu/cache/53b57aa88f09fd5f75ccfb325815c700 HTTP/1.1" 200
16899 "-"
GET /js/admin_menu/cache/53b57aa88f09fd5f75ccfb325815c700 HTTP/2" 200
16899 "-"

The second one was directly after restarting the server with mod_http2
1.0.7. mod_http2 1.0.5 does not have this problem.

I do not know yet how and where it goes wrong. Something between v1.0.5
and v1.0.7 changed that causes a ERR_CONTENT_DECODING_FAILED.

I will try to intercept the compressed content and see if I can make a
static page out of it, outside of Drupal and without having to log in as
Drupal admin.

Stefan: ERR_CONTENT_DECODING_FAILED is the most informative info I can
give you at the moment.
-- 
Jan


From dev-return-84883-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Sun Dec  6 02:30:44 2015
Return-Path: <dev-return-84883-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 54B1918199
	for <apmail-httpd-dev-archive@www.apache.org>; Sun,  6 Dec 2015 02:30:44 +0000 (UTC)
Received: (qmail 48613 invoked by uid 500); 6 Dec 2015 02:30:43 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 48543 invoked by uid 500); 6 Dec 2015 02:30:43 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 48533 invoked by uid 99); 6 Dec 2015 02:30:43 -0000
Received: from Unknown (HELO spamd4-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 06 Dec 2015 02:30:43 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd4-us-west.apache.org (ASF Mail Server at spamd4-us-west.apache.org) with ESMTP id 23472C0FFE
	for <dev@httpd.apache.org>; Sun,  6 Dec 2015 02:30:43 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd4-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 3
X-Spam-Level: ***
X-Spam-Status: No, score=3 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, HTML_MESSAGE=3,
	SPF_PASS=-0.001, URIBL_BLOCKED=0.001] autolearn=disabled
Authentication-Results: spamd4-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=rowe-clan-net.20150623.gappssmtp.com
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd4-us-west.apache.org [10.40.0.11]) (amavisd-new, port 10024)
	with ESMTP id CPgy1WlfNnvq for <dev@httpd.apache.org>;
	Sun,  6 Dec 2015 02:30:33 +0000 (UTC)
Received: from mail-io0-f174.google.com (mail-io0-f174.google.com [209.85.223.174])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id DE2F620BD8
	for <dev@httpd.apache.org>; Sun,  6 Dec 2015 02:30:32 +0000 (UTC)
Received: by ioc74 with SMTP id 74so151308113ioc.2
        for <dev@httpd.apache.org>; Sat, 05 Dec 2015 18:30:26 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=rowe-clan-net.20150623.gappssmtp.com; s=20150623;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        bh=pyuCfYpuPT9IvSVfX8rXF0ogYS/ITLXU6G4ZnkjyUIk=;
        b=Hhx3S+vZitDyC0UdCPicEXN4QKMEMH/IAFL7le2HlvycgVITfQEISBRalZWCb3oqjH
         hSlgBeWxa1SSsRE7B/Bo2MZ2PupQPlnExNRKK+t4hhHoBm5yyMqsuEArPlXjGQOxYZZV
         uDaZNuEr6eXkpMYXFpihClKCe/LA70yh7WjrDQ23CUTRaEfThDmEEMLIU50kGVhIguqi
         5M0RKqry6nPUXK0vQ+oJR9YeHcVWBfc8JJHf8CyqLWRVHWVLK5ket59YDo16XqoiPQV0
         C2rtcyzAr8wCVjERSJ8PvwH9e696MTH3pmpbYBIS+xkE7DazGIWhDHZPH4BCXuPFhfSI
         bWpw==
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=1e100.net; s=20130820;
        h=x-gm-message-state:mime-version:in-reply-to:references:date
         :message-id:subject:from:to:content-type;
        bh=pyuCfYpuPT9IvSVfX8rXF0ogYS/ITLXU6G4ZnkjyUIk=;
        b=BF3tFmI2fjQbd4Ic5zV///7ptJKlpFHResqMT3917WCRdL9CmeRGIDzu331sXOoNGo
         6eRye/06M7QFu2kUCpMTlLegVWxIMOxU9f4mV8BSWwmUxiMiijtkEwWGmAcKWo7s2u8g
         QVkMxmUUnv4thVyoxTg0bABkn26OfuL2ySUWEafBM1ifZY6nFla97xatq4jQg5bbdXLp
         0nywqjNKP/dfjA3vmyfLqcmo/01PdgkbIERbZBGsMRzCzh85hCY45K8vWTiLguk4D6Cg
         dzbfD75+5eQ32gE7ZPEZlcZaoipWoigk36TZs9oJXz3XDzmkX4c+quCIl7/0WKSgExOs
         3P7Q==
X-Gm-Message-State: ALoCoQnF0IjEaK1eg2T/lFwJ+0wyuXJfxzgfDQEvrndwdqXHBKJWhjc2tDAZxVPRGsExYbOOoGU7
MIME-Version: 1.0
X-Received: by 10.107.156.6 with SMTP id f6mr20401203ioe.163.1449369026426;
 Sat, 05 Dec 2015 18:30:26 -0800 (PST)
Received: by 10.107.62.136 with HTTP; Sat, 5 Dec 2015 18:30:26 -0800 (PST)
In-Reply-To: <36B2DCA6-40CF-4FC7-B265-4927C24BE745@jaguNET.com>
References: <288293CD-6D82-42E0-BFC9-9DC25F969ED6@jaguNET.com>
	<CACsi250e5arsm+EzN1KDJMOD-vAmTyM8M0utTuEfedUGSUfXJw@mail.gmail.com>
	<77E6470A-4FAD-4DAD-BE9E-E11F54388E2C@jaguNET.com>
	<CACsi250wpsmUsC5kEWfJOAoYKHG28m2N6NrizHXsHFjU7_nVYQ@mail.gmail.com>
	<23420A92-4983-40B9-86FD-7B0681983601@jaguNET.com>
	<CACsi250w43S9-GLmPWeFAUS3wRte81tc=g3f5cWxLLf+Q7Mx5g@mail.gmail.com>
	<36B2DCA6-40CF-4FC7-B265-4927C24BE745@jaguNET.com>
Date: Sat, 5 Dec 2015 20:30:26 -0600
Message-ID: <CACsi250R8eSyv4XTTcj3J-h9vAebEtmgGWyXDJ3=K1RWOqf8cw@mail.gmail.com>
Subject: Re: reverse proxy wishlist
From: William A Rowe Jr <wrowe@rowe-clan.net>
To: httpd <dev@httpd.apache.org>
Content-Type: multipart/alternative; boundary=001a1140ccc0f80e4c052631858f

--001a1140ccc0f80e4c052631858f
Content-Type: text/plain; charset=UTF-8

On Sat, Dec 5, 2015 at 3:48 PM, Jim Jagielski <jim@jagunet.com> wrote:

>
> > On Dec 4, 2015, at 10:25 AM, William A Rowe Jr <wrowe@rowe-clan.net>
> wrote:
> >
> > My observation was that that the mapped pages for 2-6 fundamental
> socache, lbmethod or slotmem providers are the same as for a single module
> due to page alignment - load any two and you are already wasting kernel
> resources and memory.
> >
>
> Since you refer to these 3 modules, what to you recommend? That
> we bundle all providers into 1 module? That's fine with me but
> my point was that the whole idea of submodules and providers,
> whether from us or not, was that the admin only needs to load
> the ones they use. This recommendation seems to ignore this
> basic advice.
>

That advise always applies if the module interacts with the user-agent.

I just finished pointing out that only the admin causes httpd to interact
with different socache, lbmethod or slotmem providers.  The modules
of each group combined, while appearing larger are going to occupy
the same space all together in the paging schema as any one module
alone.  So merging the 'core' providers into a single module is a win
for each admin who is using two or more mechanisms, and net-net
null for any admin who consumes only one.  Those who don't use
the facility at all need not load even these core groups.

--001a1140ccc0f80e4c052631858f
Content-Type: text/html; charset=UTF-8
Content-Transfer-Encoding: quoted-printable

<div dir=3D"ltr"><div class=3D"gmail_extra"><div class=3D"gmail_quote">On S=
at, Dec 5, 2015 at 3:48 PM, Jim Jagielski <span dir=3D"ltr">&lt;<a href=3D"=
mailto:jim@jagunet.com" target=3D"_blank">jim@jagunet.com</a>&gt;</span> wr=
ote:<br><blockquote class=3D"gmail_quote" style=3D"margin:0 0 0 .8ex;border=
-left:1px #ccc solid;padding-left:1ex"><span class=3D""><br>
&gt; On Dec 4, 2015, at 10:25 AM, William A Rowe Jr &lt;<a href=3D"mailto:w=
rowe@rowe-clan.net">wrowe@rowe-clan.net</a>&gt; wrote:<br>
&gt;<br>
&gt; My observation was that that the mapped pages for 2-6 fundamental soca=
che, lbmethod or slotmem providers are the same as for a single module due =
to page alignment - load any two and you are already wasting kernel resourc=
es and memory.<br>
&gt;<br>
<br>
</span>Since you refer to these 3 modules, what to you recommend? That<br>
we bundle all providers into 1 module? That&#39;s fine with me but<br>
my point was that the whole idea of submodules and providers,<br>
whether from us or not, was that the admin only needs to load<br>
the ones they use. This recommendation seems to ignore this<br>
basic advice.<br></blockquote><div><br></div><div>That advise always applie=
s if the module interacts with the user-agent.</div><div><br></div><div>I j=
ust finished pointing out that only the admin causes httpd to interact</div=
><div>with different socache, lbmethod or slotmem providers.=C2=A0 The modu=
les</div><div>of each group combined, while appearing larger are going to o=
ccupy=C2=A0</div><div>the same space all together in the paging schema as a=
ny one module</div><div>alone.=C2=A0 So merging the &#39;core&#39; provider=
s into a single module is a win</div><div>for each admin who is using two o=
r more mechanisms, and net-net</div><div>null for any admin who consumes on=
ly one.=C2=A0 Those who don&#39;t use</div><div>the facility at all need no=
t load even these core groups.</div><div><br></div><div><br></div><div><br>=
</div><div>=C2=A0</div></div><br></div></div>

--001a1140ccc0f80e4c052631858f--

From dev-return-84884-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Sun Dec  6 03:44:54 2015
Return-Path: <dev-return-84884-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id D7218182D5
	for <apmail-httpd-dev-archive@www.apache.org>; Sun,  6 Dec 2015 03:44:54 +0000 (UTC)
Received: (qmail 99396 invoked by uid 500); 6 Dec 2015 03:44:49 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 99327 invoked by uid 500); 6 Dec 2015 03:44:49 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 99317 invoked by uid 99); 6 Dec 2015 03:44:49 -0000
Received: from Unknown (HELO spamd4-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 06 Dec 2015 03:44:49 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd4-us-west.apache.org (ASF Mail Server at spamd4-us-west.apache.org) with ESMTP id 99295C14A5
	for <dev@httpd.apache.org>; Sun,  6 Dec 2015 03:44:48 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd4-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.554
X-Spam-Level:
X-Spam-Status: No, score=-0.554 tagged_above=-999 required=6.31
	tests=[HEADER_FROM_DIFFERENT_DOMAINS=0.001, RP_MATCHES_RCVD=-0.554,
	SPF_HELO_PASS=-0.001, SPF_PASS=-0.001, URIBL_BLOCKED=0.001]
	autolearn=disabled
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd4-us-west.apache.org [10.40.0.11]) (amavisd-new, port 10024)
	with ESMTP id AYRoCLuSnMHw for <dev@httpd.apache.org>;
	Sun,  6 Dec 2015 03:44:41 +0000 (UTC)
Received: from plane.gmane.org (plane.gmane.org [80.91.229.3])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id B069F42AD4
	for <dev@httpd.apache.org>; Sun,  6 Dec 2015 03:44:40 +0000 (UTC)
Received: from list by plane.gmane.org with local (Exim 4.69)
	(envelope-from <apache-dev@m.gmane.org>)
	id 1a5QFT-0007t8-Fz
	for dev@httpd.apache.org; Sun, 06 Dec 2015 04:44:31 +0100
Received: from 227-116.citynet.ftth.internl.net ([85.223.116.227])
        by main.gmane.org with esmtp (Gmexim 0.1 (Debian))
        id 1AlnuQ-0007hv-00
        for <dev@httpd.apache.org>; Sun, 06 Dec 2015 04:44:31 +0100
Received: from phpdev by 227-116.citynet.ftth.internl.net with local (Gmexim 0.1 (Debian))
        id 1AlnuQ-0007hv-00
        for <dev@httpd.apache.org>; Sun, 06 Dec 2015 04:44:31 +0100
X-Injected-Via-Gmane: http://gmane.org/
To: dev@httpd.apache.org
From: Jan Ehrhardt <phpdev@ehrhardt.nl>
Subject: mod_http2 1.0.7+ and Drupal (Was: No H2 Window updates!)
Date: Sun, 06 Dec 2015 04:44:23 +0100
Lines: 61
Message-ID: <v3976b5hieisv5eft645gcp5lrc77gser7@4ax.com>
References: <bqdr5blheuoccudj4sc7jql6e4dn8furd9@4ax.com> <1D08ECCD-A26B-4D3D-8F12-BE97018059B7@greenbytes.de> <043901d12e34$34d311c0$9e793540$@qqmail.nl> <10770C7F-5C8D-42EB-9E76-DC91160FDA89@greenbytes.de> <045e01d12e79$493fe620$dbbfb260$@qqmail.nl> <039D4360-8E2F-455D-8CC2-8405FC7FC272@greenbytes.de> <1jr36b5oa182lb9mupjfm6st4o9qbbr78o@4ax.com> <DA07528F-19ED-44AD-BBDA-DE3301F9F9EC@greenbytes.de> <unu66bptvbt2o9g4po12md8mdsleho74fc@4ax.com>
Mime-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Complaints-To: usenet@ger.gmane.org
X-Gmane-NNTP-Posting-Host: 227-116.citynet.ftth.internl.net
X-Newsreader: Forte Agent 3.3/32.846

Some words for sysadmins: this is a rather annoying bug because there is
not any sign in the logs that the client has a content decoding failure.
You can never be sure that the user gets to see what the server sends to
the client.

Jan Ehrhardt in gmane.comp.apache.devel (Sun, 06 Dec 2015 01:34:47 +0100):
>I will try to intercept the compressed content and see if I can make a
>static page out of it, outside of Drupal and without having to log in as
>Drupal admin.

If content decoding is successful, Chrome stores the compressed content in
the cache. I saved such a file as admin_menu_encoded.txt.gz and made it
available as https://tfrtst.sessionportal.net/admin_menu_encoded.php

PHP-script:

<?php
// open the file in a binary mode
$name = './admin_menu_encoded.txt.gz';
$fp = fopen($name, 'rb');
// send the right headers
header("Content-Type: text/html; charset=utf-8");
// admin_menu_encoded.txt.gz is already gzip'ed, so make sure
// zlib.output_compression does not compress it once more.
ini_set('zlib.output_compression', '0');
header('Content-Encoding: gzip');
header("Cache-Control: no-cache, must-revalidate, post-check=0,
pre-check=0");
header("Content-Length: " . filesize($name));
// dump the file and stop the script
fpassthru($fp);
exit;
?>

The bummer: this file does not fail, whichever mod_http2 I load. Firefox
also fails with mod_http2 1.0.7+ and gives some extra information in the
headers:

X-Requested-With: XMLHttpRequest

The explanation: the drupal admin menu is loaded by JQuery, using an
Ajax-call. The return value of that call is (1) decoded (gunzipped) and
(2) loaded in a <div id="admin-menu"> almost at the end of the page.

Yet that Ajax call is not the culprit either. If I enter the URL of the
admin-menu directly Chrome reports a ERR_CONTENT_DECODING_FAILED and
Firefox:

>Content Encoding Error
>
>The page you are trying to view cannot be shown because
>it uses an invalid or unsupported form of compression.
>
>Please contact the website owners to inform them of this problem.

You will not see this message when the admin menu is loaded by JQuery.

So far the analysis at this moment. I do not know what I could investigate
now. Suggestions welcome.
-- 
Jan


From dev-return-84885-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Sun Dec  6 04:48:00 2015
Return-Path: <dev-return-84885-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id A05061838D
	for <apmail-httpd-dev-archive@www.apache.org>; Sun,  6 Dec 2015 04:48:00 +0000 (UTC)
Received: (qmail 46705 invoked by uid 500); 6 Dec 2015 04:48:00 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 46634 invoked by uid 500); 6 Dec 2015 04:48:00 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 46623 invoked by uid 99); 6 Dec 2015 04:48:00 -0000
Received: from Unknown (HELO spamd1-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 06 Dec 2015 04:48:00 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd1-us-west.apache.org (ASF Mail Server at spamd1-us-west.apache.org) with ESMTP id 7D098C8CAA
	for <dev@httpd.apache.org>; Sun,  6 Dec 2015 04:47:59 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd1-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.01
X-Spam-Level:
X-Spam-Status: No, score=-0.01 tagged_above=-999 required=6.31
	tests=[HEADER_FROM_DIFFERENT_DOMAINS=0.001, SPF_HELO_PASS=-0.001,
	SPF_PASS=-0.001, T_RP_MATCHES_RCVD=-0.01, URIBL_BLOCKED=0.001]
	autolearn=disabled
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd1-us-west.apache.org [10.40.0.7]) (amavisd-new, port 10024)
	with ESMTP id 45GL6TOyH2IV for <dev@httpd.apache.org>;
	Sun,  6 Dec 2015 04:47:51 +0000 (UTC)
Received: from plane.gmane.org (plane.gmane.org [80.91.229.3])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id 1EFAD21275
	for <dev@httpd.apache.org>; Sun,  6 Dec 2015 04:47:50 +0000 (UTC)
Received: from list by plane.gmane.org with local (Exim 4.69)
	(envelope-from <apache-dev@m.gmane.org>)
	id 1a5REj-0001ZM-Sh
	for dev@httpd.apache.org; Sun, 06 Dec 2015 05:47:49 +0100
Received: from 227-116.citynet.ftth.internl.net ([85.223.116.227])
        by main.gmane.org with esmtp (Gmexim 0.1 (Debian))
        id 1AlnuQ-0007hv-00
        for <dev@httpd.apache.org>; Sun, 06 Dec 2015 05:47:49 +0100
Received: from phpdev by 227-116.citynet.ftth.internl.net with local (Gmexim 0.1 (Debian))
        id 1AlnuQ-0007hv-00
        for <dev@httpd.apache.org>; Sun, 06 Dec 2015 05:47:49 +0100
X-Injected-Via-Gmane: http://gmane.org/
To: dev@httpd.apache.org
From: Jan Ehrhardt <phpdev@ehrhardt.nl>
Subject: Re: mod_http2 1.0.7+ and Drupal (Was: No H2 Window updates!)
Date: Sun, 06 Dec 2015 05:47:43 +0100
Lines: 56
Message-ID: <qie76b9kq4s5f2vsk1tjo77gcis74vr685@4ax.com>
References: <bqdr5blheuoccudj4sc7jql6e4dn8furd9@4ax.com> <1D08ECCD-A26B-4D3D-8F12-BE97018059B7@greenbytes.de> <043901d12e34$34d311c0$9e793540$@qqmail.nl> <10770C7F-5C8D-42EB-9E76-DC91160FDA89@greenbytes.de> <045e01d12e79$493fe620$dbbfb260$@qqmail.nl> <039D4360-8E2F-455D-8CC2-8405FC7FC272@greenbytes.de> <1jr36b5oa182lb9mupjfm6st4o9qbbr78o@4ax.com> <DA07528F-19ED-44AD-BBDA-DE3301F9F9EC@greenbytes.de> <unu66bptvbt2o9g4po12md8mdsleho74fc@4ax.com> <v3976b5hieisv5eft645gcp5lrc77gser7@4ax.com>
Mime-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Complaints-To: usenet@ger.gmane.org
X-Gmane-NNTP-Posting-Host: 227-116.citynet.ftth.internl.net
X-Newsreader: Forte Agent 3.3/32.846

Jan Ehrhardt in gmane.comp.apache.devel (Sun, 06 Dec 2015 04:44:23 +0100):
>So far the analysis at this moment. I do not know what I could investigate
>now. Suggestions welcome.

Found the difference!

mod_http2 1.0.5 response headers

Cache-Control: private, max-age=31536000
Content-Encoding: gzip
Content-Language: en
Content-Type: text/html; charset=utf-8
Date: Sun, 06 Dec 2015 04:25:44 GMT
Etag: "1449375944-1"
Expires: Mon, 05 Dec 2016 04:25:44 +0000
Last-Modified: Sun, 06 Dec 2015 04:25:44 GMT
Server: Apache/2.4.18-dev (Win32) OpenSSL/1.0.2e-fips mod_fcgid/2.3.9
Strict-Transport-Security: max-age=31536000
Vary: Cookie,Accept-Encoding
X-Content-Type-Options: nosniff
X-Drupal-Cache: MISS
X-Firefox-Spdy: h2
x-powered-by: PHP/5.6.16

mod_http2 1.0.7 response headers

Cache-Control: private, max-age=31536000, private, max-age=31536000
Content-Encoding: gzip, gzip
Content-Language: en, en
Content-Type: text/html; charset=utf-8
Date: Sun, 06 Dec 2015 04:29:09 GMT
Etag: "1449376149-1"
Expires: Mon, 05 Dec 2016 04:29:09 +0000, Mon, 05 Dec 2016 04:29:09 +0000
Last-Modified: Sun, 06 Dec 2015 04:29:09 GMT
Server: Apache/2.4.18-dev (Win32) OpenSSL/1.0.2e-fips mod_fcgid/2.3.9
Strict-Transport-Security: max-age=31536000, max-age=31536000
Vary: Cookie,Accept-Encoding
X-Content-Type-Options: nosniff, nosniff
X-Drupal-Cache: MISS, MISS
X-Firefox-Spdy: h2
x-powered-by: PHP/5.6.16, PHP/5.6.16

Some arguments are duplicated. And 'Content-Encoding: gzip, gzip' is
causing the content decoding error.

Something in mod_http2 1.0.7+ is duplicating the arguments in the headers.
But not always, because it does not duplicate them in
https://tfrtst.sessionportal.net/admin_menu_encoded.php

Jan

BTW. Firefox was also complaining about the double argument in the
Strict-Transport-Security header:

>Strict-Transport-Security: The site specified a header that could
>not be parsed successfully.


From dev-return-84886-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Sun Dec  6 05:12:01 2015
Return-Path: <dev-return-84886-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 9076A183CF
	for <apmail-httpd-dev-archive@www.apache.org>; Sun,  6 Dec 2015 05:12:01 +0000 (UTC)
Received: (qmail 56329 invoked by uid 500); 6 Dec 2015 05:12:01 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 56257 invoked by uid 500); 6 Dec 2015 05:12:00 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 56247 invoked by uid 99); 6 Dec 2015 05:12:00 -0000
Received: from Unknown (HELO spamd4-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 06 Dec 2015 05:12:00 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd4-us-west.apache.org (ASF Mail Server at spamd4-us-west.apache.org) with ESMTP id 59F10C103E
	for <dev@httpd.apache.org>; Sun,  6 Dec 2015 05:12:00 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd4-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.554
X-Spam-Level:
X-Spam-Status: No, score=-0.554 tagged_above=-999 required=6.31
	tests=[HEADER_FROM_DIFFERENT_DOMAINS=0.001, RP_MATCHES_RCVD=-0.554,
	SPF_HELO_PASS=-0.001, SPF_PASS=-0.001, URIBL_BLOCKED=0.001]
	autolearn=disabled
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd4-us-west.apache.org [10.40.0.11]) (amavisd-new, port 10024)
	with ESMTP id tp-BqR3dLE92 for <dev@httpd.apache.org>;
	Sun,  6 Dec 2015 05:11:52 +0000 (UTC)
Received: from plane.gmane.org (plane.gmane.org [80.91.229.3])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id AFB0120C64
	for <dev@httpd.apache.org>; Sun,  6 Dec 2015 05:11:51 +0000 (UTC)
Received: from list by plane.gmane.org with local (Exim 4.69)
	(envelope-from <apache-dev@m.gmane.org>)
	id 1a5Rbx-0002Rc-0R
	for dev@httpd.apache.org; Sun, 06 Dec 2015 06:11:49 +0100
Received: from 227-116.citynet.ftth.internl.net ([85.223.116.227])
        by main.gmane.org with esmtp (Gmexim 0.1 (Debian))
        id 1AlnuQ-0007hv-00
        for <dev@httpd.apache.org>; Sun, 06 Dec 2015 06:11:48 +0100
Received: from phpdev by 227-116.citynet.ftth.internl.net with local (Gmexim 0.1 (Debian))
        id 1AlnuQ-0007hv-00
        for <dev@httpd.apache.org>; Sun, 06 Dec 2015 06:11:48 +0100
X-Injected-Via-Gmane: http://gmane.org/
To: dev@httpd.apache.org
From: Jan Ehrhardt <phpdev@ehrhardt.nl>
Subject: Re: NOTICE: Intent to T&R 2.4.18
Date: Sun, 06 Dec 2015 06:11:43 +0100
Lines: 9
Message-ID: <ugg76bl3t7j3cdvdb9mlft26sbd35ighhe@4ax.com>
References: <D72D7108-D156-4B96-A136-0BD46E709438@jaguNET.com> <43B47722-1E9C-45AE-9B8A-A7BBE8466201@greenbytes.de> <A56F00DC-9A93-4473-9DB8-817EA8F73BBF@jaguNET.com>
Mime-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Complaints-To: usenet@ger.gmane.org
X-Gmane-NNTP-Posting-Host: 227-116.citynet.ftth.internl.net
X-Newsreader: Forte Agent 3.3/32.846

Jim Jagielski in gmane.comp.apache.devel (Sat, 5 Dec 2015 16:42:37 -0500):
>With the latest patches, I think we are in good shape.
>With that in mind, I plan to T&R on Tues (Dec 8)

I would not do that, unless
http://thread.gmane.org/gmane.comp.apache.devel/57728/focus=57827
is solved before Tuesday.
-- 
Jan


From dev-return-84887-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Sun Dec  6 06:22:22 2015
Return-Path: <dev-return-84887-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 55A6018495
	for <apmail-httpd-dev-archive@www.apache.org>; Sun,  6 Dec 2015 06:22:22 +0000 (UTC)
Received: (qmail 26474 invoked by uid 500); 6 Dec 2015 06:22:21 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 26401 invoked by uid 500); 6 Dec 2015 06:22:21 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 26391 invoked by uid 99); 6 Dec 2015 06:22:21 -0000
Received: from Unknown (HELO spamd1-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 06 Dec 2015 06:22:21 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd1-us-west.apache.org (ASF Mail Server at spamd1-us-west.apache.org) with ESMTP id 6FA52C8CE2
	for <dev@httpd.apache.org>; Sun,  6 Dec 2015 06:22:21 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd1-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.01
X-Spam-Level:
X-Spam-Status: No, score=-0.01 tagged_above=-999 required=6.31
	tests=[HEADER_FROM_DIFFERENT_DOMAINS=0.001, SPF_HELO_PASS=-0.001,
	SPF_PASS=-0.001, T_RP_MATCHES_RCVD=-0.01, URIBL_BLOCKED=0.001]
	autolearn=disabled
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd1-us-west.apache.org [10.40.0.7]) (amavisd-new, port 10024)
	with ESMTP id nrEjfdCDf6tw for <dev@httpd.apache.org>;
	Sun,  6 Dec 2015 06:22:08 +0000 (UTC)
Received: from plane.gmane.org (plane.gmane.org [80.91.229.3])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id 2979D20C64
	for <dev@httpd.apache.org>; Sun,  6 Dec 2015 06:22:07 +0000 (UTC)
Received: from list by plane.gmane.org with local (Exim 4.69)
	(envelope-from <apache-dev@m.gmane.org>)
	id 1a5Shy-0006ml-U0
	for dev@httpd.apache.org; Sun, 06 Dec 2015 07:22:06 +0100
Received: from 227-116.citynet.ftth.internl.net ([85.223.116.227])
        by main.gmane.org with esmtp (Gmexim 0.1 (Debian))
        id 1AlnuQ-0007hv-00
        for <dev@httpd.apache.org>; Sun, 06 Dec 2015 07:22:06 +0100
Received: from phpdev by 227-116.citynet.ftth.internl.net with local (Gmexim 0.1 (Debian))
        id 1AlnuQ-0007hv-00
        for <dev@httpd.apache.org>; Sun, 06 Dec 2015 07:22:06 +0100
X-Injected-Via-Gmane: http://gmane.org/
To: dev@httpd.apache.org
From: Jan Ehrhardt <phpdev@ehrhardt.nl>
Subject: Re: No H2 Window updates!
Date: Sun, 06 Dec 2015 07:21:49 +0100
Lines: 22
Message-ID: <4hk76bllai2epissk4lbjghj31jmnf03mr@4ax.com>
References: <CACsi253Egm-K71wTd5Ff3gD6AFdhAgm1pHXafE5Kobzb4WejBQ@mail.gmail.com> <bqdr5blheuoccudj4sc7jql6e4dn8furd9@4ax.com> <1D08ECCD-A26B-4D3D-8F12-BE97018059B7@greenbytes.de> <043901d12e34$34d311c0$9e793540$@qqmail.nl> <10770C7F-5C8D-42EB-9E76-DC91160FDA89@greenbytes.de> <045e01d12e79$493fe620$dbbfb260$@qqmail.nl> <039D4360-8E2F-455D-8CC2-8405FC7FC272@greenbytes.de> <1jr36b5oa182lb9mupjfm6st4o9qbbr78o@4ax.com> <DA07528F-19ED-44AD-BBDA-DE3301F9F9EC@greenbytes.de>
Mime-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Complaints-To: usenet@ger.gmane.org
X-Gmane-NNTP-Posting-Host: 227-116.citynet.ftth.internl.net
X-Newsreader: Forte Agent 3.3/32.846

Stefan Eissing in gmane.comp.apache.devel (Fri, 4 Dec 2015 21:37:46
+0100):
>> 1.0.10 did not solve my problems with the admin menu in Drupal7. Sorry.
>
>Do you have any advice how to reproduce the problem, so that I might see
>what it is? I am not familiar with drupal7, unfortunately. 

mod_http2-1.0.5 revision 1715371 from the 2.4.x branch was still OK.

mod_http2-1.0.7 revision 1716210 from the 2.4.x branch doubled the
arguments in the Drupal7 admin menu:
Content-Encoding: gzip, gzip

This was the cause of my troubles with Drupal7. I rebuilt both
mod_https.so versions today with the latest nghttp2 (git head).
No other changes. Snippet from my conf file:

LoadModule http2_module modules/mod_http2-1.0.5-r1715371.so
# bad below
#LoadModule http2_module modules/mod_http2-1.0.7-r1716210.so
-- 
Jan


From dev-return-84888-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Sun Dec  6 06:53:33 2015
Return-Path: <dev-return-84888-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id C6FEB1852E
	for <apmail-httpd-dev-archive@www.apache.org>; Sun,  6 Dec 2015 06:53:33 +0000 (UTC)
Received: (qmail 78444 invoked by uid 500); 6 Dec 2015 06:53:30 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 78377 invoked by uid 500); 6 Dec 2015 06:53:30 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 78364 invoked by uid 99); 6 Dec 2015 06:53:30 -0000
Received: from Unknown (HELO spamd2-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 06 Dec 2015 06:53:30 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd2-us-west.apache.org (ASF Mail Server at spamd2-us-west.apache.org) with ESMTP id F10AF1A2532
	for <dev@httpd.apache.org>; Sun,  6 Dec 2015 06:53:29 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd2-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.555
X-Spam-Level:
X-Spam-Status: No, score=-0.555 tagged_above=-999 required=6.31
	tests=[HEADER_FROM_DIFFERENT_DOMAINS=0.001, RP_MATCHES_RCVD=-0.554,
	SPF_HELO_PASS=-0.001, SPF_PASS=-0.001] autolearn=disabled
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd2-us-west.apache.org [10.40.0.9]) (amavisd-new, port 10024)
	with ESMTP id iqFeKym_OUhH for <dev@httpd.apache.org>;
	Sun,  6 Dec 2015 06:53:29 +0000 (UTC)
Received: from plane.gmane.org (plane.gmane.org [80.91.229.3])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id B1FCB42B4B
	for <dev@httpd.apache.org>; Sun,  6 Dec 2015 06:53:28 +0000 (UTC)
Received: from list by plane.gmane.org with local (Exim 4.69)
	(envelope-from <apache-dev@m.gmane.org>)
	id 1a5TCG-0004x5-8J
	for dev@httpd.apache.org; Sun, 06 Dec 2015 07:53:24 +0100
Received: from 227-116.citynet.ftth.internl.net ([85.223.116.227])
        by main.gmane.org with esmtp (Gmexim 0.1 (Debian))
        id 1AlnuQ-0007hv-00
        for <dev@httpd.apache.org>; Sun, 06 Dec 2015 07:53:24 +0100
Received: from phpdev by 227-116.citynet.ftth.internl.net with local (Gmexim 0.1 (Debian))
        id 1AlnuQ-0007hv-00
        for <dev@httpd.apache.org>; Sun, 06 Dec 2015 07:53:24 +0100
X-Injected-Via-Gmane: http://gmane.org/
To: dev@httpd.apache.org
From: Jan Ehrhardt <phpdev@ehrhardt.nl>
Subject: Re: mod_http2 1.0.7+ and Drupal (Was: No H2 Window updates!)
Date: Sun, 06 Dec 2015 07:53:09 +0100
Lines: 16
Message-ID: <7jm76bl476qb5mgtqclss32uu84cr2gt69@4ax.com>
References: <1D08ECCD-A26B-4D3D-8F12-BE97018059B7@greenbytes.de> <043901d12e34$34d311c0$9e793540$@qqmail.nl> <10770C7F-5C8D-42EB-9E76-DC91160FDA89@greenbytes.de> <045e01d12e79$493fe620$dbbfb260$@qqmail.nl> <039D4360-8E2F-455D-8CC2-8405FC7FC272@greenbytes.de> <1jr36b5oa182lb9mupjfm6st4o9qbbr78o@4ax.com> <DA07528F-19ED-44AD-BBDA-DE3301F9F9EC@greenbytes.de> <unu66bptvbt2o9g4po12md8mdsleho74fc@4ax.com> <v3976b5hieisv5eft645gcp5lrc77gser7@4ax.com> <qie76b9kq4s5f2vsk1tjo77gcis74vr685@4ax.com>
Mime-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Complaints-To: usenet@ger.gmane.org
X-Gmane-NNTP-Posting-Host: 227-116.citynet.ftth.internl.net
X-Newsreader: Forte Agent 3.3/32.846

Jan Ehrhardt in gmane.comp.apache.devel (Sun, 06 Dec 2015 05:47:43 +0100):
>Content-Encoding: gzip, gzip

Comment in h2_from_h1.c:
/*
 * Since some clients choke violently on multiple Vary fields, or
 * Vary fields with duplicate tokens, combine any multiples and remove
 * any duplicates.
 */

Well, some clients choke violently on duplicate tokens in the
Content-Encoding field. And on duplicate tokens in the
Strict-Transport-Security field. You should remove duplicates in all
fields.
-- 
Jan


From dev-return-84889-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Sun Dec  6 07:15:17 2015
Return-Path: <dev-return-84889-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 39F2B185C0
	for <apmail-httpd-dev-archive@www.apache.org>; Sun,  6 Dec 2015 07:15:17 +0000 (UTC)
Received: (qmail 25642 invoked by uid 500); 6 Dec 2015 07:15:16 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 25574 invoked by uid 500); 6 Dec 2015 07:15:16 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 25565 invoked by uid 99); 6 Dec 2015 07:15:16 -0000
Received: from mail-relay.apache.org (HELO mail-relay.apache.org) (140.211.11.15)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 06 Dec 2015 07:15:16 +0000
Received: from asf-bz1-us-mid.priv.apache.org (nat1-us-mid.apache.org [23.253.172.122])
	by mail-relay.apache.org (ASF Mail Server at mail-relay.apache.org) with ESMTPS id 209C51A0048
	for <dev@httpd.apache.org>; Sun,  6 Dec 2015 07:15:16 +0000 (UTC)
Received: by asf-bz1-us-mid.priv.apache.org (ASF Mail Server at asf-bz1-us-mid.priv.apache.org, from userid 0)
	id A3B2C605AF; Sun,  6 Dec 2015 07:15:15 +0000 (UTC)
From: bugzilla@apache.org
To: dev@httpd.apache.org
Subject: Bug report for Apache httpd-2 [2015/12/06]
Message-Id: <20151206071515.A3B2C605AF@asf-bz1-us-mid.priv.apache.org>
Date: Sun,  6 Dec 2015 07:15:05 +0000 (UTC)

+---------------------------------------------------------------------------+
| Bugzilla Bug ID                                                           |
|     +---------------------------------------------------------------------+
|     | Status: UNC=Unconfirmed NEW=New         ASS=Assigned                |
|     |         OPN=Reopened    VER=Verified    (Skipped Closed/Resolved)   |
|     |   +-----------------------------------------------------------------+
|     |   | Severity: BLK=Blocker CRI=Critical  REG=Regression  MAJ=Major   |
|     |   |           MIN=Minor   NOR=Normal    ENH=Enhancement TRV=Trivial |
|     |   |   +-------------------------------------------------------------+
|     |   |   | Date Posted                                                 |
|     |   |   |          +--------------------------------------------------+
|     |   |   |          | Description                                      |
|     |   |   |          |                                                  |
| 7483|Ass|Enh|2002-03-26|Add FileAction directive to assign a cgi interpret|
| 8713|Inf|Min|2002-05-01|No Errorlog on PROPFIND/Depth:Infinity            |
| 8867|Opn|Cri|2002-05-07|exports.c generation fails when using a symlink to|
|10747|New|Maj|2002-07-12|ftp SIZE command and 'smart' ftp servers results i|
|11294|New|Enh|2002-07-30|desired vhost_alias option                        |
|11580|Opn|Enh|2002-08-09|generate Content-Location headers                 |
|12033|Opn|Nor|2002-08-26|Graceful restart immediately result in [warn] long|
|12680|New|Enh|2002-09-16|Digest authentication with integrity protection   |
|13599|Inf|Nor|2002-10-14|autoindex formating broken for multibyte sequences|
|13661|Ass|Enh|2002-10-15|Apache cannot not handle dynamic IP reallocation  |
|14104|Opn|Enh|2002-10-30|not documented: must restart server to load new CR|
|14496|New|Enh|2002-11-13|Cannot upgrade any version on Windows. Must uninst|
|14922|Inf|Enh|2002-11-28|<target> is currently hardcoded to 'apache2'      |
|15719|Inf|Nor|2002-12-30|WebDAV MOVE to destination URI which is content-ne|
|16761|Inf|Nor|2003-02-04|CustomLog with pipe spawns process during config  |
|16802|New|Enh|2003-02-05|Additional AllowOverride directive "Restrict"     |
|16811|Ass|Maj|2003-02-05|mod_autoindex always return webpages in UTF-8.    |
|17107|New|Min|2003-02-16|Windows should not install printenv               |
|17114|New|Enh|2003-02-17|Please add strip and install-strip targets to Make|
|17244|Ass|Nor|2003-02-20|./configure --help gives false information regardi|
|17497|Opn|Nor|2003-02-27|mod_mime_magic generates incorrect response header|
|18325|New|Enh|2003-03-25|PAM support for suEXEC                            |
|18334|Inf|Cri|2003-03-25|Server crashes when authenticating users against L|
|18497|New|Min|2003-03-30|configure --help gives wrong default for sysconfdi|
|19043|New|Min|2003-04-15|Interesting interaction between cern_meta module a|
|19670|New|Enh|2003-05-05|content type header supplied upon PUT is thrown aw|
|20036|Ass|Nor|2003-05-19|Trailing Dots stripped from PATH_INFO environment |
|21253|New|Nor|2003-07-01|Mime magic doesn't continue if type is specifed fo|
|21260|New|Nor|2003-07-02|CacheMaxExpire directive not enforced !           |
|21533|Ass|Cri|2003-07-11|Multiple levels of htacces files can cause mod_aut|
|22138|Inf|Cri|2003-08-05|Webdav is not preccessing special chars right.    |
|22237|New|Enh|2003-08-08|option to disable ServerSignature on index pages  |
|22484|Opn|Maj|2003-08-16|semaphore problem takes httpd down                |
|22686|Opn|Nor|2003-08-25|ab: apr_poll: The timeout specified has expired (7|
|22898|Opn|Nor|2003-09-02|nph scripts with two HTTP header                  |
|23167|Inf|Cri|2003-09-14|--enable-layout never goes to apr apr-util        |
|23181|New|Nor|2003-09-15|Status 304 (Not modified) and chunking leads to an|
|23238|New|Cri|2003-09-18|non-async-signal-safe operations from signal handl|
|23330|New|Enh|2003-09-22|Enhance ApacheMonitor to view and control Tomcat s|
|23911|Opn|Cri|2003-10-18|CGI processes left defunct/zombie under 2.0.54    |
|24031|New|Enh|2003-10-23|Passphrase protected private key in SSLProxyMachin|
|24095|Opn|Cri|2003-10-24|ERROR "Parent: child process exited with status 32|
|24437|Opn|Nor|2003-11-05|mod_auth_ldap doubly-escapes backslash (\) charact|
|24890|Opn|Nor|2003-11-21|Apache config parser should not be local aware ( g|
|25014|New|Enh|2003-11-26|A flexible interface for mod_log_config           |
|25201|New|Enh|2003-12-04|Provide Cache Purge operation                     |
|25240|Inf|Enh|2003-12-05|SSL Library Error: 336105671 logged as information|
|25435|New|Enh|2003-12-11|sethandler and directoryindex not playing nice    |
|25469|Opn|Enh|2003-12-12|create AuthRoot for defining paths to auth files  |
|25484|Ass|Nor|2003-12-12|Non-service Apache cannot be stopped in WinXP     |
|25543|Inf|Nor|2003-12-15|mod_proxy_ajp overwrites existing response headers|
|25667|New|Nor|2003-12-19|Memory leak in function ssl_scache_dbm_retrieve().|
|25863|New|Enh|2004-01-02|new per-host initialization hooks                 |
|26005|New|Nor|2004-01-08|SERVER_NAME incorrect when using IPv6 address in U|
|26142|New|Maj|2004-01-14|EnableSendFile Off for Windows XP Home            |
|26153|Opn|Cri|2004-01-15|Apache cygwin directory traversal vulnerability   |
|26368|New|Min|2004-01-23|File extensions in AddDescription treated as part |
|26446|New|Nor|2004-01-26|flush buckets followed by eos bucket emit multiple|
|26478|New|Enh|2004-01-28|mod_dav does not expose a method for setting the D|
|26835|New|Enh|2004-02-10|[PATCH] Mod_status Readability & Browser Side Tabl|
|27257|Ass|Enh|2004-02-26|rotatelogs with getopt and setuid                 |
|27578|New|Enh|2004-03-10|made getlastmodified a writable property          |
|27715|Ass|Enh|2004-03-16|Client sending misformed Range "bytes = 0-100" ins|
|27791|Inf|Nor|2004-03-18|mod_cache doesn't re-cache expired content        |
|27835|New|Enh|2004-03-22|When proxying FTP, all errors turns into 404      |
|27869|New|Enh|2004-03-23|stopping and starting httpd again immediately caus|
|28854|Inf|Nor|2004-05-09|Build fails with missing library call on Solaris i|
|28903|New|Enh|2004-05-11|Hooks to add environment variables to CGI and othe|
|29090|Ass|Enh|2004-05-19|MultiviewsMatch NegotiatedOnly extensions not resp|
|29165|New|Nor|2004-05-24|Parent directory icon not correct                 |
|29446|New|Enh|2004-06-08|want directive for setting content negotiation qua|
|29449|New|Enh|2004-06-09|Limit length of specified fields in LogFormat     |
|29450|New|Enh|2004-06-09|Improved logging for mod_access                   |
|29510|Ass|Enh|2004-06-10|ab does not support multiple cookies              |
|29644|Ver|Nor|2004-06-17|mod_proxy keeps downloading even after the client |
|29755|Opn|Nor|2004-06-23|mod_usertrack should use err_headers_out          |
|29822|New|Enh|2004-06-26|implement FTP 'PUT' support in proxy_ftp.c        |
|29941|Ass|Enh|2004-07-06|log files are not tested for availability on confi|
|30259|Ass|Enh|2004-07-22|When proxy connects to backend, a DNS lookup is do|
|30505|Ass|Enh|2004-08-05|Apache uses 'Error', and not lower level event typ|
|30730|Inf|Nor|2004-08-18|[PatchAvailable] mod_actions and Server-Status    |
|30865|Inf|Maj|2004-08-26|mod_disk_cache leaves many temporary files slowing|
|31302|Opn|Cri|2004-09-19|suexec doesn't execute commands if they're not in |
|31311|New|Enh|2004-09-20|Remote user not logged in reverse proxy scenario  |
|31352|Ass|Enh|2004-09-21|RFE, Bind to LDAP server with browser supplier use|
|31418|Opn|Nor|2004-09-25|SSLUserName is not usable by other modules        |
|31484|New|Maj|2004-09-30|Custom environment variables not passed to content|
|31490|New|Nor|2004-09-30|mod_proxy_ftp renders filenames with spaces badly |
|31565|New|Enh|2004-10-06|Won't start correctly if parent closed stdin, stdo|
|31679|New|Enh|2004-10-12|If the argument of a CGI has two or more consecuti|
|31709|Inf|Nor|2004-10-13|Raises an error on SSL name based virtualhosts (wi|
|31712|New|Enh|2004-10-14|config_file is NULL at ap_walk_config etc         |
|31952|New|Enh|2004-10-29|mod_proxy and RealPlayer: audio content streaming |
|32051|Opn|Nor|2004-11-04|mod_example is not thread safe                    |
|32328|Opn|Enh|2004-11-19|Make mod_rewrite escaping optional / expose intern|
|32346|New|Enh|2004-11-22|mod_include/include virtual checks content-type is|
|32524|New|Enh|2004-12-03|ab: add an option to specify a source address     |
|32703|Inf|Enh|2004-12-14|Cannot determine that Apache is frozen if /var fil|
|32750|Ass|Maj|2004-12-17|mod_proxy + Win32DisableAcceptEx = memory leak    |
|32877|New|Enh|2004-12-29|wrong utf-8 encoding/escaping in a href for umlaut|
|33084|New|Enh|2005-01-13|Optional certificate validity period check on SSLV|
|33089|New|Nor|2005-01-13|mod_include: Options +Includes (or IncludesNoExec)|
|33207|New|Nor|2005-01-23|Results of my suexec.c code audit                 |
|33215|New|Nor|2005-01-24|Cygwin build/install.sh fix (OSTYPE => ext=.exe)  |
|33512|Inf|Maj|2005-02-11|mod_mem_cache and possibly mod_deflate            |
|33627|New|Nor|2005-02-18|Bite-sized changes making progress towards compila|
|33685|New|Maj|2005-02-22|Unable to install in the path containing non engli|
|34270|Inf|Nor|2005-04-01|Large POSTs over SSL from Internet Explorer do not|
|34375|New|Enh|2005-04-08|enhancements for mod_include                      |
|34377|New|Enh|2005-04-08|Allow the overriding of 401 Unauthorized returns f|
|34405|New|Enh|2005-04-11|adds DOCUMENT_NAME_WITHOUT_SUFFIX to mod_include  |
|34508|New|Nor|2005-04-19|Randomly slow graceful restart, not accepting new |
|34519|New|Enh|2005-04-19|Directory index should emit valid XHTML           |
|35049|New|Nor|2005-05-24|let AddDefaultCharset apply to text/css and applic|
|35077|New|Nor|2005-05-26|mod_dav passes incorrect paths with LocationMatch |
|35083|Inf|Enh|2005-05-26|Certificate validation problems trapping          |
|35098|Ver|Maj|2005-05-27|Install fails using --prefix                      |
|35154|New|Nor|2005-06-01|Support for NID_serialNumber, etc. in SSLUserName |
|35245|New|Nor|2005-06-06|cache ignores max-age cache-directive in requests |
|35250|New|Enh|2005-06-07|[PatchAvailable] add logging to mod_proxy_connect |
|35280|New|Nor|2005-06-09|FTP proxy breaks RFC 2428 when trying to fall back|
|35556|Inf|Nor|2005-06-30|CRL files not re-read by HUP                      |
|35652|Opn|Min|2005-07-07|Improve error message: "pcfg_openfile: unable to c|
|35702|New|Nor|2005-07-12|Using with https URL, ab freezes or gets SIGSEGV o|
|35781|New|Nor|2005-07-18|ap_sub_req_method_uri() bypasses Limit security co|
|35981|Inf|Maj|2005-08-02|mod_dav overrides dav_fs response on PUT failure  |
|36286|New|Enh|2005-08-20|configtest doesn't check SSL certificates         |
|36492|New|Nor|2005-09-04|split-logfile script dies when splitting log of ma|
|36495|Inf|Nor|2005-09-05|mod_proxy_ajp: ajp_check_msg_header() got bad sign|
|36564|New|Enh|2005-09-08|make mod_ldap really universal                    |
|36636|New|Maj|2005-09-13|database write lock taken for PROPFIND operations |
|36676|New|Nor|2005-09-15|time() bug in httpd/os/win32/util_win32.c:wait_for|
|36710|Opn|Blk|2005-09-19|CGI output not captured                           |
|36724|New|Nor|2005-09-20|Don't install Apache Monitor by default           |
|37110|New|Nor|2005-10-17|Build fails when source tree is read-only         |
|37196|Inf|Min|2005-10-21|Wrong "Parent directory" link                     |
|37201|New|Enh|2005-10-21|Add <IfInterface IP> syntax to apache configuratio|
|37290|Opn|Min|2005-10-28|DirectoryIndex don't work in scriptaliased directo|
|37307|New|Enh|2005-10-31|Can't suppress error messages                     |
|37355|New|Enh|2005-11-04|Allow to specify Proxy-Authorization in ProxyRemot|
|37360|New|Maj|2005-11-04|Install fails on Windows XP x64 when program files|
|37402|New|Nor|2005-11-08|mod_proxy has stopped allowing POST sub-requests  |
|37514|Inf|Nor|2005-11-15|mod_proxy buffers chunked data.                   |
|37564|New|Enh|2005-11-19|Suggestion: mod_suexec SuexecUserGroup directive i|
|37587|Inf|Min|2005-11-22|mod_status Total Traffic value goes up then down? |
|37770|Opn|Blk|2005-12-03|proxy: error reading status line from remote serve|
|37823|Inf|Nor|2005-12-07|The openssl library linked is different between ht|
|37920|New|Maj|2005-12-15|mod_proxy does not flush data on POST requests fro|
|38116|New|Enh|2006-01-04|Chroot-Patch for SuExec                           |
|38164|New|Nor|2006-01-06|wrong status code for failed COPY/MOVE            |
|38182|New|Nor|2006-01-08|COPY ignores authority in Destination header      |
|38218|New|Enh|2006-01-10|Multiline Comments for *.conf files               |
|38240|Inf|Nor|2006-01-12|apache restart segfault with mutliple Include dire|
|38325|Opn|Nor|2006-01-20|impossible to determine AUTH_TYPE of interpreted r|
|38355|Unc|Enh|2006-01-23|DSO support for mod_rewrite                       |
|38369|New|Enh|2006-01-24|mod_proxy keeps alive connections that should be b|
|38408|New|Nor|2006-01-27|SSI environment vars not set in spawned processes |
|38419|New|Nor|2006-01-27|Problems with large WebDAV properties             |
|38478|New|Maj|2006-02-01|A client starting a SSL renegotiation can crash th|
|38515|New|Enh|2006-02-05|Dynamic LDAP Group Support                        |
|38550|New|Enh|2006-02-07|Setting headers based on proxied data             |
|38571|New|Enh|2006-02-08|CustomLog directive checked by apachectl configtes|
|38756|Inf|Nor|2006-02-22|errors with running make                          |
|38786|New|Nor|2006-02-26|"IndexOption VersionSort" has problems with traili|
|38827|New|Reg|2006-03-02|mod_disk_cache trying to rename locked tempfile on|
|38864|Inf|Enh|2006-03-06|ProxyPassReverse fails in <Location>              |
|38903|New|Maj|2006-03-09|r->allowed does not affect Allow response header  |
|38923|New|Min|2006-03-10|mod_speling incorrectly escapes linked URLs       |
|38928|New|Min|2006-03-11|propose removing "VARIANTS" feature               |
|38995|New|Nor|2006-03-16|httpd tries to communicate with the CGI daemon eve|
|39111|New|Nor|2006-03-27|Potential bug brought by mmapfile (mod_file_cache)|
|39128|Inf|Maj|2006-03-28|Apache 2.2 will not compile mod_ssl library's corr|
|39185|Inf|Nor|2006-04-03|Approximately in 1-2 weeks of work the server hang|
|39216|New|Maj|2006-04-05|mod_disk_cache trying to rename locked file, decre|
|39238|New|Nor|2006-04-07|mod_auth_dbm requires mod_auth or "no groups file?|
|39275|Opn|Nor|2006-04-11|slow child_init causes MaxClients warning         |
|39287|New|Nor|2006-04-12|Incorrect If-Modified-Since validation (due to syn|
|39299|New|Nor|2006-04-13|Internal Server Error (500) on COPY               |
|39329|Inf|Nor|2006-04-17|mod_dbd reconnection and prepared statements      |
|39370|New|Nor|2006-04-20|SSL session will be removed if the client is sendi|
|39380|Inf|Nor|2006-04-21|mod_disk_cache eats memory, has no LFS support, et|
|39418|New|Nor|2006-04-26|CacheMaxExpire directive not enforced             |
|39448|New|Min|2006-04-29|old-style <directory proxy:*> doesn't give any war|
|39498|New|Nor|2006-05-06|accept_filter in apr assumes if found in sys/socke|
|39517|New|Nor|2006-05-08|Corrupt chunked transfer-encoding with Content Neg|
|39658|Opn|Nor|2006-05-25|mod_proxy_ajp SSL Key Size Bug                    |
|39673|New|Nor|2006-05-29|mod_proxy opens connections that disturb NTLM     |
|39692|New|Nor|2006-05-31|mod_proxy_balancer doesn't retry a failed request |
|39723|Inf|Enh|2006-06-05|Forward proxy does not work in tranparent mode    |
|39727|Ass|Nor|2006-06-05|Incorrect ETag on gzip:ed content                 |
|39730|New|Nor|2006-06-06|LanguagePriority and DefaultLanguage are Case Sens|
|39737|New|Nor|2006-06-06|LogFormat "%{tid}P" reports wrong thread id on Win|
|39748|New|Enh|2006-06-07|Header and POST support for mod_include           |
|39753|New|Nor|2006-06-07|incorrect source for LOCALE Decimal Symbol in Win2|
|39785|Inf|Nor|2006-06-12|Status code 408 (Request Timeout) is not logged   |
|39807|Opn|Enh|2006-06-13|large files / filesystem corruption can cause apac|
|39902|New|Nor|2006-06-27|HeaderName directive breaks mod_filter somehow    |
|39904|New|Nor|2006-06-27|graceful restart error and cpu load               |
|39913|Ass|Blk|2006-06-27|detection of static OpenSSL libraries requiring li|
|39916|New|Nor|2006-06-28|Core Filters & non-blocking Sendfile              |
|39923|New|Nor|2006-06-28|AddDescription doesn't work in server config with |
|39928|New|Nor|2006-06-28|port no detected when file name not in URL        |
|39935|New|Nor|2006-06-29|AddDescription does not do literal comparisons on |
|39973|Ass|Enh|2006-07-06|apache software folder should be movable          |
|40035|New|Cri|2006-07-13|Windows Server 2003 "("R2")" 64-Bit Edition no cgi|
|40060|New|Nor|2006-07-17|AuthGroupFile should accept /etc/group syntax     |
|40075|New|Enh|2006-07-19|unable to use ldap groups that contain DNs and use|
|40102|Opn|Nor|2006-07-24|SCRIPT_NAME set incorrectly with mod_rewrite      |
|40146|New|Nor|2006-07-31|mod_ssl info in server_info is blank              |
|40174|New|Min|2006-08-03|Unable to get IndexOptionis ScanHTMLTitles to work|
|40180|Inf|Maj|2006-08-03|Mod_dav and remove folder doesn't work with Micros|
|40190|New|Nor|2006-08-05|translate file                                    |
|40196|New|Nor|2006-08-06|EILSEQ handling, NoImplicitAdd should work, and so|
|40217|Opn|Nor|2006-08-08|mod_dav PROPFIND ignores access restrictions on it|
|40266|Inf|Blk|2006-08-16|berkeley db support in httpd is screwed           |
|40312|New|Nor|2006-08-24|ssl_engine_init.c, ssl_init_ctx_verify contains a |
|40373|New|Nor|2006-08-31|mod_dir adds trailing slash after internal redirec|
|40408|New|Blk|2006-09-04|Apache 2.2.3 is not starting                      |
|40416|New|Maj|2006-09-05|mod_proxy_ftp cannot connect under http load in fo|
|40441|New|Enh|2006-09-08|intelligently handling dynamic subdomains         |
|40453|New|Nor|2006-09-09|lexicographic compare in RewriteCond isn't lexicog|
|40463|New|Nor|2006-09-11|piped logging causes some weird kill()ing         |
|40513|Opn|Maj|2006-09-14|Seeding PRNG with 0 bytes of entropy              |
|40514|New|Nor|2006-09-14|would like GracefulShutdownTimeout to work for gra|
|40540|Inf|Nor|2006-09-19|Bad interaction between MultiViews and SetOutputFi|
|40541|New|Nor|2006-09-19|Action rewrites URI used by Location?             |
|40571|New|Nor|2006-09-21|mod_proxy_ajp don't works with mod_usertrack      |
|40586|New|Enh|2006-09-22|Add option to supress default '-' output          |
|40746|New|Enh|2006-10-12|Feature request: ProxyAllow directive             |
|40749|New|Min|2006-10-12|magic file with string and "%n" causes Apache chil|
|40781|New|Nor|2006-10-17|PATH_TRANSLATED: 'redirect:/~jablko/gallery2/main.|
|40808|New|Enh|2006-10-23|ProxyRemote with optional proxy authentication    |
|40859|New|Enh|2006-11-01|[PATCH] Support -F force option to 'ab' support to|
|40917|New|Nor|2006-11-07|configure does not detect OpenSSL shared lib on HP|
|40953|New|Min|2006-11-12|Should not send any data in 1xx/204/304 reply from|
|40984|Inf|Enh|2006-11-16|AddIcon, AddIconByType for OpenDocument format    |
|40987|Opn|Enh|2006-11-16|ProxyVia Block doesn't remove Via: header for reve|
|41000|New|Nor|2006-11-19|mod_authn_dbd have an error, in function 'authn_db|
|41025|New|Nor|2006-11-23|ROBOTS META-Tag directive needed in mod_autoindex |
|41088|New|Nor|2006-11-30|installation backcolor is wrong (white)           |
|41111|New|Enh|2006-12-05|New option for filters: run only if there are spar|
|41114|New|Blk|2006-12-06|ACL HTTP method is rejected by mod_proxy_ajp      |
|41130|New|Nor|2006-12-07|mod_mime and mod_negotiation type-map both clobber|
|41143|Opn|Nor|2006-12-10|Incorrect ap_getline assumption in mod_proxy_http |
|41195|New|Nor|2006-12-17|properly set the parent pid on shutdown           |
|41196|New|Nor|2006-12-17|worker mpm usage of apr's memory pools is not thre|
|41200|Inf|Maj|2006-12-18|SSI include, prevent client from receiving full ou|
|41240|Inf|Enh|2006-12-25|BRF files support                                 |
|41262|Inf|Nor|2006-12-29|Embedded pcre causes runtime segfault             |
|41362|Inf|Maj|2007-01-14|mod_disk_cache and mod_include conflict generating|
|41375|Inf|Min|2007-01-15|Using same SSL Certificate with different ServerNa|
|41391|New|Min|2007-01-17|too long period setting makes max-age overflow    |
|41412|New|Enh|2007-01-19|RewriteRule Skip should take negative arguments   |
|41435|New|Nor|2007-01-22|Authentication fails with 500 Server Error        |
|41450|Inf|Cri|2007-01-24|Empty page (200 OK) while max-age is empty        |
|41485|New|Nor|2007-01-28|LDAP client certificates not usable in 2.2.x/trunk|
|41529|New|Enh|2007-02-02|Accept BOM in .htaccess                           |
|41556|New|Enh|2007-02-07|Feature Request: format string for masking ip addr|
|41621|New|Maj|2007-02-15|Apache 2.2.4 backend problem with Apache 2.0.59 Re|
|41646|New|Nor|2007-02-16|wrong headers are sent for HEAD requests when Prox|
|41676|Opn|Enh|2007-02-22|Refactor mod_proxy_ftp                            |
|41685|New|Enh|2007-02-22|Implement optional HTTP Authentication in a standa|
|41712|Inf|Nor|2007-02-26|threads locked at logging state                   |
|41729|New|Maj|2007-02-28|error message: ap_get_scoreboard_lb(130) failed in|
|41744|Inf|Maj|2007-03-01|SSI resolves includes but removes original HTML   |
|41763|Opn|Nor|2007-03-05|mod_disk_cache ignores CacheDirLevels and CacheDir|
|41764|New|Nor|2007-03-05|error state and conf                              |
|41771|Inf|Nor|2007-03-06|Erro with mod_proxy_ajp or mod_prox_balancer      |
|41867|New|Nor|2007-03-16|<DirectoryMatch> Matches Files                    |
|41925|New|Nor|2007-03-21|trivial patch to add automatic crypting to 'dbmman|
|41929|New|Nor|2007-03-22|ISAPI ssl variables                               |
|41953|New|Nor|2007-03-26|pidfile remains when 2nd pass of post-config retur|
|41962|New|Min|2007-03-27|Need mod_auth_ldap to authenticate with Active Dir|
|42027|Inf|Nor|2007-04-02|FileETag directive appears to be ignored          |
|42054|New|Nor|2007-04-04|service name and parameter issues                 |
|42079|New|Nor|2007-04-10|SSLRequire: Additional access in sub-directoies   |
|42082|New|Nor|2007-04-10|filter_init is called multiple times after an INCL|
|42182|Inf|Nor|2007-04-22|Mime types for cached proxied content             |
|42216|New|Enh|2007-04-24|RFE -- external overload procedure                |
|42262|Inf|Nor|2007-04-26|mod_dav /  worker fails to allocate memory and seg|
|42287|Inf|Nor|2007-04-28|chunked encoded response to POST request to cgi sc|
|42368|Inf|Nor|2007-05-09|httpd is crashing if conf/extra/httpd-manual.conf |
|42373|Inf|Maj|2007-05-09|REPORT request fails over mod_proxy               |
|42404|New|Enh|2007-05-13|Filename/info for disk-cached proxied remote URLs |
|42425|Inf|Nor|2007-05-15|Additional freshness checks in mod_cache.c cause m|
|42471|Inf|Nor|2007-05-21|clients with IE7 take 3megs per page load. httpd.e|
|42492|Inf|Nor|2007-05-22|mod_proxy_ajp with SSL front end: data corruption |
|42499|Inf|Nor|2007-05-23|Backslash produces a 404 error instead of going to|
|42548|New|Nor|2007-05-30|INCLUDE negotiating language aborts with APR_POOL_|
|42561|New|Enh|2007-05-31|[PATCH] AuthLDAPRemoteUserAttribute only applies i|
|42633|New|Min|2007-06-11|mod_info gives wrong information about actual conf|
|42665|New|Nor|2007-06-14|spurious attempt to open ".../file.html/.htaccess"|
|42666|New|Nor|2007-06-14|code & docs corrections for FollowSymLinks and Sym|
|42667|New|Nor|2007-06-14|mod_proxy_balancer not reporting when workers are |
|42668|Inf|Nor|2007-06-14|balancer_manager shows Ok status for the workers t|
|42687|New|Nor|2007-06-18|Fully delegate certificate & key semantics to the |
|42688|New|Enh|2007-06-18|engine managed keys: per process openssl context  |
|42690|New|Nor|2007-06-18|realm is not set for each configured directory whe|
|42695|Inf|Cri|2007-06-18|mod_proxy balancer problem                        |
|42699|New|Enh|2007-06-20|share mod_logio data with other modules           |
|42711|New|Enh|2007-06-20|format string for whole log entries not just id   |
|42732|Opn|Maj|2007-06-25|Authentication against database issue.            |
|42763|New|Nor|2007-06-28|graceful-stop/restart loops go loop too far       |
|42923|Inf|Maj|2007-07-17|vhost certificate NOT overriding cert from the _de|
|42972|Inf|Nor|2007-07-25|Certificate list in mod_ssl module context are not|
|42977|New|Nor|2007-07-25|DAV locking is busted when apr-util is built with |
|42987|New|Nor|2007-07-27|Weak Etags in Apache are useless and violate RFC 2|
|43012|New|Nor|2007-08-02|AIX instdso.sh libphp5.so                         |
|43027|New|Enh|2007-08-03|Header in default language                        |
|43033|New|Nor|2007-08-04|apxs does not correctly detect module name (w/o -n|
|43177|New|Nor|2007-08-21|child pid xxxxx exit signal Segmentation fault    |
|43218|New|Nor|2007-08-27|Wrong cert used for vhost if ServerName is same   |
|43220|Opn|Cri|2007-08-27|mod_proxy truncating ajp output                   |
|43249|Inf|Maj|2007-08-30|ldap_simple_bind_s failed when using SUN LDAP Libs|
|43275|New|Enh|2007-08-31|Remove avoidable network transactions in mod_proxy|
|43289|New|Nor|2007-09-02|XBitHack full g+x returns zero sized response on I|
|43308|New|Nor|2007-09-04|Persistent backend connections not supported for R|
|43352|New|Nor|2007-09-11|Apache2: out of memory during heavy webdav files c|
|43441|New|Nor|2007-09-20|Incorrect HTTP status for pre-commit-blocked autov|
|43471|New|Min|2007-09-25|no need to create a global pool on open_scoreboard|
|43481|New|Cri|2007-09-26|AuthLDAPURL must contain a final path of branch?(l|
|43494|New|Nor|2007-09-26|mod_cgid does not kill never ending scripts       |
|43502|New|Enh|2007-09-28|httpd fails to start if log directory does not exi|
|43513|New|Nor|2007-09-29|Persistent backend connections for ProxyPassMatch |
|43532|Inf|Cri|2007-10-02|Error while compiling Apache 2.2.3 on HPUX        |
|43533|Opn|Nor|2007-10-02|Frequent crashes in mod_include's bndm()          |
|43561|New|Nor|2007-10-05|apxs -q anomaly                                   |
|43577|Inf|Blk|2007-10-09|mod_authnz_ldap not working under WLDAP32 (novell/|
|43607|New|Nor|2007-10-11|mod_proxy sends data on closed connections without|
|43649|Opn|Trv|2007-10-18|mod_autoindex is generating invalid XHTML markup  |
|43652|New|Enh|2007-10-18|Suggest small change for big fix with SuExec & Vir|
|43666|New|Nor|2007-10-20|CGI works, but client denied error messages in err|
|43679|New|Enh|2007-10-23|Contributed tests for checking that subrequests ta|
|43723|Inf|Cri|2007-10-29|Apache 2.2.6 segfault when using mod_dbd          |
|43724|New|Cri|2007-10-29|Apache 2.2.6 segfault on url wich not in cache    |
|43755|New|Enh|2007-10-31|Add a SSLOptions to don't fill SSL_CLIENT_VERIFY  |
|43762|New|Enh|2007-10-31|Misleading tips in an error message about internal|
|43777|New|Nor|2007-11-01|Wrong encoding of <href> element in response      |
|43778|New|Nor|2007-11-01|Wrong responses if httpd has not access to some el|
|43785|New|Enh|2007-11-02|Tracking the per-hit impact of mod_include        |
|43792|New|Enh|2007-11-04|Feature proposal - bind phase                     |
|43818|New|Nor|2007-11-08|PROPFIND on -w- collections returns 207 MULTI-STAT|
|43838|New|Enh|2007-11-11|If-Modified-Since request and htcacheclean conflic|
|43895|New|Nor|2007-11-18|mod_mbox improvements                             |
|43897|Inf|Cri|2007-11-18|Huge memory consumption httpd 2.2.6, mod_proxy - m|
|43931|New|Enh|2007-11-21|OpenSSL autoconfig support for mod_ssl            |
|43943|New|Nor|2007-11-22|SHMCB crash due to misalignment and GCC 4 optimiza|
|43958|Inf|Maj|2007-11-26|mod_proxy_balancer not balancing correct in combin|
|43997|Opn|Min|2007-11-29|Only issue "Init: SSL server IP/Port conflict" if |
|44025|Inf|Nor|2007-12-05|Apache 2.2.6 fails to configure on OpenBSD 4.1    |
|44027|Ass|Enh|2007-12-05|Internationalized Domain Name (IDN) support       |
|44031|Opn|Maj|2007-12-06|RemoveHandler inside subdir location              |
|44034|Ass|Enh|2007-12-06|mpm_winnt doesn't call monitor hook               |
|44105|New|Nor|2007-12-19|Core dumps when using Proxy Keepalive             |
|44155|New|Enh|2007-12-31|smarter retry for LDAP_UNAVAILABLE, LDAP_BUSY, etc|
|44181|Opn|Enh|2008-01-07|add UnAlias                                       |
|44188|Inf|Cri|2008-01-08|Empty response for certain requests (mod_proxy as |
|44218|New|Min|2008-01-13|mod_autoindex shows the default icon for files wit|
|44221|Opn|Cri|2008-01-14|CheckCaseOnly On does not stop Multiple Choices ba|
|44250|New|Nor|2008-01-16|OSX 10.5: __THE_PROCESS_HAS_FORKED_AND_YOU_CANNOT_|
|44279|New|Enh|2008-01-22|Add "iterate" flag to apply rule in a loop while p|
|44302|New|Nor|2008-01-27|AuthLDAPURL does not accept ldapi:// urls         |
|44305|New|Nor|2008-01-28|Inconsistent configuration for suexec path        |
|44316|New|Nor|2008-01-28|httpd 2.0 does not follow ScriptAliases when invok|
|44322|New|Enh|2008-01-29|mod_proxy ProxyPassReverseCookieDomain with no dom|
|44351|New|Nor|2008-02-04|File descriptor leak when using prg RewriteMap    |
|44363|Inf|Maj|2008-02-05|Slow file transfers                               |
|44384|Ass|Nor|2008-02-09|mod_ssl on MacOS X 10.5.1 does not work because of|
|44453|New|Nor|2008-02-19|list_hooks.pl doesn't parse declarations that span|
|44476|New|Maj|2008-02-23|Apache service fails to start due to missing depen|
|44503|Inf|Blk|2008-02-27|Errors during SSL handshake                       |
|44518|New|Enh|2008-03-02|Don't set expires header on HTTP redirect.        |
|44578|New|Enh|2008-03-11|mod_authn_dbd option to let database validate pass|
|44601|New|Trv|2008-03-13|Add a lowercase value to Vary header for consisten|
|44602|New|Enh|2008-03-13|Options for modfying Content-Location (relative OR|
|44622|Inf|Nor|2008-03-17|POST fails to SSL vhost with proxy to HTTP backend|
|44631|New|Nor|2008-03-18|with-included-apr fails to work when using a separ|
|44638|New|Nor|2008-03-19|sed error in httpd.spec.in                        |
|44656|New|Nor|2008-03-22|Tries to retrive error document 404 instead of 406|
|44657|New|Enh|2008-03-22|prefer-type, -encoding, and -charset cookie? (as p|
|44670|New|Min|2008-03-25|Apache httpd 2.2.8 : Cannot ./configure when curre|
|44696|Inf|Nor|2008-03-27|mod_cache sometimes serves old content despite hav|
|44730|New|Nor|2008-04-01|duplicate query string in remote server url when u|
|44752|New|Nor|2008-04-03|Suexec does not correctly check that scripts are i|
|44757|New|Enh|2008-04-04|adding stderr buckets to mod_cgi                  |
|44758|New|Enh|2008-04-04|LimitRequestBody undocumented behaviour with proxi|
|44779|New|Enh|2008-04-08|Using commas and semicolons for content negotiatio|
|44855|New|Nor|2008-04-22|irregular balancing with sticky-session after re-e|
|44865|Ass|Nor|2008-04-23|mod_dav's lock database becomes consistently corru|
|44870|Inf|Nor|2008-04-24|process spinning on 100% cpu                      |
|44923|Inf|Min|2008-05-02|consequences of multiple LDAPTrustedGlobalCert    |
|44924|New|Enh|2008-05-02|allow 'CACERTDIR' in mod_ldap                     |
|44940|New|Maj|2008-05-06|Httpd randomly breaks when verifying client certif|
|44981|New|Enh|2008-05-12|Digital Certificates (CN Based) for Authorization |
|45022|New|Nor|2008-05-16|Processing of escaped glob patterns in "Include" d|
|45023|Opn|Reg|2008-05-16|DEFLATE preventing 304 NOT MODIFIED response      |
|45049|Opn|Nor|2008-05-20|mod_mem_cache caches partial content when client c|
|45054|New|Nor|2008-05-21|SSLVerifyClient optional_no_ca is broken          |
|45058|New|Nor|2008-05-21|Mod_SSL does not set AUTH_TYPE with client certifi|
|45078|New|Nor|2008-05-27|mod_proxy stalls when uploading files             |
|45103|Ass|Min|2008-05-30|apachectl should do config test before reload/rest|
|45111|New|Enh|2008-06-01|make mod_usertrack use mod_unique_id if available |
|45116|New|Nor|2008-06-02|fail to check return value of apr_file_dup2() in /|
|45148|New|Enh|2008-06-06|The actual host of the request will be more helpfu|
|45184|New|Enh|2008-06-11|Regular Expression in directive ServerAlias       |
|45187|New|Maj|2008-06-11|Long File name requests gives FORBIDDEN response  |
|45225|New|Nor|2008-06-17|XBitHack breaks DirectoryIndex + MultiViews conten|
|45253|New|Nor|2008-06-23|Unable to build httpd 2.2.9 on Solaris/SPARC      |
|45257|New|Enh|2008-06-23|add (en)force option for UseCanonicalName         |
|45259|New|Enh|2008-06-23|Add /home/[a-z]/* scheme to UserDir conf          |
|45275|New|Maj|2008-06-25|Locked files during expired page renew in disk cac|
|45281|New|Enh|2008-06-25|SITE CHMOD/SEARCH                                 |
|45287|Inf|Min|2008-06-26|build failure because of difference between BSD an|
|45297|New|Min|2008-06-27|mod_dir does not manage correctly the user (r->use|
|45302|New|Enh|2008-06-28|ServerRoot directive                              |
|45355|New|Nor|2008-07-07|ab text and html output jumbo unification         |
|45356|New|Nor|2008-07-07|ab: optionally reduce resource usage (qsort and me|
|45371|New|Nor|2008-07-10|MSI installer requires uninstall of previous versi|
|45374|New|Blk|2008-07-10|Shared memory error on starting httpd with mod_lda|
|45379|Inf|Nor|2008-07-11|[Bug] svn merge, apache and trailing slashes      |
|45385|Inf|Nor|2008-07-11|unable to compile/make 2.2.9 with --enable-ldap   |
|45393|New|Nor|2008-07-14|Apache returns 500 Error when no LDAP credentials |
|45402|New|Nor|2008-07-15|mod_autoindex incorrectly fails to list files     |
|45405|New|Enh|2008-07-16|Allow binding port to be set for individual worker|
|45449|New|Nor|2008-07-21|[PATCH] Add support to WebDav to MOVE/COPY to remo|
|45456|New|Enh|2008-07-22|mod_dbd don't allow more then one database pool   |
|45487|New|Trv|2008-07-27|broken log messages on startup in win32 version   |
|45497|New|Nor|2008-07-29|Scoreboard slot leaked using MaxRequestsPerChild a|
|45512|Ass|Maj|2008-07-31|Bad Performance of mod_proxy with SSL on Solaris 1|
|45524|New|Enh|2008-08-01|Specifying multiple vhost aliases                 |
|45525|New|Enh|2008-08-01|Switch mod_autoindex to Tango icons               |
|45579|New|Nor|2008-08-06|unknown URI scheme in request-URI ignored         |
|45674|New|Enh|2008-08-22|Allow to change error code returned by "Require ld|
|45726|New|Enh|2008-09-02|Build in a maintenance functionallity             |
|45736|New|Nor|2008-09-03|mod_dav needs a directory for its locks and one sh|
|45754|New|Enh|2008-09-06|autoconf macros                                   |
|45763|New|Nor|2008-09-08|No openssl.cnf defined by default causes OpenSSL c|
|45773|New|Nor|2008-09-09|pcre build generates sources to srcdir rather than|
|45788|New|Nor|2008-09-11|mod_log_forensic output shouldn't be buffered when|
|45801|Opn|Nor|2008-09-13|SSLRequireSSL with strictrequire and satisfy any d|
|45838|New|Nor|2008-09-18|mod_authz_owner & directories                     |
|45868|New|Nor|2008-09-23|mod_mem_cache update of headers in cache object is|
|45900|New|Nor|2008-09-26|"make install" fails from read-only filesystem    |
|45905|New|Enh|2008-09-26|ErrorDocument and default URL                     |
|45922|New|Enh|2008-09-30|Expand the conditions under which "SSLVerifyClient|
|45923|New|Nor|2008-09-30|htpasswd tries to open(file, O_RDONLY | O_APPEND) |
|45926|Inf|Nor|2008-10-01|Unable to start apache 2.2.9                      |
|45986|New|Nor|2008-10-10|[info]...Invalid argument: core_output_filter: wri|
|46024|Opn|Nor|2008-10-16|--enable-static is not available in apache's confi|
|46037|Inf|Nor|2008-10-18|Configuration of trusted OCSP responder certificat|
|46040|New|Enh|2008-10-20|Check for existing version of Apache while install|
|46054|New|Nor|2008-10-21|Running httpd returns the error "bad user name nob|
|46070|New|Nor|2008-10-22|MSI installer does not validate custom installatio|
|46071|New|Enh|2008-10-22|Allowing space in between comma and last option in|
|46074|New|Enh|2008-10-23|Need of friendly and easy to use configuration gra|
|46139|New|Nor|2008-11-02|Apache Restart option is not working              |
|46140|New|Enh|2008-11-03|Change error state in balancer manager            |
|46188|Inf|Nor|2008-11-11|Core dumps in apache 2.0.59                       |
|46195|Opn|Nor|2008-11-12|ProxyPass fails with literal IPv6 address         |
|46215|New|Nor|2008-11-14|Race condition in bybusyness algorithm            |
|46231|New|Maj|2008-11-18|Connection Pooling with ajp depends on syntax ?   |
|46241|New|Enh|2008-11-19|mod_expires - ExpiresByPattern or ExpiresIf       |
|46267|New|Nor|2008-11-22|No shared modules build if use --with-apr and --wi|
|46270|New|Enh|2008-11-23|Add FIPS 140-2 mode for mod_ssl for FIPS 1.2 modul|
|46282|New|Nor|2008-11-24|apache2.2 reverse proxy causing full memory and sw|
|46316|New|Maj|2008-12-01|Proxied SSI ProxyTimeout render failure           |
|46317|Inf|Nor|2008-12-01|mod_authnz_ldap.c(373)  seg fault                 |
|46412|New|Nor|2008-12-17|make_child return value not checked               |
|46417|New|Cri|2008-12-19|[notice] Parent: child process exited with status |
|46428|Opn|Nor|2008-12-21|Spaces in URI doesn't encode in proxy-requests    |
|46442|New|Nor|2008-12-29|Semicolon in allow/deny all rules cause reverse lo|
|46449|New|Maj|2008-12-30|Output out of order from SSI include virtual      |
|46454|New|Min|2008-12-30|escaping wildcards in AddIcon filename matching   |
|46475|New|Nor|2009-01-04|build warnings.                                   |
|46499|New|Maj|2009-01-09|httpd accept() return EAGAIN error                |
|46521|New|Nor|2009-01-13|mod_dav doesn't show symlinks                     |
|46529|Ass|Nor|2009-01-14|Child httpd processes crash with Segmentation faul|
|46534|New|Nor|2009-01-14|mod_proxy_ajp scheme and port do not follow UseCan|
|46578|New|Nor|2009-01-21|Flawed header                                     |
|46582|Ver|Min|2009-01-22|RewriteMap internal functions are not well documen|
|46604|New|Nor|2009-01-26|Error thrown when trying to rpmbuild -tb httpd sou|
|46629|New|Maj|2009-01-29|Apache hanging on system calls for php and perl   |
|46634|Ass|Nor|2009-01-30|Requests sometimes take too long, wrong time taken|
|46644|New|Enh|2009-01-31|Clean way to pass custom environment variables to |
|46646|Ass|Nor|2009-02-01|check group membership is sometimes case sensitive|
|46650|Opn|Nor|2009-02-02|CustomLog enviroment condition SCRIPT_FILENAME    |
|46656|New|Enh|2009-02-03|ProxyErrorOverride inside location                |
|46669|New|Enh|2009-02-06|rotatelogs doesn't autocreate directories         |
|46671|Opn|Cri|2009-02-07|Apache periodicaly crashes .                      |
|46678|New|Nor|2009-02-09|Fixed Content-Length using mod_ext_filter with mod|
|46682|New|Nor|2009-02-09|mod_proxy EAI_AGAIN DNS failure                   |
|46685|Opn|Nor|2009-02-09|401 sent without WWW-Authenticate header when requ|
|46709|Opn|Reg|2009-02-12|Expect: 100-continue to an HTTP/1.0 server change |
|46724|Inf|Cri|2009-02-17|WinXP SP3 - Apache crashes on startup in libapr-1.|
|46743|New|Nor|2009-02-19|Inconsistent behavior of "RewriteOptions inherit" |
|46745|New|Maj|2009-02-20|ab.c error :  undefined reference to `BIO_set_call|
|46751|New|Nor|2009-02-21|Can passenv variables who's name contain '(' or ')|
|46762|New|Nor|2009-02-24|Error, SSL/TLS libraries were missing or unusable |
|46765|Opn|Nor|2009-02-25|doubled HTTP header leads to error (Redmine)      |
|46785|Inf|Nor|2009-03-02|Child process increases to 100% (CPU)             |
|46788|New|Nor|2009-03-02|Set resource limits to avoid denial of service att|
|46810|New|Nor|2009-03-05|apxs / apu-1-config outputting erroneous include p|
|46824|New|Nor|2009-03-09|RemoveOutputFilter will not work for Filters added|
|46845|Inf|Cri|2009-03-12|Apache crashes in Windows when using subversion(pr|
|46847|New|Nor|2009-03-13|WebDAV methods with encoding other than "identity"|
|46873|New|Nor|2009-03-18|feature request: connection count on balancer-mana|
|46884|New|Min|2009-03-20|Call to apu_dso_load Fails In apr_ldap_stub.c On O|
|46946|Inf|Nor|2009-03-31|mod_mbox shows email addresses in plain text      |
|46963|New|Nor|2009-04-03|KeepAliveTimout prevents child process from exitin|
|46969|New|Nor|2009-04-05|CustomLog format %m always GET on errors with loca|
|46970|New|Nor|2009-04-05|CustomLog %X does not record aborted connections w|
|47011|New|Reg|2009-04-09|mod_proxy/mod_proxy_balancer hot-standby BalancerM|
|47055|New|Blk|2009-04-20|SSLVerifyClient + Directory doesn't use cache sess|
|47063|New|Nor|2009-04-21|mod_proxy doesn't call post_request handler when t|
|47134|New|Nor|2009-05-01|Last resolve handling when sending client certific|
|47138|New|Nor|2009-05-01|Reverse Proxy & Balancer generate error fault when|
|47152|New|Maj|2009-05-04|Apache is only serving the first character in the |
|47159|New|Nor|2009-05-06|2.2.x logresolve doesn't support ipv6             |
|47167|New|Nor|2009-05-07|Authenticated sessions being switched by reverse p|
|47170|New|Enh|2009-05-08|rotatelogs ring buffer option                     |
|47180|New|Nor|2009-05-11|DBM ssl_scache setting can cause extreme performan|
|47220|Opn|Enh|2009-05-19|Access to environment variables                   |
|47256|New|Enh|2009-05-23|Enable SSL on a per-port basis                    |
|47289|New|Nor|2009-05-30|Can't build with dynamic libraries on Mac OS 10.4 |
|47295|New|Nor|2009-06-01|AuthDBDUserPWQueryFmt/AuthDBDUserRealmQueryFmt in |
|47329|New|Nor|2009-06-07|SSLCADNRequest* & SSLCACertificate* silently do no|
|47340|New|Nor|2009-06-09|uldap_cache_comparedn() called without a lock     |
|47344|New|Enh|2009-06-10|[FEATURE REQUEST] RedirectCanonicalName           |
|47345|New|Enh|2009-06-10|rotatelogs timeout patch                          |
|47346|New|Maj|2009-06-10|mod_cache doesn't re-cache expired content when La|
|47387|Inf|Nor|2009-06-18|SSL_CLIENT_I_DN and SSL_CLIENT_S_DN use Email inst|
|47392|Opn|Nor|2009-06-18|<FilesMatch> is using the wrong directory         |
|47435|New|Nor|2009-06-26|mod_authz_host does reading of /etc/hosts on each |
|47438|Inf|Enh|2009-06-27|how to create a non-html "listing generated by the|
|47447|New|Enh|2009-06-29|Add possibility to use client IP as a value in Req|
|47484|New|Nor|2009-07-06|Spurious RewriteLock warning when using external m|
|47485|New|Enh|2009-07-06|HTML5 Websocket implementation                    |
|47514|New|Enh|2009-07-12|Personal data and restrictions based on subject di|
|47528|New|Maj|2009-07-14|Worker process won't restart more than once using |
|47542|New|Nor|2009-07-16|Piped logging processes killed before other proces|
|47562|Inf|Nor|2009-07-23|Apache/2.2.3 (Win32) mod_perl/2.0.3-rc1           |
|47578|New|Nor|2009-07-24|compile ERROR with ssl                            |
|47580|Opn|Nor|2009-07-25|mod_cache sends 200 response instead of 304       |
|47586|New|Nor|2009-07-27|httpd -k start doesn't start service when rotatelo|
|47591|New|Min|2009-07-27|show current HTTP_HOST in mod_status scoreboard   |
|47601|New|Enh|2009-07-29|Support X-Forwarded-For in forward proxy requests |
|47625|New|Nor|2009-08-02|2.2.12 win32 msi installer missing                |
|47634|New|Maj|2009-08-04|mod_ldap connection pool session keepalive not imp|
|47643|New|Enh|2009-08-04|added meta tags to xhtml output for ease of search|
|47650|Opn|Trv|2009-08-05|httxt2dbm calculates value size incorrectly       |
|47657|New|Nor|2009-08-06|Make WebDAV MOVE atomic when replacing files on sa|
|47659|New|Nor|2009-08-07|makefile.win needs check for DBM_LIST, dies on bui|
|47664|New|Nor|2009-08-07|ap_proxy_canonenc: does not recode all high-byte c|
|47665|Inf|Blk|2009-08-09|Apache service well launched but blank Screen     |
|47691|New|Enh|2009-08-12|libtool invocations should use --tag              |
|47693|Opn|Nor|2009-08-13|GET request has race condition w.r.t. replacement |
|47706|Inf|Nor|2009-08-19|(20014)Internal error: proxy: error reading status|
|47716|New|Min|2009-08-20|LimitRequestFieldSize and friends not merged well |
|47719|Opn|Enh|2009-08-20|Broken symbolic link (symlink) causes wrong ErrorD|
|47723|New|Nor|2009-08-22|suEXEC and low RLimitMem gives "crit: invalid uid"|
|47743|Inf|Nor|2009-08-26|mod_so segfaults at server startup in ap_find_load|
|47753|New|Nor|2009-08-27|output and error channels not explicitly passed fo|
|47778|Opn|Enh|2009-09-03|wrong exit value on graceful restart              |
|47780|New|Nor|2009-09-03|Critical errors should be marked by time and level|
|47807|Inf|Nor|2009-09-09|Proxy dialog error with Apache 2.2.13             |
|47808|New|Maj|2009-09-09|Child process core dumps when enabling CRL        |
|47814|Inf|Maj|2009-09-10|openssl_pkcs7_sign error                          |
|47838|New|Enh|2009-09-14|Ability to Dynamically Inject Current Time Into a |
|47874|New|Nor|2009-09-18|mod_fcgid crashes if added during restart         |
|47895|New|Maj|2009-09-24|Incorrect 413 error handling                      |
|47908|New|Min|2009-09-27|'invalid result code' in error_log                |
|47981|New|Nor|2009-10-12|allow language specific html-versions (index.html.|
|47982|New|Nor|2009-10-12|correctly interprete non-standard HTTP_ACCEPT_LANG|
|47988|New|Nor|2009-10-12|Segmentation fault                                |
|47989|New|Nor|2009-10-13|Junk string appended to compressed dynamic content|
|47994|New|Enh|2009-10-14|ScriptInterpreterSource apparently broken in Windo|
|48020|New|Nor|2009-10-17|KCP+ Opera support for mod_auth_digest            |
|48037|Inf|Nor|2009-10-21|mod_proxy_http does not handle asynchronous keepal|
|48045|New|Nor|2009-10-23|Apache 2 initgroups alert, Max OS X, abnormal exit|
|48057|New|Nor|2009-10-26|mod_fcgid creates 1 more process then allowed     |
|48094|New|Nor|2009-11-01|Avoid a race condition in close_worker_sockets()  |
|48107|New|Maj|2009-11-02|Mutual Authentication: Order in ca-bundle influenc|
|48115|New|Enh|2009-11-03|Duration to receive the request, generate response|
|48130|New|Maj|2009-11-04|DAV operations on large filesets consume all the O|
|48154|New|Nor|2009-11-06|Requests through mod_isapi are not parsed by HTTP_|
|48164|New|Enh|2009-11-09|add new parameters to rotatelogs                  |
|48219|New|Nor|2009-11-17|Retrying the worker for seems to omit POST variabl|
|48228|New|Nor|2009-11-18|Renegocation requires multiple client authenticati|
|48246|New|Enh|2009-11-19|Check permissions on file/directory specified for |
|48254|New|Trv|2009-11-20|Bogus "DocumentRoot does not exist" warning when s|
|48283|New|Nor|2009-11-25|Proxy errors since httpd 2.2.12 with Tomcat 6.0.20|
|48291|New|Maj|2009-11-26|mod_substitute loops                              |
|48295|Opn|Nor|2009-11-27|ProxyPassReverseCookiePath: Not changing path corr|
|48301|New|Enh|2009-11-30|Feature request: improved connection status report|
|48309|New|Maj|2009-11-30|libapreq2-2.12: "make test" fails at request.t and|
|48312|Opn|Nor|2009-11-30|ProxyPassReverseCookiePath: Not changing path corr|
|48316|Inf|Nor|2009-12-01|ap_run_insert_filter doesn't work in cache_url_han|
|48354|New|Enh|2009-12-08|void ap_custom_response is not supporting the bina|
|48360|New|Enh|2009-12-09|provide sample configuration file for inclusion in|
|48361|New|Enh|2009-12-09|Add global server option for specifying desired DS|
|48364|Opn|Nor|2009-12-10|PHP-generated pages are not cached in spite of per|
|48369|New|Enh|2009-12-10|add option to automatically restart if a script is|
|48431|New|Nor|2009-12-22|Error logging doesn't work when configured to use |
|48440|Inf|Cri|2009-12-23|Segmentation Fault                                |
|48449|Inf|Nor|2009-12-28|make distclean removes core.c and core_filters.c  |
|48465|Opn|Enh|2009-12-30|Support TCP to connect to backends                |
|48499|New|Nor|2010-01-06|mod_rewrite can't redirect to files with ? in them|
|48500|New|Nor|2010-01-06|mod_mbox mishandles right-click to open msg in new|
|48508|New|Nor|2010-01-07|BalancerMember doesn't accept nocanon directive   |
|48549|New|Enh|2010-01-14|Add Cache-Control s-maxage support                |
|48576|New|Nor|2010-01-19|MOVE or COPY in WebDAV fails with 404 when file ex|
|48585|New|Enh|2010-01-20|mod_cache no longer caches expired content        |
|48602|New|Enh|2010-01-23|use asynch ldap_compare so LDAPTimeout applies    |
|48623|New|Maj|2010-01-26|AuthLDAPURL syntax is not RFC-compliant, prevents |
|48639|New|Enh|2010-01-29|Add htcacheclean as a core monitored process      |
|48652|New|Maj|2010-02-01|"AuthType form" fails if a password contains  '&' |
|48659|New|Maj|2010-02-02|Problem with accents in filename and byte serving |
|48687|New|Nor|2010-02-05|mod_rewrite ignores trailing dot in request URI on|
|48705|New|Enh|2010-02-08|flag to allow newlines in the error log as opposed|
|48712|New|Enh|2010-02-09|Add UID and GID to status page                    |
|48719|New|Nor|2010-02-09|[BUG] mod_proxy_ajp return wrong error message whe|
|48721|New|Nor|2010-02-10|[Patch] Add ProxyAllow to mod_proxy               |
|48731|New|Maj|2010-02-11|Prefork not creating processes after 10 servers ar|
|48732|New|Nor|2010-02-12|[BUG] environment variable SCRIPT_NAME output erro|
|48769|New|Nor|2010-02-18|[PATCH] Processes in the busy list should not be k|
|48777|New|Maj|2010-02-19|proxy balancer not detecting correctly when host (|
|48780|New|Enh|2010-02-19|Enable mod_authnz_ldap to accept valid client cert|
|48792|New|Enh|2010-02-22|httpd util apachectl returns wrong status informat|
|48805|New|Nor|2010-02-23|Corrupted response for HTTPS + KEEPALIVE=ON       |
|48808|New|Enh|2010-02-24|mod_authz_owner support for POSIX access control l|
|48819|Inf|Nor|2010-02-25|After users login on the web page, the page does n|
|48842|Inf|Nor|2010-03-02|mod_log_config logs the full size of the file inst|
|48880|Opn|Nor|2010-03-09|error on make                                     |
|48888|New|Nor|2010-03-10|DOCTYPE definitions nearly 11 years out-of-date   |
|48920|New|Enh|2010-03-15|Breadcrumbs on mod_autoindex path                 |
|48921|Inf|Nor|2010-03-16|mod_mem_cache crash, version 2.2.15.0             |
|48937|New|Enh|2010-03-18|Feature proposal - support sasl_bind              |
|48949|Inf|Cri|2010-03-20|fcgid processes never get killed after graceful re|
|48958|New|Nor|2010-03-22|mod_ldap, ldap credential cache & graceful restart|
|48987|New|Trv|2010-03-25|typo in polish translation of HTTP_UNAUTHORIZED.ht|
|49037|New|Enh|2010-04-02|SSLVerifyClient require_no_ca                     |
|49043|New|Maj|2010-04-04|Using ssi include directive overwrites QUERY_STRIN|
|49058|New|Nor|2010-04-06|Prefork MPM tries to accept on closed listener soc|
|49067|New|Nor|2010-04-08|FTPOptions ShowUnAuthorizedFiles does not work    |
|49068|New|Nor|2010-04-08|UTF-8 URL Encode error                            |
|49087|New|Maj|2010-04-11|MSI installation reports "interrupted installation|
|49114|New|Maj|2010-04-13|NTFS junction directories missing from directory l|
|49123|New|Nor|2010-04-14|mod_proxy_ajp does not send the client's SSL chain|
|49131|New|Nor|2010-04-15|Very long URLs cause 404 or 403 errors with SetAct|
|49133|New|Maj|2010-04-16|Windows service recovery options do not work for A|
|49157|New|Nor|2010-04-20|Issues with xml interface for balancer manager    |
|49187|New|Nor|2010-04-26|Crash mod_mem_cache and mod_svn                   |
|49199|New|Enh|2010-04-27|Implement LDAP scope-aware caching in mod_ldap    |
|49220|New|Nor|2010-04-29|feature request for being able to disable FcgidWra|
|49239|New|Blk|2010-05-01|Apache mod_ssl gives coredump with openssl 0.9.8  |
|49277|New|Nor|2010-05-12|Expose a variable to identify SSL Session renegoti|
|49283|New|Nor|2010-05-12|Language of dates on SSI                          |
|49285|New|Enh|2010-05-13|Relative (local to current directory) URLs do not |
|49348|New|Enh|2010-05-27|[mod_log_config] Output log file name format capab|
|49385|New|Maj|2010-06-03|mod_disk_cache server side included files are inte|
|49387|Inf|Cri|2010-06-03|Unable to modify default charset setting to UTF-8 |
|49391|New|Nor|2010-06-05|mod_disk_cache needs to register a cleanup to kill|
|49396|New|Enh|2010-06-06|PATH_INFO normalization, especially relating to vo|
|49427|New|Nor|2010-06-11|mod_cgid and mod_cgi do not return proper value wh|
|49433|New|Enh|2010-06-13|improving info in server status                   |
|49439|New|Nor|2010-06-14|Bug in mod_userdir which prevents suexec from runn|
|49504|New|Nor|2010-06-25|Solaris 10/x64 worker graceful restart problem    |
|49532|New|Nor|2010-06-30|mod_cache: Set-Cookie headers are appended to cach|
|49553|New|Min|2010-07-05|Set QoS bits via APR2 API instead                 |
|49568|New|Maj|2010-07-07|Apache mod_authnz_ldap built with the MS LDAPSDK d|
|49632|Inf|Nor|2010-07-21|mod_authnz_ldap denies users when search is perfor|
|49633|New|Enh|2010-07-21|Handle AD primary groups in mod_authnz_ldap       |
|49642|New|Nor|2010-07-23|mod_rewrite mistakes encoded question mark as path|
|49643|New|Nor|2010-07-23|WebDav plus mod Negotiation causes directory creat|
|49676|New|Nor|2010-07-30|directory with german umlauts are indented by one |
|49680|New|Maj|2010-07-30|Perl script are not running on Win32, Apache 2.2.1|
|49684|New|Enh|2010-08-01|enhancement for ipv6 implementation               |
|49699|New|Nor|2010-08-03|Inconsistent Keep-alive from proxy to the origin s|
|49715|New|Maj|2010-08-06|ProxyPassMatch Url Encoder Problem                |
|49717|New|Enh|2010-08-06|PATCH: Enable SSL Timeout                         |
|49737|Inf|Nor|2010-08-10|order allow,deny does not work on IPv6            |
|49743|New|Maj|2010-08-12|SSI 'echo encoding="(url/none)"' bug              |
|49746|Opn|Enh|2010-08-12|mod_rewrite urlencode option                      |
|49766|New|Maj|2010-08-17|POST request on CGI script generating empty body c|
|49771|New|Nor|2010-08-17|After graceful restart using mod_proxy_ajp, couldn|
|49772|New|Nor|2010-08-18|mod_deflate kicks itself out on Content-Range resp|
|49798|Opn|Nor|2010-08-22|[mod_log_config] Piped Log scripts process cause w|
|49807|New|Enh|2010-08-23|hard to force Content-Type header for non static f|
|49810|New|Nor|2010-08-23|Mod_autoindex output of header/body/footer scrambl|
|49815|New|Enh|2010-08-24|Enable caching for HTTP Range requests / 206 respo|
|49829|New|Trv|2010-08-26|CGI index command line arguments excessively escap|
|49832|New|Enh|2010-08-26|void ap_custom_response is not supporting the bina|
|49859|Opn|Nor|2010-09-01|url with additional filepath generates bad environ|
|49921|New|Nor|2010-09-13|Trailers in chunked http requests are not handled |
|49926|New|Enh|2010-09-14|New option for mod_log_forensics or mod_log_config|
|49980|New|Nor|2010-09-22|can't use a FIFO for SSL key file; mod_ssl checks |
|49981|New|Enh|2010-09-22|Requesting SSLCertificateKeyFile Dialog functional|
|49990|New|Nor|2010-09-23|Feature request: implement ExpiresActive reset    |
|49996|New|Nor|2010-09-24|Proxied ErrorDocument returns 200 OK response code|
|49997|New|Nor|2010-09-24|wrowe promised me...                              |
|50004|New|Nor|2010-09-26|per-dir rewrite without DocumentRoot or RewriteBas|
|50011|New|Cri|2010-09-27|error running apache, and installing apache as a s|
|50024|New|Min|2010-09-29|Mod_cache/mod_mem_cache and mod_security combinati|
|50038|New|Enh|2010-10-01|What Directives apply to a file/directory? Resulta|
|50041|New|Min|2010-10-04|(9)Bad file descriptor: apr_socket_accept: (client|
|50051|New|Nor|2010-10-07|Log PID in first entry logged for each request    |
|50061|New|Nor|2010-10-08|Semicolon character '%3B' seems to be decoded to '|
|50082|New|Nor|2010-10-12|apachectl status returns incorrect exit code      |
|50112|New|Nor|2010-10-18|buildconf broken in two places                    |
|50116|New|Nor|2010-10-19|Apache fragments packets unnecessarily            |
|50151|New|Nor|2010-10-25|Software caused connection abort and apache proces|
|50155|Inf|Nor|2010-10-25|httpd -s attempts to read SSL certificates        |
|50172|Inf|Nor|2010-10-28|Digest allows access bypassing secuity            |
|50227|New|Enh|2010-11-07|Option to fail SSL handshake for diverted SNI conn|
|50237|Inf|Nor|2010-11-08|webdav LOCK access with multiple threads to same f|
|50261|New|Nor|2010-11-12|graceful restart with multiple listeners using pre|
|50262|New|Nor|2010-11-12|mod_rewrite log ip address vs hostname            |
|50274|New|Nor|2010-11-15|always pass CONTENT_LENGTH to the application     |
|50278|New|Nor|2010-11-16|-DFOREGROUND and ap_unixd_killpg()/ap_os_killpg() |
|50290|Inf|Nor|2010-11-18|vanilla apache 2.2.17 installation crashes (lib-ap|
|50296|New|Nor|2010-11-18|LDAPVerifyServerCert and possibly LDAPTrustedMode |
|50317|New|Nor|2010-11-22|Possible error in mod_cache's "Avoiding the Thunde|
|50336|New|Min|2010-11-25|PUT failures do not emit Allow:                   |
|50344|New|Nor|2010-11-26|ProxyPass does not handle different protocols when|
|50357|New|Enh|2010-11-28|improve matching mechanisms for mime type and enco|
|50372|New|Enh|2010-11-29|any reason for allowing ModMimeUsePathInfo only in|
|50390|New|Nor|2010-11-30|WARNING: Unrecognized options : --disable-ipv6    |
|50402|New|Nor|2010-12-02|SetEnv proxy-sendchunks is ignored for small amoun|
|50412|New|Nor|2010-12-04|if IndexOptions +XHTML, the correct MIME type shou|
|50423|Inf|Nor|2010-12-06|Apache is terminated with signal 11, Segmentation |
|50427|New|Nor|2010-12-07|Windows>=Vista+mod_auth_digest+command line=proble|
|50432|New|Enh|2010-12-08|add PCRE-mode for file based matches              |
|50436|New|Enh|2010-12-08|VirtualHost could behave like people expect it to |
|50444|New|Enh|2010-12-09|Pre-close logging handles in cgid agent           |
|50456|Inf|Nor|2010-12-10|Invalid Error 413 crash Apache                    |
|50464|New|Blk|2010-12-13|undefined reference to `BIO_set_callback' `BIO_set|
|50466|Inf|Maj|2010-12-13|httpd process doesn't recycle                     |
|50473|New|Maj|2010-12-14|zlib.dll Problem                                  |
|50521|New|Nor|2010-12-25|Comment at top of sample main config file is wrong|
|50525|New|Nor|2010-12-28|Header directive won't edit Location header from P|
|50530|New|Enh|2010-12-29|Provide rate limiting for failed authentication at|
|50532|New|Enh|2010-12-30|Mail protection                                   |
|50551|New|Nor|2011-01-06|Some proxied connections ignore ttl setting       |
|50562|Opn|Cri|2011-01-09|wrong PATH_INFO CGI environment with non-ASCII UTF|
|50584|New|Enh|2011-01-14|Add error message when RequestReadTimeout triggere|
|50592|New|Maj|2011-01-15|httpd dumps core on an IPv6 only system           |
|50602|New|Nor|2011-01-17|non thread safe functions used in apache httpd pro|
|50619|New|Min|2011-01-19|After changing resolv.conf signaling httpd doesn't|
|50628|New|Blk|2011-01-21|Core dump happens with Apache 2.2.15 using openssl|
|50630|New|Nor|2011-01-21|Apache return 500 error with authentication by LDA|
|50644|New|Enh|2011-01-24|Add support for maximum number of requests per Kee|
|50654|New|Nor|2011-01-25|FileETag ContentMD5 & Filename, optimisation to Co|
|50693|New|Nor|2011-01-31|AllowOverride Options=(not Foo) should permit no-o|
|50704|Inf|Nor|2011-02-01|mod_cache doesn't cache MultiViews                |
|50712|New|Maj|2011-02-02|Restart button only stops the server ...and do not|
|50727|New|Nor|2011-02-07|ISAPI EXTENSION_CONTROL_BLOCK Missing PostData wit|
|50765|New|Enh|2011-02-11|Runtime Backend Pinning via balancer-manager      |
|50770|New|Nor|2011-02-14|a rotatelogs issue, if time changed               |
|50773|Inf|Nor|2011-02-14|Dav lock database corruption                      |
|50774|New|Enh|2011-02-14|Have a way to invalidate cache without other reque|
|50777|New|Nor|2011-02-14|Back port buildconf specifies AC_PREREQ(2.13) fix |
|50796|New|Enh|2011-02-16|record time between keepalives in access log      |
|50807|New|Maj|2011-02-18|mod_proxy fails to send FIN response when a FIN is|
|50814|New|Nor|2011-02-21|SSI exec not working on Windows (Apache 2.x)      |
|50848|New|Enh|2011-03-01|Content Negotiation type map file precedence could|
|50869|New|Enh|2011-03-04|Need directive to control use and timeout of sessi|
|50873|New|Nor|2011-03-04|httpd does not start properly when built from sour|
|50878|New|Nor|2011-03-05|redundant operation when calling apr_stat         |
|50891|New|Nor|2011-03-08|Apache rewrites WWW-Authenticate headers from CGI |
|50902|Inf|Maj|2011-03-09|on major load on the server, poll() hangs         |
|50916|New|Nor|2011-03-11|RewriteMap program: mod_rewrite sends request but |
|50926|New|Nor|2011-03-14|unexpected <Directory> file-matching behavior     |
|50942|New|Maj|2011-03-17|Apache 2.2.16 forward proxy is 5x times slower tha|
|50945|Opn|Nor|2011-03-18|AJP: Missing support for ErrorOverride            |
|50948|Opn|Nor|2011-03-19|Connection not closed when CGI dies waiting for PO|
|50954|New|Nor|2011-03-21|ProxyRemote doesnt use CONNECT method with https s|
|50959|New|Enh|2011-03-23|Add cache-manifest to the mime type list          |
|50976|New|Nor|2011-03-26|Apache losts client's ip (%a or %h) sometimes.    |
|50999|Opn|Nor|2011-03-30|it seems the configure wrong detect my apr-util ve|
|51001|New|Nor|2011-03-31|patch for hook ap_lua_run_lua_open                |
|51005|New|Enh|2011-04-01|Allow to use username in LDAP filter              |
|51006|New|Blk|2011-04-01|Apache consume all memory and swap when setup as r|
|51019|New|Enh|2011-04-04|[PATCH] Implementation of Asynchronous processing |
|51020|Opn|Nor|2011-04-04|[PATCH] Apache/mod_fcgid.so does not start in comp|
|51022|New|Nor|2011-04-05|Segmentation fault on PUT request                 |
|51030|New|Enh|2011-04-06|Way to terminate CGI immediatly after closing conn|
|51078|Inf|Nor|2011-04-18|[PATCH] mod_fcgid spawned CGI Processes gets orpha|
|51079|New|Enh|2011-04-18|[PATCH] mod_fcgid spawned CGI Process cannot imper|
|51080|New|Nor|2011-04-18|[PATCH] mod_isapi does not support Except:100-Cont|
|51103|Opn|Nor|2011-04-21|mod_reqtimeout does not drop connection and return|
|51104|Opn|Maj|2011-04-21|C++ support about httpd_config.h                  |
|51107|New|Min|2011-04-22|SetOutputFilter and SetInputFilter should allow "n|
|51118|New|Nor|2011-04-26|LDAP cache is cleared after graceful/restart and o|
|51127|New|Nor|2011-04-27|Make ProxyPassReverseCookiePath work as expected  |
|51168|New|Nor|2011-05-08|mod_status Total Traffic won't take account of int|
|51170|New|Nor|2011-05-09|I/O errors when using keep-alive + mod_ssl        |
|51174|New|Min|2011-05-09|SSLRequire predicates using OIDs unknown to openss|
|51186|New|Blk|2011-05-11|NEw Openssl 1.0.1 with new FIPS                   |
|51190|New|Min|2011-05-12|::/0 does not work with allow from and deny from  |
|51194|New|Nor|2011-05-13|FcgidWrapper does not support paths containing a s|
|51201|Inf|Nor|2011-05-15|Strange behavior REQUEST_METHOD & GET in mod_rewri|
|51223|New|Nor|2011-05-18|304 HTTP Not Modified strips out CORS headers     |
|51224|New|Nor|2011-05-18|mod_dav_fs should respect FileETag                |
|51239|New|Nor|2011-05-21|ap_get_client_block may block continuously sometim|
|51257|New|Nor|2011-05-24|Build failed when cross-compiling: ./gen_test_char|
|51258|Opn|Enh|2011-05-24|new features for mod_substitute                   |
|51296|New|Enh|2011-05-31|Dynamic engine support using SSLCryptoDevice suppo|
|51297|New|Nor|2011-05-31|Improve error handling during "UNLOCK"            |
|51303|New|Nor|2011-05-31|TraceEnable 500 error                             |
|51312|New|Nor|2011-06-01|mod_filter should support adding to the Vary heade|
|51322|New|Enh|2011-06-04|Prepend and append string to LDAP search parameter|
|51359|Inf|Enh|2011-06-11|Added shebang check for //! so that .js scripts wo|
|51365|New|Nor|2011-06-13|Mod_proxy mangles query string with mod_security  |
|51402|New|Nor|2011-06-21|"ForceLanguagePriority Fallback" not working as im|
|51406|New|Maj|2011-06-21|When listing files in subdirectories, the path is |
|51409|New|Nor|2011-06-21|Sorting options accepted by ls, but ignored       |
|51471|New|Nor|2011-07-04|<DirectoryMatch>ed IndexIgnore doesn't            |
|51479|New|Enh|2011-07-05|[PATCH] AB feature to optionally read in a reusabl|
|51491|New|Nor|2011-07-08|mod_dir breaks POSTs to URLs not ending in /      |
|51495|New|Nor|2011-07-11|mod_substitute cpu and memory limit               |
|51517|New|Maj|2011-07-16|mod_proxy_fcgi is not RFC 3875 compliant (SCRIPT_F|
|51522|Ver|Trv|2011-07-18|Wrong French translation in mpm.html ("Certains Mo|
|51542|New|Nor|2011-07-22|Apache HTTP Server vs PVS-Studio                  |
|51543|New|Nor|2011-07-22|Space in username not properly escaped in log file|
|51552|Inf|Cri|2011-07-25|Apache is not starting (2.2.15)                   |
|51573|New|Enh|2011-07-28|Easy way to erase log files                       |
|51576|Inf|Nor|2011-07-28|mod_rewrite rule stopped working                  |
|51600|New|Enh|2011-08-02|Loading the same certificate in multiple virtual h|
|51603|Inf|Maj|2011-08-02|Apache accepts completely bogus HTTP requests (pos|
|51607|Inf|Nor|2011-08-03|DBDPrepareSQL ( ap_dbd_prepare ) does not work cor|
|51629|New|Nor|2011-08-05|DocumentRoot check incorrect when running under ch|
|51674|New|Blk|2011-08-18|AJP Module Bad Request                            |
|51679|New|Min|2011-08-18|Code signature key expired                        |
|51689|New|Trv|2011-08-19|Cross compiling causes multiple Listen directives |
|51695|New|Trv|2011-08-20|Code clean up (ap_rputs merge)                    |
|51707|New|Nor|2011-08-22|ProxyPassReverse issues within <Location> (differe|
|51709|New|Nor|2011-08-23|ServerName/ServerAlias don't work if Host: header |
|51711|New|Nor|2011-08-23|mod_auth_digest have broken shared mem (nonce) cod|
|51718|New|Enh|2011-08-24|Feature Request: Add shorthand to redirect any Ser|
|51725|New|Nor|2011-08-26|Multiple Range: request accepted as "Range: n-m"  |
|51732|New|Nor|2011-08-29|Inconsistencies in log messages' verbosity levels |
|51747|New|Blk|2011-08-31|mod_fcgid loads entire request into memory while p|
|51757|Inf|Enh|2011-09-02|Add support for SASL auth in LDAP                 |
|51778|Inf|Cri|2011-09-07|while buliding(make) a unix source "httpd-2.2.20.t|
|51797|Inf|Maj|2011-09-10|Crash HTTPD(Windows)                              |
|51814|New|Enh|2011-09-14|mod_proxy in Apache HTTP 2.2 FIN_WAIT2 in server s|
|51858|Inf|Nor|2011-09-21|weird error for mod_rewrite with more then 3 param|
|51864|New|Nor|2011-09-22|mod_cache returns entire entity from origin server|
|51904|New|Nor|2011-09-28|output to stderr from cgi script causes script to |
|51951|New|Nor|2011-10-04|mod_mbox hang on some e-mails on press@a.o - was I|
|51964|Ver|Nor|2011-10-05|Documentation of RewriteRule flag skip unclear    |
|51965|New|Nor|2011-10-05|--with-z=DIR not being honored                    |
|51982|Opn|Nor|2011-10-06|ProxyPassReverse / balancer://cluster/ adds slash |
|51987|Inf|Nor|2011-10-07|RewriteRule doesn't work correctly with apache 2.3|
|51994|New|Enh|2011-10-07|Mod_authn_socache should have some way to flush th|
|52004|Ver|Trv|2011-10-10|Typo "indexe" in French translation of mpm.html   |
|52007|New|Nor|2011-10-10|Content-Length: 0 not set on proxy response       |
|52038|New|Nor|2011-10-16|NameWidth works incorrectly together with Charset=|
|52039|Inf|Nor|2011-10-16|Browser mode does not always work                 |
|52043|New|Nor|2011-10-17|Directories ".", "..", and "/" do not work correct|
|52081|New|Nor|2011-10-24|segfault if mbox files have unexpected names      |
|52090|New|Maj|2011-10-26|Apache thread hangs with error 500 when sending a |
|52120|Opn|Nor|2011-11-01|mod_cache edge case: uncacheable 304 sends cached |
|52123|New|Maj|2011-11-02|DoS: High memory usage in propfind                |
|52132|New|Nor|2011-11-03|[PATCH] process activity score calculated incorrec|
|52139|New|Nor|2011-11-05|Never Syntax Error on non-existent DocumentRoot   |
|52171|Ver|Nor|2011-11-13|confusing documentation of request phases         |
|52174|New|Enh|2011-11-13|Allow hard lower-limits on the number of fcgi serv|
|52178|New|Nor|2011-11-14|IPv6 IPs as ServerName not allowed                |
|52181|Ver|Nor|2011-11-14|mod_rewrite Technical Details Ruleset Processing d|
|52195|Inf|Nor|2011-11-16|Japanese texts are garbled on mailing list archive|
|52196|Inf|Nor|2011-11-16|winnt mpm, others mpm also have this bug. pool sha|
|52207|Inf|Maj|2011-11-18|Upgrade apache version from 2.0.59 to 2.2.12 or ab|
|52222|New|Nor|2011-11-21|IndexIgnore ignores parent directories in argument|
|52247|New|Nor|2011-11-26|mod_mbox gives up on unexpected message format    |
|52248|New|Nor|2011-11-26|Bugzilla version drop-down list does not offer "un|
|52252|New|Nor|2011-11-27|luajit support broken for (at least) luajit 2.0   |
|52253|Inf|Nor|2011-11-28|Timeout doesn't work. mod_proxy_balancer strongly |
|52264|New|Enh|2011-11-30|Update and complete balancer-manager XML output   |
|52269|Inf|Nor|2011-12-01|[mod_proxy] Apache reverse proxy status code trans|
|52275|New|Nor|2011-12-02|memory leak in proxy_ajp_handler                  |
|52298|Inf|Nor|2011-12-07|Can't enter website with client certificate on an |
|52301|New|Enh|2011-12-07|Error message "RSA server certificate ... CN ... d|
|52302|New|Enh|2011-12-07|Better documentation of how server name is determi|
|52304|New|Nor|2011-12-08|<Limit> Does Not Apply When URI Is Folder         |
|52313|New|Enh|2011-12-09|htdbm enhancement: options for colon-in-username, |
|52322|Inf|Enh|2011-12-13|Providing BBC developed httpd modules for inclusio|
|52342|New|Nor|2011-12-15|ap_internal_redirect dropping filters means incons|
|52370|New|Nor|2011-12-19|apreq_decode/url_decode length miscalculation     |
|52377|New|Enh|2011-12-20|Add Directives to assert user, group, and permissi|
|52383|New|Trv|2011-12-24|Instllation log typo                              |
|52391|New|Cri|2011-12-27|100% CPU usage while using Forward Proxy          |
|52395|New|Nor|2011-12-29|reload results in different end environment to res|
|52403|New|Nor|2011-12-31|FallbackResource doesn't work for non-existent PHP|
|52408|New|Nor|2012-01-01|Directoryindex matching automatically redirects   |
|52415|New|Nor|2012-01-03|LockFile placed inappropriately                   |
|52417|New|Nor|2012-01-03|HEADERS information in the file                   |
|52435|New|Nor|2012-01-06|Apache shutdown automatically                     |
|52439|New|Nor|2012-01-09|It should be possible to treat errors in .htaccess|
|52453|New|Enh|2012-01-11|Ability to configure --logfiledir                 |
|52465|New|Nor|2012-01-13|mod_dir is allowed to redirect proxy requests     |
|52481|New|Nor|2012-01-18|Rotatelog.exe crashes Apache after setting 256MB r|
|52485|New|Nor|2012-01-19|CPU load 100%                                     |
|52494|New|Enh|2012-01-22|allow the Action directive to point in the filesys|
|52495|New|Enh|2012-01-22|CACertificate, CADNCertificate, CARevocation, Cert|
|52501|New|Cri|2012-01-23|child pid 10824 exit signal Segmentation fault (11|
|52505|New|Nor|2012-01-23|Include with directory wildcards gives errors for |
|52509|New|Nor|2012-01-23|Resources protected by .htaccess file may not be a|
|52510|New|Cri|2012-01-23|Segmentation Fault 11                             |
|52520|New|Nor|2012-01-24|ProxyRemote & NoProxy directive can not take IPv6 |
|52532|New|Trv|2012-01-26|VirtualHost added TWICE to name-virtual-host list |
|52539|New|Nor|2012-01-26|Apache mod_dav 400 Bad Request for non-existent co|
|52546|New|Nor|2012-01-27|overwrite SERVER_PROTOCOL environment             |
|52573|New|Nor|2012-02-01|mod_speling case correction fails when URI has dou|
|52578|Opn|Enh|2012-02-02|Wrong "bytes sent" logged when connection is close|
|52594|New|Nor|2012-02-03|rpmbuild -ba errors out with "File not found by gl|
|52595|New|Nor|2012-02-03|requests with gzip+chunked encoded body don't prox|
|52605|Inf|Min|2012-02-05|Please allow request lines longer than 8k         |
|52612|New|Nor|2012-02-06|Default Service Account                           |
|52616|Opn|Enh|2012-02-07|SSLUserName uses SSL_CLIENT_S_DN insted of SSL_CLI|
|52617|New|Maj|2012-02-07|Visit the rewrite page from ServerAlias domain vho|
|52623|New|Nor|2012-02-08|does not build with pcre-8.30                     |
|52644|New|Nor|2012-02-12|document how SSL FakeBasicAuth works with strange |
|52668|New|Trv|2012-02-14|More future safe patch for old MSIE ssl-unclean-sh|
|52670|New|Trv|2012-02-15|please clarify the effect of SSLStrictSNIVHostChec|
|52683|New|Enh|2012-02-16|add a symlink option that rechecks the access perm|
|52700|Inf|Blk|2012-02-17|Not rendering html content instead displaying clie|
|52703|Inf|Maj|2012-02-18|SSL+SNI+client-auth "lost" after some time        |
|52710|New|Nor|2012-02-19|mod_fcgid should set PATH_INFO when configured in |
|52756|Inf|Trv|2012-02-24|proxy_html_module LoadModule line not created in h|
|52759|New|Cri|2012-02-24|Apache httpd child process consuming high CPU Util|
|52790|New|Nor|2012-02-28|ldap caching not sufficient                       |
|52795|Opn|Nor|2012-02-29|mod_fcgid fails to spawn process in C:\Program Fil|
|52806|New|Nor|2012-03-01|configure: --with-included-apr is not supported in|
|52807|New|Nor|2012-03-01|some random strings are accepted by "configure" as|
|52816|New|Nor|2012-03-03|Potential segfault in socache_shmcb_create        |
|52817|New|Nor|2012-03-03|Long directory path sucks (but it's really a valid|
|52822|New|Nor|2012-03-04|Quiet installation not fully quiet                |
|52824|Inf|Nor|2012-03-04|Conflicts between AllowOverride and AllowOverrideL|
|52828|New|Maj|2012-03-05|Child process is not replaced in Windows, after a |
|52832|New|Nor|2012-03-05|numerical configuration entry can be mistakenly in|
|52841|Opn|Nor|2012-03-06|[proxy_balancer:emerg] [pid 25593] AH01177: Failed|
|52851|New|Nor|2012-03-07|Core TimeOut directive doesn't work               |
|52860|New|Enh|2012-03-08|Support Transfer-Encoding: gzip                   |
|52865|New|Nor|2012-03-09|Crash by segmentation fault in mod_authn_core in A|
|52870|New|Cri|2012-03-09|100% CPU usage while using Forward Proxy          |
|52874|New|Enh|2012-03-09|Support Use TrustedFirst checking when verifying c|
|52884|New|Nor|2012-03-12|"localhost" leads to start failure                |
|52890|Inf|Nor|2012-03-12|--with-included-apr doesn't work when srclib/apr a|
|52891|New|Nor|2012-03-12|2.2 doesn't perform as well as 1.3                |
|52894|Inf|Nor|2012-03-13|Apache aborts abnormally when ChrootDir is set    |
|52927|Inf|Nor|2012-03-16|[Bug in httpd 2.2.4] [error] (70014)End of file fo|
|52933|New|Nor|2012-03-17|Child survives '-k stop', consuming lots of CPU   |
|52950|New|Nor|2012-03-20|Error when set AuthType to None with valid-user   |
|52963|New|Nor|2012-03-21|Typo in AuthLDAPURL RFC 2255 error message        |
|52975|New|Nor|2012-03-23|Receiving files is suboptimal                     |
|52976|New|Min|2012-03-23|Gratuitous string-duplication in module-configurat|
|52978|New|Enh|2012-03-23|Binding to an interface instead of an address     |
|52995|New|Nor|2012-03-28|httpd -V does not print the default Mutex         |
|53002|New|Nor|2012-03-29|<Location> and auth_form (trailing slash problem?)|
|53015|New|Nor|2012-03-31|missing apr_socket_close                          |
|53016|New|Nor|2012-03-31|missing apr_brigade_destroy                       |
|53023|New|Nor|2012-04-02|mod_rewrite RewriteCond parser error and documenta|
|53037|New|Enh|2012-04-05|clarify mod_ssl documentation on the UID/GID conte|
|53059|New|Nor|2012-04-10|Make httpd easier relocatable by using a variable |
|53098|New|Nor|2012-04-18|mod_proxy_ajp: patch to set worker secret passed t|
|53099|New|Enh|2012-04-18|feature request for mod_remoteip                  |
|53108|New|Enh|2012-04-19|clarification on url-path vs full filesystem path |
|53111|New|Nor|2012-04-20|1% of CMS sites expose database passwords         |
|53121|New|Nor|2012-04-22|Confusing documentation, gzip and deflate         |
|53149|New|Enh|2012-04-25|mod_ldap should/could use mod_socache             |
|53152|Opn|Nor|2012-04-26|RewriteRule documentation: Error about per-directo|
|53156|New|Enh|2012-04-27|CRL validation fails if CRL is missing            |
|53160|New|Cri|2012-04-29|Reverse Proxy mod_deflate doesn't zip back content|
|53183|New|Min|2012-05-03|mod_apreq2 entry point is apreq_module and not apr|
|53193|New|Nor|2012-05-04|SLVerifyClient optional_no_ca + SSLSessionCache = |
|53218|New|Blk|2012-05-11|ProxyPass worker name(http://localhost:3128/...|
|53233|New|Maj|2012-05-15|Internal error: proxy: error reading status line f|
|53239|New|Maj|2012-05-16|Httpd has problems delivering data on rate-limited|
|53253|New|Maj|2012-05-17|TCP_NOPUSH used with sendfile(2), cause transfers |
|53284|New|Nor|2012-05-24|crash                                             |
|53290|New|Maj|2012-05-24|memory usage                                      |
|53292|New|Min|2012-05-25|add support for HTTP status code 308              |
|53305|New|Nor|2012-05-28|404 errors when adding query string in a balancer |
|53313|New|Nor|2012-05-28|SSI #echo VAR fails (#include OK) if URI/URL has f|
|53319|New|Nor|2012-05-29|Multiple DirectoryIndex statements in the same con|
|53332|New|Nor|2012-05-30|Requests with chunked encoding have no body availa|
|53350|New|Nor|2012-06-01|mod_cache caching 403 responses Apahce 2.2.22     |
|53351|New|Nor|2012-06-02|make fails if layout begins on first line of confi|
|53388|Opn|Nor|2012-06-08|mod_proxy_balanser generates 503 when proxying to |
|53402|New|Trv|2012-06-12|Incorrect error message for mod_ldap params       |
|53461|Inf|Cri|2012-06-23|Compilation problems                              |
|53462|New|Nor|2012-06-25|mod_rewrite does not remove trailing slash when as|
|53479|New|Nor|2012-06-27|mod_rewrite [B] flag should percent-encode the spa|
|53483|New|Enh|2012-06-29|dangerous PCRE patterns in *Match directives      |
|53539|New|Maj|2012-07-12|content type and character set are changing when t|
|53554|New|Nor|2012-07-16|Wrong case for hexadecimal percent encoding [patch|
|53555|New|Maj|2012-07-17|Scoreboard full error with event/ssl              |
|53579|New|Cri|2012-07-20|httpd looping writing on a pipe and unresponsive (|
|53581|New|Blk|2012-07-21|FollowSymlinks doesn't work with DirectoryMatch an|
|53594|New|Enh|2012-07-24|ipad as webserver                                 |
|53595|New|Nor|2012-07-24|Media type qs parameters for MultiViews sent in Co|
|53612|Inf|Nor|2012-07-27|Reverse Proxy causing 500 error SSL proxy 1.0.1c O|
|53618|New|Nor|2012-07-29|proxy_worker_shared fields not maintained in threa|
|53634|New|Nor|2012-08-01|mod_cache returning HTTP 200 for nonexistent resou|
|53638|New|Nor|2012-08-02|Problem with shortcuts to bugzilla in http://httpd|
|53640|Inf|Maj|2012-08-02|make: Fatal error: Command failed for target `htpa|
|53643|New|Cri|2012-08-02|apache segfaults with mod_authn_dbd when dbd_min i|
|53646|New|Nor|2012-08-02|Invalid uniformly distributed balancing of request|
|53651|New|Nor|2012-08-03|Worker failure doesn't have same behaviour as work|
|53667|New|Enh|2012-08-07|Add an equivalent option to "JkOptions ForwardLoca|
|53669|New|Nor|2012-08-07|IndexOptions Incremental IndexOptions documentatio|
|53686|New|Enh|2012-08-09|Status "501 Not Implemented" sent very late       |
|53690|New|Nor|2012-08-09|Calls to semctl() trigger "uninitialized memory" w|
|53692|New|Nor|2012-08-10|mod_auth_form loses request body before login page|
|53693|Opn|Nor|2012-08-10|mod_fcgid performance suffers under increase in re|
|53704|New|Enh|2012-08-13|True online configuration is needed - via LDAP?   |
|53705|New|Nor|2012-08-13|Align server-status balancer display to balancer-m|
|53706|New|Enh|2012-08-13|Include a status display for mod_ldap when present|
|53722|New|Nor|2012-08-15|when -D NO_DETACH is used, no PID file should be c|
|53736|New|Nor|2012-08-17|/balancer-manager doesn't save runtime adjusted se|
|53757|New|Enh|2012-08-21|RewriteMap of type txt should allow specifying col|
|53767|New|Nor|2012-08-23|htcacheclean deletes stale "vary" header files eve|
|53772|New|Nor|2012-08-24|REDIRECT_URL not accessible in mod_proxy          |
|53787|New|Reg|2012-08-28|In forward proxy, doesn't cache disk anymore      |
|53823|New|Nor|2012-09-03|[patch] pure IPv6 only host fix (server/config.c) |
|53835|New|Cri|2012-09-06|mod_proxy_ajp truncate output when using deflate i|
|53870|New|Maj|2012-09-13|Deadlock in CRYPTO_add_lock with Apache 2.2.22 wor|
|53886|New|Nor|2012-09-18|can't start apache control in Redhat Linux 3 X64  |
|53899|New|Nor|2012-09-19|SSL_OP_ALL disables the mitigation code for CVE-20|
|53915|New|Nor|2012-09-21|Colon lost when :port is used in CacheKeyBaseURL  |
|53919|Inf|Enh|2012-09-21|DEFAULT_LOG_FORMAT is not RFC6302 compliant       |
|53923|New|Min|2012-09-23|Overriding CustomLog directive seems impossible   |
|53932|New|Nor|2012-09-25|PROPFIND doesn't support If, If-Match ETag predica|
|53947|New|Enh|2012-09-29|Feature Request, RewriteRule - ProxyPreserveHost f|
|53961|New|Nor|2012-10-04|Null sessions to the default vhost                |
|53970|New|Nor|2012-10-05|Network control directives affects internal subreq|
|53981|New|Nor|2012-10-08|move def of log_request_state from mod_log_config.|
|53988|New|Enh|2012-10-10|Missing FCGIWrapper script should not be a critica|
|53999|Opn|Nor|2012-10-13|Deadlock between procmgr_send_spawn_cmd()/proctabl|
|54030|New|Enh|2012-10-19|Support subjectAltName when (reverse-)proxying    |
|54033|New|Enh|2012-10-21|Parent languages are not ordered according to Acce|
|54072|New|Reg|2012-10-30|Syntax error front-end virtual-path too long      |
|54102|New|Enh|2012-11-05|new feature: automatic route detection            |
|54118|New|Nor|2012-11-08|Handle leak on parent httpd process when rotatelog|
|54126|New|Maj|2012-11-09|Mod_rewrite failing because of url in query string|
|54134|New|Enh|2012-11-11|new feature: ability to use multiple routes in sti|
|54136|New|Min|2012-11-11|balancer-handler shows xml not, when only xml para|
|54158|New|Nor|2012-11-16|Suggestion regarding 2.0 to 2.2 Upgrade Documentat|
|54183|Inf|Nor|2012-11-21|PROPFIND doesn't report getcontenttype property   |
|54215|New|Maj|2012-11-27|configure fails for httpd 2.2.3 with openssl 1.0.1|
|54221|Opn|Nor|2012-11-28|no ErrorLog prefix on CGI errors                  |
|54222|New|Min|2012-11-28|ServerTokens checking is not complete             |
|54223|New|Nor|2012-11-29|AH00554 error when runtime configuration Includes |
|54252|New|Nor|2012-12-05|acinclude.m4 requires -lz when linking with ssl st|
|54253|New|Nor|2012-12-05|mod_proxy_ftp doesn't handle/log partial or cancel|
|54255|New|Nor|2012-12-06|mod_deflate adjusts the headers "too late", should|
|54269|New|Maj|2012-12-09|mod_proxy_html documentation misses several things|
|54276|New|Nor|2012-12-10|rotatelogs not getting killed on graceful restart |
|54280|New|Nor|2012-12-11|mod_auth_form inline login not working with traili|
|54281|New|Nor|2012-12-11|Stick use Partial parameters from query string    |
|54289|New|Nor|2012-12-13|"ap_get_brigade" api is failing in "AP_MODE_SPECUL|
|54306|New|Enh|2012-12-15|add regexp versions of ProxyPassReverse, ProxyPass|
|54309|New|Trv|2012-12-15|clarification on the <Location> directive when use|
|54310|Opn|Nor|2012-12-15|mod_proxy_html drops meta elements with http-equiv|
|54319|New|Reg|2012-12-17|ProxyPass has no effect in <Location> if rewrite o|
|54339|New|Nor|2012-12-21|piped log entries > PIPE_BUF can be interleaved   |
|54342|New|Nor|2012-12-22|AuthnCacheSOCache can't pass args to socache provi|
|54343|New|Maj|2012-12-22|Add sanity checks for malloc() in mpm_winnt.c and |
|54358|New|Nor|2012-12-29|Status 500 when using ldap on Solaris because apr_|
|54363|New|Nor|2012-12-31|make time conversion caching functions thread-safe|
|54364|New|Nor|2012-12-31|Add ref to mod_fcgid docs                         |
|54365|New|Nor|2013-01-02|Connection closed by server during file transfer  |
|54366|New|Nor|2013-01-02|$sysconfdir/extra/httpd-dav.conf is not built base|
|54367|Opn|Maj|2013-01-02|Location header in response to PUT is not %-escape|
|54385|New|Enh|2013-01-08|SSL configuration independent from virtual hosts, |
|54401|New|Nor|2013-01-10|Suggest to make ProxyPassReverseCookieDomain accep|
|54415|New|Enh|2013-01-14|Please tell the root cause of mutex and scoreboard|
|54431|Inf|Blk|2013-01-16|Unable to start the Apache 2.4.3 windows service. |
|54498|New|Nor|2013-01-28|apache crash on any cgi request with certain http |
|54502|New|Nor|2013-01-29|Apache deadlock on epoll_ctl error (1000 process l|
|54512|Inf|Cri|2013-01-31|Apache hung                                       |
|54517|New|Nor|2013-02-01|proxy balancer: timeout or partial failure of back|
|54518|New|Nor|2013-02-01|mod_rewrite not adding Vary header                |
|54519|New|Nor|2013-02-02|httpd already running                             |
|54526|New|Nor|2013-02-05|mod_proxy_http ignores request abortion           |
|54543|New|Enh|2013-02-10|Compile regex only when need                      |
|54546|New|Nor|2013-02-11|httpd crashes on first HUP after change Listen dir|
|54549|New|Nor|2013-02-11|mod_mime AddEncoding and mod_negotiation fix_encod|
|54556|New|Enh|2013-02-13|New flag to add default rule in rule chain        |
|54560|New|Nor|2013-02-13|Potential segfault on return from ap_server_root_r|
|54563|New|Maj|2013-02-15|mod_webdav ignores quota                          |
|54578|New|Nor|2013-02-18|Bad docs or unchecked code for "LimitRequestFields|
|54605|New|Enh|2013-02-24|mod_negotiation should cache the info it generates|
|54608|New|Enh|2013-02-25|Support an option to allow page caching when using|
|54622|New|Nor|2013-02-28|shared memory cleanup                             |
|54626|New|Nor|2013-03-01|mod_authnz_ldap through util_ldap.c does not suppo|
|54633|New|Nor|2013-03-04|Invalid % encoding not rejected                   |
|54637|New|Nor|2013-03-05|Digest: secret not used                           |
|54640|New|Nor|2013-03-05|Slow transaction on a balance member is holding su|
|54649|New|Nor|2013-03-06|Incorrect PIDFILE prevent httpd restart           |
|54653|New|Min|2013-03-08|Suggestion to add https example for forward proxy |
|54656|New|Maj|2013-03-09|SNI and SSLProxyCheckPeerCN based on "connection" |
|54657|New|Nor|2013-03-09|DNS lookup failure for load balancer member does n|
|54683|New|Min|2013-03-13|Ignor directive ErrorDocument with null byte      |
|54699|Opn|Enh|2013-03-15|[feature request] cli webaccess tester            |
|54701|New|Cri|2013-03-15|Apache 2.4.3 Migration Issue Not loading the pages|
|54704|New|Nor|2013-03-15|Web Services stalling on it's own                 |
|54719|New|Nor|2013-03-18|httpd should check for and eventually create pid f|
|54752|New|Nor|2013-03-25|mod_ssl should not use uninitialized memory as ran|
|54782|New|Nor|2013-04-02|Memory Corruption errors - mpm_worker mod_perl    |
|54785|New|Nor|2013-04-02|Random crash when httpd server is stopped         |
|54793|New|Nor|2013-04-03|Socket timeout handler can delete uploaded files P|
|54794|New|Reg|2013-04-03|mod_wsgi|fcgid and subversion >= 1.7 issues       |
|54795|New|Nor|2013-04-03|'apxs -g -n' should be self-referring             |
|54796|Inf|Enh|2013-04-03|CustomLog should be able to use syslog as ErrorLog|
|54804|New|Nor|2013-04-05|mod_fcgid sends a Continue 100 response automatica|
|54813|New|Nor|2013-04-08|documnt the Require args used by authz_dbm includi|
|54816|Inf|Nor|2013-04-08|AH00566: request failed: invalid characters in URI|
|54817|New|Nor|2013-04-09|if prefix and sysconfdir are the same then http.co|
|54820|Inf|Cri|2013-04-09|REwriterule stops working                         |
|54824|New|Nor|2013-04-10|Spec file is missing libuuid-devel requirement    |
|54830|New|Enh|2013-04-11|Make SSLPProxyMachineCertificateFile configurable |
|54848|New|Nor|2013-04-15|Client field too short for IPv6 addresses         |
|54856|Inf|Enh|2013-04-17|NSCreateObjectFileImageFromFile                   |
|54858|New|Nor|2013-04-17|ld duplicate                                      |
|54861|New|Blk|2013-04-18|The number of connections with mysql is more      |
|54869|Inf|Nor|2013-04-19|Non-breaking space characters cause httpd to choke|
|54875|New|Nor|2013-04-23|Conditional request predicated on another URL's ET|
|54878|New|Nor|2013-04-23|Multiple Listen directives prevent server to start|
|54905|Inf|Cri|2013-04-29|Apache2 loops in child Segfaults                  |
|54910|New|Enh|2013-04-30|Format %{Foobar}o cannot be used to log Date and S|
|54911|New|Enh|2013-04-30|Allow logging of fields set by a backend server in|
|54914|New|Nor|2013-04-30|mod_dir DirectoryIndex breaks WebDAV PROPFIND / DE|
|54915|New|Nor|2013-04-30|GET on a WebDAV-enabled collection, with Directory|
|54918|New|Enh|2013-05-02|Implement RFC 6797 HTTP Strict Transport Security |
|54919|Inf|Nor|2013-05-02|*** glibc detected *** /usr/sbin/httpd: double fre|
|54930|New|Nor|2013-05-06|Allow empty message in ErrorDocument directive    |
|54934|Inf|Cri|2013-05-07|Apache is crashing intermittently with a message "|
|54936|New|Nor|2013-05-08|Some potential bugs reported by static analysis to|
|54949|New|Nor|2013-05-10|[PATCH] mod_cache: fix uninitialized tmppath varia|
|54952|Inf|Cri|2013-05-10|[Fri May 10 17:39:01 2013] [error] proxy: CLUSTER:|
|54953|New|Nor|2013-05-11|<VirtualHost 0.0.0.0:80> matches IPv6             |
|54958|New|Nor|2013-05-13|mod_deflate + mod_mime with SSI gives mixed compre|
|54962|New|Maj|2013-05-14|Apache will set incorrect Content-Length header an|
|54965|New|Enh|2013-05-14|Allow ProxyPassMatch in Directory context         |
|54976|New|Nor|2013-05-15|ProxyPass parameter "acquire" and "ttl" ignored in|
|54986|New|Maj|2013-05-16|httpd hanging on large form submit in ap_run_handl|
|54989|New|Nor|2013-05-17|Apache Segfaults on OS X at random - how can I dia|
|54993|New|Nor|2013-05-20|Critical error: File descriptor in bad state: apr_|
|54998|Ver|Nor|2013-05-21|Apache 2.4 terminates all SSL connections using an|
|55000|New|Nor|2013-05-21|Memory usage per process doubles when Apache is co|
|55021|New|Enh|2013-05-28|Support arbitrary sql to authentication username/p|
|55022|Inf|Cri|2013-05-28|child pid 3123 exit signal Bus error (10) - Apache|
|55034|Inf|Maj|2013-05-31|Apache 2.4.4 won't open more that 32k VH file hand|
|55039|New|Enh|2013-05-31|"RequestHeader edit" can't access environment vari|
|55045|New|Nor|2013-06-01|calls to gets() in test_find.c and test_parser.c  |
|55068|New|Enh|2013-06-06|root permissions when writing to per vhosts errorl|
|55069|New|Min|2013-06-06|notice message in error_log even when LogLevel err|
|55070|Opn|Enh|2013-06-06|mod_fcgid stderr always goes to main error log    |
|55072|New|Nor|2013-06-07|ErrorLog doesn't work well when apache shutdown   |
|55093|New|Nor|2013-06-12|[PATCH] mod_fcgid 2.3.7 truncates large posts on R|
|55096|New|Nor|2013-06-12|Make not running on httpd configure Solaris       |
|55098|New|Nor|2013-06-13|does not listen to IP4 when both IP4 address and I|
|55106|New|Enh|2013-06-17|ProxyErrorOverride considers response codes >= 400|
|55117|New|Nor|2013-06-18|GracefullTimeout for worker threads               |
|55148|Inf|Nor|2013-06-26|Error during SSL Handshake with remote server     |
|55152|New|Nor|2013-06-28|graceful restart adjusts to new balancer members, |
|55156|New|Nor|2013-06-28|mod_cache not respecting s-maxage cache-control he|
|55178|New|Nor|2013-07-01|[PATCH] mod_authnz_ldap SASL authentication suppor|
|55192|New|Trv|2013-07-03|htaccess error messages missing request context   |
|55193|New|Min|2013-07-03|ErrorLogFormat is ignored by some modules         |
|55226|New|Enh|2013-07-09|Request for "domain cluster" feature for mod_proxy|
|55234|New|Maj|2013-07-10|Working of attribute "protocol" attribute "protoco|
|55276|Inf|Enh|2013-07-17|Add REST API for load balancer for dynamic registr|
|55278|New|Nor|2013-07-18|mod_session's cookie may be empty, is repeated twi|
|55284|New|Nor|2013-07-20|repeatable segv                                   |
|55286|New|Nor|2013-07-21|Floating point exception (8) in mod_auth_digest   |
|55293|New|Nor|2013-07-22|Incorrect default MIME type for .woff fonts       |
|55306|New|Nor|2013-07-25|Error when copying svn repository, which contains |
|55323|New|Nor|2013-07-29|Double unescaped uri in sub request handler       |
|55327|New|Nor|2013-07-30|Segmentation fault when stopping Apache 2.4.6 norm|
|55340|New|Maj|2013-08-01|Listen for valid, unconfigured IP address passes c|
|55344|New|Nor|2013-08-02|missing ap_hook_monitor on windows                |
|55346|New|Nor|2013-08-02|When on filled quota filesystem, mod_fcgid init in|
|55348|New|Nor|2013-08-02|%h is not changed in logging, only %a             |
|55351|New|Enh|2013-08-04|allow ProxyPassReverseCookieDomain to automaticall|
|55362|New|Nor|2013-08-05|Apache httpd sends "400 Bad Request" to client due|
|55379|New|Min|2013-08-07|htdigest -c doesn't behave as described anymore   |
|55394|New|Nor|2013-08-09|apache 2.4 randomy crashes with signal 6          |
|55401|New|Enh|2013-08-11|document that force-proxy-request-1.0 implies prox|
|55415|New|Maj|2013-08-14|Proxy loop caused by ProxyErrorOverride and ErrorD|
|55431|New|Nor|2013-08-16|mod_negotation does not force the mime type listed|
|55433|New|Nor|2013-08-16|mod_proxy ignores final status code for aborted re|
|55443|Inf|Maj|2013-08-17|never gives 300 multiple choices                  |
|55445|New|Maj|2013-08-18|mod_socache_memcache ignores expiry, creating eter|
|55447|New|Enh|2013-08-18|make type-maps usable again, by making them access|
|55448|New|Nor|2013-08-19|segfault in set_max_workers at event.c:3194 on SIG|
|55449|New|Maj|2013-08-19|AH01185: worker slotmem_create failed --> slotmem |
|55452|New|Maj|2013-08-19|Redirect                                          |
|55458|New|Enh|2013-08-20|allow to configure what mod_ssl responds when one |
|55460|New|Enh|2013-08-21|allow service names to be used in the Listen direc|
|55467|New|Nor|2013-08-21|Support for OpenSSL custom TLS extensions and supp|
|55523|New|Trv|2013-09-04|auth_groupfile error log on access even though suc|
|55535|Inf|Nor|2013-09-08|incorrect check state parametr                    |
|55540|New|Cri|2013-09-09|mod_proxy gzip chunked issue (sample site provided|
|55549|New|Min|2013-09-11|AuthLDAPSubGroupAttribute doesn't do anything     |
|55550|New|Nor|2013-09-11|AuthLDAPSubGroupClass checking is very inefficient|
|55556|New|Nor|2013-09-13|apachebench (ab) doesn't use so_reuseaddr         |
|55557|New|Nor|2013-09-14|Some cppcheck reports                             |
|55573|New|Enh|2013-09-19|FileETag needs MTimeSeconds, MTime with granularit|
|55581|New|Enh|2013-09-22|Support concurrent connections to same FastCGI pro|
|55590|Inf|Maj|2013-09-24|second commit is failing if space is in file name |
|55596|New|Enh|2013-09-25|Add date format used by Expires header            |
|55607|New|Enh|2013-09-28|Re-set HOME environment variable to directory from|
|55615|New|Nor|2013-09-30|Connections are starved and not balanced when conc|
|55619|New|Nor|2013-10-02|Apache httpd reported 500 internal error when uplo|
|55627|New|Min|2013-10-04|Remove unnecessary APLOGNO() for trace logging per|
|55636|Inf|Cri|2013-10-07|long lost child came home - Apache is not respondi|
|55646|Inf|Nor|2013-10-10|non-2xx responses are not considered errors       |
|55654|New|Nor|2013-10-15|Extract variables from configuration without start|
|55670|New|Min|2013-10-18|Startup may fail silently at post_config          |
|55673|New|Nor|2013-10-18|httpd fails to start with SSLProxyMachineCertifica|
|55680|New|Enh|2013-10-20|online manual directory option doesn't exist      |
|55698|New|Maj|2013-10-24|Apache 2.2 + mod_fcgid 2.3.7 (CentOS 6.4) graceful|
|55700|New|Enh|2013-10-24|add something like RewriteOptions InheritDown     |
|55707|New|Nor|2013-10-25|SSLProtocol directive seem to be ignored over diff|
|55708|New|Nor|2013-10-25|Access violation in msvcrt.dll when calling getenv|
|55711|New|Min|2013-10-28|--enable-foo doesn't enable foo                   |
|55712|New|Nor|2013-10-28|Relative <!--#include virtual="../file.shtml"--> g|
|55720|New|Enh|2013-10-29|separate LDAP Bind timeout from LDAPTimeout       |
|55738|New|Nor|2013-11-03|PVS-Studio: few issues                            |
|55763|New|Nor|2013-11-09|raise roots soft RLIMIT_NPROC on linux for high ma|
|55774|New|Nor|2013-11-13|ab: optionally accept tls client certificate      |
|55781|New|Nor|2013-11-15|ajp_read_header: ajp_ilink_receive failed; 120006)|
|55786|New|Maj|2013-11-16|SSLVerifyClient and OptRenegotiate result in a 403|
|55787|New|Maj|2013-11-16|Chroot fails with "Cannot chroot when not started |
|55790|New|Maj|2013-11-17|mod_fcgid lockfile hardcoded to be in /tmp        |
|55793|New|Enh|2013-11-18|DTrace/SystemTap support                          |
|55808|New|Nor|2013-11-21|File integrity verification using MD5 and SHA1    |
|55819|Inf|Nor|2013-11-27|Closing connection behaviour                      |
|55828|New|Cri|2013-11-28|Httpd not start if use ProxyPass balancer://      |
|55834|New|Maj|2013-12-02|Apache does not honor the openssl library path giv|
|55838|New|Nor|2013-12-03|PHP files are being executed instead of downloaded|
|55841|New|Nor|2013-12-04|Misleading news items on bugfix releases ("This ve|
|55856|New|Nor|2013-12-08|YYEMPTY (-2) used as index into yytname (const arr|
|55866|New|Nor|2013-12-11|When ProxyPreserveHost is on, SSL expects the wron|
|55878|New|Nor|2013-12-12|mod_fcgid kills spawned processes too early       |
|55881|New|Nor|2013-12-13|segmentation fault at proxy_util.c:1546           |
|55883|New|Enh|2013-12-14|string callers of ap_expr should be able to transf|
|55887|New|Maj|2013-12-16|In Windows apache, when user access to /con, apach|
|55898|New|Enh|2013-12-17|[RFE] listen on unix socket?                      |
|55914|New|Reg|2013-12-20|child exit segmentation fault after apache gracefu|
|55919|New|Nor|2013-12-22|EPREFIX and dynamic modules                       |
|55942|New|Nor|2014-01-01|400 - Bad Request on POST (Windows Server 2012 Hyp|
|55952|New|Nor|2014-01-05|ab: SSL keep-alive fails with apr_pollset_poll: Th|
|55962|New|Enh|2014-01-06|mod_remoteip should not allow an external proxy to|
|55963|New|Nor|2014-01-07|Add application/ld+json to mime.types             |
|55981|Opn|Nor|2014-01-09|mod_mbox hang on some e-mails on user@openoffice.a|
|55985|Opn|Nor|2014-01-10|apache does not reopen logs when multiple graceful|
|55989|Opn|Enh|2014-01-11|write to error log upon RewriteRule [F]orbidden   |
|55991|New|Nor|2014-01-12|mod_charset_lite doesn't bail out on non-identity |
|56009|Inf|Cri|2014-01-14|Memory leak in httpd 2.4.3 over time with persista|
|56014|New|Nor|2014-01-15|MOd rewrite CO Cookie method the lifetime flag not|
|56028|New|Enh|2014-01-17|Add http/1.0, http/1.1 NPN advertisement to enable|
|56034|New|Nor|2014-01-20|CPU consumption due to circular linked list in ap_|
|56040|New|Enh|2014-01-21|should be able to remove Max-Age cookie parameter |
|56041|New|Enh|2014-01-21|should be able to disable session expiry increment|
|56052|New|Nor|2014-01-22|ap_session_load called multiple times for expired |
|56055|New|Nor|2014-01-23|Route is not extracted properly when a session coo|
|56064|New|Enh|2014-01-25|Optimize PNGs                                     |
|56067|New|Nor|2014-01-27|FallbackResource doesn't work if directory exists |
|56081|New|Maj|2014-01-28|Apache 2.2.26 SIGSEGVs when POST'ing data         |
|56091|Inf|Nor|2014-01-30|SSL handshake error when httpd compiled on Oracle |
|56098|New|Nor|2014-02-01|duplicate cookie                                  |
|56101|New|Cri|2014-02-03|Apache 2.4.6 ceases processing requests (scoreboar|
|56102|New|Nor|2014-02-03|SSL_CLIENT_S_DN_x509_0 is undefined in the environ|
|56109|New|Nor|2014-02-05|Cannot increase the read limit                    |
|56113|New|Nor|2014-02-06|dist commit messages missing from mail-archives di|
|56131|New|Nor|2014-02-12|ProxyPassReverse / zealously replaces Location hea|
|56135|New|Nor|2014-02-13|Add DC to list of x509 components                 |
|56152|New|Nor|2014-02-18|ProxyBlock does not accept network addresses      |
|56176|New|Nor|2014-02-21|mod_substitute truncates the response body if the |
|56188|New|Nor|2014-02-25|mod_proxy_fcgi does not send FCGI_ABORT_REQUEST on|
|56209|New|Nor|2014-03-03|Uninitialised variables in os/win32/ap_regkey.c   |
|56226|Ver|Nor|2014-03-06|per VirtualHost KeepAliveTimeout is not recognized|
|56229|New|Enh|2014-03-06|ocsp ProxyHost and ProxyPort support              |
|56230|New|Nor|2014-03-07|mod_access_compat can log a bogus client denied me|
|56235|New|Nor|2014-03-07|quotes should be optional around expr             |
|56247|New|Cri|2014-03-12|semaphore creation for proxypass                  |
|56250|New|Nor|2014-03-12|sbindir in config.layout for Apache has bin instea|
|56251|New|Nor|2014-03-12|Increase maximum length of FcgidInitialEnv string |
|56252|New|Enh|2014-03-12|make install as privileged user creates files not |
|56262|New|Nor|2014-03-14|ab does not work with extremely long cookies      |
|56264|New|Trv|2014-03-14|Confusing error with .htaccess rewrite to proxy wh|
|56270|New|Enh|2014-03-15|--with-ssl=/foo w/o pkgconfig needs help on AIX 64|
|56288|New|Enh|2014-03-19|rewrite URLs in style attributes                  |
|56289|New|Nor|2014-03-19|Buffer overflow in mod_proxy_html's string replace|
|56308|New|Nor|2014-03-24|1 second delay in handle request kills performance|
|56312|New|Nor|2014-03-25|Can't configure different balancing workers that c|
|56314|New|Nor|2014-03-25|exiting from MPM-worker child caused assert in apr|
|56326|New|Nor|2014-03-27|cache_quick_handler does not serve responses with |
|56331|New|Nor|2014-03-29|windows 'access denied' during revalidaton of reso|
|56333|New|Enh|2014-03-31|API to resume a SUSPENDED connection              |
|56362|New|Maj|2014-04-08|ldaps only works with port 636. Non-standard port |
|56379|New|Nor|2014-04-09|Number of columns in the results returned from pgs|
|56395|New|Enh|2014-04-11|Allow SERVER_ADDR environment variable to be optio|
|56404|New|Nor|2014-04-12|endless loop  when connect to a website(https)  wh|
|56413|New|Blk|2014-04-15|can not restart httpd on centos 5.10 64bit        |
|56422|New|Nor|2014-04-17|authnz_ldap with other forms of authn can fail req|
|56457|New|Nor|2014-04-25|mod_proxy_html.c: 2 * cut'n'paste errors          |
|56473|New|Nor|2014-04-30|ETags don't change when headers do                |
|56475|New|Enh|2014-04-30|Allow TLS record size to be configured            |
|56483|New|Enh|2014-05-02|add disableKeepAlivePercentage similar to tomcat h|
|56493|New|Min|2014-05-06|mod_expires should not set expires in future for s|
|56495|New|Nor|2014-05-06|Application behind mod_proxy does not get SessionH|
|56500|Opn|Enh|2014-05-07|vhosts priority order with wildcard               |
|56504|New|Nor|2014-05-08|cannot build static support binaries              |
|56508|New|Nor|2014-05-09|Requiring SNI - SSLStrictSNIVHostCheck semantics  |
|56517|New|Enh|2014-05-12|Virtualhosts cannot inherit parent CustomLog      |
|56528|New|Enh|2014-05-15|"bad flags delimiter" - improve helpfulness       |
|56541|New|Nor|2014-05-18|Proxy 502's on large file post requests           |
|56559|New|Nor|2014-05-25|multiple unix sockets in one virtualhost fails    |
|56569|New|Nor|2014-05-27|Null CRC in gzip footer with mod_cgid and ErrorDoc|
|56587|New|Nor|2014-06-03|Many VirtualHost's with SSLEngine On              |
|56590|New|Enh|2014-06-04|(REST-) API for configuring balancer manager remot|
|56594|Inf|Nor|2014-06-05|mod_authn_dbd, mod_dbd and mod_ssl                |
|56598|New|Nor|2014-06-06|Content-Length header should be always interpreted|
|56621|New|Nor|2014-06-13|Rotatelogs.exe first start                        |
|56622|New|Nor|2014-06-13|mod_reqtimeout incorrectly applies timeouts to CON|
|56626|New|Nor|2014-06-15|Add info about rotatelogs to log rotation document|
|56633|New|Nor|2014-06-16|mod_auth_basic breaks mod_autoindex               |
|56645|New|Maj|2014-06-19|socket callback with timeout callback causes infin|
|56664|New|Nor|2014-06-24|Proxy retry timeout does not cope with system time|
|56697|New|Maj|2014-07-04|status page still shown while blocked             |
|56718|New|Nor|2014-07-14|Cleanup request Host headers when absolute URI are|
|56719|New|Nor|2014-07-14|parallel requests get served with delays          |
|56738|New|Enh|2014-07-17|Ability to extract route from cookie with regexp  |
|56740|New|Nor|2014-07-18|suspended_count not maintained properly with wstun|
|56750|New|Enh|2014-07-20|SuexecUserGroup replacement                       |
|56751|New|Maj|2014-07-20|Fails to properly mitigate Slow Post DoS attack   |
|56753|New|Nor|2014-07-21|mod_lua.so: symbol luaL_openlib: referenced symbol|
|56778|New|Nor|2014-07-28|while running make command i got this error       |
|56794|New|Nor|2014-07-31|Added AuthDBDFullAuthQuery option                 |
|56795|Inf|Nor|2014-07-31|Apache 2.4.10 Program received signal SIGPIPE, Bro|
|56818|Inf|Nor|2014-08-05|SetEnvIf may set invalid string length on empty st|
|56843|New|Enh|2014-08-12|Support different OCSP stapling max ages          |
|56868|New|Nor|2014-08-18|relative LuaRoot broken                           |
|56879|New|Nor|2014-08-22|Information disclosure                            |
|56889|New|Nor|2014-08-26|Close state never dies                            |
|56918|Opn|Blk|2014-09-06|error: 'ap_copy_scoreboard_worker' undeclared here|
|56926|New|Nor|2014-09-08|Filename causes AH02599 slotmem issue             |
|56933|New|Min|2014-09-09|not sure it's an appache bug : some browser want t|
|56942|New|Reg|2014-09-10|Unable to implement TRANSFER-CHUNKED:ENCODING with|
|56943|New|Nor|2014-09-10|mod_proxy_connect - AH02447: err/hup on backconn  |
|56977|New|Maj|2014-09-12|segfaults when using mod_mem_cache + mod_disk_cach|
|56986|New|Blk|2014-09-17|chunked Transfer-Encoding forbidden: /test/test.dl|
|57014|New|Cri|2014-09-24|Incorrect test for CC_FOR_BUILD prevents build (on|
|57023|New|Nor|2014-09-26|Socache shmcb don't cache file bigger than 11k    |
|57028|New|Enh|2014-09-27|mod_spdy - support Apache 2.4                     |
|57044|New|Nor|2014-09-29|[PatchAvailable] Use base64url in mod_unique_id ('|
|57045|New|Nor|2014-09-30|dumpio output strings are missing                 |
|57046|New|Enh|2014-09-30|Add additional parameter to enable check URL befor|
|57056|New|Maj|2014-10-03|Rewrite port is taken into hostname               |
|57067|New|Nor|2014-10-08|A proxy worker both standalone and balancer member|
|57069|New|Nor|2014-10-08|apache ssl timeout during chunked request in rever|
|57073|New|Cri|2014-10-09|Intermittent Connection Issues using default httpd|
|57085|New|Enh|2014-10-14|Implement Proxy Protocol in httpd                 |
|57087|New|Nor|2014-10-14|mod_proxy_fcgi doesn't send cgi CONTENT_LENGTH var|
|57100|Ver|Nor|2014-10-16|"SSLProtocol ALL" is ignored for virtual hosts    |
|57101|New|Enh|2014-10-16|[PATCH] Better error reporting when child spawn fa|
|57109|New|Nor|2014-10-17|GPG verification examples are wrong               |
|57119|Opn|Enh|2014-10-20|Suppress address reuse / DNS cache in mod_proxy   |
|57121|New|Nor|2014-10-21|ocsp stapling should not pass temporary server out|
|57131|New|Nor|2014-10-22|OCSP Stapling scalability concern                 |
|57159|New|Min|2014-10-28|mod_ssl OCSP Stapling directives don't support per|
|57160|New|Nor|2014-10-29|httxt2dbm doesn't generate files on NAS           |
|57174|New|Nor|2014-10-31|Update windows visual studio build                |
|57210|New|Nor|2014-11-14|LuaHookMapToStorage not firing in per-directory co|
|57211|New|Enh|2014-11-14|Config-time options                               |
|57212|Opn|Nor|2014-11-14|Headers returned by scripts are limited to 8190 by|
|57218|New|Nor|2014-11-15|[Feature Request] Apache Bench (AB) to output a cs|
|57219|New|Nor|2014-11-15|ApacheBench quits unexpectedly with high concurren|
|57220|New|Nor|2014-11-15|[Feature Request] Add option to ApacheBench to giv|
|57228|New|Nor|2014-11-17|glibc detected *** httpd: double free or corruptio|
|57229|New|Maj|2014-11-17|mod_sed dies on long lines                        |
|57286|New|Nor|2014-11-29|Symbolic links are not honoured                   |
|57298|New|Min|2014-12-02|RewriteBase inside FilesMatch behaves oddly       |
|57299|New|Enh|2014-12-02|mod_session_dbd should not make a database call pe|
|57300|New|Enh|2014-12-02|mod_session_dbd should not save the session at eac|
|57301|New|Enh|2014-12-02|Add SessionMaxAgeAbsolute Directive               |
|57304|Inf|Nor|2014-12-03|MySQL DBD Authentication Incompatible with SSL    |
|57311|New|Nor|2014-12-04|BalancerMember enclosed by <If> gives syntax error|
|57313|New|Nor|2014-12-05|The DefaultType directive has been removed        |
|57327|New|Nor|2014-12-08|mod_ssl seg fault on exit                         |
|57334|Ver|Maj|2014-12-09|Segmentation fault in SSL_renegotiate at ssl_lib.c|
|57337|New|Nor|2014-12-10|Content negotiation fails with conditional Redirec|
|57339|New|Enh|2014-12-10|ErrorLogFormat doesn't allow logging in Internet d|
|57360|New|Nor|2014-12-17|Fail gracefully on certificate/key mismatch       |
|57372|New|Nor|2014-12-19|httpd will lookup every home directory while start|
|57374|Ver|Nor|2014-12-19|Event MPM: Wrong KeepAliveTimeout when system cloc|
|57379|New|Nor|2014-12-20|[patch] Makefile.in  with mpm-shared, cgi and cgid|
|57383|New|Cri|2014-12-21|Error retrieving Report: An Existing connection wa|
|57386|New|Blk|2014-12-22|html5 lost some comments                          |
|57398|New|Maj|2014-12-26|AH01075: Error dispatching request to : (passing b|
|57399|New|Nor|2014-12-28|Many unnecessary CPU wakeups per second           |
|57406|New|Nor|2014-12-31|cgi-bin script is not executing                   |
|57412|New|Maj|2015-01-04|rewrite rules causes duplicate requests           |
|57416|New|Nor|2015-01-06|htcacheclean thinks the cache is smaller than it a|
|57424|Opn|Nor|2015-01-07|mod_rewrite not using ap_context_document_root    |
|57436|New|Enh|2015-01-12|Option to strip extra data after websocket request|
|57439|New|Enh|2015-01-13|Allow to change body timeout per location         |
|57448|New|Nor|2015-01-16|SSI <!--#set --> cannot capture backreferences fro|
|57453|New|Maj|2015-01-17|403 error when virtualhost configured with non-exi|
|57471|New|Nor|2015-01-20|Apache 2.4.10 Compilation fails when compiling aga|
|57477|New|Nor|2015-01-21|mod_auth_digest AH00052: child pid $pid exit signa|
|57483|New|Nor|2015-01-22|Omit "Keep-Alive" header on 1.1 connections       |
|57492|New|Nor|2015-01-24|incomplete chunked-transfered request body is not |
|57506|New|Nor|2015-01-27|<If> directive doesn't work within a <Location> se|
|57510|New|Enh|2015-01-28|Engine keyform support for private keys           |
|57511|New|Maj|2015-01-28|Opening plain TCP Socket on SSL port causes denial|
|57515|New|Nor|2015-01-30|Define/Undefine don't work reasonably outside of g|
|57519|New|Nor|2015-02-01|change SSLv2 to SSLv3 or remove SSLv2 support allt|
|57526|Opn|Maj|2015-02-03|Apache 2.2.29_openssl-1.0.1k_x86_64 Error creating|
|57529|Opn|Nor|2015-02-03|htcacheclean doesn't show the cached URL with '-a'|
|57585|New|Nor|2015-02-13|httpd fails to start if there is an IncludeOptiona|
|57590|New|Nor|2015-02-18|loading mod_proxy_http makes rewriteRule's [proxy]|
|57591|New|Nor|2015-02-18|DirectoryIndex directive cannot be overwritten    |
|57616|New|Maj|2015-02-23|AB - DNS roundrobin support                       |
|57624|New|Enh|2015-02-23|Provide support for http/2.0                      |
|57631|New|Nor|2015-02-24|Useless test in acinclude.m4                      |
|57632|New|Nor|2015-02-24|mod_systemd passes invalid default to APACHE_MODUL|
|57635|New|Nor|2015-02-25|meta-refresh is not rewritten by mod_proxy_html   |
|57636|New|Nor|2015-02-25|URLs without protocol are not rewriten by mod_prox|
|57641|New|Maj|2015-02-27|mod_substitute: Invalid merge order               |
|57646|New|Enh|2015-02-27|SSLEngine inside If directive                     |
|57660|New|Trv|2015-03-04|AB - free memory allocated by xmalloc and xcalloc |
|57680|New|Nor|2015-03-09|SSLSessionCacheTimeout has no effect              |
|57685|New|Nor|2015-03-10|Requests are denied while the mod_cgid daemon star|
|57691|New|Nor|2015-03-12|mod_proxy/proxy_util confuses UDS scheme with HTTP|
|57695|New|Nor|2015-03-12|[core:warn] [pid 1120] (101)Network is unreachable|
|57710|New|Nor|2015-03-15|Wildcard matching for logging headers             |
|57725|New|Enh|2015-03-18|ApacheBench: include http status code in gnuplot o|
|57742|New|Nor|2015-03-23|"reliable piped logging" doesn't work for ErrorLog|
|57745|New|Nor|2015-03-23|httpd exits 1 with no stderr when proxy_balancer_m|
|57746|New|Nor|2015-03-23|Apache hangs on startup using MPM event           |
|57751|Inf|Maj|2015-03-24|Problems with proxy reverse to websockets         |
|57756|New|Enh|2015-03-25|Config options for handling of pipelined request  |
|57757|New|Cri|2015-03-25|extern apr_xlate_t *ap_locale_to_ascii variable gi|
|57771|New|Nor|2015-03-27|cleanup_script uses incorrect connection ID       |
|57774|Inf|Nor|2015-03-28|httpd.conf <IfModule proxy_html_module> content er|
|57777|New|Nor|2015-03-30|Security concerns with documentation of AddHandler|
|57781|New|Nor|2015-03-31|disable reconnection after connection error       |
|57784|New|Enh|2015-03-31|[RFE] Multiple ErrorLog directives                |
|57785|Opn|Nor|2015-04-01|REDIRECT_URL is not suitable for use in server-gen|
|57795|Opn|Maj|2015-04-07|mod_proxy_wstunnel sometimes does not connect and |
|57800|New|Nor|2015-04-09|High CPU usage in ap_core_output_filter           |
|57807|New|Enh|2015-04-13|Build-configurable environment variable length    |
|57810|New|Nor|2015-04-13|Should apache ignore difference in trailing dot be|
|57813|New|Nor|2015-04-14|Rewrite 'pre-compressed content' recipe using 2.4 |
|57814|New|Nor|2015-04-14|Teach mod_deflate how to serve pre-comressed conte|
|57819|New|Nor|2015-04-15|Need a conventions document                       |
|57832|New|Enh|2015-04-19|Reduction of response splitting attacks consequenc|
|57853|Inf|Nor|2015-04-24|mod_proxy_http sends request with header 'Expect: |
|57876|New|Reg|2015-04-30|logresolve.exe on any Windows immediately crashes |
|57878|New|Nor|2015-04-30|Using UTF-8 for all languages, and avoiding html-e|
|57895|New|Min|2015-05-05|missing m4a mimeType in mime.types                |
|57911|New|Min|2015-05-09|Rewrite documentation unclear or wrong about what |
|57927|New|Maj|2015-05-13|Segmentation Fault at proxy_util.c:994            |
|57933|New|Min|2015-05-18|apr_port_t returns constant                       |
|57941|New|Nor|2015-05-21|config.status: line 331: syntax error near unexpec|
|57949|New|Enh|2015-05-25|new mod_ssl environment variable SSL_{CLIENT|SERVE|
|57950|New|Nor|2015-05-26|[patch] buildconf change hint in build to newer ap|
|57960|New|Nor|2015-05-27|PUT truncates response body; status_line appears t|
|57976|New|Cri|2015-05-30|Server threads stale when sending 500 status with |
|57978|New|Nor|2015-06-01|unix:/ works with any number of / slashes  except |
|57979|New|Nor|2015-06-01|can not turn change log level for mod_filter      |
|57996|New|Nor|2015-06-03|Symlinks erroneously not followed when target inod|
|57997|New|Nor|2015-06-03|Threads started during child_init don't block sign|
|57999|New|Nor|2015-06-04|ap_getparents() may remove start slash of uri     |
|58001|New|Enh|2015-06-04|Implement Forwarded header (RFC 7239) to mod_proxy|
|58007|New|Nor|2015-06-06|400 Bad Request with fully qualified domain name o|
|58025|New|Enh|2015-06-11|mod_authz_dbd : new dbd-query and AuthzDBDQuery op|
|58026|New|Nor|2015-06-11|return 421 status code when SNI and Host: header d|
|58044|New|Cri|2015-06-16|Error sintax 'lua_dump'                           |
|58050|New|Nor|2015-06-17|ErrorDocument does not always work                |
|58073|New|Nor|2015-06-24|Extremely long time for graceful restart          |
|58089|New|Nor|2015-07-01|mod_authz_host uses proxy IP even when mod_remotei|
|58097|New|Enh|2015-07-03|[feat] Preserve original connecting IP            |
|58101|New|Nor|2015-07-05|DeflateCompressionLevel inside vhost resets logfor|
|58107|New|Blk|2015-07-06|Httpd crashes on startup every time, dump file att|
|58109|New|Nor|2015-07-06|Apache on windows cannot handle the hash symbol (#|
|58118|Inf|Min|2015-07-09|mod_proxy_fcgi logs 503 when user aborts connectio|
|58120|New|Nor|2015-07-10|ProxyPassInherit does not work as expect          |
|58121|New|Nor|2015-07-10|ProxyHTMLMeta seems to ignore all <meta http-equiv|
|58129|New|Nor|2015-07-12|man pages are not generated correctly             |
|58132|New|Nor|2015-07-12|non-standard, non-traditional man page layout make|
|58135|New|Nor|2015-07-14|mod_cache sends client "if-Modified-Since" to back|
|58141|New|Nor|2015-07-15|Apache Service doesn't start when rotatlogs.exe pa|
|58142|New|Nor|2015-07-15|authz_core ignores loglevel                       |
|58158|New|Nor|2015-07-21|Not honoring HTTP spec with regard to Accept-Encod|
|58168|New|Enh|2015-07-21|Would like full request evaluation support in Rewr|
|58171|New|Nor|2015-07-22|ap_session_save saves the wrong session after a de|
|58177|New|Enh|2015-07-24|Mod Proxy forward trailers in http chunked request|
|58180|New|Enh|2015-07-24|ErrorDocument original URL in subsequent <Location|
|58181|New|Enh|2015-07-25|mod_expire should allow "minus" keyword same like |
|58188|New|Nor|2015-07-28|http2 mod_lua: support build with lua 5.2+        |
|58197|New|Nor|2015-07-31|apr-util-1.5.4 build against openldap - "could not|
|58225|New|Reg|2015-08-08|intermitant segfault 11 in session_identity_encode|
|58226|New|Nor|2015-08-08|XSS in Error Page                                 |
|58231|New|Nor|2015-08-11|RewriteCond can add "Host" to the Vary-Header     |
|58235|New|Enh|2015-08-12|Ability to allow from domain but with using forwar|
|58243|New|Nor|2015-08-14|rotatelogs goes infinite at startup               |
|58248|New|Nor|2015-08-17|Error 404 in use some characters of utf8 in url   |
|58257|New|Nor|2015-08-18|require ldap-group does not work if account-fullna|
|58278|Inf|Blk|2015-08-24|apache - mod_security Issue : apache no releasing |
|58280|New|Nor|2015-08-24|Backend connection not closed until timeout if cli|
|58288|New|Blk|2015-08-27|Semaphore amount increase until crash when enablin|
|58292|New|Nor|2015-08-27|FallbackResource breaks chunked encoding sometimes|
|58304|New|Nor|2015-08-30|Unexpected Warnings from Macro Use in 2.4         |
|58305|New|Nor|2015-08-30|mod_cgi documentation not clear about what is pass|
|58306|New|Nor|2015-08-30|documentation needs to make it clear which directi|
|58307|New|Nor|2015-08-31|Segmentation fault in child in "read(__nbytes, __b|
|58317|New|Min|2015-09-02|Error message AH01630 is missing file name on deny|
|58334|New|Min|2015-09-06|WebDAV HTTP access does not include meta tag for c|
|58335|New|Nor|2015-09-07|mod_authnz_ldap mismatch                          |
|58343|New|Nor|2015-09-08|The pdf files come up as a blank page.            |
|58354|New|Maj|2015-09-10|(20014)Internal error (specific information not av|
|58356|New|Blk|2015-09-10|Session jumping due to incorrect route            |
|58364|New|Reg|2015-09-11|Apache Server is restarted time to time (Release 2|
|58417|New|Min|2015-09-16|ApacheBench (ab) won't display Server Software of |
|58419|New|Nor|2015-09-16|ApacheBench (ab) doesn't work with keep-alives aga|
|58423|New|Reg|2015-09-17|Apache >= 2.4.8 PCRE_DUPNAMES causes build failure|
|58467|New|Maj|2015-09-29|Environment Variables in ProxyHTMLURLMap produces |
|58475|New|Nor|2015-10-03|Support append/merge with semicolon-separated head|
|58488|New|Nor|2015-10-08|Stoped PHP-FPM pool in multi-pool system with comu|
|58491|New|Maj|2015-10-09|Core dumps appear when the load increases         |
|58492|Inf|Nor|2015-10-09|I think LDAPConnectionPoolTTL is not being honored|
|58498|New|Nor|2015-10-16|Apache 2.4.17: Regression with mod_autoindex (in c|
|58500|New|Nor|2015-10-16|dav_fs not enabled by default                     |
|58503|New|Cri|2015-10-16|segfault in apr_brigade_cleanup() under high load |
|58509|New|Trv|2015-10-20|2.4.17-dev introduces second core.c handler at sta|
|58513|New|Maj|2015-10-21|httpd code documentation is missing               |
|58524|New|Nor|2015-10-23|mod_http2 segfaults when under heavy load         |
|58528|New|Nor|2015-10-23|AllowOverrideList None gets misparsed and .htacces|
|58529|New|Maj|2015-10-23|Segmentation fault after modifying a proxy Balance|
|58550|New|Enh|2015-10-26|During load, Apache 2.2.x with prefork MPM didn|
|58574|New|Nor|2015-11-02|Apache error AH01630 (client denied) but working  |
|58593|New|Nor|2015-11-06|mod_proxy wrong decision between http and ws      |
|58598|New|Enh|2015-11-08|Internal Server Error (500) when requesting non-ex|
|58602|New|Nor|2015-11-11|Priority issue on DirectoryMatch directive        |
|58604|New|Reg|2015-11-12|Plaintext auth broken in any Explicit FTP/AUTH TLS|
|58612|New|Min|2015-11-16|mod_webdav when write_stream failed should break a|
|58666|New|Nor|2015-11-29|"HTTPS" enviroment var is set to 'off' when mod_ht|
|58669|New|Nor|2015-11-30|Order of DBDInitSQL and DBDPrepareSQL             |
|58688|New|Nor|2015-12-03|Missing mod_ssl connection-level upgrade headers f|
+-----+---+---+----------+--------------------------------------------------+
| Total 1556 bugs                                                           |
+---------------------------------------------------------------------------+

From dev-return-84890-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Sun Dec  6 08:27:06 2015
Return-Path: <dev-return-84890-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 4F2D6186F6
	for <apmail-httpd-dev-archive@www.apache.org>; Sun,  6 Dec 2015 08:27:06 +0000 (UTC)
Received: (qmail 98988 invoked by uid 500); 6 Dec 2015 08:27:05 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 98916 invoked by uid 500); 6 Dec 2015 08:27:05 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 98906 invoked by uid 99); 6 Dec 2015 08:27:05 -0000
Received: from Unknown (HELO spamd1-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 06 Dec 2015 08:27:05 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd1-us-west.apache.org (ASF Mail Server at spamd1-us-west.apache.org) with ESMTP id 6AC81C1F8F
	for <dev@httpd.apache.org>; Sun,  6 Dec 2015 08:27:05 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd1-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.11
X-Spam-Level:
X-Spam-Status: No, score=-0.11 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	SPF_PASS=-0.001, T_RP_MATCHES_RCVD=-0.01, URIBL_BLOCKED=0.001]
	autolearn=disabled
Authentication-Results: spamd1-us-west.apache.org (amavisd-new);
	dkim=pass (1024-bit key) header.d=greenbytes.de
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd1-us-west.apache.org [10.40.0.7]) (amavisd-new, port 10024)
	with ESMTP id hI6nRxkzZxDq for <dev@httpd.apache.org>;
	Sun,  6 Dec 2015 08:26:57 +0000 (UTC)
Received: from mail.greenbytes.de (mail.greenbytes.de [217.91.35.233])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id 394D942AD9
	for <dev@httpd.apache.org>; Sun,  6 Dec 2015 08:26:57 +0000 (UTC)
Received: from [192.168.0.130] (unknown [87.78.176.104])
	(using TLSv1 with cipher ECDHE-RSA-AES256-SHA (256/256 bits))
	(Client did not present a certificate)
	by mail.greenbytes.de (Postfix) with ESMTPSA id BED8915A0396
	for <dev@httpd.apache.org>; Sun,  6 Dec 2015 09:26:55 +0100 (CET)
DKIM-Signature: v=1; a=rsa-sha256; c=simple/simple; d=greenbytes.de; s=mail;
	t=1449390415; bh=Il/k+mgbv+Kb/eNusCzaHX7kIGWjPTGCcCmzbAVVbk8=;
	h=From:Subject:Date:References:In-Reply-To:To:From;
	b=GzM33+j9kzWGKGmBeTMkV1RQQhxsM9ADDn9+tIyWUej1QaR+gGEG084hLeeZme8wH
	 9gFNHsXC4EvNVY3RIon9VUhZARWkSA0Bnz9lCPPSPup+0bF9BcYKtlPGU4hbVWq6dK
	 GGFrtyMSRVG+nRfWoYxg6q3u/qncjQ6BnPgGQciM=
From: Stefan Eissing <stefan.eissing@greenbytes.de>
Content-Type: text/plain;
	charset=us-ascii
Content-Transfer-Encoding: quoted-printable
Mime-Version: 1.0 (1.0)
Subject: Re: mod_http2 1.0.7+ and Drupal (Was: No H2 Window updates!)
Message-Id: <B4EFB75E-1DB6-4C75-9ABD-76C205E87F06@greenbytes.de>
Date: Sun, 6 Dec 2015 09:26:56 +0100
References: <1D08ECCD-A26B-4D3D-8F12-BE97018059B7@greenbytes.de> <043901d12e34$34d311c0$9e793540$@qqmail.nl> <10770C7F-5C8D-42EB-9E76-DC91160FDA89@greenbytes.de> <045e01d12e79$493fe620$dbbfb260$@qqmail.nl> <039D4360-8E2F-455D-8CC2-8405FC7FC272@greenbytes.de> <1jr36b5oa182lb9mupjfm6st4o9qbbr78o@4ax.com> <DA07528F-19ED-44AD-BBDA-DE3301F9F9EC@greenbytes.de> <unu66bptvbt2o9g4po12md8mdsleho74fc@4ax.com> <v3976b5hieisv5eft645gcp5lrc77gser7@4ax.com> <qie76b9kq4s5f2vsk1tjo77gcis74vr685@4ax.com> <7jm76bl476qb5mgtqclss32uu84cr2gt69@4ax.com>
In-Reply-To: <7jm76bl476qb5mgtqclss32uu84cr2gt69@4ax.com>
To: dev@httpd.apache.org
X-Mailer: iPhone Mail (13B143)

Jan, thanks for tracking this down to the duplicate headers. I will look int=
o it.

Just to be sure I got everything right: you tested against the mod_h2 github=
 versions?

> Am 06.12.2015 um 07:53 schrieb Jan Ehrhardt <phpdev@ehrhardt.nl>:
>=20
> Jan Ehrhardt in gmane.comp.apache.devel (Sun, 06 Dec 2015 05:47:43 +0100):=

>> Content-Encoding: gzip, gzip
>=20
> Comment in h2_from_h1.c:
> /*
> * Since some clients choke violently on multiple Vary fields, or
> * Vary fields with duplicate tokens, combine any multiples and remove
> * any duplicates.
> */
>=20
> Well, some clients choke violently on duplicate tokens in the
> Content-Encoding field. And on duplicate tokens in the
> Strict-Transport-Security field. You should remove duplicates in all
> fields.
> --=20
> Jan
>=20

From dev-return-84891-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Sun Dec  6 11:33:15 2015
Return-Path: <dev-return-84891-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id CABB718A23
	for <apmail-httpd-dev-archive@www.apache.org>; Sun,  6 Dec 2015 11:33:14 +0000 (UTC)
Received: (qmail 54964 invoked by uid 500); 6 Dec 2015 11:33:13 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 54887 invoked by uid 500); 6 Dec 2015 11:33:13 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 54877 invoked by uid 99); 6 Dec 2015 11:33:13 -0000
Received: from Unknown (HELO spamd4-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 06 Dec 2015 11:33:13 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd4-us-west.apache.org (ASF Mail Server at spamd4-us-west.apache.org) with ESMTP id 130D7C059C
	for <dev@httpd.apache.org>; Sun,  6 Dec 2015 11:33:13 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd4-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.555
X-Spam-Level:
X-Spam-Status: No, score=-0.555 tagged_above=-999 required=6.31
	tests=[HEADER_FROM_DIFFERENT_DOMAINS=0.001, RP_MATCHES_RCVD=-0.554,
	SPF_HELO_PASS=-0.001, SPF_PASS=-0.001] autolearn=disabled
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd4-us-west.apache.org [10.40.0.11]) (amavisd-new, port 10024)
	with ESMTP id 6fQSNNkVOevy for <dev@httpd.apache.org>;
	Sun,  6 Dec 2015 11:33:12 +0000 (UTC)
Received: from plane.gmane.org (plane.gmane.org [80.91.229.3])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id C0D4342AD6
	for <dev@httpd.apache.org>; Sun,  6 Dec 2015 11:33:11 +0000 (UTC)
Received: from list by plane.gmane.org with local (Exim 4.69)
	(envelope-from <apache-dev@m.gmane.org>)
	id 1a5XYx-0007U4-53
	for dev@httpd.apache.org; Sun, 06 Dec 2015 12:33:07 +0100
Received: from 227-116.citynet.ftth.internl.net ([85.223.116.227])
        by main.gmane.org with esmtp (Gmexim 0.1 (Debian))
        id 1AlnuQ-0007hv-00
        for <dev@httpd.apache.org>; Sun, 06 Dec 2015 12:33:07 +0100
Received: from phpdev by 227-116.citynet.ftth.internl.net with local (Gmexim 0.1 (Debian))
        id 1AlnuQ-0007hv-00
        for <dev@httpd.apache.org>; Sun, 06 Dec 2015 12:33:07 +0100
X-Injected-Via-Gmane: http://gmane.org/
To: dev@httpd.apache.org
From: Jan Ehrhardt <phpdev@ehrhardt.nl>
Subject: Re: mod_http2 1.0.7+ and Drupal (Was: No H2 Window updates!)
Date: Sun, 06 Dec 2015 12:33:00 +0100
Lines: 14
Message-ID: <lu686btb0b0jk0cmnmq223kr03k9t3shlg@4ax.com>
References: <10770C7F-5C8D-42EB-9E76-DC91160FDA89@greenbytes.de> <045e01d12e79$493fe620$dbbfb260$@qqmail.nl> <039D4360-8E2F-455D-8CC2-8405FC7FC272@greenbytes.de> <1jr36b5oa182lb9mupjfm6st4o9qbbr78o@4ax.com> <DA07528F-19ED-44AD-BBDA-DE3301F9F9EC@greenbytes.de> <unu66bptvbt2o9g4po12md8mdsleho74fc@4ax.com> <v3976b5hieisv5eft645gcp5lrc77gser7@4ax.com> <qie76b9kq4s5f2vsk1tjo77gcis74vr685@4ax.com> <7jm76bl476qb5mgtqclss32uu84cr2gt69@4ax.com> <B4EFB75E-1DB6-4C75-9ABD-76C205E87F06@greenbytes.de>
Mime-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Complaints-To: usenet@ger.gmane.org
X-Gmane-NNTP-Posting-Host: 227-116.citynet.ftth.internl.net
X-Newsreader: Forte Agent 3.3/32.846

Stefan Eissing in gmane.comp.apache.devel (Sun, 6 Dec 2015 09:26:56 +0100):
>Jan, thanks for tracking this down to the duplicate headers. I will look into it.
>
>Just to be sure I got everything right: you tested against the mod_h2 github versions?

I used the sources from the ASF repos. This one worked OK:

svn co -r 1715371 http://svn.apache.org/repos/asf/httpd/httpd/branches/2.4.x/modules/http2

But this one had the duplicate tokens:

svn co -r 1716210 http://svn.apache.org/repos/asf/httpd/httpd/branches/2.4.x/modules/http2
-- 
Jan


From dev-return-84892-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Mon Dec  7 12:43:40 2015
Return-Path: <dev-return-84892-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 16DFA181EB
	for <apmail-httpd-dev-archive@www.apache.org>; Mon,  7 Dec 2015 12:43:40 +0000 (UTC)
Received: (qmail 9378 invoked by uid 500); 7 Dec 2015 12:43:39 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 9314 invoked by uid 500); 7 Dec 2015 12:43:39 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 9304 invoked by uid 99); 7 Dec 2015 12:43:38 -0000
Received: from Unknown (HELO spamd1-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 07 Dec 2015 12:43:38 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd1-us-west.apache.org (ASF Mail Server at spamd1-us-west.apache.org) with ESMTP id 93AB4C9242
	for <dev@httpd.apache.org>; Mon,  7 Dec 2015 12:43:38 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd1-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 0.652
X-Spam-Level:
X-Spam-Status: No, score=0.652 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, RCVD_IN_MSPIKE_H2=-0.001,
	SPF_NEUTRAL=0.652, URIBL_BLOCKED=0.001] autolearn=disabled
Authentication-Results: spamd1-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=comcast.net
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd1-us-west.apache.org [10.40.0.7]) (amavisd-new, port 10024)
	with ESMTP id uEl82fbF5Fw3 for <dev@httpd.apache.org>;
	Mon,  7 Dec 2015 12:43:29 +0000 (UTC)
Received: from resqmta-po-05v.sys.comcast.net (resqmta-po-05v.sys.comcast.net [96.114.154.164])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id F33F820F10
	for <dev@httpd.apache.org>; Mon,  7 Dec 2015 12:43:28 +0000 (UTC)
Received: from resomta-po-03v.sys.comcast.net ([96.114.154.227])
	by resqmta-po-05v.sys.comcast.net with comcast
	id qceD1r0034ueUHc01ceDtn; Mon, 07 Dec 2015 12:38:13 +0000
Received: from [192.168.199.10] ([69.251.84.114])
	by resomta-po-03v.sys.comcast.net with comcast
	id qceB1r00D2U0RYt01ceCMr; Mon, 07 Dec 2015 12:38:13 +0000
Content-Type: text/plain; charset=us-ascii
Mime-Version: 1.0 (Mac OS X Mail 9.1 \(3096.5\))
Subject: Re: mod_http2 1.0.7+ and Drupal (Was: No H2 Window updates!)
From: Jim Jagielski <jim@jaguNET.com>
In-Reply-To: <lu686btb0b0jk0cmnmq223kr03k9t3shlg@4ax.com>
Date: Mon, 7 Dec 2015 07:38:11 -0500
Content-Transfer-Encoding: quoted-printable
Message-Id: <5B371782-8C70-41D7-A6DC-DE4E6E8A7585@jaguNET.com>
References: <10770C7F-5C8D-42EB-9E76-DC91160FDA89@greenbytes.de> <045e01d12e79$493fe620$dbbfb260$@qqmail.nl> <039D4360-8E2F-455D-8CC2-8405FC7FC272@greenbytes.de> <1jr36b5oa182lb9mupjfm6st4o9qbbr78o@4ax.com> <DA07528F-19ED-44AD-BBDA-DE3301F9F9EC@greenbytes.de> <unu66bptvbt2o9g4po12md8mdsleho74fc@4ax.com> <v3976b5hieisv5eft645gcp5lrc77gser7@4ax.com> <qie76b9kq4s5f2vsk1tjo77gcis74vr685@4ax.com> <7jm76bl476qb5mgtqclss32uu84cr2gt69@4ax.com> <B4EFB75E-1DB6-4C75-9ABD-76C205E87F06@greenbytes.de> <lu686btb0b0jk0cmnmq223kr03k9t3shlg@4ax.com>
To: dev@httpd.apache.org
X-Mailer: Apple Mail (2.3096.5)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=comcast.net;
	s=q20140121; t=1449491893;
	bh=KOy374mK5gvEmtC94ZlWajYafdYriVQ3FqPkeeTKXJw=;
	h=Received:Received:Content-Type:Mime-Version:Subject:From:Date:
	 Message-Id:To;
	b=ENrQTeL/Okn9E00YmvYas+Wz0HtxxY2AWcmvOy2TRoxo8lxWDb0wDn0QEt9SPfCih
	 1VqjVfYsqErOrkLmnS/8hS3c+n9bWCZQh6/oisrWXOSgXj7QWwx1/r/yp3VMKZa61v
	 7Jk/9+CCzoD8n0gpa3Yglxz3ysa7n+2dRC73VgxSkVnlQBWv/ss8Us4SW4Gmbcf8qM
	 GSJnMH18wCtImBRHu9RIOsLgF7zvC9yQU/7x9uYqXXoxq9xFmciivh+S3r4XvhBWOa
	 X5ZmMfIwRCOlJqZ189V8Pc2T4GAZk2JYN2hMJGIfP2Sh7AIzrWMMr+aJG5pc1fB/QN
	 w80hrylkfJnVg==

Can you retry w DEBUG level, to see if  h2_response_trailers_filter()
is the issue?

> On Dec 6, 2015, at 6:33 AM, Jan Ehrhardt <phpdev@ehrhardt.nl> wrote:
>=20
> Stefan Eissing in gmane.comp.apache.devel (Sun, 6 Dec 2015 09:26:56 =
+0100):
>> Jan, thanks for tracking this down to the duplicate headers. I will =
look into it.
>>=20
>> Just to be sure I got everything right: you tested against the mod_h2 =
github versions?
>=20
> I used the sources from the ASF repos. This one worked OK:
>=20
> svn co -r 1715371 =
http://svn.apache.org/repos/asf/httpd/httpd/branches/2.4.x/modules/http2
>=20
> But this one had the duplicate tokens:
>=20
> svn co -r 1716210 =
http://svn.apache.org/repos/asf/httpd/httpd/branches/2.4.x/modules/http2
> --=20
> Jan
>=20


From dev-return-84893-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Mon Dec  7 12:51:58 2015
Return-Path: <dev-return-84893-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id C2F08182D4
	for <apmail-httpd-dev-archive@www.apache.org>; Mon,  7 Dec 2015 12:51:58 +0000 (UTC)
Received: (qmail 23408 invoked by uid 500); 7 Dec 2015 12:51:55 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 23335 invoked by uid 500); 7 Dec 2015 12:51:55 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 23323 invoked by uid 99); 7 Dec 2015 12:51:55 -0000
Received: from Unknown (HELO spamd2-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 07 Dec 2015 12:51:55 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd2-us-west.apache.org (ASF Mail Server at spamd2-us-west.apache.org) with ESMTP id B498F1A0935
	for <dev@httpd.apache.org>; Mon,  7 Dec 2015 12:51:54 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd2-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.654
X-Spam-Level:
X-Spam-Status: No, score=-0.654 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RP_MATCHES_RCVD=-0.554, SPF_PASS=-0.001, URIBL_BLOCKED=0.001]
	autolearn=disabled
Authentication-Results: spamd2-us-west.apache.org (amavisd-new);
	dkim=pass (1024-bit key) header.d=greenbytes.de
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd2-us-west.apache.org [10.40.0.9]) (amavisd-new, port 10024)
	with ESMTP id Av2WbPY9JSxQ for <dev@httpd.apache.org>;
	Mon,  7 Dec 2015 12:51:45 +0000 (UTC)
Received: from mail.greenbytes.de (mail.greenbytes.de [217.91.35.233])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id 494AC42AA6
	for <dev@httpd.apache.org>; Mon,  7 Dec 2015 12:51:45 +0000 (UTC)
Received: from [192.168.1.42] (unknown [217.91.35.233])
	(using TLSv1 with cipher ECDHE-RSA-AES256-SHA (256/256 bits))
	(Client did not present a certificate)
	by mail.greenbytes.de (Postfix) with ESMTPSA id 5C37A15A049C
	for <dev@httpd.apache.org>; Mon,  7 Dec 2015 13:46:37 +0100 (CET)
DKIM-Signature: v=1; a=rsa-sha256; c=simple/simple; d=greenbytes.de; s=mail;
	t=1449492397; bh=HddzalJbVovDcOkiAMadrCbzL0QB9lzzBJoDl9lCShY=;
	h=Subject:From:In-Reply-To:Date:References:To:From;
	b=T38SxnF40uN4JpNT961pcFwVw5oRiapFXjMM7Zp7j/SNTE9Xu9KUliUiru7LI4101
	 nOExtVGS9yyzMMcRqYwMGAUubVw5j3gfeTO5+/ocdfxMRqFeGp4sUV4CulWDyGu6Vl
	 CQRSDXMzIx0HlqligD/A/ym1o3Tf+MTstiT2tg58=
Content-Type: text/plain; charset=us-ascii
Mime-Version: 1.0 (Mac OS X Mail 9.1 \(3096.5\))
Subject: Re: mod_http2 1.0.7+ and Drupal (Was: No H2 Window updates!)
From: Stefan Eissing <stefan.eissing@greenbytes.de>
In-Reply-To: <5B371782-8C70-41D7-A6DC-DE4E6E8A7585@jaguNET.com>
Date: Mon, 7 Dec 2015 13:46:37 +0100
Content-Transfer-Encoding: quoted-printable
Message-Id: <72579D23-A595-4265-BFCC-2BEA67C92510@greenbytes.de>
References: <10770C7F-5C8D-42EB-9E76-DC91160FDA89@greenbytes.de> <045e01d12e79$493fe620$dbbfb260$@qqmail.nl> <039D4360-8E2F-455D-8CC2-8405FC7FC272@greenbytes.de> <1jr36b5oa182lb9mupjfm6st4o9qbbr78o@4ax.com> <DA07528F-19ED-44AD-BBDA-DE3301F9F9EC@greenbytes.de> <unu66bptvbt2o9g4po12md8mdsleho74fc@4ax.com> <v3976b5hieisv5eft645gcp5lrc77gser7@4ax.com> <qie76b9kq4s5f2vsk1tjo77gcis74vr685@4ax.com> <7jm76bl476qb5mgtqclss32uu84cr2gt69@4ax.com> <B4EFB75E-1DB6-4C75-9ABD-76C205E87F06@greenbytes.de> <lu686btb0b0jk0cmnmq223kr03k9t3shlg@4ax.com> <5B371782-8C70-41D7-A6DC-DE4E6E8A7585@jaguNET.com>
To: dev@httpd.apache.org
X-Mailer: Apple Mail (2.3096.5)

I think I just found the problem:

I thought that h2_h2.c, line 678 was no longer needed. But under some, =
still unknown, conditions the post_read_req hook is called twice. That =
makes a table overlay twice which results in all headers_out be present =
twice.=20

I will remove the filter again before installing it. Someday, I need to =
understand the double invocation of the hook...

//Stefan

> Am 07.12.2015 um 13:38 schrieb Jim Jagielski <jim@jaguNET.com>:
>=20
> Can you retry w DEBUG level, to see if  h2_response_trailers_filter()
> is the issue?
>=20
>> On Dec 6, 2015, at 6:33 AM, Jan Ehrhardt <phpdev@ehrhardt.nl> wrote:
>>=20
>> Stefan Eissing in gmane.comp.apache.devel (Sun, 6 Dec 2015 09:26:56 =
+0100):
>>> Jan, thanks for tracking this down to the duplicate headers. I will =
look into it.
>>>=20
>>> Just to be sure I got everything right: you tested against the =
mod_h2 github versions?
>>=20
>> I used the sources from the ASF repos. This one worked OK:
>>=20
>> svn co -r 1715371 =
http://svn.apache.org/repos/asf/httpd/httpd/branches/2.4.x/modules/http2
>>=20
>> But this one had the duplicate tokens:
>>=20
>> svn co -r 1716210 =
http://svn.apache.org/repos/asf/httpd/httpd/branches/2.4.x/modules/http2
>> --=20
>> Jan
>>=20
>=20


From dev-return-84894-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Mon Dec  7 12:58:29 2015
Return-Path: <dev-return-84894-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 005BF1831A
	for <apmail-httpd-dev-archive@www.apache.org>; Mon,  7 Dec 2015 12:58:29 +0000 (UTC)
Received: (qmail 35907 invoked by uid 500); 7 Dec 2015 12:58:28 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 35837 invoked by uid 500); 7 Dec 2015 12:58:28 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 35827 invoked by uid 99); 7 Dec 2015 12:58:28 -0000
Received: from Unknown (HELO spamd1-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 07 Dec 2015 12:58:28 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd1-us-west.apache.org (ASF Mail Server at spamd1-us-west.apache.org) with ESMTP id AEFDEC85E5
	for <dev@httpd.apache.org>; Mon,  7 Dec 2015 12:58:27 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd1-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.11
X-Spam-Level:
X-Spam-Status: No, score=-0.11 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	SPF_PASS=-0.001, T_RP_MATCHES_RCVD=-0.01, URIBL_BLOCKED=0.001]
	autolearn=disabled
Authentication-Results: spamd1-us-west.apache.org (amavisd-new);
	dkim=pass (1024-bit key) header.d=greenbytes.de
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd1-us-west.apache.org [10.40.0.7]) (amavisd-new, port 10024)
	with ESMTP id dpMV_EswcIHG for <dev@httpd.apache.org>;
	Mon,  7 Dec 2015 12:58:14 +0000 (UTC)
Received: from mail.greenbytes.de (mail.greenbytes.de [217.91.35.233])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id E544B24DBD
	for <dev@httpd.apache.org>; Mon,  7 Dec 2015 12:58:13 +0000 (UTC)
Received: from [192.168.1.42] (unknown [217.91.35.233])
	(using TLSv1 with cipher ECDHE-RSA-AES256-SHA (256/256 bits))
	(Client did not present a certificate)
	by mail.greenbytes.de (Postfix) with ESMTPSA id 57A4015A0257
	for <dev@httpd.apache.org>; Mon,  7 Dec 2015 13:58:07 +0100 (CET)
DKIM-Signature: v=1; a=rsa-sha256; c=simple/simple; d=greenbytes.de; s=mail;
	t=1449493087; bh=QZYB9AUsZ8vuVEUBVF/03b+xJPSM6XpX4a/WDdvgBc8=;
	h=Subject:From:In-Reply-To:Date:References:To:From;
	b=glG7YM6vaJgjtBRA4A0Q9bDBy4iLotzTCM+GJZr2vU6bXaLXojepesjr8yJM9pn0f
	 1J09uU8/mgxi9BZiRbbeNJgXiU7Bc3QAakpvQgTN34WXwvJedHxXc/F91VkpCXpUlZ
	 63K3708UWAjfI7T50thQPK47LmhKub/WgZjqSn3k=
Content-Type: text/plain; charset=us-ascii
Mime-Version: 1.0 (Mac OS X Mail 9.1 \(3096.5\))
Subject: Re: No H2 Window updates!
From: Stefan Eissing <stefan.eissing@greenbytes.de>
In-Reply-To: <4hk76bllai2epissk4lbjghj31jmnf03mr@4ax.com>
Date: Mon, 7 Dec 2015 13:58:07 +0100
Content-Transfer-Encoding: quoted-printable
Message-Id: <A2E69AEB-1BA3-489A-83C3-6E7A8A73F3BC@greenbytes.de>
References: <CACsi253Egm-K71wTd5Ff3gD6AFdhAgm1pHXafE5Kobzb4WejBQ@mail.gmail.com> <bqdr5blheuoccudj4sc7jql6e4dn8furd9@4ax.com> <1D08ECCD-A26B-4D3D-8F12-BE97018059B7@greenbytes.de> <043901d12e34$34d311c0$9e793540$@qqmail.nl> <10770C7F-5C8D-42EB-9E76-DC91160FDA89@greenbytes.de> <045e01d12e79$493fe620$dbbfb260$@qqmail.nl> <039D4360-8E2F-455D-8CC2-8405FC7FC272@greenbytes.de> <1jr36b5oa182lb9mupjfm6st4o9qbbr78o@4ax.com> <DA07528F-19ED-44AD-BBDA-DE3301F9F9EC@greenbytes.de> <4hk76bllai2epissk4lbjghj31jmnf03mr@4ax.com>
To: dev@httpd.apache.org
X-Mailer: Apple Mail (2.3096.5)

Jan,=20

if you could find the time to verify that the duplicate headers are gone =
in the current 2.4.x version, that'd be nice. Thanks!

//Stefan

> Am 06.12.2015 um 07:21 schrieb Jan Ehrhardt <phpdev@ehrhardt.nl>:
>=20
> Stefan Eissing in gmane.comp.apache.devel (Fri, 4 Dec 2015 21:37:46
> +0100):
>>> 1.0.10 did not solve my problems with the admin menu in Drupal7. =
Sorry.
>>=20
>> Do you have any advice how to reproduce the problem, so that I might =
see
>> what it is? I am not familiar with drupal7, unfortunately.=20
>=20
> mod_http2-1.0.5 revision 1715371 from the 2.4.x branch was still OK.
>=20
> mod_http2-1.0.7 revision 1716210 from the 2.4.x branch doubled the
> arguments in the Drupal7 admin menu:
> Content-Encoding: gzip, gzip
>=20
> This was the cause of my troubles with Drupal7. I rebuilt both
> mod_https.so versions today with the latest nghttp2 (git head).
> No other changes. Snippet from my conf file:
>=20
> LoadModule http2_module modules/mod_http2-1.0.5-r1715371.so
> # bad below
> #LoadModule http2_module modules/mod_http2-1.0.7-r1716210.so
> --=20
> Jan
>=20


From dev-return-84895-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Mon Dec  7 13:14:29 2015
Return-Path: <dev-return-84895-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 10E481843D
	for <apmail-httpd-dev-archive@www.apache.org>; Mon,  7 Dec 2015 13:14:29 +0000 (UTC)
Received: (qmail 81129 invoked by uid 500); 7 Dec 2015 13:14:23 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 81055 invoked by uid 500); 7 Dec 2015 13:14:23 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 81045 invoked by uid 99); 7 Dec 2015 13:14:23 -0000
Received: from Unknown (HELO spamd2-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 07 Dec 2015 13:14:23 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd2-us-west.apache.org (ASF Mail Server at spamd2-us-west.apache.org) with ESMTP id 0F6271A0B33
	for <dev@httpd.apache.org>; Mon,  7 Dec 2015 13:14:23 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd2-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 0.001
X-Spam-Level:
X-Spam-Status: No, score=0.001 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, URIBL_BLOCKED=0.001]
	autolearn=disabled
Authentication-Results: spamd2-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=comcast.net
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd2-us-west.apache.org [10.40.0.9]) (amavisd-new, port 10024)
	with ESMTP id Qd4zmJlBZH5e for <dev@httpd.apache.org>;
	Mon,  7 Dec 2015 13:14:13 +0000 (UTC)
Received: from resqmta-po-05v.sys.comcast.net (resqmta-po-05v.sys.comcast.net [96.114.154.164])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id 7954720599
	for <dev@httpd.apache.org>; Mon,  7 Dec 2015 13:14:12 +0000 (UTC)
Received: from resomta-po-16v.sys.comcast.net ([96.114.154.240])
	by resqmta-po-05v.sys.comcast.net with comcast
	id qd911r0025BUCh401d99su; Mon, 07 Dec 2015 13:09:09 +0000
Received: from [192.168.199.10] ([69.251.84.114])
	by resomta-po-16v.sys.comcast.net with comcast
	id qd981r0052U0RYt01d98rT; Mon, 07 Dec 2015 13:09:08 +0000
Content-Type: text/plain; charset=us-ascii
Mime-Version: 1.0 (Mac OS X Mail 9.1 \(3096.5\))
Subject: Re: reverse proxy wishlist
From: Jim Jagielski <jim@jaguNET.com>
In-Reply-To: <CACsi250R8eSyv4XTTcj3J-h9vAebEtmgGWyXDJ3=K1RWOqf8cw@mail.gmail.com>
Date: Mon, 7 Dec 2015 08:09:08 -0500
Content-Transfer-Encoding: quoted-printable
Message-Id: <F767A7E7-8BB6-4A0E-BB4C-FAFF08F3D7C0@jaguNET.com>
References: <288293CD-6D82-42E0-BFC9-9DC25F969ED6@jaguNET.com> <CACsi250e5arsm+EzN1KDJMOD-vAmTyM8M0utTuEfedUGSUfXJw@mail.gmail.com> <77E6470A-4FAD-4DAD-BE9E-E11F54388E2C@jaguNET.com> <CACsi250wpsmUsC5kEWfJOAoYKHG28m2N6NrizHXsHFjU7_nVYQ@mail.gmail.com> <23420A92-4983-40B9-86FD-7B0681983601@jaguNET.com> <CACsi250w43S9-GLmPWeFAUS3wRte81tc=g3f5cWxLLf+Q7Mx5g@mail.gmail.com> <36B2DCA6-40CF-4FC7-B265-4927C24BE745@jaguNET.com> <CACsi250R8eSyv4XTTcj3J-h9vAebEtmgGWyXDJ3=K1RWOqf8cw@mail.gmail.com>
To: dev@httpd.apache.org
X-Mailer: Apple Mail (2.3096.5)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=comcast.net;
	s=q20140121; t=1449493749;
	bh=+g7+MRfgwhzHUxJuqgNHycdjsfPNWcbmA9KXaAubAlk=;
	h=Received:Received:Content-Type:Mime-Version:Subject:From:Date:
	 Message-Id:To;
	b=Vzfp1ekPw9lENaeeRCe8ZhYZeZePIBUsziMnGn7eK6Kntiar/Oz1W0dR6gTf7PhM7
	 LlBs211FAFVKPjKJxD2rILPeFwROjOuIqmbD9OB4QQncWFVOJYeR3NLAQ1euHXlRNK
	 B9PHqe6U/fFmr+4GGbxlIyDyqxchZ2UNt6D/DRyD1fWFJupSwrLNlNdezsMEbeKF50
	 HdZ1DnjSgTNtUsFOfYu9nYAy5vYjmD7NuhZZFexPYpVfJvZmatq+OdCLpg1nxDPGEG
	 3IVCuO0GDFRXG/O4YQPhyXA1+5qV/A9StbdkGGlYuDojttqHlG/iv8HQBr5zti1VQP
	 uzQDIoMTrZ42A==


> On Dec 5, 2015, at 9:30 PM, William A Rowe Jr <wrowe@rowe-clan.net> =
wrote:
>=20
> On Sat, Dec 5, 2015 at 3:48 PM, Jim Jagielski <jim@jagunet.com> wrote:
>=20
> > On Dec 4, 2015, at 10:25 AM, William A Rowe Jr <wrowe@rowe-clan.net> =
wrote:
> >
> > My observation was that that the mapped pages for 2-6 fundamental =
socache, lbmethod or slotmem providers are the same as for a single =
module due to page alignment - load any two and you are already wasting =
kernel resources and memory.
> >
>=20
> Since you refer to these 3 modules, what to you recommend? That
> we bundle all providers into 1 module? That's fine with me but
> my point was that the whole idea of submodules and providers,
> whether from us or not, was that the admin only needs to load
> the ones they use. This recommendation seems to ignore this
> basic advice.
>=20
> That advise always applies if the module interacts with the =
user-agent.
>=20

I have no idea why it also doesn't apply no matter what.
Isn't the whole idea of a loadable modules is so one
can add, or remove, functionality, no matter what, when
it's not needed? The idea of it only applying when it (directly)
"interacts with the user-agent" seems extremely artificial.


From dev-return-84896-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Mon Dec  7 13:33:31 2015
Return-Path: <dev-return-84896-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id F2A001858D
	for <apmail-httpd-dev-archive@www.apache.org>; Mon,  7 Dec 2015 13:33:31 +0000 (UTC)
Received: (qmail 25574 invoked by uid 500); 7 Dec 2015 13:33:22 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 25497 invoked by uid 500); 7 Dec 2015 13:33:22 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 25487 invoked by uid 99); 7 Dec 2015 13:33:22 -0000
Received: from Unknown (HELO spamd4-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 07 Dec 2015 13:33:21 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd4-us-west.apache.org (ASF Mail Server at spamd4-us-west.apache.org) with ESMTP id 895BEC0473
	for <dev@httpd.apache.org>; Mon,  7 Dec 2015 13:33:21 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd4-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 1.001
X-Spam-Level: *
X-Spam-Status: No, score=1.001 tagged_above=-999 required=6.31
	tests=[KAM_LAZY_DOMAIN_SECURITY=1, URIBL_BLOCKED=0.001]
	autolearn=disabled
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd4-us-west.apache.org [10.40.0.11]) (amavisd-new, port 10024)
	with ESMTP id N4MAxpftMwyk for <dev@httpd.apache.org>;
	Mon,  7 Dec 2015 13:33:07 +0000 (UTC)
Received: from mail1.bemta3.messagelabs.com (mail1.bemta3.messagelabs.com [195.245.230.168])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id D071D20C70
	for <dev@httpd.apache.org>; Mon,  7 Dec 2015 13:33:06 +0000 (UTC)
Received: from [85.158.138.179] by server-8.bemta-3.messagelabs.com id CE/AA-31069-A8A85665; Mon, 07 Dec 2015 13:32:58 +0000
X-Env-Sender: ruediger.pluem@vodafone.com
X-Msg-Ref: server-2.tower-169.messagelabs.com!1449495178!8370533!1
X-Originating-IP: [195.232.244.135]
X-StarScan-Received:
X-StarScan-Version: 7.35; banners=-,-,-
X-VirusChecked: Checked
Received: (qmail 25042 invoked from network); 7 Dec 2015 13:32:58 -0000
Received: from mailout03.vodafone.com (HELO mailout03.vodafone.com) (195.232.244.135)
  by server-2.tower-169.messagelabs.com with DHE-RSA-AES256-SHA encrypted SMTP; 7 Dec 2015 13:32:58 -0000
Received: from mailint02.vodafone.com (mailint02.vodafone.com [195.232.244.199])
	by mailout03.vodafone.com (Postfix) with ESMTP id 3pDlvF6xqDz17HLl
	for <dev@httpd.apache.org>; Mon,  7 Dec 2015 14:32:57 +0100 (CET)
Received: from mailint02.vodafone.com (localhost [127.0.0.1])
	by mailint02.vodafone.com (Postfix) with ESMTP id 3pDlvF5MxJzQmFy
	for <dev@httpd.apache.org>; Mon,  7 Dec 2015 14:32:57 +0100 (CET)
Received: from VOEXC02W.internal.vodafone.com (voexc02w.dc-ratingen.de [145.230.101.22])
	(using TLSv1 with cipher AES128-SHA (128/128 bits))
	(No client certificate requested)
	by mailint02.vodafone.com (Postfix) with ESMTPS id 3pDlvF5JTlzQjMB
	for <dev@httpd.apache.org>; Mon,  7 Dec 2015 14:32:57 +0100 (CET)
Received: from VOEXM10W.internal.vodafone.com ([169.254.2.138]) by
 VOEXC02W.internal.vodafone.com ([145.230.101.22]) with mapi id
 14.03.0224.002; Mon, 7 Dec 2015 14:32:57 +0100
From: =?iso-8859-1?Q?Pl=FCm=2C_R=FCdiger=2C_Vodafone_Group?=
	<ruediger.pluem@vodafone.com>
To: "dev@httpd.apache.org" <dev@httpd.apache.org>
Subject: AW: reverse proxy wishlist
Thread-Topic: reverse proxy wishlist
Thread-Index: AQHRLduD1o/yAsMyvkq08CJ4vkw8xZ65XWYAgABcgYCAAB1wgIAA7MIAgAAfbgCAAf14gIAATqcAgAJEyQCAABUGwA==
Date: Mon, 7 Dec 2015 13:32:56 +0000
Message-ID: <AB1691BE05AE7F4992697F2A0835627AC63BAA97@VOEXM10W.internal.vodafone.com>
References: <288293CD-6D82-42E0-BFC9-9DC25F969ED6@jaguNET.com>
 <CACsi250e5arsm+EzN1KDJMOD-vAmTyM8M0utTuEfedUGSUfXJw@mail.gmail.com>
 <77E6470A-4FAD-4DAD-BE9E-E11F54388E2C@jaguNET.com>
 <CACsi250wpsmUsC5kEWfJOAoYKHG28m2N6NrizHXsHFjU7_nVYQ@mail.gmail.com>
 <23420A92-4983-40B9-86FD-7B0681983601@jaguNET.com>
 <CACsi250w43S9-GLmPWeFAUS3wRte81tc=g3f5cWxLLf+Q7Mx5g@mail.gmail.com>
 <36B2DCA6-40CF-4FC7-B265-4927C24BE745@jaguNET.com>
 <CACsi250R8eSyv4XTTcj3J-h9vAebEtmgGWyXDJ3=K1RWOqf8cw@mail.gmail.com>
 <F767A7E7-8BB6-4A0E-BB4C-FAFF08F3D7C0@jaguNET.com>
In-Reply-To: <F767A7E7-8BB6-4A0E-BB4C-FAFF08F3D7C0@jaguNET.com>
Accept-Language: en-US
Content-Language: de-DE
X-MS-Has-Attach:
X-MS-TNEF-Correlator:
Content-Type: text/plain; charset="iso-8859-1"
Content-Transfer-Encoding: quoted-printable
MIME-Version: 1.0



> -----Urspr=FCngliche Nachricht-----
> Von: Jim Jagielski [mailto:jim@jaguNET.com]
> Gesendet: Montag, 7. Dezember 2015 14:09
> An: dev@httpd.apache.org
> Betreff: Re: reverse proxy wishlist
>=20
>=20
> > On Dec 5, 2015, at 9:30 PM, William A Rowe Jr <wrowe@rowe-clan.net>
> wrote:
> >
> > On Sat, Dec 5, 2015 at 3:48 PM, Jim Jagielski <jim@jagunet.com> wrote:
> >
> > > On Dec 4, 2015, at 10:25 AM, William A Rowe Jr <wrowe@rowe-clan.net>
> wrote:
> > >
> > > My observation was that that the mapped pages for 2-6 fundamental
> socache, lbmethod or slotmem providers are the same as for a single
> module due to page alignment - load any two and you are already wasting
> kernel resources and memory.
> > >
> >
> > Since you refer to these 3 modules, what to you recommend? That
> > we bundle all providers into 1 module? That's fine with me but
> > my point was that the whole idea of submodules and providers,
> > whether from us or not, was that the admin only needs to load
> > the ones they use. This recommendation seems to ignore this
> > basic advice.
> >
> > That advise always applies if the module interacts with the user-
> agent.
> >
>=20
> I have no idea why it also doesn't apply no matter what.
> Isn't the whole idea of a loadable modules is so one
> can add, or remove, functionality, no matter what, when
> it's not needed? The idea of it only applying when it (directly)
> "interacts with the user-agent" seems extremely artificial.

I guess the point is a tradeoff, between "wasting" Kernel resources and pag=
es by loading lots of very small modules and being able to really only load=
 the code you need.
As with all such stuff there is no real sharp line. For some one is more im=
portant than the other one. For others it is vice versa.
So I would go for a pragmatic approach with no sharp line. I guess we can b=
undle all balancers we deliver into one module. IMHO we wouldn't lose anyth=
ing here.
Of course we keep it possible to have balancers in separate modules for oth=
er people. With other  modules I am not so sure if this really makes sense =
and we should keep it
as is.

Regards

R=FCdiger


From dev-return-84897-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Mon Dec  7 13:47:14 2015
Return-Path: <dev-return-84897-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 1E8681860B
	for <apmail-httpd-dev-archive@www.apache.org>; Mon,  7 Dec 2015 13:47:14 +0000 (UTC)
Received: (qmail 54488 invoked by uid 500); 7 Dec 2015 13:47:10 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 54426 invoked by uid 500); 7 Dec 2015 13:47:10 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 54416 invoked by uid 99); 7 Dec 2015 13:47:10 -0000
Received: from Unknown (HELO spamd2-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 07 Dec 2015 13:47:10 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd2-us-west.apache.org (ASF Mail Server at spamd2-us-west.apache.org) with ESMTP id 09A841A34D9
	for <dev@httpd.apache.org>; Mon,  7 Dec 2015 13:47:10 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd2-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 0.653
X-Spam-Level:
X-Spam-Status: No, score=0.653 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, SPF_NEUTRAL=0.652,
	URIBL_BLOCKED=0.001] autolearn=disabled
Authentication-Results: spamd2-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=comcast.net
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd2-us-west.apache.org [10.40.0.9]) (amavisd-new, port 10024)
	with ESMTP id 1OXPegsLF9xS for <dev@httpd.apache.org>;
	Mon,  7 Dec 2015 13:47:02 +0000 (UTC)
Received: from resqmta-po-05v.sys.comcast.net (resqmta-po-05v.sys.comcast.net [96.114.154.164])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id 0648242B93
	for <dev@httpd.apache.org>; Mon,  7 Dec 2015 13:47:01 +0000 (UTC)
Received: from resomta-po-18v.sys.comcast.net ([96.114.154.242])
	by resqmta-po-05v.sys.comcast.net with comcast
	id qdhg1r0045E3ZMc01dhu37; Mon, 07 Dec 2015 13:41:54 +0000
Received: from [192.168.199.10] ([69.251.84.114])
	by resomta-po-18v.sys.comcast.net with comcast
	id qdhu1r0012U0RYt01dhuso; Mon, 07 Dec 2015 13:41:54 +0000
Content-Type: text/plain; charset=iso-8859-1
Mime-Version: 1.0 (Mac OS X Mail 9.1 \(3096.5\))
Subject: Re: reverse proxy wishlist
From: Jim Jagielski <jim@jaguNET.com>
In-Reply-To: <AB1691BE05AE7F4992697F2A0835627AC63BAA97@VOEXM10W.internal.vodafone.com>
Date: Mon, 7 Dec 2015 08:41:53 -0500
Content-Transfer-Encoding: quoted-printable
Message-Id: <3A84C17B-6012-4FCF-84F1-EC998B3AA8A4@jaguNET.com>
References: <288293CD-6D82-42E0-BFC9-9DC25F969ED6@jaguNET.com> <CACsi250e5arsm+EzN1KDJMOD-vAmTyM8M0utTuEfedUGSUfXJw@mail.gmail.com> <77E6470A-4FAD-4DAD-BE9E-E11F54388E2C@jaguNET.com> <CACsi250wpsmUsC5kEWfJOAoYKHG28m2N6NrizHXsHFjU7_nVYQ@mail.gmail.com> <23420A92-4983-40B9-86FD-7B0681983601@jaguNET.com> <CACsi250w43S9-GLmPWeFAUS3wRte81tc=g3f5cWxLLf+Q7Mx5g@mail.gmail.com> <36B2DCA6-40CF-4FC7-B265-4927C24BE745@jaguNET.com> <CACsi250R8eSyv4XTTcj3J-h9vAebEtmgGWyXDJ3=K1RWOqf8cw@mail.gmail.com> <F767A7E7-8BB6-4A0E-BB4C-FAFF08F3D7C0@jaguNET.com> <AB1691BE05AE7F4992697F2A0835627AC63BAA97@VOEXM10W.internal.vodafone.com>
To: dev@httpd.apache.org
X-Mailer: Apple Mail (2.3096.5)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=comcast.net;
	s=q20140121; t=1449495714;
	bh=xfksov2fJ7kgGG5lwf61sxNjbgx84l6SXEmLHRbz4y0=;
	h=Received:Received:Content-Type:Mime-Version:Subject:From:Date:
	 Message-Id:To;
	b=KW1Qiz5hgs6huD2TyaKZHWClSzd5JdLexJyK6iWZnbX+ZKRMRsTvdxQqRFxymC4Eq
	 j2bber4nOZ8fqqT8ZjQDV++/lisdsO5RXWSunX5363FxgZ0cGS74H6ZYudNfZma73Q
	 CdoOXZ6Cdq56i93phwD9Pc3McGZzjVT4jCywd9zje0GXY7DQIu+1FrF0iTxnNQckFS
	 8T0ufdG2OKXfj6pcIGI9gNtSLb8KNti6NLgIWO8VgSoL+Zd95wUs2N5b1zSVck6UiP
	 37qjZATiAx6S+kr8oC24OVJOSy4XULSrREzEudijudLtIjWAR/pBBBJrp49dFpcNi0
	 oMp+O36U/+poQ==


> On Dec 7, 2015, at 8:32 AM, Pl=FCm, R=FCdiger, Vodafone Group =
<ruediger.pluem@vodafone.com> wrote:
> So I would go for a pragmatic approach with no sharp line. I guess we =
can bundle all balancers we deliver into one module. IMHO we wouldn't =
lose anything here

In this particular case, I would be +1. They are extremely small.


From dev-return-84898-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Mon Dec  7 16:02:19 2015
Return-Path: <dev-return-84898-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 6DEF318E57
	for <apmail-httpd-dev-archive@www.apache.org>; Mon,  7 Dec 2015 16:02:19 +0000 (UTC)
Received: (qmail 66220 invoked by uid 500); 7 Dec 2015 16:02:12 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 66161 invoked by uid 500); 7 Dec 2015 16:02:12 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 66149 invoked by uid 99); 7 Dec 2015 16:02:12 -0000
Received: from Unknown (HELO spamd2-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 07 Dec 2015 16:02:12 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd2-us-west.apache.org (ASF Mail Server at spamd2-us-west.apache.org) with ESMTP id BE1161A0C43
	for <dev@httpd.apache.org>; Mon,  7 Dec 2015 16:02:11 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd2-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 1.183
X-Spam-Level: *
X-Spam-Status: No, score=1.183 tagged_above=-999 required=6.31
	tests=[FSL_HELO_BARE_IP_2=0.873, HEADER_FROM_DIFFERENT_DOMAINS=0.001,
	RCVD_NUMERIC_HELO=0.865, RP_MATCHES_RCVD=-0.554, SPF_HELO_PASS=-0.001,
	SPF_PASS=-0.001] autolearn=disabled
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd2-us-west.apache.org [10.40.0.9]) (amavisd-new, port 10024)
	with ESMTP id pHTtk6qNAU9M for <dev@httpd.apache.org>;
	Mon,  7 Dec 2015 16:02:10 +0000 (UTC)
Received: from plane.gmane.org (plane.gmane.org [80.91.229.3])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id 86BD342AD4
	for <dev@httpd.apache.org>; Mon,  7 Dec 2015 16:02:10 +0000 (UTC)
Received: from list by plane.gmane.org with local (Exim 4.69)
	(envelope-from <apache-dev@m.gmane.org>)
	id 1a5y9s-0000sl-Na
	for dev@httpd.apache.org; Mon, 07 Dec 2015 16:57:00 +0100
Received: from 92.66.168.50 ([92.66.168.50])
        by main.gmane.org with esmtp (Gmexim 0.1 (Debian))
        id 1AlnuQ-0007hv-00
        for <dev@httpd.apache.org>; Mon, 07 Dec 2015 16:57:00 +0100
Received: from phpdev by 92.66.168.50 with local (Gmexim 0.1 (Debian))
        id 1AlnuQ-0007hv-00
        for <dev@httpd.apache.org>; Mon, 07 Dec 2015 16:57:00 +0100
X-Injected-Via-Gmane: http://gmane.org/
To: dev@httpd.apache.org
From: Jan Ehrhardt <phpdev@ehrhardt.nl>
Subject: Re: No H2 Window updates!
Date: Mon, 07 Dec 2015 16:56:50 +0100
Lines: 8
Message-ID: <luab6b9pmo6sl3f9j3vdctukh0a9igrbka@4ax.com>
References: <1D08ECCD-A26B-4D3D-8F12-BE97018059B7@greenbytes.de> <043901d12e34$34d311c0$9e793540$@qqmail.nl> <10770C7F-5C8D-42EB-9E76-DC91160FDA89@greenbytes.de> <045e01d12e79$493fe620$dbbfb260$@qqmail.nl> <039D4360-8E2F-455D-8CC2-8405FC7FC272@greenbytes.de> <1jr36b5oa182lb9mupjfm6st4o9qbbr78o@4ax.com> <DA07528F-19ED-44AD-BBDA-DE3301F9F9EC@greenbytes.de> <4hk76bllai2epissk4lbjghj31jmnf03mr@4ax.com> <A2E69AEB-1BA3-489A-83C3-6E7A8A73F3BC@greenbytes.de>
Mime-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Complaints-To: usenet@ger.gmane.org
X-Gmane-NNTP-Posting-Host: 92.66.168.50
X-Newsreader: Forte Agent 3.3/32.846

Stefan Eissing in gmane.comp.apache.devel (Mon, 7 Dec 2015 13:58:07
+0100):
>if you could find the time to verify that the duplicate headers are gone
>in the current 2.4.x version, that'd be nice. Thanks!

They are gone! Time to T&R 2.4.18.
-- 
Jan


From dev-return-84899-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Mon Dec  7 16:08:25 2015
Return-Path: <dev-return-84899-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 98B4218E96
	for <apmail-httpd-dev-archive@www.apache.org>; Mon,  7 Dec 2015 16:08:25 +0000 (UTC)
Received: (qmail 75497 invoked by uid 500); 7 Dec 2015 16:08:25 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 75415 invoked by uid 500); 7 Dec 2015 16:08:25 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 75405 invoked by uid 99); 7 Dec 2015 16:08:24 -0000
Received: from Unknown (HELO spamd1-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 07 Dec 2015 16:08:24 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd1-us-west.apache.org (ASF Mail Server at spamd1-us-west.apache.org) with ESMTP id 8C0DEC557F
	for <dev@httpd.apache.org>; Mon,  7 Dec 2015 16:08:24 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd1-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.12
X-Spam-Level:
X-Spam-Status: No, score=-0.12 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RCVD_IN_MSPIKE_H3=-0.01, RCVD_IN_MSPIKE_WL=-0.01, SPF_PASS=-0.001,
	URIBL_BLOCKED=0.001] autolearn=disabled
Authentication-Results: spamd1-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd1-us-west.apache.org [10.40.0.7]) (amavisd-new, port 10024)
	with ESMTP id gKb_jtzxDyf6 for <dev@httpd.apache.org>;
	Mon,  7 Dec 2015 16:08:17 +0000 (UTC)
Received: from mail-ig0-f169.google.com (mail-ig0-f169.google.com [209.85.213.169])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id 0C54024D8F
	for <dev@httpd.apache.org>; Mon,  7 Dec 2015 16:08:17 +0000 (UTC)
Received: by igcph11 with SMTP id ph11so76736970igc.1
        for <dev@httpd.apache.org>; Mon, 07 Dec 2015 08:03:16 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        bh=2utYdUK3T9w42hUAUbPgJ6sv1C22cuP1Bs5l2KYVyeE=;
        b=kLnTJeHUuznXgPZdhMVJbsql/uOtOSM9Pc/cgldhAJoCnwIzXSaoRzXN61O+9Z56iN
         h2Isv1maBrXfKsp6htMyi5ZzHrKCrx3a9IOHp4i4/tCR2Olu4kFmjzC/Y8+VoxXehIhw
         2B+mr0GQSOf7l8+C5ESfdwkoWzbQmyxHQnlqfCm39JhXnVhbFYkc1kYmopqGuFUo3YsQ
         huIEk5+VKGwOqjTpH0e9ybxvbCjroZm5tx1/i0PmJEVbi0RqJ+7RV9a9eXgWUQjg0u7/
         /ZOXzr8wP/a2SS6miGQdF2P0kCVvfxO5MMNz50KhDBGBTOZ+qyqnLgcDHerFlVREgJij
         Q+FA==
MIME-Version: 1.0
X-Received: by 10.50.155.106 with SMTP id vv10mr15822681igb.36.1449504195980;
 Mon, 07 Dec 2015 08:03:15 -0800 (PST)
Received: by 10.64.114.199 with HTTP; Mon, 7 Dec 2015 08:03:15 -0800 (PST)
In-Reply-To: <luab6b9pmo6sl3f9j3vdctukh0a9igrbka@4ax.com>
References: <1D08ECCD-A26B-4D3D-8F12-BE97018059B7@greenbytes.de>
	<043901d12e34$34d311c0$9e793540$@qqmail.nl>
	<10770C7F-5C8D-42EB-9E76-DC91160FDA89@greenbytes.de>
	<045e01d12e79$493fe620$dbbfb260$@qqmail.nl>
	<039D4360-8E2F-455D-8CC2-8405FC7FC272@greenbytes.de>
	<1jr36b5oa182lb9mupjfm6st4o9qbbr78o@4ax.com>
	<DA07528F-19ED-44AD-BBDA-DE3301F9F9EC@greenbytes.de>
	<4hk76bllai2epissk4lbjghj31jmnf03mr@4ax.com>
	<A2E69AEB-1BA3-489A-83C3-6E7A8A73F3BC@greenbytes.de>
	<luab6b9pmo6sl3f9j3vdctukh0a9igrbka@4ax.com>
Date: Mon, 7 Dec 2015 11:03:15 -0500
Message-ID: <CALK=YjOjG5Lo-punwB1p3yeSYO=yUEmgC7YQS1ERVvvuhXjcrw@mail.gmail.com>
Subject: Re: No H2 Window updates!
From: Eric Covener <covener@gmail.com>
To: Apache HTTP Server Development List <dev@httpd.apache.org>
Content-Type: text/plain; charset=UTF-8

On Mon, Dec 7, 2015 at 10:56 AM, Jan Ehrhardt <phpdev@ehrhardt.nl> wrote:
> Stefan Eissing in gmane.comp.apache.devel (Mon, 7 Dec 2015 13:58:07
> +0100):
>>if you could find the time to verify that the duplicate headers are gone
>>in the current 2.4.x version, that'd be nice. Thanks!
>
> They are gone! Time to T&R 2.4.18.

Thanks for driving this one Jan.

From dev-return-84900-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Mon Dec  7 16:13:54 2015
Return-Path: <dev-return-84900-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id AC72C18EFB
	for <apmail-httpd-dev-archive@www.apache.org>; Mon,  7 Dec 2015 16:13:54 +0000 (UTC)
Received: (qmail 87842 invoked by uid 500); 7 Dec 2015 16:13:54 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 87763 invoked by uid 500); 7 Dec 2015 16:13:54 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 87753 invoked by uid 99); 7 Dec 2015 16:13:54 -0000
Received: from Unknown (HELO spamd4-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 07 Dec 2015 16:13:54 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd4-us-west.apache.org (ASF Mail Server at spamd4-us-west.apache.org) with ESMTP id B1A38C0F8F
	for <dev@httpd.apache.org>; Mon,  7 Dec 2015 16:13:53 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd4-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 3
X-Spam-Level: ***
X-Spam-Status: No, score=3 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, HTML_MESSAGE=3,
	SPF_PASS=-0.001, URIBL_BLOCKED=0.001] autolearn=disabled
Authentication-Results: spamd4-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=rowe-clan-net.20150623.gappssmtp.com
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd4-us-west.apache.org [10.40.0.11]) (amavisd-new, port 10024)
	with ESMTP id nda9WiKrfQEg for <dev@httpd.apache.org>;
	Mon,  7 Dec 2015 16:13:40 +0000 (UTC)
Received: from mail-io0-f169.google.com (mail-io0-f169.google.com [209.85.223.169])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id 0DE3424EB7
	for <dev@httpd.apache.org>; Mon,  7 Dec 2015 16:13:40 +0000 (UTC)
Received: by ioc74 with SMTP id 74so185639887ioc.2
        for <dev@httpd.apache.org>; Mon, 07 Dec 2015 08:13:39 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=rowe-clan-net.20150623.gappssmtp.com; s=20150623;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        bh=hqo+Oy3XfflSMhQ5MvV4qrGyLsKrF5LooE/SDz7s80o=;
        b=hQba9QJ+azJWwjNRZDioOcl52mhTyOAeDTJ5ld16IPcMkWHiBVFkhPbOUZnpguRjwT
         xzoRcp6+mhhBxVwMRGR4dhw9rab/sB13+gfnbLfPD9NhDzwBOIZkuHHRcXN4FFRd/gba
         v9Op14Qa2nngbHNSYGo4geRMgEZxq9kQ6hFnLxd193w0EBPnNQsALlqYS1FnTMdFKKFy
         iTDSD0E7UrvYC8n7tMf5dPMXRpYz2yuCPiD63CMEmV76SBc1a+29A/Z7i8/WLjLakJ04
         EBThRZKNla8t1xrWjZ2IATM7+YNUMDFx6UN/rMWX54/fWmKgfqIQiBpkXeEPx6C7XRnh
         bH9Q==
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=1e100.net; s=20130820;
        h=x-gm-message-state:mime-version:in-reply-to:references:date
         :message-id:subject:from:to:content-type;
        bh=hqo+Oy3XfflSMhQ5MvV4qrGyLsKrF5LooE/SDz7s80o=;
        b=KsOnilO7dMBvncfUC5j+8bBJs1FmDQkaBw9juorzOu08BHOER/XqXwkuzp/w95RcLy
         cRG9hjzExeX1yfGrOAYCtrt2yMKQKIAW2k3Q7R59Yh8veqhXBN74fI5lqg2Me5ijs79b
         DnkbCzwLTCTevFQNTr5ZYbM05YdaErmoSlLRMmmx22u51E3AoV9wUj5YxuM+mA4oW88i
         whmEzLm2rPtErgVVBtmq1f/fLgD1MlQILG7IQRcSpvAj82vkDgp/jIz9M/sYb78MFfY7
         DUY1v81d8RWpoCxdmWT2jpJfjtgtg5Jy4R1BOYYExFCBuWUrZMrly2m3ZGsQ4DsnhZxt
         mUHA==
X-Gm-Message-State: ALoCoQlSId9c85pK8fcimMSvUmvfdcEArjkJyMTdUcxh6DupInujMFEN8KCfIkmm1FKodaWdsZo6
MIME-Version: 1.0
X-Received: by 10.107.10.66 with SMTP id u63mr24505081ioi.86.1449504818967;
 Mon, 07 Dec 2015 08:13:38 -0800 (PST)
Received: by 10.107.62.136 with HTTP; Mon, 7 Dec 2015 08:13:38 -0800 (PST)
In-Reply-To: <72579D23-A595-4265-BFCC-2BEA67C92510@greenbytes.de>
References: <10770C7F-5C8D-42EB-9E76-DC91160FDA89@greenbytes.de>
	<045e01d12e79$493fe620$dbbfb260$@qqmail.nl>
	<039D4360-8E2F-455D-8CC2-8405FC7FC272@greenbytes.de>
	<1jr36b5oa182lb9mupjfm6st4o9qbbr78o@4ax.com>
	<DA07528F-19ED-44AD-BBDA-DE3301F9F9EC@greenbytes.de>
	<unu66bptvbt2o9g4po12md8mdsleho74fc@4ax.com>
	<v3976b5hieisv5eft645gcp5lrc77gser7@4ax.com>
	<qie76b9kq4s5f2vsk1tjo77gcis74vr685@4ax.com>
	<7jm76bl476qb5mgtqclss32uu84cr2gt69@4ax.com>
	<B4EFB75E-1DB6-4C75-9ABD-76C205E87F06@greenbytes.de>
	<lu686btb0b0jk0cmnmq223kr03k9t3shlg@4ax.com>
	<5B371782-8C70-41D7-A6DC-DE4E6E8A7585@jaguNET.com>
	<72579D23-A595-4265-BFCC-2BEA67C92510@greenbytes.de>
Date: Mon, 7 Dec 2015 10:13:38 -0600
Message-ID: <CACsi252DArq2Q03NPFT+sx6jjAk2CTT14meBituV-A=7AQEA-Q@mail.gmail.com>
Subject: Re: mod_http2 1.0.7+ and Drupal (Was: No H2 Window updates!)
From: William A Rowe Jr <wrowe@rowe-clan.net>
To: httpd <dev@httpd.apache.org>
Content-Type: multipart/alternative; boundary=001a113f93bed5dded05265123f2

--001a113f93bed5dded05265123f2
Content-Type: text/plain; charset=UTF-8

Within internal_internal_redirect;

  83750   fielding     /*
  83750   fielding      * XXX: hmm.  This is because mod_setenvif and
mod_unique_id really need
  83750   fielding      * to do their thing on internal redirects as well.
Perhaps this is a
  83750   fielding      * misnamed function.
  83750   fielding      */
  83750   fielding     if ((access_status = ap_run_post_read_request(new)))
{
  83750   fielding         ap_die(access_status, new);
  83750   fielding         return NULL;
  83750   fielding     }

That's some ancient mojo there :)


On Mon, Dec 7, 2015 at 6:46 AM, Stefan Eissing <stefan.eissing@greenbytes.de
> wrote:

> I think I just found the problem:
>
> I thought that h2_h2.c, line 678 was no longer needed. But under some,
> still unknown, conditions the post_read_req hook is called twice. That
> makes a table overlay twice which results in all headers_out be present
> twice.
>
> I will remove the filter again before installing it. Someday, I need to
> understand the double invocation of the hook...
>
> //Stefan
>
> > Am 07.12.2015 um 13:38 schrieb Jim Jagielski <jim@jaguNET.com>:
> >
> > Can you retry w DEBUG level, to see if  h2_response_trailers_filter()
> > is the issue?
> >
> >> On Dec 6, 2015, at 6:33 AM, Jan Ehrhardt <phpdev@ehrhardt.nl> wrote:
> >>
> >> Stefan Eissing in gmane.comp.apache.devel (Sun, 6 Dec 2015 09:26:56
> +0100):
> >>> Jan, thanks for tracking this down to the duplicate headers. I will
> look into it.
> >>>
> >>> Just to be sure I got everything right: you tested against the mod_h2
> github versions?
> >>
> >> I used the sources from the ASF repos. This one worked OK:
> >>
> >> svn co -r 1715371
> http://svn.apache.org/repos/asf/httpd/httpd/branches/2.4.x/modules/http2
> >>
> >> But this one had the duplicate tokens:
> >>
> >> svn co -r 1716210
> http://svn.apache.org/repos/asf/httpd/httpd/branches/2.4.x/modules/http2
> >> --
> >> Jan
> >>
> >
>
>

--001a113f93bed5dded05265123f2
Content-Type: text/html; charset=UTF-8
Content-Transfer-Encoding: quoted-printable

<div dir=3D"ltr">Within internal_internal_redirect;<div><br></div><div><div=
><div>=C2=A0 83750 =C2=A0 fielding =C2=A0 =C2=A0 /*</div><div>=C2=A0 83750 =
=C2=A0 fielding =C2=A0 =C2=A0 =C2=A0* XXX: hmm.=C2=A0 This is because mod_s=
etenvif and mod_unique_id really need</div><div>=C2=A0 83750 =C2=A0 fieldin=
g =C2=A0 =C2=A0 =C2=A0* to do their thing on internal redirects as well.=C2=
=A0 Perhaps this is a</div><div>=C2=A0 83750 =C2=A0 fielding =C2=A0 =C2=A0 =
=C2=A0* misnamed function.</div><div>=C2=A0 83750 =C2=A0 fielding =C2=A0 =
=C2=A0 =C2=A0*/</div><div>=C2=A0 83750 =C2=A0 fielding =C2=A0 =C2=A0 if ((a=
ccess_status =3D ap_run_post_read_request(new))) {</div><div>=C2=A0 83750 =
=C2=A0 fielding =C2=A0 =C2=A0 =C2=A0 =C2=A0 ap_die(access_status, new);</di=
v><div>=C2=A0 83750 =C2=A0 fielding =C2=A0 =C2=A0 =C2=A0 =C2=A0 return NULL=
;</div><div>=C2=A0 83750 =C2=A0 fielding =C2=A0 =C2=A0 }</div><div><br></di=
v></div></div><div>That&#39;s some ancient mojo there :)</div><div><br></di=
v></div><div class=3D"gmail_extra"><br><div class=3D"gmail_quote">On Mon, D=
ec 7, 2015 at 6:46 AM, Stefan Eissing <span dir=3D"ltr">&lt;<a href=3D"mail=
to:stefan.eissing@greenbytes.de" target=3D"_blank">stefan.eissing@greenbyte=
s.de</a>&gt;</span> wrote:<br><blockquote class=3D"gmail_quote" style=3D"ma=
rgin:0 0 0 .8ex;border-left:1px #ccc solid;padding-left:1ex">I think I just=
 found the problem:<br>
<br>
I thought that h2_h2.c, line 678 was no longer needed. But under some, stil=
l unknown, conditions the post_read_req hook is called twice. That makes a =
table overlay twice which results in all headers_out be present twice.<br>
<br>
I will remove the filter again before installing it. Someday, I need to und=
erstand the double invocation of the hook...<br>
<span class=3D"HOEnZb"><font color=3D"#888888"><br>
//Stefan<br>
</font></span><div class=3D"HOEnZb"><div class=3D"h5"><br>
&gt; Am 07.12.2015 um 13:38 schrieb Jim Jagielski &lt;jim@jaguNET.com&gt;:<=
br>
&gt;<br>
&gt; Can you retry w DEBUG level, to see if=C2=A0 h2_response_trailers_filt=
er()<br>
&gt; is the issue?<br>
&gt;<br>
&gt;&gt; On Dec 6, 2015, at 6:33 AM, Jan Ehrhardt &lt;<a href=3D"mailto:php=
dev@ehrhardt.nl">phpdev@ehrhardt.nl</a>&gt; wrote:<br>
&gt;&gt;<br>
&gt;&gt; Stefan Eissing in gmane.comp.apache.devel (Sun, 6 Dec 2015 09:26:5=
6 +0100):<br>
&gt;&gt;&gt; Jan, thanks for tracking this down to the duplicate headers. I=
 will look into it.<br>
&gt;&gt;&gt;<br>
&gt;&gt;&gt; Just to be sure I got everything right: you tested against the=
 mod_h2 github versions?<br>
&gt;&gt;<br>
&gt;&gt; I used the sources from the ASF repos. This one worked OK:<br>
&gt;&gt;<br>
&gt;&gt; svn co -r 1715371 <a href=3D"http://svn.apache.org/repos/asf/httpd=
/httpd/branches/2.4.x/modules/http2" rel=3D"noreferrer" target=3D"_blank">h=
ttp://svn.apache.org/repos/asf/httpd/httpd/branches/2.4.x/modules/http2</a>=
<br>
&gt;&gt;<br>
&gt;&gt; But this one had the duplicate tokens:<br>
&gt;&gt;<br>
&gt;&gt; svn co -r 1716210 <a href=3D"http://svn.apache.org/repos/asf/httpd=
/httpd/branches/2.4.x/modules/http2" rel=3D"noreferrer" target=3D"_blank">h=
ttp://svn.apache.org/repos/asf/httpd/httpd/branches/2.4.x/modules/http2</a>=
<br>
&gt;&gt; --<br>
&gt;&gt; Jan<br>
&gt;&gt;<br>
&gt;<br>
<br>
</div></div></blockquote></div><br></div>

--001a113f93bed5dded05265123f2--

From dev-return-84901-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Mon Dec  7 16:16:20 2015
Return-Path: <dev-return-84901-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 7866818F17
	for <apmail-httpd-dev-archive@www.apache.org>; Mon,  7 Dec 2015 16:16:20 +0000 (UTC)
Received: (qmail 97341 invoked by uid 500); 7 Dec 2015 16:16:20 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 97278 invoked by uid 500); 7 Dec 2015 16:16:19 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 97268 invoked by uid 99); 7 Dec 2015 16:16:19 -0000
Received: from Unknown (HELO spamd3-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 07 Dec 2015 16:16:19 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd3-us-west.apache.org (ASF Mail Server at spamd3-us-west.apache.org) with ESMTP id 7CBD4180ABA
	for <dev@httpd.apache.org>; Mon,  7 Dec 2015 16:16:19 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd3-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 0.97
X-Spam-Level:
X-Spam-Status: No, score=0.97 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RP_MATCHES_RCVD=-0.554, SPF_PASS=-0.001, SUBJ_ALL_CAPS=1.625]
	autolearn=disabled
Authentication-Results: spamd3-us-west.apache.org (amavisd-new);
	dkim=pass (1024-bit key) header.d=greenbytes.de
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd3-us-west.apache.org [10.40.0.10]) (amavisd-new, port 10024)
	with ESMTP id euUeg9Ub2DEC for <dev@httpd.apache.org>;
	Mon,  7 Dec 2015 16:16:18 +0000 (UTC)
Received: from mail.greenbytes.de (mail.greenbytes.de [217.91.35.233])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id CE5B224DBD
	for <dev@httpd.apache.org>; Mon,  7 Dec 2015 16:16:17 +0000 (UTC)
Received: from [192.168.1.42] (unknown [217.91.35.233])
	(using TLSv1 with cipher ECDHE-RSA-AES256-SHA (256/256 bits))
	(Client did not present a certificate)
	by mail.greenbytes.de (Postfix) with ESMTPSA id 0A2BD15A049C
	for <dev@httpd.apache.org>; Mon,  7 Dec 2015 17:16:17 +0100 (CET)
DKIM-Signature: v=1; a=rsa-sha256; c=simple/simple; d=greenbytes.de; s=mail;
	t=1449504977; bh=v5yvcb2u3guxL23VITVNtqjKBjr7FA2mYZ2wImrEe18=;
	h=From:Subject:Date:To:From;
	b=gzE8nbj4MsLg0fQJHdm2tXUv4QQqOR9qXNwTkJ7fISj7SaIUCs40HSykE2Pf1DU4P
	 Eckbay1YuBaTk3xZEub1qV2M35hRpW+f91arpJ5yRKCm98ZnG1BsP588vgKsQysrq9
	 8iA+EJb1oj2RmuHJyajFZE6nLFEsa56gRS37m64Y=
From: Stefan Eissing <stefan.eissing@greenbytes.de>
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: quoted-printable
Subject: 2.4.18 T&R
Message-Id: <A0F1479E-B80B-4F2F-8F15-C9FAFC26D561@greenbytes.de>
Date: Mon, 7 Dec 2015 17:16:16 +0100
To: dev@httpd.apache.org
Mime-Version: 1.0 (Mac OS X Mail 9.1 \(3096.5\))
X-Mailer: Apple Mail (2.3096.5)

Everything as it should be from mod_http2 for this.

//Stefan

PS. Had one changed to the mod_http2.xml and when I 'make docs'ed it, I =
got too many changes locally. If someone with more knowledge than me on =
this would be so kind...=

From dev-return-84902-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Mon Dec  7 16:19:56 2015
Return-Path: <dev-return-84902-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 02A0318F33
	for <apmail-httpd-dev-archive@www.apache.org>; Mon,  7 Dec 2015 16:19:56 +0000 (UTC)
Received: (qmail 4037 invoked by uid 500); 7 Dec 2015 16:19:55 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 3970 invoked by uid 500); 7 Dec 2015 16:19:55 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 3960 invoked by uid 99); 7 Dec 2015 16:19:55 -0000
Received: from Unknown (HELO spamd3-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 07 Dec 2015 16:19:55 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd3-us-west.apache.org (ASF Mail Server at spamd3-us-west.apache.org) with ESMTP id C7A7F18028B
	for <dev@httpd.apache.org>; Mon,  7 Dec 2015 16:19:54 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd3-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.654
X-Spam-Level:
X-Spam-Status: No, score=-0.654 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RP_MATCHES_RCVD=-0.554, SPF_PASS=-0.001, URIBL_BLOCKED=0.001]
	autolearn=disabled
Authentication-Results: spamd3-us-west.apache.org (amavisd-new);
	dkim=pass (1024-bit key) header.d=greenbytes.de
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd3-us-west.apache.org [10.40.0.10]) (amavisd-new, port 10024)
	with ESMTP id P8b0ZDcbJ316 for <dev@httpd.apache.org>;
	Mon,  7 Dec 2015 16:19:42 +0000 (UTC)
Received: from mail.greenbytes.de (mail.greenbytes.de [217.91.35.233])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id 1EFC020F4F
	for <dev@httpd.apache.org>; Mon,  7 Dec 2015 16:19:42 +0000 (UTC)
Received: from [192.168.1.42] (unknown [217.91.35.233])
	(using TLSv1 with cipher ECDHE-RSA-AES256-SHA (256/256 bits))
	(Client did not present a certificate)
	by mail.greenbytes.de (Postfix) with ESMTPSA id 754F015A049C
	for <dev@httpd.apache.org>; Mon,  7 Dec 2015 17:19:41 +0100 (CET)
DKIM-Signature: v=1; a=rsa-sha256; c=simple/simple; d=greenbytes.de; s=mail;
	t=1449505181; bh=KPtMDOkAVmFJ2wQUOBe+P+JKsK+PdgWWV3cIk7hT5cs=;
	h=Subject:From:In-Reply-To:Date:References:To:From;
	b=rmX5BnlBc7PQeiCc9R+VqOJJ+Qo/VupGyCsalLvyql75iCUoL5g4O/9POH4eymb4k
	 hdxggh9d8U62wASTu5qIuTMt+D4ZlhWYPP/WXOpDg8H8G/BU7Q1+PyOU4+q5yUBkao
	 aZnnUAkxF3jqKKzx+JRgtdcy2TuDF7efgZfpDQT0=
Content-Type: text/plain; charset=us-ascii
Mime-Version: 1.0 (Mac OS X Mail 9.1 \(3096.5\))
Subject: Re: mod_http2 1.0.7+ and Drupal (Was: No H2 Window updates!)
From: Stefan Eissing <stefan.eissing@greenbytes.de>
In-Reply-To: <CACsi252DArq2Q03NPFT+sx6jjAk2CTT14meBituV-A=7AQEA-Q@mail.gmail.com>
Date: Mon, 7 Dec 2015 17:19:41 +0100
Content-Transfer-Encoding: quoted-printable
Message-Id: <1E5428D8-A309-463E-99DB-03503A66CA87@greenbytes.de>
References: <10770C7F-5C8D-42EB-9E76-DC91160FDA89@greenbytes.de> <045e01d12e79$493fe620$dbbfb260$@qqmail.nl> <039D4360-8E2F-455D-8CC2-8405FC7FC272@greenbytes.de> <1jr36b5oa182lb9mupjfm6st4o9qbbr78o@4ax.com> <DA07528F-19ED-44AD-BBDA-DE3301F9F9EC@greenbytes.de> <unu66bptvbt2o9g4po12md8mdsleho74fc@4ax.com> <v3976b5hieisv5eft645gcp5lrc77gser7@4ax.com> <qie76b9kq4s5f2vsk1tjo77gcis74vr685@4ax.com> <7jm76bl476qb5mgtqclss32uu84cr2gt69@4ax.com> <B4EFB75E-1DB6-4C75-9ABD-76C205E87F06@greenbytes.de> <lu686btb0b0jk0cmnmq223kr03k9t3shlg@4ax.com> <5B371782-8C70-41D7-A6DC-DE4E6E8A7585@jaguNET.com> <72579D23-A595-4265-BFCC-2BEA67C92510@greenbytes.de> <CACsi252DArq2Q03NPFT+sx6jjAk2CTT14meBituV-A=7AQEA-Q@mail.gmail.com>
To: dev@httpd.apache.org
X-Mailer: Apple Mail (2.3096.5)

Oh, I see. I ran into a special_special...

How would I easily trigger this in a test config?

> Am 07.12.2015 um 17:13 schrieb William A Rowe Jr =
<wrowe@rowe-clan.net>:
>=20
> Within internal_internal_redirect;
>=20
>   83750   fielding     /*
>   83750   fielding      * XXX: hmm.  This is because mod_setenvif and =
mod_unique_id really need
>   83750   fielding      * to do their thing on internal redirects as =
well.  Perhaps this is a
>   83750   fielding      * misnamed function.
>   83750   fielding      */
>   83750   fielding     if ((access_status =3D =
ap_run_post_read_request(new))) {
>   83750   fielding         ap_die(access_status, new);
>   83750   fielding         return NULL;
>   83750   fielding     }
>=20
> That's some ancient mojo there :)
>=20
>=20
> On Mon, Dec 7, 2015 at 6:46 AM, Stefan Eissing =
<stefan.eissing@greenbytes.de> wrote:
> I think I just found the problem:
>=20
> I thought that h2_h2.c, line 678 was no longer needed. But under some, =
still unknown, conditions the post_read_req hook is called twice. That =
makes a table overlay twice which results in all headers_out be present =
twice.
>=20
> I will remove the filter again before installing it. Someday, I need =
to understand the double invocation of the hook...
>=20
> //Stefan
>=20
> > Am 07.12.2015 um 13:38 schrieb Jim Jagielski <jim@jaguNET.com>:
> >
> > Can you retry w DEBUG level, to see if  =
h2_response_trailers_filter()
> > is the issue?
> >
> >> On Dec 6, 2015, at 6:33 AM, Jan Ehrhardt <phpdev@ehrhardt.nl> =
wrote:
> >>
> >> Stefan Eissing in gmane.comp.apache.devel (Sun, 6 Dec 2015 09:26:56 =
+0100):
> >>> Jan, thanks for tracking this down to the duplicate headers. I =
will look into it.
> >>>
> >>> Just to be sure I got everything right: you tested against the =
mod_h2 github versions?
> >>
> >> I used the sources from the ASF repos. This one worked OK:
> >>
> >> svn co -r 1715371 =
http://svn.apache.org/repos/asf/httpd/httpd/branches/2.4.x/modules/http2
> >>
> >> But this one had the duplicate tokens:
> >>
> >> svn co -r 1716210 =
http://svn.apache.org/repos/asf/httpd/httpd/branches/2.4.x/modules/http2
> >> --
> >> Jan
> >>
> >
>=20
>=20


From dev-return-84903-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Mon Dec  7 16:29:56 2015
Return-Path: <dev-return-84903-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 272BF18FAE
	for <apmail-httpd-dev-archive@www.apache.org>; Mon,  7 Dec 2015 16:29:56 +0000 (UTC)
Received: (qmail 41191 invoked by uid 500); 7 Dec 2015 16:29:55 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 41115 invoked by uid 500); 7 Dec 2015 16:29:55 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 41105 invoked by uid 99); 7 Dec 2015 16:29:55 -0000
Received: from Unknown (HELO spamd2-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 07 Dec 2015 16:29:55 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd2-us-west.apache.org (ASF Mail Server at spamd2-us-west.apache.org) with ESMTP id D78001A34EC
	for <dev@httpd.apache.org>; Mon,  7 Dec 2015 16:29:54 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd2-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 3.001
X-Spam-Level: ***
X-Spam-Status: No, score=3.001 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, HTML_MESSAGE=3,
	URIBL_BLOCKED=0.001] autolearn=disabled
Authentication-Results: spamd2-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=rowe-clan-net.20150623.gappssmtp.com
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd2-us-west.apache.org [10.40.0.9]) (amavisd-new, port 10024)
	with ESMTP id XpRwNdEnY44L for <dev@httpd.apache.org>;
	Mon,  7 Dec 2015 16:29:41 +0000 (UTC)
Received: from mail-io0-f171.google.com (mail-io0-f171.google.com [209.85.223.171])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id C278442B0F
	for <dev@httpd.apache.org>; Mon,  7 Dec 2015 16:29:40 +0000 (UTC)
Received: by ioc74 with SMTP id 74so186021271ioc.2
        for <dev@httpd.apache.org>; Mon, 07 Dec 2015 08:24:39 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=rowe-clan-net.20150623.gappssmtp.com; s=20150623;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        bh=tr5QhJtQSHy5QaZ+v3s2obL0tTNtHDtmKAWyMr7y0WI=;
        b=EW6qFIQdV8H8U4BadVP9wwo3fw7sYqyohOibWPfKUU560Dxyrni+M/p4BkUWUudEai
         813e9gBA3AfikwqDzao0rqxcXaYKcMqv0pjd49ktfHhOPJ7nHzejDn33fC4HZ1o6p7Rn
         OGSK5XnBVcMpcng7ZjaJnm0yVk4QtqCDG96/Uqd62uHbzhqSt8dKvtsL06ehNRsB8j5S
         nN8LojVizCD8zIYLlHKl9mXHtm4kHGLZBCmJN7WT1Wee493pyEnmlh+5dVo01RSHLuJ6
         nrTmHA1SmY5COJXWYucjXxANR2dUsRoEngNuUl0PABBFZSPGQo5TAbgbFp5h62EzbA9z
         Dqlw==
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=1e100.net; s=20130820;
        h=x-gm-message-state:mime-version:in-reply-to:references:date
         :message-id:subject:from:to:content-type;
        bh=tr5QhJtQSHy5QaZ+v3s2obL0tTNtHDtmKAWyMr7y0WI=;
        b=HKQDPRXuTX6wlDLY35ALqwJlPxQj4tYNkyGgS6VXNj+4ctq+KswH5RAYhvkrjY8KDs
         Nz44vvYIQlh6hPBLmVcWWhQzzcNYYNbAg74bMA0wunAK3J23yqekfzokbxcQu4Ag3ukl
         KVViS1iphupM3c9pTSMLf+/mthHQ/Z4e2T6bg81JS+7Cd0al+ccfJJuYzq6BR/Lu7BVZ
         Oou6+HK+U/qppFq7Ms/rn9t3qdfADNF0LrPGfMKdC/CEHmdiBtkgwHEqsb4BYHsmtjlk
         15LgmtFx3oMvu425T19LcWz8+GH2th3M8lqTj0FNqKLRP+l7Yt8JJWaE0HRuNDNhrr0K
         iQ0Q==
X-Gm-Message-State: ALoCoQk5ENPElG8ma2t5i1AyLWQYgZZJGJ+BmebqEzx13dklYCIPDIwJ271Moo0Oa9PfwjZrNxYw
MIME-Version: 1.0
X-Received: by 10.107.156.6 with SMTP id f6mr26430061ioe.163.1449505479210;
 Mon, 07 Dec 2015 08:24:39 -0800 (PST)
Received: by 10.107.62.136 with HTTP; Mon, 7 Dec 2015 08:24:39 -0800 (PST)
In-Reply-To: <1E5428D8-A309-463E-99DB-03503A66CA87@greenbytes.de>
References: <10770C7F-5C8D-42EB-9E76-DC91160FDA89@greenbytes.de>
	<045e01d12e79$493fe620$dbbfb260$@qqmail.nl>
	<039D4360-8E2F-455D-8CC2-8405FC7FC272@greenbytes.de>
	<1jr36b5oa182lb9mupjfm6st4o9qbbr78o@4ax.com>
	<DA07528F-19ED-44AD-BBDA-DE3301F9F9EC@greenbytes.de>
	<unu66bptvbt2o9g4po12md8mdsleho74fc@4ax.com>
	<v3976b5hieisv5eft645gcp5lrc77gser7@4ax.com>
	<qie76b9kq4s5f2vsk1tjo77gcis74vr685@4ax.com>
	<7jm76bl476qb5mgtqclss32uu84cr2gt69@4ax.com>
	<B4EFB75E-1DB6-4C75-9ABD-76C205E87F06@greenbytes.de>
	<lu686btb0b0jk0cmnmq223kr03k9t3shlg@4ax.com>
	<5B371782-8C70-41D7-A6DC-DE4E6E8A7585@jaguNET.com>
	<72579D23-A595-4265-BFCC-2BEA67C92510@greenbytes.de>
	<CACsi252DArq2Q03NPFT+sx6jjAk2CTT14meBituV-A=7AQEA-Q@mail.gmail.com>
	<1E5428D8-A309-463E-99DB-03503A66CA87@greenbytes.de>
Date: Mon, 7 Dec 2015 10:24:39 -0600
Message-ID: <CACsi250DCod3jxwcNHj=1nd2PG_5m_935WtCv2j0fh1rNL+HUQ@mail.gmail.com>
Subject: Re: mod_http2 1.0.7+ and Drupal (Was: No H2 Window updates!)
From: William A Rowe Jr <wrowe@rowe-clan.net>
To: httpd <dev@httpd.apache.org>
Content-Type: multipart/alternative; boundary=001a1140ccc03074530526514b58

--001a1140ccc03074530526514b58
Content-Type: text/plain; charset=UTF-8

Any internal redirect (such as his admin panel configuration).  Serving
redirected static example content should be fine.



On Mon, Dec 7, 2015 at 10:19 AM, Stefan Eissing <
stefan.eissing@greenbytes.de> wrote:

> Oh, I see. I ran into a special_special...
>
> How would I easily trigger this in a test config?
>
> > Am 07.12.2015 um 17:13 schrieb William A Rowe Jr <wrowe@rowe-clan.net>:
> >
> > Within internal_internal_redirect;
> >
> >   83750   fielding     /*
> >   83750   fielding      * XXX: hmm.  This is because mod_setenvif and
> mod_unique_id really need
> >   83750   fielding      * to do their thing on internal redirects as
> well.  Perhaps this is a
> >   83750   fielding      * misnamed function.
> >   83750   fielding      */
> >   83750   fielding     if ((access_status =
> ap_run_post_read_request(new))) {
> >   83750   fielding         ap_die(access_status, new);
> >   83750   fielding         return NULL;
> >   83750   fielding     }
> >
> > That's some ancient mojo there :)
> >
> >
> > On Mon, Dec 7, 2015 at 6:46 AM, Stefan Eissing <
> stefan.eissing@greenbytes.de> wrote:
> > I think I just found the problem:
> >
> > I thought that h2_h2.c, line 678 was no longer needed. But under some,
> still unknown, conditions the post_read_req hook is called twice. That
> makes a table overlay twice which results in all headers_out be present
> twice.
> >
> > I will remove the filter again before installing it. Someday, I need to
> understand the double invocation of the hook...
> >
> > //Stefan
> >
> > > Am 07.12.2015 um 13:38 schrieb Jim Jagielski <jim@jaguNET.com>:
> > >
> > > Can you retry w DEBUG level, to see if  h2_response_trailers_filter()
> > > is the issue?
> > >
> > >> On Dec 6, 2015, at 6:33 AM, Jan Ehrhardt <phpdev@ehrhardt.nl> wrote:
> > >>
> > >> Stefan Eissing in gmane.comp.apache.devel (Sun, 6 Dec 2015 09:26:56
> +0100):
> > >>> Jan, thanks for tracking this down to the duplicate headers. I will
> look into it.
> > >>>
> > >>> Just to be sure I got everything right: you tested against the
> mod_h2 github versions?
> > >>
> > >> I used the sources from the ASF repos. This one worked OK:
> > >>
> > >> svn co -r 1715371
> http://svn.apache.org/repos/asf/httpd/httpd/branches/2.4.x/modules/http2
> > >>
> > >> But this one had the duplicate tokens:
> > >>
> > >> svn co -r 1716210
> http://svn.apache.org/repos/asf/httpd/httpd/branches/2.4.x/modules/http2
> > >> --
> > >> Jan
> > >>
> > >
> >
> >
>
>

--001a1140ccc03074530526514b58
Content-Type: text/html; charset=UTF-8
Content-Transfer-Encoding: quoted-printable

<div dir=3D"ltr">Any internal redirect (such as his admin panel configurati=
on).=C2=A0 Serving<div>redirected static example content should be fine.<br=
><div><br></div><div><br></div></div></div><div class=3D"gmail_extra"><br><=
div class=3D"gmail_quote">On Mon, Dec 7, 2015 at 10:19 AM, Stefan Eissing <=
span dir=3D"ltr">&lt;<a href=3D"mailto:stefan.eissing@greenbytes.de" target=
=3D"_blank">stefan.eissing@greenbytes.de</a>&gt;</span> wrote:<br><blockquo=
te class=3D"gmail_quote" style=3D"margin:0 0 0 .8ex;border-left:1px #ccc so=
lid;padding-left:1ex">Oh, I see. I ran into a special_special...<br>
<br>
How would I easily trigger this in a test config?<br>
<div class=3D"HOEnZb"><div class=3D"h5"><br>
&gt; Am 07.12.2015 um 17:13 schrieb William A Rowe Jr &lt;<a href=3D"mailto=
:wrowe@rowe-clan.net">wrowe@rowe-clan.net</a>&gt;:<br>
&gt;<br>
&gt; Within internal_internal_redirect;<br>
&gt;<br>
&gt;=C2=A0 =C2=A083750=C2=A0 =C2=A0fielding=C2=A0 =C2=A0 =C2=A0/*<br>
&gt;=C2=A0 =C2=A083750=C2=A0 =C2=A0fielding=C2=A0 =C2=A0 =C2=A0 * XXX: hmm.=
=C2=A0 This is because mod_setenvif and mod_unique_id really need<br>
&gt;=C2=A0 =C2=A083750=C2=A0 =C2=A0fielding=C2=A0 =C2=A0 =C2=A0 * to do the=
ir thing on internal redirects as well.=C2=A0 Perhaps this is a<br>
&gt;=C2=A0 =C2=A083750=C2=A0 =C2=A0fielding=C2=A0 =C2=A0 =C2=A0 * misnamed =
function.<br>
&gt;=C2=A0 =C2=A083750=C2=A0 =C2=A0fielding=C2=A0 =C2=A0 =C2=A0 */<br>
&gt;=C2=A0 =C2=A083750=C2=A0 =C2=A0fielding=C2=A0 =C2=A0 =C2=A0if ((access_=
status =3D ap_run_post_read_request(new))) {<br>
&gt;=C2=A0 =C2=A083750=C2=A0 =C2=A0fielding=C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=
=A0ap_die(access_status, new);<br>
&gt;=C2=A0 =C2=A083750=C2=A0 =C2=A0fielding=C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=
=A0return NULL;<br>
&gt;=C2=A0 =C2=A083750=C2=A0 =C2=A0fielding=C2=A0 =C2=A0 =C2=A0}<br>
&gt;<br>
&gt; That&#39;s some ancient mojo there :)<br>
&gt;<br>
&gt;<br>
&gt; On Mon, Dec 7, 2015 at 6:46 AM, Stefan Eissing &lt;<a href=3D"mailto:s=
tefan.eissing@greenbytes.de">stefan.eissing@greenbytes.de</a>&gt; wrote:<br=
>
&gt; I think I just found the problem:<br>
&gt;<br>
&gt; I thought that h2_h2.c, line 678 was no longer needed. But under some,=
 still unknown, conditions the post_read_req hook is called twice. That mak=
es a table overlay twice which results in all headers_out be present twice.=
<br>
&gt;<br>
&gt; I will remove the filter again before installing it. Someday, I need t=
o understand the double invocation of the hook...<br>
&gt;<br>
&gt; //Stefan<br>
&gt;<br>
&gt; &gt; Am 07.12.2015 um 13:38 schrieb Jim Jagielski &lt;jim@jaguNET.com&=
gt;:<br>
&gt; &gt;<br>
&gt; &gt; Can you retry w DEBUG level, to see if=C2=A0 h2_response_trailers=
_filter()<br>
&gt; &gt; is the issue?<br>
&gt; &gt;<br>
&gt; &gt;&gt; On Dec 6, 2015, at 6:33 AM, Jan Ehrhardt &lt;<a href=3D"mailt=
o:phpdev@ehrhardt.nl">phpdev@ehrhardt.nl</a>&gt; wrote:<br>
&gt; &gt;&gt;<br>
&gt; &gt;&gt; Stefan Eissing in gmane.comp.apache.devel (Sun, 6 Dec 2015 09=
:26:56 +0100):<br>
&gt; &gt;&gt;&gt; Jan, thanks for tracking this down to the duplicate heade=
rs. I will look into it.<br>
&gt; &gt;&gt;&gt;<br>
&gt; &gt;&gt;&gt; Just to be sure I got everything right: you tested agains=
t the mod_h2 github versions?<br>
&gt; &gt;&gt;<br>
&gt; &gt;&gt; I used the sources from the ASF repos. This one worked OK:<br=
>
&gt; &gt;&gt;<br>
&gt; &gt;&gt; svn co -r 1715371 <a href=3D"http://svn.apache.org/repos/asf/=
httpd/httpd/branches/2.4.x/modules/http2" rel=3D"noreferrer" target=3D"_bla=
nk">http://svn.apache.org/repos/asf/httpd/httpd/branches/2.4.x/modules/http=
2</a><br>
&gt; &gt;&gt;<br>
&gt; &gt;&gt; But this one had the duplicate tokens:<br>
&gt; &gt;&gt;<br>
&gt; &gt;&gt; svn co -r 1716210 <a href=3D"http://svn.apache.org/repos/asf/=
httpd/httpd/branches/2.4.x/modules/http2" rel=3D"noreferrer" target=3D"_bla=
nk">http://svn.apache.org/repos/asf/httpd/httpd/branches/2.4.x/modules/http=
2</a><br>
&gt; &gt;&gt; --<br>
&gt; &gt;&gt; Jan<br>
&gt; &gt;&gt;<br>
&gt; &gt;<br>
&gt;<br>
&gt;<br>
<br>
</div></div></blockquote></div><br></div>

--001a1140ccc03074530526514b58--

From dev-return-84904-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Mon Dec  7 16:44:01 2015
Return-Path: <dev-return-84904-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 54023180ED
	for <apmail-httpd-dev-archive@www.apache.org>; Mon,  7 Dec 2015 16:44:01 +0000 (UTC)
Received: (qmail 76250 invoked by uid 500); 7 Dec 2015 16:43:51 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 76180 invoked by uid 500); 7 Dec 2015 16:43:51 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 76153 invoked by uid 99); 7 Dec 2015 16:43:51 -0000
Received: from Unknown (HELO spamd4-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 07 Dec 2015 16:43:51 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd4-us-west.apache.org (ASF Mail Server at spamd4-us-west.apache.org) with ESMTP id E781CC0FFE
	for <dev@httpd.apache.org>; Mon,  7 Dec 2015 16:43:50 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd4-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 2.999
X-Spam-Level: **
X-Spam-Status: No, score=2.999 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, HTML_MESSAGE=3,
	RCVD_IN_MSPIKE_H2=-0.001, SPF_PASS=-0.001, URIBL_BLOCKED=0.001]
	autolearn=disabled
Authentication-Results: spamd4-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=rowe-clan-net.20150623.gappssmtp.com
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd4-us-west.apache.org [10.40.0.11]) (amavisd-new, port 10024)
	with ESMTP id V_FcRZwGI81y for <dev@httpd.apache.org>;
	Mon,  7 Dec 2015 16:43:39 +0000 (UTC)
Received: from mail-ig0-f171.google.com (mail-ig0-f171.google.com [209.85.213.171])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id 18B0824C66
	for <dev@httpd.apache.org>; Mon,  7 Dec 2015 16:43:38 +0000 (UTC)
Received: by igcph11 with SMTP id ph11so77533323igc.1
        for <dev@httpd.apache.org>; Mon, 07 Dec 2015 08:38:36 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=rowe-clan-net.20150623.gappssmtp.com; s=20150623;
        h=mime-version:date:message-id:subject:from:to:content-type;
        bh=NnXxbHgnjWINWXQT9e8NiXEVmSwYS0oJ+bAVB1UMXsI=;
        b=F78LdIVskGmLF1IMD76NtE/xiz4d7CzzRJ8PJlaMCZJHtu8Ets1ZEHUIcyhRXna01H
         cFFIjFY4UCo76MdEI0j8Z4WwIYjNTcTrnU4XqSyzcTPvlnXG7uebWLqyxkm7I2pPplok
         U8rWecjKlLOfMgqrEnYlRGBE/brHePPypHFa1afbtoE9aRP86lZQ6Np1FA040wTupjMu
         G8kEN4G9k+W84txE9vMi9058K/cbTA7S3TPjS4/l9111PsfxosVUELAex7EALxk5iVMe
         Decc48vBvAnIpe5wDXnvhJNFlJ9ohb1sM9JbqoV/0k/tK5qtftCBwfT99cKSlHoa+DwL
         ZCyw==
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=1e100.net; s=20130820;
        h=x-gm-message-state:mime-version:date:message-id:subject:from:to
         :content-type;
        bh=NnXxbHgnjWINWXQT9e8NiXEVmSwYS0oJ+bAVB1UMXsI=;
        b=VDAPp1zGY9JmizP7S04Fo91b+78ATNKTsfrXq97pfBAn71oWoMYRmiaZd2jCkIj/8h
         fij38AflcH4EM/22TUJUUGiSZhFEU76oVlHVergLMT7tj5NXUW5kCN7c1iFyMJeYFgEa
         t7RKB2474y5ydp/ewepP31a3ZFlrmRv9c+bMUj2WgDjWWnH+5n8v56xEBj0ETXQovOct
         Ig738gl3jEHyvZg+Rv3UtfqF2IZhBfB71adOhoX8TvIh0/wcEFFHeZMprv32a7uS/JPH
         MEX4Lo/1ZLqY9JPEd2IVAt6DFQGdRZCU7xLL4VrCan1sHvOF3woODkFmkI8iTDmwkkcX
         WxpQ==
X-Gm-Message-State: ALoCoQm7qqGK2IS4lKjyQA1mnLRW9irUCg1x7YMn24f1vhuDDJNXh49LJS7UhEwTr/mmysEXX+2z2PVXONKmbP3MunYc25bKgZUuGvT+OJaR4ZkddWJwmuY=
MIME-Version: 1.0
X-Received: by 10.50.157.34 with SMTP id wj2mr17984536igb.32.1449506315670;
 Mon, 07 Dec 2015 08:38:35 -0800 (PST)
Received: by 10.107.62.136 with HTTP; Mon, 7 Dec 2015 08:38:35 -0800 (PST)
Date: Mon, 7 Dec 2015 10:38:35 -0600
Message-ID: <CACsi250=dbRQKnsbE8JSdAZRm5x99gE0sgX3iQ-PHAx77euD1A@mail.gmail.com>
Subject: Re: 2.4 pause - mod_http2 patchset Upgrade h2c vs mod_ssl Upgrade tls
From: William A Rowe Jr <wrowe@rowe-clan.net>
To: httpd <dev@httpd.apache.org>
Content-Type: multipart/mixed; boundary=001a1136b6200bd6f40526517d93

--001a1136b6200bd6f40526517d93
Content-Type: multipart/alternative; boundary=001a1136b6200bd6ef0526517d91

--001a1136b6200bd6ef0526517d91
Content-Type: text/plain; charset=UTF-8

Hi folks, sorry for the late interruption after we have already shipped
2.4.16, but there seems to be an issue that merits revisiting before the
2.4.16 API schema is widely adopted.

We seem to have misplaced the upgrade handler in the wrong hook.  This is
easily shown by the fact that we had two different upgrade paths between
mod_ssl TLS upgrade, and h2c upgrade paths, and a crufty patch to solve the
OPTIONS * request exception which isn't an exception at all per RFC7230.

In mod_ssl connection upgrade we once emitted the TLS upgrade header in
fixups.  Fixups are bypassed by OPTIONS *.  My trunk patch moved this
mod_ssl TLS upgrade handling to post read req, leaving OPTIONS * with its
simple behavior.

In h2c this exists in an upgrade handler, and OPTIONS * was hacked to
invoke this function.  Problem, it is a transport (hop by hop) detail and
should not be presented in the request, but rather in the connection
hooks.  Moreover, none of the other *request* processing phases appear
valid prior to conducting the h2c upgrade, and some appear that they can be
harmful to the admin attempting to configure Protocol h2c.

The relevant specs are clear, it is a hop-by-hop connection transport offer
carried over the request headers.  It is not generally subject to auth
processing, certainly not resource processing.  The underlying request must
still be satisfied.  The current Protocols logic doesn't appear to do this
because it was based off of tangential specs such as h2c that don't
override 2616bis.  If we consider that a "method" has a "handler", and
transfer "headers" are "filtered" it becomes more obvious.  This is not the
UPGRADE method.

https://tools.ietf.org/html/rfc7230#section-6.7 makes things more
interesting, it calls out that 101-continue and the request body read
precedes the 101-switching protocols.  Not sure who decided that would be a
good idea, sigh... but mod_ssl TLS upgrade has these reversed for several
good reasons including the intent to encrypt the request body if present
and simple economics of processing.

I think that handling upgrade advertisement and alerting must be in post
read req, bypassing all request hooks until the 101-continue is presented,
any small request body read and set aside for the http input brigade, and
101-switching protocols is presented.  This allows the request to still be
processed for tls-style upgrades, or discarded for relevant protocols.

The beginning of a patch is attached, I note that the ap_switch_protocol
return value was never properly interpreted and my patch doesn't begin to
catch all of the exceptional cases.  Because 101-switching protocols has
already been sent, if the call fails to perform an upgrade, it seems we
need to respond with a generic 400 switch failed unless the registered
protocol switch handler is going to ap_die with a different sort of
specific error (e.g. "A server MUST NOT switch protocols unless the
received message semantics can be honored by the new protocol; an OPTIONS
request can be honored by any protocol.")

Stefan and other protocol gurus, please have a look at the proposed patch,
thanks.

Bill

--001a1136b6200bd6ef0526517d91
Content-Type: text/html; charset=UTF-8
Content-Transfer-Encoding: quoted-printable

<div dir=3D"ltr"><p>Hi folks, sorry for the late interruption after we have=
 already shipped 2.4.16, but there seems to be an issue that merits revisit=
ing before the 2.4.16 API schema is widely adopted.</p><p dir=3D"ltr">We se=
em to have misplaced the upgrade handler in the wrong hook.=C2=A0 This is e=
asily shown by the fact that we had two different upgrade paths between mod=
_ssl TLS upgrade, and h2c upgrade paths, and a crufty patch to solve the OP=
TIONS * request exception which isn&#39;t an exception at all per RFC7230.<=
/p>
<p dir=3D"ltr">In mod_ssl connection upgrade we once emitted the TLS upgrad=
e header in fixups.=C2=A0 Fixups are bypassed by OPTIONS *.=C2=A0 My trunk =
patch moved this mod_ssl TLS upgrade handling to post read req, leaving OPT=
IONS * with its simple behavior.</p>
<p dir=3D"ltr">In h2c this exists in an upgrade handler, and OPTIONS * was =
hacked to invoke this function.=C2=A0 Problem, it is a transport (hop by ho=
p) detail and should not be presented in the request, but rather in the con=
nection hooks.=C2=A0 Moreover, none of the other *request* processing phase=
s appear valid prior to conducting the h2c upgrade, and some appear that th=
ey can be harmful to the admin attempting to configure Protocol h2c.</p>
<p dir=3D"ltr">The relevant specs are clear, it is a hop-by-hop connection =
transport offer carried over the request headers.=C2=A0 It is not generally=
 subject to auth processing, certainly not resource processing.=C2=A0 The u=
nderlying request must still be satisfied.=C2=A0 The current Protocols logi=
c doesn&#39;t appear to do this because it was based off of tangential spec=
s such as h2c that don&#39;t override 2616bis.=C2=A0 If we consider that a =
&quot;method&quot; has a &quot;handler&quot;, and transfer &quot;headers&qu=
ot; are &quot;filtered&quot; it becomes more obvious.=C2=A0 This is not the=
 UPGRADE method.</p>
<p dir=3D"ltr"><a href=3D"https://tools.ietf.org/html/rfc7230#section-6.7" =
target=3D"_blank" rel=3D"noreferrer">https://tools.ietf.org/html/rfc7230#se=
ction-6.7</a> makes things more interesting, it calls out that 101-continue=
 and the request body read precedes the 101-switching protocols.=C2=A0 Not =
sure who decided that would be a good idea, sigh... but mod_ssl TLS upgrade=
 has these reversed for several good reasons including the intent to encryp=
t the request body if present and simple economics of processing.</p>
<p dir=3D"ltr">I think that handling upgrade advertisement and alerting mus=
t be in post read req, bypassing all request hooks until the 101-continue i=
s presented, any small request body read and set aside for the http input b=
rigade, and 101-switching protocols is presented.=C2=A0 This allows the req=
uest to still be processed for tls-style upgrades, or discarded for relevan=
t protocols.</p><p>The beginning of a patch is attached, I note that the ap=
_switch_protocol return value was never properly interpreted and my patch d=
oesn&#39;t begin to catch all of the exceptional cases.=C2=A0 Because 101-s=
witching protocols has already been sent, if the call fails to perform an u=
pgrade, it seems we need to respond with a generic 400 switch failed unless=
 the registered protocol switch handler is going to ap_die with a different=
 sort of specific error (e.g. &quot;A server MUST NOT switch protocols unle=
ss the received message semantics can be honored by the new protocol; an OP=
TIONS request can be honored by any protocol.&quot;)</p><p>Stefan and other=
 protocol gurus, please have a look at the proposed patch, thanks.</p><p>Bi=
ll</p>
</div>

--001a1136b6200bd6ef0526517d91--
--001a1136b6200bd6f40526517d93
Content-Type: text/x-patch; charset=US-ASCII; name="relocate_upgrade.patch"
Content-Disposition: attachment; filename="relocate_upgrade.patch"
Content-Transfer-Encoding: base64
X-Attachment-Id: f_ihw6leiq0

SW5kZXg6IHNlcnZlci9jb3JlLmMKPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQotLS0gc2VydmVyL2NvcmUuYwkocmV2aXNp
b24gMTcxODQxOSkKKysrIHNlcnZlci9jb3JlLmMJKHdvcmtpbmcgY29weSkKQEAgLTUzNDYsNyAr
NTM0Niw3IEBACiAgICAgfQogfQogCi1zdGF0aWMgaW50IGNvcmVfdXBncmFkZV9oYW5kbGVyKHJl
cXVlc3RfcmVjICpyKQorc3RhdGljIGludCBjb3JlX3VwZ3JhZGVfcmVxdWVzdChyZXF1ZXN0X3Jl
YyAqcikKIHsKICAgICBjb25uX3JlYyAqYyA9IHItPmNvbm5lY3Rpb247CiAgICAgY29uc3QgY2hh
ciAqdXBncmFkZTsKQEAgLTUzNzQsOCArNTM3NCwxNSBAQAogICAgICAgICAgICAgaWYgKG9mZmVy
cyAmJiBvZmZlcnMtPm5lbHRzID4gMCkgewogICAgICAgICAgICAgICAgIGNvbnN0IGNoYXIgKnBy
b3RvY29sID0gYXBfc2VsZWN0X3Byb3RvY29sKGMsIHIsIE5VTEwsIG9mZmVycyk7CiAgICAgICAg
ICAgICAgICAgaWYgKHByb3RvY29sICYmIHN0cmNtcChwcm90b2NvbCwgYXBfZ2V0X3Byb3RvY29s
KGMpKSkgeworICAgICAgICAgICAgICAgICAgICBhcHJfc3RhdHVzX3QgcnY7CiAgICAgICAgICAg
ICAgICAgICAgIGFwX2xvZ19yZXJyb3IoQVBMT0dfTUFSSywgQVBMT0dfREVCVUcsIDAsIHIsIEFQ
TE9HTk8oMDI5MDkpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIlVwZ3JhZGUg
c2VsZWN0cyAnJXMnIiwgcHJvdG9jb2wpOworICAgICAgICAgICAgICAgICAgICAvKiBSRkM3MjMw
IDYuNzogU3R1cGlkIGNvbnN0cmFpbnQsIGRldGVjdCByZXF1ZXN0IGJvZHksCisgICAgICAgICAg
ICAgICAgICAgICAqIHNlbmQgMTAwLWNvbnRpbnVlLCByZWFkIGl0IGltbWVkaWF0ZWx5LCBhbmQg
c2V0IGl0IGFzaWRlCisgICAgICAgICAgICAgICAgICAgICAqIGZvciB0aGUgZmlsdGVycy9oYW5k
bGVyIHRvIHByb2Nlc3MgYWZ0ZXIgdXBncmFkZQorICAgICAgICAgICAgICAgICAgICAgKiBYWFg6
IFRPRE8KKyAgICAgICAgICAgICAgICAgICAgICovCisKICAgICAgICAgICAgICAgICAgICAgLyog
TGV0IHRoZSBjbGllbnQga25vdyB3aGF0IHdlIGFyZSB1cGdyYWRpbmcgdG8uICovCiAgICAgICAg
ICAgICAgICAgICAgIGFwcl90YWJsZV9jbGVhcihyLT5oZWFkZXJzX291dCk7CiAgICAgICAgICAg
ICAgICAgICAgIGFwcl90YWJsZV9zZXRuKHItPmhlYWRlcnNfb3V0LCAiVXBncmFkZSIsIHByb3Rv
Y29sKTsKQEAgLTUzODUsMTEgKzUzOTIsMTMgQEAKICAgICAgICAgICAgICAgICAgICAgci0+c3Rh
dHVzX2xpbmUgPSBhcF9nZXRfc3RhdHVzX2xpbmUoci0+c3RhdHVzKTsKICAgICAgICAgICAgICAg
ICAgICAgYXBfc2VuZF9pbnRlcmltX3Jlc3BvbnNlKHIsIDEpOwogCi0gICAgICAgICAgICAgICAg
ICAgIGFwX3N3aXRjaF9wcm90b2NvbChjLCByLCByLT5zZXJ2ZXIsIHByb3RvY29sKTsKLQotICAg
ICAgICAgICAgICAgICAgICAvKiBtYWtlIHN1cmUgaHR0cGQgY2xvc2VzIHRoZSBjb25uZWN0aW9u
IGFmdGVyIHRoaXMgKi8KLSAgICAgICAgICAgICAgICAgICAgYy0+a2VlcGFsaXZlID0gQVBfQ09O
Tl9DTE9TRTsKLSAgICAgICAgICAgICAgICAgICAgcmV0dXJuIERPTkU7CisgICAgICAgICAgICAg
ICAgICAgIHJ2ID0gYXBfc3dpdGNoX3Byb3RvY29sKGMsIHIsIHItPnNlcnZlciwgcHJvdG9jb2wp
OworICAgICAgICAgICAgICAgICAgICBpZiAocnYgPT0gQVBSX0VPRikKKyAgICAgICAgICAgICAg
ICAgICAgeworICAgICAgICAgICAgICAgICAgICAgICAgLyogbWFrZSBzdXJlIGh0dHBkIGNsb3Nl
cyB0aGUgY29ubmVjdGlvbiBhZnRlciB0aGlzICovCisgICAgICAgICAgICAgICAgICAgICAgICBj
LT5rZWVwYWxpdmUgPSBBUF9DT05OX0NMT1NFOworICAgICAgICAgICAgICAgICAgICAgICAgcmV0
dXJuIERPTkU7CisgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICB9CiAgICAg
ICAgICAgICB9CiAgICAgICAgIH0KQEAgLTU0MDcsMTYgKzU0MTYsNyBAQAogICAgICAgICAgICAg
YXByX3RhYmxlX3NldG4oci0+aGVhZGVyc19vdXQsICJDb25uZWN0aW9uIiwgIlVwZ3JhZGUiKTsK
ICAgICAgICAgfQogICAgIH0KLSAgICAKLSAgICByZXR1cm4gREVDTElORUQ7Ci19CiAKLXN0YXRp
YyBpbnQgY29yZV91cGdyYWRlX3N0b3JhZ2UocmVxdWVzdF9yZWMgKnIpCi17Ci0gICAgaWYgKChy
LT5tZXRob2RfbnVtYmVyID09IE1fT1BUSU9OUykgJiYgci0+dXJpICYmIChyLT51cmlbMF0gPT0g
JyonKSAmJgotICAgICAgICAoci0+dXJpWzFdID09ICdcMCcpKSB7Ci0gICAgICAgIHJldHVybiBj
b3JlX3VwZ3JhZGVfaGFuZGxlcihyKTsKLSAgICB9CiAgICAgcmV0dXJuIERFQ0xJTkVEOwogfQog
CkBAIC01NDQyLDEyICs1NDQyLDExIEBACiAgICAgYXBfaG9va19jaGVja19jb25maWcoY29yZV9j
aGVja19jb25maWcsTlVMTCxOVUxMLEFQUl9IT09LX0ZJUlNUKTsKICAgICBhcF9ob29rX3Rlc3Rf
Y29uZmlnKGNvcmVfZHVtcF9jb25maWcsTlVMTCxOVUxMLEFQUl9IT09LX0ZJUlNUKTsKICAgICBh
cF9ob29rX3RyYW5zbGF0ZV9uYW1lKGFwX2NvcmVfdHJhbnNsYXRlLE5VTEwsTlVMTCxBUFJfSE9P
S19SRUFMTFlfTEFTVCk7Ci0gICAgYXBfaG9va19tYXBfdG9fc3RvcmFnZShjb3JlX3VwZ3JhZGVf
c3RvcmFnZSxOVUxMLE5VTEwsQVBSX0hPT0tfUkVBTExZX0ZJUlNUKTsKICAgICBhcF9ob29rX21h
cF90b19zdG9yYWdlKGNvcmVfbWFwX3RvX3N0b3JhZ2UsTlVMTCxOVUxMLEFQUl9IT09LX1JFQUxM
WV9MQVNUKTsKICAgICBhcF9ob29rX29wZW5fbG9ncyhhcF9vcGVuX2xvZ3MsTlVMTCxOVUxMLEFQ
Ul9IT09LX1JFQUxMWV9GSVJTVCk7CiAgICAgYXBfaG9va19jaGlsZF9pbml0KGNvcmVfY2hpbGRf
aW5pdCxOVUxMLE5VTEwsQVBSX0hPT0tfUkVBTExZX0ZJUlNUKTsKICAgICBhcF9ob29rX2NoaWxk
X2luaXQoYXBfbG9nc19jaGlsZF9pbml0LE5VTEwsTlVMTCxBUFJfSE9PS19NSURETEUpOwotICAg
IGFwX2hvb2tfaGFuZGxlcihjb3JlX3VwZ3JhZGVfaGFuZGxlcixOVUxMLE5VTEwsQVBSX0hPT0tf
UkVBTExZX0ZJUlNUKTsKKyAgICBhcF9ob29rX3Bvc3RfcmVhZF9yZXF1ZXN0KGNvcmVfdXBncmFk
ZV9yZXF1ZXN0LE5VTEwsTlVMTCxBUFJfSE9PS19MQVNUKTsKICAgICBhcF9ob29rX2hhbmRsZXIo
ZGVmYXVsdF9oYW5kbGVyLE5VTEwsTlVMTCxBUFJfSE9PS19SRUFMTFlfTEFTVCk7CiAgICAgLyog
RklYTUU6IEkgc3VzcGVjdCB3ZSBjYW4gZWxpbWluYXRlIHRoZSBuZWVkIGZvciB0aGVzZSBkb19u
b3RoaW5ncyAtIEJlbiAqLwogICAgIGFwX2hvb2tfdHlwZV9jaGVja2VyKGRvX25vdGhpbmcsTlVM
TCxOVUxMLEFQUl9IT09LX1JFQUxMWV9MQVNUKTsK
--001a1136b6200bd6f40526517d93--

From dev-return-84905-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Mon Dec  7 18:07:23 2015
Return-Path: <dev-return-84905-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 3A493186D5
	for <apmail-httpd-dev-archive@www.apache.org>; Mon,  7 Dec 2015 18:07:23 +0000 (UTC)
Received: (qmail 42044 invoked by uid 500); 7 Dec 2015 18:07:17 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 41977 invoked by uid 500); 7 Dec 2015 18:07:17 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 41967 invoked by uid 99); 7 Dec 2015 18:07:17 -0000
Received: from Unknown (HELO spamd4-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 07 Dec 2015 18:07:17 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd4-us-west.apache.org (ASF Mail Server at spamd4-us-west.apache.org) with ESMTP id 4CEC8C1335
	for <dev@httpd.apache.org>; Mon,  7 Dec 2015 18:07:17 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd4-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 2.999
X-Spam-Level: **
X-Spam-Status: No, score=2.999 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, HTML_MESSAGE=3,
	RCVD_IN_MSPIKE_H2=-0.001, SPF_PASS=-0.001, URIBL_BLOCKED=0.001]
	autolearn=disabled
Authentication-Results: spamd4-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=rowe-clan-net.20150623.gappssmtp.com
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd4-us-west.apache.org [10.40.0.11]) (amavisd-new, port 10024)
	with ESMTP id OhOPeVzvROKi for <dev@httpd.apache.org>;
	Mon,  7 Dec 2015 18:07:07 +0000 (UTC)
Received: from mail-ig0-f172.google.com (mail-ig0-f172.google.com [209.85.213.172])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id 8E6E1428DC
	for <dev@httpd.apache.org>; Mon,  7 Dec 2015 18:07:07 +0000 (UTC)
Received: by igbxm8 with SMTP id xm8so88565871igb.1
        for <dev@httpd.apache.org>; Mon, 07 Dec 2015 10:02:01 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=rowe-clan-net.20150623.gappssmtp.com; s=20150623;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        bh=+cHjuYdW6QERpR8i1L/ec267nWYE9/M6WKud1aDjRNY=;
        b=MPZgbnhYUS4j6gybFvDOn+qglsJEXIIaDHTlyGr35tSfJB26KJwnyRVj1RjbQ6jn31
         A4JGVmAQhsrP2qiM9XDuHsN/bCaftTecM3ofSK0P30y5v8YcCfdbVFjg1E2cLevTt+Sg
         PqypuzPNJ2O21cecQhd7d8OSWJMRNB3mW6RghJMgqJwf07rcEq2w/Q/YkIwaIKRjJPfO
         uKPmv9M2E5mjdXjZDk1nEPBRqL824yrG0RNa3AwWSFBk7Nff5q5eShEJ8ySbraC+4qe6
         sOT7tP/QFT3VwYMeMZhZ6wVjF38LaTnj8aKmyg/hrO+p6MEJ9aYzudQqEiIhOfs4FMjz
         lW1g==
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=1e100.net; s=20130820;
        h=x-gm-message-state:mime-version:in-reply-to:references:date
         :message-id:subject:from:to:content-type;
        bh=+cHjuYdW6QERpR8i1L/ec267nWYE9/M6WKud1aDjRNY=;
        b=E1bg7MQyLObofaFwitSs7mVBvJey/OkkkH60OFkO0bZg5mIAq8w84WHAF/YbPoHhjc
         /lnC1xb4tjkX/3uskrsnjhUvlweoc2lk87VXDBxqhN8e1NX5aT9sCbv3KG9pvn6FJ5Wl
         V0uwBOTYS+De8/eHUTKpPy8aM12ev9TyxCm9A2fmZoY53zySjL8WWRQH/eGWFhP9+IeR
         eM19MGTKJHTDyYNTH79BGQD8PxKwJOp1RnHJnb9Kj0A0rXSO5QUN6gsSGZFZmp7qYvBq
         j7n78Lh3BZFJCQYvn/UZeszUrpRM0QKt8FxwdR/RzzoVb8n9s18OiKwK4wQV3d1W8cH3
         bY0Q==
X-Gm-Message-State: ALoCoQmnnDwhtOcpsRX961q6sVvsbFfh6wL6QKiuaJSNfGSyGyroqxVsawWTuynY1y4v6ehWw83n
MIME-Version: 1.0
X-Received: by 10.50.20.163 with SMTP id o3mr18381122ige.35.1449511321400;
 Mon, 07 Dec 2015 10:02:01 -0800 (PST)
Received: by 10.107.62.136 with HTTP; Mon, 7 Dec 2015 10:02:01 -0800 (PST)
In-Reply-To: <CACsi250=dbRQKnsbE8JSdAZRm5x99gE0sgX3iQ-PHAx77euD1A@mail.gmail.com>
References: <CACsi250=dbRQKnsbE8JSdAZRm5x99gE0sgX3iQ-PHAx77euD1A@mail.gmail.com>
Date: Mon, 7 Dec 2015 12:02:01 -0600
Message-ID: <CACsi2534prBtp7ENNNiEDevA3Z7u9uW2uuYMOa8-OoOsPSHNGQ@mail.gmail.com>
Subject: Re: 2.4 pause - mod_http2 patchset Upgrade h2c vs mod_ssl Upgrade tls
From: William A Rowe Jr <wrowe@rowe-clan.net>
To: httpd <dev@httpd.apache.org>
Content-Type: multipart/alternative; boundary=047d7bd75dec6911e9052652a7d9

--047d7bd75dec6911e9052652a7d9
Content-Type: text/plain; charset=UTF-8

Here's my thoughts to address this rather quickly for 2.4.18 to keep
ourselves on track; simply move the core protocol handling phase and
ap_switch_protocol action into the appropriate request processing phase,
address the fail-cases of the ap_switch_protocol exceptions that have
been overlooked so that users can start leveraging the API, and just fix
the mod_ssl OPTIONS * advertisement as presented on trunk (I am
updating STATUS in a moment for that patch).

The actual fix to incorporate mod_ssl TLS upgrade to work within the
Protocol API can wait, so we don't further disrupt the overdue fixes
for the mod_http2 feature for our users.  Although I would -like- them
to coexist nicely, I don't believe that must happen until 2.4.19.  If the
SSLOptions optional works within one vhost, and Protocol h2c works
on another vhost, I think we are in good shape for the experimental
new feature release.

WDTY?


On Mon, Dec 7, 2015 at 10:38 AM, William A Rowe Jr <wrowe@rowe-clan.net>
wrote:

> Hi folks, sorry for the late interruption after we have already shipped
> 2.4.16, but there seems to be an issue that merits revisiting before the
> 2.4.16 API schema is widely adopted.
>
> We seem to have misplaced the upgrade handler in the wrong hook.  This is
> easily shown by the fact that we had two different upgrade paths between
> mod_ssl TLS upgrade, and h2c upgrade paths, and a crufty patch to solve the
> OPTIONS * request exception which isn't an exception at all per RFC7230.
>
> In mod_ssl connection upgrade we once emitted the TLS upgrade header in
> fixups.  Fixups are bypassed by OPTIONS *.  My trunk patch moved this
> mod_ssl TLS upgrade handling to post read req, leaving OPTIONS * with its
> simple behavior.
>
> In h2c this exists in an upgrade handler, and OPTIONS * was hacked to
> invoke this function.  Problem, it is a transport (hop by hop) detail and
> should not be presented in the request, but rather in the connection
> hooks.  Moreover, none of the other *request* processing phases appear
> valid prior to conducting the h2c upgrade, and some appear that they can be
> harmful to the admin attempting to configure Protocol h2c.
>
> The relevant specs are clear, it is a hop-by-hop connection transport
> offer carried over the request headers.  It is not generally subject to
> auth processing, certainly not resource processing.  The underlying request
> must still be satisfied.  The current Protocols logic doesn't appear to do
> this because it was based off of tangential specs such as h2c that don't
> override 2616bis.  If we consider that a "method" has a "handler", and
> transfer "headers" are "filtered" it becomes more obvious.  This is not the
> UPGRADE method.
>
> https://tools.ietf.org/html/rfc7230#section-6.7 makes things more
> interesting, it calls out that 101-continue and the request body read
> precedes the 101-switching protocols.  Not sure who decided that would be a
> good idea, sigh... but mod_ssl TLS upgrade has these reversed for several
> good reasons including the intent to encrypt the request body if present
> and simple economics of processing.
>
> I think that handling upgrade advertisement and alerting must be in post
> read req, bypassing all request hooks until the 101-continue is presented,
> any small request body read and set aside for the http input brigade, and
> 101-switching protocols is presented.  This allows the request to still be
> processed for tls-style upgrades, or discarded for relevant protocols.
>
> The beginning of a patch is attached, I note that the ap_switch_protocol
> return value was never properly interpreted and my patch doesn't begin to
> catch all of the exceptional cases.  Because 101-switching protocols has
> already been sent, if the call fails to perform an upgrade, it seems we
> need to respond with a generic 400 switch failed unless the registered
> protocol switch handler is going to ap_die with a different sort of
> specific error (e.g. "A server MUST NOT switch protocols unless the
> received message semantics can be honored by the new protocol; an OPTIONS
> request can be honored by any protocol.")
>
> Stefan and other protocol gurus, please have a look at the proposed patch,
> thanks.
>
> Bill
>

--047d7bd75dec6911e9052652a7d9
Content-Type: text/html; charset=UTF-8
Content-Transfer-Encoding: quoted-printable

<div dir=3D"ltr">Here&#39;s my thoughts to address this rather quickly for =
2.4.18 to keep<div>ourselves on track; simply move the core protocol handli=
ng phase and=C2=A0</div><div>ap_switch_protocol action into the appropriate=
 request processing phase,=C2=A0<div><div>address the fail-cases of the ap_=
switch_protocol exceptions that have=C2=A0</div><div>been overlooked so tha=
t users can start leveraging the API, and just fix</div><div>the mod_ssl OP=
TIONS * advertisement as presented on trunk (I am</div><div>updating STATUS=
 in a moment for that patch).</div><div><br></div><div>The actual fix to in=
corporate mod_ssl TLS upgrade to work within the</div><div>Protocol API can=
 wait, so we don&#39;t further disrupt the overdue fixes</div><div>for the =
mod_http2 feature for our users.=C2=A0 Although I would -like- them=C2=A0</=
div><div>to coexist nicely, I don&#39;t believe that must happen until 2.4.=
19.=C2=A0 If the</div><div>SSLOptions optional works within one vhost, and =
Protocol h2c works</div><div>on another vhost, I think we are in good shape=
 for the experimental</div><div>new feature release.</div><div><br></div><d=
iv>WDTY?</div><div><br></div></div></div></div><div class=3D"gmail_extra"><=
br><div class=3D"gmail_quote">On Mon, Dec 7, 2015 at 10:38 AM, William A Ro=
we Jr <span dir=3D"ltr">&lt;<a href=3D"mailto:wrowe@rowe-clan.net" target=
=3D"_blank">wrowe@rowe-clan.net</a>&gt;</span> wrote:<br><blockquote class=
=3D"gmail_quote" style=3D"margin:0 0 0 .8ex;border-left:1px #ccc solid;padd=
ing-left:1ex"><div dir=3D"ltr"><p>Hi folks, sorry for the late interruption=
 after we have already shipped 2.4.16, but there seems to be an issue that =
merits revisiting before the 2.4.16 API schema is widely adopted.</p><p dir=
=3D"ltr">We seem to have misplaced the upgrade handler in the wrong hook.=
=C2=A0 This is easily shown by the fact that we had two different upgrade p=
aths between mod_ssl TLS upgrade, and h2c upgrade paths, and a crufty patch=
 to solve the OPTIONS * request exception which isn&#39;t an exception at a=
ll per RFC7230.</p>
<p dir=3D"ltr">In mod_ssl connection upgrade we once emitted the TLS upgrad=
e header in fixups.=C2=A0 Fixups are bypassed by OPTIONS *.=C2=A0 My trunk =
patch moved this mod_ssl TLS upgrade handling to post read req, leaving OPT=
IONS * with its simple behavior.</p>
<p dir=3D"ltr">In h2c this exists in an upgrade handler, and OPTIONS * was =
hacked to invoke this function.=C2=A0 Problem, it is a transport (hop by ho=
p) detail and should not be presented in the request, but rather in the con=
nection hooks.=C2=A0 Moreover, none of the other *request* processing phase=
s appear valid prior to conducting the h2c upgrade, and some appear that th=
ey can be harmful to the admin attempting to configure Protocol h2c.</p>
<p dir=3D"ltr">The relevant specs are clear, it is a hop-by-hop connection =
transport offer carried over the request headers.=C2=A0 It is not generally=
 subject to auth processing, certainly not resource processing.=C2=A0 The u=
nderlying request must still be satisfied.=C2=A0 The current Protocols logi=
c doesn&#39;t appear to do this because it was based off of tangential spec=
s such as h2c that don&#39;t override 2616bis.=C2=A0 If we consider that a =
&quot;method&quot; has a &quot;handler&quot;, and transfer &quot;headers&qu=
ot; are &quot;filtered&quot; it becomes more obvious.=C2=A0 This is not the=
 UPGRADE method.</p>
<p dir=3D"ltr"><a href=3D"https://tools.ietf.org/html/rfc7230#section-6.7" =
rel=3D"noreferrer" target=3D"_blank">https://tools.ietf.org/html/rfc7230#se=
ction-6.7</a> makes things more interesting, it calls out that 101-continue=
 and the request body read precedes the 101-switching protocols.=C2=A0 Not =
sure who decided that would be a good idea, sigh... but mod_ssl TLS upgrade=
 has these reversed for several good reasons including the intent to encryp=
t the request body if present and simple economics of processing.</p>
<p dir=3D"ltr">I think that handling upgrade advertisement and alerting mus=
t be in post read req, bypassing all request hooks until the 101-continue i=
s presented, any small request body read and set aside for the http input b=
rigade, and 101-switching protocols is presented.=C2=A0 This allows the req=
uest to still be processed for tls-style upgrades, or discarded for relevan=
t protocols.</p><p>The beginning of a patch is attached, I note that the ap=
_switch_protocol return value was never properly interpreted and my patch d=
oesn&#39;t begin to catch all of the exceptional cases.=C2=A0 Because 101-s=
witching protocols has already been sent, if the call fails to perform an u=
pgrade, it seems we need to respond with a generic 400 switch failed unless=
 the registered protocol switch handler is going to ap_die with a different=
 sort of specific error (e.g. &quot;A server MUST NOT switch protocols unle=
ss the received message semantics can be honored by the new protocol; an OP=
TIONS request can be honored by any protocol.&quot;)</p><p>Stefan and other=
 protocol gurus, please have a look at the proposed patch, thanks.</p><p>Bi=
ll</p>
</div>
</blockquote></div><br></div>

--047d7bd75dec6911e9052652a7d9--

From dev-return-84906-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Mon Dec  7 18:51:03 2015
Return-Path: <dev-return-84906-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 0E17C18A0D
	for <apmail-httpd-dev-archive@www.apache.org>; Mon,  7 Dec 2015 18:51:03 +0000 (UTC)
Received: (qmail 31266 invoked by uid 500); 7 Dec 2015 18:50:45 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 31190 invoked by uid 500); 7 Dec 2015 18:50:45 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 31177 invoked by uid 99); 7 Dec 2015 18:50:45 -0000
Received: from Unknown (HELO spamd2-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 07 Dec 2015 18:50:44 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd2-us-west.apache.org (ASF Mail Server at spamd2-us-west.apache.org) with ESMTP id 82C841A0B5C
	for <dev@httpd.apache.org>; Mon,  7 Dec 2015 18:50:44 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd2-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 4
X-Spam-Level: ****
X-Spam-Status: No, score=4 tagged_above=-999 required=6.31
	tests=[HTML_MESSAGE=3, KAM_LAZY_DOMAIN_SECURITY=1] autolearn=disabled
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd2-us-west.apache.org [10.40.0.9]) (amavisd-new, port 10024)
	with ESMTP id HxmYU0TCiRQm for <dev@httpd.apache.org>;
	Mon,  7 Dec 2015 18:50:29 +0000 (UTC)
Received: from mail1.bemta5.messagelabs.com (mail1.bemta5.messagelabs.com [195.245.231.151])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id D5CC142B4B
	for <dev@httpd.apache.org>; Mon,  7 Dec 2015 18:50:28 +0000 (UTC)
Received: from [85.158.139.163] by server-15.bemta-5.messagelabs.com id 99/4C-16870-EE4D5665; Mon, 07 Dec 2015 18:50:22 +0000
X-Env-Sender: ruediger.pluem@vodafone.com
X-Msg-Ref: server-6.tower-188.messagelabs.com!1449514221!5018680!1
X-Originating-IP: [195.232.244.133]
X-StarScan-Received:
X-StarScan-Version: 7.35; banners=-,-,-
X-VirusChecked: Checked
Received: (qmail 14087 invoked from network); 7 Dec 2015 18:50:21 -0000
Received: from mailout01.vodafone.com (HELO mailout01.vodafone.com) (195.232.244.133)
  by server-6.tower-188.messagelabs.com with DHE-RSA-AES256-SHA encrypted SMTP; 7 Dec 2015 18:50:21 -0000
Received: from mailint04.vodafone.com (mailint04.vodafone.com [195.232.244.201])
	by mailout01.vodafone.com (Postfix) with ESMTP id 3pDtxT11nCz1yBq
	for <dev@httpd.apache.org>; Mon,  7 Dec 2015 19:50:21 +0100 (CET)
Received: from mailint04.vodafone.com (localhost [127.0.0.1])
	by mailint04.vodafone.com (Postfix) with ESMTP id 3pDtxT03ZRzfZZR
	for <dev@httpd.apache.org>; Mon,  7 Dec 2015 19:50:21 +0100 (CET)
Received: from VOEXC01W.internal.vodafone.com (voexc01w.dc-ratingen.de [145.230.101.21])
	(using TLSv1 with cipher AES128-SHA (128/128 bits))
	(No client certificate requested)
	by mailint04.vodafone.com (Postfix) with ESMTPS id 3pDtxS6p2pzfZY8
	for <dev@httpd.apache.org>; Mon,  7 Dec 2015 19:50:20 +0100 (CET)
Received: from VOEXC14W.internal.vodafone.com (145.230.101.16) by
 VOEXC01W.internal.vodafone.com (145.230.101.21) with Microsoft SMTP Server
 (TLS) id 14.3.224.2; Mon, 7 Dec 2015 19:50:20 +0100
Received: from VOEXM10W.internal.vodafone.com ([169.254.2.138]) by
 voexc14w.internal.vodafone.com ([145.230.101.16]) with mapi id
 14.03.0224.002; Mon, 7 Dec 2015 19:50:19 +0100
From: =?utf-8?B?UGzDvG0sIFLDvGRpZ2VyLCBWb2RhZm9uZSBHcm91cA==?=
	<ruediger.pluem@vodafone.com>
To: "dev@httpd.apache.org" <dev@httpd.apache.org>
Subject: AW: 2.4 pause - mod_http2 patchset Upgrade h2c vs mod_ssl Upgrade
 tls
Thread-Topic: 2.4 pause - mod_http2 patchset Upgrade h2c vs mod_ssl Upgrade
 tls
Thread-Index: AQHRMQ522v829LtnSE6xmFYk2tJdmp6/3VKQ
Date: Mon, 7 Dec 2015 18:50:19 +0000
Message-ID: <AB1691BE05AE7F4992697F2A0835627AC63BAB94@VOEXM10W.internal.vodafone.com>
References: <CACsi250=dbRQKnsbE8JSdAZRm5x99gE0sgX3iQ-PHAx77euD1A@mail.gmail.com>
In-Reply-To: <CACsi250=dbRQKnsbE8JSdAZRm5x99gE0sgX3iQ-PHAx77euD1A@mail.gmail.com>
Accept-Language: en-US
Content-Language: de-DE
X-MS-Has-Attach:
X-MS-TNEF-Correlator:
Content-Type: multipart/alternative;
	boundary="_000_AB1691BE05AE7F4992697F2A0835627AC63BAB94VOEXM10Winterna_"
MIME-Version: 1.0

--_000_AB1691BE05AE7F4992697F2A0835627AC63BAB94VOEXM10Winterna_
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64

DQoNClZvbjogV2lsbGlhbSBBIFJvd2UgSnIgW21haWx0bzp3cm93ZUByb3dlLWNsYW4ubmV0XQ0K
R2VzZW5kZXQ6IE1vbnRhZywgNy4gRGV6ZW1iZXIgMjAxNSAxNzozOQ0KQW46IGh0dHBkIDxkZXZA
aHR0cGQuYXBhY2hlLm9yZz4NCkJldHJlZmY6IFJlOiAyLjQgcGF1c2UgLSBtb2RfaHR0cDIgcGF0
Y2hzZXQgVXBncmFkZSBoMmMgdnMgbW9kX3NzbCBVcGdyYWRlIHRscw0KDQoNCmh0dHBzOi8vdG9v
bHMuaWV0Zi5vcmcvaHRtbC9yZmM3MjMwI3NlY3Rpb24tNi43IG1ha2VzIHRoaW5ncyBtb3JlIGlu
dGVyZXN0aW5nLCBpdCBjYWxscyBvdXQgdGhhdCAxMDEtY29udGludWUgYW5kIHRoZSByZXF1ZXN0
IGJvZHkgcmVhZCBwcmVjZWRlcyB0aGUgMTAxLXN3aXRjaGluZyBwcm90b2NvbHMuICBOb3Qgc3Vy
ZSB3aG8gZGVjaWRlZCB0aGF0IHdvdWxkIGJlIGEgZ29vZCBpZGVhLCBzaWdoLi4uIGJ1dCBtb2Rf
c3NsIFRMUyB1cGdyYWRlIGhhcyB0aGVzZSByZXZlcnNlZCBmb3Igc2V2ZXJhbCBnb29kIHJlYXNv
bnMgaW5jbHVkaW5nIHRoZSBpbnRlbnQgdG8gZW5jcnlwdCB0aGUgcmVxdWVzdCBib2R5IGlmIHBy
ZXNlbnQgYW5kIHNpbXBsZSBlY29ub21pY3Mgb2YgcHJvY2Vzc2luZy4NCg0KSSB0aGluayB0aGF0
IGhhbmRsaW5nIHVwZ3JhZGUgYWR2ZXJ0aXNlbWVudCBhbmQgYWxlcnRpbmcgbXVzdCBiZSBpbiBw
b3N0IHJlYWQgcmVxLCBieXBhc3NpbmcgYWxsIHJlcXVlc3QgaG9va3MgdW50aWwgdGhlIDEwMS1j
b250aW51ZSBpcyBwcmVzZW50ZWQsIGFueSBzbWFsbCByZXF1ZXN0IGJvZHkgcmVhZCBhbmQgc2V0
IGFzaWRlIGZvciB0aGUgaHR0cCBpbnB1dCBicmlnYWRlLCBhbmQgMTAxLXN3aXRjaGluZyBwcm90
b2NvbHMgaXMgcHJlc2VudGVkLiAgVGhpcyBhbGxvd3MgdGhlIHJlcXVlc3QgdG8gc3RpbGwgYmUg
cHJvY2Vzc2VkIGZvciB0bHMtc3R5bGUgdXBncmFkZXMsIG9yIGRpc2NhcmRlZCBmb3IgcmVsZXZh
bnQgcHJvdG9jb2xzLg0KDQpIb3cgZG8gd2UgaGFuZGxlIHRoaXMgdG9kYXkgaWYgdGhlIGNsaWVu
dCBqdXN0IHNlbmRzIGEgcmVxdWVzdCBib2R5IGFuZCBub3QgYW4gRXhwZWN0IGhlYWRlcj8gRG8g
d2Ugc2V0IGl0IGFscmVhZHkgYXNpZGUgYmVmb3JlIGFuc3dlcmluZyB3aXRoIGEgMTAxPw0KDQpS
ZWdhcmRzDQoNClLDvGRpZ2VyDQo=

--_000_AB1691BE05AE7F4992697F2A0835627AC63BAB94VOEXM10Winterna_
Content-Type: text/html; charset="utf-8"
Content-Transfer-Encoding: base64

PGh0bWwgeG1sbnM6dj0idXJuOnNjaGVtYXMtbWljcm9zb2Z0LWNvbTp2bWwiIHhtbG5zOm89InVy
bjpzY2hlbWFzLW1pY3Jvc29mdC1jb206b2ZmaWNlOm9mZmljZSIgeG1sbnM6dz0idXJuOnNjaGVt
YXMtbWljcm9zb2Z0LWNvbTpvZmZpY2U6d29yZCIgeG1sbnM6bT0iaHR0cDovL3NjaGVtYXMubWlj
cm9zb2Z0LmNvbS9vZmZpY2UvMjAwNC8xMi9vbW1sIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcv
VFIvUkVDLWh0bWw0MCI+DQo8aGVhZD4NCjxtZXRhIGh0dHAtZXF1aXY9IkNvbnRlbnQtVHlwZSIg
Y29udGVudD0idGV4dC9odG1sOyBjaGFyc2V0PXV0Zi04Ij4NCjxtZXRhIG5hbWU9IkdlbmVyYXRv
ciIgY29udGVudD0iTWljcm9zb2Z0IFdvcmQgMTUgKGZpbHRlcmVkIG1lZGl1bSkiPg0KPHN0eWxl
PjwhLS0NCi8qIEZvbnQgRGVmaW5pdGlvbnMgKi8NCkBmb250LWZhY2UNCgl7Zm9udC1mYW1pbHk6
IkNhbWJyaWEgTWF0aCI7DQoJcGFub3NlLTE6MiA0IDUgMyA1IDQgNiAzIDIgNDt9DQpAZm9udC1m
YWNlDQoJe2ZvbnQtZmFtaWx5OkNhbGlicmk7DQoJcGFub3NlLTE6MiAxNSA1IDIgMiAyIDQgMyAy
IDQ7fQ0KLyogU3R5bGUgRGVmaW5pdGlvbnMgKi8NCnAuTXNvTm9ybWFsLCBsaS5Nc29Ob3JtYWws
IGRpdi5Nc29Ob3JtYWwNCgl7bWFyZ2luOjBjbTsNCgltYXJnaW4tYm90dG9tOi4wMDAxcHQ7DQoJ
Zm9udC1zaXplOjEyLjBwdDsNCglmb250LWZhbWlseToiVGltZXMgTmV3IFJvbWFuIixzZXJpZjt9
DQphOmxpbmssIHNwYW4uTXNvSHlwZXJsaW5rDQoJe21zby1zdHlsZS1wcmlvcml0eTo5OTsNCglj
b2xvcjpibHVlOw0KCXRleHQtZGVjb3JhdGlvbjp1bmRlcmxpbmU7fQ0KYTp2aXNpdGVkLCBzcGFu
Lk1zb0h5cGVybGlua0ZvbGxvd2VkDQoJe21zby1zdHlsZS1wcmlvcml0eTo5OTsNCgljb2xvcjpw
dXJwbGU7DQoJdGV4dC1kZWNvcmF0aW9uOnVuZGVybGluZTt9DQpwDQoJe21zby1zdHlsZS1wcmlv
cml0eTo5OTsNCgltc28tbWFyZ2luLXRvcC1hbHQ6YXV0bzsNCgltYXJnaW4tcmlnaHQ6MGNtOw0K
CW1zby1tYXJnaW4tYm90dG9tLWFsdDphdXRvOw0KCW1hcmdpbi1sZWZ0OjBjbTsNCglmb250LXNp
emU6MTIuMHB0Ow0KCWZvbnQtZmFtaWx5OiJUaW1lcyBOZXcgUm9tYW4iLHNlcmlmO30NCnNwYW4u
RS1NYWlsRm9ybWF0dm9ybGFnZTE4DQoJe21zby1zdHlsZS10eXBlOnBlcnNvbmFsLXJlcGx5Ow0K
CWZvbnQtZmFtaWx5OiJDYWxpYnJpIixzYW5zLXNlcmlmOw0KCWNvbG9yOiMwMEIwNTA7DQoJZm9u
dC13ZWlnaHQ6bm9ybWFsOw0KCWZvbnQtc3R5bGU6bm9ybWFsOw0KCXRleHQtZGVjb3JhdGlvbjpu
b25lIG5vbmU7fQ0KLk1zb0NocERlZmF1bHQNCgl7bXNvLXN0eWxlLXR5cGU6ZXhwb3J0LW9ubHk7
DQoJZm9udC1mYW1pbHk6IkNhbGlicmkiLHNhbnMtc2VyaWY7DQoJbXNvLWZhcmVhc3QtbGFuZ3Vh
Z2U6RU4tVVM7fQ0KQHBhZ2UgV29yZFNlY3Rpb24xDQoJe3NpemU6NjEyLjBwdCA3OTIuMHB0Ow0K
CW1hcmdpbjo3MC44NXB0IDcwLjg1cHQgMi4wY20gNzAuODVwdDt9DQpkaXYuV29yZFNlY3Rpb24x
DQoJe3BhZ2U6V29yZFNlY3Rpb24xO30NCi0tPjwvc3R5bGU+PCEtLVtpZiBndGUgbXNvIDldPjx4
bWw+DQo8bzpzaGFwZWRlZmF1bHRzIHY6ZXh0PSJlZGl0IiBzcGlkbWF4PSIxMDI2IiAvPg0KPC94
bWw+PCFbZW5kaWZdLS0+PCEtLVtpZiBndGUgbXNvIDldPjx4bWw+DQo8bzpzaGFwZWxheW91dCB2
OmV4dD0iZWRpdCI+DQo8bzppZG1hcCB2OmV4dD0iZWRpdCIgZGF0YT0iMSIgLz4NCjwvbzpzaGFw
ZWxheW91dD48L3htbD48IVtlbmRpZl0tLT4NCjwvaGVhZD4NCjxib2R5IGxhbmc9IkRFIiBsaW5r
PSJibHVlIiB2bGluaz0icHVycGxlIj4NCjxkaXYgY2xhc3M9IldvcmRTZWN0aW9uMSI+DQo8cCBj
bGFzcz0iTXNvTm9ybWFsIj48c3BhbiBzdHlsZT0iZm9udC1zaXplOjExLjBwdDtmb250LWZhbWls
eTomcXVvdDtDYWxpYnJpJnF1b3Q7LHNhbnMtc2VyaWY7Y29sb3I6IzAwQjA1MDttc28tZmFyZWFz
dC1sYW5ndWFnZTpFTi1VUyI+PG86cD4mbmJzcDs8L286cD48L3NwYW4+PC9wPg0KPHAgY2xhc3M9
Ik1zb05vcm1hbCI+PHNwYW4gc3R5bGU9ImZvbnQtc2l6ZToxMS4wcHQ7Zm9udC1mYW1pbHk6JnF1
b3Q7Q2FsaWJyaSZxdW90OyxzYW5zLXNlcmlmO2NvbG9yOiMwMEIwNTA7bXNvLWZhcmVhc3QtbGFu
Z3VhZ2U6RU4tVVMiPjxvOnA+Jm5ic3A7PC9vOnA+PC9zcGFuPjwvcD4NCjxkaXYgc3R5bGU9ImJv
cmRlcjpub25lO2JvcmRlci1sZWZ0OnNvbGlkIGJsdWUgMS41cHQ7cGFkZGluZzowY20gMGNtIDBj
bSA0LjBwdCI+DQo8ZGl2Pg0KPGRpdiBzdHlsZT0iYm9yZGVyOm5vbmU7Ym9yZGVyLXRvcDpzb2xp
ZCAjRTFFMUUxIDEuMHB0O3BhZGRpbmc6My4wcHQgMGNtIDBjbSAwY20iPg0KPHAgY2xhc3M9Ik1z
b05vcm1hbCI+PGI+PHNwYW4gc3R5bGU9ImZvbnQtc2l6ZToxMS4wcHQ7Zm9udC1mYW1pbHk6JnF1
b3Q7Q2FsaWJyaSZxdW90OyxzYW5zLXNlcmlmIj5Wb246PC9zcGFuPjwvYj48c3BhbiBzdHlsZT0i
Zm9udC1zaXplOjExLjBwdDtmb250LWZhbWlseTomcXVvdDtDYWxpYnJpJnF1b3Q7LHNhbnMtc2Vy
aWYiPiBXaWxsaWFtIEEgUm93ZSBKciBbbWFpbHRvOndyb3dlQHJvd2UtY2xhbi5uZXRdDQo8YnI+
DQo8Yj5HZXNlbmRldDo8L2I+IE1vbnRhZywgNy4gRGV6ZW1iZXIgMjAxNSAxNzozOTxicj4NCjxi
PkFuOjwvYj4gaHR0cGQgJmx0O2RldkBodHRwZC5hcGFjaGUub3JnJmd0Ozxicj4NCjxiPkJldHJl
ZmY6PC9iPiBSZTogMi40IHBhdXNlIC0gbW9kX2h0dHAyIHBhdGNoc2V0IFVwZ3JhZGUgaDJjIHZz
IG1vZF9zc2wgVXBncmFkZSB0bHM8bzpwPjwvbzpwPjwvc3Bhbj48L3A+DQo8L2Rpdj4NCjwvZGl2
Pg0KPHAgY2xhc3M9Ik1zb05vcm1hbCI+PG86cD4mbmJzcDs8L286cD48L3A+DQo8ZGl2Pg0KPHA+
PGEgaHJlZj0iaHR0cHM6Ly90b29scy5pZXRmLm9yZy9odG1sL3JmYzcyMzAjc2VjdGlvbi02Ljci
IHRhcmdldD0iX2JsYW5rIj48c3BhbiBsYW5nPSJFTi1VUyI+aHR0cHM6Ly90b29scy5pZXRmLm9y
Zy9odG1sL3JmYzcyMzAjc2VjdGlvbi02Ljc8L3NwYW4+PC9hPjxzcGFuIGxhbmc9IkVOLVVTIj4g
bWFrZXMgdGhpbmdzIG1vcmUgaW50ZXJlc3RpbmcsIGl0IGNhbGxzIG91dCB0aGF0IDEwMS1jb250
aW51ZSBhbmQgdGhlIHJlcXVlc3QgYm9keQ0KIHJlYWQgcHJlY2VkZXMgdGhlIDEwMS1zd2l0Y2hp
bmcgcHJvdG9jb2xzLiZuYnNwOyA8L3NwYW4+Tm90IHN1cmUgd2hvIGRlY2lkZWQgdGhhdCB3b3Vs
ZCBiZSBhIGdvb2QgaWRlYSwgc2lnaC4uLiBidXQgbW9kX3NzbCBUTFMgdXBncmFkZSBoYXMgdGhl
c2UgcmV2ZXJzZWQgZm9yIHNldmVyYWwgZ29vZCByZWFzb25zIGluY2x1ZGluZyB0aGUgaW50ZW50
IHRvIGVuY3J5cHQgdGhlIHJlcXVlc3QgYm9keSBpZiBwcmVzZW50IGFuZCBzaW1wbGUgZWNvbm9t
aWNzDQogb2YgcHJvY2Vzc2luZy48bzpwPjwvbzpwPjwvcD4NCjxwPkkgdGhpbmsgdGhhdCBoYW5k
bGluZyB1cGdyYWRlIGFkdmVydGlzZW1lbnQgYW5kIGFsZXJ0aW5nIG11c3QgYmUgaW4gcG9zdCBy
ZWFkIHJlcSwgYnlwYXNzaW5nIGFsbCByZXF1ZXN0IGhvb2tzIHVudGlsIHRoZSAxMDEtY29udGlu
dWUgaXMgcHJlc2VudGVkLCBhbnkgc21hbGwgcmVxdWVzdCBib2R5IHJlYWQgYW5kIHNldCBhc2lk
ZSBmb3IgdGhlIGh0dHAgaW5wdXQgYnJpZ2FkZSwgYW5kIDEwMS1zd2l0Y2hpbmcgcHJvdG9jb2xz
IGlzIHByZXNlbnRlZC4mbmJzcDsNCiBUaGlzIGFsbG93cyB0aGUgcmVxdWVzdCB0byBzdGlsbCBi
ZSBwcm9jZXNzZWQgZm9yIHRscy1zdHlsZSB1cGdyYWRlcywgb3IgZGlzY2FyZGVkIGZvciByZWxl
dmFudCBwcm90b2NvbHMuPG86cD48L286cD48L3A+DQo8cD48c3BhbiBsYW5nPSJFTi1VUyIgc3R5
bGU9ImZvbnQtc2l6ZToxMS4wcHQ7Zm9udC1mYW1pbHk6JnF1b3Q7Q2FsaWJyaSZxdW90OyxzYW5z
LXNlcmlmO2NvbG9yOiMwMEIwNTAiPkhvdyBkbyB3ZSBoYW5kbGUgdGhpcyB0b2RheSBpZiB0aGUg
Y2xpZW50IGp1c3Qgc2VuZHMgYSByZXF1ZXN0IGJvZHkgYW5kIG5vdCBhbiBFeHBlY3QgaGVhZGVy
PyBEbyB3ZSBzZXQgaXQgYWxyZWFkeSBhc2lkZSBiZWZvcmUgYW5zd2VyaW5nIHdpdGggYSAxMDE/
PG86cD48L286cD48L3NwYW4+PC9wPg0KPHA+PHNwYW4gbGFuZz0iRU4tVVMiIHN0eWxlPSJmb250
LXNpemU6MTEuMHB0O2ZvbnQtZmFtaWx5OiZxdW90O0NhbGlicmkmcXVvdDssc2Fucy1zZXJpZjtj
b2xvcjojMDBCMDUwIj5SZWdhcmRzPG86cD48L286cD48L3NwYW4+PC9wPg0KPHA+PHNwYW4gbGFu
Zz0iRU4tVVMiIHN0eWxlPSJmb250LXNpemU6MTEuMHB0O2ZvbnQtZmFtaWx5OiZxdW90O0NhbGli
cmkmcXVvdDssc2Fucy1zZXJpZjtjb2xvcjojMDBCMDUwIj5Sw7xkaWdlcjxvOnA+PC9vOnA+PC9z
cGFuPjwvcD4NCjwvZGl2Pg0KPC9kaXY+DQo8L2Rpdj4NCjwvYm9keT4NCjwvaHRtbD4NCg==

--_000_AB1691BE05AE7F4992697F2A0835627AC63BAB94VOEXM10Winterna_--

From dev-return-84907-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Mon Dec  7 19:09:12 2015
Return-Path: <dev-return-84907-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 9354418C14
	for <apmail-httpd-dev-archive@www.apache.org>; Mon,  7 Dec 2015 19:09:12 +0000 (UTC)
Received: (qmail 33071 invoked by uid 500); 7 Dec 2015 19:09:06 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 33002 invoked by uid 500); 7 Dec 2015 19:09:06 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 32991 invoked by uid 99); 7 Dec 2015 19:09:06 -0000
Received: from Unknown (HELO spamd3-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 07 Dec 2015 19:09:06 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd3-us-west.apache.org (ASF Mail Server at spamd3-us-west.apache.org) with ESMTP id 1A2D3180A9F
	for <dev@httpd.apache.org>; Mon,  7 Dec 2015 19:09:06 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd3-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 2.347
X-Spam-Level: **
X-Spam-Status: No, score=2.347 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	HTML_MESSAGE=3, MIME_QP_LONG_LINE=0.001, RP_MATCHES_RCVD=-0.554,
	SPF_PASS=-0.001, URIBL_BLOCKED=0.001] autolearn=disabled
Authentication-Results: spamd3-us-west.apache.org (amavisd-new);
	dkim=pass (1024-bit key) header.d=greenbytes.de
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd3-us-west.apache.org [10.40.0.10]) (amavisd-new, port 10024)
	with ESMTP id RGVnWOrnqOJJ for <dev@httpd.apache.org>;
	Mon,  7 Dec 2015 19:08:54 +0000 (UTC)
Received: from mail.greenbytes.de (mail.greenbytes.de [217.91.35.233])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id 075D324D8D
	for <dev@httpd.apache.org>; Mon,  7 Dec 2015 19:08:54 +0000 (UTC)
Received: from [192.168.178.61] (unknown [93.211.116.41])
	(using TLSv1 with cipher ECDHE-RSA-AES256-SHA (256/256 bits))
	(Client did not present a certificate)
	by mail.greenbytes.de (Postfix) with ESMTPSA id C215515A049C
	for <dev@httpd.apache.org>; Mon,  7 Dec 2015 20:03:52 +0100 (CET)
DKIM-Signature: v=1; a=rsa-sha256; c=simple/simple; d=greenbytes.de; s=mail;
	t=1449515032; bh=rXair+Xrxm7/bnhbPjzd3jGjQz5bCTT9pBspn+kaBK0=;
	h=From:Subject:Date:References:In-Reply-To:To:From;
	b=k5hFL104gDkmsrsnLJnYHlKpIKyaseXk0DgkOucPVLgzI0zk7sRd0FjAVjH4udTAA
	 mrsl6WruSfJXi1mPalWzqAYORda0eTd3S8b1RibFLqBgR7lxGjN3R+btpHHV5lQWGb
	 KpKwgs3/lMXo/k/L+kxKLBuO/Dv6Fs3bXmip9E9g=
From: Stefan Eissing <stefan.eissing@greenbytes.de>
Content-Type: multipart/alternative;
	boundary=Apple-Mail-9F8BD469-177B-44B6-9BB5-E0CC240DBEA3
Content-Transfer-Encoding: 7bit
Mime-Version: 1.0 (1.0)
Subject: Re: 2.4 pause - mod_http2 patchset Upgrade h2c vs mod_ssl Upgrade tls
Message-Id: <6C1FCB84-22AF-49D5-AA10-BFB922A98390@greenbytes.de>
Date: Mon, 7 Dec 2015 20:03:52 +0100
References: <CACsi250=dbRQKnsbE8JSdAZRm5x99gE0sgX3iQ-PHAx77euD1A@mail.gmail.com> <CACsi2534prBtp7ENNNiEDevA3Z7u9uW2uuYMOa8-OoOsPSHNGQ@mail.gmail.com>
In-Reply-To: <CACsi2534prBtp7ENNNiEDevA3Z7u9uW2uuYMOa8-OoOsPSHNGQ@mail.gmail.com>
To: dev@httpd.apache.org
X-Mailer: iPhone Mail (13B143)


--Apple-Mail-9F8BD469-177B-44B6-9BB5-E0CC240DBEA3
Content-Type: text/plain;
	charset=us-ascii
Content-Transfer-Encoding: quoted-printable

Not at my machine to really check the runtime behaviour. Can do that tomorro=
w. My thoughts so far:

- the return code was not checked intentionally. Once the 101 intermediate r=
esponse is sent, there is nothing core can do on the connection. It has been=
 switched to a protocol unknown to core. Failure in the protocol handler won=
't make it HTTP/1 again. If we do not close the connection afterwards, but t=
ry to read the next h1 request, we just expose ourselves to someone insertin=
g payload that tricks us. Think about CORS restrictions and other stuff.
- I think its the protocol handlers job to deal with any request body. core d=
oes not need to do anything here. For h2 upgrade, for example, the switch is=
 only offered for requests without body. That exposes more predictable behav=
iour to clients than ignoring the upgrade on some arbitrary number of bytes.=
 Other protocols might be fine with bodies, h2 is not. This was a consensus o=
n the http wg mailing list some months ago.=20
- moving things to post read sounds tempting, however I'm not sure if we wan=
t to upgrade on non-authed request or not, for example. I am not sure what e=
lse we do in post read, maybe someone else has an opinion about that. It cer=
tainly looks nicer in the OPTIONS * case.=20

//stefan

> Am 07.12.2015 um 19:02 schrieb William A Rowe Jr <wrowe@rowe-clan.net>:
>=20
> Here's my thoughts to address this rather quickly for 2.4.18 to keep
> ourselves on track; simply move the core protocol handling phase and=20
> ap_switch_protocol action into the appropriate request processing phase,=20=

> address the fail-cases of the ap_switch_protocol exceptions that have=20
> been overlooked so that users can start leveraging the API, and just fix
> the mod_ssl OPTIONS * advertisement as presented on trunk (I am
> updating STATUS in a moment for that patch).
>=20
> The actual fix to incorporate mod_ssl TLS upgrade to work within the
> Protocol API can wait, so we don't further disrupt the overdue fixes
> for the mod_http2 feature for our users.  Although I would -like- them=20
> to coexist nicely, I don't believe that must happen until 2.4.19.  If the
> SSLOptions optional works within one vhost, and Protocol h2c works
> on another vhost, I think we are in good shape for the experimental
> new feature release.
>=20
> WDTY?
>=20
>=20
>> On Mon, Dec 7, 2015 at 10:38 AM, William A Rowe Jr <wrowe@rowe-clan.net> w=
rote:
>> Hi folks, sorry for the late interruption after we have already shipped 2=
.4.16, but there seems to be an issue that merits revisiting before the 2.4.=
16 API schema is widely adopted.
>>=20
>> We seem to have misplaced the upgrade handler in the wrong hook.  This is=
 easily shown by the fact that we had two different upgrade paths between mo=
d_ssl TLS upgrade, and h2c upgrade paths, and a crufty patch to solve the OP=
TIONS * request exception which isn't an exception at all per RFC7230.
>>=20
>> In mod_ssl connection upgrade we once emitted the TLS upgrade header in f=
ixups.  Fixups are bypassed by OPTIONS *.  My trunk patch moved this mod_ssl=
 TLS upgrade handling to post read req, leaving OPTIONS * with its simple be=
havior.
>>=20
>> In h2c this exists in an upgrade handler, and OPTIONS * was hacked to inv=
oke this function.  Problem, it is a transport (hop by hop) detail and shoul=
d not be presented in the request, but rather in the connection hooks.  More=
over, none of the other *request* processing phases appear valid prior to co=
nducting the h2c upgrade, and some appear that they can be harmful to the ad=
min attempting to configure Protocol h2c.
>>=20
>> The relevant specs are clear, it is a hop-by-hop connection transport off=
er carried over the request headers.  It is not generally subject to auth pr=
ocessing, certainly not resource processing.  The underlying request must st=
ill be satisfied.  The current Protocols logic doesn't appear to do this bec=
ause it was based off of tangential specs such as h2c that don't override 26=
16bis.  If we consider that a "method" has a "handler", and transfer "header=
s" are "filtered" it becomes more obvious.  This is not the UPGRADE method.
>>=20
>> https://tools.ietf.org/html/rfc7230#section-6.7 makes things more interes=
ting, it calls out that 101-continue and the request body read precedes the 1=
01-switching protocols.  Not sure who decided that would be a good idea, sig=
h... but mod_ssl TLS upgrade has these reversed for several good reasons inc=
luding the intent to encrypt the request body if present and simple economic=
s of processing.
>>=20
>> I think that handling upgrade advertisement and alerting must be in post r=
ead req, bypassing all request hooks until the 101-continue is presented, an=
y small request body read and set aside for the http input brigade, and 101-=
switching protocols is presented.  This allows the request to still be proce=
ssed for tls-style upgrades, or discarded for relevant protocols.
>>=20
>> The beginning of a patch is attached, I note that the ap_switch_protocol r=
eturn value was never properly interpreted and my patch doesn't begin to cat=
ch all of the exceptional cases.  Because 101-switching protocols has alread=
y been sent, if the call fails to perform an upgrade, it seems we need to re=
spond with a generic 400 switch failed unless the registered protocol switch=
 handler is going to ap_die with a different sort of specific error (e.g. "A=
 server MUST NOT switch protocols unless the received message semantics can b=
e honored by the new protocol; an OPTIONS request can be honored by any prot=
ocol.")
>>=20
>> Stefan and other protocol gurus, please have a look at the proposed patch=
, thanks.
>>=20
>> Bill
>>=20
>=20

--Apple-Mail-9F8BD469-177B-44B6-9BB5-E0CC240DBEA3
Content-Type: text/html;
	charset=utf-8
Content-Transfer-Encoding: quoted-printable

<html><head><meta http-equiv=3D"content-type" content=3D"text/html; charset=3D=
utf-8"></head><body dir=3D"auto"><div></div><div>Not at my machine to really=
 check the runtime behaviour. Can do that tomorrow. My thoughts so far:</div=
><div><br></div><div>- the return code was not checked intentionally. Once t=
he 101 intermediate response is sent, there is nothing core can do on the co=
nnection. It has been switched to a protocol unknown to core. Failure in the=
 protocol handler won't make it HTTP/1 again. If we do not close the connect=
ion afterwards, but try to read the next h1 request, we just expose ourselve=
s to someone inserting payload that tricks us. Think about CORS restrictions=
 and other stuff.</div><div>- I think its the protocol handlers job to deal w=
ith any request body. core does not need to do anything here. For h2 upgrade=
, for example, the switch is only offered for requests without body. That ex=
poses more predictable behaviour to clients than ignoring the upgrade on som=
e arbitrary number of bytes. Other protocols might be fine with bodies, h2 i=
s not. This was a consensus on the http wg mailing list some months ago.&nbs=
p;</div><div>- moving things to post read sounds tempting, however I'm not s=
ure if we want to upgrade on non-authed request or not, for example. I am no=
t sure what else we do in post read, maybe someone else has an opinion about=
 that. It certainly looks nicer in the OPTIONS * case.&nbsp;</div><div><br><=
/div><div>//stefan</div><div><br>Am 07.12.2015 um 19:02 schrieb William A Ro=
we Jr &lt;<a href=3D"mailto:wrowe@rowe-clan.net">wrowe@rowe-clan.net</a>&gt;=
:<br><br></div><blockquote type=3D"cite"><div><div dir=3D"ltr">Here's my tho=
ughts to address this rather quickly for 2.4.18 to keep<div>ourselves on tra=
ck; simply move the core protocol handling phase and&nbsp;</div><div>ap_swit=
ch_protocol action into the appropriate request processing phase,&nbsp;<div>=
<div>address the fail-cases of the ap_switch_protocol exceptions that have&n=
bsp;</div><div>been overlooked so that users can start leveraging the API, a=
nd just fix</div><div>the mod_ssl OPTIONS * advertisement as presented on tr=
unk (I am</div><div>updating STATUS in a moment for that patch).</div><div><=
br></div><div>The actual fix to incorporate mod_ssl TLS upgrade to work with=
in the</div><div>Protocol API can wait, so we don't further disrupt the over=
due fixes</div><div>for the mod_http2 feature for our users.&nbsp; Although I=
 would -like- them&nbsp;</div><div>to coexist nicely, I don't believe that m=
ust happen until 2.4.19.&nbsp; If the</div><div>SSLOptions optional works wi=
thin one vhost, and Protocol h2c works</div><div>on another vhost, I think w=
e are in good shape for the experimental</div><div>new feature release.</div=
><div><br></div><div>WDTY?</div><div><br></div></div></div></div><div class=3D=
"gmail_extra"><br><div class=3D"gmail_quote">On Mon, Dec 7, 2015 at 10:38 AM=
, William A Rowe Jr <span dir=3D"ltr">&lt;<a href=3D"mailto:wrowe@rowe-clan.=
net" target=3D"_blank">wrowe@rowe-clan.net</a>&gt;</span> wrote:<br><blockqu=
ote class=3D"gmail_quote" style=3D"margin:0 0 0 .8ex;border-left:1px #ccc so=
lid;padding-left:1ex"><div dir=3D"ltr"><p>Hi folks, sorry for the late inter=
ruption after we have already shipped 2.4.16, but there seems to be an issue=
 that merits revisiting before the 2.4.16 API schema is widely adopted.</p><=
p dir=3D"ltr">We seem to have misplaced the upgrade handler in the wrong hoo=
k.&nbsp; This is easily shown by the fact that we had two different upgrade p=
aths between mod_ssl TLS upgrade, and h2c upgrade paths, and a crufty patch t=
o solve the OPTIONS * request exception which isn't an exception at all per R=
FC7230.</p>
<p dir=3D"ltr">In mod_ssl connection upgrade we once emitted the TLS upgrade=
 header in fixups.&nbsp; Fixups are bypassed by OPTIONS *.&nbsp; My trunk pa=
tch moved this mod_ssl TLS upgrade handling to post read req, leaving OPTION=
S * with its simple behavior.</p>
<p dir=3D"ltr">In h2c this exists in an upgrade handler, and OPTIONS * was h=
acked to invoke this function.&nbsp; Problem, it is a transport (hop by hop)=
 detail and should not be presented in the request, but rather in the connec=
tion hooks.&nbsp; Moreover, none of the other *request* processing phases ap=
pear valid prior to conducting the h2c upgrade, and some appear that they ca=
n be harmful to the admin attempting to configure Protocol h2c.</p>
<p dir=3D"ltr">The relevant specs are clear, it is a hop-by-hop connection t=
ransport offer carried over the request headers.&nbsp; It is not generally s=
ubject to auth processing, certainly not resource processing.&nbsp; The unde=
rlying request must still be satisfied.&nbsp; The current Protocols logic do=
esn't appear to do this because it was based off of tangential specs such as=
 h2c that don't override 2616bis.&nbsp; If we consider that a "method" has a=
 "handler", and transfer "headers" are "filtered" it becomes more obvious.&n=
bsp; This is not the UPGRADE method.</p>
<p dir=3D"ltr"><a href=3D"https://tools.ietf.org/html/rfc7230#section-6.7" r=
el=3D"noreferrer" target=3D"_blank">https://tools.ietf.org/html/rfc7230#sect=
ion-6.7</a> makes things more interesting, it calls out that 101-continue an=
d the request body read precedes the 101-switching protocols.&nbsp; Not sure=
 who decided that would be a good idea, sigh... but mod_ssl TLS upgrade has t=
hese reversed for several good reasons including the intent to encrypt the r=
equest body if present and simple economics of processing.</p>
<p dir=3D"ltr">I think that handling upgrade advertisement and alerting must=
 be in post read req, bypassing all request hooks until the 101-continue is p=
resented, any small request body read and set aside for the http input briga=
de, and 101-switching protocols is presented.&nbsp; This allows the request t=
o still be processed for tls-style upgrades, or discarded for relevant proto=
cols.</p><p>The beginning of a patch is attached, I note that the ap_switch_=
protocol return value was never properly interpreted and my patch doesn't be=
gin to catch all of the exceptional cases.&nbsp; Because 101-switching proto=
cols has already been sent, if the call fails to perform an upgrade, it seem=
s we need to respond with a generic 400 switch failed unless the registered p=
rotocol switch handler is going to ap_die with a different sort of specific e=
rror (e.g. "A server MUST NOT switch protocols unless the received message s=
emantics can be honored by the new protocol; an OPTIONS request can be honor=
ed by any protocol.")</p><p>Stefan and other protocol gurus, please have a l=
ook at the proposed patch, thanks.</p><p>Bill</p>
</div>
</blockquote></div><br></div>
</div></blockquote></body></html>=

--Apple-Mail-9F8BD469-177B-44B6-9BB5-E0CC240DBEA3--

From dev-return-84908-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Mon Dec  7 19:11:02 2015
Return-Path: <dev-return-84908-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id D911F18C44
	for <apmail-httpd-dev-archive@www.apache.org>; Mon,  7 Dec 2015 19:11:02 +0000 (UTC)
Received: (qmail 39634 invoked by uid 500); 7 Dec 2015 19:10:59 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 39556 invoked by uid 500); 7 Dec 2015 19:10:59 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 39545 invoked by uid 99); 7 Dec 2015 19:10:59 -0000
Received: from Unknown (HELO spamd4-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 07 Dec 2015 19:10:59 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd4-us-west.apache.org (ASF Mail Server at spamd4-us-west.apache.org) with ESMTP id E5775C1335
	for <dev@httpd.apache.org>; Mon,  7 Dec 2015 19:10:58 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd4-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 2.347
X-Spam-Level: **
X-Spam-Status: No, score=2.347 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	HTML_MESSAGE=3, MIME_QP_LONG_LINE=0.001, RP_MATCHES_RCVD=-0.554,
	SPF_PASS=-0.001, URIBL_BLOCKED=0.001] autolearn=disabled
Authentication-Results: spamd4-us-west.apache.org (amavisd-new);
	dkim=pass (1024-bit key) header.d=greenbytes.de
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd4-us-west.apache.org [10.40.0.11]) (amavisd-new, port 10024)
	with ESMTP id lYq1COnqxIRo for <dev@httpd.apache.org>;
	Mon,  7 Dec 2015 19:10:48 +0000 (UTC)
Received: from mail.greenbytes.de (mail.greenbytes.de [217.91.35.233])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id BB2D1428DC
	for <dev@httpd.apache.org>; Mon,  7 Dec 2015 19:10:47 +0000 (UTC)
Received: from [192.168.178.61] (unknown [93.211.116.41])
	(using TLSv1 with cipher ECDHE-RSA-AES256-SHA (256/256 bits))
	(Client did not present a certificate)
	by mail.greenbytes.de (Postfix) with ESMTPSA id 4352915A049C
	for <dev@httpd.apache.org>; Mon,  7 Dec 2015 20:10:46 +0100 (CET)
DKIM-Signature: v=1; a=rsa-sha256; c=simple/simple; d=greenbytes.de; s=mail;
	t=1449515446; bh=y5lKIJHfHmscyHTmq3JzIMoDNzbdBLcUCVvaI/B2/5c=;
	h=From:Subject:Date:References:In-Reply-To:To:From;
	b=Rpb7js8za6aPDnBL8/7WeZr/V+p0T2SIxUQ7nZ2gp/yZCXLZUVKLeOfNGbHAwQnI0
	 ZCffNobTAUn6B7M6dBi5b7hgx3/sEQ6KvWwcIgQxPvJdSTtJFlvtuigZvqZu7hKMUp
	 kNKvS2cDDMw9hH77QPCrxeNONaD4mJiEaUiuamLU=
From: Stefan Eissing <stefan.eissing@greenbytes.de>
Content-Type: multipart/alternative;
	boundary=Apple-Mail-C5CCF040-700F-47DF-A740-C3B82EF78042
Content-Transfer-Encoding: 7bit
Mime-Version: 1.0 (1.0)
Subject: Re: AW: 2.4 pause - mod_http2 patchset Upgrade h2c vs mod_ssl Upgrade tls
Message-Id: <F7B20D30-D34A-4805-A77D-F64F6428F6E3@greenbytes.de>
Date: Mon, 7 Dec 2015 20:10:45 +0100
References: <CACsi250=dbRQKnsbE8JSdAZRm5x99gE0sgX3iQ-PHAx77euD1A@mail.gmail.com> <AB1691BE05AE7F4992697F2A0835627AC63BAB94@VOEXM10W.internal.vodafone.com>
In-Reply-To: <AB1691BE05AE7F4992697F2A0835627AC63BAB94@VOEXM10W.internal.vodafone.com>
To: dev@httpd.apache.org
X-Mailer: iPhone Mail (13B143)


--Apple-Mail-C5CCF040-700F-47DF-A740-C3B82EF78042
Content-Type: text/plain;
	charset=utf-8
Content-Transfer-Encoding: quoted-printable

h2 does not propose a switch if the request has a body.=20

As clarified on the http wg lists by the gurus there,  when i asked, the upg=
raded connection is in a mixed state after a 101. Any byte sent by the serve=
r MUST be from the switched protocol, while the client needs to send the bod=
y in HTTP/1 format and can only talk the new proto afterwards.=20

For an Expect 100 that would mean that the 100 intermediate comes before the=
 101. However that is untested with h2 as we do not propose a switch when a b=
ody is there.

> Am 07.12.2015 um 19:50 schrieb Pl=C3=BCm, R=C3=BCdiger, Vodafone Group <ru=
ediger.pluem@vodafone.com>:
>=20
> =20
> =20
> Von: William A Rowe Jr [mailto:wrowe@rowe-clan.net]=20
> Gesendet: Montag, 7. Dezember 2015 17:39
> An: httpd <dev@httpd.apache.org>
> Betreff: Re: 2.4 pause - mod_http2 patchset Upgrade h2c vs mod_ssl Upgrade=
 tls
> =20
> https://tools.ietf.org/html/rfc7230#section-6.7 makes things more interest=
ing, it calls out that 101-continue and the request body read precedes the 1=
01-switching protocols.  Not sure who decided that would be a good idea, sig=
h... but mod_ssl TLS upgrade has these reversed for several good reasons inc=
luding the intent to encrypt the request body if present and simple economic=
s of processing.
>=20
> I think that handling upgrade advertisement and alerting must be in post r=
ead req, bypassing all request hooks until the 101-continue is presented, an=
y small request body read and set aside for the http input brigade, and 101-=
switching protocols is presented.  This allows the request to still be proce=
ssed for tls-style upgrades, or discarded for relevant protocols.
>=20
> How do we handle this today if the client just sends a request body and no=
t an Expect header? Do we set it already aside before answering with a 101?
>=20
> Regards
>=20
> R=C3=BCdiger

--Apple-Mail-C5CCF040-700F-47DF-A740-C3B82EF78042
Content-Type: text/html;
	charset=utf-8
Content-Transfer-Encoding: quoted-printable

<html><head><meta http-equiv=3D"content-type" content=3D"text/html; charset=3D=
utf-8"></head><body dir=3D"auto"><div></div><div>h2 does not propose a switc=
h if the request has a body.&nbsp;</div><div><br></div><div>As clarified on t=
he http wg lists by the gurus there, &nbsp;when i asked, the upgraded connec=
tion is in a mixed state after a 101. Any byte sent by the server MUST be fr=
om the switched protocol, while the client needs to send the body in HTTP/1 f=
ormat and can only talk the new proto afterwards.&nbsp;</div><div><br></div>=
<div>For an Expect 100 that would mean that the 100 intermediate comes befor=
e the 101. However that is untested with h2 as we do not propose a switch wh=
en a body is there.</div><div><br>Am 07.12.2015 um 19:50 schrieb Pl=C3=BCm, R=
=C3=BCdiger, Vodafone Group &lt;<a href=3D"mailto:ruediger.pluem@vodafone.co=
m">ruediger.pluem@vodafone.com</a>&gt;:<br><br></div><blockquote type=3D"cit=
e"><div>

<meta http-equiv=3D"Content-Type" content=3D"text/html; charset=3Dutf-8">
<meta name=3D"Generator" content=3D"Microsoft Word 15 (filtered medium)">
<style><!--
/* Font Definitions */
@font-face
	{font-family:"Cambria Math";
	panose-1:2 4 5 3 5 4 6 3 2 4;}
@font-face
	{font-family:Calibri;
	panose-1:2 15 5 2 2 2 4 3 2 4;}
/* Style Definitions */
p.MsoNormal, li.MsoNormal, div.MsoNormal
	{margin:0cm;
	margin-bottom:.0001pt;
	font-size:12.0pt;
	font-family:"Times New Roman",serif;}
a:link, span.MsoHyperlink
	{mso-style-priority:99;
	color:blue;
	text-decoration:underline;}
a:visited, span.MsoHyperlinkFollowed
	{mso-style-priority:99;
	color:purple;
	text-decoration:underline;}
p
	{mso-style-priority:99;
	mso-margin-top-alt:auto;
	margin-right:0cm;
	mso-margin-bottom-alt:auto;
	margin-left:0cm;
	font-size:12.0pt;
	font-family:"Times New Roman",serif;}
span.E-MailFormatvorlage18
	{mso-style-type:personal-reply;
	font-family:"Calibri",sans-serif;
	color:#00B050;
	font-weight:normal;
	font-style:normal;
	text-decoration:none none;}
.MsoChpDefault
	{mso-style-type:export-only;
	font-family:"Calibri",sans-serif;
	mso-fareast-language:EN-US;}
@page WordSection1
	{size:612.0pt 792.0pt;
	margin:70.85pt 70.85pt 2.0cm 70.85pt;}
div.WordSection1
	{page:WordSection1;}
--></style><!--[if gte mso 9]><xml>
<o:shapedefaults v:ext=3D"edit" spidmax=3D"1026" />
</xml><![endif]--><!--[if gte mso 9]><xml>
<o:shapelayout v:ext=3D"edit">
<o:idmap v:ext=3D"edit" data=3D"1" />
</o:shapelayout></xml><![endif]-->


<div class=3D"WordSection1">
<p class=3D"MsoNormal"><span style=3D"font-size:11.0pt;font-family:&quot;Cal=
ibri&quot;,sans-serif;color:#00B050;mso-fareast-language:EN-US"><o:p>&nbsp;<=
/o:p></span></p>
<p class=3D"MsoNormal"><span style=3D"font-size:11.0pt;font-family:&quot;Cal=
ibri&quot;,sans-serif;color:#00B050;mso-fareast-language:EN-US"><o:p>&nbsp;<=
/o:p></span></p>
<div style=3D"border:none;border-left:solid blue 1.5pt;padding:0cm 0cm 0cm 4=
.0pt">
<div>
<div style=3D"border:none;border-top:solid #E1E1E1 1.0pt;padding:3.0pt 0cm 0=
cm 0cm">
<p class=3D"MsoNormal"><b><span style=3D"font-size:11.0pt;font-family:&quot;=
Calibri&quot;,sans-serif">Von:</span></b><span style=3D"font-size:11.0pt;fon=
t-family:&quot;Calibri&quot;,sans-serif"> William A Rowe Jr [<a href=3D"mail=
to:wrowe@rowe-clan.net">mailto:wrowe@rowe-clan.net</a>]
<br>
<b>Gesendet:</b> Montag, 7. Dezember 2015 17:39<br>
<b>An:</b> httpd &lt;<a href=3D"mailto:dev@httpd.apache.org">dev@httpd.apach=
e.org</a>&gt;<br>
<b>Betreff:</b> Re: 2.4 pause - mod_http2 patchset Upgrade h2c vs mod_ssl Up=
grade tls<o:p></o:p></span></p>
</div>
</div>
<p class=3D"MsoNormal"><o:p>&nbsp;</o:p></p>
<div>
<p><a href=3D"https://tools.ietf.org/html/rfc7230#section-6.7" target=3D"_bl=
ank"><span lang=3D"EN-US">https://tools.ietf.org/html/rfc7230#section-6.7</s=
pan></a><span lang=3D"EN-US"> makes things more interesting, it calls out th=
at 101-continue and the request body
 read precedes the 101-switching protocols.&nbsp; </span>Not sure who decide=
d that would be a good idea, sigh... but mod_ssl TLS upgrade has these rever=
sed for several good reasons including the intent to encrypt the request bod=
y if present and simple economics
 of processing.<o:p></o:p></p>
<p>I think that handling upgrade advertisement and alerting must be in post r=
ead req, bypassing all request hooks until the 101-continue is presented, an=
y small request body read and set aside for the http input brigade, and 101-=
switching protocols is presented.&nbsp;
 This allows the request to still be processed for tls-style upgrades, or di=
scarded for relevant protocols.<o:p></o:p></p>
<p><span lang=3D"EN-US" style=3D"font-size:11.0pt;font-family:&quot;Calibri&=
quot;,sans-serif;color:#00B050">How do we handle this today if the client ju=
st sends a request body and not an Expect header? Do we set it already aside=
 before answering with a 101?<o:p></o:p></span></p>
<p><span lang=3D"EN-US" style=3D"font-size:11.0pt;font-family:&quot;Calibri&=
quot;,sans-serif;color:#00B050">Regards<o:p></o:p></span></p>
<p><span lang=3D"EN-US" style=3D"font-size:11.0pt;font-family:&quot;Calibri&=
quot;,sans-serif;color:#00B050">R=C3=BCdiger<o:p></o:p></span></p>
</div>
</div>
</div>


</div></blockquote></body></html>=

--Apple-Mail-C5CCF040-700F-47DF-A740-C3B82EF78042--

From dev-return-84909-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Mon Dec  7 19:55:20 2015
Return-Path: <dev-return-84909-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id B643318E82
	for <apmail-httpd-dev-archive@www.apache.org>; Mon,  7 Dec 2015 19:55:20 +0000 (UTC)
Received: (qmail 61468 invoked by uid 500); 7 Dec 2015 19:55:17 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 61362 invoked by uid 500); 7 Dec 2015 19:55:17 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 61282 invoked by uid 99); 7 Dec 2015 19:55:17 -0000
Received: from Unknown (HELO spamd1-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 07 Dec 2015 19:55:17 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd1-us-west.apache.org (ASF Mail Server at spamd1-us-west.apache.org) with ESMTP id 8C57BC25B2
	for <dev@httpd.apache.org>; Mon,  7 Dec 2015 19:55:16 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd1-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 2.88
X-Spam-Level: **
X-Spam-Status: No, score=2.88 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	HTML_MESSAGE=3, RCVD_IN_MSPIKE_H3=-0.01, RCVD_IN_MSPIKE_WL=-0.01,
	SPF_PASS=-0.001, URIBL_BLOCKED=0.001] autolearn=disabled
Authentication-Results: spamd1-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd1-us-west.apache.org [10.40.0.7]) (amavisd-new, port 10024)
	with ESMTP id lMr6B8yL5iiy for <dev@httpd.apache.org>;
	Mon,  7 Dec 2015 19:55:10 +0000 (UTC)
Received: from mail-wm0-f49.google.com (mail-wm0-f49.google.com [74.125.82.49])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id F20E020ECF
	for <dev@httpd.apache.org>; Mon,  7 Dec 2015 19:55:09 +0000 (UTC)
Received: by wmec201 with SMTP id c201so182229816wme.0
        for <dev@httpd.apache.org>; Mon, 07 Dec 2015 11:55:09 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        bh=80eMZD2I1ym4BPnZ5mRqj5ZXP5tL7kjNtEB9p0YLPKA=;
        b=mR/Q2s85SKEF2nGy1ojSlmYji+tJEXDPI4B2TRGMP1Hofl7xOcpX77FazjicKeZ3qu
         TuDllBhob8dTYynEdIKip2cP51REM51j7GIsP9cTDQzocYpgr6iqghcMfJLEIuwwlnCs
         E0qo/87ak1ehhnd3wPtm/5uveyVwUkrQNMWruyxbLrXIsYwQIDp+f3ncdxKH3aVAIMi8
         unqdRPtokWLjgPzh6q2QObi7mhRp1PkETVT1DU50Fwu+xTMNsKLQ8qxt4JcqSzxM1Ev6
         zE4D5Nkj+vwPEbIOz9X7NUp4ooJJA2lzfUV1BPS0ywuYeL+5C/h+N2JDeTUXvbYUQ8DC
         0nfw==
MIME-Version: 1.0
X-Received: by 10.28.187.69 with SMTP id l66mr161527wmf.21.1449518109704; Mon,
 07 Dec 2015 11:55:09 -0800 (PST)
Received: by 10.28.111.80 with HTTP; Mon, 7 Dec 2015 11:55:09 -0800 (PST)
Received: by 10.28.111.80 with HTTP; Mon, 7 Dec 2015 11:55:09 -0800 (PST)
In-Reply-To: <6C1FCB84-22AF-49D5-AA10-BFB922A98390@greenbytes.de>
References: <CACsi250=dbRQKnsbE8JSdAZRm5x99gE0sgX3iQ-PHAx77euD1A@mail.gmail.com>
	<CACsi2534prBtp7ENNNiEDevA3Z7u9uW2uuYMOa8-OoOsPSHNGQ@mail.gmail.com>
	<6C1FCB84-22AF-49D5-AA10-BFB922A98390@greenbytes.de>
Date: Mon, 7 Dec 2015 11:55:09 -0800
Message-ID: <CAGu=u8h9XxW0NSeMDSwaujO1G=sRn67TFah_FyGqNnBaWhHpLw@mail.gmail.com>
Subject: Re: 2.4 pause - mod_http2 patchset Upgrade h2c vs mod_ssl Upgrade tls
From: Jacob Champion <champion.p@gmail.com>
To: dev@httpd.apache.org
Content-Type: multipart/alternative; boundary=001a114b10640647430526543cf5

--001a114b10640647430526543cf5
Content-Type: text/plain; charset=UTF-8

Ugh, looks like I'm too slow on my work with the upgrade proposal hooks;
sorry I haven't been able to give in-depth feedback yet.

On Dec 7, 2015 11:09 AM, "Stefan Eissing" <stefan.eissing@greenbytes.de>
wrote:
>
> Not at my machine to really check the runtime behaviour. Can do that
tomorrow. My thoughts so far:
>
> - the return code was not checked intentionally. Once the 101
intermediate response is sent, there is nothing core can do on the
connection. It has been switched to a protocol unknown to core. Failure in
the protocol handler won't make it HTTP/1 again. If we do not close the
connection afterwards, but try to read the next h1 request, we just expose
ourselves to someone inserting payload that tricks us. Think about CORS
restrictions and other stuff.

+1. httpd et al need to ensure an upgrade is possible before sending 101,
not after.

> - I think its the protocol handlers job to deal with any request body.
core does not need to do anything here. For h2 upgrade, for example, the
switch is only offered for requests without body. That exposes more
predictable behaviour to clients than ignoring the upgrade on some
arbitrary number of bytes. Other protocols might be fine with bodies, h2 is
not. This was a consensus on the http wg mailing list some months ago.

By "core doesn't need to do anything" do you mean that it doesn't need to
set up the incoming filter chain? Couldn't the initial request body have
been sent with transfer encodings and other transformations?

> - moving things to post read sounds tempting, however I'm not sure if we
want to upgrade on non-authed request or not, for example. I am not sure
what else we do in post read, maybe someone else has an opinion about that.
It certainly looks nicer in the OPTIONS * case.

WebSocket upgrades rely on authn headers and cookies; there is no (good)
way after a connection has been established to say "well, I upgraded you
but now I'm closing the connection because you weren't authorized." The
check needs to be done before sending 101 (and otherwise a 401/403/4xx
needs to be sent instead of the upgrade).

--Jacob

--001a114b10640647430526543cf5
Content-Type: text/html; charset=UTF-8
Content-Transfer-Encoding: quoted-printable

<p dir=3D"ltr">Ugh, looks like I&#39;m too slow on my work with the upgrade=
 proposal hooks; sorry I haven&#39;t been able to give in-depth feedback ye=
t.</p>
<p dir=3D"ltr">On Dec 7, 2015 11:09 AM, &quot;Stefan Eissing&quot; &lt;<a h=
ref=3D"mailto:stefan.eissing@greenbytes.de">stefan.eissing@greenbytes.de</a=
>&gt; wrote:<br>
&gt;<br>
&gt; Not at my machine to really check the runtime behaviour. Can do that t=
omorrow. My thoughts so far:<br>
&gt;<br>
&gt; - the return code was not checked intentionally. Once the 101 intermed=
iate response is sent, there is nothing core can do on the connection. It h=
as been switched to a protocol unknown to core. Failure in the protocol han=
dler won&#39;t make it HTTP/1 again. If we do not close the connection afte=
rwards, but try to read the next h1 request, we just expose ourselves to so=
meone inserting payload that tricks us. Think about CORS restrictions and o=
ther stuff.</p>
<p dir=3D"ltr">+1. httpd et al need to ensure an upgrade is possible before=
 sending 101, not after.</p>
<p dir=3D"ltr">&gt; - I think its the protocol handlers job to deal with an=
y request body. core does not need to do anything here. For h2 upgrade, for=
 example, the switch is only offered for requests without body. That expose=
s more predictable behaviour to clients than ignoring the upgrade on some a=
rbitrary number of bytes. Other protocols might be fine with bodies, h2 is =
not. This was a consensus on the http wg mailing list some months ago.</p>
<p dir=3D"ltr">By &quot;core doesn&#39;t need to do anything&quot; do you m=
ean that it doesn&#39;t need to set up the incoming filter chain? Couldn&#3=
9;t the initial request body have been sent with transfer encodings and oth=
er transformations?</p>
<p dir=3D"ltr">&gt; - moving things to post read sounds tempting, however I=
&#39;m not sure if we want to upgrade on non-authed request or not, for exa=
mple. I am not sure what else we do in post read, maybe someone else has an=
 opinion about that. It certainly looks nicer in the OPTIONS * case.=C2=A0<=
/p>
<p dir=3D"ltr">WebSocket upgrades rely on authn headers and cookies; there =
is no (good) way after a connection has been established to say &quot;well,=
 I upgraded you but now I&#39;m closing the connection because you weren&#3=
9;t authorized.&quot; The check needs to be done before sending 101 (and ot=
herwise a 401/403/4xx needs to be sent instead of the upgrade).</p>
<p dir=3D"ltr">--Jacob</p>

--001a114b10640647430526543cf5--

From dev-return-84910-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Mon Dec  7 20:16:10 2015
Return-Path: <dev-return-84910-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 4801C18FB3
	for <apmail-httpd-dev-archive@www.apache.org>; Mon,  7 Dec 2015 20:16:10 +0000 (UTC)
Received: (qmail 32363 invoked by uid 500); 7 Dec 2015 20:16:09 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 32286 invoked by uid 500); 7 Dec 2015 20:16:09 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 32273 invoked by uid 99); 7 Dec 2015 20:16:09 -0000
Received: from Unknown (HELO spamd3-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 07 Dec 2015 20:16:09 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd3-us-west.apache.org (ASF Mail Server at spamd3-us-west.apache.org) with ESMTP id D114A18022F
	for <dev@httpd.apache.org>; Mon,  7 Dec 2015 20:16:08 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd3-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 2.9
X-Spam-Level: **
X-Spam-Status: No, score=2.9 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	HTML_MESSAGE=3, SPF_PASS=-0.001, URIBL_BLOCKED=0.001]
	autolearn=disabled
Authentication-Results: spamd3-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd3-us-west.apache.org [10.40.0.10]) (amavisd-new, port 10024)
	with ESMTP id r2ZiTcMCd0I3 for <dev@httpd.apache.org>;
	Mon,  7 Dec 2015 20:16:00 +0000 (UTC)
Received: from mail-wm0-f50.google.com (mail-wm0-f50.google.com [74.125.82.50])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id 2CA87441A5
	for <dev@httpd.apache.org>; Mon,  7 Dec 2015 20:16:00 +0000 (UTC)
Received: by wmec201 with SMTP id c201so182996794wme.0
        for <dev@httpd.apache.org>; Mon, 07 Dec 2015 12:15:53 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        bh=9OcHYfIaMaMO65HYR6nWS2meJ6fZCqjy98qd7sqWDuk=;
        b=Qw7mKcHPZHvYuNBXgpmXNX9LJh5bHbkjH9QEwhZ0hi3B3EDtqhg0GIbc9DiU8/oSVm
         aRHTDdopXcnwRK8CMBTAsMtc3cnxOG9+m6fy7rIQVIVN6peZtC5aX88G0sfsiNGgHQqW
         YyxOw5y3Fg+t7GYz8RvrgQFBjZm8vqycIhBHhVxMbXYq6Fv2NiFH6Ywn0o5hhmsHAdpd
         55vPpzuMIgxGRCYXsUpX+EQExGxyurbclXWGQ/J/MiwdQqPjV2mDiWBx+B00hY607pu+
         QyO+QLnhY3rmSKVqFX5myH/rLtRLwp5y5VuH7PFn9tjCWAt9bbt/e6tUVUUTLZLGKOdF
         O2Pg==
MIME-Version: 1.0
X-Received: by 10.195.11.129 with SMTP id ei1mr40490408wjd.80.1449519352966;
 Mon, 07 Dec 2015 12:15:52 -0800 (PST)
Received: by 10.28.111.80 with HTTP; Mon, 7 Dec 2015 12:15:52 -0800 (PST)
Received: by 10.28.111.80 with HTTP; Mon, 7 Dec 2015 12:15:52 -0800 (PST)
In-Reply-To: <CACsi250=dbRQKnsbE8JSdAZRm5x99gE0sgX3iQ-PHAx77euD1A@mail.gmail.com>
References: <CACsi250=dbRQKnsbE8JSdAZRm5x99gE0sgX3iQ-PHAx77euD1A@mail.gmail.com>
Date: Mon, 7 Dec 2015 12:15:52 -0800
Message-ID: <CAGu=u8jn-qYVX2V-EAvcOjnPP3OcGcpThj7YesXxQRCHDUzgaA@mail.gmail.com>
Subject: Re: 2.4 pause - mod_http2 patchset Upgrade h2c vs mod_ssl Upgrade tls
From: Jacob Champion <champion.p@gmail.com>
To: dev@httpd.apache.org
Content-Type: multipart/alternative; boundary=047d7b86ce4820f94d05265486c3

--047d7b86ce4820f94d05265486c3
Content-Type: text/plain; charset=UTF-8

On Dec 7, 2015 8:43 AM, "William A Rowe Jr" <wrowe@rowe-clan.net> wrote:
>
> https://tools.ietf.org/html/rfc7230#section-6.7 makes things more
interesting, it calls out that 101-continue and the request body read
precedes the 101-switching protocols.  Not sure who decided that would be a
good idea, sigh...

100-continue can't be after the switch; the new protocol may not have any
idea what continue semantics are. Similarly, the request body sent is still
part of an HTTP/1.1 request and should be processed as such.

> but mod_ssl TLS upgrade has these reversed for several good reasons
including the intent to encrypt the request body if present and simple
economics of processing.

Did you mean "decrypt the request body"? The client needs to send its
request body in plaintext since servers are free to completely ignore the
Upgrade, right? My reading of the specs is that an Upgrade request is still
a self-contained HTTP/1.1 request, body included.

Sorry if I've misunderstood your wording.

--Jacob

--047d7b86ce4820f94d05265486c3
Content-Type: text/html; charset=UTF-8
Content-Transfer-Encoding: quoted-printable

<p dir=3D"ltr">On Dec 7, 2015 8:43 AM, &quot;William A Rowe Jr&quot; &lt;<a=
 href=3D"mailto:wrowe@rowe-clan.net">wrowe@rowe-clan.net</a>&gt; wrote:<br>
&gt;<br>
&gt; <a href=3D"https://tools.ietf.org/html/rfc7230#section-6.7">https://to=
ols.ietf.org/html/rfc7230#section-6.7</a> makes things more interesting, it=
 calls out that 101-continue and the request body read precedes the 101-swi=
tching protocols.=C2=A0 Not sure who decided that would be a good idea, sig=
h...</p>
<p dir=3D"ltr">100-continue can&#39;t be after the switch; the new protocol=
 may not have any idea what continue semantics are. Similarly, the request =
body sent is still part of an HTTP/1.1 request and should be processed as s=
uch.</p>
<p dir=3D"ltr">&gt; but mod_ssl TLS upgrade has these reversed for several =
good reasons including the intent to encrypt the request body if present an=
d simple economics of processing.</p>
<p dir=3D"ltr">Did you mean &quot;decrypt the request body&quot;? The clien=
t needs to send its request body in plaintext since servers are free to com=
pletely ignore the Upgrade, right? My reading of the specs is that an Upgra=
de request is still a self-contained HTTP/1.1 request, body included.</p>
<p dir=3D"ltr">Sorry if I&#39;ve misunderstood your wording.</p>
<p dir=3D"ltr">--Jacob</p>

--047d7b86ce4820f94d05265486c3--

From dev-return-84911-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Mon Dec  7 20:29:34 2015
Return-Path: <dev-return-84911-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id D80A818149
	for <apmail-httpd-dev-archive@www.apache.org>; Mon,  7 Dec 2015 20:29:34 +0000 (UTC)
Received: (qmail 76051 invoked by uid 500); 7 Dec 2015 20:29:25 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 75975 invoked by uid 500); 7 Dec 2015 20:29:25 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 75964 invoked by uid 99); 7 Dec 2015 20:29:24 -0000
Received: from Unknown (HELO spamd4-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 07 Dec 2015 20:29:24 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd4-us-west.apache.org (ASF Mail Server at spamd4-us-west.apache.org) with ESMTP id 7D1AAC0BC9
	for <dev@httpd.apache.org>; Mon,  7 Dec 2015 20:29:24 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd4-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 3
X-Spam-Level: ***
X-Spam-Status: No, score=3 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, HTML_MESSAGE=3,
	SPF_PASS=-0.001, URIBL_BLOCKED=0.001] autolearn=disabled
Authentication-Results: spamd4-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=rowe-clan-net.20150623.gappssmtp.com
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd4-us-west.apache.org [10.40.0.11]) (amavisd-new, port 10024)
	with ESMTP id JXI10tErm6-c for <dev@httpd.apache.org>;
	Mon,  7 Dec 2015 20:29:16 +0000 (UTC)
Received: from mail-ig0-f178.google.com (mail-ig0-f178.google.com [209.85.213.178])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id 266B842B4B
	for <dev@httpd.apache.org>; Mon,  7 Dec 2015 20:29:16 +0000 (UTC)
Received: by igcmv3 with SMTP id mv3so87067381igc.0
        for <dev@httpd.apache.org>; Mon, 07 Dec 2015 12:29:15 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=rowe-clan-net.20150623.gappssmtp.com; s=20150623;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        bh=j7EI9ZbRD/vc4FZ48ytDojazNPd4vbklBwPIkt6OpP0=;
        b=LzYXoEL8OHG+QjVH5pFPGbTsO3tPStlmCms8Cd1/ag/A845nO+cbudpGHrQYz27Zmk
         LYC6TsabaHAFFX/1JpKfmYvUzfhqz9gWDeSNshen5ziW5lEGJBQdhFrp8jpcrciXbprO
         CDcXf9QIAfgP8GPdy6zFEAAXNFJla6cQPMUljXPoSS3HvyEZhUlgh7nvJPTBLrCgcNpw
         doS+FFWn7EtfOAyu+syTh+m3WvEvWSd0rC904p3Uw9Z8uIgMOTGynh7aQzNL7xH98IQN
         gGRm0N27Fgf1cvRc2OYHt/We9yt2Td5FD2DsdvL6TRnnYRnvqRlzuS1W1T5iSpyURWHn
         zytQ==
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=1e100.net; s=20130820;
        h=x-gm-message-state:mime-version:in-reply-to:references:date
         :message-id:subject:from:to:content-type;
        bh=j7EI9ZbRD/vc4FZ48ytDojazNPd4vbklBwPIkt6OpP0=;
        b=YrOJnj3NnjU2+3jkV2SCatt7bfO/SeHSvyGV722i/h8K5miHfxMjoGcLdp4xyJ88WE
         CuSTqwhsKZhLNJRUhfiFUbQe09oyYmJUyzMPf0of48dDud5ta8k3wI2CfPBTLGQwyNPU
         VX/qmHa2ReH3tGYvAhYXIpcinuMXXUrjXBHH/ghKU/jdQGQr/9zTYBwlNXRzS+z/VAwq
         t/6uYvS+61aAwnqerTI0m1gOv9gu3NRJoJZxLjDffcW1Nlvo4Bmzkz3OAwADvStFW/Rd
         njPZOosLs/fgPXtdqeGQ0XorMxceU6bGQtaOpLBAt/2mO3OmuBaYa3sT9LPiwAu8P2RE
         rKVQ==
X-Gm-Message-State: ALoCoQlQI1yrfrfEUjwePQg647Pcu9FhSDnWfmpExaUE9KjRkrBQZfgRdCmyyLhwvMMUY2q4cnV3Psgr6gPu6oCxZwF0xzhIij0/rwVjwDqb201UTlUfxuQ=
MIME-Version: 1.0
X-Received: by 10.50.142.7 with SMTP id rs7mr18994898igb.35.1449520155515;
 Mon, 07 Dec 2015 12:29:15 -0800 (PST)
Received: by 10.107.62.136 with HTTP; Mon, 7 Dec 2015 12:29:15 -0800 (PST)
In-Reply-To: <CAGu=u8jn-qYVX2V-EAvcOjnPP3OcGcpThj7YesXxQRCHDUzgaA@mail.gmail.com>
References: <CACsi250=dbRQKnsbE8JSdAZRm5x99gE0sgX3iQ-PHAx77euD1A@mail.gmail.com>
	<CAGu=u8jn-qYVX2V-EAvcOjnPP3OcGcpThj7YesXxQRCHDUzgaA@mail.gmail.com>
Date: Mon, 7 Dec 2015 14:29:15 -0600
Message-ID: <CACsi251zevzsdTUQKmye9bPLRnoc6Tn__GRRavDPgrU-f5L7Ag@mail.gmail.com>
Subject: Re: 2.4 pause - mod_http2 patchset Upgrade h2c vs mod_ssl Upgrade tls
From: William A Rowe Jr <wrowe@rowe-clan.net>
To: httpd <dev@httpd.apache.org>
Content-Type: multipart/alternative; boundary=001a11c2eb5af6f85a052654b56a

--001a11c2eb5af6f85a052654b56a
Content-Type: text/plain; charset=UTF-8

On Mon, Dec 7, 2015 at 2:15 PM, Jacob Champion <champion.p@gmail.com> wrote:

> On Dec 7, 2015 8:43 AM, "William A Rowe Jr" <wrowe@rowe-clan.net> wrote:
> >
> > https://tools.ietf.org/html/rfc7230#section-6.7 makes things more
> interesting, it calls out that 101-continue and the request body read
> precedes the 101-switching protocols.  Not sure who decided that would be a
> good idea, sigh...
>
> 100-continue can't be after the switch; the new protocol may not have any
> idea what continue semantics are. Similarly, the request body sent is still
> part of an HTTP/1.1 request and should be processed as such.
>
> > but mod_ssl TLS upgrade has these reversed for several good reasons
> including the intent to encrypt the request body if present and simple
> economics of processing.
>
> Did you mean "decrypt the request body"?
>
Yes, my bad...

> The client needs to send its request body in plaintext since servers are
> free to completely ignore the Upgrade, right? My reading of the specs is
> that an Upgrade request is still a self-contained HTTP/1.1 request, body
> included.
>
No.  If the upgrade is rejected, no 101-switching protocols occurs.  If
there was no Expect: 100-continue then yes, the body seems part of the
request headers with no way to anticipate how to proceed except plaintext,
but in the case of an Expect: 100-continue, an an interim 101-switching
protocols, a tls handshake, followed by a 100-continue seemed entirely
reasonable.

It appears we did the wrong thing in the absence of an Expect:
100-continue, but as a practical matter this seems fairly academic since
RFC7230 codifies a specific sequence that we must adopt, and the instances
of request bodies in upgrade requests seems philosophical.

--001a11c2eb5af6f85a052654b56a
Content-Type: text/html; charset=UTF-8
Content-Transfer-Encoding: quoted-printable

<div dir=3D"ltr"><div class=3D"gmail_extra"><div class=3D"gmail_quote">On M=
on, Dec 7, 2015 at 2:15 PM, Jacob Champion <span dir=3D"ltr">&lt;<a href=3D=
"mailto:champion.p@gmail.com" target=3D"_blank">champion.p@gmail.com</a>&gt=
;</span> wrote:<br><blockquote class=3D"gmail_quote" style=3D"margin:0 0 0 =
.8ex;border-left:1px #ccc solid;padding-left:1ex"><span class=3D""><p dir=
=3D"ltr">On Dec 7, 2015 8:43 AM, &quot;William A Rowe Jr&quot; &lt;<a href=
=3D"mailto:wrowe@rowe-clan.net" target=3D"_blank">wrowe@rowe-clan.net</a>&g=
t; wrote:<br>
&gt;<br>
&gt; <a href=3D"https://tools.ietf.org/html/rfc7230#section-6.7" target=3D"=
_blank">https://tools.ietf.org/html/rfc7230#section-6.7</a> makes things mo=
re interesting, it calls out that 101-continue and the request body read pr=
ecedes the 101-switching protocols.=C2=A0 Not sure who decided that would b=
e a good idea, sigh...</p>
</span><p dir=3D"ltr">100-continue can&#39;t be after the switch; the new p=
rotocol may not have any idea what continue semantics are. Similarly, the r=
equest body sent is still part of an HTTP/1.1 request and should be process=
ed as such.</p><span class=3D"">
<p dir=3D"ltr">&gt; but mod_ssl TLS upgrade has these reversed for several =
good reasons including the intent to encrypt the request body if present an=
d simple economics of processing.</p>
</span><p dir=3D"ltr">Did you mean &quot;decrypt the request body&quot;? </=
p></blockquote><div>Yes, my bad...=C2=A0</div><blockquote class=3D"gmail_qu=
ote" style=3D"margin:0 0 0 .8ex;border-left:1px #ccc solid;padding-left:1ex=
"><p dir=3D"ltr">The client needs to send its request body in plaintext sin=
ce servers are free to completely ignore the Upgrade, right? My reading of =
the specs is that an Upgrade request is still a self-contained HTTP/1.1 req=
uest, body included.</p></blockquote><div>No.=C2=A0 If the upgrade is rejec=
ted, no 101-switching protocols occurs.=C2=A0 If there was no Expect: 100-c=
ontinue then yes, the body seems part of the request headers with no way to=
 anticipate how to proceed except plaintext, but in the case of an Expect: =
100-continue, an an interim 101-switching protocols, a tls handshake, follo=
wed by a 100-continue seemed entirely reasonable.<br></div><div><br></div><=
div>It appears we did the wrong thing in the absence of an Expect: 100-cont=
inue, but as a practical matter this seems fairly academic since RFC7230 co=
difies a specific sequence that we must adopt, and the instances of request=
 bodies in upgrade requests seems philosophical.</div><div><br></div><div><=
br></div><div><br></div><div><br></div></div></div></div>

--001a11c2eb5af6f85a052654b56a--

From dev-return-84912-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Mon Dec  7 20:44:29 2015
Return-Path: <dev-return-84912-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 1E14D181EC
	for <apmail-httpd-dev-archive@www.apache.org>; Mon,  7 Dec 2015 20:44:29 +0000 (UTC)
Received: (qmail 33323 invoked by uid 500); 7 Dec 2015 20:44:23 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 33233 invoked by uid 500); 7 Dec 2015 20:44:23 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 33223 invoked by uid 99); 7 Dec 2015 20:44:23 -0000
Received: from Unknown (HELO spamd1-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 07 Dec 2015 20:44:23 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd1-us-west.apache.org (ASF Mail Server at spamd1-us-west.apache.org) with ESMTP id 29F3BC6906
	for <dev@httpd.apache.org>; Mon,  7 Dec 2015 20:44:23 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd1-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 2.891
X-Spam-Level: **
X-Spam-Status: No, score=2.891 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	HTML_MESSAGE=3, MIME_QP_LONG_LINE=0.001, SPF_PASS=-0.001,
	T_RP_MATCHES_RCVD=-0.01, URIBL_BLOCKED=0.001] autolearn=disabled
Authentication-Results: spamd1-us-west.apache.org (amavisd-new);
	dkim=pass (1024-bit key) header.d=greenbytes.de
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd1-us-west.apache.org [10.40.0.7]) (amavisd-new, port 10024)
	with ESMTP id B2sU9o3H8464 for <dev@httpd.apache.org>;
	Mon,  7 Dec 2015 20:44:12 +0000 (UTC)
Received: from mail.greenbytes.de (mail.greenbytes.de [217.91.35.233])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id 7DF6542AA6
	for <dev@httpd.apache.org>; Mon,  7 Dec 2015 20:44:12 +0000 (UTC)
Received: from [192.168.178.61] (unknown [93.211.116.41])
	(using TLSv1 with cipher ECDHE-RSA-AES256-SHA (256/256 bits))
	(Client did not present a certificate)
	by mail.greenbytes.de (Postfix) with ESMTPSA id 163B115A049C
	for <dev@httpd.apache.org>; Mon,  7 Dec 2015 21:39:09 +0100 (CET)
DKIM-Signature: v=1; a=rsa-sha256; c=simple/simple; d=greenbytes.de; s=mail;
	t=1449520750; bh=oNMqWVk4bjfP3OJHTyl7YK05hAN9qdQDwNOhYU4Lpp8=;
	h=From:Subject:Date:References:In-Reply-To:To:From;
	b=VR91rkC19koBoBk4HCQoPC/iAXEOxG3J+X6DN1fAt5icqjdGaf6yEI3A8ckuQM04L
	 LGiGnkAe+OgH4tl7C2T3vg11o2+IMKEkT93bkBSCGGcOE8JtXQ8Okz1bao5CFt4910
	 S4XFMc2j2lIiX7gJMgKX/krGYsvm1Xkb485EAiLE=
From: Stefan Eissing <stefan.eissing@greenbytes.de>
Content-Type: multipart/alternative;
	boundary=Apple-Mail-C7BEDFB4-4251-4A80-B061-992DF4CF7B15
Content-Transfer-Encoding: 7bit
Mime-Version: 1.0 (1.0)
Subject: Re: 2.4 pause - mod_http2 patchset Upgrade h2c vs mod_ssl Upgrade tls
Message-Id: <85F6B23C-D866-4F91-ADAD-507C509192FC@greenbytes.de>
Date: Mon, 7 Dec 2015 21:39:08 +0100
References: <CACsi250=dbRQKnsbE8JSdAZRm5x99gE0sgX3iQ-PHAx77euD1A@mail.gmail.com> <CAGu=u8jn-qYVX2V-EAvcOjnPP3OcGcpThj7YesXxQRCHDUzgaA@mail.gmail.com> <CACsi251zevzsdTUQKmye9bPLRnoc6Tn__GRRavDPgrU-f5L7Ag@mail.gmail.com>
In-Reply-To: <CACsi251zevzsdTUQKmye9bPLRnoc6Tn__GRRavDPgrU-f5L7Ag@mail.gmail.com>
To: dev@httpd.apache.org
X-Mailer: iPhone Mail (13B143)


--Apple-Mail-C7BEDFB4-4251-4A80-B061-992DF4CF7B15
Content-Type: text/plain;
	charset=us-ascii
Content-Transfer-Encoding: quoted-printable

There can be no 100 after a 101. After a 101, the downstream speaks the new p=
rotocol, immediately.=20

> Am 07.12.2015 um 21:29 schrieb William A Rowe Jr <wrowe@rowe-clan.net>:
>=20
>> On Mon, Dec 7, 2015 at 2:15 PM, Jacob Champion <champion.p@gmail.com> wro=
te:
>> On Dec 7, 2015 8:43 AM, "William A Rowe Jr" <wrowe@rowe-clan.net> wrote:
>> >
>> > https://tools.ietf.org/html/rfc7230#section-6.7 makes things more inter=
esting, it calls out that 101-continue and the request body read precedes th=
e 101-switching protocols.  Not sure who decided that would be a good idea, s=
igh...
>>=20
>> 100-continue can't be after the switch; the new protocol may not have any=
 idea what continue semantics are. Similarly, the request body sent is still=
 part of an HTTP/1.1 request and should be processed as such.
>>=20
>> > but mod_ssl TLS upgrade has these reversed for several good reasons inc=
luding the intent to encrypt the request body if present and simple economic=
s of processing.
>>=20
>> Did you mean "decrypt the request body"?
>>=20
> Yes, my bad...=20
>> The client needs to send its request body in plaintext since servers are f=
ree to completely ignore the Upgrade, right? My reading of the specs is that=
 an Upgrade request is still a self-contained HTTP/1.1 request, body include=
d.
>>=20
> No.  If the upgrade is rejected, no 101-switching protocols occurs.  If th=
ere was no Expect: 100-continue then yes, the body seems part of the request=
 headers with no way to anticipate how to proceed except plaintext, but in t=
he case of an Expect: 100-continue, an an interim 101-switching protocols, a=
 tls handshake, followed by a 100-continue seemed entirely reasonable.
>=20
> It appears we did the wrong thing in the absence of an Expect: 100-continu=
e, but as a practical matter this seems fairly academic since RFC7230 codifi=
es a specific sequence that we must adopt, and the instances of request bodi=
es in upgrade requests seems philosophical.
>=20
>=20
>=20
>=20

--Apple-Mail-C7BEDFB4-4251-4A80-B061-992DF4CF7B15
Content-Type: text/html;
	charset=utf-8
Content-Transfer-Encoding: quoted-printable

<html><head><meta http-equiv=3D"content-type" content=3D"text/html; charset=3D=
utf-8"></head><body dir=3D"auto"><div></div><div>There can be no 100 after a=
 101. After a 101, the downstream speaks the new protocol, immediately.&nbsp=
;</div><div><br>Am 07.12.2015 um 21:29 schrieb William A Rowe Jr &lt;<a href=
=3D"mailto:wrowe@rowe-clan.net">wrowe@rowe-clan.net</a>&gt;:<br><br></div><b=
lockquote type=3D"cite"><div><div dir=3D"ltr"><div class=3D"gmail_extra"><di=
v class=3D"gmail_quote">On Mon, Dec 7, 2015 at 2:15 PM, Jacob Champion <span=
 dir=3D"ltr">&lt;<a href=3D"mailto:champion.p@gmail.com" target=3D"_blank">c=
hampion.p@gmail.com</a>&gt;</span> wrote:<br><blockquote class=3D"gmail_quot=
e" style=3D"margin:0 0 0 .8ex;border-left:1px #ccc solid;padding-left:1ex"><=
span class=3D""><p dir=3D"ltr">On Dec 7, 2015 8:43 AM, "William A Rowe Jr" &=
lt;<a href=3D"mailto:wrowe@rowe-clan.net" target=3D"_blank">wrowe@rowe-clan.=
net</a>&gt; wrote:<br>
&gt;<br>
&gt; <a href=3D"https://tools.ietf.org/html/rfc7230#section-6.7" target=3D"_=
blank">https://tools.ietf.org/html/rfc7230#section-6.7</a> makes things more=
 interesting, it calls out that 101-continue and the request body read prece=
des the 101-switching protocols.&nbsp; Not sure who decided that would be a g=
ood idea, sigh...</p>
</span><p dir=3D"ltr">100-continue can't be after the switch; the new protoc=
ol may not have any idea what continue semantics are. Similarly, the request=
 body sent is still part of an HTTP/1.1 request and should be processed as s=
uch.</p><span class=3D"">
<p dir=3D"ltr">&gt; but mod_ssl TLS upgrade has these reversed for several g=
ood reasons including the intent to encrypt the request body if present and s=
imple economics of processing.</p>
</span><p dir=3D"ltr">Did you mean "decrypt the request body"? </p></blockqu=
ote><div>Yes, my bad...&nbsp;</div><blockquote class=3D"gmail_quote" style=3D=
"margin:0 0 0 .8ex;border-left:1px #ccc solid;padding-left:1ex"><p dir=3D"lt=
r">The client needs to send its request body in plaintext since servers are f=
ree to completely ignore the Upgrade, right? My reading of the specs is that=
 an Upgrade request is still a self-contained HTTP/1.1 request, body include=
d.</p></blockquote><div>No.&nbsp; If the upgrade is rejected, no 101-switchi=
ng protocols occurs.&nbsp; If there was no Expect: 100-continue then yes, th=
e body seems part of the request headers with no way to anticipate how to pr=
oceed except plaintext, but in the case of an Expect: 100-continue, an an in=
terim 101-switching protocols, a tls handshake, followed by a 100-continue s=
eemed entirely reasonable.<br></div><div><br></div><div>It appears we did th=
e wrong thing in the absence of an Expect: 100-continue, but as a practical m=
atter this seems fairly academic since RFC7230 codifies a specific sequence t=
hat we must adopt, and the instances of request bodies in upgrade requests s=
eems philosophical.</div><div><br></div><div><br></div><div><br></div><div><=
br></div></div></div></div>
</div></blockquote></body></html>=

--Apple-Mail-C7BEDFB4-4251-4A80-B061-992DF4CF7B15--

From dev-return-84913-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Mon Dec  7 20:55:03 2015
Return-Path: <dev-return-84913-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 979451827C
	for <apmail-httpd-dev-archive@www.apache.org>; Mon,  7 Dec 2015 20:55:03 +0000 (UTC)
Received: (qmail 86792 invoked by uid 500); 7 Dec 2015 20:55:02 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 86708 invoked by uid 500); 7 Dec 2015 20:55:02 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 86698 invoked by uid 99); 7 Dec 2015 20:55:02 -0000
Received: from Unknown (HELO spamd3-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 07 Dec 2015 20:55:02 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd3-us-west.apache.org (ASF Mail Server at spamd3-us-west.apache.org) with ESMTP id 69804180A95
	for <dev@httpd.apache.org>; Mon,  7 Dec 2015 20:55:02 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd3-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 2.347
X-Spam-Level: **
X-Spam-Status: No, score=2.347 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	HTML_MESSAGE=3, MIME_QP_LONG_LINE=0.001, RP_MATCHES_RCVD=-0.554,
	SPF_PASS=-0.001, URIBL_BLOCKED=0.001] autolearn=disabled
Authentication-Results: spamd3-us-west.apache.org (amavisd-new);
	dkim=pass (1024-bit key) header.d=greenbytes.de
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd3-us-west.apache.org [10.40.0.10]) (amavisd-new, port 10024)
	with ESMTP id K8DOn3Powpwm for <dev@httpd.apache.org>;
	Mon,  7 Dec 2015 20:54:48 +0000 (UTC)
Received: from mail.greenbytes.de (mail.greenbytes.de [217.91.35.233])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id 0774924D90
	for <dev@httpd.apache.org>; Mon,  7 Dec 2015 20:54:48 +0000 (UTC)
Received: from [192.168.178.61] (unknown [93.211.116.41])
	(using TLSv1 with cipher ECDHE-RSA-AES256-SHA (256/256 bits))
	(Client did not present a certificate)
	by mail.greenbytes.de (Postfix) with ESMTPSA id 37FD215A044E
	for <dev@httpd.apache.org>; Mon,  7 Dec 2015 21:54:47 +0100 (CET)
DKIM-Signature: v=1; a=rsa-sha256; c=simple/simple; d=greenbytes.de; s=mail;
	t=1449521687; bh=gO6kN7v8VRcJ1+6Nlk0PxwQhPpd6Eo7pE628pRdG8zs=;
	h=From:Subject:Date:References:In-Reply-To:To:From;
	b=WHozoBEdIUG+wPqwyApelZO54eLuCWX07SStjy26MGMQGkS55dc2oyTXlmWoZ4q2M
	 FVOzDHOk03JvgcGLo9Zyg9ktQyEt4njpqepfxN9wAObEm2dD5XNYZBhX2ji02gX2eP
	 pX5VL5vJI31kE6f7lZDdOg+JNVlCHaiWsK1BtAm8=
From: Stefan Eissing <stefan.eissing@greenbytes.de>
Content-Type: multipart/alternative;
	boundary=Apple-Mail-B9B0DC75-5DA5-4152-ADB6-71C07919ECBD
Content-Transfer-Encoding: 7bit
Mime-Version: 1.0 (1.0)
Subject: Re: 2.4 pause - mod_http2 patchset Upgrade h2c vs mod_ssl Upgrade tls
Message-Id: <EB66CCC2-F04C-44C7-ACE1-8D2F1CF91519@greenbytes.de>
Date: Mon, 7 Dec 2015 21:54:46 +0100
References: <CACsi250=dbRQKnsbE8JSdAZRm5x99gE0sgX3iQ-PHAx77euD1A@mail.gmail.com> <CAGu=u8jn-qYVX2V-EAvcOjnPP3OcGcpThj7YesXxQRCHDUzgaA@mail.gmail.com> <CACsi251zevzsdTUQKmye9bPLRnoc6Tn__GRRavDPgrU-f5L7Ag@mail.gmail.com> <85F6B23C-D866-4F91-ADAD-507C509192FC@greenbytes.de>
In-Reply-To: <85F6B23C-D866-4F91-ADAD-507C509192FC@greenbytes.de>
To: dev@httpd.apache.org
X-Mailer: iPhone Mail (13B143)


--Apple-Mail-B9B0DC75-5DA5-4152-ADB6-71C07919ECBD
Content-Type: text/plain;
	charset=us-ascii
Content-Transfer-Encoding: quoted-printable

ok, after some more thinking. if a tls+http/1.1 upgrade together with Expect=
 is indeed a use case, then, to make that work, sending the 101 needs to bec=
ome the task of the switch protocol handler itself. Then the order in which i=
ntermediate responses are sent depends on the switched protocol.=20

When writing the current code, I wanted the common tasks in core. But if tha=
t needs to vary, we need to shift that.=20

> Am 07.12.2015 um 21:39 schrieb Stefan Eissing <stefan.eissing@greenbytes.d=
e>:
>=20
> There can be no 100 after a 101. After a 101, the downstream speaks the ne=
w protocol, immediately.=20
>=20
>> Am 07.12.2015 um 21:29 schrieb William A Rowe Jr <wrowe@rowe-clan.net>:
>>=20
>>> On Mon, Dec 7, 2015 at 2:15 PM, Jacob Champion <champion.p@gmail.com> wr=
ote:
>>> On Dec 7, 2015 8:43 AM, "William A Rowe Jr" <wrowe@rowe-clan.net> wrote:=

>>> >
>>> > https://tools.ietf.org/html/rfc7230#section-6.7 makes things more inte=
resting, it calls out that 101-continue and the request body read precedes t=
he 101-switching protocols.  Not sure who decided that would be a good idea,=
 sigh...
>>>=20
>>> 100-continue can't be after the switch; the new protocol may not have an=
y idea what continue semantics are. Similarly, the request body sent is stil=
l part of an HTTP/1.1 request and should be processed as such.
>>>=20
>>> > but mod_ssl TLS upgrade has these reversed for several good reasons in=
cluding the intent to encrypt the request body if present and simple economi=
cs of processing.
>>>=20
>>> Did you mean "decrypt the request body"?
>>>=20
>> Yes, my bad...=20
>>> The client needs to send its request body in plaintext since servers are=
 free to completely ignore the Upgrade, right? My reading of the specs is th=
at an Upgrade request is still a self-contained HTTP/1.1 request, body inclu=
ded.
>>>=20
>> No.  If the upgrade is rejected, no 101-switching protocols occurs.  If t=
here was no Expect: 100-continue then yes, the body seems part of the reques=
t headers with no way to anticipate how to proceed except plaintext, but in t=
he case of an Expect: 100-continue, an an interim 101-switching protocols, a=
 tls handshake, followed by a 100-continue seemed entirely reasonable.
>>=20
>> It appears we did the wrong thing in the absence of an Expect: 100-contin=
ue, but as a practical matter this seems fairly academic since RFC7230 codif=
ies a specific sequence that we must adopt, and the instances of request bod=
ies in upgrade requests seems philosophical.
>>=20
>>=20
>>=20
>>=20

--Apple-Mail-B9B0DC75-5DA5-4152-ADB6-71C07919ECBD
Content-Type: text/html;
	charset=utf-8
Content-Transfer-Encoding: quoted-printable

<html><head><meta http-equiv=3D"content-type" content=3D"text/html; charset=3D=
utf-8"></head><body dir=3D"auto"><div></div><div>ok, after some more thinkin=
g. if a tls+http/1.1 upgrade together with Expect is indeed a use case, then=
, to make that work, sending the 101 needs to become the task of the switch p=
rotocol handler itself. Then the order in which intermediate responses are s=
ent depends on the switched protocol.&nbsp;</div><div><br></div><div>When wr=
iting the current code, I wanted the common tasks in core. But if that needs=
 to vary, we need to shift that.&nbsp;</div><div><br>Am 07.12.2015 um 21:39 s=
chrieb Stefan Eissing &lt;<a href=3D"mailto:stefan.eissing@greenbytes.de">st=
efan.eissing@greenbytes.de</a>&gt;:<br><br></div><blockquote type=3D"cite"><=
div><meta http-equiv=3D"content-type" content=3D"text/html; charset=3Dutf-8"=
><div></div><div>There can be no 100 after a 101. After a 101, the downstrea=
m speaks the new protocol, immediately.&nbsp;</div><div><br>Am 07.12.2015 um=
 21:29 schrieb William A Rowe Jr &lt;<a href=3D"mailto:wrowe@rowe-clan.net">=
wrowe@rowe-clan.net</a>&gt;:<br><br></div><blockquote type=3D"cite"><div><di=
v dir=3D"ltr"><div class=3D"gmail_extra"><div class=3D"gmail_quote">On Mon, D=
ec 7, 2015 at 2:15 PM, Jacob Champion <span dir=3D"ltr">&lt;<a href=3D"mailt=
o:champion.p@gmail.com" target=3D"_blank">champion.p@gmail.com</a>&gt;</span=
> wrote:<br><blockquote class=3D"gmail_quote" style=3D"margin:0 0 0 .8ex;bor=
der-left:1px #ccc solid;padding-left:1ex"><span class=3D""><p dir=3D"ltr">On=
 Dec 7, 2015 8:43 AM, "William A Rowe Jr" &lt;<a href=3D"mailto:wrowe@rowe-c=
lan.net" target=3D"_blank">wrowe@rowe-clan.net</a>&gt; wrote:<br>
&gt;<br>
&gt; <a href=3D"https://tools.ietf.org/html/rfc7230#section-6.7" target=3D"_=
blank">https://tools.ietf.org/html/rfc7230#section-6.7</a> makes things more=
 interesting, it calls out that 101-continue and the request body read prece=
des the 101-switching protocols.&nbsp; Not sure who decided that would be a g=
ood idea, sigh...</p>
</span><p dir=3D"ltr">100-continue can't be after the switch; the new protoc=
ol may not have any idea what continue semantics are. Similarly, the request=
 body sent is still part of an HTTP/1.1 request and should be processed as s=
uch.</p><span class=3D"">
<p dir=3D"ltr">&gt; but mod_ssl TLS upgrade has these reversed for several g=
ood reasons including the intent to encrypt the request body if present and s=
imple economics of processing.</p>
</span><p dir=3D"ltr">Did you mean "decrypt the request body"? </p></blockqu=
ote><div>Yes, my bad...&nbsp;</div><blockquote class=3D"gmail_quote" style=3D=
"margin:0 0 0 .8ex;border-left:1px #ccc solid;padding-left:1ex"><p dir=3D"lt=
r">The client needs to send its request body in plaintext since servers are f=
ree to completely ignore the Upgrade, right? My reading of the specs is that=
 an Upgrade request is still a self-contained HTTP/1.1 request, body include=
d.</p></blockquote><div>No.&nbsp; If the upgrade is rejected, no 101-switchi=
ng protocols occurs.&nbsp; If there was no Expect: 100-continue then yes, th=
e body seems part of the request headers with no way to anticipate how to pr=
oceed except plaintext, but in the case of an Expect: 100-continue, an an in=
terim 101-switching protocols, a tls handshake, followed by a 100-continue s=
eemed entirely reasonable.<br></div><div><br></div><div>It appears we did th=
e wrong thing in the absence of an Expect: 100-continue, but as a practical m=
atter this seems fairly academic since RFC7230 codifies a specific sequence t=
hat we must adopt, and the instances of request bodies in upgrade requests s=
eems philosophical.</div><div><br></div><div><br></div><div><br></div><div><=
br></div></div></div></div>
</div></blockquote></div></blockquote></body></html>=

--Apple-Mail-B9B0DC75-5DA5-4152-ADB6-71C07919ECBD--

From dev-return-84914-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Mon Dec  7 21:04:15 2015
Return-Path: <dev-return-84914-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 29C8E182E8
	for <apmail-httpd-dev-archive@www.apache.org>; Mon,  7 Dec 2015 21:04:15 +0000 (UTC)
Received: (qmail 8460 invoked by uid 500); 7 Dec 2015 21:04:14 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 8381 invoked by uid 500); 7 Dec 2015 21:04:14 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 8371 invoked by uid 99); 7 Dec 2015 21:04:14 -0000
Received: from Unknown (HELO spamd3-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 07 Dec 2015 21:04:14 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd3-us-west.apache.org (ASF Mail Server at spamd3-us-west.apache.org) with ESMTP id E98DB18022F
	for <dev@httpd.apache.org>; Mon,  7 Dec 2015 21:04:13 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd3-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 2.88
X-Spam-Level: **
X-Spam-Status: No, score=2.88 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	HTML_MESSAGE=3, RCVD_IN_MSPIKE_H3=-0.01, RCVD_IN_MSPIKE_WL=-0.01,
	SPF_PASS=-0.001, URIBL_BLOCKED=0.001] autolearn=disabled
Authentication-Results: spamd3-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd3-us-west.apache.org [10.40.0.10]) (amavisd-new, port 10024)
	with ESMTP id G6bLPm1iRAa7 for <dev@httpd.apache.org>;
	Mon,  7 Dec 2015 21:04:09 +0000 (UTC)
Received: from mail-wm0-f41.google.com (mail-wm0-f41.google.com [74.125.82.41])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id AD92524D90
	for <dev@httpd.apache.org>; Mon,  7 Dec 2015 21:04:08 +0000 (UTC)
Received: by wmec201 with SMTP id c201so184500796wme.0
        for <dev@httpd.apache.org>; Mon, 07 Dec 2015 12:58:53 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        bh=PSdglJcaHL5usjzKuBhL/Ww6qTgCacTleMy+hQbwNDk=;
        b=zP+pl149B9EVO4IiXmP1pSSvkpkVjlgiI8+bY7DF4Q7U325vhSyv15Cdfa9nDFyksq
         CoX/5CshSdPArjVRS/n+EoopQu3uMG0gA42WpA9rQTFx9bxh06erw8Xw14IbwIQSSjQI
         MPayJKLqxmcn6Y1gnTa4y+FBpo4Smr3n+VOK+TS1GYqSw+8l089Tl0ZvvZOpHeLfpW6i
         QBsB9tsiTGmi89AiSZUGQ0dVEqJzzTKwA6+zV4lb+j2wuVdI5wXsogXTeVK6d12F7vdn
         eM9+pgbxcQ6jKTFbSvRSXNnnPj3KCK5GnAf0voajr+7kqs5vR7MgDUpbYF7qQXCR4ObQ
         Nk0g==
MIME-Version: 1.0
X-Received: by 10.28.85.129 with SMTP id j123mr433513wmb.77.1449521933280;
 Mon, 07 Dec 2015 12:58:53 -0800 (PST)
Received: by 10.28.111.80 with HTTP; Mon, 7 Dec 2015 12:58:53 -0800 (PST)
Received: by 10.28.111.80 with HTTP; Mon, 7 Dec 2015 12:58:53 -0800 (PST)
In-Reply-To: <85F6B23C-D866-4F91-ADAD-507C509192FC@greenbytes.de>
References: <CACsi250=dbRQKnsbE8JSdAZRm5x99gE0sgX3iQ-PHAx77euD1A@mail.gmail.com>
	<CAGu=u8jn-qYVX2V-EAvcOjnPP3OcGcpThj7YesXxQRCHDUzgaA@mail.gmail.com>
	<CACsi251zevzsdTUQKmye9bPLRnoc6Tn__GRRavDPgrU-f5L7Ag@mail.gmail.com>
	<85F6B23C-D866-4F91-ADAD-507C509192FC@greenbytes.de>
Date: Mon, 7 Dec 2015 12:58:53 -0800
Message-ID: <CAGu=u8hTqixikAxf5JOY=mgJgnGQ7QrLOVf2uWs0eqAjH9rNzA@mail.gmail.com>
Subject: Re: 2.4 pause - mod_http2 patchset Upgrade h2c vs mod_ssl Upgrade tls
From: Jacob Champion <champion.p@gmail.com>
To: dev@httpd.apache.org
Content-Type: multipart/alternative; boundary=001a11412058ed6dac0526551fe9

--001a11412058ed6dac0526551fe9
Content-Type: text/plain; charset=UTF-8

On Dec 7, 2015 12:44 PM, "Stefan Eissing" <stefan.eissing@greenbytes.de>
wrote:
>
> There can be no 100 after a 101. After a 101, the downstream speaks the
new protocol, immediately.

I suspect Bill is talking about the very specific case of an upgrade to
HTTP/1.1-over-TLS, in which case I think his proposed "101/100 handshake"
logic could work. IMO, that's too specific a use case to work well with the
rest of the standard, but like he said, it's completely academic now that
723x clarifies the required order.

--Jacob

--001a11412058ed6dac0526551fe9
Content-Type: text/html; charset=UTF-8
Content-Transfer-Encoding: quoted-printable

<p dir=3D"ltr">On Dec 7, 2015 12:44 PM, &quot;Stefan Eissing&quot; &lt;<a h=
ref=3D"mailto:stefan.eissing@greenbytes.de">stefan.eissing@greenbytes.de</a=
>&gt; wrote:<br>
&gt;<br>
&gt; There can be no 100 after a 101. After a 101, the downstream speaks th=
e new protocol, immediately.=C2=A0</p>
<p dir=3D"ltr">I suspect Bill is talking about the very specific case of an=
 upgrade to HTTP/1.1-over-TLS, in which case I think his proposed &quot;101=
/100 handshake&quot; logic could work. IMO, that&#39;s too specific a use c=
ase to work well with the rest of the standard, but like he said, it&#39;s =
completely academic now that 723x clarifies the required order.</p>
<p dir=3D"ltr">--Jacob</p>

--001a11412058ed6dac0526551fe9--

From dev-return-84915-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Mon Dec  7 22:10:57 2015
Return-Path: <dev-return-84915-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id BA200187FD
	for <apmail-httpd-dev-archive@www.apache.org>; Mon,  7 Dec 2015 22:10:57 +0000 (UTC)
Received: (qmail 29379 invoked by uid 500); 7 Dec 2015 22:10:56 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 29284 invoked by uid 500); 7 Dec 2015 22:10:56 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 29274 invoked by uid 99); 7 Dec 2015 22:10:56 -0000
Received: from Unknown (HELO spamd3-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 07 Dec 2015 22:10:56 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd3-us-west.apache.org (ASF Mail Server at spamd3-us-west.apache.org) with ESMTP id 06599180A95
	for <dev@httpd.apache.org>; Mon,  7 Dec 2015 22:10:56 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd3-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.121
X-Spam-Level:
X-Spam-Status: No, score=-0.121 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RCVD_IN_MSPIKE_H3=-0.01, RCVD_IN_MSPIKE_WL=-0.01, SPF_PASS=-0.001]
	autolearn=disabled
Authentication-Results: spamd3-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd3-us-west.apache.org [10.40.0.10]) (amavisd-new, port 10024)
	with ESMTP id 027j6hK8SRpd for <dev@httpd.apache.org>;
	Mon,  7 Dec 2015 22:10:55 +0000 (UTC)
Received: from mail-pa0-f46.google.com (mail-pa0-f46.google.com [209.85.220.46])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id 785C720E9B
	for <dev@httpd.apache.org>; Mon,  7 Dec 2015 22:10:54 +0000 (UTC)
Received: by pacwq6 with SMTP id wq6so596518pac.1
        for <dev@httpd.apache.org>; Mon, 07 Dec 2015 14:10:46 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=subject:to:references:from:message-id:date:user-agent:mime-version
         :in-reply-to:content-type:content-transfer-encoding;
        bh=doah3nV5gRCzezUBKm50MXSE9OPMcVqRfhZVtjMXOgo=;
        b=gjPhwRrlTsP721x41sX1+RJ2BwmR83BthRhpf+HvWs4lolwvdra24/1+USGHF9Oxrg
         nE3jtHhKoc3RFNqRW6sM6U+Ab9kN5U7HMwbMNoDy20UFm0M8lxDx/7hamFghpFtIr2Q8
         uCXlWR1xIeU3WFhl4ajOos4X5ohEVWh5IHbSQz3s/UGBuuATvjZawVSYwa3CrdfV2CFE
         2I7BtFH4Z1R8T0TIiWXULkhNMVfmnL7RxxrnjZM8BwrWChmpGgT2dvnHAG1imdfUlyqZ
         5YNKMDVqOPtxXiHszwvifwmPRK5keN5e38jYremj19Ao1vsUbdKm9VxJfv+v0QJo543m
         lPYQ==
X-Received: by 10.66.222.101 with SMTP id ql5mr144383pac.144.1449526246678;
        Mon, 07 Dec 2015 14:10:46 -0800 (PST)
Received: from [192.168.1.4] (50-39-117-165.bvtn.or.frontiernet.net. [50.39.117.165])
        by smtp.gmail.com with ESMTPSA id ud10sm79757pab.27.2015.12.07.14.10.45
        for <dev@httpd.apache.org>
        (version=TLSv1/SSLv3 cipher=OTHER);
        Mon, 07 Dec 2015 14:10:45 -0800 (PST)
Subject: Re: 2.4 pause - mod_http2 patchset Upgrade h2c vs mod_ssl Upgrade tls
To: dev@httpd.apache.org
References: <CACsi250=dbRQKnsbE8JSdAZRm5x99gE0sgX3iQ-PHAx77euD1A@mail.gmail.com>
 <CACsi2534prBtp7ENNNiEDevA3Z7u9uW2uuYMOa8-OoOsPSHNGQ@mail.gmail.com>
 <6C1FCB84-22AF-49D5-AA10-BFB922A98390@greenbytes.de>
 <CAGu=u8h9XxW0NSeMDSwaujO1G=sRn67TFah_FyGqNnBaWhHpLw@mail.gmail.com>
From: Jacob Champion <champion.p@gmail.com>
Message-ID: <566603E5.8030004@gmail.com>
Date: Mon, 7 Dec 2015 14:10:45 -0800
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:38.0) Gecko/20100101
 Thunderbird/38.4.0
MIME-Version: 1.0
In-Reply-To: <CAGu=u8h9XxW0NSeMDSwaujO1G=sRn67TFah_FyGqNnBaWhHpLw@mail.gmail.com>
Content-Type: text/plain; charset=utf-8; format=flowed
Content-Transfer-Encoding: 7bit

On 12/07/2015 11:55 AM, Jacob Champion wrote:
>  > - moving things to post read sounds tempting, however I'm not sure if
> we want to upgrade on non-authed request or not, for example. I am not
> sure what else we do in post read, maybe someone else has an opinion
> about that. It certainly looks nicer in the OPTIONS * case.
>
> WebSocket upgrades rely on authn headers and cookies; there is no (good)
> way after a connection has been established to say "well, I upgraded you
> but now I'm closing the connection because you weren't authorized." The
> check needs to be done before sending 101 (and otherwise a 401/403/4xx
> needs to be sent instead of the upgrade).

D'oh. My WebSocket rambling has nothing to do with anything you said -- 
I only just realized you were both talking about mod_ssl's hook 
implementations, not the general order of the hooks in the new Upgrade 
architecture...

Sorry for the noise.

--Jacob

From dev-return-84916-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Mon Dec  7 22:12:27 2015
Return-Path: <dev-return-84916-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 5474218816
	for <apmail-httpd-dev-archive@www.apache.org>; Mon,  7 Dec 2015 22:12:27 +0000 (UTC)
Received: (qmail 36466 invoked by uid 500); 7 Dec 2015 22:12:26 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 36402 invoked by uid 500); 7 Dec 2015 22:12:26 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 36392 invoked by uid 99); 7 Dec 2015 22:12:26 -0000
Received: from Unknown (HELO spamd4-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 07 Dec 2015 22:12:26 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd4-us-west.apache.org (ASF Mail Server at spamd4-us-west.apache.org) with ESMTP id 34EB9C0FFC
	for <dev@httpd.apache.org>; Mon,  7 Dec 2015 22:12:26 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd4-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 3
X-Spam-Level: ***
X-Spam-Status: No, score=3 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, HTML_MESSAGE=3,
	SPF_PASS=-0.001, URIBL_BLOCKED=0.001] autolearn=disabled
Authentication-Results: spamd4-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=rowe-clan-net.20150623.gappssmtp.com
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd4-us-west.apache.org [10.40.0.11]) (amavisd-new, port 10024)
	with ESMTP id 9tjwIcPRiz5m for <dev@httpd.apache.org>;
	Mon,  7 Dec 2015 22:12:15 +0000 (UTC)
Received: from mail-ig0-f178.google.com (mail-ig0-f178.google.com [209.85.213.178])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id 1F08042AD9
	for <dev@httpd.apache.org>; Mon,  7 Dec 2015 22:12:15 +0000 (UTC)
Received: by igbxm8 with SMTP id xm8so3774128igb.1
        for <dev@httpd.apache.org>; Mon, 07 Dec 2015 14:12:14 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=rowe-clan-net.20150623.gappssmtp.com; s=20150623;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        bh=X3dYkdAoWMk73ilA0YG/jJ0N54WDhdGtpQiIMCiB0QA=;
        b=msagao2g6S9YakW/VEV/kvxemkXSMxspg/Y5Jx04AnKeV4a/uCVffMsxnjDEXs0BTG
         Ghj+44jxPGF+wKTJfbhWN0S67sN5YWgH4V7zOqTA0VfgoGNN2M2KhDFRNh5glSMJmWVh
         TncwN6ENkcSPgF/s1oAx2BZeiRnfqsLhQ41Elc4SBuds9FiZrzP6K0CktdXPumAqLc58
         y8BcgsWIJjX9E0grvhyOFMDL2wq7Z44e9O5AD4fxXlFwpyAioF6OxI3lASFAJ4xvXorY
         6OsGzoM1FRCqAGw1DPWmyWe9RB1ObiglKl3IiPYB30Gepn+9yUqjhQkB7Qp6It4Gpp3T
         cb5w==
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=1e100.net; s=20130820;
        h=x-gm-message-state:mime-version:in-reply-to:references:date
         :message-id:subject:from:to:content-type;
        bh=X3dYkdAoWMk73ilA0YG/jJ0N54WDhdGtpQiIMCiB0QA=;
        b=DA0P6J3N7cJupxJbBzj3MostUf6JBbVHyfkkv3pIbryGpd839I4Ceb5dIo5YavnfhK
         4xlh7d038XnkOcb6bnZn/+8mPa2uU62FzUqmZOpmT5pFLseyxImi/UD9ONKmfbT9FijS
         h1Rl+4M1xS+aXqCt5KCv7pzslRIYuMazY/13hBiR9XzOopIjHyMHOK3vb4VZ8+BCmNvT
         Z3eXG3fQb/HDspcb9drzUni5eNJuPW3hQcYu+NFNfoLbDOUr3qBkaGKsCwnWkG/z9ABh
         LF7jPcW5gVTlrgWAArGEHWdCwlxAPStJvR8qlHgee7OD0eCiLuRTfaB3v6ioJ2S79AH6
         xk2g==
X-Gm-Message-State: ALoCoQmutejdva3IrAqwp1s7igIb1ZSeEUxPLrEEaqDJN1Rl6pzivWv6ySoMJDE6i883QkdHG1V3xphediSW+IRGoW050nksyuao6l20YHFTvrVtbAy29uU=
MIME-Version: 1.0
X-Received: by 10.50.142.7 with SMTP id rs7mr19422526igb.35.1449526334563;
 Mon, 07 Dec 2015 14:12:14 -0800 (PST)
Received: by 10.107.62.136 with HTTP; Mon, 7 Dec 2015 14:12:14 -0800 (PST)
In-Reply-To: <85F6B23C-D866-4F91-ADAD-507C509192FC@greenbytes.de>
References: <CACsi250=dbRQKnsbE8JSdAZRm5x99gE0sgX3iQ-PHAx77euD1A@mail.gmail.com>
	<CAGu=u8jn-qYVX2V-EAvcOjnPP3OcGcpThj7YesXxQRCHDUzgaA@mail.gmail.com>
	<CACsi251zevzsdTUQKmye9bPLRnoc6Tn__GRRavDPgrU-f5L7Ag@mail.gmail.com>
	<85F6B23C-D866-4F91-ADAD-507C509192FC@greenbytes.de>
Date: Mon, 7 Dec 2015 16:12:14 -0600
Message-ID: <CACsi251EgSnYcXq9J8+wcY+n22GpCqvJ-zW83FdZR3GF+L3f+w@mail.gmail.com>
Subject: Re: 2.4 pause - mod_http2 patchset Upgrade h2c vs mod_ssl Upgrade tls
From: William A Rowe Jr <wrowe@rowe-clan.net>
To: httpd <dev@httpd.apache.org>
Content-Type: multipart/alternative; boundary=001a11c2eb5a43c2d5052656260b

--001a11c2eb5a43c2d5052656260b
Content-Type: text/plain; charset=UTF-8

On Mon, Dec 7, 2015 at 2:39 PM, Stefan Eissing <stefan.eissing@greenbytes.de
> wrote:

> There can be no 100 after a 101. After a 101, the downstream speaks the
> new protocol, immediately.
>

Right, and the new protocol is TLS/1.x HTTP/1.1 in the mod_ssl case.  What's
so confusing?



> Am 07.12.2015 um 21:29 schrieb William A Rowe Jr <wrowe@rowe-clan.net>:
>
> On Mon, Dec 7, 2015 at 2:15 PM, Jacob Champion <champion.p@gmail.com>
> wrote:
>
>> On Dec 7, 2015 8:43 AM, "William A Rowe Jr" <wrowe@rowe-clan.net> wrote:
>> >
>> > https://tools.ietf.org/html/rfc7230#section-6.7 makes things more
>> interesting, it calls out that 101-continue and the request body read
>> precedes the 101-switching protocols.  Not sure who decided that would be a
>> good idea, sigh...
>>
>> 100-continue can't be after the switch; the new protocol may not have any
>> idea what continue semantics are. Similarly, the request body sent is still
>> part of an HTTP/1.1 request and should be processed as such.
>>
>> > but mod_ssl TLS upgrade has these reversed for several good reasons
>> including the intent to encrypt the request body if present and simple
>> economics of processing.
>>
>> Did you mean "decrypt the request body"?
>>
> Yes, my bad...
>
>> The client needs to send its request body in plaintext since servers are
>> free to completely ignore the Upgrade, right? My reading of the specs is
>> that an Upgrade request is still a self-contained HTTP/1.1 request, body
>> included.
>>
> No.  If the upgrade is rejected, no 101-switching protocols occurs.  If
> there was no Expect: 100-continue then yes, the body seems part of the
> request headers with no way to anticipate how to proceed except plaintext,
> but in the case of an Expect: 100-continue, an an interim 101-switching
> protocols, a tls handshake, followed by a 100-continue seemed entirely
> reasonable.
>
> It appears we did the wrong thing in the absence of an Expect:
> 100-continue, but as a practical matter this seems fairly academic since
> RFC7230 codifies a specific sequence that we must adopt, and the instances
> of request bodies in upgrade requests seems philosophical.
>
>
>
>
>

--001a11c2eb5a43c2d5052656260b
Content-Type: text/html; charset=UTF-8
Content-Transfer-Encoding: quoted-printable

<div dir=3D"ltr"><div class=3D"gmail_extra"><div class=3D"gmail_quote">On M=
on, Dec 7, 2015 at 2:39 PM, Stefan Eissing <span dir=3D"ltr">&lt;<a href=3D=
"mailto:stefan.eissing@greenbytes.de" target=3D"_blank">stefan.eissing@gree=
nbytes.de</a>&gt;</span> wrote:<br><blockquote class=3D"gmail_quote" style=
=3D"margin:0 0 0 .8ex;border-left:1px #ccc solid;padding-left:1ex"><div dir=
=3D"auto"><div></div><div>There can be no 100 after a 101. After a 101, the=
 downstream speaks the new protocol, immediately.=C2=A0</div></div></blockq=
uote><div><br></div><div>Right, and the new protocol is TLS/1.x HTTP/1.1 in=
 the mod_ssl case.=C2=A0 What&#39;s</div><div>so confusing?</div><div><br><=
/div><div>=C2=A0</div><blockquote class=3D"gmail_quote" style=3D"margin:0 0=
 0 .8ex;border-left:1px #ccc solid;padding-left:1ex"><div dir=3D"auto"><div=
><div class=3D"h5"><div>Am 07.12.2015 um 21:29 schrieb William A Rowe Jr &l=
t;<a href=3D"mailto:wrowe@rowe-clan.net" target=3D"_blank">wrowe@rowe-clan.=
net</a>&gt;:<br><br></div><blockquote type=3D"cite"><div><div dir=3D"ltr"><=
div class=3D"gmail_extra"><div class=3D"gmail_quote">On Mon, Dec 7, 2015 at=
 2:15 PM, Jacob Champion <span dir=3D"ltr">&lt;<a href=3D"mailto:champion.p=
@gmail.com" target=3D"_blank">champion.p@gmail.com</a>&gt;</span> wrote:<br=
><blockquote class=3D"gmail_quote" style=3D"margin:0 0 0 .8ex;border-left:1=
px #ccc solid;padding-left:1ex"><span><p dir=3D"ltr">On Dec 7, 2015 8:43 AM=
, &quot;William A Rowe Jr&quot; &lt;<a href=3D"mailto:wrowe@rowe-clan.net" =
target=3D"_blank">wrowe@rowe-clan.net</a>&gt; wrote:<br>
&gt;<br>
&gt; <a href=3D"https://tools.ietf.org/html/rfc7230#section-6.7" target=3D"=
_blank">https://tools.ietf.org/html/rfc7230#section-6.7</a> makes things mo=
re interesting, it calls out that 101-continue and the request body read pr=
ecedes the 101-switching protocols.=C2=A0 Not sure who decided that would b=
e a good idea, sigh...</p>
</span><p dir=3D"ltr">100-continue can&#39;t be after the switch; the new p=
rotocol may not have any idea what continue semantics are. Similarly, the r=
equest body sent is still part of an HTTP/1.1 request and should be process=
ed as such.</p><span>
<p dir=3D"ltr">&gt; but mod_ssl TLS upgrade has these reversed for several =
good reasons including the intent to encrypt the request body if present an=
d simple economics of processing.</p>
</span><p dir=3D"ltr">Did you mean &quot;decrypt the request body&quot;? </=
p></blockquote><div>Yes, my bad...=C2=A0</div><blockquote class=3D"gmail_qu=
ote" style=3D"margin:0 0 0 .8ex;border-left:1px #ccc solid;padding-left:1ex=
"><p dir=3D"ltr">The client needs to send its request body in plaintext sin=
ce servers are free to completely ignore the Upgrade, right? My reading of =
the specs is that an Upgrade request is still a self-contained HTTP/1.1 req=
uest, body included.</p></blockquote><div>No.=C2=A0 If the upgrade is rejec=
ted, no 101-switching protocols occurs.=C2=A0 If there was no Expect: 100-c=
ontinue then yes, the body seems part of the request headers with no way to=
 anticipate how to proceed except plaintext, but in the case of an Expect: =
100-continue, an an interim 101-switching protocols, a tls handshake, follo=
wed by a 100-continue seemed entirely reasonable.<br></div><div><br></div><=
div>It appears we did the wrong thing in the absence of an Expect: 100-cont=
inue, but as a practical matter this seems fairly academic since RFC7230 co=
difies a specific sequence that we must adopt, and the instances of request=
 bodies in upgrade requests seems philosophical.</div><div><br></div><div><=
br></div><div><br></div><div><br></div></div></div></div>
</div></blockquote></div></div></div></blockquote></div><br></div></div>

--001a11c2eb5a43c2d5052656260b--

From dev-return-84917-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Mon Dec  7 22:20:02 2015
Return-Path: <dev-return-84917-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id A484518883
	for <apmail-httpd-dev-archive@www.apache.org>; Mon,  7 Dec 2015 22:20:02 +0000 (UTC)
Received: (qmail 67781 invoked by uid 500); 7 Dec 2015 22:20:02 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 67714 invoked by uid 500); 7 Dec 2015 22:20:02 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 67703 invoked by uid 99); 7 Dec 2015 22:20:02 -0000
Received: from Unknown (HELO spamd1-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 07 Dec 2015 22:20:02 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd1-us-west.apache.org (ASF Mail Server at spamd1-us-west.apache.org) with ESMTP id 8E35BC9305
	for <dev@httpd.apache.org>; Mon,  7 Dec 2015 22:20:01 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd1-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 3
X-Spam-Level: ***
X-Spam-Status: No, score=3 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, HTML_MESSAGE=3,
	SPF_PASS=-0.001, URIBL_BLOCKED=0.001] autolearn=disabled
Authentication-Results: spamd1-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=rowe-clan-net.20150623.gappssmtp.com
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd1-us-west.apache.org [10.40.0.7]) (amavisd-new, port 10024)
	with ESMTP id CxWvROa5A3-L for <dev@httpd.apache.org>;
	Mon,  7 Dec 2015 22:19:47 +0000 (UTC)
Received: from mail-io0-f181.google.com (mail-io0-f181.google.com [209.85.223.181])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id 405FE24DBD
	for <dev@httpd.apache.org>; Mon,  7 Dec 2015 22:19:47 +0000 (UTC)
Received: by iofh3 with SMTP id h3so5316306iof.3
        for <dev@httpd.apache.org>; Mon, 07 Dec 2015 14:14:46 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=rowe-clan-net.20150623.gappssmtp.com; s=20150623;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        bh=yzXEOMOzcEOU7DFORw7/VjyvWODzu7KRypQ6L0Ws4sM=;
        b=TPCxHON//NbIn7pJDwJy2a/upHC8NTE8R2QkTamE1n1IjvbXxLHGF6+t1caFpu3TEy
         vI+/RcsQU2inU+epFkHJ7gjcAQJBzueEwsIaB0vRJvwf0T4q9xXDqiFnNtw33/oUFiPH
         D+voZ4R7rofk5mKVZXZwool6tUyZ9N0CFDolrUXpH6mPMgLHCmQ9WwyRz8OpbSKNaUbF
         yP0V2q4aJh8Z+yHUQCNeTJGCCbnC7d/F060zpW4GKjgxGdtG+lvjRmdk3I1rhSX6a7hQ
         m3iTjAA8Ddao3ATb5u+1QO014/jt9ri0Etn2jhOsJvT5g+h7qUrbu0VuYW/RewQmnnXg
         csDQ==
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=1e100.net; s=20130820;
        h=x-gm-message-state:mime-version:in-reply-to:references:date
         :message-id:subject:from:to:content-type;
        bh=yzXEOMOzcEOU7DFORw7/VjyvWODzu7KRypQ6L0Ws4sM=;
        b=Cd0sHGRyXECJ+vAxNAVVNfl0bpTstPBQIqIvTHMi4BNkWxfaeJ5pLwXmkxMD/kViAt
         Al7yKgoqP1BEiSt3BNGwFPndCeKFgIwuNze+OclgBrzcCzWKArjlYYEVaRRQRGnCFxCB
         Iri6JP2uwuvOMMS4vIM/uxWWtIfYnVzI7h0eOHRjImPXHuijcl9QQoAajdENt8L2Sue+
         m0DrekiOgicdU69Un/5issHmC7znqyKduegmRKrMU2RQrJDiqIF7Bo2veSFoQIqgGIig
         6SZ4JDZALjIaJnbnXcNFKxHUuqqrD0HDCaGGWnD5S39Ee1V4VA+hc7NlpD9jbnLBxybb
         xi+Q==
X-Gm-Message-State: ALoCoQk5EfNr373vb1VvjKWY5rEOBtV2SuT1hAwDqR+y69rTbCb+qg9TQQXBWsOT8Tw0ejeomJsS8R4eXlAzqKLcuHVB8ystT6nFk0OTw9MygumLFyqWk/4=
MIME-Version: 1.0
X-Received: by 10.107.34.199 with SMTP id i190mr738895ioi.150.1449526485966;
 Mon, 07 Dec 2015 14:14:45 -0800 (PST)
Received: by 10.107.62.136 with HTTP; Mon, 7 Dec 2015 14:14:45 -0800 (PST)
In-Reply-To: <CACsi251EgSnYcXq9J8+wcY+n22GpCqvJ-zW83FdZR3GF+L3f+w@mail.gmail.com>
References: <CACsi250=dbRQKnsbE8JSdAZRm5x99gE0sgX3iQ-PHAx77euD1A@mail.gmail.com>
	<CAGu=u8jn-qYVX2V-EAvcOjnPP3OcGcpThj7YesXxQRCHDUzgaA@mail.gmail.com>
	<CACsi251zevzsdTUQKmye9bPLRnoc6Tn__GRRavDPgrU-f5L7Ag@mail.gmail.com>
	<85F6B23C-D866-4F91-ADAD-507C509192FC@greenbytes.de>
	<CACsi251EgSnYcXq9J8+wcY+n22GpCqvJ-zW83FdZR3GF+L3f+w@mail.gmail.com>
Date: Mon, 7 Dec 2015 16:14:45 -0600
Message-ID: <CACsi252v9KO4rmLC161-Cz2fFZWGkqE-VEbZ5AhhoNnjTNL=JQ@mail.gmail.com>
Subject: Re: 2.4 pause - mod_http2 patchset Upgrade h2c vs mod_ssl Upgrade tls
From: William A Rowe Jr <wrowe@rowe-clan.net>
To: httpd <dev@httpd.apache.org>
Content-Type: multipart/alternative; boundary=001a1140d9444a11270526562f5e

--001a1140d9444a11270526562f5e
Content-Type: text/plain; charset=UTF-8

On Mon, Dec 7, 2015 at 4:12 PM, William A Rowe Jr <wrowe@rowe-clan.net>
wrote:

> On Mon, Dec 7, 2015 at 2:39 PM, Stefan Eissing <
> stefan.eissing@greenbytes.de> wrote:
>
>> There can be no 100 after a 101. After a 101, the downstream speaks the
>> new protocol, immediately.
>>
>
> Right, and the new protocol is TLS/1.x HTTP/1.1 in the mod_ssl case.
> What's
> so confusing?
>

And in that case, define 'immediately' :)  That's where the RFC2817
ambiguity came in, 100 before/after 101, which was then resolved
by RFC7230 as noted earlier (but not in the manner one at least
I might have hoped for).

--001a1140d9444a11270526562f5e
Content-Type: text/html; charset=UTF-8
Content-Transfer-Encoding: quoted-printable

<div dir=3D"ltr"><div class=3D"gmail_extra"><div class=3D"gmail_quote">On M=
on, Dec 7, 2015 at 4:12 PM, William A Rowe Jr <span dir=3D"ltr">&lt;<a href=
=3D"mailto:wrowe@rowe-clan.net" target=3D"_blank">wrowe@rowe-clan.net</a>&g=
t;</span> wrote:<br><blockquote class=3D"gmail_quote" style=3D"margin:0 0 0=
 .8ex;border-left:1px #ccc solid;padding-left:1ex"><div dir=3D"ltr"><div cl=
ass=3D"gmail_extra"><div class=3D"gmail_quote"><span class=3D"">On Mon, Dec=
 7, 2015 at 2:39 PM, Stefan Eissing <span dir=3D"ltr">&lt;<a href=3D"mailto=
:stefan.eissing@greenbytes.de" target=3D"_blank">stefan.eissing@greenbytes.=
de</a>&gt;</span> wrote:<br><blockquote class=3D"gmail_quote" style=3D"marg=
in:0 0 0 .8ex;border-left:1px #ccc solid;padding-left:1ex"><div dir=3D"auto=
"><div></div><div>There can be no 100 after a 101. After a 101, the downstr=
eam speaks the new protocol, immediately.=C2=A0</div></div></blockquote><di=
v><br></div></span><div>Right, and the new protocol is TLS/1.x HTTP/1.1 in =
the mod_ssl case.=C2=A0 What&#39;s</div><div>so confusing?</div><span class=
=3D""><div></div></span></div></div></div></blockquote></div><br></div><div=
 class=3D"gmail_extra">And in that case, define &#39;immediately&#39; :) =
=C2=A0That&#39;s where the RFC2817</div><div class=3D"gmail_extra">ambiguit=
y came in, 100 before/after 101, which was then resolved</div><div class=3D=
"gmail_extra">by RFC7230 as noted earlier (but not in the manner one at lea=
st</div><div class=3D"gmail_extra">I might have hoped for).</div><div class=
=3D"gmail_extra"><br></div><div class=3D"gmail_extra"><br></div></div>

--001a1140d9444a11270526562f5e--

From dev-return-84918-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Mon Dec  7 22:31:15 2015
Return-Path: <dev-return-84918-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id C49911891D
	for <apmail-httpd-dev-archive@www.apache.org>; Mon,  7 Dec 2015 22:31:15 +0000 (UTC)
Received: (qmail 6671 invoked by uid 500); 7 Dec 2015 22:30:59 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 6602 invoked by uid 500); 7 Dec 2015 22:30:59 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 6591 invoked by uid 99); 7 Dec 2015 22:30:59 -0000
Received: from Unknown (HELO spamd2-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 07 Dec 2015 22:30:59 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd2-us-west.apache.org (ASF Mail Server at spamd2-us-west.apache.org) with ESMTP id 05AED1A09B4
	for <dev@httpd.apache.org>; Mon,  7 Dec 2015 22:30:59 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd2-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 2.9
X-Spam-Level: **
X-Spam-Status: No, score=2.9 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	HTML_MESSAGE=3, SPF_PASS=-0.001, URIBL_BLOCKED=0.001]
	autolearn=disabled
Authentication-Results: spamd2-us-west.apache.org (amavisd-new);
	dkim=pass (1024-bit key) header.d=qqmail.nl
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd2-us-west.apache.org [10.40.0.9]) (amavisd-new, port 10024)
	with ESMTP id eh--O3yW3GmD for <dev@httpd.apache.org>;
	Mon,  7 Dec 2015 22:30:47 +0000 (UTC)
Received: from mail-wm0-f53.google.com (mail-wm0-f53.google.com [74.125.82.53])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id E275C203A3
	for <dev@httpd.apache.org>; Mon,  7 Dec 2015 22:30:46 +0000 (UTC)
Received: by wmec201 with SMTP id c201so6530730wme.1
        for <dev@httpd.apache.org>; Mon, 07 Dec 2015 14:30:46 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=qqmail.nl; s=google;
        h=message-id:mime-version:to:from:subject:date:importance:in-reply-to
         :references:content-type;
        bh=2oxK7rxYYgIuH86cNT9ck0bJC8/FuqpCzIphNOBhiQY=;
        b=POLhx2SNZK1VuSCI9wZgOVM9izMaBjV1ma1WjVsGGn7GS2SSMLPalBN+qXifP++DXq
         Q/WquHX5x3YwbLpw2L4mf1++hSmrUUgQIpcmUYosyEoYLv4zMq8nxSEBsTQeNlR2HUj8
         D9T2/y69h4INXCakRDpEDTsB7atp4C9RawW1Y=
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=1e100.net; s=20130820;
        h=x-gm-message-state:message-id:mime-version:to:from:subject:date
         :importance:in-reply-to:references:content-type;
        bh=2oxK7rxYYgIuH86cNT9ck0bJC8/FuqpCzIphNOBhiQY=;
        b=evXIVq9ur9LL9hdNYuZc4y/mYh1XL6OgkSRRASZCQIsyT8LsZRNR7aftfpNIW9uIJx
         qV+zopHFbt9jm6GwqjxBHhWURgssemKK9SQ0zMJsLJkpTNHLFctIE2mlPZrXG/KyuVeB
         OpIebfml8wdVNwFHqnt4OAGN/vLanZmlraZNZNg4xSNoND8LxKkiMgB4G8B/ALs5ekVF
         NqZ5qgCN3/Oiod3FBTRPrKxfe2TSc4F/X3f459SybbAICrUDKI0ln0KYhuVRfakzjxyB
         hkSrtrIq9CvERqnOif5mH91gtOICjCAVQnaTDKDcDUkNdlYL/Xg4yLlgSv6WnXXfj4iC
         TqlQ==
X-Gm-Message-State: ALoCoQl6twaSfZ/dMMy+jbKx46U6DTQOn3nLMjuNTyGGeibFLyT9j4A/I9xnOCrMl8A4vju2a+1CNyNLj0RV8bO8yUEDmCYZ2A==
X-Received: by 10.194.117.68 with SMTP id kc4mr140266wjb.77.1449527446601;
        Mon, 07 Dec 2015 14:30:46 -0800 (PST)
Received: from ?IPv6:2001:610:66e:0:c233:5eff:fe29:3cff? ([2001:610:66e:0:c233:5eff:fe29:3cff])
        by smtp.gmail.com with ESMTPSA id l7sm172271wjx.14.2015.12.07.14.30.45
        (version=TLSv1/SSLv3 cipher=OTHER);
        Mon, 07 Dec 2015 14:30:46 -0800 (PST)
Message-ID: <56660896.c74fc20a.15f56.0ebd@mx.google.com>
MIME-Version: 1.0
To: Stefan Eissing <stefan.eissing@greenbytes.de>, 
	"dev@httpd.apache.org" <dev@httpd.apache.org>
From: Bert Huijben <bert@qqmail.nl>
Subject: RE: AW: 2.4 pause - mod_http2 patchset Upgrade h2c vs mod_ssl
 Upgradetls
Date: Mon, 7 Dec 2015 23:30:48 +0100
Importance: normal
X-Priority: 3
In-Reply-To: <F7B20D30-D34A-4805-A77D-F64F6428F6E3@greenbytes.de>
References:
 <CACsi250=dbRQKnsbE8JSdAZRm5x99gE0sgX3iQ-PHAx77euD1A@mail.gmail.com>
 <AB1691BE05AE7F4992697F2A0835627AC63BAB94@VOEXM10W.internal.vodafone.com>
 <F7B20D30-D34A-4805-A77D-F64F6428F6E3@greenbytes.de>
Content-Type: multipart/alternative;
	boundary="_69A22ED6-5C5F-4251-86BE-9624975C14B0_"

--_69A22ED6-5C5F-4251-86BE-9624975C14B0_
Content-Transfer-Encoding: quoted-printable
Content-Type: text/plain; charset="utf-8"

Is this a h2 limitation or a mod_h2 limitation?

If I would like h2c upgrade from Subversion without an additional request I=
 would have to send the upgrade request with a very short OPTIONS request t=
hat has a body.

The way I read the spec that should be possible if both sides go through al=
l those rough edge cases to support a request in one protocol and the respo=
nse in the other. For serf I intended to implement that, but I=E2=80=99m no=
t sure if it is worth the trouble if httpd doesn=E2=80=99t implement it.

Bert

Sent from Mail for Windows 10



From: Stefan Eissing
Sent: maandag 7 december 2015 20:11
To: dev@httpd.apache.org
Subject: Re: AW: 2.4 pause - mod_http2 patchset Upgrade h2c vs mod_ssl Upgr=
adetls


h2 does not propose a switch if the request has a body.=C2=A0

As clarified on the http wg lists by the gurus there, =C2=A0when i asked, t=
he upgraded connection is in a mixed state after a 101. Any byte sent by th=
e server MUST be from the switched protocol, while the client needs to send=
 the body in HTTP/1 format and can only talk the new proto afterwards.=C2=
=A0

For an Expect 100 that would mean that the 100 intermediate comes before th=
e 101. However that is untested with h2 as we do not propose a switch when =
a body is there.

Am 07.12.2015 um 19:50 schrieb Pl=C3=BCm, R=C3=BCdiger, Vodafone Group <rue=
diger.pluem@vodafone.com>:
=C2=A0
=C2=A0
Von: William A Rowe Jr [mailto:wrowe@rowe-clan.net]=20
Gesendet: Montag, 7. Dezember 2015 17:39
An: httpd <dev@httpd.apache.org>
Betreff: Re: 2.4 pause - mod_http2 patchset Upgrade h2c vs mod_ssl Upgrade =
tls
=C2=A0
https://tools.ietf.org/html/rfc7230#section-6.7 makes things more interesti=
ng, it calls out that 101-continue and the request body read precedes the 1=
01-switching protocols.=C2=A0 Not sure who decided that would be a good ide=
a, sigh... but mod_ssl TLS upgrade has these reversed for several good reas=
ons including the intent to encrypt the request body if present and simple =
economics of processing.
I think that handling upgrade advertisement and alerting must be in post re=
ad req, bypassing all request hooks until the 101-continue is presented, an=
y small request body read and set aside for the http input brigade, and 101=
-switching protocols is presented.=C2=A0 This allows the request to still b=
e processed for tls-style upgrades, or discarded for relevant protocols.
How do we handle this today if the client just sends a request body and not=
 an Expect header? Do we set it already aside before answering with a 101?
Regards
R=C3=BCdiger



--_69A22ED6-5C5F-4251-86BE-9624975C14B0_
Content-Transfer-Encoding: quoted-printable
Content-Type: text/html; charset="utf-8"

<html xmlns:o=3D"urn:schemas-microsoft-com:office:office" xmlns:w=3D"urn:sc=
hemas-microsoft-com:office:word" xmlns:m=3D"http://schemas.microsoft.com/of=
fice/2004/12/omml" xmlns=3D"http://www.w3.org/TR/REC-html40"><head><meta ht=
tp-equiv=3DContent-Type content=3D"text/html; charset=3Dutf-8"><meta name=
=3DGenerator content=3D"Microsoft Word 15 (filtered medium)"><style><!--
/* Font Definitions */
@font-face
	{font-family:"Cambria Math";
	panose-1:2 4 5 3 5 4 6 3 2 4;}
@font-face
	{font-family:Calibri;
	panose-1:2 15 5 2 2 2 4 3 2 4;}
/* Style Definitions */
p.MsoNormal, li.MsoNormal, div.MsoNormal
	{margin:0cm;
	margin-bottom:.0001pt;
	font-size:11.0pt;
	font-family:"Calibri",sans-serif;}
a:link, span.MsoHyperlink
	{mso-style-priority:99;
	color:blue;
	text-decoration:underline;}
a:visited, span.MsoHyperlinkFollowed
	{mso-style-priority:99;
	color:#954F72;
	text-decoration:underline;}
p
	{mso-style-priority:99;
	margin:0cm;
	margin-bottom:.0001pt;
	font-size:11.0pt;
	font-family:"Times New Roman",serif;}
.MsoChpDefault
	{mso-style-type:export-only;}
@page WordSection1
	{size:612.0pt 792.0pt;
	margin:72.0pt 72.0pt 72.0pt 72.0pt;}
div.WordSection1
	{page:WordSection1;}
--></style></head><body lang=3DNL link=3Dblue vlink=3D"#954F72"><div class=
=3DWordSection1><p class=3DMsoNormal><span lang=3DEN-US>Is this a h2 limita=
tion or a mod_h2 limitation?</span></p><p class=3DMsoNormal><o:p>&nbsp;</o:=
p></p><p class=3DMsoNormal><span lang=3DEN-US>If I would like h2c upgrade f=
rom Subversion without an additional request I would have to send the upgra=
de request with a very short OPTIONS request that has a body.<o:p></o:p></s=
pan></p><p class=3DMsoNormal><span lang=3DEN-US><o:p>&nbsp;</o:p></span></p=
><p class=3DMsoNormal><span lang=3DEN-US>The way I read the spec that shoul=
d be possible if both sides go through all those rough edge cases to suppor=
t a request in one protocol and the response in the other. For serf I inten=
ded to implement that, but I=E2=80=99m not sure if it is worth the trouble =
if httpd doesn=E2=80=99t implement it.<o:p></o:p></span></p><p class=3DMsoN=
ormal><span lang=3DEN-US><o:p>&nbsp;</o:p></span></p><p class=3DMsoNormal><=
span lang=3DEN-US>Bert</span><o:p></o:p></p><p class=3DMsoNormal><o:p>&nbsp=
;</o:p></p><p class=3DMsoNormal>Sent from <a href=3D"http://go.microsoft.co=
m/fwlink/?LinkId=3D550986">Mail</a> for Windows 10</p><p><o:p>&nbsp;</o:p><=
/p><p><o:p>&nbsp;</o:p></p><div style=3D'mso-element:para-border-div;border=
:none;border-top:solid #E1E1E1 1.0pt;padding:3.0pt 0cm 0cm 0cm'><p class=3D=
MsoNormal style=3D'mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;borde=
r:none;padding:0cm'><br><b>From: </b>Stefan Eissing<br><b>Sent: </b>maandag=
 7 december 2015 20:11<br><b>To: </b>dev@httpd.apache.org<br><b>Subject: </=
b>Re: AW: 2.4 pause - mod_http2 patchset Upgrade h2c vs mod_ssl Upgradetls<=
/p></div><p class=3DMsoNormal><o:p>&nbsp;</o:p></p><p class=3DMsoNormal><sp=
an style=3D'font-size:12.0pt;font-family:"Times New Roman",serif'><o:p>&nbs=
p;</o:p></span></p><p class=3DMsoNormal><span style=3D'font-size:12.0pt;fon=
t-family:"Times New Roman",serif'>h2 does not propose a switch if the reque=
st has a body.&nbsp;</span><span style=3D'font-size:12.0pt;font-family:"Tim=
es New Roman",serif'><o:p></o:p></span></p><div><p class=3DMsoNormal><span =
style=3D'font-size:12.0pt;font-family:"Times New Roman",serif'><o:p>&nbsp;<=
/o:p></span></p></div><div><p class=3DMsoNormal><span style=3D'font-size:12=
.0pt;font-family:"Times New Roman",serif'>As clarified on the http wg lists=
 by the gurus there, &nbsp;when i asked, the upgraded connection is in a mi=
xed state after a 101. Any byte sent by the server MUST be from the switche=
d protocol, while the client needs to send the body in HTTP/1 format and ca=
n only talk the new proto afterwards.&nbsp;<o:p></o:p></span></p></div><div=
><p class=3DMsoNormal><span style=3D'font-size:12.0pt;font-family:"Times Ne=
w Roman",serif'><o:p>&nbsp;</o:p></span></p></div><div><p class=3DMsoNormal=
><span style=3D'font-size:12.0pt;font-family:"Times New Roman",serif'>For a=
n Expect 100 that would mean that the 100 intermediate comes before the 101=
. However that is untested with h2 as we do not propose a switch when a bod=
y is there.<o:p></o:p></span></p></div><div><p class=3DMsoNormal style=3D'm=
argin-bottom:12.0pt'><span style=3D'font-size:12.0pt;font-family:"Times New=
 Roman",serif'><br>Am 07.12.2015 um 19:50 schrieb Pl=C3=BCm, R=C3=BCdiger, =
Vodafone Group &lt;<a href=3D"mailto:ruediger.pluem@vodafone.com">ruediger.=
pluem@vodafone.com</a>&gt;:<o:p></o:p></span></p></div><blockquote style=3D=
'margin-top:5.0pt;margin-bottom:5.0pt'><div><p class=3DMsoNormal><span styl=
e=3D'color:#00B050'>&nbsp;</span><span style=3D'font-family:"Times New Roma=
n",serif'><o:p></o:p></span></p><p class=3DMsoNormal><span style=3D'color:#=
00B050'>&nbsp;</span></p><div style=3D'border:none;border-left:solid blue 1=
.5pt;padding:0cm 0cm 0cm 4.0pt'><div><div style=3D'border:none;border-top:s=
olid #E1E1E1 1.0pt;padding:3.0pt 0cm 0cm 0cm'><p class=3DMsoNormal><b>Von:<=
/b> William A Rowe Jr [<a href=3D"mailto:wrowe@rowe-clan.net">mailto:wrowe@=
rowe-clan.net</a>] <br><b>Gesendet:</b> Montag, 7. Dezember 2015 17:39<br><=
b>An:</b> httpd &lt;<a href=3D"mailto:dev@httpd.apache.org">dev@httpd.apach=
e.org</a>&gt;<br><b>Betreff:</b> Re: 2.4 pause - mod_http2 patchset Upgrade=
 h2c vs mod_ssl Upgrade tls<o:p></o:p></p></div></div><p class=3DMsoNormal>=
&nbsp;</p><div><p><a href=3D"https://tools.ietf.org/html/rfc7230#section-6.=
7" target=3D"_blank"><span lang=3DEN-US>https://tools.ietf.org/html/rfc7230=
#section-6.7</span></a><span lang=3DEN-US> makes things more interesting, i=
t calls out that 101-continue and the request body read precedes the 101-sw=
itching protocols.&nbsp; </span>Not sure who decided that would be a good i=
dea, sigh... but mod_ssl TLS upgrade has these reversed for several good re=
asons including the intent to encrypt the request body if present and simpl=
e economics of processing.</p><p>I think that handling upgrade advertisemen=
t and alerting must be in post read req, bypassing all request hooks until =
the 101-continue is presented, any small request body read and set aside fo=
r the http input brigade, and 101-switching protocols is presented.&nbsp; T=
his allows the request to still be processed for tls-style upgrades, or dis=
carded for relevant protocols.</p><p><span lang=3DEN-US style=3D'font-famil=
y:"Calibri",sans-serif;color:#00B050'>How do we handle this today if the cl=
ient just sends a request body and not an Expect header? Do we set it alrea=
dy aside before answering with a 101?</span></p><p><span lang=3DEN-US style=
=3D'font-family:"Calibri",sans-serif;color:#00B050'>Regards</span></p></div=
></div></div></blockquote><p style=3D'mso-margin-top-alt:0cm;margin-right:3=
6.0pt;margin-bottom:0cm;margin-left:36.0pt;margin-bottom:.0001pt'><span lan=
g=3DEN-US style=3D'font-family:"Calibri",sans-serif;color:#00B050'>R=C3=BCd=
iger</span></p><p class=3DMsoNormal><span style=3D'font-size:12.0pt'><o:p>&=
nbsp;</o:p></span></p><p class=3DMsoNormal><span style=3D'font-size:12.0pt;=
font-family:"Times New Roman",serif'><o:p>&nbsp;</o:p></span></p></div></bo=
dy></html>=

--_69A22ED6-5C5F-4251-86BE-9624975C14B0_--


From dev-return-84919-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Mon Dec  7 22:40:58 2015
Return-Path: <dev-return-84919-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id D61F218989
	for <apmail-httpd-dev-archive@www.apache.org>; Mon,  7 Dec 2015 22:40:58 +0000 (UTC)
Received: (qmail 28755 invoked by uid 500); 7 Dec 2015 22:40:58 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 28677 invoked by uid 500); 7 Dec 2015 22:40:58 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 28667 invoked by uid 99); 7 Dec 2015 22:40:57 -0000
Received: from Unknown (HELO spamd1-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 07 Dec 2015 22:40:57 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd1-us-west.apache.org (ASF Mail Server at spamd1-us-west.apache.org) with ESMTP id 88058C57C7
	for <dev@httpd.apache.org>; Mon,  7 Dec 2015 22:40:57 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd1-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 2.998
X-Spam-Level: **
X-Spam-Status: No, score=2.998 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, HTML_MESSAGE=3,
	RCVD_IN_MSPIKE_H2=-0.001, SPF_PASS=-0.001] autolearn=disabled
Authentication-Results: spamd1-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=rowe-clan-net.20150623.gappssmtp.com
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd1-us-west.apache.org [10.40.0.7]) (amavisd-new, port 10024)
	with ESMTP id iFzIdcJgm1QH for <dev@httpd.apache.org>;
	Mon,  7 Dec 2015 22:40:56 +0000 (UTC)
Received: from mail-io0-f172.google.com (mail-io0-f172.google.com [209.85.223.172])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id D1E68428DC
	for <dev@httpd.apache.org>; Mon,  7 Dec 2015 22:40:55 +0000 (UTC)
Received: by ioc74 with SMTP id 74so5974446ioc.2
        for <dev@httpd.apache.org>; Mon, 07 Dec 2015 14:40:55 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=rowe-clan-net.20150623.gappssmtp.com; s=20150623;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        bh=12Jx2ayOvwQKIadtx+46LoZ2kYX7Jd71p+kpkrCokrI=;
        b=PO6csGsC2DzOXh7c6cL5AAszNKO2Jh3AiT17/bq0gJabuWw3dtgivbC5UdhbGKEQWT
         6Ym968QLuWlxH5kxiqukMO5tO2NBNRS9dTP4a+lqEe0I/K3mSRP+JsJtykIK36OC9aBh
         WcMsMYOb8j9dbtrNw66r5U1fYb/7KfDeizvO83G3BxlVg0BCBHZ/kPzJM10Rfr/BacH3
         LJN6Mu+QnLkzQz6VDo+6VXT8kMyLvLQ712lQakkwCnZt3wQ+4YEaBR2EgGkOb2BYMus5
         lzJL+A4HrIwPj0AIL009LZ0AZIPLJTGjBa7D9O+oUWTqW7O1s6tb/x5vlX3PJiDRhG12
         Xv3A==
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=1e100.net; s=20130820;
        h=x-gm-message-state:mime-version:in-reply-to:references:date
         :message-id:subject:from:to:content-type;
        bh=12Jx2ayOvwQKIadtx+46LoZ2kYX7Jd71p+kpkrCokrI=;
        b=lHfsMR3VsbjmCBrfAc1a7pfU8JZgUwVvkuhEkimeGbOjwZMA0n2ezmsAlesnSqvb1V
         3D94JIE4pTwBaYpaxShxbpvLN4TAgkxK6zS9xarhH5XwUARiKqN/ga3jjiRRbqqdbvCK
         Ry3GB13nrekuv9Fsi7VoodNwexkTjeHwsEjbAr5TudbqTNQCY/HftX3ebYO2B8KpUOgg
         itNgdU24HoMWwNu8M0vqsNptrsUcwzkxEdVFbifN+C2Lo6KsPHvH/joGNGjjfnYJezSY
         WZwlUHpLcsQydzjwOq8SVI6kMfk63/oL9PqoFve42Lnisuo44ioLw7+aoeWWYmvcBASC
         w80A==
X-Gm-Message-State: ALoCoQk6yycD8oWMTEXm2PMFyBDs1eBswMjTZ1f0n+laY7xSnm43vl8nx05Q/YBXyEDiDipVR4kz6MJQusOlgPVHMP3pE5s9JUtKwXV4qHyrQbjJIAj64V0=
MIME-Version: 1.0
X-Received: by 10.107.10.66 with SMTP id u63mr768687ioi.86.1449528055431; Mon,
 07 Dec 2015 14:40:55 -0800 (PST)
Received: by 10.107.62.136 with HTTP; Mon, 7 Dec 2015 14:40:55 -0800 (PST)
In-Reply-To: <566603E5.8030004@gmail.com>
References: <CACsi250=dbRQKnsbE8JSdAZRm5x99gE0sgX3iQ-PHAx77euD1A@mail.gmail.com>
	<CACsi2534prBtp7ENNNiEDevA3Z7u9uW2uuYMOa8-OoOsPSHNGQ@mail.gmail.com>
	<6C1FCB84-22AF-49D5-AA10-BFB922A98390@greenbytes.de>
	<CAGu=u8h9XxW0NSeMDSwaujO1G=sRn67TFah_FyGqNnBaWhHpLw@mail.gmail.com>
	<566603E5.8030004@gmail.com>
Date: Mon, 7 Dec 2015 16:40:55 -0600
Message-ID: <CACsi252sKCj6jmwhCRt7rGmu6K9aOd0oHAQ1nOoDvqZq5kjz8g@mail.gmail.com>
Subject: Re: 2.4 pause - mod_http2 patchset Upgrade h2c vs mod_ssl Upgrade tls
From: William A Rowe Jr <wrowe@rowe-clan.net>
To: httpd <dev@httpd.apache.org>
Content-Type: multipart/alternative; boundary=001a113f93bed61e8c0526568c57

--001a113f93bed61e8c0526568c57
Content-Type: text/plain; charset=UTF-8

On Mon, Dec 7, 2015 at 4:10 PM, Jacob Champion <champion.p@gmail.com> wrote:

> On 12/07/2015 11:55 AM, Jacob Champion wrote:
>
>>  > - moving things to post read sounds tempting, however I'm not sure if
>> we want to upgrade on non-authed request or not, for example. I am not
>> sure what else we do in post read, maybe someone else has an opinion
>> about that. It certainly looks nicer in the OPTIONS * case.
>>
>> WebSocket upgrades rely on authn headers and cookies; there is no (good)
>> way after a connection has been established to say "well, I upgraded you
>> but now I'm closing the connection because you weren't authorized." The
>> check needs to be done before sending 101 (and otherwise a 401/403/4xx
>> needs to be sent instead of the upgrade).
>>
>
> D'oh. My WebSocket rambling has nothing to do with anything you said -- I
> only just realized you were both talking about mod_ssl's hook
> implementations, not the general order of the hooks in the new Upgrade
> architecture...
>
> Sorry for the noise.


Not "noise" at all... I'm imagining a mod_echo protocol example that
looks much like your use case...

1st call to core_upgrade_request in post_read_req hook, after setenvif
and mod_headers processing... tls is ready, echo (or websocket) would
not be ready.  Those ready indicate via ap_select_protocol hook response.

... normal pre-handler request preparation and auth ...

2nd call to core_upgrade_request in ap_invoke_handler hook, after all
of these other preparations but excluding filter configuration (filters may
differ for the new protocol), tls was handled earlier, echo (or websocket)
are now ready, based on auth results.  Those ready again indicate
via ap_select_protocol hook response.

WDYT?

--001a113f93bed61e8c0526568c57
Content-Type: text/html; charset=UTF-8
Content-Transfer-Encoding: quoted-printable

<div dir=3D"ltr"><div class=3D"gmail_extra"><div class=3D"gmail_quote">On M=
on, Dec 7, 2015 at 4:10 PM, Jacob Champion <span dir=3D"ltr">&lt;<a href=3D=
"mailto:champion.p@gmail.com" target=3D"_blank">champion.p@gmail.com</a>&gt=
;</span> wrote:<br><blockquote class=3D"gmail_quote" style=3D"margin:0px 0p=
x 0px 0.8ex;border-left-width:1px;border-left-color:rgb(204,204,204);border=
-left-style:solid;padding-left:1ex"><span class=3D"">On 12/07/2015 11:55 AM=
, Jacob Champion wrote:<br>
<blockquote class=3D"gmail_quote" style=3D"margin:0px 0px 0px 0.8ex;border-=
left-width:1px;border-left-color:rgb(204,204,204);border-left-style:solid;p=
adding-left:1ex">
=C2=A0&gt; - moving things to post read sounds tempting, however I&#39;m no=
t sure if<br>
we want to upgrade on non-authed request or not, for example. I am not<br>
sure what else we do in post read, maybe someone else has an opinion<br>
about that. It certainly looks nicer in the OPTIONS * case.<br>
<br>
WebSocket upgrades rely on authn headers and cookies; there is no (good)<br=
>
way after a connection has been established to say &quot;well, I upgraded y=
ou<br>
but now I&#39;m closing the connection because you weren&#39;t authorized.&=
quot; The<br>
check needs to be done before sending 101 (and otherwise a 401/403/4xx<br>
needs to be sent instead of the upgrade).<br>
</blockquote>
<br></span>
D&#39;oh. My WebSocket rambling has nothing to do with anything you said --=
 I only just realized you were both talking about mod_ssl&#39;s hook implem=
entations, not the general order of the hooks in the new Upgrade architectu=
re...<br>
<br>
Sorry for the noise.</blockquote><div><br></div><div>Not &quot;noise&quot; =
at all... I&#39;m imagining a mod_echo protocol example that=C2=A0</div><di=
v>looks much like your use case...=C2=A0</div><div><br></div><div>1st call =
to=C2=A0core_upgrade_request in post_read_req hook, after setenvif</div><di=
v>and mod_headers processing... tls is ready, echo (or websocket) would</di=
v><div>not be ready.=C2=A0 Those ready indicate via=C2=A0ap_select_protocol=
 hook response.</div><div><br></div><div>... normal pre-handler request pre=
paration and auth ...</div><div><br></div><div><div>2nd call to=C2=A0core_u=
pgrade_request in ap_invoke_handler hook, after all</div><div>of these othe=
r preparations but excluding filter configuration (filters may</div><div>di=
ffer for the new protocol), tls was handled earlier, echo (or websocket)=C2=
=A0</div><div>are now ready, based on auth results.=C2=A0 Those ready again=
 indicate=C2=A0</div><div>via=C2=A0ap_select_protocol hook response.</div><=
div><br></div></div><div>WDYT?</div><div><br></div></div></div><div class=
=3D"gmail_extra"><br></div><div class=3D"gmail_extra"><br></div></div>

--001a113f93bed61e8c0526568c57--

From dev-return-84920-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Mon Dec  7 22:47:25 2015
Return-Path: <dev-return-84920-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 83257189CE
	for <apmail-httpd-dev-archive@www.apache.org>; Mon,  7 Dec 2015 22:47:25 +0000 (UTC)
Received: (qmail 49363 invoked by uid 500); 7 Dec 2015 22:47:21 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 49291 invoked by uid 500); 7 Dec 2015 22:47:21 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 49281 invoked by uid 99); 7 Dec 2015 22:47:21 -0000
Received: from Unknown (HELO spamd3-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 07 Dec 2015 22:47:21 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd3-us-west.apache.org (ASF Mail Server at spamd3-us-west.apache.org) with ESMTP id 5ADAA180A95
	for <dev@httpd.apache.org>; Mon,  7 Dec 2015 22:47:21 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd3-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.121
X-Spam-Level:
X-Spam-Status: No, score=-0.121 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RCVD_IN_MSPIKE_H3=-0.01, RCVD_IN_MSPIKE_WL=-0.01, SPF_PASS=-0.001]
	autolearn=disabled
Authentication-Results: spamd3-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd3-us-west.apache.org [10.40.0.10]) (amavisd-new, port 10024)
	with ESMTP id ICqMxD-mf3HQ for <dev@httpd.apache.org>;
	Mon,  7 Dec 2015 22:47:20 +0000 (UTC)
Received: from mail-pa0-f46.google.com (mail-pa0-f46.google.com [209.85.220.46])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id 8173D42BA9
	for <dev@httpd.apache.org>; Mon,  7 Dec 2015 22:47:20 +0000 (UTC)
Received: by pacdm15 with SMTP id dm15so907544pac.3
        for <dev@httpd.apache.org>; Mon, 07 Dec 2015 14:42:13 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=subject:to:references:from:message-id:date:user-agent:mime-version
         :in-reply-to:content-type:content-transfer-encoding;
        bh=M48PhvixkwflfRUoZL97hp0VJJXjUJUvaJ2fpdqqzpE=;
        b=GG1HVZ8dW0cVjuNqsnsfE/esqLjYg6RrHXzNGfZtkT8xZpnvtCAit/NCQg/MdcSEKG
         FHhbkn/ZWGaCHy6NxuQ41RmysuAymYnQD/1naKHMkRxLm43EshHSMRXZXSRRSxI0yoJr
         z7p44udoI/z0vTNlVUh/Cko1F3M31MxKzk8pmJ7pBXGVTmmpfiFfjbTy35UT09EuylBS
         71onft0+Kznzuq8M1yYFCnwwCEVi495O8ykS/VKyR48JdYWrYP0ix/NcXTaT69Zaolsu
         P8T8U3sUUV1LdUPb4Lvu0rzrePY297ApInPZ7eJJcVi75bCcV8YfoCeemC0L3eounj1J
         4L+g==
X-Received: by 10.66.254.161 with SMTP id aj1mr305336pad.31.1449528133019;
        Mon, 07 Dec 2015 14:42:13 -0800 (PST)
Received: from [192.168.1.4] (50-39-117-165.bvtn.or.frontiernet.net. [50.39.117.165])
        by smtp.gmail.com with ESMTPSA id s15sm158478pfs.31.2015.12.07.14.42.11
        for <dev@httpd.apache.org>
        (version=TLSv1/SSLv3 cipher=OTHER);
        Mon, 07 Dec 2015 14:42:12 -0800 (PST)
Subject: Re: AW: 2.4 pause - mod_http2 patchset Upgrade h2c vs mod_ssl
 Upgradetls
To: dev@httpd.apache.org
References: <CACsi250=dbRQKnsbE8JSdAZRm5x99gE0sgX3iQ-PHAx77euD1A@mail.gmail.com>
 <AB1691BE05AE7F4992697F2A0835627AC63BAB94@VOEXM10W.internal.vodafone.com>
 <F7B20D30-D34A-4805-A77D-F64F6428F6E3@greenbytes.de>
 <56660896.c74fc20a.15f56.0ebd@mx.google.com>
From: Jacob Champion <champion.p@gmail.com>
Message-ID: <56660B43.2060507@gmail.com>
Date: Mon, 7 Dec 2015 14:42:11 -0800
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:38.0) Gecko/20100101
 Thunderbird/38.4.0
MIME-Version: 1.0
In-Reply-To: <56660896.c74fc20a.15f56.0ebd@mx.google.com>
Content-Type: text/plain; charset=utf-8; format=flowed
Content-Transfer-Encoding: 7bit

On 12/07/2015 02:30 PM, Bert Huijben wrote:
> Is this a h2 limitation or a mod_h2 limitation?
>
> If I would like h2c upgrade from Subversion without an additional
> request I would have to send the upgrade request with a very short
> OPTIONS request that has a body.

The HTTP/2 spec (RFC 7540, sec 3.2) appears to allow the sending of a 
request body in an h2c upgrade (h2 upgrades are prohibited). So it would 
appear to be a mod_http2 limitation for now.

Hopefully Stefan can confirm tomorrow (it's pretty late in Germany).

--Jacob

From dev-return-84921-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Mon Dec  7 23:26:40 2015
Return-Path: <dev-return-84921-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 5F20118B26
	for <apmail-httpd-dev-archive@www.apache.org>; Mon,  7 Dec 2015 23:26:40 +0000 (UTC)
Received: (qmail 7949 invoked by uid 500); 7 Dec 2015 23:26:39 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 7871 invoked by uid 500); 7 Dec 2015 23:26:39 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 7861 invoked by uid 99); 7 Dec 2015 23:26:39 -0000
Received: from Unknown (HELO spamd2-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 07 Dec 2015 23:26:39 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd2-us-west.apache.org (ASF Mail Server at spamd2-us-west.apache.org) with ESMTP id 0D0611A0C2E
	for <dev@httpd.apache.org>; Mon,  7 Dec 2015 23:26:39 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd2-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.102
X-Spam-Level:
X-Spam-Status: No, score=-0.102 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RCVD_IN_MSPIKE_H2=-0.001, SPF_PASS=-0.001] autolearn=disabled
Authentication-Results: spamd2-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd2-us-west.apache.org [10.40.0.9]) (amavisd-new, port 10024)
	with ESMTP id i3Lk7p0HubU1 for <dev@httpd.apache.org>;
	Mon,  7 Dec 2015 23:26:37 +0000 (UTC)
Received: from mail-pf0-f172.google.com (mail-pf0-f172.google.com [209.85.192.172])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id 4854E42B4B
	for <dev@httpd.apache.org>; Mon,  7 Dec 2015 23:26:37 +0000 (UTC)
Received: by pfu207 with SMTP id 207so1420162pfu.2
        for <dev@httpd.apache.org>; Mon, 07 Dec 2015 15:21:30 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=subject:to:references:from:message-id:date:user-agent:mime-version
         :in-reply-to:content-type:content-transfer-encoding;
        bh=EGVgZt9ifZ5BNoT0o1WoVs+IRW+J0c3R/H1pBNyzQQo=;
        b=i1VUfT5XJQlqJYotvuishoNEQ40Dwo93w9HUqd0fQ+hog9sTqZ1Bs4k0J3N3uuvyy8
         o6W8DmMYfsnTqXUWPK/1uY8S8/LpQIaPcDDhEbNhBxrrKO88kb9dUx8+vYCzGVzeiyKn
         3VwcVjllMFQc/mcGlzZiVLsPV5ayHOcMPCY7jc9bWYcpgPp97CY0qeg9/T70UDHj8xIk
         piLcxLWfUXV925iIvyoKCe1fvaqUZLXYXQghHcg1Ytw6eNv6eKj7OXE7rm5x+TAIPBh9
         6dtes/1u+D0YdDysBilSRzVej0ExzDylS2ruhKRdbst+BQqFAVuSQ4Shn+luntAN4GQ5
         Wfcw==
X-Received: by 10.98.86.10 with SMTP id k10mr514325pfb.85.1449530490304;
        Mon, 07 Dec 2015 15:21:30 -0800 (PST)
Received: from [192.168.1.4] (50-39-117-165.bvtn.or.frontiernet.net. [50.39.117.165])
        by smtp.gmail.com with ESMTPSA id h10sm270758pat.7.2015.12.07.15.21.29
        for <dev@httpd.apache.org>
        (version=TLSv1/SSLv3 cipher=OTHER);
        Mon, 07 Dec 2015 15:21:29 -0800 (PST)
Subject: Re: 2.4 pause - mod_http2 patchset Upgrade h2c vs mod_ssl Upgrade tls
To: dev@httpd.apache.org
References: <CACsi250=dbRQKnsbE8JSdAZRm5x99gE0sgX3iQ-PHAx77euD1A@mail.gmail.com>
 <CACsi2534prBtp7ENNNiEDevA3Z7u9uW2uuYMOa8-OoOsPSHNGQ@mail.gmail.com>
 <6C1FCB84-22AF-49D5-AA10-BFB922A98390@greenbytes.de>
 <CAGu=u8h9XxW0NSeMDSwaujO1G=sRn67TFah_FyGqNnBaWhHpLw@mail.gmail.com>
 <566603E5.8030004@gmail.com>
 <CACsi252sKCj6jmwhCRt7rGmu6K9aOd0oHAQ1nOoDvqZq5kjz8g@mail.gmail.com>
From: Jacob Champion <champion.p@gmail.com>
Message-ID: <56661478.5030703@gmail.com>
Date: Mon, 7 Dec 2015 15:21:28 -0800
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:38.0) Gecko/20100101
 Thunderbird/38.4.0
MIME-Version: 1.0
In-Reply-To: <CACsi252sKCj6jmwhCRt7rGmu6K9aOd0oHAQ1nOoDvqZq5kjz8g@mail.gmail.com>
Content-Type: text/plain; charset=utf-8; format=flowed
Content-Transfer-Encoding: 7bit

On 12/07/2015 02:40 PM, William A Rowe Jr wrote:
> Not "noise" at all... I'm imagining a mod_echo protocol example that
> looks much like your use case...
>
> 1st call to core_upgrade_request in post_read_req hook, after setenvif
> and mod_headers processing... tls is ready, echo (or websocket) would
> not be ready.  Those ready indicate via ap_select_protocol hook response.

Just to confirm, the purpose of splitting this up into two separate 
calls to the same function is solely to deal with "OPTIONS *", which 
doesn't follow the same logical path in httpd? Or is there another reason?

> ... normal pre-handler request preparation and auth ...
>
> 2nd call to core_upgrade_request in ap_invoke_handler hook, after all
> of these other preparations but excluding filter configuration (filters may
> differ for the new protocol), tls was handled earlier, echo (or websocket)
> are now ready, based on auth results.  Those ready again indicate
> via ap_select_protocol hook response.
>
> WDYT?

I have a suspicion that this isn't quite enough, at least not with the 
code that's currently there. I really need to write code to confirm, 
but: if WebSocket is enabled for the request-target path, but the 
upgrade request is malformed, I still want my module to propose a 
WebSocket upgrade to core, so that I have the ability to fail said 
upgrade with a 4xx _if_ we're chosen as the eventual protocol. (If a 
different protocol is chosen, the client lucks out.)

Put another way, I'm going to propose WebSocket for the paths that the 
server admin wants, whether the incoming request is valid/authorized or 
not, and I still need some way to interrupt the upgrade if we're chosen 
and the client hasn't sent a proper request. Does that makes sense?

--Jacob

From dev-return-84922-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Mon Dec  7 23:45:56 2015
Return-Path: <dev-return-84922-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 6425418C11
	for <apmail-httpd-dev-archive@www.apache.org>; Mon,  7 Dec 2015 23:45:56 +0000 (UTC)
Received: (qmail 57656 invoked by uid 500); 7 Dec 2015 23:45:49 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 57577 invoked by uid 500); 7 Dec 2015 23:45:49 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 57566 invoked by uid 99); 7 Dec 2015 23:45:49 -0000
Received: from Unknown (HELO spamd4-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 07 Dec 2015 23:45:49 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd4-us-west.apache.org (ASF Mail Server at spamd4-us-west.apache.org) with ESMTP id 1A2F3C14D7
	for <dev@httpd.apache.org>; Mon,  7 Dec 2015 23:45:49 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd4-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.12
X-Spam-Level:
X-Spam-Status: No, score=-0.12 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RCVD_IN_MSPIKE_H3=-0.01, RCVD_IN_MSPIKE_WL=-0.01, SPF_PASS=-0.001,
	URIBL_BLOCKED=0.001] autolearn=disabled
Authentication-Results: spamd4-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd4-us-west.apache.org [10.40.0.11]) (amavisd-new, port 10024)
	with ESMTP id Zr0UOcNAfjK9 for <dev@httpd.apache.org>;
	Mon,  7 Dec 2015 23:45:43 +0000 (UTC)
Received: from mail-ig0-f181.google.com (mail-ig0-f181.google.com [209.85.213.181])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id 0EF5B203A3
	for <dev@httpd.apache.org>; Mon,  7 Dec 2015 23:45:43 +0000 (UTC)
Received: by igbxm8 with SMTP id xm8so5251386igb.1
        for <dev@httpd.apache.org>; Mon, 07 Dec 2015 15:45:42 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        bh=R+XXWeSC/uBhw4xw8dwJNwzFdD7zAa/S/UwIVqFhsY4=;
        b=vY92Ein32o+zmxEbM+owi6Jam2izb/3u8rbap2xRNLHy2cLvNQLGI4MjnETTEYehbc
         twDex62dyW3XCh76BRI/Iv/vsu5UZOfrt+417ghFspW5YgJySDej1qHWqZFHS9ZtuHqJ
         3XuXcn69cMKmGy0iPOpPsAcMz9jon+RahsTepS6kNqGv1XYzQInEOaRNDSFlDlRVJoEE
         h6WsTlPhcGYtuB6ATJ1pgD576bzi4SEcaQHFtZkA1/VYtxynrP8wnmYdbnnr5/MZ0QGn
         4Kg77beNeFCreF5qVBnwENZ+3ZrMiKxRPqHpae3TQ0rXLcDj9pWPML1BVdAyWY6ErGnd
         n63g==
MIME-Version: 1.0
X-Received: by 10.50.142.105 with SMTP id rv9mr1030917igb.72.1449531941940;
 Mon, 07 Dec 2015 15:45:41 -0800 (PST)
Received: by 10.64.114.199 with HTTP; Mon, 7 Dec 2015 15:45:41 -0800 (PST)
In-Reply-To: <alpine.GSO.2.02.1504240752121.8824@hatchepsut.acc.umu.se>
References: <alpine.GSO.2.02.1504240752121.8824@hatchepsut.acc.umu.se>
Date: Mon, 7 Dec 2015 18:45:41 -0500
Message-ID: <CALK=YjMBKP+P59J=nzt3aX0tniq+Zv8L3uBP64-bjAKqGRV0fw@mail.gmail.com>
Subject: Re: mod_cache: Broken code?
From: Eric Covener <covener@gmail.com>
To: Apache HTTP Server Development List <dev@httpd.apache.org>
Content-Type: text/plain; charset=UTF-8

On Fri, Apr 24, 2015 at 2:04 AM, Niklas Edmundsson <nikke@acc.umu.se> wrote:
>
> When trying to debug something else I stumbled across this code-snippet in
> modules/cache/mod_cache.c:
>
> errno = 0;
> x = control.max_age_value;
> if (errno) {
>     x = dconf->defex;
> }
> else {
>     x = x * MSEC_ONE_SEC;
> }
>
> It looks that way both in trunk and 2.4.x.
>
> The likelhood of that if-statement to have more than one outcome is low, and
> the fact that errno isn't used anywhere else in mod_cache.c makes it even
> more suspicious.
>
> Looking at the annotated history it seems like the errno-stuff stems from
> apr_atoi64() being used once upon a time but has since been removed without
> cleaning up the related code...
>
> It's easy to just remove the now redundant code, but is that the right way
> to do it or did the initial code have some function that's now gone missing?
>

Just came across the same thing (looking at s-maxage stuff) and found your note
searching my mail.

I think all of the checking is still present between ap_cache_control
and the caller
checking control.maxage before looking at control.maxage_value.

I just removed the errno stuff  in r1718496.

From dev-return-84923-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Mon Dec  7 23:55:00 2015
Return-Path: <dev-return-84923-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 9D0E318C6A
	for <apmail-httpd-dev-archive@www.apache.org>; Mon,  7 Dec 2015 23:55:00 +0000 (UTC)
Received: (qmail 75439 invoked by uid 500); 7 Dec 2015 23:55:00 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 75357 invoked by uid 500); 7 Dec 2015 23:55:00 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 75347 invoked by uid 99); 7 Dec 2015 23:55:00 -0000
Received: from Unknown (HELO spamd3-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 07 Dec 2015 23:55:00 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd3-us-west.apache.org (ASF Mail Server at spamd3-us-west.apache.org) with ESMTP id 9862B180A95
	for <dev@httpd.apache.org>; Mon,  7 Dec 2015 23:54:59 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd3-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 2.998
X-Spam-Level: **
X-Spam-Status: No, score=2.998 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, HTML_MESSAGE=3,
	RCVD_IN_MSPIKE_H2=-0.001, SPF_PASS=-0.001] autolearn=disabled
Authentication-Results: spamd3-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=rowe-clan-net.20150623.gappssmtp.com
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd3-us-west.apache.org [10.40.0.10]) (amavisd-new, port 10024)
	with ESMTP id LcbnpYG_mjVV for <dev@httpd.apache.org>;
	Mon,  7 Dec 2015 23:54:57 +0000 (UTC)
Received: from mail-io0-f175.google.com (mail-io0-f175.google.com [209.85.223.175])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id 243CC428DC
	for <dev@httpd.apache.org>; Mon,  7 Dec 2015 23:54:57 +0000 (UTC)
Received: by ioc74 with SMTP id 74so7466919ioc.2
        for <dev@httpd.apache.org>; Mon, 07 Dec 2015 15:49:55 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=rowe-clan-net.20150623.gappssmtp.com; s=20150623;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        bh=Dd5Za4qbXvCqzBdn2zqfeI+nihtUkaxdxMsWEryz6Yk=;
        b=BpuufQQW4VxmQRbeQCZfsuJ47XMMZjfUUNLrMDWDmnynQ+GhFgOtcycOLVR0mzdPy/
         lATdgkiYnufBEE27F8Rxf35Qmm61Z51w4Y4sIkpHPfDs3uWWnJCTMTu6VvS+mPXxnJzu
         W/UIbbKsItmg9tk9UpCS3F71L/MRI+pLcpIKLVd29/InAwfbQEKLruYJkAuKoxwdgtqm
         ZKCV/lZ5cJPYzvn/CBpEwdQWJb7nzp/YVnfmHr1Q3sQhKXct1frruL9bYMdGvW5sgKS2
         KhSSBwU0LuR5n6jK7K2SNykKrWy+hq3WXswSCGGe+itt8eLb8cy/pp7876OIZSuHxbpa
         VGzA==
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=1e100.net; s=20130820;
        h=x-gm-message-state:mime-version:in-reply-to:references:date
         :message-id:subject:from:to:content-type;
        bh=Dd5Za4qbXvCqzBdn2zqfeI+nihtUkaxdxMsWEryz6Yk=;
        b=DAT5G19VHQlib2wiagijDxoDMNxRbigLUKsAcLGPzbTIpSFlg2fk3Rc+K4HpvV4E07
         cZJ7tz9AHpGYCnjUNoni2yjkTYCsN0WAjYh3Lplu8OfuekLMtFSzRGWf5YgrEqGJCkUc
         CymulkIJsHYdBaDW+T8z6w3D67TS1dmD9VaJzDIJNRO0mikx+puznOZlyjhh52b6cNs4
         JPKgYp0ISqMH2mGor80NzvuN3/kw1NuFlvf/n3OSeqCCQt+Acl8YQ+bcRUTvXaWqQUs8
         lgtWQw4stRMOy+QOoW7PggbqMakGVm65tVjwhXllLFs6KAiSAfrTxXz2EDI4AsRsJaT2
         EoBA==
X-Gm-Message-State: ALoCoQmOTWpOwIQ/Li2WnoTHCjDAhHicuxFTrQI0r6t0Sg+hjBzER3ZT0lVBTSFBQBJGWUeAlsDFtOJXjSwWYaT3sDOQZ4u4TAuIa8DDUoUPvF9F6hwBR0E=
MIME-Version: 1.0
X-Received: by 10.107.34.199 with SMTP id i190mr1111106ioi.150.1449532195410;
 Mon, 07 Dec 2015 15:49:55 -0800 (PST)
Received: by 10.107.62.136 with HTTP; Mon, 7 Dec 2015 15:49:55 -0800 (PST)
In-Reply-To: <56661478.5030703@gmail.com>
References: <CACsi250=dbRQKnsbE8JSdAZRm5x99gE0sgX3iQ-PHAx77euD1A@mail.gmail.com>
	<CACsi2534prBtp7ENNNiEDevA3Z7u9uW2uuYMOa8-OoOsPSHNGQ@mail.gmail.com>
	<6C1FCB84-22AF-49D5-AA10-BFB922A98390@greenbytes.de>
	<CAGu=u8h9XxW0NSeMDSwaujO1G=sRn67TFah_FyGqNnBaWhHpLw@mail.gmail.com>
	<566603E5.8030004@gmail.com>
	<CACsi252sKCj6jmwhCRt7rGmu6K9aOd0oHAQ1nOoDvqZq5kjz8g@mail.gmail.com>
	<56661478.5030703@gmail.com>
Date: Mon, 7 Dec 2015 17:49:55 -0600
Message-ID: <CACsi2517xHBLjCGE+9wcJCu5ARZxMfCx=1sOzLerqmN4hfUNYg@mail.gmail.com>
Subject: Re: 2.4 pause - mod_http2 patchset Upgrade h2c vs mod_ssl Upgrade tls
From: William A Rowe Jr <wrowe@rowe-clan.net>
To: httpd <dev@httpd.apache.org>
Content-Type: multipart/alternative; boundary=001a1140d94499296605265783d9

--001a1140d94499296605265783d9
Content-Type: text/plain; charset=UTF-8

On Mon, Dec 7, 2015 at 5:21 PM, Jacob Champion <champion.p@gmail.com> wrote:

> On 12/07/2015 02:40 PM, William A Rowe Jr wrote:
>
>> Not "noise" at all... I'm imagining a mod_echo protocol example that
>> looks much like your use case...
>>
>> 1st call to core_upgrade_request in post_read_req hook, after setenvif
>> and mod_headers processing... tls is ready, echo (or websocket) would
>> not be ready.  Those ready indicate via ap_select_protocol hook response.
>>
>
> Just to confirm, the purpose of splitting this up into two separate calls
> to the same function is solely to deal with "OPTIONS *", which doesn't
> follow the same logical path in httpd? Or is there another reason?
>

No, it is because the TLS handshake from the Upgrade: TLS  handling
is used in the auth path, everything from SSLRequireSSL to using the
CN of a client certificate for authentication.

TLS Upgrade must occur somewhere early in the post_read_request
phase of operation.  For that matter, so should h2c, I'd imagine, but
those phases may already be invoked a second time in mod_http2,
someone else could verify or disclaim that.

... normal pre-handler request preparation and auth ...
>>
>> 2nd call to core_upgrade_request in ap_invoke_handler hook, after all
>> of these other preparations but excluding filter configuration (filters
>> may
>> differ for the new protocol), tls was handled earlier, echo (or websocket)
>> are now ready, based on auth results.  Those ready again indicate
>> via ap_select_protocol hook response.
>>
>> WDYT?
>>
>
> I have a suspicion that this isn't quite enough, at least not with the
> code that's currently there. I really need to write code to confirm, but:
> if WebSocket is enabled for the request-target path, but the upgrade
> request is malformed, I still want my module to propose a WebSocket upgrade
> to core, so that I have the ability to fail said upgrade with a 4xx _if_
> we're chosen as the eventual protocol. (If a different protocol is chosen,
> the client lucks out.)
>
> Put another way, I'm going to propose WebSocket for the paths that the
> server admin wants, whether the incoming request is valid/authorized or
> not, and I still need some way to interrupt the upgrade if we're chosen and
> the client hasn't sent a proper request. Does that makes sense?


So how would a second invocation during the ap_invoke_handler cause
an interruption in this?

Upgrade: TLS would occur in the early processing, Upgrade: WebSocket
would occur in the later processing phase, but still prior to invoking a
handler
for the HTTP/1.1 request.  Remember that there is no 'error' for a malformed
upgrade request, only a failure to proceed with 101-switching protocols.

Right now the core Protocol API will only send an Upgrade: offer on the
first request in a chain of keepalive requests.  If the user agent asks for
OPTIONS * and the WebSocket module declines to offer itself, and the
user agent continues with a GET /webapp/... request that the WebSocket
module is willing to upgrade, today the core Protocol API will not advertise
that to the user agent on this kept-alive request for you.

Of course there is a fail-case, and that would be Upgrade Required, but
the protocol module needs to set this sometime before handler invocation.
Right now you can't do that within core_upgrade_request hooks, because
without an Upgrade: request from the client, the core_upgrade_request
implementation calls none of the protocol hooks on a kept-alive 2nd or
later request, right now.

Stupid question, is there an Upgrade: of protocols within HTTP/2?  An
obvious case would be the websocket connection embedded within the
h2c connection, but I expect that is not allowed.  TLS upgrade would be
nonsense on an h2c connection.  But is there a provision for it in spec?

--001a1140d94499296605265783d9
Content-Type: text/html; charset=UTF-8
Content-Transfer-Encoding: quoted-printable

<div dir=3D"ltr"><div class=3D"gmail_extra"><div class=3D"gmail_quote">On M=
on, Dec 7, 2015 at 5:21 PM, Jacob Champion <span dir=3D"ltr">&lt;<a href=3D=
"mailto:champion.p@gmail.com" target=3D"_blank">champion.p@gmail.com</a>&gt=
;</span> wrote:<br><blockquote class=3D"gmail_quote" style=3D"margin:0px 0p=
x 0px 0.8ex;border-left-width:1px;border-left-color:rgb(204,204,204);border=
-left-style:solid;padding-left:1ex"><span class=3D"">On 12/07/2015 02:40 PM=
, William A Rowe Jr wrote:<br>
<blockquote class=3D"gmail_quote" style=3D"margin:0px 0px 0px 0.8ex;border-=
left-width:1px;border-left-color:rgb(204,204,204);border-left-style:solid;p=
adding-left:1ex">
Not &quot;noise&quot; at all... I&#39;m imagining a mod_echo protocol examp=
le that<br>
looks much like your use case...<br>
<br>
1st call to core_upgrade_request in post_read_req hook, after setenvif<br>
and mod_headers processing... tls is ready, echo (or websocket) would<br>
not be ready.=C2=A0 Those ready indicate via ap_select_protocol hook respon=
se.<br>
</blockquote>
<br></span>
Just to confirm, the purpose of splitting this up into two separate calls t=
o the same function is solely to deal with &quot;OPTIONS *&quot;, which doe=
sn&#39;t follow the same logical path in httpd? Or is there another reason?=
<span class=3D""><br></span></blockquote><div>=C2=A0</div><div>No, it is be=
cause the TLS handshake from the Upgrade: TLS =C2=A0handling=C2=A0</div><di=
v>is used in the auth path, everything from SSLRequireSSL to using the</div=
><div>CN of a client certificate for authentication.</div><div><br></div><d=
iv>TLS Upgrade must occur somewhere early in the post_read_request</div><di=
v>phase of operation.=C2=A0 For that matter, so should h2c, I&#39;d imagine=
, but</div><div>those phases may already be invoked a second time in mod_ht=
tp2,</div><div>someone else could verify or disclaim that.</div><div><br></=
div><blockquote class=3D"gmail_quote" style=3D"margin:0px 0px 0px 0.8ex;bor=
der-left-width:1px;border-left-color:rgb(204,204,204);border-left-style:sol=
id;padding-left:1ex"><span class=3D"">
<blockquote class=3D"gmail_quote" style=3D"margin:0px 0px 0px 0.8ex;border-=
left-width:1px;border-left-color:rgb(204,204,204);border-left-style:solid;p=
adding-left:1ex">
... normal pre-handler request preparation and auth ...<br>
<br>
2nd call to core_upgrade_request in ap_invoke_handler hook, after all<br>
of these other preparations but excluding filter configuration (filters may=
<br>
differ for the new protocol), tls was handled earlier, echo (or websocket)<=
br>
are now ready, based on auth results.=C2=A0 Those ready again indicate<br>
via ap_select_protocol hook response.<br>
<br>
WDYT?<br>
</blockquote>
<br></span>
I have a suspicion that this isn&#39;t quite enough, at least not with the =
code that&#39;s currently there. I really need to write code to confirm, bu=
t: if WebSocket is enabled for the request-target path, but the upgrade req=
uest is malformed, I still want my module to propose a WebSocket upgrade to=
 core, so that I have the ability to fail said upgrade with a 4xx _if_ we&#=
39;re chosen as the eventual protocol. (If a different protocol is chosen, =
the client lucks out.)<br>
<br>
Put another way, I&#39;m going to propose WebSocket for the paths that the =
server admin wants, whether the incoming request is valid/authorized or not=
, and I still need some way to interrupt the upgrade if we&#39;re chosen an=
d the client hasn&#39;t sent a proper request. Does that makes sense?</bloc=
kquote><div><br></div><div>So how would a second invocation during the ap_i=
nvoke_handler cause</div><div>an interruption in this?</div><div><br></div>=
<div>Upgrade: TLS would occur in the early processing, Upgrade: WebSocket=
=C2=A0</div><div>would occur in the later processing phase, but still prior=
 to invoking a handler=C2=A0</div><div>for the HTTP/1.1 request.=C2=A0 Reme=
mber that there is no &#39;error&#39; for a malformed</div><div>upgrade req=
uest, only a failure to proceed with 101-switching protocols.</div><div><br=
></div><div>Right now the core Protocol API will only send an Upgrade: offe=
r on the=C2=A0<br></div><div>first request in a chain of keepalive requests=
.=C2=A0 If the user agent asks for=C2=A0</div><div>OPTIONS * and the WebSoc=
ket module declines to offer itself, and the</div><div>user agent continues=
 with a GET /webapp/... request that the WebSocket</div><div>module is will=
ing to upgrade, today the core Protocol API will not advertise</div><div>th=
at to the user agent on this kept-alive request for you.</div><div><br></di=
v><div><div>Of course there is a fail-case, and that would be Upgrade Requi=
red, but</div><div>the protocol module needs to set this sometime before ha=
ndler invocation.</div><div>Right now you can&#39;t do that within=C2=A0cor=
e_upgrade_request hooks, because</div><div>without an Upgrade: request from=
 the client, the=C2=A0core_upgrade_request=C2=A0</div><div>implementation c=
alls none of the protocol hooks on a kept-alive 2nd or</div><div>later requ=
est, right now.</div><div><br></div><div>Stupid question, is there an Upgra=
de: of protocols within HTTP/2?=C2=A0 An</div><div>obvious case would be th=
e websocket connection embedded within the</div><div>h2c connection, but I =
expect that is not allowed.=C2=A0 TLS upgrade would be</div><div>nonsense o=
n an h2c connection.=C2=A0 But is there a provision for it in spec?<br></di=
v></div><div><br></div><div><br></div></div></div></div>

--001a1140d94499296605265783d9--

From dev-return-84924-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Tue Dec  8 00:07:57 2015
Return-Path: <dev-return-84924-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 8920B18CD2
	for <apmail-httpd-dev-archive@www.apache.org>; Tue,  8 Dec 2015 00:07:57 +0000 (UTC)
Received: (qmail 5760 invoked by uid 500); 8 Dec 2015 00:07:56 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 5671 invoked by uid 500); 8 Dec 2015 00:07:56 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 5661 invoked by uid 99); 8 Dec 2015 00:07:56 -0000
Received: from Unknown (HELO spamd4-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 08 Dec 2015 00:07:56 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd4-us-west.apache.org (ASF Mail Server at spamd4-us-west.apache.org) with ESMTP id 3F023C0FFC
	for <dev@httpd.apache.org>; Tue,  8 Dec 2015 00:07:56 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd4-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.1
X-Spam-Level:
X-Spam-Status: No, score=-0.1 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RCVD_IN_MSPIKE_H2=-0.001, URIBL_BLOCKED=0.001] autolearn=disabled
Authentication-Results: spamd4-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd4-us-west.apache.org [10.40.0.11]) (amavisd-new, port 10024)
	with ESMTP id oYU4-HMiuWYX for <dev@httpd.apache.org>;
	Tue,  8 Dec 2015 00:07:46 +0000 (UTC)
Received: from mail-qg0-f49.google.com (mail-qg0-f49.google.com [209.85.192.49])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id 254ED42B4B
	for <dev@httpd.apache.org>; Tue,  8 Dec 2015 00:07:46 +0000 (UTC)
Received: by qgcc31 with SMTP id c31so3231568qgc.3
        for <dev@httpd.apache.org>; Mon, 07 Dec 2015 16:07:45 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        bh=2H3rIUAxnsud2qrebvzTqHTi4/pHhiWijzL4yA5/dWE=;
        b=EiC6p1yYi1Mv8stwjAslVEILrwKRHZktjj16Gk1SnAEbPuBJEAGp6wz9qOfJyef3g9
         C47y6IgC9OAX9yQyTbXUoLYtm3+ZN9zXyVO66g1tIIIKhhFfnmAjeIdyPCDSSNU8cMah
         fZaXWlgNt/2CR3BorgAgYj+1x12yJ5HYGHO+ie1YgvDBMLQGxaLtNVfrAuyIAGZNIn4y
         26pkfBKCqZIyKB0pgUJl85c/NAFKa7XcC/3eQIqMyQKPyw+wPEa8JNHTjGkzn8WlxoOg
         XQiHd/qhn2iwzjwSAvm5ImtUJbzNDlZgvEW72yoQac5IhPwaHw1rMADkfhhMvMrQvzO2
         Ka7g==
MIME-Version: 1.0
X-Received: by 10.140.96.45 with SMTP id j42mr752524qge.92.1449533265669; Mon,
 07 Dec 2015 16:07:45 -0800 (PST)
Received: by 10.55.65.85 with HTTP; Mon, 7 Dec 2015 16:07:45 -0800 (PST)
In-Reply-To: <CACsi250=dbRQKnsbE8JSdAZRm5x99gE0sgX3iQ-PHAx77euD1A@mail.gmail.com>
References: <CACsi250=dbRQKnsbE8JSdAZRm5x99gE0sgX3iQ-PHAx77euD1A@mail.gmail.com>
Date: Tue, 8 Dec 2015 01:07:45 +0100
Message-ID: <CAKQ1sVOKT6_LUbC7pCFnykVYP_7L2vDj6ZWp_TOTsDXRDCjy-w@mail.gmail.com>
Subject: Re: 2.4 pause - mod_http2 patchset Upgrade h2c vs mod_ssl Upgrade tls
From: Yann Ylavic <ylavic.dev@gmail.com>
To: httpd-dev <dev@httpd.apache.org>
Content-Type: text/plain; charset=UTF-8

On Mon, Dec 7, 2015 at 5:38 PM, William A Rowe Jr <wrowe@rowe-clan.net> wrote:
>
> https://tools.ietf.org/html/rfc7230#section-6.7 makes things more
> interesting, it calls out that 101-continue and the request body read
> precedes the 101-switching protocols.  Not sure who decided that would be a
> good idea, sigh... but mod_ssl TLS upgrade has these reversed for several
> good reasons including the intent to encrypt the request body if present and
> simple economics of processing.

As I read rfc7230#section-6.7 :

   A client cannot begin using an upgraded protocol on the connection
   until it has completely sent the request message (i.e., the client
   can't change the protocol it is sending in the middle of a message).

the server is supposed to respond with a 101 and than the Upgrade'd
response (using the Upgrade protocol, eg. TLS/1.x), but *after* the
request body is read (in plain text!).
That means, for the TLS/1.x case, that the client handshake is
supposed to arrive after a request body (if any), and hence mod_ssl
can't assume the first request body is TLS'd, and the body ought to be
set aside for any (relevant) TLS response (which needs the
handshake...).

I don't see this is working like this in mod_ssl, am I missing something ?


Still rfc7230#section-6.7:

   If a server receives both an Upgrade and an Expect header field with
   the "100-continue" expectation (Section 5.1.1 of [RFC7231]), the
   server MUST send a 100 (Continue) response before sending a 101
   (Switching Protocols) response.

The 100-continue case isn't a particular one IMHO, any Upgrade header
would be informative, not authoritative (not a 101 status).

From dev-return-84925-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Tue Dec  8 00:11:02 2015
Return-Path: <dev-return-84925-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 1C1B518CF6
	for <apmail-httpd-dev-archive@www.apache.org>; Tue,  8 Dec 2015 00:11:02 +0000 (UTC)
Received: (qmail 10283 invoked by uid 500); 8 Dec 2015 00:11:01 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 10218 invoked by uid 500); 8 Dec 2015 00:11:01 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 10206 invoked by uid 99); 8 Dec 2015 00:11:01 -0000
Received: from Unknown (HELO spamd4-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 08 Dec 2015 00:11:00 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd4-us-west.apache.org (ASF Mail Server at spamd4-us-west.apache.org) with ESMTP id 88EB4C1335
	for <dev@httpd.apache.org>; Tue,  8 Dec 2015 00:11:00 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd4-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 2.98
X-Spam-Level: **
X-Spam-Status: No, score=2.98 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, HTML_MESSAGE=3,
	RCVD_IN_MSPIKE_H3=-0.01, RCVD_IN_MSPIKE_WL=-0.01, SPF_PASS=-0.001,
	URIBL_BLOCKED=0.001] autolearn=disabled
Authentication-Results: spamd4-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=rowe-clan-net.20150623.gappssmtp.com
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd4-us-west.apache.org [10.40.0.11]) (amavisd-new, port 10024)
	with ESMTP id 0PY0by02g4VZ for <dev@httpd.apache.org>;
	Tue,  8 Dec 2015 00:10:53 +0000 (UTC)
Received: from mail-ig0-f177.google.com (mail-ig0-f177.google.com [209.85.213.177])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id C61F324C66
	for <dev@httpd.apache.org>; Tue,  8 Dec 2015 00:10:52 +0000 (UTC)
Received: by igcmv3 with SMTP id mv3so90555489igc.0
        for <dev@httpd.apache.org>; Mon, 07 Dec 2015 16:05:51 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=rowe-clan-net.20150623.gappssmtp.com; s=20150623;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        bh=YX9Pof6sdGhPoF8m9UXo+/05HKFlsfY9tw5hNRUGcvc=;
        b=gW/1PqB2cO4QKdV+PX5ZEVpeg0bF6zFyxNni/U3ZADxzJCg9m9MQuiEeTQqsOK+IoK
         IGygdOyijnPtfR1ojr4uKxmswydBI9hQYpvZwTzx+d76FsKVYc0A8zxBXvQvskVkN/NS
         AjK1P1E8b2PRtbClZQHDVmzRYfKL9RGOsJMdQHpBQjVeW1WFQAj0jhtLATqt+4BuWppQ
         9IKSOURoBheXqhH17NYMVl9PeQRYjStBNHB6vdCBVfPFxr8dSr4EdQNYNX3ri5cjrF5V
         zB95W9dDOuS5ow7CTnQPNPxa31yn25IFcamzheQOf8WnLILJUfpnFtyMM8xP+G7XchLP
         2h1A==
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=1e100.net; s=20130820;
        h=x-gm-message-state:mime-version:in-reply-to:references:date
         :message-id:subject:from:to:content-type;
        bh=YX9Pof6sdGhPoF8m9UXo+/05HKFlsfY9tw5hNRUGcvc=;
        b=dh3C1lMHd+bWB3zd1a+OsPr43EKuIo+Us2OimX5herxiH6TJUa/OMVvnBKDesgzp+A
         tffWfqglUPI4hvobur2imym7SJ/m/qs4XaBpPo9aQsat72sM4NN4NVnznDQNKDKMk8Xx
         rne5LdxVlXPiQUI2bGro58XqfxgfJrA/BNtR5qpIyWqHKfaV8pbirpsqzGFUSI72BS9P
         kzp3ttvceF1sMWBePewozRNM7PvhQzf1HuUVhnaMkBcvlcCTNKDBK7hJeZMx/wGkqu+t
         OMLRLVpvEcf87KVGr7A2XhUiKGjtTlwyXBFxEfhO4+4t1hdSuWac/horWcx/g+CCfRPE
         ZSbw==
X-Gm-Message-State: ALoCoQnLMsEsYgd339qJydQNcSgBUake6bMqZvK5dQtWIl/x+Z1YC0hXr33fVAPXoa7LoP1fiiWkdTc5sMyEb3Kh21KBv7ryS69mdCY/8trKEsYrObh/cpU=
MIME-Version: 1.0
X-Received: by 10.50.138.2 with SMTP id qm2mr746948igb.32.1449533151525; Mon,
 07 Dec 2015 16:05:51 -0800 (PST)
Received: by 10.107.62.136 with HTTP; Mon, 7 Dec 2015 16:05:51 -0800 (PST)
In-Reply-To: <EB66CCC2-F04C-44C7-ACE1-8D2F1CF91519@greenbytes.de>
References: <CACsi250=dbRQKnsbE8JSdAZRm5x99gE0sgX3iQ-PHAx77euD1A@mail.gmail.com>
	<CAGu=u8jn-qYVX2V-EAvcOjnPP3OcGcpThj7YesXxQRCHDUzgaA@mail.gmail.com>
	<CACsi251zevzsdTUQKmye9bPLRnoc6Tn__GRRavDPgrU-f5L7Ag@mail.gmail.com>
	<85F6B23C-D866-4F91-ADAD-507C509192FC@greenbytes.de>
	<EB66CCC2-F04C-44C7-ACE1-8D2F1CF91519@greenbytes.de>
Date: Mon, 7 Dec 2015 18:05:51 -0600
Message-ID: <CACsi252OBYzy4hinEwf1QiX_mcweo=tcDJ=Z0CWKVV4D-p-jPw@mail.gmail.com>
Subject: Re: 2.4 pause - mod_http2 patchset Upgrade h2c vs mod_ssl Upgrade tls
From: William A Rowe Jr <wrowe@rowe-clan.net>
To: httpd <dev@httpd.apache.org>
Content-Type: multipart/alternative; boundary=001a1135ffb0965b2a052657bc3d

--001a1135ffb0965b2a052657bc3d
Content-Type: text/plain; charset=UTF-8

On Mon, Dec 7, 2015 at 2:54 PM, Stefan Eissing <stefan.eissing@greenbytes.de
> wrote:

> ok, after some more thinking. if a tls+http/1.1 upgrade together with
> Expect is indeed a use case, then, to make that work, sending the 101 needs
> to become the task of the switch protocol handler itself. Then the order in
> which intermediate responses are sent depends on the switched protocol.
>
> When writing the current code, I wanted the common tasks in core. But if
> that needs to vary, we need to shift that.
>

100-continue should be simple enough to implement; we can even defer
the 101-switching protocols until we determine that the chunked request
body "fits in memory".  Roughly...

1. in the core protocol implementation, we determine that the provider
    is willing, so far, based on a request body of known C-L body size
    or of indeterminate length (no bytes read, chunked encoding)

2. we invoking a speculative connection filter read at the http protocol
    to network layer - that http input filter sends the 100-continue where
    it aught to be. That speculative read sets aside bytes read for later
    consumption based on the buffer it is willing to offer.  The body has
    been read complete from the network or is still in an incomplete
    chunk (or would block waiting for the next chunk).

3. back in the core protocol implementation, if the http input filter still
    must read from the network beyond it's small buffer, no upgrade is
    realistically possible, then we fall out before processing the protocol
    switch and proceed as http/1.1.

4. alternately, if the input filter read completely, the core protocol
    implementation now sends the 101-switching protocols and lets
    the protocol implementation determine whether it injects the
    appropriate filters and resumes (e.g. tls), assumes authority
    over the core request handling and protocol (e.g. h2c), or jumps
    the shark entirely (e.g. echo) and has nothing more to do with
    the request.

--001a1135ffb0965b2a052657bc3d
Content-Type: text/html; charset=UTF-8
Content-Transfer-Encoding: quoted-printable

<div dir=3D"ltr"><div class=3D"gmail_extra"><div class=3D"gmail_quote">On M=
on, Dec 7, 2015 at 2:54 PM, Stefan Eissing <span dir=3D"ltr">&lt;<a href=3D=
"mailto:stefan.eissing@greenbytes.de" target=3D"_blank">stefan.eissing@gree=
nbytes.de</a>&gt;</span> wrote:<br><blockquote class=3D"gmail_quote" style=
=3D"margin:0px 0px 0px 0.8ex;border-left-width:1px;border-left-color:rgb(20=
4,204,204);border-left-style:solid;padding-left:1ex"><div dir=3D"auto"><div=
></div><div>ok, after some more thinking. if a tls+http/1.1 upgrade togethe=
r with Expect is indeed a use case, then, to make that work, sending the 10=
1 needs to become the task of the switch protocol handler itself. Then the =
order in which intermediate responses are sent depends on the switched prot=
ocol.=C2=A0</div><div><br></div><div>When writing the current code, I wante=
d the common tasks in core. But if that needs to vary, we need to shift tha=
t.=C2=A0</div></div></blockquote><div><br></div><div>100-continue should be=
 simple enough to implement; we can even defer</div><div>the 101-switching =
protocols until we determine that the chunked request</div><div>body &quot;=
fits in memory&quot;.=C2=A0 Roughly...</div><div><br></div><div>1. in the c=
ore protocol implementation, we determine that the provider</div><div>=C2=
=A0 =C2=A0 is willing, so far, based on a request body of known=C2=A0C-L=C2=
=A0body size</div><div>=C2=A0 =C2=A0 or of indeterminate length (no bytes r=
ead, chunked encoding)</div><div><br></div><div>2. we invoking a speculativ=
e connection filter read at the http protocol</div><div>=C2=A0 =C2=A0 to ne=
twork layer - that http input filter sends the 100-continue where=C2=A0</di=
v><div>=C2=A0 =C2=A0 it aught to be. That speculative read sets aside bytes=
 read for later=C2=A0</div><div>=C2=A0 =C2=A0 consumption based on the buff=
er it is willing to offer.=C2=A0 The body has=C2=A0</div><div>=C2=A0 =C2=A0=
 been read complete from the network or is still in an incomplete=C2=A0</di=
v><div>=C2=A0 =C2=A0 chunk (or would block waiting for the next chunk).</di=
v></div></div><div class=3D"gmail_extra"><br></div><div class=3D"gmail_extr=
a">3. back in the core protocol implementation, if the http input filter st=
ill</div><div class=3D"gmail_extra">=C2=A0 =C2=A0 must read from the networ=
k beyond it&#39;s small buffer, no upgrade is=C2=A0</div><div class=3D"gmai=
l_extra">=C2=A0 =C2=A0 realistically possible, then we fall out before proc=
essing the protocol=C2=A0</div><div class=3D"gmail_extra">=C2=A0 =C2=A0 swi=
tch and proceed as http/1.1.</div><div class=3D"gmail_extra"><br></div><div=
 class=3D"gmail_extra">4. alternately, if the input filter read completely,=
 the core protocol</div><div class=3D"gmail_extra">=C2=A0 =C2=A0 implementa=
tion now sends the 101-switching protocols and lets</div><div class=3D"gmai=
l_extra">=C2=A0 =C2=A0 the protocol implementation determine whether it inj=
ects the</div><div class=3D"gmail_extra">=C2=A0 =C2=A0 appropriate filters =
and resumes (e.g. tls), assumes authority</div><div class=3D"gmail_extra">=
=C2=A0 =C2=A0 over the core request handling and protocol (e.g. h2c), or ju=
mps<br></div><div class=3D"gmail_extra">=C2=A0 =C2=A0 the shark entirely (e=
.g. echo) and has nothing more to do with</div><div class=3D"gmail_extra">=
=C2=A0 =C2=A0 the request.</div><div class=3D"gmail_extra"><br></div><div c=
lass=3D"gmail_extra"><br></div></div>

--001a1135ffb0965b2a052657bc3d--

From dev-return-84926-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Tue Dec  8 00:16:08 2015
Return-Path: <dev-return-84926-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 39CF618D4C
	for <apmail-httpd-dev-archive@www.apache.org>; Tue,  8 Dec 2015 00:16:08 +0000 (UTC)
Received: (qmail 23633 invoked by uid 500); 8 Dec 2015 00:16:07 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 23549 invoked by uid 500); 8 Dec 2015 00:16:07 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 23539 invoked by uid 99); 8 Dec 2015 00:16:07 -0000
Received: from Unknown (HELO spamd2-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 08 Dec 2015 00:16:07 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd2-us-west.apache.org (ASF Mail Server at spamd2-us-west.apache.org) with ESMTP id 403071A0C2E
	for <dev@httpd.apache.org>; Tue,  8 Dec 2015 00:16:07 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd2-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 3
X-Spam-Level: ***
X-Spam-Status: No, score=3 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, HTML_MESSAGE=3,
	SPF_PASS=-0.001, URIBL_BLOCKED=0.001] autolearn=disabled
Authentication-Results: spamd2-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=rowe-clan-net.20150623.gappssmtp.com
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd2-us-west.apache.org [10.40.0.9]) (amavisd-new, port 10024)
	with ESMTP id 4Inmfttkj1Ba for <dev@httpd.apache.org>;
	Tue,  8 Dec 2015 00:15:59 +0000 (UTC)
Received: from mail-io0-f176.google.com (mail-io0-f176.google.com [209.85.223.176])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id E9C5442BA9
	for <dev@httpd.apache.org>; Tue,  8 Dec 2015 00:15:58 +0000 (UTC)
Received: by iouu10 with SMTP id u10so8263656iou.0
        for <dev@httpd.apache.org>; Mon, 07 Dec 2015 16:15:58 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=rowe-clan-net.20150623.gappssmtp.com; s=20150623;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        bh=00BDI8NM+kv2lDS28759PajDqPKq1UbPEJEx42HQ/AQ=;
        b=AQl7fR9XUFSEZXGNeKuMVgs7XVGoNTo9XapAH/Smp0io5r3JuFw6GJeYHIkw57DXNw
         I5wccKL63bQmtEUDXX53YFf9pypO7vB38zQxx82haIr7+JNttLbgwh/QG9+SVlt3nC93
         mf8ln1IWsEpCKv4wj4N0lkwP2rfMPBVWQfjJVc2blqPg6dMi8Bf2h9DZvBif6C6T0Jg5
         ZAa3hz3q6We6eZvUBlK7mcPt53GDMnS5SkuTG4odsnhe7koPuSiACW6fVhVSQft4sw8a
         oju9V2mBFD0YC/asRqhMqJ4zXR/M6FrTLJgOAown1xNpnWDfmZB0aJQaM4uix/rWtxXt
         dV6w==
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=1e100.net; s=20130820;
        h=x-gm-message-state:mime-version:in-reply-to:references:date
         :message-id:subject:from:to:content-type;
        bh=00BDI8NM+kv2lDS28759PajDqPKq1UbPEJEx42HQ/AQ=;
        b=gfL8Nv772Ms7AQG6U6k7UI3Niixpjh0P/U0lNDb7bsYZCBQYRlO+9b3ACdu5vZYoV3
         fI68xya8JRkCqQQ3uJm9S9tpYb0DVbPfKkwYAkcBz6Ka/SNRjBqfS9G9xTKqpcM155MY
         G/j+g5id1e2BqPZY23Fj3+qLqwz2Dn1XWpSfVj8U5yvReTT+xy6Tpp88Qqs3ewGJPsQJ
         RbupH5DVfknF+puBlZZ4BW9CnZEXYVZ7+vR+8gnU22C4Fj3vXQnbZnG9D7XEGyOL80HL
         Tj4gqdYriYd8iZYoErUuihsMc2E2QY+9l7MR/lZO5OKNHNy3JxjOXxzOXn5NCwl18X6i
         lpLg==
X-Gm-Message-State: ALoCoQmGrt/Too+vHjNWpnXpTPFmSvWwdk2QE9MQZzU76mgz4TEmLes463bBTtD1ntG6h+Ab72OdDYrmObeFTUOcvua1G00bTg/zLgi9ZfSKz4+qSUXrI2Q=
MIME-Version: 1.0
X-Received: by 10.107.25.83 with SMTP id 80mr89784ioz.163.1449533758554; Mon,
 07 Dec 2015 16:15:58 -0800 (PST)
Received: by 10.107.62.136 with HTTP; Mon, 7 Dec 2015 16:15:58 -0800 (PST)
In-Reply-To: <CACsi252OBYzy4hinEwf1QiX_mcweo=tcDJ=Z0CWKVV4D-p-jPw@mail.gmail.com>
References: <CACsi250=dbRQKnsbE8JSdAZRm5x99gE0sgX3iQ-PHAx77euD1A@mail.gmail.com>
	<CAGu=u8jn-qYVX2V-EAvcOjnPP3OcGcpThj7YesXxQRCHDUzgaA@mail.gmail.com>
	<CACsi251zevzsdTUQKmye9bPLRnoc6Tn__GRRavDPgrU-f5L7Ag@mail.gmail.com>
	<85F6B23C-D866-4F91-ADAD-507C509192FC@greenbytes.de>
	<EB66CCC2-F04C-44C7-ACE1-8D2F1CF91519@greenbytes.de>
	<CACsi252OBYzy4hinEwf1QiX_mcweo=tcDJ=Z0CWKVV4D-p-jPw@mail.gmail.com>
Date: Mon, 7 Dec 2015 18:15:58 -0600
Message-ID: <CACsi250b_cE-nSzhFPK=EJoPQ19SwBuFWQipNc-vV-068ogvkQ@mail.gmail.com>
Subject: Re: 2.4 pause - mod_http2 patchset Upgrade h2c vs mod_ssl Upgrade tls
From: William A Rowe Jr <wrowe@rowe-clan.net>
To: httpd <dev@httpd.apache.org>
Content-Type: multipart/alternative; boundary=001a113fdbb4c4f6ce052657e0f8

--001a113fdbb4c4f6ce052657e0f8
Content-Type: text/plain; charset=UTF-8

On Mon, Dec 7, 2015 at 6:05 PM, William A Rowe Jr <wrowe@rowe-clan.net>
wrote:

> On Mon, Dec 7, 2015 at 2:54 PM, Stefan Eissing <
> stefan.eissing@greenbytes.de> wrote:
>
>> ok, after some more thinking. if a tls+http/1.1 upgrade together with
>> Expect is indeed a use case, then, to make that work, sending the 101 needs
>> to become the task of the switch protocol handler itself. Then the order in
>> which intermediate responses are sent depends on the switched protocol.
>>
>> When writing the current code, I wanted the common tasks in core. But if
>> that needs to vary, we need to shift that.
>>
>
> 100-continue should be simple enough to implement; we can even defer
> the 101-switching protocols until we determine that the chunked request
> body "fits in memory".  Roughly...
>
> 1. in the core protocol implementation, we determine that the provider
>     is willing, so far, based on a request body of known C-L body size
>     or of indeterminate length (no bytes read, chunked encoding)
>
> 2. we invoking a speculative connection filter read at the http protocol
>     to network layer - that http input filter sends the 100-continue where
>     it aught to be. That speculative read sets aside bytes read for later
>     consumption based on the buffer it is willing to offer.  The body has
>     been read complete from the network or is still in an incomplete
>     chunk (or would block waiting for the next chunk).
>

By 'speculative read' here, I mean a look-ahead read.


> 3. back in the core protocol implementation, if the http input filter still
>     must read from the network beyond it's small buffer, no upgrade is
>     realistically possible, then we fall out before processing the
> protocol
>     switch and proceed as http/1.1.
>
> 4. alternately, if the input filter read completely, the core protocol
>     implementation now sends the 101-switching protocols and lets
>     the protocol implementation determine whether it injects the
>     appropriate filters and resumes (e.g. tls), assumes authority
>     over the core request handling and protocol (e.g. h2c), or jumps
>     the shark entirely (e.g. echo) and has nothing more to do with
>     the request.
>
>
>

--001a113fdbb4c4f6ce052657e0f8
Content-Type: text/html; charset=UTF-8
Content-Transfer-Encoding: quoted-printable

<div dir=3D"ltr"><div class=3D"gmail_extra"><div class=3D"gmail_quote">On M=
on, Dec 7, 2015 at 6:05 PM, William A Rowe Jr <span dir=3D"ltr">&lt;<a href=
=3D"mailto:wrowe@rowe-clan.net" target=3D"_blank">wrowe@rowe-clan.net</a>&g=
t;</span> wrote:<br><blockquote class=3D"gmail_quote" style=3D"margin:0 0 0=
 .8ex;border-left:1px #ccc solid;padding-left:1ex"><div dir=3D"ltr"><div cl=
ass=3D"gmail_extra"><div class=3D"gmail_quote"><span class=3D"">On Mon, Dec=
 7, 2015 at 2:54 PM, Stefan Eissing <span dir=3D"ltr">&lt;<a href=3D"mailto=
:stefan.eissing@greenbytes.de" target=3D"_blank">stefan.eissing@greenbytes.=
de</a>&gt;</span> wrote:<br><blockquote class=3D"gmail_quote" style=3D"marg=
in:0px 0px 0px 0.8ex;border-left-width:1px;border-left-color:rgb(204,204,20=
4);border-left-style:solid;padding-left:1ex"><div dir=3D"auto"><div></div><=
div>ok, after some more thinking. if a tls+http/1.1 upgrade together with E=
xpect is indeed a use case, then, to make that work, sending the 101 needs =
to become the task of the switch protocol handler itself. Then the order in=
 which intermediate responses are sent depends on the switched protocol.=C2=
=A0</div><div><br></div><div>When writing the current code, I wanted the co=
mmon tasks in core. But if that needs to vary, we need to shift that.=C2=A0=
</div></div></blockquote><div><br></div></span><div>100-continue should be =
simple enough to implement; we can even defer</div><div>the 101-switching p=
rotocols until we determine that the chunked request</div><div>body &quot;f=
its in memory&quot;.=C2=A0 Roughly...</div><div><br></div><div>1. in the co=
re protocol implementation, we determine that the provider</div><div>=C2=A0=
 =C2=A0 is willing, so far, based on a request body of known=C2=A0C-L=C2=A0=
body size</div><div>=C2=A0 =C2=A0 or of indeterminate length (no bytes read=
, chunked encoding)</div><div><br></div><div>2. we invoking a speculative c=
onnection filter read at the http protocol</div><div>=C2=A0 =C2=A0 to netwo=
rk layer - that http input filter sends the 100-continue where=C2=A0</div><=
div>=C2=A0 =C2=A0 it aught to be. That speculative read sets aside bytes re=
ad for later=C2=A0</div><div>=C2=A0 =C2=A0 consumption based on the buffer =
it is willing to offer.=C2=A0 The body has=C2=A0</div><div>=C2=A0 =C2=A0 be=
en read complete from the network or is still in an incomplete=C2=A0</div><=
div>=C2=A0 =C2=A0 chunk (or would block waiting for the next chunk).</div><=
/div></div></div></blockquote><div><br></div><div>By &#39;speculative read&=
#39; here, I mean a look-ahead read.=C2=A0</div><div>=C2=A0</div><blockquot=
e class=3D"gmail_quote" style=3D"margin:0 0 0 .8ex;border-left:1px #ccc sol=
id;padding-left:1ex"><div dir=3D"ltr"><div class=3D"gmail_extra"></div><div=
 class=3D"gmail_extra">3. back in the core protocol implementation, if the =
http input filter still</div><div class=3D"gmail_extra">=C2=A0 =C2=A0 must =
read from the network beyond it&#39;s small buffer, no upgrade is=C2=A0</di=
v><div class=3D"gmail_extra">=C2=A0 =C2=A0 realistically possible, then we =
fall out before processing the protocol=C2=A0</div><div class=3D"gmail_extr=
a">=C2=A0 =C2=A0 switch and proceed as http/1.1.</div><div class=3D"gmail_e=
xtra"><br></div><div class=3D"gmail_extra">4. alternately, if the input fil=
ter read completely, the core protocol</div><div class=3D"gmail_extra">=C2=
=A0 =C2=A0 implementation now sends the 101-switching protocols and lets</d=
iv><div class=3D"gmail_extra">=C2=A0 =C2=A0 the protocol implementation det=
ermine whether it injects the</div><div class=3D"gmail_extra">=C2=A0 =C2=A0=
 appropriate filters and resumes (e.g. tls), assumes authority</div><div cl=
ass=3D"gmail_extra">=C2=A0 =C2=A0 over the core request handling and protoc=
ol (e.g. h2c), or jumps<br></div><div class=3D"gmail_extra">=C2=A0 =C2=A0 t=
he shark entirely (e.g. echo) and has nothing more to do with</div><div cla=
ss=3D"gmail_extra">=C2=A0 =C2=A0 the request.</div><div class=3D"gmail_extr=
a"><br></div><div class=3D"gmail_extra"><br></div></div>
</blockquote></div><br></div></div>

--001a113fdbb4c4f6ce052657e0f8--

From dev-return-84927-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Tue Dec  8 00:19:13 2015
Return-Path: <dev-return-84927-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 5567818D80
	for <apmail-httpd-dev-archive@www.apache.org>; Tue,  8 Dec 2015 00:19:13 +0000 (UTC)
Received: (qmail 33791 invoked by uid 500); 8 Dec 2015 00:19:12 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 33724 invoked by uid 500); 8 Dec 2015 00:19:12 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 33714 invoked by uid 99); 8 Dec 2015 00:19:12 -0000
Received: from Unknown (HELO spamd4-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 08 Dec 2015 00:19:12 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd4-us-west.apache.org (ASF Mail Server at spamd4-us-west.apache.org) with ESMTP id 5E431C0481
	for <dev@httpd.apache.org>; Tue,  8 Dec 2015 00:19:12 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd4-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 2.999
X-Spam-Level: **
X-Spam-Status: No, score=2.999 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, HTML_MESSAGE=3,
	RCVD_IN_MSPIKE_H2=-0.001, SPF_PASS=-0.001, URIBL_BLOCKED=0.001]
	autolearn=disabled
Authentication-Results: spamd4-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=rowe-clan-net.20150623.gappssmtp.com
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd4-us-west.apache.org [10.40.0.11]) (amavisd-new, port 10024)
	with ESMTP id QfpFOkln0u1s for <dev@httpd.apache.org>;
	Tue,  8 Dec 2015 00:19:00 +0000 (UTC)
Received: from mail-io0-f174.google.com (mail-io0-f174.google.com [209.85.223.174])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id F3FF020DB9
	for <dev@httpd.apache.org>; Tue,  8 Dec 2015 00:18:59 +0000 (UTC)
Received: by ioc74 with SMTP id 74so7962200ioc.2
        for <dev@httpd.apache.org>; Mon, 07 Dec 2015 16:13:58 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=rowe-clan-net.20150623.gappssmtp.com; s=20150623;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        bh=EP0QjtLqFUOzrUivbo7dirNWdpoMO9S6AJnfEPhljLo=;
        b=Cv3bISUC+wsFOaVTpYbUCAZO4scx9jCMD4IMcEHB4vPZRXXySWKDqwHRqmqk2HDdnp
         jG6SeQMGwi7iUj3TVoB0zhbN2VO/3yUuBsUcSNdzax57TZNzyw5+jHbWA0C4Gow/VHX6
         bDOU32NIhCxuUXzZqQxUalB/J9HMSUEg3LhFpcASeg5kCm+sSbsyXtxZVw68mcjx4HAj
         gZmF3DGDa9Y1sSGB/0Xp2fR+LSAOasUeWkAuRnESaTG3Esbo2tK3LtwoAnXDSf+HhnAp
         v+iY3s1qWyaFM5KxrdZWCyrkmLnrE2fvO3xbZ++FDPEouzNU7pUOaTfEf8jnXuJZd0JP
         QnKg==
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=1e100.net; s=20130820;
        h=x-gm-message-state:mime-version:in-reply-to:references:date
         :message-id:subject:from:to:content-type;
        bh=EP0QjtLqFUOzrUivbo7dirNWdpoMO9S6AJnfEPhljLo=;
        b=dYSKzTIZFABx+wumaoi7yxGDjimQlP39JZxHHp/V5fw6rnkQRPo+8Gxz6Whc4wcfvX
         FwmSRi0WFH4HKA8APvgFVZPDxxYcoUuTsEmLCfharSI5tdBrhYJm1Pr6dTXjJHnx3W/J
         +i7/fQvR+gmjlH+Y5nClTOGvfy0RIqMyM0VJFHpuB75F2xNo3ufJIwHulNLOef8kl2cr
         BJN3ApSCqKOHQR5jMvfLqFfO8wDpVd//ChkD1KvkKIrtxXBG7bKW8i9vICwfI/7VEpdR
         J4DBcxngpxyUeCIR1jI5hewDwIoPk3m/u/t05pi3lTKE5x2DPUYr0ZYaUXm4RQTCExX7
         lo5Q==
X-Gm-Message-State: ALoCoQn28o0OW97paPXohcZERg50Uf/IiQcREePWwAcveS+v+6Q2oJJETxTPeSrFMpKnOIAYuwGMY81Sw+mGlnjdqPQFNCtrGk+OOM8GtbdP+JyqMroz05k=
MIME-Version: 1.0
X-Received: by 10.107.34.199 with SMTP id i190mr1210087ioi.150.1449533638879;
 Mon, 07 Dec 2015 16:13:58 -0800 (PST)
Received: by 10.107.62.136 with HTTP; Mon, 7 Dec 2015 16:13:58 -0800 (PST)
In-Reply-To: <CAKQ1sVOKT6_LUbC7pCFnykVYP_7L2vDj6ZWp_TOTsDXRDCjy-w@mail.gmail.com>
References: <CACsi250=dbRQKnsbE8JSdAZRm5x99gE0sgX3iQ-PHAx77euD1A@mail.gmail.com>
	<CAKQ1sVOKT6_LUbC7pCFnykVYP_7L2vDj6ZWp_TOTsDXRDCjy-w@mail.gmail.com>
Date: Mon, 7 Dec 2015 18:13:58 -0600
Message-ID: <CACsi251hXgqpzw6F4HjgoVhKYedRxrmoFFXeSAtHkw+3pJomOQ@mail.gmail.com>
Subject: Re: 2.4 pause - mod_http2 patchset Upgrade h2c vs mod_ssl Upgrade tls
From: William A Rowe Jr <wrowe@rowe-clan.net>
To: httpd <dev@httpd.apache.org>
Content-Type: multipart/alternative; boundary=001a1140d944a2b821052657d9ff

--001a1140d944a2b821052657d9ff
Content-Type: text/plain; charset=UTF-8

On Mon, Dec 7, 2015 at 6:07 PM, Yann Ylavic <ylavic.dev@gmail.com> wrote:

> On Mon, Dec 7, 2015 at 5:38 PM, William A Rowe Jr <wrowe@rowe-clan.net>
> wrote:
> >
> > https://tools.ietf.org/html/rfc7230#section-6.7 makes things more
> > interesting, it calls out that 101-continue and the request body read
> > precedes the 101-switching protocols.  Not sure who decided that would
> be a
> > good idea, sigh... but mod_ssl TLS upgrade has these reversed for several
> > good reasons including the intent to encrypt the request body if present
> and
> > simple economics of processing.
>
> As I read rfc7230#section-6.7 :
>
>    A client cannot begin using an upgraded protocol on the connection
>    until it has completely sent the request message (i.e., the client
>    can't change the protocol it is sending in the middle of a message).
>
> the server is supposed to respond with a 101 and than the Upgrade'd
> response (using the Upgrade protocol, eg. TLS/1.x), but *after* the
> request body is read (in plain text!).
> That means, for the TLS/1.x case, that the client handshake is
> supposed to arrive after a request body (if any), and hence mod_ssl
> can't assume the first request body is TLS'd, and the body ought to be
> set aside for any (relevant) TLS response (which needs the
> handshake...).
>
> I don't see this is working like this in mod_ssl, am I missing something ?
>

Yes you are missing the relevant design spec, RFC2817, now superseded
in part, in conjunction with RFC2616.

The behavior has to change, and my generalized proposal is in the message
immediately preceding this reply.


> Still rfc7230#section-6.7:
>
>    If a server receives both an Upgrade and an Expect header field with
>    the "100-continue" expectation (Section 5.1.1 of [RFC7231]), the
>    server MUST send a 100 (Continue) response before sending a 101
>    (Switching Protocols) response.
>
> The 100-continue case isn't a particular one IMHO, any Upgrade header
> would be informative, not authoritative (not a 101 status).
>

Not sure what you mean.  If an Upgrade: request is recieved and declined,
you are right, there is no 101-switching protocols, just the typical
http/1.1
response following any 100-continue negotiated request body.

--001a1140d944a2b821052657d9ff
Content-Type: text/html; charset=UTF-8
Content-Transfer-Encoding: quoted-printable

<div dir=3D"ltr"><div class=3D"gmail_extra"><div class=3D"gmail_quote">On M=
on, Dec 7, 2015 at 6:07 PM, Yann Ylavic <span dir=3D"ltr">&lt;<a href=3D"ma=
ilto:ylavic.dev@gmail.com" target=3D"_blank">ylavic.dev@gmail.com</a>&gt;</=
span> wrote:<br><blockquote class=3D"gmail_quote" style=3D"margin:0 0 0 .8e=
x;border-left:1px #ccc solid;padding-left:1ex"><span class=3D"">On Mon, Dec=
 7, 2015 at 5:38 PM, William A Rowe Jr &lt;<a href=3D"mailto:wrowe@rowe-cla=
n.net">wrowe@rowe-clan.net</a>&gt; wrote:<br>
&gt;<br>
&gt; <a href=3D"https://tools.ietf.org/html/rfc7230#section-6.7" rel=3D"nor=
eferrer" target=3D"_blank">https://tools.ietf.org/html/rfc7230#section-6.7<=
/a> makes things more<br>
&gt; interesting, it calls out that 101-continue and the request body read<=
br>
&gt; precedes the 101-switching protocols.=C2=A0 Not sure who decided that =
would be a<br>
&gt; good idea, sigh... but mod_ssl TLS upgrade has these reversed for seve=
ral<br>
&gt; good reasons including the intent to encrypt the request body if prese=
nt and<br>
&gt; simple economics of processing.<br>
<br>
</span>As I read rfc7230#section-6.7 :<br>
<br>
=C2=A0 =C2=A0A client cannot begin using an upgraded protocol on the connec=
tion<br>
=C2=A0 =C2=A0until it has completely sent the request message (i.e., the cl=
ient<br>
=C2=A0 =C2=A0can&#39;t change the protocol it is sending in the middle of a=
 message).<br>
<br>
the server is supposed to respond with a 101 and than the Upgrade&#39;d<br>
response (using the Upgrade protocol, eg. TLS/1.x), but *after* the<br>
request body is read (in plain text!).<br>
That means, for the TLS/1.x case, that the client handshake is<br>
supposed to arrive after a request body (if any), and hence mod_ssl<br>
can&#39;t assume the first request body is TLS&#39;d, and the body ought to=
 be<br>
set aside for any (relevant) TLS response (which needs the<br>
handshake...).<br>
<br>
I don&#39;t see this is working like this in mod_ssl, am I missing somethin=
g ?<br>
</blockquote><div><br></div><div>Yes you are missing the relevant design sp=
ec, RFC2817, now superseded=C2=A0</div><div>in part, in conjunction with RF=
C2616.</div><div><br></div><div>The behavior has to change, and my generali=
zed proposal is in the message</div><div>immediately preceding this reply.<=
/div><div>=C2=A0</div><blockquote class=3D"gmail_quote" style=3D"margin:0 0=
 0 .8ex;border-left:1px #ccc solid;padding-left:1ex">
Still rfc7230#section-6.7:<br>
<br>
=C2=A0 =C2=A0If a server receives both an Upgrade and an Expect header fiel=
d with<br>
=C2=A0 =C2=A0the &quot;100-continue&quot; expectation (Section 5.1.1 of [RF=
C7231]), the<br>
=C2=A0 =C2=A0server MUST send a 100 (Continue) response before sending a 10=
1<br>
=C2=A0 =C2=A0(Switching Protocols) response.<br>
<br>
The 100-continue case isn&#39;t a particular one IMHO, any Upgrade header<b=
r>
would be informative, not authoritative (not a 101 status).<br>
</blockquote></div><br></div><div class=3D"gmail_extra">Not sure what you m=
ean.=C2=A0 If an Upgrade: request is recieved and declined,</div><div class=
=3D"gmail_extra">you are right, there is no 101-switching protocols, just t=
he typical http/1.1=C2=A0</div><div class=3D"gmail_extra">response followin=
g any 100-continue negotiated request body.</div><div class=3D"gmail_extra"=
><br></div><div class=3D"gmail_extra"><br></div></div>

--001a1140d944a2b821052657d9ff--

From dev-return-84928-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Tue Dec  8 00:20:18 2015
Return-Path: <dev-return-84928-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 272F618D88
	for <apmail-httpd-dev-archive@www.apache.org>; Tue,  8 Dec 2015 00:20:18 +0000 (UTC)
Received: (qmail 36552 invoked by uid 500); 8 Dec 2015 00:20:17 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 36471 invoked by uid 500); 8 Dec 2015 00:20:17 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 36461 invoked by uid 99); 8 Dec 2015 00:20:17 -0000
Received: from Unknown (HELO spamd1-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 08 Dec 2015 00:20:17 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd1-us-west.apache.org (ASF Mail Server at spamd1-us-west.apache.org) with ESMTP id 2858FC64BE
	for <dev@httpd.apache.org>; Tue,  8 Dec 2015 00:20:17 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd1-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.121
X-Spam-Level:
X-Spam-Status: No, score=-0.121 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RCVD_IN_MSPIKE_H3=-0.01, RCVD_IN_MSPIKE_WL=-0.01, SPF_PASS=-0.001]
	autolearn=disabled
Authentication-Results: spamd1-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd1-us-west.apache.org [10.40.0.7]) (amavisd-new, port 10024)
	with ESMTP id A_pCD9-OQBej for <dev@httpd.apache.org>;
	Tue,  8 Dec 2015 00:20:16 +0000 (UTC)
Received: from mail-qk0-f180.google.com (mail-qk0-f180.google.com [209.85.220.180])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id DAB5C20DB9
	for <dev@httpd.apache.org>; Tue,  8 Dec 2015 00:20:15 +0000 (UTC)
Received: by qkfb125 with SMTP id b125so6113999qkf.2
        for <dev@httpd.apache.org>; Mon, 07 Dec 2015 16:15:14 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        bh=omoN/2MmxItDnEmM+xUwQlb8/0tDa1BgS8a8lT/Fz/8=;
        b=zwjX0Dd6qla8p6ItH2DxqBuxN15uqb5oig6+XTDdCWWMQeePlL5uXKnsZJt/Hsma3C
         Zd5yTsDEA9C/Bf76ztRk5UCaN6W/6Fp+FTZdQNsV2aU5fYDzrimcpuIRZRqeP5hN8Hcu
         aPJIQROdLg5waAdWYmrgCKOhQa+dPVIriAXBEyrx0KsQh9vqdU7+bPUtamnbcRtpSmcM
         U10my6GBbIq5JNLG6j88rbKAf7qMdb+9Vnps6fnC+mNFDbekRThKEsxW6bkfxCS4zj0h
         lG4HsbTixtaDttUi4ba/MhTNvlZmzENexM+1TdU94Xwtw9smepwJajt770dGCbA40q3S
         3b7w==
MIME-Version: 1.0
X-Received: by 10.55.77.9 with SMTP id a9mr820897qkb.38.1449533713939; Mon, 07
 Dec 2015 16:15:13 -0800 (PST)
Received: by 10.55.65.85 with HTTP; Mon, 7 Dec 2015 16:15:13 -0800 (PST)
In-Reply-To: <CAKQ1sVOKT6_LUbC7pCFnykVYP_7L2vDj6ZWp_TOTsDXRDCjy-w@mail.gmail.com>
References: <CACsi250=dbRQKnsbE8JSdAZRm5x99gE0sgX3iQ-PHAx77euD1A@mail.gmail.com>
	<CAKQ1sVOKT6_LUbC7pCFnykVYP_7L2vDj6ZWp_TOTsDXRDCjy-w@mail.gmail.com>
Date: Tue, 8 Dec 2015 01:15:13 +0100
Message-ID: <CAKQ1sVOHSrFjkDR5yi-N2M6qbCyMQ=Z6+=NcJ+FuYpXg_+W1qg@mail.gmail.com>
Subject: Re: 2.4 pause - mod_http2 patchset Upgrade h2c vs mod_ssl Upgrade tls
From: Yann Ylavic <ylavic.dev@gmail.com>
To: httpd-dev <dev@httpd.apache.org>
Content-Type: text/plain; charset=UTF-8

On Tue, Dec 8, 2015 at 1:07 AM, Yann Ylavic <ylavic.dev@gmail.com> wrote:
>
> the body ought to be
> set aside for any (relevant) TLS response (which needs the
> handshake...).

Hmm, no need to set aside, *unless* with must produce a response
before the entire body (and the handshake) is read.
But we'd better not Upgrade in this case...

From dev-return-84929-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Tue Dec  8 00:32:30 2015
Return-Path: <dev-return-84929-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id EA55818E12
	for <apmail-httpd-dev-archive@www.apache.org>; Tue,  8 Dec 2015 00:32:30 +0000 (UTC)
Received: (qmail 57325 invoked by uid 500); 8 Dec 2015 00:32:30 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 57242 invoked by uid 500); 8 Dec 2015 00:32:30 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 57232 invoked by uid 99); 8 Dec 2015 00:32:30 -0000
Received: from Unknown (HELO spamd2-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 08 Dec 2015 00:32:30 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd2-us-west.apache.org (ASF Mail Server at spamd2-us-west.apache.org) with ESMTP id C30711A0BF5
	for <dev@httpd.apache.org>; Tue,  8 Dec 2015 00:32:29 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd2-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 2.998
X-Spam-Level: **
X-Spam-Status: No, score=2.998 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, HTML_MESSAGE=3,
	RCVD_IN_MSPIKE_H2=-0.001, SPF_PASS=-0.001] autolearn=disabled
Authentication-Results: spamd2-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=rowe-clan-net.20150623.gappssmtp.com
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd2-us-west.apache.org [10.40.0.9]) (amavisd-new, port 10024)
	with ESMTP id MXqRUWVX7bq5 for <dev@httpd.apache.org>;
	Tue,  8 Dec 2015 00:32:28 +0000 (UTC)
Received: from mail-io0-f169.google.com (mail-io0-f169.google.com [209.85.223.169])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id BFF6120DB9
	for <dev@httpd.apache.org>; Tue,  8 Dec 2015 00:32:27 +0000 (UTC)
Received: by iouu10 with SMTP id u10so8493516iou.0
        for <dev@httpd.apache.org>; Mon, 07 Dec 2015 16:27:20 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=rowe-clan-net.20150623.gappssmtp.com; s=20150623;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        bh=oCJrTWLVUXEfTjF5w5soWdvnm2Bj9Kn4Ev1xE/JGBUg=;
        b=DLo7y33SuColDmdGDAOZLJeJjCzTUno+RGEqL9gS0b2C/s+gHmE8ka6Rk0a1SpOiW/
         0i5bD7OXXRK0REjh47+ATDF1Yp1YpZab02Xse2apNdytCWbyhvB6U2HF9LL6zx4gs1yc
         71iHpSKeBcZrFLJPQ3I/ydsY2sz07GVWEezVikiSdbJcN5sCKSqZYaEIvg7WgJ2/lIhH
         QBRLkqtOLEf3o1IcRhgHrrYmKcdsDzvSFMDZQSLPPKJue0bPsmz9cGiCW1mFjrXVb7Ec
         SspE50o6QZaA/rs1gLugNjILR4rFgxoIQxasheemBo6O7zVfDrGXQUwkYLzgd4IeA29P
         CelA==
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=1e100.net; s=20130820;
        h=x-gm-message-state:mime-version:in-reply-to:references:date
         :message-id:subject:from:to:content-type;
        bh=oCJrTWLVUXEfTjF5w5soWdvnm2Bj9Kn4Ev1xE/JGBUg=;
        b=ACMGMXkRIuomMBbFv2ByObQ3bWM40KoqunCeGSDDLNOZp7eHX+bPY6njtcmwtIxXIa
         nqA05KXFT41NkvNGckTemUEsAG6u89oDFnfBEAVI6ZfIB2hDayIxwQyt6jCyIHpK6C4f
         Iv4S2OC1VTdmBKVHYPFR7kg4q21SG+r8K1W9vIEE0lk0RQBLjmMdGgBVhsRNiPc1nhaT
         lPNxmMDoTcesdj9l/ZV4CIZQpllYYkTzPVfrjQw3S8jJNePccJvG/0jpRMt0sCUZog+8
         5NXWEGYHzkQEVYB3d3FE/ghqP9F2mquBF9tI43+UFiVXV0to986e9WLkbAZf3I/sdF8M
         E1bw==
X-Gm-Message-State: ALoCoQlwx9pfF3vkaZTOmJroDjdzpC9F0KcTKtiw/xAR/G2/2ajH+HwtkiJxOxM59shEDezaWDEvyhOnGPvGAPEvSO52K1AleuC3ufyF84gp0TaIR3grEvg=
MIME-Version: 1.0
X-Received: by 10.107.10.66 with SMTP id u63mr1149810ioi.86.1449534440766;
 Mon, 07 Dec 2015 16:27:20 -0800 (PST)
Received: by 10.107.62.136 with HTTP; Mon, 7 Dec 2015 16:27:20 -0800 (PST)
In-Reply-To: <CAKQ1sVOHSrFjkDR5yi-N2M6qbCyMQ=Z6+=NcJ+FuYpXg_+W1qg@mail.gmail.com>
References: <CACsi250=dbRQKnsbE8JSdAZRm5x99gE0sgX3iQ-PHAx77euD1A@mail.gmail.com>
	<CAKQ1sVOKT6_LUbC7pCFnykVYP_7L2vDj6ZWp_TOTsDXRDCjy-w@mail.gmail.com>
	<CAKQ1sVOHSrFjkDR5yi-N2M6qbCyMQ=Z6+=NcJ+FuYpXg_+W1qg@mail.gmail.com>
Date: Mon, 7 Dec 2015 18:27:20 -0600
Message-ID: <CACsi251o57Qmj3rvCO1cLgULcrxZUb=OEa6mKz+1SGus6-yoig@mail.gmail.com>
Subject: Re: 2.4 pause - mod_http2 patchset Upgrade h2c vs mod_ssl Upgrade tls
From: William A Rowe Jr <wrowe@rowe-clan.net>
To: httpd <dev@httpd.apache.org>
Content-Type: multipart/alternative; boundary=001a113f93be6eaaec052658090b

--001a113f93be6eaaec052658090b
Content-Type: text/plain; charset=UTF-8

On Mon, Dec 7, 2015 at 6:15 PM, Yann Ylavic <ylavic.dev@gmail.com> wrote:

> On Tue, Dec 8, 2015 at 1:07 AM, Yann Ylavic <ylavic.dev@gmail.com> wrote:
> >
> > the body ought to be
> > set aside for any (relevant) TLS response (which needs the
> > handshake...).
>
> Hmm, no need to set aside, *unless* with must produce a response
> before the entire body (and the handshake) is read.
> But we'd better not Upgrade in this case...
>

Yes, there is a set aside, because the handler will read from the filter
stack... the handler phase has not yet occurred, and other content
input filters may be inserted to transform the request body.

The upgrade switch would occur before the request content handler
is invoked, in all cases (post_read_request, or later during fixups
or the very beginning of invoke_handler).

--001a113f93be6eaaec052658090b
Content-Type: text/html; charset=UTF-8
Content-Transfer-Encoding: quoted-printable

<div dir=3D"ltr"><div class=3D"gmail_extra"><div class=3D"gmail_quote">On M=
on, Dec 7, 2015 at 6:15 PM, Yann Ylavic <span dir=3D"ltr">&lt;<a href=3D"ma=
ilto:ylavic.dev@gmail.com" target=3D"_blank">ylavic.dev@gmail.com</a>&gt;</=
span> wrote:<br><blockquote class=3D"gmail_quote" style=3D"margin:0 0 0 .8e=
x;border-left:1px #ccc solid;padding-left:1ex"><span class=3D"">On Tue, Dec=
 8, 2015 at 1:07 AM, Yann Ylavic &lt;<a href=3D"mailto:ylavic.dev@gmail.com=
">ylavic.dev@gmail.com</a>&gt; wrote:<br>
&gt;<br>
&gt; the body ought to be<br>
&gt; set aside for any (relevant) TLS response (which needs the<br>
&gt; handshake...).<br>
<br>
</span>Hmm, no need to set aside, *unless* with must produce a response<br>
before the entire body (and the handshake) is read.<br>
But we&#39;d better not Upgrade in this case...<br>
</blockquote></div><br></div><div class=3D"gmail_extra">Yes, there is a set=
 aside, because the handler will read from the filter</div><div class=3D"gm=
ail_extra">stack... the handler phase has not yet occurred, and other conte=
nt</div><div class=3D"gmail_extra">input filters may be inserted to transfo=
rm the request body.</div><div class=3D"gmail_extra"><br></div><div class=
=3D"gmail_extra">The upgrade switch would occur before the request content =
handler=C2=A0</div><div class=3D"gmail_extra">is invoked, in all cases (pos=
t_read_request, or later during fixups</div><div class=3D"gmail_extra">or t=
he very beginning of invoke_handler).</div><div class=3D"gmail_extra"><br><=
/div><div class=3D"gmail_extra"><br></div></div>

--001a113f93be6eaaec052658090b--

From dev-return-84930-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Tue Dec  8 00:32:45 2015
Return-Path: <dev-return-84930-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 5E27A18E16
	for <apmail-httpd-dev-archive@www.apache.org>; Tue,  8 Dec 2015 00:32:45 +0000 (UTC)
Received: (qmail 58417 invoked by uid 500); 8 Dec 2015 00:32:44 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 58341 invoked by uid 500); 8 Dec 2015 00:32:44 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 58331 invoked by uid 99); 8 Dec 2015 00:32:44 -0000
Received: from Unknown (HELO spamd2-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 08 Dec 2015 00:32:44 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd2-us-west.apache.org (ASF Mail Server at spamd2-us-west.apache.org) with ESMTP id 6AF611A0BF5
	for <dev@httpd.apache.org>; Tue,  8 Dec 2015 00:32:44 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd2-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.101
X-Spam-Level:
X-Spam-Status: No, score=-0.101 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RCVD_IN_MSPIKE_H2=-0.001, SPF_PASS=-0.001, URIBL_BLOCKED=0.001]
	autolearn=disabled
Authentication-Results: spamd2-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd2-us-west.apache.org [10.40.0.9]) (amavisd-new, port 10024)
	with ESMTP id UlecdS98_Lsn for <dev@httpd.apache.org>;
	Tue,  8 Dec 2015 00:32:38 +0000 (UTC)
Received: from mail-qg0-f52.google.com (mail-qg0-f52.google.com [209.85.192.52])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id F390542AD4
	for <dev@httpd.apache.org>; Tue,  8 Dec 2015 00:32:37 +0000 (UTC)
Received: by qgec40 with SMTP id c40so3697277qge.2
        for <dev@httpd.apache.org>; Mon, 07 Dec 2015 16:32:37 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        bh=Z1/p0ns737wxwdLqmWwS4dgBVpfxpSnpIJl5I+HB60A=;
        b=c31RNY9n4mQT19luvGNeIVfkgKJ4ikbJ2RFkNhOIUM1+ZOY3HCmfQW/LHrNwngpVA2
         82jzY+RA4HkmSNCb7nmuyzXHeeHmxs63jzv+6dE8Sxy8Le5Bb0gPwS+NEPDZ4qB3gGNY
         d+cRO0RJIFO3waEbvsnIzSZdiudJz9RGGUjm9bHE+i3RyJ6jt3eLoy/Mn7ASluueEtkP
         5L/gptiuFakptLEsD89v9oDkFqyEqLbJoflTl63jMmAeAv2kCLoHRCWDO/ALVZ2+GyZ8
         FVeDtNXuESJFroaMgPK3kxoS9HVSVZQwulgn9rD2/Wf/yH+QWS2X/0U5vRB8NM7rOvhB
         NB2A==
MIME-Version: 1.0
X-Received: by 10.140.220.136 with SMTP id q130mr937373qhb.24.1449534757611;
 Mon, 07 Dec 2015 16:32:37 -0800 (PST)
Received: by 10.55.65.85 with HTTP; Mon, 7 Dec 2015 16:32:37 -0800 (PST)
In-Reply-To: <CACsi251hXgqpzw6F4HjgoVhKYedRxrmoFFXeSAtHkw+3pJomOQ@mail.gmail.com>
References: <CACsi250=dbRQKnsbE8JSdAZRm5x99gE0sgX3iQ-PHAx77euD1A@mail.gmail.com>
	<CAKQ1sVOKT6_LUbC7pCFnykVYP_7L2vDj6ZWp_TOTsDXRDCjy-w@mail.gmail.com>
	<CACsi251hXgqpzw6F4HjgoVhKYedRxrmoFFXeSAtHkw+3pJomOQ@mail.gmail.com>
Date: Tue, 8 Dec 2015 01:32:37 +0100
Message-ID: <CAKQ1sVOvJHGN6=nG=H2_Ttb6_r5kQmtdg-QyHG2mDV59u8q+Ow@mail.gmail.com>
Subject: Re: 2.4 pause - mod_http2 patchset Upgrade h2c vs mod_ssl Upgrade tls
From: Yann Ylavic <ylavic.dev@gmail.com>
To: httpd-dev <dev@httpd.apache.org>
Content-Type: text/plain; charset=UTF-8

On Tue, Dec 8, 2015 at 1:13 AM, William A Rowe Jr <wrowe@rowe-clan.net> wrote:
> On Mon, Dec 7, 2015 at 6:07 PM, Yann Ylavic <ylavic.dev@gmail.com> wrote:
>>
>> The 100-continue case isn't a particular one IMHO, any Upgrade header
>> would be informative, not authoritative (not a 101 status).
>
> Not sure what you mean.  If an Upgrade: request is recieved and declined,
> you are right, there is no 101-switching protocols, just the typical
> http/1.1
> response following any 100-continue negotiated request body.

I mean if httpd honors a 100-continue, it has to be done before the
101 Switching Protocols, either in the http_filter (like currently),
or if the request is proxyed and we implement end-to-end 100-continue
(I'm working on this), by forwarding the backend's 100-continue.
Then we can upgrade with 101 for the real response.

It's not different than a normal request with a body and no
100-continue expection IMHO.

From dev-return-84931-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Tue Dec  8 00:35:44 2015
Return-Path: <dev-return-84931-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 600C318E36
	for <apmail-httpd-dev-archive@www.apache.org>; Tue,  8 Dec 2015 00:35:44 +0000 (UTC)
Received: (qmail 66291 invoked by uid 500); 8 Dec 2015 00:35:43 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 66205 invoked by uid 500); 8 Dec 2015 00:35:43 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 66195 invoked by uid 99); 8 Dec 2015 00:35:43 -0000
Received: from Unknown (HELO spamd4-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 08 Dec 2015 00:35:43 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd4-us-west.apache.org (ASF Mail Server at spamd4-us-west.apache.org) with ESMTP id 759D1C0481
	for <dev@httpd.apache.org>; Tue,  8 Dec 2015 00:35:43 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd4-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.12
X-Spam-Level:
X-Spam-Status: No, score=-0.12 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RCVD_IN_MSPIKE_H3=-0.01, RCVD_IN_MSPIKE_WL=-0.01, SPF_PASS=-0.001,
	URIBL_BLOCKED=0.001] autolearn=disabled
Authentication-Results: spamd4-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd4-us-west.apache.org [10.40.0.11]) (amavisd-new, port 10024)
	with ESMTP id a2kmD7qYClTa for <dev@httpd.apache.org>;
	Tue,  8 Dec 2015 00:35:37 +0000 (UTC)
Received: from mail-qk0-f179.google.com (mail-qk0-f179.google.com [209.85.220.179])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id E3AD44452E
	for <dev@httpd.apache.org>; Tue,  8 Dec 2015 00:35:36 +0000 (UTC)
Received: by qkht125 with SMTP id t125so6623217qkh.3
        for <dev@httpd.apache.org>; Mon, 07 Dec 2015 16:35:36 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        bh=Fo6MBUVnx8e3/C9Hu2eCFtetr6GdZ0DKYxmop+QUliM=;
        b=VE4W+vtTYLVoRVcXqrJ9tmxmfhmkhG3bh3ZDG+icKtqzsuUb7TFBioB+Nt5TY/MTF3
         zjw26rwJ25pQYP7xWVn71r4xZ0/OGKE4ml5fvBhGaWkFzN4Pws1ICEvNYKB6ZMtvAYwO
         9iAbJOinSaDx0HPLo8rJXFXkdhHkV2bnYI0bqpobsGM/5+eGsVZttqouvr1CBT/WI5ot
         iWZKhcX4UNGuZtJLGdUK/YF1XsXVC2OCoVHMl5eHo+XKiOS5xInaeY0b9a+UBnJYZ34u
         z79UbOl0NlIOI3pF3cZnKCgo2ejVoUkdPSIJN8eoIHQp5cTPL+3uQM96OGOQNfgXZ8ZN
         2+zA==
MIME-Version: 1.0
X-Received: by 10.55.77.9 with SMTP id a9mr905992qkb.38.1449534936637; Mon, 07
 Dec 2015 16:35:36 -0800 (PST)
Received: by 10.55.65.85 with HTTP; Mon, 7 Dec 2015 16:35:36 -0800 (PST)
In-Reply-To: <CACsi251o57Qmj3rvCO1cLgULcrxZUb=OEa6mKz+1SGus6-yoig@mail.gmail.com>
References: <CACsi250=dbRQKnsbE8JSdAZRm5x99gE0sgX3iQ-PHAx77euD1A@mail.gmail.com>
	<CAKQ1sVOKT6_LUbC7pCFnykVYP_7L2vDj6ZWp_TOTsDXRDCjy-w@mail.gmail.com>
	<CAKQ1sVOHSrFjkDR5yi-N2M6qbCyMQ=Z6+=NcJ+FuYpXg_+W1qg@mail.gmail.com>
	<CACsi251o57Qmj3rvCO1cLgULcrxZUb=OEa6mKz+1SGus6-yoig@mail.gmail.com>
Date: Tue, 8 Dec 2015 01:35:36 +0100
Message-ID: <CAKQ1sVOKJhX5rUM-hixx2s8HtBPNYY+pJYf3-Uedrvwuaq6PPQ@mail.gmail.com>
Subject: Re: 2.4 pause - mod_http2 patchset Upgrade h2c vs mod_ssl Upgrade tls
From: Yann Ylavic <ylavic.dev@gmail.com>
To: httpd-dev <dev@httpd.apache.org>
Content-Type: text/plain; charset=UTF-8

On Tue, Dec 8, 2015 at 1:27 AM, William A Rowe Jr <wrowe@rowe-clan.net> wrote:
> On Mon, Dec 7, 2015 at 6:15 PM, Yann Ylavic <ylavic.dev@gmail.com> wrote:
>>
>> On Tue, Dec 8, 2015 at 1:07 AM, Yann Ylavic <ylavic.dev@gmail.com> wrote:
>> >
>> > the body ought to be
>> > set aside for any (relevant) TLS response (which needs the
>> > handshake...).
>>
>> Hmm, no need to set aside, *unless* with must produce a response
>> before the entire body (and the handshake) is read.
>> But we'd better not Upgrade in this case...
>
>
> Yes, there is a set aside, because the handler will read from the filter
> stack... the handler phase has not yet occurred, and other content
> input filters may be inserted to transform the request body.
>
> The upgrade switch would occur before the request content handler
> is invoked, in all cases (post_read_request, or later during fixups
> or the very beginning of invoke_handler).

But this isn't what the RFC says, right?
The body of the first request is never Upgraded, so why would we read
it using the Upgraded protocol?

From dev-return-84932-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Tue Dec  8 00:58:57 2015
Return-Path: <dev-return-84932-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 8CD5B18F49
	for <apmail-httpd-dev-archive@www.apache.org>; Tue,  8 Dec 2015 00:58:57 +0000 (UTC)
Received: (qmail 6859 invoked by uid 500); 8 Dec 2015 00:58:57 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 6773 invoked by uid 500); 8 Dec 2015 00:58:57 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 6763 invoked by uid 99); 8 Dec 2015 00:58:56 -0000
Received: from Unknown (HELO spamd1-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 08 Dec 2015 00:58:56 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd1-us-west.apache.org (ASF Mail Server at spamd1-us-west.apache.org) with ESMTP id 784B4C55F3
	for <dev@httpd.apache.org>; Tue,  8 Dec 2015 00:58:56 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd1-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 2.999
X-Spam-Level: **
X-Spam-Status: No, score=2.999 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, HTML_MESSAGE=3,
	RCVD_IN_MSPIKE_H2=-0.001, SPF_PASS=-0.001, URIBL_BLOCKED=0.001]
	autolearn=disabled
Authentication-Results: spamd1-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=rowe-clan-net.20150623.gappssmtp.com
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd1-us-west.apache.org [10.40.0.7]) (amavisd-new, port 10024)
	with ESMTP id oaDthjyDBkBE for <dev@httpd.apache.org>;
	Tue,  8 Dec 2015 00:58:50 +0000 (UTC)
Received: from mail-io0-f176.google.com (mail-io0-f176.google.com [209.85.223.176])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id B2BFC20F4F
	for <dev@httpd.apache.org>; Tue,  8 Dec 2015 00:58:49 +0000 (UTC)
Received: by iofh3 with SMTP id h3so8820902iof.3
        for <dev@httpd.apache.org>; Mon, 07 Dec 2015 16:58:48 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=rowe-clan-net.20150623.gappssmtp.com; s=20150623;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        bh=L8+sbMq/NFYZ3J2TXQV3l7YyT1hT4FOjwt73oB0Y0iI=;
        b=K8gXWnD2hWAIHlPHsg43d3bPHStqcCyVjhjCEsF/mcr7XYjlrPVEATKXWUgDrgU81N
         9kKgqL1HwN2u8kAFdUZSNrvTqyHcJ6zLTNPEb8+OgrXP9EGllmNQpzGMSAFLliBUVN5G
         gktyXp0Wp8VqmyEdwuOf9wwzvI3eKhVBnkrYkc8+TydVET3/IKmnl/ptCzY0mZbMidLz
         5Y5CQZ5y7YZTimlPoZtfbQuf6/to2pc+3swSKToDG+ZE3ZIs3r2kUkHVseeALk3qnNcu
         +p89yFqlLgSXMqGX2drCZ9QKOHg4hr1FOi8YG2I2v5XnY8aRGlS6en5ywt/mNUC3cPu0
         RgNQ==
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=1e100.net; s=20130820;
        h=x-gm-message-state:mime-version:in-reply-to:references:date
         :message-id:subject:from:to:content-type;
        bh=L8+sbMq/NFYZ3J2TXQV3l7YyT1hT4FOjwt73oB0Y0iI=;
        b=frwVNxOPyfW0FEewub0tCaZo3I8w+AZbHEEhC434OJVaLA1m2b6S7znTAE7e1cZtDo
         iGmhvV3czqYouaoynsxge2ELNMYcGI4s5z0X1g3IF5RgXE9KfXesgAan2jKhMSMtw2CT
         OLFO9J4Tn62G4X3kr9M9ZIs9zUaM8zD6XIOYKHoj+/8ieFRMQfoHTA7/N/Me8I/ALRGK
         I4EaGBXASAIgJ5si2EpraMsMrJ6N7Ju5kHkaD+I5JSdVTPkE+QGZP4TKTdHIdhbNsGxT
         N6wMZN5QfBpSLL3qS5mr/g9se1mOJ0CXTOxXGOZHSHusL4zp+AHHKSA1dSl7wQ+H/c+j
         2zOg==
X-Gm-Message-State: ALoCoQkOprUFL1FbP4ycF4MVStZB78ArDkCQM0HtjEio8ulVZoe8dyvIer8tRATmevKWvg1x46yw5DlKUmqWBS7zrOTHLLawxQhSo/rvaisj6KrR6TpXCdM=
MIME-Version: 1.0
X-Received: by 10.107.34.199 with SMTP id i190mr1363335ioi.150.1449536328699;
 Mon, 07 Dec 2015 16:58:48 -0800 (PST)
Received: by 10.107.62.136 with HTTP; Mon, 7 Dec 2015 16:58:48 -0800 (PST)
In-Reply-To: <CAKQ1sVOKJhX5rUM-hixx2s8HtBPNYY+pJYf3-Uedrvwuaq6PPQ@mail.gmail.com>
References: <CACsi250=dbRQKnsbE8JSdAZRm5x99gE0sgX3iQ-PHAx77euD1A@mail.gmail.com>
	<CAKQ1sVOKT6_LUbC7pCFnykVYP_7L2vDj6ZWp_TOTsDXRDCjy-w@mail.gmail.com>
	<CAKQ1sVOHSrFjkDR5yi-N2M6qbCyMQ=Z6+=NcJ+FuYpXg_+W1qg@mail.gmail.com>
	<CACsi251o57Qmj3rvCO1cLgULcrxZUb=OEa6mKz+1SGus6-yoig@mail.gmail.com>
	<CAKQ1sVOKJhX5rUM-hixx2s8HtBPNYY+pJYf3-Uedrvwuaq6PPQ@mail.gmail.com>
Date: Mon, 7 Dec 2015 18:58:48 -0600
Message-ID: <CACsi252Cq5GfmcXxFZebqyWXSaD=qZeSRBDAnVjbDJSoM4Ri=g@mail.gmail.com>
Subject: Re: 2.4 pause - mod_http2 patchset Upgrade h2c vs mod_ssl Upgrade tls
From: William A Rowe Jr <wrowe@rowe-clan.net>
To: httpd <dev@httpd.apache.org>
Content-Type: multipart/alternative; boundary=001a1140d944f62a19052658790b

--001a1140d944f62a19052658790b
Content-Type: text/plain; charset=UTF-8

On Mon, Dec 7, 2015 at 6:35 PM, Yann Ylavic <ylavic.dev@gmail.com> wrote:

> On Tue, Dec 8, 2015 at 1:27 AM, William A Rowe Jr <wrowe@rowe-clan.net>
> wrote:
> > On Mon, Dec 7, 2015 at 6:15 PM, Yann Ylavic <ylavic.dev@gmail.com>
> wrote:
> >>
> >> On Tue, Dec 8, 2015 at 1:07 AM, Yann Ylavic <ylavic.dev@gmail.com>
> wrote:
> >> >
> >> > the body ought to be
> >> > set aside for any (relevant) TLS response (which needs the
> >> > handshake...).
> >>
> >> Hmm, no need to set aside, *unless* with must produce a response
> >> before the entire body (and the handshake) is read.
> >> But we'd better not Upgrade in this case...
> >
> >
> > Yes, there is a set aside, because the handler will read from the filter
> > stack... the handler phase has not yet occurred, and other content
> > input filters may be inserted to transform the request body.
> >
> > The upgrade switch would occur before the request content handler
> > is invoked, in all cases (post_read_request, or later during fixups
> > or the very beginning of invoke_handler).
>
> But this isn't what the RFC says, right?
> The body of the first request is never Upgraded, so why would we read
> it using the Upgraded protocol?
>

How do you mean?  The RFC states we must read the request body
(following a 100-continue) prior to a 101-switching protocols.  AFTER
the protocol is switched, we are ready to invoke the handler, which
will read the request body (which I suggest we have set aside within
the http input filter) and it will write to the output filter stack, but to
a different stack of protocol and network filters.

Depending on the protocol, it may have to perform some magic to
move the (smaller) request body over to a new protocol if the http/1.1
filter will no longer be in the stack.

If the request body can't be set aside while still speaking http/1.1
(buffer too small, etc) then in that case we cannot honor the upgrade:
request or switch protocols at all.

--001a1140d944f62a19052658790b
Content-Type: text/html; charset=UTF-8
Content-Transfer-Encoding: quoted-printable

<div dir=3D"ltr"><div class=3D"gmail_extra"><div class=3D"gmail_quote">On M=
on, Dec 7, 2015 at 6:35 PM, Yann Ylavic <span dir=3D"ltr">&lt;<a href=3D"ma=
ilto:ylavic.dev@gmail.com" target=3D"_blank">ylavic.dev@gmail.com</a>&gt;</=
span> wrote:<br><blockquote class=3D"gmail_quote" style=3D"margin:0 0 0 .8e=
x;border-left:1px #ccc solid;padding-left:1ex"><div class=3D"HOEnZb"><div c=
lass=3D"h5">On Tue, Dec 8, 2015 at 1:27 AM, William A Rowe Jr &lt;<a href=
=3D"mailto:wrowe@rowe-clan.net">wrowe@rowe-clan.net</a>&gt; wrote:<br>
&gt; On Mon, Dec 7, 2015 at 6:15 PM, Yann Ylavic &lt;<a href=3D"mailto:ylav=
ic.dev@gmail.com">ylavic.dev@gmail.com</a>&gt; wrote:<br>
&gt;&gt;<br>
&gt;&gt; On Tue, Dec 8, 2015 at 1:07 AM, Yann Ylavic &lt;<a href=3D"mailto:=
ylavic.dev@gmail.com">ylavic.dev@gmail.com</a>&gt; wrote:<br>
&gt;&gt; &gt;<br>
&gt;&gt; &gt; the body ought to be<br>
&gt;&gt; &gt; set aside for any (relevant) TLS response (which needs the<br=
>
&gt;&gt; &gt; handshake...).<br>
&gt;&gt;<br>
&gt;&gt; Hmm, no need to set aside, *unless* with must produce a response<b=
r>
&gt;&gt; before the entire body (and the handshake) is read.<br>
&gt;&gt; But we&#39;d better not Upgrade in this case...<br>
&gt;<br>
&gt;<br>
&gt; Yes, there is a set aside, because the handler will read from the filt=
er<br>
&gt; stack... the handler phase has not yet occurred, and other content<br>
&gt; input filters may be inserted to transform the request body.<br>
&gt;<br>
&gt; The upgrade switch would occur before the request content handler<br>
&gt; is invoked, in all cases (post_read_request, or later during fixups<br=
>
&gt; or the very beginning of invoke_handler).<br>
<br>
</div></div>But this isn&#39;t what the RFC says, right?<br>
The body of the first request is never Upgraded, so why would we read<br>
it using the Upgraded protocol?<br>
</blockquote></div><br></div><div class=3D"gmail_extra">How do you mean?=C2=
=A0 The RFC states we must read the request body</div><div class=3D"gmail_e=
xtra">(following a 100-continue) prior to a 101-switching protocols.=C2=A0 =
AFTER</div><div class=3D"gmail_extra">the protocol is switched, we are read=
y to invoke the handler, which</div><div class=3D"gmail_extra">will read th=
e request body (which I suggest we have set aside within=C2=A0</div><div cl=
ass=3D"gmail_extra">the http input filter) and it will write to the output =
filter stack, but to=C2=A0</div><div class=3D"gmail_extra">a different stac=
k of protocol and network filters.</div><div class=3D"gmail_extra"><br></di=
v><div class=3D"gmail_extra">Depending on the protocol, it may have to perf=
orm some magic to</div><div class=3D"gmail_extra">move the (smaller) reques=
t body over to a new protocol if the http/1.1</div><div class=3D"gmail_extr=
a">filter will no longer be in the stack.</div><div class=3D"gmail_extra"><=
br></div><div class=3D"gmail_extra">If the request body can&#39;t be set as=
ide while still speaking http/1.1=C2=A0</div><div class=3D"gmail_extra">(bu=
ffer too small, etc) then in that case we cannot honor the upgrade:=C2=A0</=
div><div class=3D"gmail_extra">request or switch protocols at all.</div><di=
v class=3D"gmail_extra"><br></div><div class=3D"gmail_extra"><br></div><div=
 class=3D"gmail_extra"><br></div></div>

--001a1140d944f62a19052658790b--

From dev-return-84933-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Tue Dec  8 01:29:29 2015
Return-Path: <dev-return-84933-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id A465318036
	for <apmail-httpd-dev-archive@www.apache.org>; Tue,  8 Dec 2015 01:29:29 +0000 (UTC)
Received: (qmail 48273 invoked by uid 500); 8 Dec 2015 01:29:28 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 48201 invoked by uid 500); 8 Dec 2015 01:29:28 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 48189 invoked by uid 99); 8 Dec 2015 01:29:28 -0000
Received: from Unknown (HELO spamd3-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 08 Dec 2015 01:29:28 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd3-us-west.apache.org (ASF Mail Server at spamd3-us-west.apache.org) with ESMTP id F0C1A180A6F
	for <dev@httpd.apache.org>; Tue,  8 Dec 2015 01:29:27 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd3-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.101
X-Spam-Level:
X-Spam-Status: No, score=-0.101 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RCVD_IN_MSPIKE_H2=-0.001, SPF_PASS=-0.001, URIBL_BLOCKED=0.001]
	autolearn=disabled
Authentication-Results: spamd3-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd3-us-west.apache.org [10.40.0.10]) (amavisd-new, port 10024)
	with ESMTP id IFh7kfihKl21 for <dev@httpd.apache.org>;
	Tue,  8 Dec 2015 01:29:21 +0000 (UTC)
Received: from mail-qg0-f44.google.com (mail-qg0-f44.google.com [209.85.192.44])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id CEF9620E9B
	for <dev@httpd.apache.org>; Tue,  8 Dec 2015 01:29:20 +0000 (UTC)
Received: by qgcc31 with SMTP id c31so4544311qgc.3
        for <dev@httpd.apache.org>; Mon, 07 Dec 2015 17:29:14 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        bh=24EwnfRUcPBEoFHoKX5av7X9g5z7ag1swQ0bOGV2XwM=;
        b=NfhWYlVZu4Zkw9j6UcD2xMjj5GLYeS0wcmivf0uAeiBJDDoJRK+QlNZojTYzHNI//h
         KKxM6GvnMWC4Xm8e6phMn5ND4pQ5oWH88V0DJ9eKSgOwRUrJQCiLxoDPblrrticuF5Yy
         PtbEcuSRmolSBKoXCmQKXEc2md01G5FlgY025tFCUiU/v82OxradZcGG9e5gCXforbxU
         6bLAC/X6BMHhl89FP9NoJsOApotBeGuHIdwsRWabMCWPX0kebon5XanQInVpJDxUezXW
         4Wu8ga74y9laHjQKofqvYfpyYeVYEH7Ue3drrrCfPmvV3U0HkPL2SRjS6DjlK+9cnNKi
         zhwQ==
MIME-Version: 1.0
X-Received: by 10.140.226.198 with SMTP id w189mr1143966qhb.83.1449538153977;
 Mon, 07 Dec 2015 17:29:13 -0800 (PST)
Received: by 10.55.65.85 with HTTP; Mon, 7 Dec 2015 17:29:13 -0800 (PST)
In-Reply-To: <CACsi252Cq5GfmcXxFZebqyWXSaD=qZeSRBDAnVjbDJSoM4Ri=g@mail.gmail.com>
References: <CACsi250=dbRQKnsbE8JSdAZRm5x99gE0sgX3iQ-PHAx77euD1A@mail.gmail.com>
	<CAKQ1sVOKT6_LUbC7pCFnykVYP_7L2vDj6ZWp_TOTsDXRDCjy-w@mail.gmail.com>
	<CAKQ1sVOHSrFjkDR5yi-N2M6qbCyMQ=Z6+=NcJ+FuYpXg_+W1qg@mail.gmail.com>
	<CACsi251o57Qmj3rvCO1cLgULcrxZUb=OEa6mKz+1SGus6-yoig@mail.gmail.com>
	<CAKQ1sVOKJhX5rUM-hixx2s8HtBPNYY+pJYf3-Uedrvwuaq6PPQ@mail.gmail.com>
	<CACsi252Cq5GfmcXxFZebqyWXSaD=qZeSRBDAnVjbDJSoM4Ri=g@mail.gmail.com>
Date: Tue, 8 Dec 2015 02:29:13 +0100
Message-ID: <CAKQ1sVPCw_wjurNSgzE2c+f_PJjwLd=-0zezfr=DGT+se9xG6A@mail.gmail.com>
Subject: Re: 2.4 pause - mod_http2 patchset Upgrade h2c vs mod_ssl Upgrade tls
From: Yann Ylavic <ylavic.dev@gmail.com>
To: httpd-dev <dev@httpd.apache.org>
Content-Type: text/plain; charset=UTF-8

On Tue, Dec 8, 2015 at 1:58 AM, William A Rowe Jr <wrowe@rowe-clan.net> wrote:
> On Mon, Dec 7, 2015 at 6:35 PM, Yann Ylavic <ylavic.dev@gmail.com> wrote:
>>
>> The body of the first request is never Upgraded, so why would we read
>> it using the Upgraded protocol?
>
>
> How do you mean?  The RFC states we must read the request body
> (following a 100-continue) prior to a 101-switching protocols.

Right.

> AFTER
> the protocol is switched, we are ready to invoke the handler, which
> will read the request body (which I suggest we have set aside within
> the http input filter) and it will write to the output filter stack, but to
> a different stack of protocol and network filters.

The handler handling the first request has to read the body before the
switch, eg. mod_proxy could forward the request without the client
having switched to any other protocol.
That does not mean it has to (or prereqs a) setaside body, this could
be streamed (and is even desirable in the mod_proxy case).
So couldn't we handle the switch (101) in an output filter instead
(before the first bytes are sent)?
Or simply don't honor Upgrade on requests with bodies when it appears
that we'd need to setaside (that would be the case too with
client-to-backend 100-continue and some response available before all
the request body is read, not to speak about the default_handler where
the body is just discarded)?
I think we should try hard to stream things in HTTP/1 too, not
necessarily honor optionals.

From dev-return-84934-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Tue Dec  8 01:30:31 2015
Return-Path: <dev-return-84934-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id B3C3D18039
	for <apmail-httpd-dev-archive@www.apache.org>; Tue,  8 Dec 2015 01:30:31 +0000 (UTC)
Received: (qmail 49929 invoked by uid 500); 8 Dec 2015 01:30:30 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 49860 invoked by uid 500); 8 Dec 2015 01:30:30 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 49850 invoked by uid 99); 8 Dec 2015 01:30:30 -0000
Received: from Unknown (HELO spamd2-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 08 Dec 2015 01:30:30 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd2-us-west.apache.org (ASF Mail Server at spamd2-us-west.apache.org) with ESMTP id 3C3731A07A2
	for <dev@httpd.apache.org>; Tue,  8 Dec 2015 01:30:30 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd2-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.102
X-Spam-Level:
X-Spam-Status: No, score=-0.102 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RCVD_IN_MSPIKE_H2=-0.001, SPF_PASS=-0.001] autolearn=disabled
Authentication-Results: spamd2-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd2-us-west.apache.org [10.40.0.9]) (amavisd-new, port 10024)
	with ESMTP id NR_n1XZ4HAMv for <dev@httpd.apache.org>;
	Tue,  8 Dec 2015 01:30:29 +0000 (UTC)
Received: from mail-pa0-f48.google.com (mail-pa0-f48.google.com [209.85.220.48])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id 35CFD20F4F
	for <dev@httpd.apache.org>; Tue,  8 Dec 2015 01:30:28 +0000 (UTC)
Received: by pacej9 with SMTP id ej9so2948519pac.2
        for <dev@httpd.apache.org>; Mon, 07 Dec 2015 17:25:20 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=subject:to:references:from:message-id:date:user-agent:mime-version
         :in-reply-to:content-type:content-transfer-encoding;
        bh=QTRHEli31k7742K4MgbLbh/CBMzNV7gM8BD8h5gpoD0=;
        b=GGMmD559gtPFnM19ryS1ekVFa/8NHscW3l0BcE63T6Yare6SPos/R83bSoDMG+sx+8
         tB6h4dpNFbnWSPOkHZYyyuWAbh/8jB2s94nbHX0J/syOWTO1DcQgCAd8HgiKszEWblN9
         tDe1CcBKtHr8HWHB/GZ6hr9Xk9mDfXgOOzDLYbEFClAwhlCCLBqi3hbK4xN8JwhTbQsF
         KyWFOyDlOsCq2onSJjBKfypPY3Q5Pzg8tPBOfuL/LlF8WODXbzbWIiz4/N50dOiCmNhV
         Ui+81yHceMwXREAJcFMci6dkIUUCnY5cFpRCOVn0BPXjylNAlPz7SAqMVQ26mFbeSd5q
         8FQg==
X-Received: by 10.66.232.170 with SMTP id tp10mr1192786pac.38.1449537920750;
        Mon, 07 Dec 2015 17:25:20 -0800 (PST)
Received: from [192.168.1.4] (50-39-117-165.bvtn.or.frontiernet.net. [50.39.117.165])
        by smtp.gmail.com with ESMTPSA id 6sm543729pfm.58.2015.12.07.17.25.19
        for <dev@httpd.apache.org>
        (version=TLSv1/SSLv3 cipher=OTHER);
        Mon, 07 Dec 2015 17:25:19 -0800 (PST)
Subject: Re: 2.4 pause - mod_http2 patchset Upgrade h2c vs mod_ssl Upgrade tls
To: dev@httpd.apache.org
References: <CACsi250=dbRQKnsbE8JSdAZRm5x99gE0sgX3iQ-PHAx77euD1A@mail.gmail.com>
 <CACsi2534prBtp7ENNNiEDevA3Z7u9uW2uuYMOa8-OoOsPSHNGQ@mail.gmail.com>
 <6C1FCB84-22AF-49D5-AA10-BFB922A98390@greenbytes.de>
 <CAGu=u8h9XxW0NSeMDSwaujO1G=sRn67TFah_FyGqNnBaWhHpLw@mail.gmail.com>
 <566603E5.8030004@gmail.com>
 <CACsi252sKCj6jmwhCRt7rGmu6K9aOd0oHAQ1nOoDvqZq5kjz8g@mail.gmail.com>
 <56661478.5030703@gmail.com>
 <CACsi2517xHBLjCGE+9wcJCu5ARZxMfCx=1sOzLerqmN4hfUNYg@mail.gmail.com>
From: Jacob Champion <champion.p@gmail.com>
Message-ID: <5666317E.5000306@gmail.com>
Date: Mon, 7 Dec 2015 17:25:18 -0800
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:38.0) Gecko/20100101
 Thunderbird/38.4.0
MIME-Version: 1.0
In-Reply-To: <CACsi2517xHBLjCGE+9wcJCu5ARZxMfCx=1sOzLerqmN4hfUNYg@mail.gmail.com>
Content-Type: text/plain; charset=utf-8; format=flowed
Content-Transfer-Encoding: 7bit

On 12/07/2015 03:49 PM, William A Rowe Jr wrote:
>     Just to confirm, the purpose of splitting this up into two separate
>     calls to the same function is solely to deal with "OPTIONS *", which
>     doesn't follow the same logical path in httpd? Or is there another
>     reason?
>
> No, it is because the TLS handshake from the Upgrade: TLS  handling
> is used in the auth path, everything from SSLRequireSSL to using the
> CN of a client certificate for authentication.

Oh, I see. Thanks for the clarification.

>     Put another way, I'm going to propose WebSocket for the paths that
>     the server admin wants, whether the incoming request is
>     valid/authorized or not, and I still need some way to interrupt the
>     upgrade if we're chosen and the client hasn't sent a proper request.
>     Does that makes sense?
>
>
> So how would a second invocation during the ap_invoke_handler cause
> an interruption in this?

I don't think it would; that comment was unrelated to the "two calls" 
clarification. I'm just trying to work through whether or not the 
current architecture is sufficient for my use case.

> Upgrade: TLS would occur in the early processing, Upgrade: WebSocket
> would occur in the later processing phase, but still prior to invoking a
> handler
> for the HTTP/1.1 request.  Remember that there is no 'error' for a malformed
> upgrade request, only a failure to proceed with 101-switching protocols.

 From the HTTP/1.1 point of view, yes. I could choose to simply ignore 
bad upgrades, eventually fall back to the file handler, and be perfectly 
HTTP-compliant.

 From the WebSocket point of view, though, server implementations have 
to reject improper upgrades with a 4xx. Letting a bad upgrade fall 
through to some other handler (which could possibly return 200 and some 
document) is non-compliant behavior. It would be nice (TM) if I had a 
hook to "accept the upgrade" (from httpd's point of view, not the 
client's), but perform my checks and send back an error code before the 
101 proceeded. The only other option I see is to inject myself as a 
handler in an error case and hope I'm not preempted by some other module.

Again, I need to write code so I have some solid information for you all 
instead of just speculation based on reading the source.

> Right now the core Protocol API will only send an Upgrade: offer on the
> first request in a chain of keepalive requests.  If the user agent asks for
> OPTIONS * and the WebSocket module declines to offer itself, and the
> user agent continues with a GET /webapp/... request that the WebSocket
> module is willing to upgrade, today the core Protocol API will not advertise
> that to the user agent on this kept-alive request for you.

Ah. That is unfortunate...

> Of course there is a fail-case, and that would be Upgrade Required, but
> the protocol module needs to set this sometime before handler invocation.
> Right now you can't do that within core_upgrade_request hooks, because
> without an Upgrade: request from the client, the core_upgrade_request
> implementation calls none of the protocol hooks on a kept-alive 2nd or
> later request, right now.
>
> Stupid question, is there an Upgrade: of protocols within HTTP/2?  An
> obvious case would be the websocket connection embedded within the
> h2c connection, but I expect that is not allowed.  TLS upgrade would be
> nonsense on an h2c connection.  But is there a provision for it in spec?

No. Upgrade semantics are explicitly removed from HTTP/2 (section 
8.1.1). I assume the rationale is that other protocols can be negotiated 
directly via either ALPN or HTTP/1.1 Upgrades, just like HTTP/2 is.

--Jacob

From dev-return-84935-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Tue Dec  8 02:07:44 2015
Return-Path: <dev-return-84935-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id BB5F7181C6
	for <apmail-httpd-dev-archive@www.apache.org>; Tue,  8 Dec 2015 02:07:44 +0000 (UTC)
Received: (qmail 34654 invoked by uid 500); 8 Dec 2015 02:07:44 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 34552 invoked by uid 500); 8 Dec 2015 02:07:44 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 34533 invoked by uid 99); 8 Dec 2015 02:07:44 -0000
Received: from Unknown (HELO spamd2-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 08 Dec 2015 02:07:44 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd2-us-west.apache.org (ASF Mail Server at spamd2-us-west.apache.org) with ESMTP id C09FD1A0C29
	for <dev@httpd.apache.org>; Tue,  8 Dec 2015 02:07:43 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd2-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 2.999
X-Spam-Level: **
X-Spam-Status: No, score=2.999 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, HTML_MESSAGE=3,
	RCVD_IN_MSPIKE_H2=-0.001, SPF_PASS=-0.001, URIBL_BLOCKED=0.001]
	autolearn=disabled
Authentication-Results: spamd2-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=rowe-clan-net.20150623.gappssmtp.com
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd2-us-west.apache.org [10.40.0.9]) (amavisd-new, port 10024)
	with ESMTP id K2NPbmCMV68L for <dev@httpd.apache.org>;
	Tue,  8 Dec 2015 02:07:37 +0000 (UTC)
Received: from mail-io0-f181.google.com (mail-io0-f181.google.com [209.85.223.181])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id 8E91224E9F
	for <dev@httpd.apache.org>; Tue,  8 Dec 2015 02:07:35 +0000 (UTC)
Received: by iofh3 with SMTP id h3so10226869iof.3
        for <dev@httpd.apache.org>; Mon, 07 Dec 2015 18:07:34 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=rowe-clan-net.20150623.gappssmtp.com; s=20150623;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        bh=Q1FVfwu9KgXnQm53wc9cw38x6vsHxRkcRU/qZTdGTuw=;
        b=AteetnIQttdNE3qtf3cfXTejR57ShC1F64dvwd+nquNsSd2VJcysPgoN2pD612Lqu/
         VQan92a3P1UzdRuSaC+q811pRfq11rxX1IPR4KWwbgK/pKZvlHtK0DrSgc8bjA73u87g
         xebO0l7vGqcSlaIpPneR1g9ReCIJnmTllTHTDDHSNxnoVVs8Nqo5kZsKr2Bh8qMTpM41
         dF5pEqeoekDFifjz9xQnU0ndRNZl+i5+iU5QfQYHlFoWYpfKh0m4UQPS/0Z4e9RTMEO8
         WEiOonvPrd567Xx22n2RynFEy/9YB5UHad3LGRsms+WzwgqfZl2f96u4N6pYz0Z/0AQp
         voDA==
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=1e100.net; s=20130820;
        h=x-gm-message-state:mime-version:in-reply-to:references:date
         :message-id:subject:from:to:content-type;
        bh=Q1FVfwu9KgXnQm53wc9cw38x6vsHxRkcRU/qZTdGTuw=;
        b=edPbTziyQoqW/phEblrR5pWPfP7iikshJ8pKWpx9+aAD7he46FVmbEiMD6cycLwOT0
         hhwgv4PxEe3Or0Gvf/OBHROjcrlSzKECpO7Jl9M1wpty8HDE2kbM0iJtJUU0nMu3LLnO
         FDqUmwh21RdT6b7upNqnN2zCNpCKzhAWjogKW1JHL7wqiE5kzVHZz2JRMoJieN80y+Vr
         z6/YWlnjaiSpHwvBnES8MSy2ZZFOX2EK6yu3WnBFsTGWD8zSES3M7B159Mh4CO8Yqkfh
         qbZLl0OO5DPGEuBpXrbuuxU4K6sQCZA3ltVhuZigATwRycneUwBWo36OTkyVqEDYTDHV
         FpIQ==
X-Gm-Message-State: ALoCoQmt2pBe67SPKeAV9fieiRMdZnax+AOnVX+6UzS53U2Z5vZWuyYkHGhkTmgD8+kq8KznrmNV/dj1ZcYOdHbDTCL+uaI0ye5DuM/+pIy9g0scxc7HF2E=
MIME-Version: 1.0
X-Received: by 10.107.34.199 with SMTP id i190mr1606530ioi.150.1449540454482;
 Mon, 07 Dec 2015 18:07:34 -0800 (PST)
Received: by 10.107.62.136 with HTTP; Mon, 7 Dec 2015 18:07:34 -0800 (PST)
Received: by 10.107.62.136 with HTTP; Mon, 7 Dec 2015 18:07:34 -0800 (PST)
In-Reply-To: <CAKQ1sVPCw_wjurNSgzE2c+f_PJjwLd=-0zezfr=DGT+se9xG6A@mail.gmail.com>
References: <CACsi250=dbRQKnsbE8JSdAZRm5x99gE0sgX3iQ-PHAx77euD1A@mail.gmail.com>
	<CAKQ1sVOKT6_LUbC7pCFnykVYP_7L2vDj6ZWp_TOTsDXRDCjy-w@mail.gmail.com>
	<CAKQ1sVOHSrFjkDR5yi-N2M6qbCyMQ=Z6+=NcJ+FuYpXg_+W1qg@mail.gmail.com>
	<CACsi251o57Qmj3rvCO1cLgULcrxZUb=OEa6mKz+1SGus6-yoig@mail.gmail.com>
	<CAKQ1sVOKJhX5rUM-hixx2s8HtBPNYY+pJYf3-Uedrvwuaq6PPQ@mail.gmail.com>
	<CACsi252Cq5GfmcXxFZebqyWXSaD=qZeSRBDAnVjbDJSoM4Ri=g@mail.gmail.com>
	<CAKQ1sVPCw_wjurNSgzE2c+f_PJjwLd=-0zezfr=DGT+se9xG6A@mail.gmail.com>
Date: Mon, 7 Dec 2015 20:07:34 -0600
Message-ID: <CACsi250YwVJ0WVHX9Z5V7nsYbvx+XM2EOm9RSzKM5Cj7rnf9mg@mail.gmail.com>
Subject: Re: 2.4 pause - mod_http2 patchset Upgrade h2c vs mod_ssl Upgrade tls
From: William A Rowe Jr <wrowe@rowe-clan.net>
To: httpd <dev@httpd.apache.org>
Content-Type: multipart/alternative; boundary=001a1140d944e0a1920526596f9c

--001a1140d944e0a1920526596f9c
Content-Type: text/plain; charset=UTF-8

On Dec 7, 2015 19:29, "Yann Ylavic" <ylavic.dev@gmail.com> wrote:
>
> On Tue, Dec 8, 2015 at 1:58 AM, William A Rowe Jr <wrowe@rowe-clan.net>
wrote:
> > On Mon, Dec 7, 2015 at 6:35 PM, Yann Ylavic <ylavic.dev@gmail.com>
wrote:
> >>
> >> The body of the first request is never Upgraded, so why would we read
> >> it using the Upgraded protocol?
> >
> >
> > How do you mean?  The RFC states we must read the request body
> > (following a 100-continue) prior to a 101-switching protocols.
>
> Right.
>
> > AFTER
> > the protocol is switched, we are ready to invoke the handler, which
> > will read the request body (which I suggest we have set aside within
> > the http input filter) and it will write to the output filter stack,
but to
> > a different stack of protocol and network filters.
>
> The handler handling the first request has to read the body before the
> switch, eg. mod_proxy could forward the request without the client
> having switched to any other protocol.

Whoa... First the handler can't process the request until the switch, and
more importantly the protocol upgrade is hop by hop, review s6.7 again
please.

The mechanism to address your use case is HTTP/1.1 CONNECT.

In terms of h2/h2c/HTTP/https the connection between user agent and gateway
has no bearing on the connection to the back end in the reverse proxy
situation.

> That does not mean it has to (or prereqs a) setaside body, this could
> be streamed (and is even desirable in the mod_proxy case).

Not possible to read plaintext and write TLS, for example.  The body must
be consumed first.

> So couldn't we handle the switch (101) in an output filter instead
> (before the first bytes are sent)?

No, for TLS, absolutely not.

You presume the handler consumed the body, and you have no assurance of
that.  Which means the output filter now needs to attend to the input
filter state, and we are back where we started with the no 101 before the
upgrade can be satisfied.

If the upgrade fails (tls handshake failure or whatnot) we have no
intention of starting a stateful transaction that will be broken.  No
successful upgrade, then no handler invocation.

And if the handler wants to make an election based on the protocol, it
cannot do this before reading all the input.  Sub-optimal if not simply
broken.

And as I've called out already the entire pre-handler cycle needs to be
able to inspect the tls session for authn/authz.

> Or simply don't honor Upgrade on requests with bodies when it appears
> that we'd need to setaside (that would be the case too with
> client-to-backend 100-continue and some response available before all
> the request body is read, not to speak about the default_handler where
> the body is just discarded)?
> I think we should try hard to stream things in HTTP/1 too, not
> necessarily honor optionals.

What's the performance impact of a 16k or 64k set aside?  None, those
buckets would have been called up anyways without the protocol switch.  We
are streaming, some baseline buckets must always be filled in all cases.
The extent of that buffer can be administor controlled.

The call is out there from svn, and many other web services will eventually
rely on the same concept, this is a must have to avoid the very round trips
that h2c sought to avoid.

--001a1140d944e0a1920526596f9c
Content-Type: text/html; charset=UTF-8
Content-Transfer-Encoding: quoted-printable

<p dir=3D"ltr">On Dec 7, 2015 19:29, &quot;Yann Ylavic&quot; &lt;<a href=3D=
"mailto:ylavic.dev@gmail.com">ylavic.dev@gmail.com</a>&gt; wrote:<br>
&gt;<br>
&gt; On Tue, Dec 8, 2015 at 1:58 AM, William A Rowe Jr &lt;<a href=3D"mailt=
o:wrowe@rowe-clan.net">wrowe@rowe-clan.net</a>&gt; wrote:<br>
&gt; &gt; On Mon, Dec 7, 2015 at 6:35 PM, Yann Ylavic &lt;<a href=3D"mailto=
:ylavic.dev@gmail.com">ylavic.dev@gmail.com</a>&gt; wrote:<br>
&gt; &gt;&gt;<br>
&gt; &gt;&gt; The body of the first request is never Upgraded, so why would=
 we read<br>
&gt; &gt;&gt; it using the Upgraded protocol?<br>
&gt; &gt;<br>
&gt; &gt;<br>
&gt; &gt; How do you mean?=C2=A0 The RFC states we must read the request bo=
dy<br>
&gt; &gt; (following a 100-continue) prior to a 101-switching protocols.<br=
>
&gt;<br>
&gt; Right.<br>
&gt;<br>
&gt; &gt; AFTER<br>
&gt; &gt; the protocol is switched, we are ready to invoke the handler, whi=
ch<br>
&gt; &gt; will read the request body (which I suggest we have set aside wit=
hin<br>
&gt; &gt; the http input filter) and it will write to the output filter sta=
ck, but to<br>
&gt; &gt; a different stack of protocol and network filters.<br>
&gt;<br>
&gt; The handler handling the first request has to read the body before the=
<br>
&gt; switch, eg. mod_proxy could forward the request without the client<br>
&gt; having switched to any other protocol.</p>
<p dir=3D"ltr">Whoa... First the handler can&#39;t process the request unti=
l the switch, and more importantly the protocol upgrade is hop by hop, revi=
ew s6.7 again please.</p>
<p dir=3D"ltr">The mechanism to address your use case is HTTP/1.1 CONNECT.<=
/p>
<p dir=3D"ltr">In terms of h2/h2c/HTTP/https the connection between user ag=
ent and gateway has no bearing on the connection to the back end in the rev=
erse proxy situation.</p>
<p dir=3D"ltr">&gt; That does not mean it has to (or prereqs a) setaside bo=
dy, this could<br>
&gt; be streamed (and is even desirable in the mod_proxy case).</p>
<p dir=3D"ltr">Not possible to read plaintext and write TLS, for example.=
=C2=A0 The body must be consumed first.</p>
<p dir=3D"ltr">&gt; So couldn&#39;t we handle the switch (101) in an output=
 filter instead<br>
&gt; (before the first bytes are sent)?</p>
<p dir=3D"ltr">No, for TLS, absolutely not.</p>
<p dir=3D"ltr">You presume the handler consumed the body, and you have no a=
ssurance of that.=C2=A0 Which means the output filter now needs to attend t=
o the input filter state, and we are back where we started with the no 101 =
before the upgrade can be satisfied.</p>
<p dir=3D"ltr">If the upgrade fails (tls handshake failure or whatnot) we h=
ave no intention of starting a stateful transaction that will be broken.=C2=
=A0 No successful upgrade, then no handler invocation.</p>
<p dir=3D"ltr">And if the handler wants to make an election based on the pr=
otocol, it cannot do this before reading all the input.=C2=A0 Sub-optimal i=
f not simply broken.</p>
<p dir=3D"ltr">And as I&#39;ve called out already the entire pre-handler cy=
cle needs to be able to inspect the tls session for authn/authz.</p>
<p dir=3D"ltr">&gt; Or simply don&#39;t honor Upgrade on requests with bodi=
es when it appears<br>
&gt; that we&#39;d need to setaside (that would be the case too with<br>
&gt; client-to-backend 100-continue and some response available before all<=
br>
&gt; the request body is read, not to speak about the default_handler where=
<br>
&gt; the body is just discarded)?<br>
&gt; I think we should try hard to stream things in HTTP/1 too, not<br>
&gt; necessarily honor optionals.</p>
<p dir=3D"ltr">What&#39;s the performance impact of a 16k or 64k set aside?=
=C2=A0 None, those buckets would have been called up anyways without the pr=
otocol switch.=C2=A0 We are streaming, some baseline buckets must always be=
 filled in all cases.=C2=A0 The extent of that buffer can be administor con=
trolled.</p>
<p dir=3D"ltr">The call is out there from svn, and many other web services =
will eventually rely on the same concept, this is a must have to avoid the =
very round trips that h2c sought to avoid.</p>

--001a1140d944e0a1920526596f9c--

From dev-return-84936-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Tue Dec  8 02:24:41 2015
Return-Path: <dev-return-84936-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 4B69718279
	for <apmail-httpd-dev-archive@www.apache.org>; Tue,  8 Dec 2015 02:24:41 +0000 (UTC)
Received: (qmail 63097 invoked by uid 500); 8 Dec 2015 02:24:40 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 62996 invoked by uid 500); 8 Dec 2015 02:24:40 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 62986 invoked by uid 99); 8 Dec 2015 02:24:40 -0000
Received: from Unknown (HELO spamd1-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 08 Dec 2015 02:24:40 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd1-us-west.apache.org (ASF Mail Server at spamd1-us-west.apache.org) with ESMTP id 4281CC297D
	for <dev@httpd.apache.org>; Tue,  8 Dec 2015 02:24:40 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd1-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 2.998
X-Spam-Level: **
X-Spam-Status: No, score=2.998 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, HTML_MESSAGE=3,
	RCVD_IN_MSPIKE_H2=-0.001, SPF_PASS=-0.001] autolearn=disabled
Authentication-Results: spamd1-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=rowe-clan-net.20150623.gappssmtp.com
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd1-us-west.apache.org [10.40.0.7]) (amavisd-new, port 10024)
	with ESMTP id nOkcZXL83zFm for <dev@httpd.apache.org>;
	Tue,  8 Dec 2015 02:24:38 +0000 (UTC)
Received: from mail-vk0-f47.google.com (mail-vk0-f47.google.com [209.85.213.47])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id 90B0142BCA
	for <dev@httpd.apache.org>; Tue,  8 Dec 2015 02:24:38 +0000 (UTC)
Received: by vkay187 with SMTP id y187so3685815vka.3
        for <dev@httpd.apache.org>; Mon, 07 Dec 2015 18:19:37 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=rowe-clan-net.20150623.gappssmtp.com; s=20150623;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        bh=pYVBoXhsnTisTDAYdUl9BFskkaIRQ8Rq1S8DmGG0Yx4=;
        b=s3+I47wtchyx8WbrzdT4Wxcig8O1DPMkEkBbcs48Xxad9IdELovZvV1Lvr6c9+h8LN
         Scmmx3JkJJCRFEbvrK2ebxgPav03CgFnEehHAW65eEZqWaR0Nz2lvo60ZJIaj9PNhVSX
         zLnO2Ivxx8aVedC1BnXECJ5/U1V5LQ/B86FvXDEODfbe0j0jt6fx/JB+mNC4VRYTtmYO
         Z16pylqqqwv4Sz9PGwHXRWLGjO6PEyVVS0J3d3jd0Vyt6M0ZFidVQ37AA/AALdwR8JYV
         dtsb8KU2D7nbGWFXOXUaNC4w8cjl56YOI+WA9GQOSsV8tyQrr1FrVbJ+JlKsqu/sQr6z
         vK9w==
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=1e100.net; s=20130820;
        h=x-gm-message-state:mime-version:in-reply-to:references:date
         :message-id:subject:from:to:content-type;
        bh=pYVBoXhsnTisTDAYdUl9BFskkaIRQ8Rq1S8DmGG0Yx4=;
        b=Vm2J4Z8T+dovCm/8h0s7Amb9MRdZNB3RXWAez/zt4F+oqXWp0rTuZiw2o69XwRsUxz
         eQByaBvRqrIWnoD5fQB6YAa96PciFuQosurdjxF0ccO+Mf7CO2czlSbtd2rZDsUCfF4+
         YfMB/MruSCXWNx7CD7tOzIE1nvYKagdLIEtnoyiTTmbPpFKz5cT4AQGLWM37zjqPwOF8
         lcqJPHmAhcsmDPGNUZEI4nJvQYyfr1+TWjoOFk0o4ThkwfALCimZigL7mheMiUCcK8MW
         VpxXO97WhjvPDu27kwa++dA/OTCtvQpMX2dTwsTnBKUmZcPS14eUpfr98tTxhZbiXhWJ
         rtbQ==
X-Gm-Message-State: ALoCoQk17fIQiACYVcFmMp8k37nTzDOythRPvfQ9N5AAXgPjgOUdf99W7f/TC0Gc8zNKG/am3/UIp/zYlBk4D8qQcOpUNw/o4uWcO7EVS5GkBHEnA8H+57E=
MIME-Version: 1.0
X-Received: by 10.31.8.8 with SMTP id 8mr923193vki.106.1449541177478; Mon, 07
 Dec 2015 18:19:37 -0800 (PST)
Received: by 10.31.215.129 with HTTP; Mon, 7 Dec 2015 18:19:37 -0800 (PST)
In-Reply-To: <5666317E.5000306@gmail.com>
References: <CACsi250=dbRQKnsbE8JSdAZRm5x99gE0sgX3iQ-PHAx77euD1A@mail.gmail.com>
	<CACsi2534prBtp7ENNNiEDevA3Z7u9uW2uuYMOa8-OoOsPSHNGQ@mail.gmail.com>
	<6C1FCB84-22AF-49D5-AA10-BFB922A98390@greenbytes.de>
	<CAGu=u8h9XxW0NSeMDSwaujO1G=sRn67TFah_FyGqNnBaWhHpLw@mail.gmail.com>
	<566603E5.8030004@gmail.com>
	<CACsi252sKCj6jmwhCRt7rGmu6K9aOd0oHAQ1nOoDvqZq5kjz8g@mail.gmail.com>
	<56661478.5030703@gmail.com>
	<CACsi2517xHBLjCGE+9wcJCu5ARZxMfCx=1sOzLerqmN4hfUNYg@mail.gmail.com>
	<5666317E.5000306@gmail.com>
Date: Mon, 7 Dec 2015 20:19:37 -0600
Message-ID: <CACsi251d1U9iTb6iCkTkcjb_cMfnungXWvA-aejfUrODwg-MTw@mail.gmail.com>
Subject: Re: 2.4 pause - mod_http2 patchset Upgrade h2c vs mod_ssl Upgrade tls
From: William A Rowe Jr <wrowe@rowe-clan.net>
To: httpd <dev@httpd.apache.org>
Content-Type: multipart/alternative; boundary=001a11454c64f8a81f0526599a8b

--001a11454c64f8a81f0526599a8b
Content-Type: text/plain; charset=UTF-8

On Mon, Dec 7, 2015 at 7:25 PM, Jacob Champion <champion.p@gmail.com> wrote:

> On 12/07/2015 03:49 PM, William A Rowe Jr wrote:
>
>>     Just to confirm, the purpose of splitting this up into two separate
>>     calls to the same function is solely to deal with "OPTIONS *", which
>>     doesn't follow the same logical path in httpd? Or is there another
>>     reason?
>>
>> No, it is because the TLS handshake from the Upgrade: TLS  handling
>> is used in the auth path, everything from SSLRequireSSL to using the
>> CN of a client certificate for authentication.
>>
>
> Oh, I see. Thanks for the clarification.
>
>     Put another way, I'm going to propose WebSocket for the paths that
>>     the server admin wants, whether the incoming request is
>>     valid/authorized or not, and I still need some way to interrupt the
>>     upgrade if we're chosen and the client hasn't sent a proper request.
>>     Does that makes sense?
>>
>>
>> So how would a second invocation during the ap_invoke_handler cause
>> an interruption in this?
>>
>
> I don't think it would; that comment was unrelated to the "two calls"
> clarification. I'm just trying to work through whether or not the current
> architecture is sufficient for my use case.


I think it may be...


>
> Upgrade: TLS would occur in the early processing, Upgrade: WebSocket
>> would occur in the later processing phase, but still prior to invoking a
>> handler
>> for the HTTP/1.1 request.  Remember that there is no 'error' for a
>> malformed
>> upgrade request, only a failure to proceed with 101-switching protocols.
>>
>
> From the HTTP/1.1 point of view, yes. I could choose to simply ignore bad
> upgrades, eventually fall back to the file handler, and be perfectly
> HTTP-compliant.
>
> From the WebSocket point of view, though, server implementations have to
> reject improper upgrades with a 4xx. Letting a bad upgrade fall through to
> some other handler (which could possibly return 200 and some document) is
> non-compliant behavior. It would be nice (TM) if I had a hook to "accept
> the upgrade" (from httpd's point of view, not the client's), but perform my
> checks and send back an error code before the 101 proceeded. The only other
> option I see is to inject myself as a handler in an error case and hope I'm
> not preempted by some other module.
>

You can ap_die anywhere during the pre-handler phases, between or before
the second protocol switch offer.  What you are describing seems like
something well handled within the auth stack or in final fixups, no?  That
would include any upgrade-required status (as tls is going to do for
SSLRequireSSL when SSL optional is configured).


> Again, I need to write code so I have some solid information for you all
> instead of just speculation based on reading the source.


:)  I would have dove deeper already but this conversation had to happen
first, thanks for all the details of this specific use case.


> Right now the core Protocol API will only send an Upgrade: offer on the
>> first request in a chain of keepalive requests.  If the user agent asks
>> for
>> OPTIONS * and the WebSocket module declines to offer itself, and the
>> user agent continues with a GET /webapp/... request that the WebSocket
>> module is willing to upgrade, today the core Protocol API will not
>> advertise
>> that to the user agent on this kept-alive request for you.
>>
>
> Ah. That is unfortunate...
>

... but fixable.

Perhaps the advertising hook determines if it will 're-advertise', or not?

Of course there is a fail-case, and that would be Upgrade Required, but
>> the protocol module needs to set this sometime before handler invocation.
>> Right now you can't do that within core_upgrade_request hooks, because
>> without an Upgrade: request from the client, the core_upgrade_request
>> implementation calls none of the protocol hooks on a kept-alive 2nd or
>> later request, right now.
>>
>> Stupid question, is there an Upgrade: of protocols within HTTP/2?  An
>> obvious case would be the websocket connection embedded within the
>> h2c connection, but I expect that is not allowed.  TLS upgrade would be
>> nonsense on an h2c connection.  But is there a provision for it in spec?
>>
>
> No. Upgrade semantics are explicitly removed from HTTP/2 (section 8.1.1).
> I assume the rationale is that other protocols can be negotiated directly
> via either ALPN or HTTP/1.1 Upgrades, just like HTTP/2 is.
>

Thanks for clarifying.

--001a11454c64f8a81f0526599a8b
Content-Type: text/html; charset=UTF-8
Content-Transfer-Encoding: quoted-printable

<div dir=3D"ltr"><div class=3D"gmail_extra"><div class=3D"gmail_quote">On M=
on, Dec 7, 2015 at 7:25 PM, Jacob Champion <span dir=3D"ltr">&lt;<a href=3D=
"mailto:champion.p@gmail.com" target=3D"_blank">champion.p@gmail.com</a>&gt=
;</span> wrote:<br><blockquote class=3D"gmail_quote" style=3D"margin:0 0 0 =
.8ex;border-left:1px #ccc solid;padding-left:1ex"><span class=3D"">On 12/07=
/2015 03:49 PM, William A Rowe Jr wrote:<br>
<blockquote class=3D"gmail_quote" style=3D"margin:0 0 0 .8ex;border-left:1p=
x #ccc solid;padding-left:1ex">
=C2=A0 =C2=A0 Just to confirm, the purpose of splitting this up into two se=
parate<br>
=C2=A0 =C2=A0 calls to the same function is solely to deal with &quot;OPTIO=
NS *&quot;, which<br>
=C2=A0 =C2=A0 doesn&#39;t follow the same logical path in httpd? Or is ther=
e another<br>
=C2=A0 =C2=A0 reason?<br>
<br>
No, it is because the TLS handshake from the Upgrade: TLS=C2=A0 handling<br=
>
is used in the auth path, everything from SSLRequireSSL to using the<br>
CN of a client certificate for authentication.<br>
</blockquote>
<br></span>
Oh, I see. Thanks for the clarification.<span class=3D""><br>
<br>
<blockquote class=3D"gmail_quote" style=3D"margin:0 0 0 .8ex;border-left:1p=
x #ccc solid;padding-left:1ex">
=C2=A0 =C2=A0 Put another way, I&#39;m going to propose WebSocket for the p=
aths that<br>
=C2=A0 =C2=A0 the server admin wants, whether the incoming request is<br>
=C2=A0 =C2=A0 valid/authorized or not, and I still need some way to interru=
pt the<br>
=C2=A0 =C2=A0 upgrade if we&#39;re chosen and the client hasn&#39;t sent a =
proper request.<br>
=C2=A0 =C2=A0 Does that makes sense?<br>
<br>
<br>
So how would a second invocation during the ap_invoke_handler cause<br>
an interruption in this?<br>
</blockquote>
<br></span>
I don&#39;t think it would; that comment was unrelated to the &quot;two cal=
ls&quot; clarification. I&#39;m just trying to work through whether or not =
the current architecture is sufficient for my use case.</blockquote><div><b=
r></div><div>I think it may be...</div><div>=C2=A0</div><blockquote class=
=3D"gmail_quote" style=3D"margin:0 0 0 .8ex;border-left:1px #ccc solid;padd=
ing-left:1ex"><span class=3D""><br>
<blockquote class=3D"gmail_quote" style=3D"margin:0 0 0 .8ex;border-left:1p=
x #ccc solid;padding-left:1ex">
Upgrade: TLS would occur in the early processing, Upgrade: WebSocket<br>
would occur in the later processing phase, but still prior to invoking a<br=
>
handler<br>
for the HTTP/1.1 request.=C2=A0 Remember that there is no &#39;error&#39; f=
or a malformed<br>
upgrade request, only a failure to proceed with 101-switching protocols.<br=
>
</blockquote>
<br></span>
>From the HTTP/1.1 point of view, yes. I could choose to simply ignore bad u=
pgrades, eventually fall back to the file handler, and be perfectly HTTP-co=
mpliant.<br>
<br>
>From the WebSocket point of view, though, server implementations have to re=
ject improper upgrades with a 4xx. Letting a bad upgrade fall through to so=
me other handler (which could possibly return 200 and some document) is non=
-compliant behavior. It would be nice (TM) if I had a hook to &quot;accept =
the upgrade&quot; (from httpd&#39;s point of view, not the client&#39;s), b=
ut perform my checks and send back an error code before the 101 proceeded. =
The only other option I see is to inject myself as a handler in an error ca=
se and hope I&#39;m not preempted by some other module.<br></blockquote><di=
v><br></div><div>You can ap_die anywhere during the pre-handler phases, bet=
ween or before the second protocol switch offer.=C2=A0 What you are describ=
ing seems like something well handled within the auth stack or in final fix=
ups, no?=C2=A0 That would include any upgrade-required status (as tls is go=
ing to do for SSLRequireSSL when SSL optional is configured).</div><div>=C2=
=A0</div><blockquote class=3D"gmail_quote" style=3D"margin:0 0 0 .8ex;borde=
r-left:1px #ccc solid;padding-left:1ex">
Again, I need to write code so I have some solid information for you all in=
stead of just speculation based on reading the source.</blockquote><div><br=
></div><div>:) =C2=A0I would have dove deeper already but this conversation=
 had to happen first, thanks for all the details of this specific use case.=
=C2=A0</div><div>=C2=A0</div><blockquote class=3D"gmail_quote" style=3D"mar=
gin:0 0 0 .8ex;border-left:1px #ccc solid;padding-left:1ex"><span class=3D"=
">
<blockquote class=3D"gmail_quote" style=3D"margin:0 0 0 .8ex;border-left:1p=
x #ccc solid;padding-left:1ex">
Right now the core Protocol API will only send an Upgrade: offer on the<br>
first request in a chain of keepalive requests.=C2=A0 If the user agent ask=
s for<br>
OPTIONS * and the WebSocket module declines to offer itself, and the<br>
user agent continues with a GET /webapp/... request that the WebSocket<br>
module is willing to upgrade, today the core Protocol API will not advertis=
e<br>
that to the user agent on this kept-alive request for you.<br>
</blockquote>
<br></span>
Ah. That is unfortunate...<span class=3D""><br></span></blockquote><div>=C2=
=A0</div><div>... but fixable.</div><div><br></div><div>Perhaps the adverti=
sing hook determines if it will &#39;re-advertise&#39;, or not?</div><div><=
br></div><blockquote class=3D"gmail_quote" style=3D"margin:0 0 0 .8ex;borde=
r-left:1px #ccc solid;padding-left:1ex"><span class=3D"">
<blockquote class=3D"gmail_quote" style=3D"margin:0 0 0 .8ex;border-left:1p=
x #ccc solid;padding-left:1ex">
Of course there is a fail-case, and that would be Upgrade Required, but<br>
the protocol module needs to set this sometime before handler invocation.<b=
r>
Right now you can&#39;t do that within core_upgrade_request hooks, because<=
br>
without an Upgrade: request from the client, the core_upgrade_request<br>
implementation calls none of the protocol hooks on a kept-alive 2nd or<br>
later request, right now.<br>
<br>
Stupid question, is there an Upgrade: of protocols within HTTP/2?=C2=A0 An<=
br>
obvious case would be the websocket connection embedded within the<br>
h2c connection, but I expect that is not allowed.=C2=A0 TLS upgrade would b=
e<br>
nonsense on an h2c connection.=C2=A0 But is there a provision for it in spe=
c?<br>
</blockquote>
<br></span>
No. Upgrade semantics are explicitly removed from HTTP/2 (section 8.1.1). I=
 assume the rationale is that other protocols can be negotiated directly vi=
a either ALPN or HTTP/1.1 Upgrades, just like HTTP/2 is.<span class=3D"HOEn=
Zb"><font color=3D"#888888"><br></font></span></blockquote><div></div></div=
><br></div><div class=3D"gmail_extra">Thanks for clarifying.</div><div clas=
s=3D"gmail_extra"><br></div></div>

--001a11454c64f8a81f0526599a8b--

From dev-return-84937-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Tue Dec  8 02:50:16 2015
Return-Path: <dev-return-84937-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id EAE8D18376
	for <apmail-httpd-dev-archive@www.apache.org>; Tue,  8 Dec 2015 02:50:15 +0000 (UTC)
Received: (qmail 99757 invoked by uid 500); 8 Dec 2015 02:50:15 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 99443 invoked by uid 500); 8 Dec 2015 02:50:15 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 99433 invoked by uid 99); 8 Dec 2015 02:50:15 -0000
Received: from Unknown (HELO spamd4-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 08 Dec 2015 02:50:15 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd4-us-west.apache.org (ASF Mail Server at spamd4-us-west.apache.org) with ESMTP id E3C9FC06D6
	for <dev@httpd.apache.org>; Tue,  8 Dec 2015 02:50:14 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd4-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 2.999
X-Spam-Level: **
X-Spam-Status: No, score=2.999 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, HTML_MESSAGE=3,
	RCVD_IN_MSPIKE_H2=-0.001, SPF_PASS=-0.001, URIBL_BLOCKED=0.001]
	autolearn=disabled
Authentication-Results: spamd4-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=rowe-clan-net.20150623.gappssmtp.com
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd4-us-west.apache.org [10.40.0.11]) (amavisd-new, port 10024)
	with ESMTP id QNYeDEcmkPtx for <dev@httpd.apache.org>;
	Tue,  8 Dec 2015 02:50:08 +0000 (UTC)
Received: from mail-ig0-f171.google.com (mail-ig0-f171.google.com [209.85.213.171])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id 149D224DBD
	for <dev@httpd.apache.org>; Tue,  8 Dec 2015 02:50:07 +0000 (UTC)
Received: by igcto18 with SMTP id to18so7681614igc.0
        for <dev@httpd.apache.org>; Mon, 07 Dec 2015 18:50:06 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=rowe-clan-net.20150623.gappssmtp.com; s=20150623;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        bh=MRDZ8xLX4j7KlU84cAIyjdjrw8n9M+lRIAGjoJ11fjM=;
        b=q/udDIZmL/HHj9rcF9RnLSp+MfHFWykzva2E9QFrFn5e15vLKX/9aop7ik7So008As
         YRXyb1ZBPhYrv0ogN1Mmn0vQuRmBXuvg37BhhD5hgr9P50NJWgipb1F9nHPKlqBZaaIY
         Sb6UOtzMeTrd+tWSXrNypXXAmFnWqx4dDgNDuzsbJS56qkcpHDyI+QtdHV4wIL7R9ibb
         RE6Wu9wlabKIbPNjbd59/BioGkGGOGkyviEP3GFWkEkwsEfK8q2OrEkJMUYec+9Jv08w
         dnCLXBHZbJ3BCPYgmVv4lbdqZk/VoGpEIgj0KapCPYOhQ4cldcv7YXhGpa0TGTopdEdL
         lt0A==
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=1e100.net; s=20130820;
        h=x-gm-message-state:mime-version:in-reply-to:references:date
         :message-id:subject:from:to:content-type;
        bh=MRDZ8xLX4j7KlU84cAIyjdjrw8n9M+lRIAGjoJ11fjM=;
        b=DD+kwfLlFg9+AgOPLJZYK6HM52rT6L7oSALEH8ef9EahlG15WreDfzF/kBOzLZ3i3i
         H33mzfAewtU4TaaUwnVBqMMporciRSpt7KTxZ3yutVkBUdYBcnQT746dhH+LUkLbXPzi
         WJmnuxXQ90Aieyp9u/+b9+fAi4q94hacdcjqpX2ULmxQdLmkUpXxP3nbJTcW7Q0O+F2A
         alqrIxzkiDBTRqF/rBKfTuE8Kym1/25p2W/YO1HrS/ykaMia10wnHg3C0YQTh+p/knTr
         ztQHMjT1el4bhnyzdbkhFKAlVnu03d7ppulHDEqv32dvlYVWgM0jpQk9GtDPalHB/j5n
         a0vw==
X-Gm-Message-State: ALoCoQnk9VMqSG6oBd68H+J/4pmf2gX3qzyapotRyCyi4VULbMOzJG1OF35ahu/S2FGph+SjUzSqrdHzkdEBBRxaA6aqWtOoEoWIgmgHB+TGQnx9Gh+vGbU=
MIME-Version: 1.0
X-Received: by 10.50.143.10 with SMTP id sa10mr16935821igb.77.1449543006024;
 Mon, 07 Dec 2015 18:50:06 -0800 (PST)
Received: by 10.107.62.136 with HTTP; Mon, 7 Dec 2015 18:50:05 -0800 (PST)
In-Reply-To: <6C1FCB84-22AF-49D5-AA10-BFB922A98390@greenbytes.de>
References: <CACsi250=dbRQKnsbE8JSdAZRm5x99gE0sgX3iQ-PHAx77euD1A@mail.gmail.com>
	<CACsi2534prBtp7ENNNiEDevA3Z7u9uW2uuYMOa8-OoOsPSHNGQ@mail.gmail.com>
	<6C1FCB84-22AF-49D5-AA10-BFB922A98390@greenbytes.de>
Date: Mon, 7 Dec 2015 20:50:05 -0600
Message-ID: <CACsi250CCZSz6Rf-_mDNsXT+v3rwcYHuQOfPLibTQ-P=Wvz_pg@mail.gmail.com>
Subject: Re: 2.4 pause - mod_http2 patchset Upgrade h2c vs mod_ssl Upgrade tls
From: William A Rowe Jr <wrowe@rowe-clan.net>
To: httpd <dev@httpd.apache.org>
Content-Type: multipart/alternative; boundary=001a1135fe9af615e405265a073d

--001a1135fe9af615e405265a073d
Content-Type: text/plain; charset=UTF-8

Sorry it took so long to respond to this earlier post, some of this might
have already been covered...

On Mon, Dec 7, 2015 at 1:03 PM, Stefan Eissing <stefan.eissing@greenbytes.de
> wrote:

>
>
Think about CORS restrictions and other stuff.
> - I think its the protocol handlers job to deal with any request body.
>

Strongly disagree, because 1. the protocol switch mechansim isn't the
content handler of the originating request, the request body is a
request-level entity, and 2. TLS gave you a perfect illustration of
altering the connection stack to continue using the core protocol stack.

In the case of h2c, or even a mod_echo Upgrade: echo mechanism, the entire
request/response is going to be handed off to a new protocol stack, I
understand that.  But that is one of several use cases here, and that new
protocol stack is going to consume the network pipe and close it, I
trust?!?  And return the appropriate status that the connection is gone
even if it leaves the old code to mop up, e.g. lingering_close.

For h2 upgrade, for example, the switch is only offered for requests
> without body.
>

Well, h2c is advertised on the first request with or without a body, and
then never again. Other modules must advertise, e.g. in conjunction with
the 426 Upgrade Required.

In fact, how do you propose to handle an authentication case with h2c
living in near the handler phase, when it will alert during the authnz
phase that http1.1 has been disallowed/h2c is required for a particular
resource, and that upgrade (which could have occurred in the
post-read-request phase) has not yet occurred during auth?

- moving things to post read sounds tempting, however I'm not sure if we
> want to upgrade on non-authed request or not, for example.
>

This is transport layer, yes, we always address the protocol without
consideration as to authnz; the same as we decode gzip irrespective of
client auth.  The actual requests over h2c (or http/1.1) are *each* still
subject to auth per-request.

I can't see a justification for excluding a client other than the user
agent identifier (known inoperable agent), otherwise h2c benefits the
client-server performance and there is no obvious reason to prevent it?


> I am not sure what else we do in post read, maybe someone else has an
> opinion about that. It certainly looks nicer in the OPTIONS * case.
>

The most critical thing for all of us to pay attention to is the setenvif
logic and mod_headers injection, things that are there to deliberately
affect the initial read and processing of.  The admin may want to trick
httpd into *not* honoring upgrades from specific user agent signatures that
are known-wonky, or when other request headers are present.  So I suggested
HOOK_LAST, although a slightly different order could work.  We carefully
inject mod_ssl (not upgrade, but the core read request hook) to fall after
mod_setenvif, but otherwise at HOOK_MIDDLE.

--001a1135fe9af615e405265a073d
Content-Type: text/html; charset=UTF-8
Content-Transfer-Encoding: quoted-printable

<div dir=3D"ltr"><div class=3D"gmail_extra"><div class=3D"gmail_quote">Sorr=
y it took so long to respond to this earlier post, some of this might have =
already been covered...</div><div class=3D"gmail_quote"><br></div><div clas=
s=3D"gmail_quote">On Mon, Dec 7, 2015 at 1:03 PM, Stefan Eissing <span dir=
=3D"ltr">&lt;<a href=3D"mailto:stefan.eissing@greenbytes.de" target=3D"_bla=
nk">stefan.eissing@greenbytes.de</a>&gt;</span> wrote:<br><blockquote class=
=3D"gmail_quote" style=3D"margin:0px 0px 0px 0.8ex;border-left-width:1px;bo=
rder-left-color:rgb(204,204,204);border-left-style:solid;padding-left:1ex">=
<div dir=3D"auto"><div></div><div>=C2=A0<br></div></div></blockquote><block=
quote class=3D"gmail_quote" style=3D"margin:0px 0px 0px 0.8ex;border-left-w=
idth:1px;border-left-color:rgb(204,204,204);border-left-style:solid;padding=
-left:1ex"><div dir=3D"auto"><div> Think about CORS restrictions and other =
stuff.</div><div>- I think its the protocol handlers job to deal with any r=
equest body.</div></div></blockquote><div><br></div><div>Strongly disagree,=
 because 1. the protocol switch mechansim isn&#39;t the content handler of =
the originating request, the request body is a request-level entity, and 2.=
 TLS gave you a perfect illustration of altering the connection stack to co=
ntinue using the core protocol stack.</div><div><br></div><div>In the case =
of h2c, or even a mod_echo Upgrade: echo mechanism, the entire request/resp=
onse is going to be handed off to a new protocol stack, I understand that.=
=C2=A0 But that is one of several use cases here, and that new protocol sta=
ck is going to consume the network pipe and close it, I trust?!?=C2=A0 And =
return the appropriate status that the connection is gone even if it leaves=
 the old code to mop up, e.g. lingering_close.</div><div><br></div><blockqu=
ote class=3D"gmail_quote" style=3D"margin:0px 0px 0px 0.8ex;border-left-wid=
th:1px;border-left-color:rgb(204,204,204);border-left-style:solid;padding-l=
eft:1ex"><div dir=3D"auto"><div>For h2 upgrade, for example, the switch is =
only offered for requests without body.</div></div></blockquote><div><br></=
div><div>Well, h2c is advertised on the first request with or without a bod=
y, and then never again. Other modules must advertise, e.g. in conjunction =
with the 426 Upgrade Required.</div><div><br></div><div>In fact, how do you=
 propose to handle an authentication case with h2c living in near the handl=
er phase, when it will alert during the authnz phase that http1.1 has been =
disallowed/h2c is required for a particular resource, and that upgrade (whi=
ch could have occurred in the post-read-request phase) has not yet occurred=
 during auth?</div><div><br></div><blockquote class=3D"gmail_quote" style=
=3D"margin:0px 0px 0px 0.8ex;border-left-width:1px;border-left-color:rgb(20=
4,204,204);border-left-style:solid;padding-left:1ex"><div dir=3D"auto"><div=
>- moving things to post read sounds tempting, however I&#39;m not sure if =
we want to upgrade on non-authed request or not, for example.<br></div></di=
v></blockquote><div><br></div><div>This is transport layer, yes, we always =
address the protocol without consideration as to authnz; the same as we dec=
ode gzip irrespective of client auth.=C2=A0 The actual requests over h2c (o=
r http/1.1) are *each* still subject to auth per-request.</div><div><br></d=
iv><div>I can&#39;t see a justification for excluding a client other than t=
he user agent identifier (known inoperable agent), otherwise h2c benefits t=
he client-server performance and there is no obvious reason to prevent it?<=
/div><div>=C2=A0<br></div><blockquote class=3D"gmail_quote" style=3D"margin=
:0px 0px 0px 0.8ex;border-left-width:1px;border-left-color:rgb(204,204,204)=
;border-left-style:solid;padding-left:1ex"><div dir=3D"auto"><div> I am not=
 sure what else we do in post read, maybe someone else has an opinion about=
 that. It certainly looks nicer in the OPTIONS * case.=C2=A0</div><span><fo=
nt color=3D"#888888"><div></div></font></span></div></blockquote></div><br>=
</div><div class=3D"gmail_extra">The most critical thing for all of us to p=
ay attention to is the setenvif logic and mod_headers injection, things tha=
t are there to deliberately affect the initial read and processing of.=C2=
=A0 The admin may want to trick httpd into *not* honoring upgrades from spe=
cific user agent signatures that are known-wonky, or when other request hea=
ders are present.=C2=A0 So I suggested HOOK_LAST, although a slightly diffe=
rent order could work.=C2=A0 We carefully inject mod_ssl (not upgrade, but =
the core read request hook) to fall after mod_setenvif, but otherwise at HO=
OK_MIDDLE.</div><div class=3D"gmail_extra"><br></div><div class=3D"gmail_ex=
tra"><br></div><div class=3D"gmail_extra"><br></div><div class=3D"gmail_ext=
ra"><br></div></div>

--001a1135fe9af615e405265a073d--

From dev-return-84938-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Tue Dec  8 06:36:57 2015
Return-Path: <dev-return-84938-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id DAE6218B5D
	for <apmail-httpd-dev-archive@www.apache.org>; Tue,  8 Dec 2015 06:36:57 +0000 (UTC)
Received: (qmail 15438 invoked by uid 500); 8 Dec 2015 06:36:57 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 15255 invoked by uid 500); 8 Dec 2015 06:36:56 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 15245 invoked by uid 99); 8 Dec 2015 06:36:56 -0000
Received: from Unknown (HELO spamd1-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 08 Dec 2015 06:36:56 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd1-us-west.apache.org (ASF Mail Server at spamd1-us-west.apache.org) with ESMTP id ABE5BC9407
	for <dev@httpd.apache.org>; Tue,  8 Dec 2015 06:36:55 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd1-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 2.891
X-Spam-Level: **
X-Spam-Status: No, score=2.891 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	HTML_MESSAGE=3, MIME_QP_LONG_LINE=0.001, SPF_PASS=-0.001,
	T_RP_MATCHES_RCVD=-0.01, URIBL_BLOCKED=0.001] autolearn=disabled
Authentication-Results: spamd1-us-west.apache.org (amavisd-new);
	dkim=pass (1024-bit key) header.d=greenbytes.de
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd1-us-west.apache.org [10.40.0.7]) (amavisd-new, port 10024)
	with ESMTP id NfgLBJSrPxEE for <dev@httpd.apache.org>;
	Tue,  8 Dec 2015 06:36:46 +0000 (UTC)
Received: from mail.greenbytes.de (mail.greenbytes.de [217.91.35.233])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id 4165642ADE
	for <dev@httpd.apache.org>; Tue,  8 Dec 2015 06:36:46 +0000 (UTC)
Received: from [192.168.178.61] (unknown [93.211.118.179])
	(using TLSv1 with cipher ECDHE-RSA-AES256-SHA (256/256 bits))
	(Client did not present a certificate)
	by mail.greenbytes.de (Postfix) with ESMTPSA id 9954615A00A5
	for <dev@httpd.apache.org>; Tue,  8 Dec 2015 07:36:44 +0100 (CET)
DKIM-Signature: v=1; a=rsa-sha256; c=simple/simple; d=greenbytes.de; s=mail;
	t=1449556604; bh=VdcwkVd6w1Y4lGXm0dyAWR+1rEYmRrHA0ZkPPQ6LCcE=;
	h=From:Subject:Date:References:In-Reply-To:To:From;
	b=ZQrMH3AUYA9g/+ON6Oe6stC7AzCPolNOL8p7fqugmx9Cdw59TDT738ff20QuCttlK
	 425lkTSeKelbB1m6rI+12xi6Y3yAaEFcdMNPUCrXZNW0BzIGKI+/QSr+ZRIgySMaTY
	 P3RUeOlNi9yKPnxpg8DkSM2fytm5wK+9AWRoYSpU=
From: Stefan Eissing <stefan.eissing@greenbytes.de>
Content-Type: multipart/alternative;
	boundary=Apple-Mail-3A5AAB69-15C3-4DFE-8C76-1F28A92E20BB
Content-Transfer-Encoding: 7bit
Mime-Version: 1.0 (1.0)
Subject: Re: 2.4 pause - mod_http2 patchset Upgrade h2c vs mod_ssl Upgrade tls
Message-Id: <6AE86B5D-5EFD-46BA-91ED-5D4BB882DC2C@greenbytes.de>
Date: Tue, 8 Dec 2015 07:36:43 +0100
References: <CACsi250=dbRQKnsbE8JSdAZRm5x99gE0sgX3iQ-PHAx77euD1A@mail.gmail.com> <CACsi2534prBtp7ENNNiEDevA3Z7u9uW2uuYMOa8-OoOsPSHNGQ@mail.gmail.com> <6C1FCB84-22AF-49D5-AA10-BFB922A98390@greenbytes.de> <CACsi250CCZSz6Rf-_mDNsXT+v3rwcYHuQOfPLibTQ-P=Wvz_pg@mail.gmail.com>
In-Reply-To: <CACsi250CCZSz6Rf-_mDNsXT+v3rwcYHuQOfPLibTQ-P=Wvz_pg@mail.gmail.com>
To: dev@httpd.apache.org
X-Mailer: iPhone Mail (13B143)


--Apple-Mail-3A5AAB69-15C3-4DFE-8C76-1F28A92E20BB
Content-Type: text/plain;
	charset=us-ascii
Content-Transfer-Encoding: quoted-printable

Wow, you have been busy in my sleep...

I will respond to individual messages later in my office. =46rom what I got o=
verall:

- I completely agree with Yann, request bodies, 100 continue or not, are sen=
t using the original, pre-upgrade protocol, e.g. http/1.1
- until the body is read, 101 may be sent back, but afterwards the downstrea=
m is talking the new protocol, while the upstream can only start doing so af=
ter the last request byte
- this makes upgrades on requests with bodies awkward for both parties. the a=
pproach of setaside nnn bytes is bad for interop as there is no standard wha=
t nnn is supposed to be, leading to failed requests varying by implementatio=
n or even size specific configuration. For h2 therfore all server implemento=
rs on the HTTP WG list at that time agreed to body-less upgrades only.=20
- In case a client wants to talk to a known server implementation and is con=
cerned about efficiency, I'd recommend http2 direct mode. 24 initial bytes a=
nd you have http2.
- as Jacob pointed out, some protocols need deeper inspections/other respons=
es before sending out 101. So, I think making that part of the protocol swit=
ch handler is better.

//Stefan

> Am 08.12.2015 um 03:50 schrieb William A Rowe Jr <wrowe@rowe-clan.net>:
>=20
> Sorry it took so long to respond to this earlier post, some of this might h=
ave already been covered...
>=20
>> On Mon, Dec 7, 2015 at 1:03 PM, Stefan Eissing <stefan.eissing@greenbytes=
.de> wrote:
>> =20
>> Think about CORS restrictions and other stuff.
>> - I think its the protocol handlers job to deal with any request body.
>=20
> Strongly disagree, because 1. the protocol switch mechansim isn't the cont=
ent handler of the originating request, the request body is a request-level e=
ntity, and 2. TLS gave you a perfect illustration of altering the connection=
 stack to continue using the core protocol stack.
>=20
> In the case of h2c, or even a mod_echo Upgrade: echo mechanism, the entire=
 request/response is going to be handed off to a new protocol stack, I under=
stand that.  But that is one of several use cases here, and that new protoco=
l stack is going to consume the network pipe and close it, I trust?!?  And r=
eturn the appropriate status that the connection is gone even if it leaves t=
he old code to mop up, e.g. lingering_close.
>=20
>> For h2 upgrade, for example, the switch is only offered for requests with=
out body.
>=20
> Well, h2c is advertised on the first request with or without a body, and t=
hen never again. Other modules must advertise, e.g. in conjunction with the 4=
26 Upgrade Required.
>=20
> In fact, how do you propose to handle an authentication case with h2c livi=
ng in near the handler phase, when it will alert during the authnz phase tha=
t http1.1 has been disallowed/h2c is required for a particular resource, and=
 that upgrade (which could have occurred in the post-read-request phase) has=
 not yet occurred during auth?
>=20
>> - moving things to post read sounds tempting, however I'm not sure if we w=
ant to upgrade on non-authed request or not, for example.
>=20
> This is transport layer, yes, we always address the protocol without consi=
deration as to authnz; the same as we decode gzip irrespective of client aut=
h.  The actual requests over h2c (or http/1.1) are *each* still subject to a=
uth per-request.
>=20
> I can't see a justification for excluding a client other than the user age=
nt identifier (known inoperable agent), otherwise h2c benefits the client-se=
rver performance and there is no obvious reason to prevent it?
> =20
>> I am not sure what else we do in post read, maybe someone else has an opi=
nion about that. It certainly looks nicer in the OPTIONS * case.=20
>=20
> The most critical thing for all of us to pay attention to is the setenvif l=
ogic and mod_headers injection, things that are there to deliberately affect=
 the initial read and processing of.  The admin may want to trick httpd into=
 *not* honoring upgrades from specific user agent signatures that are known-=
wonky, or when other request headers are present.  So I suggested HOOK_LAST,=
 although a slightly different order could work.  We carefully inject mod_ss=
l (not upgrade, but the core read request hook) to fall after mod_setenvif, b=
ut otherwise at HOOK_MIDDLE.
>=20
>=20
>=20
>=20

--Apple-Mail-3A5AAB69-15C3-4DFE-8C76-1F28A92E20BB
Content-Type: text/html;
	charset=utf-8
Content-Transfer-Encoding: quoted-printable

<html><head><meta http-equiv=3D"content-type" content=3D"text/html; charset=3D=
utf-8"></head><body dir=3D"auto"><div></div><div>Wow, you have been busy in m=
y sleep...</div><div><br></div><div>I will respond to individual messages la=
ter in my office. =46rom what I got overall:</div><div><br></div><div>- I co=
mpletely agree with Yann, request bodies, 100 continue or not, are sent usin=
g the original, pre-upgrade protocol, e.g. http/1.1</div><div>- until the bo=
dy is read, 101 may be sent back, but afterwards the downstream is talking t=
he new protocol, while the upstream can only start doing so after the last r=
equest byte</div><div>- this makes upgrades on requests with bodies awkward f=
or both parties. the approach of setaside nnn bytes is bad for interop as th=
ere is no standard what nnn is supposed to be, leading to failed requests va=
rying by implementation or even size specific configuration. For h2 therfore=
 all server implementors on the HTTP WG list at that time agreed to body-les=
s upgrades only.&nbsp;</div><div>- In case a client wants to talk to a known=
 server implementation and is concerned about efficiency, I'd recommend http=
2 direct mode. 24 initial bytes and you have http2.</div><div>- as Jacob poi=
nted out, some protocols need deeper inspections/other responses before send=
ing out 101. So, I think making that part of the protocol switch handler is b=
etter.</div><div><br></div><div>//Stefan</div><div><br>Am 08.12.2015 um 03:5=
0 schrieb William A Rowe Jr &lt;<a href=3D"mailto:wrowe@rowe-clan.net">wrowe=
@rowe-clan.net</a>&gt;:<br><br></div><blockquote type=3D"cite"><div><div dir=
=3D"ltr"><div class=3D"gmail_extra"><div class=3D"gmail_quote">Sorry it took=
 so long to respond to this earlier post, some of this might have already be=
en covered...</div><div class=3D"gmail_quote"><br></div><div class=3D"gmail_=
quote">On Mon, Dec 7, 2015 at 1:03 PM, Stefan Eissing <span dir=3D"ltr">&lt;=
<a href=3D"mailto:stefan.eissing@greenbytes.de" target=3D"_blank">stefan.eis=
sing@greenbytes.de</a>&gt;</span> wrote:<br><blockquote class=3D"gmail_quote=
" style=3D"margin:0px 0px 0px 0.8ex;border-left-width:1px;border-left-color:=
rgb(204,204,204);border-left-style:solid;padding-left:1ex"><div dir=3D"auto"=
><div></div><div>&nbsp;<br></div></div></blockquote><blockquote class=3D"gma=
il_quote" style=3D"margin:0px 0px 0px 0.8ex;border-left-width:1px;border-lef=
t-color:rgb(204,204,204);border-left-style:solid;padding-left:1ex"><div dir=3D=
"auto"><div> Think about CORS restrictions and other stuff.</div><div>- I th=
ink its the protocol handlers job to deal with any request body.</div></div>=
</blockquote><div><br></div><div>Strongly disagree, because 1. the protocol s=
witch mechansim isn't the content handler of the originating request, the re=
quest body is a request-level entity, and 2. TLS gave you a perfect illustra=
tion of altering the connection stack to continue using the core protocol st=
ack.</div><div><br></div><div>In the case of h2c, or even a mod_echo Upgrade=
: echo mechanism, the entire request/response is going to be handed off to a=
 new protocol stack, I understand that.&nbsp; But that is one of several use=
 cases here, and that new protocol stack is going to consume the network pip=
e and close it, I trust?!?&nbsp; And return the appropriate status that the c=
onnection is gone even if it leaves the old code to mop up, e.g. lingering_c=
lose.</div><div><br></div><blockquote class=3D"gmail_quote" style=3D"margin:=
0px 0px 0px 0.8ex;border-left-width:1px;border-left-color:rgb(204,204,204);b=
order-left-style:solid;padding-left:1ex"><div dir=3D"auto"><div>For h2 upgra=
de, for example, the switch is only offered for requests without body.</div>=
</div></blockquote><div><br></div><div>Well, h2c is advertised on the first r=
equest with or without a body, and then never again. Other modules must adve=
rtise, e.g. in conjunction with the 426 Upgrade Required.</div><div><br></di=
v><div>In fact, how do you propose to handle an authentication case with h2c=
 living in near the handler phase, when it will alert during the authnz phas=
e that http1.1 has been disallowed/h2c is required for a particular resource=
, and that upgrade (which could have occurred in the post-read-request phase=
) has not yet occurred during auth?</div><div><br></div><blockquote class=3D=
"gmail_quote" style=3D"margin:0px 0px 0px 0.8ex;border-left-width:1px;border=
-left-color:rgb(204,204,204);border-left-style:solid;padding-left:1ex"><div d=
ir=3D"auto"><div>- moving things to post read sounds tempting, however I'm n=
ot sure if we want to upgrade on non-authed request or not, for example.<br>=
</div></div></blockquote><div><br></div><div>This is transport layer, yes, w=
e always address the protocol without consideration as to authnz; the same a=
s we decode gzip irrespective of client auth.&nbsp; The actual requests over=
 h2c (or http/1.1) are *each* still subject to auth per-request.</div><div><=
br></div><div>I can't see a justification for excluding a client other than t=
he user agent identifier (known inoperable agent), otherwise h2c benefits th=
e client-server performance and there is no obvious reason to prevent it?</d=
iv><div>&nbsp;<br></div><blockquote class=3D"gmail_quote" style=3D"margin:0p=
x 0px 0px 0.8ex;border-left-width:1px;border-left-color:rgb(204,204,204);bor=
der-left-style:solid;padding-left:1ex"><div dir=3D"auto"><div> I am not sure=
 what else we do in post read, maybe someone else has an opinion about that.=
 It certainly looks nicer in the OPTIONS * case.&nbsp;</div><span><font colo=
r=3D"#888888"><div></div></font></span></div></blockquote></div><br></div><d=
iv class=3D"gmail_extra">The most critical thing for all of us to pay attent=
ion to is the setenvif logic and mod_headers injection, things that are ther=
e to deliberately affect the initial read and processing of.&nbsp; The admin=
 may want to trick httpd into *not* honoring upgrades from specific user age=
nt signatures that are known-wonky, or when other request headers are presen=
t.&nbsp; So I suggested HOOK_LAST, although a slightly different order could=
 work.&nbsp; We carefully inject mod_ssl (not upgrade, but the core read req=
uest hook) to fall after mod_setenvif, but otherwise at HOOK_MIDDLE.</div><d=
iv class=3D"gmail_extra"><br></div><div class=3D"gmail_extra"><br></div><div=
 class=3D"gmail_extra"><br></div><div class=3D"gmail_extra"><br></div></div>=

</div></blockquote></body></html>=

--Apple-Mail-3A5AAB69-15C3-4DFE-8C76-1F28A92E20BB--

From dev-return-84939-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Tue Dec  8 09:25:21 2015
Return-Path: <dev-return-84939-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 9E17B10257
	for <apmail-httpd-dev-archive@www.apache.org>; Tue,  8 Dec 2015 09:25:21 +0000 (UTC)
Received: (qmail 39272 invoked by uid 500); 8 Dec 2015 09:25:14 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 39184 invoked by uid 500); 8 Dec 2015 09:25:14 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 39174 invoked by uid 99); 8 Dec 2015 09:25:14 -0000
Received: from Unknown (HELO spamd2-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 08 Dec 2015 09:25:14 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd2-us-west.apache.org (ASF Mail Server at spamd2-us-west.apache.org) with ESMTP id F14CC1A09D1
	for <dev@httpd.apache.org>; Tue,  8 Dec 2015 09:25:13 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd2-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.654
X-Spam-Level:
X-Spam-Status: No, score=-0.654 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RP_MATCHES_RCVD=-0.554, SPF_PASS=-0.001, URIBL_BLOCKED=0.001]
	autolearn=disabled
Authentication-Results: spamd2-us-west.apache.org (amavisd-new);
	dkim=pass (1024-bit key) header.d=greenbytes.de
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd2-us-west.apache.org [10.40.0.9]) (amavisd-new, port 10024)
	with ESMTP id 6nUE78PIUjx3 for <dev@httpd.apache.org>;
	Tue,  8 Dec 2015 09:25:07 +0000 (UTC)
Received: from mail.greenbytes.de (mail.greenbytes.de [217.91.35.233])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id EDDC042AEE
	for <dev@httpd.apache.org>; Tue,  8 Dec 2015 09:25:06 +0000 (UTC)
Received: from [192.168.1.42] (unknown [217.91.35.233])
	(using TLSv1 with cipher ECDHE-RSA-AES256-SHA (256/256 bits))
	(Client did not present a certificate)
	by mail.greenbytes.de (Postfix) with ESMTPSA id 415AF15A043A
	for <dev@httpd.apache.org>; Tue,  8 Dec 2015 10:25:05 +0100 (CET)
DKIM-Signature: v=1; a=rsa-sha256; c=simple/simple; d=greenbytes.de; s=mail;
	t=1449566705; bh=P7evM/jMgY1JSaYT5jr8+QeRVMEGW6PEnABG9NxaJr4=;
	h=Subject:From:In-Reply-To:Date:References:To:From;
	b=IVGUP5QW1VY1bcOJ09wiBqsKMCVMqbRJ2uwxb8zj5V7k3rTzbjNVECUSRZ6B2sI55
	 xhsDlM/ZPr8h4YvkxS1SqCH1GSXxGQ1pN78lD7LT9kTScmfrVpViKowa6cDyv0c7nA
	 lvVYhPXzSgQUk/g7XkN1Fi+KaGZhp0QXOAROGojc=
Content-Type: text/plain; charset=us-ascii
Mime-Version: 1.0 (Mac OS X Mail 9.1 \(3096.5\))
Subject: Re: 2.4 pause - mod_http2 patchset Upgrade h2c vs mod_ssl Upgrade tls
From: Stefan Eissing <stefan.eissing@greenbytes.de>
In-Reply-To: <CACsi252Cq5GfmcXxFZebqyWXSaD=qZeSRBDAnVjbDJSoM4Ri=g@mail.gmail.com>
Date: Tue, 8 Dec 2015 10:25:04 +0100
Content-Transfer-Encoding: quoted-printable
Message-Id: <BEE86912-5123-4684-9B97-1811C3F55ACC@greenbytes.de>
References: <CACsi250=dbRQKnsbE8JSdAZRm5x99gE0sgX3iQ-PHAx77euD1A@mail.gmail.com> <CAKQ1sVOKT6_LUbC7pCFnykVYP_7L2vDj6ZWp_TOTsDXRDCjy-w@mail.gmail.com> <CAKQ1sVOHSrFjkDR5yi-N2M6qbCyMQ=Z6+=NcJ+FuYpXg_+W1qg@mail.gmail.com> <CACsi251o57Qmj3rvCO1cLgULcrxZUb=OEa6mKz+1SGus6-yoig@mail.gmail.com> <CAKQ1sVOKJhX5rUM-hixx2s8HtBPNYY+pJYf3-Uedrvwuaq6PPQ@mail.gmail.com> <CACsi252Cq5GfmcXxFZebqyWXSaD=qZeSRBDAnVjbDJSoM4Ri=g@mail.gmail.com>
To: dev@httpd.apache.org
X-Mailer: Apple Mail (2.3096.5)


> Am 08.12.2015 um 01:58 schrieb William A Rowe Jr =
<wrowe@rowe-clan.net>:
>=20
> On Mon, Dec 7, 2015 at 6:35 PM, Yann Ylavic <ylavic.dev@gmail.com> =
wrote:
> On Tue, Dec 8, 2015 at 1:27 AM, William A Rowe Jr =
<wrowe@rowe-clan.net> wrote:
> > On Mon, Dec 7, 2015 at 6:15 PM, Yann Ylavic <ylavic.dev@gmail.com> =
wrote:
> >>
> >> On Tue, Dec 8, 2015 at 1:07 AM, Yann Ylavic <ylavic.dev@gmail.com> =
wrote:
> >> >
> >> > the body ought to be
> >> > set aside for any (relevant) TLS response (which needs the
> >> > handshake...).
> >>
> >> Hmm, no need to set aside, *unless* with must produce a response
> >> before the entire body (and the handshake) is read.
> >> But we'd better not Upgrade in this case...
> >
> >
> > Yes, there is a set aside, because the handler will read from the =
filter
> > stack... the handler phase has not yet occurred, and other content
> > input filters may be inserted to transform the request body.
> >
> > The upgrade switch would occur before the request content handler
> > is invoked, in all cases (post_read_request, or later during fixups
> > or the very beginning of invoke_handler).
>=20
> But this isn't what the RFC says, right?
> The body of the first request is never Upgraded, so why would we read
> it using the Upgraded protocol?
>=20
> How do you mean?  The RFC states we must read the request body
> (following a 100-continue) prior to a 101-switching protocols.  AFTER
> the protocol is switched, we are ready to invoke the handler, which
> will read the request body (which I suggest we have set aside within=20=

> the http input filter) and it will write to the output filter stack, =
but to=20
> a different stack of protocol and network filters.

No, that is not what the RFC says. HTTP/1 switching protocols does not =
need
to happen simultaneously on upstream and downstream. Instead, the server
switches directly after the 101 response, the client switches after the =
last
byte of the request.

This is problematic for protocols like HTTP/2 who may require to receive
data in the new protocol format *before* they are able to read an =
arbitrarily
long request body. So, every HTTP/2 implementation will have a request
body maximum length that it can upgrade with. For interop reasons, me =
and
other implementors choose to have 0 as max length, since every clients
will run into that limit immediately and learn to cope with that.

Please remember that such a request will be answered correctly and that=20=

the client can upgrade to h2c on the next one, or anytime it likes. The
upgrade possibilities are announced by Apache on the first response, so
it should be easy to make a decision.

//Stefan



From dev-return-84940-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Tue Dec  8 09:42:37 2015
Return-Path: <dev-return-84940-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 9810C10331
	for <apmail-httpd-dev-archive@www.apache.org>; Tue,  8 Dec 2015 09:42:37 +0000 (UTC)
Received: (qmail 88607 invoked by uid 500); 8 Dec 2015 09:42:37 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 88533 invoked by uid 500); 8 Dec 2015 09:42:37 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 88523 invoked by uid 99); 8 Dec 2015 09:42:37 -0000
Received: from Unknown (HELO spamd2-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 08 Dec 2015 09:42:37 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd2-us-west.apache.org (ASF Mail Server at spamd2-us-west.apache.org) with ESMTP id B25811A0AB2
	for <dev@httpd.apache.org>; Tue,  8 Dec 2015 09:42:36 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd2-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.655
X-Spam-Level:
X-Spam-Status: No, score=-0.655 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RP_MATCHES_RCVD=-0.554, SPF_PASS=-0.001] autolearn=disabled
Authentication-Results: spamd2-us-west.apache.org (amavisd-new);
	dkim=pass (1024-bit key) header.d=greenbytes.de
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd2-us-west.apache.org [10.40.0.9]) (amavisd-new, port 10024)
	with ESMTP id AdRE1KumGBEf for <dev@httpd.apache.org>;
	Tue,  8 Dec 2015 09:42:35 +0000 (UTC)
Received: from mail.greenbytes.de (mail.greenbytes.de [217.91.35.233])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id 60B0542AEE
	for <dev@httpd.apache.org>; Tue,  8 Dec 2015 09:42:35 +0000 (UTC)
Received: from [192.168.1.42] (unknown [217.91.35.233])
	(using TLSv1 with cipher ECDHE-RSA-AES256-SHA (256/256 bits))
	(Client did not present a certificate)
	by mail.greenbytes.de (Postfix) with ESMTPSA id 7D75415A0A55
	for <dev@httpd.apache.org>; Tue,  8 Dec 2015 10:42:34 +0100 (CET)
DKIM-Signature: v=1; a=rsa-sha256; c=simple/simple; d=greenbytes.de; s=mail;
	t=1449567754; bh=hQswaHHWe3q+9gsCfYyIF8S7BotSoMuuFERbD4CcqLA=;
	h=Subject:From:In-Reply-To:Date:References:To:From;
	b=rOO1Unhk1LIph3cBXRmJDDZygo9g0vKRTvBWT8jEcHX+4da23+qU1GAwFtJ/PCKF1
	 jvs8MjathLEvQQJ20AGtvK3lh2B52IYfQ4E9CwkVdUV9z+UrSpyEp+H2iETR1vOu/A
	 EbE3BwR6ZZg3cKsPIBdz2/HeKR2F86uSf06nBQEY=
Content-Type: text/plain; charset=us-ascii
Mime-Version: 1.0 (Mac OS X Mail 9.1 \(3096.5\))
Subject: Re: 2.4 pause - mod_http2 patchset Upgrade h2c vs mod_ssl Upgradetls
From: Stefan Eissing <stefan.eissing@greenbytes.de>
In-Reply-To: <56660B43.2060507@gmail.com>
Date: Tue, 8 Dec 2015 10:42:34 +0100
Content-Transfer-Encoding: quoted-printable
Message-Id: <6B13DF2B-0586-42BB-B62F-59A7638B697D@greenbytes.de>
References: <CACsi250=dbRQKnsbE8JSdAZRm5x99gE0sgX3iQ-PHAx77euD1A@mail.gmail.com> <AB1691BE05AE7F4992697F2A0835627AC63BAB94@VOEXM10W.internal.vodafone.com> <F7B20D30-D34A-4805-A77D-F64F6428F6E3@greenbytes.de> <56660896.c74fc20a.15f56.0ebd@mx.google.com> <56660B43.2060507@gmail.com>
To: dev@httpd.apache.org
X-Mailer: Apple Mail (2.3096.5)


> Am 07.12.2015 um 23:42 schrieb Jacob Champion <champion.p@gmail.com>:
>=20
> On 12/07/2015 02:30 PM, Bert Huijben wrote:
>> Is this a h2 limitation or a mod_h2 limitation?
>>=20
>> If I would like h2c upgrade from Subversion without an additional
>> request I would have to send the upgrade request with a very short
>> OPTIONS request that has a body.
>=20
> The HTTP/2 spec (RFC 7540, sec 3.2) appears to allow the sending of a =
request body in an h2c upgrade (h2 upgrades are prohibited). So it would =
appear to be a mod_http2 limitation for now.
>=20
> Hopefully Stefan can confirm tomorrow (it's pretty late in Germany).

It is possible, but difficult to do unless you can read the body and set =
it aside somewhere. Which again imposes an arbitrary (for the client) =
limit. Experience shows that this leads to design of clients that work =
will in developments, but then encounter requests usage/sites/servers =
that have other limits and break.

If Apache accepts body lengths of up to 64KB (or something configurable) =
and some other server implements 8K and some third 1MB, how will that =
help design of a client that, for some reason, *wants* an upgrade to =
succeed?=20

//Stefan


From dev-return-84941-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Tue Dec  8 09:48:08 2015
Return-Path: <dev-return-84941-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 747F91036B
	for <apmail-httpd-dev-archive@www.apache.org>; Tue,  8 Dec 2015 09:48:08 +0000 (UTC)
Received: (qmail 98277 invoked by uid 500); 8 Dec 2015 09:48:08 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 98226 invoked by uid 500); 8 Dec 2015 09:48:07 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 98216 invoked by uid 99); 8 Dec 2015 09:48:07 -0000
Received: from Unknown (HELO spamd1-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 08 Dec 2015 09:48:07 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd1-us-west.apache.org (ASF Mail Server at spamd1-us-west.apache.org) with ESMTP id 79898C957B
	for <dev@httpd.apache.org>; Tue,  8 Dec 2015 09:48:07 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd1-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.101
X-Spam-Level:
X-Spam-Status: No, score=-0.101 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RCVD_IN_MSPIKE_H2=-0.001, SPF_PASS=-0.001, URIBL_BLOCKED=0.001]
	autolearn=disabled
Authentication-Results: spamd1-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd1-us-west.apache.org [10.40.0.7]) (amavisd-new, port 10024)
	with ESMTP id EXDSUX1p7LAj for <dev@httpd.apache.org>;
	Tue,  8 Dec 2015 09:48:01 +0000 (UTC)
Received: from mail-qk0-f176.google.com (mail-qk0-f176.google.com [209.85.220.176])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id AFEFD428ED
	for <dev@httpd.apache.org>; Tue,  8 Dec 2015 09:48:01 +0000 (UTC)
Received: by qkdp187 with SMTP id p187so21227957qkd.1
        for <dev@httpd.apache.org>; Tue, 08 Dec 2015 01:48:01 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        bh=L+0Vk377g1uIK2kjcJ5ktMaL3kETEmQyHoVf0ZDZ+xw=;
        b=cwmpI6Yinlk7EHH6QUmFLl15//7Ny7a+GdOVa91sAUFdaR3Fnynyu+fwVHL2i377af
         l+IOqF3t0MOcstWObORy6A9/Gm0U0hOVmm/sDIGB187gDOnNOH5dY9/l5G/uhfhTJed6
         Mc8Z+G92zmB3m8W9LkWToPy360cgXVE5N9fYFXBI1+zl89Fy4GWZxHUHsjYLw0kW6tdI
         0ELCfphQh9FOS5C48hxCOqmL833wByQFT1yftrytewYSEno6ioMaAaLLAeq/VTwD2Ijp
         /VwnJQf3+CwkUIzF+cIJ64FGBx+IlWds0uYPPax7wdAcgf5J/5oEK5G6XLj4jnHcvGWI
         aQvQ==
MIME-Version: 1.0
X-Received: by 10.55.80.194 with SMTP id e185mr3132952qkb.68.1449568081534;
 Tue, 08 Dec 2015 01:48:01 -0800 (PST)
Received: by 10.55.65.85 with HTTP; Tue, 8 Dec 2015 01:48:01 -0800 (PST)
In-Reply-To: <CACsi250YwVJ0WVHX9Z5V7nsYbvx+XM2EOm9RSzKM5Cj7rnf9mg@mail.gmail.com>
References: <CACsi250=dbRQKnsbE8JSdAZRm5x99gE0sgX3iQ-PHAx77euD1A@mail.gmail.com>
	<CAKQ1sVOKT6_LUbC7pCFnykVYP_7L2vDj6ZWp_TOTsDXRDCjy-w@mail.gmail.com>
	<CAKQ1sVOHSrFjkDR5yi-N2M6qbCyMQ=Z6+=NcJ+FuYpXg_+W1qg@mail.gmail.com>
	<CACsi251o57Qmj3rvCO1cLgULcrxZUb=OEa6mKz+1SGus6-yoig@mail.gmail.com>
	<CAKQ1sVOKJhX5rUM-hixx2s8HtBPNYY+pJYf3-Uedrvwuaq6PPQ@mail.gmail.com>
	<CACsi252Cq5GfmcXxFZebqyWXSaD=qZeSRBDAnVjbDJSoM4Ri=g@mail.gmail.com>
	<CAKQ1sVPCw_wjurNSgzE2c+f_PJjwLd=-0zezfr=DGT+se9xG6A@mail.gmail.com>
	<CACsi250YwVJ0WVHX9Z5V7nsYbvx+XM2EOm9RSzKM5Cj7rnf9mg@mail.gmail.com>
Date: Tue, 8 Dec 2015 10:48:01 +0100
Message-ID: <CAKQ1sVOeotN4oGYu16gLhTjH3_Kg9ufxWKNU6FbKbTrqpsPSZg@mail.gmail.com>
Subject: Re: 2.4 pause - mod_http2 patchset Upgrade h2c vs mod_ssl Upgrade tls
From: Yann Ylavic <ylavic.dev@gmail.com>
To: httpd-dev <dev@httpd.apache.org>
Content-Type: text/plain; charset=UTF-8

On Tue, Dec 8, 2015 at 3:07 AM, William A Rowe Jr <wrowe@rowe-clan.net> wrote:
>>
>> The handler handling the first request has to read the body before the
>> switch, eg. mod_proxy could forward the request without the client
>> having switched to any other protocol.
>
> Whoa... First the handler can't process the request until the switch, and
> more importantly the protocol upgrade is hop by hop, review s6.7 again
> please.

Hop by hop does not mean that Upgrade has to be done as soon as
possible, but that it must not be forwarded (this is client <=> httpd
stuff only, any the backend/origin wouldn't notice).

The handler has to process an HTTP/1 body (that is, plain text when
http: is used), because this is what the client will send (s6.7 states
that the first request is HTTP/1, including the body, IOW the client
can't change that between the header and the body).
So if we were to set aside the first request body on Upgrade, do the
switch, and then run the handler, the latter should not expect
anything else than HTTP/1 for the body (this is how the body is, be it
aside or not).

Moreover, if we choose to honor the Upgrade after the body, we must
produce a response which is Upgraded, that means for the TLS/1.x case
that we must first enable mod_ssl, read/write/do the TLS handshake so
that the response is really TLS/1.x upgraded.
We can indeed do that by reading/setaside the body, send the 101
switch to the client, do the handshake, play the setaside HTTP/1 body
through the input filter, and finally be HTTP/1+TLS on the (first)
response and further requests.
But I find this a bit complicated, not to talk about resources usage /
possible DOS...

>
> The mechanism to address your use case is HTTP/1.1 CONNECT.

My use case is a normal HTTP/1 request with a body, w/ or w/o
100-continue, through mod_proxy_http, not CONNECT.
And I don't want Upgrade to break or make this overly complicated.

>
>> That does not mean it has to (or prereqs a) setaside body, this could
>> be streamed (and is even desirable in the mod_proxy case).
>
> Not possible to read plaintext and write TLS, for example.  The body must be
> consumed first.

The HTTP/1 Upgrade described in the RFC is actually "read plaintext
and write TLS", AIUI.

>
>> So couldn't we handle the switch (101) in an output filter instead
>> (before the first bytes are sent)?
>
> No, for TLS, absolutely not.
>
> You presume the handler consumed the body, and you have no assurance of
> that.  Which means the output filter now needs to attend to the input filter
> state, and we are back where we started with the no 101 before the upgrade
> can be satisfied.

That's why I'd rather go with *not* honoring the Upgrade until a
request comes with no body.

From dev-return-84942-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Tue Dec  8 09:50:54 2015
Return-Path: <dev-return-84942-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 987D3103E5
	for <apmail-httpd-dev-archive@www.apache.org>; Tue,  8 Dec 2015 09:50:54 +0000 (UTC)
Received: (qmail 7803 invoked by uid 500); 8 Dec 2015 09:50:54 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 7727 invoked by uid 500); 8 Dec 2015 09:50:54 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 7715 invoked by uid 99); 8 Dec 2015 09:50:54 -0000
Received: from Unknown (HELO spamd4-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 08 Dec 2015 09:50:54 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd4-us-west.apache.org (ASF Mail Server at spamd4-us-west.apache.org) with ESMTP id 9F403C0473
	for <dev@httpd.apache.org>; Tue,  8 Dec 2015 09:50:53 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd4-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.654
X-Spam-Level:
X-Spam-Status: No, score=-0.654 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RP_MATCHES_RCVD=-0.554, SPF_PASS=-0.001, URIBL_BLOCKED=0.001]
	autolearn=disabled
Authentication-Results: spamd4-us-west.apache.org (amavisd-new);
	dkim=pass (1024-bit key) header.d=greenbytes.de
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd4-us-west.apache.org [10.40.0.11]) (amavisd-new, port 10024)
	with ESMTP id gNkrsnuRcUF0 for <dev@httpd.apache.org>;
	Tue,  8 Dec 2015 09:50:39 +0000 (UTC)
Received: from mail.greenbytes.de (mail.greenbytes.de [217.91.35.233])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id E34FE27D82
	for <dev@httpd.apache.org>; Tue,  8 Dec 2015 09:50:38 +0000 (UTC)
Received: from [192.168.1.42] (unknown [217.91.35.233])
	(using TLSv1 with cipher ECDHE-RSA-AES256-SHA (256/256 bits))
	(Client did not present a certificate)
	by mail.greenbytes.de (Postfix) with ESMTPSA id 4649D15A049C
	for <dev@httpd.apache.org>; Tue,  8 Dec 2015 10:50:08 +0100 (CET)
DKIM-Signature: v=1; a=rsa-sha256; c=simple/simple; d=greenbytes.de; s=mail;
	t=1449568208; bh=/B5k6qkabRq1E+ruyi2uqXQaLZZdE3I/ipAjdCljkDI=;
	h=Subject:From:In-Reply-To:Date:References:To:From;
	b=m3CbiIrvA99O8i3fmd5Qn//+E5Ql3ncznACMMbjob6CznFjQ01g0bCXUjIkcalIDF
	 uIYc2aiZWbQrcUrdd9T4wPonY9AWBBTaGqgZ2hDNGKKmsZ2qzQxy0mtEVUbfklWrre
	 ruIekWGfmXXzMnbtlUVLYrw+uXb4/wAdtVexo85c=
Content-Type: text/plain; charset=us-ascii
Mime-Version: 1.0 (Mac OS X Mail 9.1 \(3096.5\))
Subject: Re: 2.4 pause - mod_http2 patchset Upgrade h2c vs mod_ssl Upgrade tls
From: Stefan Eissing <stefan.eissing@greenbytes.de>
In-Reply-To: <CAKQ1sVOeotN4oGYu16gLhTjH3_Kg9ufxWKNU6FbKbTrqpsPSZg@mail.gmail.com>
Date: Tue, 8 Dec 2015 10:50:08 +0100
Content-Transfer-Encoding: quoted-printable
Message-Id: <9DF81856-CC9E-415F-A449-CE9FA64FADD6@greenbytes.de>
References: <CACsi250=dbRQKnsbE8JSdAZRm5x99gE0sgX3iQ-PHAx77euD1A@mail.gmail.com> <CAKQ1sVOKT6_LUbC7pCFnykVYP_7L2vDj6ZWp_TOTsDXRDCjy-w@mail.gmail.com> <CAKQ1sVOHSrFjkDR5yi-N2M6qbCyMQ=Z6+=NcJ+FuYpXg_+W1qg@mail.gmail.com> <CACsi251o57Qmj3rvCO1cLgULcrxZUb=OEa6mKz+1SGus6-yoig@mail.gmail.com> <CAKQ1sVOKJhX5rUM-hixx2s8HtBPNYY+pJYf3-Uedrvwuaq6PPQ@mail.gmail.com> <CACsi252Cq5GfmcXxFZebqyWXSaD=qZeSRBDAnVjbDJSoM4Ri=g@mail.gmail.com> <CAKQ1sVPCw_wjurNSgzE2c+f_PJjwLd=-0zezfr=DGT+se9xG6A@mail.gmail.com> <CACsi250YwVJ0WVHX9Z5V7nsYbvx+XM2EOm9RSzKM5Cj7rnf9mg@mail.gmail.com> <CAKQ1sVOeotN4oGYu16gLhTjH3_Kg9ufxWKNU6FbKbTrqpsPSZg@mail.gmail.com>
To: dev@httpd.apache.org
X-Mailer: Apple Mail (2.3096.5)


> Am 08.12.2015 um 10:48 schrieb Yann Ylavic <ylavic.dev@gmail.com>:
>=20
> On Tue, Dec 8, 2015 at 3:07 AM, William A Rowe Jr =
<wrowe@rowe-clan.net> wrote:
> [...]
> That's why I'd rather go with *not* honoring the Upgrade until a
> request comes with no body.

++1=

From dev-return-84943-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Tue Dec  8 10:07:41 2015
Return-Path: <dev-return-84943-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 34874104D4
	for <apmail-httpd-dev-archive@www.apache.org>; Tue,  8 Dec 2015 10:07:41 +0000 (UTC)
Received: (qmail 39553 invoked by uid 500); 8 Dec 2015 10:07:40 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 39460 invoked by uid 500); 8 Dec 2015 10:07:40 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 39450 invoked by uid 99); 8 Dec 2015 10:07:40 -0000
Received: from Unknown (HELO spamd2-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 08 Dec 2015 10:07:40 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd2-us-west.apache.org (ASF Mail Server at spamd2-us-west.apache.org) with ESMTP id 2D1631A35A7
	for <dev@httpd.apache.org>; Tue,  8 Dec 2015 10:07:40 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd2-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.654
X-Spam-Level:
X-Spam-Status: No, score=-0.654 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RP_MATCHES_RCVD=-0.554, SPF_PASS=-0.001, URIBL_BLOCKED=0.001]
	autolearn=disabled
Authentication-Results: spamd2-us-west.apache.org (amavisd-new);
	dkim=pass (1024-bit key) header.d=greenbytes.de
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd2-us-west.apache.org [10.40.0.9]) (amavisd-new, port 10024)
	with ESMTP id dTbGz2wFQ-tw for <dev@httpd.apache.org>;
	Tue,  8 Dec 2015 10:07:26 +0000 (UTC)
Received: from mail.greenbytes.de (mail.greenbytes.de [217.91.35.233])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id 0184B20F4F
	for <dev@httpd.apache.org>; Tue,  8 Dec 2015 10:07:25 +0000 (UTC)
Received: from [192.168.1.42] (unknown [217.91.35.233])
	(using TLSv1 with cipher ECDHE-RSA-AES256-SHA (256/256 bits))
	(Client did not present a certificate)
	by mail.greenbytes.de (Postfix) with ESMTPSA id 42CD215A049C
	for <dev@httpd.apache.org>; Tue,  8 Dec 2015 11:07:24 +0100 (CET)
DKIM-Signature: v=1; a=rsa-sha256; c=simple/simple; d=greenbytes.de; s=mail;
	t=1449569244; bh=yxt7Nhxwazpr7OWCUFK5RxtaPeq2cpbH8nQ51RZhURs=;
	h=Subject:From:In-Reply-To:Date:References:To:From;
	b=g/1yH773CKp9dnZ9KOWrCN8cG/pt3SmuJXli6+rMSyFSILn4P9H7YgZE7p72Pl33h
	 sW+NzvvSxXtmjveBeWXXxaHDbj+jX0dN0sobVdKFfgexHuJnbXTpVJRjmSypfw8en4
	 CEtFSsd4ReJZ2DCACu60Q6/XKjlH+Yb92T6fpCFw=
Content-Type: text/plain; charset=us-ascii
Mime-Version: 1.0 (Mac OS X Mail 9.1 \(3096.5\))
Subject: Upgrade Summary
From: Stefan Eissing <stefan.eissing@greenbytes.de>
In-Reply-To: <6B13DF2B-0586-42BB-B62F-59A7638B697D@greenbytes.de>
Date: Tue, 8 Dec 2015 11:07:24 +0100
Content-Transfer-Encoding: quoted-printable
Message-Id: <13FE9E7F-9620-4BF9-8EA4-57A6314D66BF@greenbytes.de>
References: <CACsi250=dbRQKnsbE8JSdAZRm5x99gE0sgX3iQ-PHAx77euD1A@mail.gmail.com> <AB1691BE05AE7F4992697F2A0835627AC63BAB94@VOEXM10W.internal.vodafone.com> <F7B20D30-D34A-4805-A77D-F64F6428F6E3@greenbytes.de> <56660896.c74fc20a.15f56.0ebd@mx.google.com> <56660B43.2060507@gmail.com> <6B13DF2B-0586-42BB-B62F-59A7638B697D@greenbytes.de>
To: dev@httpd.apache.org
X-Mailer: Apple Mail (2.3096.5)

Trying to summarize the status of the discussion and where the issues =
are with the current Upgrade implementation.

Clarified:
A. any 100 must be sent out *before* a 101 response
B. request bodies are to be read in the original protocol, input filters =
like chunk can be used, indeed are necessary, as if the request is being =
processed normally
C. if a protocol supports upgrade on request bodies is up to the =
protocol implementation and needs to be checked in the "propose" phase

Open:
1. Protocols like Websocket need to take over the 101 sending themselves =
in the "switch protocol" phase. (correct, Jacob?). Should we delegate =
the sending of the 101 to the protocol switch handler?
2. General handling of request bodies. Options:
  a setaside in core of up to nnn bytes before switch invocation
  b do nothing, let protocol switch handler care about it
3. When to do the upgrade dance:
  a post_read_request: upgrade precedes authentication
  b handler: upgrade only honored on authenticated and otherwise ok =
requests
  c both: introduce separate hooks? have an additional parameter? more =
complexity
4. status code of protocol switch handler: if we move the task of 101 =
sending, the switch handler might not do it and keep the connection on =
the "old" protocol. Then a connection close is not necessary. So, we =
would do the close only when the switch handler returns APR_EOF.
5. Will it be possible to migrate the current TLS upgrade handling to =
this revised scheme?

Anything I missed?

PS. Re 5: with change 1+4, a TLS upgrade switcher could install an =
output filter, return and have it being processed normally. The output =
filter would then send the 101 and do the TLS handshake. Would that =
work?

> Am 08.12.2015 um 10:42 schrieb Stefan Eissing =
<stefan.eissing@greenbytes.de>:
>=20
>=20
>> Am 07.12.2015 um 23:42 schrieb Jacob Champion <champion.p@gmail.com>:
>>=20
>> On 12/07/2015 02:30 PM, Bert Huijben wrote:
>>> Is this a h2 limitation or a mod_h2 limitation?
>>>=20
>>> If I would like h2c upgrade from Subversion without an additional
>>> request I would have to send the upgrade request with a very short
>>> OPTIONS request that has a body.
>>=20
>> The HTTP/2 spec (RFC 7540, sec 3.2) appears to allow the sending of a =
request body in an h2c upgrade (h2 upgrades are prohibited). So it would =
appear to be a mod_http2 limitation for now.
>>=20
>> Hopefully Stefan can confirm tomorrow (it's pretty late in Germany).
>=20
> It is possible, but difficult to do unless you can read the body and =
set it aside somewhere. Which again imposes an arbitrary (for the =
client) limit. Experience shows that this leads to design of clients =
that work will in developments, but then encounter requests =
usage/sites/servers that have other limits and break.
>=20
> If Apache accepts body lengths of up to 64KB (or something =
configurable) and some other server implements 8K and some third 1MB, =
how will that help design of a client that, for some reason, *wants* an =
upgrade to succeed?=20
>=20
> //Stefan
>=20


From dev-return-84944-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Tue Dec  8 10:25:03 2015
Return-Path: <dev-return-84944-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 821D810582
	for <apmail-httpd-dev-archive@www.apache.org>; Tue,  8 Dec 2015 10:25:03 +0000 (UTC)
Received: (qmail 74138 invoked by uid 500); 8 Dec 2015 10:24:50 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 74046 invoked by uid 500); 8 Dec 2015 10:24:50 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 74033 invoked by uid 99); 8 Dec 2015 10:24:50 -0000
Received: from Unknown (HELO spamd4-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 08 Dec 2015 10:24:50 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd4-us-west.apache.org (ASF Mail Server at spamd4-us-west.apache.org) with ESMTP id AE1C7C0473
	for <dev@httpd.apache.org>; Tue,  8 Dec 2015 10:24:49 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd4-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.1
X-Spam-Level:
X-Spam-Status: No, score=-0.1 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	SPF_PASS=-0.001, URIBL_BLOCKED=0.001] autolearn=disabled
Authentication-Results: spamd4-us-west.apache.org (amavisd-new);
	dkim=pass (1024-bit key) header.d=qqmail.nl
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd4-us-west.apache.org [10.40.0.11]) (amavisd-new, port 10024)
	with ESMTP id ZS4Motd31c_l for <dev@httpd.apache.org>;
	Tue,  8 Dec 2015 10:24:34 +0000 (UTC)
Received: from mail-wm0-f52.google.com (mail-wm0-f52.google.com [74.125.82.52])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id 0C95B20F4F
	for <dev@httpd.apache.org>; Tue,  8 Dec 2015 10:24:34 +0000 (UTC)
Received: by wmww144 with SMTP id w144so23572668wmw.0
        for <dev@httpd.apache.org>; Tue, 08 Dec 2015 02:24:33 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=qqmail.nl; s=google;
        h=from:to:references:in-reply-to:subject:date:message-id:mime-version
         :content-type:content-transfer-encoding:thread-index
         :content-language;
        bh=PQCTqXVShaMeAJYfleJG1MXK42eaJxXKgoPnAKGNxig=;
        b=QITS46OuPnAR9N6OnYScln2Tthp9HRgh0/ffxZ8S06blffzgtewgjA39xonfwesMeK
         QWFCkSKWG5HGHs1Ln4t87OCdLttZeAjY0uDNo8lfL+w8dnsY5oRz1YNz0A4FVRyVa+er
         Aajs3UiYHtKqgaYJ0YLPfqWwcell6bj4FB1kY=
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=1e100.net; s=20130820;
        h=x-gm-message-state:from:to:references:in-reply-to:subject:date
         :message-id:mime-version:content-type:content-transfer-encoding
         :thread-index:content-language;
        bh=PQCTqXVShaMeAJYfleJG1MXK42eaJxXKgoPnAKGNxig=;
        b=CY+/FMgChOayr8KXPSBAkQb4TOplB/46shKMgrPGhV9NE2RHgBHJaw7ABsXr5jWmp3
         tjzAAe4dyHh6KjdKnQStQSyWk3yY8c4kqlNhod18Ze+pLlIE1GUBLNkCOvtucj4M02az
         A/JRt9o60SRQdlCpWnYLjqLNQz5yW+Ekn9RWjKDNewKlBwN0GR4l20zilFCZaaWshIRa
         ad4EKHaqIlonXdIu4SqC3eBHhueRsM+b/d6frTQNsSC8WY5P0KcfundADrtaarUEQ863
         jjOMN00P7GAzokoc2zovil1Vi0wLxqO90iRBrzzyIs/BueoQD+9filAOPZFa6C/3ZJzP
         zBTg==
X-Gm-Message-State: ALoCoQnmG49dbhPI3AGV2yT+js4XjYLeyivzGGxnuh9D7eE3fqsS7ewHHx+bESkDI+Unzu3bj6VhpFiKTq2bsbI3dLm0WyRcZg==
X-Received: by 10.28.72.136 with SMTP id v130mr3488276wma.60.1449570273690;
        Tue, 08 Dec 2015 02:24:33 -0800 (PST)
Received: from I72600 ([2001:610:66e:0:52e5:49ff:fee1:96b7])
        by smtp.gmail.com with ESMTPSA id gl10sm2290074wjb.30.2015.12.08.02.24.32
        for <dev@httpd.apache.org>
        (version=TLS1_2 cipher=ECDHE-RSA-AES128-GCM-SHA256 bits=128/128);
        Tue, 08 Dec 2015 02:24:33 -0800 (PST)
From: "Bert Huijben" <bert@qqmail.nl>
To: <dev@httpd.apache.org>
References: <CACsi250=dbRQKnsbE8JSdAZRm5x99gE0sgX3iQ-PHAx77euD1A@mail.gmail.com> <CAKQ1sVOKT6_LUbC7pCFnykVYP_7L2vDj6ZWp_TOTsDXRDCjy-w@mail.gmail.com> <CAKQ1sVOHSrFjkDR5yi-N2M6qbCyMQ=Z6+=NcJ+FuYpXg_+W1qg@mail.gmail.com> <CACsi251o57Qmj3rvCO1cLgULcrxZUb=OEa6mKz+1SGus6-yoig@mail.gmail.com> <CAKQ1sVOKJhX5rUM-hixx2s8HtBPNYY+pJYf3-Uedrvwuaq6PPQ@mail.gmail.com> <CACsi252Cq5GfmcXxFZebqyWXSaD=qZeSRBDAnVjbDJSoM4Ri=g@mail.gmail.com> <BEE86912-5123-4684-9B97-1811C3F55ACC@greenbytes.de>
In-Reply-To: <BEE86912-5123-4684-9B97-1811C3F55ACC@greenbytes.de>
Subject: RE: 2.4 pause - mod_http2 patchset Upgrade h2c vs mod_ssl Upgrade tls
Date: Tue, 8 Dec 2015 11:24:26 +0100
Message-ID: <cf0f01d131a2$9f062ca0$dd1285e0$@qqmail.nl>
MIME-Version: 1.0
Content-Type: text/plain;
	charset="us-ascii"
Content-Transfer-Encoding: 7bit
X-Mailer: Microsoft Outlook 16.0
Thread-Index: AQKiK5k53Zwc1sqI7zswkQpwqyBJZQKGbLq8At66pcICZhyUyAIHALWHAwMJOtMBSq7BkZyt7Ibg
Content-Language: nl



> -----Original Message-----
> From: Stefan Eissing [mailto:stefan.eissing@greenbytes.de]
> Sent: dinsdag 8 december 2015 10:25
> To: dev@httpd.apache.org
> Subject: Re: 2.4 pause - mod_http2 patchset Upgrade h2c vs mod_ssl
> Upgrade tls
> 
> 
> > Am 08.12.2015 um 01:58 schrieb William A Rowe Jr <wrowe@rowe-
> clan.net>:
> >
> > On Mon, Dec 7, 2015 at 6:35 PM, Yann Ylavic <ylavic.dev@gmail.com>
> wrote:
> > On Tue, Dec 8, 2015 at 1:27 AM, William A Rowe Jr <wrowe@rowe-
> clan.net> wrote:
> > > On Mon, Dec 7, 2015 at 6:15 PM, Yann Ylavic <ylavic.dev@gmail.com>
> wrote:
> > >>
> > >> On Tue, Dec 8, 2015 at 1:07 AM, Yann Ylavic <ylavic.dev@gmail.com>
> wrote:
> > >> >
> > >> > the body ought to be
> > >> > set aside for any (relevant) TLS response (which needs the
> > >> > handshake...).
> > >>
> > >> Hmm, no need to set aside, *unless* with must produce a response
> > >> before the entire body (and the handshake) is read.
> > >> But we'd better not Upgrade in this case...
> > >
> > >
> > > Yes, there is a set aside, because the handler will read from the
filter
> > > stack... the handler phase has not yet occurred, and other content
> > > input filters may be inserted to transform the request body.
> > >
> > > The upgrade switch would occur before the request content handler
> > > is invoked, in all cases (post_read_request, or later during fixups
> > > or the very beginning of invoke_handler).
> >
> > But this isn't what the RFC says, right?
> > The body of the first request is never Upgraded, so why would we read
> > it using the Upgraded protocol?
> >
> > How do you mean?  The RFC states we must read the request body
> > (following a 100-continue) prior to a 101-switching protocols.  AFTER
> > the protocol is switched, we are ready to invoke the handler, which
> > will read the request body (which I suggest we have set aside within
> > the http input filter) and it will write to the output filter stack, but
to
> > a different stack of protocol and network filters.
> 
> No, that is not what the RFC says. HTTP/1 switching protocols does not
need
> to happen simultaneously on upstream and downstream. Instead, the server
> switches directly after the 101 response, the client switches after the
last
> byte of the request.

The client can only switch once it has confirmation from the server, that it
is really going to perform the upgrade. If the server doesn't accept the
upgrade it must continue using 1.1.

So it has to stop producing data after that first request and first check if
there is a 101 response before it can pipeline the next request.
 
In pipelining clients such as serf this makes a huge difference.

At some points during update/checkout we may have tens of requests pipelined
on a single connection... but that process starts a bit after the initial
handshake. I'm trying to be in H2(c) at that point, to avoid opening the
additional connections at that point, which we currently have.


Once the client has the 101 it can switch protocol for both input and output
and start sending the next request. Waiting for the 101 is a full stall.

	Bert


From dev-return-84945-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Tue Dec  8 10:32:59 2015
Return-Path: <dev-return-84945-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 83606105BC
	for <apmail-httpd-dev-archive@www.apache.org>; Tue,  8 Dec 2015 10:32:59 +0000 (UTC)
Received: (qmail 85722 invoked by uid 500); 8 Dec 2015 10:32:59 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 85659 invoked by uid 500); 8 Dec 2015 10:32:58 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 85641 invoked by uid 99); 8 Dec 2015 10:32:58 -0000
Received: from Unknown (HELO spamd1-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 08 Dec 2015 10:32:58 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd1-us-west.apache.org (ASF Mail Server at spamd1-us-west.apache.org) with ESMTP id 5C3C8C6BA5
	for <dev@httpd.apache.org>; Tue,  8 Dec 2015 10:32:58 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd1-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.121
X-Spam-Level:
X-Spam-Status: No, score=-0.121 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RCVD_IN_MSPIKE_H3=-0.01, RCVD_IN_MSPIKE_WL=-0.01, SPF_PASS=-0.001]
	autolearn=disabled
Authentication-Results: spamd1-us-west.apache.org (amavisd-new);
	dkim=pass (1024-bit key) header.d=qqmail.nl
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd1-us-west.apache.org [10.40.0.7]) (amavisd-new, port 10024)
	with ESMTP id K6mYElClt97w for <dev@httpd.apache.org>;
	Tue,  8 Dec 2015 10:32:57 +0000 (UTC)
Received: from mail-wm0-f41.google.com (mail-wm0-f41.google.com [74.125.82.41])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id 6EC3720B91
	for <dev@httpd.apache.org>; Tue,  8 Dec 2015 10:32:56 +0000 (UTC)
Received: by wmww144 with SMTP id w144so175222217wmw.1
        for <dev@httpd.apache.org>; Tue, 08 Dec 2015 02:27:56 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=qqmail.nl; s=google;
        h=from:to:references:in-reply-to:subject:date:message-id:mime-version
         :content-type:content-transfer-encoding:thread-index
         :content-language;
        bh=eRHKT/uvACSNu+meFh8BtQFKqqcO8GIBOH+VPY+nyHA=;
        b=Bi9wZ9pW3hp3dG8MZ8qrdlH6QSpEjlSVGs8shNGHXpbQEseU5rwBd2a8P7hJDIV9BY
         c2P1moE4dShrnuLdfjBHpZxd0eol/2JpeAsCJ6XGuhsrENW+owfqUots1gmBYJjYYnRU
         QhSaGpuc1Kw/kNAStEBmjJDC24ySKpd+KQp48=
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=1e100.net; s=20130820;
        h=x-gm-message-state:from:to:references:in-reply-to:subject:date
         :message-id:mime-version:content-type:content-transfer-encoding
         :thread-index:content-language;
        bh=eRHKT/uvACSNu+meFh8BtQFKqqcO8GIBOH+VPY+nyHA=;
        b=RaNOn4051iFh8lNsL52/IEAVWC6AZb0d/ssZjeK1RmOh7mbXyjWLw+PyImiGpAnEeM
         Ow97dqssLGSTZrsBCfA0IqDcdmPrQAoUidehqx81uqc/qdKyO8u03ihy+H/DoRcrXNPQ
         tNCV2QLfLKdZfCtqdQASi9AqmclEHb/p5zNgNaZdJn1zEYIfAQRMnW02GqEeKKyc9tJ2
         LTIvCXfX4zw2TN9eY6fOrLJf84BfjU8EJLlj8Wesqc0PPZM/dtjXX3Ux3gbYtS4vqNs9
         OOURSmbnd/YIkeXv1k0zhdI9QEVwF7Dc2jIwjkfzJBwyYdxioN1oz+dLubUcpCSAKStg
         NGhw==
X-Gm-Message-State: ALoCoQl6WM0dL84n/f2BL0BhxlOOrd1VZbWnzFGJOsw7C5u8gHN6xMJRlJ9oyijZLfSfM+VwXUUzFKzewISsdSrI2uIYMOKqww==
X-Received: by 10.28.49.65 with SMTP id x62mr3730871wmx.49.1449570476055;
        Tue, 08 Dec 2015 02:27:56 -0800 (PST)
Received: from I72600 ([2001:610:66e:0:52e5:49ff:fee1:96b7])
        by smtp.gmail.com with ESMTPSA id e83sm2774241wmc.23.2015.12.08.02.27.55
        for <dev@httpd.apache.org>
        (version=TLS1_2 cipher=ECDHE-RSA-AES128-GCM-SHA256 bits=128/128);
        Tue, 08 Dec 2015 02:27:55 -0800 (PST)
From: "Bert Huijben" <bert@qqmail.nl>
To: <dev@httpd.apache.org>
References: <CACsi250=dbRQKnsbE8JSdAZRm5x99gE0sgX3iQ-PHAx77euD1A@mail.gmail.com> <AB1691BE05AE7F4992697F2A0835627AC63BAB94@VOEXM10W.internal.vodafone.com> <F7B20D30-D34A-4805-A77D-F64F6428F6E3@greenbytes.de> <56660896.c74fc20a.15f56.0ebd@mx.google.com> <56660B43.2060507@gmail.com> <6B13DF2B-0586-42BB-B62F-59A7638B697D@greenbytes.de>
In-Reply-To: <6B13DF2B-0586-42BB-B62F-59A7638B697D@greenbytes.de>
Subject: RE: 2.4 pause - mod_http2 patchset Upgrade h2c vs mod_ssl Upgradetls
Date: Tue, 8 Dec 2015 11:27:49 +0100
Message-ID: <cf1001d131a3$17b28220$47178660$@qqmail.nl>
MIME-Version: 1.0
Content-Type: text/plain;
	charset="us-ascii"
Content-Transfer-Encoding: 7bit
X-Mailer: Microsoft Outlook 16.0
Thread-Index: AQKiK5k53Zwc1sqI7zswkQpwqyBJZQHPPeQLAlYfy+wBw01DvAJJXKo0Ai3vbIycy+5uUA==
Content-Language: nl



> -----Original Message-----
> From: Stefan Eissing [mailto:stefan.eissing@greenbytes.de]
> Sent: dinsdag 8 december 2015 10:43
> To: dev@httpd.apache.org
> Subject: Re: 2.4 pause - mod_http2 patchset Upgrade h2c vs mod_ssl
> Upgradetls


> If Apache accepts body lengths of up to 64KB (or something configurable)
> and some other server implements 8K and some third 1MB, how will that
> help design of a client that, for some reason, *wants* an upgrade to
> succeed?

For Subversion this would make a 100% difference.

Currently all true Subversion servers are implemented via httpd.


Upgrade to h2c is currently not interesting for webbrowsers as all of them
have decided not to implement it... But it makes a huge difference for web
applications that talk to specific servers.

Which is very similar to that TLS upgrade that is interested for
webprinting... These usecases don't use combinations of random clients, with
random servers... They use specific combinations.

	Bert


From dev-return-84946-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Tue Dec  8 10:35:54 2015
Return-Path: <dev-return-84946-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 24B05105C8
	for <apmail-httpd-dev-archive@www.apache.org>; Tue,  8 Dec 2015 10:35:54 +0000 (UTC)
Received: (qmail 87934 invoked by uid 500); 8 Dec 2015 10:35:53 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 87867 invoked by uid 500); 8 Dec 2015 10:35:53 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 87856 invoked by uid 99); 8 Dec 2015 10:35:53 -0000
Received: from Unknown (HELO spamd4-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 08 Dec 2015 10:35:53 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd4-us-west.apache.org (ASF Mail Server at spamd4-us-west.apache.org) with ESMTP id 26DA6C0295
	for <dev@httpd.apache.org>; Tue,  8 Dec 2015 10:35:53 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd4-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.121
X-Spam-Level:
X-Spam-Status: No, score=-0.121 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RCVD_IN_MSPIKE_H3=-0.01, RCVD_IN_MSPIKE_WL=-0.01, SPF_PASS=-0.001]
	autolearn=disabled
Authentication-Results: spamd4-us-west.apache.org (amavisd-new);
	dkim=pass (1024-bit key) header.d=qqmail.nl
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd4-us-west.apache.org [10.40.0.11]) (amavisd-new, port 10024)
	with ESMTP id FW2w0hdHS_iS for <dev@httpd.apache.org>;
	Tue,  8 Dec 2015 10:35:51 +0000 (UTC)
Received: from mail-wm0-f43.google.com (mail-wm0-f43.google.com [74.125.82.43])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id E6C9442B93
	for <dev@httpd.apache.org>; Tue,  8 Dec 2015 10:35:50 +0000 (UTC)
Received: by wmww144 with SMTP id w144so175314144wmw.1
        for <dev@httpd.apache.org>; Tue, 08 Dec 2015 02:30:48 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=qqmail.nl; s=google;
        h=from:to:references:in-reply-to:subject:date:message-id:mime-version
         :content-type:content-transfer-encoding:thread-index
         :content-language;
        bh=oA67nh/ZudSmSDkfGu7wcSbIljQaMOmpSh8IVovKnsY=;
        b=QF0UOG2139P49RB7g1SfIsE2kdoehN+Q9DarEImbbvTF4RG/1O72ZOu8btMIMLenmX
         qcu1isKSbSu6rkQg2kdHn0nNY+D8keg98stDdfaCpIX79LDOXMs9fwcgrudYX2jQucGD
         UGdfInJGMNOcxahUqA7/u/z4kT2j1Pj63oqhc=
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=1e100.net; s=20130820;
        h=x-gm-message-state:from:to:references:in-reply-to:subject:date
         :message-id:mime-version:content-type:content-transfer-encoding
         :thread-index:content-language;
        bh=oA67nh/ZudSmSDkfGu7wcSbIljQaMOmpSh8IVovKnsY=;
        b=m1Jl7m2aEXPMumuDY9uXv3r6cTTEo66RzIbFJUQ+NgZL/nNhisuMyJqt5Xdow9NzDx
         yij9P1t3CHKxORFwl0brEMKz9SuQy53+yf5Abx2uAGWxGuamD9AORYevou8NZrBh2wZm
         zqQKf3RuE/1XctyBERc3+i5GLYEG/utatRXxlIEhZ3tEHv3Wuzsqtg0IpFu7BReatFpu
         kv5hSR5n6dWrrHFu6YsHl/SsNOVKbIcXMRRoU83RVpWLpOaMHssn435KckYBshKOgNVR
         W6JzHEq3gU5xInzbZRNHpzxzw8PJff+5/Pvre68nY8OERvoWrLhyJm+kgpALwdjMkE/m
         Lb4g==
X-Gm-Message-State: ALoCoQnCiiAovf09pqZX4wJ/VY9Z8FszpsdMLAMw1o90b4cmj2ScVzCNqwr9assEDXT7njdithSbkShaPJaRwjTSotOyFLnF/A==
X-Received: by 10.28.4.212 with SMTP id 203mr27960665wme.89.1449570648819;
        Tue, 08 Dec 2015 02:30:48 -0800 (PST)
Received: from I72600 ([2001:610:66e:0:52e5:49ff:fee1:96b7])
        by smtp.gmail.com with ESMTPSA id t3sm1974392wjz.11.2015.12.08.02.30.48
        for <dev@httpd.apache.org>
        (version=TLS1_2 cipher=ECDHE-RSA-AES128-GCM-SHA256 bits=128/128);
        Tue, 08 Dec 2015 02:30:48 -0800 (PST)
From: "Bert Huijben" <bert@qqmail.nl>
To: <dev@httpd.apache.org>
References: <CACsi250=dbRQKnsbE8JSdAZRm5x99gE0sgX3iQ-PHAx77euD1A@mail.gmail.com> <AB1691BE05AE7F4992697F2A0835627AC63BAB94@VOEXM10W.internal.vodafone.com> <F7B20D30-D34A-4805-A77D-F64F6428F6E3@greenbytes.de> <56660896.c74fc20a.15f56.0ebd@mx.google.com> <56660B43.2060507@gmail.com> <6B13DF2B-0586-42BB-B62F-59A7638B697D@greenbytes.de> <13FE9E7F-9620-4BF9-8EA4-57A6314D66BF@greenbytes.de>
In-Reply-To: <13FE9E7F-9620-4BF9-8EA4-57A6314D66BF@greenbytes.de>
Subject: RE: Upgrade Summary
Date: Tue, 8 Dec 2015 11:30:42 +0100
Message-ID: <cf1101d131a3$7eaef300$7c0cd900$@qqmail.nl>
MIME-Version: 1.0
Content-Type: text/plain;
	charset="us-ascii"
Content-Transfer-Encoding: 7bit
X-Mailer: Microsoft Outlook 16.0
Thread-Index: AQKiK5k53Zwc1sqI7zswkQpwqyBJZQHPPeQLAlYfy+wBw01DvAJJXKo0Ai3vbIwBtCRQO5y+STQQ
Content-Language: nl

> -----Original Message-----
> From: Stefan Eissing [mailto:stefan.eissing@greenbytes.de]
> Sent: dinsdag 8 december 2015 11:07
> To: dev@httpd.apache.org
> Subject: Upgrade Summary
> 
> Trying to summarize the status of the discussion and where the issues are
> with the current Upgrade implementation.
> 
> Clarified:
> A. any 100 must be sent out *before* a 101 response
> B. request bodies are to be read in the original protocol, input filters
like
> chunk can be used, indeed are necessary, as if the request is being
> processed normally
> C. if a protocol supports upgrade on request bodies is up to the protocol
> implementation and needs to be checked in the "propose" phase
> 
> Open:
> 1. Protocols like Websocket need to take over the 101 sending themselves
in
> the "switch protocol" phase. (correct, Jacob?). Should we delegate the
> sending of the 101 to the protocol switch handler?

If possible I would recommend avoiding this. I think the original protocol
should setup the response and then the final protocol should somehow be able
to annotate this.

The problems we try to solve now originate from the problem of doing things
different in different protocol handlers, while in theory many upgrades are
very similar.

The TLS and H2C upgrades both begin in one form and end in a different form.
Websockets are kind of different in that they require a bad request response
in a specific case. I'm not sure in which protocol this error needs to be
send though.

In TLS and H2C further errors can always be produced in the new protocol, so
when the handshake succeeds things can just go on.

> 2. General handling of request bodies. Options:
>   a setaside in core of up to nnn bytes before switch invocation
>   b do nothing, let protocol switch handler care about it

For Subversion to be able to use upgrade we would need to support a small
body on a request (few hundred bytes. Content-Length header provided).

During our current (already optimized) handshake all requests have bodies,
and introducing an additional request just to upgrade will slow things down
quite measurable on operation like 'svn log', that are mostly bound by the
handshake time.

We can't just switch the handshake to be something else... our handshake was
built upon WEBDAV and DELTA/V. We added several headers to avoid many
requests we previously performed, but we can't move away from that initial
OPTIONS request without slowing down against all older servers.

	Bert



From dev-return-84947-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Tue Dec  8 10:38:59 2015
Return-Path: <dev-return-84947-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id EEFCB105E0
	for <apmail-httpd-dev-archive@www.apache.org>; Tue,  8 Dec 2015 10:38:58 +0000 (UTC)
Received: (qmail 93176 invoked by uid 500); 8 Dec 2015 10:38:58 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 93109 invoked by uid 500); 8 Dec 2015 10:38:58 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 93098 invoked by uid 99); 8 Dec 2015 10:38:58 -0000
Received: from Unknown (HELO spamd1-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 08 Dec 2015 10:38:58 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd1-us-west.apache.org (ASF Mail Server at spamd1-us-west.apache.org) with ESMTP id F0B87C748E
	for <dev@httpd.apache.org>; Tue,  8 Dec 2015 10:38:57 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd1-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.11
X-Spam-Level:
X-Spam-Status: No, score=-0.11 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	SPF_PASS=-0.001, T_RP_MATCHES_RCVD=-0.01, URIBL_BLOCKED=0.001]
	autolearn=disabled
Authentication-Results: spamd1-us-west.apache.org (amavisd-new);
	dkim=pass (1024-bit key) header.d=greenbytes.de
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd1-us-west.apache.org [10.40.0.7]) (amavisd-new, port 10024)
	with ESMTP id iQywhkg0rqOr for <dev@httpd.apache.org>;
	Tue,  8 Dec 2015 10:38:52 +0000 (UTC)
Received: from mail.greenbytes.de (mail.greenbytes.de [217.91.35.233])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id E3D2242AEE
	for <dev@httpd.apache.org>; Tue,  8 Dec 2015 10:38:51 +0000 (UTC)
Received: from [192.168.1.42] (unknown [217.91.35.233])
	(using TLSv1 with cipher ECDHE-RSA-AES256-SHA (256/256 bits))
	(Client did not present a certificate)
	by mail.greenbytes.de (Postfix) with ESMTPSA id B8D2415A05B1
	for <dev@httpd.apache.org>; Tue,  8 Dec 2015 11:38:50 +0100 (CET)
DKIM-Signature: v=1; a=rsa-sha256; c=simple/simple; d=greenbytes.de; s=mail;
	t=1449571130; bh=veql3WloXIJp5/32QlJEIkXt4vV4U1uE7vxlZSBNf2E=;
	h=Subject:From:In-Reply-To:Date:References:To:From;
	b=LiwaVjMIz8T5RbHV+Qhy8USPfsJPiJTdvIT1FHhy8G/V2Rfg4zsLD8qebxXc89mV6
	 5/38acbA3nCylrKyL6fvcu925FTCjT0R/heteLfYGFdjkx6GQAsAInALdwxaqKraZJ
	 J9qKI9B20fP8sDhwxRC578VijT9xcJ7kvO4J6n2U=
Content-Type: text/plain; charset=us-ascii
Mime-Version: 1.0 (Mac OS X Mail 9.1 \(3096.5\))
Subject: Re: Upgrade Summary
From: Stefan Eissing <stefan.eissing@greenbytes.de>
In-Reply-To: <cf1101d131a3$7eaef300$7c0cd900$@qqmail.nl>
Date: Tue, 8 Dec 2015 11:38:50 +0100
Content-Transfer-Encoding: quoted-printable
Message-Id: <5B376659-4E44-47E9-B1D3-E680AC089D1E@greenbytes.de>
References: <CACsi250=dbRQKnsbE8JSdAZRm5x99gE0sgX3iQ-PHAx77euD1A@mail.gmail.com> <AB1691BE05AE7F4992697F2A0835627AC63BAB94@VOEXM10W.internal.vodafone.com> <F7B20D30-D34A-4805-A77D-F64F6428F6E3@greenbytes.de> <56660896.c74fc20a.15f56.0ebd@mx.google.com> <56660B43.2060507@gmail.com> <6B13DF2B-0586-42BB-B62F-59A7638B697D@greenbytes.de> <13FE9E7F-9620-4BF9-8EA4-57A6314D66BF@greenbytes.de> <cf1101d131a3$7eaef300$7c0cd900$@qqmail.nl>
To: dev@httpd.apache.org
X-Mailer: Apple Mail (2.3096.5)

Bert,

why can't you use h2c in direct mode? I assume you could store server =
support for this in the checkout meta data somewhere.

//Stefan

> Am 08.12.2015 um 11:30 schrieb Bert Huijben <bert@qqmail.nl>:
>=20
>> -----Original Message-----
>> From: Stefan Eissing [mailto:stefan.eissing@greenbytes.de]
>> Sent: dinsdag 8 december 2015 11:07
>> To: dev@httpd.apache.org
>> Subject: Upgrade Summary
>>=20
>> Trying to summarize the status of the discussion and where the issues =
are
>> with the current Upgrade implementation.
>>=20
>> Clarified:
>> A. any 100 must be sent out *before* a 101 response
>> B. request bodies are to be read in the original protocol, input =
filters
> like
>> chunk can be used, indeed are necessary, as if the request is being
>> processed normally
>> C. if a protocol supports upgrade on request bodies is up to the =
protocol
>> implementation and needs to be checked in the "propose" phase
>>=20
>> Open:
>> 1. Protocols like Websocket need to take over the 101 sending =
themselves
> in
>> the "switch protocol" phase. (correct, Jacob?). Should we delegate =
the
>> sending of the 101 to the protocol switch handler?
>=20
> If possible I would recommend avoiding this. I think the original =
protocol
> should setup the response and then the final protocol should somehow =
be able
> to annotate this.
>=20
> The problems we try to solve now originate from the problem of doing =
things
> different in different protocol handlers, while in theory many =
upgrades are
> very similar.
>=20
> The TLS and H2C upgrades both begin in one form and end in a different =
form.
> Websockets are kind of different in that they require a bad request =
response
> in a specific case. I'm not sure in which protocol this error needs to =
be
> send though.
>=20
> In TLS and H2C further errors can always be produced in the new =
protocol, so
> when the handshake succeeds things can just go on.
>=20
>> 2. General handling of request bodies. Options:
>>  a setaside in core of up to nnn bytes before switch invocation
>>  b do nothing, let protocol switch handler care about it
>=20
> For Subversion to be able to use upgrade we would need to support a =
small
> body on a request (few hundred bytes. Content-Length header provided).
>=20
> During our current (already optimized) handshake all requests have =
bodies,
> and introducing an additional request just to upgrade will slow things =
down
> quite measurable on operation like 'svn log', that are mostly bound by =
the
> handshake time.
>=20
> We can't just switch the handshake to be something else... our =
handshake was
> built upon WEBDAV and DELTA/V. We added several headers to avoid many
> requests we previously performed, but we can't move away from that =
initial
> OPTIONS request without slowing down against all older servers.
>=20
> 	Bert


From dev-return-84948-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Tue Dec  8 10:41:26 2015
Return-Path: <dev-return-84948-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 6E6B9105EC
	for <apmail-httpd-dev-archive@www.apache.org>; Tue,  8 Dec 2015 10:41:26 +0000 (UTC)
Received: (qmail 95534 invoked by uid 500); 8 Dec 2015 10:41:25 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 95460 invoked by uid 500); 8 Dec 2015 10:41:25 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 95450 invoked by uid 99); 8 Dec 2015 10:41:25 -0000
Received: from Unknown (HELO spamd4-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 08 Dec 2015 10:41:25 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd4-us-west.apache.org (ASF Mail Server at spamd4-us-west.apache.org) with ESMTP id 51633C094F
	for <dev@httpd.apache.org>; Tue,  8 Dec 2015 10:41:25 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd4-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.654
X-Spam-Level:
X-Spam-Status: No, score=-0.654 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RP_MATCHES_RCVD=-0.554, SPF_PASS=-0.001, URIBL_BLOCKED=0.001]
	autolearn=disabled
Authentication-Results: spamd4-us-west.apache.org (amavisd-new);
	dkim=pass (1024-bit key) header.d=greenbytes.de
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd4-us-west.apache.org [10.40.0.11]) (amavisd-new, port 10024)
	with ESMTP id 3-fRAoOXA6HP for <dev@httpd.apache.org>;
	Tue,  8 Dec 2015 10:41:18 +0000 (UTC)
Received: from mail.greenbytes.de (mail.greenbytes.de [217.91.35.233])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id 7838642B93
	for <dev@httpd.apache.org>; Tue,  8 Dec 2015 10:41:18 +0000 (UTC)
Received: from [192.168.1.42] (unknown [217.91.35.233])
	(using TLSv1 with cipher ECDHE-RSA-AES256-SHA (256/256 bits))
	(Client did not present a certificate)
	by mail.greenbytes.de (Postfix) with ESMTPSA id 3EF4515A049C
	for <dev@httpd.apache.org>; Tue,  8 Dec 2015 11:36:17 +0100 (CET)
DKIM-Signature: v=1; a=rsa-sha256; c=simple/simple; d=greenbytes.de; s=mail;
	t=1449570977; bh=5i8UofPJ95NZ1vVhGOTikvTXm5HwnKqiL9gyNwqVpN0=;
	h=Subject:From:In-Reply-To:Date:References:To:From;
	b=RNrKN2LPJERRqodkjetWPTAPV9rajZM4/XxSgEMOw7i4urqYdQysUt5yzmySQU1bG
	 1sQTd9E9tHxWlM4a1lwF4pZJ4tqfvCi83gm3gw90HHDW+vX7MdE0xqL/Yt0O80AwIF
	 zgjXQAPj28xLRljjFQru/QLjtXAFlEVomXiFyp1I=
Content-Type: text/plain; charset=us-ascii
Mime-Version: 1.0 (Mac OS X Mail 9.1 \(3096.5\))
Subject: Re: 2.4 pause - mod_http2 patchset Upgrade h2c vs mod_ssl Upgradetls
From: Stefan Eissing <stefan.eissing@greenbytes.de>
In-Reply-To: <cf1001d131a3$17b28220$47178660$@qqmail.nl>
Date: Tue, 8 Dec 2015 11:36:17 +0100
Content-Transfer-Encoding: quoted-printable
Message-Id: <4258EB04-447D-4F9B-B549-1209F87AD374@greenbytes.de>
References: <CACsi250=dbRQKnsbE8JSdAZRm5x99gE0sgX3iQ-PHAx77euD1A@mail.gmail.com> <AB1691BE05AE7F4992697F2A0835627AC63BAB94@VOEXM10W.internal.vodafone.com> <F7B20D30-D34A-4805-A77D-F64F6428F6E3@greenbytes.de> <56660896.c74fc20a.15f56.0ebd@mx.google.com> <56660B43.2060507@gmail.com> <6B13DF2B-0586-42BB-B62F-59A7638B697D@greenbytes.de> <cf1001d131a3$17b28220$47178660$@qqmail.nl>
To: dev@httpd.apache.org
X-Mailer: Apple Mail (2.3096.5)

Bert,

I do not understand. How do you want to make pipelining requests and =
protocol upgrades work together? I assume you talk about http pipelining =
where you send a second request before you receive the response for the =
first one...

//Stefan

> Am 08.12.2015 um 11:27 schrieb Bert Huijben <bert@qqmail.nl>:
>=20
>=20
>=20
>> -----Original Message-----
>> From: Stefan Eissing [mailto:stefan.eissing@greenbytes.de]
>> Sent: dinsdag 8 december 2015 10:43
>> To: dev@httpd.apache.org
>> Subject: Re: 2.4 pause - mod_http2 patchset Upgrade h2c vs mod_ssl
>> Upgradetls
>=20
>=20
>> If Apache accepts body lengths of up to 64KB (or something =
configurable)
>> and some other server implements 8K and some third 1MB, how will that
>> help design of a client that, for some reason, *wants* an upgrade to
>> succeed?
>=20
> For Subversion this would make a 100% difference.
>=20
> Currently all true Subversion servers are implemented via httpd.
>=20
>=20
> Upgrade to h2c is currently not interesting for webbrowsers as all of =
them
> have decided not to implement it... But it makes a huge difference for =
web
> applications that talk to specific servers.
>=20
> Which is very similar to that TLS upgrade that is interested for
> webprinting... These usecases don't use combinations of random =
clients, with
> random servers... They use specific combinations.
>=20
> 	Bert
>=20


From dev-return-84949-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Tue Dec  8 10:44:47 2015
Return-Path: <dev-return-84949-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 1C9421060B
	for <apmail-httpd-dev-archive@www.apache.org>; Tue,  8 Dec 2015 10:44:47 +0000 (UTC)
Received: (qmail 10113 invoked by uid 500); 8 Dec 2015 10:44:46 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 10040 invoked by uid 500); 8 Dec 2015 10:44:46 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 10030 invoked by uid 99); 8 Dec 2015 10:44:46 -0000
Received: from Unknown (HELO spamd2-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 08 Dec 2015 10:44:46 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd2-us-west.apache.org (ASF Mail Server at spamd2-us-west.apache.org) with ESMTP id 081711A359B
	for <dev@httpd.apache.org>; Tue,  8 Dec 2015 10:44:46 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd2-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.101
X-Spam-Level:
X-Spam-Status: No, score=-0.101 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RCVD_IN_MSPIKE_H2=-0.001, SPF_PASS=-0.001, URIBL_BLOCKED=0.001]
	autolearn=disabled
Authentication-Results: spamd2-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd2-us-west.apache.org [10.40.0.9]) (amavisd-new, port 10024)
	with ESMTP id 2nYYtU5ZxDaS for <dev@httpd.apache.org>;
	Tue,  8 Dec 2015 10:44:41 +0000 (UTC)
Received: from mail-qg0-f48.google.com (mail-qg0-f48.google.com [209.85.192.48])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id 551C020599
	for <dev@httpd.apache.org>; Tue,  8 Dec 2015 10:44:40 +0000 (UTC)
Received: by qgcc31 with SMTP id c31so11928432qgc.3
        for <dev@httpd.apache.org>; Tue, 08 Dec 2015 02:44:39 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type:content-transfer-encoding;
        bh=YijPsXgbgvzWgd5eK7GZek6Ay3RURC9XTyy2CdSbQR8=;
        b=QLi0x/jhvaVGpteprPaOSaq9/aCbBB+hyBW+3S48g2ceyHbLWfIgHKSnBPrkhEkef/
         5TXGvf++ZZG81yEsOd7o7DJMWad9psDTIs6AFBmHlHNTHNV2808Rdx0UPHwm1gtW0Hpg
         EbohuW7/3RTmmoVtovtPUlOFDmr9S+Grvr9xrpHJQ4R2NkCw/DzkXPEs/QVh33eD0bQ4
         OXXeNvS6KlCoIpO6X+tQX0CBCepj3po3cKmBy+gleuR2i4EL/pFcUdKlMpmZB1s10GjP
         uGZQX52L/vN4HWmIvyJLKQW3BY3KcJDoO8Uihl0+oM1ZuRknoq7ZhPjBE4qWDbBSvm5/
         x7Uw==
MIME-Version: 1.0
X-Received: by 10.140.89.201 with SMTP id v67mr3599828qgd.38.1449571479475;
 Tue, 08 Dec 2015 02:44:39 -0800 (PST)
Received: by 10.55.65.85 with HTTP; Tue, 8 Dec 2015 02:44:39 -0800 (PST)
In-Reply-To: <13FE9E7F-9620-4BF9-8EA4-57A6314D66BF@greenbytes.de>
References: <CACsi250=dbRQKnsbE8JSdAZRm5x99gE0sgX3iQ-PHAx77euD1A@mail.gmail.com>
	<AB1691BE05AE7F4992697F2A0835627AC63BAB94@VOEXM10W.internal.vodafone.com>
	<F7B20D30-D34A-4805-A77D-F64F6428F6E3@greenbytes.de>
	<56660896.c74fc20a.15f56.0ebd@mx.google.com>
	<56660B43.2060507@gmail.com>
	<6B13DF2B-0586-42BB-B62F-59A7638B697D@greenbytes.de>
	<13FE9E7F-9620-4BF9-8EA4-57A6314D66BF@greenbytes.de>
Date: Tue, 8 Dec 2015 11:44:39 +0100
Message-ID: <CAKQ1sVNaRRRVn-Qp_OuR-oK6D32dJeSoBKRrteMtr+ABjZMB7w@mail.gmail.com>
Subject: Re: Upgrade Summary
From: Yann Ylavic <ylavic.dev@gmail.com>
To: httpd-dev <dev@httpd.apache.org>
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: quoted-printable

On Tue, Dec 8, 2015 at 11:07 AM, Stefan Eissing
<stefan.eissing@greenbytes.de> wrote:
> Trying to summarize the status of the discussion and where the issues are=
 with the current Upgrade implementation.
>
> Clarified:
> A. any 100 must be sent out *before* a 101 response
> B. request bodies are to be read in the original protocol, input filters =
like chunk can be used, indeed are necessary, as if the request is being pr=
ocessed normally
> C. if a protocol supports upgrade on request bodies is up to the protocol=
 implementation and needs to be checked in the "propose" phase

Agreed.

>
> Open:
> 1. Protocols like Websocket need to take over the 101 sending themselves =
in the "switch protocol" phase. (correct, Jacob?). Should we delegate the s=
ending of the 101 to the protocol switch handler?
> 2. General handling of request bodies. Options:
>   a setaside in core of up to nnn bytes before switch invocation
>   b do nothing, let protocol switch handler care about it

a. is tempting, where nnn would be the limit above which we don't honor Upg=
rade.
But that could be a default behaviour, i.e. when "Protocols ... http1"
is finally elected.
Possibly specific modules would bypass that?

> 3. When to do the upgrade dance:
>   a post_read_request: upgrade precedes authentication

Looks like it can't be RFC compliant, is it?

>   b handler: upgrade only honored on authenticated and otherwise ok reque=
sts

This is probably the right thing to do, would OPTIONS be special is this ca=
se?

>   c both: introduce separate hooks? have an additional parameter? more co=
mplexity

Depends on whether OPTIONS (others?) need special treatment.

> 4. status code of protocol switch handler: if we move the task of 101 sen=
ding, the switch handler might not do it and keep the connection on the "ol=
d" protocol. Then a connection close is not necessary. So, we would do the =
close only when the switch handler returns APR_EOF.
> 5. Will it be possible to migrate the current TLS upgrade handling to thi=
s revised scheme?

We must do that IMHO, the scheme should be suite for all the cases.

>
> PS. Re 5: with change 1+4, a TLS upgrade switcher could install an output=
 filter, return and have it being processed normally. The output filter wou=
ld then send the 101 and do the TLS handshake. Would that work?

The issue is that this output filter would have to both read and write
during the TLS handshake, not sure this is suitable.

From dev-return-84950-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Tue Dec  8 10:46:21 2015
Return-Path: <dev-return-84950-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 11B8710617
	for <apmail-httpd-dev-archive@www.apache.org>; Tue,  8 Dec 2015 10:46:21 +0000 (UTC)
Received: (qmail 11860 invoked by uid 500); 8 Dec 2015 10:46:14 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 11791 invoked by uid 500); 8 Dec 2015 10:46:14 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 11781 invoked by uid 99); 8 Dec 2015 10:46:14 -0000
Received: from Unknown (HELO spamd4-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 08 Dec 2015 10:46:14 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd4-us-west.apache.org (ASF Mail Server at spamd4-us-west.apache.org) with ESMTP id E2357C0BC9
	for <dev@httpd.apache.org>; Tue,  8 Dec 2015 10:46:13 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd4-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.101
X-Spam-Level:
X-Spam-Status: No, score=-0.101 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RCVD_IN_MSPIKE_H2=-0.001, SPF_PASS=-0.001, URIBL_BLOCKED=0.001]
	autolearn=disabled
Authentication-Results: spamd4-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd4-us-west.apache.org [10.40.0.11]) (amavisd-new, port 10024)
	with ESMTP id gzV_5YP9Xcuf for <dev@httpd.apache.org>;
	Tue,  8 Dec 2015 10:46:07 +0000 (UTC)
Received: from mail-qg0-f45.google.com (mail-qg0-f45.google.com [209.85.192.45])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id 5B05F20E9B
	for <dev@httpd.apache.org>; Tue,  8 Dec 2015 10:46:06 +0000 (UTC)
Received: by qgea14 with SMTP id a14so12079311qge.0
        for <dev@httpd.apache.org>; Tue, 08 Dec 2015 02:46:05 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        bh=6zHB3pIHc6riiQadft8kuBHrlYxiteLIFJ5w+YyJxMY=;
        b=CP692Lf3o66N/9K41vATdIJr6NWor1b4D87ZVBRfgjRg9C6qRYuvnxLyKZqNhfjSpE
         XTLb7erK49IDhgHMGwJ3pUMmokUW0oTcosHgbK8qkiFXtTMb7o4cxTFg20FnaXt/aKQL
         GFkhrqN0zQ5KlCtNOAz0W3LDZVXRTc2VGrkBVXy+wJQTynvkTc4RN2Ri7R5v8fY/3wLB
         8k1vyweRqqFN6sRygD/wY6HYjp+ekVvDMIhz5fXq4t1gcVGyTHxgdFRO4GgnbtV+hCfq
         pLBRz5c2LiJ/cthmiEmUHJ3564pSG4M+bzDvAXhjptoIlPchZPUDEMepsfceI9TtWWal
         BClQ==
MIME-Version: 1.0
X-Received: by 10.140.43.9 with SMTP id d9mr3374026qga.51.1449571565472; Tue,
 08 Dec 2015 02:46:05 -0800 (PST)
Received: by 10.55.65.85 with HTTP; Tue, 8 Dec 2015 02:46:05 -0800 (PST)
In-Reply-To: <4258EB04-447D-4F9B-B549-1209F87AD374@greenbytes.de>
References: <CACsi250=dbRQKnsbE8JSdAZRm5x99gE0sgX3iQ-PHAx77euD1A@mail.gmail.com>
	<AB1691BE05AE7F4992697F2A0835627AC63BAB94@VOEXM10W.internal.vodafone.com>
	<F7B20D30-D34A-4805-A77D-F64F6428F6E3@greenbytes.de>
	<56660896.c74fc20a.15f56.0ebd@mx.google.com>
	<56660B43.2060507@gmail.com>
	<6B13DF2B-0586-42BB-B62F-59A7638B697D@greenbytes.de>
	<cf1001d131a3$17b28220$47178660$@qqmail.nl>
	<4258EB04-447D-4F9B-B549-1209F87AD374@greenbytes.de>
Date: Tue, 8 Dec 2015 11:46:05 +0100
Message-ID: <CAKQ1sVMnenCDEdmyuwpo9cszUNV3Bv+L3RjHAbmZ=MZ+Ep2bEA@mail.gmail.com>
Subject: Re: 2.4 pause - mod_http2 patchset Upgrade h2c vs mod_ssl Upgradetls
From: Yann Ylavic <ylavic.dev@gmail.com>
To: httpd-dev <dev@httpd.apache.org>
Content-Type: text/plain; charset=UTF-8

On Tue, Dec 8, 2015 at 11:36 AM, Stefan Eissing
<stefan.eissing@greenbytes.de> wrote:
>
> I do not understand. How do you want to make pipelining requests and protocol upgrades work together? I assume you talk about http pipelining where you send a second request before you receive the response for the first one...

I suppose pipelining would start from the second request...

From dev-return-84951-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Tue Dec  8 10:55:01 2015
Return-Path: <dev-return-84951-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id E3E731065A
	for <apmail-httpd-dev-archive@www.apache.org>; Tue,  8 Dec 2015 10:55:01 +0000 (UTC)
Received: (qmail 25051 invoked by uid 500); 8 Dec 2015 10:55:01 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 24971 invoked by uid 500); 8 Dec 2015 10:55:01 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 24952 invoked by uid 99); 8 Dec 2015 10:55:01 -0000
Received: from Unknown (HELO spamd2-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 08 Dec 2015 10:55:01 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd2-us-west.apache.org (ASF Mail Server at spamd2-us-west.apache.org) with ESMTP id A4DCE1A0C84
	for <dev@httpd.apache.org>; Tue,  8 Dec 2015 10:55:00 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd2-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.654
X-Spam-Level:
X-Spam-Status: No, score=-0.654 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RP_MATCHES_RCVD=-0.554, SPF_PASS=-0.001, URIBL_BLOCKED=0.001]
	autolearn=disabled
Authentication-Results: spamd2-us-west.apache.org (amavisd-new);
	dkim=pass (1024-bit key) header.d=greenbytes.de
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd2-us-west.apache.org [10.40.0.9]) (amavisd-new, port 10024)
	with ESMTP id u9Nw0TYmzBBV for <dev@httpd.apache.org>;
	Tue,  8 Dec 2015 10:54:55 +0000 (UTC)
Received: from mail.greenbytes.de (mail.greenbytes.de [217.91.35.233])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id E0E4D20CB7
	for <dev@httpd.apache.org>; Tue,  8 Dec 2015 10:54:54 +0000 (UTC)
Received: from [192.168.1.42] (unknown [217.91.35.233])
	(using TLSv1 with cipher ECDHE-RSA-AES256-SHA (256/256 bits))
	(Client did not present a certificate)
	by mail.greenbytes.de (Postfix) with ESMTPSA id 6B1BB15A049C
	for <dev@httpd.apache.org>; Tue,  8 Dec 2015 11:54:54 +0100 (CET)
DKIM-Signature: v=1; a=rsa-sha256; c=simple/simple; d=greenbytes.de; s=mail;
	t=1449572094; bh=Hn90gBcfFA2eQlHD6zKJb8mPA/Yergo4Uqh6Pq6Mt0k=;
	h=Subject:From:In-Reply-To:Date:References:To:From;
	b=TlBaFE/xDlVtariLYOYOu6lD5DUQ449pfSPT66hcOZB/3up9quAuYqUXaT7pS2nPl
	 6HoYBD7XMTJuJ6+OLiTJ7hrxd7KgLmIxFkNdANVJkdzf7VZkpQaBffdXLJ1pFWq441
	 GIPU7mxzDb5qzNcJYPZYi8KKrWkTJnMjK/BuRn+s=
Content-Type: text/plain; charset=us-ascii
Mime-Version: 1.0 (Mac OS X Mail 9.1 \(3096.5\))
Subject: Re: Upgrade Summary
From: Stefan Eissing <stefan.eissing@greenbytes.de>
In-Reply-To: <CAKQ1sVNaRRRVn-Qp_OuR-oK6D32dJeSoBKRrteMtr+ABjZMB7w@mail.gmail.com>
Date: Tue, 8 Dec 2015 11:54:54 +0100
Content-Transfer-Encoding: quoted-printable
Message-Id: <E9DB0497-C846-4EB2-9064-06ED1801A113@greenbytes.de>
References: <CACsi250=dbRQKnsbE8JSdAZRm5x99gE0sgX3iQ-PHAx77euD1A@mail.gmail.com> <AB1691BE05AE7F4992697F2A0835627AC63BAB94@VOEXM10W.internal.vodafone.com> <F7B20D30-D34A-4805-A77D-F64F6428F6E3@greenbytes.de> <56660896.c74fc20a.15f56.0ebd@mx.google.com> <56660B43.2060507@gmail.com> <6B13DF2B-0586-42BB-B62F-59A7638B697D@greenbytes.de> <13FE9E7F-9620-4BF9-8EA4-57A6314D66BF@greenbytes.de> <CAKQ1sVNaRRRVn-Qp_OuR-oK6D32dJeSoBKRrteMtr+ABjZMB7w@mail.gmail.com>
To: dev@httpd.apache.org
X-Mailer: Apple Mail (2.3096.5)


> Am 08.12.2015 um 11:44 schrieb Yann Ylavic <ylavic.dev@gmail.com>:
>=20
> On Tue, Dec 8, 2015 at 11:07 AM, Stefan Eissing
> <stefan.eissing@greenbytes.de> wrote:
>> [...]
>> Open:
>> 1. Protocols like Websocket need to take over the 101 sending =
themselves in the "switch protocol" phase. (correct, Jacob?). Should we =
delegate the sending of the 101 to the protocol switch handler?
>> 2. General handling of request bodies. Options:
>>  a setaside in core of up to nnn bytes before switch invocation
>>  b do nothing, let protocol switch handler care about it
>=20
> a. is tempting, where nnn would be the limit above which we don't =
honor Upgrade.
> But that could be a default behaviour, i.e. when "Protocols ... http1"
> is finally elected.
> Possibly specific modules would bypass that?
>=20
>> 3. When to do the upgrade dance:
>>  a post_read_request: upgrade precedes authentication
>=20
> Looks like it can't be RFC compliant, is it?

I think it will not be, right.

>>  b handler: upgrade only honored on authenticated and otherwise ok =
requests
>=20
> This is probably the right thing to do, would OPTIONS be special is =
this case?

It currently is insofar as core installs a storage handler to invoke =
the, otherwise
same, upgrade handling code. It's a special case, but nothing the =
protocol handlers
need to care about...

>>  c both: introduce separate hooks? have an additional parameter? more =
complexity
>=20
> Depends on whether OPTIONS (others?) need special treatment.

The current design works with it while exposing in the API only one set =
of hooks. If
those get called from one or the other does not matter. For each =
request, the hooks
are invoked at most once.

>> 4. status code of protocol switch handler: if we move the task of 101 =
sending, the switch handler might not do it and keep the connection on =
the "old" protocol. Then a connection close is not necessary. So, we =
would do the close only when the switch handler returns APR_EOF.
>> 5. Will it be possible to migrate the current TLS upgrade handling to =
this revised scheme?
>=20
> We must do that IMHO, the scheme should be suite for all the cases.

Agreed.

>> PS. Re 5: with change 1+4, a TLS upgrade switcher could install an =
output filter, return and have it being processed normally. The output =
filter would then send the 101 and do the TLS handshake. Would that =
work?
>=20
> The issue is that this output filter would have to both read and write
> during the TLS handshake, not sure this is suitable.

Ok, maybe from pre_read_request hook then?


From dev-return-84952-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Tue Dec  8 11:18:40 2015
Return-Path: <dev-return-84952-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 95AF110788
	for <apmail-httpd-dev-archive@www.apache.org>; Tue,  8 Dec 2015 11:18:40 +0000 (UTC)
Received: (qmail 78315 invoked by uid 500); 8 Dec 2015 11:18:40 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 78225 invoked by uid 500); 8 Dec 2015 11:18:40 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 78215 invoked by uid 99); 8 Dec 2015 11:18:40 -0000
Received: from Unknown (HELO spamd4-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 08 Dec 2015 11:18:40 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd4-us-west.apache.org (ASF Mail Server at spamd4-us-west.apache.org) with ESMTP id A4D32C0FD7
	for <dev@httpd.apache.org>; Tue,  8 Dec 2015 11:18:39 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd4-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.101
X-Spam-Level:
X-Spam-Status: No, score=-0.101 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RCVD_IN_MSPIKE_H2=-0.001, SPF_PASS=-0.001, URIBL_BLOCKED=0.001]
	autolearn=disabled
Authentication-Results: spamd4-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd4-us-west.apache.org [10.40.0.11]) (amavisd-new, port 10024)
	with ESMTP id Ftl7gCxd0CsK for <dev@httpd.apache.org>;
	Tue,  8 Dec 2015 11:18:32 +0000 (UTC)
Received: from mail-qg0-f41.google.com (mail-qg0-f41.google.com [209.85.192.41])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id 450A742ABE
	for <dev@httpd.apache.org>; Tue,  8 Dec 2015 11:18:32 +0000 (UTC)
Received: by qgcc31 with SMTP id c31so12457949qgc.3
        for <dev@httpd.apache.org>; Tue, 08 Dec 2015 03:18:26 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        bh=F9zNKH+cG8+boRbEq0fF1ibj+anIkVmNnt2f3OXtLrI=;
        b=FK2A7R5mFxJKtsq2Ce7qO6ZqF8UNCx6H1+JyQT6pe3umotvhxJmnI3wdJU+ZYx/M1T
         Y+Hboo/ERoAfTc+aIlBrXEV5EeLlqnmatbPW0+4ZamV+iY/orOPd0A6Ea6aEnju7mUOm
         uIiZDlMBR8xIraFGRw+vKF4Oao2dsUhmi3122M1XMAa7d8P3ZCTv6JmBWwGki8xPulHo
         3ZvFF4VNAnUZK2tkqjaB/CkjctyrLRT1RqA1dVVB/OpQarvRFESAbrxskBXWb7/Fnvp8
         kmkOJ7YOJIahNdpZhlx5CEkyRQihurLIY5bydgDFTnmSU4DIjHxhBJUKW1HGuTnJUv32
         TToA==
MIME-Version: 1.0
X-Received: by 10.140.89.201 with SMTP id v67mr3790826qgd.38.1449573505887;
 Tue, 08 Dec 2015 03:18:25 -0800 (PST)
Received: by 10.55.65.85 with HTTP; Tue, 8 Dec 2015 03:18:25 -0800 (PST)
In-Reply-To: <E9DB0497-C846-4EB2-9064-06ED1801A113@greenbytes.de>
References: <CACsi250=dbRQKnsbE8JSdAZRm5x99gE0sgX3iQ-PHAx77euD1A@mail.gmail.com>
	<AB1691BE05AE7F4992697F2A0835627AC63BAB94@VOEXM10W.internal.vodafone.com>
	<F7B20D30-D34A-4805-A77D-F64F6428F6E3@greenbytes.de>
	<56660896.c74fc20a.15f56.0ebd@mx.google.com>
	<56660B43.2060507@gmail.com>
	<6B13DF2B-0586-42BB-B62F-59A7638B697D@greenbytes.de>
	<13FE9E7F-9620-4BF9-8EA4-57A6314D66BF@greenbytes.de>
	<CAKQ1sVNaRRRVn-Qp_OuR-oK6D32dJeSoBKRrteMtr+ABjZMB7w@mail.gmail.com>
	<E9DB0497-C846-4EB2-9064-06ED1801A113@greenbytes.de>
Date: Tue, 8 Dec 2015 12:18:25 +0100
Message-ID: <CAKQ1sVOS3o5k4pSr74wYYak+s=XGL62kBH4YFGv4GrPF2fgW6w@mail.gmail.com>
Subject: Re: Upgrade Summary
From: Yann Ylavic <ylavic.dev@gmail.com>
To: httpd-dev <dev@httpd.apache.org>
Content-Type: text/plain; charset=UTF-8

On Tue, Dec 8, 2015 at 11:54 AM, Stefan Eissing
<stefan.eissing@greenbytes.de> wrote:
>
> Am 08.12.2015 um 11:44 schrieb Yann Ylavic <ylavic.dev@gmail.com>:
>>
>> On Tue, Dec 8, 2015 at 11:07 AM, Stefan Eissing
>>>
>>> PS. Re 5: with change 1+4, a TLS upgrade switcher could install an output filter, return and have it being processed normally. The output filter would then send the 101 and do the TLS handshake. Would that work?
>>
>> The issue is that this output filter would have to both read and write
>> during the TLS handshake, not sure this is suitable.
>
> Ok, maybe from pre_read_request hook then?

Hmm, pre_read of the second request, interesting.
But maybe output filter could work too after all, we'd need to set the
correct CONN_SENSE for event to do right thing?
pre_read may be simpler though, based on a flag in the conn_rec?

From dev-return-84953-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Tue Dec  8 11:29:51 2015
Return-Path: <dev-return-84953-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 53A0E107FB
	for <apmail-httpd-dev-archive@www.apache.org>; Tue,  8 Dec 2015 11:29:51 +0000 (UTC)
Received: (qmail 97385 invoked by uid 500); 8 Dec 2015 11:29:50 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 97304 invoked by uid 500); 8 Dec 2015 11:29:50 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 97294 invoked by uid 99); 8 Dec 2015 11:29:50 -0000
Received: from Unknown (HELO spamd1-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 08 Dec 2015 11:29:50 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd1-us-west.apache.org (ASF Mail Server at spamd1-us-west.apache.org) with ESMTP id 46F28C8689
	for <dev@httpd.apache.org>; Tue,  8 Dec 2015 11:29:50 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd1-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.12
X-Spam-Level:
X-Spam-Status: No, score=-0.12 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RCVD_IN_MSPIKE_H3=-0.01, RCVD_IN_MSPIKE_WL=-0.01, SPF_PASS=-0.001,
	URIBL_BLOCKED=0.001] autolearn=disabled
Authentication-Results: spamd1-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd1-us-west.apache.org [10.40.0.7]) (amavisd-new, port 10024)
	with ESMTP id QAfnnVpvgK4G for <dev@httpd.apache.org>;
	Tue,  8 Dec 2015 11:29:42 +0000 (UTC)
Received: from mail-qk0-f181.google.com (mail-qk0-f181.google.com [209.85.220.181])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id 701F820F4F
	for <dev@httpd.apache.org>; Tue,  8 Dec 2015 11:29:42 +0000 (UTC)
Received: by qkht125 with SMTP id t125so23877104qkh.3
        for <dev@httpd.apache.org>; Tue, 08 Dec 2015 03:29:41 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        bh=TPf6Q42OdGvmQdJOJt6sMtM+7hJW7w3JctWfggtB028=;
        b=XMKyixl2zWX8al2aXQEyVpf//0wSs8D3eGB0yyPa+LB0my/h5gLiKZ7nnEJdqSMYIB
         wT1bgKDjdcZHOA6tyA/Yz2OaYdA5oTSKzwUlaj9c4rAU0h0nPrbdKSdPnVdDyKC8tWw8
         Gax5vNvwd3xPdBfkhhlVgi3Qv993ozQS/t5mHnMKQZu+O7fNqeiBllrtfu6bWxX3EyH2
         DrehKtuoNFaLLFxR03dIU4ASHsPdmyq8F2hMPaEuKi6fB15yE4Cu7nL388NXHbsjU+Cs
         8GT2T2Ie+c2uIwmLDV0BCAR619eIQd9gO/LsL/TRWqAO7gmb6SIzARAcKkqHRmLx6FtK
         qxSw==
MIME-Version: 1.0
X-Received: by 10.55.75.8 with SMTP id y8mr3808654qka.2.1449574181545; Tue, 08
 Dec 2015 03:29:41 -0800 (PST)
Received: by 10.55.65.85 with HTTP; Tue, 8 Dec 2015 03:29:41 -0800 (PST)
In-Reply-To: <CAKQ1sVOS3o5k4pSr74wYYak+s=XGL62kBH4YFGv4GrPF2fgW6w@mail.gmail.com>
References: <CACsi250=dbRQKnsbE8JSdAZRm5x99gE0sgX3iQ-PHAx77euD1A@mail.gmail.com>
	<AB1691BE05AE7F4992697F2A0835627AC63BAB94@VOEXM10W.internal.vodafone.com>
	<F7B20D30-D34A-4805-A77D-F64F6428F6E3@greenbytes.de>
	<56660896.c74fc20a.15f56.0ebd@mx.google.com>
	<56660B43.2060507@gmail.com>
	<6B13DF2B-0586-42BB-B62F-59A7638B697D@greenbytes.de>
	<13FE9E7F-9620-4BF9-8EA4-57A6314D66BF@greenbytes.de>
	<CAKQ1sVNaRRRVn-Qp_OuR-oK6D32dJeSoBKRrteMtr+ABjZMB7w@mail.gmail.com>
	<E9DB0497-C846-4EB2-9064-06ED1801A113@greenbytes.de>
	<CAKQ1sVOS3o5k4pSr74wYYak+s=XGL62kBH4YFGv4GrPF2fgW6w@mail.gmail.com>
Date: Tue, 8 Dec 2015 12:29:41 +0100
Message-ID: <CAKQ1sVM1j3Eubp7-qB6ubg1NaOkYS+OvzRpZjBQQao4G95ej_Q@mail.gmail.com>
Subject: Re: Upgrade Summary
From: Yann Ylavic <ylavic.dev@gmail.com>
To: httpd-dev <dev@httpd.apache.org>
Content-Type: text/plain; charset=UTF-8

On Tue, Dec 8, 2015 at 12:18 PM, Yann Ylavic <ylavic.dev@gmail.com> wrote:
> On Tue, Dec 8, 2015 at 11:54 AM, Stefan Eissing
> <stefan.eissing@greenbytes.de> wrote:
>>
>> Am 08.12.2015 um 11:44 schrieb Yann Ylavic <ylavic.dev@gmail.com>:
>>>
>>> On Tue, Dec 8, 2015 at 11:07 AM, Stefan Eissing
>>>>
>>>> PS. Re 5: with change 1+4, a TLS upgrade switcher could install an output filter, return and have it being processed normally. The output filter would then send the 101 and do the TLS handshake. Would that work?
>>>
>>> The issue is that this output filter would have to both read and write
>>> during the TLS handshake, not sure this is suitable.
>>
>> Ok, maybe from pre_read_request hook then?
>
> Hmm, pre_read of the second request, interesting.

Actually no, the previous response has to be Upgraded, so for the TLS
case we'd have needed the handshake already.
Also, pre_read has no server_rec selected, so on which configuration
would we base the upgrade on...

> But maybe output filter could work too after all, we'd need to set the
> correct CONN_SENSE for event to do right thing?

Looks like the most suitable option if that can work.

From dev-return-84954-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Tue Dec  8 11:34:36 2015
Return-Path: <dev-return-84954-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 05A6910846
	for <apmail-httpd-dev-archive@www.apache.org>; Tue,  8 Dec 2015 11:34:36 +0000 (UTC)
Received: (qmail 8179 invoked by uid 500); 8 Dec 2015 11:34:30 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 8094 invoked by uid 500); 8 Dec 2015 11:34:30 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 8084 invoked by uid 99); 8 Dec 2015 11:34:30 -0000
Received: from Unknown (HELO spamd4-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 08 Dec 2015 11:34:30 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd4-us-west.apache.org (ASF Mail Server at spamd4-us-west.apache.org) with ESMTP id EA29AC06D6
	for <dev@httpd.apache.org>; Tue,  8 Dec 2015 11:34:29 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd4-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.554
X-Spam-Level:
X-Spam-Status: No, score=-0.554 tagged_above=-999 required=6.31
	tests=[HEADER_FROM_DIFFERENT_DOMAINS=0.001, RP_MATCHES_RCVD=-0.554,
	SPF_HELO_PASS=-0.001, SPF_PASS=-0.001, URIBL_BLOCKED=0.001]
	autolearn=disabled
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd4-us-west.apache.org [10.40.0.11]) (amavisd-new, port 10024)
	with ESMTP id kqNpj_V0nwYi for <dev@httpd.apache.org>;
	Tue,  8 Dec 2015 11:34:22 +0000 (UTC)
Received: from plane.gmane.org (plane.gmane.org [80.91.229.3])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id 592A324DB9
	for <dev@httpd.apache.org>; Tue,  8 Dec 2015 11:34:21 +0000 (UTC)
Received: from list by plane.gmane.org with local (Exim 4.69)
	(envelope-from <apache-dev@m.gmane.org>)
	id 1a6GX8-0002SD-BM
	for dev@httpd.apache.org; Tue, 08 Dec 2015 12:34:14 +0100
Received: from 227-116.citynet.ftth.internl.net ([85.223.116.227])
        by main.gmane.org with esmtp (Gmexim 0.1 (Debian))
        id 1AlnuQ-0007hv-00
        for <dev@httpd.apache.org>; Tue, 08 Dec 2015 12:34:14 +0100
Received: from phpdev by 227-116.citynet.ftth.internl.net with local (Gmexim 0.1 (Debian))
        id 1AlnuQ-0007hv-00
        for <dev@httpd.apache.org>; Tue, 08 Dec 2015 12:34:14 +0100
X-Injected-Via-Gmane: http://gmane.org/
To: dev@httpd.apache.org
From: Jan Ehrhardt <phpdev@ehrhardt.nl>
Subject: Re: No H2 Window updates!
Date: Tue, 08 Dec 2015 12:34:02 +0100
Lines: 15
Message-ID: <stfd6b9gt1nqv1e3ac8c30qnk3upu5lfub@4ax.com>
References: <10770C7F-5C8D-42EB-9E76-DC91160FDA89@greenbytes.de> <045e01d12e79$493fe620$dbbfb260$@qqmail.nl> <039D4360-8E2F-455D-8CC2-8405FC7FC272@greenbytes.de> <1jr36b5oa182lb9mupjfm6st4o9qbbr78o@4ax.com> <DA07528F-19ED-44AD-BBDA-DE3301F9F9EC@greenbytes.de> <4hk76bllai2epissk4lbjghj31jmnf03mr@4ax.com> <A2E69AEB-1BA3-489A-83C3-6E7A8A73F3BC@greenbytes.de> <luab6b9pmo6sl3f9j3vdctukh0a9igrbka@4ax.com> <CALK=YjOjG5Lo-punwB1p3yeSYO=yUEmgC7YQS1ERVvvuhXjcrw@mail.gmail.com>
Mime-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Complaints-To: usenet@ger.gmane.org
X-Gmane-NNTP-Posting-Host: 227-116.citynet.ftth.internl.net
X-Newsreader: Forte Agent 3.3/32.846

Eric Covener in gmane.comp.apache.devel (Mon, 7 Dec 2015 11:03:15 -0500):
>On Mon, Dec 7, 2015 at 10:56 AM, Jan Ehrhardt <phpdev@ehrhardt.nl> wrote:
>> Stefan Eissing in gmane.comp.apache.devel (Mon, 7 Dec 2015 13:58:07
>> +0100):
>>>if you could find the time to verify that the duplicate headers are gone
>>>in the current 2.4.x version, that'd be nice. Thanks!
>>
>> They are gone! Time to T&R 2.4.18.
>
>Thanks for driving this one Jan.

My pleasure. To confirm: I have been working on our devserver with
mod_http2 1.0.11 a couple of hours now. No problems.
-- 
Jan


From dev-return-84955-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Tue Dec  8 11:40:51 2015
Return-Path: <dev-return-84955-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 697AC10869
	for <apmail-httpd-dev-archive@www.apache.org>; Tue,  8 Dec 2015 11:40:51 +0000 (UTC)
Received: (qmail 23299 invoked by uid 500); 8 Dec 2015 11:40:50 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 23236 invoked by uid 500); 8 Dec 2015 11:40:50 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 23226 invoked by uid 99); 8 Dec 2015 11:40:50 -0000
Received: from Unknown (HELO spamd1-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 08 Dec 2015 11:40:50 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd1-us-west.apache.org (ASF Mail Server at spamd1-us-west.apache.org) with ESMTP id 2893EC86C3
	for <dev@httpd.apache.org>; Tue,  8 Dec 2015 11:40:50 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd1-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.121
X-Spam-Level:
X-Spam-Status: No, score=-0.121 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RCVD_IN_MSPIKE_H3=-0.01, RCVD_IN_MSPIKE_WL=-0.01, SPF_PASS=-0.001]
	autolearn=disabled
Authentication-Results: spamd1-us-west.apache.org (amavisd-new);
	dkim=pass (1024-bit key) header.d=qqmail.nl
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd1-us-west.apache.org [10.40.0.7]) (amavisd-new, port 10024)
	with ESMTP id LzQITojWWDA3 for <dev@httpd.apache.org>;
	Tue,  8 Dec 2015 11:40:49 +0000 (UTC)
Received: from mail-wm0-f49.google.com (mail-wm0-f49.google.com [74.125.82.49])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id 9C2F242BA0
	for <dev@httpd.apache.org>; Tue,  8 Dec 2015 11:40:48 +0000 (UTC)
Received: by wmuu63 with SMTP id u63so177362511wmu.0
        for <dev@httpd.apache.org>; Tue, 08 Dec 2015 03:35:46 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=qqmail.nl; s=google;
        h=from:to:references:in-reply-to:subject:date:message-id:mime-version
         :content-type:content-transfer-encoding:thread-index
         :content-language;
        bh=iiGUbKoUnZ/yGFKDflUT5nY7cfdF0rKe+MbRREtrVs0=;
        b=devyEb3F2cYheEKH9xXgbqg7uFnG+9sPn8DWSlev2fGvwI2eQPNPmuoUWOrTzsTZEe
         sY5aMRuvTw2Y/U3JhhKJvUhC4zkduIs2ySO7e98s2mJQlqpL+bzk2ig/wHWjK4mRYHSD
         b+kmMXtusliyrqX3uzBm6vDCud0uA81JRUXrE=
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=1e100.net; s=20130820;
        h=x-gm-message-state:from:to:references:in-reply-to:subject:date
         :message-id:mime-version:content-type:content-transfer-encoding
         :thread-index:content-language;
        bh=iiGUbKoUnZ/yGFKDflUT5nY7cfdF0rKe+MbRREtrVs0=;
        b=AYbVEG2mV3/+jDmgF1n/Wo/joqUPpwp96tlq1wOH6iyTs2BaFgMOCs3w3fLsfcB3Vc
         tw9cr/SXbLHePClRtWipP2HlYEXXrq/zaQRN2tNFU4TjJLbRo7/gcCKBxe/YG5nfHc24
         fX6BcrOWO8JVnshaTwGNMDYy3i6lU1Nv9MPpFZsxp51A03LXBOZPFUJ2IfjqHTustQZa
         vE96+siMszbvuDxRmoWxXnm0VVW44lpmB5qoSlQxIyQba3aHm3DDuTHyxTr0cY9tAORC
         3iRncWNf5Cv/lituc5Gu/8c5Tyhsy/8Fk7gapcu1z+xjpppPQ9hQt5Mvqvs13nXLqtU6
         wLSQ==
X-Gm-Message-State: ALoCoQkUBye6MxyAeT/2XJfwAMzRqwRO94fh5TtPj/t710OnDLl3Pl6k2UnK9b4kQ2g7yEuf3SAHFY7CblCG51/eiHc9sbtyFQ==
X-Received: by 10.194.110.35 with SMTP id hx3mr3865755wjb.0.1449574546546;
        Tue, 08 Dec 2015 03:35:46 -0800 (PST)
Received: from I72600 ([2001:610:66e:0:52e5:49ff:fee1:96b7])
        by smtp.gmail.com with ESMTPSA id jz1sm2586016wjc.27.2015.12.08.03.35.45
        for <dev@httpd.apache.org>
        (version=TLS1_2 cipher=ECDHE-RSA-AES128-GCM-SHA256 bits=128/128);
        Tue, 08 Dec 2015 03:35:45 -0800 (PST)
From: "Bert Huijben" <bert@qqmail.nl>
To: <dev@httpd.apache.org>
References: <CACsi250=dbRQKnsbE8JSdAZRm5x99gE0sgX3iQ-PHAx77euD1A@mail.gmail.com> <AB1691BE05AE7F4992697F2A0835627AC63BAB94@VOEXM10W.internal.vodafone.com> <F7B20D30-D34A-4805-A77D-F64F6428F6E3@greenbytes.de> <56660896.c74fc20a.15f56.0ebd@mx.google.com> <56660B43.2060507@gmail.com> <6B13DF2B-0586-42BB-B62F-59A7638B697D@greenbytes.de> <cf1001d131a3$17b28220$47178660$@qqmail.nl> <4258EB04-447D-4F9B-B549-1209F87AD374@greenbytes.de>
In-Reply-To: <4258EB04-447D-4F9B-B549-1209F87AD374@greenbytes.de>
Subject: RE: 2.4 pause - mod_http2 patchset Upgrade h2c vs mod_ssl Upgradetls
Date: Tue, 8 Dec 2015 12:35:39 +0100
Message-ID: <cf2d01d131ac$9192d4b0$b4b87e10$@qqmail.nl>
MIME-Version: 1.0
Content-Type: text/plain;
	charset="us-ascii"
Content-Transfer-Encoding: 7bit
X-Mailer: Microsoft Outlook 16.0
Thread-Index: AQKiK5k53Zwc1sqI7zswkQpwqyBJZQHPPeQLAlYfy+wBw01DvAJJXKo0Ai3vbIwBRNHNgwHOofyEnLNkR2A=
Content-Language: nl



> -----Original Message-----
> From: Stefan Eissing [mailto:stefan.eissing@greenbytes.de]
> Sent: dinsdag 8 december 2015 11:36
> To: dev@httpd.apache.org
> Subject: Re: 2.4 pause - mod_http2 patchset Upgrade h2c vs mod_ssl
> Upgradetls
> 
> Bert,
> 
> I do not understand. How do you want to make pipelining requests and
> protocol upgrades work together? I assume you talk about http pipelining
> where you send a second request before you receive the response for the
> first one...

I can't... but you were explaining that I could just switch to the new
protocol after my request... which I can't.

I have to perform a full stop... which is a performance killer in a client
that is optimized for pipelining. (Serf and libsvn_ra_serf are 100%
optimized for pipelining)

That is why I want to upgrade on the first request.


At the start of any session we currently perform 2 requests with full stop
behavior, to support user scnearios:
* one to detect if we have HTTP/1.1 or HTTP/1.0.

This is an OPTIONS request with a small Content-Length body. This will
already hand over the capabilities of the Subversion server and some
interesting URLS. If we find an old server here, the full handshake will
have more requests.

* A second request with a small chunked body to see if the server supports
chunked encoding (assuming we found 1.1).
If users use an nginx frontend (which is not uncommon) this fails and we
explicitly cache all requests to have explicit Content-Length headers in
this case.

After this we have many different scenarios, of which many want to pipeline,
or open multiple connections as soon as possible.

For Subversion I would like to switch to H2c in one of these two requests.
The first one looks like the simplest one. (Combining upgrading with chunked
makes things even harder).



I can't store whether a server supports H2 and just use it. Subversion is
used on laptops that are used on multiple networks.


Receiving Alt-Svc in the first response and just pipelining the upgrade
between further requests if there is a match, is the only other way I could
upgrade without a performance penalty on all servers that don't support H2c.

	Bert


From dev-return-84956-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Tue Dec  8 11:46:13 2015
Return-Path: <dev-return-84956-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 54B9F108A0
	for <apmail-httpd-dev-archive@www.apache.org>; Tue,  8 Dec 2015 11:46:13 +0000 (UTC)
Received: (qmail 30214 invoked by uid 500); 8 Dec 2015 11:46:12 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 30139 invoked by uid 500); 8 Dec 2015 11:46:12 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 30129 invoked by uid 99); 8 Dec 2015 11:46:12 -0000
Received: from Unknown (HELO spamd4-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 08 Dec 2015 11:46:12 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd4-us-west.apache.org (ASF Mail Server at spamd4-us-west.apache.org) with ESMTP id 5A15FC0FD7
	for <dev@httpd.apache.org>; Tue,  8 Dec 2015 11:46:12 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd4-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.12
X-Spam-Level:
X-Spam-Status: No, score=-0.12 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RCVD_IN_MSPIKE_H3=-0.01, RCVD_IN_MSPIKE_WL=-0.01, SPF_PASS=-0.001,
	URIBL_BLOCKED=0.001] autolearn=disabled
Authentication-Results: spamd4-us-west.apache.org (amavisd-new);
	dkim=pass (1024-bit key) header.d=qqmail.nl
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd4-us-west.apache.org [10.40.0.11]) (amavisd-new, port 10024)
	with ESMTP id 5jQH5LHff1wA for <dev@httpd.apache.org>;
	Tue,  8 Dec 2015 11:46:05 +0000 (UTC)
Received: from mail-wm0-f45.google.com (mail-wm0-f45.google.com [74.125.82.45])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id 31FCE42AEE
	for <dev@httpd.apache.org>; Tue,  8 Dec 2015 11:46:05 +0000 (UTC)
Received: by wmvv187 with SMTP id v187so209522254wmv.1
        for <dev@httpd.apache.org>; Tue, 08 Dec 2015 03:41:04 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=qqmail.nl; s=google;
        h=from:to:references:in-reply-to:subject:date:message-id:mime-version
         :content-type:content-transfer-encoding:thread-index
         :content-language;
        bh=Tlwe2JUz33KQbSZQO9c28FayzsO8UascXLz3nlJKUxk=;
        b=LsAIZpalTU3rfkG60xrJ9sbt9kflwuk+cpnJwawsHmKxZFGzH6EEetVykshK0pyEtw
         LxrEswKUAFPLWl9hlZ4W2d+mjNbsiuyh6mHNzET4wNh9yatoSkhJLdP20QSMnzrRP6P1
         wj71uJIHcJ5+xcyHdF/h2Nxo6hyOAUI716trI=
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=1e100.net; s=20130820;
        h=x-gm-message-state:from:to:references:in-reply-to:subject:date
         :message-id:mime-version:content-type:content-transfer-encoding
         :thread-index:content-language;
        bh=Tlwe2JUz33KQbSZQO9c28FayzsO8UascXLz3nlJKUxk=;
        b=jTBOhhZOJTy7e4lxCJB6sLHU9OCYMEgxhKFXBMr1gXpGDwkLYgSYv8phvRPGjGwRrk
         1hL/t0N10lCQtxUyYD2+6oXhhmhnvKU85klw4BCIECsr1Ee+7aS1lXi9izlff+SJ2RdX
         FQ4NcUM04gdiFpmD8EUVcrW5gcrpuRD6RAOJAPgr90py+HytA558agK+Yr5Yhuy91TTJ
         zbxWG/P0kFEGayjwLBVGC+XqxT7RTgo+LfSc1yzRkiNcPwynTcSFjuhUwAiX0ylditsU
         Xs60DdxbzQDXl51UNerJGoeiJVdTMqRwNgUBtvOB25xRs3aFuHpljf84o23+ylSWFf7O
         tnhQ==
X-Gm-Message-State: ALoCoQl1rV56oVhnfdrjlWplFCNZVtbspj0v5rS6LVOj2v4AQVd4FUbHRnmRF9kn/astMhUBc9GTYCIhJLXGp8Mmgjp6OrsH3g==
X-Received: by 10.194.94.100 with SMTP id db4mr3093264wjb.85.1449574864302;
        Tue, 08 Dec 2015 03:41:04 -0800 (PST)
Received: from I72600 ([2001:610:66e:0:52e5:49ff:fee1:96b7])
        by smtp.gmail.com with ESMTPSA id w4sm2581133wje.49.2015.12.08.03.41.03
        for <dev@httpd.apache.org>
        (version=TLS1_2 cipher=ECDHE-RSA-AES128-GCM-SHA256 bits=128/128);
        Tue, 08 Dec 2015 03:41:03 -0800 (PST)
From: "Bert Huijben" <bert@qqmail.nl>
To: <dev@httpd.apache.org>
References: <CACsi250=dbRQKnsbE8JSdAZRm5x99gE0sgX3iQ-PHAx77euD1A@mail.gmail.com> <AB1691BE05AE7F4992697F2A0835627AC63BAB94@VOEXM10W.internal.vodafone.com> <F7B20D30-D34A-4805-A77D-F64F6428F6E3@greenbytes.de> <56660896.c74fc20a.15f56.0ebd@mx.google.com> <56660B43.2060507@gmail.com> <6B13DF2B-0586-42BB-B62F-59A7638B697D@greenbytes.de> <13FE9E7F-9620-4BF9-8EA4-57A6314D66BF@greenbytes.de> <CAKQ1sVNaRRRVn-Qp_OuR-oK6D32dJeSoBKRrteMtr+ABjZMB7w@mail.gmail.com> <E9DB0497-C846-4EB2-9064-06ED1801A113@greenbytes.de>
In-Reply-To: <E9DB0497-C846-4EB2-9064-06ED1801A113@greenbytes.de>
Subject: RE: Upgrade Summary
Date: Tue, 8 Dec 2015 12:40:58 +0100
Message-ID: <cf2e01d131ad$4f55c7a0$ee0156e0$@qqmail.nl>
MIME-Version: 1.0
Content-Type: text/plain;
	charset="us-ascii"
Content-Transfer-Encoding: 7bit
X-Mailer: Microsoft Outlook 16.0
Thread-Index: AQKiK5k53Zwc1sqI7zswkQpwqyBJZQHPPeQLAlYfy+wBw01DvAJJXKo0Ai3vbIwBtCRQOwIKJ3O2AkJSr/mcm/2P0A==
Content-Language: nl



> -----Original Message-----
> From: Stefan Eissing [mailto:stefan.eissing@greenbytes.de]
> Sent: dinsdag 8 december 2015 11:55
> To: dev@httpd.apache.org
> Subject: Re: Upgrade Summary
> 
> 
> > Am 08.12.2015 um 11:44 schrieb Yann Ylavic <ylavic.dev@gmail.com>:
> >
> > On Tue, Dec 8, 2015 at 11:07 AM, Stefan Eissing
> > <stefan.eissing@greenbytes.de> wrote:
> >> [...]
> >> Open:
> >> 1. Protocols like Websocket need to take over the 101 sending
> themselves in the "switch protocol" phase. (correct, Jacob?). Should we
> delegate the sending of the 101 to the protocol switch handler?
> >> 2. General handling of request bodies. Options:
> >>  a setaside in core of up to nnn bytes before switch invocation
> >>  b do nothing, let protocol switch handler care about it
> >
> > a. is tempting, where nnn would be the limit above which we don't honor
> Upgrade.
> > But that could be a default behaviour, i.e. when "Protocols ... http1"
> > is finally elected.
> > Possibly specific modules would bypass that?
> >
> >> 3. When to do the upgrade dance:
> >>  a post_read_request: upgrade precedes authentication
> >
> > Looks like it can't be RFC compliant, is it?
> 
> I think it will not be, right.

I read the spec as H2c and HTTP/1.1 are equivalent protocols. Handling
authentication *after* switching should work just like when not switching.

As client I would like to switch as soon as possible, as at that point I can
start multiple requests.. potentially with their own auth, using the same or
different realms; or even different auth schemes.


I don't think we should require all auth to happen on HTTP/1.1.

With equivalent protocols we should switch as soon as possible... I don't
think servers should be configured as H2c only for authenticated users.
Especially if they also allow H2direct.

	Bert



From dev-return-84957-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Tue Dec  8 11:48:58 2015
Return-Path: <dev-return-84957-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 37D1E108B7
	for <apmail-httpd-dev-archive@www.apache.org>; Tue,  8 Dec 2015 11:48:58 +0000 (UTC)
Received: (qmail 34428 invoked by uid 500); 8 Dec 2015 11:48:57 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 34341 invoked by uid 500); 8 Dec 2015 11:48:57 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 34331 invoked by uid 99); 8 Dec 2015 11:48:57 -0000
Received: from Unknown (HELO spamd3-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 08 Dec 2015 11:48:57 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd3-us-west.apache.org (ASF Mail Server at spamd3-us-west.apache.org) with ESMTP id 237B9180989
	for <dev@httpd.apache.org>; Tue,  8 Dec 2015 11:48:57 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd3-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.121
X-Spam-Level:
X-Spam-Status: No, score=-0.121 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RCVD_IN_MSPIKE_H3=-0.01, RCVD_IN_MSPIKE_WL=-0.01, SPF_PASS=-0.001]
	autolearn=disabled
Authentication-Results: spamd3-us-west.apache.org (amavisd-new);
	dkim=pass (1024-bit key) header.d=qqmail.nl
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd3-us-west.apache.org [10.40.0.10]) (amavisd-new, port 10024)
	with ESMTP id GPzqOxq-GGxk for <dev@httpd.apache.org>;
	Tue,  8 Dec 2015 11:48:56 +0000 (UTC)
Received: from mail-wm0-f42.google.com (mail-wm0-f42.google.com [74.125.82.42])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id 1A2E042AEE
	for <dev@httpd.apache.org>; Tue,  8 Dec 2015 11:48:56 +0000 (UTC)
Received: by wmww144 with SMTP id w144so177743913wmw.1
        for <dev@httpd.apache.org>; Tue, 08 Dec 2015 03:48:55 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=qqmail.nl; s=google;
        h=from:to:references:in-reply-to:subject:date:message-id:mime-version
         :content-type:content-transfer-encoding:thread-index
         :content-language;
        bh=c9B0uKKvtJKCPUx9Ju26t11oL1SchPYWxG3nXjoWInM=;
        b=Po+45RGYDoTqhLewoIhGWB0bExXsyy3bpk/tPayL6G5wgxMJqWSoIq8GvLg/ThXiJH
         X5lCxD1RP/xvfSuAASgqbFGYLiJ2G57SYLNt/l+fLusxkwTEVj2YvmUZqzEWIcmhmEQd
         9uqeuOTER+NVqwA7EFayvDt8dJKLMJeyFQBG4=
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=1e100.net; s=20130820;
        h=x-gm-message-state:from:to:references:in-reply-to:subject:date
         :message-id:mime-version:content-type:content-transfer-encoding
         :thread-index:content-language;
        bh=c9B0uKKvtJKCPUx9Ju26t11oL1SchPYWxG3nXjoWInM=;
        b=Nx717SVSH8G1XpyrFB1iqbswlTdDx1OhkbjtWlZuwj5iwTAWDCwEf86IqNFzq40J0o
         js1LuOPDU1rMqk5MuQk3KxM8zwa1NHMCA7d/Z+6wPJ36FQPHFRboLC2FdvCNJ2evAbH3
         2b8CUzn9Gn7FUp/ZfkRNcIH09vu5w9r+jsa0KiNPOBmToVfZEgS2/KC0ayCqNaWsodGT
         B1ndjGT//lXvhb0jSWTQB5Idb5SGTzPMx5g0snGaw730iFn907zcGOZkUlYaFRRYrTBk
         apMrYrgK+KB26zSI9PBqBH4UQiqEx9PHbLBmn/JEuXbAjqChRWio4CvRPwGjLdq8egB/
         YmTA==
X-Gm-Message-State: ALoCoQkwz+BLeFCWopOpubzEIDzTzQvre1LX6UtEgssZaJa3GXvjPM1GrguOnqRR7ENZvPgOINjdNjFOMa5uM5ZO2PmJW58Ayw==
X-Received: by 10.194.117.68 with SMTP id kc4mr3288117wjb.77.1449575335196;
        Tue, 08 Dec 2015 03:48:55 -0800 (PST)
Received: from I72600 ([2001:610:66e:0:52e5:49ff:fee1:96b7])
        by smtp.gmail.com with ESMTPSA id vu4sm2677521wjc.2.2015.12.08.03.48.54
        for <dev@httpd.apache.org>
        (version=TLS1_2 cipher=ECDHE-RSA-AES128-GCM-SHA256 bits=128/128);
        Tue, 08 Dec 2015 03:48:54 -0800 (PST)
From: "Bert Huijben" <bert@qqmail.nl>
To: <dev@httpd.apache.org>
References: <CACsi250=dbRQKnsbE8JSdAZRm5x99gE0sgX3iQ-PHAx77euD1A@mail.gmail.com> <AB1691BE05AE7F4992697F2A0835627AC63BAB94@VOEXM10W.internal.vodafone.com> <F7B20D30-D34A-4805-A77D-F64F6428F6E3@greenbytes.de> <56660896.c74fc20a.15f56.0ebd@mx.google.com> <56660B43.2060507@gmail.com> <6B13DF2B-0586-42BB-B62F-59A7638B697D@greenbytes.de> <13FE9E7F-9620-4BF9-8EA4-57A6314D66BF@greenbytes.de> <CAKQ1sVNaRRRVn-Qp_OuR-oK6D32dJeSoBKRrteMtr+ABjZMB7w@mail.gmail.com> <E9DB0497-C846-4EB2-9064-06ED1801A113@greenbytes.de> <cf2e01d131ad$4f55c7a0$ee0156e0$@qqmail.nl>
In-Reply-To: <cf2e01d131ad$4f55c7a0$ee0156e0$@qqmail.nl>
Subject: RE: Upgrade Summary
Date: Tue, 8 Dec 2015 12:48:49 +0100
Message-ID: <cf2f01d131ae$67dbe5b0$3793b110$@qqmail.nl>
MIME-Version: 1.0
Content-Type: text/plain;
	charset="us-ascii"
Content-Transfer-Encoding: 7bit
X-Mailer: Microsoft Outlook 16.0
Thread-Index: AQKiK5k53Zwc1sqI7zswkQpwqyBJZQHPPeQLAlYfy+wBw01DvAJJXKo0Ai3vbIwBtCRQOwIKJ3O2AkJSr/kCyFGF2JyFvT/Q
Content-Language: nl

> -----Original Message-----
> From: Bert Huijben [mailto:bert@qqmail.nl]
> Sent: dinsdag 8 december 2015 12:41
> To: dev@httpd.apache.org
> Subject: RE: Upgrade Summary
> 


> I don't think we should require all auth to happen on HTTP/1.1.

If you want to go for equivalent implementations for things like the TLS
upgrade... then you really don't want to have AUTH completed before upgrade.

My preferred implementation would issue the 101 on HTTP/1.1 and then produce
the 401 on H2.
(I would be happy with an EOS on the response headers... I'm not interested
in the body :-))

I can handle '100 continue' before the 101 on HTTP/1.1, but also after
switching to H2 and before the actual result on H2... But I'm happy that we
don't have to support all possible scenarios there.

	Bert


From dev-return-84958-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Tue Dec  8 12:10:43 2015
Return-Path: <dev-return-84958-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id EBA771094C
	for <apmail-httpd-dev-archive@www.apache.org>; Tue,  8 Dec 2015 12:10:43 +0000 (UTC)
Received: (qmail 88409 invoked by uid 500); 8 Dec 2015 12:10:43 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 88331 invoked by uid 500); 8 Dec 2015 12:10:43 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 88320 invoked by uid 99); 8 Dec 2015 12:10:43 -0000
Received: from Unknown (HELO spamd4-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 08 Dec 2015 12:10:43 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd4-us-west.apache.org (ASF Mail Server at spamd4-us-west.apache.org) with ESMTP id 0F5EBC0E02
	for <dev@httpd.apache.org>; Tue,  8 Dec 2015 12:10:43 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd4-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.654
X-Spam-Level:
X-Spam-Status: No, score=-0.654 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RP_MATCHES_RCVD=-0.554, SPF_PASS=-0.001, URIBL_BLOCKED=0.001]
	autolearn=disabled
Authentication-Results: spamd4-us-west.apache.org (amavisd-new);
	dkim=pass (1024-bit key) header.d=greenbytes.de
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd4-us-west.apache.org [10.40.0.11]) (amavisd-new, port 10024)
	with ESMTP id xAeO4moxX24v for <dev@httpd.apache.org>;
	Tue,  8 Dec 2015 12:10:35 +0000 (UTC)
Received: from mail.greenbytes.de (mail.greenbytes.de [217.91.35.233])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id CE7CB42AA6
	for <dev@httpd.apache.org>; Tue,  8 Dec 2015 12:10:34 +0000 (UTC)
Received: from [192.168.1.42] (unknown [217.91.35.233])
	(using TLSv1 with cipher ECDHE-RSA-AES256-SHA (256/256 bits))
	(Client did not present a certificate)
	by mail.greenbytes.de (Postfix) with ESMTPSA id 7DE5A15A0049
	for <dev@httpd.apache.org>; Tue,  8 Dec 2015 13:10:33 +0100 (CET)
DKIM-Signature: v=1; a=rsa-sha256; c=simple/simple; d=greenbytes.de; s=mail;
	t=1449576633; bh=8n1IJeMyT4rYYggkxkYKtwoJV7a9x21+txX1A7xaAbY=;
	h=Subject:From:In-Reply-To:Date:References:To:From;
	b=JobxSLUxBIo3Ra2nHX04MjOYW92QbqPsu6m6RgERTohfk8JQz1h5iTWnbL9KhJuwI
	 RVll8v9A7Bl8uGZqjzxtrWAeFoyXc9x7cSQsMlQje83NnWid+Gpf3DGABeuPDWtWFQ
	 ZQyH+JpL+fiemL4vS9/oC87J6g8h4OrYUVKSTWYY=
Content-Type: text/plain; charset=us-ascii
Mime-Version: 1.0 (Mac OS X Mail 9.1 \(3096.5\))
Subject: Re: Upgrade Summary
From: Stefan Eissing <stefan.eissing@greenbytes.de>
In-Reply-To: <CAKQ1sVOS3o5k4pSr74wYYak+s=XGL62kBH4YFGv4GrPF2fgW6w@mail.gmail.com>
Date: Tue, 8 Dec 2015 13:10:33 +0100
Content-Transfer-Encoding: quoted-printable
Message-Id: <027D469E-9BA2-46F4-B66D-4D3113600F0F@greenbytes.de>
References: <CACsi250=dbRQKnsbE8JSdAZRm5x99gE0sgX3iQ-PHAx77euD1A@mail.gmail.com> <AB1691BE05AE7F4992697F2A0835627AC63BAB94@VOEXM10W.internal.vodafone.com> <F7B20D30-D34A-4805-A77D-F64F6428F6E3@greenbytes.de> <56660896.c74fc20a.15f56.0ebd@mx.google.com> <56660B43.2060507@gmail.com> <6B13DF2B-0586-42BB-B62F-59A7638B697D@greenbytes.de> <13FE9E7F-9620-4BF9-8EA4-57A6314D66BF@greenbytes.de> <CAKQ1sVNaRRRVn-Qp_OuR-oK6D32dJeSoBKRrteMtr+ABjZMB7w@mail.gmail.com> <E9DB0497-C846-4EB2-9064-06ED1801A113@greenbytes.de> <CAKQ1sVOS3o5k4pSr74wYYak+s=XGL62kBH4YFGv4GrPF2fgW6w@mail.gmail.com>
To: dev@httpd.apache.org
X-Mailer: Apple Mail (2.3096.5)


> Am 08.12.2015 um 12:18 schrieb Yann Ylavic <ylavic.dev@gmail.com>:
>=20
> On Tue, Dec 8, 2015 at 11:54 AM, Stefan Eissing
> <stefan.eissing@greenbytes.de> wrote:
>>=20
>> Am 08.12.2015 um 11:44 schrieb Yann Ylavic <ylavic.dev@gmail.com>:
>>>=20
>>> On Tue, Dec 8, 2015 at 11:07 AM, Stefan Eissing
>>>>=20
>>>> PS. Re 5: with change 1+4, a TLS upgrade switcher could install an =
output filter, return and have it being processed normally. The output =
filter would then send the 101 and do the TLS handshake. Would that =
work?
>>>=20
>>> The issue is that this output filter would have to both read and =
write
>>> during the TLS handshake, not sure this is suitable.
>>=20
>> Ok, maybe from pre_read_request hook then?
>=20
> Hmm, pre_read of the second request, interesting.
> But maybe output filter could work too after all, we'd need to set the
> correct CONN_SENSE for event to do right thing?
> pre_read may be simpler though, based on a flag in the conn_rec?

mod_ssl could have that flag in its SSLConnRec, i would assume...=

From dev-return-84959-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Tue Dec  8 12:27:13 2015
Return-Path: <dev-return-84959-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id DBF3D109EB
	for <apmail-httpd-dev-archive@www.apache.org>; Tue,  8 Dec 2015 12:27:13 +0000 (UTC)
Received: (qmail 27229 invoked by uid 500); 8 Dec 2015 12:27:04 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 27149 invoked by uid 500); 8 Dec 2015 12:27:04 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 27133 invoked by uid 99); 8 Dec 2015 12:27:03 -0000
Received: from Unknown (HELO spamd2-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 08 Dec 2015 12:27:03 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd2-us-west.apache.org (ASF Mail Server at spamd2-us-west.apache.org) with ESMTP id 6B2931A298B
	for <dev@httpd.apache.org>; Tue,  8 Dec 2015 12:27:03 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd2-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.654
X-Spam-Level:
X-Spam-Status: No, score=-0.654 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RP_MATCHES_RCVD=-0.554, SPF_PASS=-0.001, URIBL_BLOCKED=0.001]
	autolearn=disabled
Authentication-Results: spamd2-us-west.apache.org (amavisd-new);
	dkim=pass (1024-bit key) header.d=greenbytes.de
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd2-us-west.apache.org [10.40.0.9]) (amavisd-new, port 10024)
	with ESMTP id lK9Ur2D4vRYr for <dev@httpd.apache.org>;
	Tue,  8 Dec 2015 12:26:56 +0000 (UTC)
Received: from mail.greenbytes.de (mail.greenbytes.de [217.91.35.233])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id BD9CB42ABE
	for <dev@httpd.apache.org>; Tue,  8 Dec 2015 12:26:55 +0000 (UTC)
Received: from [192.168.1.42] (unknown [217.91.35.233])
	(using TLSv1 with cipher ECDHE-RSA-AES256-SHA (256/256 bits))
	(Client did not present a certificate)
	by mail.greenbytes.de (Postfix) with ESMTPSA id 7433A15A0049
	for <dev@httpd.apache.org>; Tue,  8 Dec 2015 13:21:47 +0100 (CET)
DKIM-Signature: v=1; a=rsa-sha256; c=simple/simple; d=greenbytes.de; s=mail;
	t=1449577307; bh=C1SkkrQDvkgGjmZJtNrXQ4EaXgosPzmTGzjN1wwrUiY=;
	h=Subject:From:In-Reply-To:Date:References:To:From;
	b=P5KjwWOD5KqVIs/BP3jFRcgL0K2F4kVNieeQHz2fW/emLGbkdvvuO6DS1eJNeBCxR
	 goQrv5q8oDxLMIQXkll5WYiywbbp1htKe2qAF92ZjRVjvVC0OfAyJJHE6hCzTpFFEV
	 DLepCTDqzG+PRVLs3/9WlYQzDQXhSeL2pZv2bu7c=
Content-Type: text/plain; charset=us-ascii
Mime-Version: 1.0 (Mac OS X Mail 9.1 \(3096.5\))
Subject: Re: Upgrade Summary
From: Stefan Eissing <stefan.eissing@greenbytes.de>
In-Reply-To: <cf2e01d131ad$4f55c7a0$ee0156e0$@qqmail.nl>
Date: Tue, 8 Dec 2015 13:21:47 +0100
Content-Transfer-Encoding: quoted-printable
Message-Id: <23776D3F-162E-4C8D-AA80-8BBE53B7F20B@greenbytes.de>
References: <CACsi250=dbRQKnsbE8JSdAZRm5x99gE0sgX3iQ-PHAx77euD1A@mail.gmail.com> <AB1691BE05AE7F4992697F2A0835627AC63BAB94@VOEXM10W.internal.vodafone.com> <F7B20D30-D34A-4805-A77D-F64F6428F6E3@greenbytes.de> <56660896.c74fc20a.15f56.0ebd@mx.google.com> <56660B43.2060507@gmail.com> <6B13DF2B-0586-42BB-B62F-59A7638B697D@greenbytes.de> <13FE9E7F-9620-4BF9-8EA4-57A6314D66BF@greenbytes.de> <CAKQ1sVNaRRRVn-Qp_OuR-oK6D32dJeSoBKRrteMtr+ABjZMB7w@mail.gmail.com> <E9DB0497-C846-4EB2-9064-06ED1801A113@greenbytes.de> <cf2e01d131ad$4f55c7a0$ee0156e0$@qqmail.nl>
To: dev@httpd.apache.org
X-Mailer: Apple Mail (2.3096.5)


> Am 08.12.2015 um 12:40 schrieb Bert Huijben <bert@qqmail.nl>:
>> -----Original Message-----
>> From: Stefan Eissing [mailto:stefan.eissing@greenbytes.de]
>> Sent: dinsdag 8 december 2015 11:55
>> To: dev@httpd.apache.org
>> Subject: Re: Upgrade Summary
>>>> [...]3. When to do the upgrade dance:
>>>> a post_read_request: upgrade precedes authentication
>>>=20
>>> Looks like it can't be RFC compliant, is it?
>>=20
>> I think it will not be, right.
>=20
> I read the spec as H2c and HTTP/1.1 are equivalent protocols. Handling
> authentication *after* switching should work just like when not =
switching.

It does. We are only talking about upgrade.

> As client I would like to switch as soon as possible, as at that point =
I can
> start multiple requests.. potentially with their own auth, using the =
same or
> different realms; or even different auth schemes.

Again, your easiest choice is a direct h2c connection. The second =
easiest is=20
an initial OPTIONS * request without *request* body. The response may =
have=20
any body length it wants.=20

The options * will, as I understand it, not trigger any authentication. =
In
another mail, you describe that you already send such a request as 1st =
thing.
But you said it has a body. What does that contain, I wonder?

If you can live without that request body, we are all fine and have a =
simple
implementation. If we need to implement upgrades to h2c on some length
request bodies, I personally do not have the time to do that right away =
among
all other changes that are being discussed. At least not this week.

So, what is so relevant about the OPTIONS request body, may I ask?

//Stefan=

From dev-return-84960-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Tue Dec  8 12:46:17 2015
Return-Path: <dev-return-84960-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 3E45510A9B
	for <apmail-httpd-dev-archive@www.apache.org>; Tue,  8 Dec 2015 12:46:17 +0000 (UTC)
Received: (qmail 74319 invoked by uid 500); 8 Dec 2015 12:46:11 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 74236 invoked by uid 500); 8 Dec 2015 12:46:11 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 74225 invoked by uid 99); 8 Dec 2015 12:46:11 -0000
Received: from Unknown (HELO spamd1-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 08 Dec 2015 12:46:11 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd1-us-west.apache.org (ASF Mail Server at spamd1-us-west.apache.org) with ESMTP id 2BB20C6AA8
	for <dev@httpd.apache.org>; Tue,  8 Dec 2015 12:46:11 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd1-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 2.277
X-Spam-Level: **
X-Spam-Status: No, score=2.277 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, SPF_NEUTRAL=0.652,
	SUBJ_ALL_CAPS=1.625] autolearn=disabled
Authentication-Results: spamd1-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=comcast.net
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd1-us-west.apache.org [10.40.0.7]) (amavisd-new, port 10024)
	with ESMTP id nLCm1-njW9Hu for <dev@httpd.apache.org>;
	Tue,  8 Dec 2015 12:46:04 +0000 (UTC)
Received: from resqmta-po-07v.sys.comcast.net (resqmta-po-07v.sys.comcast.net [96.114.154.166])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id 7A82D42B82
	for <dev@httpd.apache.org>; Tue,  8 Dec 2015 12:46:04 +0000 (UTC)
Received: from resomta-po-16v.sys.comcast.net ([96.114.154.240])
	by resqmta-po-07v.sys.comcast.net with comcast
	id r0gj1r0055BUCh4010gxZU; Tue, 08 Dec 2015 12:40:57 +0000
Received: from [192.168.199.10] ([69.251.84.114])
	by resomta-po-16v.sys.comcast.net with comcast
	id r0gx1r0012U0RYt010gxUQ; Tue, 08 Dec 2015 12:40:57 +0000
Content-Type: text/plain; charset=us-ascii
Mime-Version: 1.0 (Mac OS X Mail 9.1 \(3096.5\))
Subject: Re: 2.4.18 T&R
From: Jim Jagielski <jim@jaguNET.com>
In-Reply-To: <A0F1479E-B80B-4F2F-8F15-C9FAFC26D561@greenbytes.de>
Date: Tue, 8 Dec 2015 07:40:56 -0500
Content-Transfer-Encoding: 7bit
Message-Id: <92939CCD-3DC7-4A46-A154-EF911F003EF8@jaguNET.com>
References: <A0F1479E-B80B-4F2F-8F15-C9FAFC26D561@greenbytes.de>
To: dev@httpd.apache.org
X-Mailer: Apple Mail (2.3096.5)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=comcast.net;
	s=q20140121; t=1449578457;
	bh=dgQKpUKZpi8mDveK/K3YmEkjbsjYHzSyMaEbZAmBYiA=;
	h=Received:Received:Content-Type:Mime-Version:Subject:From:Date:
	 Message-Id:To;
	b=KNohgdIG0gWjB8z5cAn7Q2lONTs+ImogIEsdi8A4N4IS0i9nLmrQbJwLKc1D64q9E
	 RKf5tSA/V/RTmGviM99mnU1vXDYpgAHTfG1XzcfzdRswAc97QFtzefKUSB0zP/U0jV
	 G8Jr2AfTHIlxt834Rn6U7uLO+VTrMEr2Rr5ojgyipfpt+Fv+loK/GaByAKSYC0kOKy
	 WIoGkQv69SNoaGg5Ka0I+6rFoOR8XJVxjsOjpumsuPj7tcLjJObRxAsapGwW9tsC11
	 5EpGhlfwkXyAV7R7QwouVGO9BkOIt2ph1L9a2JqE3ERJOi4zdgWZhQB8JOnnukJa43
	 XrB5r+/8tV4+A==

This will be happening today, afternoon, eastern time.

From dev-return-84961-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Tue Dec  8 12:47:31 2015
Return-Path: <dev-return-84961-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 3501C10AAC
	for <apmail-httpd-dev-archive@www.apache.org>; Tue,  8 Dec 2015 12:47:31 +0000 (UTC)
Received: (qmail 77243 invoked by uid 500); 8 Dec 2015 12:46:56 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 77170 invoked by uid 500); 8 Dec 2015 12:46:56 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 77160 invoked by uid 99); 8 Dec 2015 12:46:56 -0000
Received: from Unknown (HELO spamd3-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 08 Dec 2015 12:46:56 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd3-us-west.apache.org (ASF Mail Server at spamd3-us-west.apache.org) with ESMTP id E2F60180969
	for <dev@httpd.apache.org>; Tue,  8 Dec 2015 12:46:55 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd3-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.12
X-Spam-Level:
X-Spam-Status: No, score=-0.12 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RCVD_IN_MSPIKE_H3=-0.01, RCVD_IN_MSPIKE_WL=-0.01, SPF_PASS=-0.001,
	URIBL_BLOCKED=0.001] autolearn=disabled
Authentication-Results: spamd3-us-west.apache.org (amavisd-new);
	dkim=pass (1024-bit key) header.d=qqmail.nl
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd3-us-west.apache.org [10.40.0.10]) (amavisd-new, port 10024)
	with ESMTP id NMxbhhwl9xbu for <dev@httpd.apache.org>;
	Tue,  8 Dec 2015 12:46:47 +0000 (UTC)
Received: from mail-wm0-f53.google.com (mail-wm0-f53.google.com [74.125.82.53])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id 6991D42BBD
	for <dev@httpd.apache.org>; Tue,  8 Dec 2015 12:46:47 +0000 (UTC)
Received: by wmec201 with SMTP id c201so210768133wme.0
        for <dev@httpd.apache.org>; Tue, 08 Dec 2015 04:46:46 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=qqmail.nl; s=google;
        h=from:to:references:in-reply-to:subject:date:message-id:mime-version
         :content-type:content-transfer-encoding:thread-index
         :content-language;
        bh=hqFdJMTyWD6Cpddbn/+uL0nX9/rpebhxz1vkkcZbhss=;
        b=N/AsfLueVlwExErd/EflG/3F4bJNCwajMWC5CSN7Yo6pRJ45OBCH/VI2d/b8Px4Rw+
         JKb+YmtzfO7KJkJYw5NoKbIPfVQB9/RkGi1Hvc/LPJwjvR0M6p43OXG53rLhZTqlRo/F
         3D6wXkqW9UB06NZvaFImAZg6BiIYorMiLtszg=
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=1e100.net; s=20130820;
        h=x-gm-message-state:from:to:references:in-reply-to:subject:date
         :message-id:mime-version:content-type:content-transfer-encoding
         :thread-index:content-language;
        bh=hqFdJMTyWD6Cpddbn/+uL0nX9/rpebhxz1vkkcZbhss=;
        b=JH/DqCLJEI9eI9bG2lp0Hw6P9AY0AyaZxoYiWTbNzAE5VdjOKzUCfqiBdsIm4b45vZ
         KNwNNyTDIG2OGm8Hh96fdgGRXIil1zGVZKNOqP++gX7zM4hwQQHUf7cQyZLKYGBvVVn6
         NBoP47+wqSsnSm+dHvTjrhQNj7gsE01jr/m9wmAaLC+kNNN+bSnbrEZczORPYJbAxZF2
         v5B/7F5steTPC42OTUg+W1md6tTZuH0Fbil7AEhVBKQz+I+sQVI6Pa9Qlc+6L0Vx7z/9
         C1tAl8zJgiSTHFBkh6XZMZsscbtmJ8xQQ6FXiza4iSZAlm8Q7n2QZKcLwGGcSaRWx8B5
         tQMQ==
X-Gm-Message-State: ALoCoQkm9moKNLknfiecc3Dq3aM5t/60tMMJdnSCxukha3kOiicj18UseWftBlAcEMud3AbaMAjneCEdbcnykK2/nyMXdcFGdg==
X-Received: by 10.194.2.168 with SMTP id 8mr4258042wjv.66.1449578806471;
        Tue, 08 Dec 2015 04:46:46 -0800 (PST)
Received: from I72600 ([2001:610:66e:0:52e5:49ff:fee1:96b7])
        by smtp.gmail.com with ESMTPSA id jz1sm2857849wjc.27.2015.12.08.04.46.45
        for <dev@httpd.apache.org>
        (version=TLS1_2 cipher=ECDHE-RSA-AES128-GCM-SHA256 bits=128/128);
        Tue, 08 Dec 2015 04:46:45 -0800 (PST)
From: "Bert Huijben" <bert@qqmail.nl>
To: <dev@httpd.apache.org>
References: <CACsi250=dbRQKnsbE8JSdAZRm5x99gE0sgX3iQ-PHAx77euD1A@mail.gmail.com> <AB1691BE05AE7F4992697F2A0835627AC63BAB94@VOEXM10W.internal.vodafone.com> <F7B20D30-D34A-4805-A77D-F64F6428F6E3@greenbytes.de> <56660896.c74fc20a.15f56.0ebd@mx.google.com> <56660B43.2060507@gmail.com> <6B13DF2B-0586-42BB-B62F-59A7638B697D@greenbytes.de> <13FE9E7F-9620-4BF9-8EA4-57A6314D66BF@greenbytes.de> <CAKQ1sVNaRRRVn-Qp_OuR-oK6D32dJeSoBKRrteMtr+ABjZMB7w@mail.gmail.com> <E9DB0497-C846-4EB2-9064-06ED1801A113@greenbytes.de> <cf2e01d131ad$4f55c7a0$ee0156e0$@qqmail.nl> <23776D3F-162E-4C8D-AA80-8BBE53B7F20B@greenbytes.de>
In-Reply-To: <23776D3F-162E-4C8D-AA80-8BBE53B7F20B@greenbytes.de>
Subject: RE: Upgrade Summary
Date: Tue, 8 Dec 2015 13:46:40 +0100
Message-ID: <cf3e01d131b6$7cc72590$765570b0$@qqmail.nl>
MIME-Version: 1.0
Content-Type: text/plain;
	charset="us-ascii"
Content-Transfer-Encoding: 7bit
X-Mailer: Microsoft Outlook 16.0
Thread-Index: AQKiK5k53Zwc1sqI7zswkQpwqyBJZQHPPeQLAlYfy+wBw01DvAJJXKo0Ai3vbIwBtCRQOwIKJ3O2AkJSr/kCyFGF2ALaCAYonG78oAA=
Content-Language: nl



> -----Original Message-----
> From: Stefan Eissing [mailto:stefan.eissing@greenbytes.de]
> Sent: dinsdag 8 december 2015 13:22
> To: dev@httpd.apache.org
> Subject: Re: Upgrade Summary
> 
> 
> > Am 08.12.2015 um 12:40 schrieb Bert Huijben <bert@qqmail.nl>:
> >> -----Original Message-----
> >> From: Stefan Eissing [mailto:stefan.eissing@greenbytes.de]
> >> Sent: dinsdag 8 december 2015 11:55
> >> To: dev@httpd.apache.org
> >> Subject: Re: Upgrade Summary
> >>>> [...]3. When to do the upgrade dance:
> >>>> a post_read_request: upgrade precedes authentication
> >>>
> >>> Looks like it can't be RFC compliant, is it?
> >>
> >> I think it will not be, right.
> >
> > I read the spec as H2c and HTTP/1.1 are equivalent protocols. Handling
> > authentication *after* switching should work just like when not
switching.
> 
> It does. We are only talking about upgrade.
> 
> > As client I would like to switch as soon as possible, as at that point I
can
> > start multiple requests.. potentially with their own auth, using the
same or
> > different realms; or even different auth schemes.
> 
> Again, your easiest choice is a direct h2c connection. The second easiest
is
> an initial OPTIONS * request without *request* body. The response may
> have
> any body length it wants.
> 
> The options * will, as I understand it, not trigger any authentication. In
> another mail, you describe that you already send such a request as 1st
thing.
> But you said it has a body. What does that contain, I wonder?
> 
> If you can live without that request body, we are all fine and have a
simple
> implementation. If we need to implement upgrades to h2c on some length
> request bodies, I personally do not have the time to do that right away
> among
> all other changes that are being discussed. At least not this week.
> 
> So, what is so relevant about the OPTIONS request body, may I ask?

I can't live without that request body. That would just add another request
to my handshake... the thing I'm trying to avoid.

I'm guessing the body of that initial body is something like
[[
<D:options xmlns:D="DAV:">
   <D:activity-collection-set />
</D:options>
]]
(content-type text/xml of course)

And this request is mostly handled by mod_dav, and further annotated with
additional headers by mod_dav_svn.

I can't just redesign DAV to optimize for http/2. If we had a timemachine,
we would have made other decisions.

Would have been nice if we knew DELTA/V was never really implemented outside
Subversion. But now we have compatibility guarantees with older Subversion
clients/servers and other implementations that may use some of the features.

	Bert


From dev-return-84962-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Tue Dec  8 12:54:17 2015
Return-Path: <dev-return-84962-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id F12AD10ACB
	for <apmail-httpd-dev-archive@www.apache.org>; Tue,  8 Dec 2015 12:54:17 +0000 (UTC)
Received: (qmail 93297 invoked by uid 500); 8 Dec 2015 12:54:17 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 93212 invoked by uid 500); 8 Dec 2015 12:54:17 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 93201 invoked by uid 99); 8 Dec 2015 12:54:17 -0000
Received: from Unknown (HELO spamd4-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 08 Dec 2015 12:54:17 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd4-us-west.apache.org (ASF Mail Server at spamd4-us-west.apache.org) with ESMTP id 0B772C0473
	for <dev@httpd.apache.org>; Tue,  8 Dec 2015 12:54:17 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd4-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.654
X-Spam-Level:
X-Spam-Status: No, score=-0.654 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RP_MATCHES_RCVD=-0.554, SPF_PASS=-0.001, URIBL_BLOCKED=0.001]
	autolearn=disabled
Authentication-Results: spamd4-us-west.apache.org (amavisd-new);
	dkim=pass (1024-bit key) header.d=greenbytes.de
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd4-us-west.apache.org [10.40.0.11]) (amavisd-new, port 10024)
	with ESMTP id 5_6nPg-1pw4a for <dev@httpd.apache.org>;
	Tue,  8 Dec 2015 12:54:08 +0000 (UTC)
Received: from mail.greenbytes.de (mail.greenbytes.de [217.91.35.233])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id 3221542B0F
	for <dev@httpd.apache.org>; Tue,  8 Dec 2015 12:54:08 +0000 (UTC)
Received: from [192.168.1.42] (unknown [217.91.35.233])
	(using TLSv1 with cipher ECDHE-RSA-AES256-SHA (256/256 bits))
	(Client did not present a certificate)
	by mail.greenbytes.de (Postfix) with ESMTPSA id C029915A043B
	for <dev@httpd.apache.org>; Tue,  8 Dec 2015 13:54:00 +0100 (CET)
DKIM-Signature: v=1; a=rsa-sha256; c=simple/simple; d=greenbytes.de; s=mail;
	t=1449579240; bh=//VvoiRLQFwXncuqPl4elI//AxwrW7xId+y4+EviuDg=;
	h=Subject:From:In-Reply-To:Date:References:To:From;
	b=rYF0uCadNnW95euRMEJjAaLHyl/Olgl+4P1iPtFqEBxSs6XAZZxbgccUT9ZN4wDqE
	 G54n8CyI355KJynKWDi6jPBOAbNYQZ/dr9zlXiL1Bcov8U4iYmxYxmCEj7DK5lzo8O
	 xd7eCZRbpj4W2CfxC3k9ZxhIVUWpc8sSTzyU6lIY=
Content-Type: text/plain; charset=us-ascii
Mime-Version: 1.0 (Mac OS X Mail 9.1 \(3096.5\))
Subject: Re: Upgrade Summary
From: Stefan Eissing <stefan.eissing@greenbytes.de>
In-Reply-To: <cf3e01d131b6$7cc72590$765570b0$@qqmail.nl>
Date: Tue, 8 Dec 2015 13:54:00 +0100
Content-Transfer-Encoding: quoted-printable
Message-Id: <0B4C7502-7DD7-4FFF-8E77-EBA83C69704F@greenbytes.de>
References: <CACsi250=dbRQKnsbE8JSdAZRm5x99gE0sgX3iQ-PHAx77euD1A@mail.gmail.com> <AB1691BE05AE7F4992697F2A0835627AC63BAB94@VOEXM10W.internal.vodafone.com> <F7B20D30-D34A-4805-A77D-F64F6428F6E3@greenbytes.de> <56660896.c74fc20a.15f56.0ebd@mx.google.com> <56660B43.2060507@gmail.com> <6B13DF2B-0586-42BB-B62F-59A7638B697D@greenbytes.de> <13FE9E7F-9620-4BF9-8EA4-57A6314D66BF@greenbytes.de> <CAKQ1sVNaRRRVn-Qp_OuR-oK6D32dJeSoBKRrteMtr+ABjZMB7w@mail.gmail.com> <E9DB0497-C846-4EB2-9064-06ED1801A113@greenbytes.de> <cf2e01d131ad$4f55c7a0$ee0156e0$@qqmail.nl> <23776D3F-162E-4C8D-AA80-8BBE53B7F20B@greenbytes.de> <cf3e01d131b6$7cc72590$765570b0$@qqmail.nl>
To: dev@httpd.apache.org
X-Mailer: Apple Mail (2.3096.5)

I see. Delta-V goodies.

My proposal therefore is:
- keep the upgrade/protocol switch mechanism as is for the 2.4.18 =
release
- make the agreed upon changes, including TLS upgrade and small content =
h2c upgrades for the next release

Since the mechanism is already out with 2.4.17, I see no sense in =
delaying 2.4.18 at this point and rather give us time to change it =
later, so it works for everyone.

//Stefan

> Am 08.12.2015 um 13:46 schrieb Bert Huijben <bert@qqmail.nl>:
>=20
>=20
>=20
>> -----Original Message-----
>> From: Stefan Eissing [mailto:stefan.eissing@greenbytes.de]
>> Sent: dinsdag 8 december 2015 13:22
>> To: dev@httpd.apache.org
>> Subject: Re: Upgrade Summary
>>=20
>>=20
>>> Am 08.12.2015 um 12:40 schrieb Bert Huijben <bert@qqmail.nl>:
>>>> -----Original Message-----
>>>> From: Stefan Eissing [mailto:stefan.eissing@greenbytes.de]
>>>> Sent: dinsdag 8 december 2015 11:55
>>>> To: dev@httpd.apache.org
>>>> Subject: Re: Upgrade Summary
>>>>>> [...]3. When to do the upgrade dance:
>>>>>> a post_read_request: upgrade precedes authentication
>>>>>=20
>>>>> Looks like it can't be RFC compliant, is it?
>>>>=20
>>>> I think it will not be, right.
>>>=20
>>> I read the spec as H2c and HTTP/1.1 are equivalent protocols. =
Handling
>>> authentication *after* switching should work just like when not
> switching.
>>=20
>> It does. We are only talking about upgrade.
>>=20
>>> As client I would like to switch as soon as possible, as at that =
point I
> can
>>> start multiple requests.. potentially with their own auth, using the
> same or
>>> different realms; or even different auth schemes.
>>=20
>> Again, your easiest choice is a direct h2c connection. The second =
easiest
> is
>> an initial OPTIONS * request without *request* body. The response may
>> have
>> any body length it wants.
>>=20
>> The options * will, as I understand it, not trigger any =
authentication. In
>> another mail, you describe that you already send such a request as =
1st
> thing.
>> But you said it has a body. What does that contain, I wonder?
>>=20
>> If you can live without that request body, we are all fine and have a
> simple
>> implementation. If we need to implement upgrades to h2c on some =
length
>> request bodies, I personally do not have the time to do that right =
away
>> among
>> all other changes that are being discussed. At least not this week.
>>=20
>> So, what is so relevant about the OPTIONS request body, may I ask?
>=20
> I can't live without that request body. That would just add another =
request
> to my handshake... the thing I'm trying to avoid.
>=20
> I'm guessing the body of that initial body is something like
> [[
> <D:options xmlns:D=3D"DAV:">
>   <D:activity-collection-set />
> </D:options>
> ]]
> (content-type text/xml of course)
>=20
> And this request is mostly handled by mod_dav, and further annotated =
with
> additional headers by mod_dav_svn.
>=20
> I can't just redesign DAV to optimize for http/2. If we had a =
timemachine,
> we would have made other decisions.
>=20
> Would have been nice if we knew DELTA/V was never really implemented =
outside
> Subversion. But now we have compatibility guarantees with older =
Subversion
> clients/servers and other implementations that may use some of the =
features.
>=20
> 	Bert


From dev-return-84963-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Tue Dec  8 13:01:12 2015
Return-Path: <dev-return-84963-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id E1D4010AF6
	for <apmail-httpd-dev-archive@www.apache.org>; Tue,  8 Dec 2015 13:01:12 +0000 (UTC)
Received: (qmail 6698 invoked by uid 500); 8 Dec 2015 13:01:12 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 6604 invoked by uid 500); 8 Dec 2015 13:01:12 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 6594 invoked by uid 99); 8 Dec 2015 13:01:12 -0000
Received: from Unknown (HELO spamd4-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 08 Dec 2015 13:01:12 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd4-us-west.apache.org (ASF Mail Server at spamd4-us-west.apache.org) with ESMTP id EA428C0473
	for <dev@httpd.apache.org>; Tue,  8 Dec 2015 13:01:11 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd4-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.101
X-Spam-Level:
X-Spam-Status: No, score=-0.101 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RCVD_IN_MSPIKE_H2=-0.001, SPF_PASS=-0.001, URIBL_BLOCKED=0.001]
	autolearn=disabled
Authentication-Results: spamd4-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd4-us-west.apache.org [10.40.0.11]) (amavisd-new, port 10024)
	with ESMTP id Beni3Yy5b_WQ for <dev@httpd.apache.org>;
	Tue,  8 Dec 2015 13:01:03 +0000 (UTC)
Received: from mail-qg0-f46.google.com (mail-qg0-f46.google.com [209.85.192.46])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id 3CDC7207E3
	for <dev@httpd.apache.org>; Tue,  8 Dec 2015 13:01:02 +0000 (UTC)
Received: by qgcc31 with SMTP id c31so14309161qgc.3
        for <dev@httpd.apache.org>; Tue, 08 Dec 2015 05:01:01 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        bh=k5qVn735QQOh789RTkDbDPpJSezv2yd6rPSxINFiaGM=;
        b=AZthCsQ4e7expD4DpbR2bFSTBq3fZbEo9W6BY/Y/SOcpjiKP0xMW0KDW9cMiy13j0C
         o/j6pvWsuPDiDiDPnYwowzejqTDxW4JkjK3xtQ9oAj/XLcxZR3DunOqS10bu7QqgBCF0
         NwxVB5fA27d9YyxdFV/GpzBDtS+yuep6iq3trLqttMXzkN3JtUCHD6pKS4XFSQm+87Nf
         vlop48CjJUA7M9zmLh3eVt7XWR56MFXkzMIh7uS0F304of09DhWtRUEGEHhJZKn5JRub
         aB4nNA78kTM0ihlkWimOH7evnAoTDbZg/SOPYh2WWbsJTbFGgdADndJ41BQjPTxgN3wj
         K6gg==
MIME-Version: 1.0
X-Received: by 10.140.30.101 with SMTP id c92mr4346536qgc.14.1449579661372;
 Tue, 08 Dec 2015 05:01:01 -0800 (PST)
Received: by 10.55.65.85 with HTTP; Tue, 8 Dec 2015 05:01:01 -0800 (PST)
In-Reply-To: <0B4C7502-7DD7-4FFF-8E77-EBA83C69704F@greenbytes.de>
References: <CACsi250=dbRQKnsbE8JSdAZRm5x99gE0sgX3iQ-PHAx77euD1A@mail.gmail.com>
	<AB1691BE05AE7F4992697F2A0835627AC63BAB94@VOEXM10W.internal.vodafone.com>
	<F7B20D30-D34A-4805-A77D-F64F6428F6E3@greenbytes.de>
	<56660896.c74fc20a.15f56.0ebd@mx.google.com>
	<56660B43.2060507@gmail.com>
	<6B13DF2B-0586-42BB-B62F-59A7638B697D@greenbytes.de>
	<13FE9E7F-9620-4BF9-8EA4-57A6314D66BF@greenbytes.de>
	<CAKQ1sVNaRRRVn-Qp_OuR-oK6D32dJeSoBKRrteMtr+ABjZMB7w@mail.gmail.com>
	<E9DB0497-C846-4EB2-9064-06ED1801A113@greenbytes.de>
	<cf2e01d131ad$4f55c7a0$ee0156e0$@qqmail.nl>
	<23776D3F-162E-4C8D-AA80-8BBE53B7F20B@greenbytes.de>
	<cf3e01d131b6$7cc72590$765570b0$@qqmail.nl>
	<0B4C7502-7DD7-4FFF-8E77-EBA83C69704F@greenbytes.de>
Date: Tue, 8 Dec 2015 14:01:01 +0100
Message-ID: <CAKQ1sVPHy_GJiCf7jPPRmz-vLggyCxT-mv1svr5ct=7t1Qq1QQ@mail.gmail.com>
Subject: Re: Upgrade Summary
From: Yann Ylavic <ylavic.dev@gmail.com>
To: httpd-dev <dev@httpd.apache.org>
Content-Type: text/plain; charset=UTF-8

If so, for 2.4.18 we should probably backport Bill's proposal in
STATUS (r1717816), so that OPTIONS works as in 2.4.16...

On Tue, Dec 8, 2015 at 1:54 PM, Stefan Eissing
<stefan.eissing@greenbytes.de> wrote:
> I see. Delta-V goodies.
>
> My proposal therefore is:
> - keep the upgrade/protocol switch mechanism as is for the 2.4.18 release
> - make the agreed upon changes, including TLS upgrade and small content h2c upgrades for the next release
>
> Since the mechanism is already out with 2.4.17, I see no sense in delaying 2.4.18 at this point and rather give us time to change it later, so it works for everyone.
>
> //Stefan
>
>> Am 08.12.2015 um 13:46 schrieb Bert Huijben <bert@qqmail.nl>:
>>
>>
>>
>>> -----Original Message-----
>>> From: Stefan Eissing [mailto:stefan.eissing@greenbytes.de]
>>> Sent: dinsdag 8 december 2015 13:22
>>> To: dev@httpd.apache.org
>>> Subject: Re: Upgrade Summary
>>>
>>>
>>>> Am 08.12.2015 um 12:40 schrieb Bert Huijben <bert@qqmail.nl>:
>>>>> -----Original Message-----
>>>>> From: Stefan Eissing [mailto:stefan.eissing@greenbytes.de]
>>>>> Sent: dinsdag 8 december 2015 11:55
>>>>> To: dev@httpd.apache.org
>>>>> Subject: Re: Upgrade Summary
>>>>>>> [...]3. When to do the upgrade dance:
>>>>>>> a post_read_request: upgrade precedes authentication
>>>>>>
>>>>>> Looks like it can't be RFC compliant, is it?
>>>>>
>>>>> I think it will not be, right.
>>>>
>>>> I read the spec as H2c and HTTP/1.1 are equivalent protocols. Handling
>>>> authentication *after* switching should work just like when not
>> switching.
>>>
>>> It does. We are only talking about upgrade.
>>>
>>>> As client I would like to switch as soon as possible, as at that point I
>> can
>>>> start multiple requests.. potentially with their own auth, using the
>> same or
>>>> different realms; or even different auth schemes.
>>>
>>> Again, your easiest choice is a direct h2c connection. The second easiest
>> is
>>> an initial OPTIONS * request without *request* body. The response may
>>> have
>>> any body length it wants.
>>>
>>> The options * will, as I understand it, not trigger any authentication. In
>>> another mail, you describe that you already send such a request as 1st
>> thing.
>>> But you said it has a body. What does that contain, I wonder?
>>>
>>> If you can live without that request body, we are all fine and have a
>> simple
>>> implementation. If we need to implement upgrades to h2c on some length
>>> request bodies, I personally do not have the time to do that right away
>>> among
>>> all other changes that are being discussed. At least not this week.
>>>
>>> So, what is so relevant about the OPTIONS request body, may I ask?
>>
>> I can't live without that request body. That would just add another request
>> to my handshake... the thing I'm trying to avoid.
>>
>> I'm guessing the body of that initial body is something like
>> [[
>> <D:options xmlns:D="DAV:">
>>   <D:activity-collection-set />
>> </D:options>
>> ]]
>> (content-type text/xml of course)
>>
>> And this request is mostly handled by mod_dav, and further annotated with
>> additional headers by mod_dav_svn.
>>
>> I can't just redesign DAV to optimize for http/2. If we had a timemachine,
>> we would have made other decisions.
>>
>> Would have been nice if we knew DELTA/V was never really implemented outside
>> Subversion. But now we have compatibility guarantees with older Subversion
>> clients/servers and other implementations that may use some of the features.
>>
>>       Bert
>

From dev-return-84964-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Tue Dec  8 13:13:55 2015
Return-Path: <dev-return-84964-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 62B3C10B6F
	for <apmail-httpd-dev-archive@www.apache.org>; Tue,  8 Dec 2015 13:13:55 +0000 (UTC)
Received: (qmail 33656 invoked by uid 500); 8 Dec 2015 13:13:45 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 33554 invoked by uid 500); 8 Dec 2015 13:13:45 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 33537 invoked by uid 99); 8 Dec 2015 13:13:45 -0000
Received: from Unknown (HELO spamd3-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 08 Dec 2015 13:13:45 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd3-us-west.apache.org (ASF Mail Server at spamd3-us-west.apache.org) with ESMTP id CE25418028D
	for <dev@httpd.apache.org>; Tue,  8 Dec 2015 13:13:44 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd3-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.121
X-Spam-Level:
X-Spam-Status: No, score=-0.121 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RCVD_IN_MSPIKE_H3=-0.01, RCVD_IN_MSPIKE_WL=-0.01, SPF_PASS=-0.001]
	autolearn=disabled
Authentication-Results: spamd3-us-west.apache.org (amavisd-new);
	dkim=pass (1024-bit key) header.d=qqmail.nl
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd3-us-west.apache.org [10.40.0.10]) (amavisd-new, port 10024)
	with ESMTP id Gqco7CwdHVBk for <dev@httpd.apache.org>;
	Tue,  8 Dec 2015 13:13:43 +0000 (UTC)
Received: from mail-wm0-f50.google.com (mail-wm0-f50.google.com [74.125.82.50])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id 1F7A742B82
	for <dev@httpd.apache.org>; Tue,  8 Dec 2015 13:13:43 +0000 (UTC)
Received: by wmuu63 with SMTP id u63so180301739wmu.0
        for <dev@httpd.apache.org>; Tue, 08 Dec 2015 05:08:41 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=qqmail.nl; s=google;
        h=from:to:references:in-reply-to:subject:date:message-id:mime-version
         :content-type:content-transfer-encoding:thread-index
         :content-language;
        bh=SCArjmAUI7GhwbJER7XIbDzRmk+QC0kn+kcd7Ci3T28=;
        b=HBEMJ6zI0j9KLfrA4iXX4mYCKuVF12c0Xxf3qV/w9kyHaXfCHfKqqawzVQmTY6KQJe
         +XhVaf4xZjKveMY8ufjkK9wA3bftAfBYwkpMQja6vuG7qqf/1l8mI9+UlI5xinBvK54Y
         XAbKeGbxpsEBDVgRLh14Idd5lWu+4gq9JRyaI=
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=1e100.net; s=20130820;
        h=x-gm-message-state:from:to:references:in-reply-to:subject:date
         :message-id:mime-version:content-type:content-transfer-encoding
         :thread-index:content-language;
        bh=SCArjmAUI7GhwbJER7XIbDzRmk+QC0kn+kcd7Ci3T28=;
        b=EarDJDE/rbexUdztclyxajKoR0kagx7NAcNSPQGOzZH58sfpIAYqe2pzwEf3CGJu98
         5ue+Kc4ExSqvxrDOj6RVjrRd3worUTwfPlB+h0eBVOc7+kb2FqBrcovxkOoP2IdTOKyd
         zuTRHqr8m4UAhEnK1VHwXVgSUi3wJEWuY0G6nLVQf0DjBIJtlrEKkiiAXR6mW/FTgVZX
         Ai2zhUGTVo9O49DiA6OFA2wY/xjNBa2AMJxj3qiIBi/rGL/glQIX8/UJzepQdKLTfNla
         sWM9iiNZ/itj0T3LBocgeRO2iaDnHrhhaychZFgaJx+JV8+16FzuIaYgF82AIMUQCwqw
         rbPw==
X-Gm-Message-State: ALoCoQnx5W/MrrmHRYziOZ2/1Y4KeloWkiQFaazGwLWNq59tVrLaCfmwBr5LchdYdyNu6HkJ7mYw1rdiCEblhVydGwm7Wq8M5g==
X-Received: by 10.28.50.193 with SMTP id y184mr28990419wmy.26.1449580121138;
        Tue, 08 Dec 2015 05:08:41 -0800 (PST)
Received: from I72600 ([2001:610:66e:0:52e5:49ff:fee1:96b7])
        by smtp.gmail.com with ESMTPSA id z66sm21565713wmz.7.2015.12.08.05.08.40
        for <dev@httpd.apache.org>
        (version=TLS1_2 cipher=ECDHE-RSA-AES128-GCM-SHA256 bits=128/128);
        Tue, 08 Dec 2015 05:08:40 -0800 (PST)
From: "Bert Huijben" <bert@qqmail.nl>
To: <dev@httpd.apache.org>
References: <CACsi250=dbRQKnsbE8JSdAZRm5x99gE0sgX3iQ-PHAx77euD1A@mail.gmail.com> <AB1691BE05AE7F4992697F2A0835627AC63BAB94@VOEXM10W.internal.vodafone.com> <F7B20D30-D34A-4805-A77D-F64F6428F6E3@greenbytes.de> <56660896.c74fc20a.15f56.0ebd@mx.google.com> <56660B43.2060507@gmail.com> <6B13DF2B-0586-42BB-B62F-59A7638B697D@greenbytes.de> <13FE9E7F-9620-4BF9-8EA4-57A6314D66BF@greenbytes.de> <CAKQ1sVNaRRRVn-Qp_OuR-oK6D32dJeSoBKRrteMtr+ABjZMB7w@mail.gmail.com> <E9DB0497-C846-4EB2-9064-06ED1801A113@greenbytes.de> <cf2e01d131ad$4f55c7a0$ee0156e0$@qqmail.nl> <23776D3F-162E-4C8D-AA80-8BBE53B7F20B@greenbytes.de> <cf3e01d131b6$7cc72590$765570b0$@qqmail.nl> <0B4C7502-7DD7-4FFF-8E77-EBA83C69704F@greenbytes.de>
In-Reply-To: <0B4C7502-7DD7-4FFF-8E77-EBA83C69704F@greenbytes.de>
Subject: RE: Upgrade Summary
Date: Tue, 8 Dec 2015 14:08:34 +0100
Message-ID: <cf4401d131b9$8c878ee0$a596aca0$@qqmail.nl>
MIME-Version: 1.0
Content-Type: text/plain;
	charset="us-ascii"
Content-Transfer-Encoding: 7bit
X-Mailer: Microsoft Outlook 16.0
Thread-Index: AQKiK5k53Zwc1sqI7zswkQpwqyBJZQHPPeQLAlYfy+wBw01DvAJJXKo0Ai3vbIwBtCRQOwIKJ3O2AkJSr/kCyFGF2ALaCAYoATZfsEwBbv7QzZxZ2EKA
Content-Language: nl

> -----Original Message-----
> From: Stefan Eissing [mailto:stefan.eissing@greenbytes.de]
> Sent: dinsdag 8 december 2015 13:54
> To: dev@httpd.apache.org
> Subject: Re: Upgrade Summary
> 
> I see. Delta-V goodies.
> 
> My proposal therefore is:
> - keep the upgrade/protocol switch mechanism as is for the 2.4.18 release
> - make the agreed upon changes, including TLS upgrade and small content
> h2c upgrades for the next release
> 
> Since the mechanism is already out with 2.4.17, I see no sense in delaying
> 2.4.18 at this point and rather give us time to change it later, so it
works for
> everyone.

Sure... my upgrade requests for Subversion are for 2.4.x future... Certainly
no rush here.

I don't expect this upgrade support to reach Subversion far before 1.10. 

Perhaps we will backport some of this to 1.9, but I don't think we can just
enable H2 support in a minor release without testing on a bigger group
first.
(I'm pretty sure we find new interesting proxy server scenarios :-( )

	Bert


From dev-return-84965-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Tue Dec  8 13:26:53 2015
Return-Path: <dev-return-84965-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 5D97010BE5
	for <apmail-httpd-dev-archive@www.apache.org>; Tue,  8 Dec 2015 13:26:53 +0000 (UTC)
Received: (qmail 53281 invoked by uid 500); 8 Dec 2015 13:26:52 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 53197 invoked by uid 500); 8 Dec 2015 13:26:52 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 53183 invoked by uid 99); 8 Dec 2015 13:26:52 -0000
Received: from Unknown (HELO spamd3-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 08 Dec 2015 13:26:52 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd3-us-west.apache.org (ASF Mail Server at spamd3-us-west.apache.org) with ESMTP id 44205180428
	for <dev@httpd.apache.org>; Tue,  8 Dec 2015 13:26:52 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd3-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.654
X-Spam-Level:
X-Spam-Status: No, score=-0.654 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RP_MATCHES_RCVD=-0.554, SPF_PASS=-0.001, URIBL_BLOCKED=0.001]
	autolearn=disabled
Authentication-Results: spamd3-us-west.apache.org (amavisd-new);
	dkim=pass (1024-bit key) header.d=greenbytes.de
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd3-us-west.apache.org [10.40.0.10]) (amavisd-new, port 10024)
	with ESMTP id 12xCUoGQFMm3 for <dev@httpd.apache.org>;
	Tue,  8 Dec 2015 13:26:43 +0000 (UTC)
Received: from mail.greenbytes.de (mail.greenbytes.de [217.91.35.233])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id 1EFB342AA6
	for <dev@httpd.apache.org>; Tue,  8 Dec 2015 13:26:43 +0000 (UTC)
Received: from [192.168.1.42] (unknown [217.91.35.233])
	(using TLSv1 with cipher ECDHE-RSA-AES256-SHA (256/256 bits))
	(Client did not present a certificate)
	by mail.greenbytes.de (Postfix) with ESMTPSA id BE25915A043B
	for <dev@httpd.apache.org>; Tue,  8 Dec 2015 14:21:41 +0100 (CET)
DKIM-Signature: v=1; a=rsa-sha256; c=simple/simple; d=greenbytes.de; s=mail;
	t=1449580901; bh=DyA0gYqkcFsoCqZQWa3YQBfSCTtWNlt6X+lG7KKSkH4=;
	h=Subject:From:In-Reply-To:Date:References:To:From;
	b=R7OfHfGwnLu34248ZN2I8e88VKaMc/mEn8aRLb/w2petP7PT4uSRW7dZ6NaUjze4d
	 qOZt4XzhDKSPcp4o2puY9AfxYW9tpRt2lbIQp7sViy1/+Gcoggk/LgehvxbMW/ObNh
	 sWMFAnkeEi+3tVeIQY13kLjSifuyqaXnsr7G48rI=
Content-Type: text/plain; charset=us-ascii
Mime-Version: 1.0 (Mac OS X Mail 9.1 \(3096.5\))
Subject: Re: Upgrade Summary
From: Stefan Eissing <stefan.eissing@greenbytes.de>
In-Reply-To: <cf4401d131b9$8c878ee0$a596aca0$@qqmail.nl>
Date: Tue, 8 Dec 2015 14:21:41 +0100
Content-Transfer-Encoding: quoted-printable
Message-Id: <682F2F1E-1C36-4E43-8CA6-E7F58F3E8292@greenbytes.de>
References: <CACsi250=dbRQKnsbE8JSdAZRm5x99gE0sgX3iQ-PHAx77euD1A@mail.gmail.com> <AB1691BE05AE7F4992697F2A0835627AC63BAB94@VOEXM10W.internal.vodafone.com> <F7B20D30-D34A-4805-A77D-F64F6428F6E3@greenbytes.de> <56660896.c74fc20a.15f56.0ebd@mx.google.com> <56660B43.2060507@gmail.com> <6B13DF2B-0586-42BB-B62F-59A7638B697D@greenbytes.de> <13FE9E7F-9620-4BF9-8EA4-57A6314D66BF@greenbytes.de> <CAKQ1sVNaRRRVn-Qp_OuR-oK6D32dJeSoBKRrteMtr+ABjZMB7w@mail.gmail.com> <E9DB0497-C846-4EB2-9064-06ED1801A113@greenbytes.de> <cf2e01d131ad$4f55c7a0$ee0156e0$@qqmail.nl> <23776D3F-162E-4C8D-AA80-8BBE53B7F20B@greenbytes.de> <cf3e01d131b6$7cc72590$765570b0$@qqmail.nl> <0B4C7502-7DD7-4FFF-8E77-EBA83C69704F@greenbytes.de> <cf4401d131b9$8c878ee0$a596aca0$@qqmail.nl>
To: dev@httpd.apache.org
X-Mailer: Apple Mail (2.3096.5)


> Am 08.12.2015 um 14:08 schrieb Bert Huijben <bert@qqmail.nl>:
> [...]
> (I'm pretty sure we find new interesting proxy server scenarios :-( )

Not only that. Someone tested h2c against his server from various Tor =
exit nodes and got a failure rate > 10% because of network middle =
boxes...

Fun times.




From dev-return-84966-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Tue Dec  8 13:43:02 2015
Return-Path: <dev-return-84966-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 0D51710CBF
	for <apmail-httpd-dev-archive@www.apache.org>; Tue,  8 Dec 2015 13:43:02 +0000 (UTC)
Received: (qmail 77857 invoked by uid 500); 8 Dec 2015 13:42:58 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 77741 invoked by uid 500); 8 Dec 2015 13:42:58 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 77731 invoked by uid 99); 8 Dec 2015 13:42:57 -0000
Received: from Unknown (HELO spamd3-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 08 Dec 2015 13:42:57 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd3-us-west.apache.org (ASF Mail Server at spamd3-us-west.apache.org) with ESMTP id 8BF9918017A
	for <dev@httpd.apache.org>; Tue,  8 Dec 2015 13:42:57 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd3-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 0.278
X-Spam-Level:
X-Spam-Status: No, score=0.278 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1,
	HEADER_FROM_DIFFERENT_DOMAINS=0.001, PLING_QUERY=0.279,
	RCVD_IN_MSPIKE_H2=-0.001, SPF_PASS=-0.001] autolearn=disabled
Authentication-Results: spamd3-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd3-us-west.apache.org [10.40.0.10]) (amavisd-new, port 10024)
	with ESMTP id h11HEZgVzzAW for <dev@httpd.apache.org>;
	Tue,  8 Dec 2015 13:42:56 +0000 (UTC)
Received: from mail-qg0-f53.google.com (mail-qg0-f53.google.com [209.85.192.53])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id A0DEB42B96
	for <dev@httpd.apache.org>; Tue,  8 Dec 2015 13:42:56 +0000 (UTC)
Received: by qgec40 with SMTP id c40so15403941qge.2
        for <dev@httpd.apache.org>; Tue, 08 Dec 2015 05:37:56 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=mime-version:sender:date:message-id:subject:from:to:content-type;
        bh=Lfd7mMxSO316ECSoe1swbDgLfnfR1Kn07Cc/DAhmNDo=;
        b=e81J6A0CxN13CJwsTacJ6ux8eg1MvQVTmrmBvK7shf4fFVC/CO2ZojJGemqpkBQkXg
         iuZs9g1ZMHFVb314eFag5fUINfiVv5GnmVTdn4I3bhdmMa/rpi4x0pn/28bbAjlnvUca
         Yw8Q57kJnB/kE1i4elTsZXcijtoHCrjzDyDPwHNMSI/5BeDZltg6Ib3VTMANrpnAvc2/
         J+Cy2mFcaswMx8WnTS+xPlwrDOHZUVj3Q4QZLUT/tyiDyBLED0rcUEFxplPUPjvovyCg
         0uQBHKPjyXzGZS805VoXBFBHCGSChYwy+S+tGsvrEt+tYe+XmTsP6Vm1qbHhYB4VAN74
         FjYA==
MIME-Version: 1.0
X-Received: by 10.55.217.149 with SMTP id q21mr4533574qkl.55.1449581875931;
 Tue, 08 Dec 2015 05:37:55 -0800 (PST)
Sender: ylavic.dev@gmail.com
Received: by 10.55.65.85 with HTTP; Tue, 8 Dec 2015 05:37:55 -0800 (PST)
Date: Tue, 8 Dec 2015 14:37:55 +0100
X-Google-Sender-Auth: aKXMhunIok3y6SNnSeyHxN9DEVk
Message-ID: <CAKQ1sVOFVO9dxgncH2txe3qbuT46c9O=h1T2djBzfRVmH64m_Q@mail.gmail.com>
Subject: Upgrade when !ap_request_has_body(r) only for 2.4.18? (was: svn
 commit: r1718595 - /httpd/httpd/branches/2.4.x/STATUS)
From: Yann Ylavic <ylavic@apache.org>
To: httpd-dev <dev@httpd.apache.org>
Content-Type: text/plain; charset=UTF-8

On Tue, Dec 8, 2015 at 2:30 PM,  <ylavic@apache.org> wrote:
> Author: ylavic
> Date: Tue Dec  8 13:30:30 2015
> New Revision: 1718595
>
> URL: http://svn.apache.org/viewvc?rev=1718595&view=rev
> Log:
> Comment about ap_request_has_body() check for Upgrade.
>
> Modified:
>     httpd/httpd/branches/2.4.x/STATUS
>
[]
>       trunk patch: http://svn.apache.org/r1717816
>       +1: wrowe, icing
> +     ylavic: how about adding !ap_request_has_body(r) to the test then?

E.g. (on top of r1717816):

Index: modules/ssl/ssl_engine_kernel.c
===================================================================
--- modules/ssl/ssl_engine_kernel.c    (revision 1718341)
+++ modules/ssl/ssl_engine_kernel.c    (working copy)
@@ -252,7 +252,7 @@ int ssl_hook_ReadReq(request_rec *r)
      * and OPTIONS * request processing is completed.
      */
     if (sc->enabled == SSL_ENABLED_OPTIONAL && !(sslconn && sslconn->ssl)
-        && !r->main) {
+            && ap_is_initial_req(r) && !ap_has_request_body(r)) {
         apr_table_setn(r->headers_out, "Upgrade", "TLS/1.0, HTTP/1.1");
         apr_table_mergen(r->headers_out, "Connection", "upgrade");
     }
--

From dev-return-84967-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Tue Dec  8 14:07:02 2015
Return-Path: <dev-return-84967-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id ACF5E10DC3
	for <apmail-httpd-dev-archive@www.apache.org>; Tue,  8 Dec 2015 14:07:02 +0000 (UTC)
Received: (qmail 40024 invoked by uid 500); 8 Dec 2015 14:07:01 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 39965 invoked by uid 500); 8 Dec 2015 14:07:01 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 39954 invoked by uid 99); 8 Dec 2015 14:07:01 -0000
Received: from Unknown (HELO spamd2-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 08 Dec 2015 14:07:01 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd2-us-west.apache.org (ASF Mail Server at spamd2-us-west.apache.org) with ESMTP id C496B1A0AAF
	for <dev@httpd.apache.org>; Tue,  8 Dec 2015 14:07:00 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd2-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.376
X-Spam-Level:
X-Spam-Status: No, score=-0.376 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	PLING_QUERY=0.279, RP_MATCHES_RCVD=-0.554, SPF_PASS=-0.001]
	autolearn=disabled
Authentication-Results: spamd2-us-west.apache.org (amavisd-new);
	dkim=pass (1024-bit key) header.d=greenbytes.de
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd2-us-west.apache.org [10.40.0.9]) (amavisd-new, port 10024)
	with ESMTP id uy4OgyvYBa7S for <dev@httpd.apache.org>;
	Tue,  8 Dec 2015 14:06:59 +0000 (UTC)
Received: from mail.greenbytes.de (mail.greenbytes.de [217.91.35.233])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id 0C1D942B82
	for <dev@httpd.apache.org>; Tue,  8 Dec 2015 14:06:59 +0000 (UTC)
Received: from [192.168.1.42] (unknown [217.91.35.233])
	(using TLSv1 with cipher ECDHE-RSA-AES256-SHA (256/256 bits))
	(Client did not present a certificate)
	by mail.greenbytes.de (Postfix) with ESMTPSA id B64BB15A049C
	for <dev@httpd.apache.org>; Tue,  8 Dec 2015 15:01:57 +0100 (CET)
DKIM-Signature: v=1; a=rsa-sha256; c=simple/simple; d=greenbytes.de; s=mail;
	t=1449583317; bh=aYyju/j7NAyBqrmM0SQqSt6bO1HvD/qCfVF/B1n7vQE=;
	h=Subject:From:In-Reply-To:Date:References:To:From;
	b=R30Hl83X/XcU3qTZk7yXP2OZNS2x6DPKr5EdVc8kHG7EbTOq4lcU+a/9gubZvociL
	 OHssO7t9vgQEV51PQw4ocX0r7gDdiGVTQu48BFkc5ahAVJN5lvUfTyYxQ/4/tj+20g
	 0gh/PEmuXIzi7rXm6xSb/b9glXjDsyWZyPiz78S8=
Content-Type: text/plain; charset=us-ascii
Mime-Version: 1.0 (Mac OS X Mail 9.1 \(3096.5\))
Subject: Re: Upgrade when !ap_request_has_body(r) only for 2.4.18? (was: svn commit: r1718595 - /httpd/httpd/branches/2.4.x/STATUS)
From: Stefan Eissing <stefan.eissing@greenbytes.de>
In-Reply-To: <CAKQ1sVOFVO9dxgncH2txe3qbuT46c9O=h1T2djBzfRVmH64m_Q@mail.gmail.com>
Date: Tue, 8 Dec 2015 15:01:57 +0100
Content-Transfer-Encoding: quoted-printable
Message-Id: <8FDFC0E2-4088-4324-90FB-A81F9FD016F3@greenbytes.de>
References: <CAKQ1sVOFVO9dxgncH2txe3qbuT46c9O=h1T2djBzfRVmH64m_Q@mail.gmail.com>
To: dev@httpd.apache.org
X-Mailer: Apple Mail (2.3096.5)

With the current implementation, that seems wise. This restriction can =
be removed once the change we discussed with output filter/hook is =
working.

> Am 08.12.2015 um 14:37 schrieb Yann Ylavic <ylavic@apache.org>:
>=20
> On Tue, Dec 8, 2015 at 2:30 PM,  <ylavic@apache.org> wrote:
>> Author: ylavic
>> Date: Tue Dec  8 13:30:30 2015
>> New Revision: 1718595
>>=20
>> URL: http://svn.apache.org/viewvc?rev=3D1718595&view=3Drev
>> Log:
>> Comment about ap_request_has_body() check for Upgrade.
>>=20
>> Modified:
>>    httpd/httpd/branches/2.4.x/STATUS
>>=20
> []
>>      trunk patch: http://svn.apache.org/r1717816
>>      +1: wrowe, icing
>> +     ylavic: how about adding !ap_request_has_body(r) to the test =
then?
>=20
> E.g. (on top of r1717816):
>=20
> Index: modules/ssl/ssl_engine_kernel.c
> =3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D
> --- modules/ssl/ssl_engine_kernel.c    (revision 1718341)
> +++ modules/ssl/ssl_engine_kernel.c    (working copy)
> @@ -252,7 +252,7 @@ int ssl_hook_ReadReq(request_rec *r)
>      * and OPTIONS * request processing is completed.
>      */
>     if (sc->enabled =3D=3D SSL_ENABLED_OPTIONAL && !(sslconn && =
sslconn->ssl)
> -        && !r->main) {
> +            && ap_is_initial_req(r) && !ap_has_request_body(r)) {
>         apr_table_setn(r->headers_out, "Upgrade", "TLS/1.0, =
HTTP/1.1");
>         apr_table_mergen(r->headers_out, "Connection", "upgrade");
>     }
> --


From dev-return-84968-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Tue Dec  8 14:09:53 2015
Return-Path: <dev-return-84968-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id CC07A10E63
	for <apmail-httpd-dev-archive@www.apache.org>; Tue,  8 Dec 2015 14:09:53 +0000 (UTC)
Received: (qmail 51954 invoked by uid 500); 8 Dec 2015 14:09:53 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 51874 invoked by uid 500); 8 Dec 2015 14:09:53 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 51864 invoked by uid 99); 8 Dec 2015 14:09:53 -0000
Received: from Unknown (HELO spamd2-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 08 Dec 2015 14:09:53 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd2-us-west.apache.org (ASF Mail Server at spamd2-us-west.apache.org) with ESMTP id B2D3C1A0AAF
	for <dev@httpd.apache.org>; Tue,  8 Dec 2015 14:09:52 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd2-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 0.179
X-Spam-Level:
X-Spam-Status: No, score=0.179 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	PLING_QUERY=0.279] autolearn=disabled
Authentication-Results: spamd2-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd2-us-west.apache.org [10.40.0.9]) (amavisd-new, port 10024)
	with ESMTP id IlP9uxTQ7wI7 for <dev@httpd.apache.org>;
	Tue,  8 Dec 2015 14:09:37 +0000 (UTC)
Received: from mail-qg0-f54.google.com (mail-qg0-f54.google.com [209.85.192.54])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id 276DB25E29
	for <dev@httpd.apache.org>; Tue,  8 Dec 2015 14:09:32 +0000 (UTC)
Received: by qgec40 with SMTP id c40so16910838qge.2
        for <dev@httpd.apache.org>; Tue, 08 Dec 2015 06:09:31 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=mime-version:date:message-id:subject:from:to:content-type;
        bh=74nAFXT+u4OSK8BhYp4Utua7DDj5lRGyGypyKxuiISI=;
        b=Ggi7AJJWeXoBQHLBylZSjPiVvhvczwFZlHW5x3PKU1LZNQ19foWDLCopmyAsRtvCXq
         badijxJUQg8iJtcjA5b9jGmb8wsfecB7clWA/cjX45CzyMP653KBPlSM3oqPp4S0eNwQ
         jqY32RyfT0zuGRd1RdAjB0lrkiNnTSrvCOp5mj4HJyuua1o2tsGr2IqKfWykYddGLmmB
         O5TCSFB/HNEpWuY4IWZwzhr42BpJsT0nZUCBZ997rdQ5oF2YvAf/UW5xKSkcH+B/e1FN
         LjqBnLbaST4CqB0VlFN5CGAiOOYLwFfUk+OqOgYH00M4kUZqbjKeP/oVa49HV5+S+EPh
         0aAw==
MIME-Version: 1.0
X-Received: by 10.55.75.8 with SMTP id y8mr4874518qka.2.1449583769413; Tue, 08
 Dec 2015 06:09:29 -0800 (PST)
Received: by 10.55.65.85 with HTTP; Tue, 8 Dec 2015 06:09:29 -0800 (PST)
Date: Tue, 8 Dec 2015 15:09:29 +0100
Message-ID: <CAKQ1sVNgj8M12Ye+PM+B8EPnFdDkcdELJ-Hbo34kquFXMj-Eyg@mail.gmail.com>
Subject: Re: Upgrade when !ap_request_has_body(r) only for 2.4.18? (was: svn
 commit: r1718595 - /httpd/httpd/branches/2.4.x/STATUS)
From: Yann Ylavic <ylavic.dev@gmail.com>
To: httpd-dev <dev@httpd.apache.org>
Content-Type: text/plain; charset=UTF-8

On Tue, Dec 8, 2015 at 2:37 PM, Yann Ylavic <ylavic@apache.org> wrote:
> On Tue, Dec 8, 2015 at 2:30 PM,  <ylavic@apache.org> wrote:
>> Author: ylavic
>> Date: Tue Dec  8 13:30:30 2015
>> New Revision: 1718595
>>
>> URL: http://svn.apache.org/viewvc?rev=1718595&view=rev
>> Log:
>> Comment about ap_request_has_body() check for Upgrade.
>>
>> Modified:
>>     httpd/httpd/branches/2.4.x/STATUS
>>
> []
>>       trunk patch: http://svn.apache.org/r1717816
>>       +1: wrowe, icing
>> +     ylavic: how about adding !ap_request_has_body(r) to the test then?
>
> E.g. (on top of r1717816):

Actually, since there is already an Upgrade handling above, wouldn't a more
correct patch be (trunk):

Index: modules/ssl/ssl_engine_kernel.c
===================================================================
--- modules/ssl/ssl_engine_kernel.c    (revision 1718341)
+++ modules/ssl/ssl_engine_kernel.c    (working copy)
@@ -230,10 +230,13 @@ int ssl_hook_ReadReq(request_rec *r)

     /* Perform TLS upgrade here if "SSLEngine optional" is configured,
      * SSL is not already set up for this connection, and the client
-     * has sent a suitable Upgrade header. */
+     * has sent a suitable Upgrade header. Note this must happen before
+     * map_to_storage and OPTIONS * request processing is completed.
+     */
     if (sc->enabled == SSL_ENABLED_OPTIONAL && !myConnConfig(r->connection)
         && (upgrade = apr_table_get(r->headers_in, "Upgrade")) != NULL
-        && ap_find_token(r->pool, upgrade, "TLS/1.0")) {
+        && ap_find_token(r->pool, upgrade, "TLS/1.0")
+        && !r->main && !ap_has_request_body(r)) {
         if (upgrade_connection(r)) {
             return AP_FILTER_ERROR;
         }
@@ -246,17 +249,6 @@ int ssl_hook_ReadReq(request_rec *r)
         sslconn = myConnConfig(r->connection->master);
     }

-    /* If "SSLEngine optional" is configured, this is not an SSL
-     * connection, and this isn't a subrequest, send an Upgrade
-     * response header.  Note this must happen before map_to_storage
-     * and OPTIONS * request processing is completed.
-     */
-    if (sc->enabled == SSL_ENABLED_OPTIONAL && !(sslconn && sslconn->ssl)
-        && !r->main) {
-        apr_table_setn(r->headers_out, "Upgrade", "TLS/1.0, HTTP/1.1");
-        apr_table_mergen(r->headers_out, "Connection", "upgrade");
-    }
-
     if (!sslconn) {
         return DECLINED;
     }
?

From dev-return-84969-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Tue Dec  8 14:18:01 2015
Return-Path: <dev-return-84969-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 9F71D10EAA
	for <apmail-httpd-dev-archive@www.apache.org>; Tue,  8 Dec 2015 14:18:01 +0000 (UTC)
Received: (qmail 70536 invoked by uid 500); 8 Dec 2015 14:17:58 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 70446 invoked by uid 500); 8 Dec 2015 14:17:58 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 70436 invoked by uid 99); 8 Dec 2015 14:17:58 -0000
Received: from Unknown (HELO spamd4-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 08 Dec 2015 14:17:58 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd4-us-west.apache.org (ASF Mail Server at spamd4-us-west.apache.org) with ESMTP id B07D2C0BC9
	for <dev@httpd.apache.org>; Tue,  8 Dec 2015 14:17:57 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd4-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 0.931
X-Spam-Level:
X-Spam-Status: No, score=0.931 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, PLING_QUERY=0.279,
	SPF_NEUTRAL=0.652] autolearn=disabled
Authentication-Results: spamd4-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=comcast.net
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd4-us-west.apache.org [10.40.0.11]) (amavisd-new, port 10024)
	with ESMTP id dd9BO6NaQ804 for <dev@httpd.apache.org>;
	Tue,  8 Dec 2015 14:17:51 +0000 (UTC)
Received: from resqmta-ch2-01v.sys.comcast.net (resqmta-ch2-01v.sys.comcast.net [69.252.207.33])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id 1411E42AA6
	for <dev@httpd.apache.org>; Tue,  8 Dec 2015 14:17:51 +0000 (UTC)
Received: from resomta-ch2-15v.sys.comcast.net ([69.252.207.111])
	by resqmta-ch2-01v.sys.comcast.net with comcast
	id r2HJ1r00B2Qkjl9012HkNn; Tue, 08 Dec 2015 14:17:44 +0000
Received: from [192.168.199.10] ([69.251.84.114])
	by resomta-ch2-15v.sys.comcast.net with comcast
	id r2Hj1r00G2U0RYt012Hj9r; Tue, 08 Dec 2015 14:17:44 +0000
Content-Type: text/plain; charset=us-ascii
Mime-Version: 1.0 (Mac OS X Mail 9.1 \(3096.5\))
Subject: Re: Upgrade when !ap_request_has_body(r) only for 2.4.18? (was: svn commit: r1718595 - /httpd/httpd/branches/2.4.x/STATUS)
From: Jim Jagielski <jim@jaguNET.com>
In-Reply-To: <CAKQ1sVNgj8M12Ye+PM+B8EPnFdDkcdELJ-Hbo34kquFXMj-Eyg@mail.gmail.com>
Date: Tue, 8 Dec 2015 09:17:43 -0500
Content-Transfer-Encoding: 7bit
Message-Id: <D785F0D3-D690-4C18-8FD2-67ABACE8D730@jaguNET.com>
References: <CAKQ1sVNgj8M12Ye+PM+B8EPnFdDkcdELJ-Hbo34kquFXMj-Eyg@mail.gmail.com>
To: dev@httpd.apache.org
X-Mailer: Apple Mail (2.3096.5)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=comcast.net;
	s=q20140121; t=1449584264;
	bh=Yzv23ciDPAjnFuH9Lude28frpO+glvTba8unTCe6qew=;
	h=Received:Received:Content-Type:Mime-Version:Subject:From:Date:
	 Message-Id:To;
	b=Bz24xeHxPezEHSBAtdHxZtlzJui8sGUEZTW3s8P7yMb8DSU47uAtAUaDSoHKp1/+f
	 jGxuxuyz+GOHQfOZKhCcYGVc2hbaXJVNzYvNVc8+2o34RXs84Q5FtDQfmKbmFQY1mX
	 FnilGTXQmgYMI+mPC6nYHwz4kYZjcwvTV8hgg5k2yRUG1IgV01O3YSWtQSkydgTEXD
	 qjMXFtKyLSfZzWxQw/sttoy3R9zkVw42jSCM1B5ehhXkUMSplaq6AHkxlbNZdDMPgA
	 Ejm1Hr+tBji9GISqubMeloDDm8tg1gTrB6fqgj0avbrU1eBUYXkJblcSmmW6zTrZBq
	 DDiNwvw527z3w==

My only suggestion is that instead of willy-nilly suggesting
patches that will be included in a release, that we actually take
time to think of the correct patch, to implement it and TEST against
it and only THEN have it backported.

Please.

We don't want to put out a semi-immediate 2.4.19 because one
of these last-minute patches broke other stuff. It looks, and
is, really, really bad and amateur.

From dev-return-84970-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Tue Dec  8 14:29:51 2015
Return-Path: <dev-return-84970-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 10CB710F39
	for <apmail-httpd-dev-archive@www.apache.org>; Tue,  8 Dec 2015 14:29:51 +0000 (UTC)
Received: (qmail 9696 invoked by uid 500); 8 Dec 2015 14:29:47 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 9619 invoked by uid 500); 8 Dec 2015 14:29:47 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 9609 invoked by uid 99); 8 Dec 2015 14:29:47 -0000
Received: from Unknown (HELO spamd3-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 08 Dec 2015 14:29:47 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd3-us-west.apache.org (ASF Mail Server at spamd3-us-west.apache.org) with ESMTP id 10FAB18028B
	for <dev@httpd.apache.org>; Tue,  8 Dec 2015 14:29:47 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd3-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 3.277
X-Spam-Level: ***
X-Spam-Status: No, score=3.277 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, HTML_MESSAGE=3,
	PLING_QUERY=0.279, RCVD_IN_MSPIKE_H2=-0.001, SPF_PASS=-0.001]
	autolearn=disabled
Authentication-Results: spamd3-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=rowe-clan-net.20150623.gappssmtp.com
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd3-us-west.apache.org [10.40.0.10]) (amavisd-new, port 10024)
	with ESMTP id xqKqikQxLuy9 for <dev@httpd.apache.org>;
	Tue,  8 Dec 2015 14:29:45 +0000 (UTC)
Received: from mail-io0-f181.google.com (mail-io0-f181.google.com [209.85.223.181])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id DCAAD42BBD
	for <dev@httpd.apache.org>; Tue,  8 Dec 2015 14:29:44 +0000 (UTC)
Received: by ioc74 with SMTP id 74so25609278ioc.2
        for <dev@httpd.apache.org>; Tue, 08 Dec 2015 06:29:38 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=rowe-clan-net.20150623.gappssmtp.com; s=20150623;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        bh=lDV9NIsbbqWD9p1A2Hk87Dd9FBHAZBhK0Mozm85CWlw=;
        b=g6oH6okU4JWjQPpcMx+eAd2QZEtCBSV6J6sp9yH7/TWXtz2o7NfCcrejKLDPyzVrFV
         SbU/qwG3CN/8h7y42+lPiEIlCfK1Z8bq1yolTKI81P7WmO483qYSoDxI6TFwEXgUv0IR
         mXLW8dcHQRLpkorlaVQj1N8aoziRVi1Yw9WfiKJDWj00WL+dCqaURXbhxbaUkMRKYgkA
         sGtVUSm8xJTpR5UQXaYtBcGy6V8bIreNh7cbNH1F4sHAKCS0FaZw12a1EWdDHymXlgIy
         nYbzQCXIH0t+7eZ0qWOlU1pA1VIEHI8DAM6Lsr44T4J8EZqcplitfrxi7yaY4j48cdvQ
         kbQA==
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=1e100.net; s=20130820;
        h=x-gm-message-state:mime-version:in-reply-to:references:date
         :message-id:subject:from:to:content-type;
        bh=lDV9NIsbbqWD9p1A2Hk87Dd9FBHAZBhK0Mozm85CWlw=;
        b=aetdZMXwmodX+lTRwDDdxnr+QX3DQUWIgt+X1UmwQvapuUQ68Hd5cnCNzjbgLttFh9
         z8WDRlH/G4XKd+Ia7ttoZmrEPaF3wYYtRIycasCVflzfsi0M5vVzXF7HHBAqWKC1py4k
         phlLcr3kEB8bSSh9ERwVuRZh3CVsU75SAkGLmpsMGJJf8RTtj9MYFyi0Q7w0BiU+zef3
         hQLVEqTwDuMdIbLx+3+R5N2r7DeHtEmE2oPElBAvRJ/MUjghSGp7/G0TqnMufMwGXOOH
         vwGjXq8XFGsHljZAhzU8skNgYltHGG9cKZHfqfLSZ2OVTcBfXVlfAqpaZXCzseevY8yC
         BgMQ==
X-Gm-Message-State: ALoCoQkWW3nCGscCsDt9Zp+yZ8Hcdq5An23XEtBN+CrYKnD+YfiOTWMHWw+fovHD2XnkvcSjZJORihpScRod5qX0+12x0yHtLz4lkpUUSAoPvkKWkCqJ3G4=
MIME-Version: 1.0
X-Received: by 10.107.10.66 with SMTP id u63mr186159ioi.86.1449584978515; Tue,
 08 Dec 2015 06:29:38 -0800 (PST)
Received: by 10.107.62.136 with HTTP; Tue, 8 Dec 2015 06:29:38 -0800 (PST)
In-Reply-To: <CAKQ1sVOFVO9dxgncH2txe3qbuT46c9O=h1T2djBzfRVmH64m_Q@mail.gmail.com>
References: <CAKQ1sVOFVO9dxgncH2txe3qbuT46c9O=h1T2djBzfRVmH64m_Q@mail.gmail.com>
Date: Tue, 8 Dec 2015 08:29:38 -0600
Message-ID: <CACsi250ihFv=N3s0u+7KwK1z67ekiHSMQwABBZddeeGCw8LO_A@mail.gmail.com>
Subject: Re: Upgrade when !ap_request_has_body(r) only for 2.4.18? (was: svn
 commit: r1718595 - /httpd/httpd/branches/2.4.x/STATUS)
From: William A Rowe Jr <wrowe@rowe-clan.net>
To: httpd <dev@httpd.apache.org>
Content-Type: multipart/alternative; boundary=001a113f93beb76eac052663cd8a

--001a113f93beb76eac052663cd8a
Content-Type: text/plain; charset=UTF-8

On Tue, Dec 8, 2015 at 7:37 AM, Yann Ylavic <ylavic@apache.org> wrote:

> On Tue, Dec 8, 2015 at 2:30 PM,  <ylavic@apache.org> wrote:
> > Author: ylavic
> > Date: Tue Dec  8 13:30:30 2015
> > New Revision: 1718595
> >
> > URL: http://svn.apache.org/viewvc?rev=1718595&view=rev
> > Log:
> > Comment about ap_request_has_body() check for Upgrade.
> >
> > Modified:
> >     httpd/httpd/branches/2.4.x/STATUS
> >
> []
> >       trunk patch: http://svn.apache.org/r1717816
> >       +1: wrowe, icing
> > +     ylavic: how about adding !ap_request_has_body(r) to the test then?
>
> E.g. (on top of r1717816):
>
> Index: modules/ssl/ssl_engine_kernel.c
> ===================================================================
> --- modules/ssl/ssl_engine_kernel.c    (revision 1718341)
> +++ modules/ssl/ssl_engine_kernel.c    (working copy)
> @@ -252,7 +252,7 @@ int ssl_hook_ReadReq(request_rec *r)
>       * and OPTIONS * request processing is completed.
>       */
>      if (sc->enabled == SSL_ENABLED_OPTIONAL && !(sslconn && sslconn->ssl)
> -        && !r->main) {
> +            && ap_is_initial_req(r) && !ap_has_request_body(r)) {
>          apr_table_setn(r->headers_out, "Upgrade", "TLS/1.0, HTTP/1.1");
>          apr_table_mergen(r->headers_out, "Connection", "upgrade");
>      }
>
>
The problem is that you are disabling *advertising* of the protocol based
on the content of a request body.  *This* request isn't going to be the
target
of the user's advertisement, that applies to their *next* request.  It
doesn't
change what I think you meant to change.

On the next request, your patch disables the advertising in an OPTIONS *
request because you didn't send the first advertisement; that won't work
out.
You are also disabling per-context advertisement which is allowed by
RFC7230.
E.g. content under /cups/devices/ may actually have an SSLRequireSSL.  Right
now the 426 code path relies on advertising headers already being present.

We save lots of response bytes on kept-alive SSLEngine optional resources
by advertising less frequently as you suggest above, but we can't have an
_initial_req toggle without later re-injecting these into all 426 exception
paths,
per the upgrade required exception's definition.

The core Protocols API already suffers this problem, e.g. WebSockets.  They
may apply to all resources within /webapp/ but not to other resources on the
server, and the current API won't present the upgrade header in response to
the specific resources desired.

Since we have the read-ahead buffering already, I don't see a reason to
simply
disable it at this time, the patch to switch the sequence of 101 and 100
should
be straightforward.  Since we aren't converging quite yet on an API fix to
solve
this multifaceted case, I'll look at the simple fix within mod_ssl alone.
Since
the logic was valid under RFC2718/2616 I don't think we have to do a hard
stop
to fix such a bug for RFC7230 here today, but can incorporate such fixes in
2.4.19 soon.

Cheers,

Bill

--001a113f93beb76eac052663cd8a
Content-Type: text/html; charset=UTF-8
Content-Transfer-Encoding: quoted-printable

<div dir=3D"ltr"><div class=3D"gmail_extra"><div class=3D"gmail_quote">On T=
ue, Dec 8, 2015 at 7:37 AM, Yann Ylavic <span dir=3D"ltr">&lt;<a href=3D"ma=
ilto:ylavic@apache.org" target=3D"_blank">ylavic@apache.org</a>&gt;</span> =
wrote:<br><blockquote class=3D"gmail_quote" style=3D"margin:0px 0px 0px 0.8=
ex;border-left-width:1px;border-left-color:rgb(204,204,204);border-left-sty=
le:solid;padding-left:1ex">On Tue, Dec 8, 2015 at 2:30 PM,=C2=A0 &lt;<a hre=
f=3D"mailto:ylavic@apache.org" target=3D"_blank">ylavic@apache.org</a>&gt; =
wrote:<br>
&gt; Author: ylavic<br>
&gt; Date: Tue Dec=C2=A0 8 13:30:30 2015<br>
&gt; New Revision: 1718595<br>
&gt;<br>
&gt; URL: <a href=3D"http://svn.apache.org/viewvc?rev=3D1718595&amp;view=3D=
rev" rel=3D"noreferrer" target=3D"_blank">http://svn.apache.org/viewvc?rev=
=3D1718595&amp;view=3Drev</a><br>
&gt; Log:<br>
&gt; Comment about ap_request_has_body() check for Upgrade.<br>
&gt;<br>
&gt; Modified:<br>
&gt;=C2=A0 =C2=A0 =C2=A0httpd/httpd/branches/2.4.x/STATUS<br>
&gt;<br>
[]<br>
&gt;=C2=A0 =C2=A0 =C2=A0 =C2=A0trunk patch: <a href=3D"http://svn.apache.or=
g/r1717816" rel=3D"noreferrer" target=3D"_blank">http://svn.apache.org/r171=
7816</a><br>
&gt;=C2=A0 =C2=A0 =C2=A0 =C2=A0+1: wrowe, icing<br>
&gt; +=C2=A0 =C2=A0 =C2=A0ylavic: how about adding !ap_request_has_body(r) =
to the test then?<br>
<br>
E.g. (on top of r1717816):<br>
<br>
Index: modules/ssl/ssl_engine_kernel.c<br>
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D<br>
--- modules/ssl/ssl_engine_kernel.c=C2=A0 =C2=A0 (revision 1718341)<br>
+++ modules/ssl/ssl_engine_kernel.c=C2=A0 =C2=A0 (working copy)<br>
@@ -252,7 +252,7 @@ int ssl_hook_ReadReq(request_rec *r)<br>
=C2=A0 =C2=A0 =C2=A0 * and OPTIONS * request processing is completed.<br>
=C2=A0 =C2=A0 =C2=A0 */<br>
=C2=A0 =C2=A0 =C2=A0if (sc-&gt;enabled =3D=3D SSL_ENABLED_OPTIONAL &amp;&am=
p; !(sslconn &amp;&amp; sslconn-&gt;ssl)<br>
-=C2=A0 =C2=A0 =C2=A0 =C2=A0 &amp;&amp; !r-&gt;main) {<br>
+=C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 &amp;&amp; ap_is_initial_req(r) =
&amp;&amp; !ap_has_request_body(r)) {<br>
=C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0apr_table_setn(r-&gt;headers_out, &quot;U=
pgrade&quot;, &quot;TLS/1.0, HTTP/1.1&quot;);<br>
=C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0apr_table_mergen(r-&gt;headers_out, &quot=
;Connection&quot;, &quot;upgrade&quot;);<br>
=C2=A0 =C2=A0 =C2=A0}<br><br></blockquote><div><br></div><div>The problem i=
s that you are disabling *advertising* of the protocol based</div><div>on t=
he content of a request body. =C2=A0*This* request isn&#39;t going to be th=
e target</div><div>of the user&#39;s advertisement, that applies to their *=
next* request.=C2=A0 It doesn&#39;t</div><div>change what I think you meant=
 to change.</div><div><br></div><div>On the next request, your patch disabl=
es the advertising in an OPTIONS *</div><div>request because you didn&#39;t=
 send the first advertisement; that won&#39;t work out.</div><div>You are a=
lso disabling per-context advertisement which is allowed by RFC7230.</div><=
div>E.g. content under /cups/devices/ may actually have an SSLRequireSSL.=
=C2=A0 Right</div><div>now the 426 code path relies on advertising headers =
already being present.</div><div><br></div><div>We save lots of response by=
tes on kept-alive SSLEngine optional resources=C2=A0<br></div><div>by adver=
tising less frequently as you suggest above, but we can&#39;t have an=C2=A0=
</div><div>_initial_req toggle without later re-injecting these into all 42=
6 exception paths,</div><div>per the upgrade required exception&#39;s defin=
ition.</div><div><br></div><div>The core Protocols API already suffers this=
 problem, e.g. WebSockets.=C2=A0 They</div><div>may apply to all resources =
within /webapp/ but not to other resources on the</div><div>server, and the=
 current API won&#39;t present the upgrade header in response to</div><div>=
the specific resources desired.</div><div><br></div><div>Since we have the =
read-ahead buffering already, I don&#39;t see a reason to simply</div><div>=
disable it at this time, the patch to switch the sequence of 101 and 100 sh=
ould</div><div>be straightforward.=C2=A0 Since we aren&#39;t converging qui=
te yet on an API fix to solve</div><div>this multifaceted case, I&#39;ll lo=
ok at the simple fix within mod_ssl alone.=C2=A0 Since</div><div>the logic =
was valid under RFC2718/2616 I don&#39;t think we have to do a hard stop</d=
iv><div>to fix such a bug for RFC7230 here today, but can incorporate such =
fixes in</div><div>2.4.19 soon.</div><div><br></div><div>Cheers,</div><div>=
<br></div><div>Bill</div><div>=C2=A0</div></div><br></div></div>

--001a113f93beb76eac052663cd8a--

From dev-return-84971-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Tue Dec  8 14:39:14 2015
Return-Path: <dev-return-84971-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id B741610FA8
	for <apmail-httpd-dev-archive@www.apache.org>; Tue,  8 Dec 2015 14:39:14 +0000 (UTC)
Received: (qmail 37969 invoked by uid 500); 8 Dec 2015 14:39:14 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 37546 invoked by uid 500); 8 Dec 2015 14:39:14 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 37536 invoked by uid 99); 8 Dec 2015 14:39:14 -0000
Received: from Unknown (HELO spamd4-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 08 Dec 2015 14:39:14 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd4-us-west.apache.org (ASF Mail Server at spamd4-us-west.apache.org) with ESMTP id BC961C094F
	for <dev@httpd.apache.org>; Tue,  8 Dec 2015 14:39:13 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd4-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.375
X-Spam-Level:
X-Spam-Status: No, score=-0.375 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	PLING_QUERY=0.279, RP_MATCHES_RCVD=-0.554, SPF_PASS=-0.001,
	URIBL_BLOCKED=0.001] autolearn=disabled
Authentication-Results: spamd4-us-west.apache.org (amavisd-new);
	dkim=pass (1024-bit key) header.d=greenbytes.de
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd4-us-west.apache.org [10.40.0.11]) (amavisd-new, port 10024)
	with ESMTP id 6T2Al8Oi2ZvF for <dev@httpd.apache.org>;
	Tue,  8 Dec 2015 14:39:08 +0000 (UTC)
Received: from mail.greenbytes.de (mail.greenbytes.de [217.91.35.233])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id A418B42ABE
	for <dev@httpd.apache.org>; Tue,  8 Dec 2015 14:39:07 +0000 (UTC)
Received: from [192.168.1.42] (unknown [217.91.35.233])
	(using TLSv1 with cipher ECDHE-RSA-AES256-SHA (256/256 bits))
	(Client did not present a certificate)
	by mail.greenbytes.de (Postfix) with ESMTPSA id EE01015A043A
	for <dev@httpd.apache.org>; Tue,  8 Dec 2015 15:34:05 +0100 (CET)
DKIM-Signature: v=1; a=rsa-sha256; c=simple/simple; d=greenbytes.de; s=mail;
	t=1449585245; bh=atCMXsLEfP3vrUoknl8pPoLYlCd16Nx2jbkg2lFGYIg=;
	h=Subject:From:In-Reply-To:Date:References:To:From;
	b=bnAfWuZUlbCsdbD1wZaRY8hdAiUsKAY842UMG0UT9hHxbzYvfSAGrQeLm5YmfALF9
	 k+4JV+E2PbesGr991gqEpp39pRSSCmYkhDF6U3lNWOQ6M1vjvHmeShY9H6ZsFKDiBD
	 09x1aRaWUXJJJdaf6MXJ13q2iG9ZRkZB0+bBhRms=
Content-Type: text/plain; charset=us-ascii
Mime-Version: 1.0 (Mac OS X Mail 9.1 \(3096.5\))
Subject: Re: Upgrade when !ap_request_has_body(r) only for 2.4.18? (was: svn commit: r1718595 - /httpd/httpd/branches/2.4.x/STATUS)
From: Stefan Eissing <stefan.eissing@greenbytes.de>
In-Reply-To: <CACsi250ihFv=N3s0u+7KwK1z67ekiHSMQwABBZddeeGCw8LO_A@mail.gmail.com>
Date: Tue, 8 Dec 2015 15:34:05 +0100
Content-Transfer-Encoding: quoted-printable
Message-Id: <3E14E6D3-A26D-45DF-B415-679E49D98B6F@greenbytes.de>
References: <CAKQ1sVOFVO9dxgncH2txe3qbuT46c9O=h1T2djBzfRVmH64m_Q@mail.gmail.com> <CACsi250ihFv=N3s0u+7KwK1z67ekiHSMQwABBZddeeGCw8LO_A@mail.gmail.com>
To: dev@httpd.apache.org
X-Mailer: Apple Mail (2.3096.5)

+1 for deferring any upgrade changes that do not fix real issues - like =
the one proposed for backport by Bill - to 2.4.19

> Am 08.12.2015 um 15:29 schrieb William A Rowe Jr =
<wrowe@rowe-clan.net>:
>=20
> On Tue, Dec 8, 2015 at 7:37 AM, Yann Ylavic <ylavic@apache.org> wrote:
> On Tue, Dec 8, 2015 at 2:30 PM,  <ylavic@apache.org> wrote:
> > Author: ylavic
> > Date: Tue Dec  8 13:30:30 2015
> > New Revision: 1718595
> >
> > URL: http://svn.apache.org/viewvc?rev=3D1718595&view=3Drev
> > Log:
> > Comment about ap_request_has_body() check for Upgrade.
> >
> > Modified:
> >     httpd/httpd/branches/2.4.x/STATUS
> >
> []
> >       trunk patch: http://svn.apache.org/r1717816
> >       +1: wrowe, icing
> > +     ylavic: how about adding !ap_request_has_body(r) to the test =
then?
>=20
> E.g. (on top of r1717816):
>=20
> Index: modules/ssl/ssl_engine_kernel.c
> =3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D
> --- modules/ssl/ssl_engine_kernel.c    (revision 1718341)
> +++ modules/ssl/ssl_engine_kernel.c    (working copy)
> @@ -252,7 +252,7 @@ int ssl_hook_ReadReq(request_rec *r)
>       * and OPTIONS * request processing is completed.
>       */
>      if (sc->enabled =3D=3D SSL_ENABLED_OPTIONAL && !(sslconn && =
sslconn->ssl)
> -        && !r->main) {
> +            && ap_is_initial_req(r) && !ap_has_request_body(r)) {
>          apr_table_setn(r->headers_out, "Upgrade", "TLS/1.0, =
HTTP/1.1");
>          apr_table_mergen(r->headers_out, "Connection", "upgrade");
>      }
>=20
>=20
> The problem is that you are disabling *advertising* of the protocol =
based
> on the content of a request body.  *This* request isn't going to be =
the target
> of the user's advertisement, that applies to their *next* request.  It =
doesn't
> change what I think you meant to change.
>=20
> On the next request, your patch disables the advertising in an OPTIONS =
*
> request because you didn't send the first advertisement; that won't =
work out.
> You are also disabling per-context advertisement which is allowed by =
RFC7230.
> E.g. content under /cups/devices/ may actually have an SSLRequireSSL.  =
Right
> now the 426 code path relies on advertising headers already being =
present.
>=20
> We save lots of response bytes on kept-alive SSLEngine optional =
resources=20
> by advertising less frequently as you suggest above, but we can't have =
an=20
> _initial_req toggle without later re-injecting these into all 426 =
exception paths,
> per the upgrade required exception's definition.
>=20
> The core Protocols API already suffers this problem, e.g. WebSockets.  =
They
> may apply to all resources within /webapp/ but not to other resources =
on the
> server, and the current API won't present the upgrade header in =
response to
> the specific resources desired.
>=20
> Since we have the read-ahead buffering already, I don't see a reason =
to simply
> disable it at this time, the patch to switch the sequence of 101 and =
100 should
> be straightforward.  Since we aren't converging quite yet on an API =
fix to solve
> this multifaceted case, I'll look at the simple fix within mod_ssl =
alone.  Since
> the logic was valid under RFC2718/2616 I don't think we have to do a =
hard stop
> to fix such a bug for RFC7230 here today, but can incorporate such =
fixes in
> 2.4.19 soon.
>=20
> Cheers,
>=20
> Bill


From dev-return-84972-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Tue Dec  8 15:19:55 2015
Return-Path: <dev-return-84972-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 27F01181A9
	for <apmail-httpd-dev-archive@www.apache.org>; Tue,  8 Dec 2015 15:19:55 +0000 (UTC)
Received: (qmail 35517 invoked by uid 500); 8 Dec 2015 15:19:49 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 35446 invoked by uid 500); 8 Dec 2015 15:19:49 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 35436 invoked by uid 99); 8 Dec 2015 15:19:49 -0000
Received: from Unknown (HELO spamd3-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 08 Dec 2015 15:19:49 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd3-us-west.apache.org (ASF Mail Server at spamd3-us-west.apache.org) with ESMTP id 36C8F180428
	for <dev@httpd.apache.org>; Tue,  8 Dec 2015 15:19:49 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd3-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 3.259
X-Spam-Level: ***
X-Spam-Status: No, score=3.259 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, HTML_MESSAGE=3,
	PLING_QUERY=0.279, RCVD_IN_MSPIKE_H3=-0.01, RCVD_IN_MSPIKE_WL=-0.01,
	SPF_PASS=-0.001, URIBL_BLOCKED=0.001] autolearn=disabled
Authentication-Results: spamd3-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=rowe-clan-net.20150623.gappssmtp.com
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd3-us-west.apache.org [10.40.0.10]) (amavisd-new, port 10024)
	with ESMTP id BLRL2JJuvq8x for <dev@httpd.apache.org>;
	Tue,  8 Dec 2015 15:19:43 +0000 (UTC)
Received: from mail-ig0-f179.google.com (mail-ig0-f179.google.com [209.85.213.179])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id C7245428ED
	for <dev@httpd.apache.org>; Tue,  8 Dec 2015 15:19:42 +0000 (UTC)
Received: by igvg19 with SMTP id g19so103391158igv.1
        for <dev@httpd.apache.org>; Tue, 08 Dec 2015 07:18:57 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=rowe-clan-net.20150623.gappssmtp.com; s=20150623;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        bh=aE2HtcAzxwet8RpaCU2uFpQxmLByxmJH/wHpMePuBVM=;
        b=ANArSKPVbAi19JhxcJrcy9B0sAahBX649l0OZltd73H5AiGEhJrn+S5RPlJMCqRu3O
         LG7Oh9xwayciTlx3XQMNzDvtH7j/FDx+Qcp8Y7Ov2KrVPL0fItS/MoptJUHUJjvNZVLr
         lzG/WJeEVvHdu2z49NnOJK/3yb4nDHwXqf7rerVvibpH0xC+EIFpDjGVsTnrp97e/86A
         /gse+W5/axXoa62LDoQmNtCU1crs00xzIXWnWv5anL1b3XrWphcDDLjygJNbIoX/Nn+D
         hGBqpGw7ITP7Z6wxc7viSOXQBxkADDdqKNViQPpqVAA0/le5i3TBEis3I5a6Tq9tmMXW
         di4Q==
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=1e100.net; s=20130820;
        h=x-gm-message-state:mime-version:in-reply-to:references:date
         :message-id:subject:from:to:content-type;
        bh=aE2HtcAzxwet8RpaCU2uFpQxmLByxmJH/wHpMePuBVM=;
        b=U5Gtq4g8bTJFOHdH0wYGUdKpBPagzZy0JQC7EO78PW9JcVh0JMiSnZpHoQSRGprpCh
         6GDbO4BQMkmNm7ANUJXvk3fgHOYifM7bOk19I46dE0fMjxNTQtgu5JCF+GuqI5epvymy
         hxq0/ll1VS/YvqbcZxCbZnK1Tc1uIrXeFFEJZ1gKfV1Exxr+scCdGZUe+LBluuzwKugo
         DSpQuhEFB+n26cCTW5k8rNWYCcMiB4TUq6Ba6KbSxOnT7/bisYRRIUeqcUPs+POgDPV9
         IdGyAb40LmLZTYXFu5KfE6DYmnce+Y3/vfwLkHz4wzivRrQodWlXhWCjMvtPHSabZPNk
         GRBA==
X-Gm-Message-State: ALoCoQlCWwxohkgaP1lnuS5BavrGY4v0XfDbg9/c85Xuj8t4i6oFk9YPoE4XqT0YJ4cnuH+kxG0hwPlo//I9Mz/NUIW7SQ3UZA0RnnZGlqmJKd4HMIOVg+E=
MIME-Version: 1.0
X-Received: by 10.50.142.7 with SMTP id rs7mr23332558igb.35.1449587937159;
 Tue, 08 Dec 2015 07:18:57 -0800 (PST)
Received: by 10.107.62.136 with HTTP; Tue, 8 Dec 2015 07:18:57 -0800 (PST)
In-Reply-To: <3E14E6D3-A26D-45DF-B415-679E49D98B6F@greenbytes.de>
References: <CAKQ1sVOFVO9dxgncH2txe3qbuT46c9O=h1T2djBzfRVmH64m_Q@mail.gmail.com>
	<CACsi250ihFv=N3s0u+7KwK1z67ekiHSMQwABBZddeeGCw8LO_A@mail.gmail.com>
	<3E14E6D3-A26D-45DF-B415-679E49D98B6F@greenbytes.de>
Date: Tue, 8 Dec 2015 09:18:57 -0600
Message-ID: <CACsi251EEs0KVzfbcVb5y088RYOv23RQ7=6Noz3hfHL6QsBCsA@mail.gmail.com>
Subject: Re: Upgrade when !ap_request_has_body(r) only for 2.4.18? (was: svn
 commit: r1718595 - /httpd/httpd/branches/2.4.x/STATUS)
From: William A Rowe Jr <wrowe@rowe-clan.net>
To: httpd <dev@httpd.apache.org>
Content-Type: multipart/alternative; boundary=001a11c2eb5a10d1e10526647e9b

--001a11c2eb5a10d1e10526647e9b
Content-Type: text/plain; charset=UTF-8

On Tue, Dec 8, 2015 at 8:34 AM, Stefan Eissing <stefan.eissing@greenbytes.de
> wrote:

> +1 for deferring any upgrade changes that do not fix real issues - like
> the one proposed for backport by Bill - to 2.4.19
>

Agreed, as spelled out in my top-post, simplest path to 2.4.18, and these
interesting discussions over the past day point to no single simple path.

Note that the pre-patch behavior caused tls to overwrite h2c, now the
protocol
API will overwrite tls upgrade advertisements on the first trip through.

Does it make sense to @bug the new Protocol API's stating that these
remain experimental and still subject to change, and refer prospective
developer/consumers to dev@httpd?  It seems something will change
in a later 2.4 release, and its simply a matter of what is the appropriate
straight path that can satisfy all of the prospective upgrade consumers.

--001a11c2eb5a10d1e10526647e9b
Content-Type: text/html; charset=UTF-8
Content-Transfer-Encoding: quoted-printable

<div dir=3D"ltr"><div class=3D"gmail_extra"><div class=3D"gmail_quote">On T=
ue, Dec 8, 2015 at 8:34 AM, Stefan Eissing <span dir=3D"ltr">&lt;<a href=3D=
"mailto:stefan.eissing@greenbytes.de" target=3D"_blank">stefan.eissing@gree=
nbytes.de</a>&gt;</span> wrote:<br><blockquote class=3D"gmail_quote" style=
=3D"margin:0 0 0 .8ex;border-left:1px #ccc solid;padding-left:1ex">+1 for d=
eferring any upgrade changes that do not fix real issues - like the one pro=
posed for backport by Bill - to 2.4.19<br>
<div class=3D"HOEnZb"><div class=3D"h5"></div></div></blockquote></div><br>=
</div><div class=3D"gmail_extra">Agreed, as spelled out in my top-post, sim=
plest path to 2.4.18, and these</div><div class=3D"gmail_extra">interesting=
 discussions over the past day point to no single simple path.</div><div cl=
ass=3D"gmail_extra"><br></div><div class=3D"gmail_extra">Note that the pre-=
patch behavior caused tls to overwrite h2c, now the protocol</div><div clas=
s=3D"gmail_extra">API will overwrite tls upgrade advertisements on the firs=
t trip through.</div><div class=3D"gmail_extra"><br></div><div class=3D"gma=
il_extra">Does it make sense to @bug the new Protocol API&#39;s stating tha=
t these</div><div class=3D"gmail_extra">remain experimental and still subje=
ct to change, and refer prospective=C2=A0</div><div class=3D"gmail_extra">d=
eveloper/consumers to dev@httpd?=C2=A0 It seems something will change</div>=
<div class=3D"gmail_extra">in a later 2.4 release, and its simply a matter =
of what is the appropriate</div><div class=3D"gmail_extra">straight path th=
at can satisfy all of the prospective upgrade consumers.</div><div class=3D=
"gmail_extra"><br></div><div class=3D"gmail_extra"><br></div></div>

--001a11c2eb5a10d1e10526647e9b--

From dev-return-84973-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Tue Dec  8 15:21:45 2015
Return-Path: <dev-return-84973-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 1603C181B9
	for <apmail-httpd-dev-archive@www.apache.org>; Tue,  8 Dec 2015 15:21:45 +0000 (UTC)
Received: (qmail 42293 invoked by uid 500); 8 Dec 2015 15:21:44 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 42213 invoked by uid 500); 8 Dec 2015 15:21:44 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 42203 invoked by uid 99); 8 Dec 2015 15:21:44 -0000
Received: from Unknown (HELO spamd3-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 08 Dec 2015 15:21:44 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd3-us-west.apache.org (ASF Mail Server at spamd3-us-west.apache.org) with ESMTP id 27C70180428
	for <dev@httpd.apache.org>; Tue,  8 Dec 2015 15:21:44 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd3-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.374
X-Spam-Level:
X-Spam-Status: No, score=-0.374 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	PLING_QUERY=0.279, RP_MATCHES_RCVD=-0.554, URIBL_BLOCKED=0.001]
	autolearn=disabled
Authentication-Results: spamd3-us-west.apache.org (amavisd-new);
	dkim=pass (1024-bit key) header.d=greenbytes.de
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd3-us-west.apache.org [10.40.0.10]) (amavisd-new, port 10024)
	with ESMTP id n9FhmlesqDLK for <dev@httpd.apache.org>;
	Tue,  8 Dec 2015 15:21:33 +0000 (UTC)
Received: from mail.greenbytes.de (mail.greenbytes.de [217.91.35.233])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id 02AFC42ADE
	for <dev@httpd.apache.org>; Tue,  8 Dec 2015 15:21:33 +0000 (UTC)
Received: from [192.168.1.42] (unknown [217.91.35.233])
	(using TLSv1 with cipher ECDHE-RSA-AES256-SHA (256/256 bits))
	(Client did not present a certificate)
	by mail.greenbytes.de (Postfix) with ESMTPSA id EEF4C15A049C
	for <dev@httpd.apache.org>; Tue,  8 Dec 2015 16:21:31 +0100 (CET)
DKIM-Signature: v=1; a=rsa-sha256; c=simple/simple; d=greenbytes.de; s=mail;
	t=1449588091; bh=SBWFrGPQKrF0S2y4C7K4oQxZJQ6c+zL0Y7bIJZw/NJ8=;
	h=Subject:From:In-Reply-To:Date:References:To:From;
	b=p0MHwT0w7ikd2jp9z2IoAWeYMW3Qu+JxqHdGpHDFjv9uzTLYS4JuJCGRuF4FW+D5r
	 zKpCpcEgwAI83QiFAjelQts6B9O4xo1vSTyF+ewKHy2isApaZ0q6DOiPgw3Un2oRoM
	 c/MQYw1vXUsCcYsujuemei3ypzGC0mk02SvsUKBU=
Content-Type: text/plain; charset=us-ascii
Mime-Version: 1.0 (Mac OS X Mail 9.1 \(3096.5\))
Subject: Re: Upgrade when !ap_request_has_body(r) only for 2.4.18? (was: svn commit: r1718595 - /httpd/httpd/branches/2.4.x/STATUS)
From: Stefan Eissing <stefan.eissing@greenbytes.de>
In-Reply-To: <CACsi251EEs0KVzfbcVb5y088RYOv23RQ7=6Noz3hfHL6QsBCsA@mail.gmail.com>
Date: Tue, 8 Dec 2015 16:21:31 +0100
Content-Transfer-Encoding: quoted-printable
Message-Id: <99C24AE9-2819-43B8-BAA4-9B956A0EAA68@greenbytes.de>
References: <CAKQ1sVOFVO9dxgncH2txe3qbuT46c9O=h1T2djBzfRVmH64m_Q@mail.gmail.com> <CACsi250ihFv=N3s0u+7KwK1z67ekiHSMQwABBZddeeGCw8LO_A@mail.gmail.com> <3E14E6D3-A26D-45DF-B415-679E49D98B6F@greenbytes.de> <CACsi251EEs0KVzfbcVb5y088RYOv23RQ7=6Noz3hfHL6QsBCsA@mail.gmail.com>
To: dev@httpd.apache.org
X-Mailer: Apple Mail (2.3096.5)


> Am 08.12.2015 um 16:18 schrieb William A Rowe Jr =
<wrowe@rowe-clan.net>:
>=20
> On Tue, Dec 8, 2015 at 8:34 AM, Stefan Eissing =
<stefan.eissing@greenbytes.de> wrote:
> +1 for deferring any upgrade changes that do not fix real issues - =
like the one proposed for backport by Bill - to 2.4.19
>=20
> Agreed, as spelled out in my top-post, simplest path to 2.4.18, and =
these
> interesting discussions over the past day point to no single simple =
path.
>=20
> Note that the pre-patch behavior caused tls to overwrite h2c, now the =
protocol
> API will overwrite tls upgrade advertisements on the first trip =
through.
>=20
> Does it make sense to @bug the new Protocol API's stating that these
> remain experimental and still subject to change, and refer prospective=20=

> developer/consumers to dev@httpd?  It seems something will change
> in a later 2.4 release, and its simply a matter of what is the =
appropriate
> straight path that can satisfy all of the prospective upgrade =
consumers.

+1


From dev-return-84974-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Tue Dec  8 15:36:17 2015
Return-Path: <dev-return-84974-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 344261824C
	for <apmail-httpd-dev-archive@www.apache.org>; Tue,  8 Dec 2015 15:36:17 +0000 (UTC)
Received: (qmail 73777 invoked by uid 500); 8 Dec 2015 15:36:16 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 73695 invoked by uid 500); 8 Dec 2015 15:36:16 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 73685 invoked by uid 99); 8 Dec 2015 15:36:16 -0000
Received: from Unknown (HELO spamd4-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 08 Dec 2015 15:36:16 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd4-us-west.apache.org (ASF Mail Server at spamd4-us-west.apache.org) with ESMTP id CB872C0052
	for <dev@httpd.apache.org>; Tue,  8 Dec 2015 15:36:15 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd4-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 2.999
X-Spam-Level: **
X-Spam-Status: No, score=2.999 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, HTML_MESSAGE=3,
	RCVD_IN_MSPIKE_H2=-0.001, SPF_PASS=-0.001, URIBL_BLOCKED=0.001]
	autolearn=disabled
Authentication-Results: spamd4-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=rowe-clan-net.20150623.gappssmtp.com
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd4-us-west.apache.org [10.40.0.11]) (amavisd-new, port 10024)
	with ESMTP id SHcjOx4Rcyxx for <dev@httpd.apache.org>;
	Tue,  8 Dec 2015 15:36:09 +0000 (UTC)
Received: from mail-io0-f173.google.com (mail-io0-f173.google.com [209.85.223.173])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id 6D86842ACE
	for <dev@httpd.apache.org>; Tue,  8 Dec 2015 15:36:09 +0000 (UTC)
Received: by iofh3 with SMTP id h3so27659539iof.3
        for <dev@httpd.apache.org>; Tue, 08 Dec 2015 07:31:08 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=rowe-clan-net.20150623.gappssmtp.com; s=20150623;
        h=mime-version:date:message-id:subject:from:to:content-type;
        bh=49VddMGtTP5JBZ6jFbFZnGxSVRlgAtnnvW97v1+E8mg=;
        b=TWL3/8iEWLS3W/5A/q15yKtXjEDG7vrGD7NzcyB/98vLmrCrIDw3M2iVxsfhVR0MQl
         WileLfmPiIPyja72md4B9DryrLTUQpQN9DRRgeHfz3eLipO/CXtY/w72gnT2lzSDbip4
         XuAhBgGHK1xG94dGzeR6Y1VVvv9KGia3jiXsJpOPQH03wi05LNev1zNRlzbt4744YTmM
         /XZ/hnU7bUacDMX8KstW4NyBhNkh0kTzPZPmwmyi75IuwIi9OuO3jHkhi99v1D7T+KnJ
         yqHOm3wfmwm1W6vw0xto1t/BvTsyEipqONz4vufU1xvBepZb5aEAGLCffGo7QsL4fIQU
         5a4A==
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=1e100.net; s=20130820;
        h=x-gm-message-state:mime-version:date:message-id:subject:from:to
         :content-type;
        bh=49VddMGtTP5JBZ6jFbFZnGxSVRlgAtnnvW97v1+E8mg=;
        b=PupKzYUj/Ysi5FPQE1KRVFEEiousDP2qfktOTwUTxiFBeP3A+mVSxuxVKrF3e6YSwu
         htst6geswKKxewlf/FUJYWyRQosAn31yu3qTgo/IUK0EKAVB1ofbOh22KGV0m338MLMq
         ou8ufLbdZm74JVa6XtXmpTwrIMNusX5/Bmh0+xc6L47oGOQMapuZ6usSpb8whvYLTKM5
         /1ptOR4GY/pi+fnSbjy1l0vKoo9+FT3KQTgsX+dDLReV/SMxkIYEEPYrrfo5kFKq3cmH
         X4Xqss0AviGrjDCUUeh/3cF8gUHTT6VNrFPXvKM29oJxWLDDvy0FAnv0qTq80w9q6jqc
         fqfg==
X-Gm-Message-State: ALoCoQn18JZGam6HsBdWmL+H3H0Qoo2Y9ngkTLm7TSRK31e37n5bXlzx+gvuaE5cKebzvAGYBHGIpEHYajc6qZoO29/cs4K7vo9te7HAp81Py0M+Fmv7O3c=
MIME-Version: 1.0
X-Received: by 10.107.25.83 with SMTP id 80mr437793ioz.163.1449588667919; Tue,
 08 Dec 2015 07:31:07 -0800 (PST)
Received: by 10.107.62.136 with HTTP; Tue, 8 Dec 2015 07:31:07 -0800 (PST)
Date: Tue, 8 Dec 2015 09:31:07 -0600
Message-ID: <CACsi250Djh9jiFwV55eYTdnQgi1eJcVvQi_FZFY9NPY7cuzWPA@mail.gmail.com>
Subject: Protocol API @bug warnings for 2.4.18?
From: William A Rowe Jr <wrowe@rowe-clan.net>
To: httpd <dev@httpd.apache.org>
Content-Type: multipart/mixed; boundary=001a113fdbb49f9c14052664a995

--001a113fdbb49f9c14052664a995
Content-Type: multipart/alternative; boundary=001a113fdbb49f9c10052664a993

--001a113fdbb49f9c10052664a993
Content-Type: text/plain; charset=UTF-8

On Tue, Dec 8, 2015 at 9:21 AM, Stefan Eissing <stefan.eissing@greenbytes.de
> wrote:

>
> > On Tue, Dec 8, 2015 at 8:34 AM, Stefan Eissing <
> stefan.eissing@greenbytes.de> wrote:
> > +1 for deferring any upgrade changes
> >
> > Agreed, as spelled out in my top-post, simplest path to 2.4.18, and these
> > interesting discussions over the past day point to no single simple path.
> >
> > Does it make sense to @bug the new Protocol API's stating that these
> > remain experimental and still subject to change, and refer prospective
> > developer/consumers to dev@httpd?  It seems something will change
> > in a later 2.4 release, and its simply a matter of what is the
> appropriate
> > straight path that can satisfy all of the prospective upgrade consumers.
>
> +1
>

Something like the attached?  Edits/suggestions welcome.

--001a113fdbb49f9c10052664a993
Content-Type: text/html; charset=UTF-8
Content-Transfer-Encoding: quoted-printable

<div dir=3D"ltr"><div class=3D"gmail_extra"><div class=3D"gmail_quote">On T=
ue, Dec 8, 2015 at 9:21 AM, Stefan Eissing <span dir=3D"ltr">&lt;<a href=3D=
"mailto:stefan.eissing@greenbytes.de" target=3D"_blank">stefan.eissing@gree=
nbytes.de</a>&gt;</span> wrote:<br><blockquote class=3D"gmail_quote" style=
=3D"margin:0 0 0 .8ex;border-left:1px #ccc solid;padding-left:1ex"><div cla=
ss=3D"HOEnZb"><div class=3D"h5"><br>&gt; On Tue, Dec 8, 2015 at 8:34 AM, St=
efan Eissing &lt;<a href=3D"mailto:stefan.eissing@greenbytes.de">stefan.eis=
sing@greenbytes.de</a>&gt; wrote:<br>
&gt; +1 for deferring any upgrade changes<br>
&gt;<br>
&gt; Agreed, as spelled out in my top-post, simplest path to 2.4.18, and th=
ese<br>
&gt; interesting discussions over the past day point to no single simple pa=
th.<br>
&gt;<br>&gt; Does it make sense to @bug the new Protocol API&#39;s stating =
that these<br>
&gt; remain experimental and still subject to change, and refer prospective=
<br>
&gt; developer/consumers to dev@httpd?=C2=A0 It seems something will change=
<br>
&gt; in a later 2.4 release, and its simply a matter of what is the appropr=
iate<br>
&gt; straight path that can satisfy all of the prospective upgrade consumer=
s.<br>
<br>
</div></div>+1<br></blockquote><div><br></div><div>Something like the attac=
hed?=C2=A0 Edits/suggestions welcome.</div><div><br></div><div><br></div><d=
iv><br></div><div>=C2=A0</div></div><br></div></div>

--001a113fdbb49f9c10052664a993--
--001a113fdbb49f9c14052664a995
Content-Type: text/x-patch; charset=US-ASCII; 
	name="httpd24-experimental-protocol-api.patch"
Content-Disposition: attachment; 
	filename="httpd24-experimental-protocol-api.patch"
Content-Transfer-Encoding: base64
X-Attachment-Id: f_ihxjnv7j0

SW5kZXg6IGluY2x1ZGUvaHR0cF9wcm90b2NvbC5oCj09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KLS0tIGluY2x1ZGUvaHR0
cF9wcm90b2NvbC5oCShyZXZpc2lvbiAxNzE4NjMxKQorKysgaW5jbHVkZS9odHRwX3Byb3RvY29s
LmgJKHdvcmtpbmcgY29weSkKQEAgLTczNiw2ICs3MzYsMTAgQEAKICAqICAgICAgICAgICAgICAg
TlVMTCB0byBpbmRpY2F0ZWQgdGhhdCB0aGUgaG9va3MgYXJlIGZyZWUgdG8gcHJvcG9zZSAKICAq
IEBwYXJhbSBwcm9wb3NhbHMgVGhlIGxpc3Qgb2YgcHJvdG9jb2wgaWRlbnRpZmllcnMgcHJvcG9z
ZWQgYnkgdGhlIGhvb2tzCiAgKiBAcmV0dXJuIE9LIG9yIERFQ0xJTkVECisgKiBAYnVnIFRoaXMg
QVBJIG9yIGltcGxlbWVudGF0aW9uIGFuZCBvcmRlciBvZiBvcGVyYXRpb25zIHNob3VsZCBiZSBj
b25zaWRlcmVkCisgKiBleHBlcmltZW50YWwgYW5kIHdpbGwgY29udGludWUgdG8gZXZvbHZlIGlu
IGZ1dHVyZSAyLjQgcmVsZWFzZXMsIHdpdGgKKyAqIGEgY29ycmVzcG9uZGluZyBtaW5vciBtb2R1
bGUgbWFnaWMgbnVtYmVyIChNTU4pIGJ1bXAgdG8gaW5kaWNhdGUgdGhlCisgKiBBUEkgcmV2aXNp
b24gbGV2ZWwuCiAgKi8KIEFQX0RFQ0xBUkVfSE9PSyhpbnQscHJvdG9jb2xfcHJvcG9zZSwoY29u
bl9yZWMgKmMsIHJlcXVlc3RfcmVjICpyLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICBzZXJ2ZXJfcmVjICpzLApAQCAtNzY1LDYgKzc2OSwxMCBAQAogICogQHBhcmFtIGNo
b2ljZXMgQSBsaXN0IG9mIHByb3RvY29sIGlkZW50aWZpZXJzLCBub3JtYWxseSB0aGUgY2xpZW50
cyB3aGlzaGVzCiAgKiBAcGFyYW0gcHJvcG9zYWxzIHRoZSBsaXN0IG9mIHByb3RvY29sIGlkZW50
aWZpZXJzIHByb3Bvc2VkIGJ5IHRoZSBob29rcwogICogQHJldHVybiBPSyBvciBERUNMSU5FRAor
ICogQGJ1ZyBUaGlzIEFQSSBvciBpbXBsZW1lbnRhdGlvbiBhbmQgb3JkZXIgb2Ygb3BlcmF0aW9u
cyBzaG91bGQgYmUgY29uc2lkZXJlZAorICogZXhwZXJpbWVudGFsIGFuZCB3aWxsIGNvbnRpbnVl
IHRvIGV2b2x2ZSBpbiBmdXR1cmUgMi40IHJlbGVhc2VzLCB3aXRoCisgKiBhIGNvcnJlc3BvbmRp
bmcgbWlub3IgbW9kdWxlIG1hZ2ljIG51bWJlciAoTU1OKSBidW1wIHRvIGluZGljYXRlIHRoZQor
ICogQVBJIHJldmlzaW9uIGxldmVsLgogICovCiBBUF9ERUNMQVJFX0hPT0soaW50LHByb3RvY29s
X3N3aXRjaCwoY29ubl9yZWMgKmMsIHJlcXVlc3RfcmVjICpyLAogICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgIHNlcnZlcl9yZWMgKnMsCkBAIC03ODAsNiArNzg4LDEwIEBACiAg
KgogICogQHBhcmFtIGMgVGhlIGN1cnJlbnQgY29ubmVjdGlvbgogICogQHJldHVybiBUaGUgaWRl
bnRpZmllciBvZiB0aGUgcHJvdG9jb2wgaW4gcGxhY2Ugb3IgTlVMTAorICogQGJ1ZyBUaGlzIEFQ
SSBvciBpbXBsZW1lbnRhdGlvbiBhbmQgb3JkZXIgb2Ygb3BlcmF0aW9ucyBzaG91bGQgYmUgY29u
c2lkZXJlZAorICogZXhwZXJpbWVudGFsIGFuZCB3aWxsIGNvbnRpbnVlIHRvIGV2b2x2ZSBpbiBm
dXR1cmUgMi40IHJlbGVhc2VzLCB3aXRoCisgKiBhIGNvcnJlc3BvbmRpbmcgbWlub3IgbW9kdWxl
IG1hZ2ljIG51bWJlciAoTU1OKSBidW1wIHRvIGluZGljYXRlIHRoZQorICogQVBJIHJldmlzaW9u
IGxldmVsLgogICovCiBBUF9ERUNMQVJFX0hPT0soY29uc3QgY2hhciAqLHByb3RvY29sX2dldCwo
Y29uc3QgY29ubl9yZWMgKmMpKQogCkBAIC03OTgsNiArODEwLDEwIEBACiAgKiBAcGFyYW0gcmVw
b3J0X2FsbCBpbmNsdWRlIGFsc28gcHJvdG9jb2xzIGxlc3MgcHJlZmVycmVkIHRoYW4gdGhlIGN1
cnJlbnQgb25lCiAgKiBAcGFyYW0gcHVwZ3JhZGVzIG9uIHJldHVybiwgcG9zc2libGUgcHJvdG9j
b2xzIHRvIHVwZ3JhZGUgdG8gaW4gZGVzY2VuZGluZyBvcmRlciAKICAqICAgICAgICAgICAgICAg
ICBvZiBwcmVmZXJlbmNlLiBNYXliZSBOVUxMIGlmIG5vbmUgYXJlIGF2YWlsYWJsZS4gICAgCisg
KiBAYnVnIFRoaXMgQVBJIG9yIGltcGxlbWVudGF0aW9uIGFuZCBvcmRlciBvZiBvcGVyYXRpb25z
IHNob3VsZCBiZSBjb25zaWRlcmVkCisgKiBleHBlcmltZW50YWwgYW5kIHdpbGwgY29udGludWUg
dG8gZXZvbHZlIGluIGZ1dHVyZSAyLjQgcmVsZWFzZXMsIHdpdGgKKyAqIGEgY29ycmVzcG9uZGlu
ZyBtaW5vciBtb2R1bGUgbWFnaWMgbnVtYmVyIChNTU4pIGJ1bXAgdG8gaW5kaWNhdGUgdGhlCisg
KiBBUEkgcmV2aXNpb24gbGV2ZWwuCiAgKi8KIEFQX0RFQ0xBUkUoYXByX3N0YXR1c190KSBhcF9n
ZXRfcHJvdG9jb2xfdXBncmFkZXMoY29ubl9yZWMgKmMsIHJlcXVlc3RfcmVjICpyLCAKICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VydmVyX3JlYyAq
cywgaW50IHJlcG9ydF9hbGwsIApAQCAtODE3LDYgKzgzMywxMCBAQAogICogQHBhcmFtIHMgVGhl
IHNlcnZlci92aXJ0dWFsIGhvc3Qgc2VsZWN0ZWQKICAqIEBwYXJhbSBjaG9pY2VzIEEgbGlzdCBv
ZiBwcm90b2NvbCBpZGVudGlmaWVycywgbm9ybWFsbHkgdGhlIGNsaWVudHMgd2hpc2hlcwogICog
QHJldHVybiBUaGUgc2VsZWN0ZWQgcHJvdG9jb2wgb3IgTlVMTCBpZiBubyBwcm90b2NvbCBjb3Vs
ZCBiZSBhZ3JlZWQgdXBvbgorICogQGJ1ZyBUaGlzIEFQSSBvciBpbXBsZW1lbnRhdGlvbiBhbmQg
b3JkZXIgb2Ygb3BlcmF0aW9ucyBzaG91bGQgYmUgY29uc2lkZXJlZAorICogZXhwZXJpbWVudGFs
IGFuZCB3aWxsIGNvbnRpbnVlIHRvIGV2b2x2ZSBpbiBmdXR1cmUgMi40IHJlbGVhc2VzLCB3aXRo
CisgKiBhIGNvcnJlc3BvbmRpbmcgbWlub3IgbW9kdWxlIG1hZ2ljIG51bWJlciAoTU1OKSBidW1w
IHRvIGluZGljYXRlIHRoZQorICogQVBJIHJldmlzaW9uIGxldmVsLgogICovCiBBUF9ERUNMQVJF
KGNvbnN0IGNoYXIgKikgYXBfc2VsZWN0X3Byb3RvY29sKGNvbm5fcmVjICpjLCByZXF1ZXN0X3Jl
YyAqciwgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlcnZl
cl9yZWMgKnMsCkBAIC04MzUsNiArODU1LDEwIEBACiAgKiAgICAgICAgIEFQUl9FSU5WQUwsICBp
ZiB0aGUgcHJvdG9jb2wgaXMgYWxyZWFkeSBpbiBwbGFjZQogICogICAgICAgICBBUFJfTk9USU1Q
TCwgaWYgbm8gbW9kdWxlIHBlcmZvcm1lZCB0aGUgc3dpdGNoCiAgKiAgICAgICAgIE90aGVyIGVy
cm9ycyB3aGVyZSBhcHByb3ByaWF0ZQorICogQGJ1ZyBUaGlzIEFQSSBvciBpbXBsZW1lbnRhdGlv
biBhbmQgb3JkZXIgb2Ygb3BlcmF0aW9ucyBzaG91bGQgYmUgY29uc2lkZXJlZAorICogZXhwZXJp
bWVudGFsIGFuZCB3aWxsIGNvbnRpbnVlIHRvIGV2b2x2ZSBpbiBmdXR1cmUgMi40IHJlbGVhc2Vz
LCB3aXRoCisgKiBhIGNvcnJlc3BvbmRpbmcgbWlub3IgbW9kdWxlIG1hZ2ljIG51bWJlciAoTU1O
KSBidW1wIHRvIGluZGljYXRlIHRoZQorICogQVBJIHJldmlzaW9uIGxldmVsLgogICovCiBBUF9E
RUNMQVJFKGFwcl9zdGF0dXNfdCkgYXBfc3dpdGNoX3Byb3RvY29sKGNvbm5fcmVjICpjLCByZXF1
ZXN0X3JlYyAqciwgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
IHNlcnZlcl9yZWMgKnMsCkBAIC04NTAsNiArODc0LDEwIEBACiAgKgogICogQHBhcmFtIGMgVGhl
IGNvbm5lY3Rpb24gdG8gZGV0ZXJtaW5lIHRoZSBwcm90b2NvbCBmb3IKICAqIEByZXR1cm4gdGhl
IHByb3RvY29sIGluIHVzZSwgbmV2ZXIgTlVMTAorICogQGJ1ZyBUaGlzIEFQSSBvciBpbXBsZW1l
bnRhdGlvbiBhbmQgb3JkZXIgb2Ygb3BlcmF0aW9ucyBzaG91bGQgYmUgY29uc2lkZXJlZAorICog
ZXhwZXJpbWVudGFsIGFuZCB3aWxsIGNvbnRpbnVlIHRvIGV2b2x2ZSBpbiBmdXR1cmUgMi40IHJl
bGVhc2VzLCB3aXRoCisgKiBhIGNvcnJlc3BvbmRpbmcgbWlub3IgbW9kdWxlIG1hZ2ljIG51bWJl
ciAoTU1OKSBidW1wIHRvIGluZGljYXRlIHRoZQorICogQVBJIHJldmlzaW9uIGxldmVsLgogICov
CiBBUF9ERUNMQVJFKGNvbnN0IGNoYXIgKikgYXBfZ2V0X3Byb3RvY29sKGNvbm5fcmVjICpjKTsK
IApAQCAtODY2LDYgKzg5NCwxMCBAQAogICogQHBhcmFtIHMgVGhlIHNlcnZlci92aXJ0dWFsIGhv
c3Qgc2VsZWN0ZWQgb3IgTlVMTAogICogQHBhcmFtIHByb3RvY29sIHRoZSBwcm90b2NvbCB0byBz
d2l0Y2ggdG8KICAqIEByZXR1cm4gIT0gMCBpZmYgcHJvdG9jb2wgaXMgYWxsb3dlZAorICogQGJ1
ZyBUaGlzIEFQSSBvciBpbXBsZW1lbnRhdGlvbiBhbmQgb3JkZXIgb2Ygb3BlcmF0aW9ucyBzaG91
bGQgYmUgY29uc2lkZXJlZAorICogZXhwZXJpbWVudGFsIGFuZCB3aWxsIGNvbnRpbnVlIHRvIGV2
b2x2ZSBpbiBmdXR1cmUgMi40IHJlbGVhc2VzLCB3aXRoCisgKiBhIGNvcnJlc3BvbmRpbmcgbWlu
b3IgbW9kdWxlIG1hZ2ljIG51bWJlciAoTU1OKSBidW1wIHRvIGluZGljYXRlIHRoZQorICogQVBJ
IHJldmlzaW9uIGxldmVsLgogICovCiBBUF9ERUNMQVJFKGludCkgYXBfaXNfYWxsb3dlZF9wcm90
b2NvbChjb25uX3JlYyAqYywgcmVxdWVzdF9yZWMgKnIsCiAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICBzZXJ2ZXJfcmVjICpzLCBjb25zdCBjaGFyICpwcm90b2NvbCk7Cg==
--001a113fdbb49f9c14052664a995--

From dev-return-84975-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Tue Dec  8 15:36:30 2015
Return-Path: <dev-return-84975-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 83D0518254
	for <apmail-httpd-dev-archive@www.apache.org>; Tue,  8 Dec 2015 15:36:30 +0000 (UTC)
Received: (qmail 74818 invoked by uid 500); 8 Dec 2015 15:36:30 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 74745 invoked by uid 500); 8 Dec 2015 15:36:30 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 74735 invoked by uid 99); 8 Dec 2015 15:36:30 -0000
Received: from Unknown (HELO spamd3-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 08 Dec 2015 15:36:30 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd3-us-west.apache.org (ASF Mail Server at spamd3-us-west.apache.org) with ESMTP id 95A19180428
	for <dev@httpd.apache.org>; Tue,  8 Dec 2015 15:36:29 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd3-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 0.931
X-Spam-Level:
X-Spam-Status: No, score=0.931 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, PLING_QUERY=0.279,
	SPF_NEUTRAL=0.652] autolearn=disabled
Authentication-Results: spamd3-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=comcast.net
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd3-us-west.apache.org [10.40.0.10]) (amavisd-new, port 10024)
	with ESMTP id cSpsuAh3jYhq for <dev@httpd.apache.org>;
	Tue,  8 Dec 2015 15:36:22 +0000 (UTC)
Received: from resqmta-ch2-06v.sys.comcast.net (resqmta-ch2-06v.sys.comcast.net [69.252.207.38])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id C292724DB9
	for <dev@httpd.apache.org>; Tue,  8 Dec 2015 15:36:21 +0000 (UTC)
Received: from resomta-ch2-04v.sys.comcast.net ([69.252.207.100])
	by resqmta-ch2-06v.sys.comcast.net with comcast
	id r3aT1r0012AWL2D013cERP; Tue, 08 Dec 2015 15:36:14 +0000
Received: from [192.168.199.10] ([69.251.84.114])
	by resomta-ch2-04v.sys.comcast.net with comcast
	id r3cD1r00M2U0RYt013cDuc; Tue, 08 Dec 2015 15:36:14 +0000
Content-Type: text/plain; charset=us-ascii
Mime-Version: 1.0 (Mac OS X Mail 9.1 \(3096.5\))
Subject: Re: Upgrade when !ap_request_has_body(r) only for 2.4.18? (was: svn commit: r1718595 - /httpd/httpd/branches/2.4.x/STATUS)
From: Jim Jagielski <jim@jaguNET.com>
In-Reply-To: <99C24AE9-2819-43B8-BAA4-9B956A0EAA68@greenbytes.de>
Date: Tue, 8 Dec 2015 10:36:13 -0500
Content-Transfer-Encoding: 7bit
Message-Id: <E024E897-EEFC-445C-8F45-78942E6A4324@jaguNET.com>
References: <CAKQ1sVOFVO9dxgncH2txe3qbuT46c9O=h1T2djBzfRVmH64m_Q@mail.gmail.com> <CACsi250ihFv=N3s0u+7KwK1z67ekiHSMQwABBZddeeGCw8LO_A@mail.gmail.com> <3E14E6D3-A26D-45DF-B415-679E49D98B6F@greenbytes.de> <CACsi251EEs0KVzfbcVb5y088RYOv23RQ7=6Noz3hfHL6QsBCsA@mail.gmail.com> <99C24AE9-2819-43B8-BAA4-9B956A0EAA68@greenbytes.de>
To: dev@httpd.apache.org
X-Mailer: Apple Mail (2.3096.5)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=comcast.net;
	s=q20140121; t=1449588974;
	bh=YgLnQtUFsQBZepqarcSTVhqXMKWv+/gEoSmMd0GTgsg=;
	h=Received:Received:Content-Type:Mime-Version:Subject:From:Date:
	 Message-Id:To;
	b=ArjMN2hvn+BZsjV4GlzKHvxHeObMJK15/usZXMTr5V6Y81pPNQYNM1lGbPUaiuyC8
	 68L4f1CMLI09vYtQHH5eQUhpFi6pfOJbdrnO0Sh8zmRYKjs17X6l95WQzfFJiMjYsh
	 q3J+3+i52d3tpxMyWHmFUu/Lf/gMNCp8xuPtHNBn7xUcMkdmkdkmqIqbBmReI4dGgw
	 JSpP0B2F9OhotKEtx/CsqG3I1D1qdLPjKsczX0NotJEbZhvPEaPVEdeOSynVz2DElt
	 9ZGGIVeog1cTTDvUxY9s7bYa0EiWO7AAIFDeQcaEo2PGugtIly3dPbVKQqZU9DYInB
	 wUp3gp9+kc1Lw==

So what is current (r1718631) is likely what will be tagged and rolled
and, assuming enuff +1s, released.

From dev-return-84976-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Tue Dec  8 15:44:55 2015
Return-Path: <dev-return-84976-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id F1071182B6
	for <apmail-httpd-dev-archive@www.apache.org>; Tue,  8 Dec 2015 15:44:54 +0000 (UTC)
Received: (qmail 95014 invoked by uid 500); 8 Dec 2015 15:44:49 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 94941 invoked by uid 500); 8 Dec 2015 15:44:49 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 94931 invoked by uid 99); 8 Dec 2015 15:44:49 -0000
Received: from Unknown (HELO spamd4-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 08 Dec 2015 15:44:49 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd4-us-west.apache.org (ASF Mail Server at spamd4-us-west.apache.org) with ESMTP id 1D140C06D6
	for <dev@httpd.apache.org>; Tue,  8 Dec 2015 15:44:49 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd4-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.654
X-Spam-Level:
X-Spam-Status: No, score=-0.654 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RP_MATCHES_RCVD=-0.554, SPF_PASS=-0.001, URIBL_BLOCKED=0.001]
	autolearn=disabled
Authentication-Results: spamd4-us-west.apache.org (amavisd-new);
	dkim=pass (1024-bit key) header.d=greenbytes.de
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd4-us-west.apache.org [10.40.0.11]) (amavisd-new, port 10024)
	with ESMTP id 5XU8Nm3EemJa for <dev@httpd.apache.org>;
	Tue,  8 Dec 2015 15:44:41 +0000 (UTC)
Received: from mail.greenbytes.de (mail.greenbytes.de [217.91.35.233])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id C018D20B91
	for <dev@httpd.apache.org>; Tue,  8 Dec 2015 15:44:40 +0000 (UTC)
Received: from [192.168.1.42] (unknown [217.91.35.233])
	(using TLSv1 with cipher ECDHE-RSA-AES256-SHA (256/256 bits))
	(Client did not present a certificate)
	by mail.greenbytes.de (Postfix) with ESMTPSA id BCD7915A0098
	for <dev@httpd.apache.org>; Tue,  8 Dec 2015 16:44:03 +0100 (CET)
DKIM-Signature: v=1; a=rsa-sha256; c=simple/simple; d=greenbytes.de; s=mail;
	t=1449589443; bh=mqRq2HatLHDkU3Fp0N2w15MS0pC1WO8//FWD3CebFCg=;
	h=Subject:From:In-Reply-To:Date:References:To:From;
	b=hZYadjKH6GKvDP9tFX9Zdk90+0DS5mIap5ugFLq9HIV6Ts/FhNzKwH9lSLejQb3yq
	 q8zjeF4/xbXP/fn6irPdDVlb+QOu35TWtme+SsrlfdBUUPIkyCJ459qv8hrEzEJQrc
	 xe2NSVPjMxeqoTXoy/Jn3WhMFkNYXxaK6uz9j7zY=
Content-Type: text/plain; charset=us-ascii
Mime-Version: 1.0 (Mac OS X Mail 9.1 \(3096.5\))
Subject: Re: Protocol API @bug warnings for 2.4.18?
From: Stefan Eissing <stefan.eissing@greenbytes.de>
In-Reply-To: <CACsi250Djh9jiFwV55eYTdnQgi1eJcVvQi_FZFY9NPY7cuzWPA@mail.gmail.com>
Date: Tue, 8 Dec 2015 16:44:03 +0100
Content-Transfer-Encoding: quoted-printable
Message-Id: <BFC8BF18-5E31-4612-9FD6-FD149EA8AC3A@greenbytes.de>
References: <CACsi250Djh9jiFwV55eYTdnQgi1eJcVvQi_FZFY9NPY7cuzWPA@mail.gmail.com>
To: dev@httpd.apache.org
X-Mailer: Apple Mail (2.3096.5)

+1 Fine by me.

> Am 08.12.2015 um 16:31 schrieb William A Rowe Jr =
<wrowe@rowe-clan.net>:
>=20
> On Tue, Dec 8, 2015 at 9:21 AM, Stefan Eissing =
<stefan.eissing@greenbytes.de> wrote:
>=20
> > On Tue, Dec 8, 2015 at 8:34 AM, Stefan Eissing =
<stefan.eissing@greenbytes.de> wrote:
> > +1 for deferring any upgrade changes
> >
> > Agreed, as spelled out in my top-post, simplest path to 2.4.18, and =
these
> > interesting discussions over the past day point to no single simple =
path.
> >
> > Does it make sense to @bug the new Protocol API's stating that these
> > remain experimental and still subject to change, and refer =
prospective
> > developer/consumers to dev@httpd?  It seems something will change
> > in a later 2.4 release, and its simply a matter of what is the =
appropriate
> > straight path that can satisfy all of the prospective upgrade =
consumers.
>=20
> +1
>=20
> Something like the attached?  Edits/suggestions welcome.
>=20
>=20
>=20
> =20
>=20
> <httpd24-experimental-protocol-api.patch>


From dev-return-84977-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Tue Dec  8 15:52:59 2015
Return-Path: <dev-return-84977-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 67F01182F0
	for <apmail-httpd-dev-archive@www.apache.org>; Tue,  8 Dec 2015 15:52:59 +0000 (UTC)
Received: (qmail 16383 invoked by uid 500); 8 Dec 2015 15:52:58 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 16305 invoked by uid 500); 8 Dec 2015 15:52:58 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 16295 invoked by uid 99); 8 Dec 2015 15:52:58 -0000
Received: from Unknown (HELO spamd4-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 08 Dec 2015 15:52:58 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd4-us-west.apache.org (ASF Mail Server at spamd4-us-west.apache.org) with ESMTP id 57154C0052
	for <dev@httpd.apache.org>; Tue,  8 Dec 2015 15:52:58 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd4-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 0.178
X-Spam-Level:
X-Spam-Status: No, score=0.178 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	PLING_QUERY=0.279, RCVD_IN_MSPIKE_H2=-0.001, SPF_PASS=-0.001,
	URIBL_BLOCKED=0.001] autolearn=disabled
Authentication-Results: spamd4-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd4-us-west.apache.org [10.40.0.11]) (amavisd-new, port 10024)
	with ESMTP id F9VZ4IJ9wmHK for <dev@httpd.apache.org>;
	Tue,  8 Dec 2015 15:52:52 +0000 (UTC)
Received: from mail-qg0-f45.google.com (mail-qg0-f45.google.com [209.85.192.45])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id 9E85D42BB8
	for <dev@httpd.apache.org>; Tue,  8 Dec 2015 15:52:52 +0000 (UTC)
Received: by qgcc31 with SMTP id c31so21915195qgc.3
        for <dev@httpd.apache.org>; Tue, 08 Dec 2015 07:52:52 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=mime-version:date:message-id:subject:from:to:content-type;
        bh=AhogEdfmkcy8dXH8fltwjkNzsiMFuqm86qV8haR+YQA=;
        b=Bt2IdioNrWIVHiIxuxVJSA3FfZE6NR0f0PoEIkoQX04Uu//IsFVSVkkLHBBvmNm33+
         YAiH4YrtEHpXL9MQ3aWIm87xrGDcLi9ND+pOgBkHokofgqkAu2I5L8VV2p/i45e1bXiN
         vRBnWyCkPD/ZOsPehFKoPle9oUom73NQEsxqZ05PtSbcwEE6GogOMkm4KLmC4bYzM7HM
         OJ1zyzfIFdRrZqlR31ppuKWv//SCN14rptZ9FaInvXgDzLLvJ8fyzc42F9fIU6kRQfCR
         ife2zVGOuC+RHNrE+hRvc/NYnyJpOhb0DRbz98BrMZScAJ4gLK+6xAX4+fUYsQ+0oljQ
         qgkA==
MIME-Version: 1.0
X-Received: by 10.140.101.51 with SMTP id t48mr291444qge.71.1449589970961;
 Tue, 08 Dec 2015 07:52:50 -0800 (PST)
Received: by 10.55.65.85 with HTTP; Tue, 8 Dec 2015 07:52:50 -0800 (PST)
Date: Tue, 8 Dec 2015 16:52:50 +0100
Message-ID: <CAKQ1sVOuWpCdaLW+j0pJhyMMu+XpWr5Tw1Lw5abM+BOa=xV6rA@mail.gmail.com>
Subject: Re: Upgrade when !ap_request_has_body(r) only? (was: for 2.4.18)
From: Yann Ylavic <ylavic.dev@gmail.com>
To: httpd-dev <dev@httpd.apache.org>
Content-Type: text/plain; charset=UTF-8

On Tue, Dec 8, 2015 at 3:29 PM, William A Rowe Jr <wrowe@rowe-clan.net> wrote:
> On Tue, Dec 8, 2015 at 7:37 AM, Yann Ylavic <ylavic@apache.org> wrote:
>>
>> E.g. (on top of r1717816):
>
> The problem is that you are disabling *advertising* of the protocol based
> on the content of a request body.  *This* request isn't going to be the
> target
> of the user's advertisement, that applies to their *next* request.  It
> doesn't
> change what I think you meant to change.

Yes, you are right, the real Upgrade is done above, so when we are
here we just prepare the response headers.
Let's think/agree more about how to handle Upgrades in the next release(s).

Regards,
Yann.

From dev-return-84978-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Tue Dec  8 15:58:42 2015
Return-Path: <dev-return-84978-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 332FA18317
	for <apmail-httpd-dev-archive@www.apache.org>; Tue,  8 Dec 2015 15:58:42 +0000 (UTC)
Received: (qmail 31699 invoked by uid 500); 8 Dec 2015 15:58:32 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 31613 invoked by uid 500); 8 Dec 2015 15:58:32 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 31603 invoked by uid 99); 8 Dec 2015 15:58:32 -0000
Received: from Unknown (HELO spamd1-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 08 Dec 2015 15:58:32 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd1-us-west.apache.org (ASF Mail Server at spamd1-us-west.apache.org) with ESMTP id CE2DEC892C
	for <dev@httpd.apache.org>; Tue,  8 Dec 2015 15:58:31 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd1-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.1
X-Spam-Level:
X-Spam-Status: No, score=-0.1 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	SPF_PASS=-0.001, URIBL_BLOCKED=0.001] autolearn=disabled
Authentication-Results: spamd1-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd1-us-west.apache.org [10.40.0.7]) (amavisd-new, port 10024)
	with ESMTP id OkZ--LSYz0cI for <dev@httpd.apache.org>;
	Tue,  8 Dec 2015 15:58:23 +0000 (UTC)
Received: from mail-qg0-f42.google.com (mail-qg0-f42.google.com [209.85.192.42])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id 49B9642ACE
	for <dev@httpd.apache.org>; Tue,  8 Dec 2015 15:58:23 +0000 (UTC)
Received: by qgec40 with SMTP id c40so21870665qge.2
        for <dev@httpd.apache.org>; Tue, 08 Dec 2015 07:53:15 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        bh=5R4H71ViVN7QL2I4nGAoMUN5/3gv54SzXSnNpzuVS1c=;
        b=POiuRS+azdu1c/0bnoxpemUZsbI6xv/jtLdLtyd9x44fg4ozga6m/MqFV+pAzsfolq
         KZvuKfqtqB85eMQMuQBzzjxOtugxlRmqTcLNycFepO5LtdAecTpU4PCdO1IhXE3m3egr
         ZquKEuAtSOj1g+UhLMUHquUNTK5Dueog+INRVEMyukdjLfxd0sdUVywo07V2SGxLLKNE
         GqreBZpU39DxAd4p6P/9EoOxUSy3RmH5AM9gOL/jHkCOYSGViscm0c2BL4aeYypygL0A
         fUbXqvRzjojJ5e+/nH0rYuF0VPTFxvRo2bS8mV/V0Q3iwy2R7y/8bu6SoyO62rpClDg2
         +Nxg==
MIME-Version: 1.0
X-Received: by 10.140.251.215 with SMTP id w206mr5347425qhc.73.1449589995196;
 Tue, 08 Dec 2015 07:53:15 -0800 (PST)
Received: by 10.55.65.85 with HTTP; Tue, 8 Dec 2015 07:53:15 -0800 (PST)
In-Reply-To: <CACsi250Djh9jiFwV55eYTdnQgi1eJcVvQi_FZFY9NPY7cuzWPA@mail.gmail.com>
References: <CACsi250Djh9jiFwV55eYTdnQgi1eJcVvQi_FZFY9NPY7cuzWPA@mail.gmail.com>
Date: Tue, 8 Dec 2015 16:53:15 +0100
Message-ID: <CAKQ1sVOAiqxaK+crF1aTjUjyVew6G6H+MZ54Kre7wpsEbAMg3Q@mail.gmail.com>
Subject: Re: Protocol API @bug warnings for 2.4.18?
From: Yann Ylavic <ylavic.dev@gmail.com>
To: httpd-dev <dev@httpd.apache.org>
Content-Type: text/plain; charset=UTF-8

On Tue, Dec 8, 2015 at 4:31 PM, William A Rowe Jr <wrowe@rowe-clan.net> wrote:
> On Tue, Dec 8, 2015 at 9:21 AM, Stefan Eissing
> <stefan.eissing@greenbytes.de> wrote:
>>
>>
>> > On Tue, Dec 8, 2015 at 8:34 AM, Stefan Eissing
>> > <stefan.eissing@greenbytes.de> wrote:
>> > +1 for deferring any upgrade changes
>> >
>> > Agreed, as spelled out in my top-post, simplest path to 2.4.18, and
>> > these
>> > interesting discussions over the past day point to no single simple
>> > path.
>> >
>> > Does it make sense to @bug the new Protocol API's stating that these
>> > remain experimental and still subject to change, and refer prospective
>> > developer/consumers to dev@httpd?  It seems something will change
>> > in a later 2.4 release, and its simply a matter of what is the
>> > appropriate
>> > straight path that can satisfy all of the prospective upgrade consumers.
>>
>> +1
>
>
> Something like the attached?  Edits/suggestions welcome.

+1, we discussed this already for 2.4.17 but it did not make its way.
Thanks for doing it.

From dev-return-84979-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Tue Dec  8 16:12:47 2015
Return-Path: <dev-return-84979-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 46CFA183D5
	for <apmail-httpd-dev-archive@www.apache.org>; Tue,  8 Dec 2015 16:12:47 +0000 (UTC)
Received: (qmail 73172 invoked by uid 500); 8 Dec 2015 16:12:43 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 73089 invoked by uid 500); 8 Dec 2015 16:12:43 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 73079 invoked by uid 99); 8 Dec 2015 16:12:43 -0000
Received: from Unknown (HELO spamd3-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 08 Dec 2015 16:12:43 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd3-us-west.apache.org (ASF Mail Server at spamd3-us-west.apache.org) with ESMTP id 36366180428
	for <dev@httpd.apache.org>; Tue,  8 Dec 2015 16:12:43 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd3-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 0.178
X-Spam-Level:
X-Spam-Status: No, score=0.178 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	PLING_QUERY=0.279, RCVD_IN_MSPIKE_H2=-0.001, SPF_PASS=-0.001,
	URIBL_BLOCKED=0.001] autolearn=disabled
Authentication-Results: spamd3-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd3-us-west.apache.org [10.40.0.10]) (amavisd-new, port 10024)
	with ESMTP id M_xbiGgz2kpR for <dev@httpd.apache.org>;
	Tue,  8 Dec 2015 16:12:37 +0000 (UTC)
Received: from mail-qg0-f44.google.com (mail-qg0-f44.google.com [209.85.192.44])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id BC78E42AEE
	for <dev@httpd.apache.org>; Tue,  8 Dec 2015 16:12:36 +0000 (UTC)
Received: by qgec40 with SMTP id c40so22768296qge.2
        for <dev@httpd.apache.org>; Tue, 08 Dec 2015 08:11:51 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        bh=FNGJ46hioNveijJyfkfBMsWhH+QoH0sHI0CLWIX1PHI=;
        b=wt0gzwPE7h5zx3DgcviiOl0WrisrcoTY0eYYjZJ1EyiWfF9geUKpfZTdEYw5YJzHtc
         4vVoqw29U0BbVBLX25okqS/Zf2JulMdjUn6plceOU/rSlncfoUAr/CKM4VBChstFIoV6
         4fbefcbkh39LUFO5PB4Qpx3OtQ0Nk/pSkzTKbcRV3SMDSYAlrGbJROOilD4OhnP4QTuN
         AwvNw+qV2+v8ljTi38XXCVtE37QqCXzEIB3Xmi535RfQ1CBz6L4eT0+1Sdj7lRwA9/F/
         Hw3R9Yp9A77Oq6/MyhxHinvsk6uE+r0segEJFHtmgIMPovlMkZ2SAaZWQFBf93kvqf9q
         sz0g==
MIME-Version: 1.0
X-Received: by 10.140.248.70 with SMTP id t67mr5399594qhc.97.1449591091420;
 Tue, 08 Dec 2015 08:11:31 -0800 (PST)
Received: by 10.55.65.85 with HTTP; Tue, 8 Dec 2015 08:11:31 -0800 (PST)
In-Reply-To: <D785F0D3-D690-4C18-8FD2-67ABACE8D730@jaguNET.com>
References: <CAKQ1sVNgj8M12Ye+PM+B8EPnFdDkcdELJ-Hbo34kquFXMj-Eyg@mail.gmail.com>
	<D785F0D3-D690-4C18-8FD2-67ABACE8D730@jaguNET.com>
Date: Tue, 8 Dec 2015 17:11:31 +0100
Message-ID: <CAKQ1sVOXOGXTxuGFUYZs_j4jnr2Ad_R0S2h44z963fbtULRjKw@mail.gmail.com>
Subject: Re: Upgrade when !ap_request_has_body(r) only for 2.4.18? (was: svn
 commit: r1718595 - /httpd/httpd/branches/2.4.x/STATUS)
From: Yann Ylavic <ylavic.dev@gmail.com>
To: httpd-dev <dev@httpd.apache.org>
Content-Type: text/plain; charset=UTF-8

On Tue, Dec 8, 2015 at 3:17 PM, Jim Jagielski <jim@jagunet.com> wrote:
> My only suggestion is that instead of willy-nilly suggesting
> patches that will be included in a release, that we actually take
> time to think of the correct patch, to implement it and TEST against
> it and only THEN have it backported.
>
> Please.

Suggestions have to start somewhere, I did not mean to rush on this,
just expecting feedbacks (including ones like yours, which is indeed
very sensible :)

My point was that if we were backport r1717816 in 2.4.18 (for OPTIONS
to work back), we needed more changes for RFC-compliance wrt TLS/1.x
Upgrades, the one w/o the other is not suitable.

So I think we all agree on the need to think/test more about this ;)

From dev-return-84980-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Tue Dec  8 16:56:55 2015
Return-Path: <dev-return-84980-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 98D47185E3
	for <apmail-httpd-dev-archive@www.apache.org>; Tue,  8 Dec 2015 16:56:55 +0000 (UTC)
Received: (qmail 32061 invoked by uid 500); 8 Dec 2015 16:56:55 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 31985 invoked by uid 500); 8 Dec 2015 16:56:55 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 31975 invoked by uid 99); 8 Dec 2015 16:56:55 -0000
Received: from Unknown (HELO spamd3-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 08 Dec 2015 16:56:55 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd3-us-west.apache.org (ASF Mail Server at spamd3-us-west.apache.org) with ESMTP id 99AF918028B
	for <dev@httpd.apache.org>; Tue,  8 Dec 2015 16:56:54 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd3-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 0.932
X-Spam-Level:
X-Spam-Status: No, score=0.932 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, PLING_QUERY=0.279,
	SPF_NEUTRAL=0.652, URIBL_BLOCKED=0.001] autolearn=disabled
Authentication-Results: spamd3-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=comcast.net
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd3-us-west.apache.org [10.40.0.10]) (amavisd-new, port 10024)
	with ESMTP id eJQdTCzr7zd9 for <dev@httpd.apache.org>;
	Tue,  8 Dec 2015 16:56:45 +0000 (UTC)
Received: from resqmta-ch2-05v.sys.comcast.net (resqmta-ch2-05v.sys.comcast.net [69.252.207.37])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id B536A44553
	for <dev@httpd.apache.org>; Tue,  8 Dec 2015 16:56:38 +0000 (UTC)
Received: from resomta-ch2-05v.sys.comcast.net ([69.252.207.101])
	by resqmta-ch2-05v.sys.comcast.net with comcast
	id r4qk1r0022Bo0NV014rQa2; Tue, 08 Dec 2015 16:51:24 +0000
Received: from [192.168.199.10] ([69.251.84.114])
	by resomta-ch2-05v.sys.comcast.net with comcast
	id r4rP1r00K2U0RYt014rPzS; Tue, 08 Dec 2015 16:51:24 +0000
Content-Type: text/plain; charset=us-ascii
Mime-Version: 1.0 (Mac OS X Mail 9.1 \(3096.5\))
Subject: Re: Upgrade when !ap_request_has_body(r) only for 2.4.18? (was: svn commit: r1718595 - /httpd/httpd/branches/2.4.x/STATUS)
From: Jim Jagielski <jim@jaguNET.com>
In-Reply-To: <CAKQ1sVOXOGXTxuGFUYZs_j4jnr2Ad_R0S2h44z963fbtULRjKw@mail.gmail.com>
Date: Tue, 8 Dec 2015 11:51:23 -0500
Content-Transfer-Encoding: 7bit
Message-Id: <A643E483-6806-45F8-AFAF-F84B5540D6A1@jaguNET.com>
References: <CAKQ1sVNgj8M12Ye+PM+B8EPnFdDkcdELJ-Hbo34kquFXMj-Eyg@mail.gmail.com> <D785F0D3-D690-4C18-8FD2-67ABACE8D730@jaguNET.com> <CAKQ1sVOXOGXTxuGFUYZs_j4jnr2Ad_R0S2h44z963fbtULRjKw@mail.gmail.com>
To: dev@httpd.apache.org
X-Mailer: Apple Mail (2.3096.5)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=comcast.net;
	s=q20140121; t=1449593484;
	bh=VWGovUFL711iZ0YljeBwCIIiZrxy7DH0jzsfshxMQfg=;
	h=Received:Received:Content-Type:Mime-Version:Subject:From:Date:
	 Message-Id:To;
	b=myaTufXM9/c3ik9y2nhuc/idXF0QFeYPqajNW8Ry7frc6SRrv/uPNgDkMOVG0Hp0k
	 OzsXHEjxuf/xXhAlmodoY3G22ufCciRRyhNaAL3ma0qF2RHDzbB9VikToFmIhIrNhz
	 NWGTwz6KvpludycTMnRrgv6gS86xpIas+IFfdCZ/gas/HoHgWAkA3FXPz8ghAsu0iJ
	 s4qdjV8A7jqZbwZlsOnEvKRiNkUU+TKzr+xfun6+Pn0bf0thdvDVPdNoyj7WlkTxoZ
	 IV+GwoVr5/XqtvhwBb/AcL8jp/qGe1QNVk2HqrW7GDwd++DaZMt9U223sMT5hvwWO+
	 3fS6dNFaBk4vw==


> On Dec 8, 2015, at 11:11 AM, Yann Ylavic <ylavic.dev@gmail.com> wrote:
> 
> On Tue, Dec 8, 2015 at 3:17 PM, Jim Jagielski <jim@jagunet.com> wrote:
>> My only suggestion is that instead of willy-nilly suggesting
>> patches that will be included in a release, that we actually take
>> time to think of the correct patch, to implement it and TEST against
>> it and only THEN have it backported.
>> 
>> Please.
> 
> Suggestions have to start somewhere, I did not mean to rush on this,
> just expecting feedbacks (including ones like yours, which is indeed
> very sensible :)
> 
> My point was that if we were backport r1717816 in 2.4.18 (for OPTIONS
> to work back), we needed more changes for RFC-compliance wrt TLS/1.x
> Upgrades, the one w/o the other is not suitable.
> 
> So I think we all agree on the need to think/test more about this ;)

Oh, agreed 100%.

From dev-return-84981-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Tue Dec  8 20:18:46 2015
Return-Path: <dev-return-84981-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id AAC441823C
	for <apmail-httpd-dev-archive@www.apache.org>; Tue,  8 Dec 2015 20:18:46 +0000 (UTC)
Received: (qmail 56470 invoked by uid 500); 8 Dec 2015 20:18:46 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 56388 invoked by uid 500); 8 Dec 2015 20:18:46 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 56378 invoked by uid 99); 8 Dec 2015 20:18:46 -0000
Received: from Unknown (HELO spamd3-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 08 Dec 2015 20:18:46 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd3-us-west.apache.org (ASF Mail Server at spamd3-us-west.apache.org) with ESMTP id B2522180A12
	for <dev@httpd.apache.org>; Tue,  8 Dec 2015 20:18:45 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd3-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.101
X-Spam-Level:
X-Spam-Status: No, score=-0.101 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RCVD_IN_MSPIKE_H2=-0.001] autolearn=disabled
Authentication-Results: spamd3-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd3-us-west.apache.org [10.40.0.10]) (amavisd-new, port 10024)
	with ESMTP id cJH5HcWTbKgL for <dev@httpd.apache.org>;
	Tue,  8 Dec 2015 20:18:39 +0000 (UTC)
Received: from mail-pf0-f181.google.com (mail-pf0-f181.google.com [209.85.192.181])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id E3CB920599
	for <dev@httpd.apache.org>; Tue,  8 Dec 2015 20:18:38 +0000 (UTC)
Received: by pfbg73 with SMTP id g73so17598489pfb.1
        for <dev@httpd.apache.org>; Tue, 08 Dec 2015 12:13:29 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=subject:to:references:from:message-id:date:user-agent:mime-version
         :in-reply-to:content-type:content-transfer-encoding;
        bh=i9tg3x6g+45h2W6E/giWgxxxvyn1vwxWFkAKZdOWDaA=;
        b=t46kQPfFdDh1cKnIEDsoHbaSp4Z9h1xIRymcXpFKQoODBcBDgZbeuifUa5bELmRhun
         NPGqD3ycVt5yaPNo8NGvZQmLfZ2FpuNIZCrJS57V7ngdjH2HehDR4SSud8M980cDMXgS
         PnjF5xMUx2oEDHRvJgZcs3JhpUjF0oWKYgrY4UKfjGVgROBWKF+Ow5+dA2F1oFIugrDq
         vGeBLd0XkTk5UbVaVFlQwontDfRD8seBUpf8ODT/uGkRXb2ShQBVbIFLIXO3tIPTB3Zi
         Sc6SdtWAUq5qN0KYBUmAbZ95P4CW9LmQOIAiWYJcCofWg62PJLX92GGkWs4glY0jM2W3
         cfJQ==
X-Received: by 10.98.14.8 with SMTP id w8mr7696625pfi.38.1449605608939;
        Tue, 08 Dec 2015 12:13:28 -0800 (PST)
Received: from [192.168.1.4] (50-39-117-165.bvtn.or.frontiernet.net. [50.39.117.165])
        by smtp.gmail.com with ESMTPSA id d14sm6539679pfj.4.2015.12.08.12.13.27
        for <dev@httpd.apache.org>
        (version=TLSv1/SSLv3 cipher=OTHER);
        Tue, 08 Dec 2015 12:13:27 -0800 (PST)
Subject: Re: 2.4 pause - mod_http2 patchset Upgrade h2c vs mod_ssl Upgradetls
To: dev@httpd.apache.org
References: <CACsi250=dbRQKnsbE8JSdAZRm5x99gE0sgX3iQ-PHAx77euD1A@mail.gmail.com>
 <AB1691BE05AE7F4992697F2A0835627AC63BAB94@VOEXM10W.internal.vodafone.com>
 <F7B20D30-D34A-4805-A77D-F64F6428F6E3@greenbytes.de>
 <56660896.c74fc20a.15f56.0ebd@mx.google.com> <56660B43.2060507@gmail.com>
 <6B13DF2B-0586-42BB-B62F-59A7638B697D@greenbytes.de>
From: Jacob Champion <champion.p@gmail.com>
Message-ID: <566739E6.6080003@gmail.com>
Date: Tue, 8 Dec 2015 12:13:26 -0800
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:38.0) Gecko/20100101
 Thunderbird/38.4.0
MIME-Version: 1.0
In-Reply-To: <6B13DF2B-0586-42BB-B62F-59A7638B697D@greenbytes.de>
Content-Type: text/plain; charset=windows-1252; format=flowed
Content-Transfer-Encoding: 7bit

On 12/08/2015 01:42 AM, Stefan Eissing wrote:
> If Apache accepts body lengths of up to 64KB (or something
> configurable) and some other server implements 8K and some third 1MB,
> how will that help design of a client that, for some reason, *wants*
> an upgrade to succeed?

I don't disagree with your premise, and I think that the zero-length 
body requirement is the correct thing to do for now. I will theorycraft 
in another email to the list.

--Jacob

From dev-return-84982-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Tue Dec  8 20:27:50 2015
Return-Path: <dev-return-84982-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 6F71F182B0
	for <apmail-httpd-dev-archive@www.apache.org>; Tue,  8 Dec 2015 20:27:50 +0000 (UTC)
Received: (qmail 90442 invoked by uid 500); 8 Dec 2015 20:27:50 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 90366 invoked by uid 500); 8 Dec 2015 20:27:50 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 90356 invoked by uid 99); 8 Dec 2015 20:27:49 -0000
Received: from Unknown (HELO spamd3-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 08 Dec 2015 20:27:49 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd3-us-west.apache.org (ASF Mail Server at spamd3-us-west.apache.org) with ESMTP id 6B02918027B
	for <dev@httpd.apache.org>; Tue,  8 Dec 2015 20:27:49 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd3-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.1
X-Spam-Level:
X-Spam-Status: No, score=-0.1 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1]
	autolearn=disabled
Authentication-Results: spamd3-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd3-us-west.apache.org [10.40.0.10]) (amavisd-new, port 10024)
	with ESMTP id 1-Bs0eAP9EV1 for <dev@httpd.apache.org>;
	Tue,  8 Dec 2015 20:27:35 +0000 (UTC)
Received: from mail-pa0-f47.google.com (mail-pa0-f47.google.com [209.85.220.47])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id 51D9244527
	for <dev@httpd.apache.org>; Tue,  8 Dec 2015 20:27:35 +0000 (UTC)
Received: by pacwq6 with SMTP id wq6so17110589pac.1
        for <dev@httpd.apache.org>; Tue, 08 Dec 2015 12:22:19 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=to:from:subject:message-id:date:user-agent:mime-version
         :content-type:content-transfer-encoding;
        bh=rU81bjg0vULoD8zTaXqwZgurVecD+QydZtuYiKkEoWw=;
        b=a4QjnlxEcKwc0wm4uqW8BjKygomVdgY/Uw8OZWybmQRySxnNANe3kMQOg9cBU3NsAP
         xUFAo4q/PrWwX+9fXOBZLkEM6fERJQqxhXeDLJt0UL3+Taztuy8wql1SACeqS/NXybMq
         CBrGN6Tv3C2JbjFmEG+sTo90niFAdJyUSID7UotzDBpGyMC8kY4ztIQGaEJqYXP5qdQV
         Oug/1hnhy+1B8QlTZ7QIN2dTHb/bT6ylzySlTKSyBap9VGEsFqRVlnOoTwjhxIHgHm/X
         uHSP4agaoGOezeayJGV9ZcwWhGr5ZNTeausYBKwYWoIvZ9RY8a2ZjcQnYtooR/HkPdR0
         G6Dg==
X-Received: by 10.66.240.4 with SMTP id vw4mr2652683pac.9.1449606139684;
        Tue, 08 Dec 2015 12:22:19 -0800 (PST)
Received: from [192.168.1.4] (50-39-117-165.bvtn.or.frontiernet.net. [50.39.117.165])
        by smtp.gmail.com with ESMTPSA id 13sm6538169pfp.68.2015.12.08.12.22.18
        for <dev@httpd.apache.org>
        (version=TLSv1/SSLv3 cipher=OTHER);
        Tue, 08 Dec 2015 12:22:18 -0800 (PST)
To: dev@httpd.apache.org
From: Jacob Champion <champion.p@gmail.com>
Subject: On the Upgrade request body limit
Message-ID: <56673BF9.8070507@gmail.com>
Date: Tue, 8 Dec 2015 12:22:17 -0800
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:38.0) Gecko/20100101
 Thunderbird/38.4.0
MIME-Version: 1.0
Content-Type: text/plain; charset=utf-8; format=flowed
Content-Transfer-Encoding: 7bit

I wrote this in response to Stefan's note on the zero-length request 
body limit for h2c Upgrades, then realized it would further fragment the 
(already massive) conversation, so here it is.

Stefan wrote:
> It is possible, but difficult to do unless you can read the body and
 > set it aside somewhere. Which again imposes an arbitrary (for the
 > client) limit. Experience shows that this leads to design of clients
 > that work will in developments, but then encounter requests
 > usage/sites/servers that have other limits and break.

This is true of other things about HTTP/1.1 too -- how does a client 
figure out what the maximum request size for a server is? -- but it's 
made harder in this case by the fact that

1) 100 Continue is sent whether the request is upgraded or not, which 
makes it impossible to use a continue handshake to quickly determine 
upgrade limits, and

2) returning 413 during an upgrade would be ambiguous anyway. Is the 413 
really related to the request target, or is it just because I tried to 
upgrade and my request was temporarily limited?

It seems to me that we're missing something in HTTP/1.1 that would make 
these complex Upgrade scenarios robust. IIUC, the point of allowing 
request bodies during upgrades was to decrease the number of round 
trips, but if implementations can't actually make use of it in practice 
then that's not very useful...

If it were enough of a problem to fix (and I'm not claiming it is, 
necessarily), how would we fix it? Would we need a new 1xx response 
(e.g. 103 Upgrade Declined, with headers indicating the related protocol 
and the reason for the failure)? A new header in OPTIONS? Something else 
entirely?

Or is the correct "fix" to rearchitect so the limit during upgrades can 
be exactly the same as during a normal request?

--Jacob

From dev-return-84983-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Tue Dec  8 20:38:57 2015
Return-Path: <dev-return-84983-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 259E61835B
	for <apmail-httpd-dev-archive@www.apache.org>; Tue,  8 Dec 2015 20:38:57 +0000 (UTC)
Received: (qmail 14691 invoked by uid 500); 8 Dec 2015 20:38:56 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 14610 invoked by uid 500); 8 Dec 2015 20:38:56 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 14466 invoked by uid 99); 8 Dec 2015 20:38:56 -0000
Received: from Unknown (HELO spamd2-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 08 Dec 2015 20:38:56 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd2-us-west.apache.org (ASF Mail Server at spamd2-us-west.apache.org) with ESMTP id 33F2A1A365B
	for <dev@httpd.apache.org>; Tue,  8 Dec 2015 20:38:56 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd2-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 0.652
X-Spam-Level:
X-Spam-Status: No, score=0.652 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, SPF_NEUTRAL=0.652]
	autolearn=disabled
Authentication-Results: spamd2-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=comcast.net
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd2-us-west.apache.org [10.40.0.9]) (amavisd-new, port 10024)
	with ESMTP id GzvvNoVycbFb for <dev@httpd.apache.org>;
	Tue,  8 Dec 2015 20:38:48 +0000 (UTC)
Received: from resqmta-ch2-06v.sys.comcast.net (resqmta-ch2-06v.sys.comcast.net [69.252.207.38])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id 84C3B42ABE
	for <dev@httpd.apache.org>; Tue,  8 Dec 2015 20:38:48 +0000 (UTC)
Received: from resomta-ch2-08v.sys.comcast.net ([69.252.207.104])
	by resqmta-ch2-06v.sys.comcast.net with comcast
	id r8cL1r0042Fh1PH018eian; Tue, 08 Dec 2015 20:38:42 +0000
Received: from [192.168.199.10] ([69.251.84.114])
	by resomta-ch2-08v.sys.comcast.net with comcast
	id r8eh1r00H2U0RYt018ehhu; Tue, 08 Dec 2015 20:38:42 +0000
From: Jim Jagielski <jim@jaguNET.com>
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
Subject: [VOTE] Release Apache httpd 2.4.18 as GA
Message-Id: <AD9BFA0F-C508-4DFE-8B4F-FF79D46D9D91@jaguNET.com>
Date: Tue, 8 Dec 2015 15:38:41 -0500
To: httpd <dev@httpd.apache.org>
Mime-Version: 1.0 (Mac OS X Mail 9.1 \(3096.5\))
X-Mailer: Apple Mail (2.3096.5)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=comcast.net;
	s=q20140121; t=1449607122;
	bh=01mCpY23GNU8rGx4yJ+ulVmJlw9BaYZp3439sn9EPKk=;
	h=Received:Received:From:Content-Type:Subject:Message-Id:Date:To:
	 Mime-Version;
	b=YdzUnNZQveyBKw4bPXc2ubbV0FVZeZ49rmcmbqd9ImjbaEKL6WDt+uRYceRO6ft7A
	 hL0H881UBfGPQ2vHnsBNiwBrat2ml4lji1pXfy00G0wg4TZenCUY/aKP9LBkfmo/AV
	 cuPo7E4Q4DLwEQm3KKV6mA5mPgfLTN4b2JOP73qVqO22YTpiw9EtSrzvp5LMZr03kW
	 cRILk4LHXvNYjS/0DtJJa3frW2QPl4iETrb5enSC1v0uSzpw9FilWPipwK/+M4q/63
	 0uUGT4yAlZD3KqRDo5jTckb4Qtt3lujmmHQFQtR/T7w8ivQZXhdufCm+RgrUPq1S68
	 WqKbz1zB6lQJQ==

The pre-release test tarballs for Apache httpd 2.4.18 can be found
at the usual place:

	http://httpd.apache.org/dev/dist/

I'm calling a VOTE on releasing these as Apache httpd 2.4.18 GA.

[ ] +1: Good to go
[ ] +0: meh
[ ] -1: Danger Will Robinson. And why.

Vote will last the normal 72 hrs.

NOTE: The *-deps are only there for convenience.

Thx!

From dev-return-84984-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Tue Dec  8 20:45:36 2015
Return-Path: <dev-return-84984-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 07A4F183A7
	for <apmail-httpd-dev-archive@www.apache.org>; Tue,  8 Dec 2015 20:45:36 +0000 (UTC)
Received: (qmail 36300 invoked by uid 500); 8 Dec 2015 20:45:35 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 36228 invoked by uid 500); 8 Dec 2015 20:45:35 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 36218 invoked by uid 99); 8 Dec 2015 20:45:35 -0000
Received: from Unknown (HELO spamd1-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 08 Dec 2015 20:45:35 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd1-us-west.apache.org (ASF Mail Server at spamd1-us-west.apache.org) with ESMTP id EBD33C9712
	for <dev@httpd.apache.org>; Tue,  8 Dec 2015 20:45:34 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd1-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 0.652
X-Spam-Level:
X-Spam-Status: No, score=0.652 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, SPF_NEUTRAL=0.652]
	autolearn=disabled
Authentication-Results: spamd1-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=comcast.net
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd1-us-west.apache.org [10.40.0.7]) (amavisd-new, port 10024)
	with ESMTP id 6XjeFTV2PMYO for <dev@httpd.apache.org>;
	Tue,  8 Dec 2015 20:45:29 +0000 (UTC)
Received: from resqmta-ch2-09v.sys.comcast.net (resqmta-ch2-09v.sys.comcast.net [69.252.207.41])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id 88BBB24D8F
	for <dev@httpd.apache.org>; Tue,  8 Dec 2015 20:45:28 +0000 (UTC)
Received: from resomta-ch2-13v.sys.comcast.net ([69.252.207.109])
	by resqmta-ch2-09v.sys.comcast.net with comcast
	id r8kf1r0092N9P4d018lMP2; Tue, 08 Dec 2015 20:45:21 +0000
Received: from [192.168.199.10] ([69.251.84.114])
	by resomta-ch2-13v.sys.comcast.net with comcast
	id r8lL1r00R2U0RYt018lLVg; Tue, 08 Dec 2015 20:45:21 +0000
Content-Type: text/plain; charset=us-ascii
Mime-Version: 1.0 (Mac OS X Mail 9.1 \(3096.5\))
Subject: Re: On the Upgrade request body limit
From: Jim Jagielski <jim@jaguNET.com>
In-Reply-To: <56673BF9.8070507@gmail.com>
Date: Tue, 8 Dec 2015 15:45:20 -0500
Content-Transfer-Encoding: quoted-printable
Message-Id: <3A145FA2-421B-4054-881B-E5EFF7A73FCE@jaguNET.com>
References: <56673BF9.8070507@gmail.com>
To: dev@httpd.apache.org
X-Mailer: Apple Mail (2.3096.5)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=comcast.net;
	s=q20140121; t=1449607521;
	bh=0OwaqanMe5/AV+eyklHiSiecQi0LI8tFdyoZLrWXrlg=;
	h=Received:Received:Content-Type:Mime-Version:Subject:From:Date:
	 Message-Id:To;
	b=UDH6ZfmygBLQSkL3PHAow8RS0zkMHc1Nh8D7XW4d5oK2YS2KXkSUo8rsMv90n2Zzc
	 l5onwacptzxwqZ3EofrvH2RKzlSvaEl6xJtS5GcQctAldnv6C/wZyxZqjkHJxIHL7j
	 FyOxv4DbETWDDSlRnwXxBN0E9qi0JgBc1de3Z8NqYR5i+Ue0WxOVG8XHoOrX4pw4SW
	 FOrzDrVnMw8pc9W3l+xN23J9pfNaS6JTxOGsK8PAsJU54URAX8PORjIe6m4R0VXuFV
	 KnC6G9pkvi3QQtl9aX4kz8gYusvE8OmAXhB2BRPGWyttRJh8P5yxQf33wrYa5YbJvJ
	 ic4v7znwPWC7g==

Well....

We are not NGINX. We are also not Microsoft. We don't create HTTP
response codes willy-nilly. We actually try to *honor* the actual
specs.

> On Dec 8, 2015, at 3:22 PM, Jacob Champion <champion.p@gmail.com> =
wrote:
>=20
> I wrote this in response to Stefan's note on the zero-length request =
body limit for h2c Upgrades, then realized it would further fragment the =
(already massive) conversation, so here it is.
>=20
> Stefan wrote:
>> It is possible, but difficult to do unless you can read the body and
> > set it aside somewhere. Which again imposes an arbitrary (for the
> > client) limit. Experience shows that this leads to design of clients
> > that work will in developments, but then encounter requests
> > usage/sites/servers that have other limits and break.
>=20
> This is true of other things about HTTP/1.1 too -- how does a client =
figure out what the maximum request size for a server is? -- but it's =
made harder in this case by the fact that
>=20
> 1) 100 Continue is sent whether the request is upgraded or not, which =
makes it impossible to use a continue handshake to quickly determine =
upgrade limits, and
>=20
> 2) returning 413 during an upgrade would be ambiguous anyway. Is the =
413 really related to the request target, or is it just because I tried =
to upgrade and my request was temporarily limited?
>=20
> It seems to me that we're missing something in HTTP/1.1 that would =
make these complex Upgrade scenarios robust. IIUC, the point of allowing =
request bodies during upgrades was to decrease the number of round =
trips, but if implementations can't actually make use of it in practice =
then that's not very useful...
>=20
> If it were enough of a problem to fix (and I'm not claiming it is, =
necessarily), how would we fix it? Would we need a new 1xx response =
(e.g. 103 Upgrade Declined, with headers indicating the related protocol =
and the reason for the failure)? A new header in OPTIONS? Something else =
entirely?
>=20
> Or is the correct "fix" to rearchitect so the limit during upgrades =
can be exactly the same as during a normal request?
>=20
> --Jacob


From dev-return-84985-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Tue Dec  8 21:00:30 2015
Return-Path: <dev-return-84985-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 2026F1847E
	for <apmail-httpd-dev-archive@www.apache.org>; Tue,  8 Dec 2015 21:00:30 +0000 (UTC)
Received: (qmail 79009 invoked by uid 500); 8 Dec 2015 21:00:29 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 78926 invoked by uid 500); 8 Dec 2015 21:00:29 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 78916 invoked by uid 99); 8 Dec 2015 21:00:29 -0000
Received: from Unknown (HELO spamd4-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 08 Dec 2015 21:00:29 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd4-us-west.apache.org (ASF Mail Server at spamd4-us-west.apache.org) with ESMTP id 271E7C06D6
	for <dev@httpd.apache.org>; Tue,  8 Dec 2015 21:00:29 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd4-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.12
X-Spam-Level:
X-Spam-Status: No, score=-0.12 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RCVD_IN_MSPIKE_H3=-0.01, RCVD_IN_MSPIKE_WL=-0.01] autolearn=disabled
Authentication-Results: spamd4-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd4-us-west.apache.org [10.40.0.11]) (amavisd-new, port 10024)
	with ESMTP id iSfQ3ybjdsoI for <dev@httpd.apache.org>;
	Tue,  8 Dec 2015 21:00:15 +0000 (UTC)
Received: from mail-pa0-f45.google.com (mail-pa0-f45.google.com [209.85.220.45])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id 58B0C211C0
	for <dev@httpd.apache.org>; Tue,  8 Dec 2015 21:00:14 +0000 (UTC)
Received: by pacwq6 with SMTP id wq6so17539024pac.1
        for <dev@httpd.apache.org>; Tue, 08 Dec 2015 13:00:13 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=subject:to:references:from:message-id:date:user-agent:mime-version
         :in-reply-to:content-type:content-transfer-encoding;
        bh=EIgVZqgGT2pi2YHZdAgQTQ7uxpf4w8q+rcVpwjqU74s=;
        b=Lrvn1HMaIhRUFu4vsk4c6MkIrtSJgVYexSG698EioL8Hw1+RK64wgpwlLld0QT0SC6
         Hd2ODEFrNyiipOkGCjIGsqNSWW3O5dSHxdDzGk7nfWiW105B9VWnEc3v2p60x0uqa+HK
         374oXCpVQ+TNSVhOl3VdSPxexRcQKwSs2rBuOolMM0Pf3XjCPTeMM2oOMIjNTqSz30l2
         iLREV8mzn0Xs7FmoCf7YpcyKDIE/O7gvCO9ZP4253OVTYH19nezoJrOuh7KKibWlayBz
         UiXdOOlIlTYmRJKjS2sp9eIGHIk+H+Ty/r9UriA3nr5/VljJofl8+fFNj7oRnSbEycG0
         RPQg==
X-Received: by 10.66.142.136 with SMTP id rw8mr2932609pab.36.1449608412993;
        Tue, 08 Dec 2015 13:00:12 -0800 (PST)
Received: from [192.168.1.4] (50-39-117-165.bvtn.or.frontiernet.net. [50.39.117.165])
        by smtp.gmail.com with ESMTPSA id by2sm6781724pab.20.2015.12.08.13.00.11
        for <dev@httpd.apache.org>
        (version=TLSv1/SSLv3 cipher=OTHER);
        Tue, 08 Dec 2015 13:00:11 -0800 (PST)
Subject: Re: On the Upgrade request body limit
To: dev@httpd.apache.org
References: <56673BF9.8070507@gmail.com>
 <3A145FA2-421B-4054-881B-E5EFF7A73FCE@jaguNET.com>
From: Jacob Champion <champion.p@gmail.com>
Message-ID: <566744DA.7090408@gmail.com>
Date: Tue, 8 Dec 2015 13:00:10 -0800
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:38.0) Gecko/20100101
 Thunderbird/38.4.0
MIME-Version: 1.0
In-Reply-To: <3A145FA2-421B-4054-881B-E5EFF7A73FCE@jaguNET.com>
Content-Type: text/plain; charset=windows-1252; format=flowed
Content-Transfer-Encoding: 7bit

On 12/08/2015 12:45 PM, Jim Jagielski wrote:
> Well....
>
> We are not NGINX. We are also not Microsoft. We don't create HTTP
> response codes willy-nilly. We actually try to *honor* the actual
> specs.

Yes, I agree 100%. :) Trust me, I've dealt with enough non-standard HTTP 
"extensions"; I'm not suggesting we just start doing stuff willy-nilly.

There are people who have worked on those specs on this mailing list, 
though, who might be interested in making official improvements and 
additions -- or have opinions on why those additions would not actually 
be improvements. This seemed like a nice place to talk about it, since 
we have implementation experts who can weigh in. If that's not on topic, 
I can try to take it somewhere else.

--Jacob

From dev-return-84986-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Tue Dec  8 21:03:57 2015
Return-Path: <dev-return-84986-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 7F24D184A8
	for <apmail-httpd-dev-archive@www.apache.org>; Tue,  8 Dec 2015 21:03:57 +0000 (UTC)
Received: (qmail 88683 invoked by uid 500); 8 Dec 2015 21:03:57 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 88620 invoked by uid 500); 8 Dec 2015 21:03:57 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 88610 invoked by uid 99); 8 Dec 2015 21:03:57 -0000
Received: from Unknown (HELO spamd1-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 08 Dec 2015 21:03:57 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd1-us-west.apache.org (ASF Mail Server at spamd1-us-west.apache.org) with ESMTP id 749E1C3A0B
	for <dev@httpd.apache.org>; Tue,  8 Dec 2015 21:03:56 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd1-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.102
X-Spam-Level:
X-Spam-Status: No, score=-0.102 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RCVD_IN_MSPIKE_H2=-0.001, SPF_PASS=-0.001] autolearn=disabled
Authentication-Results: spamd1-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd1-us-west.apache.org [10.40.0.7]) (amavisd-new, port 10024)
	with ESMTP id ySaLCCrWoCnn for <dev@httpd.apache.org>;
	Tue,  8 Dec 2015 21:03:55 +0000 (UTC)
Received: from mail-pf0-f171.google.com (mail-pf0-f171.google.com [209.85.192.171])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id 9DFCA42B93
	for <dev@httpd.apache.org>; Tue,  8 Dec 2015 21:03:55 +0000 (UTC)
Received: by pfnn128 with SMTP id n128so17801843pfn.0
        for <dev@httpd.apache.org>; Tue, 08 Dec 2015 13:03:49 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=subject:to:references:from:message-id:date:user-agent:mime-version
         :in-reply-to:content-type:content-transfer-encoding;
        bh=xZH4h0/a337yMp9w0apr6zmEtqafxTJQKevvRZ9mpJE=;
        b=apdAZqVDedr2Dt8CftGPlR+l1sy1FgpXiPm8DN9wgnh2QtiWY1dRI+JAcHpfFm/DKM
         EFgThELC1/9UTMeDN57PHLzSdi9/Jmq8ETiCGmUqAEQiOaEG4VigMwFAdzmKn/SoStbC
         7JQTRMayI1GR40g/5dhNHu8KhimMHy7dOPhvwClOV64Nxy9AYRsn4ZXSazb9f5hFwv4w
         glxJZzNJihcizGcSi7phEqZigSd5CR5tPY8ujdVOQRCe38v+qYjGD1V746Tf6Dq424OG
         +Dm4YRrmoEEx4mFuyaZg9Z6aZSItMUhZJllj7cfdWiDjVun2DOuuxUqzLY5/fvDWD23T
         yMrg==
X-Received: by 10.98.1.140 with SMTP id 134mr7700368pfb.134.1449608628999;
        Tue, 08 Dec 2015 13:03:48 -0800 (PST)
Received: from [192.168.1.4] (50-39-117-165.bvtn.or.frontiernet.net. [50.39.117.165])
        by smtp.gmail.com with ESMTPSA id fc6sm3872601pac.44.2015.12.08.13.03.47
        for <dev@httpd.apache.org>
        (version=TLSv1/SSLv3 cipher=OTHER);
        Tue, 08 Dec 2015 13:03:47 -0800 (PST)
Subject: Re: Upgrade Summary
To: dev@httpd.apache.org
References: <CACsi250=dbRQKnsbE8JSdAZRm5x99gE0sgX3iQ-PHAx77euD1A@mail.gmail.com>
 <AB1691BE05AE7F4992697F2A0835627AC63BAB94@VOEXM10W.internal.vodafone.com>
 <F7B20D30-D34A-4805-A77D-F64F6428F6E3@greenbytes.de>
 <56660896.c74fc20a.15f56.0ebd@mx.google.com> <56660B43.2060507@gmail.com>
 <6B13DF2B-0586-42BB-B62F-59A7638B697D@greenbytes.de>
 <13FE9E7F-9620-4BF9-8EA4-57A6314D66BF@greenbytes.de>
From: Jacob Champion <champion.p@gmail.com>
Message-ID: <566745B3.4080504@gmail.com>
Date: Tue, 8 Dec 2015 13:03:47 -0800
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:38.0) Gecko/20100101
 Thunderbird/38.4.0
MIME-Version: 1.0
In-Reply-To: <13FE9E7F-9620-4BF9-8EA4-57A6314D66BF@greenbytes.de>
Content-Type: text/plain; charset=windows-1252; format=flowed
Content-Transfer-Encoding: 7bit

On 12/08/2015 02:07 AM, Stefan Eissing wrote:
> C. if a protocol supports upgrade on request bodies is up to the protocol implementation and needs to be checked in the "propose" phase

Only if the module's intent is to simply ignore upgrade requests if they 
have bodies. Other modules might choose to propose the protocol anyway, 
and explicitly fail the request with a 4xx if the upgrade comes to them.

> 1. Protocols like Websocket need to take over the 101 sending themselves in the "switch protocol" phase. (correct, Jacob?). Should we delegate the sending of the 101 to the protocol switch handler?

It's more that I need to be able to interrupt the upgrade if necessary 
-- whether that's handled by a separate hook, or by delegating the 
upgrade entirely to me, is up for debate. I worry about the duplication 
of the Upgrade code if you delegate that to the modules though... seems 
like core should understand how to upgrade, and handle it for the modules.

In my head the ideal handshake API goes like this:

- Request comes in with a proposed set of protocols to Upgrade to.
- Core uses the propose hook to get a list of protocols that are valid 
upgrades for the current request target. A protocol is chosen.
- The module that won the proposal is given one last chance to check the 
incoming request and fail the upgrade with an immediate HTTP response.
- Otherwise, core sends the 101.
- The switch handler takes over the connection.
- The connection is closed after the switch handler returns.

I am still not sure where the authnz calls fit in, though. h2c and 
tls+http/1.1 can send a 401 after the protocol switch if they want 
(right?), but WebSocket needs to send it before the protocol switch, and 
having to replicate the authnz checks in my switch handler would be a 
pain...

> 4. status code of protocol switch handler: if we move the task of 101 sending, the switch handler might not do it and keep the connection on the "old" protocol. Then a connection close is not necessary. So, we would do the close only when the switch handler returns APR_EOF.

That's an interesting idea. Seems like it would work.

--Jacob

From dev-return-84987-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Tue Dec  8 21:12:20 2015
Return-Path: <dev-return-84987-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id CD7FF18598
	for <apmail-httpd-dev-archive@www.apache.org>; Tue,  8 Dec 2015 21:12:20 +0000 (UTC)
Received: (qmail 12836 invoked by uid 500); 8 Dec 2015 21:12:17 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 12761 invoked by uid 500); 8 Dec 2015 21:12:17 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 12751 invoked by uid 99); 8 Dec 2015 21:12:17 -0000
Received: from Unknown (HELO spamd1-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 08 Dec 2015 21:12:17 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd1-us-west.apache.org (ASF Mail Server at spamd1-us-west.apache.org) with ESMTP id E0B2CC59A0
	for <dev@httpd.apache.org>; Tue,  8 Dec 2015 21:12:16 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd1-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.102
X-Spam-Level:
X-Spam-Status: No, score=-0.102 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RCVD_IN_MSPIKE_H2=-0.001, SPF_PASS=-0.001] autolearn=disabled
Authentication-Results: spamd1-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd1-us-west.apache.org [10.40.0.7]) (amavisd-new, port 10024)
	with ESMTP id YjymraYanFwh for <dev@httpd.apache.org>;
	Tue,  8 Dec 2015 21:12:16 +0000 (UTC)
Received: from mail-pa0-f44.google.com (mail-pa0-f44.google.com [209.85.220.44])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id 84ED220314
	for <dev@httpd.apache.org>; Tue,  8 Dec 2015 21:12:15 +0000 (UTC)
Received: by pabur14 with SMTP id ur14so17820879pab.0
        for <dev@httpd.apache.org>; Tue, 08 Dec 2015 13:12:14 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=subject:to:references:from:message-id:date:user-agent:mime-version
         :in-reply-to:content-type:content-transfer-encoding;
        bh=4mWgH84aaQz47PxBViONeywtpdv2QBCcE9PcR3jl154=;
        b=kKYPmbQ5A9X/+2HvFuuu0QxGBqInOPoTXeaV7jVffpfAh3CT1jX7MWP6x5kxUXqKlv
         ZvFX/BbH0wTNlyzDL0+c7iTdn1S8k2YxqvKJznQ4ub5HTW8SB/PZ59vwNdw5C2D1dTGq
         lqXar3hxCVWkw0VTbjHh5fBYAq8bU2TfqrQBQ9Guth4lbWO4yrdz4k/+aKPISa0v3YGj
         sLHL9UWdQ3O6MFpO+S8tBAsxp+souT5L58Nc64AESaMpxV0DRXq0rmXQ0R4PVXMcLUQQ
         /Gieaf/9B/x5rtQCnnu4ixTx8XRG+KEDVREdEaQwKbiILrgSltUcMAxABlQWT15idHcR
         X2Xw==
X-Received: by 10.66.121.4 with SMTP id lg4mr2979703pab.22.1449609134179;
        Tue, 08 Dec 2015 13:12:14 -0800 (PST)
Received: from [192.168.1.4] (50-39-117-165.bvtn.or.frontiernet.net. [50.39.117.165])
        by smtp.gmail.com with ESMTPSA id w1sm6666806pfa.57.2015.12.08.13.12.13
        for <dev@httpd.apache.org>
        (version=TLSv1/SSLv3 cipher=OTHER);
        Tue, 08 Dec 2015 13:12:13 -0800 (PST)
Subject: Re: Upgrade Summary
To: dev@httpd.apache.org
References: <CACsi250=dbRQKnsbE8JSdAZRm5x99gE0sgX3iQ-PHAx77euD1A@mail.gmail.com>
 <AB1691BE05AE7F4992697F2A0835627AC63BAB94@VOEXM10W.internal.vodafone.com>
 <F7B20D30-D34A-4805-A77D-F64F6428F6E3@greenbytes.de>
 <56660896.c74fc20a.15f56.0ebd@mx.google.com> <56660B43.2060507@gmail.com>
 <6B13DF2B-0586-42BB-B62F-59A7638B697D@greenbytes.de>
 <13FE9E7F-9620-4BF9-8EA4-57A6314D66BF@greenbytes.de>
 <cf1101d131a3$7eaef300$7c0cd900$@qqmail.nl>
From: Jacob Champion <champion.p@gmail.com>
Message-ID: <566747AC.3000903@gmail.com>
Date: Tue, 8 Dec 2015 13:12:12 -0800
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:38.0) Gecko/20100101
 Thunderbird/38.4.0
MIME-Version: 1.0
In-Reply-To: <cf1101d131a3$7eaef300$7c0cd900$@qqmail.nl>
Content-Type: text/plain; charset=windows-1252; format=flowed
Content-Transfer-Encoding: 7bit

On 12/08/2015 02:30 AM, Bert Huijben wrote:
> The TLS and H2C upgrades both begin in one form and end in a different form.
> Websockets are kind of different in that they require a bad request response
> in a specific case. I'm not sure in which protocol this error needs to be
> send though.

For WebSocket, any upgrade failures have to be sent in the original 
HTTP/1.1 protocol using HTTP error codes.

WebSocket is different from TLS/h2c because, conceptually, you're 
upgrading the connection to a specific request target (a ws:// URL). The 
"response" sent back to the client after the upgrade (if you want to 
call it a response) is simply the establishment of a WebSocket 
connection for that URL.

--Jacob

From dev-return-84988-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Tue Dec  8 21:15:35 2015
Return-Path: <dev-return-84988-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 26E73185BE
	for <apmail-httpd-dev-archive@www.apache.org>; Tue,  8 Dec 2015 21:15:35 +0000 (UTC)
Received: (qmail 21842 invoked by uid 500); 8 Dec 2015 21:15:34 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 21778 invoked by uid 500); 8 Dec 2015 21:15:34 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 21768 invoked by uid 99); 8 Dec 2015 21:15:34 -0000
Received: from Unknown (HELO spamd1-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 08 Dec 2015 21:15:34 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd1-us-west.apache.org (ASF Mail Server at spamd1-us-west.apache.org) with ESMTP id 3C931C974C
	for <dev@httpd.apache.org>; Tue,  8 Dec 2015 21:15:34 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd1-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 0.652
X-Spam-Level:
X-Spam-Status: No, score=0.652 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, SPF_NEUTRAL=0.652]
	autolearn=disabled
Authentication-Results: spamd1-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=comcast.net
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd1-us-west.apache.org [10.40.0.7]) (amavisd-new, port 10024)
	with ESMTP id u91YTcBzDbL0 for <dev@httpd.apache.org>;
	Tue,  8 Dec 2015 21:15:27 +0000 (UTC)
Received: from resqmta-ch2-03v.sys.comcast.net (resqmta-ch2-03v.sys.comcast.net [69.252.207.35])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id 942B242ABE
	for <dev@httpd.apache.org>; Tue,  8 Dec 2015 21:15:27 +0000 (UTC)
Received: from resomta-ch2-10v.sys.comcast.net ([69.252.207.106])
	by resqmta-ch2-03v.sys.comcast.net with comcast
	id r9Dl1r0012JGN3p019FMLo; Tue, 08 Dec 2015 21:15:21 +0000
Received: from [192.168.199.10] ([69.251.84.114])
	by resomta-ch2-10v.sys.comcast.net with comcast
	id r9FL1r00L2U0RYt019FL4s; Tue, 08 Dec 2015 21:15:21 +0000
Content-Type: text/plain; charset=windows-1252
Mime-Version: 1.0 (Mac OS X Mail 9.1 \(3096.5\))
Subject: Re: On the Upgrade request body limit
From: Jim Jagielski <jim@jaguNET.com>
In-Reply-To: <566744DA.7090408@gmail.com>
Date: Tue, 8 Dec 2015 16:15:20 -0500
Content-Transfer-Encoding: quoted-printable
Message-Id: <9CAF1C47-CA9B-4D28-B1FA-A05D952FD682@jaguNET.com>
References: <56673BF9.8070507@gmail.com> <3A145FA2-421B-4054-881B-E5EFF7A73FCE@jaguNET.com> <566744DA.7090408@gmail.com>
To: dev@httpd.apache.org
X-Mailer: Apple Mail (2.3096.5)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=comcast.net;
	s=q20140121; t=1449609321;
	bh=dOHox4vndg7emKbx7M//t6UUxlCTvolHoRWHvpZ+hYY=;
	h=Received:Received:Content-Type:Mime-Version:Subject:From:Date:
	 Message-Id:To;
	b=ncfGYUidiO4zNXwv+mYzVHDfvoRxzS9Qj9Da+JxqnkvXlATjAhGq+nHREaH2FXtdL
	 JNK8X7IBGEV3vRxL/DFHaBmePDAqAR1W+BU63jeab1C+YBEAQvweosQqhMDWhpapqA
	 F0xDRttjLSCV49cQT73rXx5EU+BsPyUqnqN/Sc0rQOWrB32PWaH3a0RdTG1bV1PAFL
	 anB5jLfPPwY2bOz1J3f/bhB04YFasD49CTWjX9EZHVtsoYuAUdeeVHsSizc/pc/11z
	 4KNJo6FQxdTMBrq7LvVhAiwL4g1SQaTgupAkmyzHgmw4kr8gB9n26VBdecRfhJsetE
	 q/NAS1CS4+Zyw==


> On Dec 8, 2015, at 4:00 PM, Jacob Champion <champion.p@gmail.com> =
wrote:
>=20
> On 12/08/2015 12:45 PM, Jim Jagielski wrote:
>> Well....
>>=20
>> We are not NGINX. We are also not Microsoft. We don't create HTTP
>> response codes willy-nilly. We actually try to *honor* the actual
>> specs.
>=20
> Yes, I agree 100%. :) Trust me, I've dealt with enough non-standard =
HTTP "extensions"; I'm not suggesting we just start doing stuff =
willy-nilly.
>=20
> There are people who have worked on those specs on this mailing list, =
though, who might be interested in making official improvements and =
additions -- or have opinions on why those additions would not actually =
be improvements. This seemed like a nice place to talk about it, since =
we have implementation experts who can weigh in. If that's not on topic, =
I can try to take it somewhere else.
>=20

I agree that adding in some of the http/2 lists on this thread
would make sense.


From dev-return-84989-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Tue Dec  8 21:43:44 2015
Return-Path: <dev-return-84989-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id E0D4418780
	for <apmail-httpd-dev-archive@www.apache.org>; Tue,  8 Dec 2015 21:43:43 +0000 (UTC)
Received: (qmail 3617 invoked by uid 500); 8 Dec 2015 21:43:43 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 3534 invoked by uid 500); 8 Dec 2015 21:43:43 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 3524 invoked by uid 99); 8 Dec 2015 21:43:43 -0000
Received: from Unknown (HELO spamd2-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 08 Dec 2015 21:43:42 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd2-us-west.apache.org (ASF Mail Server at spamd2-us-west.apache.org) with ESMTP id 94E6A1A372F
	for <dev@httpd.apache.org>; Tue,  8 Dec 2015 21:43:42 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd2-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.102
X-Spam-Level:
X-Spam-Status: No, score=-0.102 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RCVD_IN_MSPIKE_H2=-0.001, SPF_PASS=-0.001] autolearn=disabled
Authentication-Results: spamd2-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd2-us-west.apache.org [10.40.0.9]) (amavisd-new, port 10024)
	with ESMTP id ajJvMt4t9VPV for <dev@httpd.apache.org>;
	Tue,  8 Dec 2015 21:43:41 +0000 (UTC)
Received: from mail-pa0-f51.google.com (mail-pa0-f51.google.com [209.85.220.51])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id E55BB42B0F
	for <dev@httpd.apache.org>; Tue,  8 Dec 2015 21:43:40 +0000 (UTC)
Received: by pacdm15 with SMTP id dm15so18114150pac.3
        for <dev@httpd.apache.org>; Tue, 08 Dec 2015 13:43:40 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=subject:to:references:from:message-id:date:user-agent:mime-version
         :in-reply-to:content-type:content-transfer-encoding;
        bh=qqzdagfR07AK9IgGQhbjj+oC4NeaUw790QkgK0o9gcw=;
        b=uW1Wff/SERewShxwBser7cyRohTrgWQu5V17o4vIkNysnGCeOAYnG5hvcDF273gzSG
         hg55XHlK1mcka7Hsk/3s1OOjT/ylg+fE0+/v21vOhX8l4TnajAHbBLJ85vjSf2ZVRKT+
         9D9RcPJnGaRv4fHors0ReZn+cud1pQpE/tmx4aMEyAZzNe3z//QNnbaykvyLKazZ5Cod
         ab/3EMs3I2melEwgwwNobBk6sDzejbjTKJcr1jMObiT9Z6eoBvyVBD/bB+Q/kk6JRFyy
         RnIrZIn2klZsWMrx/eM9VS0oEssRGrel79P+EXMTAFwW+XlReGdcVLr3NmmbShKDLWOw
         YSuQ==
X-Received: by 10.66.102.70 with SMTP id fm6mr3166279pab.80.1449611020150;
        Tue, 08 Dec 2015 13:43:40 -0800 (PST)
Received: from [192.168.1.4] (50-39-117-165.bvtn.or.frontiernet.net. [50.39.117.165])
        by smtp.gmail.com with ESMTPSA id 82sm6735131pfn.76.2015.12.08.13.43.38
        for <dev@httpd.apache.org>
        (version=TLSv1/SSLv3 cipher=OTHER);
        Tue, 08 Dec 2015 13:43:38 -0800 (PST)
Subject: Re: Upgrade Summary
To: dev@httpd.apache.org
References: <CACsi250=dbRQKnsbE8JSdAZRm5x99gE0sgX3iQ-PHAx77euD1A@mail.gmail.com>
 <AB1691BE05AE7F4992697F2A0835627AC63BAB94@VOEXM10W.internal.vodafone.com>
 <F7B20D30-D34A-4805-A77D-F64F6428F6E3@greenbytes.de>
 <56660896.c74fc20a.15f56.0ebd@mx.google.com> <56660B43.2060507@gmail.com>
 <6B13DF2B-0586-42BB-B62F-59A7638B697D@greenbytes.de>
 <13FE9E7F-9620-4BF9-8EA4-57A6314D66BF@greenbytes.de>
 <566745B3.4080504@gmail.com>
From: Jacob Champion <champion.p@gmail.com>
Message-ID: <56674F09.1080300@gmail.com>
Date: Tue, 8 Dec 2015 13:43:37 -0800
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:38.0) Gecko/20100101
 Thunderbird/38.4.0
MIME-Version: 1.0
In-Reply-To: <566745B3.4080504@gmail.com>
Content-Type: text/plain; charset=windows-1252; format=flowed
Content-Transfer-Encoding: 7bit

On 12/08/2015 01:03 PM, Jacob Champion wrote:
> - The module that won the proposal is given one last chance to check the
> incoming request and fail the upgrade with an immediate HTTP response.

And to add to this, for completeness: mod_websocket also needs to add 
any required headers (e.g. Sec-WebSocket-Accept/Protocol/Extensions) to 
the 101 response during this same conceptual "check" phase.

--Jacob

From dev-return-84990-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Tue Dec  8 22:00:58 2015
Return-Path: <dev-return-84990-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 9F8D5188B5
	for <apmail-httpd-dev-archive@www.apache.org>; Tue,  8 Dec 2015 22:00:58 +0000 (UTC)
Received: (qmail 60135 invoked by uid 500); 8 Dec 2015 22:00:51 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 60058 invoked by uid 500); 8 Dec 2015 22:00:51 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 60048 invoked by uid 99); 8 Dec 2015 22:00:51 -0000
Received: from Unknown (HELO spamd2-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 08 Dec 2015 22:00:51 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd2-us-west.apache.org (ASF Mail Server at spamd2-us-west.apache.org) with ESMTP id 528EB1A2898
	for <dev@httpd.apache.org>; Tue,  8 Dec 2015 22:00:51 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd2-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 2.998
X-Spam-Level: **
X-Spam-Status: No, score=2.998 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, HTML_MESSAGE=3,
	RCVD_IN_MSPIKE_H2=-0.001, SPF_PASS=-0.001] autolearn=disabled
Authentication-Results: spamd2-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=rowe-clan-net.20150623.gappssmtp.com
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd2-us-west.apache.org [10.40.0.9]) (amavisd-new, port 10024)
	with ESMTP id A3k0qyNpaHLW for <dev@httpd.apache.org>;
	Tue,  8 Dec 2015 22:00:48 +0000 (UTC)
Received: from mail-io0-f179.google.com (mail-io0-f179.google.com [209.85.223.179])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id 6BED142ACE
	for <dev@httpd.apache.org>; Tue,  8 Dec 2015 22:00:48 +0000 (UTC)
Received: by iofh3 with SMTP id h3so39277763iof.3
        for <dev@httpd.apache.org>; Tue, 08 Dec 2015 14:00:48 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=rowe-clan-net.20150623.gappssmtp.com; s=20150623;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        bh=taEJy/Li6JLw3HusIttUdDEgpuq9Rie/9llmDPq5Qdo=;
        b=NNFIsNTjC+wH2P0q30oq/XNtOX1grfOTHlj2AmO9MZOPCDBaA7Xkdg2UaY0qIFi+64
         EhfRd0dfYrkq8vbAQFxK56PQMtUuPX7aPblXxuEWLZnx0+9GqAs3wMFNngxww6I091RW
         JGqhgE+cSJlt20o/I4BAgbnU/Vpbp/IbEtjNYPTS5vsj2l0/U8wYn734pRZxPh7dw+xM
         FRq1CLbf67cYERk9aFuiIanDvkcLLjK2d+MQJAn05V9jf2/hGjRZO4n03bVwas2vg5Qd
         7tXd6ppwsbJzCy4QuOL6Ym007qrcPwIP4tz00+QUhtrORPM45a6andF7d4pWTfGkP9B+
         LZdA==
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=1e100.net; s=20130820;
        h=x-gm-message-state:mime-version:in-reply-to:references:date
         :message-id:subject:from:to:content-type;
        bh=taEJy/Li6JLw3HusIttUdDEgpuq9Rie/9llmDPq5Qdo=;
        b=mYbO4Em5mf15H+WkJUljZxnQrTb7GTjEYVMu+nEH50spJLogWByoDWoSz8gGc+Mmqh
         fE/2zhPRBX0Xy72JcHhrvSCbYPdYHu84Bwy2WF/yvcPcmx+TXGWVu9nuogIJteGbvDPA
         EmUQ2V2RsWWom+SYSQ0w2hBpC4uTkr9FgrWuWKifwJPaIzVjEhymms4S+MfO2SnL83lr
         EMIbbCjnXmh+YmHXUFxJs34zXvn49AnxyQj/Ei0Cz1GbAv2V9+S0zEjhl+6R2ftt/0Au
         g4bY8e32ahwojxWhE5A3xW7byBrvohDTcxx7+hd2qwv8A27GyonhSNvlEvQmyqtm6B9H
         iyEA==
X-Gm-Message-State: ALoCoQkQq3mNBsZxWRt2qAKWcCsI3hzkWrtrxLQ8UbMwA1onpy9wO/qI6TGyxi+92ClErymhQsETNJ1LfuUB9LJ8TSGleOZENCCJPQLgmXH7FOdf4/7qDLY=
MIME-Version: 1.0
X-Received: by 10.107.25.83 with SMTP id 80mr2158202ioz.163.1449612047954;
 Tue, 08 Dec 2015 14:00:47 -0800 (PST)
Received: by 10.107.62.136 with HTTP; Tue, 8 Dec 2015 14:00:47 -0800 (PST)
In-Reply-To: <56673BF9.8070507@gmail.com>
References: <56673BF9.8070507@gmail.com>
Date: Tue, 8 Dec 2015 16:00:47 -0600
Message-ID: <CACsi252ZL7WvqSzVJ8Yf1GaX7LhcJ4eXhK3TS3ypqyv5tkrisQ@mail.gmail.com>
Subject: Re: On the Upgrade request body limit
From: William A Rowe Jr <wrowe@rowe-clan.net>
To: httpd <dev@httpd.apache.org>
Content-Type: multipart/alternative; boundary=001a113fdbb42e59ad05266a1b7a

--001a113fdbb42e59ad05266a1b7a
Content-Type: text/plain; charset=UTF-8

On Tue, Dec 8, 2015 at 2:22 PM, Jacob Champion <champion.p@gmail.com> wrote:

> I wrote this in response to Stefan's note on the zero-length request body
> limit for h2c Upgrades, then realized it would further fragment the
> (already massive) conversation, so here it is.
>

And I agree to keep the other thread as clean as possible, so to your
thoughts...


> Stefan wrote:
>
>> It is possible, but difficult to do unless you can read the body and
>>
> > set it aside somewhere. Which again imposes an arbitrary (for the
> > client) limit. Experience shows that this leads to design of clients
> > that work will in developments, but then encounter requests
> > usage/sites/servers that have other limits and break.
>

That's nonsense, of course.  Apache httpd server offers limits on the
number of incoming headers, the number of bytes in those headers, the
number of bytes in the request line, the length of the URI.  The maximum
request body length.  This is just one more limit, but not an actual
*limitation*, because the request will be processed, simply not by changing
protocols first, per RFC7230.

As I'll point out again in closing, h2c isn't defined by RFC7230, and if it
decides to ignore requests with bodies, that's up to mod_http2 and other
implementations.  But RFC7230 has nothing to say to h2c on this, and rather
encourages protocol implementors to accept already-read C-L or T-E: chunked
request bodies in a hand-over into their upgraded protocol.

This is true of other things about HTTP/1.1 too -- how does a client figure
> out what the maximum request size for a server is? -- but it's made harder
> in this case by the fact that
>
> 1) 100 Continue is sent whether the request is upgraded or not, which
> makes it impossible to use a continue handshake to quickly determine
> upgrade limits, and
>

There is no need for the client to determine the upgrade limit, because the
body of the request is sent.  If the server -arbitrarily- chooses to
satisfy it, there will be a 101 following the body transmission.  But the
spec makes absolutely clear that it is the server's prerogative to upgrade
or not, irrespective of the particular upgrade requested.

If the server demands that the upgrade happen, before a request can be
honored, it must reply with a 426 until the client offers to upgrade.  If
the client demands that the upgrade happen, it must perform the simplest
applicable request (e.g. OPTIONS *) with the desired upgrade semantics and
verify that the upgrade occurred.

2) returning 413 during an upgrade would be ambiguous anyway. Is the 413
> really related to the request target, or is it just because I tried to
> upgrade and my request was temporarily limited?
>

It never would.  The possible results are the normal response in http/1.1
protocol, or 426 to tell the client it still must change protocols first.

That new protocol can make whatever demands on the protocol it wants to.
That the only acceptable upgrade to h2c will be an OPTIONS * with no
request body.  Or that POST upgrades will be refused.  Our httpd http/1.1
server doesn't and cannot care, it can read-ahead the same network bucket
it was going to read anyways, and let the new protocol handler decide, very
early or very late in the cycle, whether the upgrade will happen.  If it
won't, httpd must continue to serve the response sticking to http/1.1.

It seems to me that we're missing something in HTTP/1.1 that would make
> these complex Upgrade scenarios robust. IIUC, the point of allowing request
> bodies during upgrades was to decrease the number of round trips, but if
> implementations can't actually make use of it in practice then that's not
> very useful...
>

Define complex, robust.  Request (upgrade: somespec) -> 100 continue ->
request body <- [ http/1.1 response | 101 - switching protocols <- new
protocol response ].

The spec spells it out.  That is as clear as it gets.  One will happen, or
the other.

If it were enough of a problem to fix (and I'm not claiming it is,
> necessarily), how would we fix it? Would we need a new 1xx response (e.g.
> 103 Upgrade Declined, with headers indicating the related protocol and the
> reason for the failure)? A new header in OPTIONS? Something else entirely?
>

I was thinking about this... even within the 100-continue it might be
possible to add some commentary / hint of what might happen next.  Request
and response headers may contain (comments).

Or is the correct "fix" to rearchitect so the limit during upgrades can be
> exactly the same as during a normal request?


RFC7230 is baked, expect no changes.  The request (including 100-continue +
body) is read, the protocol is switched if possible, otherwise the response
is sent in http/1.1.  Those are our constraints.

Is there an advantage to stating no body accepted when we are free to
either upgrade or stay with http/1.1, at our whim? I'd suggest not and will
strongly object to the TLS filter behaving this way. I'll let http/2
protocol gurus argue what happens to that spec, I'm agnostic.

--001a113fdbb42e59ad05266a1b7a
Content-Type: text/html; charset=UTF-8
Content-Transfer-Encoding: quoted-printable

<div dir=3D"ltr"><div class=3D"gmail_extra"><div class=3D"gmail_quote">On T=
ue, Dec 8, 2015 at 2:22 PM, Jacob Champion <span dir=3D"ltr">&lt;<a href=3D=
"mailto:champion.p@gmail.com" target=3D"_blank">champion.p@gmail.com</a>&gt=
;</span> wrote:<br><blockquote class=3D"gmail_quote" style=3D"margin:0 0 0 =
.8ex;border-left:1px #ccc solid;padding-left:1ex">I wrote this in response =
to Stefan&#39;s note on the zero-length request body limit for h2c Upgrades=
, then realized it would further fragment the (already massive) conversatio=
n, so here it is.<br></blockquote><div><br></div><div>And I agree to keep t=
he other thread as clean as possible, so to your thoughts...</div><div>=C2=
=A0</div><blockquote class=3D"gmail_quote" style=3D"margin:0 0 0 .8ex;borde=
r-left:1px #ccc solid;padding-left:1ex">
Stefan wrote:<br>
<blockquote class=3D"gmail_quote" style=3D"margin:0 0 0 .8ex;border-left:1p=
x #ccc solid;padding-left:1ex">
It is possible, but difficult to do unless you can read the body and<br>
</blockquote>
&gt; set it aside somewhere. Which again imposes an arbitrary (for the<br>
&gt; client) limit. Experience shows that this leads to design of clients<b=
r>
&gt; that work will in developments, but then encounter requests<br>
&gt; usage/sites/servers that have other limits and break.<br></blockquote>=
<div><br></div><div>That&#39;s nonsense, of course.=C2=A0 Apache httpd serv=
er offers limits on the number of incoming headers, the number of bytes in =
those headers, the number of bytes in the request line, the length of the U=
RI.=C2=A0 The maximum request body length.=C2=A0 This is just one more limi=
t, but not an actual *limitation*, because the request will be processed, s=
imply not by changing protocols first, per RFC7230.</div><div><br></div><di=
v>As I&#39;ll point out again in closing, h2c isn&#39;t defined by RFC7230,=
 and if it decides to ignore requests with bodies, that&#39;s up to mod_htt=
p2 and other implementations.=C2=A0 But RFC7230 has nothing to say to h2c o=
n this, and rather encourages protocol implementors to accept already-read =
C-L or T-E: chunked request bodies in a hand-over into their upgraded proto=
col.</div><div><br></div><blockquote class=3D"gmail_quote" style=3D"margin:=
0 0 0 .8ex;border-left:1px #ccc solid;padding-left:1ex">
This is true of other things about HTTP/1.1 too -- how does a client figure=
 out what the maximum request size for a server is? -- but it&#39;s made ha=
rder in this case by the fact that<br>
<br>
1) 100 Continue is sent whether the request is upgraded or not, which makes=
 it impossible to use a continue handshake to quickly determine upgrade lim=
its, and<br></blockquote><div><br></div><div>There is no need for the clien=
t to determine the upgrade limit, because the body of the request is sent.=
=C2=A0 If the server -arbitrarily- chooses to satisfy it, there will be a 1=
01 following the body transmission.=C2=A0 But the spec makes absolutely cle=
ar that it is the server&#39;s prerogative to upgrade or not, irrespective =
of the particular upgrade requested.</div><div><br></div><div>If the server=
 demands that the upgrade happen, before a request can be honored, it must =
reply with a 426 until the client offers to upgrade.=C2=A0 If the client de=
mands that the upgrade happen, it must perform the simplest applicable requ=
est (e.g. OPTIONS *) with the desired upgrade semantics and verify that the=
 upgrade occurred.</div><div><br></div><blockquote class=3D"gmail_quote" st=
yle=3D"margin:0 0 0 .8ex;border-left:1px #ccc solid;padding-left:1ex">
2) returning 413 during an upgrade would be ambiguous anyway. Is the 413 re=
ally related to the request target, or is it just because I tried to upgrad=
e and my request was temporarily limited?<br></blockquote><div><br></div><d=
iv>It never would.=C2=A0 The possible results are the normal response in ht=
tp/1.1 protocol, or 426 to tell the client it still must change protocols f=
irst.</div><div><br></div><div>That new protocol can make whatever demands =
on the protocol it wants to.=C2=A0 That the only acceptable upgrade to h2c =
will be an OPTIONS * with no request body.=C2=A0 Or that POST upgrades will=
 be refused.=C2=A0 Our httpd http/1.1 server doesn&#39;t and cannot care, i=
t can read-ahead the same network bucket it was going to read anyways, and =
let the new protocol handler decide, very early or very late in the cycle, =
whether the upgrade will happen.=C2=A0 If it won&#39;t, httpd must continue=
 to serve the response sticking to http/1.1.</div><div><br></div><blockquot=
e class=3D"gmail_quote" style=3D"margin:0 0 0 .8ex;border-left:1px #ccc sol=
id;padding-left:1ex">
It seems to me that we&#39;re missing something in HTTP/1.1 that would make=
 these complex Upgrade scenarios robust. IIUC, the point of allowing reques=
t bodies during upgrades was to decrease the number of round trips, but if =
implementations can&#39;t actually make use of it in practice then that&#39=
;s not very useful...<br></blockquote><div><br></div><div>Define complex, r=
obust.=C2=A0 Request (upgrade: somespec) -&gt; 100 continue -&gt; request b=
ody &lt;- [ http/1.1 response | 101 - switching protocols &lt;- new protoco=
l response ]. =C2=A0</div><div><br></div><div>The spec spells it out.=C2=A0=
 That is as clear as it gets.=C2=A0 One will happen, or the other.</div><di=
v><br></div><blockquote class=3D"gmail_quote" style=3D"margin:0 0 0 .8ex;bo=
rder-left:1px #ccc solid;padding-left:1ex">
If it were enough of a problem to fix (and I&#39;m not claiming it is, nece=
ssarily), how would we fix it? Would we need a new 1xx response (e.g. 103 U=
pgrade Declined, with headers indicating the related protocol and the reaso=
n for the failure)? A new header in OPTIONS? Something else entirely?<br></=
blockquote><div>=C2=A0</div><div>I was thinking about this... even within t=
he 100-continue it might be possible to add some commentary / hint of what =
might happen next.=C2=A0 Request and response headers may contain (comments=
). =C2=A0</div><div><br></div><blockquote class=3D"gmail_quote" style=3D"ma=
rgin:0 0 0 .8ex;border-left:1px #ccc solid;padding-left:1ex">
Or is the correct &quot;fix&quot; to rearchitect so the limit during upgrad=
es can be exactly the same as during a normal request?</blockquote><div><br=
></div><div>RFC7230 is baked, expect no changes.=C2=A0 The request (includi=
ng 100-continue + body) is read, the protocol is switched if possible, othe=
rwise the response is sent in http/1.1.=C2=A0 Those are our constraints.</d=
iv><div><br></div><div>Is there an advantage to stating no body accepted wh=
en we are free to either upgrade or stay with http/1.1, at our whim? I&#39;=
d suggest not and will strongly object to the TLS filter behaving this way.=
 I&#39;ll let http/2 protocol gurus argue what happens to that spec, I&#39;=
m agnostic.</div><div><br></div><div><br></div></div></div></div>

--001a113fdbb42e59ad05266a1b7a--

From dev-return-84991-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Tue Dec  8 22:17:53 2015
Return-Path: <dev-return-84991-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 186CC18994
	for <apmail-httpd-dev-archive@www.apache.org>; Tue,  8 Dec 2015 22:17:53 +0000 (UTC)
Received: (qmail 97321 invoked by uid 500); 8 Dec 2015 22:17:52 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 97249 invoked by uid 500); 8 Dec 2015 22:17:52 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 97239 invoked by uid 99); 8 Dec 2015 22:17:52 -0000
Received: from Unknown (HELO spamd3-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 08 Dec 2015 22:17:52 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd3-us-west.apache.org (ASF Mail Server at spamd3-us-west.apache.org) with ESMTP id 1CF2518028D
	for <dev@httpd.apache.org>; Tue,  8 Dec 2015 22:17:52 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd3-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.101
X-Spam-Level:
X-Spam-Status: No, score=-0.101 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RCVD_IN_MSPIKE_H2=-0.001, SPF_PASS=-0.001, URIBL_BLOCKED=0.001]
	autolearn=disabled
Authentication-Results: spamd3-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd3-us-west.apache.org [10.40.0.10]) (amavisd-new, port 10024)
	with ESMTP id NjGJrnJ6tU18 for <dev@httpd.apache.org>;
	Tue,  8 Dec 2015 22:17:45 +0000 (UTC)
Received: from mail-qg0-f41.google.com (mail-qg0-f41.google.com [209.85.192.41])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id 894F542B82
	for <dev@httpd.apache.org>; Tue,  8 Dec 2015 22:17:45 +0000 (UTC)
Received: by qgcc31 with SMTP id c31so40708994qgc.3
        for <dev@httpd.apache.org>; Tue, 08 Dec 2015 14:17:45 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        bh=ZPtrWygTVmA6KPsz+z82VGo8LKUntbUPqORF6gFltGw=;
        b=uQk136IVhNHXZFMm55uer/nEOaGUHpaR1Xqrziquokqjkbb9Br21W4vJh8OwH7u+yv
         0SdJWtQdPI1eNIAxzCauWLwEy18rbSAlBYDaSFFAjoc8BhUjS4rL1DhNECc6nhsQIg0X
         rTnmtedpxvNC6j5MjckUbZJ/Ko9ZMsnPUSZYvJBk85gYDA0NqiO17dOvxbif8uW4uvB1
         rJ6grrT7Sa21XH52VpuvsWpoyQc7gkzKl6MxxdHJqzWQWdXgM5xOSB1i2npwEFtC2m4m
         5qPNp8wVle8l8QcScsgzPS1I3LnZfLD3mlu6F7BiZnERTq4ZvnHIcQoOxqIezzmc6gye
         u7Ug==
MIME-Version: 1.0
X-Received: by 10.140.220.136 with SMTP id q130mr8442116qhb.24.1449613064957;
 Tue, 08 Dec 2015 14:17:44 -0800 (PST)
Received: by 10.55.65.85 with HTTP; Tue, 8 Dec 2015 14:17:44 -0800 (PST)
In-Reply-To: <CACsi252ZL7WvqSzVJ8Yf1GaX7LhcJ4eXhK3TS3ypqyv5tkrisQ@mail.gmail.com>
References: <56673BF9.8070507@gmail.com>
	<CACsi252ZL7WvqSzVJ8Yf1GaX7LhcJ4eXhK3TS3ypqyv5tkrisQ@mail.gmail.com>
Date: Tue, 8 Dec 2015 23:17:44 +0100
Message-ID: <CAKQ1sVMp+MNmSQrFVDf-62=1WENXYLc9bDXQDU4UfmRoCrau4Q@mail.gmail.com>
Subject: Re: On the Upgrade request body limit
From: Yann Ylavic <ylavic.dev@gmail.com>
To: httpd-dev <dev@httpd.apache.org>
Content-Type: text/plain; charset=UTF-8

On Tue, Dec 8, 2015 at 11:00 PM, William A Rowe Jr <wrowe@rowe-clan.net> wrote:
>
> Define complex, robust.  Request (upgrade: somespec) -> 100 continue ->
> request body <- [ http/1.1 response | 101 - switching protocols <- new
> protocol response ].

As I read the RFC, the simple(st) case is:
Request (upgrade: somespec) -> request body <- 101 (upgrade: somespec)
<- new protocol response or read

Whereas the 100-continue case is:
Request (upgrade: somespec, expect: 100-continue) [ <- 100-continue ->
request body ] <- 101 (upgrade: somespec) <- new protocol response or
read

Why any HTTP/1 response? If the Upgrade is accepted, ISTM that the
response must be Upgraded, no?

From dev-return-84992-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Tue Dec  8 22:43:18 2015
Return-Path: <dev-return-84992-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 948E118A99
	for <apmail-httpd-dev-archive@www.apache.org>; Tue,  8 Dec 2015 22:43:18 +0000 (UTC)
Received: (qmail 64589 invoked by uid 500); 8 Dec 2015 22:43:13 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 64525 invoked by uid 500); 8 Dec 2015 22:43:13 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 64515 invoked by uid 99); 8 Dec 2015 22:43:13 -0000
Received: from Unknown (HELO spamd1-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 08 Dec 2015 22:43:13 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd1-us-west.apache.org (ASF Mail Server at spamd1-us-west.apache.org) with ESMTP id AC5B6C971D
	for <dev@httpd.apache.org>; Tue,  8 Dec 2015 22:43:12 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd1-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 2.979
X-Spam-Level: **
X-Spam-Status: No, score=2.979 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, HTML_MESSAGE=3,
	RCVD_IN_MSPIKE_H3=-0.01, RCVD_IN_MSPIKE_WL=-0.01, SPF_PASS=-0.001]
	autolearn=disabled
Authentication-Results: spamd1-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=rowe-clan-net.20150623.gappssmtp.com
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd1-us-west.apache.org [10.40.0.7]) (amavisd-new, port 10024)
	with ESMTP id m3OMcjAodTxT for <dev@httpd.apache.org>;
	Tue,  8 Dec 2015 22:43:11 +0000 (UTC)
Received: from mail-ig0-f182.google.com (mail-ig0-f182.google.com [209.85.213.182])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id 54FD042ACE
	for <dev@httpd.apache.org>; Tue,  8 Dec 2015 22:43:11 +0000 (UTC)
Received: by igcph11 with SMTP id ph11so105952209igc.1
        for <dev@httpd.apache.org>; Tue, 08 Dec 2015 14:38:09 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=rowe-clan-net.20150623.gappssmtp.com; s=20150623;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        bh=tVXeb/9TRc+lo22mjZVbErdNQ3XFaunwz0CJS744dTk=;
        b=YNOhfh8SIh+oaYeN9PNK/265/O9+V89RQpzGNHVGl1fVg+VPDjSPmizjgKnzckaXUv
         U+vvssBpKuhGXAt/EHBoTlqRS/Y5PSLTQBzAILS82LLzYLtpoqxSfsJSDk2KTBhC1bN7
         3y/SB53OsIJXYtePaDu20OamqlnAQxFq8EIWyW/4Xvplpbc1WjeI1XwRp0ROYalVqrr8
         WS1bhgS53Rec3orjFkCCELf6Iksik3gGOPTZmBMYVGfIivxWMYnfplX30axhq2agNGD1
         4s6QHmeSVbIWzq7hLcifxhCwdOHMkRU3R2EUwt7gMQhICF7p5ppmxAk+44HNzEwtJS0E
         724Q==
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=1e100.net; s=20130820;
        h=x-gm-message-state:mime-version:in-reply-to:references:date
         :message-id:subject:from:to:content-type;
        bh=tVXeb/9TRc+lo22mjZVbErdNQ3XFaunwz0CJS744dTk=;
        b=eqykBLsMYo8AwE6o9VLI8ICm8WevL7Rmn340uR7cKczVs61KcoMMWIp9SeN/6ActrH
         f+jcY+UKggt6zxVGEvARAdobLdwymStyxQoiis2Jbb2S6mkWxgl13cgFi3TlcVOaPnSR
         ruKjiGTC1gXrS6HCEJb+CBeQXs+SJ2EhoaSre8Q1tFzP11Xb404dXGxVw6+PS0m9Rtji
         RZvbszYzlyLUPuJOq+hvfzs8sm5ZAExdAh4IFxjgosgWGwXJaHiEZlNnIDXTSp8bCx8k
         pIcIC1Myl2b+5YFSklUXUvX6eIoA7QLhG0VevphhTEVbX97M2adWBGe28HjXwIuVo9Wu
         HlLg==
X-Gm-Message-State: ALoCoQlOtglbiEW5xmS862VbUxtWdw8tQ8LRJJdZs8+roClY0ZR94N4NhXkl6Vkcjhki1Ml8saf1LN8VM5Q5XZCJelYH3T8zNwv8Z0NKqInHTLa5TySRQAw=
MIME-Version: 1.0
X-Received: by 10.50.20.163 with SMTP id o3mr6671188ige.35.1449614289738; Tue,
 08 Dec 2015 14:38:09 -0800 (PST)
Received: by 10.107.62.136 with HTTP; Tue, 8 Dec 2015 14:38:09 -0800 (PST)
In-Reply-To: <56674F09.1080300@gmail.com>
References: <CACsi250=dbRQKnsbE8JSdAZRm5x99gE0sgX3iQ-PHAx77euD1A@mail.gmail.com>
	<AB1691BE05AE7F4992697F2A0835627AC63BAB94@VOEXM10W.internal.vodafone.com>
	<F7B20D30-D34A-4805-A77D-F64F6428F6E3@greenbytes.de>
	<56660896.c74fc20a.15f56.0ebd@mx.google.com>
	<56660B43.2060507@gmail.com>
	<6B13DF2B-0586-42BB-B62F-59A7638B697D@greenbytes.de>
	<13FE9E7F-9620-4BF9-8EA4-57A6314D66BF@greenbytes.de>
	<566745B3.4080504@gmail.com>
	<56674F09.1080300@gmail.com>
Date: Tue, 8 Dec 2015 16:38:09 -0600
Message-ID: <CACsi2535X2vg_ofgNMmcRR7ACyY+ka3oXgDwjJ-PXEDugK9AtQ@mail.gmail.com>
Subject: Re: Upgrade Summary
From: William A Rowe Jr <wrowe@rowe-clan.net>
To: httpd <dev@httpd.apache.org>
Content-Type: multipart/alternative; boundary=047d7bd75deccd367705266aa0ba

--047d7bd75deccd367705266aa0ba
Content-Type: text/plain; charset=UTF-8

On Tue, Dec 8, 2015 at 3:43 PM, Jacob Champion <champion.p@gmail.com> wrote:

> On 12/08/2015 01:03 PM, Jacob Champion wrote:
>
>> - The module that won the proposal is given one last chance to check the
>> incoming request and fail the upgrade with an immediate HTTP response.
>>
>
> And to add to this, for completeness: mod_websocket also needs to add any
> required headers (e.g. Sec-WebSocket-Accept/Protocol/Extensions) to the 101
> response during this same conceptual "check" phase.


It seems prudent in the API design to allow the target of the switch to also
specify any exceptional 100-continue interim response headers as well as
these 101-switching protocols interim response headers.

--047d7bd75deccd367705266aa0ba
Content-Type: text/html; charset=UTF-8
Content-Transfer-Encoding: quoted-printable

<div dir=3D"ltr"><div class=3D"gmail_extra"><div class=3D"gmail_quote">On T=
ue, Dec 8, 2015 at 3:43 PM, Jacob Champion <span dir=3D"ltr">&lt;<a href=3D=
"mailto:champion.p@gmail.com" target=3D"_blank">champion.p@gmail.com</a>&gt=
;</span> wrote:<br><blockquote class=3D"gmail_quote" style=3D"margin:0px 0p=
x 0px 0.8ex;border-left-width:1px;border-left-color:rgb(204,204,204);border=
-left-style:solid;padding-left:1ex"><span class=3D"">On 12/08/2015 01:03 PM=
, Jacob Champion wrote:<br>
<blockquote class=3D"gmail_quote" style=3D"margin:0px 0px 0px 0.8ex;border-=
left-width:1px;border-left-color:rgb(204,204,204);border-left-style:solid;p=
adding-left:1ex">
- The module that won the proposal is given one last chance to check the<br=
>
incoming request and fail the upgrade with an immediate HTTP response.<br>
</blockquote>
<br></span>
And to add to this, for completeness: mod_websocket also needs to add any r=
equired headers (e.g. Sec-WebSocket-Accept/Protocol/Extensions) to the 101 =
response during this same conceptual &quot;check&quot; phase.</blockquote><=
div><br></div><div>It seems prudent in the API design to allow the target o=
f the switch to also</div><div>specify any exceptional 100-continue interim=
 response headers as well as</div><div>these 101-switching protocols=C2=A0i=
nterim=C2=A0response headers.=C2=A0</div><div><br></div><div><br></div></di=
v><br></div></div>

--047d7bd75deccd367705266aa0ba--

From dev-return-84993-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Tue Dec  8 22:48:35 2015
Return-Path: <dev-return-84993-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id C42C018AE0
	for <apmail-httpd-dev-archive@www.apache.org>; Tue,  8 Dec 2015 22:48:35 +0000 (UTC)
Received: (qmail 80920 invoked by uid 500); 8 Dec 2015 22:48:35 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 80848 invoked by uid 500); 8 Dec 2015 22:48:35 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 80838 invoked by uid 99); 8 Dec 2015 22:48:35 -0000
Received: from Unknown (HELO spamd1-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 08 Dec 2015 22:48:35 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd1-us-west.apache.org (ASF Mail Server at spamd1-us-west.apache.org) with ESMTP id AA9BCC9785
	for <dev@httpd.apache.org>; Tue,  8 Dec 2015 22:48:34 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd1-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.101
X-Spam-Level:
X-Spam-Status: No, score=-0.101 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RCVD_IN_MSPIKE_H2=-0.001, SPF_PASS=-0.001, URIBL_BLOCKED=0.001]
	autolearn=disabled
Authentication-Results: spamd1-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd1-us-west.apache.org [10.40.0.7]) (amavisd-new, port 10024)
	with ESMTP id jDdp7EFUhfxU for <dev@httpd.apache.org>;
	Tue,  8 Dec 2015 22:48:28 +0000 (UTC)
Received: from mail-qg0-f43.google.com (mail-qg0-f43.google.com [209.85.192.43])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id 2408B42ACE
	for <dev@httpd.apache.org>; Tue,  8 Dec 2015 22:48:28 +0000 (UTC)
Received: by qgeb1 with SMTP id b1so42169403qge.1
        for <dev@httpd.apache.org>; Tue, 08 Dec 2015 14:48:27 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        bh=F8PjFVBRuJf2Ew4oKqFBIx4nUEVfIqAa0/3KFArcM8s=;
        b=tL+sFs2gfocNVTQt/V3sOTQ10K+8gUQ6/wLP9SY/ioVfLUV54GbYE+dnHKN3rCnPka
         v6USF+nXi9NmsXBSjHdUV5P6Keb+inufVqxHhzfwk7FsrMJ0SWScnHXOVdB0kdmQfzuI
         7WQcOshXNqUhM5/tb7Fsyaz2kK9ktXGAmhSMe6pqKFCUMskEBH66TURzKgypnC9SNful
         ebsumz/1YTny/G3YHzEPjc0deUmN0fSoKfYmXjO5NzxsTqWBs/vBPjwHiZl0VWU1g+zs
         u9lDzQsZi96CW4L9BXwv3w7Ffom8b1fNBNBj5In0IRNYSAZPrCLOXzOzsbt7SoiFW0mo
         bkVQ==
MIME-Version: 1.0
X-Received: by 10.140.43.9 with SMTP id d9mr2930257qga.51.1449614907718; Tue,
 08 Dec 2015 14:48:27 -0800 (PST)
Received: by 10.55.65.85 with HTTP; Tue, 8 Dec 2015 14:48:27 -0800 (PST)
In-Reply-To: <CACsi252ZL7WvqSzVJ8Yf1GaX7LhcJ4eXhK3TS3ypqyv5tkrisQ@mail.gmail.com>
References: <56673BF9.8070507@gmail.com>
	<CACsi252ZL7WvqSzVJ8Yf1GaX7LhcJ4eXhK3TS3ypqyv5tkrisQ@mail.gmail.com>
Date: Tue, 8 Dec 2015 23:48:27 +0100
Message-ID: <CAKQ1sVMJ7ctfEX-JyfFQn7RbzxyYkHfQ2NG+CRPOJy1_VSKKkw@mail.gmail.com>
Subject: Re: On the Upgrade request body limit
From: Yann Ylavic <ylavic.dev@gmail.com>
To: httpd-dev <dev@httpd.apache.org>
Content-Type: text/plain; charset=UTF-8

On Tue, Dec 8, 2015 at 11:00 PM, William A Rowe Jr <wrowe@rowe-clan.net> wrote:
>
> Apache httpd server offers limits on the number
> of incoming headers, the number of bytes in those headers, the number of
> bytes in the request line, the length of the URI.  The maximum request body
> length.  This is just one more limit, but not an actual *limitation*,
> because the request will be processed, simply not by changing protocols
> first, per RFC7230.

Agreed.

> On Tue, Dec 8, 2015 at 2:22 PM, Jacob Champion <champion.p@gmail.com> wrote:
>>
>> 1) 100 Continue is sent whether the request is upgraded or not, which
>> makes it impossible to use a continue handshake to quickly determine upgrade
>> limits, and

100-continue is sent only if the client Expect's it, that's not mandatory.

>
>> 2) returning 413 during an upgrade would be ambiguous anyway. Is the 413
>> really related to the request target, or is it just because I tried to
>> upgrade and my request was temporarily limited?
>
> It never would.  The possible results are the normal response in http/1.1
> protocol, or 426 to tell the client it still must change protocols first.
[]
>
> Our httpd http/1.1 server
> doesn't and cannot care, it can read-ahead the same network bucket it was
> going to read anyways, and let the new protocol handler decide, very early
> or very late in the cycle, whether the upgrade will happen.  If it won't,
> httpd must continue to serve the response sticking to http/1.1.

Agreed, the module/handler can read the (HTTP/1) body if it needs it,
or ignore it, in any case the core must do the right thing for this
body, and if some Protocols was elected, do the 101 switch before any
response bytes.
For empty response (i.e. simple/single 101 response), couldn't the
module/handler simply flush?
If so, an output filter could do the job...

>
> RFC7230 is baked, expect no changes.  The request (including 100-continue +
> body) is read, the protocol is switched if possible, otherwise the response
> is sent in http/1.1.  Those are our constraints.

Agreed (again), and that constraints are not that bad ("normal"
Upgrade handshakes should not have a huge payload anyway), so we
should be able to do an Upgrade in a single round trip.

From dev-return-84994-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Tue Dec  8 22:49:11 2015
Return-Path: <dev-return-84994-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 0D96218AE9
	for <apmail-httpd-dev-archive@www.apache.org>; Tue,  8 Dec 2015 22:49:11 +0000 (UTC)
Received: (qmail 82160 invoked by uid 500); 8 Dec 2015 22:49:10 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 82082 invoked by uid 500); 8 Dec 2015 22:49:10 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 82066 invoked by uid 99); 8 Dec 2015 22:49:10 -0000
Received: from Unknown (HELO spamd1-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 08 Dec 2015 22:49:10 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd1-us-west.apache.org (ASF Mail Server at spamd1-us-west.apache.org) with ESMTP id E5B4CC9785
	for <dev@httpd.apache.org>; Tue,  8 Dec 2015 22:49:09 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd1-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 3
X-Spam-Level: ***
X-Spam-Status: No, score=3 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, HTML_MESSAGE=3,
	SPF_PASS=-0.001, URIBL_BLOCKED=0.001] autolearn=disabled
Authentication-Results: spamd1-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=rowe-clan-net.20150623.gappssmtp.com
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd1-us-west.apache.org [10.40.0.7]) (amavisd-new, port 10024)
	with ESMTP id dr6_7zkb8hg9 for <dev@httpd.apache.org>;
	Tue,  8 Dec 2015 22:49:02 +0000 (UTC)
Received: from mail-io0-f182.google.com (mail-io0-f182.google.com [209.85.223.182])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id 391BA20599
	for <dev@httpd.apache.org>; Tue,  8 Dec 2015 22:49:01 +0000 (UTC)
Received: by ioir85 with SMTP id r85so40342393ioi.1
        for <dev@httpd.apache.org>; Tue, 08 Dec 2015 14:43:25 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=rowe-clan-net.20150623.gappssmtp.com; s=20150623;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        bh=bq1VE11SjKVKwzugPdB3AsepT1FbFcI1RLx+hKC0k9g=;
        b=VMnYzGvIYVxx3id7tDXYEEkxJIM5r8/yYUl7fuma46fSpi7sT8vUUIBH/bXq3+PnqK
         YbvlKkOZuTF38oKXAnyXOeUhffwMny7bdnJxDzSg1xAh2BMyS9mr0RhI2t+Luzp/d8OP
         8wdLvT3GRCkiaEQIW9wVxPzhAcE/uvMSw2csg8AznzDjJGZ1dW7J89LfUnInjKygfLck
         nt541dlJJuo3zy8p7zFktNbppVGb05nVKsvIDEuktwNUcQQryWuymz2skif2VlDFJmLR
         gk9hxHrEqXW1meqNpgEQ/N40AMTIoirmLkvs/MMDdxeyASX+/D2kGEFfUDoV2+eWZf25
         LrPg==
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=1e100.net; s=20130820;
        h=x-gm-message-state:mime-version:in-reply-to:references:date
         :message-id:subject:from:to:content-type;
        bh=bq1VE11SjKVKwzugPdB3AsepT1FbFcI1RLx+hKC0k9g=;
        b=JqrrdBYlPc+0r3AlEGbDq5xNelw0YtI2XF3yuCS4suJzD8OmWUbgD5EtHrCrIwfoE7
         7T/Awj+Yt1W124Zn4LEBa66ZL24iqR3BsJMKUGuH20q1vXCrNIwtqKAlJ6Q54/8EGHRZ
         oOeRTk1nj87fs3KXIJQPWZ6Uh5LfyALGkjAqfBBYxEbKU5Wbo2ByGfPUdhsZtgDEpsbd
         ZJ27yjZ6/l++oDnCdEhIGnRmfMNqZfBra4dIoWDJy5gmhWtYEvN1DZNnZ8kWN/yBFbm5
         fLXUBgZ5sfgDsUlXq+FyNu9fHSShCDLjwEY5PV5wM5l1ZK+sNZsGp1xTxWWrHuzOmO2i
         oc6A==
X-Gm-Message-State: ALoCoQk0Hr24X/Dh97hxjMNkMc2jf4RL6dniuX2vN6yD1LQbkAn8aVIIr0sG4i2nijP6vZ46RdqxwcwxSi+aa1gqBUtSUDgs5EE/NRqWLu20B0+nrWSVdZA=
MIME-Version: 1.0
X-Received: by 10.107.25.83 with SMTP id 80mr2329718ioz.163.1449614605135;
 Tue, 08 Dec 2015 14:43:25 -0800 (PST)
Received: by 10.107.62.136 with HTTP; Tue, 8 Dec 2015 14:43:25 -0800 (PST)
In-Reply-To: <CAKQ1sVMp+MNmSQrFVDf-62=1WENXYLc9bDXQDU4UfmRoCrau4Q@mail.gmail.com>
References: <56673BF9.8070507@gmail.com>
	<CACsi252ZL7WvqSzVJ8Yf1GaX7LhcJ4eXhK3TS3ypqyv5tkrisQ@mail.gmail.com>
	<CAKQ1sVMp+MNmSQrFVDf-62=1WENXYLc9bDXQDU4UfmRoCrau4Q@mail.gmail.com>
Date: Tue, 8 Dec 2015 16:43:25 -0600
Message-ID: <CACsi251E6V2hDCH8MxGGwF2Lk8NaALqUcgW5Vr6upbqfQ6h4+w@mail.gmail.com>
Subject: Re: On the Upgrade request body limit
From: William A Rowe Jr <wrowe@rowe-clan.net>
To: httpd <dev@httpd.apache.org>
Content-Type: multipart/alternative; boundary=001a113fdbb499c52505266ab361

--001a113fdbb499c52505266ab361
Content-Type: text/plain; charset=UTF-8

On Tue, Dec 8, 2015 at 4:17 PM, Yann Ylavic <ylavic.dev@gmail.com> wrote:

> On Tue, Dec 8, 2015 at 11:00 PM, William A Rowe Jr <wrowe@rowe-clan.net>
> wrote:
> >
> > Define complex, robust.  Request (upgrade: somespec) -> 100 continue ->
> > request body <- [ http/1.1 response | 101 - switching protocols <- new
> > protocol response ].
>
> As I read the RFC, the simple(st) case is:
> Request (upgrade: somespec) -> request body <- 101 (upgrade: somespec)
> <- new protocol response or read
>

Whereas the 100-continue case is:
> Request (upgrade: somespec, expect: 100-continue) [ <- 100-continue ->
> request body ] <- 101 (upgrade: somespec) <- new protocol response or
> read
>

Right, and I didn't color the complexity of using C-L vs. T-E encoding for
the request body, either.  Both may reply in http/1.1 or with a
101-switching
followed by something recognizable (e.g. tls following handshake and filter
insertion) or inscrutable (e.g. websocket, h2c) to the http/1.1 protocol
stack.


> Why any HTTP/1 response? If the Upgrade is accepted, ISTM that the
> response must be Upgraded, no?
>

The server is always free to accept or ignore the Upgrade: request... and
once the 101-switching protocols has been sent, the connection must be
in the offered protocol.

6.7 <https://tools.ietf.org/html/rfc7230#section-6.7>.  Upgrade

   The "Upgrade" header field is intended to provide a simple mechanism
   for transitioning from HTTP/1.1 to some other protocol on the same
   connection.  A client MAY send a list of protocols in the Upgrade
   header field of a request to invite the server to switch to one or
   more of those protocols, in order of descending preference, before
   sending the final response.  A server MAY ignore a received Upgrade
   header field if it wishes to continue using the current protocol on
   that connection.  Upgrade cannot be used to insist on a protocol
   change.

--001a113fdbb499c52505266ab361
Content-Type: text/html; charset=UTF-8
Content-Transfer-Encoding: quoted-printable

<div dir=3D"ltr"><div class=3D"gmail_extra"><div class=3D"gmail_quote">On T=
ue, Dec 8, 2015 at 4:17 PM, Yann Ylavic <span dir=3D"ltr">&lt;<a href=3D"ma=
ilto:ylavic.dev@gmail.com" target=3D"_blank">ylavic.dev@gmail.com</a>&gt;</=
span> wrote:<br><blockquote class=3D"gmail_quote" style=3D"margin:0px 0px 0=
px 0.8ex;border-left-width:1px;border-left-color:rgb(204,204,204);border-le=
ft-style:solid;padding-left:1ex"><span class=3D"">On Tue, Dec 8, 2015 at 11=
:00 PM, William A Rowe Jr &lt;<a href=3D"mailto:wrowe@rowe-clan.net">wrowe@=
rowe-clan.net</a>&gt; wrote:<br>
&gt;<br>
&gt; Define complex, robust.=C2=A0 Request (upgrade: somespec) -&gt; 100 co=
ntinue -&gt;<br>
&gt; request body &lt;- [ http/1.1 response | 101 - switching protocols &lt=
;- new<br>
&gt; protocol response ].<br>
<br>
</span>As I read the RFC, the simple(st) case is:<br>
Request (upgrade: somespec) -&gt; request body &lt;- 101 (upgrade: somespec=
)<br>
&lt;- new protocol response or read<br></blockquote><div><br></div><blockqu=
ote class=3D"gmail_quote" style=3D"margin:0px 0px 0px 0.8ex;border-left-wid=
th:1px;border-left-color:rgb(204,204,204);border-left-style:solid;padding-l=
eft:1ex">
Whereas the 100-continue case is:<br>
Request (upgrade: somespec, expect: 100-continue) [ &lt;- 100-continue -&gt=
;<br>
request body ] &lt;- 101 (upgrade: somespec) &lt;- new protocol response or=
<br>
read<br></blockquote><div><br></div><div>Right, and I didn&#39;t color the =
complexity of using C-L vs. T-E encoding for</div><div>the request body, ei=
ther.=C2=A0 Both may reply in http/1.1 or with a 101-switching</div><div>fo=
llowed by something recognizable (e.g. tls following handshake and filter</=
div><div>insertion) or inscrutable (e.g. websocket, h2c) to the http/1.1 pr=
otocol stack.</div><div>=C2=A0</div><blockquote class=3D"gmail_quote" style=
=3D"margin:0px 0px 0px 0.8ex;border-left-width:1px;border-left-color:rgb(20=
4,204,204);border-left-style:solid;padding-left:1ex">
Why any HTTP/1 response? If the Upgrade is accepted, ISTM that the<br>
response must be Upgraded, no?<br>
</blockquote></div><br></div><div class=3D"gmail_extra">The server is alway=
s free to accept or ignore the Upgrade: request... and</div><div class=3D"g=
mail_extra">once the 101-switching protocols has been sent, the connection =
must be</div><div class=3D"gmail_extra">in the offered protocol.</div><div =
class=3D"gmail_extra"><br></div><div class=3D"gmail_extra"><pre class=3D"" =
style=3D"font-size:13.3333px;margin-top:0px;margin-bottom:0px;color:rgb(0,0=
,0)"><span class=3D"" style=3D"line-height:0pt;display:inline;font-size:1em=
;font-weight:bold"><a class=3D"" name=3D"section-6.7" href=3D"https://tools=
.ietf.org/html/rfc7230#section-6.7" style=3D"color:black;text-decoration:no=
ne">6.7</a>.  Upgrade</span>

   The &quot;Upgrade&quot; header field is intended to provide a simple mec=
hanism
   for transitioning from HTTP/1.1 to some other protocol on the same
   connection.  A client MAY send a list of protocols in the Upgrade
   header field of a request to invite the server to switch to one or
   more of those protocols, in order of descending preference, before
   sending the final response.  A server MAY ignore a received Upgrade
   header field if it wishes to continue using the current protocol on
   that connection.  Upgrade cannot be used to insist on a protocol
   change.</pre><pre class=3D"" style=3D"font-size:13.3333px;margin-top:0px=
;margin-bottom:0px;color:rgb(0,0,0)"><br></pre></div></div>

--001a113fdbb499c52505266ab361--

From dev-return-84995-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Tue Dec  8 22:58:37 2015
Return-Path: <dev-return-84995-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id C4EB318B8C
	for <apmail-httpd-dev-archive@www.apache.org>; Tue,  8 Dec 2015 22:58:37 +0000 (UTC)
Received: (qmail 11118 invoked by uid 500); 8 Dec 2015 22:58:36 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 11049 invoked by uid 500); 8 Dec 2015 22:58:36 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 11039 invoked by uid 99); 8 Dec 2015 22:58:36 -0000
Received: from Unknown (HELO spamd2-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 08 Dec 2015 22:58:36 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd2-us-west.apache.org (ASF Mail Server at spamd2-us-west.apache.org) with ESMTP id 76E691A2B79
	for <dev@httpd.apache.org>; Tue,  8 Dec 2015 22:58:36 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd2-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.101
X-Spam-Level:
X-Spam-Status: No, score=-0.101 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RCVD_IN_MSPIKE_H2=-0.001, SPF_PASS=-0.001, URIBL_BLOCKED=0.001]
	autolearn=disabled
Authentication-Results: spamd2-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd2-us-west.apache.org [10.40.0.9]) (amavisd-new, port 10024)
	with ESMTP id bzg86HmxwBLP for <dev@httpd.apache.org>;
	Tue,  8 Dec 2015 22:58:30 +0000 (UTC)
Received: from mail-qg0-f45.google.com (mail-qg0-f45.google.com [209.85.192.45])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id EA06D42B0F
	for <dev@httpd.apache.org>; Tue,  8 Dec 2015 22:58:29 +0000 (UTC)
Received: by qgec40 with SMTP id c40so41950875qge.2
        for <dev@httpd.apache.org>; Tue, 08 Dec 2015 14:53:29 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        bh=dVeH4Mm/AFTm+AEMns2nqQxWHaIk18v41tJ3YzHwawU=;
        b=e6D4aHQdDGiVE0rRUCW66p76XNO47bZ6L3/xoPr+a6+ohkwtJdNTOBTf5UoQ26O6Rj
         +puktn61plJOD8rIZJAvOwBxrAeJeIlWxU34/voNmQ8Ex0gmZWiFkdH6Ah++bKqMAnFA
         OKaUZa+NNB/TwRhULnpMU4yFRwZkixrcLUKuc/4pSJoDNnKHkdbYqupQB5EJ/sHjL/vP
         IFvEWGpfXQos73uzcDP7P5glquMQOHbR0A9lrvNPqIXnRSi7pTt2s2PLMt62pKiO5XPk
         dH+oI29eWLXBhcG4i/ehCTBE2lSOGVjKMco/ZuxpPw7DeoYTuBGqkcX7bZPEdsNc95j7
         F3vA==
MIME-Version: 1.0
X-Received: by 10.55.77.9 with SMTP id a9mr3047557qkb.38.1449615209603; Tue,
 08 Dec 2015 14:53:29 -0800 (PST)
Received: by 10.55.65.85 with HTTP; Tue, 8 Dec 2015 14:53:29 -0800 (PST)
In-Reply-To: <CACsi251E6V2hDCH8MxGGwF2Lk8NaALqUcgW5Vr6upbqfQ6h4+w@mail.gmail.com>
References: <56673BF9.8070507@gmail.com>
	<CACsi252ZL7WvqSzVJ8Yf1GaX7LhcJ4eXhK3TS3ypqyv5tkrisQ@mail.gmail.com>
	<CAKQ1sVMp+MNmSQrFVDf-62=1WENXYLc9bDXQDU4UfmRoCrau4Q@mail.gmail.com>
	<CACsi251E6V2hDCH8MxGGwF2Lk8NaALqUcgW5Vr6upbqfQ6h4+w@mail.gmail.com>
Date: Tue, 8 Dec 2015 23:53:29 +0100
Message-ID: <CAKQ1sVNcLcsqUoKFjpLi-AMYe1b6SPqgSeoTe4yzZVaXndA_gA@mail.gmail.com>
Subject: Re: On the Upgrade request body limit
From: Yann Ylavic <ylavic.dev@gmail.com>
To: httpd-dev <dev@httpd.apache.org>
Content-Type: text/plain; charset=UTF-8

On Tue, Dec 8, 2015 at 11:43 PM, William A Rowe Jr <wrowe@rowe-clan.net> wrote:
> On Tue, Dec 8, 2015 at 4:17 PM, Yann Ylavic <ylavic.dev@gmail.com> wrote:
>>
>> Why any HTTP/1 response? If the Upgrade is accepted, ISTM that the
>> response must be Upgraded, no?
>
> The server is always free to accept or ignore the Upgrade: request... and
> once the 101-switching protocols has been sent, the connection must be
> in the offered protocol.
>
> 6.7.  Upgrade

Oh, right, but in this case the Upgrade is aborted, so there should be
no 101 switch from httpd, the whole transaction is HTTP/1 (until
possibly further request).

From dev-return-84996-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Tue Dec  8 23:06:53 2015
Return-Path: <dev-return-84996-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 97CA018DF4
	for <apmail-httpd-dev-archive@www.apache.org>; Tue,  8 Dec 2015 23:06:53 +0000 (UTC)
Received: (qmail 33382 invoked by uid 500); 8 Dec 2015 23:06:50 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 33313 invoked by uid 500); 8 Dec 2015 23:06:50 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 33303 invoked by uid 99); 8 Dec 2015 23:06:50 -0000
Received: from Unknown (HELO spamd3-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 08 Dec 2015 23:06:50 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd3-us-west.apache.org (ASF Mail Server at spamd3-us-west.apache.org) with ESMTP id B3D4C180428
	for <dev@httpd.apache.org>; Tue,  8 Dec 2015 23:06:49 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd3-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.102
X-Spam-Level:
X-Spam-Status: No, score=-0.102 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RCVD_IN_MSPIKE_H2=-0.001, SPF_PASS=-0.001] autolearn=disabled
Authentication-Results: spamd3-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd3-us-west.apache.org [10.40.0.10]) (amavisd-new, port 10024)
	with ESMTP id dDnauOxIqbMj for <dev@httpd.apache.org>;
	Tue,  8 Dec 2015 23:06:49 +0000 (UTC)
Received: from mail-qg0-f48.google.com (mail-qg0-f48.google.com [209.85.192.48])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id 0789942ACE
	for <dev@httpd.apache.org>; Tue,  8 Dec 2015 23:06:49 +0000 (UTC)
Received: by qgec40 with SMTP id c40so42349553qge.2
        for <dev@httpd.apache.org>; Tue, 08 Dec 2015 15:01:45 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        bh=xHWU2e1XzITtjKu9lB+L4sGzyEvb3jWUXLnD6b0azRU=;
        b=wIwyOcZ0aqGjt8/PalB4VKIOzLwqwfYwb+xvDySZmMwfFnrH769WgL+bRkXo5qoOcL
         GECGSY+VbnUFsoV9YFWLzce3pSydb8AkEpYhtyuXdoali4t2BOduMrCXTy7U8+21r+i8
         UoRjJraVydQm9yBvn85at+ZT/svnGYa4pP26MNVuxLFFUJ2clm9U3poC0pL/evWmWVE4
         IFijiUVBNUP+reyZXXHNy+619Vh2YN9y4kcB6iFQd/Bfsvh0aVxtLPQAew2mz89NDK3v
         PCrWKh4QxrE4AKLTZ/fk5Pt2sWAKEaUEUl4znngCRLwwC8vYmGQVEjOr0eZusZ3O5TH8
         nPBw==
MIME-Version: 1.0
X-Received: by 10.55.217.149 with SMTP id q21mr3070336qkl.55.1449615705604;
 Tue, 08 Dec 2015 15:01:45 -0800 (PST)
Received: by 10.55.65.85 with HTTP; Tue, 8 Dec 2015 15:01:45 -0800 (PST)
In-Reply-To: <CAKQ1sVMp+MNmSQrFVDf-62=1WENXYLc9bDXQDU4UfmRoCrau4Q@mail.gmail.com>
References: <56673BF9.8070507@gmail.com>
	<CACsi252ZL7WvqSzVJ8Yf1GaX7LhcJ4eXhK3TS3ypqyv5tkrisQ@mail.gmail.com>
	<CAKQ1sVMp+MNmSQrFVDf-62=1WENXYLc9bDXQDU4UfmRoCrau4Q@mail.gmail.com>
Date: Wed, 9 Dec 2015 00:01:45 +0100
Message-ID: <CAKQ1sVNAQdTwRntn36KcpK0YO+cgBNUuE0XtZ6K3F-1yZjT3gw@mail.gmail.com>
Subject: Re: On the Upgrade request body limit
From: Yann Ylavic <ylavic.dev@gmail.com>
To: httpd-dev <dev@httpd.apache.org>
Content-Type: text/plain; charset=UTF-8

Jacob,

On Tue, Dec 8, 2015 at 11:17 PM, Yann Ylavic <ylavic.dev@gmail.com> wrote:
>
> As I read the RFC, the simple(st) case is:
> Request (upgrade: somespec) -> request body <- 101 (upgrade: somespec)
> <- new protocol response or read

Wouldn't that work for the WebSocket case?
If the new protocol wants to read after the Switch I don't think
anything prevents it...
The headers included in the 101 response could be set by a hook.

From dev-return-84997-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Tue Dec  8 23:27:51 2015
Return-Path: <dev-return-84997-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id A6D6118143
	for <apmail-httpd-dev-archive@www.apache.org>; Tue,  8 Dec 2015 23:27:51 +0000 (UTC)
Received: (qmail 66731 invoked by uid 500); 8 Dec 2015 23:27:51 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 66656 invoked by uid 500); 8 Dec 2015 23:27:51 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 66632 invoked by uid 99); 8 Dec 2015 23:27:51 -0000
Received: from Unknown (HELO spamd1-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 08 Dec 2015 23:27:51 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd1-us-west.apache.org (ASF Mail Server at spamd1-us-west.apache.org) with ESMTP id A7377C39A4
	for <dev@httpd.apache.org>; Tue,  8 Dec 2015 23:27:50 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd1-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.102
X-Spam-Level:
X-Spam-Status: No, score=-0.102 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RCVD_IN_MSPIKE_H2=-0.001, SPF_PASS=-0.001] autolearn=disabled
Authentication-Results: spamd1-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd1-us-west.apache.org [10.40.0.7]) (amavisd-new, port 10024)
	with ESMTP id utzQYOcIe07l for <dev@httpd.apache.org>;
	Tue,  8 Dec 2015 23:27:50 +0000 (UTC)
Received: from mail-pf0-f177.google.com (mail-pf0-f177.google.com [209.85.192.177])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id BCF1B428ED
	for <dev@httpd.apache.org>; Tue,  8 Dec 2015 23:27:49 +0000 (UTC)
Received: by pfbg73 with SMTP id g73so19898852pfb.1
        for <dev@httpd.apache.org>; Tue, 08 Dec 2015 15:27:49 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=subject:to:references:from:message-id:date:user-agent:mime-version
         :in-reply-to:content-type:content-transfer-encoding;
        bh=ibbjaJwjmuWFU4l3HKwiDkrzt60sc6QyldFRPL2xhwU=;
        b=VIeUYKcm6YrRYSBceuQFYhzrILdtMze7UKcqevTaaD3zm1MVeVS90YE4MqbRAafTmm
         oeRRa9Y3yqYJuVjq8IktujTAyYEyBoxn6QRVOndk4dr0tc2VjGG9676hOAsWZcPVXTzu
         FrHkH7adYwPlLMVynwODYNZ9KDVvx6T8iB9e5XTEIdlEDd2oXiqNr/ss/kEthSUCJAFY
         M12Vaf8SXL2YX9QJMfdqmerXQoFMtOAclsJY6RxhRNFKfqsJaVEr9OaX9pRAEnCnYK66
         XQkVTwZjxmrzNB7T+BjwepYwx+5xrCf4vijp4H1AreWQ6q4dMYS6pcQIKmkZAJDg7uFJ
         u6Sw==
X-Received: by 10.98.68.210 with SMTP id m79mr8809983pfi.140.1449617269164;
        Tue, 08 Dec 2015 15:27:49 -0800 (PST)
Received: from [192.168.1.4] (50-39-117-165.bvtn.or.frontiernet.net. [50.39.117.165])
        by smtp.gmail.com with ESMTPSA id 73sm6999616pfh.14.2015.12.08.15.27.47
        for <dev@httpd.apache.org>
        (version=TLSv1/SSLv3 cipher=OTHER);
        Tue, 08 Dec 2015 15:27:47 -0800 (PST)
Subject: Re: On the Upgrade request body limit
To: dev@httpd.apache.org
References: <56673BF9.8070507@gmail.com>
 <CACsi252ZL7WvqSzVJ8Yf1GaX7LhcJ4eXhK3TS3ypqyv5tkrisQ@mail.gmail.com>
 <CAKQ1sVMp+MNmSQrFVDf-62=1WENXYLc9bDXQDU4UfmRoCrau4Q@mail.gmail.com>
 <CAKQ1sVNAQdTwRntn36KcpK0YO+cgBNUuE0XtZ6K3F-1yZjT3gw@mail.gmail.com>
From: Jacob Champion <champion.p@gmail.com>
Message-ID: <56676772.3010407@gmail.com>
Date: Tue, 8 Dec 2015 15:27:46 -0800
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:38.0) Gecko/20100101
 Thunderbird/38.4.0
MIME-Version: 1.0
In-Reply-To: <CAKQ1sVNAQdTwRntn36KcpK0YO+cgBNUuE0XtZ6K3F-1yZjT3gw@mail.gmail.com>
Content-Type: text/plain; charset=utf-8; format=flowed
Content-Transfer-Encoding: 7bit

On 12/08/2015 03:01 PM, Yann Ylavic wrote:
> Jacob,
>
> On Tue, Dec 8, 2015 at 11:17 PM, Yann Ylavic <ylavic.dev@gmail.com> wrote:
>>
>> As I read the RFC, the simple(st) case is:
>> Request (upgrade: somespec) -> request body <- 101 (upgrade: somespec)
>> <- new protocol response or read
>
> Wouldn't that work for the WebSocket case?
> If the new protocol wants to read after the Switch I don't think
> anything prevents it...
> The headers included in the 101 response could be set by a hook.

Sorry I'm responding so slowly; I'm trying to grok all the responses 
before I reply, and they're coming in fast. ;)

Yes, this works fine for the WebSocket case. WebSocket is easier because 
WebSocket upgrades are only allowed for the GET method and there is no 
request body (that I have to worry about, anyway).

The motivation for my original post wasn't WebSocket. I made it with the 
assumption (provided by Stefan) that the h2c upgrade is more limited 
than other protocol upgrades in how big a request body it can handle; 
i.e. that the specs themselves painted mod_http2 into a corner. If that 
assumption is incorrect, and there's a way for it to use the same limit 
as every other request, then I think my discussion point is moot.

--Jacob

From dev-return-84998-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Tue Dec  8 23:57:58 2015
Return-Path: <dev-return-84998-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 6C4901823C
	for <apmail-httpd-dev-archive@www.apache.org>; Tue,  8 Dec 2015 23:57:58 +0000 (UTC)
Received: (qmail 10820 invoked by uid 500); 8 Dec 2015 23:57:57 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 10738 invoked by uid 500); 8 Dec 2015 23:57:57 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 10695 invoked by uid 99); 8 Dec 2015 23:57:57 -0000
Received: from Unknown (HELO spamd3-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 08 Dec 2015 23:57:57 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd3-us-west.apache.org (ASF Mail Server at spamd3-us-west.apache.org) with ESMTP id 541BA180999
	for <dev@httpd.apache.org>; Tue,  8 Dec 2015 23:57:57 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd3-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.102
X-Spam-Level:
X-Spam-Status: No, score=-0.102 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RCVD_IN_MSPIKE_H2=-0.001, SPF_PASS=-0.001] autolearn=disabled
Authentication-Results: spamd3-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd3-us-west.apache.org [10.40.0.10]) (amavisd-new, port 10024)
	with ESMTP id HcnI4aB3aKn5 for <dev@httpd.apache.org>;
	Tue,  8 Dec 2015 23:57:56 +0000 (UTC)
Received: from mail-pa0-f44.google.com (mail-pa0-f44.google.com [209.85.220.44])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id 849C3211C0
	for <dev@httpd.apache.org>; Tue,  8 Dec 2015 23:57:55 +0000 (UTC)
Received: by pacwq6 with SMTP id wq6so19517671pac.1
        for <dev@httpd.apache.org>; Tue, 08 Dec 2015 15:52:53 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=subject:to:references:from:message-id:date:user-agent:mime-version
         :in-reply-to:content-type:content-transfer-encoding;
        bh=8a73C5u8OnwXeLUlExUwX/Ebu3jsR038Gm/TVGnIHKU=;
        b=wmVYariv9eWHd77wiJpXS7hRI488qFzR8zsaiFN+UM67OVCvbgVjo7AsS+kNB2g3OF
         04XWIg6yIPN8VsVW+DKIxG9JgN33q+2zUt3ijpAyLZ4KJ25HfjPg/wHCnHhRrGrVS8gp
         0MSCdEi6mcHL+QsWtKHYCGlcja6+/WFahnlfpDGM/YBAXs/r0gstzhUPgWrevkPyw+y/
         dc0nsVoMDqdLDvhUxBTFTy9AOrEFx2N9bSd/zE1ACRL30mwiducaSipHBdee2V5ih2Qg
         WwrqMgnfWKVbkUQ/u+qSJsVIOd4XkTRPFUQ09j0oLCB7i9zP9MDQ8S2myMWzJPMCreyd
         f8/g==
X-Received: by 10.66.139.131 with SMTP id qy3mr3815534pab.71.1449618773126;
        Tue, 08 Dec 2015 15:52:53 -0800 (PST)
Received: from [192.168.1.4] (50-39-117-165.bvtn.or.frontiernet.net. [50.39.117.165])
        by smtp.gmail.com with ESMTPSA id z13sm7068804pfi.11.2015.12.08.15.52.52
        for <dev@httpd.apache.org>
        (version=TLSv1/SSLv3 cipher=OTHER);
        Tue, 08 Dec 2015 15:52:52 -0800 (PST)
Subject: Re: On the Upgrade request body limit
To: dev@httpd.apache.org
References: <56673BF9.8070507@gmail.com>
 <CACsi252ZL7WvqSzVJ8Yf1GaX7LhcJ4eXhK3TS3ypqyv5tkrisQ@mail.gmail.com>
From: Jacob Champion <champion.p@gmail.com>
Message-ID: <56676D53.205@gmail.com>
Date: Tue, 8 Dec 2015 15:52:51 -0800
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:38.0) Gecko/20100101
 Thunderbird/38.4.0
MIME-Version: 1.0
In-Reply-To: <CACsi252ZL7WvqSzVJ8Yf1GaX7LhcJ4eXhK3TS3ypqyv5tkrisQ@mail.gmail.com>
Content-Type: text/plain; charset=utf-8; format=flowed
Content-Transfer-Encoding: 7bit

On 12/08/2015 02:00 PM, William A Rowe Jr wrote:
> Apache httpd server offers limits on the
> number of incoming headers, the number of bytes in those headers, the
> number of bytes in the request line, the length of the URI.  The maximum
> request body length.  This is just one more limit, but not an actual
> *limitation*, because the request will be processed, simply not by
> changing protocols first, per RFC7230.

I agree with your point -- that's what I was trying to point out with my 
OP -- but I think general-purpose clients that are trying to ensure 
their upgrades succeed as quickly as possible, as often as possible, and 
are thwarted in that by an invisible request body limit, might consider 
it a limitation. That the request succeeds is not necessarily their only 
design goal.

> As I'll point out again in closing, h2c isn't defined by RFC7230, and if
> it decides to ignore requests with bodies, that's up to mod_http2 and
> other implementations.  But RFC7230 has nothing to say to h2c on this,
> and rather encourages protocol implementors to accept already-read C-L
> or T-E: chunked request bodies in a hand-over into their upgraded protocol.

Agreed. And like I said in my response to Yann, if it turns out that the 
arbitrary upgrade-body-limit for h2c can be done away with entirely, an 
official addition to HTTP would be completely unnecessary.

> There is no need for the client to determine the upgrade limit, because
> the body of the request is sent.  If the server -arbitrarily- chooses to
> satisfy it, there will be a 101 following the body transmission.  But
> the spec makes absolutely clear that it is the server's prerogative to
> upgrade or not, irrespective of the particular upgrade requested.
>
> If the server demands that the upgrade happen, before a request can be
> honored, it must reply with a 426 until the client offers to upgrade.
> If the client demands that the upgrade happen, it must perform the
> simplest applicable request (e.g. OPTIONS *) with the desired upgrade
> semantics and verify that the upgrade occurred.

Stefan is, I think, adding more shades of grey here. OPTIONS * is the 
most likely upgrade to succeed, but also guarantees the addition of an 
"unnecessary" (depending on your point of view) round-trip. Clients may 
be willing to make a trade-off in initial success rate for an average 
increase in performance, but not if the server implementations are so 
different that their success rate plummets.

Whether this is enough of a concern to "fix" is a matter of opinion. But 
it appears that there has already been an agreement of sorts to reject 
h2c response bodies from the major implementors, if I understood Stefan 
correctly, so they at least are concerned. It would be nice to read that 
conversation.

>     2) returning 413 during an upgrade would be ambiguous anyway. Is the
>     413 really related to the request target, or is it just because I
>     tried to upgrade and my request was temporarily limited?
>
>
> It never would.  The possible results are the normal response in
> http/1.1 protocol, or 426 to tell the client it still must change
> protocols first.

I'm not sure I understand what you mean. My point was simply that while 
a pure HTTP/1.1 client implementation can try to optimize its "limits 
discovery" through the use of a 100-continue handshake, and immediately 
making adjustments if a 4xx comes back, clients have no way to apply the 
same discovery to an artificial limit on upgrade-requests.

And again, whether such a limit is justified to begin with still remains 
to be seen, I think.

> Define complex, robust.  Request (upgrade: somespec) -> 100 continue ->
> request body <- [ http/1.1 response | 101 - switching protocols <- new
> protocol response ].

Hopefully I've clarified what I mean by this -- not "robust" in terms of 
whether the request breaks or not, but "robust" in terms of a high 
success rate for optimally-performant upgrades to h2c.

--Jacob

From dev-return-84999-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Wed Dec  9 03:11:12 2015
Return-Path: <dev-return-84999-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 0EF4518958
	for <apmail-httpd-dev-archive@www.apache.org>; Wed,  9 Dec 2015 03:11:12 +0000 (UTC)
Received: (qmail 82483 invoked by uid 500); 9 Dec 2015 03:11:11 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 82411 invoked by uid 500); 9 Dec 2015 03:11:11 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 82373 invoked by uid 99); 9 Dec 2015 03:11:10 -0000
Received: from Unknown (HELO spamd1-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 09 Dec 2015 03:11:10 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd1-us-west.apache.org (ASF Mail Server at spamd1-us-west.apache.org) with ESMTP id 20233C6D9D
	for <dev@httpd.apache.org>; Wed,  9 Dec 2015 03:11:10 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd1-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.1
X-Spam-Level:
X-Spam-Status: No, score=-0.1 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RCVD_IN_MSPIKE_H2=-0.001, URIBL_BLOCKED=0.001] autolearn=disabled
Authentication-Results: spamd1-us-west.apache.org (amavisd-new);
	dkim=pass (1024-bit key) header.d=gbiv.com
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd1-us-west.apache.org [10.40.0.7]) (amavisd-new, port 10024)
	with ESMTP id j3YeqkyFfRyb for <dev@httpd.apache.org>;
	Wed,  9 Dec 2015 03:10:58 +0000 (UTC)
Received: from homiemail-a49.g.dreamhost.com (sub4.mail.dreamhost.com [69.163.253.135])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTP id 909A044527
	for <dev@httpd.apache.org>; Wed,  9 Dec 2015 03:10:58 +0000 (UTC)
Received: from homiemail-a49.g.dreamhost.com (localhost [127.0.0.1])
	by homiemail-a49.g.dreamhost.com (Postfix) with ESMTP id 09125200D30A6
	for <dev@httpd.apache.org>; Tue,  8 Dec 2015 19:10:52 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha1; c=relaxed; d=gbiv.com; h=content-type
	:mime-version:subject:from:in-reply-to:date
	:content-transfer-encoding:message-id:references:to; s=gbiv.com;
	 bh=lAqgz3z+E4AoMXAK2FyvQKXxOyg=; b=T3FpsxmuRCy0EwB9PTJXQS6nApJm
	1fS7oaURE73QKNAU/wM/OLHmuP2Xi8zofKZKEUufFlZivdDnoeMoD9wLmTpOybMQ
	lIZT4y37uFJIr6WTWlULadSnJl1AdwBK8LSpJI8llRBkruL9YdYMYpnPtfweT9E6
	ZxyjIQMVyrlR61c=
Received: from [192.168.1.2] (ip68-228-71-159.oc.oc.cox.net [68.228.71.159])
	(using TLSv1 with cipher ECDHE-RSA-AES256-SHA (256/256 bits))
	(No client certificate requested)
	(Authenticated sender: fielding@gbiv.com)
	by homiemail-a49.g.dreamhost.com (Postfix) with ESMTPSA id E9DBA200D30A0
	for <dev@httpd.apache.org>; Tue,  8 Dec 2015 19:10:51 -0800 (PST)
Content-Type: text/plain; charset=us-ascii
Mime-Version: 1.0 (Mac OS X Mail 8.2 \(2104\))
Subject: Re: Upgrade Summary
From: "Roy T. Fielding" <fielding@gbiv.com>
In-Reply-To: <13FE9E7F-9620-4BF9-8EA4-57A6314D66BF@greenbytes.de>
Date: Tue, 8 Dec 2015 19:10:51 -0800
Content-Transfer-Encoding: quoted-printable
Message-Id: <9CCEFD7E-9ED3-4ED1-8F58-2134DD5310F9@gbiv.com>
References: <CACsi250=dbRQKnsbE8JSdAZRm5x99gE0sgX3iQ-PHAx77euD1A@mail.gmail.com> <AB1691BE05AE7F4992697F2A0835627AC63BAB94@VOEXM10W.internal.vodafone.com> <F7B20D30-D34A-4805-A77D-F64F6428F6E3@greenbytes.de> <56660896.c74fc20a.15f56.0ebd@mx.google.com> <56660B43.2060507@gmail.com> <6B13DF2B-0586-42BB-B62F-59A7638B697D@greenbytes.de> <13FE9E7F-9620-4BF9-8EA4-57A6314D66BF@greenbytes.de>
To: dev@httpd.apache.org
X-Mailer: Apple Mail (2.2104)

> On Dec 8, 2015, at 2:07 AM, Stefan Eissing =
<stefan.eissing@greenbytes.de> wrote:
>=20
> Trying to summarize the status of the discussion and where the issues =
are with the current Upgrade implementation.
>=20
> Clarified:
> A. any 100 must be sent out *before* a 101 response
> B. request bodies are to be read in the original protocol, input =
filters like chunk can be used, indeed are necessary, as if the request =
is being processed normally

Yes.

> C. if a protocol supports upgrade on request bodies is up to the =
protocol implementation and needs to be checked in the "propose" phase

In some respects, yes, but Upgrade is defined by HTTP/1 and no other
protocol applies until after it is done.  That means ignoring any
idiotic handshake requirements of the "new" protocol that aren't
consistent with HTTP/1.  It also means h2's requirements on Upgrade
are irrelevant except for when it requires not upgrading to h2.

The client's assumption must be that the Upgrade will fail and any
attempt to use Expect will timeout, so the entire message will be
sent eventually regardless of anyone's stupid hacks to try and game
the protocol.  Hence, the server has no choice but to receive the
entire message as HTTP/1.1 even if it thinks it could have responded
fast enough to interrupt the client in mid-send.

>=20
> Open:
> 1. Protocols like Websocket need to take over the 101 sending =
themselves in the "switch protocol" phase. (correct, Jacob?). Should we =
delegate the sending of the 101 to the protocol switch handler?

That seems unlikely.

> 2. General handling of request bodies. Options:
>  a setaside in core of up to nnn bytes before switch invocation
>  b do nothing, let protocol switch handler care about it

I think folks are confusing implementation with protocol.  There is no =
need
for the protocol being read on a connection to be the same protocol that =
is
being written in response.  In other words, the incoming connection =
remains
reading HTTP/1 bits until the message is finished, regardless of the =
decision
to upgrade the response stream -- the other protocol engine doesn't =
care.

This should be easily handled by adding a filter that translates the =
HTTP/1
incoming body (if any) to a single channel of the new protocol.  Just =
fake it.
There is no need to wait or set aside the bytes, unless that is desired =
for
other reasons (e.g., denial of denial of service attacks).

> 3. When to do the upgrade dance:
>  a post_read_request: upgrade precedes authentication
>  b handler: upgrade only honored on authenticated and otherwise ok =
requests
>  c both: introduce separate hooks? have an additional parameter? more =
complexity

(a).  We do want to upgrade non-ok responses.  If the "new" protocol =
wants to
send a canned HTTP/1.1 error, it can do so without our help.

> 4. status code of protocol switch handler: if we move the task of 101 =
sending, the switch handler might not do it and keep the connection on =
the "old" protocol. Then a connection close is not necessary. So, we =
would do the close only when the switch handler returns APR_EOF.

Eh?

> 5. Will it be possible to migrate the current TLS upgrade handling to =
this revised scheme?

TLS upgrade is never done with a body (and is broken code anyway).  Just =
fix it.
Note that the upgrade token is "TLS" -- it does not have to be =
"TLS/1.0".

....Roy


From dev-return-85000-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Wed Dec  9 07:02:32 2015
Return-Path: <dev-return-85000-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 5642418FA4
	for <apmail-httpd-dev-archive@www.apache.org>; Wed,  9 Dec 2015 07:02:32 +0000 (UTC)
Received: (qmail 18015 invoked by uid 500); 9 Dec 2015 07:02:31 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 17939 invoked by uid 500); 9 Dec 2015 07:02:31 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 17929 invoked by uid 99); 9 Dec 2015 07:02:31 -0000
Received: from Unknown (HELO spamd1-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 09 Dec 2015 07:02:31 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd1-us-west.apache.org (ASF Mail Server at spamd1-us-west.apache.org) with ESMTP id 30A6EC6DA2
	for <dev@httpd.apache.org>; Wed,  9 Dec 2015 07:02:31 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd1-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.121
X-Spam-Level:
X-Spam-Status: No, score=-0.121 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RCVD_IN_MSPIKE_H3=-0.01, RCVD_IN_MSPIKE_WL=-0.01, SPF_PASS=-0.001]
	autolearn=disabled
Authentication-Results: spamd1-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd1-us-west.apache.org [10.40.0.7]) (amavisd-new, port 10024)
	with ESMTP id y7LfvC1-KwBw for <dev@httpd.apache.org>;
	Wed,  9 Dec 2015 07:02:30 +0000 (UTC)
Received: from mail-wm0-f41.google.com (mail-wm0-f41.google.com [74.125.82.41])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id 4C05142BB8
	for <dev@httpd.apache.org>; Wed,  9 Dec 2015 07:02:30 +0000 (UTC)
Received: by wmec201 with SMTP id c201so59610235wme.1
        for <dev@httpd.apache.org>; Tue, 08 Dec 2015 23:02:23 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=subject:to:references:from:message-id:date:user-agent:mime-version
         :in-reply-to:content-type:content-transfer-encoding;
        bh=Bg9QIcmDQiIkBswkQyDafN+RsBUrXGPkdfgAFPBOMhY=;
        b=OV9AETJVEjiGyiZz0tYkaAc+FSVB/9UkNXws2OHK3vEZH70gB/OKNZtQQJjdE4fUwH
         0UY3dIlHRoz44NvDh/F4LntrTk5MbtlLqG//+ZjYyNfRsajt4U8VtjDFXQKSIUVHqy5b
         02iizKTkzDf0/fEfweAhRzWRydcTY8IK/rk4fVvv+0dFXNe7v2BYcZG3PM+oJMDcsmn4
         dttUyxgZixs1pzYb2Be3Ji5WTiZ87+hypebV9JYFauOqQ6uOJBO1H9Zx8f5NttYNFIx4
         0NUuaxnaIHGqeefC5xq1UO8pbodSEz7yQkEYxUvq5cPsxWegQiTmObnkwEfVccM96oB9
         HdGQ==
X-Received: by 10.28.142.83 with SMTP id q80mr9593307wmd.66.1449644542861;
        Tue, 08 Dec 2015 23:02:22 -0800 (PST)
Received: from [10.33.144.3] (nat-pool-gva-t.redhat.com. [209.132.186.32])
        by smtp.gmail.com with ESMTPSA id z13sm6125453wjr.47.2015.12.08.23.02.21
        for <dev@httpd.apache.org>
        (version=TLS1_2 cipher=ECDHE-RSA-AES128-GCM-SHA256 bits=128/128);
        Tue, 08 Dec 2015 23:02:21 -0800 (PST)
Subject: Re: reverse proxy wishlist
To: dev@httpd.apache.org
References: <288293CD-6D82-42E0-BFC9-9DC25F969ED6@jaguNET.com>
From: jean-frederic clere <jfclere@gmail.com>
Message-ID: <5667D1FC.9070202@gmail.com>
Date: Wed, 9 Dec 2015 08:02:20 +0100
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:38.0) Gecko/20100101
 Thunderbird/38.4.0
MIME-Version: 1.0
In-Reply-To: <288293CD-6D82-42E0-BFC9-9DC25F969ED6@jaguNET.com>
Content-Type: text/plain; charset=windows-1252
Content-Transfer-Encoding: 7bit

On 12/03/2015 03:59 PM, Jim Jagielski wrote:
> I put out a call on Twitter regarding this, but wanted to
> close the loop here as well.
> 
> What would *you* like to see as new features or enhancements
> w/ mod_proxy, esp reverse proxy. I was thinking about some
> sort of active backend monitoring, utilizing watchdog, which
> could also maybe, eventually, pull in performance and load
> data for the backend for a more accurate LB provider. But
> what about new LB methods? Any ideas there?

I need a more dynamic list of workers and balancers basically in
mod_cluster we are able to add and remove those. Our health check is
done by the nodes which also requires some changes in the proxy logic too.

Cheers

Jean-Frederic


From dev-return-85001-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Wed Dec  9 07:11:17 2015
Return-Path: <dev-return-85001-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 4FFFD18FEC
	for <apmail-httpd-dev-archive@www.apache.org>; Wed,  9 Dec 2015 07:11:17 +0000 (UTC)
Received: (qmail 33155 invoked by uid 500); 9 Dec 2015 07:11:16 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 33089 invoked by uid 500); 9 Dec 2015 07:11:16 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 33079 invoked by uid 99); 9 Dec 2015 07:11:16 -0000
Received: from Unknown (HELO spamd2-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 09 Dec 2015 07:11:16 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd2-us-west.apache.org (ASF Mail Server at spamd2-us-west.apache.org) with ESMTP id 284BE1A1043
	for <dev@httpd.apache.org>; Wed,  9 Dec 2015 07:11:16 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd2-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.121
X-Spam-Level:
X-Spam-Status: No, score=-0.121 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RCVD_IN_MSPIKE_H3=-0.01, RCVD_IN_MSPIKE_WL=-0.01, SPF_PASS=-0.001]
	autolearn=disabled
Authentication-Results: spamd2-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd2-us-west.apache.org [10.40.0.9]) (amavisd-new, port 10024)
	with ESMTP id cFAMdzD7Od6X for <dev@httpd.apache.org>;
	Wed,  9 Dec 2015 07:11:15 +0000 (UTC)
Received: from mail-wm0-f54.google.com (mail-wm0-f54.google.com [74.125.82.54])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id F136F24D8F
	for <dev@httpd.apache.org>; Wed,  9 Dec 2015 07:11:14 +0000 (UTC)
Received: by wmww144 with SMTP id w144so59674389wmw.0
        for <dev@httpd.apache.org>; Tue, 08 Dec 2015 23:11:14 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=subject:to:references:from:message-id:date:user-agent:mime-version
         :in-reply-to:content-type:content-transfer-encoding;
        bh=lej+p1K1LD+tGg+Qh3ScCCD0++/sf5wSaVTVMteS3vc=;
        b=T0ImJoaETxhvqs0qQJU6mYfqh2IXMmpoG621RKs9dYNBpXtbxTod5CzMf7n2FGkgq5
         28AiFzBOL751Y1DJKB92O1cj1j4Q4Kn2YkXbxl8e/wUgPsaXOzUxBsAw5/V3tgol7ABP
         ozqjDALUP4ZwDZlnG6c/3v7OGXvMBzIKx6skcbGhOuB4SuIG5ZYXWqBNkLcJxcsWsAYg
         5sO47MT01QjoAn3x6Z+rdMBboASlePIZ+cajzC6OJMfENCqjs7KZcUp0Sm+jM20JZgAm
         urGsX3EvZ4MVvrKMOQIZ8MM60NcYp8eB0Tmj869BlKD6/RsluyvUycvRZgeZ2kW54txZ
         FMPQ==
X-Received: by 10.194.21.101 with SMTP id u5mr4435932wje.103.1449645074681;
        Tue, 08 Dec 2015 23:11:14 -0800 (PST)
Received: from [10.33.144.3] (nat-pool-gva-t.redhat.com. [209.132.186.32])
        by smtp.gmail.com with ESMTPSA id z17sm6243182wjq.1.2015.12.08.23.11.13
        for <dev@httpd.apache.org>
        (version=TLS1_2 cipher=ECDHE-RSA-AES128-GCM-SHA256 bits=128/128);
        Tue, 08 Dec 2015 23:11:14 -0800 (PST)
Subject: Re: reverse proxy wishlist
To: dev@httpd.apache.org
References: <288293CD-6D82-42E0-BFC9-9DC25F969ED6@jaguNET.com>
 <AB1691BE05AE7F4992697F2A0835627AC63B8989@VOEXM10W.internal.vodafone.com>
 <a138da8b6df34d42a588f5a729ede044@DC01PXMBP007.jacksonnational.com>
 <CALK=YjO=POeknBmC-SiBKD+ZmnsaP74SOwu25UBgCdh5VGBjOQ@mail.gmail.com>
 <72469bbdabd24f17a14f79729985cc4d@DC01PXMBP007.jacksonnational.com>
From: jean-frederic clere <jfclere@gmail.com>
Message-ID: <5667D411.3090707@gmail.com>
Date: Wed, 9 Dec 2015 08:11:13 +0100
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:38.0) Gecko/20100101
 Thunderbird/38.4.0
MIME-Version: 1.0
In-Reply-To: <72469bbdabd24f17a14f79729985cc4d@DC01PXMBP007.jacksonnational.com>
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit

On 12/03/2015 07:39 PM, Houser, Rick wrote:
> I would definitely expect to see a substantial improvement if the thread reservation could be delayed until the response headers are fully received.

That is something tricky you need to mix blocking and non-blocking of
have a bunch (configurable) threads that receive the data and are able
to know they have a complete message they can forward to the worker
thread that does the send (which also needs a bunch of threads dedicated
to send in a non-blocking way to the client).

Cheers

Jean-Frederic

From dev-return-85002-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Wed Dec  9 12:54:49 2015
Return-Path: <dev-return-85002-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 4B5DB18E25
	for <apmail-httpd-dev-archive@www.apache.org>; Wed,  9 Dec 2015 12:54:49 +0000 (UTC)
Received: (qmail 69309 invoked by uid 500); 9 Dec 2015 12:54:48 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 69234 invoked by uid 500); 9 Dec 2015 12:54:48 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 69224 invoked by uid 99); 9 Dec 2015 12:54:48 -0000
Received: from Unknown (HELO spamd2-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 09 Dec 2015 12:54:48 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd2-us-west.apache.org (ASF Mail Server at spamd2-us-west.apache.org) with ESMTP id 2B2291A0A6E
	for <dev@httpd.apache.org>; Wed,  9 Dec 2015 12:54:48 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd2-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 0.652
X-Spam-Level:
X-Spam-Status: No, score=0.652 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, SPF_NEUTRAL=0.652]
	autolearn=disabled
Authentication-Results: spamd2-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=comcast.net
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd2-us-west.apache.org [10.40.0.9]) (amavisd-new, port 10024)
	with ESMTP id Taxn5j4q6PbK for <dev@httpd.apache.org>;
	Wed,  9 Dec 2015 12:54:41 +0000 (UTC)
Received: from resqmta-ch2-12v.sys.comcast.net (resqmta-ch2-12v.sys.comcast.net [69.252.207.44])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id C25A820F4F
	for <dev@httpd.apache.org>; Wed,  9 Dec 2015 12:54:40 +0000 (UTC)
Received: from resomta-ch2-10v.sys.comcast.net ([69.252.207.106])
	by resqmta-ch2-12v.sys.comcast.net with comcast
	id rQtQ1r0042JGN3p01QuYHX; Wed, 09 Dec 2015 12:54:32 +0000
Received: from [192.168.199.10] ([69.251.84.114])
	by resomta-ch2-10v.sys.comcast.net with comcast
	id rQuY1r0082U0RYt01QuYlN; Wed, 09 Dec 2015 12:54:32 +0000
Content-Type: text/plain; charset=windows-1252
Mime-Version: 1.0 (Mac OS X Mail 9.2 \(3112\))
Subject: Re: reverse proxy wishlist
From: Jim Jagielski <jim@jaguNET.com>
In-Reply-To: <5667D1FC.9070202@gmail.com>
Date: Wed, 9 Dec 2015 07:54:32 -0500
Content-Transfer-Encoding: 7bit
Message-Id: <FA4AB02A-FF0A-4AED-ADE9-2C50BF703D39@jaguNET.com>
References: <288293CD-6D82-42E0-BFC9-9DC25F969ED6@jaguNET.com> <5667D1FC.9070202@gmail.com>
To: dev@httpd.apache.org
X-Mailer: Apple Mail (2.3112)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=comcast.net;
	s=q20140121; t=1449665672;
	bh=s6CZhKGO3HsIgXVVhbCReSmXyIY5dbSfsmyft8GmZJE=;
	h=Received:Received:Content-Type:Mime-Version:Subject:From:Date:
	 Message-Id:To;
	b=Gc9SRorE4F7hATuk09tBv2Jipn+IRvL7TmrWPR2+nHYfHlsbUswmILh3SFfXNPk+X
	 qPRgZv6L5U+MG2zonO+NaGN68Q/4voch0+LaSafHRn68EJ8oV9Mh6CZcdIYmAHGDTs
	 l4glyQRcl7Jcm2I81EOg+HhsyaLjxnX2mGOnc1Qd5pcg8NDJ/s9VrEldvw5Gm+UPqf
	 epPtlXe7pupvYx0tuXmr9vC6k3ka+9k+x+86hOAM/zCmCE41v0HqcfkZjYZVwvLHVe
	 lkNENsZoG3EL+xrnFnlaI0Rze7Bg9muMSG82ERn+DC0a9MKY7rb+bea6i90Clc06GZ
	 oddVY0VxzfuMQ==


> On Dec 9, 2015, at 2:02 AM, jean-frederic clere <jfclere@gmail.com> wrote:
> 
> On 12/03/2015 03:59 PM, Jim Jagielski wrote:
>> I put out a call on Twitter regarding this, but wanted to
>> close the loop here as well.
>> 
>> What would *you* like to see as new features or enhancements
>> w/ mod_proxy, esp reverse proxy. I was thinking about some
>> sort of active backend monitoring, utilizing watchdog, which
>> could also maybe, eventually, pull in performance and load
>> data for the backend for a more accurate LB provider. But
>> what about new LB methods? Any ideas there?
> 
> I need a more dynamic list of workers and balancers basically in
> mod_cluster we are able to add and remove those.

Yeah, adding balancers has been on my TODO for awhile and I have
some krufty implementations scattered around. I think most of
the main hooks and scars are already in trunk and httpd-2.4,
it's just the actual impl.

Does mod_cluster actually allow you to remove, or just
disable?

> Our health check is
> done by the nodes which also requires some changes in the proxy logic too.

For healthcheck I was thinking of just using our watchdog
and allowing it to update the balancer and worker's shared
memory as needed.

From dev-return-85003-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Wed Dec  9 13:49:44 2015
Return-Path: <dev-return-85003-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 33372172B1
	for <apmail-httpd-dev-archive@www.apache.org>; Wed,  9 Dec 2015 13:49:44 +0000 (UTC)
Received: (qmail 15840 invoked by uid 500); 9 Dec 2015 13:49:43 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 15757 invoked by uid 500); 9 Dec 2015 13:49:43 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 15745 invoked by uid 99); 9 Dec 2015 13:49:42 -0000
Received: from Unknown (HELO spamd1-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 09 Dec 2015 13:49:42 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd1-us-west.apache.org (ASF Mail Server at spamd1-us-west.apache.org) with ESMTP id 922CDC9A36
	for <dev@httpd.apache.org>; Wed,  9 Dec 2015 13:49:42 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd1-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.111
X-Spam-Level:
X-Spam-Status: No, score=-0.111 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	SPF_PASS=-0.001, T_RP_MATCHES_RCVD=-0.01] autolearn=disabled
Authentication-Results: spamd1-us-west.apache.org (amavisd-new);
	dkim=pass (1024-bit key) header.d=greenbytes.de
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd1-us-west.apache.org [10.40.0.7]) (amavisd-new, port 10024)
	with ESMTP id xtzUA58-CxTN for <dev@httpd.apache.org>;
	Wed,  9 Dec 2015 13:49:41 +0000 (UTC)
Received: from mail.greenbytes.de (mail.greenbytes.de [217.91.35.233])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id 401F820F4F
	for <dev@httpd.apache.org>; Wed,  9 Dec 2015 13:49:41 +0000 (UTC)
Received: from [192.168.1.42] (unknown [217.91.35.233])
	(using TLSv1 with cipher ECDHE-RSA-AES256-SHA (256/256 bits))
	(Client did not present a certificate)
	by mail.greenbytes.de (Postfix) with ESMTPSA id 9906C15A047F
	for <dev@httpd.apache.org>; Wed,  9 Dec 2015 14:49:40 +0100 (CET)
DKIM-Signature: v=1; a=rsa-sha256; c=simple/simple; d=greenbytes.de; s=mail;
	t=1449668980; bh=BwL5Hr/mt7Owa9alaWQK2Aj3USYbfRRweXMaAUaRMvE=;
	h=From:Subject:Date:To:From;
	b=LHKH9Ql6Avdtr72emXbc4zo6M5feIispEDa1GnfYn+hsVgJGt4avfOBVgp7+8r6SL
	 9xOh3FUmr4aLqSeDADUndSAgvvJrSeDOUCcSwO9cS4LJQ8/6qDpgNOP8EZocTNT9p7
	 14QXPsem61HvZc0w7um3zhPP31FEWPAvCkcA57KY=
From: Stefan Eissing <stefan.eissing@greenbytes.de>
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: quoted-printable
Subject: scoreboard and http2
Message-Id: <4B4BC185-927B-40C2-BD51-7F9CA46FA3E3@greenbytes.de>
Date: Wed, 9 Dec 2015 14:49:40 +0100
To: dev@httpd.apache.org
Mime-Version: 1.0 (Mac OS X Mail 9.2 \(3112\))
X-Mailer: Apple Mail (2.3112)

For the next 2.4 release, I would like to add scoreboard support to =
mod_http2.

There are several options for doing so and I would like your feedback on =
which
route we should take. I try to outline what options I see:

A) Make mod_http2 workers general MPM workers. They would then become
   part of scoreboard without changes to the board itself.
B) Extend scoreboard to handle "thread sets", where MPM threads are the =
set it has
   not. mod_http2 would register a new set. scoreboard handles, an =
opaque struct
   pointer for everyone, would get an additional "set id".
C) Mix both. MPM has thread sets and scoreboard learns to handle them.=20=


Discussion:
1. A), doing it naively, will mess heavily with MPM module code. MPM =
modules now
   use for(0...num_threads) {} heavily to setup threads that handle =
sockets and
   pollsets and other nice things. This is not relevant for the http2 =
workers which
   are, framed more generally, "slave connection workers", whereas the =
current MPM
   threads are "master connection workers".
2. B) will not mess with MPM at all, just extend scoreboard and =
mod_status. mod_http2
   would register itself for a new thread set and update the status =
regularly. This
   approach offers least API disturbance for a backport to 2.4.x
3. C) is an extension of B). Thread sets get registered at MPM, =
scoreboard interrogates
   the new MPM sets and can hand out "scoreboard handles" for them. =
Bringing these sets
   into the MPM could be done, so that spare threads are shared between =
different sets.
   Don't know if that's desirable.
4. For mod_http2, the existing status indicators will continue to work, =
as slave=20
   connection workers do the same tasks as MPM threads, more or less. =
For more flexible
   use, one could provide for status indicators provided by the =
registrar.

Thoughts?

//Stefan


From dev-return-85004-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Wed Dec  9 13:57:58 2015
Return-Path: <dev-return-85004-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 87B3C17302
	for <apmail-httpd-dev-archive@www.apache.org>; Wed,  9 Dec 2015 13:57:58 +0000 (UTC)
Received: (qmail 37289 invoked by uid 500); 9 Dec 2015 13:57:57 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 37211 invoked by uid 500); 9 Dec 2015 13:57:57 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 37201 invoked by uid 99); 9 Dec 2015 13:57:57 -0000
Received: from Unknown (HELO spamd3-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 09 Dec 2015 13:57:57 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd3-us-west.apache.org (ASF Mail Server at spamd3-us-west.apache.org) with ESMTP id 4A04F1809BB
	for <dev@httpd.apache.org>; Wed,  9 Dec 2015 13:57:57 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd3-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.554
X-Spam-Level:
X-Spam-Status: No, score=-0.554 tagged_above=-999 required=6.31
	tests=[RP_MATCHES_RCVD=-0.554, SPF_PASS=-0.001, URIBL_BLOCKED=0.001]
	autolearn=disabled
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd3-us-west.apache.org [10.40.0.10]) (amavisd-new, port 10024)
	with ESMTP id i3YxR0By7vTR for <dev@httpd.apache.org>;
	Wed,  9 Dec 2015 13:57:48 +0000 (UTC)
Received: from monica.sharp.fm (monica.sharp.fm [80.168.143.5])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTP id E42AB20CC6
	for <dev@httpd.apache.org>; Wed,  9 Dec 2015 13:57:47 +0000 (UTC)
Received: from [10.105.35.208] (unknown [5.56.169.80])
	(using TLSv1 with cipher DHE-RSA-AES256-SHA (256/256 bits))
	(Client did not present a certificate)
	(Authenticated sender: minfrin@sharp.fm)
	by monica.sharp.fm (Postfix) with ESMTPSA id 113E68203C
	for <dev@httpd.apache.org>; Wed,  9 Dec 2015 13:57:47 +0000 (GMT)
Content-Type: text/plain; charset=utf-8
Mime-Version: 1.0 (Mac OS X Mail 8.2 \(2104\))
Subject: Re: scoreboard and http2
From: Graham Leggett <minfrin@sharp.fm>
In-Reply-To: <4B4BC185-927B-40C2-BD51-7F9CA46FA3E3@greenbytes.de>
Date: Wed, 9 Dec 2015 15:57:46 +0200
Content-Transfer-Encoding: quoted-printable
Message-Id: <54570F93-263A-4BDA-9E62-5AB4AA8330DE@sharp.fm>
References: <4B4BC185-927B-40C2-BD51-7F9CA46FA3E3@greenbytes.de>
To: dev@httpd.apache.org
X-Mailer: Apple Mail (2.2104)

On 09 Dec 2015, at 3:49 PM, Stefan Eissing =
<stefan.eissing@greenbytes.de> wrote:

> For the next 2.4 release, I would like to add scoreboard support to =
mod_http2.
>=20
> There are several options for doing so and I would like your feedback =
on which
> route we should take. I try to outline what options I see:
>=20
> A) Make mod_http2 workers general MPM workers. They would then become
>   part of scoreboard without changes to the board itself.

It is the goal of the MPM to care about the architecture of the machine, =
and know about processes/threads/etc.

Option A is the only real option - we cannot allow the h2 stuff to mess =
up the clean separation between the architecture of each platform and =
the core of the server itself.

Regards,
Graham
=E2=80=94


From dev-return-85005-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Wed Dec  9 14:04:54 2015
Return-Path: <dev-return-85005-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 0D8311736D
	for <apmail-httpd-dev-archive@www.apache.org>; Wed,  9 Dec 2015 14:04:54 +0000 (UTC)
Received: (qmail 60855 invoked by uid 500); 9 Dec 2015 14:04:53 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 60779 invoked by uid 500); 9 Dec 2015 14:04:52 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 60769 invoked by uid 99); 9 Dec 2015 14:04:52 -0000
Received: from Unknown (HELO spamd3-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 09 Dec 2015 14:04:52 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd3-us-west.apache.org (ASF Mail Server at spamd3-us-west.apache.org) with ESMTP id 636BD1809CD
	for <dev@httpd.apache.org>; Wed,  9 Dec 2015 14:04:52 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd3-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 1
X-Spam-Level: *
X-Spam-Status: No, score=1 tagged_above=-999 required=6.31
	tests=[KAM_LAZY_DOMAIN_SECURITY=1, SPF_HELO_PASS=-0.001,
	URIBL_BLOCKED=0.001] autolearn=disabled
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd3-us-west.apache.org [10.40.0.10]) (amavisd-new, port 10024)
	with ESMTP id m4fw3TN7_GiU for <dev@httpd.apache.org>;
	Wed,  9 Dec 2015 14:04:40 +0000 (UTC)
Received: from mail1.bemta5.messagelabs.com (mail1.bemta5.messagelabs.com [195.245.231.146])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id A53A524D8F
	for <dev@httpd.apache.org>; Wed,  9 Dec 2015 14:04:39 +0000 (UTC)
Received: from [85.158.139.163] by server-10.bemta-5.messagelabs.com id 97/68-17090-0F438665; Wed, 09 Dec 2015 14:04:32 +0000
X-Env-Sender: ruediger.pluem@vodafone.com
X-Msg-Ref: server-10.tower-188.messagelabs.com!1449669872!5376489!1
X-Originating-IP: [195.232.244.133]
X-StarScan-Received:
X-StarScan-Version: 7.35.1; banners=-,-,-
X-VirusChecked: Checked
Received: (qmail 30408 invoked from network); 9 Dec 2015 14:04:32 -0000
Received: from mailout01.vodafone.com (HELO mailout01.vodafone.com) (195.232.244.133)
  by server-10.tower-188.messagelabs.com with DHE-RSA-AES256-SHA encrypted SMTP; 9 Dec 2015 14:04:32 -0000
Received: from mailint03.vodafone.com (mailint03.vodafone.com [195.232.244.200])
	by mailout01.vodafone.com (Postfix) with ESMTP id 3pG0Vm1Rkyz1yJT
	for <dev@httpd.apache.org>; Wed,  9 Dec 2015 15:04:32 +0100 (CET)
Received: from mailint03.vodafone.com (localhost [127.0.0.1])
	by mailint03.vodafone.com (Postfix) with ESMTP id 3pG0Vm0TmLz16L7N
	for <dev@httpd.apache.org>; Wed,  9 Dec 2015 15:04:32 +0100 (CET)
Received: from VOEXC04W.internal.vodafone.com (voexc04w.dc-ratingen.de [145.230.101.24])
	(using TLSv1 with cipher AES128-SHA (128/128 bits))
	(No client certificate requested)
	by mailint03.vodafone.com (Postfix) with ESMTPS id 3pG0Vm07qDz16J72
	for <dev@httpd.apache.org>; Wed,  9 Dec 2015 15:04:32 +0100 (CET)
Received: from VOEXC09W.internal.vodafone.com (145.230.101.29) by
 VOEXC04W.internal.vodafone.com (145.230.101.24) with Microsoft SMTP Server
 (TLS) id 14.3.224.2; Wed, 9 Dec 2015 15:04:31 +0100
Received: from VOEXM10W.internal.vodafone.com ([169.254.2.138]) by
 VOEXC09W.internal.vodafone.com ([145.230.101.29]) with mapi id
 14.03.0224.002; Wed, 9 Dec 2015 15:04:30 +0100
From: =?utf-8?B?UGzDvG0sIFLDvGRpZ2VyLCBWb2RhZm9uZSBHcm91cA==?=
	<ruediger.pluem@vodafone.com>
To: "dev@httpd.apache.org" <dev@httpd.apache.org>
Subject: AW: scoreboard and http2
Thread-Topic: scoreboard and http2
Thread-Index: AQHRMoh329i77S/H9UC3aD6vOys2GJ7CnVUAgAASmYA=
Date: Wed, 9 Dec 2015 14:04:30 +0000
Message-ID: <AB1691BE05AE7F4992697F2A0835627AC63BF8B6@VOEXM10W.internal.vodafone.com>
References: <4B4BC185-927B-40C2-BD51-7F9CA46FA3E3@greenbytes.de>
 <54570F93-263A-4BDA-9E62-5AB4AA8330DE@sharp.fm>
In-Reply-To: <54570F93-263A-4BDA-9E62-5AB4AA8330DE@sharp.fm>
Accept-Language: en-US
Content-Language: de-DE
X-MS-Has-Attach:
X-MS-TNEF-Correlator:
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
MIME-Version: 1.0

DQoNCj4gLS0tLS1VcnNwcsO8bmdsaWNoZSBOYWNocmljaHQtLS0tLQ0KPiBWb246IEdyYWhhbSBM
ZWdnZXR0IFttYWlsdG86bWluZnJpbkBzaGFycC5mbV0NCj4gR2VzZW5kZXQ6IE1pdHR3b2NoLCA5
LiBEZXplbWJlciAyMDE1IDE0OjU4DQo+IEFuOiBkZXZAaHR0cGQuYXBhY2hlLm9yZw0KPiBCZXRy
ZWZmOiBSZTogc2NvcmVib2FyZCBhbmQgaHR0cDINCj4gDQo+IE9uIDA5IERlYyAyMDE1LCBhdCAz
OjQ5IFBNLCBTdGVmYW4gRWlzc2luZw0KPiA8c3RlZmFuLmVpc3NpbmdAZ3JlZW5ieXRlcy5kZT4g
d3JvdGU6DQo+IA0KPiA+IEZvciB0aGUgbmV4dCAyLjQgcmVsZWFzZSwgSSB3b3VsZCBsaWtlIHRv
IGFkZCBzY29yZWJvYXJkIHN1cHBvcnQgdG8NCj4gbW9kX2h0dHAyLg0KPiA+DQo+ID4gVGhlcmUg
YXJlIHNldmVyYWwgb3B0aW9ucyBmb3IgZG9pbmcgc28gYW5kIEkgd291bGQgbGlrZSB5b3VyIGZl
ZWRiYWNrDQo+IG9uIHdoaWNoDQo+ID4gcm91dGUgd2Ugc2hvdWxkIHRha2UuIEkgdHJ5IHRvIG91
dGxpbmUgd2hhdCBvcHRpb25zIEkgc2VlOg0KPiA+DQo+ID4gQSkgTWFrZSBtb2RfaHR0cDIgd29y
a2VycyBnZW5lcmFsIE1QTSB3b3JrZXJzLiBUaGV5IHdvdWxkIHRoZW4gYmVjb21lDQo+ID4gICBw
YXJ0IG9mIHNjb3JlYm9hcmQgd2l0aG91dCBjaGFuZ2VzIHRvIHRoZSBib2FyZCBpdHNlbGYuDQo+
IA0KPiBJdCBpcyB0aGUgZ29hbCBvZiB0aGUgTVBNIHRvIGNhcmUgYWJvdXQgdGhlIGFyY2hpdGVj
dHVyZSBvZiB0aGUgbWFjaGluZSwNCj4gYW5kIGtub3cgYWJvdXQgcHJvY2Vzc2VzL3RocmVhZHMv
ZXRjLg0KPiANCj4gT3B0aW9uIEEgaXMgdGhlIG9ubHkgcmVhbCBvcHRpb24gLSB3ZSBjYW5ub3Qg
YWxsb3cgdGhlIGgyIHN0dWZmIHRvIG1lc3MNCj4gdXAgdGhlIGNsZWFuIHNlcGFyYXRpb24gYmV0
d2VlbiB0aGUgYXJjaGl0ZWN0dXJlIG9mIGVhY2ggcGxhdGZvcm0gYW5kDQo+IHRoZSBjb3JlIG9m
IHRoZSBzZXJ2ZXIgaXRzZWxmLg0KDQorMQ0KDQpSZWdhcmRzDQoNClLDvGRpZ2VyDQo=

From dev-return-85006-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Wed Dec  9 15:19:30 2015
Return-Path: <dev-return-85006-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 54256176E1
	for <apmail-httpd-dev-archive@www.apache.org>; Wed,  9 Dec 2015 15:19:30 +0000 (UTC)
Received: (qmail 62597 invoked by uid 500); 9 Dec 2015 15:19:24 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 62525 invoked by uid 500); 9 Dec 2015 15:19:24 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 62516 invoked by uid 99); 9 Dec 2015 15:19:24 -0000
Received: from mail-relay.apache.org (HELO mail-relay.apache.org) (140.211.11.15)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 09 Dec 2015 15:19:24 +0000
Received: from [192.168.201.3] (c-73-181-14-238.hsd1.co.comcast.net [73.181.14.238])
	by mail-relay.apache.org (ASF Mail Server at mail-relay.apache.org) with ESMTPSA id 7A7E01A05B0
	for <dev@httpd.apache.org>; Wed,  9 Dec 2015 15:19:24 +0000 (UTC)
Content-Type: text/plain; charset=utf-8
Mime-Version: 1.0 (Mac OS X Mail 9.1 \(3096.5\))
Subject: Re: [VOTE] Release Apache httpd 2.4.18 as GA
From: Leif Hedstrom <zwoop@apache.org>
In-Reply-To: <AD9BFA0F-C508-4DFE-8B4F-FF79D46D9D91@jaguNET.com>
Date: Wed, 9 Dec 2015 08:19:23 -0700
Content-Transfer-Encoding: quoted-printable
Message-Id: <BCEA8A94-A292-49B1-872A-1FBD5CCC652C@apache.org>
References: <AD9BFA0F-C508-4DFE-8B4F-FF79D46D9D91@jaguNET.com>
To: dev@httpd.apache.org
X-Mailer: Apple Mail (2.3096.5)


> On Dec 8, 2015, at 1:38 PM, Jim Jagielski <jim@jaguNET.com> wrote:
>=20
> The pre-release test tarballs for Apache httpd 2.4.18 can be found
> at the usual place:
>=20
> 	http://httpd.apache.org/dev/dist/
>=20
> I'm calling a VOTE on releasing these as Apache httpd 2.4.18 GA.
>=20
> [ ] +1: Good to go
> [ ] +0: meh
> [ ] -1: Danger Will Robinson. And why.
>=20
> Vote will last the normal 72 hrs.


+1. Built, tested and run on Fedora 21 - 64-bit with PHP 5.6.4.

=E2=80=94 leif


From dev-return-85007-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Wed Dec  9 16:39:34 2015
Return-Path: <dev-return-85007-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id B75E317D38
	for <apmail-httpd-dev-archive@www.apache.org>; Wed,  9 Dec 2015 16:39:34 +0000 (UTC)
Received: (qmail 51819 invoked by uid 500); 9 Dec 2015 16:39:31 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 51748 invoked by uid 500); 9 Dec 2015 16:39:31 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 51738 invoked by uid 99); 9 Dec 2015 16:39:31 -0000
Received: from Unknown (HELO spamd1-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 09 Dec 2015 16:39:31 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd1-us-west.apache.org (ASF Mail Server at spamd1-us-west.apache.org) with ESMTP id C8574C71D9
	for <dev@httpd.apache.org>; Wed,  9 Dec 2015 16:39:30 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd1-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 0.653
X-Spam-Level:
X-Spam-Status: No, score=0.653 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, SPF_NEUTRAL=0.652,
	URIBL_BLOCKED=0.001] autolearn=disabled
Authentication-Results: spamd1-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=comcast.net
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd1-us-west.apache.org [10.40.0.7]) (amavisd-new, port 10024)
	with ESMTP id ckvq-tm7jX1u for <dev@httpd.apache.org>;
	Wed,  9 Dec 2015 16:39:22 +0000 (UTC)
Received: from resqmta-po-07v.sys.comcast.net (resqmta-po-07v.sys.comcast.net [96.114.154.166])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id E95B742BB1
	for <dev@httpd.apache.org>; Wed,  9 Dec 2015 16:39:21 +0000 (UTC)
Received: from resomta-po-02v.sys.comcast.net ([96.114.154.226])
	by resqmta-po-07v.sys.comcast.net with comcast
	id rUZC1r0084tLnxL01Ua7Mv; Wed, 09 Dec 2015 16:34:07 +0000
Received: from [192.168.199.10] ([69.251.84.114])
	by resomta-po-02v.sys.comcast.net with comcast
	id rUa61r00E2U0RYt01Ua7Uo; Wed, 09 Dec 2015 16:34:07 +0000
Content-Type: text/plain; charset=us-ascii
Mime-Version: 1.0 (Mac OS X Mail 9.2 \(3112\))
Subject: Re: [VOTE] Release Apache httpd 2.4.18 as GA
From: Jim Jagielski <jim@jaguNET.com>
In-Reply-To: <AD9BFA0F-C508-4DFE-8B4F-FF79D46D9D91@jaguNET.com>
Date: Wed, 9 Dec 2015 11:34:06 -0500
Content-Transfer-Encoding: 7bit
Message-Id: <8F8938D2-93B1-416B-8D5D-20792E1EF2AD@jaguNET.com>
References: <AD9BFA0F-C508-4DFE-8B4F-FF79D46D9D91@jaguNET.com>
To: dev@httpd.apache.org
X-Mailer: Apple Mail (2.3112)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=comcast.net;
	s=q20140121; t=1449678847;
	bh=AKFBIEI+0fTBTxdEuiDubckCobkkHrZeyNtLUY9MrB8=;
	h=Received:Received:Content-Type:Mime-Version:Subject:From:Date:
	 Message-Id:To;
	b=iaPQhojUvagIikhP0rwtNcuqViwHXCc1DU8HPmlbt7n4s4GJ7WXAqLK/Uxrn9UOOT
	 Iypo2uuPKjqHs5dSDd9SFpLc0fOqcwAkTTMHq2pNTqgKKT30OPIwSIjhpaJ6hKQ5au
	 MtE1ESx7WCbPR2gQuauBrBYw56YfhYIxI8BXU/TTFw1GWFv8W2XIfw3E3DKqSO7+n0
	 WNknbxt6nidxCrcMxwVZYK90dYNRGW73bOAiQp7ZKJlDgE5x5khvpLgJXHpA2HbowF
	 XbdYasYwcYecI+85ZFU9yx/RMfzuxnGkIvtAPO7R2tEmfVZIuuoehB7wuZUgZ+En2G
	 vUYRR7F1fDD/g==

+1:
 o OSX 10.11.2, Xcode 7.2: x64
 o CentOS6: x64
 o CentOS7: x64

> On Dec 8, 2015, at 3:38 PM, Jim Jagielski <jim@jaguNET.com> wrote:
> 
> The pre-release test tarballs for Apache httpd 2.4.18 can be found
> at the usual place:
> 
> 	http://httpd.apache.org/dev/dist/
> 
> I'm calling a VOTE on releasing these as Apache httpd 2.4.18 GA.
> 
> [ ] +1: Good to go
> [ ] +0: meh
> [ ] -1: Danger Will Robinson. And why.
> 
> Vote will last the normal 72 hrs.
> 
> NOTE: The *-deps are only there for convenience.
> 
> Thx!


From dev-return-85008-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Wed Dec  9 17:19:24 2015
Return-Path: <dev-return-85008-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id E1EBC17FCB
	for <apmail-httpd-dev-archive@www.apache.org>; Wed,  9 Dec 2015 17:19:24 +0000 (UTC)
Received: (qmail 720 invoked by uid 500); 9 Dec 2015 17:19:21 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 645 invoked by uid 500); 9 Dec 2015 17:19:21 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 635 invoked by uid 99); 9 Dec 2015 17:19:21 -0000
Received: from Unknown (HELO spamd4-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 09 Dec 2015 17:19:21 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd4-us-west.apache.org (ASF Mail Server at spamd4-us-west.apache.org) with ESMTP id F3634C0295
	for <dev@httpd.apache.org>; Wed,  9 Dec 2015 17:19:20 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd4-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 3
X-Spam-Level: ***
X-Spam-Status: No, score=3 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, HTML_MESSAGE=3,
	SPF_PASS=-0.001, URIBL_BLOCKED=0.001] autolearn=disabled
Authentication-Results: spamd4-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=rowe-clan-net.20150623.gappssmtp.com
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd4-us-west.apache.org [10.40.0.11]) (amavisd-new, port 10024)
	with ESMTP id d5HEpj2FLOTE for <dev@httpd.apache.org>;
	Wed,  9 Dec 2015 17:19:10 +0000 (UTC)
Received: from mail-ig0-f174.google.com (mail-ig0-f174.google.com [209.85.213.174])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id B389D42AA6
	for <dev@httpd.apache.org>; Wed,  9 Dec 2015 17:19:09 +0000 (UTC)
Received: by igcmv3 with SMTP id mv3so128590942igc.0
        for <dev@httpd.apache.org>; Wed, 09 Dec 2015 09:19:09 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=rowe-clan-net.20150623.gappssmtp.com; s=20150623;
        h=mime-version:date:message-id:subject:from:to:content-type;
        bh=O2HNFgnS49Gt74A3rvwzqyHbdZ9KsZ0mSAqPKFQS1N4=;
        b=MspEtDYTRKTTUuElhBnY4j4EkkI4deD7fQZyCXIy/KkcL5BtAhXoBnytz1xC7iJfxW
         Z+4QiEiJU7WBJY/0GUmHNLCLEuEXx7ySwsJQvG+zB79NyQI1w9DnqV2u2V977HymZqkk
         eUsDuXJrEaI/JSEW12RyQtRobE7jSnSKqEoNCTfRFMBzYJFh4rlT7iSzZb7jVmf77i/B
         bYbtH9+EX0O5dh16Z7nyA8iQaqq2vYqB5x1sU3sDbFrfQ/D/icsF0bjzjl49xA1L6YdQ
         P4zZDC/5OFgbGkm3Gmm5r+n9mpLIN4dN+aSZxZNqNNTrBvvrwWloPTSpufXc1rHGRx+0
         dOCw==
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=1e100.net; s=20130820;
        h=x-gm-message-state:mime-version:date:message-id:subject:from:to
         :content-type;
        bh=O2HNFgnS49Gt74A3rvwzqyHbdZ9KsZ0mSAqPKFQS1N4=;
        b=Z715lJ7l8mmCrEmOBIvmlAuojzVJ58IaejXu4q/v0k6LTm2uM7eMCbFyssKb/Eemf6
         XbiprDLzcDKyhYPDcIKkKDvu8zqXocroyzvuv82fMPRXs+q63ugYsStvaYLQuEZkr3cM
         h2mmyt8EgpHUjMp2n+N1wFPxszzwsZ1Xmkk5lAqMzuZ0MNEao94Q3Q7cWms5Is/72wLy
         4qJEYqFHX4gVmbyobqYwXEGygCzms9YjjaPlFkClAUP+Zv9DNapOFfuZVoScmVKqosej
         483UTlb9WiJPbMgDynm8SHIjKc9X7jlL3tnVwwri8RPuS+axfd8yWaGleVqysnKnOD0Z
         Etcw==
X-Gm-Message-State: ALoCoQmVTDDC+GAMFSv4nFegUBTVTc+HzN6ckhcvME5lQ3Y4s1qPWWx7Cc5r9i2NHqQ1TwNFFA/SBmC/r1lq75MtJ5RnnO7/Ki5HiCtS7CCbyDwcwsLeF+o=
MIME-Version: 1.0
X-Received: by 10.50.143.8 with SMTP id sa8mr3105855igb.32.1449681549125; Wed,
 09 Dec 2015 09:19:09 -0800 (PST)
Received: by 10.107.62.136 with HTTP; Wed, 9 Dec 2015 09:19:09 -0800 (PST)
Date: Wed, 9 Dec 2015 11:19:09 -0600
Message-ID: <CACsi251DF52ZRqHBnvvTghLc7V34Sgy=5NADM=WGWyNkthb-ow@mail.gmail.com>
Subject: mod_http2 and rejecting HTTP/1 requests...
From: William A Rowe Jr <wrowe@rowe-clan.net>
To: httpd <dev@httpd.apache.org>
Content-Type: multipart/alternative; boundary=001a1134b40ec6076305267a497c

--001a1134b40ec6076305267a497c
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: quoted-printable

Back to h2c, RFC7231 spells out

6.5.15 <https://tools.ietf.org/html/rfc7231#section-6.5.15>.  426
Upgrade Required

   The 426 (Upgrade Required) status code indicates that the server
   refuses to perform the request using the current protocol but might
   be willing to do so after the client upgrades to a different
   protocol.  The server MUST send an Upgrade header field in a 426
   response to indicate the required protocol(s) (Section 6.7 of
   [RFC7230] <https://tools.ietf.org/html/rfc7230#section-6.7>).

   Example:

     HTTP/1.1 426 Upgrade Required
     Upgrade: HTTP/3.0
     Connection: Upgrade
     Content-Length: 53
     Content-Type: text/plain

     This service requires use of the HTTP/3.0 protocol.



This leaves a lot of stuff out from the original RFC2817 definition of 426.=
..

4.2 Mandatory Advertisement

   A server MAY indicate that a client request can not be completed
   without TLS using the "426 Upgrade Required" status code, which MUST
   include an an Upgrade header field specifying the token of the
   required TLS version.

       HTTP/1.1 426 Upgrade Required
       Upgrade: TLS/1.0, HTTP/1.1
       Connection: Upgrade

   The server SHOULD include a message body in the 426 response which
   indicates in human readable form the reason for the error and
   describes any alternative courses which may be available to the user.

   Note that even if a client is willing to use TLS, it must use the
   operations in Section 3 to proceed; the TLS handshake cannot begin
   immediately after the 426 response.


And then I'm reading a really nonsensical comment in this FAQ...

https://http2.github.io/faq/#implementation-questions
Can I implement HTTP/2 without implementing HTTP/1.1?
"Requests without the h2c upgrade token can be rejected with a 505
(HTTP Version Not Supported) status code that contains the Upgrade
header field. Servers that don=E2=80=99t wish to process the HTTP/1.1 respo=
nse
should reject stream 1 with a REFUSED_STREAM error code immediately
after sending the connection preface to encourage the client to retry
the request over the upgraded HTTP/2 connection."


which would be absurd...

6.6.6 <https://tools.ietf.org/html/rfc7231#section-6.6.6>.  505 HTTP
Version Not Supported

   The 505 (HTTP Version Not Supported) status code indicates that the
   server does not support, or refuses to support, the major version of
   HTTP that was used in the request message.  The server is indicating
   that it is unable or unwilling to complete the request using the same
   major version as the client, as described in Section 2.6 of
   [RFC7230] <https://tools.ietf.org/html/rfc7230#section-2.6>, other
than with this error message.  The server SHOULD
   generate a representation for the 505 response that describes why
   that version is not supported and what other protocols are supported
   by that server.


A 505 is an unrecoverable error, the client isn't expected to do anything
with it.

I just want to ensure that we do *not* follow this guidance; if the user
wants configure httpd to enforce HTTP/2 only on a particular vhost, we
should be sending a 426 error always, with an error message explaining
exactly why their request is rejected, but giving the user-agent the
opportunity to automatically upgrade without presenting the message to the
user.

--001a1134b40ec6076305267a497c
Content-Type: text/html; charset=UTF-8
Content-Transfer-Encoding: quoted-printable

<div dir=3D"ltr"><div>Back to h2c, RFC7231 spells out</div><div><br></div><=
div><pre class=3D"" style=3D"font-size:13.3333px;margin-top:0px;margin-bott=
om:0px;color:rgb(0,0,0)"><span class=3D"h4" style=3D"font-size:1em;line-hei=
ght:0pt;display:inline;font-weight:bold"><a class=3D"" name=3D"section-6.5.=
15" href=3D"https://tools.ietf.org/html/rfc7231#section-6.5.15" style=3D"co=
lor:black;text-decoration:none" rel=3D"noreferrer">6.5.15</a>.  426 Upgrade=
 Required</span>

   The 426 (Upgrade Required) status code indicates that the server
   refuses to perform the request using the current protocol but might
   be willing to do so after the client upgrades to a different
   protocol.  The server MUST send an Upgrade header field in a 426
   response to indicate the required protocol(s) (<a href=3D"https://tools.=
ietf.org/html/rfc7230#section-6.7" rel=3D"noreferrer">Section=C2=A06.7 of
   [RFC7230]</a>).

   Example:

     HTTP/1.1 426 Upgrade Required
     Upgrade: HTTP/3.0
     Connection: Upgrade
     Content-Length: 53
     Content-Type: text/plain

     This service requires use of the HTTP/3.0 protocol.
</pre></div><div><br></div><div><pre class=3D"" style=3D"font-size:13.3333p=
x;margin-top:0px;margin-bottom:0px;color:rgb(0,0,0)"></pre><pre class=3D"" =
style=3D"font-size:13.3333px;margin-top:0px;margin-bottom:0px;color:rgb(0,0=
,0)"><br></pre><pre class=3D"" style=3D"font-size:13.3333px;margin-top:0px;=
margin-bottom:0px;color:rgb(0,0,0)"><div style=3D"color:rgb(34,34,34);font-=
family:arial,sans-serif;font-size:small;white-space:normal">This leaves a l=
ot of stuff out from the original RFC2817 definition of 426...</div><div><b=
r></div></pre><pre class=3D"" style=3D"margin-top:0px;margin-bottom:0px"><p=
re style=3D"color:rgb(0,0,0);font-size:13.3333px;word-wrap:break-word;white=
-space:pre-wrap">4.2 Mandatory Advertisement

   A server MAY indicate that a client request can not be completed
   without TLS using the &quot;426 Upgrade Required&quot; status code, whic=
h MUST
   include an an Upgrade header field specifying the token of the
   required TLS version.

       HTTP/1.1 426 Upgrade Required
       Upgrade: TLS/1.0, HTTP/1.1
       Connection: Upgrade

   The server SHOULD include a message body in the 426 response which
   indicates in human readable form the reason for the error and
   describes any alternative courses which may be available to the user.

   Note that even if a client is willing to use TLS, it must use the
   operations in Section 3 to proceed; the TLS handshake cannot begin
   immediately after the 426 response.</pre><pre style=3D"word-wrap:break-w=
ord"><div style=3D"white-space:normal;font-family:arial,sans-serif"><br></d=
iv><div style=3D"white-space:normal;font-family:arial,sans-serif">And then =
I&#39;m reading a really nonsensical comment in this FAQ...=C2=A0</div><div=
 style=3D"white-space:normal;font-family:arial,sans-serif"><br></div><div><=
font face=3D"arial, sans-serif"><span style=3D"white-space:normal"><a href=
=3D"https://http2.github.io/faq/#implementation-questions">https://http2.gi=
thub.io/faq/#implementation-questions</a><br></span></font></div><div style=
=3D"white-space:normal;font-family:arial,sans-serif"><h3 id=3D"can-i-implem=
ent-http2-without-implementing-http11" style=3D"font-family:&#39;Helvetica =
Neue&#39;,Helvetica,Arial,sans-serif;font-weight:500;line-height:1.1;color:=
rgb(51,51,51);margin-top:20px;margin-bottom:10px;font-size:24px">Can I impl=
ement HTTP/2 without implementing HTTP/1.1?</h3></div><div style=3D"white-s=
pace:normal;font-family:arial,sans-serif">&quot;<span style=3D"color:rgb(51=
,51,51);font-family:&#39;Helvetica Neue&#39;,Helvetica,Arial,sans-serif;fon=
t-size:14px;line-height:20px">Requests without the</span><span style=3D"col=
or:rgb(51,51,51);font-family:&#39;Helvetica Neue&#39;,Helvetica,Arial,sans-=
serif;font-size:14px;line-height:20px">=C2=A0</span><code style=3D"line-hei=
ght:20px;font-family:Menlo,Monaco,Consolas,&#39;Courier New&#39;,monospace;=
font-size:12.6px;padding:2px 4px;color:rgb(199,37,78);white-space:nowrap;bo=
rder-radius:4px;background-color:rgb(249,242,244)">h2c</code><span style=3D=
"color:rgb(51,51,51);font-family:&#39;Helvetica Neue&#39;,Helvetica,Arial,s=
ans-serif;font-size:14px;line-height:20px">=C2=A0</span><span style=3D"colo=
r:rgb(51,51,51);font-family:&#39;Helvetica Neue&#39;,Helvetica,Arial,sans-s=
erif;font-size:14px;line-height:20px">upgrade token can be rejected with a =
505 (HTTP Version Not Supported) status code that contains the Upgrade head=
er field. Servers that don=E2=80=99t wish to process the HTTP/1.1 response =
should reject stream 1 with a REFUSED_STREAM error code immediately after s=
ending the connection preface to encourage the client to retry the request =
over the upgraded HTTP/2 connection.</span><span style=3D"color:rgb(51,51,5=
1);font-family:&#39;Helvetica Neue&#39;,Helvetica,Arial,sans-serif;font-siz=
e:14px;line-height:20px;white-space:pre-wrap">&quot;</span></div><div style=
=3D"white-space:normal;font-family:arial,sans-serif"><span style=3D"color:r=
gb(51,51,51);font-family:&#39;Helvetica Neue&#39;,Helvetica,Arial,sans-seri=
f;font-size:14px;line-height:20px;white-space:pre-wrap"><br></span></div><d=
iv style=3D"white-space:normal;font-family:arial,sans-serif"><span style=3D=
"color:rgb(51,51,51);font-family:&#39;Helvetica Neue&#39;,Helvetica,Arial,s=
ans-serif;font-size:14px;line-height:20px;white-space:pre-wrap"><br></span>=
</div><div style=3D"white-space:normal;font-family:arial,sans-serif"><span =
style=3D"color:rgb(51,51,51);font-family:&#39;Helvetica Neue&#39;,Helvetica=
,Arial,sans-serif;font-size:14px;line-height:20px;white-space:pre-wrap">whi=
ch would be absurd...</span></div><div style=3D"white-space:normal;font-fam=
ily:arial,sans-serif"><br></div><div style=3D"white-space:normal;font-famil=
y:arial,sans-serif"><pre class=3D"" style=3D"font-size:13.3333px;margin-top=
:0px;margin-bottom:0px;color:rgb(0,0,0)"><span class=3D"h4" style=3D"font-s=
ize:1em;line-height:0pt;display:inline;font-weight:bold"><a class=3D"" name=
=3D"section-6.6.6" href=3D"https://tools.ietf.org/html/rfc7231#section-6.6.=
6" style=3D"color:black;text-decoration:none" rel=3D"noreferrer">6.6.6</a>.=
  505 HTTP Version Not Supported</span>

   The 505 (HTTP Version Not Supported) status code indicates that the
   server does not support, or refuses to support, the major version of
   HTTP that was used in the request message.  The server is indicating
   that it is unable or unwilling to complete the request using the same
   major version as the client, as described in <a href=3D"https://tools.ie=
tf.org/html/rfc7230#section-2.6" rel=3D"noreferrer">Section=C2=A02.6 of
   [RFC7230]</a>, other than with this error message.  The server SHOULD
   generate a representation for the 505 response that describes why
   that version is not supported and what other protocols are supported
   by that server.</pre></div><div style=3D"white-space:normal;font-family:=
arial,sans-serif"><br></div><div style=3D"white-space:normal;font-family:ar=
ial,sans-serif">A 505 is an unrecoverable error, the client isn&#39;t expec=
ted to do anything with it.</div><div style=3D"white-space:normal;font-fami=
ly:arial,sans-serif"><br></div><div style=3D"white-space:normal;font-family=
:arial,sans-serif">I just want to ensure that we do *not* follow this guida=
nce; if the user wants configure httpd to enforce HTTP/2 only on a particul=
ar vhost, we should be sending a 426 error always, with an error message ex=
plaining exactly why their request is rejected, but giving the user-agent t=
he opportunity to automatically upgrade without presenting the message to t=
he user.</div><div style=3D"white-space:normal;font-family:arial,sans-serif=
"><br></div><div style=3D"white-space:normal;font-family:arial,sans-serif">=
<br></div><div style=3D"white-space:normal;font-family:arial,sans-serif"><b=
r></div><div style=3D"white-space:normal;font-family:arial,sans-serif"><br>=
</div><div style=3D"white-space:normal;font-family:arial,sans-serif"><br></=
div></pre></pre></div></div>

--001a1134b40ec6076305267a497c--

From dev-return-85009-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Wed Dec  9 17:23:13 2015
Return-Path: <dev-return-85009-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id C1CBE1801A
	for <apmail-httpd-dev-archive@www.apache.org>; Wed,  9 Dec 2015 17:23:13 +0000 (UTC)
Received: (qmail 16551 invoked by uid 500); 9 Dec 2015 17:23:08 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 16480 invoked by uid 500); 9 Dec 2015 17:23:08 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 16470 invoked by uid 99); 9 Dec 2015 17:23:08 -0000
Received: from Unknown (HELO spamd1-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 09 Dec 2015 17:23:08 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd1-us-west.apache.org (ASF Mail Server at spamd1-us-west.apache.org) with ESMTP id D3573C9BC2
	for <dev@httpd.apache.org>; Wed,  9 Dec 2015 17:23:07 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd1-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 3
X-Spam-Level: ***
X-Spam-Status: No, score=3 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, HTML_MESSAGE=3,
	SPF_PASS=-0.001, URIBL_BLOCKED=0.001] autolearn=disabled
Authentication-Results: spamd1-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=rowe-clan-net.20150623.gappssmtp.com
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd1-us-west.apache.org [10.40.0.7]) (amavisd-new, port 10024)
	with ESMTP id 299B6oHZGfDW for <dev@httpd.apache.org>;
	Wed,  9 Dec 2015 17:22:59 +0000 (UTC)
Received: from mail-io0-f174.google.com (mail-io0-f174.google.com [209.85.223.174])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id A407342BB3
	for <dev@httpd.apache.org>; Wed,  9 Dec 2015 17:22:51 +0000 (UTC)
Received: by ioir85 with SMTP id r85so66694725ioi.1
        for <dev@httpd.apache.org>; Wed, 09 Dec 2015 09:17:26 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=rowe-clan-net.20150623.gappssmtp.com; s=20150623;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        bh=CaV2kaRwLivaC1LYWeIWCORPH4iXZoU12tD3gVTcggE=;
        b=IWBQCetV4LFx3lYsgkVMW3szP0Wcbhz3Bp3ZI7GInx0g/A8P1+U6XpDi8yF5yI2SEb
         5HwYioVPzz2YEfwrgLL/7Wy+JvbisMPRb9SVmPLkTuZ2dtrBpBtlyv7Ap7cTDlnDqUoA
         I3PZnpOiGPwzCjfycBGrsT3V8obhZxji5ooFd8+waSzdYVyHFMdt0kjPmZd+zCzdrDf/
         1E3SWz1/qnjQeQPGxIfhrKa/Z7l0zwT9pXbyxwPj0nJu0m2pVDa/PGPRgOQk72skcPqw
         m/eAVPVAunlmDdlYH0ahuNspvHxsZukQ4S3aAoNMqmb3EfpoESNqkH3sXPDKy+WVHxGJ
         mwoA==
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=1e100.net; s=20130820;
        h=x-gm-message-state:mime-version:in-reply-to:references:date
         :message-id:subject:from:to:content-type;
        bh=CaV2kaRwLivaC1LYWeIWCORPH4iXZoU12tD3gVTcggE=;
        b=dJlGop6VXUSFVZSZAVSqommdKaAI3MoYTToHx3dgPS349xr+Dnj1duzUHd8RkC90SA
         kjDSvlxtJklEI3cyVw1VOxy3niyaEi9QQiAALuFdtKLZIaf+cpLgchZg7N0EkGf2Rp+V
         OG00gncHsq2OthiGUy9RD7M6asOKX6QzAsdgUlpjV+RS7OAFUUJ87rlWcZmFl44xbHlD
         DXn/qJJBfTI7AoBWDgPXW5iJCXii3Sbw24Whrkpsg3ZWlPES7beSm6Z0heyXdl+Cngd4
         mQ/BJOMhu3iD3m63Cd/5kHlGtAg7E6XlVqz1bM2nE+AuQQansEPsIom/xVyleKMMBxhN
         5XXA==
X-Gm-Message-State: ALoCoQlzCDVbdDMzMuhGnSshleqHKRtNVJoMVPZjOC1rLJ1wxDLjm/Sx9zAjPBU3+sc26+0NOQRe5LRmzqAuu1Qd+XPoiQq9hqjpIH5+7DenM1pSlzdA+PQ=
MIME-Version: 1.0
X-Received: by 10.107.34.199 with SMTP id i190mr6708699ioi.150.1449681446117;
 Wed, 09 Dec 2015 09:17:26 -0800 (PST)
Received: by 10.107.62.136 with HTTP; Wed, 9 Dec 2015 09:17:25 -0800 (PST)
In-Reply-To: <9CCEFD7E-9ED3-4ED1-8F58-2134DD5310F9@gbiv.com>
References: <CACsi250=dbRQKnsbE8JSdAZRm5x99gE0sgX3iQ-PHAx77euD1A@mail.gmail.com>
	<AB1691BE05AE7F4992697F2A0835627AC63BAB94@VOEXM10W.internal.vodafone.com>
	<F7B20D30-D34A-4805-A77D-F64F6428F6E3@greenbytes.de>
	<56660896.c74fc20a.15f56.0ebd@mx.google.com>
	<56660B43.2060507@gmail.com>
	<6B13DF2B-0586-42BB-B62F-59A7638B697D@greenbytes.de>
	<13FE9E7F-9620-4BF9-8EA4-57A6314D66BF@greenbytes.de>
	<9CCEFD7E-9ED3-4ED1-8F58-2134DD5310F9@gbiv.com>
Date: Wed, 9 Dec 2015 11:17:25 -0600
Message-ID: <CACsi252y7nX0kR9+JgSra7Q_5_LVqaR3z6ExPKg=Lhi8zhN4ew@mail.gmail.com>
Subject: Re: Upgrade Summary
From: William A Rowe Jr <wrowe@rowe-clan.net>
To: httpd <dev@httpd.apache.org>
Content-Type: multipart/alternative; boundary=001a1140d944a2403805267a43d8

--001a1140d944a2403805267a43d8
Content-Type: text/plain; charset=UTF-8

On Tue, Dec 8, 2015 at 9:10 PM, Roy T. Fielding <fielding@gbiv.com> wrote:

> > On Dec 8, 2015, at 2:07 AM, Stefan Eissing <stefan.eissing@greenbytes.de>
> wrote:
> >
> > Open:
> > 1. Protocols like Websocket need to take over the 101 sending themselves
> in the "switch protocol" phase. (correct, Jacob?). Should we delegate the
> sending of the 101 to the protocol switch handler?
>
> That seems unlikely.


Agreed, anywhere we like we can send the 101 with headers, all that the
websocket module needed to do was to set up output_headers or perhaps we
add intermediate_output_headers in the request structure.  Easily fixed so
this code is still common...


> > 2. General handling of request bodies. Options:
> >  a setaside in core of up to nnn bytes before switch invocation
> >  b do nothing, let protocol switch handler care about it
>
> I think folks are confusing implementation with protocol.  There is no need
> for the protocol being read on a connection to be the same protocol that is
> being written in response.  In other words, the incoming connection remains
> reading HTTP/1 bits until the message is finished, regardless of the
> decision
> to upgrade the response stream -- the other protocol engine doesn't care.
>

+1, between HTTP/1 and HTTP/2, or between HTTP/1 and websocket.  (And we
already worked out that websocket upgrade passes no request body anyways,
right?)


> This should be easily handled by adding a filter that translates the HTTP/1
> incoming body (if any) to a single channel of the new protocol.  Just fake
> it.
> There is no need to wait or set aside the bytes, unless that is desired for
> other reasons (e.g., denial of denial of service attacks).
>

However, we must read the request body complete before the input handler is
toggled to the h2c state, or before we switch to any bidirectional
protocol, e.g. TLS or otherwise.

> 3. When to do the upgrade dance:
> >  a post_read_request: upgrade precedes authentication
> >  b handler: upgrade only honored on authenticated and otherwise ok
> requests
> >  c both: introduce separate hooks? have an additional parameter? more
> complexity
>
> (a).  We do want to upgrade non-ok responses.  If the "new" protocol wants
> to
> send a canned HTTP/1.1 error, it can do so without our help.
>

+1 in the case of h2c, TLS.  I understand that websocket upgrades are going
to be conditional on authentication. As long as we give websocket the
chance to upgrade in the fixups or similar phase, after auth, then
websocket can ignore the Upgrade: websocket offer after inspecting authnz.


> > 4. status code of protocol switch handler: if we move the task of 101
> sending, the switch handler might not do it and keep the connection on the
> "old" protocol. Then a connection close is not necessary. So, we would do
> the close only when the switch handler returns APR_EOF.
>
> Eh?


I'm wondering the same, the new protocol loop can do all of the connection
handling, no need for the protocol switch to do anything but continue, if
the connection is ended in the protocol handler, it's gone.


> > 5. Will it be possible to migrate the current TLS upgrade handling to
> this revised scheme?
>
> TLS upgrade is never done with a body (and is broken code anyway).  Just
> fix it.
>

Fixing (leveraging set-aside code that already exists in mod_ssl for TLS
protocol renegotiation)... I see nothing in either RFC that suggests that
upgrade to TLS with a request body is not permitted.  You may be right
about existing CUPS clients.

Note that the upgrade token is "TLS" -- it does not have to be "TLS/1.0".
>

Funny, just working on this w.r.t. TLS vs TLS/1 vs TLS/1.x  - we need to
accept any of the above.  We should reject TLS/1.3, and TLS/2 however,
whenever mod_ssl/openssl is not configured handshake those protocols.

I interpret the token version as the minimum acceptable handshake, e.g. any
client that will handshake only TLS/1.1 or TLS/1.2 would send Upgrade: TLS
or Upgrade: TLS/1 or Upgrade: TLS/1.1. The TLS handshake itself will
present the best possible protocol level, while successfully negotiating
this earlier protocol.  We also must advertise TLS/1.1 (or TLS/1.2) if
mod_ssl/openssl is not configured to accept TLS/1.0 (or TLS/1.1)
handshakes. am I misinterpreting this?

--001a1140d944a2403805267a43d8
Content-Type: text/html; charset=UTF-8
Content-Transfer-Encoding: quoted-printable

<div dir=3D"ltr"><div class=3D"gmail_extra"><div class=3D"gmail_quote">On T=
ue, Dec 8, 2015 at 9:10 PM, Roy T. Fielding <span dir=3D"ltr">&lt;<a href=
=3D"mailto:fielding@gbiv.com" target=3D"_blank">fielding@gbiv.com</a>&gt;</=
span> wrote:<br><blockquote class=3D"gmail_quote" style=3D"margin:0px 0px 0=
px 0.8ex;border-left-width:1px;border-left-color:rgb(204,204,204);border-le=
ft-style:solid;padding-left:1ex"><span class=3D"">&gt; On Dec 8, 2015, at 2=
:07 AM, Stefan Eissing &lt;<a href=3D"mailto:stefan.eissing@greenbytes.de">=
stefan.eissing@greenbytes.de</a>&gt; wrote:<br>
&gt;<br></span><span class=3D"">&gt; Open:<br>
&gt; 1. Protocols like Websocket need to take over the 101 sending themselv=
es in the &quot;switch protocol&quot; phase. (correct, Jacob?). Should we d=
elegate the sending of the 101 to the protocol switch handler?<br>
<br>
</span>That seems unlikely.</blockquote><div><br></div><div>Agreed, anywher=
e we like we can send the 101 with headers, all that the websocket module n=
eeded to do was to set up output_headers or perhaps we add intermediate_out=
put_headers in the request structure.=C2=A0 Easily fixed so this code is st=
ill common...</div><div>=C2=A0</div><blockquote class=3D"gmail_quote" style=
=3D"margin:0px 0px 0px 0.8ex;border-left-width:1px;border-left-color:rgb(20=
4,204,204);border-left-style:solid;padding-left:1ex"><span class=3D"">
&gt; 2. General handling of request bodies. Options:<br>
&gt;=C2=A0 a setaside in core of up to nnn bytes before switch invocation<b=
r>
&gt;=C2=A0 b do nothing, let protocol switch handler care about it<br>
<br>
</span>I think folks are confusing implementation with protocol.=C2=A0 Ther=
e is no need<br>
for the protocol being read on a connection to be the same protocol that is=
<br>
being written in response.=C2=A0 In other words, the incoming connection re=
mains<br>
reading HTTP/1 bits until the message is finished, regardless of the decisi=
on<br>
to upgrade the response stream -- the other protocol engine doesn&#39;t car=
e.<br></blockquote><div><br></div><div>+1, between HTTP/1 and HTTP/2, or be=
tween HTTP/1 and websocket. =C2=A0(And we already worked out that websocket=
 upgrade passes no request body anyways, right?)</div><div>=C2=A0</div><blo=
ckquote class=3D"gmail_quote" style=3D"margin:0px 0px 0px 0.8ex;border-left=
-width:1px;border-left-color:rgb(204,204,204);border-left-style:solid;paddi=
ng-left:1ex">
This should be easily handled by adding a filter that translates the HTTP/1=
<br>
incoming body (if any) to a single channel of the new protocol.=C2=A0 Just =
fake it.<br>
There is no need to wait or set aside the bytes, unless that is desired for=
<br>
other reasons (e.g., denial of denial of service attacks).<span class=3D"">=
<br></span></blockquote><div>=C2=A0</div><div>However, we must read the req=
uest body complete before the input handler is toggled to the h2c state, or=
 before we switch to any bidirectional protocol, e.g. TLS or otherwise.</di=
v><div><br></div><blockquote class=3D"gmail_quote" style=3D"margin:0px 0px =
0px 0.8ex;border-left-width:1px;border-left-color:rgb(204,204,204);border-l=
eft-style:solid;padding-left:1ex"><span class=3D"">
&gt; 3. When to do the upgrade dance:<br>
&gt;=C2=A0 a post_read_request: upgrade precedes authentication<br>
&gt;=C2=A0 b handler: upgrade only honored on authenticated and otherwise o=
k requests<br>
&gt;=C2=A0 c both: introduce separate hooks? have an additional parameter? =
more complexity<br>
<br>
</span>(a).=C2=A0 We do want to upgrade non-ok responses.=C2=A0 If the &quo=
t;new&quot; protocol wants to<br>
send a canned HTTP/1.1 error, it can do so without our help.<span class=3D"=
"><br></span></blockquote><div><br></div><div>+1 in the case of h2c, TLS.=
=C2=A0 I understand that websocket upgrades are going to be conditional on =
authentication. As long as we give websocket the chance to upgrade in the f=
ixups or similar phase, after auth, then websocket can ignore the Upgrade: =
websocket offer after inspecting authnz.</div><div>=C2=A0</div><blockquote =
class=3D"gmail_quote" style=3D"margin:0px 0px 0px 0.8ex;border-left-width:1=
px;border-left-color:rgb(204,204,204);border-left-style:solid;padding-left:=
1ex"><span class=3D"">
&gt; 4. status code of protocol switch handler: if we move the task of 101 =
sending, the switch handler might not do it and keep the connection on the =
&quot;old&quot; protocol. Then a connection close is not necessary. So, we =
would do the close only when the switch handler returns APR_EOF.<br>
<br>
</span>Eh?</blockquote><div><br></div><div>I&#39;m wondering the same, the =
new protocol loop can do all of the connection handling, no need for the pr=
otocol switch to do anything but continue, if the connection is ended in th=
e protocol handler, it&#39;s gone.</div><div>=C2=A0</div><blockquote class=
=3D"gmail_quote" style=3D"margin:0px 0px 0px 0.8ex;border-left-width:1px;bo=
rder-left-color:rgb(204,204,204);border-left-style:solid;padding-left:1ex">=
<span class=3D"">&gt; 5. Will it be possible to migrate the current TLS upg=
rade handling to this revised scheme?<br>
<br>
</span>TLS upgrade is never done with a body (and is broken code anyway).=
=C2=A0 Just fix it.<br></blockquote><div><br></div><div>Fixing (leveraging =
set-aside code that already exists in mod_ssl for TLS protocol renegotiatio=
n)... I see nothing in either RFC that suggests that upgrade to TLS with a =
request body is not permitted.=C2=A0 You may be right about existing CUPS c=
lients.</div><div><br></div><blockquote class=3D"gmail_quote" style=3D"marg=
in:0px 0px 0px 0.8ex;border-left-width:1px;border-left-color:rgb(204,204,20=
4);border-left-style:solid;padding-left:1ex">
Note that the upgrade token is &quot;TLS&quot; -- it does not have to be &q=
uot;TLS/1.0&quot;.<br>
<span class=3D""><font color=3D"#888888"></font></span></blockquote><div><b=
r></div><div>Funny, just working on this w.r.t. TLS vs TLS/1 vs TLS/1.x =C2=
=A0- we need to accept any of the above.=C2=A0 We should reject TLS/1.3, an=
d TLS/2 however, whenever mod_ssl/openssl is not configured handshake those=
 protocols.</div><div><br></div><div>I interpret the token version as the m=
inimum acceptable handshake, e.g. any client that will handshake only TLS/1=
.1 or TLS/1.2 would send Upgrade: TLS or Upgrade: TLS/1 or Upgrade: TLS/1.1=
. The TLS handshake itself will present the best possible protocol level, w=
hile successfully negotiating this earlier protocol.=C2=A0 We also must adv=
ertise TLS/1.1 (or TLS/1.2) if mod_ssl/openssl is not configured to accept =
TLS/1.0 (or TLS/1.1) handshakes. am I misinterpreting this?</div><div><br><=
/div><div><br></div></div></div></div>

--001a1140d944a2403805267a43d8--

From dev-return-85010-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Wed Dec  9 17:59:03 2015
Return-Path: <dev-return-85010-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 5A0A2182A7
	for <apmail-httpd-dev-archive@www.apache.org>; Wed,  9 Dec 2015 17:59:03 +0000 (UTC)
Received: (qmail 26771 invoked by uid 500); 9 Dec 2015 17:59:03 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 26695 invoked by uid 500); 9 Dec 2015 17:59:02 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 26684 invoked by uid 99); 9 Dec 2015 17:59:02 -0000
Received: from Unknown (HELO spamd2-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 09 Dec 2015 17:59:02 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd2-us-west.apache.org (ASF Mail Server at spamd2-us-west.apache.org) with ESMTP id 7480D1A414C
	for <dev@httpd.apache.org>; Wed,  9 Dec 2015 17:59:02 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd2-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 2.999
X-Spam-Level: **
X-Spam-Status: No, score=2.999 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, HTML_MESSAGE=3,
	RCVD_IN_MSPIKE_H2=-0.001, SPF_PASS=-0.001, URIBL_BLOCKED=0.001]
	autolearn=disabled
Authentication-Results: spamd2-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=rowe-clan-net.20150623.gappssmtp.com
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd2-us-west.apache.org [10.40.0.9]) (amavisd-new, port 10024)
	with ESMTP id anDNawmNjmhd for <dev@httpd.apache.org>;
	Wed,  9 Dec 2015 17:58:56 +0000 (UTC)
Received: from mail-io0-f178.google.com (mail-io0-f178.google.com [209.85.223.178])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id 6A2CF42BAD
	for <dev@httpd.apache.org>; Wed,  9 Dec 2015 17:58:56 +0000 (UTC)
Received: by iofh3 with SMTP id h3so67873085iof.3
        for <dev@httpd.apache.org>; Wed, 09 Dec 2015 09:53:56 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=rowe-clan-net.20150623.gappssmtp.com; s=20150623;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        bh=UW1OPIzt7y3qxSgkOVb1AMz4OFaQSuiVZkSDezSTh/4=;
        b=KbLdO7dO7m8eUwUvEAjF2U4jpvBGm8D1DCOIr1kabFTml0bDqlMFc1pWAQuo6y8UMm
         6pExNJT8b6ILR/q8lhsU6Y0tV/WosI5W3AV1FCUJjSzL9PXEPpCLdsrSVpF7pwE23GxK
         Z4xWre560+4aak4QEKL5/xZ9uIO/va4r2RnCQLpG91BpFnJEwbo2OHf8eB1H4tDqhq3n
         Rwv6aN5sQ6szmIVmtJMPleh5g2iHPdKNt5qdSVtJ/CdgyVRFmVf0PpCqJo0exblImI+E
         wXIpoLHf1x1/58muOi16vIcc75xVvkap4xBwP2wxraWVIFtl+ti/jIR9n4oKG6JDZzbW
         0o5w==
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=1e100.net; s=20130820;
        h=x-gm-message-state:mime-version:in-reply-to:references:date
         :message-id:subject:from:to:content-type;
        bh=UW1OPIzt7y3qxSgkOVb1AMz4OFaQSuiVZkSDezSTh/4=;
        b=DXA9nY8XFbdtPcnd5Sox4gC0WXCCTCgQG+vXj6+w3G4YZzyU5kwSBwvNZ2Ma3TOUVN
         ESDYRkNDDHUBacLUrkZEChX92Hsvk8PBleBH6oZjsSxfX5ccasKkRUEkeiSUSCGXhGZf
         UCe/jJPB7g9ruAs52P5KzaJjnPv5oRHJPRksGhLDwefbast7zZXjKsIklTvsZqpJ/NTs
         latmGAFHTEiFFwC29HFlbtkBI5II9JCVQqcA3ywqN6gXyu8+mYieXf6HUqz3HiYbim00
         rBpvLWpxfSwUBXlsAePU3I9YYwxRsZVnIXG0NpNuwvGf4uROeZ5s/iZxkU2KaIaaZ7hV
         ca/w==
X-Gm-Message-State: ALoCoQnHXTQAFm0LwjoQOZZr7gTazG8zF5SDAAsLeBotTmThbQXQbicL15iyy5MOaUq8v3atAJQIYfJjDoBe3G6xLJe7qAeJhQnSOI5SRe6mVYOUarzKpwo=
MIME-Version: 1.0
X-Received: by 10.107.25.83 with SMTP id 80mr6696635ioz.163.1449683635872;
 Wed, 09 Dec 2015 09:53:55 -0800 (PST)
Received: by 10.107.62.136 with HTTP; Wed, 9 Dec 2015 09:53:55 -0800 (PST)
In-Reply-To: <CACsi251DF52ZRqHBnvvTghLc7V34Sgy=5NADM=WGWyNkthb-ow@mail.gmail.com>
References: <CACsi251DF52ZRqHBnvvTghLc7V34Sgy=5NADM=WGWyNkthb-ow@mail.gmail.com>
Date: Wed, 9 Dec 2015 11:53:55 -0600
Message-ID: <CACsi250NOjmc3yAv27aJXASAuRy3W-wJVQexctQW7dbQfaiuzg@mail.gmail.com>
Subject: Re: mod_http2 and rejecting HTTP/1 requests...
From: William A Rowe Jr <wrowe@rowe-clan.net>
To: httpd <dev@httpd.apache.org>
Content-Type: multipart/alternative; boundary=001a113fdbb4273a3105267ac684

--001a113fdbb4273a3105267ac684
Content-Type: text/plain; charset=UTF-8

Ignore this bit below; I was reading 2817 against 7230 and hadn't driven
down into the 7231 spec yet, and apparently forgot to snip it before
clicking send... the insistence on 426 vs poor advise to use 505 still
stands

On Wed, Dec 9, 2015 at 11:19 AM, William A Rowe Jr <wrowe@rowe-clan.net>
wrote:

>
> This leaves a lot of stuff out from the original RFC2817 definition of 426...
>
> 4.2 Mandatory Advertisement
>
>    A server MAY indicate that a client request can not be completed
>    without TLS using the "426 Upgrade Required" status code, which MUST
>    include an an Upgrade header field specifying the token of the
>    required TLS version.
>
>        HTTP/1.1 426 Upgrade Required
>        Upgrade: TLS/1.0, HTTP/1.1
>        Connection: Upgrade
>
>    The server SHOULD include a message body in the 426 response which
>    indicates in human readable form the reason for the error and
>    describes any alternative courses which may be available to the user.
>
>    Note that even if a client is willing to use TLS, it must use the
>    operations in Section 3 to proceed; the TLS handshake cannot begin
>    immediately after the 426 response.
>
>

--001a113fdbb4273a3105267ac684
Content-Type: text/html; charset=UTF-8
Content-Transfer-Encoding: quoted-printable

<div dir=3D"ltr"><div class=3D"gmail_extra"><div class=3D"gmail_quote">Igno=
re this bit below; I was reading 2817 against 7230 and hadn&#39;t driven do=
wn into the 7231 spec yet, and apparently forgot to snip it before clicking=
 send... the insistence on 426 vs poor advise to use 505 still stands</div>=
<div class=3D"gmail_quote"><br></div><div class=3D"gmail_quote">On Wed, Dec=
 9, 2015 at 11:19 AM, William A Rowe Jr <span dir=3D"ltr">&lt;<a href=3D"ma=
ilto:wrowe@rowe-clan.net" target=3D"_blank">wrowe@rowe-clan.net</a>&gt;</sp=
an> wrote:<br><blockquote class=3D"gmail_quote" style=3D"margin:0 0 0 .8ex;=
border-left:1px #ccc solid;padding-left:1ex"><div dir=3D"ltr"><div><br></di=
v><div><pre style=3D"font-size:13.3333px;margin-top:0px;margin-bottom:0px;c=
olor:rgb(0,0,0)"><div style=3D"color:rgb(34,34,34);font-family:arial,sans-s=
erif;font-size:small;white-space:normal">This leaves a lot of stuff out fro=
m the original RFC2817 definition of 426...</div></pre><pre style=3D"margin=
-top:0px;margin-bottom:0px"><pre style=3D"color:rgb(0,0,0);font-size:13.333=
3px;word-wrap:break-word;white-space:pre-wrap">4.2 Mandatory Advertisement

   A server MAY indicate that a client request can not be completed
   without TLS using the &quot;426 Upgrade Required&quot; status code, whic=
h MUST
   include an an Upgrade header field specifying the token of the
   required TLS version.

       HTTP/1.1 426 Upgrade Required
       Upgrade: TLS/1.0, HTTP/1.1
       Connection: Upgrade

   The server SHOULD include a message body in the 426 response which
   indicates in human readable form the reason for the error and
   describes any alternative courses which may be available to the user.

   Note that even if a client is willing to use TLS, it must use the
   operations in Section 3 to proceed; the TLS handshake cannot begin
   immediately after the 426 response.</pre></pre></div></div></blockquote>=
</div></div></div>

--001a113fdbb4273a3105267ac684--

From dev-return-85011-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Wed Dec  9 18:11:50 2015
Return-Path: <dev-return-85011-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 1CED518357
	for <apmail-httpd-dev-archive@www.apache.org>; Wed,  9 Dec 2015 18:11:50 +0000 (UTC)
Received: (qmail 67586 invoked by uid 500); 9 Dec 2015 18:11:44 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 67478 invoked by uid 500); 9 Dec 2015 18:11:44 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 67402 invoked by uid 99); 9 Dec 2015 18:11:44 -0000
Received: from Unknown (HELO spamd4-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 09 Dec 2015 18:11:44 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd4-us-west.apache.org (ASF Mail Server at spamd4-us-west.apache.org) with ESMTP id 43619C0473
	for <dev@httpd.apache.org>; Wed,  9 Dec 2015 18:11:44 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd4-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 3
X-Spam-Level: ***
X-Spam-Status: No, score=3 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, HTML_MESSAGE=3,
	RCVD_IN_MSPIKE_H2=-0.001, URIBL_BLOCKED=0.001] autolearn=disabled
Authentication-Results: spamd4-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=rowe-clan-net.20150623.gappssmtp.com
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd4-us-west.apache.org [10.40.0.11]) (amavisd-new, port 10024)
	with ESMTP id a78bJqFjQKxz for <dev@httpd.apache.org>;
	Wed,  9 Dec 2015 18:11:35 +0000 (UTC)
Received: from mail-io0-f171.google.com (mail-io0-f171.google.com [209.85.223.171])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id C63AA21270
	for <dev@httpd.apache.org>; Wed,  9 Dec 2015 18:11:34 +0000 (UTC)
Received: by ioc74 with SMTP id 74so67982478ioc.2
        for <dev@httpd.apache.org>; Wed, 09 Dec 2015 10:06:33 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=rowe-clan-net.20150623.gappssmtp.com; s=20150623;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        bh=3UEQ+Vhn8r4gtPpigtN7qTV4DEOgLZbOmMKGEGkPqc0=;
        b=JhESBuNQ0nA7xAv3kYrppeg8lO+A3aLStzG/ZU3SEZ2teRoAjDl6W/bxmY/qDCf9SS
         JlIQVi3Jyvf+Yk51jH13YZVAda7xqfRvK+TTEoRqzsayUaeRluNtlDrLL73XvKosVUF1
         947b/TcppDJ6uFoG+sNKMjHK8F/saWvnKU1Igna9tmctnOwkoxQOdhglLTxetV1COq21
         YOybAi13+6k6K+yjbxkh5/vJD1Gl7BM6tWPCkl5EnGB38NFiT2RObNcJnTN8PljiEMyn
         HXwtPugZFpJ9dh0JzKbTsc6Ia/OA5qWqjiV+NA+WRFTCv2DBL0QIsnzO7dg+4xxoTVTP
         rUZQ==
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=1e100.net; s=20130820;
        h=x-gm-message-state:mime-version:in-reply-to:references:date
         :message-id:subject:from:to:content-type;
        bh=3UEQ+Vhn8r4gtPpigtN7qTV4DEOgLZbOmMKGEGkPqc0=;
        b=e/+poYVB65e+4ScnIDGV9BDrah84DLStTP0Lj4IQdwwq1TUCLayhkEIg6Fr2X2mIBq
         1Ep9FxdCfXKfHJF6kRiC6xHkVq1xyqcJLgzNJY0845AdpsLlphF2WKwOrZyiLe4HC1cs
         2MY/jLtIVXvBr1ffwEnZLpJDhdZ/okwoUC33DJqO0rSZMkzrZZjcYmd3b3vgZ9H+oISn
         SND8b0I8ggh6KM1hrHUeQVOfKhuaOTDXl4fzu7yqEPSLkdYzB8xm4f+qbwpebZSy41DM
         SWpH/xkynvMVDVflB0PqdH+pM5dfgl60AjU/zi4+SO+WIZuG7+eO/ANWivMdGsxI20Xm
         eorA==
X-Gm-Message-State: ALoCoQnlxN+1dyC0pVk5z5Hu9fcMCxmGvqSea6vBzJn0sJATznf7WjwhCqCoW87xv9XqGl1nYwoYTybH2L2ArWJEuFokRY65EuFpdRMcfqCuD/mdxxiM6Gk=
MIME-Version: 1.0
X-Received: by 10.107.34.199 with SMTP id i190mr6953844ioi.150.1449684393473;
 Wed, 09 Dec 2015 10:06:33 -0800 (PST)
Received: by 10.107.62.136 with HTTP; Wed, 9 Dec 2015 10:06:33 -0800 (PST)
Received: by 10.107.62.136 with HTTP; Wed, 9 Dec 2015 10:06:33 -0800 (PST)
In-Reply-To: <CACsi251DF52ZRqHBnvvTghLc7V34Sgy=5NADM=WGWyNkthb-ow@mail.gmail.com>
References: <CACsi251DF52ZRqHBnvvTghLc7V34Sgy=5NADM=WGWyNkthb-ow@mail.gmail.com>
Date: Wed, 9 Dec 2015 12:06:33 -0600
Message-ID: <CACsi253k3igA2Ans-c8UBGX9s=wKbYTh0eSgcqQMyHpy0QxmaA@mail.gmail.com>
Subject: Re: mod_http2 and rejecting HTTP/1 requests...
From: William A Rowe Jr <wrowe@rowe-clan.net>
To: httpd <dev@httpd.apache.org>
Content-Type: multipart/alternative; boundary=001a1140d9444f4c2905267af304

--001a1140d9444f4c2905267af304
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: quoted-printable

I think I know where this author was misguided...

On Dec 9, 2015 11:19, "William A Rowe Jr" <wrowe@rowe-clan.net> wrote:
>
> And then I'm reading a really nonsensical comment in this FAQ...
>
> https://http2.github.io/faq/#implementation-questions
> Can I implement HTTP/2 without implementing HTTP/1.1?
> "Requests without the h2c upgrade token can be rejected with a 505 (HTTP
Version Not Supported) status code that contains the Upgrade header field.
Servers that don=E2=80=99t wish to process the HTTP/1.1 response should rej=
ect
stream 1 with a REFUSED_STREAM error code immediately after sending the
connection preface to encourage the client to retry the request over the
upgraded HTTP/2 connection."
>
>
> which would be absurd...
>
> 6.6.6.  505 HTTP Version Not Supported
>
>    The 505 (HTTP Version Not Supported) status code indicates that the
>    server does not support, or refuses to support, the major version of
>    HTTP that was used in the request message.  The server is indicating
>    that it is unable or unwilling to complete the request using the same
>    major version as the client, as described in Section 2.6 of
>    [RFC7230], other than with this error message.  The server SHOULD
>    generate a representation for the 505 response that describes why
>    that version is not supported and what other protocols are supported
>    by that server.
>
> A 505 is an unrecoverable error, the client isn't expected to do anything
with it.
>
> I just want to ensure that we do *not* follow this guidance; if the user
wants configure httpd to enforce HTTP/2 only on a particular vhost, we
should be sending a 426 error always, with an error message explaining
exactly why their request is rejected, but giving the user-agent the
opportunity to automatically upgrade without presenting the message to the
user.

I think the guidance above is correct for TLS h2 or HTTP/1 requests. ALPN
handshake should have resulted in an HTTP/2 connection, so if we are still
at HTTP/1 in a TLS session we can't continue, and it is a fatal 505
condition.

The author's guidance was written to h2c applications though, and was
clearly wrong for that negotiation.

--001a1140d9444f4c2905267af304
Content-Type: text/html; charset=UTF-8
Content-Transfer-Encoding: quoted-printable

<p dir=3D"ltr">I think I know where this author was misguided...</p>
<p dir=3D"ltr">On Dec 9, 2015 11:19, &quot;William A Rowe Jr&quot; &lt;<a h=
ref=3D"mailto:wrowe@rowe-clan.net">wrowe@rowe-clan.net</a>&gt; wrote:<br>
&gt;<br>
&gt; And then I&#39;m reading a really nonsensical comment in this FAQ...=
=C2=A0<br>
&gt;<br>
&gt; <a href=3D"https://http2.github.io/faq/#implementation-questions">http=
s://http2.github.io/faq/#implementation-questions</a><br>
&gt; Can I implement HTTP/2 without implementing HTTP/1.1?<br>
&gt; &quot;Requests without the=C2=A0h2c=C2=A0upgrade token can be rejected=
 with a 505 (HTTP Version Not Supported) status code that contains the Upgr=
ade header field. Servers that don=E2=80=99t wish to process the HTTP/1.1 r=
esponse should reject stream 1 with a REFUSED_STREAM error code immediately=
 after sending the connection preface to encourage the client to retry the =
request over the upgraded HTTP/2 connection.&quot;<br>
&gt;<br>
&gt;<br>
&gt; which would be absurd...<br>
&gt;<br>
&gt; 6.6.6.=C2=A0 505 HTTP Version Not Supported<br>
&gt;<br>
&gt;=C2=A0=C2=A0=C2=A0 The 505 (HTTP Version Not Supported) status code ind=
icates that the<br>
&gt;=C2=A0=C2=A0=C2=A0 server does not support, or refuses to support, the =
major version of<br>
&gt;=C2=A0=C2=A0=C2=A0 HTTP that was used in the request message.=C2=A0 The=
 server is indicating<br>
&gt;=C2=A0=C2=A0=C2=A0 that it is unable or unwilling to complete the reque=
st using the same<br>
&gt;=C2=A0=C2=A0=C2=A0 major version as the client, as described in Section=
=C2=A02.6 of<br>
&gt;=C2=A0=C2=A0=C2=A0 [RFC7230], other than with this error message.=C2=A0=
 The server SHOULD<br>
&gt;=C2=A0=C2=A0=C2=A0 generate a representation for the 505 response that =
describes why<br>
&gt;=C2=A0=C2=A0=C2=A0 that version is not supported and what other protoco=
ls are supported<br>
&gt;=C2=A0=C2=A0=C2=A0 by that server.<br>
&gt;<br>
&gt; A 505 is an unrecoverable error, the client isn&#39;t expected to do a=
nything with it.<br>
&gt;<br>
&gt; I just want to ensure that we do *not* follow this guidance; if the us=
er wants configure httpd to enforce HTTP/2 only on a particular vhost, we s=
hould be sending a 426 error always, with an error message explaining exact=
ly why their request is rejected, but giving the user-agent the opportunity=
 to automatically upgrade without presenting the message to the user.</p>
<p dir=3D"ltr">I think the guidance above is correct for TLS h2 or HTTP/1 r=
equests. ALPN handshake should have resulted in an HTTP/2 connection, so if=
 we are still at HTTP/1 in a TLS session we can&#39;t continue, and it is a=
 fatal 505 condition.</p>
<p dir=3D"ltr">The author&#39;s guidance was written to h2c applications th=
ough, and was clearly wrong for that negotiation.</p>

--001a1140d9444f4c2905267af304--

From dev-return-85012-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Wed Dec  9 19:03:09 2015
Return-Path: <dev-return-85012-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 758AE1860A
	for <apmail-httpd-dev-archive@www.apache.org>; Wed,  9 Dec 2015 19:03:09 +0000 (UTC)
Received: (qmail 54301 invoked by uid 500); 9 Dec 2015 19:03:09 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 54231 invoked by uid 500); 9 Dec 2015 19:03:09 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 54221 invoked by uid 99); 9 Dec 2015 19:03:09 -0000
Received: from Unknown (HELO spamd3-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 09 Dec 2015 19:03:09 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd3-us-west.apache.org (ASF Mail Server at spamd3-us-west.apache.org) with ESMTP id 94E5C180AF2
	for <dev@httpd.apache.org>; Wed,  9 Dec 2015 19:03:08 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd3-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 1.183
X-Spam-Level: *
X-Spam-Status: No, score=1.183 tagged_above=-999 required=6.31
	tests=[FSL_HELO_BARE_IP_2=0.873, HEADER_FROM_DIFFERENT_DOMAINS=0.001,
	RCVD_NUMERIC_HELO=0.865, RP_MATCHES_RCVD=-0.554, SPF_HELO_PASS=-0.001,
	SPF_PASS=-0.001] autolearn=disabled
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd3-us-west.apache.org [10.40.0.10]) (amavisd-new, port 10024)
	with ESMTP id mFEHyJd11eHc for <dev@httpd.apache.org>;
	Wed,  9 Dec 2015 19:03:07 +0000 (UTC)
Received: from plane.gmane.org (plane.gmane.org [80.91.229.3])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id 25F9242BA9
	for <dev@httpd.apache.org>; Wed,  9 Dec 2015 19:03:06 +0000 (UTC)
Received: from list by plane.gmane.org with local (Exim 4.69)
	(envelope-from <apache-dev@m.gmane.org>)
	id 1a6k12-0006XD-F1
	for dev@httpd.apache.org; Wed, 09 Dec 2015 20:03:04 +0100
Received: from 46.145.215.246 ([46.145.215.246])
        by main.gmane.org with esmtp (Gmexim 0.1 (Debian))
        id 1AlnuQ-0007hv-00
        for <dev@httpd.apache.org>; Wed, 09 Dec 2015 20:03:04 +0100
Received: from phpdev by 46.145.215.246 with local (Gmexim 0.1 (Debian))
        id 1AlnuQ-0007hv-00
        for <dev@httpd.apache.org>; Wed, 09 Dec 2015 20:03:04 +0100
X-Injected-Via-Gmane: http://gmane.org/
To: dev@httpd.apache.org
From: Jan Ehrhardt <phpdev@ehrhardt.nl>
Subject: Re: [VOTE] Release Apache httpd 2.4.18 as GA
Date: Wed, 09 Dec 2015 20:02:58 +0100
Lines: 14
Message-ID: <8hug6bppd6gr82bnitu9nj76osek703gtl@4ax.com>
References: <AD9BFA0F-C508-4DFE-8B4F-FF79D46D9D91@jaguNET.com>
Mime-Version: 1.0
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
X-Complaints-To: usenet@ger.gmane.org
X-Gmane-NNTP-Posting-Host: 46.145.215.246
X-Newsreader: Forte Agent 3.3/32.846

Jim Jagielski in gmane.comp.apache.devel (Tue, 8 Dec 2015 15:38:41 -0500):
>The pre-release test tarballs for Apache httpd 2.4.18 can be found
>at the usual place:
>
>	http://httpd.apache.org/dev/dist/
>
>I'm calling a VOTE on releasing these as Apache httpd 2.4.18 GA.

No idea who has voting rights, but I am

+1 Build on Windows 7 Pro (VC9 / VC11 / VC14, x86 / x64)
   Tested on Windows 2008 R2 SP1
-- 
Jan


From dev-return-85013-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Wed Dec  9 19:11:40 2015
Return-Path: <dev-return-85013-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 3A51F18696
	for <apmail-httpd-dev-archive@www.apache.org>; Wed,  9 Dec 2015 19:11:40 +0000 (UTC)
Received: (qmail 79492 invoked by uid 500); 9 Dec 2015 19:11:39 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 79415 invoked by uid 500); 9 Dec 2015 19:11:39 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 79401 invoked by uid 99); 9 Dec 2015 19:11:39 -0000
Received: from Unknown (HELO spamd1-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 09 Dec 2015 19:11:39 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd1-us-west.apache.org (ASF Mail Server at spamd1-us-west.apache.org) with ESMTP id 4F4D0C722C
	for <dev@httpd.apache.org>; Wed,  9 Dec 2015 19:11:39 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd1-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 2.98
X-Spam-Level: **
X-Spam-Status: No, score=2.98 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, HTML_MESSAGE=3,
	RCVD_IN_MSPIKE_H3=-0.01, RCVD_IN_MSPIKE_WL=-0.01, SPF_PASS=-0.001,
	URIBL_BLOCKED=0.001] autolearn=disabled
Authentication-Results: spamd1-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=rowe-clan-net.20150623.gappssmtp.com
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd1-us-west.apache.org [10.40.0.7]) (amavisd-new, port 10024)
	with ESMTP id LnjmhblSHS4e for <dev@httpd.apache.org>;
	Wed,  9 Dec 2015 19:11:33 +0000 (UTC)
Received: from mail-ig0-f178.google.com (mail-ig0-f178.google.com [209.85.213.178])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id 80B4320599
	for <dev@httpd.apache.org>; Wed,  9 Dec 2015 19:11:32 +0000 (UTC)
Received: by igcmv3 with SMTP id mv3so130725131igc.0
        for <dev@httpd.apache.org>; Wed, 09 Dec 2015 11:06:25 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=rowe-clan-net.20150623.gappssmtp.com; s=20150623;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        bh=ugKgYvABiwQX0I9GeojiWWIDLUghdenE/nkqX9f4CrY=;
        b=g/S22Ix+fZbWw8uR9HlrMILqOYU5dBm4f+TDrTSAxP+jy/FzjXmgaKfKbJD2Nj6mmX
         IoR9JtH/W/sSo6FVuZwXLTI/ouK7dnqzeJLdz24nwrRpbi37PN9ZOk/0uxkNIoozrfG0
         29Ht94R4hmpjRvvrC7/B1NtghLm4xzp01UVWj9CiDYQO8WCsZRE2p62nuwyJ/VpVHf/F
         SRZH4LewPsLBDh2/2tSy9JcpXACOF8QmyxtEYiuJsh6bu12MSWVs1siTY4Fd949i7YXd
         n9HsNCOhx81S5JSknyeHX06xUPG1Z7qq5bEyX9rF7TSA4g9k3wo171JpFHPaAtoq70Il
         lg2A==
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=1e100.net; s=20130820;
        h=x-gm-message-state:mime-version:in-reply-to:references:date
         :message-id:subject:from:to:content-type;
        bh=ugKgYvABiwQX0I9GeojiWWIDLUghdenE/nkqX9f4CrY=;
        b=CRsB5kIIT8l2i3Lw0LyaB/F13Fv2V+xVssyfYh3kaeQvatKthby2k+8NofZAq7uxMb
         4xdvZKpaTP1ABje2Acd5O60C8gs2+gXY4PqZozQeXw+AZpK00c3hayDEQoXPxok1EeFc
         rWQAM+n/TSeuVWFMVKT9fR0TgrOXcfeaqgbnAnkFTUYTQt65MuDe1o1+Wnziw71BS8ce
         FjnA+Vs2wHX2z6bOGOLbtenBfb8j85w5KCSHRE6VuQemxGjQaKnp3XUuqqJYHlM563g3
         29Y1/HrDLO+zyY2HUJ/jWgpK9ECMFl4+AC9iq8zBaRD84U3R6//DKcp6Ev3FSDmNjxy7
         ctPg==
X-Gm-Message-State: ALoCoQkQ42KjY9xO9Hsy0P351i4MaZ3NY0PwrSRD0GZhTH4SamqbyWnkbrjNoeB8J698k1GS/gtHpmOeQ/SbnJCOGG54rS263K+AppwMXLqcUR+jZLKcOWc=
MIME-Version: 1.0
X-Received: by 10.50.142.7 with SMTP id rs7mr30393282igb.35.1449687985240;
 Wed, 09 Dec 2015 11:06:25 -0800 (PST)
Received: by 10.107.62.136 with HTTP; Wed, 9 Dec 2015 11:06:25 -0800 (PST)
In-Reply-To: <8hug6bppd6gr82bnitu9nj76osek703gtl@4ax.com>
References: <AD9BFA0F-C508-4DFE-8B4F-FF79D46D9D91@jaguNET.com>
	<8hug6bppd6gr82bnitu9nj76osek703gtl@4ax.com>
Date: Wed, 9 Dec 2015 13:06:25 -0600
Message-ID: <CACsi252nB1usetkN3dncbvyaeg1wyBe+6sMBjb20QJ6vmBAKjg@mail.gmail.com>
Subject: Re: [VOTE] Release Apache httpd 2.4.18 as GA
From: William A Rowe Jr <wrowe@rowe-clan.net>
To: httpd <dev@httpd.apache.org>
Content-Type: multipart/alternative; boundary=001a11c2eb5a6554cf05267bc9ee

--001a11c2eb5a6554cf05267bc9ee
Content-Type: text/plain; charset=UTF-8

On Wed, Dec 9, 2015 at 1:02 PM, Jan Ehrhardt <phpdev@ehrhardt.nl> wrote:

> Jim Jagielski in gmane.comp.apache.devel (Tue, 8 Dec 2015 15:38:41 -0500):
> >The pre-release test tarballs for Apache httpd 2.4.18 can be found
> >at the usual place:
> >
> >       http://httpd.apache.org/dev/dist/
> >
> >I'm calling a VOTE on releasing these as Apache httpd 2.4.18 GA.
>
> No idea who has voting rights, but I am
>
> +1 Build on Windows 7 Pro (VC9 / VC11 / VC14, x86 / x64)
>    Tested on Windows 2008 R2 SP1
>

Everyone's votes are valued, whether they are 'weighed' or not!
Both positive and negative feedback from non-PMC members
strongly influence the RM and the PMC member's votes.

Thanks for testing :)

--001a11c2eb5a6554cf05267bc9ee
Content-Type: text/html; charset=UTF-8
Content-Transfer-Encoding: quoted-printable

<div dir=3D"ltr"><div class=3D"gmail_extra"><div class=3D"gmail_quote">On W=
ed, Dec 9, 2015 at 1:02 PM, Jan Ehrhardt <span dir=3D"ltr">&lt;<a href=3D"m=
ailto:phpdev@ehrhardt.nl" target=3D"_blank">phpdev@ehrhardt.nl</a>&gt;</spa=
n> wrote:<br><blockquote class=3D"gmail_quote" style=3D"margin:0 0 0 .8ex;b=
order-left:1px #ccc solid;padding-left:1ex">Jim Jagielski in gmane.comp.apa=
che.devel (Tue, 8 Dec 2015 15:38:41 -0500):<br>
<span class=3D"">&gt;The pre-release test tarballs for Apache httpd 2.4.18 =
can be found<br>
&gt;at the usual place:<br>
&gt;<br>
&gt;=C2=A0 =C2=A0 =C2=A0 =C2=A0<a href=3D"http://httpd.apache.org/dev/dist/=
" rel=3D"noreferrer" target=3D"_blank">http://httpd.apache.org/dev/dist/</a=
><br>
&gt;<br>
&gt;I&#39;m calling a VOTE on releasing these as Apache httpd 2.4.18 GA.<br=
>
<br>
</span>No idea who has voting rights, but I am<br>
<br>
+1 Build on Windows 7 Pro (VC9 / VC11 / VC14, x86 / x64)<br>
=C2=A0 =C2=A0Tested on Windows 2008 R2 SP1<br></blockquote><div><br></div><=
div>Everyone&#39;s votes are valued, whether they are &#39;weighed&#39; or =
not!</div><div>Both positive and negative feedback from non-PMC members</di=
v><div>strongly influence the RM and the PMC member&#39;s votes.</div><div>=
<br></div><div>Thanks for testing :)</div></div><br></div></div>

--001a11c2eb5a6554cf05267bc9ee--

From dev-return-85014-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Wed Dec  9 20:03:06 2015
Return-Path: <dev-return-85014-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 4FAAC18A3C
	for <apmail-httpd-dev-archive@www.apache.org>; Wed,  9 Dec 2015 20:03:06 +0000 (UTC)
Received: (qmail 53689 invoked by uid 500); 9 Dec 2015 20:03:00 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 53617 invoked by uid 500); 9 Dec 2015 20:03:00 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 53607 invoked by uid 99); 9 Dec 2015 20:03:00 -0000
Received: from Unknown (HELO spamd3-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 09 Dec 2015 20:03:00 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd3-us-west.apache.org (ASF Mail Server at spamd3-us-west.apache.org) with ESMTP id 23BDC180A77
	for <dev@httpd.apache.org>; Wed,  9 Dec 2015 20:03:00 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd3-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.1
X-Spam-Level:
X-Spam-Status: No, score=-0.1 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	SPF_PASS=-0.001, URIBL_BLOCKED=0.001] autolearn=disabled
Authentication-Results: spamd3-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd3-us-west.apache.org [10.40.0.10]) (amavisd-new, port 10024)
	with ESMTP id zpenNy66roXy for <dev@httpd.apache.org>;
	Wed,  9 Dec 2015 20:02:50 +0000 (UTC)
Received: from mail-pf0-f169.google.com (mail-pf0-f169.google.com [209.85.192.169])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id 4AC6A428ED
	for <dev@httpd.apache.org>; Wed,  9 Dec 2015 20:02:50 +0000 (UTC)
Received: by pfdd184 with SMTP id d184so34917192pfd.3
        for <dev@httpd.apache.org>; Wed, 09 Dec 2015 11:57:43 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=subject:to:references:from:message-id:date:user-agent:mime-version
         :in-reply-to:content-type:content-transfer-encoding;
        bh=Vw0vKjA6htipXcsYYTQJEOFzLdG38f2BRsCBffMJN3U=;
        b=lFVJ2rigoSwhTUT7vo+oXVJmbN7erVm4i1gAiFqfwf178y8ZVFdmAKFdPFaJhrRG29
         Zx3Sy2KwQHFiWYIQNv4tTNI72vc1kmFgbynSs4ftWqdqSh4AhdvRWbPec0w/NONzdH0y
         fo3UJW0dHR33ldOssQxHUdtjjzYnKgSKT9D/iOQqgJ/mUikzbN5yUlqIbZynN3bqZe+i
         Q8ETprrSQ++KMB3UybhRQlLvhLMk9vxMFZ3mlc7iH5qxoUwZEY9j+RL2QNzPiol/XXf+
         Fz4xLt++TSWl6G3dQU2YJvNe5QjoJ3pQ4rnSc1ipLPVJsCffdIfQdituQNxSTpEdFBiV
         Jkiw==
X-Received: by 10.98.42.9 with SMTP id q9mr871011pfq.142.1449691063338;
        Wed, 09 Dec 2015 11:57:43 -0800 (PST)
Received: from [192.168.1.4] (50-39-117-165.bvtn.or.frontiernet.net. [50.39.117.165])
        by smtp.gmail.com with ESMTPSA id s15sm13453000pfs.31.2015.12.09.11.57.41
        for <dev@httpd.apache.org>
        (version=TLSv1/SSLv3 cipher=OTHER);
        Wed, 09 Dec 2015 11:57:41 -0800 (PST)
Subject: Re: Upgrade Summary
To: dev@httpd.apache.org
References: <CACsi250=dbRQKnsbE8JSdAZRm5x99gE0sgX3iQ-PHAx77euD1A@mail.gmail.com>
 <AB1691BE05AE7F4992697F2A0835627AC63BAB94@VOEXM10W.internal.vodafone.com>
 <F7B20D30-D34A-4805-A77D-F64F6428F6E3@greenbytes.de>
 <56660896.c74fc20a.15f56.0ebd@mx.google.com> <56660B43.2060507@gmail.com>
 <6B13DF2B-0586-42BB-B62F-59A7638B697D@greenbytes.de>
 <13FE9E7F-9620-4BF9-8EA4-57A6314D66BF@greenbytes.de>
 <9CCEFD7E-9ED3-4ED1-8F58-2134DD5310F9@gbiv.com>
 <CACsi252y7nX0kR9+JgSra7Q_5_LVqaR3z6ExPKg=Lhi8zhN4ew@mail.gmail.com>
From: Jacob Champion <champion.p@gmail.com>
Message-ID: <566887B5.2080705@gmail.com>
Date: Wed, 9 Dec 2015 11:57:41 -0800
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:38.0) Gecko/20100101
 Thunderbird/38.4.0
MIME-Version: 1.0
In-Reply-To: <CACsi252y7nX0kR9+JgSra7Q_5_LVqaR3z6ExPKg=Lhi8zhN4ew@mail.gmail.com>
Content-Type: text/plain; charset=utf-8; format=flowed
Content-Transfer-Encoding: 7bit

On 12/09/2015 09:17 AM, William A Rowe Jr wrote:
> On Tue, Dec 8, 2015 at 9:10 PM, Roy T. Fielding <fielding@gbiv.com
> <mailto:fielding@gbiv.com>> wrote:
>
>     > On Dec 8, 2015, at 2:07 AM, Stefan Eissing <stefan.eissing@greenbytes.de <mailto:stefan.eissing@greenbytes.de>>
>     wrote:
>     >
>     > Open:
>     > 1. Protocols like Websocket need to take over the 101 sending themselves in the "switch protocol" phase. (correct, Jacob?). Should we delegate the sending of the 101 to the protocol switch handler?
>
>     That seems unlikely.
>
>
> Agreed, anywhere we like we can send the 101 with headers, all that the
> websocket module needed to do was to set up output_headers or perhaps we
> add intermediate_output_headers in the request structure.  Easily fixed
> so this code is still common...

+1.

>     This should be easily handled by adding a filter that translates the
>     HTTP/1
>     incoming body (if any) to a single channel of the new protocol.
>     Just fake it.
>     There is no need to wait or set aside the bytes, unless that is
>     desired for
>     other reasons (e.g., denial of denial of service attacks).
>
> However, we must read the request body complete before the input handler
> is toggled to the h2c state, or before we switch to any bidirectional
> protocol, e.g. TLS or otherwise.

For my own clarification: this is a protocol-specific limitation, right? 
As in, you can't begin a TLS handshake without first draining the 
incoming request body off the connection.

>
>     > 3. When to do the upgrade dance:
>     >  a post_read_request: upgrade precedes authentication
>     >  b handler: upgrade only honored on authenticated and otherwise ok requests
>     >  c both: introduce separate hooks? have an additional parameter? more complexity
>
>     (a).  We do want to upgrade non-ok responses.  If the "new" protocol
>     wants to
>     send a canned HTTP/1.1 error, it can do so without our help.
>
>
> +1 in the case of h2c, TLS.  I understand that websocket upgrades are
> going to be conditional on authentication. As long as we give websocket
> the chance to upgrade in the fixups or similar phase, after auth, then
> websocket can ignore the Upgrade: websocket offer after inspecting authnz.

Sounds reasonable. Unfortunate in the sense that it's possible for a 
module implementing the Upgrade API to screw up and accidentally ignore 
authnz, but since most protocols we're talking about can safely upgrade 
first and respond with 401/3 on the new protocol, I don't see much of an 
alternative.

>     > 4. status code of protocol switch handler: if we move the task of 101 sending, the switch handler might not do it and keep the connection on the "old" protocol. Then a connection close is not necessary. So, we would do the close only when the switch handler returns APR_EOF.
>
>     Eh?
>
> I'm wondering the same, the new protocol loop can do all of the
> connection handling, no need for the protocol switch to do anything but
> continue, if the connection is ended in the protocol handler, it's gone.

Why leave it up to the protocol handler (to potentially get wrong)? Are 
there any cases where, after a successful upgrade, we would not want to 
close the connection upon returning from the protocol handler?

--Jacob


From dev-return-85015-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Wed Dec  9 23:19:36 2015
Return-Path: <dev-return-85015-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 6F4A818344
	for <apmail-httpd-dev-archive@www.apache.org>; Wed,  9 Dec 2015 23:19:36 +0000 (UTC)
Received: (qmail 92900 invoked by uid 500); 9 Dec 2015 23:19:36 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 92827 invoked by uid 500); 9 Dec 2015 23:19:36 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 92817 invoked by uid 99); 9 Dec 2015 23:19:35 -0000
Received: from Unknown (HELO spamd2-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 09 Dec 2015 23:19:35 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd2-us-west.apache.org (ASF Mail Server at spamd2-us-west.apache.org) with ESMTP id 8642F1A2021
	for <dev@httpd.apache.org>; Wed,  9 Dec 2015 23:19:35 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd2-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 2.999
X-Spam-Level: **
X-Spam-Status: No, score=2.999 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, HTML_MESSAGE=3,
	RCVD_IN_MSPIKE_H2=-0.001, SPF_PASS=-0.001, URIBL_BLOCKED=0.001]
	autolearn=disabled
Authentication-Results: spamd2-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=rowe-clan-net.20150623.gappssmtp.com
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd2-us-west.apache.org [10.40.0.9]) (amavisd-new, port 10024)
	with ESMTP id EhCplvodp7jy for <dev@httpd.apache.org>;
	Wed,  9 Dec 2015 23:19:29 +0000 (UTC)
Received: from mail-io0-f181.google.com (mail-io0-f181.google.com [209.85.223.181])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id 9DB5A2302D
	for <dev@httpd.apache.org>; Wed,  9 Dec 2015 23:19:28 +0000 (UTC)
Received: by iofh3 with SMTP id h3so77121019iof.3
        for <dev@httpd.apache.org>; Wed, 09 Dec 2015 15:19:27 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=rowe-clan-net.20150623.gappssmtp.com; s=20150623;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        bh=PPzvpYta7bTDBNc2DwnD2k3UWNQAK8EthsGBlNJq5bo=;
        b=FaY5ap3tFBi3SLvBbpOPEtR0mrKp9qtXRIjRwxp6iGeGu0nwMftXHQOcwvhqKGjb58
         9jxXss+enoyqvNkwi5NdkprLo/++sGpVQu8zC8eWpDdJhr1KTo0FIPb5U364u/O33eD5
         DMPDjGswRGOcJlZ8RkBk9ers5zh6W5kdRBzU4WDsxBrDJSQL0OZCdq8jmh63871oHEHS
         jxJGFsK9mtaE/TQRZo76IylxkLxuP56mOqEiYKIT56BiLnGOgb16eAILlAWPEaU9J01d
         AwIULAeH9filbgN+x9ASewcVi+MR7cVAZoZjQIuSn+KnluaI+MemF00CRsHxgeUYip1s
         F1VA==
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=1e100.net; s=20130820;
        h=x-gm-message-state:mime-version:in-reply-to:references:date
         :message-id:subject:from:to:content-type;
        bh=PPzvpYta7bTDBNc2DwnD2k3UWNQAK8EthsGBlNJq5bo=;
        b=PEE3ym/4Iw9l7QVY68hBGbR4s4p/7i2AUxyhjcvvjhb/uSy5sJi4xj9a5uTfrsorNz
         sfMMiHs9R9KK8feq7zeJ3KpMWhE1/XhKQe69/l1sGVrAyME8d3t3SfrlpUGzTHBNYNhE
         ML0cVJddfaMFeGrvhezStXYx86Y7hvERs4lLZD5qbYIhtv5OGGi6wRiIpSYPw+J8eT+k
         v0FcY+B+sFiLHUK1OgPcraYSNuiJQi5JXisEV+LBOePLXJ6HeSJQsPRCsAom3lCHbN6H
         UzDHP48TashvsJB0triYlC2RiasMX/E4SMeEBftCxEiLC/5GI/vunRdyt2cnrcJSZzYh
         rfLA==
X-Gm-Message-State: ALoCoQnlm7wTnuoZ/eSCX8doNrj8JaKV9aD7RA53pbuPTTuaPFB5zRPA+aFlAohM3wAbnDAYxhcxv3Kd+xch37KCv/9AqDlLknUlbo2bXQ+QYBYPuFp3T38=
MIME-Version: 1.0
X-Received: by 10.107.10.66 with SMTP id u63mr7776319ioi.86.1449703167598;
 Wed, 09 Dec 2015 15:19:27 -0800 (PST)
Received: by 10.107.62.136 with HTTP; Wed, 9 Dec 2015 15:19:27 -0800 (PST)
In-Reply-To: <566887B5.2080705@gmail.com>
References: <CACsi250=dbRQKnsbE8JSdAZRm5x99gE0sgX3iQ-PHAx77euD1A@mail.gmail.com>
	<AB1691BE05AE7F4992697F2A0835627AC63BAB94@VOEXM10W.internal.vodafone.com>
	<F7B20D30-D34A-4805-A77D-F64F6428F6E3@greenbytes.de>
	<56660896.c74fc20a.15f56.0ebd@mx.google.com>
	<56660B43.2060507@gmail.com>
	<6B13DF2B-0586-42BB-B62F-59A7638B697D@greenbytes.de>
	<13FE9E7F-9620-4BF9-8EA4-57A6314D66BF@greenbytes.de>
	<9CCEFD7E-9ED3-4ED1-8F58-2134DD5310F9@gbiv.com>
	<CACsi252y7nX0kR9+JgSra7Q_5_LVqaR3z6ExPKg=Lhi8zhN4ew@mail.gmail.com>
	<566887B5.2080705@gmail.com>
Date: Wed, 9 Dec 2015 17:19:27 -0600
Message-ID: <CACsi253sTRbX2dnuq0yRP1sHb8vOos_9QaoYmA3TtYmnNx-Erg@mail.gmail.com>
Subject: Re: Upgrade Summary
From: William A Rowe Jr <wrowe@rowe-clan.net>
To: httpd <dev@httpd.apache.org>
Content-Type: multipart/alternative; boundary=001a113f93be55c03d05267f5215

--001a113f93be55c03d05267f5215
Content-Type: text/plain; charset=UTF-8

On Wed, Dec 9, 2015 at 1:57 PM, Jacob Champion <champion.p@gmail.com> wrote:

> On 12/09/2015 09:17 AM, William A Rowe Jr wrote:
>
>> On Tue, Dec 8, 2015 at 9:10 PM, Roy T. Fielding <fielding@gbiv.com
>> <mailto:fielding@gbiv.com>> wrote:
>>
>>     This should be easily handled by adding a filter that translates the
>>     HTTP/1
>>     incoming body (if any) to a single channel of the new protocol.
>>     Just fake it.
>>     There is no need to wait or set aside the bytes, unless that is
>>     desired for
>>     other reasons (e.g., denial of denial of service attacks).
>>
>> However, we must read the request body complete before the input handler
>> is toggled to the h2c state, or before we switch to any bidirectional
>> protocol, e.g. TLS or otherwise.
>>
>
> For my own clarification: this is a protocol-specific limitation, right?
> As in, you can't begin a TLS handshake without first draining the incoming
> request body off the connection.


Because the request body is inbound already at some state of completion
or incomplete transmission, it is competing with the TLS handshake, which
is a bidirectional engagement with the same socket between the user agent
and server.  Unlike h2c and websocket, where Roy suggests we leave the
http/1 input filter in place and inject the http/2 output filter for the
duration
of the initial Upgrade: request, we must pass TLS traffic in both
directions
at once during Upgrade: TLS.

Also, the results of the TLS handshake are interesting to authnz
configuration
and need to be available throughout those request phases.  This means that
for any Upgrade: TLS request must be satisfied (101 switching protocols)
prior to those auth phases.

In the case of h2c and websocket, the http/1.1 request headers are
sufficient
to begin processing the request. At the end of the first request, the input
filter is also toggled into the new protocol to resume processing of all
subsequent requests.  So this Upgrade: handling must occur before the
request handler is invoked, even a simple handler like 'OPTIONS *',

Please remember that a request handler is based on a method and location,
while Upgrade is not the request itself, but a proposal to switch protocols.
In the case of TLS and h2c, that request is satisfied over the
corresponding
HTTP/1 or HTTP/2 output filter, but I'm not clear whether websocket has
any equivalence in terms of a content handler phase.

    > 3. When to do the upgrade dance:
>>     >  a post_read_request: upgrade precedes authentication
>>     >  b handler: upgrade only honored on authenticated and otherwise ok
>> requests
>>     >  c both: introduce separate hooks? have an additional parameter?
>> more complexity
>>
>>     (a).  We do want to upgrade non-ok responses.  If the "new" protocol
>>     wants to
>>     send a canned HTTP/1.1 error, it can do so without our help.
>>
>> +1 in the case of h2c, TLS.  I understand that websocket upgrades are
>> going to be conditional on authentication. As long as we give websocket
>> the chance to upgrade in the fixups or similar phase, after auth, then
>> websocket can ignore the Upgrade: websocket offer after inspecting authnz.
>>
>
> Sounds reasonable. Unfortunate in the sense that it's possible for a
> module implementing the Upgrade API to screw up and accidentally ignore
> authnz, but since most protocols we're talking about can safely upgrade
> first and respond with 401/3 on the new protocol, I don't see much of an
> alternative.
>

Howso?  Any module can have any bug, I don't see your objection.

I think we agree that TLS upgrades happen early, h2c/websocket upgrades
happen late (before the content handler is invoked), and if either the
protocol
module or an auth module has a bug, we fix the bugs as with any other code
in the server.  Right?

    > 4. status code of protocol switch handler: if we move the task of 101
>> sending, the switch handler might not do it and keep the connection on the
>> "old" protocol. Then a connection close is not necessary. So, we would do
>> the close only when the switch handler returns APR_EOF.
>>
>>     Eh?
>>
>> I'm wondering the same, the new protocol loop can do all of the
>> connection handling, no need for the protocol switch to do anything but
>> continue, if the connection is ended in the protocol handler, it's gone.
>>
>
> Why leave it up to the protocol handler (to potentially get wrong)? Are
> there any cases where, after a successful upgrade, we would not want to
> close the connection upon returning from the protocol handler?


Why are you focused on such bugs?  It isn't making any sense.  If the
module sends a response or indicates the connection is closed, there is
nothing more that happens in the request processing loop anyways.  This
isn't for the core Protocol API to solve, IMHO.

--001a113f93be55c03d05267f5215
Content-Type: text/html; charset=UTF-8
Content-Transfer-Encoding: quoted-printable

<div dir=3D"ltr"><div class=3D"gmail_extra"><div class=3D"gmail_quote">On W=
ed, Dec 9, 2015 at 1:57 PM, Jacob Champion <span dir=3D"ltr">&lt;<a href=3D=
"mailto:champion.p@gmail.com" target=3D"_blank">champion.p@gmail.com</a>&gt=
;</span> wrote:<br><blockquote class=3D"gmail_quote" style=3D"margin:0 0 0 =
.8ex;border-left:1px #ccc solid;padding-left:1ex"><span class=3D"">On 12/09=
/2015 09:17 AM, William A Rowe Jr wrote:<br>
</span><blockquote class=3D"gmail_quote" style=3D"margin:0 0 0 .8ex;border-=
left:1px #ccc solid;padding-left:1ex"><span class=3D"">
On Tue, Dec 8, 2015 at 9:10 PM, Roy T. Fielding &lt;<a href=3D"mailto:field=
ing@gbiv.com" target=3D"_blank">fielding@gbiv.com</a><br></span>
&lt;mailto:<a href=3D"mailto:fielding@gbiv.com" target=3D"_blank">fielding@=
gbiv.com</a>&gt;&gt; wrote:<br><span class=3D""><br></span></blockquote><sp=
an class=3D"">
<blockquote class=3D"gmail_quote" style=3D"margin:0 0 0 .8ex;border-left:1p=
x #ccc solid;padding-left:1ex">
=C2=A0 =C2=A0 This should be easily handled by adding a filter that transla=
tes the<br>
=C2=A0 =C2=A0 HTTP/1<br>
=C2=A0 =C2=A0 incoming body (if any) to a single channel of the new protoco=
l.<br>
=C2=A0 =C2=A0 Just fake it.<br>
=C2=A0 =C2=A0 There is no need to wait or set aside the bytes, unless that =
is<br>
=C2=A0 =C2=A0 desired for<br>
=C2=A0 =C2=A0 other reasons (e.g., denial of denial of service attacks).<br=
>
<br>
However, we must read the request body complete before the input handler<br=
>
is toggled to the h2c state, or before we switch to any bidirectional<br>
protocol, e.g. TLS or otherwise.<br>
</blockquote>
<br></span>
For my own clarification: this is a protocol-specific limitation, right? As=
 in, you can&#39;t begin a TLS handshake without first draining the incomin=
g request body off the connection.</blockquote><div><br></div><div>Because =
the request body is inbound already at some state of completion</div><div>o=
r incomplete transmission, it is competing with the TLS handshake, which</d=
iv><div>is a bidirectional engagement with the same socket between the user=
 agent</div><div>and server.=C2=A0 Unlike h2c and websocket, where Roy sugg=
ests we leave the</div><div>http/1 input filter in place and inject the htt=
p/2 output filter for the duration</div><div>of the initial Upgrade: reques=
t, we must pass TLS traffic in both directions=C2=A0</div><div>at once duri=
ng Upgrade: TLS.</div><div><br></div><div>Also, the results of the TLS hand=
shake are interesting to authnz configuration</div><div>and need to be avai=
lable throughout those request phases.=C2=A0 This means that</div><div>for =
any Upgrade: TLS request must be satisfied (101 switching protocols)</div><=
div>prior to those auth phases.</div><div><br></div><div>In the case of h2c=
 and websocket, the http/1.1 request headers are sufficient</div><div>to be=
gin processing the request. At the end of the first request, the input</div=
><div>filter is also toggled into the new protocol to resume processing of =
all</div><div>subsequent requests.=C2=A0 So this Upgrade: handling must occ=
ur before the=C2=A0</div><div>request handler is invoked, even a simple han=
dler like &#39;OPTIONS *&#39;,=C2=A0</div><div>=C2=A0</div><div>Please reme=
mber that a request handler is based on a method and location,</div><div>wh=
ile Upgrade is not the request itself, but a proposal to switch protocols.<=
/div><div>In the case of TLS and h2c, that request is satisfied over the co=
rresponding=C2=A0</div><div>HTTP/1 or HTTP/2 output filter, but I&#39;m not=
 clear whether websocket has</div><div>any equivalence in terms of a conten=
t handler phase.</div><div><br></div><blockquote class=3D"gmail_quote" styl=
e=3D"margin:0 0 0 .8ex;border-left:1px #ccc solid;padding-left:1ex"><span c=
lass=3D""><blockquote class=3D"gmail_quote" style=3D"margin:0 0 0 .8ex;bord=
er-left:1px #ccc solid;padding-left:1ex">
=C2=A0 =C2=A0 &gt; 3. When to do the upgrade dance:<br>
=C2=A0 =C2=A0 &gt;=C2=A0 a post_read_request: upgrade precedes authenticati=
on<br>
=C2=A0 =C2=A0 &gt;=C2=A0 b handler: upgrade only honored on authenticated a=
nd otherwise ok requests<br>
=C2=A0 =C2=A0 &gt;=C2=A0 c both: introduce separate hooks? have an addition=
al parameter? more complexity<br>
<br>
=C2=A0 =C2=A0 (a).=C2=A0 We do want to upgrade non-ok responses.=C2=A0 If t=
he &quot;new&quot; protocol<br>
=C2=A0 =C2=A0 wants to<br>
=C2=A0 =C2=A0 send a canned HTTP/1.1 error, it can do so without our help.<=
br><br>
+1 in the case of h2c, TLS.=C2=A0 I understand that websocket upgrades are<=
br>
going to be conditional on authentication. As long as we give websocket<br>
the chance to upgrade in the fixups or similar phase, after auth, then<br>
websocket can ignore the Upgrade: websocket offer after inspecting authnz.<=
br>
</blockquote>
<br></span>
Sounds reasonable. Unfortunate in the sense that it&#39;s possible for a mo=
dule implementing the Upgrade API to screw up and accidentally ignore authn=
z, but since most protocols we&#39;re talking about can safely upgrade firs=
t and respond with 401/3 on the new protocol, I don&#39;t see much of an al=
ternative.<span class=3D""><br></span></blockquote><div>=C2=A0</div><div>Ho=
wso?=C2=A0 Any module can have any bug, I don&#39;t see your objection.</di=
v><div><br></div><div>I think we agree that TLS upgrades happen early, h2c/=
websocket upgrades</div><div>happen late (before the content handler is inv=
oked), and if either the protocol</div><div>module or an auth module has a =
bug, we fix the bugs as with any other code</div><div>in the server.=C2=A0 =
Right?</div><div><br></div><blockquote class=3D"gmail_quote" style=3D"margi=
n:0 0 0 .8ex;border-left:1px #ccc solid;padding-left:1ex"><span class=3D"">
<blockquote class=3D"gmail_quote" style=3D"margin:0 0 0 .8ex;border-left:1p=
x #ccc solid;padding-left:1ex">
=C2=A0 =C2=A0 &gt; 4. status code of protocol switch handler: if we move th=
e task of 101 sending, the switch handler might not do it and keep the conn=
ection on the &quot;old&quot; protocol. Then a connection close is not nece=
ssary. So, we would do the close only when the switch handler returns APR_E=
OF.<br>
<br>
=C2=A0 =C2=A0 Eh?<br>
<br>
I&#39;m wondering the same, the new protocol loop can do all of the<br>
connection handling, no need for the protocol switch to do anything but<br>
continue, if the connection is ended in the protocol handler, it&#39;s gone=
.<br>
</blockquote>
<br></span>
Why leave it up to the protocol handler (to potentially get wrong)? Are the=
re any cases where, after a successful upgrade, we would not want to close =
the connection upon returning from the protocol handler?</blockquote><div><=
br></div><div>Why are you focused on such bugs?=C2=A0 It isn&#39;t making a=
ny sense.=C2=A0 If the</div><div>module sends a response or indicates the c=
onnection is closed, there is=C2=A0</div><div>nothing more that happens in =
the request processing loop anyways.=C2=A0 This</div><div>isn&#39;t for the=
 core Protocol API to solve, IMHO.</div><div><br></div><div><br></div></div=
></div></div>

--001a113f93be55c03d05267f5215--

From dev-return-85016-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Thu Dec 10 00:13:03 2015
Return-Path: <dev-return-85016-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 6E1B81859B
	for <apmail-httpd-dev-archive@www.apache.org>; Thu, 10 Dec 2015 00:13:03 +0000 (UTC)
Received: (qmail 15758 invoked by uid 500); 10 Dec 2015 00:13:02 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 15689 invoked by uid 500); 10 Dec 2015 00:13:02 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 15679 invoked by uid 99); 10 Dec 2015 00:13:02 -0000
Received: from Unknown (HELO spamd2-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 10 Dec 2015 00:13:02 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd2-us-west.apache.org (ASF Mail Server at spamd2-us-west.apache.org) with ESMTP id 014991A424A
	for <dev@httpd.apache.org>; Thu, 10 Dec 2015 00:13:02 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd2-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.556
X-Spam-Level:
X-Spam-Status: No, score=-0.556 tagged_above=-999 required=6.31
	tests=[RP_MATCHES_RCVD=-0.554, SPF_HELO_PASS=-0.001, SPF_PASS=-0.001]
	autolearn=disabled
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd2-us-west.apache.org [10.40.0.9]) (amavisd-new, port 10024)
	with ESMTP id VI1W08H96Dfp for <dev@httpd.apache.org>;
	Thu, 10 Dec 2015 00:13:01 +0000 (UTC)
Received: from mail.thelounge.net (mail.thelounge.net [91.118.73.15])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id DE7BC25376
	for <dev@httpd.apache.org>; Thu, 10 Dec 2015 00:12:56 +0000 (UTC)
Subject: Re: [VOTE] Release Apache httpd 2.4.18 as GA
To: dev@httpd.apache.org
References: <AD9BFA0F-C508-4DFE-8B4F-FF79D46D9D91@jaguNET.com>
From: Reindl Harald <h.reindl@thelounge.net>
Openpgp: id=13540402D67A7F71C6E974EA866063CF7F780279;
 url=https://arrakis.thelounge.net/gpg/h.reindl_thelounge.net.pub.txt
Organization: the lounge interactive design
Message-ID: <5668C388.80106@thelounge.net>
Date: Thu, 10 Dec 2015 01:12:56 +0100
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:38.0) Gecko/20100101
 Thunderbird/38.4.0
MIME-Version: 1.0
In-Reply-To: <AD9BFA0F-C508-4DFE-8B4F-FF79D46D9D91@jaguNET.com>
Content-Type: multipart/signed; micalg=pgp-sha1;
 protocol="application/pgp-signature";
 boundary="FA7bl0MRMlIM5MiT2VJBM6uAQdEPLSG3M"

This is an OpenPGP/MIME signed message (RFC 4880 and 3156)
--FA7bl0MRMlIM5MiT2VJBM6uAQdEPLSG3M
Content-Type: text/plain; charset=windows-1252; format=flowed
Content-Transfer-Encoding: quoted-printable



Am 08.12.2015 um 21:38 schrieb Jim Jagielski:
> The pre-release test tarballs for Apache httpd 2.4.18 can be found
> at the usual place:
>
> 	http://httpd.apache.org/dev/dist/
>
> I'm calling a VOTE on releasing these as Apache httpd 2.4.18 GA.
>
> [ ] +1: Good to go
> [ ] +0: meh
> [ ] -1: Danger Will Robinson. And why.
>
> Vote will last the normal 72 hrs

+1 Fedora 23 x86_64 with mod_security 2.9 and PHP 5.6.16
without HTTP2 part of the game the same most likely for Fedora 22


--FA7bl0MRMlIM5MiT2VJBM6uAQdEPLSG3M
Content-Type: application/pgp-signature; name="signature.asc"
Content-Description: OpenPGP digital signature
Content-Disposition: attachment; filename="signature.asc"

-----BEGIN PGP SIGNATURE-----
Version: GnuPG v2

iEYEARECAAYFAlZow4gACgkQhmBjz394Anmp5wCfSJUw07vV0jEUV1lZSpu0Gozp
8HgAnjQoaH7E0+bHqjnO99mcsGftD6wd
=x7HC
-----END PGP SIGNATURE-----

--FA7bl0MRMlIM5MiT2VJBM6uAQdEPLSG3M--

From dev-return-85017-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Thu Dec 10 00:16:50 2015
Return-Path: <dev-return-85017-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 7F49D185D0
	for <apmail-httpd-dev-archive@www.apache.org>; Thu, 10 Dec 2015 00:16:50 +0000 (UTC)
Received: (qmail 22876 invoked by uid 500); 10 Dec 2015 00:16:49 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 22797 invoked by uid 500); 10 Dec 2015 00:16:49 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 22787 invoked by uid 99); 10 Dec 2015 00:16:49 -0000
Received: from Unknown (HELO spamd3-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 10 Dec 2015 00:16:49 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd3-us-west.apache.org (ASF Mail Server at spamd3-us-west.apache.org) with ESMTP id 1396A180AB6
	for <dev@httpd.apache.org>; Thu, 10 Dec 2015 00:16:49 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd3-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 0.809
X-Spam-Level:
X-Spam-Status: No, score=0.809 tagged_above=-999 required=6.31
	tests=[KAM_LAZY_DOMAIN_SECURITY=1, RDNS_DYNAMIC=0.363,
	RP_MATCHES_RCVD=-0.554, SPF_HELO_PASS=-0.001, URIBL_BLOCKED=0.001]
	autolearn=disabled
Received: from mx1-us-west.apache.org ([10.40.0.8])
	by localhost (spamd3-us-west.apache.org [10.40.0.10]) (amavisd-new, port 10024)
	with ESMTP id 9gN4GUSuvPUC for <dev@httpd.apache.org>;
	Thu, 10 Dec 2015 00:16:40 +0000 (UTC)
Received: from nebula.c8h10n4o2.org.uk (nebula.c8h10n4o2.org.uk [80.68.88.207])
	by mx1-us-west.apache.org (ASF Mail Server at mx1-us-west.apache.org) with ESMTPS id C9481265D6
	for <dev@httpd.apache.org>; Thu, 10 Dec 2015 00:16:39 +0000 (UTC)
Received: from consume.c8h10n4o2.org.uk ([2001:8b0:caee:2::2])
	by nebula.c8h10n4o2.org.uk with esmtpsa (TLS1.0:ECDHE_RSA_AES_256_CBC_SHA384:256)
	(Exim 4.84)
	(envelope-from <isoma@c8h10n4o2.org.uk>)
	id 1a6ouN-0002Jt-Oc
	for dev@httpd.apache.org; Thu, 10 Dec 2015 00:16:31 +0000
Content-Type: text/plain; charset=utf-8
Mime-Version: 1.0 (Mac OS X Mail 9.1 \(3096.5\))
Subject: Re: Upgrades
From: Tim Bannister <isoma@c8h10n4o2.org.uk>
In-Reply-To: <CACsi253sTRbX2dnuq0yRP1sHb8vOos_9QaoYmA3TtYmnNx-Erg@mail.gmail.com>
Date: Thu, 10 Dec 2015 00:16:31 +0000
Content-Transfer-Encoding: quoted-printable
Message-Id: <4E837922-E5BF-4BA1-9B91-21AD22613461@c8h10n4o2.org.uk>
References: <CACsi250=dbRQKnsbE8JSdAZRm5x99gE0sgX3iQ-PHAx77euD1A@mail.gmail.com> <AB1691BE05AE7F4992697F2A0835627AC63BAB94@VOEXM10W.internal.vodafone.com> <F7B20D30-D34A-4805-A77D-F64F6428F6E3@greenbytes.de> <56660896.c74fc20a.15f56.0ebd@mx.google.com> <56660B43.2060507@gmail.com> <6B13DF2B-0586-42BB-B62F-59A7638B697D@greenbytes.de> <13FE9E7F-9620-4BF9-8EA4-57A6314D66BF@greenbytes.de> <9CCEFD7E-9ED3-4ED1-8F58-2134DD5310F9@gbiv.com> <CACsi252y7nX0kR9+JgSra7Q_5_LVqaR3z6ExPKg=Lhi8zhN4ew@mail.gmail.com> <566887B5.2080705@gmail.com> <CACsi253sTRbX2dnuq0yRP1sHb8vOos_9QaoYmA3TtYmnNx-Erg@mail.gmail.com>
To: dev@httpd.apache.org
X-Mailer: Apple Mail (2.3096.5)

On 9 Dec 2015, at 23:19, William A Rowe Jr <wrowe@rowe-clan.net> wrote:

> Because the request body is inbound already at some state of =
completion
> or incomplete transmission, it is competing with the TLS handshake, =
which
> is a bidirectional engagement with the same socket between the user =
agent
> and server.  Unlike h2c and websocket, where Roy suggests we leave the
> http/1 input filter in place and inject the http/2 output filter for =
the duration
> of the initial Upgrade: request, we must pass TLS traffic in both =
directions=20
> at once during Upgrade: TLS.
=E2=80=A6
> Please remember that a request handler is based on a method and =
location,
> while Upgrade is not the request itself, but a proposal to switch =
protocols.
> In the case of TLS and h2c, that request is satisfied over the =
corresponding=20
> HTTP/1 or HTTP/2 output filter, but I'm not clear whether websocket =
has
> any equivalence in terms of a content handler phase.

In a sense, all upgrades happen after of an existing request (& =
response). So how about this high level behaviour model:
httpd keeps note, for each connection, of what upgrades are (1) feasible =
and (2) agreed upon.
At end of any given request, either zero or one of the feasible upgrades =
will have been agreed between web server and client. That's when the =
upgrade should happen if it has been negotiated.

Eg, for a new, inbound port 80 connection: an upgrade to TLS or h2c =
would be feasible. During the first request it may transpire that an =
upgrade to WebSocket is feasible too (authz having been satisfied). Once =
the request in which the upgrade has been negotiated is complete, said =
upgrade takes place.

Any subsequent requests on the same TCP connection won't be eligible for =
upgrade to WebSocket. This kind of rule ought to live outside the =
HTTP/1.x implementation as it has more to do with WebSocket than HTTP.


--=20
Tim Bannister =E2=80=93 isoma@c8h10n4o2.org.uk


From dev-return-85018-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Thu Dec 10 00:20:04 2015
Return-Path: <dev-return-85018-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 92335185FC
	for <apmail-httpd-dev-archive@www.apache.org>; Thu, 10 Dec 2015 00:20:04 +0000 (UTC)
Received: (qmail 28112 invoked by uid 500); 10 Dec 2015 00:19:59 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 28037 invoked by uid 500); 10 Dec 2015 00:19:59 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 28027 invoked by uid 99); 10 Dec 2015 00:19:59 -0000
Received: from Unknown (HELO spamd2-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 10 Dec 2015 00:19:59 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd2-us-west.apache.org (ASF Mail Server at spamd2-us-west.apache.org) with ESMTP id 9C4C01A2130
	for <dev@httpd.apache.org>; Thu, 10 Dec 2015 00:19:58 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd2-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.102
X-Spam-Level:
X-Spam-Status: No, score=-0.102 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RCVD_IN_MSPIKE_H2=-0.001, SPF_PASS=-0.001] autolearn=disabled
Authentication-Results: spamd2-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd2-us-west.apache.org [10.40.0.9]) (amavisd-new, port 10024)
	with ESMTP id h_GFcOD3gR-E for <dev@httpd.apache.org>;
	Thu, 10 Dec 2015 00:19:58 +0000 (UTC)
Received: from mail-pf0-f182.google.com (mail-pf0-f182.google.com [209.85.192.182])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id 42D5320C70
	for <dev@httpd.apache.org>; Thu, 10 Dec 2015 00:19:57 +0000 (UTC)
Received: by pfu207 with SMTP id 207so38033928pfu.2
        for <dev@httpd.apache.org>; Wed, 09 Dec 2015 16:19:50 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=subject:to:references:from:message-id:date:user-agent:mime-version
         :in-reply-to:content-type:content-transfer-encoding;
        bh=BeFsJxnHBut7dwFYEGmf7wFTxkBZTTDqznp3Zb0afYs=;
        b=faaEgHI2Bb1w8DMmGSMefXeBtxy6zvltYuuUdATkEHUW8dWbFqmaeIlxIb/YaFSzmX
         4udsNyOqWoDXLY4CAjXLbbpBRIRG5JXDaj+jJY5YWG7WM9XNtpmGnOH9fAIV6xByA7X7
         ETTKPtr2jHR3avps5b5KQwkqQfrEBGn9dY7/2f6NwZqN8t5osM6/Sb+Udj1xfUDBGNQA
         e4VJ26PxxqHMjJ6nUnrFWzDefSxdA9sHpdffiOVXvCHBYhzavH8hs3NaOh5mQR04TmnM
         z4JT9Vc+PjDghpv6X7ykJVD8O+x9hsyVVA/hFee+pf1rzWP1WZq5umMkWD7EwB8fooFD
         zRsA==
X-Received: by 10.98.13.211 with SMTP id 80mr2575557pfn.112.1449706790489;
        Wed, 09 Dec 2015 16:19:50 -0800 (PST)
Received: from [192.168.1.4] (50-39-117-165.bvtn.or.frontiernet.net. [50.39.117.165])
        by smtp.gmail.com with ESMTPSA id 72sm14108682pfi.33.2015.12.09.16.19.48
        for <dev@httpd.apache.org>
        (version=TLSv1/SSLv3 cipher=OTHER);
        Wed, 09 Dec 2015 16:19:48 -0800 (PST)
Subject: Re: Upgrades
To: dev@httpd.apache.org
References: <CACsi250=dbRQKnsbE8JSdAZRm5x99gE0sgX3iQ-PHAx77euD1A@mail.gmail.com>
 <AB1691BE05AE7F4992697F2A0835627AC63BAB94@VOEXM10W.internal.vodafone.com>
 <F7B20D30-D34A-4805-A77D-F64F6428F6E3@greenbytes.de>
 <56660896.c74fc20a.15f56.0ebd@mx.google.com> <56660B43.2060507@gmail.com>
 <6B13DF2B-0586-42BB-B62F-59A7638B697D@greenbytes.de>
 <13FE9E7F-9620-4BF9-8EA4-57A6314D66BF@greenbytes.de>
 <9CCEFD7E-9ED3-4ED1-8F58-2134DD5310F9@gbiv.com>
 <CACsi252y7nX0kR9+JgSra7Q_5_LVqaR3z6ExPKg=Lhi8zhN4ew@mail.gmail.com>
 <566887B5.2080705@gmail.com>
 <CACsi253sTRbX2dnuq0yRP1sHb8vOos_9QaoYmA3TtYmnNx-Erg@mail.gmail.com>
 <4E837922-E5BF-4BA1-9B91-21AD22613461@c8h10n4o2.org.uk>
From: Jacob Champion <champion.p@gmail.com>
Message-ID: <5668C523.108@gmail.com>
Date: Wed, 9 Dec 2015 16:19:47 -0800
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:38.0) Gecko/20100101
 Thunderbird/38.4.0
MIME-Version: 1.0
In-Reply-To: <4E837922-E5BF-4BA1-9B91-21AD22613461@c8h10n4o2.org.uk>
Content-Type: text/plain; charset=utf-8; format=flowed
Content-Transfer-Encoding: 7bit

On 12/09/2015 04:16 PM, Tim Bannister wrote:
> Any subsequent requests on the same TCP connection won't be eligible for upgrade to WebSocket.

Why not?

--Jacob


From dev-return-85019-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Thu Dec 10 00:50:29 2015
Return-Path: <dev-return-85019-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 742601870F
	for <apmail-httpd-dev-archive@www.apache.org>; Thu, 10 Dec 2015 00:50:29 +0000 (UTC)
Received: (qmail 94735 invoked by uid 500); 10 Dec 2015 00:50:28 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 94660 invoked by uid 500); 10 Dec 2015 00:50:28 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 94650 invoked by uid 99); 10 Dec 2015 00:50:28 -0000
Received: from Unknown (HELO spamd2-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 10 Dec 2015 00:50:28 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd2-us-west.apache.org (ASF Mail Server at spamd2-us-west.apache.org) with ESMTP id 5B0E01A23A5
	for <dev@httpd.apache.org>; Thu, 10 Dec 2015 00:50:28 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd2-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.102
X-Spam-Level:
X-Spam-Status: No, score=-0.102 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RCVD_IN_MSPIKE_H2=-0.001, SPF_PASS=-0.001] autolearn=disabled
Authentication-Results: spamd2-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd2-us-west.apache.org [10.40.0.9]) (amavisd-new, port 10024)
	with ESMTP id WCMq_FYNeWxU for <dev@httpd.apache.org>;
	Thu, 10 Dec 2015 00:50:27 +0000 (UTC)
Received: from mail-pf0-f172.google.com (mail-pf0-f172.google.com [209.85.192.172])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id DC15442989
	for <dev@httpd.apache.org>; Thu, 10 Dec 2015 00:50:26 +0000 (UTC)
Received: by pfbg73 with SMTP id g73so39244978pfb.1
        for <dev@httpd.apache.org>; Wed, 09 Dec 2015 16:50:26 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=subject:to:references:from:message-id:date:user-agent:mime-version
         :in-reply-to:content-type:content-transfer-encoding;
        bh=gw3sJ9Zv27akAodkdXJCvlEDHSOvWrzrKgpEvPz44+w=;
        b=LBtFzxOHcWWqVHc6CHIqsg7T9w9zPU63tJ7M+4yegHOfXIlSVhvSLUrQa3B+22aNmN
         F+TcWRY9o2HlfKpdIrrXXoOGi577xYZErPeBcOCKftnorej+HBppQAJRQc0ifU16g79M
         QJmMtJ2P/G5atN9gNoyP2+HpldubagGKkZTQA+JUwyug1HxbtuuBJtSWCvcbX2W+qDnw
         eEQzoQ1z51FbUXgP4XtmRbyAMQjONzVhlHoFfXxE0n4pocfoQhjnoMKG/rpU/Evb1/Y8
         nnVpRYWUmr5ZgoiX1ECgduJAvPVULfX0qe4aAzbCnyYiSp+WTBhRGvOXNRUrXXGpBEEP
         zOyw==
X-Received: by 10.98.86.92 with SMTP id k89mr2680801pfb.111.1449708626224;
        Wed, 09 Dec 2015 16:50:26 -0800 (PST)
Received: from [192.168.1.4] (50-39-117-165.bvtn.or.frontiernet.net. [50.39.117.165])
        by smtp.gmail.com with ESMTPSA id sm8sm14354358pac.43.2015.12.09.16.50.24
        for <dev@httpd.apache.org>
        (version=TLSv1/SSLv3 cipher=OTHER);
        Wed, 09 Dec 2015 16:50:25 -0800 (PST)
Subject: Re: Upgrade Summary
To: dev@httpd.apache.org
References: <CACsi250=dbRQKnsbE8JSdAZRm5x99gE0sgX3iQ-PHAx77euD1A@mail.gmail.com>
 <AB1691BE05AE7F4992697F2A0835627AC63BAB94@VOEXM10W.internal.vodafone.com>
 <F7B20D30-D34A-4805-A77D-F64F6428F6E3@greenbytes.de>
 <56660896.c74fc20a.15f56.0ebd@mx.google.com> <56660B43.2060507@gmail.com>
 <6B13DF2B-0586-42BB-B62F-59A7638B697D@greenbytes.de>
 <13FE9E7F-9620-4BF9-8EA4-57A6314D66BF@greenbytes.de>
 <9CCEFD7E-9ED3-4ED1-8F58-2134DD5310F9@gbiv.com>
 <CACsi252y7nX0kR9+JgSra7Q_5_LVqaR3z6ExPKg=Lhi8zhN4ew@mail.gmail.com>
 <566887B5.2080705@gmail.com>
 <CACsi253sTRbX2dnuq0yRP1sHb8vOos_9QaoYmA3TtYmnNx-Erg@mail.gmail.com>
From: Jacob Champion <champion.p@gmail.com>
Message-ID: <5668CC4F.109@gmail.com>
Date: Wed, 9 Dec 2015 16:50:23 -0800
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:38.0) Gecko/20100101
 Thunderbird/38.4.0
MIME-Version: 1.0
In-Reply-To: <CACsi253sTRbX2dnuq0yRP1sHb8vOos_9QaoYmA3TtYmnNx-Erg@mail.gmail.com>
Content-Type: text/plain; charset=utf-8; format=flowed
Content-Transfer-Encoding: 7bit

On 12/09/2015 03:19 PM, William A Rowe Jr wrote:
> Because the request body is inbound already at some state of completion
> or incomplete transmission, it is competing with the TLS handshake, which
> is a bidirectional engagement with the same socket between the user agent
> and server.  Unlike h2c and websocket, where Roy suggests we leave the
> http/1 input filter in place and inject the http/2 output filter for the
> duration
> of the initial Upgrade: request, we must pass TLS traffic in both
> directions
> at once during Upgrade: TLS.
>
> Also, the results of the TLS handshake are interesting to authnz
> configuration
> and need to be available throughout those request phases.  This means that
> for any Upgrade: TLS request must be satisfied (101 switching protocols)
> prior to those auth phases.
>
> In the case of h2c and websocket, the http/1.1 request headers are
> sufficient
> to begin processing the request. At the end of the first request, the input
> filter is also toggled into the new protocol to resume processing of all
> subsequent requests.  So this Upgrade: handling must occur before the
> request handler is invoked, even a simple handler like 'OPTIONS *',

Great, thanks for the clarification.

> Please remember that a request handler is based on a method and location,
> while Upgrade is not the request itself, but a proposal to switch protocols.

I... think I agree with you, but I'm not clear on the point you're 
trying to make. It is true that an Upgrade is a proposal to switch 
protocols. It is also true that an Upgrade is associated with a specific 
HTTP/1.1 request, with a specific request-target.

The latter point is (more?) important for protocols like WebSocket. When 
you do a [GET /blah + Upgrade: h2c], the resulting protocol (HTTP/2) has 
access to the full global scope of the server after the upgrade. Even if 
/blah doesn't exist(!), the upgrade can proceed, and I can use the 
resulting connection to perform other HTTP/2 requests.

In contrast, a WebSocket upgrade limits the scope of the connection to 
whatever resource is at the request-target. If I have two WebSocket 
endpoints at /ws1 and /ws2, and I do a [GET /ws1 + Upgrade: websocket], 
I can't use the resulting connection to later switch to the resource at 
/ws2. I'm stuck with whatever is at /ws1 until I start a completely new 
connection.

> In the case of TLS and h2c, that request is satisfied over the
> corresponding
> HTTP/1 or HTTP/2 output filter, but I'm not clear whether websocket has
> any equivalence in terms of a content handler phase.

The "handler phase" is simply the establishment of a bidirectional 
WebSocket connection. If the client did something pathological like 
sending a request body with their GET request, I think that needs to go 
into the bit bucket before the upgrade completes.

>     Sounds reasonable. Unfortunate in the sense that it's possible for a
>     module implementing the Upgrade API to screw up and accidentally
>     ignore authnz, but since most protocols we're talking about can
>     safely upgrade first and respond with 401/3 on the new protocol, I
>     don't see much of an alternative.
>
> Howso?  Any module can have any bug, I don't see your objection.

Some APIs are easier to write bugs with than others. All else being 
equal, I have a personal preference for strong/defensive API boundaries 
over weaker/looser ones, that's all. Especially for security-related code.

_If_ all the other protocols worked like WebSocket and required authnz 
before an upgrade could succeed, it wouldn't make sense for each upgrade 
handler to have to do the authnz check themselves. But in this case, 
WebSocket is different enough that I think it will probably have to.

>     Why leave it up to the protocol handler (to potentially get wrong)?
>     Are there any cases where, after a successful upgrade, we would not
>     want to close the connection upon returning from the protocol handler?
>
> Why are you focused on such bugs?  It isn't making any sense.

Same reason as before. Reducing the number of places an upgrade handler 
can get it wrong by strengthening the API's guarantees is a Good Thing, 
IMHO, as long as the cost of doing that is reasonable and we aren't 
painting ourselves into a corner.

--Jacob

From dev-return-85020-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Thu Dec 10 01:07:11 2015
Return-Path: <dev-return-85020-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 37598187DD
	for <apmail-httpd-dev-archive@www.apache.org>; Thu, 10 Dec 2015 01:07:11 +0000 (UTC)
Received: (qmail 25100 invoked by uid 500); 10 Dec 2015 01:07:10 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 25023 invoked by uid 500); 10 Dec 2015 01:07:10 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 25013 invoked by uid 99); 10 Dec 2015 01:07:10 -0000
Received: from Unknown (HELO spamd3-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 10 Dec 2015 01:07:10 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd3-us-west.apache.org (ASF Mail Server at spamd3-us-west.apache.org) with ESMTP id 2EEDA180AB6
	for <dev@httpd.apache.org>; Thu, 10 Dec 2015 01:07:10 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd3-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 3
X-Spam-Level: ***
X-Spam-Status: No, score=3 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, HTML_MESSAGE=3,
	SPF_PASS=-0.001, URIBL_BLOCKED=0.001] autolearn=disabled
Authentication-Results: spamd3-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=rowe-clan-net.20150623.gappssmtp.com
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd3-us-west.apache.org [10.40.0.10]) (amavisd-new, port 10024)
	with ESMTP id 6ngKm77EmRhS for <dev@httpd.apache.org>;
	Thu, 10 Dec 2015 01:07:02 +0000 (UTC)
Received: from mail-ig0-f177.google.com (mail-ig0-f177.google.com [209.85.213.177])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id B199542989
	for <dev@httpd.apache.org>; Thu, 10 Dec 2015 01:07:01 +0000 (UTC)
Received: by mail-ig0-f177.google.com with SMTP id su19so2833705igc.0
        for <dev@httpd.apache.org>; Wed, 09 Dec 2015 17:07:01 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=rowe-clan-net.20150623.gappssmtp.com; s=20150623;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        bh=KdozzF+aQ1JnaWu06gK3yAAY8QvdtCSWUQ8QDMuMNWI=;
        b=FhTTUERAfEsS93RdS7YIN3MGFgHakZL8c6jxGz3khaUpNXkgvMM6OftjnBf8/RxTfp
         C4xMC/2Oqx1yhUU80+iu/bShzCrmrTJqCuYhNUkfUjTWbgoIr4x3Gv5h340CCm2DmrAK
         rUKsTPQuRyM2ttN3/8itCSTJH1/KJ5mFtv94AZHrAnjPKONsCHcAAIwlxkBJCP8jco0d
         iz1Xcd20p38u05Hz9S0PDC7eEmOVKgAVRgFWvNOAyrs54No88LLHl56CEfynMd+WqsGz
         dx0YXIbLM7byZPjUz9IYjlIKIvv9v6k5npShFnN/t98FkjrQJEIvKBVlIyq5ffscg/9X
         Awtg==
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=1e100.net; s=20130820;
        h=x-gm-message-state:mime-version:in-reply-to:references:date
         :message-id:subject:from:to:content-type;
        bh=KdozzF+aQ1JnaWu06gK3yAAY8QvdtCSWUQ8QDMuMNWI=;
        b=C2J4asHsL6LPgmU2ILGY5relnN7ZQY016Tg7385SKNO8gsAwaT+Z3603MOQXfGOiTY
         tcuQPcl08UTYoNu8dQljLpiyowJu85JCG+R/2o2lhHCTe+tw287pw2Y2tHc24l2R1zme
         0Rt6cbw/Jgn9emox7RREdnK/B9ZB/mGTke/neHtNL/iNTFj/4P4BEnf8BxpwuTvQotWE
         vmD+Hg+r2As+UjcCxHRt/jVlumDYNVhOo6qj2PyftxwNh0OxWZYtQ1WpKYWAiPCR72up
         Znnx6kbogUVJTYFf9u25DMwCEpHnphA0QzZcwWbMyh2CHwWFh3zRSxzye7yF5d13QV5E
         XPoQ==
X-Gm-Message-State: ALoCoQlT0SXgCSPCb3deklJ/jGfSbOq+PZGrPH/dirlC+So23mpI0COxbtY0XWZ92iiTIZVxFdvV2U2ArS0hlCskmUklFjBS50f2MGnqGxHLvo361AOVuB0=
MIME-Version: 1.0
X-Received: by 10.50.43.164 with SMTP id x4mr337430igl.35.1449709621189; Wed,
 09 Dec 2015 17:07:01 -0800 (PST)
Received: by 10.107.62.136 with HTTP; Wed, 9 Dec 2015 17:07:01 -0800 (PST)
In-Reply-To: <4E837922-E5BF-4BA1-9B91-21AD22613461@c8h10n4o2.org.uk>
References: <CACsi250=dbRQKnsbE8JSdAZRm5x99gE0sgX3iQ-PHAx77euD1A@mail.gmail.com>
	<AB1691BE05AE7F4992697F2A0835627AC63BAB94@VOEXM10W.internal.vodafone.com>
	<F7B20D30-D34A-4805-A77D-F64F6428F6E3@greenbytes.de>
	<56660896.c74fc20a.15f56.0ebd@mx.google.com>
	<56660B43.2060507@gmail.com>
	<6B13DF2B-0586-42BB-B62F-59A7638B697D@greenbytes.de>
	<13FE9E7F-9620-4BF9-8EA4-57A6314D66BF@greenbytes.de>
	<9CCEFD7E-9ED3-4ED1-8F58-2134DD5310F9@gbiv.com>
	<CACsi252y7nX0kR9+JgSra7Q_5_LVqaR3z6ExPKg=Lhi8zhN4ew@mail.gmail.com>
	<566887B5.2080705@gmail.com>
	<CACsi253sTRbX2dnuq0yRP1sHb8vOos_9QaoYmA3TtYmnNx-Erg@mail.gmail.com>
	<4E837922-E5BF-4BA1-9B91-21AD22613461@c8h10n4o2.org.uk>
Date: Wed, 9 Dec 2015 19:07:01 -0600
Message-ID: <CACsi252GzY3QZ3_7qw_07QMDwMi8D=MD=Lq38_FcR+0_rtzodQ@mail.gmail.com>
Subject: Re: Upgrades
From: William A Rowe Jr <wrowe@rowe-clan.net>
To: httpd <dev@httpd.apache.org>
Content-Type: multipart/alternative; boundary=089e01184b10ffbd5a052680d251

--089e01184b10ffbd5a052680d251
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: quoted-printable

On Wed, Dec 9, 2015 at 6:16 PM, Tim Bannister <isoma@c8h10n4o2.org.uk>
wrote:

> On 9 Dec 2015, at 23:19, William A Rowe Jr <wrowe@rowe-clan.net> wrote:
>
> > Because the request body is inbound already at some state of completion
> > or incomplete transmission, it is competing with the TLS handshake, whi=
ch
> > is a bidirectional engagement with the same socket between the user age=
nt
> > and server.  Unlike h2c and websocket, where Roy suggests we leave the
> > http/1 input filter in place and inject the http/2 output filter for th=
e
> duration
> > of the initial Upgrade: request, we must pass TLS traffic in both
> directions
> > at once during Upgrade: TLS.
> =E2=80=A6
> > Please remember that a request handler is based on a method and locatio=
n,
> > while Upgrade is not the request itself, but a proposal to switch
> protocols.
> > In the case of TLS and h2c, that request is satisfied over the
> corresponding
> > HTTP/1 or HTTP/2 output filter, but I'm not clear whether websocket has
> > any equivalence in terms of a content handler phase.
>
> In a sense, all upgrades happen after of an existing request (& response)=
.
> So how about this high level behaviour model:
> httpd keeps note, for each connection, of what upgrades are (1) feasible
> and (2) agreed upon.
> At end of any given request, either zero or one of the feasible upgrades
> will have been agreed between web server and client. That's when the
> upgrade should happen if it has been negotiated.
>

I think that is the design we are arriving at, that each module is queried
early
if an upgrade should be advertised, and given the chance to begin the
upgrade,
and then immediately before the content handler (after auth) these steps
are
repeated, giving the protocol modules a chance to offer an upgrade or back
out of an intended offer.  The offers must be assembled before the content
handler causes the http/1 protocol filter to push out the response headers.

In the TLS case, it must happen very early for TLS
handshake/certificates/SNI
inspection for auth purposes, and prior to beginning the response.  No
upgrade
can happen after a response (except within the next request) because the
upgrade is a product of the 101-switching protocols.

There is a case to be made for the h2c to also be an 'early' upgrade
decision,
AIUI (correct me if I'm wrong Stefan) the mod_http2 module sees a request,
grabs ahold of the network in the main request thread, and then
're-processes'
the request, repeating all of the request processing hooks for the initial
request
on the secondary h2c 'worker' thread.  By interrupting very early, during
the
post_read_request phase, these steps will no longer be duplicated.

The main thread can still leave the http/1 input filter in place to provide
the
initial request body to that initial worker thread, but won't see
additional http/2
requests until that request body is consumed, completing the 101-switching
protocols contract.

The reason not to leave the initial http/1 request in the primary thread
until
it has been satisfied is that the connection would block on both the initia=
l
request body and the initial response, which would be a huge penalty for
an initial request that performed some back-end processing and might
have database or other back-end contention.

Eg, for a new, inbound port 80 connection: an upgrade to TLS or h2c would
> be feasible. During the first request it may transpire that an upgrade to
> WebSocket is feasible too (authz having been satisfied). Once the request
> in which the upgrade has been negotiated is complete, said upgrade takes
> place.
>

For every request within a connection, such an upgrade remains feasible.


> Any subsequent requests on the same TCP connection won't be eligible for
> upgrade to WebSocket. This kind of rule ought to live outside the HTTP/1.=
x
> implementation as it has more to do with WebSocket than HTTP.
>

I'm wondering the same thing, why not on the third or twentieth request?
It simply can't be downgraded back to HTTP/1, if I understand the spec
correctly.

--089e01184b10ffbd5a052680d251
Content-Type: text/html; charset=UTF-8
Content-Transfer-Encoding: quoted-printable

<div dir=3D"ltr"><div class=3D"gmail_extra"><div class=3D"gmail_quote">On W=
ed, Dec 9, 2015 at 6:16 PM, Tim Bannister <span dir=3D"ltr">&lt;<a href=3D"=
mailto:isoma@c8h10n4o2.org.uk" target=3D"_blank">isoma@c8h10n4o2.org.uk</a>=
&gt;</span> wrote:<br><blockquote class=3D"gmail_quote" style=3D"margin:0 0=
 0 .8ex;border-left:1px #ccc solid;padding-left:1ex">On 9 Dec 2015, at 23:1=
9, William A Rowe Jr &lt;<a href=3D"mailto:wrowe@rowe-clan.net" target=3D"_=
blank">wrowe@rowe-clan.net</a>&gt; wrote:<br>
<br>
&gt; Because the request body is inbound already at some state of completio=
n<br>
&gt; or incomplete transmission, it is competing with the TLS handshake, wh=
ich<br>
&gt; is a bidirectional engagement with the same socket between the user ag=
ent<br>
&gt; and server.=C2=A0 Unlike h2c and websocket, where Roy suggests we leav=
e the<br>
&gt; http/1 input filter in place and inject the http/2 output filter for t=
he duration<br>
&gt; of the initial Upgrade: request, we must pass TLS traffic in both dire=
ctions<br>
&gt; at once during Upgrade: TLS.<br>
=E2=80=A6<br>
&gt; Please remember that a request handler is based on a method and locati=
on,<br>
&gt; while Upgrade is not the request itself, but a proposal to switch prot=
ocols.<br>
&gt; In the case of TLS and h2c, that request is satisfied over the corresp=
onding<br>
&gt; HTTP/1 or HTTP/2 output filter, but I&#39;m not clear whether websocke=
t has<br>
&gt; any equivalence in terms of a content handler phase.<br>
<br>
In a sense, all upgrades happen after of an existing request (&amp; respons=
e). So how about this high level behaviour model:<br>
httpd keeps note, for each connection, of what upgrades are (1) feasible an=
d (2) agreed upon.<br>
At end of any given request, either zero or one of the feasible upgrades wi=
ll have been agreed between web server and client. That&#39;s when the upgr=
ade should happen if it has been negotiated.<br></blockquote><div><br></div=
><div>I think that is the design we are arriving at, that each module is qu=
eried early</div><div>if an upgrade should be advertised, and given the cha=
nce to begin the upgrade,</div><div>and then immediately before the content=
 handler (after auth) these steps are=C2=A0</div><div>repeated, giving the =
protocol modules a chance to offer an upgrade or back=C2=A0</div><div>out o=
f an intended offer.=C2=A0 The offers must be assembled before the content=
=C2=A0</div><div>handler causes the http/1 protocol filter to push out the =
response headers.</div><div><br></div><div>In the TLS case, it must happen =
very early for TLS handshake/certificates/SNI=C2=A0</div><div>inspection fo=
r auth purposes, and prior to beginning the response.=C2=A0 No upgrade</div=
><div>can happen after a response (except within the next request) because =
the=C2=A0</div><div>upgrade is a product of the 101-switching protocols.</d=
iv><div><br></div><div>There is a case to be made for the h2c to also be an=
 &#39;early&#39; upgrade decision,</div><div>AIUI (correct me if I&#39;m wr=
ong Stefan) the mod_http2 module sees a request,</div><div>grabs ahold of t=
he network in the main request thread, and then &#39;re-processes&#39;</div=
><div>the request, repeating all of the request processing hooks for the in=
itial request</div><div>on the secondary h2c &#39;worker&#39; thread.=C2=A0=
 By interrupting very early, during the</div><div>post_read_request phase, =
these steps will no longer be duplicated.</div><div><br></div><div>The main=
 thread can still leave the http/1 input filter in place to provide the</di=
v><div>initial request body to that initial worker thread, but won&#39;t se=
e additional http/2</div><div>requests until that request body is consumed,=
 completing the 101-switching</div><div>protocols contract.<br></div><div><=
br></div><div>The reason not to leave the initial http/1 request in the pri=
mary thread until</div><div>it has been satisfied is that the connection wo=
uld block on both the initial</div><div>request body and the initial respon=
se, which would be a huge penalty for</div><div>an initial request that per=
formed some back-end processing and might</div><div>have database or other =
back-end contention.</div><div><br></div><blockquote class=3D"gmail_quote" =
style=3D"margin:0 0 0 .8ex;border-left:1px #ccc solid;padding-left:1ex">
Eg, for a new, inbound port 80 connection: an upgrade to TLS or h2c would b=
e feasible. During the first request it may transpire that an upgrade to We=
bSocket is feasible too (authz having been satisfied). Once the request in =
which the upgrade has been negotiated is complete, said upgrade takes place=
.<br></blockquote><div><br></div><div>For every request within a connection=
, such an upgrade remains feasible.</div><div>=C2=A0</div><blockquote class=
=3D"gmail_quote" style=3D"margin:0 0 0 .8ex;border-left:1px #ccc solid;padd=
ing-left:1ex">
Any subsequent requests on the same TCP connection won&#39;t be eligible fo=
r upgrade to WebSocket. This kind of rule ought to live outside the HTTP/1.=
x implementation as it has more to do with WebSocket than HTTP.<br></blockq=
uote><div><br></div><div>I&#39;m wondering the same thing, why not on the t=
hird or twentieth request?</div><div>It simply can&#39;t be downgraded back=
 to HTTP/1, if I understand the spec correctly.=C2=A0</div></div><br></div>=
</div>

--089e01184b10ffbd5a052680d251--

From dev-return-85021-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Thu Dec 10 01:19:27 2015
Return-Path: <dev-return-85021-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 81F3118867
	for <apmail-httpd-dev-archive@www.apache.org>; Thu, 10 Dec 2015 01:19:27 +0000 (UTC)
Received: (qmail 50549 invoked by uid 500); 10 Dec 2015 01:19:27 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 50460 invoked by uid 500); 10 Dec 2015 01:19:27 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 50444 invoked by uid 99); 10 Dec 2015 01:19:26 -0000
Received: from Unknown (HELO spamd3-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 10 Dec 2015 01:19:26 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd3-us-west.apache.org (ASF Mail Server at spamd3-us-west.apache.org) with ESMTP id 739F1180AB6
	for <dev@httpd.apache.org>; Thu, 10 Dec 2015 01:19:26 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd3-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 2.979
X-Spam-Level: **
X-Spam-Status: No, score=2.979 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, HTML_MESSAGE=3,
	RCVD_IN_MSPIKE_H3=-0.01, RCVD_IN_MSPIKE_WL=-0.01, SPF_PASS=-0.001]
	autolearn=disabled
Authentication-Results: spamd3-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=rowe-clan-net.20150623.gappssmtp.com
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd3-us-west.apache.org [10.40.0.10]) (amavisd-new, port 10024)
	with ESMTP id v8UqNQpdueZY for <dev@httpd.apache.org>;
	Thu, 10 Dec 2015 01:19:23 +0000 (UTC)
Received: from mail-ig0-f181.google.com (mail-ig0-f181.google.com [209.85.213.181])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id BB5202302D
	for <dev@httpd.apache.org>; Thu, 10 Dec 2015 01:19:22 +0000 (UTC)
Received: by igcto18 with SMTP id to18so2978365igc.0
        for <dev@httpd.apache.org>; Wed, 09 Dec 2015 17:19:21 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=rowe-clan-net.20150623.gappssmtp.com; s=20150623;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        bh=70x9BTDhrs4HZiT/Xfu1B3wvatrKvbKm7mOFsgys4FU=;
        b=Mh5w19c27Kq4keTLPrwbpcpeu40G9DEwHGRaDPGMsOx+rsoCEahpmqO6dSEsxcg47e
         warhM43m6MwDRq29chVurFFJRIC06ukzZcPwx4I1zxwD3bTa+4SQrl1kX4VICsx6EbiJ
         aWfk83ouKwq545jFxhS7Tun+xV0czGgBgDOh5mkYTtORwVMFWNhExjflfik7GogWnJBV
         9/Qa7IlnRxDlm78ltKbJAbPe61/HJkGTrWh18lIJVzCSENR9Am7EXl/PHvCkS4+37stn
         +SarpyTYQTZzRwo77HAfW6GixOh/32r287vIe+E3U6pW7g4L7m+3JNlLcBghZd9MORik
         mnlA==
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=1e100.net; s=20130820;
        h=x-gm-message-state:mime-version:in-reply-to:references:date
         :message-id:subject:from:to:content-type;
        bh=70x9BTDhrs4HZiT/Xfu1B3wvatrKvbKm7mOFsgys4FU=;
        b=PYsKhINZeXqKUQ7T5JTXeO8BVeRSvUz3oh3AXRzvDvSjb+0Sljp07cWJo/1974MBHG
         d/Hrjq0vgwJrJYfUGC97BoQtlcNwq7lTV/rY1Ahg0i2cXgFlUTIS+L1DUEmrpvvXpvvI
         Nm2JUQGSOQay0gKHewjFiDfkimIH8UBGH5vli6HE8qMjk6ZE3sHgp9dqfVxpwc3osH8V
         1cJR13cL0wGHrSyG/TKXGJPiF/X1oZU86DwLAzVeC4UQB1YGLi+zkmRGEJfpz/sadUq9
         7TOCJhKmMJ1MFgEkAZIemFb5/cLADIXFwsglXBlvuNLasMfd+7/9Nco5I7EpTOgLrH4i
         7Y5w==
X-Gm-Message-State: ALoCoQkPX1UMQ2rcSKKhnSwuP1j794Jllom3uRwEj6UQHxLsfnmv+a1p8gkfIVyGyhaDWNU0COWoPyezTbsRHSpgd8FvWY/5l2WhrtCGQVdnvGnIt/XGnPo=
MIME-Version: 1.0
X-Received: by 10.50.43.164 with SMTP id x4mr390394igl.35.1449710361702; Wed,
 09 Dec 2015 17:19:21 -0800 (PST)
Received: by 10.107.62.136 with HTTP; Wed, 9 Dec 2015 17:19:21 -0800 (PST)
In-Reply-To: <5668CC4F.109@gmail.com>
References: <CACsi250=dbRQKnsbE8JSdAZRm5x99gE0sgX3iQ-PHAx77euD1A@mail.gmail.com>
	<AB1691BE05AE7F4992697F2A0835627AC63BAB94@VOEXM10W.internal.vodafone.com>
	<F7B20D30-D34A-4805-A77D-F64F6428F6E3@greenbytes.de>
	<56660896.c74fc20a.15f56.0ebd@mx.google.com>
	<56660B43.2060507@gmail.com>
	<6B13DF2B-0586-42BB-B62F-59A7638B697D@greenbytes.de>
	<13FE9E7F-9620-4BF9-8EA4-57A6314D66BF@greenbytes.de>
	<9CCEFD7E-9ED3-4ED1-8F58-2134DD5310F9@gbiv.com>
	<CACsi252y7nX0kR9+JgSra7Q_5_LVqaR3z6ExPKg=Lhi8zhN4ew@mail.gmail.com>
	<566887B5.2080705@gmail.com>
	<CACsi253sTRbX2dnuq0yRP1sHb8vOos_9QaoYmA3TtYmnNx-Erg@mail.gmail.com>
	<5668CC4F.109@gmail.com>
Date: Wed, 9 Dec 2015 19:19:21 -0600
Message-ID: <CACsi253q+GanuRzOqBjaOe-h1w8uOcH6uFAcdres=+ig5q6+VA@mail.gmail.com>
Subject: Re: Upgrade Summary
From: William A Rowe Jr <wrowe@rowe-clan.net>
To: httpd <dev@httpd.apache.org>
Content-Type: multipart/alternative; boundary=089e01184b102324fd052680ff3c

--089e01184b102324fd052680ff3c
Content-Type: text/plain; charset=UTF-8

On Wed, Dec 9, 2015 at 6:50 PM, Jacob Champion <champion.p@gmail.com> wrote:

> On 12/09/2015 03:19 PM, William A Rowe Jr wrote:
>
>> Because the request body is inbound already at some state of completion
>> or incomplete transmission, it is competing with the TLS handshake, which
>> is a bidirectional engagement with the same socket between the user agent
>> and server.  Unlike h2c and websocket, where Roy suggests we leave the
>> http/1 input filter in place and inject the http/2 output filter for the
>> duration
>> of the initial Upgrade: request, we must pass TLS traffic in both
>> directions
>> at once during Upgrade: TLS.
>>
>> Also, the results of the TLS handshake are interesting to authnz
>> configuration
>> and need to be available throughout those request phases.  This means that
>> for any Upgrade: TLS request must be satisfied (101 switching protocols)
>> prior to those auth phases.
>>
>> In the case of h2c and websocket, the http/1.1 request headers are
>> sufficient
>> to begin processing the request. At the end of the first request, the
>> input
>> filter is also toggled into the new protocol to resume processing of all
>> subsequent requests.  So this Upgrade: handling must occur before the
>> request handler is invoked, even a simple handler like 'OPTIONS *',
>>
>
> Great, thanks for the clarification.
>
> Please remember that a request handler is based on a method and location,
>> while Upgrade is not the request itself, but a proposal to switch
>> protocols.
>>
>
> I... think I agree with you, but I'm not clear on the point you're trying
> to make. It is true that an Upgrade is a proposal to switch protocols. It
> is also true that an Upgrade is associated with a specific HTTP/1.1
> request, with a specific request-target.
>
> The latter point is (more?) important for protocols like WebSocket. When
> you do a [GET /blah + Upgrade: h2c], the resulting protocol (HTTP/2) has
> access to the full global scope of the server after the upgrade. Even if
> /blah doesn't exist(!), the upgrade can proceed, and I can use the
> resulting connection to perform other HTTP/2 requests.
>
> In contrast, a WebSocket upgrade limits the scope of the connection to
> whatever resource is at the request-target. If I have two WebSocket
> endpoints at /ws1 and /ws2, and I do a [GET /ws1 + Upgrade: websocket], I
> can't use the resulting connection to later switch to the resource at /ws2.
> I'm stuck with whatever is at /ws1 until I start a completely new
> connection.


That was my understanding, thanks for clarifying.


> In the case of TLS and h2c, that request is satisfied over the
>> corresponding
>> HTTP/1 or HTTP/2 output filter, but I'm not clear whether websocket has
>> any equivalence in terms of a content handler phase.
>>
>
> The "handler phase" is simply the establishment of a bidirectional
> WebSocket connection. If the client did something pathological like sending
> a request body with their GET request, I think that needs to go into the
> bit bucket before the upgrade completes.


If that is permissible under the websocket API, then fine.  If the
websocket
protocol disallows request bodies altogether, that's also fine.  You simply
ignore the Upgrade: request and we continue to process the request as
http/1.  If there is no http/1 representation, the appropriate error should
be
emitted in or before the handler phase.


>     Sounds reasonable. Unfortunate in the sense that it's possible for a
>>     module implementing the Upgrade API to screw up and accidentally
>>     ignore authnz, but since most protocols we're talking about can
>>     safely upgrade first and respond with 401/3 on the new protocol, I
>>     don't see much of an alternative.
>>
>> Howso?  Any module can have any bug, I don't see your objection.
>>
>
> Some APIs are easier to write bugs with than others. All else being equal,
> I have a personal preference for strong/defensive API boundaries over
> weaker/looser ones, that's all. Especially for security-related code.
>
> _If_ all the other protocols worked like WebSocket and required authnz
> before an upgrade could succeed, it wouldn't make sense for each upgrade
> handler to have to do the authnz check themselves. But in this case,
> WebSocket is different enough that I think it will probably have to.
>

No, because we will simply give you two chances to accept and trigger
the upgrade, once in the post_read_request, another in ap_invoke_handler
phase before filters are inserted.  A websocket protocol handler will likely
choose the later, obviously.  TLS and quite possibly h2c should choose
the former.  Other Upgrade: handers to be added later would make their
respective choice based on what they need to accomplish.


>     Why leave it up to the protocol handler (to potentially get wrong)?
>>     Are there any cases where, after a successful upgrade, we would not
>>     want to close the connection upon returning from the protocol handler?
>>
>> Why are you focused on such bugs?  It isn't making any sense.
>>
>
> Same reason as before. Reducing the number of places an upgrade handler
> can get it wrong by strengthening the API's guarantees is a Good Thing,
> IMHO, as long as the cost of doing that is reasonable and we aren't
> painting ourselves into a corner.


But you are painting all the other protocols into a corner.  TLS will resume
the http/1 request on the same thread.  h2c will resume the http/1 request
either in the same thread (problematic) or in an h2 worker thread.  That
request_rec will indicate completion, the h2c or websocket protocol marks
the connection: close (or already closed/eof, depending) which prevents
the original http/1 handler from treating the connection as a keep-alive
connection.  In the websocket case, I expect you can do that as step #1
in the protocol handler to address any paranoia about falling back into the
request processing cycle.

Good coding style should prevent the scenarios you describe, that's why
we leverage peer review, much like the recent review of the protocol api by
so many of the httpd devs.  I'd certainly like to see a websocket prototype
or outline before we declare the protocol baked for the second time :)

--089e01184b102324fd052680ff3c
Content-Type: text/html; charset=UTF-8
Content-Transfer-Encoding: quoted-printable

<div dir=3D"ltr"><div class=3D"gmail_extra"><div class=3D"gmail_quote">On W=
ed, Dec 9, 2015 at 6:50 PM, Jacob Champion <span dir=3D"ltr">&lt;<a href=3D=
"mailto:champion.p@gmail.com" target=3D"_blank">champion.p@gmail.com</a>&gt=
;</span> wrote:<br><blockquote class=3D"gmail_quote" style=3D"margin:0 0 0 =
.8ex;border-left:1px #ccc solid;padding-left:1ex"><span class=3D"">On 12/09=
/2015 03:19 PM, William A Rowe Jr wrote:<br>
<blockquote class=3D"gmail_quote" style=3D"margin:0 0 0 .8ex;border-left:1p=
x #ccc solid;padding-left:1ex">
Because the request body is inbound already at some state of completion<br>
or incomplete transmission, it is competing with the TLS handshake, which<b=
r>
is a bidirectional engagement with the same socket between the user agent<b=
r>
and server.=C2=A0 Unlike h2c and websocket, where Roy suggests we leave the=
<br>
http/1 input filter in place and inject the http/2 output filter for the<br=
>
duration<br>
of the initial Upgrade: request, we must pass TLS traffic in both<br>
directions<br>
at once during Upgrade: TLS.<br>
<br>
Also, the results of the TLS handshake are interesting to authnz<br>
configuration<br>
and need to be available throughout those request phases.=C2=A0 This means =
that<br>
for any Upgrade: TLS request must be satisfied (101 switching protocols)<br=
>
prior to those auth phases.<br>
<br>
In the case of h2c and websocket, the http/1.1 request headers are<br>
sufficient<br>
to begin processing the request. At the end of the first request, the input=
<br>
filter is also toggled into the new protocol to resume processing of all<br=
>
subsequent requests.=C2=A0 So this Upgrade: handling must occur before the<=
br>
request handler is invoked, even a simple handler like &#39;OPTIONS *&#39;,=
<br>
</blockquote>
<br></span>
Great, thanks for the clarification.<span class=3D""><br>
<br>
<blockquote class=3D"gmail_quote" style=3D"margin:0 0 0 .8ex;border-left:1p=
x #ccc solid;padding-left:1ex">
Please remember that a request handler is based on a method and location,<b=
r>
while Upgrade is not the request itself, but a proposal to switch protocols=
.<br>
</blockquote>
<br></span>
I... think I agree with you, but I&#39;m not clear on the point you&#39;re =
trying to make. It is true that an Upgrade is a proposal to switch protocol=
s. It is also true that an Upgrade is associated with a specific HTTP/1.1 r=
equest, with a specific request-target.<br>
<br>
The latter point is (more?) important for protocols like WebSocket. When yo=
u do a [GET /blah + Upgrade: h2c], the resulting protocol (HTTP/2) has acce=
ss to the full global scope of the server after the upgrade. Even if /blah =
doesn&#39;t exist(!), the upgrade can proceed, and I can use the resulting =
connection to perform other HTTP/2 requests.<br>
<br>
In contrast, a WebSocket upgrade limits the scope of the connection to what=
ever resource is at the request-target. If I have two WebSocket endpoints a=
t /ws1 and /ws2, and I do a [GET /ws1 + Upgrade: websocket], I can&#39;t us=
e the resulting connection to later switch to the resource at /ws2. I&#39;m=
 stuck with whatever is at /ws1 until I start a completely new connection.<=
/blockquote><div><br></div><div>That was my understanding, thanks for clari=
fying.=C2=A0</div><div>=C2=A0</div><blockquote class=3D"gmail_quote" style=
=3D"margin:0 0 0 .8ex;border-left:1px #ccc solid;padding-left:1ex"><span cl=
ass=3D"">
<blockquote class=3D"gmail_quote" style=3D"margin:0 0 0 .8ex;border-left:1p=
x #ccc solid;padding-left:1ex">
In the case of TLS and h2c, that request is satisfied over the<br>
corresponding<br>
HTTP/1 or HTTP/2 output filter, but I&#39;m not clear whether websocket has=
<br>
any equivalence in terms of a content handler phase.<br>
</blockquote>
<br></span>
The &quot;handler phase&quot; is simply the establishment of a bidirectiona=
l WebSocket connection. If the client did something pathological like sendi=
ng a request body with their GET request, I think that needs to go into the=
 bit bucket before the upgrade completes.</blockquote><div><br></div><div>I=
f that is permissible under the websocket API, then fine.=C2=A0 If the webs=
ocket=C2=A0</div><div>protocol disallows request bodies altogether, that&#3=
9;s also fine.=C2=A0 You simply</div><div>ignore the Upgrade: request and w=
e continue to process the request as=C2=A0</div><div>http/1.=C2=A0 If there=
 is no http/1 representation, the appropriate error should be</div><div>emi=
tted in or before the handler phase.</div><div>=C2=A0</div><blockquote clas=
s=3D"gmail_quote" style=3D"margin:0 0 0 .8ex;border-left:1px #ccc solid;pad=
ding-left:1ex"><span class=3D"">
<blockquote class=3D"gmail_quote" style=3D"margin:0 0 0 .8ex;border-left:1p=
x #ccc solid;padding-left:1ex">
=C2=A0 =C2=A0 Sounds reasonable. Unfortunate in the sense that it&#39;s pos=
sible for a<br>
=C2=A0 =C2=A0 module implementing the Upgrade API to screw up and accidenta=
lly<br>
=C2=A0 =C2=A0 ignore authnz, but since most protocols we&#39;re talking abo=
ut can<br>
=C2=A0 =C2=A0 safely upgrade first and respond with 401/3 on the new protoc=
ol, I<br>
=C2=A0 =C2=A0 don&#39;t see much of an alternative.<br>
<br>
Howso?=C2=A0 Any module can have any bug, I don&#39;t see your objection.<b=
r>
</blockquote>
<br></span>
Some APIs are easier to write bugs with than others. All else being equal, =
I have a personal preference for strong/defensive API boundaries over weake=
r/looser ones, that&#39;s all. Especially for security-related code.<br>
<br>
_If_ all the other protocols worked like WebSocket and required authnz befo=
re an upgrade could succeed, it wouldn&#39;t make sense for each upgrade ha=
ndler to have to do the authnz check themselves. But in this case, WebSocke=
t is different enough that I think it will probably have to.<span class=3D"=
"><br></span></blockquote><div><br></div><div>No, because we will simply gi=
ve you two chances to accept and trigger</div><div>the upgrade, once in the=
 post_read_request, another in ap_invoke_handler</div><div>phase before fil=
ters are inserted.=C2=A0 A websocket protocol handler will likely</div><div=
>choose the later, obviously.=C2=A0 TLS and quite possibly h2c should choos=
e</div><div>the former.=C2=A0 Other Upgrade: handers to be added later woul=
d make their</div><div>respective choice based on what they need to accompl=
ish.</div><div>=C2=A0</div><blockquote class=3D"gmail_quote" style=3D"margi=
n:0 0 0 .8ex;border-left:1px #ccc solid;padding-left:1ex"><span class=3D"">
<blockquote class=3D"gmail_quote" style=3D"margin:0 0 0 .8ex;border-left:1p=
x #ccc solid;padding-left:1ex">
=C2=A0 =C2=A0 Why leave it up to the protocol handler (to potentially get w=
rong)?<br>
=C2=A0 =C2=A0 Are there any cases where, after a successful upgrade, we wou=
ld not<br>
=C2=A0 =C2=A0 want to close the connection upon returning from the protocol=
 handler?<br>
<br>
Why are you focused on such bugs?=C2=A0 It isn&#39;t making any sense.<br>
</blockquote>
<br></span>
Same reason as before. Reducing the number of places an upgrade handler can=
 get it wrong by strengthening the API&#39;s guarantees is a Good Thing, IM=
HO, as long as the cost of doing that is reasonable and we aren&#39;t paint=
ing ourselves into a corner.</blockquote><div><br></div><div>But you are pa=
inting all the other protocols into a corner.=C2=A0 TLS will resume</div><d=
iv>the http/1 request on the same thread. =C2=A0h2c will resume the http/1 =
request</div><div>either in the same thread (problematic) or in an h2 worke=
r thread.=C2=A0 That</div><div>request_rec will indicate completion, the h2=
c or websocket protocol marks</div><div>the connection: close (or already c=
losed/eof, depending) which prevents=C2=A0</div><div>the original http/1 ha=
ndler from treating the connection as a keep-alive=C2=A0</div><div>connecti=
on.=C2=A0 In the websocket case, I expect you can do that as step #1</div><=
div>in the protocol handler to address any paranoia about falling back into=
 the</div><div>request processing cycle.</div><div><br></div><div>Good codi=
ng style should prevent the scenarios you describe, that&#39;s why</div><di=
v>we leverage peer review, much like the recent review of the protocol api =
by</div><div>so many of the httpd devs.=C2=A0 I&#39;d certainly like to see=
 a websocket prototype</div><div>or outline before we declare the protocol =
baked for the second time :)</div><div><br></div><div><br></div><div><br></=
div><div><br></div></div></div></div>

--089e01184b102324fd052680ff3c--

From dev-return-85022-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Thu Dec 10 03:22:15 2015
Return-Path: <dev-return-85022-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 0EEEB18CF3
	for <apmail-httpd-dev-archive@www.apache.org>; Thu, 10 Dec 2015 03:22:15 +0000 (UTC)
Received: (qmail 78193 invoked by uid 500); 10 Dec 2015 03:22:13 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 78110 invoked by uid 500); 10 Dec 2015 03:22:13 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 78099 invoked by uid 99); 10 Dec 2015 03:22:13 -0000
Received: from Unknown (HELO spamd1-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 10 Dec 2015 03:22:13 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd1-us-west.apache.org (ASF Mail Server at spamd1-us-west.apache.org) with ESMTP id 4045AC9DBD
	for <dev@httpd.apache.org>; Thu, 10 Dec 2015 03:22:13 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd1-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.102
X-Spam-Level:
X-Spam-Status: No, score=-0.102 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RCVD_IN_MSPIKE_H2=-0.001, SPF_PASS=-0.001] autolearn=disabled
Authentication-Results: spamd1-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd1-us-west.apache.org [10.40.0.7]) (amavisd-new, port 10024)
	with ESMTP id 4Rz5VK98KySh for <dev@httpd.apache.org>;
	Thu, 10 Dec 2015 03:22:12 +0000 (UTC)
Received: from mail-pa0-f43.google.com (mail-pa0-f43.google.com [209.85.220.43])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id 4D3B642963
	for <dev@httpd.apache.org>; Thu, 10 Dec 2015 03:22:12 +0000 (UTC)
Received: by pacej9 with SMTP id ej9so40104863pac.2
        for <dev@httpd.apache.org>; Wed, 09 Dec 2015 19:22:05 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=subject:to:references:from:message-id:date:user-agent:mime-version
         :in-reply-to:content-type:content-transfer-encoding;
        bh=4vDFS9Z+UbmcPgr8JelL1GaO6kZbBdVXl+JQ/Cem2Qw=;
        b=qqgquo9y7mXCFmQ9YFZ5aw5Y1TMWJrFiKc211SSMZn7aIfMfgOY7uQCIBAUKkYgclC
         Va7mldRfa7mVkPXbE4XsXux5+b9KszCzoPR+2G+Xm3Zk7OBSMtM5DqvJmpqrApbIUig5
         UFWkPnU+bhLdWRVEMSLfpOwvaL6O4HewMrCmAiu+M7y879QiovlQ9HtYpbACkro+2rcW
         MUh/TQ2+ATBxmBDl0nCyoMwp9Qx/ovdyQ1wKLbAAC42CCoeFbVGl5cZ/2Sk0Zy60SCmM
         iZzzQe4S+57MPhB6BNYOhYFon4ao3/3b/Msf/ym0+RYjABmmQqwLeNrW0tmulXxW/uMX
         HyAA==
X-Received: by 10.66.102.37 with SMTP id fl5mr13184268pab.24.1449717725379;
        Wed, 09 Dec 2015 19:22:05 -0800 (PST)
Received: from [192.168.1.4] (50-39-117-165.bvtn.or.frontiernet.net. [50.39.117.165])
        by smtp.gmail.com with ESMTPSA id f76sm14614586pfd.49.2015.12.09.19.22.03
        for <dev@httpd.apache.org>
        (version=TLSv1/SSLv3 cipher=OTHER);
        Wed, 09 Dec 2015 19:22:04 -0800 (PST)
Subject: Re: Upgrade Summary
To: dev@httpd.apache.org
References: <CACsi250=dbRQKnsbE8JSdAZRm5x99gE0sgX3iQ-PHAx77euD1A@mail.gmail.com>
 <AB1691BE05AE7F4992697F2A0835627AC63BAB94@VOEXM10W.internal.vodafone.com>
 <F7B20D30-D34A-4805-A77D-F64F6428F6E3@greenbytes.de>
 <56660896.c74fc20a.15f56.0ebd@mx.google.com> <56660B43.2060507@gmail.com>
 <6B13DF2B-0586-42BB-B62F-59A7638B697D@greenbytes.de>
 <13FE9E7F-9620-4BF9-8EA4-57A6314D66BF@greenbytes.de>
 <9CCEFD7E-9ED3-4ED1-8F58-2134DD5310F9@gbiv.com>
 <CACsi252y7nX0kR9+JgSra7Q_5_LVqaR3z6ExPKg=Lhi8zhN4ew@mail.gmail.com>
 <566887B5.2080705@gmail.com>
 <CACsi253sTRbX2dnuq0yRP1sHb8vOos_9QaoYmA3TtYmnNx-Erg@mail.gmail.com>
 <5668CC4F.109@gmail.com>
 <CACsi253q+GanuRzOqBjaOe-h1w8uOcH6uFAcdres=+ig5q6+VA@mail.gmail.com>
From: Jacob Champion <champion.p@gmail.com>
Message-ID: <5668EFDB.1050900@gmail.com>
Date: Wed, 9 Dec 2015 19:22:03 -0800
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:38.0) Gecko/20100101
 Thunderbird/38.4.0
MIME-Version: 1.0
In-Reply-To: <CACsi253q+GanuRzOqBjaOe-h1w8uOcH6uFAcdres=+ig5q6+VA@mail.gmail.com>
Content-Type: text/plain; charset=utf-8; format=flowed
Content-Transfer-Encoding: 7bit

On 12/09/2015 05:19 PM, William A Rowe Jr wrote:
>     The "handler phase" is simply the establishment of a bidirectional
>     WebSocket connection. If the client did something pathological like
>     sending a request body with their GET request, I think that needs to
>     go into the bit bucket before the upgrade completes.
>
> If that is permissible under the websocket API, then fine.

There's no mention of it either way. I think most people forget that GET 
requests can have (useless?) bodies, anyway.

>     _If_ all the other protocols worked like WebSocket and required
>     authnz before an upgrade could succeed, it wouldn't make sense for
>     each upgrade handler to have to do the authnz check themselves. But
>     in this case, WebSocket is different enough that I think it will
>     probably have to.
>
> No, because we will simply give you two chances to accept and trigger
> the upgrade, once in the post_read_request, another in ap_invoke_handler
> phase before filters are inserted.

Here you make it sound as if I won't have to duplicate the authnz checks 
in the handler phase, but in a previous email you said

> websocket can ignore the Upgrade: websocket offer after inspecting authnz

Did I misunderstand? I feel like I'm missing something crucial to your 
point.

> But you are painting all the other protocols into a corner.  TLS will resume
> the http/1 request on the same thread.

Cool, that answers my question then ("Are there any cases where, after a 
successful upgrade, we would not want to close the connection upon 
returning from the protocol handler?"). If TLS is able to switch the 
filters around and have the stack continue as normal, then that sounds 
like a good reason not to do what I was suggesting. ;D

> the h2c or websocket protocol marks
> the connection: close (or already closed/eof, depending) which prevents
> the original http/1 handler from treating the connection as a keep-alive
> connection.  In the websocket case, I expect you can do that as step #1
> in the protocol handler to address any paranoia about falling back into the
> request processing cycle.

Sounds reasonable.

> I'd certainly like to see a websocket prototype
> or outline before we declare the protocol baked for the second time :)

Working on it. :) My original experimental hook for 2.4.17 rebased 
nicely onto 2.4.18, but mod_websocket has been refactored significantly 
since I wrote that and I couldn't reuse my work. Sorry I've been slow in 
actual code-writing; I've been under the weather this week.

--Jacob


From dev-return-85023-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Thu Dec 10 06:40:30 2015
Return-Path: <dev-return-85023-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 332FA18317
	for <apmail-httpd-dev-archive@www.apache.org>; Thu, 10 Dec 2015 06:40:30 +0000 (UTC)
Received: (qmail 6929 invoked by uid 500); 10 Dec 2015 06:40:29 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 6869 invoked by uid 500); 10 Dec 2015 06:40:29 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 6859 invoked by uid 99); 10 Dec 2015 06:40:29 -0000
Received: from Unknown (HELO spamd1-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 10 Dec 2015 06:40:29 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd1-us-west.apache.org (ASF Mail Server at spamd1-us-west.apache.org) with ESMTP id 4FB69C9F86
	for <dev@httpd.apache.org>; Thu, 10 Dec 2015 06:40:29 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd1-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 2.998
X-Spam-Level: **
X-Spam-Status: No, score=2.998 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, HTML_MESSAGE=3,
	RCVD_IN_MSPIKE_H2=-0.001, SPF_PASS=-0.001] autolearn=disabled
Authentication-Results: spamd1-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=rowe-clan-net.20150623.gappssmtp.com
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd1-us-west.apache.org [10.40.0.7]) (amavisd-new, port 10024)
	with ESMTP id qUaF_M0yNmY5 for <dev@httpd.apache.org>;
	Thu, 10 Dec 2015 06:40:27 +0000 (UTC)
Received: from mail-ig0-f176.google.com (mail-ig0-f176.google.com [209.85.213.176])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id B55C9203A3
	for <dev@httpd.apache.org>; Thu, 10 Dec 2015 06:40:26 +0000 (UTC)
Received: by igcto18 with SMTP id to18so7225862igc.0
        for <dev@httpd.apache.org>; Wed, 09 Dec 2015 22:40:25 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=rowe-clan-net.20150623.gappssmtp.com; s=20150623;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        bh=j9nR6QXLb4rE3CDciCNHxPRXZTBxPzp9qrZvxLSGZ94=;
        b=u+rWD5OmFjhA4BpVFKSazypyW0GXcvyffLvcKLKidZWz+BYXXtgnh9FOPShkxEXNmI
         HlRu0/Q19Lh9vBNNuIWgHmsmRprirPNICnbNQnllfROu9XzN6+q2zJwRQ22wMZJkn04N
         wove3ebACJtuRQQNfNVADXzhdlsm3b0bf8HmiaYpiMhlVDYqdq6QzHWeovdmpfsSU8Yo
         2aZzVGxfnelTA4Jkv6SC3/22P8/Km/pKR5lgSEVCf0gSlPYp2t3z+o13RQh4+lMczq67
         fGuJeGow+8kOw6NwHnsuwI4CW+WL4cydfWi4PpDk1hAJwMJ0jLb0xFlKWw30r9YXb2H9
         DVWQ==
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=1e100.net; s=20130820;
        h=x-gm-message-state:mime-version:in-reply-to:references:date
         :message-id:subject:from:to:content-type;
        bh=j9nR6QXLb4rE3CDciCNHxPRXZTBxPzp9qrZvxLSGZ94=;
        b=k2U4upMd1EkqeveGsmYZYKk6sDJEMat8jic3rXXztc0r7Hpaew64eFwn5rm3F4QBbL
         h8EGedZgmMZgEwsdln1lQ8jCrJrCC54DcKbdLpNDRtOZLshbPyJWwxD4CVUs5cNHYHwA
         I2DUaFj6Wlf5QxhW2uRxXonsb2TktwxLdl8PgzBWnPpbFfqz4k0GL0BQg82INZBMyWev
         dP6x/VCePLpLdBs1y/d48f++hbRyqDta8eO3ZF+fMG4FvzEyC1tgHUwkBWbc50OXgElK
         /GNFHb+Nw66op/duINlG59NxoFCCcbMv349SYy7klPhe42aKC9+/Cs4X6pQwbYaPQN8R
         BJBA==
X-Gm-Message-State: ALoCoQmIo4mBDNhUVzof3W7F6umtmBbhstJTmqDlIEWwTA/qZLxtIeYyysJEXEmWSua/nx/nEXQ0GZpFg56u/cVxECwFAdJ9aqpZSwpkIhg7Ggsel28jPTM=
MIME-Version: 1.0
X-Received: by 10.107.10.66 with SMTP id u63mr9250421ioi.86.1449729625530;
 Wed, 09 Dec 2015 22:40:25 -0800 (PST)
Received: by 10.107.62.136 with HTTP; Wed, 9 Dec 2015 22:40:25 -0800 (PST)
In-Reply-To: <5668EFDB.1050900@gmail.com>
References: <CACsi250=dbRQKnsbE8JSdAZRm5x99gE0sgX3iQ-PHAx77euD1A@mail.gmail.com>
	<AB1691BE05AE7F4992697F2A0835627AC63BAB94@VOEXM10W.internal.vodafone.com>
	<F7B20D30-D34A-4805-A77D-F64F6428F6E3@greenbytes.de>
	<56660896.c74fc20a.15f56.0ebd@mx.google.com>
	<56660B43.2060507@gmail.com>
	<6B13DF2B-0586-42BB-B62F-59A7638B697D@greenbytes.de>
	<13FE9E7F-9620-4BF9-8EA4-57A6314D66BF@greenbytes.de>
	<9CCEFD7E-9ED3-4ED1-8F58-2134DD5310F9@gbiv.com>
	<CACsi252y7nX0kR9+JgSra7Q_5_LVqaR3z6ExPKg=Lhi8zhN4ew@mail.gmail.com>
	<566887B5.2080705@gmail.com>
	<CACsi253sTRbX2dnuq0yRP1sHb8vOos_9QaoYmA3TtYmnNx-Erg@mail.gmail.com>
	<5668CC4F.109@gmail.com>
	<CACsi253q+GanuRzOqBjaOe-h1w8uOcH6uFAcdres=+ig5q6+VA@mail.gmail.com>
	<5668EFDB.1050900@gmail.com>
Date: Thu, 10 Dec 2015 00:40:25 -0600
Message-ID: <CACsi252HOz3_BO6hJtRTfM=M6oB0ZUXpSvkPmKs8LWP3LCz8xA@mail.gmail.com>
Subject: Re: Upgrade Summary
From: William A Rowe Jr <wrowe@rowe-clan.net>
To: httpd <dev@httpd.apache.org>
Content-Type: multipart/alternative; boundary=001a113f93be59baa40526857b95

--001a113f93be59baa40526857b95
Content-Type: text/plain; charset=UTF-8

On Wed, Dec 9, 2015 at 9:22 PM, Jacob Champion <champion.p@gmail.com> wrote:

> On 12/09/2015 05:19 PM, William A Rowe Jr wrote:
>
>>
>>     _If_ all the other protocols worked like WebSocket and required
>>     authnz before an upgrade could succeed, it wouldn't make sense for
>>     each upgrade handler to have to do the authnz check themselves. But
>>     in this case, WebSocket is different enough that I think it will
>>     probably have to.
>>
>> No, because we will simply give you two chances to accept and trigger
>> the upgrade, once in the post_read_request, another in ap_invoke_handler
>> phase before filters are inserted.
>>
>
> Here you make it sound as if I won't have to duplicate the authnz checks
> in the handler phase, but in a previous email you said
>
> websocket can ignore the Upgrade: websocket offer after inspecting authnz
>>
>
> Did I misunderstand? I feel like I'm missing something crucial to your
> point.


I propose two chances to catch the upgrade, early and late.  You need auth,
therefore you must inspect the late catch, which follows authnz but
precedes
the handler invocation.

If a websocket protocol module determines that authnz denied websocket
but not the resource, then it can proceed to the normal http/1 handler
without
responding with a 101-switching protocols.  But if the request meets the
requirements to be handled by the websocket protocol, you reply to the
Protocol API with an 'upgrade accepted' and take ownership of the request
and the connection.


> Sounds reasonable.
>
> I'd certainly like to see a websocket prototype
>> or outline before we declare the protocol baked for the second time :)
>>
>
> Working on it. :) My original experimental hook for 2.4.17 rebased nicely
> onto 2.4.18, but mod_websocket has been refactored significantly since I
> wrote that and I couldn't reuse my work. Sorry I've been slow in actual
> code-writing; I've been under the weather this week.


No worries, 2.4.18 is an incremental set of improvements, and 2.4.19
will be moreso, but not in the next week :)

--001a113f93be59baa40526857b95
Content-Type: text/html; charset=UTF-8
Content-Transfer-Encoding: quoted-printable

<div dir=3D"ltr"><div class=3D"gmail_extra"><div class=3D"gmail_quote">On W=
ed, Dec 9, 2015 at 9:22 PM, Jacob Champion <span dir=3D"ltr">&lt;<a href=3D=
"mailto:champion.p@gmail.com" target=3D"_blank">champion.p@gmail.com</a>&gt=
;</span> wrote:<br><blockquote class=3D"gmail_quote" style=3D"margin:0 0 0 =
.8ex;border-left:1px #ccc solid;padding-left:1ex"><span class=3D"">On 12/09=
/2015 05:19 PM, William A Rowe Jr wrote:<br>
<blockquote class=3D"gmail_quote" style=3D"margin:0 0 0 .8ex;border-left:1p=
x #ccc solid;padding-left:1ex"><br></blockquote></span><span class=3D"">
<blockquote class=3D"gmail_quote" style=3D"margin:0 0 0 .8ex;border-left:1p=
x #ccc solid;padding-left:1ex">
=C2=A0 =C2=A0 _If_ all the other protocols worked like WebSocket and requir=
ed<br>
=C2=A0 =C2=A0 authnz before an upgrade could succeed, it wouldn&#39;t make =
sense for<br>
=C2=A0 =C2=A0 each upgrade handler to have to do the authnz check themselve=
s. But<br>
=C2=A0 =C2=A0 in this case, WebSocket is different enough that I think it w=
ill<br>
=C2=A0 =C2=A0 probably have to.<br>
<br>
No, because we will simply give you two chances to accept and trigger<br>
the upgrade, once in the post_read_request, another in ap_invoke_handler<br=
>
phase before filters are inserted.<br>
</blockquote>
<br></span>
Here you make it sound as if I won&#39;t have to duplicate the authnz check=
s in the handler phase, but in a previous email you said<span class=3D""><b=
r>
<br>
<blockquote class=3D"gmail_quote" style=3D"margin:0 0 0 .8ex;border-left:1p=
x #ccc solid;padding-left:1ex">
websocket can ignore the Upgrade: websocket offer after inspecting authnz<b=
r>
</blockquote>
<br></span>
Did I misunderstand? I feel like I&#39;m missing something crucial to your =
point.</blockquote><div><br></div><div>I propose two chances to catch the u=
pgrade, early and late.=C2=A0 You need auth,</div><div>therefore you must i=
nspect the late catch, which follows authnz but precedes=C2=A0</div><div>th=
e handler invocation.</div><div><br></div><div>If a websocket protocol modu=
le determines that authnz denied websocket</div><div>but not the resource, =
then it can proceed to the normal http/1 handler without</div><div>respondi=
ng with a 101-switching protocols.=C2=A0 But if the request meets the</div>=
<div>requirements to be handled by the websocket protocol, you reply to the=
</div><div>Protocol API with an &#39;upgrade accepted&#39; and take ownersh=
ip of the request</div><div>and the connection.</div><div>=C2=A0</div><bloc=
kquote class=3D"gmail_quote" style=3D"margin:0 0 0 .8ex;border-left:1px #cc=
c solid;padding-left:1ex">
Sounds reasonable.<span class=3D""><br>
<br>
<blockquote class=3D"gmail_quote" style=3D"margin:0 0 0 .8ex;border-left:1p=
x #ccc solid;padding-left:1ex">
I&#39;d certainly like to see a websocket prototype<br>
or outline before we declare the protocol baked for the second time :)<br>
</blockquote>
<br></span>
Working on it. :) My original experimental hook for 2.4.17 rebased nicely o=
nto 2.4.18, but mod_websocket has been refactored significantly since I wro=
te that and I couldn&#39;t reuse my work. Sorry I&#39;ve been slow in actua=
l code-writing; I&#39;ve been under the weather this week.</blockquote><div=
><br></div><div>No worries, 2.4.18 is an incremental set of improvements, a=
nd 2.4.19</div><div>will be moreso, but not in the next week :)=C2=A0</div>=
</div><br></div></div>

--001a113f93be59baa40526857b95--

From dev-return-85024-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Thu Dec 10 08:48:36 2015
Return-Path: <dev-return-85024-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id E682D18879
	for <apmail-httpd-dev-archive@www.apache.org>; Thu, 10 Dec 2015 08:48:36 +0000 (UTC)
Received: (qmail 8141 invoked by uid 500); 10 Dec 2015 08:48:36 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 8065 invoked by uid 500); 10 Dec 2015 08:48:36 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 8055 invoked by uid 99); 10 Dec 2015 08:48:36 -0000
Received: from Unknown (HELO spamd4-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 10 Dec 2015 08:48:36 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd4-us-west.apache.org (ASF Mail Server at spamd4-us-west.apache.org) with ESMTP id BA2DDC0179
	for <dev@httpd.apache.org>; Thu, 10 Dec 2015 08:48:35 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd4-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 2.899
X-Spam-Level: **
X-Spam-Status: No, score=2.899 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	HTML_MESSAGE=3, MIME_QP_LONG_LINE=0.001, SPF_HELO_PASS=-0.001,
	SPF_PASS=-0.001] autolearn=disabled
Authentication-Results: spamd4-us-west.apache.org (amavisd-new);
	dkim=pass (1024-bit key) header.d=apachelounge.com
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd4-us-west.apache.org [10.40.0.11]) (amavisd-new, port 10024)
	with ESMTP id 1kGnk7CnB_3T for <dev@httpd.apache.org>;
	Thu, 10 Dec 2015 08:48:34 +0000 (UTC)
Received: from land10web.com (land10web.com [80.101.236.247])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTP id CC9E124E24
	for <dev@httpd.apache.org>; Thu, 10 Dec 2015 08:48:33 +0000 (UTC)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=apachelounge.com;
	s=default; t=1449737301;
	bh=LR5DZO9fkNkF95Bo5YwYhOsRESzLYdaAJRIDsT0Hqbc=;
	h=From:To:Subject:Date;
	b=ySf2cdOZ1pXuFinpEtZ1pSqTza3sxZC1qC/UR8p37x6bCxmCUnMjT4C0e+scPUE62
	 pclzU2KelSuGWQo4J9vxyB2dljTVd+rwWQ9frvVInIdyWl1jdlwR5XPxB8vc+5ubMg
	 Fi4BVEqUabb25C7E+bupAtk4Nlu7h2bp41dzQbcM=
X-Default-Received-SPF: pass (skip=forwardok (res=PASS)) x-ip-name=127.0.0.1;
From: Steffen <info@apachelounge.com>
To:  <dev@httpd.apache.org>
Subject: Re: [VOTE] Release Apache httpd 2.4.18 as GA
Date: Thu, 10 Dec 2015 09:48:14 +0100
Message-ID: <56693c4e.1a64.2484.1490@land10.nl>
MIME-Version: 1.0
Content-Type: multipart/alternative; boundary="----=_SW_18093_1449737294_mpa="
X-Originating-IP: 127.0.0.1
X-Mailer: SurgeWeb - Ajax Webmail Client

This is a multi-part message in MIME format.

------=_SW_18093_1449737294_mpa=
Content-Type: text/plain; charset=us-ascii; format=flowed


Running on AL for a few days, no issues/regressions seen on all the 
windows VC/OS flavors.

Also no crashes anymore with mod_http2 (discussed off-list with Stefan 
E)

Thanks dev's,

Steffen


On Tuesday 08/12/2015 at 21:38, Jim Jagielski  wrote:
> The pre-release test tarballs for Apache httpd 2.4.18 can be found
> at the usual place:
>
> http://httpd.apache.org/dev/dist/
>
> I'm calling a VOTE on releasing these as Apache httpd 2.4.18 GA.
>
> [ ] +1: Good to go
> [ ] +0: meh
> [ ] -1: Danger Will Robinson. And why.
>
> Vote will last the normal 72 hrs.
>
> NOTE: The *-deps are only there for convenience.
>
> Thx!


------=_SW_18093_1449737294_mpa=
Content-Type: text/html; charset=utf-8
Content-Transfer-Encoding: quoted-printable

<html>
<head>
<style>
 .sw_message P{margin:0px;padding:0px;}
 .sw_message {FONT-SIZE: 12pt;FONT-FAMILY:Tahoma,Arial,Helvetica,sans-serif;background:white;}
 .sw_message blockquote{margin-left:5px;padding-left:5px;border-left:2px solid #144fae;color: #144fae;}
 .sw_message blockquote blockquote{border-left:2px solid #006312;color: #006312;}
 .sw_message blockquote blockquote blockquote{border-left:2px solid #8e5656;color: #8e5656;}
 .sw_message blockquote blockquote blockquote blockquote{border-left:2px solid #888;color: #888;}
</style>
</head>
<body class=3d"sw_message">
<div>Running on AL for a few days, no issues/regressions seen on all the win=
dows VC/OS flavors.</div><div><br></div><div>Also no crashes anymore with mo=
d_http2 (discussed off-list with Stefan E)</div><div><br></div><div>Thanks d=
ev's,</div><div><br></div><div>Steffen</div><div>&nbsp;</div><div id=3d"edit=
or_signature"></div><div>On Tuesday 08/12/2015 at 21:38, Jim Jagielski  wrot=
e: </div><blockquote type=3d"cite">The pre-release test tarballs for Apache =
httpd 2.4.18 can be found<br>at the usual place:<br><br>=09<a target=3d"_bla=
nk" href=3d"http://httpd.apache.org/dev/dist/">http://httpd.apache.org/dev/d=
ist/</a><br><br>I'm calling a VOTE on releasing these as Apache httpd 2.4.18=
 GA.<br><br>[ ] +1: Good to go<br>[ ] +0: meh<br>[ ] -1: Danger Will Robinso=
n. And why.<br><br>Vote will last the normal 72 hrs.<br><br>NOTE: The *-deps=
 are only there for convenience.<br><br>Thx!<br></blockquote><br> 
</body></html>

------=_SW_18093_1449737294_mpa=--


From dev-return-85025-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Thu Dec 10 09:25:54 2015
Return-Path: <dev-return-85025-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id E3EFE18A7D
	for <apmail-httpd-dev-archive@www.apache.org>; Thu, 10 Dec 2015 09:25:54 +0000 (UTC)
Received: (qmail 14123 invoked by uid 500); 10 Dec 2015 09:25:54 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 14048 invoked by uid 500); 10 Dec 2015 09:25:54 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 14038 invoked by uid 99); 10 Dec 2015 09:25:54 -0000
Received: from Unknown (HELO spamd4-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 10 Dec 2015 09:25:54 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd4-us-west.apache.org (ASF Mail Server at spamd4-us-west.apache.org) with ESMTP id 03056C0F42
	for <dev@httpd.apache.org>; Thu, 10 Dec 2015 09:25:54 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd4-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.1
X-Spam-Level:
X-Spam-Status: No, score=-0.1 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	FROM_12LTRDOM=0.001, SPF_PASS=-0.001] autolearn=disabled
Authentication-Results: spamd4-us-west.apache.org (amavisd-new);
	dkim=pass (1024-bit key) header.d=apachelounge.com
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd4-us-west.apache.org [10.40.0.11]) (amavisd-new, port 10024)
	with ESMTP id iyWIJEdjVI0L for <dev@httpd.apache.org>;
	Thu, 10 Dec 2015 09:25:47 +0000 (UTC)
Received: from land10web.com (land10web.com [80.101.236.247])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTP id BCC5F25763
	for <dev@httpd.apache.org>; Thu, 10 Dec 2015 09:25:46 +0000 (UTC)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=apachelounge.com;
	s=default; t=1449739534;
	bh=XBgQQ3Hg/EsGB2+/dJv4bM29OJBMp0mI43CTYFAvfO0=;
	h=From:To:Subject:Date;
	b=cIpF+hZG9jykVO9gnEgMYg/nieK/ZLgThrwD6rYg5lYFRL7TSYFHHPz78iqLI2sXG
	 OO/hRJmaoOejzjMCaEEUWlztpsn7Ix5zFydXOcbnYePw1muUsu3mN/ZX1w6ukdETtx
	 amjJT4Wctl3caYYAcIMyzwmWMRgUOv2xt7akVc0M=
X-Default-Received-SPF: pass (skip=forwardok (res=PASS)) x-ip-name=127.0.0.1;
From: Steffen <info@apachelounge.com>
To:  <dev@httpd.apache.org>
Subject: mod_http2 memory footprint
Date: Thu, 10 Dec 2015 10:25:34 +0100
Message-ID: <5669450e.1a64.1524.7c6a@land10.nl>
MIME-Version: 1.0
Content-Type: multipart/mixed; boundary="----=_SW_31784_1449739534_mixed="
X-Originating-IP: 127.0.0.1
X-Mailer: SurgeWeb - Ajax Webmail Client

This is a multi-part message in MIME format.

------=_SW_31784_1449739534_mixed=
Content-Type: text/plain; charset=us-ascii; format=flowed


Running mod_ssl-only Apache  (no external party modules), which is in 
front (reverse proxy) of a non-ssl Apache.

With mod-http2 the memory footprint varies greatly:

Without mod_http2 a steady ~40 MB.

With mod_http2 it starts with ~50MB and peaks to over ~300 MB with a 
average of ~130 MB and slowly growing.


Measured with 2 minutes interval, so the peak could be much higher.

Attached the graph from today.
The dark line is the non-ssl Apache.
The dip is the switch from 2.4.18-dev-http2-Alpha to 2.4.18-vote.

Happens with 2.4.17 as well as 2.4.18.


Steffen


------=_SW_31784_1449739534_mixed=
Content-Type: image/PNG; name="watch_cfg-httpd-ram-d-n.png"
Content-Transfer-Encoding: base64
Content-Disposition: attachment; filename="watch_cfg-httpd-ram-d-n.png"

iVBORw0KGgoAAAANSUhEUgAAAesAAADPCAYAAADVufk1AAAASnRFWHRTb2Z0d2FyZQBSUkR0b29s
LCBUb2JpYXMgT2V0aWtlciA8dG9iaUBvZXRpa2VyLmNoPiwgaHR0cDovL3RvYmkub2V0aWtlci5j
aNRrFAoAACAASURBVHgB7Z0HvCRFtf8xoz4T7ykCIqISFQFFJSgCDxAVMaCAARQw4F8xoM+EIIr4
BDF8FJWnZNglCsuyiU3ssmwCNrCBTWxgd9ldNhINiLf+/a27Z+ZMTXXP9NyeuTNzT30+M1Vdffp0
9Tmn6le5tpk9e7azn8nAbMBswGzAbMBsoD1t4KqrrnLbmHLaUzmmF9OL2YDZgNmA2QBAXQHWjz32
mLOfycBswGzAbMBswGygfWzAwNoqJ1Y5MxswGzAbMBtocxswsG5zBVnNtn1qtqYL04XZgNlAf9mA
gbWBtdWozQbMBswGzAba3AYMrNtcQf1Vi7P3WgvCbMBswGygfWzAwNrA2mrUZgNmA2YDZgP9ZAMT
Jkxw/EaPHl3yY5UkA+t+UlBMGRbXPrVY04XpwmzAbKCVNgBg8z7xw3cbWBtYW43abMBswGzAbKAf
bWDTpk1uzJgxXgcTJ06M6sLAuh8VFNac7Npq8mYDZgNmAwPLBtavX+8mTZrk7rrrLrd582Y3btw4
A2vLBAMrE3SjvufMmVPKyDrcbt+q06bD7ZZOS4+VCf1tA4D06tWr3YoVKzxgz58/v5THddqsZW0t
66hhaCPppPC9997rttlmG3fYYYdVfdehhx7qXvSiF1XFt9P3kf60NM6bN8+94hWv8OnX4bzpz3oH
vC6++GL3n//5n+41r3mNu/baa6PyyuKh06bDRaezXn5Zaa2Xh9EZqDfLBmhJ2wQzA+JoQdsso2sH
vhTMz3/+890rX/lKt3LlytL3L1u2zANdGhC2Q9pJQxaw6Hs6nDftWc8uXbrUy2/WrFnummuuca99
7WtLMtTvyeKh7+mwfr6ecF+e1fyL4qN5WtjAu2gbkIll4of8rWVtgB4tjEND6ZRrKZg/+tGPussu
u6z0bX/4wx8ccRqsly9f7uNe9rKXeVD65S9/6emFxw9+8AO33Xbb+d+ll17qvvnNb7pXvepVVS1O
KgLwhg8t0q9+9atu48aNJeD9yEc+4rbddlv33ve+198TWc6dO9e9/OUvd48++mgpnbz7hS98ofvK
V77i7+28885uyJAh/v6LX/xi32vwkpe8xOmwpPdHP/pRKb1nnnmmTwPvonvt4x//uK+svP71r3ff
//73K+Qg6cF/+OGH/fvvvvtud+WVV7q3vvWtpbRpuv5O5x//+Ee34447OmRBjwkteNIXixf56PRb
2MC2nWzAJpgZEEcL2nYy0qLTIgUzQA1ACf9jjjnGXXHFFRUg9aEPfch9+ctfdkzw4FSj173ude7W
W2/1IEtX+ne/+11HJrrwwgvd8573PPfjH//YX//iF79wb3jDGyp4n3DCCW7t2rVu8eLF7u1vf7t/
lrTA51e/+pV/x+DBgx1gKWk6//zz3UknnVS6Jl6e4V1MNjnnnHPcXnvt5Wnk24ROKh7yDN9Ib8KS
JUvcAQcc4ABvaI899lj/nnXr1rmFCxe6fffdt0IOkh7xeW777bd3e+yxh5s8eXJF+oRG3tkf6ZTW
//Tp070+Tj75ZHfGGWe4tHgtN0m/+QbW7WIDNsHMgDpayLaLgTYrHVIwr1q1yv3Xf/2XB8lHHnnE
A57c491M6KC7fM2aNSU5/fCHP3QnnnhiCTB5Dtpp06a55z73uZ6XXNNSJsx7uLdo0aISn5tvvtnt
sssuJT7yDlrbtNSlm+sd73iHu+mmm0rPwU9AUFrbU6ZM8a1HuacBWoepFNBSh47fLbfc4nbffXfH
N1DRoBIh92644YZUsL7zzjvdrrvu6lvU73//+92WLVvcggULPCjK8/j9mU4qJMif3gMqE1RqSFNa
vNa7/gYLG2C3gw3YBLOthVY7KMPS0LpCQRfMRx11lG8p0537jW98wwOMABxjsgAc3dDye+lLX+qO
OOIIT0dXtOhN8yROX8MH0Bda/KlTp3qA1XRy/3Of+5w766yzPLDSpb5hw4aKZ8Nn9HVWOJYGuuXp
MYjdEzlIuvBJyw477OBGjhzpKyFvetOb3Le//W0/REAFRNPqtBCvr7PCsbTUk066u+XH+0aMGOHQ
L99Bxej666/36YvF6/Tob7Bw6/KlyTpd1uQ3KvDyYyezmLxszDrJ+DHBWFxnykUXzL/73e/cF77w
BXf88cf7tYv6HmOztIjpuhZdP/TQQ46fpuNe1jWtuec85zkVLesbb7yx1LIOQXHo0KFut912cz//
+c8d3bfybvGz3qXvhWEqHnR/Cx/SQPc5rfoXvOAFvvtb7tHVH6aLeyyx0hPKpNIBaDMcIM/j6/eH
1/peGC4infRmjBo1yqcH/Z177rk+3WnxOg36GyzcmXm82/QmPW3yXeG1xBtYG1hXFMJiGJ3q64IZ
8Nppp53cnnvu6btz9T2+7+ijj/YTvhgzohubyVSMEYd0ta7hw9gzY8IyZk2LNHyOdwJ6Mh582223
Vck+fEZfz5w503dp00Wuw9AAgpIGxqX3339/x9g67ySe8Xu6xKmMvPvd746CNd30TNr6y1/+4uXF
bHB6HehyBuC1Teh0Ea+vddp0uKh0zpgxw0+CoxXNu1lqho7T4nXa9DdY2MC6HWwgBOfwWtJoYJ1k
dhGG+Z0vi7BgPvjgg/3kI3Qb3gO4PvzhD/tZ3IDSaaedVjGLW+whfC68ZmLTcccd5/m8+tWvdl//
+td9l3JIJ/y+9KUv+fH0sLUaS6PmAUgzOYyZ4FQuJDx27FgPXt/61rf8mDiVgbPPPrs0lkvr+jOf
+YxfzkY39/e+970oWPN+Coq3ve1t/h3wpwX7+9//3g8PSPrbIZ0ANL0AVCRIpxRwsXgtQ/0NFu78
/N4NOmR7Uenhw7ftRg2UrVLSJjbwk5/8xFcMiipoWgFGTDTra3pbkc6+ptGeNwBvtQ3QI8dESSqc
+FzH0mAt6zYpwGPKsbjuKjgYJ7/nnnscY8Bpk0ga0XmngGCnpLMRHdgz3ZVX+1Of0ksUpsHA2sA6
WosLDcWu+14YMeuTblvWdhcpz04BwU5JZ5G6MV59zzcDTYYG1gbKhQLEQMtA9r1W6JoNmA00wwYA
Z/0bNmxYtKy2lrWBeNQwmmGUxtMKO7MBswGzgWwbsJZ1BJRH/u//GlBF5GKZKTszmXxMPmYDZgNF
2QATytipEJDGtwlmASjNHTPGnZfs74xflNCNj2VgswGzAbMBs4E8NsChObK1McssbelWANaXfeIT
Hqzx8wjWaC0jmg2YDZgNmA0UZQPsDa55WTe4AmtpVdOytta1ZTqdUSxs9mA2YDbQShsIW9Zcx94/
ICeYSatawNpa15Y5Y5nD4swuzAbMBpptA3pTFBuzVq1qLXhOP9LXFraMaTZgNtBXG9iYnHTWVx72
/MCxQ5tglgLQOhMIWMvgvr6XFTb67Ixk8jH56Pwz0OxhfTAGqWURCw80+Qy0743pXMeF3eA2wSwC
3t///vcdjppNHmf02dIy+Zh8tAQGmj08nZyClscNNPl0y/dqwO1L2CaYRcA5FKiBdX1FSrdkrvq+
1ipvteRk9pAtIQPrbPl0i/2EeNLoddiytglmEfA2sM7OVHK3WzKXfE8t3743W0Imn2z5GFhny6db
7KdRcA6fQx5y6pZNMIsANQIzsM7OVHK3WzKXfE8t3743W0Imn2z5GFhny6db7CcE3UavxyQbc+m9
wW2ddQDYTHL4xje+4cerH3zwQe9jRPX8jD5bTiYfk4/ORwPNHlaMH19XOSIyGmjy6Zbvfeihh0o7
jzUK1Dw3bdq0ulYPDMh11iJYa1ln14DlLoVKHmf02dIy+XS3fKxl3d36lfwrONJX38A6aEnHBGpg
nZ2p5K4Yp1zX8o0+W0Imn+6Wj4F1d+tX8m8MUxqJW7JkibWsawnOwDo7U8ldMU65ruUbfbaETD7d
LR8D6+7Wr+TfWvhS9H3rBk/sSoSfbWLlu0ZflkUsZPKJSaUcZ/IpyyIW6nT5GFjHtFqO63T9SvqL
BuNa/AysExsS4ZfNKTtk9CYfLQGzBy2N6vBAk4+BdbUN6JhusYda4Frv/ZkzZ7oHHnjArVy5MrM7
3MA6saJuMR6dIbLC9r1Z0jF7yJaOyaeWfAyssyXULeVPvWBcD93mzZvd0qVL3axZs/wv9oyBdWJX
3WI82VmkfNe+tyyLWMjkE5NKOc7kU5ZFLGRgHZNKOa5b7CcGqM2MG7Bgbeuss9cCk6Hk1y3rIuV7
avn2vWXdx2Rl8smWj62zzpZPt9hPUeus6wX4AQvWCMhmg5dru1khCuw8zuizpWXy6W75WMu6u/Ur
+bdekM1LZzuYRdZdG1hnZyq5K8Yp17V8o8+WkMmnu+VjYN3d+pX8mxeE66U3sDawLuUgMbZSRI2A
0WcLqFPl8/CGv/sP69T0i1baLf0G1qKZuN9u+mo0PfWCby26cF/wYcOGRWeF91s3+PTp091BBx3k
DjzwQLf//vu7ESNGOHZyOeKII3zcoYce6hYvXhyNCz9+u+22cyeccELFB55zzjmO+JBWX1vLOp6Z
wthGjTnkk3Zt/NMk0xvfDPn869l/u0GT17tnEr8Z/PUXDTT+BtZa+9XhbrEHjSVFhtuuZX3UUUe5
cePGeTCdO3eu23vvvd0pp5zirr32Wh83ePBgd+qpp0bjQsHssssubvfdd/eFjtyjErDrrrsaWFfn
FSucIzLRUd1SmOhvCsN/++ezHqyf/PuzZg+hcILrvPZgYB0IMLjMK892pRes6avP93E0JiDdlkdk
0mqWj5w3b57bZ5993G677eY2bNjg4zdt2uT23HPPaJw8Jz6gfOaZZzq6CYi766673Be/+EX/rNDE
fGtZB7ko5bJdM0tKcquiLf1VInGP/+1fHqw3PfmMgXW1eCpi8tqPgXWF+Kou8sqzXeljmNJI3N13
3106vWvNmjVu4sSJJWzU/PqtG1wSsXDhQrfffvu5m266qaolTGs5bB0TJ8+KD82kSZPcscce6++d
ccYZbuzYsQbWVdmkN6JdjT8luVXRlv4qkVRE1COfjU8848F6zeZ/GlhXSK/6oh556qcMrLU0qsN5
5dmu9II/ffVpXGoebdcNTuKGDx/u9thjD3fjjTf6xBLeuHGjD9Oypms8Fqc/jLAA+r777uuWLVvm
x8KJp6Ue0nK9cfZstz4R0HdOP92RsR4ZPdr7hOv5GX22nEw+7S+fVeMnuxFXj3HLx9xj9l8j3+e1
582DBtVVjkhZk5e/0bdH/gJD+IEnMZypNy5sWXMde7bfWtY33HCDb1GzJ6ok7OSTT3aMVXONf3oC
prE4oRdfwPrcc891xx9/vDv77LM9jzSwluesG7y61huLadeabSytsThLf7VUHt74D9+yXrjmaWtZ
V4unIiav/QDCeVxe/kafLd1WyUdwpK8+6Z08eXL7jlnvuOOO7i1veYs75JBD/O8DH/iAo0v8Pe95
j28ZH3744Y4dYmJxoXAErJmo9tznPtfhQ2NgHTfqVhlz/O3VsZaeapnomGbI56F1f/Ng/cDDTxlY
a2FHwnnlb2AdEaKKyivPdqUPcajR69FJzy5d39qP8eq3lnUsMa2Os5a1ykEZwXbNLBlJrrhl6a8Q
h79Y8MjT7vqpG9y9S58wsK4WT0VMXvsxsK4QX9VFXnm2K31ReCVj1KEf8jewTkypXY2hyspTIiz9
KYLZGm3yqZYPLeo7Zm5y9yx63Oy/WjwVMXntx8C6QnxVF3nl2a70IZg2es3s7y1btrg777zT++PH
jy8NDWueBtaJKbWrMVRZeUqEpT9FMFujTT7V8rl/2ZNu/PzH3Lh5W8z+q8VTEZPXfgysK8RXdZFX
nu1Kr4G0L+E5c+b4bnCGfFnVxHWMn4F1YkrtagxVVp4SYelPEczWaJNPtXymLnnC3Zd0gY+Yvdns
v1o8FTF57cfAukJ8VRd55dmu9DFAbWacgXViSu1qDFVWnhJh6U8RzNZok0+1fO5e8Jhj3Pq2+zaa
/VeLpyImr/0YWFeIr+oirzzblb4oYGasOvzFeA9YsLbzrLPPnCWDyK9bzp+V76nlD4TvvWPKEjdn
0Up3zZiFbiB8r9Z5s7/XzrMulx1a7hJutvxbxd/Os06WXMVqFc2Is9ngVZXeaASZLI8z+mxptYN8
Rj6w2bGLGTPCH0m2OMzj2iH9Or3tlh5rWWvtVIfbTV+NpqcZmJTFc8C2rBGKgXV1RorFNGrMMV6x
OOMfk0o5rhnyGTpjk3vs6X+5v9670T28ysC6LO3qUF75G1hXy1DH5JVnu9JnAWsz7hlYJ1bUrsag
DTwrbOnPko7pNyYdQJqTt1i+9dCKR2IkqXFmb6mi8TcMrLPl0y32UxQgI4+2PnWrqA/tCx9rWWdn
KrnbLZlLvqeWPxC+94ak+5szrUcl3eELl62uJZKK+wNBPvqD836vgbWWXnU4rzwbpe/p6al+eSSm
Uf59wR79bLg3eNueuqUT3eqwgXXEciNRjRpzhFU0yvhHxVKKLFo+gDRgjRs3f4ubt3hV6V21AhSA
t0xc7IbN2uSaXRiSltnJ5i3/rlHoFi2fUAZ5+RtYV0rwkc3/qIjIK89G6J9IjoBlpcOz/64N2I3w
54OKwquOOHWrqI9tlI+BdUUeSr1o1JhTGQY3jH8gkOCyCPlwbrW4p//xrLs1KchwkxY+7mYtXCm3
avp/T7rOB49b6G5MwP6ZBPTrcY2mH/6DJq93y9b/PfM1jfLPZJrcXPvYPz1JXv4G1mXJUjFEh8/8
q2wreeWZl/6+Bx/2+wcMnrLebX6qbPflVFWG8vIX+kZxJ3wubFm33albYYL749rAutJo067EONPu
h/FGH0qk8rrV8qF1QYH5z60F5pan/uVbxqRqGpujJIVbvW5LMint5qRlLWPe9TzX6PdSqSDdzFzP
co3yz+IpIIPs8vI3sC5LlnkR6JCWrri88sxD720mqUyyhwB7CazYkF3RI015+Gv6ojCL9zf91C32
MD3vvPP8xx5wwAFuu+22cxx9WdRHNJOPrbPOXguJAcmvVesW5X21fEtPWTcxWYXyWbl6jbtq9AK3
ZPkjXqcPPrTKDZ28xIcnzlzmRt8zq6TrGD8dx7M3jb7P3TRhsVv2cC8/fT8WDtMTo9FxQs/ENyoG
rAVfkywv0zQ6LPQ6LitcD/3ylb0yQ3b10Ov32Trrsn0uTWwE21uwdHVJf3nlmYd+zuKV7ubEPtHH
3bOXu3seWF56r9aRDufhz3NCX9Q6a33aFpujcB3Dvj7NBt9vv/3czTff7C677DLHkZazZs1y++yz
T/RFsZf3d5y1rKWum+1joHmc0WdLq9Xyeervva0bGTtcmZxlPTFpdeDmrnrK3T1ruQ/X80dLZeT0
pW74rM11dTHCs9Hv3ZCsA2cCXK1WfKP8s76X7lNahE8lrfu8/K1lXZYsa/mR46rE5sTllWceeuyZ
CihueTJ8wjBPLZeHP7yEvij8Ck/bkuuQf5/AmvOoYXjyySe7iy66yIf33ntvA+vAOkS5QXTqpdGn
isbfaFf50L1cj2t1+um6psBcvPZvPnmcZc3e4LhFa/7mxs/oLdx8RI0/oR89Z4t79PHeMd0aj5QK
t1p0cl/ks2bzP/0EOJaXsSY8zQl92v0wvh76tVv+6WXGe+uh1+8wsC5LQ+S4JLE5cTF5PplUKNNc
jD6N9u4EnGcu6J2DwTwNKpW1XB7+8BL6EEwbvRZwDv2QX5/Aevfdd3cLFixwO+20k5s2bZo/LWS3
3XYzsA6sQ5QbRKdeGn2qaPyNZsuHrrvH1Rhbdmp6My/jwQAiY521XLPTH/KnhUraZq14yidt/uqn
3YzlT/owk7dG37u0VpJL9zlac1LSvciJXdJSL91MCYTpSSErRQs9rXhaRrSu+YY0J/Rp98P4eugf
Tt6NzGgZ1kOv32FgXZYGvTjIce7KXtvjTihPaJgMJnMqyk/3hkL68L6+ZrMf2Tfg2SQvMhHy3zVm
hOfhz7uEPgTTRq8FpMFQeMh1yK9PYH3JJZe4l770pe6kk07yL3nd617nLr/8cgNrbT1KuUF06qUY
QypBcMPoA4EEl3nkwzIhxkhZ2lTPsg9eBX/p7qPLuZbLkx7hX4unvh/yl9bN5OTsatysFU+6eaue
9uHVm/7hhk99yIfr+bs3Oanr3nkP+8k7D6uuzaxnw/Rk0XJP6GmNMQGuVsVA6GvxZfIRoF8PPb0Q
gMy6ZEZ4PfT63QbWZWksfbS30nPf0t7KIXe0PP/+zLN+mGPI/ZtSe2o0fZlzdQiwv2naBrd27drS
zdFzt9SsVNbLX5gKfQimjV7DTz+7efPmimu51yewhsnSpUvdqFGj3MaNGx3ncQrjTvBtzFrML9sX
48ymKt/NQ9/IbNt6+OvadD30knqWmFw7dqFf2sR4ZT0O/oyP+ZaYWiKV9mye9MxJWiR56HlnSM94
IYXYmKTgwk176IlSlzhd2bffs8TH1/NHNyNLvaYsftxRENfjwvRkPcPsYaF/cGsPwD1JJQP5pjmh
x5aYOR6rMNHjgQxoadWzveq8ZOwTfVKZEf5p7w/jDazLEmFWNnMO9Ngxk/bo9qZnBn3R00OlbNHW
YZry072heuW/Jhm6wMY1PTY0PbH3NMdeAZo+jU7HC32zMK4pLetBgwb5LnC6wekOf9WrXuWIa9ZH
FM3XwFqbYHpYjDOdovJOvfRkZLq/Fhe8gxatY7rDZNOOetPDVwAWg8cv8us09drkyi+svII/oErh
rruGAfsY4NebHula7+tBG3R13zlns6P1ggNwZUkLE6luuXtx5QelXAGYFIbMCKeFzfh1Pa7e7wVk
sYe/JulhTJ0NUeg+pbCV8fbY+4Q/66IBBjZsCd36x5/xwDDhwcei68r10iKenbHsSa9P5CT8Q55p
1wbWZcmQL5jfIBVFejeuSyrD2OJdiS6WbAXohYktxUAVIGdYKq2LvPwml/QWPeVmJsM7Wl8MZ90y
faO3I8obfgA4fOlpwt7Y5IdKg+9FSWyIcNYwmPAvGo+EX1PAeq+99nJLlixxb33rWz1Az5gxw9mY
tTaf3rAot/pOPGYg0LPhBV3NC9c87W6dtDiz5YSU8rSU//HM1o0Yknfg8siTGv+Ndy2u2fXqGW/9
gz8Z//ok4y/b2tqklUdLjl/YnV5veigwqADUagnW4g/QAX43T9/gQZuCk65xHJWJG5LKibhVSUsy
5mSDEr5xSbKkikKRAq8eV+/3As73JyBJZeCWJK20xrAP3W0fe5/wZzwdWipq4WQ/Wm203khzOKGO
SgeFtp5vMGXxEz6OyXjCX7+biuCEZEY9XfSMjWrXiWANiIqLfa/ci/lZ9MyNwPaGJZMEcVxP2Dpb
W/MCKAF17Zjchx3ccNcin49CAMXute2jj1jlit4RbAPb4kcasF8qsTyPPfN+5kZgO9gc7x0xe7P/
kXZdkWAZGsNeAq599QFn/Rs2bFiUd5+6wQFrEipgTXjPPfeMvqivH1T087bOurwWksyW9ZN1hVk0
+l499EwCYa0u40ujJ830rdnFy8trMTW/1ckaW1q71LCJr8V/mayRTU6Tqodev4uMO3jEvX7S1YwH
V2bKRZ4jPbclFQ5+U+eu8M+QhhspZJJvlHRregln+RQKrFGdMXtuajpodV+fyGZNIkfhFcpnypwV
voCk+5E0Xp3wpDcD+lWPrHFXDJ3u10zPTL6X91E5EF7iy7pj7j8wZ56bnKxfZR2r3M/yw/Sk0VJp
YC049FTgWGONDkg/y3HSnhP+rB2fm6yzZcIcG71o+rH3L/Nj7ch08Mh7HbLgPmvFsS3/bgrtrXlh
RDKOT6Vt+rwVUXvDfrk/KlnGxoQ7eQ6/09ZZY0PXJHrFFki/yFN/U1Y4i37sfcu8/mhNo8NByYYl
sx6YVyEveKOPa5O5IlrP6P7ORJfwv3f+w25IMlyzZk2vnWMn8CTdw6Y85Ct46JF8l5We2HfE6Mmz
5BF+lAmkmzRiL1fdMd2NSb6rqHXWIbY1pWV95JFHuuHDh3uwXrVqld8ghfXW4cvb9dq6wXU9Nj2M
gedxFHC1ukhp2Y3dOoYKf2q6Mls5fBdjrjcmLVS6p5gYVSs9skZWloPUotfvo8YMUFD7prusHsdS
EVrQdJ3yHTjGgu9MWgpj521xjKVpV296aOXSsl6UMUwgM73/nvQmiAv506qgOxJHtzI89bjuHVOW
+O5jWs20LHRXvvBkSIB7vlWeVAzoTqSVUsvVOyZI+mn540g/rWpau8wUpquUcfY0Bz1DH3I4ifQk
aHpaTeiEHhoqLOiLb7graRn71nbir1Z7WKM7vjXN3mjBsUMWwya0wmiBY6ekd/nYe3wLjzxAHOkh
LD/s6tGkJScu1JfEp/lF09MLgU3IjPsi+aNHZEWrl+/WcxLC76N1Sz6nZwx3b6JzdER6sCPmLrAU
i3zGdrlMcETvtJwpGx5MaHFFpt8zTP4YWqFcwR6kZ6bVuNanljUTyj74wQ+6l7zkJW7bbbd173//
+/3Ydas/otH3GViLKWb7eYyfsT/fUkm6uLPGmZicJLOT4Q8Y3J6AQczdl4yPUqCSUa5P+NYaw6VQ
pvBhfTEuT/opMGih8T4B3liaJI4uUGr3FMR6/TIFFAUVXYB6jWme9MCP75ifdAunOYAAGj3mGn4v
hZsUZDJrPbZXMwUpAMy3h44KBxUPHPxlpnZIp6/pVgbgaQ3VcnpNLPypLPFdVOpElmk8oKdidtv9
vfudU6gyJipjkxTygLN0c0MPIDBJDh0B4HRzokNxrO3GPqlAQh864qUChNx4B4DEZjP33TrB82Vc
nzh4+1n0yTW2jF1JxQK+Mf7h+/R10fRSKcTecEXy56CYsPKXxR97kTX1dEOHs/cBZmwZHae5LP6x
Z+qhlxUJVBYYpsE1ijvhc7oLXMIhDdd9AusPfehDFQnetGmTe/e7310RF3tpu8T1F1hTCLBkIc3V
Yzz62XaiZ8yWrkEKOwFLnVYJMxmE8UWcpJ+MIGOpQocPL5nsxQSiWmO4ZGgKeoAJJ/z9RY0/tUqC
KwAAIABJREFUCha61ahMUJjXchTUVE5wFHpMYMJJy5MCnbFY7epND6DJd8xZlH7QBkDgv1XNQg/5
M1YrE3looQhwS5o0va5EyX18DZjQM9kMgMIBdhRm8NZO1tjSdVjLoTMmHOHgD3DKd/nNUbZWFGJ8
oKeSJZOYSAff3Ntb86RPu/SyCP+QT1g5uyWxMwCZyouWjzxHWmk1x1w9Y9aAkozBxvjH+Epc0fSM
0dKLQQUJVyT/2Br5LP7oEF1iU1Ro8LPoRSbabwY9lW7yDZU+4d9qHGsIrN/znve4bbbZpur3nOc8
xx1yyCEG1tpyAuMHpOlupBXJCUYxJ8YQuxeLazU9GSjNAR50g8e6f/UzejaxpJ/WmoAdtBTSZBIy
vDiAWzY9kLjQl2VUZHqc8A/pYtd0rY2c9pDvEgWAajkKXMalccw4lrRS8AEAHvwC0K83PdK6lB2Z
YmnhfSxH0pWckD+gWs/SJ/hTKYrNpmaCFt2SOPjriokMO1Bx0Q7ABHCzegaEHv7YDg7+UuFCvrSu
6OZMc9DTKqynciX8Q17Ih1Y2DrD3E+mSNGF/oTyh4fhFXQEgTlw9YM0QkOgsxl94xfyi6amQAJIM
CeCK5E9+lZayfEsWf+k2p6dIVi9k0QtP7TeDngo35QH5TfgXBda0pjkmc8yYMaWJZjHeDYG1MNIT
yySuk/z+aFlTsFEY0gKllkbXXdjdKsagDTAr3Ep6ZgVnnRPLtzEpo9Y6XECZlhdO0s/MTJZZMDOV
gh/5sJmCnm1LZlmYMYYLP+kalu434c+9Wk529KJVPjLphqvlZIwbOoBFuvIFIHWLT3jVmx5mJNO6
YBOSmKNgY4yPQkRvUBLyR9aAa5rT9FTEkDvfMiSxTQpbwIuxbukhgJ5lUjLnAJkBygA9z2MDDIFg
J+iLiUK1HK1Y9nXGwV8qAFRoSQst0TQHPePy/Opx+nuFngoBacX5LvUk7dJ7ENJjn9hpmqsHrCer
deoh/zS+El80PV33VCybAY6MLeuZ5nxDVvrJ77T0qchIT0kWvchE+82gpzJJXqNcE/5FYx0nb3Fg
TRrfPoH17bff7rZs2ZLKPO2l7RLfH2DN2N+4rV16jJv5pTNJgQwIisMYmDgBiGeNzWh6Cdfji7HV
QwuNppcWT1hbhk4mCTEzuXe5TW/hSWEeOoAw1k1NLZ+Cmy7GWMsW2c1bkj6Gy3uk+1gATKdfp2N2
8h7epR3dxcxgZQIWYFPLUagMTSZo4QAogA4n3XlP/r0X9Hzk1r+09GgawnS1AnzMhg6dvIsWCK0/
GW+ETvhjQ4yZkhY5mznko+nlHqBMJQH7ozuYihN6oWtf6H1lZiu4QQdYYxt8L2F2jgL8AFBOPqrl
QvDi++BDBQ7AJh1pju/Vz6fRSbzIR67x+UYmilHhQKdURKjgoIOQXiZM6ed1uB6wJn/oyol+vlY4
TE9f6Rl+4rvpoWFcvyj+GxOe2JGeH0Fas/jL8FhvT0m5p6XWN+r7Wfw1nYTroccWsEc94bBIHJs7
d66bPn26mzJlipdPjHefwJoJZW984xsdoPfAAw90HGj3B1jTopaJVWIsgILePAPjoUsYQKO2S2Gc
5eoxNv18HnoqC5qeyUpSMGuehMlgtPagZ8yRrm5q1dBTGGjH2LPUuDV/WlHcAwBkAo9+jg09Zic7
aGU5AJh3SiVB85fnKJSYrEYBBTCI8zOEkyUm3KegqeWk21zoSDu6pIXNt9DSpEtVj+fG0iPPax+w
o1UcOxWrtxKwde1qohM9c134yyxfvkMqRpq/hIVergFIWhD4FOTYAGAoa8ihp7JGqxtHpYrvxmbp
SSCM/BnGwCZG31v7oJBYt7DMeRAZSvpCn/RQOZBhj/B+eB1+r9yn257WEwUyYek9COmxay1veV78
esA67PaXZ+vxw/SkPYONeNBLKnt8E3mSVitjr1Ro5UceoOHAUANDOfXyp1KDHKhMCi+GMrAH1iaT
B2RoQacxiz/ppbyjwij5P4te85VwM+jJP9g0vYHCPwaojcTRomb5GM+yE+g999wTxdI+gTXMFy1a
5M4//3x/NOZ73/ted+mll/qPaSTRrXymv9ZZx9aMsmOTXmM88u6Zfu3sg0tX+XXIg1njF1n7itHw
i60TlHsxP6RndvXwZFIVLVbW08ozjDWyrva+mXP9jF7WPLK2lKVNU5MMys5XrIWVs4ZHJGO9jK/C
/4FkUhTX8ISHPld2fhLH2mDWWMfSz3PMsGbNrKRFfNY33jV1dlW83MdnaYVPd7I2k+vwe4lDnkwM
C89lRj/IHxq+jWVThNN+9yfreYeO76WHhjW+dFuzvzhyJU7WaAqPWHrknvZJ211JxWHYhDJ/uU+6
bk3kz3W45ln4owvkwI9xfnk29IU+jOeaZV3zFq/y9sFZwcRBj52wNplrdMl3o2O6vAkzY5Z76Jrz
rwln/fR69Fh6eNeylfFvmDN3nk8Da2yz3iH3YvzlHt+LXWMHXsaJrd82boafdCjrz8mvDMXIM6Ff
zzprZMme7Dwbpod8wX22dQ1/2NsNo+71u7yRDmQv66N1OtA99k0vEfZ896xlPl+QN9iUhPXM8oOW
Z8lbrGfW6WFIK0wL9OOSdevoDF4jJs70vHgHz5NvFyRll06PDmv+Op6wl0tSFmFD2BJxWfTh882i
X5HYluQjSU9R66xXrlxZAc6PPvpoxbXgYp/BGkb333+/+973vue3HmXy2Zvf/GYP2vKSdvXztKxp
GdHKoRu2nqUoUsvDx4B4nslGdCeGs3F1NyWtTcCZLkVxLGHI0zKS59J80qMdY7y0TGjJs9aVWjhx
tKp4NxmSFifppNZLmHvUxOkm5LuYOMeztFLhL5OChJbuXFlzSpem7kYP00NLjtaobvFKemnZs/GI
OORJC1S3XGkF0qXJu3Ehf+LoPqbmz7OkVRw1esAPB2+65bIc7wBQxTHOSesMWxEnrWy5jqVH7mmf
LnVaQhRcodPDKWzVyJIgccKf3glp5eqeG6ETX+jlWvvSvazlBD0tMfSNvaJPaSmGs9/pXaBQz3J6
jTR0sfQw+Sk27k7vAZtjYLvwqcfF+MtzDI3QguLULVr22CHpZ3gEfWBX5IOsd9XTsqaniTyE0+mh
N4M13uQtWqXhjx4PNnYhj/DtzI0QO5dvIG+hE5kAp/kLTczH1phEKPTM+cB+sGWdDt5J74JeChfj
lxYn/GP36TqnzEHG0lOSRR/j0Qx6yhdsEL0L/6JwbfTo0X5imfZjvPsE1hdffLE74IAD3K677up+
9KMfldZYL1u2zL3iFa+I1g5iieivuDxgTaHDhBu2xMtaShMzHna+AQQoBMiE4cxcNleQ8VU/Bpqs
89WOCSByX8dLWIyHwhmAW5+sM6YwlR9jfoA9mz4w3sZOVXRpAsj86M6UjTt4ni5AurPo4uK7aRnK
eB7vlHFr3kehxjcxAUjWqZIeCnEml8CLeAoZxk/J6OEseEm/fA9+2tI2wIAdo3AyzkghqoGdwoXK
QdaYIIUdhSW0AgJMZNOVAQorCo0sp9MDHelAVnrdM/LRFYLY94bvkG54ut3oaQidnr1Md78eWhH+
dEeiI+xOyyfkJfRhPNc8TxdnuNQIUAHISAf2STrRbzh+Dh32g6zRV8zR9annJ8TSQzp0xYnCk8qU
n6CZtPTyuBh/eV7GJgFT5i0gO1qcONKf9g3yPH49YE0eoLKD3Gg9ky9lLDzPsBd7CjBUxhg4MuKH
7SNTcVnfKzT4gCPlG/R8J8NzlEe1XL38hU8WPZVKyg30mreyUQ9/odF+Vno0nYSFvijckh3LQj/k
3yewPvHEE90dd9wRnWR29dVXdxVYA5YURoAb3cGMo2W1dkWxFJLU/KktUiCR+cPJPmROxvtwABtd
TNoxQzKsPev7GA+1bECLApTxIgoC+VHLpmVEzZAaMi01Wkx+mVUCyrSksxzdgfpbqbnzHYAZcgCA
ZeY1fEgPNVDeTyGvd2uKvUeMP3YvjNMt2d5dwjZXZGzoAVh6QGTyWIw/z1IwCbgwCYZWBJULuvJw
AA3jvfhpDsDQLX15TtOj91A++n4sLGPCvvK2dQKbpsNOZCkVlSd6OMTJ9/I98MEuslqCQi/Pa58K
GxUYdEnlDyf02DQVPXQiPSl67Fn4UFnFvqHFXkJHvAYF4a/pqJBgZ+KQJxUAnovRC13Mz6IHpAZv
rdwwYRI7p+s5j6sHrOGH/qjo+C1Lt7aisaeYjPT7w/RTJpGHZdxYAzXPhfSalw5TVmHvdK1jM2Gj
QtPqcL385Zkser4dW6OiIDabRS88td8q+hBMG70OQVquQ359AuuQWd5rdkCT/cV5lkNBjjjiCHfg
gQe6Qw891C1enHQ/ReLC92y33XbuhBNOqKgcnHPOOY74kFZf52lZM6uV1jEGTUuBrk42EghnOmqj
IYzBs88wjkxF5qcA1U5aL8QBzNNUNy9xFJhk4jSHccKbpT5Z3Z3yfF+NmQxFbV66wYSv+MKfQoPv
lUJe7oe+0IfxsWu63GXCkl/DnBTgFNq0lMUBIlRGRGYx/hT20vKkoJMW1dgE5PVSIyo+mre8Q3zA
vlZhDsjogi+WHuEnvmwEQiWJOQKh00uppOIhNPCnZU8LBZfVquZ+VnoASQCFSUgy1CD0yB/9+lZo
0iKigA27/DV/KhR0tWrHs+GyLOEf0tFiFEdvlGz0EqMXuphfi57eJBw9LXxfrXX94TvqBWt5rlZ6
hE78ZtJj64zP1sqzkhb8otPDu8XWmsFfp70v/DWW9CUs4Dxt2jSPV3Id8mwIrIcMGeK23357d/DB
B7uhQ4d6wH3hC1/ou8TlheGLwmta5Pvvv7/nI/dOOeUUd+211/oEDx482J166qkuFif04u+yyy5u
991390YjcQA+3fNyHfPzgDWFA91UOCZ0YFAUMiHwegL1B2hIS01m54YZAbAAsHG0CJmgoR1dzbw/
zZFZeI+0ztPoJL6IzCW1XuGpfc2fLvlaTtPXotXdwjJjNJwJDGAgT9lPOsYfXdLLIC1HmeVOJUTP
NtfHScbShl40fYyG8WTGlcXF0iP3xKeiQ0UA+2KiW+ioiEhvC3algQz+2ILuGg+f19dZ6WF4hFnz
VGLECT2VNtJBwSotIlpFhLUTeoCACoReN88wApu/aCf0Oo7eDXoKaPnR8tWVxRi9fjYM56GnEpyH
nnd1MliT/rzfO1DpY5jSSBzy089t3ry54lruNQTW++23n5s6daobNWqUY9eyX/3qV279+vV+F5b3
ve990RfJC8W/7bbbHGPbGlA5XnPDhg3+ebYu5QSvWJzwEB8eZ555pt87lTh2g/niF79Y87jOPGCt
gVmMM9blh7GLo+VJFzQzZ8VJASvX+LQQBFgYq2HWq3bSxajjJEwLkTFoWjW1Kg7yjKRfrmv57USv
u4VpsdLy0+POfAsbViBnAatY+gUMfes8qegwQQld0VvCjFRxVAiyNtuoZ903zwNK4mLpkXvi8ww/
xv7plgwdcwBIO47eFPQvDv7IRu5LfJqflR6pYMr4PzzS6KmEhhXRkJ4KCL1HtF7RJb0iMpFI0pfG
H8AmT4UVxTR64Rf6zaY3sA4lXnndbPm3ir/gT199WtL8mjLBbJ999ikB8k477VQKk2hay3kSr8Fa
h+FBazkWF/KHZtKkSe7YY4/17z7jjDPc2LFjc4M1Y1SM7dIyowXAuI2MAxMvhYQYA63ZtAKR1gN8
6PYT+kqTLV/RyqMFR3cmhS5LN7RjHI1WRegYR/eT3pIxaGmZhzSx61rpCZ9pJ3pmi7JkCSczlNGD
rAEmnnF7L9OtvRGx9APmtAqp7DD7Fj0zjEC3p2zUDy+6r9EN4B62GLnP5LFaO6rJu6Bn7WssPdzT
To+lc3RgCIJ0KcvEOIZi6KYWxxIaWrj6ZC25F/Oz0sNEP2Sie0iy6Gvxp0ueYQoqv7TWqVToLk+e
7wv/2PvDuGbzN7AOJV553Wz5t4p/iEN9vZbub/FDfg21rPU2ozoM8/A6fGF4rcF4jz328IvCoaFl
vffee7tYXBqPfffd17fWDzroIA/atMpDWq43zp7t1iet7++cfrrvsnokmTpPBrv7xvFuwYi73cZJ
U93mydPc41N7f09Om+7vQ8NP6OcOm5jQT3JPJTvP4G9JnuE+9NybMWRiBb08H/qrx092U24e78YP
HusIC39NN/q6se6xKb38iX8qecfYQWPduolTovT62TAc4x/S6Ot2ot+Q6Gb0FUO8XJEJMn9g6ES3
eNSkrbKf5kZeM8atSuQ47Za7UuX/4PC73bzkh/xGXD3GTf/rXW7esLt9ePEdI/1zyODRu6e4kcn9
kdeOTfQ5wdNr2Uy4fpxbOqxMr+9JeNnoe9z9t03w+oPXihGjvM3wvpVJOoVO+1NuGe+/gbjxVw1x
fCv2iK1hW5NuGu/WTCg/i/1gv2smTPHy4fs1v6xwln5538zEjvGFRxa90Gh/oNFvHjSoJCsth7Tw
QJNPt3wvGMIPPInhTJ448I69wXlm4sSJUX5tBdYnn3yyY6yaBOOfnoBpLC4UggD+ueee644//nh3
9tlnex5pYC3P625w1lTSEq7HSc2NcUjWG/Isy3UYT6MVQsuOljktdZzQp/Fmkg3P0OJIo2eSj56k
xAQkWoRp9P5Gyl+t9ISPtRM9S17Y7IE123Sh4uiqZsIVjhYorUq/DGXrsqtY+mVSnyzPYXY1+kR/
HGwvTsZK0TGtQFrgdE2Lo8ejnlPAmInP+C/82VSClir2Rk8KPSqhC4dd6OpH/8KDcdtw2IMueSbE
0bLO42LyyXre6LOkY2PW2dKpXR6Gz7ervQmO9NVnCJmeYYZvGa8eN25ccWAdO3FLx+VJvAAtzzA7
nE1VaBkffvjhjh1iYnEhf+HB/qrPfe5zHT40ecCaCTmMA9bjxHhkbSldpHTFpjmhT7vPekIKcTZk
wMXo2XSCblpxLPtgqQYuRi90Mb+T6QFPdjej+58ubJyfJLZ1kpKM3zKLmnFoXOx7kR8yZQwU2TN7
mol8hMMjHXX3N4CNvsVRQat1vracxoW+qEiwbpfKAmPSDKMw90E73gdfmW1P+rFP3k33OEudSGe4
5hd7JJ7do/K4mHyynjf6LOkYWGdLJ54fs55pV3sLcajRa0B69erVbsWKFR6w58+fXxxYN5qodntO
t6wB6ryzqQUQKEBpmaW5Wsbml4Mlhay0sGL0TMhhAhSFPK15wrLEJEaflhbiO52e7S8BJnHojfXR
OFqb0ioF1HCx72XyGZPTcPRs4JA/YMfSlTQHuDKLHEdlgZZsjL9+XtIE2LL2mwljTCTkvYzXwkNv
ekPlg54UcfCnNS9zKJhVHZt1DS8msoVzHoRPml8r/eFzRh9KpPKa7u48zuSZLa12lU9ReMZ+4PXw
aqgbvB7GnUADWFOQ0i1J4UlXZz1OjIcClG5QQEEK/NjzQh+7J3GAsEy0SaNnEhWtMyoGGqzS6IV3
6HcbvUzQ4zvRA8MJ9FbQ+gYEY9/LBjd0pWtH5QewZmlemqMbvncy2uO+UoAeYvz18zzDDHUqEcyu
ZhMVAFkclQTAl259fvDXO6AJf0BaKmjS6hYe2hd6HZcVNvos6cQre1lPGFhnSSe/PNvVPluNcQMe
rOkOZUeycK1nlrmJ8QCuzEhmcw2ZKR57Tuhj92JxRh+TSjkulA/juIzX4gA+diYDIAFefuygFTpm
Iutds7jPrGroa+39DuDSwpaVAGF6wnfRrU1PCO/EZmL0VBoBY34y10H4xOjlXsw3+phUynHNlo+B
dVnWsVCz5d8q/gbWyVhzq4Sgu8FjRpUW1ypjSHt/GD/Q06PXodM1PW7+Fn8+uIA1JweFjiVXegtV
uQ/YN0OeeiOQZvCX9OMbfy2N6nCz5WNgXS1zHdNs+beKf6twSt4z4FvWGFGrlKsNNits6cmSTrW+
6BqmixlHtzTjvbRgmW3NPuGzk+M6QzfkvvTd50z+obQqr00+lfIIrwysQ4lUXneL/QiItsofsGDd
X+dZY6i1fnJeai06uT/Q6Vk6xXIu5MH8Aw4qIbwm2VyG4yvHTJ5VkjlnHi9bttZdetsi91CyREtk
qP2BLk8ti1jY5JOdh+s5z1rL1eSZLc92lU9R51nXC/YDFqwRkHWDV9Z4064oWPK4VtPTxcz+1Tj2
cpatW7lm97DxM3rXHTPrnu1Ex0z9m7tyfLLkam15vTS04lqdfnlvmm/pSZNMb3y7ycda1p2lr0bt
p16QLYrOwDqxq0aVlW2S5bvGvyyLWKgI+bAu+ZkEtPXWnryLGd9y6hkbkdBdPmjiRnfZ6I1u0aLe
TWvCNBWRnpCnvjb+WhrV4U6Xj4F1tU51TKfrV9JfFAjXy8fAOrEiEb42qKyw0WdJp3/kyU5gbIii
j44klSzl+uvWvcRpdbMmPtngzh19zL/dffdVng4lX2X6FUnEfZNPXC4Sa2Atkoj73WI/9YJsUXQG
1ok9dYvxxLNGdWw3fi/rk1n2NGvFk44jR3FLlyaTzO541l1150J3/fCn3OBRT7jBw552H/2oc//v
/7lkL14Da+TUjfbAd6W5Zn9vu4P1M8/0JBvn9Ljly3t/y5b1+LxCfuE3bdpat2BBT7IFZo8bPjzZ
tGdY9u+WW9Z6mjvu6HG1fkOG9Ljrr1/rbr21p+bvxht73NVX97jLL1/r/auu6klOVqz+XX65c7/+
tXMXXtj7u+iidaUwcT//uXMXXFD+nX++cz/9afn3s5+tq7jW937yE+f+539cclSzc2ed5XxF/5xz
1nl+RYFwvXwMrJMc3ezMa/zTis3e+CLkI8eVcvzihJlPuxNOcO4LX3Du4oud+9NVK901Yze76yZt
cP93TbIByc097ne/S47SvMXAGg0UIf8sDWfxZw16+GOdexiXdd1K+mef7UnO407/AYSb7p7unnqq
p+7f8uVr66aFb156JlQ+8USPmzevx+eLI4907qSTnPvc53p/n/+8c6eeWv594xvr3Je/3AtMgN1F
F9X6rfM0v/ylc7V+v/mNc7/5zTr329+6mr8//MElQO3cn/+8zvtXXOFc7AegUwmgYsHvr39dWwpz
PWpUj7vzzvKPSvrYseXf0KFrK671vXHjetz06b2Vmvvv763AjB69NhlC62nZEmMB8wEP1g880ONQ
Fgqs54fSr7xyrbv22h532WUu8/eXvzjH79JL13lfrmv5f/rTusRAMdLK3//9n3P6d+ml8Hbuj39c
5325ruV3Av2IET1u5coet2pVjyOTbNxYBtZY4T/mgcfcTy7+u7v4yifc//w0OZRjYSX96k29+2bL
ftpkcPQXczH+MTqJ6y96Wj9z5vQkh970tjbEXsR+xA4oQCl0//d/e3+0NGhd0Grgd/7569x55zmX
nINT1++nP11Xk+6b33Tu4x937iMfce4zn1nnjjvOuQ9/uPz74AedO+wwl5wBUP372MfWReNjtMS1
kv6II5zL+gGE3zv2Xsf31fs76aR1ddPCMy/9pz+9Ljk+2LkTT0z20X+wnC/EfkO/v+w5TIdct2t6
BERb5Q94sKbmdsEF63zhRQFW60dBR2EI4F5zTXKoRMYPQOd3xRW94C7XtXwqA9dd11P1GzSox+kf
hTS/q69e6325ruV3Aj21+c9+loLeuW99yyWnqTl31FHOd2Gfdto630IgDkDA/8klT7jbxz/tRt7/
eMXpZGR4yewAtrjbb+/xrW651r7QE/fPf7LjWI975JHeigOVh8WLe9zUqT2OCgVdhDffvNZ3/w0d
SsWv3L2HDtE1rXsAk2/S4AhA8vvRj5w788zK31e+4txpp/X+vvrVdaUwcbSCPvlJl5xI59zXvtZb
YaPFITYj9iN2QNckLYyRI3t/tDSomNJq4Dds2Fo3fnyPmzChvt+IEWtr0s6enbQwN/W4LVt6kgN5
1iatkB73+OPlHy3ENKfln0aj49uNvt27wbXsYuF2k2e7pqdVIC3vGbBgbeuss9c2kkHk1y7rHFeu
XJsA5doEKOcnLYS1SeuZ7qhef3xyktWUOSv8zO85i1eW0s43xNIP4PzkJ+VvlG+dP39t0lPxoLvk
knXu299e5z7xCYByXdKlvs596Uu9v69/fZ1j3OrCC+n+W5cA8YPJb10Cyr0/uvn4UamjV+Wmm9Z6
QGds74471ibd7/M9QAKS/EaNWpuMD1b+pkxZm/Qo9P7uumt+KUzcjBlr3axZayu+UdKf9r36fhiO
ySek0ddGX203Wj62zjpbPt1iP7bO2rYb9YVwrMabFkdBkcd1I70ckxnb8zv2vbT8aM1qx5AI3bb0
hDC5hTE+xkpruRj/rGeMPks65Z6QbKry3XaTp7Wsy7qJhdpNX42mR1q8rfIHbMsaAdumKLGsVB3X
qDFXc4rHFMGfM6ZZlsXBKpwfrV2M/4oVPX6GJ3R0czOZBaBmfDxGr/mFYaMPJVJ5PdDkY2Bdqf/w
qlvsoVUgLe8xsE4sqVuMJ8wUadfd+L3sCc6xl7KES3977HsZS2XS0+TJPX4cnJnhjEvjYvSaXxg2
+lAildcDTT4G1pX6D6+6xR4ERFvlG1gnltQtxhNmirTrbvzeRx9LjsZMDu3g8A59FjQyiH0v3dss
XfnEJ5x7+OHKru4YfZos0/gbfVkCA02eBtZl3cdC3WIPrQJpeY+BdWJN3WI8sYwRi+vG7+WM6WEz
N7lbk53Mnk52MtOuG79Xf18Ytu8NJVJ53Wz5GFhXyju8arb8W8VfQLRVvoF1YkmtUm5otGnXlp40
yfTGx+TD+um/3rvR3TRtg+PADu1i9Pp+GDb6UCKV1yafSnmEVwbWoUQqr7vFfloF0vIeA+vEjrrF
eCqzRPpVN37vs0m3NidvXZ+cqhXO4O7G703Xrtlzlmy412x7MLDO1kCz5d8q/gKirfIHLFjbOuvs
tZAYvPw6ZV3komWrHT9Jt/idkn5Jb+hb+su2GMqG63aTj62z7ix9NWo/ts7a1lk3veZTqWyCAAAa
LUlEQVRPAZfHGX22tEw+Jh8tAWtZa2lUh7slv7SqRS3vGbAtawRg66yrM1IsplsyV+zbYnH2vTGp
lONMPmVZxEIG1jGplOO6xX4ERFvlG1gnNtQtxlPODtkh+16Tj5aA2YOWRnU4r3wMrKtlqGPyyrNd
6VsF0vIeA+vEitrVGLSBZ4Ut/VnSMf1mS8fkU7R8DKyzJdot5ZWAaKt8A+vErrrFeLKzSPmufW9Z
FrGQyScmlXKcyacsi1jIwDomlXJct9hPq0Ba3mNgndhQtxhPOTtkh+x7TT5aAmYPWhrV4bzyMbCu
lqGOySvPdqUXEG2Vb2CdWFG7GoM28KywpT9LOqbfbOmYfIqWj4F1tkS7pbxqFUjLewYsWNs66+y1
kGQo+TW6DlGer+Ub/7KsY7Iy+XSWfGyddWfpq9H8ZeusbZ21tfSzK+YmH5NPhQSo4ORxzaa3lnW2
Npot/1bxlxZvq/wB27JGwLbOOjtTyd1WGb+8r5Zv6cmWkMmnf+VjYN2/8m+V/bcKpOU9BtaJXbVK
udkmXL5r6SnLIhYy+cSkUo4z+ZRlEQs1Wz4G1jGpl+OaLf9W8RcQbZXfVWC9ZMkSd8QRR7gDDzzQ
HXrooW7x4sUuS5DWsi5noKxQq4w/Kw36nqVHS6M6bPKplomOabZ8DKy1tKvDzZZ/q/hnYUsz7nUV
WJ9yyinu2muv9QA9ePBgd+qppxpYV+cV60mIyERHtSqz63dmhS09WdJpv54xA+vO0lej+asZgJzF
s6vAerfddnMbNmzwAL1p0ya35557GlhH8k2jxhlhFY0y/lGxlCJNPiVRRAOdLh8D66haS5Gdrl9J
vwDrZZ/4hJs7Zkwm1ghtX/yuAutdd921QmC77757xXUoKOsGL+WfzIAYZyaRumn0ShiRoMknIhQV
1enyMbBWyowEO12/kn7Bk/Pe8AbHr9mg3VVgvccee7iNGzd6gKZlvffee1eA9ZVXXunOOuss960v
fcl983Ofc4cddJD3v/qpT3mfuHp+Rp8tJ5OPyUfno4FmD1//2MfqKkdERgNNPt32vQLW4gPaAuRF
+l0F1ieffLJjrBoB4Z9++umZQgO4oWWDlDxCNfrHMuVl8jH56Pw00Oxh/V13ZeYPLRsrf7LzSifI
R4N0M7vDuwqsFy5c6N7znve4g5IW8+GHH+7YYSbMGPpawFrHWbh25jEZmYzMBtJtIC9YmyzTZdkJ
sml297fIoKvAWj6qXt/AurMzSb16NjrTcyttYOPs2ZmNhFamxd7VPbY/oMGaMWwz5u4xZtOl6dJs
wGygW21gQIN1tyrVvssKLLMBswGzge6yAQPrFh4cYpmnuzKP6dP0aTZgNtAqGzCwNrC2oQCzAbMB
swGzgTa3AQPrGgqK7Tc+ffp0P+OcPcj3339/N2LEiIYNPcZfampz5sxxO++8c8O84RPjv2bNGnfc
cce5d77zne6AAw5wM2fObPgdMf6DBg1yb33rW90+++zjbrzxxoZ5ixzwmem/1157lXjF3qvp84ZD
/kXqOJZ+SV8ROo7xL1LHMf5F6Tgm5yJ1G+MfixN95PVjaY3F5eUr9DFezU6/vLsI24ylv0jbjPEv
yjZFDvhh+RB7r6ZvRtjAugZYx/YbP+qoo9y4ceM8cMydO7dq85U8iorxl+ePPfZYt8MOO5QASuLz
+DH+3/rWt9wFF1zg+Y4cOdJ9LNnEIQ9PTRvjzzavy5cvd0uXLu2TbOQ9d9xxh68Ubb/99qV0xt4r
9Hn9GP8idRzjL2ksQscx/kXqOMa/KB3H5FykbmP8Y3Gij7x+LK2xuLx8hT7Gq9npl3cXYZux9Bdp
mzH+RdmmyCFm/7H3Cn2zfAPrGmAd229cn+Y1b94834JsVEEx/vC6/PLL3Q9+8APH/UZ581yM/777
7ut+/OMfu4MPPtgdc8wxbsGCBQ2/I8b/fe97n6MSg2xe+cpXNsxbvvu2225zy5Ytc3o72dh7hT6v
H+NfpI5j/EljUTqO8S9SxzH+Rek4JucidRvjH4vLazNCH0trLE7o8/oxXs1OP2ksyjZj6S/SNmP8
i7JN0VXM/mPvFfpm+QbWiWFmCVcDBHR6v3G6Rvbbbz930003ZfLIy3/FihXukEMOcevXr+8zWMfS
/5rXvMZdd911Ps2k/f3vf3+h6b/11lvdS1/6Uvf617/effzjH3ePPvpow/y17PS36HCoF/1MnnDI
k2eL0LGkQfMvUscx/kXqOMa/aB1rOWs58W6d5yQteX3NX56Nxcm9ev1YWmNx9fIL6bJ4NSv9Rdpm
LP1F2maMf9G2KTrR79Jh7hdho/KeNN/AOhF0mnCIT9tvfPjw4f5eX8dkY/w/l+xRDn/eTw0uK321
7sX4h6eRvfGNb2z4HTH+jFePHz/e88T/0Ic+1DB//X06g8Teq2kbCWv+PF+UjiUtmn+ROo7xL1LH
Mf5F6jiUc9G6DfkXqdtYWmNxIsO8fhqv2Dfl5Q19jH+RthnjX6RtxvgXaZtapjr/xt6raZsRNrBO
DDZLsLH9xm+44Qbfon7ggQcyn83iK/di/AFPWtb8tt12W+8LfV4/xv/Tn/60GzJkiE/76NGj3ZFH
Htnwd8T4MxGMLnDSiq8nhuVNv6bXmSX2Xk3bSFjzL1LHkhbNv0gdx/gXqeMY/6J0HJNzkbqN8Y/F
yTfm9WNpjcXl5Sv0MV7NTn+RthlLf5G2GeNflG2KDsTX+Tf2XqFrlm9gXQOs6WoK9xvfcccd3Vve
8pYSoH7gAx9oGOxi/LWy+9qyjvFnzOvoo492zGbnN2PGjELTz6S1d7zjHZ43fl9my2tZ6MwS+y5N
20hY8y9Sx5IWzV/i8PuqY+Gl+Rep4xj/onQck3ORuo3xj8XJN+b1Y2mNxeXlK/QxXs1Ov7wbv6+2
GUt/kbYZ41+UbWo5ENb5K/bekL7oawPrGmBdtMCNX3ZPhsnH5GM2YDZgNlBtAwbWBtYNt6otQ1Vn
KJOJycRswGygGTZgYG1gbWBtNmA2YDZgNtDmNmBg3eYKakYNzXhazd9swGzAbKCzbMDA2sDaatRm
A2YDZgNmA21uAwbWba4gq/12Vu3X9GX6MhswG2iGDRhYG1hbjdpswGzAbMBsoM1twMC6zRXUjBqa
8bSav9mA2YDZQGfZgIG1gbXVqM0GzAbMBswG2twGWg7W22yzTapRsFOY1PZ0WOKy/Cy+Wc/ZvebU
LrP0oXWrw/XoIotvK56v5x1G0xybMrmaXAeyDbQVWOuCWIfrUVBe+np4Gk3jhUOWPvQ9Ha5H3nnp
Q559fT7kZ9eN24jJzmRnNlC/DRQG1ttu+wZHQRj+XvGKV5RayyiG+6eddpp729ve5nbZZRd36aWX
+vuclMI9TmjSYXmGk2DYoJ29pmfPnu04RONd73qXp+Uez5ri61d8o7J69Q47V+kY2fenni+55BLH
ST7s137AAQe4CRMmuFic2FKj327PNd++TMYmY7OBuA0UBtYU2Icd5qp+IYhyfcUVV3hgpVB99atf
XQJZTRuGf/GLX3i63//+9/78Zc5g/stf/uLjfve73xlYt2i8Bb0Mmry+6qf1RWbjulV65uzsBQsW
eFu4+eab3XnnnefP0w7jJF1WGMQLA5OLycVsoH1toF/AesOGDb5g3bJlSwXI6gI/DD/yyCP+mbVr
17qXvOQl/rdu3Tofxz1NbwbXPINDzvWCdav0fMIJJ7iddtrJcWzd5Zdf7rCLWBx2YXbSPNuwfGey
NRtong30C1hrherCMyusgfllL3uZbzkB3PDinn5W87dwscaDnOsFay17rZ+scL16ZqhEfrxn6tSp
7qKLLkp6dg5z73znO71dxOL0u3X6LFysnZg8TZ5mA8XaQFuB9XOe8xy3adMmX9DqMAWsjG3/5je/
cR/5yEf82PYf/vAHT8s9K4SLNYy0jIac+wrWWrc63IieAfedd97ZzZs3z9sC8xle9apXVcVtt912
/r7ZSWvsJM1+LN7kbzbQmA20FVgfdNBB7t3vfrcvVHWYAvakk07yLan3ve99joO/GY885JBD/KSi
z372swbWSeuyFZmgCLDWutXhRvX85z//2b35zW92e++9t7eHG264wcXikI+BdWvspBW2aO8wXQ4k
GygMrF//+tf7gpDCUP/CWcKNCNcK2PbJlKbn9tFFI3nJnjH9mQ10pg0UBtbNNAAD6840rrw2YXoe
GHrOaxdGb3ZhNvCY6wiwNkVZZjUbMBswGzAbGMg2YGDdorHegWxk9u1WyJoNmA2YDfTNBgysDaxb
MjHNMmrfMqrJz+RnNjCwbcDA2sDawNpswGzAbMBsoM1toFCwZoLQ29/+9iqlf/rTny5syUzWJCR9
gpMO11MjzeJbz/MhzT333OOXmrFn9Uc/+lG3cuVKd9ttt/nlRcTts88+btiwYRWyYjkaS9O4z2/0
6NEV9x988EG3/fbbV8Tp9/ZV/tOnT/d6+uMf/5j6Dv2+esJZctU60uG+8q3n+ZCGDXY+9rGPuT32
2MPrDVlomvvuu8+96EUvqojT99N0y74Ar33ta0sbuLCRi36OcF/1Bo/rr7/eHXjggf49b3zjG933
v/99xw6B4bvyXHe67mJ5UH9/Vn5rld50eiw8sFvOtfRfOFi/7nWvc/fff3+pkFizZo2j8MjK+LUS
qe9n8dH3dFg/nxbOS5/GR+IBY9nI5eqrr3annnqq3wd94sSJXjbjx4/3hbjQ45944onuxhtv9Pdv
v/1296Y3vakkx6FDh/q1xFnp5F5f5P/1r3/dbzbDYRg6XX0J10qv8M6iExrt56XXz8bCZ511ljvj
jDP8d1933XXu6KOPrpABB8xkvZM97mO6ZQ+AQYMGVfAK3w/fvugNm9l33339/gPwZvtd9iD42c9+
lvneMB3hddb36ns6HPKIXeelj/HQcWm6i+VB/VxWfmuF3nRaLGxAXcsGCgdrMs53v/vdUiEBYH3t
a18rFXRTpkxxbIRBC4Odpy644AJPe+GFF/p4WgMc8EHhtWzZshIf+RAyeiec2vX85z/fyXao+LSu
9ttvPzdkyBD/TYDv/vvvX/F9gITs4LZixQr34he/uHT/mGOOcZMmTSrJUeShfWRTS/6aXoc3btzo
W+1s0fma17zGv4v7H/7wh/1+20J78MEHu5EjR/odw9AjJ1196lOfSk1Xp+iLFvWsWbNK8pbvxWen
vIsvvjj1G6FJ0y0btXDoDHJi573ly5dXvaMveuPdtKjDXpoZM2Z4PXEf/vjy09eEjzvuOF8RXLx4
cYlGnuuEvJamu1geFBngZ+W3VuhNp8XCZfs0WcRlUThY33vvve4Nb3hDKdPTrQtASwFBCxOgQiFz
5sxx2267rQ8D0u9973v9/s50AdOtGFMafFp1mlPs/fXG0dKRljX+8573PF8J4Xt32GEH36WKXNL4
ffOb3/S7toX3RY5hPNfcqyX/2HPEsesXBRThL37xi74ngDCtwg9+8IM+nm54dIuuiJPu8iwg6xR9
oRdOduPoVioh0g2+dOlSd+SRR7rNmzeXbDgmQyqYoW55BqCmAsQzVGIZEgmf74ve4MXBNrKnesib
69Bm9DXh4cOHV6VJnuuEvJamu1gejMmHOJ3fWqW3tLRYfBysBrpcCgdrBEqLcdSoUW7+/Pml1qMU
EOvXr3fXXHONO/vss93xxx9fUZDMnTvXH9ABWKQpBj6tOs0pLQ31xE+bNs23eCj8f/7zn3twZjz/
t7/9rf82ehLoqozxOv/88z1oMM4d3hc5hvFcy70s+ceeI45u3nPPPde/78477/R6WL16tUNf9AqQ
FrpVv/Od73gajqUUgGCoQ94d8u8UfVGZ4vhV0k8lhJYy4c985jO+kkU47Ru5V49uH374YQ+s0Ouf
8G1Eb/BBF9KLo/lKWPjHrrmHjuWe9rnXCXktTXexPKi/T8JZ+Q2aZulN3m9+ZX4wecTl0RSwpoVC
9xmFv5xDLQXGf//3f7tTTjnFt9jodpR4FDRixAjfFUu3HrXbmNI0Pff1dVZYgIXxvFac2kU3pBSC
tKAZf37hC19YAXBch9/IkAEgTgER3gu/N7wv358l//AZrh966CGfNlr8DE3wowvx17/+tU/DF77w
hRKAMdGKZ+iiF4DAl3eH/MN4fZ0VbrW+qJDIO/ke0c2OO+5YmhxGevVJX/pbY7qlW/mXv/xlSY/o
9D/+4z9K1/K8yCGv3uR57CXsBh83bpxDb9DAXyabYZPyPrknfEJf04W0+l4YFjm2Kq+l6S6WB8Nv
jOW3VuktTItdx0HK5NIrl6aANYU/s5aZ4EE3IsKWDE2X1aJFi3zcn/70Jx/PeKlMRKNVxzgptd2Y
koSP3NPX+gQnHYZGuqRbdWoXLVV6EEgnhSZjybScBg8e7OMYL5PWm3wLBTtj048++mj026HT3yvP
iS/3suQvtNpn3sDhhx9e8U5a0egPujFjxniQ0jP9SafIVPSoeUpY0hS71jrS4f7QFxOKOPyDdDIh
8F3veleFPIgPv0W+CT+mW8CKE8CYawDND3/4Q9/Frp8jLHzz6k34MIShJ5itWrXK9+pITwn780+e
PNmngW+U9+l3Cy/ta7qQVutLh3lG7KJVeS1Nd7E8qL8vLb+1Sm86LRY2oK5lA00Ba15KYU5mkQRI
xv/pT3/qdtllF99t+O1vf9vPFGec9fTTTy+1BDhVi0lOMm4oPPCFj8Tpa32Ckw5D0+pTu/gmWmGM
v/NuWht0ywF4xL3jHe/w13yHLOehgsPMeWm9Sbx8a+z70+6lyV/TS3ivvfbyS3/kGp8u8Je//OUe
qLmmZ0B6SbhmvgHnRjNx6pOf/GSpJap5ENb6Ca+1jnS4P/RFpZIZ4OgG4K3H9vge0VGabm+++Wa/
HIxJUIceeqifU5Alozx603wASOYcoEtZuiW9U4AmEzb5LpZ0aZ3osOZHOLynr7W+dBiaVue1NN3F
8iDfJTrLym+t0lsoc7s20E6zgULBOu0l/R2vC5n+Tku3vJ85BzJ7mt4QaYUX8X2mr84tsEx3nau7
IvKu8Wie/g2sk5q2GVh+GVx22WW+FUcrhV4CWWNchCytwM+vjyLkXgQP013n6q4I/RuP5ul/QIC1
GVDzDMhka7I1GzAbMBtovg0YWFvL2noWzAbMBswGzAba3AYMrNtcQVZjbX6N1WRsMjYbMBtodxsw
sDawthq12YDZgNmA2UCb20ChYM3kEr0WV2oqA+HUrdjEmrRTfdLiRV61TniCLnYqEPtOs16aJTz4
sX2oebavemJZEzxku1FJd1/8mPyEnz6RS4flfpafxTfrObmX9Xx4ClqaXuvRCxuxxE79qnVyFOkk
jX3NdwPp1K48OhU7iOXJNH3LM/hpNPXYRFG61emxcOf2IBQO1n05PageQ8rKaPqeDveVb6PPp53q
kxYv72F9eq30x04FYtc4tjaFD+vZZQcr4Ss+vPuip4F0OleaHmKnoKXptR69NHpyFDrtqz4H2qld
eXQqeSaWJ9P0Lc/gp9HUYxNF6FanxcKdC9TornCwrnXqUyedunXJJZf4TTLY+INjIzmsIRYnmSrM
DGmn+qTF83w9JzxBFzsVaKeddnK09riPDyCHaeKawqqWnmLPEdcNp3PFdBiLE1nFZMHmJeEpaGl6
rUcvjZ4cJWlsVJ883w2ndsX0F4sTedWrU+jS8mSavjXvNJp6bELS2hfd6rRY2MC6BAiAQK1Tnzrp
1C0OSKAbCyNnR6PzzjvPH5oQxkmmysoM+lQfTafj6z3hKe1UIPbzBkzhj/+CF7ygpBv9znr0pOl1
uBtO5ypSr2mtNK3XevTSl5Oj+qJPdNsNp3Y1S6f15kmtb51fdFjT1GMTPNtX3er3W9jAugQIUnCx
rWE3nLp1wgknOGrAJ598sj/TmS1DY3GSqdIyQ9qpPmF8vSc8he+RU4EAZzkPG7CmQAhpdVqz9BR7
jji6A2XP6U49nSumw1icllWaPMTm9f1Qr/XopS8nR0kaGtEn6e6GU7ti+ovF5dVpPXky1Le2BQmH
NPXYhE5ro7qV95vf2UCN/grvBodp1ulB7X7qFjtyyY9v4Sziiy66yB122GF+L+y0OCkwua9/sVN9
uB+Lr/eEp7RTgTgti33V4V+rGxyaLD3pb5BwJ5/OJTrF53v6qleRSaj3mF7r0UtfTo6SNOTVp3xD
p57a1Qqd1sqTMX2LXMWP0dRjEzzfV91KGsyvLJc7UR5NAeus04M65dQtWtFkqHnz5vnCffbs2f4E
pTBuu+228/clU2kjSDvVJy1ePxvjJ/fTTgX6/Oc/XzHBjEks8oz2hXeWnjS9hLvhdK4i9CrywBdZ
Ek7Taz16afTkKJ2GvPqU7+j0U7uaqVORkZazxKXpW+7jp9HUYxP6nY3qVqfFwp0N2E0Ba4wi7fSg
Tjp1i+ME3/zmN/vJXEwyo1CLxelMpTNE2qk+afH6WQ0CEi+tQq5jpwItWbLEn4XNyUuc8LRs2bJM
sIZPmp7kndrvltO5YjqMxfHtMT1omej7aXrN0ovoNO/JUWlpyKNPzaPTT+2K6S8Wl1enWkZa18Sn
6Zt7otc0miybSHtno7rV/CzcuYBdKFi3qyGEmaxd09mN6bLTuTq3cOgPe7S8avbSH3bXCe80sE5q
wZ2gqE5No53OZfaVx3YNrM1e8tjLQKIdEGA9kBRq32qFndmA2YDZQPfZgIG1taytZ8FswGzAbMBs
oM1twMC6zRVkNeTuqyGbTk2nZgNmA3ltwMDawNpq1GYDZgNmA2YDbW4DBtZtrqC8tS+jtxq72YDZ
gNlA99mAgbWBtdWozQbMBswGzAba3AYMrNtcQVZD7r4asunUdGo2YDaQ1wYMrA2srUZtNmA2YDZg
NtDmNmBg3eYKylv7MnqrsZsNmA2YDXSfDRhYG1hbjdpswGzAbMBsoM1toAKs5cL8q0pnh5osTBZm
A2YDZgNmA+1iA9u0S0IsHZYpzAbMBswGzAbMBuI28P8BGKm2J3TJQUQAAAAASUVORK5CYII=

------=_SW_31784_1449739534_mixed=--


From dev-return-85026-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Thu Dec 10 09:28:49 2015
Return-Path: <dev-return-85026-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id CD44A18A99
	for <apmail-httpd-dev-archive@www.apache.org>; Thu, 10 Dec 2015 09:28:49 +0000 (UTC)
Received: (qmail 22329 invoked by uid 500); 10 Dec 2015 09:28:49 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 22238 invoked by uid 500); 10 Dec 2015 09:28:49 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 22228 invoked by uid 99); 10 Dec 2015 09:28:49 -0000
Received: from Unknown (HELO spamd4-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 10 Dec 2015 09:28:49 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd4-us-west.apache.org (ASF Mail Server at spamd4-us-west.apache.org) with ESMTP id D16A1C0F42
	for <dev@httpd.apache.org>; Thu, 10 Dec 2015 09:28:48 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd4-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.653
X-Spam-Level:
X-Spam-Status: No, score=-0.653 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RP_MATCHES_RCVD=-0.554, URIBL_BLOCKED=0.001] autolearn=disabled
Authentication-Results: spamd4-us-west.apache.org (amavisd-new);
	dkim=pass (1024-bit key) header.d=greenbytes.de
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd4-us-west.apache.org [10.40.0.11]) (amavisd-new, port 10024)
	with ESMTP id 8xz9Z73sxNgy for <dev@httpd.apache.org>;
	Thu, 10 Dec 2015 09:28:39 +0000 (UTC)
Received: from mail.greenbytes.de (mail.greenbytes.de [217.91.35.233])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id A1AA824DB9
	for <dev@httpd.apache.org>; Thu, 10 Dec 2015 09:28:38 +0000 (UTC)
Received: from [192.168.1.42] (unknown [217.91.35.233])
	(using TLSv1 with cipher ECDHE-RSA-AES256-SHA (256/256 bits))
	(Client did not present a certificate)
	by mail.greenbytes.de (Postfix) with ESMTPSA id 389B215A03EB
	for <dev@httpd.apache.org>; Thu, 10 Dec 2015 10:28:32 +0100 (CET)
DKIM-Signature: v=1; a=rsa-sha256; c=simple/simple; d=greenbytes.de; s=mail;
	t=1449739712; bh=JkJBcbwrhj7uBW5Pbb6Gf8mcY+B7geCGr9QA33JOJrE=;
	h=Subject:From:In-Reply-To:Date:References:To:From;
	b=BvotF+t+CC++aNtltue/vhJXYl+tZ9TAbwDoHU5znTtNA+914PF5h+qAxXVDLJTLe
	 fQ7w3Ndy7CLzaaSpYaFMzYpDANF/9ROiWJtjCzpHmbnQkWZWk+ullRCSqBwFhq8LPQ
	 hoi2nB/S/5O8Qaj1hWEgKgJ+7rb1AWa6dYMRo9aI=
Content-Type: text/plain; charset=utf-8
Mime-Version: 1.0 (Mac OS X Mail 9.2 \(3112\))
Subject: Re: mod_http2 and rejecting HTTP/1 requests...
From: Stefan Eissing <stefan.eissing@greenbytes.de>
In-Reply-To: <CACsi253k3igA2Ans-c8UBGX9s=wKbYTh0eSgcqQMyHpy0QxmaA@mail.gmail.com>
Date: Thu, 10 Dec 2015 10:28:32 +0100
Content-Transfer-Encoding: quoted-printable
Message-Id: <62F0BC5B-E7E2-4E14-BCF5-8D29F17660DD@greenbytes.de>
References: <CACsi251DF52ZRqHBnvvTghLc7V34Sgy=5NADM=WGWyNkthb-ow@mail.gmail.com> <CACsi253k3igA2Ans-c8UBGX9s=wKbYTh0eSgcqQMyHpy0QxmaA@mail.gmail.com>
To: dev@httpd.apache.org
X-Mailer: Apple Mail (2.3112)


> Am 09.12.2015 um 19:06 schrieb William A Rowe Jr =
<wrowe@rowe-clan.net>:
>=20
> I think I know where this author was misguided...
>=20
> On Dec 9, 2015 11:19, "William A Rowe Jr" <wrowe@rowe-clan.net> wrote:
> >
> > And then I'm reading a really nonsensical comment in this FAQ...=20
> >
> > https://http2.github.io/faq/#implementation-questions
> > Can I implement HTTP/2 without implementing HTTP/1.1?
> > "Requests without the h2c upgrade token can be rejected with a 505 =
(HTTP Version Not Supported) status code that contains the Upgrade =
header field. Servers that don=E2=80=99t wish to process the HTTP/1.1 =
response should reject stream 1 with a REFUSED_STREAM error code =
immediately after sending the connection preface to encourage the client =
to retry the request over the upgraded HTTP/2 connection."
> >
> >
> > which would be absurd...
> >
> > 6.6.6.  505 HTTP Version Not Supported
> >
> >    The 505 (HTTP Version Not Supported) status code indicates that =
the
> >    server does not support, or refuses to support, the major version =
of
> >    HTTP that was used in the request message.  The server is =
indicating
> >    that it is unable or unwilling to complete the request using the =
same
> >    major version as the client, as described in Section 2.6 of
> >    [RFC7230], other than with this error message.  The server SHOULD
> >    generate a representation for the 505 response that describes why
> >    that version is not supported and what other protocols are =
supported
> >    by that server.
> >
> > A 505 is an unrecoverable error, the client isn't expected to do =
anything with it.
> >
> > I just want to ensure that we do *not* follow this guidance; if the =
user wants configure httpd to enforce HTTP/2 only on a particular vhost, =
we should be sending a 426 error always, with an error message =
explaining exactly why their request is rejected, but giving the =
user-agent the opportunity to automatically upgrade without presenting =
the message to the user.

> I think the guidance above is correct for TLS h2 or HTTP/1 requests. =
ALPN handshake should have resulted in an HTTP/2 connection, so if we =
are still at HTTP/1 in a TLS session we can't continue, and it is a =
fatal 505 condition.

If ALPN negotiated h2, the connection is on HTTP/2 semantics. If the =
client sends some HTTP/1 on it, it will lead to a protocol error and a =
GOAWAY frame before the connection is shutdown. We cannot send out a =
HTTP/1 response on a h2 connection.=20

If we have a cleartext connection, it starts in HTTP/1 format (unless we =
have some totally other Protocol directly configured on it). There are =
several cases to consider:

1. Protocols something http/1.1 other
  a) without Upgrade: header, HTTP/1 processing just continues. If it is =
the first request on a connection, we kindly advise the client about =
Upgrade possibilities in an Upgrade: response header.
  b) with Upgrade: header, internal protocol proposing and maybe =
switching starts, or maybe not. If only "other" is proposed, we would =
stay on http/1.1, since that is preferred.

2. Protocols something other
  a) without Upgrade: server answers 426, since it is not configured to =
stay on HTTP/1 here. Upgrade advisory as above.
  b) with Upgrade: negotiation as above, success -> switch, nothing =
agreed -> 505 response, as the protocols suggested by the client were =
not supported by the server, Upgrade advisory response header.

3. Server receives "PRI * HTTP/2.0\r\n\r\nSM\r\n\r\n", which is the h2c =
direct mode. mod_http2 currently tries to detect this on a new =
connection, if configured. Currently, this gives a "400 Bad Request", if =
mod_http2 does not take over. We could change this to a 505 answer.

//Stefan




From dev-return-85027-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Thu Dec 10 10:41:46 2015
Return-Path: <dev-return-85027-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 2408718CE3
	for <apmail-httpd-dev-archive@www.apache.org>; Thu, 10 Dec 2015 10:41:46 +0000 (UTC)
Received: (qmail 4940 invoked by uid 500); 10 Dec 2015 10:41:45 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 4866 invoked by uid 500); 10 Dec 2015 10:41:45 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 4855 invoked by uid 99); 10 Dec 2015 10:41:45 -0000
Received: from Unknown (HELO spamd3-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 10 Dec 2015 10:41:45 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd3-us-west.apache.org (ASF Mail Server at spamd3-us-west.apache.org) with ESMTP id 182B2180A38
	for <dev@httpd.apache.org>; Thu, 10 Dec 2015 10:41:45 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd3-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.653
X-Spam-Level:
X-Spam-Status: No, score=-0.653 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RP_MATCHES_RCVD=-0.554, URIBL_BLOCKED=0.001] autolearn=disabled
Authentication-Results: spamd3-us-west.apache.org (amavisd-new);
	dkim=pass (1024-bit key) header.d=greenbytes.de
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd3-us-west.apache.org [10.40.0.10]) (amavisd-new, port 10024)
	with ESMTP id Z4P5FSUpw7RD for <dev@httpd.apache.org>;
	Thu, 10 Dec 2015 10:41:38 +0000 (UTC)
Received: from mail.greenbytes.de (mail.greenbytes.de [217.91.35.233])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id 1FD6B203A3
	for <dev@httpd.apache.org>; Thu, 10 Dec 2015 10:41:38 +0000 (UTC)
Received: from [192.168.1.42] (unknown [217.91.35.233])
	(using TLSv1 with cipher ECDHE-RSA-AES256-SHA (256/256 bits))
	(Client did not present a certificate)
	by mail.greenbytes.de (Postfix) with ESMTPSA id 6D3F815A044E
	for <dev@httpd.apache.org>; Thu, 10 Dec 2015 11:41:37 +0100 (CET)
DKIM-Signature: v=1; a=rsa-sha256; c=simple/simple; d=greenbytes.de; s=mail;
	t=1449744097; bh=nSP9Bkofmdv/dXn6hLj8gSb/qT2/HQxZJUu4PiclXWY=;
	h=Subject:From:In-Reply-To:Date:References:To:From;
	b=S/CQDp9kEgVhdhkP6LYd/xO14WMHLW6cxy3yPCH8Uk64onUoZvMphQve8pTHPePBv
	 ocVL4irjK7VYvc2PPF7dkKph7x6IYttIQEr6oGxvDES0ARtmpkc10JWtyYP4aBtGvF
	 ql81srl8D6q97Yvtn6xjAKJJ3wUqIuV3yP+2igEE=
Content-Type: text/plain; charset=us-ascii
Mime-Version: 1.0 (Mac OS X Mail 9.2 \(3112\))
Subject: Re: Upgrades
From: Stefan Eissing <stefan.eissing@greenbytes.de>
In-Reply-To: <CACsi252GzY3QZ3_7qw_07QMDwMi8D=MD=Lq38_FcR+0_rtzodQ@mail.gmail.com>
Date: Thu, 10 Dec 2015 11:41:37 +0100
Content-Transfer-Encoding: quoted-printable
Message-Id: <85CD9A04-87AE-458E-AF53-D5BE9FFCE2B7@greenbytes.de>
References: <CACsi250=dbRQKnsbE8JSdAZRm5x99gE0sgX3iQ-PHAx77euD1A@mail.gmail.com> <AB1691BE05AE7F4992697F2A0835627AC63BAB94@VOEXM10W.internal.vodafone.com> <F7B20D30-D34A-4805-A77D-F64F6428F6E3@greenbytes.de> <56660896.c74fc20a.15f56.0ebd@mx.google.com> <56660B43.2060507@gmail.com> <6B13DF2B-0586-42BB-B62F-59A7638B697D@greenbytes.de> <13FE9E7F-9620-4BF9-8EA4-57A6314D66BF@greenbytes.de> <9CCEFD7E-9ED3-4ED1-8F58-2134DD5310F9@gbiv.com> <CACsi252y7nX0kR9+JgSra7Q_5_LVqaR3z6ExPKg=Lhi8zhN4ew@mail.gmail.com> <566887B5.2080705@gmail.com> <CACsi253sTRbX2dnuq0yRP1sHb8vOos_9QaoYmA3TtYmnNx-Erg@mail.gmail.com> <4E837922-E5BF-4BA1-9B91-21AD22613461@c8h10n4o2.org.uk> <CACsi252GzY3QZ3_7qw_07QMDwMi8D=MD=Lq38_FcR+0_rtzodQ@mail.gmail.com>
To: dev@httpd.apache.org
X-Mailer: Apple Mail (2.3112)


> Am 10.12.2015 um 02:07 schrieb William A Rowe Jr =
<wrowe@rowe-clan.net>:
>=20
> There is a case to be made for the h2c to also be an 'early' upgrade =
decision,
> AIUI (correct me if I'm wrong Stefan) the mod_http2 module sees a =
request,
> grabs ahold of the network in the main request thread, and then =
're-processes'
> the request, repeating all of the request processing hooks for the =
initial request
> on the secondary h2c 'worker' thread.  By interrupting very early, =
during the
> post_read_request phase, these steps will no longer be duplicated.

Yes, correct. Good point for making the upgrade earlier for protocols =
like h2c.=

From dev-return-85028-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Thu Dec 10 10:46:00 2015
Return-Path: <dev-return-85028-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 25B0218CF5
	for <apmail-httpd-dev-archive@www.apache.org>; Thu, 10 Dec 2015 10:46:00 +0000 (UTC)
Received: (qmail 9581 invoked by uid 500); 10 Dec 2015 10:45:59 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 9508 invoked by uid 500); 10 Dec 2015 10:45:59 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 9497 invoked by uid 99); 10 Dec 2015 10:45:59 -0000
Received: from Unknown (HELO spamd2-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 10 Dec 2015 10:45:59 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd2-us-west.apache.org (ASF Mail Server at spamd2-us-west.apache.org) with ESMTP id 4B3121A5BE1
	for <dev@httpd.apache.org>; Thu, 10 Dec 2015 10:45:59 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd2-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 2.88
X-Spam-Level: **
X-Spam-Status: No, score=2.88 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	HTML_MESSAGE=3, RCVD_IN_MSPIKE_H3=-0.01, RCVD_IN_MSPIKE_WL=-0.01]
	autolearn=disabled
Authentication-Results: spamd2-us-west.apache.org (amavisd-new);
	dkim=pass (1024-bit key) header.d=qqmail.nl
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd2-us-west.apache.org [10.40.0.9]) (amavisd-new, port 10024)
	with ESMTP id 5KIA9xvPG24X for <dev@httpd.apache.org>;
	Thu, 10 Dec 2015 10:45:51 +0000 (UTC)
Received: from mail-wm0-f46.google.com (mail-wm0-f46.google.com [74.125.82.46])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id 54443429C4
	for <dev@httpd.apache.org>; Thu, 10 Dec 2015 10:45:51 +0000 (UTC)
Received: by wmww144 with SMTP id w144so18824192wmw.0
        for <dev@httpd.apache.org>; Thu, 10 Dec 2015 02:45:44 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=qqmail.nl; s=google;
        h=from:to:references:in-reply-to:subject:date:message-id:mime-version
         :content-type:thread-index:content-language;
        bh=emYxlFoLwYdpdqsEWNiWzuaMz4gQUsUbXMj+Q2CUSbk=;
        b=JoPsVwEP9D1UOuh7jYW+PGgl034T0oUc7aQWRTobAVM690lJs/RngoLKYTEk/g6g80
         WBI0Pdfa4MhF5rFCcygcfPQR7DM2Y93qYPbDggotagFv4f3YmfuipY0caYaB77OpyviD
         3KHXiD7+Rl6dCKaQj8F57pWpHlUwx8NsCLoFU=
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=1e100.net; s=20130820;
        h=x-gm-message-state:from:to:references:in-reply-to:subject:date
         :message-id:mime-version:content-type:thread-index:content-language;
        bh=emYxlFoLwYdpdqsEWNiWzuaMz4gQUsUbXMj+Q2CUSbk=;
        b=W1JDzPNCwWCwRmjVgAUJs4TZW6KdbgXEHJXQ7OBDwZJXmkvwlsl46XmII6uG5GEJ9g
         B/JjsjSOS1OKqlXFVMegF6HKgqBEo7HDaJQK4gXzVCpgl+6EOtSsrgcxMr2svlhwCMrg
         l2BpqIBskdV/sASc2kJ5rAp6j8AUJRnAoBAJCzubqv7A+RyIDUGtMa8jtnYngLs7gYjA
         H9uQAK7JiobX0gLLlWqiAn38NTVmJEuv9r7WJ8seoIJ9kn/zSQKoym21ft3inK9Sqyuq
         l053adK3OcZkc0t5VNyDS7nQWOcIratbyftjOF9PB8pzUHT245+40MuVVDrcQJksoBW3
         mIgg==
X-Gm-Message-State: ALoCoQn6FCYGeZsRqdo6o72DyCCglFYbmG1HM0WYHGByvjRqNV4rwgCjeIJvwvIWvNh57ZqIUCpM54vWGoD5qIxu7/sCD2eqJg==
X-Received: by 10.194.173.5 with SMTP id bg5mr11993764wjc.142.1449744344461;
        Thu, 10 Dec 2015 02:45:44 -0800 (PST)
Received: from I72600 ([2001:610:66e:0:52e5:49ff:fee1:96b7])
        by smtp.gmail.com with ESMTPSA id z66sm233139wmz.7.2015.12.10.02.45.43
        for <dev@httpd.apache.org>
        (version=TLS1_2 cipher=ECDHE-RSA-AES128-GCM-SHA256 bits=128/128);
        Thu, 10 Dec 2015 02:45:43 -0800 (PST)
From: "Bert Huijben" <bert@qqmail.nl>
To: <dev@httpd.apache.org>
References: <CACsi250=dbRQKnsbE8JSdAZRm5x99gE0sgX3iQ-PHAx77euD1A@mail.gmail.com>	<AB1691BE05AE7F4992697F2A0835627AC63BAB94@VOEXM10W.internal.vodafone.com>	<F7B20D30-D34A-4805-A77D-F64F6428F6E3@greenbytes.de>	<56660896.c74fc20a.15f56.0ebd@mx.google.com>	<56660B43.2060507@gmail.com>	<6B13DF2B-0586-42BB-B62F-59A7638B697D@greenbytes.de>	<13FE9E7F-9620-4BF9-8EA4-57A6314D66BF@greenbytes.de>	<9CCEFD7E-9ED3-4ED1-8F58-2134DD5310F9@gbiv.com>	<CACsi252y7nX0kR9+JgSra7Q_5_LVqaR3z6ExPKg=Lhi8zhN4ew@mail.gmail.com>	<566887B5.2080705@gmail.com>	<CACsi253sTRbX2dnuq0yRP1sHb8vOos_9QaoYmA3TtYmnNx-Erg@mail.gmail.com>	<5668CC4F.109@gmail.com>	<CACsi253q+GanuRzOqBjaOe-h1w8uOcH6uFAcdres=+ig5q6+VA@mail.gmail.com>	<5668EFDB.1050900@gmail.com> <CACsi252HOz3_BO6hJtRTfM=M6oB0ZUXpSvkPmKs8LWP3LCz8xA@mail.gmail.com>
In-Reply-To: <CACsi252HOz3_BO6hJtRTfM=M6oB0ZUXpSvkPmKs8LWP3LCz8xA@mail.gmail.com>
Subject: RE: Upgrade Summary
Date: Thu, 10 Dec 2015 11:45:35 +0100
Message-ID: <d27501d13337$e83832b0$b8a89810$@qqmail.nl>
MIME-Version: 1.0
Content-Type: multipart/alternative;
	boundary="----=_NextPart_000_D276_01D13340.49FF0BB0"
X-Mailer: Microsoft Outlook 16.0
Thread-Index: AQKiK5k53Zwc1sqI7zswkQpwqyBJZQHPPeQLAlYfy+wBw01DvAJJXKo0Ai3vbIwBtCRQOwEDPPgvAno6FMYC0LSzywJNCLE3Aj1Jd00ByA6t6QGH0D6QAVTGCOWcRWjKsA==
Content-Language: nl

This is a multipart message in MIME format.

------=_NextPart_000_D276_01D13340.49FF0BB0
Content-Type: text/plain;
	charset="utf-8"
Content-Transfer-Encoding: quoted-printable

Great to see where this discussion is headed:

+1 on the last design ideas.

=20

Going with one =E2=80=98as early as possible=E2=80=99 upgrade and one =
=E2=80=98upgrade last=E2=80=99 should handle all these cases just fine.

=20

I don=E2=80=99t think the h2c and TLS cases really have to be that =
different as suggested in the earlier parts of the discussion. Both want =
to upgrade as soon as possible, which is +- after the initial request is =
read, and before the response is generated.

=20

TLS then really needs to exchange information both ways, while for h2c =
allowing exchange both ways allows doing some things a bit earlier.

=20

=20

Websockets are different=E2=80=A6 and in some ways not really an upgrade =
of the connection=E2=80=A6 more like a hostile takeover with a final =
operation to a targetJ

=20

More like a CONNECT request to a proxy=E2=80=A6 or perhaps a PRI request =
to a HTTP/1.1 server that handles h2direct that way=E2=80=A6 one final =
request until the connection closes.

=20

                Bert

=20

=20

From: William A Rowe Jr [mailto:wrowe@rowe-clan.net]=20
Sent: donderdag 10 december 2015 07:40
To: httpd <dev@httpd.apache.org>
Subject: Re: Upgrade Summary

=20

On Wed, Dec 9, 2015 at 9:22 PM, Jacob Champion <champion.p@gmail.com =
<mailto:champion.p@gmail.com> > wrote:

On 12/09/2015 05:19 PM, William A Rowe Jr wrote:

=20

    _If_ all the other protocols worked like WebSocket and required
    authnz before an upgrade could succeed, it wouldn't make sense for
    each upgrade handler to have to do the authnz check themselves. But
    in this case, WebSocket is different enough that I think it will
    probably have to.

No, because we will simply give you two chances to accept and trigger
the upgrade, once in the post_read_request, another in ap_invoke_handler
phase before filters are inserted.


Here you make it sound as if I won't have to duplicate the authnz checks =
in the handler phase, but in a previous email you said

websocket can ignore the Upgrade: websocket offer after inspecting =
authnz


Did I misunderstand? I feel like I'm missing something crucial to your =
point.

=20

I propose two chances to catch the upgrade, early and late.  You need =
auth,

therefore you must inspect the late catch, which follows authnz but =
precedes=20

the handler invocation.

=20

If a websocket protocol module determines that authnz denied websocket

but not the resource, then it can proceed to the normal http/1 handler =
without

responding with a 101-switching protocols.  But if the request meets the

requirements to be handled by the websocket protocol, you reply to the

Protocol API with an 'upgrade accepted' and take ownership of the =
request

and the connection.

=20

Sounds reasonable.

I'd certainly like to see a websocket prototype
or outline before we declare the protocol baked for the second time :)


Working on it. :) My original experimental hook for 2.4.17 rebased =
nicely onto 2.4.18, but mod_websocket has been refactored significantly =
since I wrote that and I couldn't reuse my work. Sorry I've been slow in =
actual code-writing; I've been under the weather this week.

=20

No worries, 2.4.18 is an incremental set of improvements, and 2.4.19

will be moreso, but not in the next week :)=20

=20


------=_NextPart_000_D276_01D13340.49FF0BB0
Content-Type: text/html;
	charset="utf-8"
Content-Transfer-Encoding: quoted-printable

<html xmlns:v=3D"urn:schemas-microsoft-com:vml" =
xmlns:o=3D"urn:schemas-microsoft-com:office:office" =
xmlns:w=3D"urn:schemas-microsoft-com:office:word" =
xmlns:m=3D"http://schemas.microsoft.com/office/2004/12/omml" =
xmlns=3D"http://www.w3.org/TR/REC-html40"><head><meta =
http-equiv=3DContent-Type content=3D"text/html; charset=3Dutf-8"><meta =
name=3DGenerator content=3D"Microsoft Word 15 (filtered =
medium)"><style><!--
/* Font Definitions */
@font-face
	{font-family:Wingdings;
	panose-1:5 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"Cambria Math";
	panose-1:2 4 5 3 5 4 6 3 2 4;}
@font-face
	{font-family:Calibri;
	panose-1:2 15 5 2 2 2 4 3 2 4;}
/* Style Definitions */
p.MsoNormal, li.MsoNormal, div.MsoNormal
	{margin:0cm;
	margin-bottom:.0001pt;
	font-size:12.0pt;
	font-family:"Times New Roman",serif;}
a:link, span.MsoHyperlink
	{mso-style-priority:99;
	color:blue;
	text-decoration:underline;}
a:visited, span.MsoHyperlinkFollowed
	{mso-style-priority:99;
	color:purple;
	text-decoration:underline;}
p.msonormal0, li.msonormal0, div.msonormal0
	{mso-style-name:msonormal;
	mso-margin-top-alt:auto;
	margin-right:0cm;
	mso-margin-bottom-alt:auto;
	margin-left:0cm;
	font-size:12.0pt;
	font-family:"Times New Roman",serif;}
span.EmailStyle18
	{mso-style-type:personal-reply;
	font-family:"Calibri",sans-serif;
	color:#1F497D;}
.MsoChpDefault
	{mso-style-type:export-only;
	font-family:"Calibri",sans-serif;}
@page WordSection1
	{size:612.0pt 792.0pt;
	margin:72.0pt 72.0pt 72.0pt 72.0pt;}
div.WordSection1
	{page:WordSection1;}
--></style><!--[if gte mso 9]><xml>
<o:shapedefaults v:ext=3D"edit" spidmax=3D"1026" />
</xml><![endif]--><!--[if gte mso 9]><xml>
<o:shapelayout v:ext=3D"edit">
<o:idmap v:ext=3D"edit" data=3D"1" />
</o:shapelayout></xml><![endif]--></head><body lang=3DEN-US link=3Dblue =
vlink=3Dpurple><div class=3DWordSection1><p class=3DMsoNormal><span =
style=3D'font-size:11.0pt;font-family:"Calibri",sans-serif;color:#1F497D'=
>Great to see where this discussion is headed:<o:p></o:p></span></p><p =
class=3DMsoNormal><span =
style=3D'font-size:11.0pt;font-family:"Calibri",sans-serif;color:#1F497D'=
>+1 on the last design ideas.<o:p></o:p></span></p><p =
class=3DMsoNormal><span =
style=3D'font-size:11.0pt;font-family:"Calibri",sans-serif;color:#1F497D'=
><o:p>&nbsp;</o:p></span></p><p class=3DMsoNormal><span =
style=3D'font-size:11.0pt;font-family:"Calibri",sans-serif;color:#1F497D'=
>Going with one =E2=80=98as early as possible=E2=80=99 upgrade and one =
=E2=80=98upgrade last=E2=80=99 should handle all these cases just =
fine.<o:p></o:p></span></p><p class=3DMsoNormal><span =
style=3D'font-size:11.0pt;font-family:"Calibri",sans-serif;color:#1F497D'=
><o:p>&nbsp;</o:p></span></p><p class=3DMsoNormal><span =
style=3D'font-size:11.0pt;font-family:"Calibri",sans-serif;color:#1F497D'=
>I don=E2=80=99t think the h2c and TLS cases really have to be that =
different as suggested in the earlier parts of the discussion. Both want =
to upgrade as soon as possible, which is +- after the initial request is =
read, and before the response is generated.<o:p></o:p></span></p><p =
class=3DMsoNormal><span =
style=3D'font-size:11.0pt;font-family:"Calibri",sans-serif;color:#1F497D'=
><o:p>&nbsp;</o:p></span></p><p class=3DMsoNormal><span =
style=3D'font-size:11.0pt;font-family:"Calibri",sans-serif;color:#1F497D'=
>TLS then really needs to exchange information both ways, while for h2c =
allowing exchange both ways allows doing some things a bit =
earlier.<o:p></o:p></span></p><p class=3DMsoNormal><span =
style=3D'font-size:11.0pt;font-family:"Calibri",sans-serif;color:#1F497D'=
><o:p>&nbsp;</o:p></span></p><p class=3DMsoNormal><span =
style=3D'font-size:11.0pt;font-family:"Calibri",sans-serif;color:#1F497D'=
><o:p>&nbsp;</o:p></span></p><p class=3DMsoNormal><span =
style=3D'font-size:11.0pt;font-family:"Calibri",sans-serif;color:#1F497D'=
>Websockets are different=E2=80=A6 and in some ways not really an =
upgrade of the connection=E2=80=A6 more like a hostile takeover with a =
final operation to a target</span><span =
style=3D'font-size:11.0pt;font-family:Wingdings;color:#1F497D'>J</span><s=
pan =
style=3D'font-size:11.0pt;font-family:"Calibri",sans-serif;color:#1F497D'=
><o:p></o:p></span></p><p class=3DMsoNormal><span =
style=3D'font-size:11.0pt;font-family:"Calibri",sans-serif;color:#1F497D'=
><o:p>&nbsp;</o:p></span></p><p class=3DMsoNormal><span =
style=3D'font-size:11.0pt;font-family:"Calibri",sans-serif;color:#1F497D'=
>More like a CONNECT request to a proxy=E2=80=A6 or perhaps a PRI =
request to a HTTP/1.1 server that handles h2direct that way=E2=80=A6 one =
final request until the connection closes.<o:p></o:p></span></p><p =
class=3DMsoNormal><span =
style=3D'font-size:11.0pt;font-family:"Calibri",sans-serif;color:#1F497D'=
><o:p>&nbsp;</o:p></span></p><p class=3DMsoNormal><span =
style=3D'font-size:11.0pt;font-family:"Calibri",sans-serif;color:#1F497D'=
>=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0=
=C2=A0=C2=A0=C2=A0 Bert<o:p></o:p></span></p><p class=3DMsoNormal><span =
style=3D'font-size:11.0pt;font-family:"Calibri",sans-serif;color:#1F497D'=
><o:p>&nbsp;</o:p></span></p><p class=3DMsoNormal><a =
name=3D"_MailEndCompose"><span =
style=3D'font-size:11.0pt;font-family:"Calibri",sans-serif;color:#1F497D'=
><o:p>&nbsp;</o:p></span></a></p><span =
style=3D'mso-bookmark:_MailEndCompose'></span><div =
style=3D'border:none;border-left:solid blue 1.5pt;padding:0cm 0cm 0cm =
4.0pt'><div><div style=3D'border:none;border-top:solid #E1E1E1 =
1.0pt;padding:3.0pt 0cm 0cm 0cm'><p class=3DMsoNormal><b><span =
style=3D'font-size:11.0pt;font-family:"Calibri",sans-serif'>From:</span><=
/b><span style=3D'font-size:11.0pt;font-family:"Calibri",sans-serif'> =
William A Rowe Jr [mailto:wrowe@rowe-clan.net] <br><b>Sent:</b> =
donderdag 10 december 2015 07:40<br><b>To:</b> httpd =
&lt;dev@httpd.apache.org&gt;<br><b>Subject:</b> Re: Upgrade =
Summary<o:p></o:p></span></p></div></div><p =
class=3DMsoNormal><o:p>&nbsp;</o:p></p><div><div><div><p =
class=3DMsoNormal>On Wed, Dec 9, 2015 at 9:22 PM, Jacob Champion &lt;<a =
href=3D"mailto:champion.p@gmail.com" =
target=3D"_blank">champion.p@gmail.com</a>&gt; =
wrote:<o:p></o:p></p><blockquote style=3D'border:none;border-left:solid =
#CCCCCC 1.0pt;padding:0cm 0cm 0cm =
6.0pt;margin-left:4.8pt;margin-right:0cm'><p class=3DMsoNormal>On =
12/09/2015 05:19 PM, William A Rowe Jr wrote:<o:p></o:p></p><blockquote =
style=3D'border:none;border-left:solid #CCCCCC 1.0pt;padding:0cm 0cm 0cm =
6.0pt;margin-left:4.8pt;margin-right:0cm'><p =
class=3DMsoNormal><o:p>&nbsp;</o:p></p></blockquote><blockquote =
style=3D'border:none;border-left:solid #CCCCCC 1.0pt;padding:0cm 0cm 0cm =
6.0pt;margin-left:4.8pt;margin-right:0cm'><p class=3DMsoNormal>&nbsp; =
&nbsp; _If_ all the other protocols worked like WebSocket and =
required<br>&nbsp; &nbsp; authnz before an upgrade could succeed, it =
wouldn't make sense for<br>&nbsp; &nbsp; each upgrade handler to have to =
do the authnz check themselves. But<br>&nbsp; &nbsp; in this case, =
WebSocket is different enough that I think it will<br>&nbsp; &nbsp; =
probably have to.<br><br>No, because we will simply give you two chances =
to accept and trigger<br>the upgrade, once in the post_read_request, =
another in ap_invoke_handler<br>phase before filters are =
inserted.<o:p></o:p></p></blockquote><p class=3DMsoNormal =
style=3D'margin-bottom:12.0pt'><br>Here you make it sound as if I won't =
have to duplicate the authnz checks in the handler phase, but in a =
previous email you said<o:p></o:p></p><blockquote =
style=3D'border:none;border-left:solid #CCCCCC 1.0pt;padding:0cm 0cm 0cm =
6.0pt;margin-left:4.8pt;margin-right:0cm'><p class=3DMsoNormal>websocket =
can ignore the Upgrade: websocket offer after inspecting =
authnz<o:p></o:p></p></blockquote><p class=3DMsoNormal><br>Did I =
misunderstand? I feel like I'm missing something crucial to your =
point.<o:p></o:p></p></blockquote><div><p =
class=3DMsoNormal><o:p>&nbsp;</o:p></p></div><div><p class=3DMsoNormal>I =
propose two chances to catch the upgrade, early and late.&nbsp; You need =
auth,<o:p></o:p></p></div><div><p class=3DMsoNormal>therefore you must =
inspect the late catch, which follows authnz but =
precedes&nbsp;<o:p></o:p></p></div><div><p class=3DMsoNormal>the handler =
invocation.<o:p></o:p></p></div><div><p =
class=3DMsoNormal><o:p>&nbsp;</o:p></p></div><div><p =
class=3DMsoNormal>If a websocket protocol module determines that authnz =
denied websocket<o:p></o:p></p></div><div><p class=3DMsoNormal>but not =
the resource, then it can proceed to the normal http/1 handler =
without<o:p></o:p></p></div><div><p class=3DMsoNormal>responding with a =
101-switching protocols.&nbsp; But if the request meets =
the<o:p></o:p></p></div><div><p class=3DMsoNormal>requirements to be =
handled by the websocket protocol, you reply to =
the<o:p></o:p></p></div><div><p class=3DMsoNormal>Protocol API with an =
'upgrade accepted' and take ownership of the =
request<o:p></o:p></p></div><div><p class=3DMsoNormal>and the =
connection.<o:p></o:p></p></div><div><p =
class=3DMsoNormal>&nbsp;<o:p></o:p></p></div><blockquote =
style=3D'border:none;border-left:solid #CCCCCC 1.0pt;padding:0cm 0cm 0cm =
6.0pt;margin-left:4.8pt;margin-right:0cm'><p class=3DMsoNormal =
style=3D'margin-bottom:12.0pt'>Sounds =
reasonable.<o:p></o:p></p><blockquote =
style=3D'border:none;border-left:solid #CCCCCC 1.0pt;padding:0cm 0cm 0cm =
6.0pt;margin-left:4.8pt;margin-right:0cm'><p class=3DMsoNormal>I'd =
certainly like to see a websocket prototype<br>or outline before we =
declare the protocol baked for the second time =
:)<o:p></o:p></p></blockquote><p class=3DMsoNormal><br>Working on it. :) =
My original experimental hook for 2.4.17 rebased nicely onto 2.4.18, but =
mod_websocket has been refactored significantly since I wrote that and I =
couldn't reuse my work. Sorry I've been slow in actual code-writing; =
I've been under the weather this =
week.<o:p></o:p></p></blockquote><div><p =
class=3DMsoNormal><o:p>&nbsp;</o:p></p></div><div><p =
class=3DMsoNormal>No worries, 2.4.18 is an incremental set of =
improvements, and 2.4.19<o:p></o:p></p></div><div><p =
class=3DMsoNormal>will be moreso, but not in the next week =
:)&nbsp;<o:p></o:p></p></div></div><p =
class=3DMsoNormal><o:p>&nbsp;</o:p></p></div></div></div></div></body></h=
tml>
------=_NextPart_000_D276_01D13340.49FF0BB0--


From dev-return-85029-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Thu Dec 10 10:46:46 2015
Return-Path: <dev-return-85029-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id A04F918CFE
	for <apmail-httpd-dev-archive@www.apache.org>; Thu, 10 Dec 2015 10:46:46 +0000 (UTC)
Received: (qmail 13793 invoked by uid 500); 10 Dec 2015 10:46:46 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 13726 invoked by uid 500); 10 Dec 2015 10:46:46 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 13716 invoked by uid 99); 10 Dec 2015 10:46:46 -0000
Received: from Unknown (HELO spamd3-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 10 Dec 2015 10:46:46 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd3-us-west.apache.org (ASF Mail Server at spamd3-us-west.apache.org) with ESMTP id AC7CF180A38
	for <dev@httpd.apache.org>; Thu, 10 Dec 2015 10:46:45 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd3-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.655
X-Spam-Level:
X-Spam-Status: No, score=-0.655 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RP_MATCHES_RCVD=-0.554, SPF_PASS=-0.001] autolearn=disabled
Authentication-Results: spamd3-us-west.apache.org (amavisd-new);
	dkim=pass (1024-bit key) header.d=greenbytes.de
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd3-us-west.apache.org [10.40.0.10]) (amavisd-new, port 10024)
	with ESMTP id 5HBE7SS8xBJg for <dev@httpd.apache.org>;
	Thu, 10 Dec 2015 10:46:44 +0000 (UTC)
Received: from mail.greenbytes.de (mail.greenbytes.de [217.91.35.233])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id 2398824E9F
	for <dev@httpd.apache.org>; Thu, 10 Dec 2015 10:46:44 +0000 (UTC)
Received: from [192.168.1.42] (unknown [217.91.35.233])
	(using TLSv1 with cipher ECDHE-RSA-AES256-SHA (256/256 bits))
	(Client did not present a certificate)
	by mail.greenbytes.de (Postfix) with ESMTPSA id B9F2F15A044E
	for <dev@httpd.apache.org>; Thu, 10 Dec 2015 11:46:43 +0100 (CET)
DKIM-Signature: v=1; a=rsa-sha256; c=simple/simple; d=greenbytes.de; s=mail;
	t=1449744403; bh=lJbHDkgpoXn7kYy0VXRJpg7AfyI0cPHbAlAz3aXoux8=;
	h=Subject:From:In-Reply-To:Date:References:To:From;
	b=ASRfe2co7Nxvwv3697tKo09ITL/d1avLkURY/1lm9xGd//qfu9qKU2IIRUJ2olXJE
	 9jQ3x63bp23jMfv/T8jDLaIe6Brjsm+yABpQhaAbjTzGNGd8CgNcMtinm2eOmMjsSf
	 coL8FNGzjcBA7dTxZAIKnq4IKPFnYTaJkcd8ZWv4=
Content-Type: text/plain; charset=us-ascii
Mime-Version: 1.0 (Mac OS X Mail 9.2 \(3112\))
Subject: Re: Upgrade Summary
From: Stefan Eissing <stefan.eissing@greenbytes.de>
In-Reply-To: <CACsi252HOz3_BO6hJtRTfM=M6oB0ZUXpSvkPmKs8LWP3LCz8xA@mail.gmail.com>
Date: Thu, 10 Dec 2015 11:46:43 +0100
Content-Transfer-Encoding: quoted-printable
Message-Id: <EC8AA057-325B-4176-88A8-D9E5073C7F32@greenbytes.de>
References: <CACsi250=dbRQKnsbE8JSdAZRm5x99gE0sgX3iQ-PHAx77euD1A@mail.gmail.com> <AB1691BE05AE7F4992697F2A0835627AC63BAB94@VOEXM10W.internal.vodafone.com> <F7B20D30-D34A-4805-A77D-F64F6428F6E3@greenbytes.de> <56660896.c74fc20a.15f56.0ebd@mx.google.com> <56660B43.2060507@gmail.com> <6B13DF2B-0586-42BB-B62F-59A7638B697D@greenbytes.de> <13FE9E7F-9620-4BF9-8EA4-57A6314D66BF@greenbytes.de> <9CCEFD7E-9ED3-4ED1-8F58-2134DD5310F9@gbiv.com> <CACsi252y7nX0kR9+JgSra7Q_5_LVqaR3z6ExPKg=Lhi8zhN4ew@mail.gmail.com> <566887B5.2080705@gmail.com> <CACsi253sTRbX2dnuq0yRP1sHb8vOos_9QaoYmA3TtYmnNx-Erg@mail.gmail.com> <5668CC4F.109@gmail.com> <CACsi253q+GanuRzOqBjaOe-h1w8uOcH6uFAcdres=+ig5q6+VA@mail.gmail.com> <5668EFDB.1050900@gmail.com> <CACsi252HOz3_BO6hJtRTfM=M6oB0ZUXpSvkPmKs8LWP3LCz8xA@mail.gmail.com>
To: dev@httpd.apache.org
X-Mailer: Apple Mail (2.3112)

Given all the input on this thread, I arrive at the following pseudo =
code:

1. Post Read Request Hook:
  =20
	if (Upgrade: request header present) {
		collect protocol proposals;
		ps =3D protocol with highest preference from proposals;
	        if (ps && ps !=3D current) {
			status =3D switch protocol(phase =3D> =
post_read);
			if (status =3D=3D APR_EOF) {
				close connection;
			}
			else if (status =3D=3D APR_EAGAIN) {
				// protocol switch wants to be called =
later before handler
				if (request is "OPTIONS *") {
					// TODO: invoke again with =
(phase =3D> handler)?
				}
				request->upgrade_protocol =3D ps;
			}
			else {
				// continue, HTTP/1 processing. May =
happen on TLS Upgrade
				// or if the protocol managed to switch =
back to HTTP/1
				// process other stati than APR_SUCCESS =
as usual
			}
		}
        	else if ("http/1.1" not in Protocols) {
			answer "505 Not Supported";
		}
	}
	else if ("http/1.1" not in Protocols) {
		answer "426 Upgrade Required";
	}

2. Handler Hook (First or just before):

	if (r->upgrade_protocol) {
		status =3D switch protocol(phase =3D> handler);
		if (status =3D=3D APR_EOF) {
			close connection;
		}
		else {
			// continue, HTTP/1 processing. May happen on =
TLS Upgrade
			// or if the protocol managed to switch back to =
HTTP/1
			// process other stati than APR_SUCCESS as usual
		}
	}

3. Common protocol switch hook behavior:

	apr_status_t process_body(apr_bucket_brigade *bb, void *ctx)
	{
		// brigade contains unchunked body data of request
		// may be called several times. EOS bucket in brigade
		// indicates end of body.
		// If request has no body, will be called once with EOS =
bucket.
	}

	int xxx_switch(conn_rec *c, request_rec *r, server_rec *s,=20
		const char *protocol, int phase)
	{
		apr_status_t stats;

		if (strcmp(my_protocol, protocol)) {
			return DECLINED;
		}
	=09
		if (need_handler && phase !=3D handler) {
			return APR_EAGAIN;
		}

		status =3D ap_upgrade_request(r, protocol, phase, =
my_additional_header, process_body);
		if (status !=3D APR_SUCCESS) {
			// any type of error, could also fail if NULL is =
passed instead of
			// &process_body and request has body
			return status;
		}

		// c->output_filters can be written
		// c->input_filters can be read, will pass data to =
process_body() until body is done,
		// then return data up the filter chain.
		process protocol;

		return APR_EOF;
	}


From dev-return-85030-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Thu Dec 10 11:18:15 2015
Return-Path: <dev-return-85030-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 2D8FC18E46
	for <apmail-httpd-dev-archive@www.apache.org>; Thu, 10 Dec 2015 11:18:15 +0000 (UTC)
Received: (qmail 97039 invoked by uid 500); 10 Dec 2015 11:18:14 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 96977 invoked by uid 500); 10 Dec 2015 11:18:14 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 96967 invoked by uid 99); 10 Dec 2015 11:18:14 -0000
Received: from Unknown (HELO spamd1-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 10 Dec 2015 11:18:14 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd1-us-west.apache.org (ASF Mail Server at spamd1-us-west.apache.org) with ESMTP id 19A16CA167
	for <dev@httpd.apache.org>; Thu, 10 Dec 2015 11:18:14 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd1-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.111
X-Spam-Level:
X-Spam-Status: No, score=-0.111 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	SPF_PASS=-0.001, T_RP_MATCHES_RCVD=-0.01] autolearn=disabled
Authentication-Results: spamd1-us-west.apache.org (amavisd-new);
	dkim=pass (1024-bit key) header.d=greenbytes.de
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd1-us-west.apache.org [10.40.0.7]) (amavisd-new, port 10024)
	with ESMTP id LT8dkWcIa3aB for <dev@httpd.apache.org>;
	Thu, 10 Dec 2015 11:18:13 +0000 (UTC)
Received: from mail.greenbytes.de (mail.greenbytes.de [217.91.35.233])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id F1364429C4
	for <dev@httpd.apache.org>; Thu, 10 Dec 2015 11:18:12 +0000 (UTC)
Received: from [192.168.1.42] (unknown [217.91.35.233])
	(using TLSv1 with cipher ECDHE-RSA-AES256-SHA (256/256 bits))
	(Client did not present a certificate)
	by mail.greenbytes.de (Postfix) with ESMTPSA id E33AC15A0330
	for <dev@httpd.apache.org>; Thu, 10 Dec 2015 12:18:04 +0100 (CET)
DKIM-Signature: v=1; a=rsa-sha256; c=simple/simple; d=greenbytes.de; s=mail;
	t=1449746284; bh=82QfR6igky4YGdWO/y22OM5X461v0osDnSv5Xauuw+I=;
	h=Subject:From:In-Reply-To:Date:References:To:From;
	b=P6yDsmg2J8uUveAgTL10sQvdWi3ZtTaLYbAnIzIDTcre1Gte8lbz7PexBOKNlWzKi
	 fvHFrigyuPjQcVYBkCQasTmEcjaEsbOGv4oHnnF7052y7gv6oH+m5NaRZnFNWaU5BW
	 UD52GeptNulps+DmLgHGVeoGBNHliUcxAtLrxV+4=
Content-Type: text/plain; charset=us-ascii
Mime-Version: 1.0 (Mac OS X Mail 9.2 \(3112\))
Subject: Re: [VOTE] Release Apache httpd 2.4.18 as GA
From: Stefan Eissing <stefan.eissing@greenbytes.de>
In-Reply-To: <AD9BFA0F-C508-4DFE-8B4F-FF79D46D9D91@jaguNET.com>
Date: Thu, 10 Dec 2015 12:18:04 +0100
Content-Transfer-Encoding: 7bit
Message-Id: <4B292267-A03E-4E51-990C-E726DF2526FA@greenbytes.de>
References: <AD9BFA0F-C508-4DFE-8B4F-FF79D46D9D91@jaguNET.com>
To: dev@httpd.apache.org
X-Mailer: Apple Mail (2.3112)

+1: 14.04.1-Ubuntu SMP, gcc 4.8.4
worker, event, prefork


From dev-return-85031-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Thu Dec 10 11:25:37 2015
Return-Path: <dev-return-85031-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 9DAA018EAF
	for <apmail-httpd-dev-archive@www.apache.org>; Thu, 10 Dec 2015 11:25:37 +0000 (UTC)
Received: (qmail 24716 invoked by uid 500); 10 Dec 2015 11:25:37 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 24643 invoked by uid 500); 10 Dec 2015 11:25:37 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 24633 invoked by uid 99); 10 Dec 2015 11:25:37 -0000
Received: from Unknown (HELO spamd4-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 10 Dec 2015 11:25:37 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd4-us-west.apache.org (ASF Mail Server at spamd4-us-west.apache.org) with ESMTP id 8EB8CC0179
	for <dev@httpd.apache.org>; Thu, 10 Dec 2015 11:25:36 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd4-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.12
X-Spam-Level:
X-Spam-Status: No, score=-0.12 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RCVD_IN_MSPIKE_H3=-0.01, RCVD_IN_MSPIKE_WL=-0.01] autolearn=disabled
Authentication-Results: spamd4-us-west.apache.org (amavisd-new);
	dkim=pass (1024-bit key) header.d=qqmail.nl
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd4-us-west.apache.org [10.40.0.11]) (amavisd-new, port 10024)
	with ESMTP id OF5hD4KYZpWR for <dev@httpd.apache.org>;
	Thu, 10 Dec 2015 11:25:31 +0000 (UTC)
Received: from mail-wm0-f48.google.com (mail-wm0-f48.google.com [74.125.82.48])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id 5616E2026F
	for <dev@httpd.apache.org>; Thu, 10 Dec 2015 11:25:31 +0000 (UTC)
Received: by wmec201 with SMTP id c201so20304648wme.1
        for <dev@httpd.apache.org>; Thu, 10 Dec 2015 03:25:31 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=qqmail.nl; s=google;
        h=from:to:references:in-reply-to:subject:date:message-id:mime-version
         :content-type:content-transfer-encoding:thread-index
         :content-language;
        bh=DTIqis13rsfzR3tfi4KaoZ0uz4aulILUhRjjQYVrxEo=;
        b=Sv+lsZ7EhKsWYVm450mMMHc+jb3zbSjOe4Nwfw9/9A54/GomlV1VlXp3JgS/c6f9JT
         DW+JLneO+Oty+ZQxdqkJYQGvEXK9vvQ2K4aYEAdLLiTi2xMPnMCPB7qmBVwiwWWmbyZu
         5FQwABQVcUfAIRsjH/E2AkPXjt0ryDPyWMBoo=
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=1e100.net; s=20130820;
        h=x-gm-message-state:from:to:references:in-reply-to:subject:date
         :message-id:mime-version:content-type:content-transfer-encoding
         :thread-index:content-language;
        bh=DTIqis13rsfzR3tfi4KaoZ0uz4aulILUhRjjQYVrxEo=;
        b=T+HnkS706b7xgO4nKqhaqMexYyarOZmyl0TKWJ9JJp06qeGJjmLXm2rl+lDfX85bp8
         Wy7flUV7bMRszgGx1aDR2EKcfHyPAj5zA4q6+gpcIoHj0elyIAYOA6u+hg10gi+RdVxI
         XIYFZBmG78PenKzv3cZ5aVrsCzCp5zQ4JaMMYo8tidbC/qNUtOvVJSwU456nQgqxTYMZ
         r+6t2rU/wE+LalEPACyOQygMDfjE5JlUiTlCGyKKWZ2+gWTkPmMumHLy3vJ/BvdByvjQ
         XYFYIFgM7wAD1SKjlT/8UgfuVQPqgZpqDpXMvdbcLtvi98PcDfGjVB9Dv0GbiurDwaW0
         8IiA==
X-Gm-Message-State: ALoCoQmM2hTV84JSir5Wreli+VAAue1CRuMBe4mCCk/r8YLlKsPXMNnDno6D16svoVEIyv35sPoakbzBKi/4UV6f5eulKo44mg==
X-Received: by 10.194.52.3 with SMTP id p3mr13798431wjo.2.1449746731063;
        Thu, 10 Dec 2015 03:25:31 -0800 (PST)
Received: from I72600 ([2001:610:66e:0:52e5:49ff:fee1:96b7])
        by smtp.gmail.com with ESMTPSA id t3sm11566377wjz.11.2015.12.10.03.25.30
        for <dev@httpd.apache.org>
        (version=TLS1_2 cipher=ECDHE-RSA-AES128-GCM-SHA256 bits=128/128);
        Thu, 10 Dec 2015 03:25:30 -0800 (PST)
From: "Bert Huijben" <bert@qqmail.nl>
To: <dev@httpd.apache.org>
References: <CACsi250=dbRQKnsbE8JSdAZRm5x99gE0sgX3iQ-PHAx77euD1A@mail.gmail.com> <AB1691BE05AE7F4992697F2A0835627AC63BAB94@VOEXM10W.internal.vodafone.com> <F7B20D30-D34A-4805-A77D-F64F6428F6E3@greenbytes.de> <56660896.c74fc20a.15f56.0ebd@mx.google.com> <56660B43.2060507@gmail.com> <6B13DF2B-0586-42BB-B62F-59A7638B697D@greenbytes.de> <13FE9E7F-9620-4BF9-8EA4-57A6314D66BF@greenbytes.de> <9CCEFD7E-9ED3-4ED1-8F58-2134DD5310F9@gbiv.com> <CACsi252y7nX0kR9+JgSra7Q_5_LVqaR3z6ExPKg=Lhi8zhN4ew@mail.gmail.com> <566887B5.2080705@gmail.com> <CACsi253sTRbX2dnuq0yRP1sHb8vOos_9QaoYmA3TtYmnNx-Erg@mail.gmail.com> <5668CC4F.109@gmail.com> <CACsi253q+GanuRzOqBjaOe-h1w8uOcH6uFAcdres=+ig5q6+VA@mail.gmail.com> <5668EFDB.1050900@gmail.com> <CACsi252HOz3_BO6hJtRTfM=M6oB0ZUXpSvkPmKs8LWP3LCz8xA@mail.gmail.com> <EC8AA057-325B-4176-88A8-D9E5073C7F32@greenbytes.de>
In-Reply-To: <EC8AA057-325B-4176-88A8-D9E5073C7F32@greenbytes.de>
Subject: RE: Upgrade Summary
Date: Thu, 10 Dec 2015 12:25:22 +0100
Message-ID: <d29e01d1333d$76c2e200$6448a600$@qqmail.nl>
MIME-Version: 1.0
Content-Type: text/plain;
	charset="us-ascii"
Content-Transfer-Encoding: 7bit
X-Mailer: Microsoft Outlook 16.0
Thread-Index: AQKiK5k53Zwc1sqI7zswkQpwqyBJZQHPPeQLAlYfy+wBw01DvAJJXKo0Ai3vbIwBtCRQOwEDPPgvAno6FMYC0LSzywJNCLE3Aj1Jd00ByA6t6QGH0D6QAVTGCOUBW1I3zZw6vl4w
Content-Language: nl



> -----Original Message-----
> From: Stefan Eissing [mailto:stefan.eissing@greenbytes.de]
> Sent: donderdag 10 december 2015 11:47
> To: dev@httpd.apache.org
> Subject: Re: Upgrade Summary
> 
> Given all the input on this thread, I arrive at the following pseudo code:
> 
> 1. Post Read Request Hook:
> 
> 	if (Upgrade: request header present) {
> 		collect protocol proposals;
> 		ps = protocol with highest preference from proposals;
> 	        if (ps && ps != current) {
> 			status = switch protocol(phase => post_read);
> 			if (status == APR_EOF) {
> 				close connection;
> 			}
> 			else if (status == APR_EAGAIN) {
> 				// protocol switch wants to be called later
> before handler
> 				if (request is "OPTIONS *") {
> 					// TODO: invoke again with (phase =>
> handler)?

Why handle 'OPTIONS *' different here?

Isn't that 'just another simple HTTP/1.1 request'?


>From what I read about that request, it is a recommended easy request if you
don't have anything to send yourself in this stage. (With "HEAD /" as
alternative).

If not required I would recommend not hardcoding specific behavior on this
request. There is not much that makes it that different from "GET /" or
"HEAD /", or every other request that doesn't have a request body.

	Bert


From dev-return-85032-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Thu Dec 10 13:57:52 2015
Return-Path: <dev-return-85032-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 6E88E183EB
	for <apmail-httpd-dev-archive@www.apache.org>; Thu, 10 Dec 2015 13:57:52 +0000 (UTC)
Received: (qmail 23249 invoked by uid 500); 10 Dec 2015 13:57:52 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 23171 invoked by uid 500); 10 Dec 2015 13:57:52 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 23161 invoked by uid 99); 10 Dec 2015 13:57:52 -0000
Received: from Unknown (HELO spamd4-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 10 Dec 2015 13:57:52 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd4-us-west.apache.org (ASF Mail Server at spamd4-us-west.apache.org) with ESMTP id 73CF1C0179
	for <dev@httpd.apache.org>; Thu, 10 Dec 2015 13:57:51 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd4-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.556
X-Spam-Level:
X-Spam-Status: No, score=-0.556 tagged_above=-999 required=6.31
	tests=[RCVD_IN_MSPIKE_H2=-0.001, RP_MATCHES_RCVD=-0.554,
	SPF_PASS=-0.001] autolearn=disabled
Received: from mx1-us-west.apache.org ([10.40.0.8])
	by localhost (spamd4-us-west.apache.org [10.40.0.11]) (amavisd-new, port 10024)
	with ESMTP id hzrtmKNfiN8j for <dev@httpd.apache.org>;
	Thu, 10 Dec 2015 13:57:42 +0000 (UTC)
Received: from userp1040.oracle.com (userp1040.oracle.com [156.151.31.81])
	by mx1-us-west.apache.org (ASF Mail Server at mx1-us-west.apache.org) with ESMTPS id 6DCCF265D8
	for <dev@httpd.apache.org>; Thu, 10 Dec 2015 13:57:42 +0000 (UTC)
Received: from aserv0021.oracle.com (aserv0021.oracle.com [141.146.126.233])
	by userp1040.oracle.com (Sentrion-MTA-4.3.2/Sentrion-MTA-4.3.2) with ESMTP id tBADvZKj013737
	(version=TLSv1 cipher=DHE-RSA-AES256-SHA bits=256 verify=OK)
	for <dev@httpd.apache.org>; Thu, 10 Dec 2015 13:57:35 GMT
Received: from userv0121.oracle.com (userv0121.oracle.com [156.151.31.72])
	by aserv0021.oracle.com (8.13.8/8.13.8) with ESMTP id tBADvY0v032409
	(version=TLSv1/SSLv3 cipher=DHE-RSA-AES256-SHA bits=256 verify=FAIL)
	for <dev@httpd.apache.org>; Thu, 10 Dec 2015 13:57:35 GMT
Received: from abhmp0012.oracle.com (abhmp0012.oracle.com [141.146.116.18])
	by userv0121.oracle.com (8.13.8/8.13.8) with ESMTP id tBADvXmr003450
	for <dev@httpd.apache.org>; Thu, 10 Dec 2015 13:57:34 GMT
Received: from [10.132.185.154] (/10.132.185.154)
	by default (Oracle Beehive Gateway v4.0)
	with ESMTP ; Thu, 10 Dec 2015 05:57:33 -0800
Subject: Re: Upgrade Summary
To: dev@httpd.apache.org
References: <CACsi250=dbRQKnsbE8JSdAZRm5x99gE0sgX3iQ-PHAx77euD1A@mail.gmail.com>
 <AB1691BE05AE7F4992697F2A0835627AC63BAB94@VOEXM10W.internal.vodafone.com>
 <F7B20D30-D34A-4805-A77D-F64F6428F6E3@greenbytes.de>
 <56660896.c74fc20a.15f56.0ebd@mx.google.com> <56660B43.2060507@gmail.com>
 <6B13DF2B-0586-42BB-B62F-59A7638B697D@greenbytes.de>
 <13FE9E7F-9620-4BF9-8EA4-57A6314D66BF@greenbytes.de>
 <9CCEFD7E-9ED3-4ED1-8F58-2134DD5310F9@gbiv.com>
 <CACsi252y7nX0kR9+JgSra7Q_5_LVqaR3z6ExPKg=Lhi8zhN4ew@mail.gmail.com>
 <566887B5.2080705@gmail.com>
 <CACsi253sTRbX2dnuq0yRP1sHb8vOos_9QaoYmA3TtYmnNx-Erg@mail.gmail.com>
 <5668CC4F.109@gmail.com>
 <CACsi253q+GanuRzOqBjaOe-h1w8uOcH6uFAcdres=+ig5q6+VA@mail.gmail.com>
 <5668EFDB.1050900@gmail.com>
 <CACsi252HOz3_BO6hJtRTfM=M6oB0ZUXpSvkPmKs8LWP3LCz8xA@mail.gmail.com>
 <EC8AA057-325B-4176-88A8-D9E5073C7F32@greenbytes.de>
From: Mike Rumph <mike.rumph@oracle.com>
Organization: Oracle Corporation
Message-ID: <566984C7.5090908@oracle.com>
Date: Thu, 10 Dec 2015 05:57:27 -0800
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:38.0) Gecko/20100101
 Thunderbird/38.4.0
MIME-Version: 1.0
In-Reply-To: <EC8AA057-325B-4176-88A8-D9E5073C7F32@greenbytes.de>
Content-Type: text/plain; charset=windows-1252; format=flowed
Content-Transfer-Encoding: 7bit
X-Source-IP: aserv0021.oracle.com [141.146.126.233]

Question below:

On 12/10/2015 2:46 AM, Stefan Eissing wrote:
> 	int xxx_switch(conn_rec *c, request_rec *r, server_rec *s,
> 		const char *protocol, int phase)
> 	{
> 		apr_status_t stats;
>
> 		if (strcmp(my_protocol, protocol)) {
Do you mean "if my_protocol is protocol"?
> 			return DECLINED;
> 		}
> 		
> 		if (need_handler && phase != handler) {
> 			return APR_EAGAIN;
> 		}
>
> 		status = ap_upgrade_request(r, protocol, phase, my_additional_header, process_body);
> 		if (status != APR_SUCCESS) {
> 			// any type of error, could also fail if NULL is passed instead of
> 			// &process_body and request has body
> 			return status;
> 		}
>
> 		// c->output_filters can be written
> 		// c->input_filters can be read, will pass data to process_body() until body is done,
> 		// then return data up the filter chain.
> 		process protocol;
>
> 		return APR_EOF;
> 	}
>
>


From dev-return-85033-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Thu Dec 10 14:06:25 2015
Return-Path: <dev-return-85033-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id C333518474
	for <apmail-httpd-dev-archive@www.apache.org>; Thu, 10 Dec 2015 14:06:25 +0000 (UTC)
Received: (qmail 40016 invoked by uid 500); 10 Dec 2015 14:06:25 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 39938 invoked by uid 500); 10 Dec 2015 14:06:25 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 39927 invoked by uid 99); 10 Dec 2015 14:06:25 -0000
Received: from Unknown (HELO spamd2-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 10 Dec 2015 14:06:25 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd2-us-west.apache.org (ASF Mail Server at spamd2-us-west.apache.org) with ESMTP id 7A9CF1A5C64
	for <dev@httpd.apache.org>; Thu, 10 Dec 2015 14:06:24 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd2-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.654
X-Spam-Level:
X-Spam-Status: No, score=-0.654 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RP_MATCHES_RCVD=-0.554, SPF_PASS=-0.001, URIBL_BLOCKED=0.001]
	autolearn=disabled
Authentication-Results: spamd2-us-west.apache.org (amavisd-new);
	dkim=pass (1024-bit key) header.d=greenbytes.de
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd2-us-west.apache.org [10.40.0.9]) (amavisd-new, port 10024)
	with ESMTP id cAGREP5Segq1 for <dev@httpd.apache.org>;
	Thu, 10 Dec 2015 14:06:14 +0000 (UTC)
Received: from mail.greenbytes.de (mail.greenbytes.de [217.91.35.233])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id 780ED2064F
	for <dev@httpd.apache.org>; Thu, 10 Dec 2015 14:06:14 +0000 (UTC)
Received: from [192.168.1.42] (unknown [217.91.35.233])
	(using TLSv1 with cipher ECDHE-RSA-AES256-SHA (256/256 bits))
	(Client did not present a certificate)
	by mail.greenbytes.de (Postfix) with ESMTPSA id D62B615A0330
	for <dev@httpd.apache.org>; Thu, 10 Dec 2015 15:06:13 +0100 (CET)
DKIM-Signature: v=1; a=rsa-sha256; c=simple/simple; d=greenbytes.de; s=mail;
	t=1449756373; bh=cReO/eUdo9NwBtMztYoX17JEk3I1tDjOjLP3zW1gm9k=;
	h=Subject:From:In-Reply-To:Date:References:To:From;
	b=m7VblZWP3apJzvLW2DUfzXHnXuINBmjf0RO624mtJuGtPtuzH56yPrRIw4r/Ml6cR
	 sieY6DMAMkl76wfSz69/HWSH0QlLuO97MoZ0o9fR8VUduCahqcfda9m+e8IXaUlzuj
	 bgxbtiNv/gTK4zNqpoKI9zTzJNfzuZqruWTE6LiE=
Content-Type: text/plain; charset=windows-1252
Mime-Version: 1.0 (Mac OS X Mail 9.2 \(3112\))
Subject: Re: Upgrade Summary
From: Stefan Eissing <stefan.eissing@greenbytes.de>
In-Reply-To: <566984C7.5090908@oracle.com>
Date: Thu, 10 Dec 2015 15:06:13 +0100
Content-Transfer-Encoding: quoted-printable
Message-Id: <00D7A5D3-4671-49DA-B710-03A54C8485BF@greenbytes.de>
References: <CACsi250=dbRQKnsbE8JSdAZRm5x99gE0sgX3iQ-PHAx77euD1A@mail.gmail.com> <AB1691BE05AE7F4992697F2A0835627AC63BAB94@VOEXM10W.internal.vodafone.com> <F7B20D30-D34A-4805-A77D-F64F6428F6E3@greenbytes.de> <56660896.c74fc20a.15f56.0ebd@mx.google.com> <56660B43.2060507@gmail.com> <6B13DF2B-0586-42BB-B62F-59A7638B697D@greenbytes.de> <13FE9E7F-9620-4BF9-8EA4-57A6314D66BF@greenbytes.de> <9CCEFD7E-9ED3-4ED1-8F58-2134DD5310F9@gbiv.com> <CACsi252y7nX0kR9+JgSra7Q_5_LVqaR3z6ExPKg=Lhi8zhN4ew@mail.gmail.com> <566887B5.2080705@gmail.com> <CACsi253sTRbX2dnuq0yRP1sHb8vOos_9QaoYmA3TtYmnNx-Erg@mail.gmail.com> <5668CC4F.109@gmail.com> <CACsi253q+GanuRzOqBjaOe-h1w8uOcH6uFAcdres=+ig5q6+VA@mail.gmail.com> <5668EFDB.1050900@gmail.com> <CACsi252HOz3_BO6hJtRTfM=M6oB0ZUXpSvkPmKs8LWP3LCz8xA@mail.gmail.com> <EC8AA057-325B-4176-88A8-D9E5073C7F32@greenbytes.de> <566984C7.5090908@oracle.com>
To: dev@httpd.apache.org
X-Mailer: Apple Mail (2.3112)


> Am 10.12.2015 um 14:57 schrieb Mike Rumph <mike.rumph@oracle.com>:
>=20
> Question below:
>=20
> On 12/10/2015 2:46 AM, Stefan Eissing wrote:
>> 	int xxx_switch(conn_rec *c, request_rec *r, server_rec *s,
>> 		const char *protocol, int phase)
>> 	{
>> 		apr_status_t stats;
>>=20
>> 		if (strcmp(my_protocol, protocol)) {
> Do you mean "if my_protocol is protocol"?

If the protocol to switch to is not mine, DECLINE.

Should have written that in prose...

>> 			return DECLINED;
>> 		}
>> 	=09
>> 		if (need_handler && phase !=3D handler) {
>> 			return APR_EAGAIN;
>> 		}
>>=20
>> 		status =3D ap_upgrade_request(r, protocol, phase, =
my_additional_header, process_body);
>> 		if (status !=3D APR_SUCCESS) {
>> 			// any type of error, could also fail if NULL is =
passed instead of
>> 			// &process_body and request has body
>> 			return status;
>> 		}
>>=20
>> 		// c->output_filters can be written
>> 		// c->input_filters can be read, will pass data to =
process_body() until body is done,
>> 		// then return data up the filter chain.
>> 		process protocol;
>>=20
>> 		return APR_EOF;
>> 	}
>>=20
>>=20
>=20


From dev-return-85034-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Thu Dec 10 21:41:48 2015
Return-Path: <dev-return-85034-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 255A118F73
	for <apmail-httpd-dev-archive@www.apache.org>; Thu, 10 Dec 2015 21:41:48 +0000 (UTC)
Received: (qmail 52804 invoked by uid 500); 10 Dec 2015 21:41:47 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 52732 invoked by uid 500); 10 Dec 2015 21:41:47 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 52722 invoked by uid 99); 10 Dec 2015 21:41:47 -0000
Received: from Unknown (HELO spamd4-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 10 Dec 2015 21:41:47 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd4-us-west.apache.org (ASF Mail Server at spamd4-us-west.apache.org) with ESMTP id 9F8AAC08BA
	for <dev@httpd.apache.org>; Thu, 10 Dec 2015 21:41:46 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd4-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.102
X-Spam-Level:
X-Spam-Status: No, score=-0.102 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RCVD_IN_MSPIKE_H2=-0.001, SPF_PASS=-0.001] autolearn=disabled
Authentication-Results: spamd4-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-us-west.apache.org ([10.40.0.8])
	by localhost (spamd4-us-west.apache.org [10.40.0.11]) (amavisd-new, port 10024)
	with ESMTP id ipzE6Jqyt0aj for <dev@httpd.apache.org>;
	Thu, 10 Dec 2015 21:41:46 +0000 (UTC)
Received: from mail-pa0-f48.google.com (mail-pa0-f48.google.com [209.85.220.48])
	by mx1-us-west.apache.org (ASF Mail Server at mx1-us-west.apache.org) with ESMTPS id E7B36265EC
	for <dev@httpd.apache.org>; Thu, 10 Dec 2015 21:41:45 +0000 (UTC)
Received: by pabur14 with SMTP id ur14so53762477pab.0
        for <dev@httpd.apache.org>; Thu, 10 Dec 2015 13:41:39 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=subject:to:references:from:message-id:date:user-agent:mime-version
         :in-reply-to:content-type:content-transfer-encoding;
        bh=Gai/3dkxK5vtnK9MoQftFTfbLE2h7WOQtgvZoJotkRE=;
        b=B0Iy2pMWkxXkdh1RN0kTG5Tq0s7w929zb2VI0PTqE+4MksjhLRZVvdZ5GgnInAmnP7
         GktfbLr8qVdgyy+tGFrFVPXb/O9DX8NZWGEY5fPFm6eRbIYClKXuY8piI0hLqvnRIySU
         p8erAzCNpau+KRFQKDNsAAE9c9eRhq5yYYk12pQNe2PwyaCewC9zQuV8fB7IyvkZgQqZ
         +ndOMd1Z05z/39uvIxGzC0ORfGSWo8XhPpD1BixUP8WKxokPph7hnjvuLssIViyt4Z5o
         rcmiATLn8O3QH3WWcI4PuAUmmPcZDEVTKNB0TvG2m8V5r1FK2f79AYu1AuMFWSzJnkl/
         L/Hw==
X-Received: by 10.66.138.101 with SMTP id qp5mr19900026pab.113.1449783699030;
        Thu, 10 Dec 2015 13:41:39 -0800 (PST)
Received: from [192.168.1.4] (50-39-117-165.bvtn.or.frontiernet.net. [50.39.117.165])
        by smtp.gmail.com with ESMTPSA id q23sm20466064pfi.34.2015.12.10.13.41.37
        for <dev@httpd.apache.org>
        (version=TLSv1/SSLv3 cipher=OTHER);
        Thu, 10 Dec 2015 13:41:38 -0800 (PST)
Subject: Re: Upgrade Summary
To: dev@httpd.apache.org
References: <CACsi250=dbRQKnsbE8JSdAZRm5x99gE0sgX3iQ-PHAx77euD1A@mail.gmail.com>
 <AB1691BE05AE7F4992697F2A0835627AC63BAB94@VOEXM10W.internal.vodafone.com>
 <F7B20D30-D34A-4805-A77D-F64F6428F6E3@greenbytes.de>
 <56660896.c74fc20a.15f56.0ebd@mx.google.com> <56660B43.2060507@gmail.com>
 <6B13DF2B-0586-42BB-B62F-59A7638B697D@greenbytes.de>
 <13FE9E7F-9620-4BF9-8EA4-57A6314D66BF@greenbytes.de>
 <9CCEFD7E-9ED3-4ED1-8F58-2134DD5310F9@gbiv.com>
 <CACsi252y7nX0kR9+JgSra7Q_5_LVqaR3z6ExPKg=Lhi8zhN4ew@mail.gmail.com>
 <566887B5.2080705@gmail.com>
 <CACsi253sTRbX2dnuq0yRP1sHb8vOos_9QaoYmA3TtYmnNx-Erg@mail.gmail.com>
 <5668CC4F.109@gmail.com>
 <CACsi253q+GanuRzOqBjaOe-h1w8uOcH6uFAcdres=+ig5q6+VA@mail.gmail.com>
 <5668EFDB.1050900@gmail.com>
 <CACsi252HOz3_BO6hJtRTfM=M6oB0ZUXpSvkPmKs8LWP3LCz8xA@mail.gmail.com>
 <d27501d13337$e83832b0$b8a89810$@qqmail.nl>
From: Jacob Champion <champion.p@gmail.com>
Message-ID: <5669F191.5060800@gmail.com>
Date: Thu, 10 Dec 2015 13:41:37 -0800
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:38.0) Gecko/20100101
 Thunderbird/38.4.0
MIME-Version: 1.0
In-Reply-To: <d27501d13337$e83832b0$b8a89810$@qqmail.nl>
Content-Type: text/plain; charset=utf-8; format=flowed
Content-Transfer-Encoding: 8bit

On 12/10/2015 02:45 AM, Bert Huijben wrote:
> Websockets are different and in some ways not really an upgrade of the
> connection more like a hostile takeover with a final operation to a target

Ha! Yes -- although from the point of view of HTTP/1.1, all successful 
upgrades are hostile takeovers, no? But a failure to upgrade is more of 
a problem for a WebSocket client than a pure-HTTP client.

> More like a CONNECT request to a proxy

Heh, interesting that you mention that. Proxy and cache behavior is, 
IIRC, the motivation for many of the strange-looking design decisions in 
the WebSocket protocol...

--Jacob

From dev-return-85035-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Thu Dec 10 22:18:30 2015
Return-Path: <dev-return-85035-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 354511810E
	for <apmail-httpd-dev-archive@www.apache.org>; Thu, 10 Dec 2015 22:18:30 +0000 (UTC)
Received: (qmail 26518 invoked by uid 500); 10 Dec 2015 22:18:29 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 26444 invoked by uid 500); 10 Dec 2015 22:18:29 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 26434 invoked by uid 99); 10 Dec 2015 22:18:29 -0000
Received: from Unknown (HELO spamd2-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Thu, 10 Dec 2015 22:18:29 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd2-us-west.apache.org (ASF Mail Server at spamd2-us-west.apache.org) with ESMTP id C72AF1A0745
	for <dev@httpd.apache.org>; Thu, 10 Dec 2015 22:18:28 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd2-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.101
X-Spam-Level:
X-Spam-Status: No, score=-0.101 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RCVD_IN_MSPIKE_H2=-0.001, SPF_PASS=-0.001, URIBL_BLOCKED=0.001]
	autolearn=disabled
Authentication-Results: spamd2-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd2-us-west.apache.org [10.40.0.9]) (amavisd-new, port 10024)
	with ESMTP id 3Lz_4TYaY0uA for <dev@httpd.apache.org>;
	Thu, 10 Dec 2015 22:18:23 +0000 (UTC)
Received: from mail-pf0-f182.google.com (mail-pf0-f182.google.com [209.85.192.182])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id B05A5429CC
	for <dev@httpd.apache.org>; Thu, 10 Dec 2015 22:18:22 +0000 (UTC)
Received: by pfv76 with SMTP id 76so1928112pfv.2
        for <dev@httpd.apache.org>; Thu, 10 Dec 2015 14:18:15 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=subject:to:references:from:message-id:date:user-agent:mime-version
         :in-reply-to:content-type:content-transfer-encoding;
        bh=Scpz23plqP9ufD/S8mnzBipFrEsSghbk8cKiSMUjtLE=;
        b=ytFV+CHh3B4wLpE/ovSxPfBRyLqjXmnqTplYMIqZ+SPs40oe6D3oCgtZrz60LFQ9nK
         yggZE+0p0OT5r2gDRLM6E8s4rseg41SPMHrca0x43MWLhtU37BEnn1HLMpTkXWk/+xWD
         KIBZWMVhvpjRu77pRC7Cw07ck6Pne/7csY0Fdo+wbY+ImkheDQN0RfmZAQoJHk/jpRSe
         utpxRh2lmCv1Jd+A7zdSkJj9RTwL9ogOY+ewhc3Xnr3wnxhBdcWdMQFBIO2D4k4kPdiG
         tA3kJtecpPVi+dDMe8zAAgMHoNDRaGEInPvwS5VI1UFCMvOXKzMJ25j4Q9/p56hn96v/
         MFTA==
X-Received: by 10.98.13.195 with SMTP id 64mr10619805pfn.147.1449785895666;
        Thu, 10 Dec 2015 14:18:15 -0800 (PST)
Received: from [192.168.1.4] (50-39-117-165.bvtn.or.frontiernet.net. [50.39.117.165])
        by smtp.gmail.com with ESMTPSA id 79sm20533874pfb.67.2015.12.10.14.18.14
        for <dev@httpd.apache.org>
        (version=TLSv1/SSLv3 cipher=OTHER);
        Thu, 10 Dec 2015 14:18:14 -0800 (PST)
Subject: Re: Upgrade Summary
To: dev@httpd.apache.org
References: <CACsi250=dbRQKnsbE8JSdAZRm5x99gE0sgX3iQ-PHAx77euD1A@mail.gmail.com>
 <AB1691BE05AE7F4992697F2A0835627AC63BAB94@VOEXM10W.internal.vodafone.com>
 <F7B20D30-D34A-4805-A77D-F64F6428F6E3@greenbytes.de>
 <56660896.c74fc20a.15f56.0ebd@mx.google.com> <56660B43.2060507@gmail.com>
 <6B13DF2B-0586-42BB-B62F-59A7638B697D@greenbytes.de>
 <13FE9E7F-9620-4BF9-8EA4-57A6314D66BF@greenbytes.de>
 <9CCEFD7E-9ED3-4ED1-8F58-2134DD5310F9@gbiv.com>
 <CACsi252y7nX0kR9+JgSra7Q_5_LVqaR3z6ExPKg=Lhi8zhN4ew@mail.gmail.com>
 <566887B5.2080705@gmail.com>
 <CACsi253sTRbX2dnuq0yRP1sHb8vOos_9QaoYmA3TtYmnNx-Erg@mail.gmail.com>
 <5668CC4F.109@gmail.com>
 <CACsi253q+GanuRzOqBjaOe-h1w8uOcH6uFAcdres=+ig5q6+VA@mail.gmail.com>
 <5668EFDB.1050900@gmail.com>
 <CACsi252HOz3_BO6hJtRTfM=M6oB0ZUXpSvkPmKs8LWP3LCz8xA@mail.gmail.com>
From: Jacob Champion <champion.p@gmail.com>
Message-ID: <5669FA25.3020100@gmail.com>
Date: Thu, 10 Dec 2015 14:18:13 -0800
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:38.0) Gecko/20100101
 Thunderbird/38.4.0
MIME-Version: 1.0
In-Reply-To: <CACsi252HOz3_BO6hJtRTfM=M6oB0ZUXpSvkPmKs8LWP3LCz8xA@mail.gmail.com>
Content-Type: text/plain; charset=utf-8; format=flowed
Content-Transfer-Encoding: 7bit

Okay, I finally have actual code to share. This is the original 
experimental pre_protocol_switch hook that Stefan and I were talking 
about a while ago [1], rebased onto 2.4.18. The two patches are available at

     https://github.com/jchampio/httpd/commits/dev/websocket-protocols

It is *not* an implementation of Stefan's most recent pseudocode (a 
primary difference is that his proposal does the filter + upgrade in one 
hook instead of two), and it doesn't solve many of the use cases that 
you've already agreed must be handled:

- 100-continue is not handled correctly
- the incoming request body is not correctly dealt with
- there is only one switch point, at the handler stage
- etc.

*But* it is a working implementation from mod_websocket's point of view, 
so I offer it up primarily for informational purposes. The module making 
use of the new hook is available at

 
https://github.com/jchampio/apache-websocket/blob/dev/hook/mod_websocket.c

You might be most interested in the mod_websocket_pre_protocol_switch() 
implementation (line 1627), which contains the pre-upgrade checks I need 
to do to remain compliant with RFC 6455.

== Asides ==

1) The current Protocols API does not correctly ignore upgrades from 
HTTP/1.0 requests; the latest commit to my experimental branch patched this.

2) As Stefan and I discussed in [1], Upgrade header values are 
case-sensitive (correct?), but the RFC 6455 declares that servers should 
respond to any protocol that's a case-insensitive match for "websocket". 
To make matters worse, the official IANA upgrade token is "WebSocket", 
but the RFC uses "websocket" throughout. I have seen both used in the 
wild (Autobahn uses WebSocket; Firefox uses websocket), and I'm not sure 
what the right way to resolve this is.

Hope this helps. Again, I don't expect this to actually be part of the 
final solution, but sometimes it's nice to see code.

--Jacob

[1] 
https://mail-archives.apache.org/mod_mbox/httpd-dev/201509.mbox/%3C55FF85F0.8040106@gmail.com%3E

From dev-return-85036-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Fri Dec 11 01:22:50 2015
Return-Path: <dev-return-85036-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id DAB541888D
	for <apmail-httpd-dev-archive@www.apache.org>; Fri, 11 Dec 2015 01:22:50 +0000 (UTC)
Received: (qmail 42209 invoked by uid 500); 11 Dec 2015 01:22:50 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 42149 invoked by uid 500); 11 Dec 2015 01:22:50 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 42139 invoked by uid 99); 11 Dec 2015 01:22:50 -0000
Received: from Unknown (HELO spamd1-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 11 Dec 2015 01:22:50 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd1-us-west.apache.org (ASF Mail Server at spamd1-us-west.apache.org) with ESMTP id F3F7ACBD8C
	for <dev@httpd.apache.org>; Fri, 11 Dec 2015 01:22:49 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd1-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.099
X-Spam-Level:
X-Spam-Status: No, score=-0.099 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	URIBL_BLOCKED=0.001] autolearn=disabled
Authentication-Results: spamd1-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd1-us-west.apache.org [10.40.0.7]) (amavisd-new, port 10024)
	with ESMTP id 1SAkrp2Mqplf for <dev@httpd.apache.org>;
	Fri, 11 Dec 2015 01:22:36 +0000 (UTC)
Received: from mail-qg0-f47.google.com (mail-qg0-f47.google.com [209.85.192.47])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id 44AD420C70
	for <dev@httpd.apache.org>; Fri, 11 Dec 2015 01:22:35 +0000 (UTC)
Received: by qgec40 with SMTP id c40so173966988qge.2
        for <dev@httpd.apache.org>; Thu, 10 Dec 2015 17:22:34 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        bh=1Bw4/y/6cuOsN3HJgVPg3hwdaFzAfji5f+qGwa0XQuA=;
        b=BgGkpSEV8g7uWbNdZTrzjCPn/L3jxpqygfghLj6sECxLcox7Zbtr+tyINH/7UQYfqY
         E2Rr1YZbHwd9nT8bPWHNwnPRozJ6Ks1Njzql4rs41OshZpDJlji63PvFA68TJGtIDYok
         d1p2ObqBp3kOVnHymi1bxrCDtiZaUEt+GSpZlYqpA7aRgwFW/US9N7IHxkDqebLf023S
         S8kM/jS49np0XqHzCcf5TqjN/T1lAMm3zb6Iu0cFrAxRO+TxNqCTSj4/yxraL5p7rbCn
         PW8HZzhh4ktU48RWE2hV+MaAwQSmDtYResxYoMzxiyF6pqJJ/O8uIB9jSDKVy10uhrv2
         DF7A==
MIME-Version: 1.0
X-Received: by 10.55.80.194 with SMTP id e185mr19475455qkb.68.1449796954287;
 Thu, 10 Dec 2015 17:22:34 -0800 (PST)
Received: by 10.55.65.85 with HTTP; Thu, 10 Dec 2015 17:22:34 -0800 (PST)
In-Reply-To: <EC8AA057-325B-4176-88A8-D9E5073C7F32@greenbytes.de>
References: <CACsi250=dbRQKnsbE8JSdAZRm5x99gE0sgX3iQ-PHAx77euD1A@mail.gmail.com>
	<AB1691BE05AE7F4992697F2A0835627AC63BAB94@VOEXM10W.internal.vodafone.com>
	<F7B20D30-D34A-4805-A77D-F64F6428F6E3@greenbytes.de>
	<56660896.c74fc20a.15f56.0ebd@mx.google.com>
	<56660B43.2060507@gmail.com>
	<6B13DF2B-0586-42BB-B62F-59A7638B697D@greenbytes.de>
	<13FE9E7F-9620-4BF9-8EA4-57A6314D66BF@greenbytes.de>
	<9CCEFD7E-9ED3-4ED1-8F58-2134DD5310F9@gbiv.com>
	<CACsi252y7nX0kR9+JgSra7Q_5_LVqaR3z6ExPKg=Lhi8zhN4ew@mail.gmail.com>
	<566887B5.2080705@gmail.com>
	<CACsi253sTRbX2dnuq0yRP1sHb8vOos_9QaoYmA3TtYmnNx-Erg@mail.gmail.com>
	<5668CC4F.109@gmail.com>
	<CACsi253q+GanuRzOqBjaOe-h1w8uOcH6uFAcdres=+ig5q6+VA@mail.gmail.com>
	<5668EFDB.1050900@gmail.com>
	<CACsi252HOz3_BO6hJtRTfM=M6oB0ZUXpSvkPmKs8LWP3LCz8xA@mail.gmail.com>
	<EC8AA057-325B-4176-88A8-D9E5073C7F32@greenbytes.de>
Date: Fri, 11 Dec 2015 02:22:34 +0100
Message-ID: <CAKQ1sVO0pade3_QMnftz38NajZ6v17+9CUz8PW_j3Zj2OvysZA@mail.gmail.com>
Subject: Re: Upgrade Summary
From: Yann Ylavic <ylavic.dev@gmail.com>
To: httpd-dev <dev@httpd.apache.org>
Content-Type: text/plain; charset=UTF-8

On Thu, Dec 10, 2015 at 11:46 AM, Stefan Eissing
<stefan.eissing@greenbytes.de> wrote:
> Given all the input on this thread, I arrive at the following pseudo code:

Thanks for _compiling_ this thread, quite exhaustive :)

I wonder if we could let each Protocols module hook wherever
appropriate in the current hooking set.

TLS handshake is already at the right place IMO, it possibly needs a
simple fix like,

Index: modules/ssl/ssl_engine_kernel.c
===================================================================
--- modules/ssl/ssl_engine_kernel.c    (revision 1718341)
+++ modules/ssl/ssl_engine_kernel.c    (working copy)
@@ -233,7 +233,8 @@ int ssl_hook_ReadReq(request_rec *r)
      * has sent a suitable Upgrade header. */
     if (sc->enabled == SSL_ENABLED_OPTIONAL && !myConnConfig(r->connection)
         && (upgrade = apr_table_get(r->headers_in, "Upgrade")) != NULL
-        && ap_find_token(r->pool, upgrade, "TLS/1.0")) {
+        && ap_find_token(r->pool, upgrade, "TLS")
+        && !ap_has_request_body(r)) {
         if (upgrade_connection(r)) {
             return AP_FILTER_ERROR;
         }
--
so that we don't Upgrade when a body is given (looks like it's RFC
compliant since Upgrade is not mandatory).

Or maybe,
-        && ap_find_token(r->pool, upgrade, "TLS/1.0")) {
+        && ap_find_token(r->pool, upgrade, "TLS")) {
+        if (ap_has_request_body(r)) {
+            return HTTP_REQUEST_ENTITY_TOO_LARGE;
+        }
         if (upgrade_connection(r)) {
             return AP_FILTER_ERROR;
         }
--
because a body in clear text while requiring TLS makes few sense, and
clients that send TLS body directly (no header) after the Upgrade
would notice (now), that looks safer.
But stricly speaking this looks not very RFC7230 compliant too, I
could not find an "Upgrade: TLS" exception there (the whole HTTP/1
request must be read otherwise before upgrade)...

Possibly we could also,
+            ap_discard_request_body(r);
but I'd feel safer with the previous patch, WDYT?


Regarding WebSocket, we already have proxy_wstunnel that handshakes
successfully as a (proxy_)handler.
I don't know if the upcoming body is to be HTTP/1 or not, but should
this be enforced we could use ap_get_brigade() to forward it until
complete (while still detecting HTTP/1 "errors"), and then use the
current TCP forwarding until EOF on either side.


>
> 1. Post Read Request Hook:
>
>         if (Upgrade: request header present) {
>                 collect protocol proposals;
>                 ps = protocol with highest preference from proposals;
>                 if (ps && ps != current) {

Here I would use ap_add_output_filter(switch_protocol_filter, r); with
switch_protocol_filter() which would flush out the 101 response (or
not) based on r->need_upgrade and r->current_protocol, before any
Protocols data.
Maybe this filter could also call ap_discard_request_body(r) when
needed/asked to (eg. r->discard_body), that'd need CONN_SENSE handling
with MPM event possibly.
For the headers in the 101 response, another hook called from
switch_protocol_filter() could be used.

If I'm talking about new r-> field, that could also be in
core_request_config, reachable with
ap_get_core_module_config(r->request_config), for possibly a better
backportabily (but that's an implementation detail).

So now I think we can let the request fall through.
If a Protocols' module needs to bypass/handle auth[nz] itself, it
would hook after this one (post_read_request still, and return DONE).
Otherwise, as a handler, each Protocols' module would check
r->current_protocol against its own one, and either handle it or
DECLINE.
If the selected module doesn't care about the request body (ie. never
reads it), switch_protocol_filter() would do the right thing (discard
the body) before switching.
Otherwise, the module can do whatever it wants with the (full) HTTP/1
request, and even DECLINE if it finally wants to fall through HTTP/1
(after resetting r->need_upgrade probably).

>
> 3. Common protocol switch hook behavior:
>
>         apr_status_t process_body(apr_bucket_brigade *bb, void *ctx)
>         {
>                 // brigade contains unchunked body data of request
>                 // may be called several times. EOS bucket in brigade
>                 // indicates end of body.
>                 // If request has no body, will be called once with EOS bucket.

A handler could use ap_get_brigade(r->input_filters) and friends more
easily, or ap_discard_request_body() explicitely, and/or
ap_pass_brigade(FLUSH) to force the 101 response, ..., and/or go to :

>
>                 // c->output_filters can be written
>                 // c->input_filters can be read [...]
>                 process protocol;

Followed by:
                  r->keepalive = AP_CONN_CLOSE;
                  return OK;
>         }

Wouldn't that work for every case we discussed?

From dev-return-85037-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Fri Dec 11 01:38:00 2015
Return-Path: <dev-return-85037-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 02C7018911
	for <apmail-httpd-dev-archive@www.apache.org>; Fri, 11 Dec 2015 01:38:00 +0000 (UTC)
Received: (qmail 67957 invoked by uid 500); 11 Dec 2015 01:37:59 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 67886 invoked by uid 500); 11 Dec 2015 01:37:59 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 67876 invoked by uid 99); 11 Dec 2015 01:37:59 -0000
Received: from Unknown (HELO spamd4-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 11 Dec 2015 01:37:59 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd4-us-west.apache.org (ASF Mail Server at spamd4-us-west.apache.org) with ESMTP id E6CD4C0F42
	for <dev@httpd.apache.org>; Fri, 11 Dec 2015 01:37:58 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd4-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.101
X-Spam-Level:
X-Spam-Status: No, score=-0.101 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RCVD_IN_MSPIKE_H2=-0.001] autolearn=disabled
Authentication-Results: spamd4-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd4-us-west.apache.org [10.40.0.11]) (amavisd-new, port 10024)
	with ESMTP id nWG7QaAdawov for <dev@httpd.apache.org>;
	Fri, 11 Dec 2015 01:37:55 +0000 (UTC)
Received: from mail-qg0-f54.google.com (mail-qg0-f54.google.com [209.85.192.54])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id 2633642A5E
	for <dev@httpd.apache.org>; Fri, 11 Dec 2015 01:37:55 +0000 (UTC)
Received: by qgeb1 with SMTP id b1so175958901qge.1
        for <dev@httpd.apache.org>; Thu, 10 Dec 2015 17:37:55 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        bh=rjow/UycVRkbSrn/3zUzRk8JjmkT2HLZ3BNhhEgu+q4=;
        b=w5uNEEbxN4z9uYxV27mG2taxCeylEl2roeWpvss2CEpCH3Tm8i5kj1p0O818GaEqyB
         Xk36CEv0C1OmMVpQZt7KaGMlnvNE+9Djg9h6MYVHrqO/q2CcjyHkDkkBA4z8nTBNuqfU
         82aVgocMhuqrodXGTEBDMqVImC1NtJihIeQEAn0V4DSahLWb120QrOyxLqJcktmoKjEb
         N4DO0oQ3mdSeHSJpJyMzg45TDRGJOLd0thBPf+4Ivv/ZsuQruYsHHUWJnbIz0r51D2wq
         iJnWfnQ2v8sNcFrZn51ZZ4vdc5tutJ6uicQh0yAMgYplegWuQ4GChxa0Wq/phyem8PHC
         hWzg==
MIME-Version: 1.0
X-Received: by 10.140.96.45 with SMTP id j42mr19725874qge.92.1449797874892;
 Thu, 10 Dec 2015 17:37:54 -0800 (PST)
Received: by 10.55.65.85 with HTTP; Thu, 10 Dec 2015 17:37:54 -0800 (PST)
In-Reply-To: <CAKQ1sVO0pade3_QMnftz38NajZ6v17+9CUz8PW_j3Zj2OvysZA@mail.gmail.com>
References: <CACsi250=dbRQKnsbE8JSdAZRm5x99gE0sgX3iQ-PHAx77euD1A@mail.gmail.com>
	<AB1691BE05AE7F4992697F2A0835627AC63BAB94@VOEXM10W.internal.vodafone.com>
	<F7B20D30-D34A-4805-A77D-F64F6428F6E3@greenbytes.de>
	<56660896.c74fc20a.15f56.0ebd@mx.google.com>
	<56660B43.2060507@gmail.com>
	<6B13DF2B-0586-42BB-B62F-59A7638B697D@greenbytes.de>
	<13FE9E7F-9620-4BF9-8EA4-57A6314D66BF@greenbytes.de>
	<9CCEFD7E-9ED3-4ED1-8F58-2134DD5310F9@gbiv.com>
	<CACsi252y7nX0kR9+JgSra7Q_5_LVqaR3z6ExPKg=Lhi8zhN4ew@mail.gmail.com>
	<566887B5.2080705@gmail.com>
	<CACsi253sTRbX2dnuq0yRP1sHb8vOos_9QaoYmA3TtYmnNx-Erg@mail.gmail.com>
	<5668CC4F.109@gmail.com>
	<CACsi253q+GanuRzOqBjaOe-h1w8uOcH6uFAcdres=+ig5q6+VA@mail.gmail.com>
	<5668EFDB.1050900@gmail.com>
	<CACsi252HOz3_BO6hJtRTfM=M6oB0ZUXpSvkPmKs8LWP3LCz8xA@mail.gmail.com>
	<EC8AA057-325B-4176-88A8-D9E5073C7F32@greenbytes.de>
	<CAKQ1sVO0pade3_QMnftz38NajZ6v17+9CUz8PW_j3Zj2OvysZA@mail.gmail.com>
Date: Fri, 11 Dec 2015 02:37:54 +0100
Message-ID: <CAKQ1sVPaupr1jrFzB0=V1-YX0XYVOKiGWtgStQdReX-8Z+b3cA@mail.gmail.com>
Subject: Re: Upgrade Summary
From: Yann Ylavic <ylavic.dev@gmail.com>
To: httpd-dev <dev@httpd.apache.org>
Content-Type: text/plain; charset=UTF-8

On Fri, Dec 11, 2015 at 2:22 AM, Yann Ylavic <ylavic.dev@gmail.com> wrote:
>
> Here I would use ap_add_output_filter(switch_protocol_filter, r); with
> switch_protocol_filter() which would flush out the 101 response (or
> not) based on r->need_upgrade and r->current_protocol, before any
> Protocols data.

This filter would be AP_FILTER_PROTOCOL+x or (low)
AP_FILTER_CONNECTION (before mod_ssl).

>
> Wouldn't that work for every case we discussed?

I did not mentioned h2c, but it could run in post_read_request right?

From dev-return-85038-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Fri Dec 11 08:56:16 2015
Return-Path: <dev-return-85038-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 206831860B
	for <apmail-httpd-dev-archive@www.apache.org>; Fri, 11 Dec 2015 08:56:16 +0000 (UTC)
Received: (qmail 29639 invoked by uid 500); 11 Dec 2015 08:56:15 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 29569 invoked by uid 500); 11 Dec 2015 08:56:15 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 29559 invoked by uid 99); 11 Dec 2015 08:56:15 -0000
Received: from Unknown (HELO spamd3-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 11 Dec 2015 08:56:15 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd3-us-west.apache.org (ASF Mail Server at spamd3-us-west.apache.org) with ESMTP id 8DDC8180B5A
	for <dev@httpd.apache.org>; Fri, 11 Dec 2015 08:56:14 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd3-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.653
X-Spam-Level:
X-Spam-Status: No, score=-0.653 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RP_MATCHES_RCVD=-0.554, URIBL_BLOCKED=0.001] autolearn=disabled
Authentication-Results: spamd3-us-west.apache.org (amavisd-new);
	dkim=pass (1024-bit key) header.d=greenbytes.de
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd3-us-west.apache.org [10.40.0.10]) (amavisd-new, port 10024)
	with ESMTP id f-jZw0nYj8qQ for <dev@httpd.apache.org>;
	Fri, 11 Dec 2015 08:56:06 +0000 (UTC)
Received: from mail.greenbytes.de (mail.greenbytes.de [217.91.35.233])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id 526562026F
	for <dev@httpd.apache.org>; Fri, 11 Dec 2015 08:56:05 +0000 (UTC)
Received: from [192.168.1.42] (unknown [217.91.35.233])
	(using TLSv1 with cipher ECDHE-RSA-AES256-SHA (256/256 bits))
	(Client did not present a certificate)
	by mail.greenbytes.de (Postfix) with ESMTPSA id 98A5815A047F
	for <dev@httpd.apache.org>; Fri, 11 Dec 2015 09:56:04 +0100 (CET)
DKIM-Signature: v=1; a=rsa-sha256; c=simple/simple; d=greenbytes.de; s=mail;
	t=1449824164; bh=VCWks4OSTz2unNu0hIJqtm5w+NDq2v99dSy6rP4YnDg=;
	h=Subject:From:In-Reply-To:Date:References:To:From;
	b=eKLxaggtwFJLdmrTd4Rs+SZGVx/67r/528OdTSFyktilbJPrveVqtrYal8TqYTuJ9
	 1UuG3sEkauQDhjFqkvV4sJaYCz/5v1UDnNs5T/D+oRBjQKDuyiR2oPzfn38p2TS5cT
	 +UtRSTM8XFGGOh+HofEYTGiqI53XLpSwf/wsrQvY=
Content-Type: text/plain; charset=us-ascii
Mime-Version: 1.0 (Mac OS X Mail 9.2 \(3112\))
Subject: Re: Upgrade Summary
From: Stefan Eissing <stefan.eissing@greenbytes.de>
In-Reply-To: <5669FA25.3020100@gmail.com>
Date: Fri, 11 Dec 2015 09:56:08 +0100
Content-Transfer-Encoding: quoted-printable
Message-Id: <90C59262-7253-4862-A430-F0510A3D854C@greenbytes.de>
References: <CACsi250=dbRQKnsbE8JSdAZRm5x99gE0sgX3iQ-PHAx77euD1A@mail.gmail.com> <AB1691BE05AE7F4992697F2A0835627AC63BAB94@VOEXM10W.internal.vodafone.com> <F7B20D30-D34A-4805-A77D-F64F6428F6E3@greenbytes.de> <56660896.c74fc20a.15f56.0ebd@mx.google.com> <56660B43.2060507@gmail.com> <6B13DF2B-0586-42BB-B62F-59A7638B697D@greenbytes.de> <13FE9E7F-9620-4BF9-8EA4-57A6314D66BF@greenbytes.de> <9CCEFD7E-9ED3-4ED1-8F58-2134DD5310F9@gbiv.com> <CACsi252y7nX0kR9+JgSra7Q_5_LVqaR3z6ExPKg=Lhi8zhN4ew@mail.gmail.com> <566887B5.2080705@gmail.com> <CACsi253sTRbX2dnuq0yRP1sHb8vOos_9QaoYmA3TtYmnNx-Erg@mail.gmail.com> <5668CC4F.109@gmail.com> <CACsi253q+GanuRzOqBjaOe-h1w8uOcH6uFAcdres=+ig5q6+VA@mail.gmail.com> <5668EFDB.1050900@gmail.com> <CACsi252HOz3_BO6hJtRTfM=M6oB0ZUXpSvkPmKs8LWP3LCz8xA@mail.gmail.com> <5669FA25.3020100@gmail.com>
To: dev@httpd.apache.org
X-Mailer: Apple Mail (2.3112)

Jacob, thanks for the code! I will let this and my pseudo code stew over =
the weekend and then probably next week start the changes to upgrade =
handling.

//Stefan

> Am 10.12.2015 um 23:18 schrieb Jacob Champion <champion.p@gmail.com>:
>=20
> Okay, I finally have actual code to share. This is the original =
experimental pre_protocol_switch hook that Stefan and I were talking =
about a while ago [1], rebased onto 2.4.18. The two patches are =
available at
>=20
>    https://github.com/jchampio/httpd/commits/dev/websocket-protocols
>=20
> It is *not* an implementation of Stefan's most recent pseudocode (a =
primary difference is that his proposal does the filter + upgrade in one =
hook instead of two), and it doesn't solve many of the use cases that =
you've already agreed must be handled:
>=20
> - 100-continue is not handled correctly
> - the incoming request body is not correctly dealt with
> - there is only one switch point, at the handler stage
> - etc.
>=20
> *But* it is a working implementation from mod_websocket's point of =
view, so I offer it up primarily for informational purposes. The module =
making use of the new hook is available at
>=20
> =
https://github.com/jchampio/apache-websocket/blob/dev/hook/mod_websocket.c=

>=20
> You might be most interested in the =
mod_websocket_pre_protocol_switch() implementation (line 1627), which =
contains the pre-upgrade checks I need to do to remain compliant with =
RFC 6455.
>=20
> =3D=3D Asides =3D=3D
>=20
> 1) The current Protocols API does not correctly ignore upgrades from =
HTTP/1.0 requests; the latest commit to my experimental branch patched =
this.
>=20
> 2) As Stefan and I discussed in [1], Upgrade header values are =
case-sensitive (correct?), but the RFC 6455 declares that servers should =
respond to any protocol that's a case-insensitive match for "websocket". =
To make matters worse, the official IANA upgrade token is "WebSocket", =
but the RFC uses "websocket" throughout. I have seen both used in the =
wild (Autobahn uses WebSocket; Firefox uses websocket), and I'm not sure =
what the right way to resolve this is.
>=20
> Hope this helps. Again, I don't expect this to actually be part of the =
final solution, but sometimes it's nice to see code.
>=20
> --Jacob
>=20
> [1] =
https://mail-archives.apache.org/mod_mbox/httpd-dev/201509.mbox/%3C55FF85F=
0.8040106@gmail.com%3E


From dev-return-85039-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Fri Dec 11 09:20:24 2015
Return-Path: <dev-return-85039-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 2677618715
	for <apmail-httpd-dev-archive@www.apache.org>; Fri, 11 Dec 2015 09:20:24 +0000 (UTC)
Received: (qmail 92589 invoked by uid 500); 11 Dec 2015 09:20:23 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 92516 invoked by uid 500); 11 Dec 2015 09:20:23 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 92506 invoked by uid 99); 11 Dec 2015 09:20:23 -0000
Received: from Unknown (HELO spamd3-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 11 Dec 2015 09:20:23 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd3-us-west.apache.org (ASF Mail Server at spamd3-us-west.apache.org) with ESMTP id 3EDC4180B60
	for <dev@httpd.apache.org>; Fri, 11 Dec 2015 09:20:23 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd3-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.654
X-Spam-Level:
X-Spam-Status: No, score=-0.654 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RP_MATCHES_RCVD=-0.554] autolearn=disabled
Authentication-Results: spamd3-us-west.apache.org (amavisd-new);
	dkim=pass (1024-bit key) header.d=greenbytes.de
Received: from mx1-us-west.apache.org ([10.40.0.8])
	by localhost (spamd3-us-west.apache.org [10.40.0.10]) (amavisd-new, port 10024)
	with ESMTP id fbkrCfGSSDiC for <dev@httpd.apache.org>;
	Fri, 11 Dec 2015 09:20:08 +0000 (UTC)
Received: from mail.greenbytes.de (mail.greenbytes.de [217.91.35.233])
	by mx1-us-west.apache.org (ASF Mail Server at mx1-us-west.apache.org) with ESMTPS id B538025085
	for <dev@httpd.apache.org>; Fri, 11 Dec 2015 09:20:07 +0000 (UTC)
Received: from [192.168.1.42] (unknown [217.91.35.233])
	(using TLSv1 with cipher ECDHE-RSA-AES256-SHA (256/256 bits))
	(Client did not present a certificate)
	by mail.greenbytes.de (Postfix) with ESMTPSA id A1D5D15A044E
	for <dev@httpd.apache.org>; Fri, 11 Dec 2015 10:20:05 +0100 (CET)
DKIM-Signature: v=1; a=rsa-sha256; c=simple/simple; d=greenbytes.de; s=mail;
	t=1449825605; bh=dZA5AWqPmAj7wIVxVX2na1MIqm+y6yVPFVbcWZz6SdU=;
	h=Subject:From:In-Reply-To:Date:References:To:From;
	b=DVZNUpbTX/axwIZEroJIfEW5GwWEQitOpXSsjOlrPPhk9LOAoK7EFw+mL1NrlfOSO
	 OagZyIwL87JjgXjSXwjiFWBWhETiuxG6N51uO2Gu/UrNyNfoyZFzXtnhGOjKIsGPEk
	 gz8jbPq6i9rFMGgQbLcTAorbgfjhAJUGvbXWllU0=
Content-Type: text/plain; charset=us-ascii
Mime-Version: 1.0 (Mac OS X Mail 9.2 \(3112\))
Subject: Re: Upgrade Summary
From: Stefan Eissing <stefan.eissing@greenbytes.de>
In-Reply-To: <CAKQ1sVO0pade3_QMnftz38NajZ6v17+9CUz8PW_j3Zj2OvysZA@mail.gmail.com>
Date: Fri, 11 Dec 2015 10:20:05 +0100
Content-Transfer-Encoding: quoted-printable
Message-Id: <482349A8-86D1-42EF-A436-C907BDF9DF7D@greenbytes.de>
References: <CACsi250=dbRQKnsbE8JSdAZRm5x99gE0sgX3iQ-PHAx77euD1A@mail.gmail.com> <AB1691BE05AE7F4992697F2A0835627AC63BAB94@VOEXM10W.internal.vodafone.com> <F7B20D30-D34A-4805-A77D-F64F6428F6E3@greenbytes.de> <56660896.c74fc20a.15f56.0ebd@mx.google.com> <56660B43.2060507@gmail.com> <6B13DF2B-0586-42BB-B62F-59A7638B697D@greenbytes.de> <13FE9E7F-9620-4BF9-8EA4-57A6314D66BF@greenbytes.de> <9CCEFD7E-9ED3-4ED1-8F58-2134DD5310F9@gbiv.com> <CACsi252y7nX0kR9+JgSra7Q_5_LVqaR3z6ExPKg=Lhi8zhN4ew@mail.gmail.com> <566887B5.2080705@gmail.com> <CACsi253sTRbX2dnuq0yRP1sHb8vOos_9QaoYmA3TtYmnNx-Erg@mail.gmail.com> <5668CC4F.109@gmail.com> <CACsi253q+GanuRzOqBjaOe-h1w8uOcH6uFAcdres=+ig5q6+VA@mail.gmail.com> <5668EFDB.1050900@gmail.com> <CACsi252HOz3_BO6hJtRTfM=M6oB0ZUXpSvkPmKs8LWP3LCz8xA@mail.gmail.com> <EC8AA057-325B-4176-88A8-D9E5073C7F32@greenbytes.de> <CAKQ1sVO0pade3_QMnftz38NajZ6v17+9CUz8PW_j3Zj2OvysZA@mail.gmail.com>
To: dev@httpd.apache.org
X-Mailer: Apple Mail (2.3112)


> Am 11.12.2015 um 02:22 schrieb Yann Ylavic <ylavic.dev@gmail.com>:
>=20
> On Thu, Dec 10, 2015 at 11:46 AM, Stefan Eissing
> <stefan.eissing@greenbytes.de> wrote:
>> Given all the input on this thread, I arrive at the following pseudo =
code:
>=20
> Thanks for _compiling_ this thread, quite exhaustive :)

Code often says more than a thousand...tokens.

> I wonder if we could let each Protocols module hook wherever
> appropriate in the current hooking set.
>=20
> TLS handshake is already at the right place IMO, it possibly needs a
> simple fix like,

I am not an expert on where TLS handshake would fit best. It would
be good, and we are on the way of working on it, to have a good
Upgrade handling in core, where TLS, h2c and websocket all are
comfortable with.

Currently, TLS and current core step on each others toes when it
comes to the Upgrade response header. This we should fix.

If it turns out that TLS, h2c and websocket all need the actual=20
switching at different phases of request processing, then we need
to accomodate for that.

What I can see:
- TLS and h2c should switch in post_read_req
- websocket should switch just before the handler phase

Regarding request bodies:
- websocket will never switch on request bodies
- h2c currently does not, but clients like serf (and curl) really would =
prefer it to
- TLS could switch with arbitrary request bodies, but maybe need not to
Protocol implementations should make up their minds in the "propose" =
phase, I think,
because once a protocol gets selected, the upgrade *should* succeed =
unless the
connection catches fire or something. Not upgrading is better than =
failing.



> Index: modules/ssl/ssl_engine_kernel.c
> =3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D
> --- modules/ssl/ssl_engine_kernel.c    (revision 1718341)
> +++ modules/ssl/ssl_engine_kernel.c    (working copy)
> @@ -233,7 +233,8 @@ int ssl_hook_ReadReq(request_rec *r)
>      * has sent a suitable Upgrade header. */
>     if (sc->enabled =3D=3D SSL_ENABLED_OPTIONAL && =
!myConnConfig(r->connection)
>         && (upgrade =3D apr_table_get(r->headers_in, "Upgrade")) !=3D =
NULL
> -        && ap_find_token(r->pool, upgrade, "TLS/1.0")) {
> +        && ap_find_token(r->pool, upgrade, "TLS")
> +        && !ap_has_request_body(r)) {
>         if (upgrade_connection(r)) {
>             return AP_FILTER_ERROR;
>         }
> --
> so that we don't Upgrade when a body is given (looks like it's RFC
> compliant since Upgrade is not mandatory).
>=20
> Or maybe,
> -        && ap_find_token(r->pool, upgrade, "TLS/1.0")) {
> +        && ap_find_token(r->pool, upgrade, "TLS")) {
> +        if (ap_has_request_body(r)) {
> +            return HTTP_REQUEST_ENTITY_TOO_LARGE;
> +        }
>         if (upgrade_connection(r)) {
>             return AP_FILTER_ERROR;
>         }
> --
> because a body in clear text while requiring TLS makes few sense, and
> clients that send TLS body directly (no header) after the Upgrade
> would notice (now), that looks safer.
> But stricly speaking this looks not very RFC7230 compliant too, I
> could not find an "Upgrade: TLS" exception there (the whole HTTP/1
> request must be read otherwise before upgrade)...
>=20
> Possibly we could also,
> +            ap_discard_request_body(r);
> but I'd feel safer with the previous patch, WDYT?

I think the first way, don't Upgrade if you know it will not work, is =
better.

>> [...]
>> 1. Post Read Request Hook:
>>=20
>>        if (Upgrade: request header present) {
>>                collect protocol proposals;
>>                ps =3D protocol with highest preference from =
proposals;
>>                if (ps && ps !=3D current) {
>=20
> Here I would use ap_add_output_filter(switch_protocol_filter, r); with
> switch_protocol_filter() which would flush out the 101 response (or
> not) based on r->need_upgrade and r->current_protocol, before any
> Protocols data.

I am not convinced that a flushing is necessary. If a protocol needs
this, it can just pass out a flush bucket, or?

> Maybe this filter could also call ap_discard_request_body(r) when
> needed/asked to (eg. r->discard_body), that'd need CONN_SENSE handling
> with MPM event possibly.

Some safeguard+comfort filter magic to make protocol's life with=20
Upgrade request bodies easier would be nice.=20

h2c needs to receive request body separate, get an indication=20
that EOS for that body has been reached, and then continue reading=20
HTTP/2 protocol data on the connection. I am not sure what is the=20
best way to do that and, when upgrading on post_read_req hook, if
all necessary request filters are in place by then.

> For the headers in the 101 response, another hook called from
> switch_protocol_filter() could be used.

That'd be the pre_switch hook Jacob and I talked about and where he
posted his implementation yesterday.

>> [...]
>=20
> A handler could use ap_get_brigade(r->input_filters) and friends more
> easily, or ap_discard_request_body() explicitely, and/or
> ap_pass_brigade(FLUSH) to force the 101 response, ..., and/or go to :

Yes, maybe that is easier.

>=20
>>                // c->output_filters can be written
>>                // c->input_filters can be read [...]
>>                process protocol;
>=20
> Followed by:
>                  r->keepalive =3D AP_CONN_CLOSE;
>                  return OK;
>>        }
>=20
> Wouldn't that work for every case we discussed?

I though the TLS wanted to switch protocol and then let normal HTTP/1
processing continue on the connection?

//Stefan


From dev-return-85040-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Fri Dec 11 09:23:24 2015
Return-Path: <dev-return-85040-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 1FA8B18746
	for <apmail-httpd-dev-archive@www.apache.org>; Fri, 11 Dec 2015 09:23:24 +0000 (UTC)
Received: (qmail 2122 invoked by uid 500); 11 Dec 2015 09:23:23 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 2054 invoked by uid 500); 11 Dec 2015 09:23:23 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 2044 invoked by uid 99); 11 Dec 2015 09:23:23 -0000
Received: from Unknown (HELO spamd3-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 11 Dec 2015 09:23:23 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd3-us-west.apache.org (ASF Mail Server at spamd3-us-west.apache.org) with ESMTP id 1A89B180B60
	for <dev@httpd.apache.org>; Fri, 11 Dec 2015 09:23:23 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd3-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.654
X-Spam-Level:
X-Spam-Status: No, score=-0.654 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RP_MATCHES_RCVD=-0.554, SPF_PASS=-0.001, URIBL_BLOCKED=0.001]
	autolearn=disabled
Authentication-Results: spamd3-us-west.apache.org (amavisd-new);
	dkim=pass (1024-bit key) header.d=greenbytes.de
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd3-us-west.apache.org [10.40.0.10]) (amavisd-new, port 10024)
	with ESMTP id aVE_tutETSxD for <dev@httpd.apache.org>;
	Fri, 11 Dec 2015 09:23:08 +0000 (UTC)
Received: from mail.greenbytes.de (mail.greenbytes.de [217.91.35.233])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id 8C13B439A6
	for <dev@httpd.apache.org>; Fri, 11 Dec 2015 09:23:08 +0000 (UTC)
Received: from [192.168.1.42] (unknown [217.91.35.233])
	(using TLSv1 with cipher ECDHE-RSA-AES256-SHA (256/256 bits))
	(Client did not present a certificate)
	by mail.greenbytes.de (Postfix) with ESMTPSA id 378E915A061B
	for <dev@httpd.apache.org>; Fri, 11 Dec 2015 10:23:07 +0100 (CET)
DKIM-Signature: v=1; a=rsa-sha256; c=simple/simple; d=greenbytes.de; s=mail;
	t=1449825787; bh=/VfEVqfGrmuk/DGmmggMFGwhhvW5SxRsCbxEaMsJM9A=;
	h=Subject:From:In-Reply-To:Date:References:To:From;
	b=nSuW5CrZg0ABmX46XPo5upBN2sofIGZHWwIErvfHPWDvUYv7q6TK3pFTRn6R94MlG
	 jw0uni55ElmXNmvSv5bF38qQplCb6QO8ScOJzZbqbiAWpOhcR094bb5IRUKGqD4BGR
	 4Pw3CAFLNJ4davAF2FE1/9MnOOS17E9j/yf7M6g0=
Content-Type: text/plain; charset=us-ascii
Mime-Version: 1.0 (Mac OS X Mail 9.2 \(3112\))
Subject: Re: mod_http2 memory footprint
From: Stefan Eissing <stefan.eissing@greenbytes.de>
In-Reply-To: <5669450e.1a64.1524.7c6a@land10.nl>
Date: Fri, 11 Dec 2015 10:23:07 +0100
Content-Transfer-Encoding: quoted-printable
Message-Id: <228A6BF2-9D64-47CC-816F-97310EE97C8F@greenbytes.de>
References: <5669450e.1a64.1524.7c6a@land10.nl>
To: dev@httpd.apache.org
X-Mailer: Apple Mail (2.3112)

The "slowly growing" part is certainly not good. For 2.4.18, my main =
concern was stability and some important new features. I had a look at =
memory consumption but could not find anything that explained the growth =
well. Definitely needs more attention in the future...

> Am 10.12.2015 um 10:25 schrieb Steffen <info@apachelounge.com>:
>=20
>=20
> Running mod_ssl-only Apache  (no external party modules), which is in =
front (reverse proxy) of a non-ssl Apache.
>=20
> With mod-http2 the memory footprint varies greatly:
>=20
> Without mod_http2 a steady ~40 MB.
>=20
> With mod_http2 it starts with ~50MB and peaks to over ~300 MB with a =
average of ~130 MB and slowly growing.
>=20
>=20
> Measured with 2 minutes interval, so the peak could be much higher.
>=20
> Attached the graph from today.
> The dark line is the non-ssl Apache.
> The dip is the switch from 2.4.18-dev-http2-Alpha to 2.4.18-vote.
>=20
> Happens with 2.4.17 as well as 2.4.18.
>=20
>=20
> Steffen
>=20
> <watch_cfg-httpd-ram-d-n.png>


From dev-return-85041-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Fri Dec 11 10:36:30 2015
Return-Path: <dev-return-85041-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 64B4118AAC
	for <apmail-httpd-dev-archive@www.apache.org>; Fri, 11 Dec 2015 10:36:30 +0000 (UTC)
Received: (qmail 74861 invoked by uid 500); 11 Dec 2015 10:36:30 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 74795 invoked by uid 500); 11 Dec 2015 10:36:29 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 74785 invoked by uid 99); 11 Dec 2015 10:36:29 -0000
Received: from Unknown (HELO spamd4-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 11 Dec 2015 10:36:29 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd4-us-west.apache.org (ASF Mail Server at spamd4-us-west.apache.org) with ESMTP id 7C918C0179
	for <dev@httpd.apache.org>; Fri, 11 Dec 2015 10:36:29 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd4-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.121
X-Spam-Level:
X-Spam-Status: No, score=-0.121 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RCVD_IN_MSPIKE_H3=-0.01, RCVD_IN_MSPIKE_WL=-0.01, SPF_PASS=-0.001]
	autolearn=disabled
Authentication-Results: spamd4-us-west.apache.org (amavisd-new);
	dkim=pass (1024-bit key) header.d=qqmail.nl
Received: from mx1-us-west.apache.org ([10.40.0.8])
	by localhost (spamd4-us-west.apache.org [10.40.0.11]) (amavisd-new, port 10024)
	with ESMTP id GpL3ehum7OS0 for <dev@httpd.apache.org>;
	Fri, 11 Dec 2015 10:36:28 +0000 (UTC)
Received: from mail-wm0-f46.google.com (mail-wm0-f46.google.com [74.125.82.46])
	by mx1-us-west.apache.org (ASF Mail Server at mx1-us-west.apache.org) with ESMTPS id C46E12016B
	for <dev@httpd.apache.org>; Fri, 11 Dec 2015 10:36:27 +0000 (UTC)
Received: by mail-wm0-f46.google.com with SMTP id c17so6318030wmd.1
        for <dev@httpd.apache.org>; Fri, 11 Dec 2015 02:36:27 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=qqmail.nl; s=google;
        h=from:to:references:in-reply-to:subject:date:message-id:mime-version
         :content-type:content-transfer-encoding:thread-index
         :content-language;
        bh=EVEVsASoW21vXFeihSr2fhwfNlzV/wQupPQ3sITChp4=;
        b=WroNjniZvUErl5lttELdPag2um5e8E8vexpxb7soU+rwJfjSJiG2L8yjKCM3qdMRBC
         Amm9ViKEIHS3gcAfbDKesIqps+vOScrFWNjHYx0IjKrc4kmQBbakL+S6+rMTPUpcE22I
         9b7R+2b7EwLXgWCIzLxrC9NoE5xA3gR8A/mKA=
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=1e100.net; s=20130820;
        h=x-gm-message-state:from:to:references:in-reply-to:subject:date
         :message-id:mime-version:content-type:content-transfer-encoding
         :thread-index:content-language;
        bh=EVEVsASoW21vXFeihSr2fhwfNlzV/wQupPQ3sITChp4=;
        b=WGVtAzxORvpqAS9D+VLj4lbSc7BY6Ljy39uKQepLWh6oPfMbjE05uYPSgsExFe2Cu4
         3zWbBDbBJHxlXklzrs8slg30x1ZSuJ7AElXIezRXR57OSZuKSDutqUScAoixzPxpvhCQ
         c79Qy1MiohxJE39wXoMFQwpWwmKNUGvPo3LeJanAIlDfFuGQdx4QkNa2OASiuuftCioJ
         I73dMpGA28CsCj9X57DL19m38BFmk8CB7i/jZwRQYZtKjEjFDGEhNP+OAvppO+OeiDjm
         4wn6fjQm5aPNvv5hJAbdBnM6jhfUF/9IXhN0P5TlTzVUhPg0XxHfdHCK+pDclqrTBzyX
         Voug==
X-Gm-Message-State: ALoCoQl80k6z4gussJthjxqOLT8x4kApGXTOyqGkp3ykn5JkPT8yuPFsgD37gvweI4avW1UEFHeTmvibE53qYTxS2/Jkp5uBfA==
X-Received: by 10.194.78.212 with SMTP id d20mr20140734wjx.70.1449830186401;
        Fri, 11 Dec 2015 02:36:26 -0800 (PST)
Received: from I72600 ([2001:610:66e:0:52e5:49ff:fee1:96b7])
        by smtp.gmail.com with ESMTPSA id z17sm16459768wjq.1.2015.12.11.02.36.25
        for <dev@httpd.apache.org>
        (version=TLS1_2 cipher=ECDHE-RSA-AES128-GCM-SHA256 bits=128/128);
        Fri, 11 Dec 2015 02:36:25 -0800 (PST)
From: "Bert Huijben" <bert@qqmail.nl>
To: <dev@httpd.apache.org>
References: <CACsi250=dbRQKnsbE8JSdAZRm5x99gE0sgX3iQ-PHAx77euD1A@mail.gmail.com> <AB1691BE05AE7F4992697F2A0835627AC63BAB94@VOEXM10W.internal.vodafone.com> <F7B20D30-D34A-4805-A77D-F64F6428F6E3@greenbytes.de> <56660896.c74fc20a.15f56.0ebd@mx.google.com> <56660B43.2060507@gmail.com> <6B13DF2B-0586-42BB-B62F-59A7638B697D@greenbytes.de> <13FE9E7F-9620-4BF9-8EA4-57A6314D66BF@greenbytes.de> <9CCEFD7E-9ED3-4ED1-8F58-2134DD5310F9@gbiv.com> <CACsi252y7nX0kR9+JgSra7Q_5_LVqaR3z6ExPKg=Lhi8zhN4ew@mail.gmail.com> <566887B5.2080705@gmail.com> <CACsi253sTRbX2dnuq0yRP1sHb8vOos_9QaoYmA3TtYmnNx-Erg@mail.gmail.com> <5668CC4F.109@gmail.com> <CACsi253q+GanuRzOqBjaOe-h1w8uOcH6uFAcdres=+ig5q6+VA@mail.gmail.com> <5668EFDB.1050900@gmail.com> <CACsi252HOz3_BO6hJtRTfM=M6oB0ZUXpSvkPmKs8LWP3LCz8xA@mail.gmail.com> <EC8AA057-325B-4176-88A8-D9E5073C7F32@greenbytes.de> <CAKQ1sVO0pade3_QMnftz38NajZ6v17+9CUz8PW_j3Zj2OvysZA@mail.gmail.com> <482349A8-86D1-42EF-A436-C907BDF9DF7D@greenbytes.de>
In-Reply-To: <482349A8-86D1-42EF-A436-C907BDF9DF7D@greenbytes.de>
Subject: RE: Upgrade Summary
Date: Fri, 11 Dec 2015 11:36:18 +0100
Message-ID: <d3ce01d133ff$c50fa930$4f2efb90$@qqmail.nl>
MIME-Version: 1.0
Content-Type: text/plain;
	charset="us-ascii"
Content-Transfer-Encoding: 7bit
X-Mailer: Microsoft Outlook 16.0
Thread-Index: AQKiK5k53Zwc1sqI7zswkQpwqyBJZQHPPeQLAlYfy+wBw01DvAJJXKo0Ai3vbIwBtCRQOwEDPPgvAno6FMYC0LSzywJNCLE3Aj1Jd00ByA6t6QGH0D6QAVTGCOUBW1I3zQKBHCYoAfeakvucGHjSUA==
Content-Language: nl

> -----Original Message-----
> From: Stefan Eissing [mailto:stefan.eissing@greenbytes.de]
> Sent: vrijdag 11 december 2015 10:20
> To: dev@httpd.apache.org
> Subject: Re: Upgrade Summary


> Regarding request bodies:
> - websocket will never switch on request bodies
> - h2c currently does not, but clients like serf (and curl) really would
prefer it to
> - TLS could switch with arbitrary request bodies, but maybe need not to
> Protocol implementations should make up their minds in the "propose"
phase, I
> think,
> because once a protocol gets selected, the upgrade *should* succeed unless
> the
> connection catches fire or something. Not upgrading is better than
failing.

+1
Not upgrading is 100% better than failing.

But for Subversion not upgrading will most likely also imply not retrying
later on the same connection.

The way Subversion uses requests implies that it needs to pipeline requests.
With h2 it can do this much more efficient and stable than with http/1.1,
but not pipelining will make operations to remote repositories unusable
slow. (And I think most of us at least sometimes use the ASF master
repository from a distance:-)


So once we get past that initial request on an operation like update,
checkout or merge we will start opening multiple http/1.1 connections and
pipelining requests on those connections without further upgrade headers.
With requests leaving and responses arriving out of sync there is no way to
upgrade later on.




One other thing that sticks in my mind:
Is it possible to upgrade to TLS in one request and to h2c later?
(The other direction is explicitly forbidden by h2)

I'm not going to implement this for the pipelining reasons noted above, but
perhaps other scenarios might want this. But more likely  we might want to
explicitly block this scenario.

TLS and then websockets...
I don't think that scenario should be supported either. Webbrowsers aren't
going to use it... and dedicated clients probably use a direct connection of
some sort instead of websockets.

	Bert


From dev-return-85042-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Fri Dec 11 11:56:38 2015
Return-Path: <dev-return-85042-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id DDECA18D94
	for <apmail-httpd-dev-archive@www.apache.org>; Fri, 11 Dec 2015 11:56:37 +0000 (UTC)
Received: (qmail 23901 invoked by uid 500); 11 Dec 2015 11:56:37 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 23844 invoked by uid 500); 11 Dec 2015 11:56:37 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 23834 invoked by uid 99); 11 Dec 2015 11:56:37 -0000
Received: from Unknown (HELO spamd1-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 11 Dec 2015 11:56:37 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd1-us-west.apache.org (ASF Mail Server at spamd1-us-west.apache.org) with ESMTP id B2111C4E0A
	for <dev@httpd.apache.org>; Fri, 11 Dec 2015 11:56:36 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd1-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.12
X-Spam-Level:
X-Spam-Status: No, score=-0.12 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RCVD_IN_MSPIKE_H3=-0.01, RCVD_IN_MSPIKE_WL=-0.01, SPF_PASS=-0.001,
	URIBL_BLOCKED=0.001] autolearn=disabled
Authentication-Results: spamd1-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd1-us-west.apache.org [10.40.0.7]) (amavisd-new, port 10024)
	with ESMTP id XWHSzkND4jJR for <dev@httpd.apache.org>;
	Fri, 11 Dec 2015 11:56:30 +0000 (UTC)
Received: from mail-qk0-f169.google.com (mail-qk0-f169.google.com [209.85.220.169])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id 989A724D8E
	for <dev@httpd.apache.org>; Fri, 11 Dec 2015 11:56:29 +0000 (UTC)
Received: by qkdp187 with SMTP id p187so34445673qkd.1
        for <dev@httpd.apache.org>; Fri, 11 Dec 2015 03:56:22 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        bh=XuERerVDQBkiycMELBkaonuJXIokSC5ipMx7uHSEXtA=;
        b=XdATtlzEPYysKPEBYzvI43A2wIks5aVubDrjczVEJVHu6X72pptXVzOwhGrjgSzL8U
         B+od1vRztQT6UUMxLVezBbd5tcim31RFyCV4BY0WMgHEUvKTzb4VViYbbx8niyX5sQeN
         zYnelE5irqU1eEKpr03Ytbmei2AXs0mV+SQovOnrnlqQAZv6QZtTmpLToiktiZ0lOkS8
         ZTWkWtINzZuG6OK5sH7lk5vYyEzDXGWyMcS3SSz3yHDvSTNW98ciy9qP4KNUH3ePy/Ig
         CJoDyuFDhQWyawgchT4hOQ8DuCDixUSqZMm0FaYwxAxmfZ3+HCoGuBIg4t7MNRVJM22Y
         fQ2g==
MIME-Version: 1.0
X-Received: by 10.55.71.195 with SMTP id u186mr1024787qka.38.1449834982081;
 Fri, 11 Dec 2015 03:56:22 -0800 (PST)
Received: by 10.55.65.85 with HTTP; Fri, 11 Dec 2015 03:56:22 -0800 (PST)
In-Reply-To: <AD9BFA0F-C508-4DFE-8B4F-FF79D46D9D91@jaguNET.com>
References: <AD9BFA0F-C508-4DFE-8B4F-FF79D46D9D91@jaguNET.com>
Date: Fri, 11 Dec 2015 12:56:22 +0100
Message-ID: <CAKQ1sVMW-2CeZjgYDkdRmzk3shyQzF0Y6yJaBu=pwwyXG1p20Q@mail.gmail.com>
Subject: Re: [VOTE] Release Apache httpd 2.4.18 as GA
From: Yann Ylavic <ylavic.dev@gmail.com>
To: httpd-dev <dev@httpd.apache.org>
Content-Type: text/plain; charset=UTF-8

On Tue, Dec 8, 2015 at 9:38 PM, Jim Jagielski <jim@jagunet.com> wrote:
>
> I'm calling a VOTE on releasing these as Apache httpd 2.4.18 GA.
>
> [X] +1: Good to go

md5/sha1/pgp OK

Tested on:

* Debian 8.2 (Jessie)
=> All tests passed.

* Debian 7.9 (Wheezy)
=> All tests passed.

* Debian 6.0.10 (Squeeze)
=> No regression.

Thanks Jim from RMing.

From dev-return-85043-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Fri Dec 11 13:18:52 2015
Return-Path: <dev-return-85043-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 814E0180C0
	for <apmail-httpd-dev-archive@www.apache.org>; Fri, 11 Dec 2015 13:18:52 +0000 (UTC)
Received: (qmail 37605 invoked by uid 500); 11 Dec 2015 13:18:52 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 37253 invoked by uid 500); 11 Dec 2015 13:18:51 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 37242 invoked by uid 99); 11 Dec 2015 13:18:51 -0000
Received: from Unknown (HELO spamd2-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 11 Dec 2015 13:18:51 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd2-us-west.apache.org (ASF Mail Server at spamd2-us-west.apache.org) with ESMTP id 614B41A23CF
	for <dev@httpd.apache.org>; Fri, 11 Dec 2015 13:18:51 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd2-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.101
X-Spam-Level:
X-Spam-Status: No, score=-0.101 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RCVD_IN_MSPIKE_H2=-0.001, SPF_PASS=-0.001, URIBL_BLOCKED=0.001]
	autolearn=disabled
Authentication-Results: spamd2-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd2-us-west.apache.org [10.40.0.9]) (amavisd-new, port 10024)
	with ESMTP id CY9AX-_lt88m for <dev@httpd.apache.org>;
	Fri, 11 Dec 2015 13:18:45 +0000 (UTC)
Received: from mail-qg0-f47.google.com (mail-qg0-f47.google.com [209.85.192.47])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id 1019242963
	for <dev@httpd.apache.org>; Fri, 11 Dec 2015 13:18:45 +0000 (UTC)
Received: by qgcc31 with SMTP id c31so196308787qgc.3
        for <dev@httpd.apache.org>; Fri, 11 Dec 2015 05:18:44 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        bh=KYbvCugzZe9ys+9J4zPjbH+nMSsKpCgZAKa51Au4Qv8=;
        b=TpJlPDoxcr7qcFjzu5k9QKkVT5VhFG1qWcGbbl5kb1ms0KM+qtn49dSVXX+AMfQIGZ
         Fo3VmIUoqrC1Uu8hiyjUiQoRnRAfuET2IYFSIqVXkCvz6YFIhlNUocF5wVuvS7J4YXEi
         2vi8anKFMeZIR0d/0MwCjwoF+80qZFsdH1BuUzTHRJEhX7xnSV4jz5KKbafR34BiPM2o
         ZVw+PsMJKrYla4grL0dM9YQuO0N/3465FQtNTPg1l9eyEgD5pktGUm2w79l6dIlrS9lW
         o+QMSdzWlWkHwaAlu8jXAPwuM82foWpOiXaqlGXlMP5kgUEBjcsotOQgpDsTtPioNbcQ
         4Qjw==
MIME-Version: 1.0
X-Received: by 10.140.226.198 with SMTP id w189mr14817559qhb.83.1449839924623;
 Fri, 11 Dec 2015 05:18:44 -0800 (PST)
Received: by 10.55.65.85 with HTTP; Fri, 11 Dec 2015 05:18:44 -0800 (PST)
In-Reply-To: <482349A8-86D1-42EF-A436-C907BDF9DF7D@greenbytes.de>
References: <CACsi250=dbRQKnsbE8JSdAZRm5x99gE0sgX3iQ-PHAx77euD1A@mail.gmail.com>
	<AB1691BE05AE7F4992697F2A0835627AC63BAB94@VOEXM10W.internal.vodafone.com>
	<F7B20D30-D34A-4805-A77D-F64F6428F6E3@greenbytes.de>
	<56660896.c74fc20a.15f56.0ebd@mx.google.com>
	<56660B43.2060507@gmail.com>
	<6B13DF2B-0586-42BB-B62F-59A7638B697D@greenbytes.de>
	<13FE9E7F-9620-4BF9-8EA4-57A6314D66BF@greenbytes.de>
	<9CCEFD7E-9ED3-4ED1-8F58-2134DD5310F9@gbiv.com>
	<CACsi252y7nX0kR9+JgSra7Q_5_LVqaR3z6ExPKg=Lhi8zhN4ew@mail.gmail.com>
	<566887B5.2080705@gmail.com>
	<CACsi253sTRbX2dnuq0yRP1sHb8vOos_9QaoYmA3TtYmnNx-Erg@mail.gmail.com>
	<5668CC4F.109@gmail.com>
	<CACsi253q+GanuRzOqBjaOe-h1w8uOcH6uFAcdres=+ig5q6+VA@mail.gmail.com>
	<5668EFDB.1050900@gmail.com>
	<CACsi252HOz3_BO6hJtRTfM=M6oB0ZUXpSvkPmKs8LWP3LCz8xA@mail.gmail.com>
	<EC8AA057-325B-4176-88A8-D9E5073C7F32@greenbytes.de>
	<CAKQ1sVO0pade3_QMnftz38NajZ6v17+9CUz8PW_j3Zj2OvysZA@mail.gmail.com>
	<482349A8-86D1-42EF-A436-C907BDF9DF7D@greenbytes.de>
Date: Fri, 11 Dec 2015 14:18:44 +0100
Message-ID: <CAKQ1sVNMZ12kbvmcfz98ENJPN7BTL0vqM+rGu+Oxvx71BA53YA@mail.gmail.com>
Subject: Re: Upgrade Summary
From: Yann Ylavic <ylavic.dev@gmail.com>
To: httpd-dev <dev@httpd.apache.org>
Content-Type: text/plain; charset=UTF-8

On Fri, Dec 11, 2015 at 10:20 AM, Stefan Eissing
<stefan.eissing@greenbytes.de> wrote:
>
>> Am 11.12.2015 um 02:22 schrieb Yann Ylavic <ylavic.dev@gmail.com>:
>>
>> On Thu, Dec 10, 2015 at 11:46 AM, Stefan Eissing
>> <stefan.eissing@greenbytes.de> wrote:
>>> Given all the input on this thread, I arrive at the following pseudo code:
>>
>> Thanks for _compiling_ this thread, quite exhaustive :)
>
> Code often says more than a thousand...tokens.

++1 (though I won't propose code this time, possibly soon :p )

>
> Currently, TLS and current core step on each others toes when it
> comes to the Upgrade response header. This we should fix.

Agreed.

>
> If it turns out that TLS, h2c and websocket all need the actual
> switching at different phases of request processing, then we need
> to accomodate for that.
>
> What I can see:
> - TLS and h2c should switch in post_read_req
> - websocket should switch just before the handler phase

Yes, they could use one of those phase, their choice to hook wherever
they need to.

In my proposal, they'd rely on the core's Upgrade output filter being
in the chain (which will be the case since the core's
post_read_request (really-)first hook would have run).
The Upgrade output filter would catch the first brigade sent to the
client and issue the 101-Upgrade response first before removing itself
from the chain and forwarding the brigade.

- TLS (post_read_request):
0. make a decision when a request body exists (either bail out,
discard or return 413),
1. enable SSL/TLS engine and filters,
2. call ap_pass_brigade(FLUSH) for the Upgrade to occur,
3. return DECLINED.

- h2c/ws (wherever, post_read_request/[pre_]handler):
0. make a decision when a request body exists (either bail out,
discard or use it!),
1. run their process_request(),
2. return DONE.

As far as they use ap_{get,pass}_brigade() for reading/writing data
this should work.
They wouldn't do anything (ie. return DECLINED early) if
r->selected_protocol != their protocol.
If some headers are needed in the 101 response, one can fill in
r->headers_out for the core Upgrade output filter to use that when
Upgrading.

>
> Protocol implementations should make up their minds in the "propose" phase, I think,
> because once a protocol gets selected, the upgrade *should* succeed unless the
> connection catches fire or something. Not upgrading is better than failing.

Yes, all could be based on (communication via) current/selected proto
(set by the core!) for decisions, each module can use that to
determine if it was elected or not.
Whether the core Upgrade output filter would do the Upgrade or not can
be driven by a r->flag too (or anything else, special bucket, ...),
the module really handling the Protocols would set it unless the offer
is finally DECLINED (for some reason).

>> +        && ap_find_token(r->pool, upgrade, "TLS")
>> +        && !ap_has_request_body(r)) {
>> []
>
> I think the first way, don't Upgrade if you know it will not work, is better.

Agreed, let's do that in ssl_hook_ReadReq(), along with:
+        && !ap_has_request_body(r)
+        && !strcasecmp(r->selected_protocol, "TLS")) {
...

>>> 1. Post Read Request Hook:
>>>
>>>        if (Upgrade: request header present) {
>>>                collect protocol proposals;
>>>                ps = protocol with highest preference from proposals;
>>>                if (ps && ps != current) {
>>
>> Here I would use ap_add_output_filter(switch_protocol_filter, r); with
>> switch_protocol_filter() which would flush out the 101 response (or
>> not) based on r->need_upgrade and r->current_protocol, before any
>> Protocols data.
>
> I am not convinced that a flushing is necessary. If a protocol needs
> this, it can just pass out a flush bucket, or?

Yes, this is what I meant, as maybe better explained above.

>
> h2c needs to receive request body separate, get an indication
> that EOS for that body has been reached,

ap_discard_request_body()?

> and then continue reading
> HTTP/2 protocol data on the connection. I am not sure what is the
> best way to do that and, when upgrading on post_read_req hook, if
> all necessary request filters are in place by then.

I think so with my proposal, unless I'm missing something (which is
ofter the case ;)

>
>> For the headers in the 101 response, another hook called from
>> switch_protocol_filter() could be used.
>
> That'd be the pre_switch hook Jacob and I talked about and where he
> posted his implementation yesterday.

We wouldn't need it actually, as said above, why not simply use
r->headers_out while we are still HTTP/1...


Thanks for the feedbacks, Stefan.

From dev-return-85044-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Fri Dec 11 13:55:27 2015
Return-Path: <dev-return-85044-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id A1CB41824B
	for <apmail-httpd-dev-archive@www.apache.org>; Fri, 11 Dec 2015 13:55:27 +0000 (UTC)
Received: (qmail 8517 invoked by uid 500); 11 Dec 2015 13:55:27 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 8436 invoked by uid 500); 11 Dec 2015 13:55:27 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 8425 invoked by uid 99); 11 Dec 2015 13:55:27 -0000
Received: from Unknown (HELO spamd2-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 11 Dec 2015 13:55:27 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd2-us-west.apache.org (ASF Mail Server at spamd2-us-west.apache.org) with ESMTP id 9EA1F1A5ABA
	for <dev@httpd.apache.org>; Fri, 11 Dec 2015 13:55:26 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd2-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.102
X-Spam-Level:
X-Spam-Status: No, score=-0.102 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RCVD_IN_MSPIKE_H2=-0.001, SPF_PASS=-0.001] autolearn=disabled
Authentication-Results: spamd2-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd2-us-west.apache.org [10.40.0.9]) (amavisd-new, port 10024)
	with ESMTP id 9HYSmwjT2z5C for <dev@httpd.apache.org>;
	Fri, 11 Dec 2015 13:55:26 +0000 (UTC)
Received: from mail-qg0-f52.google.com (mail-qg0-f52.google.com [209.85.192.52])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id D1475429D0
	for <dev@httpd.apache.org>; Fri, 11 Dec 2015 13:55:25 +0000 (UTC)
Received: by qgcc31 with SMTP id c31so197154388qgc.3
        for <dev@httpd.apache.org>; Fri, 11 Dec 2015 05:55:25 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        bh=Fx7+tPU5W1zKAt7h84TSlw0ARQzz6E+iLJ1f3AVLD6g=;
        b=cysQQ2DQK2MKUv2s5Jjn0gcDnRBWHKSyBlYaSqgg+A9dKZvZ6f7oxbSELE/nDYuH92
         Lhv2t4iHAbGT3kXan2mtXXIXgOak9mxUuLNZPI/BUhRjeCMdSns/etDM35XeoRnhHZ2n
         JZ2tNCi9Pb34OmXEo952qij6sxODqtz40Yg5i4r5Owset5ULyXwLd5kDI5OzxylLUul9
         VrVVG1P2dVEbHyZ1QIfwbEYg3FOaFpFicMxV3Q3Y8jLO+H4prSnSCKrX/mVn5E87ehAb
         jOQl1ZMZisjTs+oEw/l0QEdsvkMURX//mx5NokIv3zyecooGRfKkPg7acgqhsQp0yVQG
         J0Wg==
MIME-Version: 1.0
X-Received: by 10.140.89.201 with SMTP id v67mr24064649qgd.38.1449842125395;
 Fri, 11 Dec 2015 05:55:25 -0800 (PST)
Received: by 10.55.65.85 with HTTP; Fri, 11 Dec 2015 05:55:25 -0800 (PST)
In-Reply-To: <20151211125733.30DDA3A01DC@svn01-us-west.apache.org>
References: <20151211125733.30DDA3A01DC@svn01-us-west.apache.org>
Date: Fri, 11 Dec 2015 14:55:25 +0100
Message-ID: <CAKQ1sVN4ztrisyr_mLKS2_aLtFhKi4aLBN2BFSuZ08+XDmy3Sw@mail.gmail.com>
Subject: Re: svn commit: r1719403 - in /httpd/httpd/trunk: CHANGES
 modules/http2/h2_conn.c modules/http2/h2_h2.c modules/http2/h2_io.c
 modules/http2/h2_io.h modules/http2/h2_mplx.c modules/http2/h2_stream.c
 modules/http2/h2_task.h modules/http2/h2_task_input.c
From: Yann Ylavic <ylavic.dev@gmail.com>
To: httpd-dev <dev@httpd.apache.org>
Content-Type: text/plain; charset=UTF-8

Hi Stefan,

On Fri, Dec 11, 2015 at 1:57 PM,  <icing@apache.org> wrote:
> Author: icing
> Date: Fri Dec 11 12:57:32 2015
> New Revision: 1719403
>
> URL: http://svn.apache.org/viewvc?rev=1719403&view=rev
> Log:
> fixed window update on chunked uploads, moved handling of chunking to later stage

Is that a showstopper?

From dev-return-85045-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Fri Dec 11 13:57:31 2015
Return-Path: <dev-return-85045-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 2A27718274
	for <apmail-httpd-dev-archive@www.apache.org>; Fri, 11 Dec 2015 13:57:31 +0000 (UTC)
Received: (qmail 18917 invoked by uid 500); 11 Dec 2015 13:57:30 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 18840 invoked by uid 500); 11 Dec 2015 13:57:30 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 18830 invoked by uid 99); 11 Dec 2015 13:57:30 -0000
Received: from Unknown (HELO spamd3-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 11 Dec 2015 13:57:30 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd3-us-west.apache.org (ASF Mail Server at spamd3-us-west.apache.org) with ESMTP id 3DA1A1809D3
	for <dev@httpd.apache.org>; Fri, 11 Dec 2015 13:57:30 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd3-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.655
X-Spam-Level:
X-Spam-Status: No, score=-0.655 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RP_MATCHES_RCVD=-0.554, SPF_PASS=-0.001] autolearn=disabled
Authentication-Results: spamd3-us-west.apache.org (amavisd-new);
	dkim=pass (1024-bit key) header.d=greenbytes.de
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd3-us-west.apache.org [10.40.0.10]) (amavisd-new, port 10024)
	with ESMTP id yJ9rRiF5tHFE for <dev@httpd.apache.org>;
	Fri, 11 Dec 2015 13:57:29 +0000 (UTC)
Received: from mail.greenbytes.de (mail.greenbytes.de [217.91.35.233])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id 77A272026F
	for <dev@httpd.apache.org>; Fri, 11 Dec 2015 13:57:28 +0000 (UTC)
Received: from [192.168.1.42] (unknown [217.91.35.233])
	(using TLSv1 with cipher ECDHE-RSA-AES256-SHA (256/256 bits))
	(Client did not present a certificate)
	by mail.greenbytes.de (Postfix) with ESMTPSA id DCC1515A0455
	for <dev@httpd.apache.org>; Fri, 11 Dec 2015 14:57:21 +0100 (CET)
DKIM-Signature: v=1; a=rsa-sha256; c=simple/simple; d=greenbytes.de; s=mail;
	t=1449842241; bh=tKI8/P5k3iRP3bkBRD4FJZSxNXnvB2z2MJdR1SVx24A=;
	h=Subject:From:In-Reply-To:Date:References:To:From;
	b=ioLW7whN6SwGc7dYuqkRD1Oortbt6Myx2Bub71D6aX23HAsYiySB3WwIRQscScqdT
	 K7T7ckcFCohbRcmXFakl9nSaoccbYINU2j8u6dZmDPtW39cuMOtmF9shBjMmDhYHd/
	 Z7ldhOrsjFrVnjVlSvKlZF2Kbl02rD8m3j4bB01Y=
Content-Type: text/plain; charset=us-ascii
Mime-Version: 1.0 (Mac OS X Mail 9.2 \(3112\))
Subject: Re: svn commit: r1719403 - in /httpd/httpd/trunk: CHANGES modules/http2/h2_conn.c modules/http2/h2_h2.c modules/http2/h2_io.c modules/http2/h2_io.h modules/http2/h2_mplx.c modules/http2/h2_stream.c modules/http2/h2_task.h modules/http2/h2_task_input.c
From: Stefan Eissing <stefan.eissing@greenbytes.de>
In-Reply-To: <CAKQ1sVN4ztrisyr_mLKS2_aLtFhKi4aLBN2BFSuZ08+XDmy3Sw@mail.gmail.com>
Date: Fri, 11 Dec 2015 14:57:21 +0100
Content-Transfer-Encoding: quoted-printable
Message-Id: <E3BC7A02-CF96-4BA0-95AB-0414DC178C7A@greenbytes.de>
References: <20151211125733.30DDA3A01DC@svn01-us-west.apache.org> <CAKQ1sVN4ztrisyr_mLKS2_aLtFhKi4aLBN2BFSuZ08+XDmy3Sw@mail.gmail.com>
To: dev@httpd.apache.org
X-Mailer: Apple Mail (2.3112)


> Am 11.12.2015 um 14:55 schrieb Yann Ylavic <ylavic.dev@gmail.com>:
>=20
> Hi Stefan,
>=20
> On Fri, Dec 11, 2015 at 1:57 PM,  <icing@apache.org> wrote:
>> Author: icing
>> Date: Fri Dec 11 12:57:32 2015
>> New Revision: 1719403
>>=20
>> URL: http://svn.apache.org/viewvc?rev=3D1719403&view=3Drev
>> Log:
>> fixed window update on chunked uploads, moved handling of chunking to =
later stage
>=20
> Is that a showstopper?

If something else comes up, I'd include it. But I would not stop the =
release for it.

//Stefan=

From dev-return-85046-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Fri Dec 11 14:00:47 2015
Return-Path: <dev-return-85046-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 73E37182A5
	for <apmail-httpd-dev-archive@www.apache.org>; Fri, 11 Dec 2015 14:00:47 +0000 (UTC)
Received: (qmail 23767 invoked by uid 500); 11 Dec 2015 14:00:47 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 23696 invoked by uid 500); 11 Dec 2015 14:00:46 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 23686 invoked by uid 99); 11 Dec 2015 14:00:46 -0000
Received: from Unknown (HELO spamd4-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 11 Dec 2015 14:00:46 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd4-us-west.apache.org (ASF Mail Server at spamd4-us-west.apache.org) with ESMTP id 7E88FC0052
	for <dev@httpd.apache.org>; Fri, 11 Dec 2015 14:00:46 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd4-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.101
X-Spam-Level:
X-Spam-Status: No, score=-0.101 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RCVD_IN_MSPIKE_H2=-0.001, SPF_PASS=-0.001, URIBL_BLOCKED=0.001]
	autolearn=disabled
Authentication-Results: spamd4-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-us-west.apache.org ([10.40.0.8])
	by localhost (spamd4-us-west.apache.org [10.40.0.11]) (amavisd-new, port 10024)
	with ESMTP id ypibIQt12uqv for <dev@httpd.apache.org>;
	Fri, 11 Dec 2015 14:00:41 +0000 (UTC)
Received: from mail-qg0-f45.google.com (mail-qg0-f45.google.com [209.85.192.45])
	by mx1-us-west.apache.org (ASF Mail Server at mx1-us-west.apache.org) with ESMTPS id CC13C2016B
	for <dev@httpd.apache.org>; Fri, 11 Dec 2015 14:00:40 +0000 (UTC)
Received: by qgcc31 with SMTP id c31so197282033qgc.3
        for <dev@httpd.apache.org>; Fri, 11 Dec 2015 06:00:34 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        bh=2xNkyzpK2yeD+LVMFRUYHxgimmHskOyUvxropHdG8r0=;
        b=Ue00NzcZdgCgCQD/+blwhsWM6mvWmaPtHOZqbkOnnnsHfzGw5N+bKo8f7meL+tr37d
         U0sOUTRu2InTTrrYt+ooF9leQiqEMMGXNDtYnzuRBDax+6912Siz5wUbpDabx+obXmFE
         s77UPkWKSpqOX+Ue84s1sjWrOOJpi9yQUhytEhJiXCLIAPkuwSU85EYkq6kL8q98Fcfl
         Q3msPutBeyBhRT7WyzOUBu32fdikGnRmx29/KgeMymp0JJ1eQuyx3RD20/bQo4BLHHTm
         MF/u0mqTdznfB6V5YNWmLwipAuG4gVhEK2steZ91X9hiclRbQhQ0BPOATKnZjKlS9D4I
         0y+w==
MIME-Version: 1.0
X-Received: by 10.140.101.51 with SMTP id t48mr24420927qge.71.1449842433988;
 Fri, 11 Dec 2015 06:00:33 -0800 (PST)
Received: by 10.55.65.85 with HTTP; Fri, 11 Dec 2015 06:00:33 -0800 (PST)
In-Reply-To: <E3BC7A02-CF96-4BA0-95AB-0414DC178C7A@greenbytes.de>
References: <20151211125733.30DDA3A01DC@svn01-us-west.apache.org>
	<CAKQ1sVN4ztrisyr_mLKS2_aLtFhKi4aLBN2BFSuZ08+XDmy3Sw@mail.gmail.com>
	<E3BC7A02-CF96-4BA0-95AB-0414DC178C7A@greenbytes.de>
Date: Fri, 11 Dec 2015 15:00:33 +0100
Message-ID: <CAKQ1sVMxyuN8rPrCW3cuQ-90_TTAEF-0Ju+uxH6xkbC37SNwOg@mail.gmail.com>
Subject: Re: svn commit: r1719403 - in /httpd/httpd/trunk: CHANGES
 modules/http2/h2_conn.c modules/http2/h2_h2.c modules/http2/h2_io.c
 modules/http2/h2_io.h modules/http2/h2_mplx.c modules/http2/h2_stream.c
 modules/http2/h2_task.h modules/http2/h2_task_input.c
From: Yann Ylavic <ylavic.dev@gmail.com>
To: httpd-dev <dev@httpd.apache.org>
Content-Type: text/plain; charset=UTF-8

On Fri, Dec 11, 2015 at 2:57 PM, Stefan Eissing
<stefan.eissing@greenbytes.de> wrote:
>
>> Am 11.12.2015 um 14:55 schrieb Yann Ylavic <ylavic.dev@gmail.com>:
>>
>> Hi Stefan,
>>
>> On Fri, Dec 11, 2015 at 1:57 PM,  <icing@apache.org> wrote:
>>> Author: icing
>>> Date: Fri Dec 11 12:57:32 2015
>>> New Revision: 1719403
>>>
>>> URL: http://svn.apache.org/viewvc?rev=1719403&view=rev
>>> Log:
>>> fixed window update on chunked uploads, moved handling of chunking to later stage
>>
>> Is that a showstopper?
>
> If something else comes up, I'd include it. But I would not stop the release for it.

OK, fine with me, thanks.

From dev-return-85047-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Fri Dec 11 16:13:07 2015
Return-Path: <dev-return-85047-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 81046187F0
	for <apmail-httpd-dev-archive@www.apache.org>; Fri, 11 Dec 2015 16:13:07 +0000 (UTC)
Received: (qmail 1355 invoked by uid 500); 11 Dec 2015 16:13:07 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 1281 invoked by uid 500); 11 Dec 2015 16:13:07 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 1270 invoked by uid 99); 11 Dec 2015 16:13:07 -0000
Received: from Unknown (HELO spamd3-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 11 Dec 2015 16:13:07 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd3-us-west.apache.org (ASF Mail Server at spamd3-us-west.apache.org) with ESMTP id 9D20C180A9A
	for <dev@httpd.apache.org>; Fri, 11 Dec 2015 16:13:06 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd3-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.02
X-Spam-Level:
X-Spam-Status: No, score=-0.02 tagged_above=-999 required=6.31
	tests=[RCVD_IN_MSPIKE_H3=-0.01, RCVD_IN_MSPIKE_WL=-0.01]
	autolearn=disabled
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd3-us-west.apache.org [10.40.0.10]) (amavisd-new, port 10024)
	with ESMTP id M8GGo5anuWpr for <dev@httpd.apache.org>;
	Fri, 11 Dec 2015 16:13:00 +0000 (UTC)
Received: from fed1rmfepo201.cox.net (fed1rmfepo201.cox.net [68.230.241.146])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTP id 8868442A73
	for <dev@httpd.apache.org>; Fri, 11 Dec 2015 16:12:59 +0000 (UTC)
Received: from fed1rmimpo210 ([68.230.241.161]) by fed1rmfepo201.cox.net
          (InterMail vM.8.01.05.15 201-2260-151-145-20131218) with ESMTP
          id <20151211161253.GVTZ5597.fed1rmfepo201.cox.net@fed1rmimpo210>
          for <dev@httpd.apache.org>; Fri, 11 Dec 2015 11:12:53 -0500
Received: from [192.168.1.33] ([98.176.34.113])
	by fed1rmimpo210 with cox
	id sGCr1r00U2STVfm01GCsTf; Fri, 11 Dec 2015 11:12:53 -0500
X-CT-Class: Clean
X-CT-Score: 0.00
X-CT-RefID: str=0001.0A020203.566AF605.01CF,ss=1,re=0.000,fgs=0
X-CT-Spam: 0
X-Authority-Analysis: v=2.0 cv=Hq2o7TvS c=1 sm=1
 a=8xCO7h6kmYZdHn5tUOQhsw==:17 a=LrjODJgKAAAA:8 a=mV9VRH-2AAAA:8
 a=rZxK0Be1zyEXHtl_65IA:9 a=QEXdDO2ut3YA:10 a=8xCO7h6kmYZdHn5tUOQhsw==:117
X-CM-Score: 0.00
Authentication-Results: cox.net; auth=pass (PLAIN) smtp.auth=glewis63@cox.net
Message-ID: <566AF5FE.4060401@gknw.net>
Date: Fri, 11 Dec 2015 08:12:46 -0800
From: Gregg Smith <gls@gknw.net>
User-Agent: Mozilla/5.0 (Windows; U; Windows NT 6.0; en-US; rv:1.9.2.28) Gecko/20120306 Thunderbird/3.1.20
MIME-Version: 1.0
To: dev@httpd.apache.org
Subject: Re: [VOTE] Release Apache httpd 2.4.18 as GA
References: <AD9BFA0F-C508-4DFE-8B4F-FF79D46D9D91@jaguNET.com>
In-Reply-To: <AD9BFA0F-C508-4DFE-8B4F-FF79D46D9D91@jaguNET.com>
Content-Type: text/plain; charset=UTF-8; format=flowed
Content-Transfer-Encoding: 7bit

+1 Various flavors of VC/Windows


On 12/8/2015 12:38 PM, Jim Jagielski wrote:
> The pre-release test tarballs for Apache httpd 2.4.18 can be found
> at the usual place:
>
> 	http://httpd.apache.org/dev/dist/
>
> I'm calling a VOTE on releasing these as Apache httpd 2.4.18 GA.
>
> [ ] +1: Good to go
> [ ] +0: meh
> [ ] -1: Danger Will Robinson. And why.
>
> Vote will last the normal 72 hrs.
>
> NOTE: The *-deps are only there for convenience.
>
> Thx!


From dev-return-85048-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Fri Dec 11 19:00:01 2015
Return-Path: <dev-return-85048-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 3D316181AA
	for <apmail-httpd-dev-archive@www.apache.org>; Fri, 11 Dec 2015 19:00:01 +0000 (UTC)
Received: (qmail 78966 invoked by uid 500); 11 Dec 2015 19:00:00 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 78896 invoked by uid 500); 11 Dec 2015 19:00:00 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 78878 invoked by uid 99); 11 Dec 2015 19:00:00 -0000
Received: from Unknown (HELO spamd1-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 11 Dec 2015 19:00:00 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd1-us-west.apache.org (ASF Mail Server at spamd1-us-west.apache.org) with ESMTP id 66A38CC2BA
	for <dev@httpd.apache.org>; Fri, 11 Dec 2015 19:00:00 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd1-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 0.653
X-Spam-Level:
X-Spam-Status: No, score=0.653 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, SPF_NEUTRAL=0.652,
	URIBL_BLOCKED=0.001] autolearn=disabled
Authentication-Results: spamd1-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=comcast.net
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd1-us-west.apache.org [10.40.0.7]) (amavisd-new, port 10024)
	with ESMTP id RsfIGwpeTGEW for <dev@httpd.apache.org>;
	Fri, 11 Dec 2015 18:59:51 +0000 (UTC)
Received: from resqmta-ch2-02v.sys.comcast.net (resqmta-ch2-02v.sys.comcast.net [69.252.207.34])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id 8C506439A9
	for <dev@httpd.apache.org>; Fri, 11 Dec 2015 18:59:51 +0000 (UTC)
Received: from resomta-ch2-08v.sys.comcast.net ([69.252.207.104])
	by resqmta-ch2-02v.sys.comcast.net with comcast
	id sJzT1r0062Fh1PH01Jzlee; Fri, 11 Dec 2015 18:59:45 +0000
Received: from [192.168.199.10] ([69.251.84.114])
	by resomta-ch2-08v.sys.comcast.net with comcast
	id sJzk1r00Q2U0RYt01JzkGT; Fri, 11 Dec 2015 18:59:45 +0000
Content-Type: text/plain; charset=us-ascii
Mime-Version: 1.0 (Mac OS X Mail 9.2 \(3112\))
Subject: Re: [VOTE] Release Apache httpd 2.4.18 as GA
From: Jim Jagielski <jim@jaguNET.com>
In-Reply-To: <AD9BFA0F-C508-4DFE-8B4F-FF79D46D9D91@jaguNET.com>
Date: Fri, 11 Dec 2015 13:59:44 -0500
Content-Transfer-Encoding: 7bit
Message-Id: <EC420E38-3384-4964-A180-817CD7C10F00@jaguNET.com>
References: <AD9BFA0F-C508-4DFE-8B4F-FF79D46D9D91@jaguNET.com>
To: dev@httpd.apache.org
X-Mailer: Apple Mail (2.3112)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=comcast.net;
	s=q20140121; t=1449860385;
	bh=mcAnLxXe5CKXcXZGJX7QSHS7jDKZVA2SUsp4JWextg0=;
	h=Received:Received:Content-Type:Mime-Version:Subject:From:Date:
	 Message-Id:To;
	b=dXSeuqhtXEcXvpOLsM8OD4L0KLE51I9V9eXfgwjiYULbdglizTJ8CcuIP+xdi0vJo
	 qI2mBpgFR3bE1/tB1BBrVllhkwZD3bHxfDcN7vXCBq+emkBtml0cOtEwfhpaD5Y2+4
	 fSUJ5dGquCXwPGZjhgzHSDM4yxI/MBkJpzkKFcXaynFVCrccRPbSEKSNXRsoGjEwIF
	 +OZEff4rlrhHgqWaEZIexeJSZlIPKUqW+NI2+rPEK+J+cKjdgfKHmQ0vKYTmTD7Vmp
	 pGrgPKYGNxWPU4o3lpWhBMkPcWjOyisl674lPiJZ0j4QtLnHCahrYqiEpR6XhO4TcH
	 ZhemLEJ85an2A==

Just a quick reminder that the voting closes in about 90mins.

tia!

> On Dec 8, 2015, at 3:38 PM, Jim Jagielski <jim@jaguNET.com> wrote:
> 
> The pre-release test tarballs for Apache httpd 2.4.18 can be found
> at the usual place:
> 
> 	http://httpd.apache.org/dev/dist/
> 
> I'm calling a VOTE on releasing these as Apache httpd 2.4.18 GA.
> 
> [ ] +1: Good to go
> [ ] +0: meh
> [ ] -1: Danger Will Robinson. And why.
> 
> Vote will last the normal 72 hrs.
> 
> NOTE: The *-deps are only there for convenience.
> 
> Thx!


From dev-return-85049-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Fri Dec 11 19:14:00 2015
Return-Path: <dev-return-85049-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id F22F818238
	for <apmail-httpd-dev-archive@www.apache.org>; Fri, 11 Dec 2015 19:13:59 +0000 (UTC)
Received: (qmail 13856 invoked by uid 500); 11 Dec 2015 19:13:59 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 13770 invoked by uid 500); 11 Dec 2015 19:13:59 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 13760 invoked by uid 99); 11 Dec 2015 19:13:59 -0000
Received: from Unknown (HELO spamd4-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 11 Dec 2015 19:13:59 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd4-us-west.apache.org (ASF Mail Server at spamd4-us-west.apache.org) with ESMTP id F3FBAC0FFD
	for <dev@httpd.apache.org>; Fri, 11 Dec 2015 19:13:58 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd4-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.102
X-Spam-Level:
X-Spam-Status: No, score=-0.102 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RCVD_IN_MSPIKE_H2=-0.001, SPF_PASS=-0.001] autolearn=disabled
Authentication-Results: spamd4-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd4-us-west.apache.org [10.40.0.11]) (amavisd-new, port 10024)
	with ESMTP id 3SMqGLq9lQhl for <dev@httpd.apache.org>;
	Fri, 11 Dec 2015 19:13:57 +0000 (UTC)
Received: from mail-pa0-f51.google.com (mail-pa0-f51.google.com [209.85.220.51])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id 0BB2121271
	for <dev@httpd.apache.org>; Fri, 11 Dec 2015 19:13:57 +0000 (UTC)
Received: by pabur14 with SMTP id ur14so69856068pab.0
        for <dev@httpd.apache.org>; Fri, 11 Dec 2015 11:13:55 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=subject:to:references:from:message-id:date:user-agent:mime-version
         :in-reply-to:content-type:content-transfer-encoding;
        bh=r3r6ApO89cPCzsbCZfcuKokPI6IOeUDFX8c5jRjbVrI=;
        b=XfcBh0Gfti/jwqLkntUxP4FyIrA3uQW7qa2h5oAjc73QWj4bqZSJzMV9xJLIcCKXUN
         vQmnENxkanroMiskpslKSKbOImsbNqbvgMlj14T/S+4mDkGaBP6g6FY1qCMFikNlbZzG
         CINlzxIZRcaMg8huSd7RYVjNWvGOoyqVsYqoHp2Hllv+N3Hh4WxOQkZasVkU0TXYbjuG
         QrBY1jPG29qsyXICV3Ns4taKb8CBnVSNXbzqFlzHIy9dPIkTqHXkZI7q34gYBhPZX73C
         eONOCzVhOocbQME27XhidzpthYEBUSxaf+ySIEJfGO3fFoJ6ib9q6WSs/nwhi8Hf71lG
         /QJw==
X-Received: by 10.66.154.161 with SMTP id vp1mr27030264pab.25.1449861235491;
        Fri, 11 Dec 2015 11:13:55 -0800 (PST)
Received: from [192.168.1.4] (50-39-117-165.bvtn.or.frontiernet.net. [50.39.117.165])
        by smtp.gmail.com with ESMTPSA id v2sm26692047pfi.44.2015.12.11.11.13.53
        for <dev@httpd.apache.org>
        (version=TLSv1/SSLv3 cipher=OTHER);
        Fri, 11 Dec 2015 11:13:54 -0800 (PST)
Subject: Re: Upgrade Summary
To: dev@httpd.apache.org
References: <CACsi250=dbRQKnsbE8JSdAZRm5x99gE0sgX3iQ-PHAx77euD1A@mail.gmail.com>
 <F7B20D30-D34A-4805-A77D-F64F6428F6E3@greenbytes.de>
 <56660896.c74fc20a.15f56.0ebd@mx.google.com> <56660B43.2060507@gmail.com>
 <6B13DF2B-0586-42BB-B62F-59A7638B697D@greenbytes.de>
 <13FE9E7F-9620-4BF9-8EA4-57A6314D66BF@greenbytes.de>
 <9CCEFD7E-9ED3-4ED1-8F58-2134DD5310F9@gbiv.com>
 <CACsi252y7nX0kR9+JgSra7Q_5_LVqaR3z6ExPKg=Lhi8zhN4ew@mail.gmail.com>
 <566887B5.2080705@gmail.com>
 <CACsi253sTRbX2dnuq0yRP1sHb8vOos_9QaoYmA3TtYmnNx-Erg@mail.gmail.com>
 <5668CC4F.109@gmail.com>
 <CACsi253q+GanuRzOqBjaOe-h1w8uOcH6uFAcdres=+ig5q6+VA@mail.gmail.com>
 <5668EFDB.1050900@gmail.com>
 <CACsi252HOz3_BO6hJtRTfM=M6oB0ZUXpSvkPmKs8LWP3LCz8xA@mail.gmail.com>
 <EC8AA057-325B-4176-88A8-D9E5073C7F32@greenbytes.de>
 <CAKQ1sVO0pade3_QMnftz38NajZ6v17+9CUz8PW_j3Zj2OvysZA@mail.gmail.com>
 <482349A8-86D1-42EF-A436-C907BDF9DF7D@greenbytes.de>
 <d3ce01d133ff$c50fa930$4f2efb90$@qqmail.nl>
From: Jacob Champion <champion.p@gmail.com>
Message-ID: <566B2071.4080108@gmail.com>
Date: Fri, 11 Dec 2015 11:13:53 -0800
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:38.0) Gecko/20100101
 Thunderbird/38.4.0
MIME-Version: 1.0
In-Reply-To: <d3ce01d133ff$c50fa930$4f2efb90$@qqmail.nl>
Content-Type: text/plain; charset=windows-1252; format=flowed
Content-Transfer-Encoding: 7bit

On 12/11/2015 02:36 AM, Bert Huijben wrote:
>> -----Original Message-----
>> From: Stefan Eissing [mailto:stefan.eissing@greenbytes.de]
>> Protocol implementations should make up their minds in the "propose"
>> phase, I think,
>> because once a protocol gets selected, the upgrade *should* succeed unless
>> the
>> connection catches fire or something. Not upgrading is better than
> failing.
>
> +1
> Not upgrading is 100% better than failing.

...except for those protocols for which failure instead of upgrade is 
*required* by their spec (e.g. WebSocket). Protocol switch 
implementations need to have the opportunity to fail after they have 
been selected for that reason, but of course the TLS and HTTP/2 
implementations should/would not make use of that.

> One other thing that sticks in my mind:
> Is it possible to upgrade to TLS in one request and to h2c later?

I believe so; is there anything in the specs that would make you think 
otherwise? An Upgrade: TLS by itself still results in an HTTP/1.1 
connection, which can respond to further upgrades, right?

I'll go further though: is it possible to upgrade to TLS and then to h2c 
in the *same* request?:

    Upgrade: TLS/1.2, h2c

> TLS and then websockets...
> I don't think that scenario should be supported either. Webbrowsers aren't
> going to use it... and dedicated clients probably use a direct connection of
> some sort instead of websockets.

IMHO, dedicated clients who are serious about WebSocket security will 
have connected via a wss:// connection instead of upgrading from an 
initially unsecure connection. (I'm not saying it's impossible to design 
a secure system that uses an upgrade, but the percentage of users who 
can get it 100% right is likely to be low.)

--Jacob

From dev-return-85050-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Fri Dec 11 20:07:13 2015
Return-Path: <dev-return-85050-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id A8CB018581
	for <apmail-httpd-dev-archive@www.apache.org>; Fri, 11 Dec 2015 20:07:13 +0000 (UTC)
Received: (qmail 77823 invoked by uid 500); 11 Dec 2015 20:07:12 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 77753 invoked by uid 500); 11 Dec 2015 20:07:12 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 77743 invoked by uid 99); 11 Dec 2015 20:07:12 -0000
Received: from Unknown (HELO spamd4-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 11 Dec 2015 20:07:12 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd4-us-west.apache.org (ASF Mail Server at spamd4-us-west.apache.org) with ESMTP id 41B62C0288
	for <dev@httpd.apache.org>; Fri, 11 Dec 2015 20:07:12 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd4-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.12
X-Spam-Level:
X-Spam-Status: No, score=-0.12 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RCVD_IN_MSPIKE_H3=-0.01, RCVD_IN_MSPIKE_WL=-0.01, SPF_PASS=-0.001,
	URIBL_BLOCKED=0.001] autolearn=disabled
Authentication-Results: spamd4-us-west.apache.org (amavisd-new);
	dkim=pass (1024-bit key) header.d=sevenval.com
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd4-us-west.apache.org [10.40.0.11]) (amavisd-new, port 10024)
	with ESMTP id 9lsQmoLhaTGQ for <dev@httpd.apache.org>;
	Fri, 11 Dec 2015 20:07:05 +0000 (UTC)
Received: from mail-ig0-f173.google.com (mail-ig0-f173.google.com [209.85.213.173])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id D8F36429C4
	for <dev@httpd.apache.org>; Fri, 11 Dec 2015 20:07:04 +0000 (UTC)
Received: by igcto18 with SMTP id to18so45957453igc.0
        for <dev@httpd.apache.org>; Fri, 11 Dec 2015 12:07:04 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=sevenval.com; s=google;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        bh=WCEM3OZSZi/C2NoAOE36PlY/mXrGCOVcLo1ZvmbRAMw=;
        b=XLxAV0LPo7+6C/fPMWHZDSDNs1PdHOwZj7FCfDYwBckMlweS4TY08f9jvwIDWChI9s
         C0kRR6YV876NWGTOhh9cw8Ui6AlWKrRDRD0xjFckCnbEtReJjhHU1lbfi7mK+ltEmvnl
         rcl2RbsGIVdz2StZqSkMptG2+D2AdmUeMD/Rc=
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=1e100.net; s=20130820;
        h=x-gm-message-state:mime-version:in-reply-to:references:date
         :message-id:subject:from:to:content-type;
        bh=WCEM3OZSZi/C2NoAOE36PlY/mXrGCOVcLo1ZvmbRAMw=;
        b=h3Kdm/+H9HosqoD+NQc1mpl1MRB2HUAU2KjFhCzVlQXhJ14dE2fIUMOEfPpdLuXVqG
         9gO98jE76BUwXAWy+HGCV8MTLs7Te2uH9T6ek8ezOzJV2Tj7xt70uzh65Xe1icFa+fXr
         W5PXSGKsSn4EuFkT2rHjSzqA4K/FNvneY2cbs8RXN1mPvJEoBZh4SEXIsyc0EG5mq6eN
         RIJ4zgdKRUMc7Ri2NbqszBNqqNZWnFVnrv4kvTgo59su5NaKgWAr+KO+R3D97rDeZe92
         phSHqHFVRUAt7TN4eQ2psidoS8NNipEaWtLcBIssW5y8DwyzUsWWemDcWKUhcntWniTO
         8sow==
X-Gm-Message-State: ALoCoQnRIHQBGF+22VEG7BHjl33H2hXpwv6zbpIRGnqOdGrTKfu+s/Wo2nLqlvxlf6m+1UcWiAc5NgGNQrrwb9ecbsOcrDxnZB83vsaFAt53y1RTddN1NA4=
MIME-Version: 1.0
X-Received: by 10.50.225.102 with SMTP id rj6mr6559659igc.95.1449864424315;
 Fri, 11 Dec 2015 12:07:04 -0800 (PST)
Received: by 10.50.150.36 with HTTP; Fri, 11 Dec 2015 12:07:04 -0800 (PST)
In-Reply-To: <EC420E38-3384-4964-A180-817CD7C10F00@jaguNET.com>
References: <AD9BFA0F-C508-4DFE-8B4F-FF79D46D9D91@jaguNET.com>
	<EC420E38-3384-4964-A180-817CD7C10F00@jaguNET.com>
Date: Fri, 11 Dec 2015 21:07:04 +0100
Message-ID: <CAN-a7TGNPLZww+BE0+5YV9_rMH5AJHZ2mbHOR8O5a5atyUoM1A@mail.gmail.com>
Subject: Re: [VOTE] Release Apache httpd 2.4.18 as GA
From: Rainer Canavan <rainer.canavan@sevenval.com>
To: dev@httpd.apache.org
Content-Type: text/plain; charset=UTF-8

2015-12-11 19:59 GMT+01:00 Jim Jagielski <jim@jagunet.com>:
> Just a quick reminder that the voting closes in about 90mins.
>
> tia!

builds and works according to my casual tests on IRIX mips as n32.

rainer

From dev-return-85051-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Fri Dec 11 20:13:10 2015
Return-Path: <dev-return-85051-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id D17D8185D3
	for <apmail-httpd-dev-archive@www.apache.org>; Fri, 11 Dec 2015 20:13:10 +0000 (UTC)
Received: (qmail 89085 invoked by uid 500); 11 Dec 2015 20:13:10 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 89008 invoked by uid 500); 11 Dec 2015 20:13:10 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 88992 invoked by uid 99); 11 Dec 2015 20:13:10 -0000
Received: from Unknown (HELO spamd4-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 11 Dec 2015 20:13:10 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd4-us-west.apache.org (ASF Mail Server at spamd4-us-west.apache.org) with ESMTP id 9051BC0288
	for <dev@httpd.apache.org>; Fri, 11 Dec 2015 20:13:09 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd4-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 2.999
X-Spam-Level: **
X-Spam-Status: No, score=2.999 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, HTML_MESSAGE=3,
	RCVD_IN_MSPIKE_H2=-0.001, SPF_PASS=-0.001, URIBL_BLOCKED=0.001]
	autolearn=disabled
Authentication-Results: spamd4-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=rowe-clan-net.20150623.gappssmtp.com
Received: from mx1-us-west.apache.org ([10.40.0.8])
	by localhost (spamd4-us-west.apache.org [10.40.0.11]) (amavisd-new, port 10024)
	with ESMTP id G5hNlCBuPHRi for <dev@httpd.apache.org>;
	Fri, 11 Dec 2015 20:13:02 +0000 (UTC)
Received: from mail-io0-f176.google.com (mail-io0-f176.google.com [209.85.223.176])
	by mx1-us-west.apache.org (ASF Mail Server at mx1-us-west.apache.org) with ESMTPS id 9B1D0265F4
	for <dev@httpd.apache.org>; Fri, 11 Dec 2015 20:13:00 +0000 (UTC)
Received: by iojd73 with SMTP id d73so20058966ioj.3
        for <dev@httpd.apache.org>; Fri, 11 Dec 2015 12:12:59 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=rowe-clan-net.20150623.gappssmtp.com; s=20150623;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        bh=izK08Yq1LxQRAtBwca0z70B4TXg6YmOElK607u6ojTM=;
        b=j6fsJEUscQrgnsRXL9Sr6dERbPXxOTyDUCHG5Lhahm6Usze7vLTlQkQlq+L5KTDyj/
         lf5Stu3EJA9+IxcI7KHaZyeUgiFn6usX1oZw0NvCAsqZKz2ZEaHhF/Myc51EWzImavBk
         H4m9dwwtjXjJhI2TGSRlIC5PZw+VO3Mzryhk3JfJR2f5dMybZrlqsdluIRzyxhWMW4me
         JS+wIBwF5C8viGxk1S4cA1pwiVyglDbPIMuvVG/CPfn25BEFt5GSHl11SJxAQzwveFSq
         hBlu1c9xBxvgbb+wjh1zMFOrbpCHED6+NnFxVSgrNcRhbOjexdFExCTc1GB6FzuQ+aBv
         BWAw==
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=1e100.net; s=20130820;
        h=x-gm-message-state:mime-version:in-reply-to:references:date
         :message-id:subject:from:to:content-type;
        bh=izK08Yq1LxQRAtBwca0z70B4TXg6YmOElK607u6ojTM=;
        b=KwS+fb/5ljkXG3WQczAjB1CgNs7Lqq71kBPRJ/tn4HN7O+6y1MyfKgXQigekIVi2xw
         HLhrakG3N0Wsse0qiKPHf8AWE0pTtBDwDldBuqZ7HTc/qcpzZjSoNwDd5uacV20RAISn
         f2Dx4sJnjLiJElWWXe18+N7F69xxC/v+AOZ6zGKvvoewkAuiyRTSG6j52o1zhbAPHLyg
         qcIcQDtxLxhExR38vMQ4VVqNkpwsX1cMimhyQcoPpM2SoxEDMlMCixwbNbRwSbXDa0KP
         cNBqD2BKVwqdJBsDb/MQlG/vCSpAYVn0n/6pOpWWK9t0gd4/xAhYd40CqAPF/inKFYrU
         tLvA==
X-Gm-Message-State: ALoCoQkxP+Rb+nsCi9e70lIpOrw1qWtDZEYIhAd++ePjGhiLKU53y8y6B5ZsBy8hpBs3shxwZcmmRt6YKpgSWa5sdCb0ADruHieid2ox0PafiCArrMABJLQ=
MIME-Version: 1.0
X-Received: by 10.107.10.66 with SMTP id u63mr17351470ioi.86.1449864779819;
 Fri, 11 Dec 2015 12:12:59 -0800 (PST)
Received: by 10.107.62.136 with HTTP; Fri, 11 Dec 2015 12:12:59 -0800 (PST)
In-Reply-To: <566B2071.4080108@gmail.com>
References: <CACsi250=dbRQKnsbE8JSdAZRm5x99gE0sgX3iQ-PHAx77euD1A@mail.gmail.com>
	<F7B20D30-D34A-4805-A77D-F64F6428F6E3@greenbytes.de>
	<56660896.c74fc20a.15f56.0ebd@mx.google.com>
	<56660B43.2060507@gmail.com>
	<6B13DF2B-0586-42BB-B62F-59A7638B697D@greenbytes.de>
	<13FE9E7F-9620-4BF9-8EA4-57A6314D66BF@greenbytes.de>
	<9CCEFD7E-9ED3-4ED1-8F58-2134DD5310F9@gbiv.com>
	<CACsi252y7nX0kR9+JgSra7Q_5_LVqaR3z6ExPKg=Lhi8zhN4ew@mail.gmail.com>
	<566887B5.2080705@gmail.com>
	<CACsi253sTRbX2dnuq0yRP1sHb8vOos_9QaoYmA3TtYmnNx-Erg@mail.gmail.com>
	<5668CC4F.109@gmail.com>
	<CACsi253q+GanuRzOqBjaOe-h1w8uOcH6uFAcdres=+ig5q6+VA@mail.gmail.com>
	<5668EFDB.1050900@gmail.com>
	<CACsi252HOz3_BO6hJtRTfM=M6oB0ZUXpSvkPmKs8LWP3LCz8xA@mail.gmail.com>
	<EC8AA057-325B-4176-88A8-D9E5073C7F32@greenbytes.de>
	<CAKQ1sVO0pade3_QMnftz38NajZ6v17+9CUz8PW_j3Zj2OvysZA@mail.gmail.com>
	<482349A8-86D1-42EF-A436-C907BDF9DF7D@greenbytes.de>
	<d3ce01d133ff$c50fa930$4f2efb90$@qqmail.nl>
	<566B2071.4080108@gmail.com>
Date: Fri, 11 Dec 2015 14:12:59 -0600
Message-ID: <CACsi251r2KxQ3dOgXOVfV9nOh-fmyVG0C0g2dS=h2qTMvrjqfw@mail.gmail.com>
Subject: Re: Upgrade Summary
From: William A Rowe Jr <wrowe@rowe-clan.net>
To: httpd <dev@httpd.apache.org>
Content-Type: multipart/alternative; boundary=001a113f93be2c9a770526a4f3f5

--001a113f93be2c9a770526a4f3f5
Content-Type: text/plain; charset=UTF-8

On Fri, Dec 11, 2015 at 1:13 PM, Jacob Champion <champion.p@gmail.com>
wrote:

> On 12/11/2015 02:36 AM, Bert Huijben wrote:
>
>> -----Original Message-----
>>> From: Stefan Eissing [mailto:stefan.eissing@greenbytes.de]
>>> Protocol implementations should make up their minds in the "propose"
>>> phase, I think,
>>> because once a protocol gets selected, the upgrade *should* succeed
>>> unless
>>> the
>>> connection catches fire or something. Not upgrading is better than
>>>
>> failing.
>>
>> +1
>> Not upgrading is 100% better than failing.
>>
>
> ...except for those protocols for which failure instead of upgrade is
> *required* by their spec (e.g. WebSocket).


No, no protocol overrides the HTTP/1 RFCs *until* 101-switching protocols
has occurred at which point the new protocol definition is in force, this
behavior is all defined by RFC7230 section 6.7.

If there is an http:// representation of the websocket resource, that is
served instead of the 101-switching protocols.  If there isn't such a
representation, then the request of course does fail :)


> Protocol switch implementations need to have the opportunity to fail after
> they have been selected for that reason, but of course the TLS and HTTP/2
> implementations should/would not make use of that.
>

Any module can cause a request to fail for any of hundreds of reasons, we
must avoid that logic in the Protocol API schema because the protocol
handler module can deal with this in any of the request hooks it likes and
is most appropriate for the failure case.

One other thing that sticks in my mind:
>> Is it possible to upgrade to TLS in one request and to h2c later?
>>
>
> I believe so; is there anything in the specs that would make you think
> otherwise? An Upgrade: TLS by itself still results in an HTTP/1.1
> connection, which can respond to further upgrades, right?
>

I was under the impression that particular case was disallowed by the
HTTP/2 RFC, but I could be mistaken.


> I'll go further though: is it possible to upgrade to TLS and then to h2c
> in the *same* request?:
>
>    Upgrade: TLS/1.2, h2c


By RFC 7230, yes (and in the order you illustrated - "if multiple protocol
layers are being switched, the sender MUST list the protocols in
layer-ascending order.").

But by RFC 7540 I think the answer is a clear "no"...

   A server MUST ignore an "h2" token in an Upgrade header field.
   Presence of a token with "h2" implies HTTP/2 over TLS, which is
   instead negotiated as described in Section 3.3
<https://tools.ietf.org/html/rfc7540#section-3.3>.


3.3 <https://tools.ietf.org/html/rfc7540#section-3.3>.  Starting
HTTP/2 for "https" URIs

   A client that makes a request to an "https" URI uses TLS [TLS12
<https://tools.ietf.org/html/rfc7540#ref-TLS12>] with
   the application-layer protocol negotiation (ALPN) extension
   [TLS-ALPN <https://tools.ietf.org/html/rfc7540#ref-TLS-ALPN>].

   HTTP/2 over TLS uses the "h2" protocol identifier.  The "h2c"
   protocol identifier MUST NOT be sent by a client or selected by a
   server; the "h2c" protocol identifier describes a protocol that does
   not use TLS.


In other words, there is one and only one recognized mechanism to establish
a TLS h2 connection.  I don't think we want to honor other mechanics.

TLS and then websockets...
>> I don't think that scenario should be supported either. Webbrowsers aren't
>> going to use it... and dedicated clients probably use a direct connection
>> of
>> some sort instead of websockets.
>>
>
> IMHO, dedicated clients who are serious about WebSocket security will have
> connected via a wss:// connection instead of upgrading from an initially
> unsecure connection. (I'm not saying it's impossible to design a secure
> system that uses an upgrade, but the percentage of users who can get it
> 100% right is likely to be low.)


Your call as a websocket implementer, but I'd be inclined to ignore this
combination
just as with TLS+h2c.

--001a113f93be2c9a770526a4f3f5
Content-Type: text/html; charset=UTF-8
Content-Transfer-Encoding: quoted-printable

<div dir=3D"ltr"><div class=3D"gmail_extra"><div class=3D"gmail_quote">On F=
ri, Dec 11, 2015 at 1:13 PM, Jacob Champion <span dir=3D"ltr">&lt;<a href=
=3D"mailto:champion.p@gmail.com" target=3D"_blank">champion.p@gmail.com</a>=
&gt;</span> wrote:<br><blockquote class=3D"gmail_quote" style=3D"margin:0px=
 0px 0px 0.8ex;border-left-width:1px;border-left-color:rgb(204,204,204);bor=
der-left-style:solid;padding-left:1ex"><span class=3D"">On 12/11/2015 02:36=
 AM, Bert Huijben wrote:<br>
</span><blockquote class=3D"gmail_quote" style=3D"margin:0px 0px 0px 0.8ex;=
border-left-width:1px;border-left-color:rgb(204,204,204);border-left-style:=
solid;padding-left:1ex"><blockquote class=3D"gmail_quote" style=3D"margin:0=
px 0px 0px 0.8ex;border-left-width:1px;border-left-color:rgb(204,204,204);b=
order-left-style:solid;padding-left:1ex"><span class=3D"">
-----Original Message-----<br>
From: Stefan Eissing [mailto:<a href=3D"mailto:stefan.eissing@greenbytes.de=
" target=3D"_blank">stefan.eissing@greenbytes.de</a>]<br></span><span class=
=3D"">
Protocol implementations should make up their minds in the &quot;propose&qu=
ot;<br>
phase, I think,<br>
because once a protocol gets selected, the upgrade *should* succeed unless<=
br>
the<br>
connection catches fire or something. Not upgrading is better than<br>
</span></blockquote><span class=3D"">
failing.<br>
<br>
+1<br>
Not upgrading is 100% better than failing.<br>
</span></blockquote>
<br>
...except for those protocols for which failure instead of upgrade is *requ=
ired* by their spec (e.g. WebSocket). </blockquote><div><br></div><div>No, =
no protocol overrides the HTTP/1 RFCs *until* 101-switching protocols has o=
ccurred at which point the new protocol definition is in force, this behavi=
or is all defined by RFC7230 section 6.7.</div><div><br></div><div>If there=
 is an http:// representation of the websocket resource, that is served ins=
tead of the 101-switching protocols.=C2=A0 If there isn&#39;t such a repres=
entation, then the request of course does fail :)</div><div>=C2=A0</div><bl=
ockquote class=3D"gmail_quote" style=3D"margin:0px 0px 0px 0.8ex;border-lef=
t-width:1px;border-left-color:rgb(204,204,204);border-left-style:solid;padd=
ing-left:1ex">Protocol switch implementations need to have the opportunity =
to fail after they have been selected for that reason, but of course the TL=
S and HTTP/2 implementations should/would not make use of that.<span class=
=3D""><br></span></blockquote><div><br></div><div>Any module can cause a re=
quest to fail for any of hundreds of reasons, we must avoid that logic in t=
he Protocol API schema because the protocol handler module can deal with th=
is in any of the request hooks it likes and is most appropriate for the fai=
lure case.</div><div><br></div><blockquote class=3D"gmail_quote" style=3D"m=
argin:0px 0px 0px 0.8ex;border-left-width:1px;border-left-color:rgb(204,204=
,204);border-left-style:solid;padding-left:1ex"><span class=3D"">
<blockquote class=3D"gmail_quote" style=3D"margin:0px 0px 0px 0.8ex;border-=
left-width:1px;border-left-color:rgb(204,204,204);border-left-style:solid;p=
adding-left:1ex">
One other thing that sticks in my mind:<br>
Is it possible to upgrade to TLS in one request and to h2c later?<br>
</blockquote>
<br></span>
I believe so; is there anything in the specs that would make you think othe=
rwise? An Upgrade: TLS by itself still results in an HTTP/1.1 connection, w=
hich can respond to further upgrades, right?<br></blockquote><div><br></div=
><div>I was under the impression that particular case was disallowed by the=
 HTTP/2 RFC, but I could be mistaken.=C2=A0</div><div>=C2=A0</div><blockquo=
te class=3D"gmail_quote" style=3D"margin:0px 0px 0px 0.8ex;border-left-widt=
h:1px;border-left-color:rgb(204,204,204);border-left-style:solid;padding-le=
ft:1ex">
I&#39;ll go further though: is it possible to upgrade to TLS and then to h2=
c in the *same* request?:<br>
<br>
=C2=A0 =C2=A0Upgrade: TLS/1.2, h2c</blockquote><div><br></div><div>By RFC 7=
230, yes (and in the order you illustrated - &quot;if multiple protocol lay=
ers are being switched, the sender MUST list the protocols in layer-ascendi=
ng order.&quot;).=C2=A0</div><div><br></div><div>But by RFC 7540 I think th=
e answer is a clear &quot;no&quot;...</div><div><br></div><div><pre class=
=3D"" style=3D"font-size:13.3333px;margin-top:0px;margin-bottom:0px;color:r=
gb(0,0,0)">   A server MUST ignore an &quot;h2&quot; token in an Upgrade he=
ader field.
   Presence of a token with &quot;h2&quot; implies HTTP/2 over TLS, which i=
s
   instead negotiated as described in <a href=3D"https://tools.ietf.org/htm=
l/rfc7540#section-3.3">Section 3.3</a>.</pre><pre class=3D"" style=3D"font-=
size:13.3333px;margin-top:0px;margin-bottom:0px;color:rgb(0,0,0)"><br></pre=
><pre class=3D"" style=3D"font-size:13.3333px;margin-top:0px;margin-bottom:=
0px;color:rgb(0,0,0)"><pre class=3D"" style=3D"font-size:13.3333px;margin-t=
op:0px;margin-bottom:0px"><span class=3D"" style=3D"line-height:0pt;display=
:inline;font-size:1em;font-weight:bold"><a class=3D"" name=3D"section-3.3" =
href=3D"https://tools.ietf.org/html/rfc7540#section-3.3" style=3D"color:bla=
ck;text-decoration:none">3.3</a>.  Starting HTTP/2 for &quot;https&quot; UR=
Is</span>

   A client that makes a request to an &quot;https&quot; URI uses TLS [<a h=
ref=3D"https://tools.ietf.org/html/rfc7540#ref-TLS12" title=3D"&quot;The Tr=
ansport Layer Security (TLS) Protocol Version 1.2&quot;">TLS12</a>] with
   the application-layer protocol negotiation (ALPN) extension
   [<a href=3D"https://tools.ietf.org/html/rfc7540#ref-TLS-ALPN" title=3D"&=
quot;Transport Layer Security (TLS) Application-Layer Protocol Negotiation =
Extension&quot;">TLS-ALPN</a>].

   HTTP/2 over TLS uses the &quot;h2&quot; protocol identifier.  The &quot;=
h2c&quot;
   protocol identifier MUST NOT be sent by a client or selected by a
   server; the &quot;h2c&quot; protocol identifier describes a protocol tha=
t does
   not use TLS.</pre></pre></div><div><br></div><div>In other words, there =
is one and only one recognized mechanism to establish=C2=A0</div><div>a TLS=
 h2 connection.=C2=A0 I don&#39;t think we want to honor other mechanics.</=
div><div><br></div><blockquote class=3D"gmail_quote" style=3D"margin:0px 0p=
x 0px 0.8ex;border-left-width:1px;border-left-color:rgb(204,204,204);border=
-left-style:solid;padding-left:1ex"><span class=3D"">
<blockquote class=3D"gmail_quote" style=3D"margin:0px 0px 0px 0.8ex;border-=
left-width:1px;border-left-color:rgb(204,204,204);border-left-style:solid;p=
adding-left:1ex">
TLS and then websockets...<br>
I don&#39;t think that scenario should be supported either. Webbrowsers are=
n&#39;t<br>
going to use it... and dedicated clients probably use a direct connection o=
f<br>
some sort instead of websockets.<br>
</blockquote>
<br></span>
IMHO, dedicated clients who are serious about WebSocket security will have =
connected via a wss:// connection instead of upgrading from an initially un=
secure connection. (I&#39;m not saying it&#39;s impossible to design a secu=
re system that uses an upgrade, but the percentage of users who can get it =
100% right is likely to be low.)</blockquote><div><br></div><div>Your call =
as a websocket implementer, but I&#39;d be inclined to ignore this combinat=
ion</div><div>just as with TLS+h2c.</div><div><br></div><div><br></div></di=
v><br></div></div>

--001a113f93be2c9a770526a4f3f5--

From dev-return-85052-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Fri Dec 11 20:21:44 2015
Return-Path: <dev-return-85052-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id C3C041860B
	for <apmail-httpd-dev-archive@www.apache.org>; Fri, 11 Dec 2015 20:21:44 +0000 (UTC)
Received: (qmail 9919 invoked by uid 500); 11 Dec 2015 20:21:44 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 9855 invoked by uid 500); 11 Dec 2015 20:21:44 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 9845 invoked by uid 99); 11 Dec 2015 20:21:44 -0000
Received: from Unknown (HELO spamd3-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 11 Dec 2015 20:21:44 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd3-us-west.apache.org (ASF Mail Server at spamd3-us-west.apache.org) with ESMTP id 94DE4180A9A
	for <dev@httpd.apache.org>; Fri, 11 Dec 2015 20:21:43 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd3-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.554
X-Spam-Level:
X-Spam-Status: No, score=-0.554 tagged_above=-999 required=6.31
	tests=[RP_MATCHES_RCVD=-0.554, SPF_PASS=-0.001, URIBL_BLOCKED=0.001]
	autolearn=disabled
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd3-us-west.apache.org [10.40.0.10]) (amavisd-new, port 10024)
	with ESMTP id cnUe7jOD9n33 for <dev@httpd.apache.org>;
	Fri, 11 Dec 2015 20:21:32 +0000 (UTC)
Received: from mailserver.kippdata.de (capsella.kippdata.de [195.227.30.149])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTP id DB74320B91
	for <dev@httpd.apache.org>; Fri, 11 Dec 2015 20:21:31 +0000 (UTC)
Received: from [10.0.110.6] ([192.168.2.104])
	by mailserver.kippdata.de (8.13.5/8.13.5) with ESMTP id tBBKLP83026194
	for <dev@httpd.apache.org>; Fri, 11 Dec 2015 21:21:25 +0100 (CET)
Subject: Re: [VOTE] Release Apache httpd 2.4.18 as GA
To: dev@httpd.apache.org
References: <AD9BFA0F-C508-4DFE-8B4F-FF79D46D9D91@jaguNET.com>
From: Rainer Jung <rainer.jung@kippdata.de>
Message-ID: <566B3043.2050607@kippdata.de>
Date: Fri, 11 Dec 2015 21:21:23 +0100
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:38.0) Gecko/20100101
 Thunderbird/38.4.0
MIME-Version: 1.0
In-Reply-To: <AD9BFA0F-C508-4DFE-8B4F-FF79D46D9D91@jaguNET.com>
Content-Type: text/plain; charset=utf-8; format=flowed
Content-Transfer-Encoding: 7bit

Am 08.12.2015 um 21:38 schrieb Jim Jagielski:
> The pre-release test tarballs for Apache httpd 2.4.18 can be found
> at the usual place:
>
> 	http://httpd.apache.org/dev/dist/
>
> I'm calling a VOTE on releasing these as Apache httpd 2.4.18 GA.
>
> [X] +1: Good to go
> [ ] +0: meh
> [ ] -1: Danger Will Robinson. And why.
>
> Vote will last the normal 72 hrs.

+1 to release and thank a bunch for RMing.

In short: No regressions found.

Detailed report:

- Sigs and hashes OK
- contents of tarballs identical
- contents of tag and tarballs identical
   except for expected deltas
   (we could cleanup some m4 files in apr-util/xml/expat/conftools
    at the end of buildconf, no regression)

Built on

- Solaris 8+10 Sparc as 32 Bit Binaries
- SLES 10+11 (64 Bits)
- RHEL 6 (64 Bits)

For all platforms built

- with default (shared), shared and static modules
- with module sets none, few, most, all, reallyall and default
   (always mod_privileges disabled)
- using --enable-load-all-modules
- against "included" APR/APU from deps tarball,
   plus external APR/APU 1.5.2/1.5.4

- using external libraries
   - expat 2.1.0 plus patch
   - pcre 8.37
   - openssl 1.0.2e
   - lua 5.2.4
   - distcache 1.5.1
   - libxml2 2.9.3
   - libnghttp2 1.5.0

- Tool chain:
     - platform gcc except for Solaris
       (gcc 4.4.4 for Solaris 8 and 4.9.2 for Solaris 10)
     - CFLAGS: -O2 -g -Wall -fno-strict-aliasing
               (and -mpcu=v9 on Solaris)

All builds succeeded
   - three compiler warning (2 regressions, one old)
       modules/http2/h2_conn_io.c:401:2: warning: no newline at end of file
       modules/ssl/ssl_engine_kernel.c:414:22: warning: variable 'hssc' 
set but not used [-Wunused-but-set-variable]
       modules/ssl/ssl_util_stapling.c:686: warning: 'ok' may be used 
uninitialized in this function

Tested for

- 343 build combinations
- Solaris 8+10 (32), SLES 10+11 (64), RHEL 6 (64)
- MPMs prefork, worker, event
   (except event on Solaris8, unsupported)
- default, shared and static modules
- log levels info, debug and trace8
- module set reallyall (122 modules plus MPMs)
- SLES 10 and RHEL 6 still ongoing but so far OK

The tests sometimes produce perl warnings:

- Use of uninitialized value in length at
   .../lib/perl5/Protocol/HTTP2/Stream.pm line 366.
   Printed at the start of the http2 test runs.
   Only on the Linux platform.

- Status read failed: at
   .../lib/perl5/Net/HTTP/Methods.pm line 289.
   Printed for test 1 and 3 of t/ssl/verify.t

The following test failures were seen:

a Test 4 or 5 in t/modules/dav.t:
   Happens for 37 out of 343 runs (14 on SLES 10, 13 on SLES 11,
   7 on RHEL 6, 2 on Solaris 8, 1 on Solaris 10).
   Creation, modified and now times not in the correct order.
   This seems to be a system issue, all tests done on NFS,
   many tested on virtualized guests.
   Not a regression.

b Various tests in t/apache/expr_string.t: (6, 11, 14, 17, 20 ,23)
   Happens for 50 out of 343 runs (45 on SLES 10, 3 on RHEL6,
   2 on Solaris 10).
   The failure is always on line 68, where the error_log contents
   are checked.
   Not a regression.

c Test 59 of t/modules/include.t only and always on
   Solaris.
   This is due to a bug in the test, which uses strftime()
   with a "%s" pattern that is not supported on Solaris.
   Until recently the server and the test client both returned
   verbatim "%s" and the test succeeded. After updating some
   Perl modules for the http2 tests, the perl client even
   on Solaris now supports "%s" in strftime and the test starts
   to fail. It seems we have to fix the test. Not a regression.

d Failure of t/modules/session.t on SLES 10.
   Warning: Use of "shift" without parentheses is ambiguous at line 39.
   Perl version is 5.8.8. The script uses a somewhat advances
   $x = shift // "NOTFOUND";
   construct, which seems to be ambiguous for old Perl (I had
   to look in the fine perl docs for the // operator).
   We could probably use a less elegant but more compatible
   construct instead. Not a regression.

e Failure of t/modules/http2.t: tests 11, 12, 15, 16, 45, 46
   Only 4 out of 343 runs fail, 3 on Solaris 8 one on RHEL 6.

   The failure always seems to be related with
   [cgid:error] End of script output before headers: necho.pl

Details for the 4 cases of http2 failures (I do have full logs incl. 
trace8 logs for two cases):

event-trace8-rhel6.x86_64-shared:

test case: TC0009, necho.pl without arguments: GET 
http://localhost:8544/modules/h2/necho.pl
# testing : response status
# expected: 400
# received: '500'
not ok 11
# testing : content comparision
# expected: '<html><body>
# <p>No query was specified.</p>
# </body></html>
# '
# received: '<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML 2.0//EN">
# <html><head>
# <title>500 Internal Server Error</title>
# </head><body>
# <h1>Internal Server Error</h1>
# <p>The server encountered an internal error or
# misconfiguration and was unable to complete
# your request.</p>
# <p>Please contact the server administrator at
#  you@example.com to inform them of the time this error occurred,
#  and the actions you performed just before this error.</p>
# <p>More information about this error may be available
# in the server error log.</p>
# </body></html>
# '
not ok 12

worker-debug-solaris8.sparc-shared:

test case: TC0014, necho.pl 10000x10: GET 
https://localhost:8545/modules/h2/necho.pl?count=10000&text=0123456789
# testing : response status
# expected: 200
# received: '500'
not ok 45
# testing : content-length
# expected: 100000
# received: 528
not ok 46

worker-info-solaris8.sparc-shared:

test case: TC0011, necho.pl 10x10: GET 
http://localhost:8544/modules/h2/necho.pl?count=10&text=0123456789
# testing : response status
# expected: 200
# received: '500'
not ok 15
# testing : content-length
# expected: 100
# received: 528
not ok 16

worker-trace8-solaris8.sparc-static:

test case: TC0014, necho.pl 10000x10: GET 
https://localhost:8545/modules/h2/necho.pl?count=10000&text=0123456789
# testing : response status
# expected: 200
# received: '500'
not ok 45
# testing : content-length
# expected: 100000
# received: 528
not ok 46

Regards,

Rainer

From dev-return-85053-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Fri Dec 11 20:55:32 2015
Return-Path: <dev-return-85053-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 020D31874E
	for <apmail-httpd-dev-archive@www.apache.org>; Fri, 11 Dec 2015 20:55:32 +0000 (UTC)
Received: (qmail 90021 invoked by uid 500); 11 Dec 2015 20:55:30 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 89950 invoked by uid 500); 11 Dec 2015 20:55:30 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 89940 invoked by uid 99); 11 Dec 2015 20:55:30 -0000
Received: from Unknown (HELO spamd4-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 11 Dec 2015 20:55:30 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd4-us-west.apache.org (ASF Mail Server at spamd4-us-west.apache.org) with ESMTP id 0FAF2C0052
	for <dev@httpd.apache.org>; Fri, 11 Dec 2015 20:55:30 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd4-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.102
X-Spam-Level:
X-Spam-Status: No, score=-0.102 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RCVD_IN_MSPIKE_H2=-0.001, SPF_PASS=-0.001] autolearn=disabled
Authentication-Results: spamd4-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd4-us-west.apache.org [10.40.0.11]) (amavisd-new, port 10024)
	with ESMTP id yXmCkB77vbZJ for <dev@httpd.apache.org>;
	Fri, 11 Dec 2015 20:55:29 +0000 (UTC)
Received: from mail-pf0-f182.google.com (mail-pf0-f182.google.com [209.85.192.182])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id 96556429D7
	for <dev@httpd.apache.org>; Fri, 11 Dec 2015 20:55:28 +0000 (UTC)
Received: by pfnn128 with SMTP id n128so71509904pfn.0
        for <dev@httpd.apache.org>; Fri, 11 Dec 2015 12:55:27 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=subject:to:references:from:message-id:date:user-agent:mime-version
         :in-reply-to:content-type:content-transfer-encoding;
        bh=11Ia9DbhEgW1+i0SBiHKCxmJt/wCNgk5/psIi9uZcVA=;
        b=EOklEOPtCzKaewwEAN13yE4/5DWZFEef7YrMGUpSiFd0Z2y9+0hPHNkE2nbxCM/JbY
         s+Mr0GdSIQXVckqrikFew3jB+2a2sNwJyw6fJh6mMwVv/Oh4lZQUqTGbSWTe3bWTDBut
         i4O2fWAcOqbaYPWyLmgEGLZseCnMcYCuQuCISahRVg7uHLy4uxaSt1YeaQ/Sk6U5OGIZ
         3JRZM0wycCq0mv55oCMT4a1+72A/jac69QdW92w+Dbotapqyb8EXHXsZe0uktScTvoXS
         wU0nY3sYnYkZORJOWnBIe8rfdEe+V+icrhtuficjwUOSm8EpdPslK9ERFW8aPjSnuHFU
         qvzQ==
X-Received: by 10.98.71.194 with SMTP id p63mr18277765pfi.66.1449867327721;
        Fri, 11 Dec 2015 12:55:27 -0800 (PST)
Received: from [192.168.1.4] (50-39-117-165.bvtn.or.frontiernet.net. [50.39.117.165])
        by smtp.gmail.com with ESMTPSA id c1sm27380180pas.1.2015.12.11.12.55.26
        for <dev@httpd.apache.org>
        (version=TLSv1/SSLv3 cipher=OTHER);
        Fri, 11 Dec 2015 12:55:26 -0800 (PST)
Subject: Re: Upgrade Summary
To: dev@httpd.apache.org
References: <CACsi250=dbRQKnsbE8JSdAZRm5x99gE0sgX3iQ-PHAx77euD1A@mail.gmail.com>
 <56660896.c74fc20a.15f56.0ebd@mx.google.com> <56660B43.2060507@gmail.com>
 <6B13DF2B-0586-42BB-B62F-59A7638B697D@greenbytes.de>
 <13FE9E7F-9620-4BF9-8EA4-57A6314D66BF@greenbytes.de>
 <9CCEFD7E-9ED3-4ED1-8F58-2134DD5310F9@gbiv.com>
 <CACsi252y7nX0kR9+JgSra7Q_5_LVqaR3z6ExPKg=Lhi8zhN4ew@mail.gmail.com>
 <566887B5.2080705@gmail.com>
 <CACsi253sTRbX2dnuq0yRP1sHb8vOos_9QaoYmA3TtYmnNx-Erg@mail.gmail.com>
 <5668CC4F.109@gmail.com>
 <CACsi253q+GanuRzOqBjaOe-h1w8uOcH6uFAcdres=+ig5q6+VA@mail.gmail.com>
 <5668EFDB.1050900@gmail.com>
 <CACsi252HOz3_BO6hJtRTfM=M6oB0ZUXpSvkPmKs8LWP3LCz8xA@mail.gmail.com>
 <EC8AA057-325B-4176-88A8-D9E5073C7F32@greenbytes.de>
 <CAKQ1sVO0pade3_QMnftz38NajZ6v17+9CUz8PW_j3Zj2OvysZA@mail.gmail.com>
 <482349A8-86D1-42EF-A436-C907BDF9DF7D@greenbytes.de>
 <d3ce01d133ff$c50fa930$4f2efb90$@qqmail.nl> <566B2071.4080108@gmail.com>
 <CACsi251r2KxQ3dOgXOVfV9nOh-fmyVG0C0g2dS=h2qTMvrjqfw@mail.gmail.com>
From: Jacob Champion <champion.p@gmail.com>
Message-ID: <566B383D.9010306@gmail.com>
Date: Fri, 11 Dec 2015 12:55:25 -0800
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:38.0) Gecko/20100101
 Thunderbird/38.4.0
MIME-Version: 1.0
In-Reply-To: <CACsi251r2KxQ3dOgXOVfV9nOh-fmyVG0C0g2dS=h2qTMvrjqfw@mail.gmail.com>
Content-Type: text/plain; charset=utf-8; format=flowed
Content-Transfer-Encoding: 7bit

On 12/11/2015 12:12 PM, William A Rowe Jr wrote:
> On Fri, Dec 11, 2015 at 1:13 PM, Jacob Champion <champion.p@gmail.com
> <mailto:champion.p@gmail.com>> wrote:
>
>     On 12/11/2015 02:36 AM, Bert Huijben wrote:
>         Not upgrading is 100% better than failing.
>
>     ...except for those protocols for which failure instead of upgrade
>     is *required* by their spec (e.g. WebSocket).
>
> No, no protocol overrides the HTTP/1 RFCs *until* 101-switching
> protocols has occurred at which point the new protocol definition is in
> force, this behavior is all defined by RFC7230 section 6.7.

That additional constraint doesn't conflict with any part of HTTP/1.1, 
as far as I can tell. Returning 4xx directly to an Upgrade request is 
allowed within HTTP/1.1, right? The spec says nothing about the internal 
server architecture.

> If there is an http:// representation of the websocket resource, that is
> served instead of the 101-switching protocols.  If there isn't such a
> representation, then the request of course does fail :)

I have to serve two masters here. All of the following are allowed by 
RFCs 723x, upon receiving a WebSocket upgrade offer:

1) Upgrade the connection to WebSocket.
2) Ignore the upgrade entirely, and continue processing as a normal HTTP 
request, which may or may not fail for any number of reasons.
3) Return a 4xx *immediately*. (This is allowed, in that it is not 
disallowed: from the point of view of 723x, it's as if the server 
ignored the upgrade but found something otherwise objectionable in the 
request.)

RFC 6455 removes 2) from my list of choices. There is no conflict 
between the specifications here, only a reduction in available options 
for the server.

>     Protocol switch implementations need to have the opportunity to fail
>     after they have been selected for that reason, but of course the TLS
>     and HTTP/2 implementations should/would not make use of that.
>
> Any module can cause a request to fail for any of hundreds of reasons,
> we must avoid that logic in the Protocol API schema because the protocol
> handler module can deal with this in any of the request hooks it likes
> and is most appropriate for the failure case.

As long as I can still satisfy 6455, I have no objection.

> In other words, there is one and only one recognized mechanism to establish
> a TLS h2 connection.  I don't think we want to honor other mechanics.

I'm inclined to agree.

>     IMHO, dedicated clients who are serious about WebSocket security
>     will have connected via a wss:// connection instead of upgrading
>     from an initially unsecure connection. (I'm not saying it's
>     impossible to design a secure system that uses an upgrade, but the
>     percentage of users who can get it 100% right is likely to be low.)
>
> Your call as a websocket implementer, but I'd be inclined to ignore this
> combination just as with TLS+h2c.

+1.

--Jacob


From dev-return-85054-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Fri Dec 11 21:39:15 2015
Return-Path: <dev-return-85054-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id B8AF21896F
	for <apmail-httpd-dev-archive@www.apache.org>; Fri, 11 Dec 2015 21:39:15 +0000 (UTC)
Received: (qmail 19978 invoked by uid 500); 11 Dec 2015 21:39:15 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 19904 invoked by uid 500); 11 Dec 2015 21:39:15 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 19894 invoked by uid 99); 11 Dec 2015 21:39:15 -0000
Received: from Unknown (HELO spamd2-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 11 Dec 2015 21:39:15 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd2-us-west.apache.org (ASF Mail Server at spamd2-us-west.apache.org) with ESMTP id ABDA01A5F55
	for <dev@httpd.apache.org>; Fri, 11 Dec 2015 21:39:14 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd2-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.101
X-Spam-Level:
X-Spam-Status: No, score=-0.101 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RCVD_IN_MSPIKE_H2=-0.001, SPF_PASS=-0.001, URIBL_BLOCKED=0.001]
	autolearn=disabled
Authentication-Results: spamd2-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd2-us-west.apache.org [10.40.0.9]) (amavisd-new, port 10024)
	with ESMTP id 4oLCT_Ab5LSz for <dev@httpd.apache.org>;
	Fri, 11 Dec 2015 21:39:09 +0000 (UTC)
Received: from mail-qg0-f44.google.com (mail-qg0-f44.google.com [209.85.192.44])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id 2B47520F5E
	for <dev@httpd.apache.org>; Fri, 11 Dec 2015 21:39:09 +0000 (UTC)
Received: by qgz52 with SMTP id 52so20028109qgz.1
        for <dev@httpd.apache.org>; Fri, 11 Dec 2015 13:39:01 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        bh=e0LnIMvrPZNgyDKWT05msR7lIxhiD0n3jdHkTYsY+F8=;
        b=dE6Ej83BZih9p0I5B+4hju9V6Q0Lqz9+qHsUXKwXe60ab9AhBCQ+7KfUOXi0tBgQH1
         p1olkDdI+Q1fTbo3xNAGkGJ+IOMisIwUA+8eDCd85373XLDQ+fIrFhIE/OfjlVUMDYM8
         IROKGv1RmmskWi50ZC0YQX+HtkwdS/fd+iZKmn63m0Q4TlzD+fVsw0NFY8UBVGmi7stL
         XPzkJucY0SFxBbYHnTa7XZjiNJ/T4C7jwxsRbtuX1JtkJLcEN3Yym9Wefv4ClSLmXHqi
         36T3diXBEKZcuoCuUYR8wfBmcW4yYXu+HCZ+4x8e31N2nIyrDZg+1vRWUmY5Z5+v2zAY
         +jnw==
MIME-Version: 1.0
X-Received: by 10.140.89.201 with SMTP id v67mr27270736qgd.38.1449869941769;
 Fri, 11 Dec 2015 13:39:01 -0800 (PST)
Received: by 10.55.65.85 with HTTP; Fri, 11 Dec 2015 13:39:01 -0800 (PST)
In-Reply-To: <566B3043.2050607@kippdata.de>
References: <AD9BFA0F-C508-4DFE-8B4F-FF79D46D9D91@jaguNET.com>
	<566B3043.2050607@kippdata.de>
Date: Fri, 11 Dec 2015 22:39:01 +0100
Message-ID: <CAKQ1sVO1B-tuonLNvtpJ0FJ8=wdErcgag_bx==p0bhT+S7ms8w@mail.gmail.com>
Subject: Re: [VOTE] Release Apache httpd 2.4.18 as GA
From: Yann Ylavic <ylavic.dev@gmail.com>
To: httpd-dev <dev@httpd.apache.org>
Content-Type: text/plain; charset=UTF-8

On Fri, Dec 11, 2015 at 9:21 PM, Rainer Jung <rainer.jung@kippdata.de> wrote:
>
>   - three compiler warning (2 regressions, one old)
[]
>       modules/ssl/ssl_engine_kernel.c:414:22: warning: variable 'hssc' set
> but not used [-Wunused-but-set-variable]

This one is harmless ('hssc' redeclared and used below in inner scope).
But I checked twice since handshakeserver (there) is not checked
against NULL like at the initialization.
Fortunately the !ssl path above handles the case, so this is simply a
double initialization (to the same value), likely optimized away
finally...

-Wunused-but-set-variable does its job, though.

From dev-return-85055-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Fri Dec 11 21:57:52 2015
Return-Path: <dev-return-85055-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id A5E9B18AD2
	for <apmail-httpd-dev-archive@www.apache.org>; Fri, 11 Dec 2015 21:57:52 +0000 (UTC)
Received: (qmail 59326 invoked by uid 500); 11 Dec 2015 21:57:52 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 59253 invoked by uid 500); 11 Dec 2015 21:57:52 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 59243 invoked by uid 99); 11 Dec 2015 21:57:52 -0000
Received: from Unknown (HELO spamd4-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 11 Dec 2015 21:57:52 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd4-us-west.apache.org (ASF Mail Server at spamd4-us-west.apache.org) with ESMTP id C5A38C0288
	for <dev@httpd.apache.org>; Fri, 11 Dec 2015 21:57:51 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd4-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.101
X-Spam-Level:
X-Spam-Status: No, score=-0.101 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RCVD_IN_MSPIKE_H2=-0.001, SPF_PASS=-0.001, URIBL_BLOCKED=0.001]
	autolearn=disabled
Authentication-Results: spamd4-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd4-us-west.apache.org [10.40.0.11]) (amavisd-new, port 10024)
	with ESMTP id j_y4B-qA8b_z for <dev@httpd.apache.org>;
	Fri, 11 Dec 2015 21:57:47 +0000 (UTC)
Received: from mail-qg0-f47.google.com (mail-qg0-f47.google.com [209.85.192.47])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id D19EB42963
	for <dev@httpd.apache.org>; Fri, 11 Dec 2015 21:57:46 +0000 (UTC)
Received: by qgew101 with SMTP id w101so3847325qge.2
        for <dev@httpd.apache.org>; Fri, 11 Dec 2015 13:57:46 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        bh=LX70vgeG7qJfI0Pz9C3avkKkkpraDSjjVBhDRaQ/3uQ=;
        b=RV3KduhtxTVo/PJBFmI1U3X+4Q03tYpLO349jyB685ddbFKIq0PjnnmZuj8aRXIN+S
         NLWfx+yHfRRtuLPVDAjdd3tJf95OulzJdhDJPwmyYOx1v/1h/r1ltdQjXdwcK56Ljme2
         acHRw2ADZlzRdAEu/TlmDU6dRkqu2iPBapzf6Ab9zUMx5JHmOgFqpI5ZNMIwhflOON4r
         W5iiDepfb3wXIHYVMTk79ezqaZp4S/N8CbNV9VNAC2jZCKWLxNDoZkJi9OEeWQeT46L+
         CM5VKqfeDHUukIk5PoT6va9Wvt5Q3jHgJ5QShd56AY5x5JTst96pFezI//4+ICzk1vZJ
         5OLQ==
MIME-Version: 1.0
X-Received: by 10.140.179.14 with SMTP id z14mr4329713qhz.70.1449871066686;
 Fri, 11 Dec 2015 13:57:46 -0800 (PST)
Received: by 10.55.65.85 with HTTP; Fri, 11 Dec 2015 13:57:46 -0800 (PST)
In-Reply-To: <CAKQ1sVO1B-tuonLNvtpJ0FJ8=wdErcgag_bx==p0bhT+S7ms8w@mail.gmail.com>
References: <AD9BFA0F-C508-4DFE-8B4F-FF79D46D9D91@jaguNET.com>
	<566B3043.2050607@kippdata.de>
	<CAKQ1sVO1B-tuonLNvtpJ0FJ8=wdErcgag_bx==p0bhT+S7ms8w@mail.gmail.com>
Date: Fri, 11 Dec 2015 22:57:46 +0100
Message-ID: <CAKQ1sVO57H9fzU2T2OFLw1FzSVeBvX+_JKkLdsasXGBCgoRBLA@mail.gmail.com>
Subject: Re: [VOTE] Release Apache httpd 2.4.18 as GA
From: Yann Ylavic <ylavic.dev@gmail.com>
To: httpd-dev <dev@httpd.apache.org>
Content-Type: text/plain; charset=UTF-8

On Fri, Dec 11, 2015 at 10:39 PM, Yann Ylavic <ylavic.dev@gmail.com> wrote:
> On Fri, Dec 11, 2015 at 9:21 PM, Rainer Jung <rainer.jung@kippdata.de> wrote:
>>
>>   - three compiler warning (2 regressions, one old)
> []
>>       modules/ssl/ssl_engine_kernel.c:414:22: warning: variable 'hssc' set
>> but not used [-Wunused-but-set-variable]
>
> This one is harmless ('hssc' redeclared and used below in inner scope).
> But I checked twice since handshakeserver (there) is not checked
> against NULL like at the initialization.
> Fortunately the !ssl path above handles the case, so this is simply a
> double initialization (to the same value), likely optimized away
> finally...
>
> -Wunused-but-set-variable does its job, though.

The original commit in trunk (r1709995) contained:
@@ -529,7 +672,6 @@ int ssl_hook_Access(request_rec *r)
      */
     if ((dc->nVerifyClient != SSL_CVERIFY_UNSET) ||
         (sc->server->auth.verify_mode != SSL_CVERIFY_UNSET)) {
-        SSLSrvConfigRec *hssc = mySrvConfig(handshakeserver);

         /* remember old state */
         verify_old = SSL_get_verify_mode(ssl);
--

But somehow the merge in 2.4.x (r1715255, from
2.4.17-protocols-changes branch?) does not.

Looks like a merge issue :/
Comparing files now...

From dev-return-85056-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Fri Dec 11 22:23:59 2015
Return-Path: <dev-return-85056-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 5E74518C19
	for <apmail-httpd-dev-archive@www.apache.org>; Fri, 11 Dec 2015 22:23:59 +0000 (UTC)
Received: (qmail 16761 invoked by uid 500); 11 Dec 2015 22:23:58 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 16693 invoked by uid 500); 11 Dec 2015 22:23:58 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 16683 invoked by uid 99); 11 Dec 2015 22:23:58 -0000
Received: from Unknown (HELO spamd4-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 11 Dec 2015 22:23:58 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd4-us-west.apache.org (ASF Mail Server at spamd4-us-west.apache.org) with ESMTP id 781AEC0288
	for <dev@httpd.apache.org>; Fri, 11 Dec 2015 22:23:58 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd4-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 0.653
X-Spam-Level:
X-Spam-Status: No, score=0.653 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, SPF_NEUTRAL=0.652,
	URIBL_BLOCKED=0.001] autolearn=disabled
Authentication-Results: spamd4-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=comcast.net
Received: from mx1-us-west.apache.org ([10.40.0.8])
	by localhost (spamd4-us-west.apache.org [10.40.0.11]) (amavisd-new, port 10024)
	with ESMTP id sCgK1BdP0VNL for <dev@httpd.apache.org>;
	Fri, 11 Dec 2015 22:23:49 +0000 (UTC)
Received: from resqmta-ch2-01v.sys.comcast.net (resqmta-ch2-01v.sys.comcast.net [69.252.207.33])
	by mx1-us-west.apache.org (ASF Mail Server at mx1-us-west.apache.org) with ESMTPS id A9044265D8
	for <dev@httpd.apache.org>; Fri, 11 Dec 2015 22:23:49 +0000 (UTC)
Received: from resomta-ch2-18v.sys.comcast.net ([69.252.207.114])
	by resqmta-ch2-01v.sys.comcast.net with comcast
	id sNPe1r0032Udklx01NPi2l; Fri, 11 Dec 2015 22:23:42 +0000
Received: from [192.168.199.10] ([69.251.84.114])
	by resomta-ch2-18v.sys.comcast.net with comcast
	id sNPi1r0062U0RYt01NPiGm; Fri, 11 Dec 2015 22:23:42 +0000
Content-Type: text/plain; charset=us-ascii
Mime-Version: 1.0 (Mac OS X Mail 9.2 \(3112\))
Subject: [RESULT] Was: [VOTE] Release Apache httpd 2.4.18 as GA
From: Jim Jagielski <jim@jaguNET.com>
In-Reply-To: <AD9BFA0F-C508-4DFE-8B4F-FF79D46D9D91@jaguNET.com>
Date: Fri, 11 Dec 2015 17:23:41 -0500
Content-Transfer-Encoding: 7bit
Message-Id: <244112C6-B101-4ED8-BD5B-D49580F35114@jaguNET.com>
References: <AD9BFA0F-C508-4DFE-8B4F-FF79D46D9D91@jaguNET.com>
To: dev@httpd.apache.org
X-Mailer: Apple Mail (2.3112)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=comcast.net;
	s=q20140121; t=1449872622;
	bh=vkQbtn7Pwvb0U9AcCjQ5Or/zRhIlYkRf+wYgR3QEbFY=;
	h=Received:Received:Content-Type:Mime-Version:Subject:From:Date:
	 Message-Id:To;
	b=DYHz5e6zuNgg4XP9YZa9bKDVJq3aSITRWWTcbnqdXZmGwQ1THc+ecEw0/mQ6kjlms
	 1rEPnZWztalOKd0BrWyBwcLiTMkth0ejQB5NuC+stsb0FoJL5sQBY6nnubKaMLy09/
	 fq6plUDeWBJPDtrVHBsBMzIM78Lfjh8ab5bMNImB65ZCUyhrqD6fxu8K8HBYyOBOVh
	 Ib0OlJBpTwv9oCrR4Dz0X3pmmLqBNoSFRlaIfiEEJ14Ms/hnz4vlu5FHZi1L7FAjJ6
	 HqpNdahdSAAF3kr0nCKlLUdObRf/VIbbLWR3jyB1bIlU5FPHXlws40u4R1+rI/zJ+N
	 kAqaERJ7X06sg==

With more than the required 3 +1 (binding) votes, I call
the VOTE closed with the result that the VOTE PASSES.

I will start moving the artifacts so the mirrors can collect
them over the weekend.

> On Dec 8, 2015, at 3:38 PM, Jim Jagielski <jim@jaguNET.com> wrote:
> 
> The pre-release test tarballs for Apache httpd 2.4.18 can be found
> at the usual place:
> 
> 	http://httpd.apache.org/dev/dist/
> 
> I'm calling a VOTE on releasing these as Apache httpd 2.4.18 GA.
> 
> [ ] +1: Good to go
> [ ] +0: meh
> [ ] -1: Danger Will Robinson. And why.
> 
> Vote will last the normal 72 hrs.
> 
> NOTE: The *-deps are only there for convenience.
> 
> Thx!


From dev-return-85057-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Fri Dec 11 22:24:38 2015
Return-Path: <dev-return-85057-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id BEB6E18C1D
	for <apmail-httpd-dev-archive@www.apache.org>; Fri, 11 Dec 2015 22:24:38 +0000 (UTC)
Received: (qmail 18003 invoked by uid 500); 11 Dec 2015 22:24:38 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 17945 invoked by uid 500); 11 Dec 2015 22:24:38 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 17934 invoked by uid 99); 11 Dec 2015 22:24:38 -0000
Received: from Unknown (HELO spamd3-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 11 Dec 2015 22:24:38 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd3-us-west.apache.org (ASF Mail Server at spamd3-us-west.apache.org) with ESMTP id 96DB0180A9A
	for <dev@httpd.apache.org>; Fri, 11 Dec 2015 22:24:37 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd3-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 2.999
X-Spam-Level: **
X-Spam-Status: No, score=2.999 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, HTML_MESSAGE=3,
	RCVD_IN_MSPIKE_H2=-0.001, SPF_PASS=-0.001, URIBL_BLOCKED=0.001]
	autolearn=disabled
Authentication-Results: spamd3-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=rowe-clan-net.20150623.gappssmtp.com
Received: from mx1-us-west.apache.org ([10.40.0.8])
	by localhost (spamd3-us-west.apache.org [10.40.0.10]) (amavisd-new, port 10024)
	with ESMTP id YYkSiVBBp4ue for <dev@httpd.apache.org>;
	Fri, 11 Dec 2015 22:24:28 +0000 (UTC)
Received: from mail-io0-f170.google.com (mail-io0-f170.google.com [209.85.223.170])
	by mx1-us-west.apache.org (ASF Mail Server at mx1-us-west.apache.org) with ESMTPS id A4DDE2016B
	for <dev@httpd.apache.org>; Fri, 11 Dec 2015 22:24:28 +0000 (UTC)
Received: by iojd73 with SMTP id d73so23250480ioj.3
        for <dev@httpd.apache.org>; Fri, 11 Dec 2015 14:24:28 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=rowe-clan-net.20150623.gappssmtp.com; s=20150623;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        bh=/o8jiy9yMylHNTJAo0/zEuHELIzpyF/iQvxQTIHDYdY=;
        b=dQ6ECQ14JZBfsSYSePT1Em4dpmrFkAWoX+HNqRl9Xtr6xhHcb4zYkn0BegRqgyi6bg
         nyumkGdbexc9gV/7IbuY0JgX3io/aL9vjcEHCIjUOe0cDc8wNYjGrEIQBP/oysnjMkVb
         OwytmzQ8Lft+crAOVywKKAegzCeLJrgNTAQluuqCZ/OZp+hTXkHKmKHQQzrJXS9bQmd8
         kaJzOg03LYNtBqUVl0Z1kUL+h0TDjLkdWdkSo2KWWXpC85A0tKHsWJUmWLX0pDkGVoiL
         kFKAB7YK0P8cgrqJMuijLRKmYrIc1PftatrkRJYR7poWmWS2G0q0NU44kQGA239Aj2ti
         eDnA==
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=1e100.net; s=20130820;
        h=x-gm-message-state:mime-version:in-reply-to:references:date
         :message-id:subject:from:to:content-type;
        bh=/o8jiy9yMylHNTJAo0/zEuHELIzpyF/iQvxQTIHDYdY=;
        b=UROaO/OgBZQB8C0GisYyZ9yGhgyOLd90FwjiCOYQyRnwm2QLBW0XWoNibIBVaOacpk
         wXIv0NLA9HWQWn3keRfSC+opZEJYv6DCBFepcMne3hSEr9nA3JXxil/LCoOWt4ziw8NF
         NN9OereyQ2FPfvOS36qJ5Je3EaJhRJjY5w4zbZ277Z09r9irXdLuotZdbGT9kwUXjSBy
         ztq9pP9kMh0LSu6KFryb9cGm5mpL2gwCgVt+BB6yfuDmooCO1WMbNmX1nQ3s9kT94WVz
         8lf3cP7XOuD77izucUey2OapvfthgHtR7zQ+G10q/dcp30poLxtbREqZ7TKzvgHFn0gd
         OsMA==
X-Gm-Message-State: ALoCoQlSZtDqzxgoz5D434uLgiXrYDkym5e6UEzWO9aGww740co1VYeD+fWgHSQbPzj+5A9SJ+VE2UEgKMSlLpbi40mKZCx0rVA0w9lxjXcxj2+4lCrcdwA=
MIME-Version: 1.0
X-Received: by 10.107.25.83 with SMTP id 80mr19173419ioz.163.1449872667990;
 Fri, 11 Dec 2015 14:24:27 -0800 (PST)
Received: by 10.107.62.136 with HTTP; Fri, 11 Dec 2015 14:24:27 -0800 (PST)
In-Reply-To: <566B383D.9010306@gmail.com>
References: <CACsi250=dbRQKnsbE8JSdAZRm5x99gE0sgX3iQ-PHAx77euD1A@mail.gmail.com>
	<56660896.c74fc20a.15f56.0ebd@mx.google.com>
	<56660B43.2060507@gmail.com>
	<6B13DF2B-0586-42BB-B62F-59A7638B697D@greenbytes.de>
	<13FE9E7F-9620-4BF9-8EA4-57A6314D66BF@greenbytes.de>
	<9CCEFD7E-9ED3-4ED1-8F58-2134DD5310F9@gbiv.com>
	<CACsi252y7nX0kR9+JgSra7Q_5_LVqaR3z6ExPKg=Lhi8zhN4ew@mail.gmail.com>
	<566887B5.2080705@gmail.com>
	<CACsi253sTRbX2dnuq0yRP1sHb8vOos_9QaoYmA3TtYmnNx-Erg@mail.gmail.com>
	<5668CC4F.109@gmail.com>
	<CACsi253q+GanuRzOqBjaOe-h1w8uOcH6uFAcdres=+ig5q6+VA@mail.gmail.com>
	<5668EFDB.1050900@gmail.com>
	<CACsi252HOz3_BO6hJtRTfM=M6oB0ZUXpSvkPmKs8LWP3LCz8xA@mail.gmail.com>
	<EC8AA057-325B-4176-88A8-D9E5073C7F32@greenbytes.de>
	<CAKQ1sVO0pade3_QMnftz38NajZ6v17+9CUz8PW_j3Zj2OvysZA@mail.gmail.com>
	<482349A8-86D1-42EF-A436-C907BDF9DF7D@greenbytes.de>
	<d3ce01d133ff$c50fa930$4f2efb90$@qqmail.nl>
	<566B2071.4080108@gmail.com>
	<CACsi251r2KxQ3dOgXOVfV9nOh-fmyVG0C0g2dS=h2qTMvrjqfw@mail.gmail.com>
	<566B383D.9010306@gmail.com>
Date: Fri, 11 Dec 2015 16:24:27 -0600
Message-ID: <CACsi251jRbJgEo4aP7AFe0Wfz4KWv8Zcbo6LMUAAkQDDqiJp9g@mail.gmail.com>
Subject: Re: Upgrade Summary
From: William A Rowe Jr <wrowe@rowe-clan.net>
To: httpd <dev@httpd.apache.org>
Content-Type: multipart/alternative; boundary=001a113fdbb45878aa0526a6c9c0

--001a113fdbb45878aa0526a6c9c0
Content-Type: text/plain; charset=UTF-8

On Fri, Dec 11, 2015 at 2:55 PM, Jacob Champion <champion.p@gmail.com>
wrote:

> On 12/11/2015 12:12 PM, William A Rowe Jr wrote:
>
>> On Fri, Dec 11, 2015 at 1:13 PM, Jacob Champion <champion.p@gmail.com
>> <mailto:champion.p@gmail.com>> wrote:
>>
>>     On 12/11/2015 02:36 AM, Bert Huijben wrote:
>>         Not upgrading is 100% better than failing.
>>
>>     ...except for those protocols for which failure instead of upgrade
>>     is *required* by their spec (e.g. WebSocket).
>>
>> No, no protocol overrides the HTTP/1 RFCs *until* 101-switching
>> protocols has occurred at which point the new protocol definition is in
>> force, this behavior is all defined by RFC7230 section 6.7.
>>
>
> That additional constraint doesn't conflict with any part of HTTP/1.1, as
> far as I can tell. Returning 4xx directly to an Upgrade request is allowed
> within HTTP/1.1, right? The spec says nothing about the internal server
> architecture.


The spec describes the exception handling;
  "A client MAY send a list of protocols in the Upgrade
   header field of a request to invite the server to switch to one or
   more of those protocols, in order of descending preference, before
   sending the final response.  A server MAY ignore a received Upgrade
   header field if it wishes to continue using the current protocol on
   that connection.  Upgrade cannot be used to insist on a protocol
   change."
Unambiguous, there is no "error" in not upgrading, period.

If there is no underlying HTTP/1.1 resource resulting from -not- upgrading
the response, or additional constraints are in place (e.g. upgrade required,
http/1 not honored etc) then those are outside of the scope of the Protocol
switch API and fall in the domain of the normal httpd request hook scope,
IMHO.


> If there is an http:// representation of the websocket resource, that is
>> served instead of the 101-switching protocols.  If there isn't such a
>> representation, then the request of course does fail :)
>>
>
> I have to serve two masters here. All of the following are allowed by RFCs
> 723x, upon receiving a WebSocket upgrade offer:
>
> 1) Upgrade the connection to WebSocket.
> 2) Ignore the upgrade entirely, and continue processing as a normal HTTP
> request, which may or may not fail for any number of reasons.
> 3) Return a 4xx *immediately*. (This is allowed, in that it is not
> disallowed: from the point of view of 723x, it's as if the server ignored
> the upgrade but found something otherwise objectionable in the request.)
>
> RFC 6455 removes 2) from my list of choices. There is no conflict between
> the specifications here, only a reduction in available options for the
> server.
>
>     Protocol switch implementations need to have the opportunity to fail
>>     after they have been selected for that reason, but of course the TLS
>>     and HTTP/2 implementations should/would not make use of that.
>>
>> Any module can cause a request to fail for any of hundreds of reasons,
>> we must avoid that logic in the Protocol API schema because the protocol
>> handler module can deal with this in any of the request hooks it likes
>> and is most appropriate for the failure case.
>>
>
> As long as I can still satisfy 6455, I have no objection.
>
> In other words, there is one and only one recognized mechanism to establish
>> a TLS h2 connection.  I don't think we want to honor other mechanics.
>>
>
> I'm inclined to agree.
>
>     IMHO, dedicated clients who are serious about WebSocket security
>>     will have connected via a wss:// connection instead of upgrading
>>     from an initially unsecure connection. (I'm not saying it's
>>     impossible to design a secure system that uses an upgrade, but the
>>     percentage of users who can get it 100% right is likely to be low.)
>>
>> Your call as a websocket implementer, but I'd be inclined to ignore this
>> combination just as with TLS+h2c.
>>
>
> +1.


I think we are essentially on the same page.  To the extent that any RFC6455
contradiction to RFC7230 is invalid, RFC7230 is binding, but it doesn't
look that
way to me.  From RFC6455 4.1,

   Once the client's opening handshake has been sent, the client MUST
   wait for a response from the server before sending any further data.
   The client MUST validate the server's response as follows:

   1.  If the status code received from the server is not 101, the
       client handles the response per HTTP [RFC2616
<https://tools.ietf.org/html/rfc2616>] procedures.  In
       particular, the client might perform authentication if it
       receives a 401 status code; the server might redirect the client
       using a 3xx status code (but clients are not required to follow
       them), etc.  Otherwise, proceed as follows.


In other words, in the absence of the websocket module declining to honor
the upgrade request, it still remains an http/1 request and response.
Whatever
auth or other technical details cause that request to fail will be
represented as
an http/1 response.  If the implementer wants to present a successful http/1
response to the request in lieu of establishing a websocket connection with
the corresponding 101-switching protocols, by offering a resource at the
given
URL, that option remains.  If there is no resource except a websocket at
that
URL, an error will occur.

I hope that makes things clearer?

--001a113fdbb45878aa0526a6c9c0
Content-Type: text/html; charset=UTF-8
Content-Transfer-Encoding: quoted-printable

<div dir=3D"ltr"><div class=3D"gmail_extra"><div class=3D"gmail_quote">On F=
ri, Dec 11, 2015 at 2:55 PM, Jacob Champion <span dir=3D"ltr">&lt;<a href=
=3D"mailto:champion.p@gmail.com" target=3D"_blank">champion.p@gmail.com</a>=
&gt;</span> wrote:<br><blockquote class=3D"gmail_quote" style=3D"margin:0px=
 0px 0px 0.8ex;border-left-width:1px;border-left-color:rgb(204,204,204);bor=
der-left-style:solid;padding-left:1ex"><span class=3D"">On 12/11/2015 12:12=
 PM, William A Rowe Jr wrote:<br>
</span><blockquote class=3D"gmail_quote" style=3D"margin:0px 0px 0px 0.8ex;=
border-left-width:1px;border-left-color:rgb(204,204,204);border-left-style:=
solid;padding-left:1ex"><span class=3D"">
On Fri, Dec 11, 2015 at 1:13 PM, Jacob Champion &lt;<a href=3D"mailto:champ=
ion.p@gmail.com" target=3D"_blank">champion.p@gmail.com</a><br></span><span=
 class=3D"">
&lt;mailto:<a href=3D"mailto:champion.p@gmail.com" target=3D"_blank">champi=
on.p@gmail.com</a>&gt;&gt; wrote:<br>
<br>
=C2=A0 =C2=A0 On 12/11/2015 02:36 AM, Bert Huijben wrote:<br></span><span c=
lass=3D"">
=C2=A0 =C2=A0 =C2=A0 =C2=A0 Not upgrading is 100% better than failing.<br>
<br>
=C2=A0 =C2=A0 ...except for those protocols for which failure instead of up=
grade<br>
=C2=A0 =C2=A0 is *required* by their spec (e.g. WebSocket).<br>
<br>
No, no protocol overrides the HTTP/1 RFCs *until* 101-switching<br>
protocols has occurred at which point the new protocol definition is in<br>
force, this behavior is all defined by RFC7230 section 6.7.<br>
</span></blockquote>
<br>
That additional constraint doesn&#39;t conflict with any part of HTTP/1.1, =
as far as I can tell. Returning 4xx directly to an Upgrade request is allow=
ed within HTTP/1.1, right? The spec says nothing about the internal server =
architecture.</blockquote><div><br></div><div>The spec describes the except=
ion handling;=C2=A0</div><div>=C2=A0 &quot;A client MAY send a list of prot=
ocols in the Upgrade</div><div>=C2=A0 =C2=A0header field of a request to in=
vite the server to switch to one or</div><div>=C2=A0 =C2=A0more of those pr=
otocols, in order of descending preference, before</div><div>=C2=A0 =C2=A0s=
ending the final response.=C2=A0 A server MAY ignore a received Upgrade</di=
v><div>=C2=A0 =C2=A0header field if it wishes to continue using the current=
 protocol on</div><div>=C2=A0 =C2=A0that connection.=C2=A0 Upgrade cannot b=
e used to insist on a protocol</div><div>=C2=A0 =C2=A0change.&quot;</div><d=
iv>Unambiguous, there is no &quot;error&quot; in not upgrading, period.</di=
v><div><br></div><div>If there is no underlying HTTP/1.1 resource resulting=
 from -not- upgrading</div><div>the response, or additional constraints are=
 in place (e.g. upgrade required,</div><div>http/1 not honored etc) then th=
ose are outside of the scope of the Protocol</div><div>switch API and fall =
in the domain of the normal httpd request hook scope,</div><div>IMHO.</div>=
<div>=C2=A0</div><blockquote class=3D"gmail_quote" style=3D"margin:0px 0px =
0px 0.8ex;border-left-width:1px;border-left-color:rgb(204,204,204);border-l=
eft-style:solid;padding-left:1ex"><span class=3D"">
<blockquote class=3D"gmail_quote" style=3D"margin:0px 0px 0px 0.8ex;border-=
left-width:1px;border-left-color:rgb(204,204,204);border-left-style:solid;p=
adding-left:1ex">
If there is an http:// representation of the websocket resource, that is<br=
>
served instead of the 101-switching protocols.=C2=A0 If there isn&#39;t suc=
h a<br>
representation, then the request of course does fail :)<br>
</blockquote>
<br></span>
I have to serve two masters here. All of the following are allowed by RFCs =
723x, upon receiving a WebSocket upgrade offer:<br>
<br>
1) Upgrade the connection to WebSocket.<br>
2) Ignore the upgrade entirely, and continue processing as a normal HTTP re=
quest, which may or may not fail for any number of reasons.<br>
3) Return a 4xx *immediately*. (This is allowed, in that it is not disallow=
ed: from the point of view of 723x, it&#39;s as if the server ignored the u=
pgrade but found something otherwise objectionable in the request.)<br>
<br>
RFC 6455 removes 2) from my list of choices. There is no conflict between t=
he specifications here, only a reduction in available options for the serve=
r.<span class=3D""><br>
<br>
<blockquote class=3D"gmail_quote" style=3D"margin:0px 0px 0px 0.8ex;border-=
left-width:1px;border-left-color:rgb(204,204,204);border-left-style:solid;p=
adding-left:1ex">
=C2=A0 =C2=A0 Protocol switch implementations need to have the opportunity =
to fail<br>
=C2=A0 =C2=A0 after they have been selected for that reason, but of course =
the TLS<br>
=C2=A0 =C2=A0 and HTTP/2 implementations should/would not make use of that.=
<br>
<br>
Any module can cause a request to fail for any of hundreds of reasons,<br>
we must avoid that logic in the Protocol API schema because the protocol<br=
>
handler module can deal with this in any of the request hooks it likes<br>
and is most appropriate for the failure case.<br>
</blockquote>
<br></span>
As long as I can still satisfy 6455, I have no objection.<span class=3D""><=
br>
<br>
<blockquote class=3D"gmail_quote" style=3D"margin:0px 0px 0px 0.8ex;border-=
left-width:1px;border-left-color:rgb(204,204,204);border-left-style:solid;p=
adding-left:1ex">
In other words, there is one and only one recognized mechanism to establish=
<br>
a TLS h2 connection.=C2=A0 I don&#39;t think we want to honor other mechani=
cs.<br>
</blockquote>
<br></span>
I&#39;m inclined to agree.<span class=3D""><br>
<br>
<blockquote class=3D"gmail_quote" style=3D"margin:0px 0px 0px 0.8ex;border-=
left-width:1px;border-left-color:rgb(204,204,204);border-left-style:solid;p=
adding-left:1ex">
=C2=A0 =C2=A0 IMHO, dedicated clients who are serious about WebSocket secur=
ity<br>
=C2=A0 =C2=A0 will have connected via a wss:// connection instead of upgrad=
ing<br>
=C2=A0 =C2=A0 from an initially unsecure connection. (I&#39;m not saying it=
&#39;s<br>
=C2=A0 =C2=A0 impossible to design a secure system that uses an upgrade, bu=
t the<br>
=C2=A0 =C2=A0 percentage of users who can get it 100% right is likely to be=
 low.)<br>
<br>
Your call as a websocket implementer, but I&#39;d be inclined to ignore thi=
s<br>
combination just as with TLS+h2c.<br>
</blockquote>
<br></span>
+1.</blockquote><div><br></div><div>I think we are essentially on the same =
page.=C2=A0 To the extent that any RFC6455</div><div>contradiction to RFC72=
30 is invalid, RFC7230 is binding, but it doesn&#39;t look that</div><div>w=
ay to me.=C2=A0 From RFC6455 4.1,</div><div><br></div><div><pre class=3D"" =
style=3D"font-size:13.3333px;margin-top:0px;margin-bottom:0px;color:rgb(0,0=
,0)">   Once the client&#39;s opening handshake has been sent, the client M=
UST
   wait for a response from the server before sending any further data.
   The client MUST validate the server&#39;s response as follows:

   1.  If the status code received from the server is not 101, the
       client handles the response per HTTP [<a href=3D"https://tools.ietf.=
org/html/rfc2616" title=3D"&quot;Hypertext Transfer Protocol -- HTTP/1.1&qu=
ot;">RFC2616</a>] procedures.  In
       particular, the client might perform authentication if it
       receives a 401 status code; the server might redirect the client
       using a 3xx status code (but clients are not required to follow
       them), etc.  Otherwise, proceed as follows.</pre></div><div>=C2=A0</=
div></div>In other words, in the absence of the websocket module declining =
to honor</div><div class=3D"gmail_extra">the upgrade request, it still rema=
ins an http/1 request and response.=C2=A0 Whatever</div><div class=3D"gmail=
_extra">auth or other technical details cause that request to fail will be =
represented as</div><div class=3D"gmail_extra">an http/1 response.=C2=A0 If=
 the implementer wants to present a successful http/1</div><div class=3D"gm=
ail_extra">response to the request in lieu of establishing a websocket conn=
ection with</div><div class=3D"gmail_extra">the corresponding 101-switching=
 protocols, by offering a resource at the given</div><div class=3D"gmail_ex=
tra">URL, that option remains.=C2=A0 If there is no resource except a webso=
cket at that</div><div class=3D"gmail_extra">URL, an error will occur.</div=
><div class=3D"gmail_extra"><br></div><div class=3D"gmail_extra">I hope tha=
t makes things clearer?</div><div class=3D"gmail_extra"><br></div><div clas=
s=3D"gmail_extra"><br></div><div class=3D"gmail_extra"><br></div><div class=
=3D"gmail_extra"><br></div></div>

--001a113fdbb45878aa0526a6c9c0--

From dev-return-85058-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Fri Dec 11 22:48:08 2015
Return-Path: <dev-return-85058-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 80EAB18D5E
	for <apmail-httpd-dev-archive@www.apache.org>; Fri, 11 Dec 2015 22:48:08 +0000 (UTC)
Received: (qmail 86269 invoked by uid 500); 11 Dec 2015 22:48:07 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 86195 invoked by uid 500); 11 Dec 2015 22:48:07 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 86182 invoked by uid 99); 11 Dec 2015 22:48:07 -0000
Received: from Unknown (HELO spamd3-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 11 Dec 2015 22:48:07 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd3-us-west.apache.org (ASF Mail Server at spamd3-us-west.apache.org) with ESMTP id 0500B180A9A
	for <dev@httpd.apache.org>; Fri, 11 Dec 2015 22:48:07 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd3-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.099
X-Spam-Level:
X-Spam-Status: No, score=-0.099 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	URIBL_BLOCKED=0.001] autolearn=disabled
Authentication-Results: spamd3-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-us-west.apache.org ([10.40.0.8])
	by localhost (spamd3-us-west.apache.org [10.40.0.10]) (amavisd-new, port 10024)
	with ESMTP id lBlhN7JCLwDK for <dev@httpd.apache.org>;
	Fri, 11 Dec 2015 22:47:56 +0000 (UTC)
Received: from mail-pa0-f50.google.com (mail-pa0-f50.google.com [209.85.220.50])
	by mx1-us-west.apache.org (ASF Mail Server at mx1-us-west.apache.org) with ESMTPS id 3EDC5265D8
	for <dev@httpd.apache.org>; Fri, 11 Dec 2015 22:47:56 +0000 (UTC)
Received: by padhk6 with SMTP id hk6so31875447pad.2
        for <dev@httpd.apache.org>; Fri, 11 Dec 2015 14:47:50 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=subject:to:references:from:message-id:date:user-agent:mime-version
         :in-reply-to:content-type:content-transfer-encoding;
        bh=z6D366GYR4Q9dJdx/3ylvp20g0JzV8cmnWIWyC5JL1I=;
        b=R5pO94qtwNwwIAQBsvbv0s3iRzeV4Qh0LIKptT+hwlSsVf9LrXaeeO+ASsKKiOTYl2
         snKWAZSSKPf8X/07sfo4AILCesRurap7xpqyuRUQ/F/i6GDrVezDwezMCYh2/vjioztN
         7X7tjaBKecMhR4N4t2MuEeiL6hyQ3R30YsJPkRQI/oNcbdShjMtLdJ5OVdsRlvOHB4Ec
         ZQ3cVIKLBYB1qJqAgb8m2FB4l6o505fG5aqvZIZ/52OPstbiOjNOMpYji5gVuAc1YDjc
         0kZ7F9heNLSokc2LXT2RfPvBZQzkRgRNDZsBGV5YrX5xCHtCCsDjLkgEK+W+L88pgSZ/
         om5Q==
X-Received: by 10.66.216.200 with SMTP id os8mr28712216pac.143.1449874070021;
        Fri, 11 Dec 2015 14:47:50 -0800 (PST)
Received: from [192.168.1.4] (50-39-117-165.bvtn.or.frontiernet.net. [50.39.117.165])
        by smtp.gmail.com with ESMTPSA id e14sm25188403pap.24.2015.12.11.14.47.48
        for <dev@httpd.apache.org>
        (version=TLSv1/SSLv3 cipher=OTHER);
        Fri, 11 Dec 2015 14:47:48 -0800 (PST)
Subject: Re: Upgrade Summary
To: dev@httpd.apache.org
References: <CACsi250=dbRQKnsbE8JSdAZRm5x99gE0sgX3iQ-PHAx77euD1A@mail.gmail.com>
 <13FE9E7F-9620-4BF9-8EA4-57A6314D66BF@greenbytes.de>
 <9CCEFD7E-9ED3-4ED1-8F58-2134DD5310F9@gbiv.com>
 <CACsi252y7nX0kR9+JgSra7Q_5_LVqaR3z6ExPKg=Lhi8zhN4ew@mail.gmail.com>
 <566887B5.2080705@gmail.com>
 <CACsi253sTRbX2dnuq0yRP1sHb8vOos_9QaoYmA3TtYmnNx-Erg@mail.gmail.com>
 <5668CC4F.109@gmail.com>
 <CACsi253q+GanuRzOqBjaOe-h1w8uOcH6uFAcdres=+ig5q6+VA@mail.gmail.com>
 <5668EFDB.1050900@gmail.com>
 <CACsi252HOz3_BO6hJtRTfM=M6oB0ZUXpSvkPmKs8LWP3LCz8xA@mail.gmail.com>
 <EC8AA057-325B-4176-88A8-D9E5073C7F32@greenbytes.de>
 <CAKQ1sVO0pade3_QMnftz38NajZ6v17+9CUz8PW_j3Zj2OvysZA@mail.gmail.com>
 <482349A8-86D1-42EF-A436-C907BDF9DF7D@greenbytes.de>
 <d3ce01d133ff$c50fa930$4f2efb90$@qqmail.nl> <566B2071.4080108@gmail.com>
 <CACsi251r2KxQ3dOgXOVfV9nOh-fmyVG0C0g2dS=h2qTMvrjqfw@mail.gmail.com>
 <566B383D.9010306@gmail.com>
 <CACsi251jRbJgEo4aP7AFe0Wfz4KWv8Zcbo6LMUAAkQDDqiJp9g@mail.gmail.com>
From: Jacob Champion <champion.p@gmail.com>
Message-ID: <566B5293.2080803@gmail.com>
Date: Fri, 11 Dec 2015 14:47:47 -0800
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:38.0) Gecko/20100101
 Thunderbird/38.4.0
MIME-Version: 1.0
In-Reply-To: <CACsi251jRbJgEo4aP7AFe0Wfz4KWv8Zcbo6LMUAAkQDDqiJp9g@mail.gmail.com>
Content-Type: text/plain; charset=utf-8; format=flowed
Content-Transfer-Encoding: 7bit

n 12/11/2015 02:24 PM, William A Rowe Jr wrote:
> On Fri, Dec 11, 2015 at 2:55 PM, Jacob Champion <champion.p@gmail.com
> <mailto:champion.p@gmail.com>> wrote:
>     That additional constraint doesn't conflict with any part of
>     HTTP/1.1, as far as I can tell. Returning 4xx directly to an Upgrade
>     request is allowed within HTTP/1.1, right? The spec says nothing
>     about the internal server architecture.
>
> The spec describes the exception handling;
>    "A client MAY send a list of protocols in the Upgrade
>     header field of a request to invite the server to switch to one or
>     more of those protocols, in order of descending preference, before
>     sending the final response.  A server MAY ignore a received Upgrade
>     header field if it wishes to continue using the current protocol on
>     that connection.  Upgrade cannot be used to insist on a protocol
>     change."
> Unambiguous, there is no "error" in not upgrading, period.

Is your argument that, because the spec does not explicitly say that the 
server may take some action, such an action is prohibited?

> To the extent that any RFC6455
> contradiction to RFC7230 is invalid, RFC7230 is binding,

Agreed.

> but it doesn't look that way to me.  From RFC6455 4.1,
>
>     Once the client's opening handshake has been sent, the client MUST
>     wait for a response from the server before sending any further data.
>     The client MUST validate the server's response as follows:
>
>     1.  If the status code received from the server is not 101, the
>         client handles the response per HTTP [RFC2616 <https://tools.ietf.org/html/rfc2616>] procedures.  In
>         particular, the client might perform authentication if it
>         receives a 401 status code; the server might redirect the client
>         using a 3xx status code (but clients are not required to follow
>         them), etc.  Otherwise, proceed as follows.
>
> In other words, in the absence of the websocket module declining to honor
> the upgrade request, it still remains an http/1 request and response.

Agreed. A properly implemented WebSocket client is also, by necessity, 
an HTTP/1.1 client, because the server may not have any idea what 
WebSocket is.

> Whatever auth or other technical details cause that request to fail will be
> represented as an http/1 response.

Yes.

> If the implementer wants to present a successful http/1
> response to the request in lieu of establishing a websocket connection with
> the corresponding 101-switching protocols, by offering a resource at the
> given URL, that option remains.

This is where we disagree, for the case of WebSocket and WebSocket 
alone. RFC 6455 4.2.1:

    The client's opening handshake consists of the following parts.  If
    the server, while reading the handshake, finds that the client did
    not send a handshake that matches the description below (note that as
    per [RFC2616], the order of the header fields is not important),
    including but not limited to any violations of the ABNF grammar
    specified for the components of the handshake, the server MUST stop
    processing the client's handshake and return an HTTP response with an
    appropriate error code (such as 400 Bad Request).

I maintain that this requirement (stop, do not pass Go, return an error 
immediately) is not in conflict with 723x, but I am open to persuasion 
otherwise. At the moment, I just don't agree that the paragraph you 
cited above (RFC 7230 6.7)  prohibits this behavior. Are there other 
cases you can show me where omission is tantamount to prohibition?

--Jacob

From dev-return-85059-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Fri Dec 11 23:08:16 2015
Return-Path: <dev-return-85059-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id C7B7A18EC9
	for <apmail-httpd-dev-archive@www.apache.org>; Fri, 11 Dec 2015 23:08:16 +0000 (UTC)
Received: (qmail 27574 invoked by uid 500); 11 Dec 2015 23:08:16 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 27506 invoked by uid 500); 11 Dec 2015 23:08:16 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 27495 invoked by uid 99); 11 Dec 2015 23:08:16 -0000
Received: from Unknown (HELO spamd2-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 11 Dec 2015 23:08:16 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd2-us-west.apache.org (ASF Mail Server at spamd2-us-west.apache.org) with ESMTP id B8B411A5F5E
	for <dev@httpd.apache.org>; Fri, 11 Dec 2015 23:08:15 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd2-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.12
X-Spam-Level:
X-Spam-Status: No, score=-0.12 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RCVD_IN_MSPIKE_H3=-0.01, RCVD_IN_MSPIKE_WL=-0.01, SPF_PASS=-0.001,
	URIBL_BLOCKED=0.001] autolearn=disabled
Authentication-Results: spamd2-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd2-us-west.apache.org [10.40.0.9]) (amavisd-new, port 10024)
	with ESMTP id 4G-YjsC-tK8V for <dev@httpd.apache.org>;
	Fri, 11 Dec 2015 23:08:09 +0000 (UTC)
Received: from mail-qk0-f179.google.com (mail-qk0-f179.google.com [209.85.220.179])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id E08632026F
	for <dev@httpd.apache.org>; Fri, 11 Dec 2015 23:08:08 +0000 (UTC)
Received: by qkfb125 with SMTP id b125so61652515qkf.2
        for <dev@httpd.apache.org>; Fri, 11 Dec 2015 15:08:07 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        bh=JyxFY4x6r4/tm+nCB1gak+ujsE+9lmQlIxlPZuPA5l8=;
        b=IjcOFxmZFpbQIrdEDwVSHF0rX3VZt12sYmRnlO3m/CRQl829juED+U39r2CP19OVnw
         69wryUSc4NlvkEHcF8tw+B2jOwHkpEPtG5uAz8QyKib8ne5sFNW8/HF2NxIPmm6NFOTg
         lAlYBdbu+I3N8oVGjYv/IojTMGjDs1HepTyDC+3eem1kfXSjy5+g6m/GsDbs2qggYdSa
         XLDxT3610dXo8j/agiOo779VqvpsNSyEVNEnKPCL9ZF80hwTclVepo3S3VUl3RhgFjfQ
         PUt/sbNvAB8fs31mA9MVmHTcFHyTrdORVWjbWsztNmB9qKX3ZxS7YN85DXzSXaxGnnIO
         i9AA==
MIME-Version: 1.0
X-Received: by 10.55.217.149 with SMTP id q21mr27286974qkl.55.1449875287519;
 Fri, 11 Dec 2015 15:08:07 -0800 (PST)
Received: by 10.55.65.85 with HTTP; Fri, 11 Dec 2015 15:08:07 -0800 (PST)
In-Reply-To: <CAKQ1sVO57H9fzU2T2OFLw1FzSVeBvX+_JKkLdsasXGBCgoRBLA@mail.gmail.com>
References: <AD9BFA0F-C508-4DFE-8B4F-FF79D46D9D91@jaguNET.com>
	<566B3043.2050607@kippdata.de>
	<CAKQ1sVO1B-tuonLNvtpJ0FJ8=wdErcgag_bx==p0bhT+S7ms8w@mail.gmail.com>
	<CAKQ1sVO57H9fzU2T2OFLw1FzSVeBvX+_JKkLdsasXGBCgoRBLA@mail.gmail.com>
Date: Sat, 12 Dec 2015 00:08:07 +0100
Message-ID: <CAKQ1sVMLTQk4-1OaJndcyVAdHzWBsEyiZf-FrH2eM+DY++wrwA@mail.gmail.com>
Subject: Re: [VOTE] Release Apache httpd 2.4.18 as GA
From: Yann Ylavic <ylavic.dev@gmail.com>
To: httpd-dev <dev@httpd.apache.org>
Content-Type: text/plain; charset=UTF-8

On Fri, Dec 11, 2015 at 10:57 PM, Yann Ylavic <ylavic.dev@gmail.com> wrote:
> On Fri, Dec 11, 2015 at 10:39 PM, Yann Ylavic <ylavic.dev@gmail.com> wrote:
>> On Fri, Dec 11, 2015 at 9:21 PM, Rainer Jung <rainer.jung@kippdata.de> wrote:
>>>
>>>   - three compiler warning (2 regressions, one old)
>> []
>>>       modules/ssl/ssl_engine_kernel.c:414:22: warning: variable 'hssc' set
>>> but not used [-Wunused-but-set-variable]
>>
>> This one is harmless ('hssc' redeclared and used below in inner scope).
>> But I checked twice since handshakeserver (there) is not checked
>> against NULL like at the initialization.
>> Fortunately the !ssl path above handles the case, so this is simply a
>> double initialization (to the same value), likely optimized away
>> finally...
>>
>> -Wunused-but-set-variable does its job, though.
>
> The original commit in trunk (r1709995) contained:
> @@ -529,7 +672,6 @@ int ssl_hook_Access(request_rec *r)
>       */
>      if ((dc->nVerifyClient != SSL_CVERIFY_UNSET) ||
>          (sc->server->auth.verify_mode != SSL_CVERIFY_UNSET)) {
> -        SSLSrvConfigRec *hssc = mySrvConfig(handshakeserver);
>
>          /* remember old state */
>          verify_old = SSL_get_verify_mode(ssl);
> --

This turned into (r1712567, 2.4.17-protocols-changes):
@@ -554,6 +697,7 @@ int ssl_hook_Access(request_rec *r)
      */
     if ((dc->nVerifyClient != SSL_CVERIFY_UNSET) ||
         (sc->server->auth.verify_mode != SSL_CVERIFY_UNSET)) {
+
         /* remember old state */
         verify_old = SSL_get_verify_mode(ssl);
         /* configure new state */
--
which was then merged in 2.4.x.

This is the only change which "failed" in r1712567, and trunk and
2.4.x are in sync wrt the changes in 2.4.18, so finally not an issue.

From dev-return-85060-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Fri Dec 11 23:41:12 2015
Return-Path: <dev-return-85060-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id B873D1808D
	for <apmail-httpd-dev-archive@www.apache.org>; Fri, 11 Dec 2015 23:41:12 +0000 (UTC)
Received: (qmail 97171 invoked by uid 500); 11 Dec 2015 23:41:12 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 97074 invoked by uid 500); 11 Dec 2015 23:41:12 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 97064 invoked by uid 99); 11 Dec 2015 23:41:12 -0000
Received: from Unknown (HELO spamd3-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 11 Dec 2015 23:41:12 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd3-us-west.apache.org (ASF Mail Server at spamd3-us-west.apache.org) with ESMTP id AFBEF180A9A
	for <dev@httpd.apache.org>; Fri, 11 Dec 2015 23:41:11 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd3-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.102
X-Spam-Level:
X-Spam-Status: No, score=-0.102 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RCVD_IN_MSPIKE_H2=-0.001, SPF_PASS=-0.001] autolearn=disabled
Authentication-Results: spamd3-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd3-us-west.apache.org [10.40.0.10]) (amavisd-new, port 10024)
	with ESMTP id of5pjXEXFghX for <dev@httpd.apache.org>;
	Fri, 11 Dec 2015 23:41:11 +0000 (UTC)
Received: from mail-qg0-f41.google.com (mail-qg0-f41.google.com [209.85.192.41])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id CD01E439A6
	for <dev@httpd.apache.org>; Fri, 11 Dec 2015 23:41:10 +0000 (UTC)
Received: by qgew101 with SMTP id w101so5620879qge.2
        for <dev@httpd.apache.org>; Fri, 11 Dec 2015 15:41:10 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        bh=3IUU/MM0jETo5OO2LxQbbrjxibdFeurL4dLB+MEx99k=;
        b=twruGr+PtqOSpFpgPy16o6ApcmsM18AYDA/CK4wnhlvHQiPbcuAyVxlUigAIC8rbNQ
         Rv03KMvFpRMnLbCc3NTlMeiOfsLAGfCVlUT0YNi3V79nXPmW8ChyOwdms43HW7wC9sKs
         E7thjY/9USudB4Lvnetbf221iqtXlO2id8kIq5pUscQeyigDVOwLP+ynqFya72FG/zCf
         Mv3jsNv+J0k3zlbuSqRmN5MSd9X8D2JVjjh3Rh66V1G7RMoeS1MTLWG1xkcFv977MW85
         BZJh3Kq71v6CZx8hAfRLnR62fHL/IE8q3einuXb7WFvVfWyU3sU8fgHJuJzAY4+u79D2
         hL0Q==
MIME-Version: 1.0
X-Received: by 10.140.101.51 with SMTP id t48mr28311642qge.71.1449877270561;
 Fri, 11 Dec 2015 15:41:10 -0800 (PST)
Received: by 10.55.65.85 with HTTP; Fri, 11 Dec 2015 15:41:10 -0800 (PST)
In-Reply-To: <566B5293.2080803@gmail.com>
References: <CACsi250=dbRQKnsbE8JSdAZRm5x99gE0sgX3iQ-PHAx77euD1A@mail.gmail.com>
	<13FE9E7F-9620-4BF9-8EA4-57A6314D66BF@greenbytes.de>
	<9CCEFD7E-9ED3-4ED1-8F58-2134DD5310F9@gbiv.com>
	<CACsi252y7nX0kR9+JgSra7Q_5_LVqaR3z6ExPKg=Lhi8zhN4ew@mail.gmail.com>
	<566887B5.2080705@gmail.com>
	<CACsi253sTRbX2dnuq0yRP1sHb8vOos_9QaoYmA3TtYmnNx-Erg@mail.gmail.com>
	<5668CC4F.109@gmail.com>
	<CACsi253q+GanuRzOqBjaOe-h1w8uOcH6uFAcdres=+ig5q6+VA@mail.gmail.com>
	<5668EFDB.1050900@gmail.com>
	<CACsi252HOz3_BO6hJtRTfM=M6oB0ZUXpSvkPmKs8LWP3LCz8xA@mail.gmail.com>
	<EC8AA057-325B-4176-88A8-D9E5073C7F32@greenbytes.de>
	<CAKQ1sVO0pade3_QMnftz38NajZ6v17+9CUz8PW_j3Zj2OvysZA@mail.gmail.com>
	<482349A8-86D1-42EF-A436-C907BDF9DF7D@greenbytes.de>
	<d3ce01d133ff$c50fa930$4f2efb90$@qqmail.nl>
	<566B2071.4080108@gmail.com>
	<CACsi251r2KxQ3dOgXOVfV9nOh-fmyVG0C0g2dS=h2qTMvrjqfw@mail.gmail.com>
	<566B383D.9010306@gmail.com>
	<CACsi251jRbJgEo4aP7AFe0Wfz4KWv8Zcbo6LMUAAkQDDqiJp9g@mail.gmail.com>
	<566B5293.2080803@gmail.com>
Date: Sat, 12 Dec 2015 00:41:10 +0100
Message-ID: <CAKQ1sVNd1jyisC44xjVQswvK-Zq3zEhqRGUu6PLAQWWHY-+duQ@mail.gmail.com>
Subject: Re: Upgrade Summary
From: Yann Ylavic <ylavic.dev@gmail.com>
To: httpd-dev <dev@httpd.apache.org>
Content-Type: text/plain; charset=UTF-8

Hi Jacob,

On Fri, Dec 11, 2015 at 11:47 PM, Jacob Champion <champion.p@gmail.com> wrote:
>
> This is where we disagree, for the case of WebSocket and WebSocket alone.
> RFC 6455 4.2.1:
>
>    The client's opening handshake consists of the following parts.  If
>    the server, while reading the handshake, finds that the client did
>    not send a handshake that matches the description below (note that as
>    per [RFC2616], the order of the header fields is not important),
>    including but not limited to any violations of the ABNF grammar
>    specified for the components of the handshake, the server MUST stop
>    processing the client's handshake and return an HTTP response with an
>    appropriate error code (such as 400 Bad Request).

I guess the RFC is talking about a Websocket server that also
implements HTTP/1 for Websocket purpose only.
In httpd, the protocol parsing is done by the core http module before
any websocket module is called, so there can't (at least shouldn't) be
an invalid HTTP/1 grammar at that level (post_read_request[_header]),
HTTP/1 failures ought to be handled by the core (http module),
including ill/invalid body transfer encoding/length.
So the error could be an unacceptable handshake for the websocket
module, which should then let httpd handle the HTTP/1 request
(ignoring the handshake and probably websocket headers too).

That does not mean that Protocols handlers can't return "applicative"
errors in handshake (eg. Protocols' auth[nz] failures), but if it
accepts/handles the handshake it MUST respond in the Upgraded
protocol, not in HTTP/1.

Regards,
Yann.

From dev-return-85061-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Fri Dec 11 23:48:44 2015
Return-Path: <dev-return-85061-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 4791B180BC
	for <apmail-httpd-dev-archive@www.apache.org>; Fri, 11 Dec 2015 23:48:44 +0000 (UTC)
Received: (qmail 9162 invoked by uid 500); 11 Dec 2015 23:48:43 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 9085 invoked by uid 500); 11 Dec 2015 23:48:43 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 9075 invoked by uid 99); 11 Dec 2015 23:48:43 -0000
Received: from Unknown (HELO spamd2-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 11 Dec 2015 23:48:43 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd2-us-west.apache.org (ASF Mail Server at spamd2-us-west.apache.org) with ESMTP id 515FB1A24A2
	for <dev@httpd.apache.org>; Fri, 11 Dec 2015 23:48:43 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd2-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 2.901
X-Spam-Level: **
X-Spam-Status: No, score=2.901 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	HTML_MESSAGE=3, URIBL_BLOCKED=0.001] autolearn=disabled
Authentication-Results: spamd2-us-west.apache.org (amavisd-new);
	dkim=pass (1024-bit key) header.d=qqmail.nl
Received: from mx1-us-west.apache.org ([10.40.0.8])
	by localhost (spamd2-us-west.apache.org [10.40.0.9]) (amavisd-new, port 10024)
	with ESMTP id aiaE1hALK5qr for <dev@httpd.apache.org>;
	Fri, 11 Dec 2015 23:48:32 +0000 (UTC)
Received: from mail-wm0-f48.google.com (mail-wm0-f48.google.com [74.125.82.48])
	by mx1-us-west.apache.org (ASF Mail Server at mx1-us-west.apache.org) with ESMTPS id AB7F8265D8
	for <dev@httpd.apache.org>; Fri, 11 Dec 2015 23:48:31 +0000 (UTC)
Received: by wmnn186 with SMTP id n186so52288255wmn.0
        for <dev@httpd.apache.org>; Fri, 11 Dec 2015 15:48:30 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=qqmail.nl; s=google;
        h=message-id:mime-version:to:from:subject:date:importance:in-reply-to
         :references:content-type;
        bh=IPGbA4JPxoUhVQ9qbyjYJH0yN1iXKPY/RkJy1tlDg2Q=;
        b=bj2RKMB1ha0AVyIzrT99oI6DnMPwc7FjRKBLbAwXTRnANjxubs+FlbuSbLOSFRMZwD
         eC4ce0c8oqoGtNuDmGC2zzzj53acI+enCK610oQL5wSbCd41Ls6R+PmkjamarBtpfRJo
         M8LAYaOtcC9b0/PedMtzvRCZFu3TLRHXP9Azc=
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=1e100.net; s=20130820;
        h=x-gm-message-state:message-id:mime-version:to:from:subject:date
         :importance:in-reply-to:references:content-type;
        bh=IPGbA4JPxoUhVQ9qbyjYJH0yN1iXKPY/RkJy1tlDg2Q=;
        b=Dv7EnbMlCS15hHwHBLrP+21aerBBCbT8VMsLRbM0bNUJla7T06Vy/w7z09MlTyhZpP
         X7vbkFsHGFyu4SClc/KQjn4I7vkeLEf+nbigVXeGTr66GC5ZPEI+sjjs+os5eELXN98g
         ivX6d0YBWajWNoxpo3r5xdibSULys58fWGmthU87YZCpDGWnTPicNLf5hrVAxaiaYJpE
         BwWktOTzS3S/UNcsDIdpSxdB6/nQ2tjQRqFb0f9NmtM+xScvQSNkvCpUtdVuMNXaavl6
         YBpcO3WA+Wcj/7+/IIdJLE5AJ4pbqWuH0xf1/olwBWn9Rj5q1tuvUkXYrD/i/bMM2m+M
         kewQ==
X-Gm-Message-State: ALoCoQmgeOB647uJ0qLBQfvRmyBquKLgLbHrJV4GJWfLlXhpzkz7yKImF1O3HiiJyOqzAr3P1oJTi/f6GhSt00l07Bs7sVEl1g==
X-Received: by 10.28.184.134 with SMTP id i128mr9539783wmf.12.1449877710025;
        Fri, 11 Dec 2015 15:48:30 -0800 (PST)
Received: from ?IPv6:2001:610:66e:0:c233:5eff:fe29:3cff? ([2001:610:66e:0:c233:5eff:fe29:3cff])
        by smtp.gmail.com with ESMTPSA id cl2sm18914407wjc.33.2015.12.11.15.48.28
        (version=TLSv1/SSLv3 cipher=OTHER);
        Fri, 11 Dec 2015 15:48:29 -0800 (PST)
Message-ID: <566b60cd.e2b0c20a.7cbe6.ffff86fa@mx.google.com>
MIME-Version: 1.0
To: Yann Ylavic <ylavic.dev@gmail.com>, httpd-dev <dev@httpd.apache.org>
From: Bert Huijben <bert@qqmail.nl>
Subject: RE: Upgrade Summary
Date: Sat, 12 Dec 2015 00:48:29 +0100
Importance: normal
X-Priority: 3
In-Reply-To:
 <CAKQ1sVO0pade3_QMnftz38NajZ6v17+9CUz8PW_j3Zj2OvysZA@mail.gmail.com>
References:
 <CACsi250=dbRQKnsbE8JSdAZRm5x99gE0sgX3iQ-PHAx77euD1A@mail.gmail.com>
 <AB1691BE05AE7F4992697F2A0835627AC63BAB94@VOEXM10W.internal.vodafone.com>
 <F7B20D30-D34A-4805-A77D-F64F6428F6E3@greenbytes.de>
 <56660896.c74fc20a.15f56.0ebd@mx.google.com> <56660B43.2060507@gmail.com>
 <6B13DF2B-0586-42BB-B62F-59A7638B697D@greenbytes.de>
 <13FE9E7F-9620-4BF9-8EA4-57A6314D66BF@greenbytes.de>
 <9CCEFD7E-9ED3-4ED1-8F58-2134DD5310F9@gbiv.com>
 <CACsi252y7nX0kR9+JgSra7Q_5_LVqaR3z6ExPKg=Lhi8zhN4ew@mail.gmail.com>
 <566887B5.2080705@gmail.com>
 <CACsi253sTRbX2dnuq0yRP1sHb8vOos_9QaoYmA3TtYmnNx-Erg@mail.gmail.com>
 <5668CC4F.109@gmail.com>
 <CACsi253q+GanuRzOqBjaOe-h1w8uOcH6uFAcdres=+ig5q6+VA@mail.gmail.com>
 <5668EFDB.1050900@gmail.com>
 <CACsi252HOz3_BO6hJtRTfM=M6oB0ZUXpSvkPmKs8LWP3LCz8xA@mail.gmail.com>
 <EC8AA057-325B-4176-88A8-D9E5073C7F32@greenbytes.de>
 <CAKQ1sVO0pade3_QMnftz38NajZ6v17+9CUz8PW_j3Zj2OvysZA@mail.gmail.com>
Content-Type: multipart/alternative;
	boundary="_0F8FA566-67BE-4331-A18B-200E8DF25C68_"

--_0F8FA566-67BE-4331-A18B-200E8DF25C68_
Content-Transfer-Encoding: quoted-printable
Content-Type: text/plain; charset="utf-8"

If you request an upgrade to TLS on your initial request, upgrading with a =
body might still make sense. Especially if the server would respond with a =
401. But also if the request can be public, but the response needs to be se=
cured.

If we blindly ignore the upgrade as =E2=80=98doesn=E2=80=99t make sense=E2=
=80=99, the next request wouldn=E2=80=99t use encryption=E2=80=A6 but if we=
 upgraded to TLS after the request, the next request=E2=80=A6 with the auth=
entication headers could be sent encrypted.

The server can=E2=80=99t choose if that first request makes sense or not=E2=
=80=A6 It has to decide if upgrading the connection during the request make=
s sense=E2=80=A6 and if that is possible.

If upgrading the first request doesn=E2=80=99t make sense the client should=
 use a different request (Like options *, or HEAD /).

If the server denies the request at least some parts have already travelled=
 the network unencrypted. Returning an error or not upgrading will only mak=
e sure more requests will travel unencrypted.

The response is not the only thing encrypted when upgrading=E2=80=A6 all fu=
ture requests are. Upgrade is a connection level request, sent via a reques=
t.


Bert


Sent from Mail for Windows 10



From: Yann Ylavic
Sent: vrijdag 11 december 2015 02:22
To: httpd-dev
Subject: Re: Upgrade Summary


On Thu, Dec 10, 2015 at 11:46 AM, Stefan Eissing
<stefan.eissing@greenbytes.de> wrote:
> Given all the input on this thread, I arrive at the following pseudo code=
:

Thanks for _compiling_ this thread, quite exhaustive :)

I wonder if we could let each Protocols module hook wherever
appropriate in the current hooking set.

TLS handshake is already at the right place IMO, it possibly needs a
simple fix like,

Index: modules/ssl/ssl_engine_kernel.c
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D
--- modules/ssl/ssl_engine_kernel.c    (revision 1718341)
+++ modules/ssl/ssl_engine_kernel.c    (working copy)
@@ -233,7 +233,8 @@ int ssl_hook_ReadReq(request_rec *r)
      * has sent a suitable Upgrade header. */
     if (sc->enabled =3D=3D SSL_ENABLED_OPTIONAL && !myConnConfig(r->connec=
tion)
         && (upgrade =3D apr_table_get(r->headers_in, "Upgrade")) !=3D NULL
-        && ap_find_token(r->pool, upgrade, "TLS/1.0")) {
+        && ap_find_token(r->pool, upgrade, "TLS")
+        && !ap_has_request_body(r)) {
         if (upgrade_connection(r)) {
             return AP_FILTER_ERROR;
         }
--
so that we don't Upgrade when a body is given (looks like it's RFC
compliant since Upgrade is not mandatory).

Or maybe,
-        && ap_find_token(r->pool, upgrade, "TLS/1.0")) {
+        && ap_find_token(r->pool, upgrade, "TLS")) {
+        if (ap_has_request_body(r)) {
+            return HTTP_REQUEST_ENTITY_TOO_LARGE;
+        }
         if (upgrade_connection(r)) {
             return AP_FILTER_ERROR;
         }
--
because a body in clear text while requiring TLS makes few sense, and
clients that send TLS body directly (no header) after the Upgrade
would notice (now), that looks safer.
But stricly speaking this looks not very RFC7230 compliant too, I
could not find an "Upgrade: TLS" exception there (the whole HTTP/1
request must be read otherwise before upgrade)...

Possibly we could also,
+            ap_discard_request_body(r);
but I'd feel safer with the previous patch, WDYT?


Regarding WebSocket, we already have proxy_wstunnel that handshakes
successfully as a (proxy_)handler.
I don't know if the upcoming body is to be HTTP/1 or not, but should
this be enforced we could use ap_get_brigade() to forward it until
complete (while still detecting HTTP/1 "errors"), and then use the
current TCP forwarding until EOF on either side.


>
> 1. Post Read Request Hook:
>
>         if (Upgrade: request header present) {
>                 collect protocol proposals;
>                 ps =3D protocol with highest preference from proposals;
>                 if (ps && ps !=3D current) {

Here I would use ap_add_output_filter(switch_protocol_filter, r); with
switch_protocol_filter() which would flush out the 101 response (or
not) based on r->need_upgrade and r->current_protocol, before any
Protocols data.
Maybe this filter could also call ap_discard_request_body(r) when
needed/asked to (eg. r->discard_body), that'd need CONN_SENSE handling
with MPM event possibly.
For the headers in the 101 response, another hook called from
switch_protocol_filter() could be used.

If I'm talking about new r-> field, that could also be in
core_request_config, reachable with
ap_get_core_module_config(r->request_config), for possibly a better
backportabily (but that's an implementation detail).

So now I think we can let the request fall through.
If a Protocols' module needs to bypass/handle auth[nz] itself, it
would hook after this one (post_read_request still, and return DONE).
Otherwise, as a handler, each Protocols' module would check
r->current_protocol against its own one, and either handle it or
DECLINE.
If the selected module doesn't care about the request body (ie. never
reads it), switch_protocol_filter() would do the right thing (discard
the body) before switching.
Otherwise, the module can do whatever it wants with the (full) HTTP/1
request, and even DECLINE if it finally wants to fall through HTTP/1
(after resetting r->need_upgrade probably).

>
> 3. Common protocol switch hook behavior:
>
>         apr_status_t process_body(apr_bucket_brigade *bb, void *ctx)
>         {
>                 // brigade contains unchunked body data of request
>                 // may be called several times. EOS bucket in brigade
>                 // indicates end of body.
>                 // If request has no body, will be called once with EOS b=
ucket.

A handler could use ap_get_brigade(r->input_filters) and friends more
easily, or ap_discard_request_body() explicitely, and/or
ap_pass_brigade(FLUSH) to force the 101 response, ..., and/or go to :

>
>                 // c->output_filters can be written
>                 // c->input_filters can be read [...]
>                 process protocol;

Followed by:
                  r->keepalive =3D AP_CONN_CLOSE;
                  return OK;
>         }

Wouldn't that work for every case we discussed?



--_0F8FA566-67BE-4331-A18B-200E8DF25C68_
Content-Transfer-Encoding: quoted-printable
Content-Type: text/html; charset="utf-8"

<html xmlns:o=3D"urn:schemas-microsoft-com:office:office" xmlns:w=3D"urn:sc=
hemas-microsoft-com:office:word" xmlns:m=3D"http://schemas.microsoft.com/of=
fice/2004/12/omml" xmlns=3D"http://www.w3.org/TR/REC-html40"><head><meta ht=
tp-equiv=3DContent-Type content=3D"text/html; charset=3Dutf-8"><meta name=
=3DGenerator content=3D"Microsoft Word 15 (filtered medium)"><style><!--
/* Font Definitions */
@font-face
	{font-family:"Cambria Math";
	panose-1:2 4 5 3 5 4 6 3 2 4;}
@font-face
	{font-family:Calibri;
	panose-1:2 15 5 2 2 2 4 3 2 4;}
/* Style Definitions */
p.MsoNormal, li.MsoNormal, div.MsoNormal
	{margin:0cm;
	margin-bottom:.0001pt;
	font-size:11.0pt;
	font-family:"Calibri",sans-serif;}
a:link, span.MsoHyperlink
	{mso-style-priority:99;
	color:blue;
	text-decoration:underline;}
a:visited, span.MsoHyperlinkFollowed
	{mso-style-priority:99;
	color:#954F72;
	text-decoration:underline;}
p
	{mso-style-priority:99;
	margin:0cm;
	margin-bottom:.0001pt;
	font-size:11.0pt;
	font-family:"Times New Roman",serif;}
.MsoChpDefault
	{mso-style-type:export-only;}
@page WordSection1
	{size:612.0pt 792.0pt;
	margin:72.0pt 72.0pt 72.0pt 72.0pt;}
div.WordSection1
	{page:WordSection1;}
--></style></head><body lang=3DNL link=3Dblue vlink=3D"#954F72"><div class=
=3DWordSection1><p class=3DMsoNormal><span lang=3DEN-US>If you request an u=
pgrade to TLS on your initial request, upgrading with a body might still ma=
ke sense. Especially if the server would respond with a 401. But also if th=
e request can be public, but the response needs to be secured.<o:p></o:p></=
span></p><p class=3DMsoNormal><span lang=3DEN-US><o:p>&nbsp;</o:p></span></=
p><p class=3DMsoNormal><span lang=3DEN-US>If we blindly ignore the upgrade =
as =E2=80=98doesn=E2=80=99t make sense=E2=80=99, the next request wouldn=E2=
=80=99t use encryption=E2=80=A6 but if we upgraded to TLS after the request=
, the next request=E2=80=A6 with the authentication headers could be sent e=
ncrypted.<o:p></o:p></span></p><p class=3DMsoNormal><span lang=3DEN-US><o:p=
>&nbsp;</o:p></span></p><p class=3DMsoNormal><span lang=3DEN-US>The server =
can=E2=80=99t choose if that first <b>request</b> makes sense or not=E2=80=
=A6 It has to decide if upgrading the <b>connection</b> during the request =
makes sense=E2=80=A6 and if that is possible.<o:p></o:p></span></p><p class=
=3DMsoNormal><span lang=3DEN-US><o:p>&nbsp;</o:p></span></p><p class=3DMsoN=
ormal><span lang=3DEN-US>If upgrading the first request doesn=E2=80=99t mak=
e sense <b>the client</b> should use a different request (Like options *, o=
r HEAD /).<o:p></o:p></span></p><p class=3DMsoNormal><span lang=3DEN-US><o:=
p>&nbsp;</o:p></span></p><p class=3DMsoNormal><span lang=3DEN-US>If the ser=
ver denies the request at least some parts have already travelled the netwo=
rk unencrypted. Returning an error or not upgrading will only make sure mor=
e requests will travel unencrypted.<o:p></o:p></span></p><p class=3DMsoNorm=
al><span lang=3DEN-US><o:p>&nbsp;</o:p></span></p><p class=3DMsoNormal><spa=
n lang=3DEN-US>The response is not the only thing encrypted when upgrading=
=E2=80=A6 all future requests are. Upgrade is a connection level request, s=
ent via a request.<o:p></o:p></span></p><p class=3DMsoNormal><span lang=3DE=
N-US><o:p>&nbsp;</o:p></span></p><p class=3DMsoNormal><span lang=3DEN-US><o=
:p>&nbsp;</o:p></span></p><p class=3DMsoNormal><span lang=3DEN-US>Bert<o:p>=
</o:p></span></p><p class=3DMsoNormal><span lang=3DEN-US><o:p>&nbsp;</o:p><=
/span></p><p class=3DMsoNormal><o:p>&nbsp;</o:p></p><p class=3DMsoNormal>Se=
nt from <a href=3D"http://go.microsoft.com/fwlink/?LinkId=3D550986">Mail</a=
> for Windows 10</p><p><o:p>&nbsp;</o:p></p><p><o:p>&nbsp;</o:p></p><div st=
yle=3D'mso-element:para-border-div;border:none;border-top:solid #E1E1E1 1.0=
pt;padding:3.0pt 0cm 0cm 0cm'><p class=3DMsoNormal style=3D'mso-margin-top-=
alt:auto;mso-margin-bottom-alt:auto;border:none;padding:0cm'><br><b>From: <=
/b>Yann Ylavic<br><b>Sent: </b>vrijdag 11 december 2015 02:22<br><b>To: </b=
>httpd-dev<br><b>Subject: </b>Re: Upgrade Summary</p></div><p class=3DMsoNo=
rmal><o:p>&nbsp;</o:p></p><p class=3DMsoNormal><span style=3D'font-size:12.=
0pt;font-family:"Times New Roman",serif'><o:p>&nbsp;</o:p></span></p><p cla=
ss=3DMsoNormal>On Thu, Dec 10, 2015 at 11:46 AM, Stefan Eissing</p><p class=
=3DMsoNormal>&lt;stefan.eissing@greenbytes.de&gt; wrote:</p><p class=3DMsoN=
ormal>&gt; Given all the input on this thread, I arrive at the following ps=
eudo code:</p><p class=3DMsoNormal><o:p>&nbsp;</o:p></p><p class=3DMsoNorma=
l>Thanks for _compiling_ this thread, quite exhaustive :)</p><p class=3DMso=
Normal><o:p>&nbsp;</o:p></p><p class=3DMsoNormal>I wonder if we could let e=
ach Protocols module hook wherever</p><p class=3DMsoNormal>appropriate in t=
he current hooking set.</p><p class=3DMsoNormal><o:p>&nbsp;</o:p></p><p cla=
ss=3DMsoNormal>TLS handshake is already at the right place IMO, it possibly=
 needs a</p><p class=3DMsoNormal>simple fix like,</p><p class=3DMsoNormal><=
o:p>&nbsp;</o:p></p><p class=3DMsoNormal>Index: modules/ssl/ssl_engine_kern=
el.c</p><p class=3DMsoNormal>=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D</p><p class=3DMsoNormal>--- modules/ssl/ssl_engine_kernel.c=C2=A0=C2=
=A0=C2=A0 (revision 1718341)</p><p class=3DMsoNormal>+++ modules/ssl/ssl_en=
gine_kernel.c=C2=A0=C2=A0=C2=A0 (working copy)</p><p class=3DMsoNormal>@@ -=
233,7 +233,8 @@ int ssl_hook_ReadReq(request_rec *r)</p><p class=3DMsoNorma=
l>=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0 * has sent a suitable Upgrade header. */</=
p><p class=3DMsoNormal>=C2=A0=C2=A0=C2=A0=C2=A0 if (sc-&gt;enabled =3D=3D S=
SL_ENABLED_OPTIONAL &amp;&amp; !myConnConfig(r-&gt;connection)</p><p class=
=3DMsoNormal>=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0 &amp;&amp; (u=
pgrade =3D apr_table_get(r-&gt;headers_in, &quot;Upgrade&quot;)) !=3D NULL<=
/p><p class=3DMsoNormal>-=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0 &amp;&a=
mp; ap_find_token(r-&gt;pool, upgrade, &quot;TLS/1.0&quot;)) {</p><p class=
=3DMsoNormal>+=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0 &amp;&amp; ap_find=
_token(r-&gt;pool, upgrade, &quot;TLS&quot;)</p><p class=3DMsoNormal>+=C2=
=A0=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0 &amp;&amp; !ap_has_request_body(r))=
 {</p><p class=3DMsoNormal>=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0=
 if (upgrade_connection(r)) {</p><p class=3DMsoNormal>=C2=A0=C2=A0=C2=A0=C2=
=A0=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0 return AP_FILTER_ERROR;=
</p><p class=3DMsoNormal>=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0 }=
</p><p class=3DMsoNormal>--</p><p class=3DMsoNormal>so that we don't Upgrad=
e when a body is given (looks like it's RFC</p><p class=3DMsoNormal>complia=
nt since Upgrade is not mandatory).</p><p class=3DMsoNormal><o:p>&nbsp;</o:=
p></p><p class=3DMsoNormal>Or maybe,</p><p class=3DMsoNormal>-=C2=A0=C2=A0=
=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0 &amp;&amp; ap_find_token(r-&gt;pool, upgrade=
, &quot;TLS/1.0&quot;)) {</p><p class=3DMsoNormal>+=C2=A0=C2=A0=C2=A0=C2=A0=
=C2=A0=C2=A0=C2=A0 &amp;&amp; ap_find_token(r-&gt;pool, upgrade, &quot;TLS&=
quot;)) {</p><p class=3DMsoNormal>+=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0=C2=
=A0 if (ap_has_request_body(r)) {</p><p class=3DMsoNormal>+=C2=A0=C2=A0=C2=
=A0=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0 return HTTP_REQUEST_ENT=
ITY_TOO_LARGE;</p><p class=3DMsoNormal>+=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0=C2=
=A0=C2=A0 }</p><p class=3DMsoNormal>=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0=C2=
=A0=C2=A0 if (upgrade_connection(r)) {</p><p class=3DMsoNormal>=C2=A0=C2=A0=
=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0 return AP_FILT=
ER_ERROR;</p><p class=3DMsoNormal>=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0=C2=
=A0=C2=A0 }</p><p class=3DMsoNormal>--</p><p class=3DMsoNormal>because a bo=
dy in clear text while requiring TLS makes few sense, and</p><p class=3DMso=
Normal>clients that send TLS body directly (no header) after the Upgrade</p=
><p class=3DMsoNormal>would notice (now), that looks safer.</p><p class=3DM=
soNormal>But stricly speaking this looks not very RFC7230 compliant too, I<=
/p><p class=3DMsoNormal>could not find an &quot;Upgrade: TLS&quot; exceptio=
n there (the whole HTTP/1</p><p class=3DMsoNormal>request must be read othe=
rwise before upgrade)...</p><p class=3DMsoNormal><o:p>&nbsp;</o:p></p><p cl=
ass=3DMsoNormal>Possibly we could also,</p><p class=3DMsoNormal>+=C2=A0=C2=
=A0=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0 ap_discard_reques=
t_body(r);</p><p class=3DMsoNormal>but I'd feel safer with the previous pat=
ch, WDYT?</p><p class=3DMsoNormal><o:p>&nbsp;</o:p></p><p class=3DMsoNormal=
><o:p>&nbsp;</o:p></p><p class=3DMsoNormal>Regarding WebSocket, we already =
have proxy_wstunnel that handshakes</p><p class=3DMsoNormal>successfully as=
 a (proxy_)handler.</p><p class=3DMsoNormal>I don't know if the upcoming bo=
dy is to be HTTP/1 or not, but should</p><p class=3DMsoNormal>this be enfor=
ced we could use ap_get_brigade() to forward it until</p><p class=3DMsoNorm=
al>complete (while still detecting HTTP/1 &quot;errors&quot;), and then use=
 the</p><p class=3DMsoNormal>current TCP forwarding until EOF on either sid=
e.</p><p class=3DMsoNormal><o:p>&nbsp;</o:p></p><p class=3DMsoNormal><o:p>&=
nbsp;</o:p></p><p class=3DMsoNormal>&gt;<o:p>&nbsp;</o:p></p><p class=3DMso=
Normal>&gt; 1. Post Read Request Hook:</p><p class=3DMsoNormal>&gt;<o:p>&nb=
sp;</o:p></p><p class=3DMsoNormal>&gt;=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0=
=C2=A0=C2=A0 if (Upgrade: request header present) {</p><p class=3DMsoNormal=
>&gt;=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0=C2=
=A0=C2=A0=C2=A0=C2=A0=C2=A0 collect protocol proposals;</p><p class=3DMsoNo=
rmal>&gt;=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0=
=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0 ps =3D protocol with highest preference from=
 proposals;</p><p class=3DMsoNormal>&gt;=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0=C2=
=A0=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0 if (ps &amp=
;&amp; ps !=3D current) {</p><p class=3DMsoNormal><o:p>&nbsp;</o:p></p><p c=
lass=3DMsoNormal>Here I would use ap_add_output_filter(switch_protocol_filt=
er, r); with</p><p class=3DMsoNormal>switch_protocol_filter() which would f=
lush out the 101 response (or</p><p class=3DMsoNormal>not) based on r-&gt;n=
eed_upgrade and r-&gt;current_protocol, before any</p><p class=3DMsoNormal>=
Protocols data.</p><p class=3DMsoNormal>Maybe this filter could also call a=
p_discard_request_body(r) when</p><p class=3DMsoNormal>needed/asked to (eg.=
 r-&gt;discard_body), that'd need CONN_SENSE handling</p><p class=3DMsoNorm=
al>with MPM event possibly.</p><p class=3DMsoNormal>For the headers in the =
101 response, another hook called from</p><p class=3DMsoNormal>switch_proto=
col_filter() could be used.</p><p class=3DMsoNormal><o:p>&nbsp;</o:p></p><p=
 class=3DMsoNormal>If I'm talking about new r-&gt; field, that could also b=
e in</p><p class=3DMsoNormal>core_request_config, reachable with</p><p clas=
s=3DMsoNormal>ap_get_core_module_config(r-&gt;request_config), for possibly=
 a better</p><p class=3DMsoNormal>backportabily (but that's an implementati=
on detail).</p><p class=3DMsoNormal><o:p>&nbsp;</o:p></p><p class=3DMsoNorm=
al>So now I think we can let the request fall through.</p><p class=3DMsoNor=
mal>If a Protocols' module needs to bypass/handle auth[nz] itself, it</p><p=
 class=3DMsoNormal>would hook after this one (post_read_request still, and =
return DONE).</p><p class=3DMsoNormal>Otherwise, as a handler, each Protoco=
ls' module would check</p><p class=3DMsoNormal>r-&gt;current_protocol again=
st its own one, and either handle it or</p><p class=3DMsoNormal>DECLINE.</p=
><p class=3DMsoNormal>If the selected module doesn't care about the request=
 body (ie. never</p><p class=3DMsoNormal>reads it), switch_protocol_filter(=
) would do the right thing (discard</p><p class=3DMsoNormal>the body) befor=
e switching.</p><p class=3DMsoNormal>Otherwise, the module can do whatever =
it wants with the (full) HTTP/1</p><p class=3DMsoNormal>request, and even D=
ECLINE if it finally wants to fall through HTTP/1</p><p class=3DMsoNormal>(=
after resetting r-&gt;need_upgrade probably).</p><p class=3DMsoNormal><o:p>=
&nbsp;</o:p></p><p class=3DMsoNormal>&gt;<o:p>&nbsp;</o:p></p><p class=3DMs=
oNormal>&gt; 3. Common protocol switch hook behavior:</p><p class=3DMsoNorm=
al>&gt;<o:p>&nbsp;</o:p></p><p class=3DMsoNormal>&gt;=C2=A0=C2=A0=C2=A0=C2=
=A0=C2=A0=C2=A0=C2=A0=C2=A0 apr_status_t process_body(apr_bucket_brigade *b=
b, void *ctx)</p><p class=3DMsoNormal>&gt;=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0=C2=
=A0=C2=A0=C2=A0 {</p><p class=3DMsoNormal>&gt;=C2=A0=C2=A0=C2=A0=C2=A0=C2=
=A0=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0 // br=
igade contains unchunked body data of request</p><p class=3DMsoNormal>&gt;=
=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0=C2=
=A0=C2=A0=C2=A0=C2=A0 // may be called several times. EOS bucket in brigade=
</p><p class=3DMsoNormal>&gt;=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0=C2=
=A0=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0 // indicates end of bod=
y.</p><p class=3DMsoNormal>&gt;=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0=
=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0 // If request has no=
 body, will be called once with EOS bucket.</p><p class=3DMsoNormal><o:p>&n=
bsp;</o:p></p><p class=3DMsoNormal>A handler could use ap_get_brigade(r-&gt=
;input_filters) and friends more</p><p class=3DMsoNormal>easily, or ap_disc=
ard_request_body() explicitely, and/or</p><p class=3DMsoNormal>ap_pass_brig=
ade(FLUSH) to force the 101 response, ..., and/or go to :</p><p class=3DMso=
Normal><o:p>&nbsp;</o:p></p><p class=3DMsoNormal>&gt;<o:p>&nbsp;</o:p></p><=
p class=3DMsoNormal>&gt;=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0=C2=
=A0=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0 // c-&gt;output_filters can b=
e written</p><p class=3DMsoNormal>&gt;=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0=
=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0 // c-&gt;input=
_filters can be read [...]</p><p class=3DMsoNormal>&gt;=C2=A0=C2=A0=C2=A0=
=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0=C2=
=A0 process protocol;</p><p class=3DMsoNormal><o:p>&nbsp;</o:p></p><p class=
=3DMsoNormal>Followed by:</p><p class=3DMsoNormal>=C2=A0=C2=A0=C2=A0=C2=A0=
=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0=C2=
=A0 r-&gt;keepalive =3D AP_CONN_CLOSE;</p><p class=3DMsoNormal>=C2=A0=C2=A0=
=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0=C2=
=A0=C2=A0=C2=A0 return OK;</p><p class=3DMsoNormal>&gt;=C2=A0=C2=A0=C2=A0=
=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0 }</p><p class=3DMsoNormal><o:p>&nbsp;</o:p><=
/p><p class=3DMsoNormal>Wouldn't that work for every case we discussed?</p>=
<p class=3DMsoNormal><o:p>&nbsp;</o:p></p><p class=3DMsoNormal><o:p>&nbsp;<=
/o:p></p></div></body></html>=

--_0F8FA566-67BE-4331-A18B-200E8DF25C68_--


From dev-return-85062-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Sat Dec 12 00:00:03 2015
Return-Path: <dev-return-85062-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 4D5081813A
	for <apmail-httpd-dev-archive@www.apache.org>; Sat, 12 Dec 2015 00:00:03 +0000 (UTC)
Received: (qmail 27301 invoked by uid 500); 12 Dec 2015 00:00:02 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 27229 invoked by uid 500); 12 Dec 2015 00:00:02 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 27219 invoked by uid 99); 12 Dec 2015 00:00:02 -0000
Received: from Unknown (HELO spamd1-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 12 Dec 2015 00:00:02 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd1-us-west.apache.org (ASF Mail Server at spamd1-us-west.apache.org) with ESMTP id 35DADC4FD6
	for <dev@httpd.apache.org>; Sat, 12 Dec 2015 00:00:02 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd1-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.102
X-Spam-Level:
X-Spam-Status: No, score=-0.102 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RCVD_IN_MSPIKE_H2=-0.001, SPF_PASS=-0.001] autolearn=disabled
Authentication-Results: spamd1-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd1-us-west.apache.org [10.40.0.7]) (amavisd-new, port 10024)
	with ESMTP id 3q9RgGRGkv1E for <dev@httpd.apache.org>;
	Sat, 12 Dec 2015 00:00:01 +0000 (UTC)
Received: from mail-qg0-f47.google.com (mail-qg0-f47.google.com [209.85.192.47])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id AAD5524D8E
	for <dev@httpd.apache.org>; Sat, 12 Dec 2015 00:00:00 +0000 (UTC)
Received: by qgz52 with SMTP id 52so22459787qgz.1
        for <dev@httpd.apache.org>; Fri, 11 Dec 2015 15:59:54 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        bh=9J8HBU3Z0BGgWKyY3mh1W3jsa9o/Wfnwdc55sfI9pdw=;
        b=gd09EDb5r2xH2LOOivmS0xfAW9Ju4+ruMcrxn1lCBkQZYzMq6V8qNX1bMoJwxMrlHH
         uN5itOCxI3qX0LjSRmNOaGeBFrooYc+P0omDUqZk2zegaB6CqW3hCTMaqOKx0wVGx7PK
         d3aRH0WSEK4QPPOtFkZP1rVHkEAmGSegsA1Jq0C19YbgVFvg8+33fZXTNxWT0ALSe6+s
         5wguFmpM8DqCoU+lbyVokhqgvTRdE0FMrXmbjmaR9gPJHS07hvZJGYovr2HyprVuA+tc
         1dFgBDTKkxVhkOFVDPkj2v0AOwWurUYURfZEMRxMt3hCsx/rIEN9DhhkoRI0GYdHm2aA
         8R7A==
MIME-Version: 1.0
X-Received: by 10.140.89.201 with SMTP id v67mr27991889qgd.38.1449878394401;
 Fri, 11 Dec 2015 15:59:54 -0800 (PST)
Received: by 10.55.65.85 with HTTP; Fri, 11 Dec 2015 15:59:54 -0800 (PST)
In-Reply-To: <CAKQ1sVNd1jyisC44xjVQswvK-Zq3zEhqRGUu6PLAQWWHY-+duQ@mail.gmail.com>
References: <CACsi250=dbRQKnsbE8JSdAZRm5x99gE0sgX3iQ-PHAx77euD1A@mail.gmail.com>
	<13FE9E7F-9620-4BF9-8EA4-57A6314D66BF@greenbytes.de>
	<9CCEFD7E-9ED3-4ED1-8F58-2134DD5310F9@gbiv.com>
	<CACsi252y7nX0kR9+JgSra7Q_5_LVqaR3z6ExPKg=Lhi8zhN4ew@mail.gmail.com>
	<566887B5.2080705@gmail.com>
	<CACsi253sTRbX2dnuq0yRP1sHb8vOos_9QaoYmA3TtYmnNx-Erg@mail.gmail.com>
	<5668CC4F.109@gmail.com>
	<CACsi253q+GanuRzOqBjaOe-h1w8uOcH6uFAcdres=+ig5q6+VA@mail.gmail.com>
	<5668EFDB.1050900@gmail.com>
	<CACsi252HOz3_BO6hJtRTfM=M6oB0ZUXpSvkPmKs8LWP3LCz8xA@mail.gmail.com>
	<EC8AA057-325B-4176-88A8-D9E5073C7F32@greenbytes.de>
	<CAKQ1sVO0pade3_QMnftz38NajZ6v17+9CUz8PW_j3Zj2OvysZA@mail.gmail.com>
	<482349A8-86D1-42EF-A436-C907BDF9DF7D@greenbytes.de>
	<d3ce01d133ff$c50fa930$4f2efb90$@qqmail.nl>
	<566B2071.4080108@gmail.com>
	<CACsi251r2KxQ3dOgXOVfV9nOh-fmyVG0C0g2dS=h2qTMvrjqfw@mail.gmail.com>
	<566B383D.9010306@gmail.com>
	<CACsi251jRbJgEo4aP7AFe0Wfz4KWv8Zcbo6LMUAAkQDDqiJp9g@mail.gmail.com>
	<566B5293.2080803@gmail.com>
	<CAKQ1sVNd1jyisC44xjVQswvK-Zq3zEhqRGUu6PLAQWWHY-+duQ@mail.gmail.com>
Date: Sat, 12 Dec 2015 00:59:54 +0100
Message-ID: <CAKQ1sVMCDhkbEeSFVudX6UHxZeSUJ=TYufnZMPwEKS+aT-TCKw@mail.gmail.com>
Subject: Re: Upgrade Summary
From: Yann Ylavic <ylavic.dev@gmail.com>
To: httpd-dev <dev@httpd.apache.org>
Content-Type: text/plain; charset=UTF-8

On Sat, Dec 12, 2015 at 12:41 AM, Yann Ylavic <ylavic.dev@gmail.com> wrote:
> Hi Jacob,
>
> On Fri, Dec 11, 2015 at 11:47 PM, Jacob Champion <champion.p@gmail.com> wrote:
>>
>> This is where we disagree, for the case of WebSocket and WebSocket alone.
>> RFC 6455 4.2.1:
>>
>>    The client's opening handshake consists of the following parts.  If
>>    the server, while reading the handshake, finds that the client did
>>    not send a handshake that matches the description below (note that as
>>    per [RFC2616], the order of the header fields is not important),
>>    including but not limited to any violations of the ABNF grammar
>>    specified for the components of the handshake, the server MUST stop
>>    processing the client's handshake and return an HTTP response with an
>>    appropriate error code (such as 400 Bad Request).
>
> I guess the RFC is talking about a Websocket server that also
> implements HTTP/1 for Websocket purpose only.
> In httpd, the protocol parsing is done by the core http module before
> any websocket module is called, so there can't (at least shouldn't) be
> an invalid HTTP/1 grammar at that level (post_read_request[_header]),
> HTTP/1 failures ought to be handled by the core (http module),
> including ill/invalid body transfer encoding/length.
> So the error could be an unacceptable handshake for the websocket
> module, which should then let httpd handle the HTTP/1 request
> (ignoring the handshake and probably websocket headers too).

Please note that httpd's default (HTTP/1) handler can always catch
"http/1" not in Protocols and return "505 Not Supported" if the
request reaches it.
The administrator configures acceptable protocols, and httpd gives
each one's module a chance, defaulting to HTTP/1 (or 505) if none
accepts the handshake.

From dev-return-85063-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Sat Dec 12 02:04:00 2015
Return-Path: <dev-return-85063-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id C9D8A18523
	for <apmail-httpd-dev-archive@www.apache.org>; Sat, 12 Dec 2015 02:04:00 +0000 (UTC)
Received: (qmail 46134 invoked by uid 500); 12 Dec 2015 02:03:59 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 46052 invoked by uid 500); 12 Dec 2015 02:03:59 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 46042 invoked by uid 99); 12 Dec 2015 02:03:59 -0000
Received: from Unknown (HELO spamd1-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sat, 12 Dec 2015 02:03:59 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd1-us-west.apache.org (ASF Mail Server at spamd1-us-west.apache.org) with ESMTP id 44CE6CC412
	for <dev@httpd.apache.org>; Sat, 12 Dec 2015 02:03:59 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd1-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 2.88
X-Spam-Level: **
X-Spam-Status: No, score=2.88 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	HTML_MESSAGE=3, RCVD_IN_MSPIKE_H3=-0.01, RCVD_IN_MSPIKE_WL=-0.01,
	SPF_PASS=-0.001, URIBL_BLOCKED=0.001] autolearn=disabled
Authentication-Results: spamd1-us-west.apache.org (amavisd-new);
	dkim=pass (1024-bit key) header.d=qqmail.nl
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd1-us-west.apache.org [10.40.0.7]) (amavisd-new, port 10024)
	with ESMTP id JDI7ChtSUHnX for <dev@httpd.apache.org>;
	Sat, 12 Dec 2015 02:03:51 +0000 (UTC)
Received: from mail-wm0-f41.google.com (mail-wm0-f41.google.com [74.125.82.41])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id E6BF323047
	for <dev@httpd.apache.org>; Sat, 12 Dec 2015 02:03:50 +0000 (UTC)
Received: by mail-wm0-f41.google.com with SMTP id c201so94808795wme.0
        for <dev@httpd.apache.org>; Fri, 11 Dec 2015 18:03:50 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=qqmail.nl; s=google;
        h=message-id:mime-version:to:from:subject:date:importance:in-reply-to
         :references:content-type;
        bh=yjQRd/aDzc9I/l/9JQVfDhwR+RfqX7JirBG8GQUoZak=;
        b=XMPe720Bdo9qYx+Q7nXhl1nbMpTjckMUTGjtxVFQ0j7VrNu9euNB/EaQNIlvR8Zi6H
         s2jTGTa6drNo2IRezX5kxMcfihdR590/9GLK4pSNvPqMVmcibL6ZcEMviyDYiXnks09Q
         V+5kL7IA0+FdB8qFl1aeEMhX7ssR90Jvkrx4U=
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=1e100.net; s=20130820;
        h=x-gm-message-state:message-id:mime-version:to:from:subject:date
         :importance:in-reply-to:references:content-type;
        bh=yjQRd/aDzc9I/l/9JQVfDhwR+RfqX7JirBG8GQUoZak=;
        b=hb2qPDStQ2mZLAxvL8OR+kMQinLUBwHQIBtgwKYKNXSCbMkgM6wYpaiflXIYG9bvHd
         1ht/YHdDXjgYrejxedN3m/USMwhJRvnfrMO/SlYEXRz2ecZrdp+syVYyd32fVbRYYffc
         /Agk7dFgSN8PBazb00iWmHRDoB/HXlym5WNnLsLMm2/02PIRHMOhW7M7h8TUngZy0//t
         1ltJXVDhp6g8mLN4WEBl4rwr4iCn0HjDRjCsEFMdqS9x+c+eQFshjKUs/ZYyQ4gaHeUf
         H1L1mxZaoE49ERnjWSgV4XCt6HyvAjCzL/vjqQBrUrz9LG4sXv28H1WHj0WWwDzdH9Qe
         qE+w==
X-Gm-Message-State: ALoCoQkXa733KQb8E9F+X4SWEgOSu7BCsEpq8/x1c5li4fk3rWz3mbKc25r9Xd0yUyBG+S2u3IcOESmwRUJ67qFYKAZqEusWxA==
X-Received: by 10.28.0.149 with SMTP id 143mr10258156wma.48.1449885830539;
        Fri, 11 Dec 2015 18:03:50 -0800 (PST)
Received: from ?IPv6:2001:610:66e:0:c233:5eff:fe29:3cff? ([2001:610:66e:0:c233:5eff:fe29:3cff])
        by smtp.gmail.com with ESMTPSA id 200sm5722225wmn.11.2015.12.11.18.03.48
        (version=TLSv1/SSLv3 cipher=OTHER);
        Fri, 11 Dec 2015 18:03:49 -0800 (PST)
Message-ID: <566b8085.d10d1c0a.30a67.0674@mx.google.com>
MIME-Version: 1.0
To: Yann Ylavic <ylavic.dev@gmail.com>, 
	"dev@httpd.apache.org" <dev@httpd.apache.org>
From: Bert Huijben <bert@qqmail.nl>
Subject: RE: Upgrade Summary
Date: Sat, 12 Dec 2015 03:03:49 +0100
Importance: normal
X-Priority: 3
In-Reply-To:
 <CAKQ1sVNx9pnpZ=cySYYnZ1HdCpLHFjftpUUfvUeginfZ0jz6mA@mail.gmail.com>
References:
 <CACsi250=dbRQKnsbE8JSdAZRm5x99gE0sgX3iQ-PHAx77euD1A@mail.gmail.com>
 <AB1691BE05AE7F4992697F2A0835627AC63BAB94@VOEXM10W.internal.vodafone.com>
 <F7B20D30-D34A-4805-A77D-F64F6428F6E3@greenbytes.de>
 <56660896.c74fc20a.15f56.0ebd@mx.google.com> <56660B43.2060507@gmail.com>
 <6B13DF2B-0586-42BB-B62F-59A7638B697D@greenbytes.de>
 <13FE9E7F-9620-4BF9-8EA4-57A6314D66BF@greenbytes.de>
 <9CCEFD7E-9ED3-4ED1-8F58-2134DD5310F9@gbiv.com>
 <CACsi252y7nX0kR9+JgSra7Q_5_LVqaR3z6ExPKg=Lhi8zhN4ew@mail.gmail.com>
 <566887B5.2080705@gmail.com>
 <CACsi253sTRbX2dnuq0yRP1sHb8vOos_9QaoYmA3TtYmnNx-Erg@mail.gmail.com>
 <5668CC4F.109@gmail.com>
 <CACsi253q+GanuRzOqBjaOe-h1w8uOcH6uFAcdres=+ig5q6+VA@mail.gmail.com>
 <5668EFDB.1050900@gmail.com>
 <CACsi252HOz3_BO6hJtRTfM=M6oB0ZUXpSvkPmKs8LWP3LCz8xA@mail.gmail.com>
 <EC8AA057-325B-4176-88A8-D9E5073C7F32@greenbytes.de>
 <CAKQ1sVO0pade3_QMnftz38NajZ6v17+9CUz8PW_j3Zj2OvysZA@mail.gmail.com>
 <566b60cd.e2b0c20a.7cbe6.ffff86fa@mx.google.com>
 <CAKQ1sVNx9pnpZ=cySYYnZ1HdCpLHFjftpUUfvUeginfZ0jz6mA@mail.gmail.com>
Content-Type: multipart/alternative;
	boundary="_9530D3F8-BFF4-4D01-9CBC-A85FDD339217_"

--_9530D3F8-BFF4-4D01-9CBC-A85FDD339217_
Content-Transfer-Encoding: quoted-printable
Content-Type: text/plain; charset="utf-8"

I=E2=80=99m not talking about why the client does want the upgrade=E2=80=A6

Perhaps it doesn=E2=80=99t know if port 443 uses TLS or hosts the same cont=
ent. In general it is just a lucky guess that it does have the same content=
. The Alt-Svc spec might help here, but currently this still requires the a=
dmin to configure things=E2=80=A6 and I don=E2=80=99t see that change anyti=
me soon. (And if it would be automatic, it would still assume no firewalls,=
 certificate availability, etc., etc.)


What I=E2=80=99m trying to say is: we should not just deny connections an u=
pgrade for no reason. If we can upgrade the connection with a body=E2=80=A6=
 why explicitly deny it *after* we already received the body? If we want to=
 reuse the connection we have to read the body anyway.


We can=E2=80=99t make the connection more secure by asking the client to re=
try the request=E2=80=A6 We can only make things less secure that way.


Returning a 4XX error just makes the client retry the request (perhaps afte=
r asking the user). The 4XX will be more work for the server, more work for=
 the client and perhaps even for the end user.

We don=E2=80=99t make the web more secure by denying upgrades after the req=
uest is already sent. And as http/1.1 doesn=E2=80=99t have a way to stop a =
request before it is sent without resetting the connection I would say that=
 we upgrade to TLS and/or H2c whenever possible.

The server can=E2=80=99t decide if the client should send the request unenc=
rypted or not *after* it is already on the wire unencrypted.

By not upgrading we *as server* decide that the next request on the same co=
nnection will be unencrypted as well=E2=80=A6 By returning a 4XX (or other =
error) we ask the client to retry again; most likely on the same connection=
 and just as unencrypted as the previous request.

On disconnecting we do the same thing=E2=80=A6.

The only way to ensure encryption or more advanced protocol support is hono=
ring the upgrade request as soon as possible.

The deadlock scenarios on bodies that can=E2=80=99t be sent while the reque=
st is read are no reason to just block upgrades=E2=80=A6 These same deadloc=
ks can occur for dozens of different reasons and in case of h2 even after u=
pgrade. (Don=E2=80=99t send window updates and everything stalls=E2=80=A6 b=
y design). At that point we can handle the error, just like how we handle t=
imeouts on http/1.1

With h2 we can even force stream 1 (the response for the upgraded request) =
to close with an appropriate stream error in that case=E2=80=A6 so we can s=
till reuse the connection.


With h2 you can in theory start the response in h2 while you are still read=
ing the http/1.1 body, while with TLS you can=E2=80=99t as you need a two w=
ay handshake.

There will be cases where the upgrade path definitely breaks (e.g. huge/inf=
inite chunked request echoed as response), but I think in most cases it can=
 succeed without a problem. Just returning an error in easy cases for consi=
stency with the cases where it can=E2=80=99t work doesn=E2=80=99t really he=
lp.



The problem with errors like 413 is that in clients like Subversion we can =
only handle them by showing them as fatal error to the user. The printer sc=
enario for upgrades to TLS probably does the same thing. Printing works or =
doesn=E2=80=99t work=E2=80=A6 It doesn=E2=80=99t allow retrying with a diff=
erent request.

Not upgrading is an option=E2=80=A6 But upgrading under less favorable cond=
itions is what makes things work.

      Bert

Sent from Mail for Windows 10



From: Yann Ylavic
Sent: zaterdag 12 december 2015 01:46
To: Bert Huijben
Subject: Re: Upgrade Summary


On Sat, Dec 12, 2015 at 12:48 AM, Bert Huijben <bert@qqmail.nl> wrote:
> If you request an upgrade to TLS on your initial request, upgrading with =
a
> body might still make sense. Especially if the server would respond with =
a
> 401. But also if the request can be public, but the response needs to be
> secured.

Why using Upgrade at the first place if you are confident enough (to
play auth) with the server being TLS ready?
Wouldn't a direct https connection be better?

Is there such an authentication protocol?
If so, I guess we can do the TLS Upgrade+handshake in the output
filter (as proposed) like any other Protocols Upgrade, letting httpd
handle that first clear text request body...
That's possible without setting aside the body anyway, still I doubt
there is a real need for it (if a TLS Upgrade is asked, the client
shouldn't mind the first (half) round trip and play it's auth on the
second (TLSed) request.

>
> If we blindly ignore the upgrade as =E2=80=98doesn=E2=80=99t make sense=
=E2=80=99, the next request
> wouldn=E2=80=99t use encryption=E2=80=A6 but if we upgraded to TLS after =
the request, the
> next request=E2=80=A6 with the authentication headers could be sent encry=
pted.

My preference would be to return an error (413), so that the client
notices what's "better" for a TLS Upgrade (no body), but if there
really exist such a cleartext body use case I'm fine with honoring the
body too.

>
> If upgrading the first request doesn=E2=80=99t make sense the client shou=
ld use a
> different request (Like options *, or HEAD /).

That are, AFAICT, the only use cases so far.

>
> If the server denies the request at least some parts have already travell=
ed
> the network unencrypted. Returning an error or not upgrading will only ma=
ke
> sure more requests will travel unencrypted.

The client would not send encrypted vs unencrypted (Upgrade) request
depending on the response status, it must send plaintext request
anyway, it ought to know that.
IOW the error response is not a security issue at all, on the contrary
if a client relies on current httpd behaviour to do the handshake
before reading the body, and hence sends private things in the body of
the Upgrade request, it would notice with a response error.
Anyway if the RFC is respected, the TLS handshake doesn't happen
before any body is (fully) received on the server, hence such client
would wait for the handshake before sending anything, and that would
timeout.
Again, an error response is better here...

>
> The response is not the only thing encrypted when upgrading=E2=80=A6 all =
future
> requests are. Upgrade is a connection level request, sent via a request.

Agreed.

Regards,
Yann.



--_9530D3F8-BFF4-4D01-9CBC-A85FDD339217_
Content-Transfer-Encoding: quoted-printable
Content-Type: text/html; charset="utf-8"

<html xmlns:o=3D"urn:schemas-microsoft-com:office:office" xmlns:w=3D"urn:sc=
hemas-microsoft-com:office:word" xmlns:m=3D"http://schemas.microsoft.com/of=
fice/2004/12/omml" xmlns=3D"http://www.w3.org/TR/REC-html40"><head><meta ht=
tp-equiv=3DContent-Type content=3D"text/html; charset=3Dutf-8"><meta name=
=3DGenerator content=3D"Microsoft Word 15 (filtered medium)"><style><!--
/* Font Definitions */
@font-face
	{font-family:"Cambria Math";
	panose-1:2 4 5 3 5 4 6 3 2 4;}
@font-face
	{font-family:Calibri;
	panose-1:2 15 5 2 2 2 4 3 2 4;}
/* Style Definitions */
p.MsoNormal, li.MsoNormal, div.MsoNormal
	{margin:0cm;
	margin-bottom:.0001pt;
	font-size:11.0pt;
	font-family:"Calibri",sans-serif;}
a:link, span.MsoHyperlink
	{mso-style-priority:99;
	color:blue;
	text-decoration:underline;}
a:visited, span.MsoHyperlinkFollowed
	{mso-style-priority:99;
	color:#954F72;
	text-decoration:underline;}
p
	{mso-style-priority:99;
	margin:0cm;
	margin-bottom:.0001pt;
	font-size:11.0pt;
	font-family:"Times New Roman",serif;}
.MsoChpDefault
	{mso-style-type:export-only;}
@page WordSection1
	{size:612.0pt 792.0pt;
	margin:72.0pt 72.0pt 72.0pt 72.0pt;}
div.WordSection1
	{page:WordSection1;}
--></style></head><body lang=3DNL link=3Dblue vlink=3D"#954F72"><div class=
=3DWordSection1><p class=3DMsoNormal><span lang=3DEN-US>I=E2=80=99m not tal=
king about why the client does want the upgrade=E2=80=A6<o:p></o:p></span><=
/p><p class=3DMsoNormal><span lang=3DEN-US><o:p>&nbsp;</o:p></span></p><p c=
lass=3DMsoNormal><span lang=3DEN-US>Perhaps it doesn=E2=80=99t know if port=
 443 uses TLS or hosts the same content. In general it is just a lucky gues=
s that it does have the same content. The Alt-Svc spec might help here, but=
 currently this still requires the admin to configure things=E2=80=A6 and I=
 don=E2=80=99t see that change anytime soon. (And if it would be automatic,=
 it would still assume no firewalls, certificate availability, etc., etc.)<=
o:p></o:p></span></p><p class=3DMsoNormal><span lang=3DEN-US><o:p>&nbsp;</o=
:p></span></p><p class=3DMsoNormal><span lang=3DEN-US><o:p>&nbsp;</o:p></sp=
an></p><p class=3DMsoNormal><span lang=3DEN-US>What I=E2=80=99m trying to s=
ay is: we should not just deny connections an upgrade for no reason. If we =
can upgrade the connection with a body=E2=80=A6 why explicitly deny it *<b>=
after</b>* we already received the body? If we want to reuse the connection=
 we have to read the body anyway.<o:p></o:p></span></p><p class=3DMsoNormal=
><span lang=3DEN-US><o:p>&nbsp;</o:p></span></p><p class=3DMsoNormal><span =
lang=3DEN-US><o:p>&nbsp;</o:p></span></p><p class=3DMsoNormal><span lang=3D=
EN-US>We can=E2=80=99t make the connection more secure by asking the client=
 to retry the request=E2=80=A6 We can only make things less secure that way=
.<o:p></o:p></span></p><p class=3DMsoNormal><span lang=3DEN-US><o:p>&nbsp;<=
/o:p></span></p><p class=3DMsoNormal><span lang=3DEN-US><o:p>&nbsp;</o:p></=
span></p><p class=3DMsoNormal><span lang=3DEN-US>Returning a 4XX error just=
 makes the client retry the request (perhaps after asking the user). The 4X=
X will be more work for the server, more work for the client and perhaps ev=
en for the end user.<o:p></o:p></span></p><p class=3DMsoNormal><span lang=
=3DEN-US><o:p>&nbsp;</o:p></span></p><p class=3DMsoNormal><span lang=3DEN-U=
S>We don=E2=80=99t make the web more secure by denying upgrades after the r=
equest is already sent. And as http/1.1 doesn=E2=80=99t have a way to stop =
a request before it is sent without resetting the connection I would say th=
at we upgrade to TLS and/or H2c whenever possible.<o:p></o:p></span></p><p =
class=3DMsoNormal><span lang=3DEN-US><o:p>&nbsp;</o:p></span></p><p class=
=3DMsoNormal><span lang=3DEN-US>The server can=E2=80=99t decide if the clie=
nt should send the request unencrypted or not *<b>after</b>* it is already =
on the wire unencrypted.<o:p></o:p></span></p><p class=3DMsoNormal><span la=
ng=3DEN-US><o:p>&nbsp;</o:p></span></p><p class=3DMsoNormal><span lang=3DEN=
-US>By not upgrading we *<b>as server</b>* decide that the next request on =
the same connection will be unencrypted as well=E2=80=A6 By returning a 4XX=
 (or other error) we ask the client to retry again; most likely on the same=
 connection and just as unencrypted as the previous request.<o:p></o:p></sp=
an></p><p class=3DMsoNormal><span lang=3DEN-US><o:p>&nbsp;</o:p></span></p>=
<p class=3DMsoNormal><span lang=3DEN-US>On disconnecting we do the same thi=
ng=E2=80=A6.<o:p></o:p></span></p><p class=3DMsoNormal><span lang=3DEN-US><=
o:p>&nbsp;</o:p></span></p><p class=3DMsoNormal><span lang=3DEN-US>The only=
 way to ensure encryption or more advanced protocol support is honoring the=
 upgrade request as soon as possible.<o:p></o:p></span></p><p class=3DMsoNo=
rmal><span lang=3DEN-US><o:p>&nbsp;</o:p></span></p><p class=3DMsoNormal><s=
pan lang=3DEN-US>The deadlock scenarios on bodies that can=E2=80=99t be sen=
t while the request is read are no reason to just block upgrades=E2=80=A6 T=
hese same deadlocks can occur for dozens of different reasons and in case o=
f h2 even after upgrade. (Don=E2=80=99t send window updates and everything =
stalls=E2=80=A6 by design). At that point we can handle the error, just lik=
e how we handle timeouts on http/1.1<o:p></o:p></span></p><p class=3DMsoNor=
mal><span lang=3DEN-US><o:p>&nbsp;</o:p></span></p><p class=3DMsoNormal><sp=
an lang=3DEN-US>With h2 we can even force stream 1 (the response for the up=
graded request) to close with an appropriate stream error in that case=E2=
=80=A6 so we can still reuse the connection.<o:p></o:p></span></p><p class=
=3DMsoNormal><o:p>&nbsp;</o:p></p><p class=3DMsoNormal><o:p>&nbsp;</o:p></p=
><p class=3DMsoNormal><span lang=3DEN-US>With h2 you can in theory start th=
e response in h2 while you are still reading the http/1.1 body, while with =
TLS you can=E2=80=99t as you need a two way handshake.<o:p></o:p></span></p=
><p class=3DMsoNormal><span lang=3DEN-US><o:p>&nbsp;</o:p></span></p><p cla=
ss=3DMsoNormal><span lang=3DEN-US>There will be cases where the upgrade pat=
h definitely breaks (e.g. huge/infinite chunked request echoed as response)=
, but I think in most cases it can succeed without a problem. Just returnin=
g an error in easy cases for consistency with the cases where it can=E2=80=
=99t work doesn=E2=80=99t really help.</span></p><p class=3DMsoNormal><o:p>=
&nbsp;</o:p></p><p class=3DMsoNormal><o:p>&nbsp;</o:p></p><p class=3DMsoNor=
mal><o:p>&nbsp;</o:p></p><p class=3DMsoNormal><span lang=3DEN-US>The proble=
m with errors like 413 is that in clients like Subversion we can only handl=
e them by showing them as fatal error to the user. The printer scenario for=
 upgrades to TLS probably does the same thing. Printing works or doesn=E2=
=80=99t work=E2=80=A6 It doesn=E2=80=99t allow retrying with a different re=
quest.<o:p></o:p></span></p><p class=3DMsoNormal><span lang=3DEN-US><o:p>&n=
bsp;</o:p></span></p><p class=3DMsoNormal><span lang=3DEN-US>Not upgrading =
is an option=E2=80=A6 But upgrading under less favorable conditions is what=
 makes things work.<o:p></o:p></span></p><p class=3DMsoNormal><span lang=3D=
EN-US><o:p>&nbsp;</o:p></span></p><p class=3DMsoNormal><span lang=3DEN-US>=
=C2=A0=C2=A0=C2=A0=C2=A0=C2=A0 Bert<o:p></o:p></span></p><p class=3DMsoNorm=
al><o:p>&nbsp;</o:p></p><p class=3DMsoNormal>Sent from <a href=3D"http://go=
.microsoft.com/fwlink/?LinkId=3D550986">Mail</a> for Windows 10</p><p><o:p>=
&nbsp;</o:p></p><p><o:p>&nbsp;</o:p></p><div style=3D'mso-element:para-bord=
er-div;border:none;border-top:solid #E1E1E1 1.0pt;padding:3.0pt 0cm 0cm 0cm=
'><p class=3DMsoNormal style=3D'mso-margin-top-alt:auto;mso-margin-bottom-a=
lt:auto;border:none;padding:0cm'><br><b>From: </b>Yann Ylavic<br><b>Sent: <=
/b>zaterdag 12 december 2015 01:46<br><b>To: </b>Bert Huijben<br><b>Subject=
: </b>Re: Upgrade Summary</p></div><p class=3DMsoNormal><o:p>&nbsp;</o:p></=
p><p class=3DMsoNormal><span style=3D'font-size:12.0pt;font-family:"Times N=
ew Roman",serif'><o:p>&nbsp;</o:p></span></p><p class=3DMsoNormal>On Sat, D=
ec 12, 2015 at 12:48 AM, Bert Huijben &lt;bert@qqmail.nl&gt; wrote:</p><p c=
lass=3DMsoNormal>&gt; If you request an upgrade to TLS on your initial requ=
est, upgrading with a</p><p class=3DMsoNormal>&gt; body might still make se=
nse. Especially if the server would respond with a</p><p class=3DMsoNormal>=
&gt; 401. But also if the request can be public, but the response needs to =
be</p><p class=3DMsoNormal>&gt; secured.</p><p class=3DMsoNormal><o:p>&nbsp=
;</o:p></p><p class=3DMsoNormal>Why using Upgrade at the first place if you=
 are confident enough (to</p><p class=3DMsoNormal>play auth) with the serve=
r being TLS ready?</p><p class=3DMsoNormal>Wouldn't a direct https connecti=
on be better?</p><p class=3DMsoNormal><o:p>&nbsp;</o:p></p><p class=3DMsoNo=
rmal>Is there such an authentication protocol?</p><p class=3DMsoNormal>If s=
o, I guess we can do the TLS Upgrade+handshake in the output</p><p class=3D=
MsoNormal>filter (as proposed) like any other Protocols Upgrade, letting ht=
tpd</p><p class=3DMsoNormal>handle that first clear text request body...</p=
><p class=3DMsoNormal>That's possible without setting aside the body anyway=
, still I doubt</p><p class=3DMsoNormal>there is a real need for it (if a T=
LS Upgrade is asked, the client</p><p class=3DMsoNormal>shouldn't mind the =
first (half) round trip and play it's auth on the</p><p class=3DMsoNormal>s=
econd (TLSed) request.</p><p class=3DMsoNormal><o:p>&nbsp;</o:p></p><p clas=
s=3DMsoNormal>&gt;<o:p>&nbsp;</o:p></p><p class=3DMsoNormal>&gt; If we blin=
dly ignore the upgrade as =E2=80=98doesn=E2=80=99t make sense=E2=80=99, the=
 next request</p><p class=3DMsoNormal>&gt; wouldn=E2=80=99t use encryption=
=E2=80=A6 but if we upgraded to TLS after the request, the</p><p class=3DMs=
oNormal>&gt; next request=E2=80=A6 with the authentication headers could be=
 sent encrypted.</p><p class=3DMsoNormal><o:p>&nbsp;</o:p></p><p class=3DMs=
oNormal>My preference would be to return an error (413), so that the client=
</p><p class=3DMsoNormal>notices what's &quot;better&quot; for a TLS Upgrad=
e (no body), but if there</p><p class=3DMsoNormal>really exist such a clear=
text body use case I'm fine with honoring the</p><p class=3DMsoNormal>body =
too.</p><p class=3DMsoNormal><o:p>&nbsp;</o:p></p><p class=3DMsoNormal>&gt;=
<o:p>&nbsp;</o:p></p><p class=3DMsoNormal>&gt; If upgrading the first reque=
st doesn=E2=80=99t make sense the client should use a</p><p class=3DMsoNorm=
al>&gt; different request (Like options *, or HEAD /).</p><p class=3DMsoNor=
mal><o:p>&nbsp;</o:p></p><p class=3DMsoNormal>That are, AFAICT, the only us=
e cases so far.</p><p class=3DMsoNormal><o:p>&nbsp;</o:p></p><p class=3DMso=
Normal>&gt;<o:p>&nbsp;</o:p></p><p class=3DMsoNormal>&gt; If the server den=
ies the request at least some parts have already travelled</p><p class=3DMs=
oNormal>&gt; the network unencrypted. Returning an error or not upgrading w=
ill only make</p><p class=3DMsoNormal>&gt; sure more requests will travel u=
nencrypted.</p><p class=3DMsoNormal><o:p>&nbsp;</o:p></p><p class=3DMsoNorm=
al>The client would not send encrypted vs unencrypted (Upgrade) request</p>=
<p class=3DMsoNormal>depending on the response status, it must send plainte=
xt request</p><p class=3DMsoNormal>anyway, it ought to know that.</p><p cla=
ss=3DMsoNormal>IOW the error response is not a security issue at all, on th=
e contrary</p><p class=3DMsoNormal>if a client relies on current httpd beha=
viour to do the handshake</p><p class=3DMsoNormal>before reading the body, =
and hence sends private things in the body of</p><p class=3DMsoNormal>the U=
pgrade request, it would notice with a response error.</p><p class=3DMsoNor=
mal>Anyway if the RFC is respected, the TLS handshake doesn't happen</p><p =
class=3DMsoNormal>before any body is (fully) received on the server, hence =
such client</p><p class=3DMsoNormal>would wait for the handshake before sen=
ding anything, and that would</p><p class=3DMsoNormal>timeout.</p><p class=
=3DMsoNormal>Again, an error response is better here...</p><p class=3DMsoNo=
rmal><o:p>&nbsp;</o:p></p><p class=3DMsoNormal>&gt;<o:p>&nbsp;</o:p></p><p =
class=3DMsoNormal>&gt; The response is not the only thing encrypted when up=
grading=E2=80=A6 all future</p><p class=3DMsoNormal>&gt; requests are. Upgr=
ade is a connection level request, sent via a request.</p><p class=3DMsoNor=
mal><o:p>&nbsp;</o:p></p><p class=3DMsoNormal>Agreed.</p><p class=3DMsoNorm=
al><o:p>&nbsp;</o:p></p><p class=3DMsoNormal>Regards,</p><p class=3DMsoNorm=
al>Yann.</p><p class=3DMsoNormal><o:p>&nbsp;</o:p></p><p class=3DMsoNormal>=
<o:p>&nbsp;</o:p></p></div></body></html>=

--_9530D3F8-BFF4-4D01-9CBC-A85FDD339217_--


From dev-return-85064-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Sun Dec 13 07:15:16 2015
Return-Path: <dev-return-85064-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id AA8491838A
	for <apmail-httpd-dev-archive@www.apache.org>; Sun, 13 Dec 2015 07:15:16 +0000 (UTC)
Received: (qmail 93118 invoked by uid 500); 13 Dec 2015 07:15:15 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 93050 invoked by uid 500); 13 Dec 2015 07:15:15 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 93041 invoked by uid 99); 13 Dec 2015 07:15:15 -0000
Received: from mail-relay.apache.org (HELO mail-relay.apache.org) (140.211.11.15)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 13 Dec 2015 07:15:15 +0000
Received: from asf-bz1-us-mid.priv.apache.org (nat1-us-mid.apache.org [23.253.172.122])
	by mail-relay.apache.org (ASF Mail Server at mail-relay.apache.org) with ESMTPS id 7D0901A0042
	for <dev@httpd.apache.org>; Sun, 13 Dec 2015 07:15:15 +0000 (UTC)
Received: by asf-bz1-us-mid.priv.apache.org (ASF Mail Server at asf-bz1-us-mid.priv.apache.org, from userid 0)
	id E1D9360475; Sun, 13 Dec 2015 07:15:14 +0000 (UTC)
From: bugzilla@apache.org
To: dev@httpd.apache.org
Subject: Bug report for Apache httpd-2 [2015/12/13]
Message-Id: <20151213071514.E1D9360475@asf-bz1-us-mid.priv.apache.org>
Date: Sun, 13 Dec 2015 07:15:05 +0000 (UTC)

+---------------------------------------------------------------------------+
| Bugzilla Bug ID                                                           |
|     +---------------------------------------------------------------------+
|     | Status: UNC=Unconfirmed NEW=New         ASS=Assigned                |
|     |         OPN=Reopened    VER=Verified    (Skipped Closed/Resolved)   |
|     |   +-----------------------------------------------------------------+
|     |   | Severity: BLK=Blocker CRI=Critical  REG=Regression  MAJ=Major   |
|     |   |           MIN=Minor   NOR=Normal    ENH=Enhancement TRV=Trivial |
|     |   |   +-------------------------------------------------------------+
|     |   |   | Date Posted                                                 |
|     |   |   |          +--------------------------------------------------+
|     |   |   |          | Description                                      |
|     |   |   |          |                                                  |
| 7483|Ass|Enh|2002-03-26|Add FileAction directive to assign a cgi interpret|
| 8713|Inf|Min|2002-05-01|No Errorlog on PROPFIND/Depth:Infinity            |
| 8867|Opn|Cri|2002-05-07|exports.c generation fails when using a symlink to|
|10747|New|Maj|2002-07-12|ftp SIZE command and 'smart' ftp servers results i|
|11294|New|Enh|2002-07-30|desired vhost_alias option                        |
|11580|Opn|Enh|2002-08-09|generate Content-Location headers                 |
|12033|Opn|Nor|2002-08-26|Graceful restart immediately result in [warn] long|
|12680|New|Enh|2002-09-16|Digest authentication with integrity protection   |
|13599|Inf|Nor|2002-10-14|autoindex formating broken for multibyte sequences|
|13661|Ass|Enh|2002-10-15|Apache cannot not handle dynamic IP reallocation  |
|14104|Opn|Enh|2002-10-30|not documented: must restart server to load new CR|
|14496|New|Enh|2002-11-13|Cannot upgrade any version on Windows. Must uninst|
|14922|Inf|Enh|2002-11-28|<target> is currently hardcoded to 'apache2'      |
|15719|Inf|Nor|2002-12-30|WebDAV MOVE to destination URI which is content-ne|
|16761|Inf|Nor|2003-02-04|CustomLog with pipe spawns process during config  |
|16802|New|Enh|2003-02-05|Additional AllowOverride directive "Restrict"     |
|16811|Ass|Maj|2003-02-05|mod_autoindex always return webpages in UTF-8.    |
|17107|New|Min|2003-02-16|Windows should not install printenv               |
|17114|New|Enh|2003-02-17|Please add strip and install-strip targets to Make|
|17244|Ass|Nor|2003-02-20|./configure --help gives false information regardi|
|17497|Opn|Nor|2003-02-27|mod_mime_magic generates incorrect response header|
|18325|New|Enh|2003-03-25|PAM support for suEXEC                            |
|18334|Inf|Cri|2003-03-25|Server crashes when authenticating users against L|
|18497|New|Min|2003-03-30|configure --help gives wrong default for sysconfdi|
|19043|New|Min|2003-04-15|Interesting interaction between cern_meta module a|
|19670|New|Enh|2003-05-05|content type header supplied upon PUT is thrown aw|
|20036|Ass|Nor|2003-05-19|Trailing Dots stripped from PATH_INFO environment |
|21253|New|Nor|2003-07-01|Mime magic doesn't continue if type is specifed fo|
|21260|New|Nor|2003-07-02|CacheMaxExpire directive not enforced !           |
|21533|Ass|Cri|2003-07-11|Multiple levels of htacces files can cause mod_aut|
|22138|Inf|Cri|2003-08-05|Webdav is not preccessing special chars right.    |
|22237|New|Enh|2003-08-08|option to disable ServerSignature on index pages  |
|22484|Opn|Maj|2003-08-16|semaphore problem takes httpd down                |
|22686|Opn|Nor|2003-08-25|ab: apr_poll: The timeout specified has expired (7|
|22898|Opn|Nor|2003-09-02|nph scripts with two HTTP header                  |
|23167|Inf|Cri|2003-09-14|--enable-layout never goes to apr apr-util        |
|23181|New|Nor|2003-09-15|Status 304 (Not modified) and chunking leads to an|
|23238|New|Cri|2003-09-18|non-async-signal-safe operations from signal handl|
|23330|New|Enh|2003-09-22|Enhance ApacheMonitor to view and control Tomcat s|
|23911|Opn|Cri|2003-10-18|CGI processes left defunct/zombie under 2.0.54    |
|24031|New|Enh|2003-10-23|Passphrase protected private key in SSLProxyMachin|
|24095|Opn|Cri|2003-10-24|ERROR "Parent: child process exited with status 32|
|24437|Opn|Nor|2003-11-05|mod_auth_ldap doubly-escapes backslash (\) charact|
|24890|Opn|Nor|2003-11-21|Apache config parser should not be local aware ( g|
|25014|New|Enh|2003-11-26|A flexible interface for mod_log_config           |
|25201|New|Enh|2003-12-04|Provide Cache Purge operation                     |
|25240|Inf|Enh|2003-12-05|SSL Library Error: 336105671 logged as information|
|25435|New|Enh|2003-12-11|sethandler and directoryindex not playing nice    |
|25469|Opn|Enh|2003-12-12|create AuthRoot for defining paths to auth files  |
|25484|Ass|Nor|2003-12-12|Non-service Apache cannot be stopped in WinXP     |
|25543|Inf|Nor|2003-12-15|mod_proxy_ajp overwrites existing response headers|
|25667|New|Nor|2003-12-19|Memory leak in function ssl_scache_dbm_retrieve().|
|25863|New|Enh|2004-01-02|new per-host initialization hooks                 |
|26005|New|Nor|2004-01-08|SERVER_NAME incorrect when using IPv6 address in U|
|26142|New|Maj|2004-01-14|EnableSendFile Off for Windows XP Home            |
|26153|Opn|Cri|2004-01-15|Apache cygwin directory traversal vulnerability   |
|26368|New|Min|2004-01-23|File extensions in AddDescription treated as part |
|26446|New|Nor|2004-01-26|flush buckets followed by eos bucket emit multiple|
|26478|New|Enh|2004-01-28|mod_dav does not expose a method for setting the D|
|26835|New|Enh|2004-02-10|[PATCH] Mod_status Readability & Browser Side Tabl|
|27257|Ass|Enh|2004-02-26|rotatelogs with getopt and setuid                 |
|27578|New|Enh|2004-03-10|made getlastmodified a writable property          |
|27715|Ass|Enh|2004-03-16|Client sending misformed Range "bytes = 0-100" ins|
|27791|Inf|Nor|2004-03-18|mod_cache doesn't re-cache expired content        |
|27835|New|Enh|2004-03-22|When proxying FTP, all errors turns into 404      |
|27869|New|Enh|2004-03-23|stopping and starting httpd again immediately caus|
|28854|Inf|Nor|2004-05-09|Build fails with missing library call on Solaris i|
|28903|New|Enh|2004-05-11|Hooks to add environment variables to CGI and othe|
|29090|Ass|Enh|2004-05-19|MultiviewsMatch NegotiatedOnly extensions not resp|
|29165|New|Nor|2004-05-24|Parent directory icon not correct                 |
|29446|New|Enh|2004-06-08|want directive for setting content negotiation qua|
|29449|New|Enh|2004-06-09|Limit length of specified fields in LogFormat     |
|29450|New|Enh|2004-06-09|Improved logging for mod_access                   |
|29510|Ass|Enh|2004-06-10|ab does not support multiple cookies              |
|29644|Ver|Nor|2004-06-17|mod_proxy keeps downloading even after the client |
|29755|Opn|Nor|2004-06-23|mod_usertrack should use err_headers_out          |
|29822|New|Enh|2004-06-26|implement FTP 'PUT' support in proxy_ftp.c        |
|29941|Ass|Enh|2004-07-06|log files are not tested for availability on confi|
|30259|Ass|Enh|2004-07-22|When proxy connects to backend, a DNS lookup is do|
|30505|Ass|Enh|2004-08-05|Apache uses 'Error', and not lower level event typ|
|30730|Inf|Nor|2004-08-18|[PatchAvailable] mod_actions and Server-Status    |
|30865|Inf|Maj|2004-08-26|mod_disk_cache leaves many temporary files slowing|
|31302|Opn|Cri|2004-09-19|suexec doesn't execute commands if they're not in |
|31311|New|Enh|2004-09-20|Remote user not logged in reverse proxy scenario  |
|31352|Ass|Enh|2004-09-21|RFE, Bind to LDAP server with browser supplier use|
|31418|Opn|Nor|2004-09-25|SSLUserName is not usable by other modules        |
|31484|New|Maj|2004-09-30|Custom environment variables not passed to content|
|31490|New|Nor|2004-09-30|mod_proxy_ftp renders filenames with spaces badly |
|31565|New|Enh|2004-10-06|Won't start correctly if parent closed stdin, stdo|
|31679|New|Enh|2004-10-12|If the argument of a CGI has two or more consecuti|
|31709|Inf|Nor|2004-10-13|Raises an error on SSL name based virtualhosts (wi|
|31712|New|Enh|2004-10-14|config_file is NULL at ap_walk_config etc         |
|31952|New|Enh|2004-10-29|mod_proxy and RealPlayer: audio content streaming |
|32051|Opn|Nor|2004-11-04|mod_example is not thread safe                    |
|32328|Opn|Enh|2004-11-19|Make mod_rewrite escaping optional / expose intern|
|32346|New|Enh|2004-11-22|mod_include/include virtual checks content-type is|
|32524|New|Enh|2004-12-03|ab: add an option to specify a source address     |
|32703|Inf|Enh|2004-12-14|Cannot determine that Apache is frozen if /var fil|
|32750|Ass|Maj|2004-12-17|mod_proxy + Win32DisableAcceptEx = memory leak    |
|32877|New|Enh|2004-12-29|wrong utf-8 encoding/escaping in a href for umlaut|
|33084|New|Enh|2005-01-13|Optional certificate validity period check on SSLV|
|33089|New|Nor|2005-01-13|mod_include: Options +Includes (or IncludesNoExec)|
|33207|New|Nor|2005-01-23|Results of my suexec.c code audit                 |
|33215|New|Nor|2005-01-24|Cygwin build/install.sh fix (OSTYPE => ext=.exe)  |
|33512|Inf|Maj|2005-02-11|mod_mem_cache and possibly mod_deflate            |
|33627|New|Nor|2005-02-18|Bite-sized changes making progress towards compila|
|33685|New|Maj|2005-02-22|Unable to install in the path containing non engli|
|34270|Inf|Nor|2005-04-01|Large POSTs over SSL from Internet Explorer do not|
|34375|New|Enh|2005-04-08|enhancements for mod_include                      |
|34377|New|Enh|2005-04-08|Allow the overriding of 401 Unauthorized returns f|
|34405|New|Enh|2005-04-11|adds DOCUMENT_NAME_WITHOUT_SUFFIX to mod_include  |
|34508|New|Nor|2005-04-19|Randomly slow graceful restart, not accepting new |
|34519|New|Enh|2005-04-19|Directory index should emit valid XHTML           |
|35049|New|Nor|2005-05-24|let AddDefaultCharset apply to text/css and applic|
|35077|New|Nor|2005-05-26|mod_dav passes incorrect paths with LocationMatch |
|35083|Inf|Enh|2005-05-26|Certificate validation problems trapping          |
|35098|Ver|Maj|2005-05-27|Install fails using --prefix                      |
|35154|New|Nor|2005-06-01|Support for NID_serialNumber, etc. in SSLUserName |
|35245|New|Nor|2005-06-06|cache ignores max-age cache-directive in requests |
|35250|New|Enh|2005-06-07|[PatchAvailable] add logging to mod_proxy_connect |
|35280|New|Nor|2005-06-09|FTP proxy breaks RFC 2428 when trying to fall back|
|35556|Inf|Nor|2005-06-30|CRL files not re-read by HUP                      |
|35652|Opn|Min|2005-07-07|Improve error message: "pcfg_openfile: unable to c|
|35702|New|Nor|2005-07-12|Using with https URL, ab freezes or gets SIGSEGV o|
|35781|New|Nor|2005-07-18|ap_sub_req_method_uri() bypasses Limit security co|
|35981|Inf|Maj|2005-08-02|mod_dav overrides dav_fs response on PUT failure  |
|36286|New|Enh|2005-08-20|configtest doesn't check SSL certificates         |
|36492|New|Nor|2005-09-04|split-logfile script dies when splitting log of ma|
|36495|Inf|Nor|2005-09-05|mod_proxy_ajp: ajp_check_msg_header() got bad sign|
|36564|New|Enh|2005-09-08|make mod_ldap really universal                    |
|36636|New|Maj|2005-09-13|database write lock taken for PROPFIND operations |
|36676|New|Nor|2005-09-15|time() bug in httpd/os/win32/util_win32.c:wait_for|
|36710|Opn|Blk|2005-09-19|CGI output not captured                           |
|36724|New|Nor|2005-09-20|Don't install Apache Monitor by default           |
|37110|New|Nor|2005-10-17|Build fails when source tree is read-only         |
|37196|Inf|Min|2005-10-21|Wrong "Parent directory" link                     |
|37201|New|Enh|2005-10-21|Add <IfInterface IP> syntax to apache configuratio|
|37290|Opn|Min|2005-10-28|DirectoryIndex don't work in scriptaliased directo|
|37307|New|Enh|2005-10-31|Can't suppress error messages                     |
|37355|New|Enh|2005-11-04|Allow to specify Proxy-Authorization in ProxyRemot|
|37360|New|Maj|2005-11-04|Install fails on Windows XP x64 when program files|
|37402|New|Nor|2005-11-08|mod_proxy has stopped allowing POST sub-requests  |
|37514|Inf|Nor|2005-11-15|mod_proxy buffers chunked data.                   |
|37564|New|Enh|2005-11-19|Suggestion: mod_suexec SuexecUserGroup directive i|
|37587|Inf|Min|2005-11-22|mod_status Total Traffic value goes up then down? |
|37770|Opn|Blk|2005-12-03|proxy: error reading status line from remote serve|
|37823|Inf|Nor|2005-12-07|The openssl library linked is different between ht|
|37920|New|Maj|2005-12-15|mod_proxy does not flush data on POST requests fro|
|38116|New|Enh|2006-01-04|Chroot-Patch for SuExec                           |
|38164|New|Nor|2006-01-06|wrong status code for failed COPY/MOVE            |
|38182|New|Nor|2006-01-08|COPY ignores authority in Destination header      |
|38218|New|Enh|2006-01-10|Multiline Comments for *.conf files               |
|38240|Inf|Nor|2006-01-12|apache restart segfault with mutliple Include dire|
|38325|Opn|Nor|2006-01-20|impossible to determine AUTH_TYPE of interpreted r|
|38355|Unc|Enh|2006-01-23|DSO support for mod_rewrite                       |
|38369|New|Enh|2006-01-24|mod_proxy keeps alive connections that should be b|
|38408|New|Nor|2006-01-27|SSI environment vars not set in spawned processes |
|38419|New|Nor|2006-01-27|Problems with large WebDAV properties             |
|38478|New|Maj|2006-02-01|A client starting a SSL renegotiation can crash th|
|38515|New|Enh|2006-02-05|Dynamic LDAP Group Support                        |
|38550|New|Enh|2006-02-07|Setting headers based on proxied data             |
|38571|New|Enh|2006-02-08|CustomLog directive checked by apachectl configtes|
|38756|Inf|Nor|2006-02-22|errors with running make                          |
|38786|New|Nor|2006-02-26|"IndexOption VersionSort" has problems with traili|
|38827|New|Reg|2006-03-02|mod_disk_cache trying to rename locked tempfile on|
|38864|Inf|Enh|2006-03-06|ProxyPassReverse fails in <Location>              |
|38903|New|Maj|2006-03-09|r->allowed does not affect Allow response header  |
|38923|New|Min|2006-03-10|mod_speling incorrectly escapes linked URLs       |
|38928|New|Min|2006-03-11|propose removing "VARIANTS" feature               |
|38995|New|Nor|2006-03-16|httpd tries to communicate with the CGI daemon eve|
|39111|New|Nor|2006-03-27|Potential bug brought by mmapfile (mod_file_cache)|
|39128|Inf|Maj|2006-03-28|Apache 2.2 will not compile mod_ssl library's corr|
|39185|Inf|Nor|2006-04-03|Approximately in 1-2 weeks of work the server hang|
|39216|New|Maj|2006-04-05|mod_disk_cache trying to rename locked file, decre|
|39238|New|Nor|2006-04-07|mod_auth_dbm requires mod_auth or "no groups file?|
|39275|Opn|Nor|2006-04-11|slow child_init causes MaxClients warning         |
|39287|New|Nor|2006-04-12|Incorrect If-Modified-Since validation (due to syn|
|39299|New|Nor|2006-04-13|Internal Server Error (500) on COPY               |
|39329|Inf|Nor|2006-04-17|mod_dbd reconnection and prepared statements      |
|39370|New|Nor|2006-04-20|SSL session will be removed if the client is sendi|
|39380|Inf|Nor|2006-04-21|mod_disk_cache eats memory, has no LFS support, et|
|39418|New|Nor|2006-04-26|CacheMaxExpire directive not enforced             |
|39448|New|Min|2006-04-29|old-style <directory proxy:*> doesn't give any war|
|39498|New|Nor|2006-05-06|accept_filter in apr assumes if found in sys/socke|
|39517|New|Nor|2006-05-08|Corrupt chunked transfer-encoding with Content Neg|
|39658|Opn|Nor|2006-05-25|mod_proxy_ajp SSL Key Size Bug                    |
|39673|New|Nor|2006-05-29|mod_proxy opens connections that disturb NTLM     |
|39692|New|Nor|2006-05-31|mod_proxy_balancer doesn't retry a failed request |
|39723|Inf|Enh|2006-06-05|Forward proxy does not work in tranparent mode    |
|39727|Ass|Nor|2006-06-05|Incorrect ETag on gzip:ed content                 |
|39730|New|Nor|2006-06-06|LanguagePriority and DefaultLanguage are Case Sens|
|39737|New|Nor|2006-06-06|LogFormat "%{tid}P" reports wrong thread id on Win|
|39748|New|Enh|2006-06-07|Header and POST support for mod_include           |
|39753|New|Nor|2006-06-07|incorrect source for LOCALE Decimal Symbol in Win2|
|39785|Inf|Nor|2006-06-12|Status code 408 (Request Timeout) is not logged   |
|39807|Opn|Enh|2006-06-13|large files / filesystem corruption can cause apac|
|39902|New|Nor|2006-06-27|HeaderName directive breaks mod_filter somehow    |
|39904|New|Nor|2006-06-27|graceful restart error and cpu load               |
|39913|Ass|Blk|2006-06-27|detection of static OpenSSL libraries requiring li|
|39916|New|Nor|2006-06-28|Core Filters & non-blocking Sendfile              |
|39923|New|Nor|2006-06-28|AddDescription doesn't work in server config with |
|39928|New|Nor|2006-06-28|port no detected when file name not in URL        |
|39935|New|Nor|2006-06-29|AddDescription does not do literal comparisons on |
|39973|Ass|Enh|2006-07-06|apache software folder should be movable          |
|40035|New|Cri|2006-07-13|Windows Server 2003 "("R2")" 64-Bit Edition no cgi|
|40060|New|Nor|2006-07-17|AuthGroupFile should accept /etc/group syntax     |
|40075|New|Enh|2006-07-19|unable to use ldap groups that contain DNs and use|
|40102|Opn|Nor|2006-07-24|SCRIPT_NAME set incorrectly with mod_rewrite      |
|40146|New|Nor|2006-07-31|mod_ssl info in server_info is blank              |
|40174|New|Min|2006-08-03|Unable to get IndexOptionis ScanHTMLTitles to work|
|40180|Inf|Maj|2006-08-03|Mod_dav and remove folder doesn't work with Micros|
|40190|New|Nor|2006-08-05|translate file                                    |
|40196|New|Nor|2006-08-06|EILSEQ handling, NoImplicitAdd should work, and so|
|40217|Opn|Nor|2006-08-08|mod_dav PROPFIND ignores access restrictions on it|
|40266|Inf|Blk|2006-08-16|berkeley db support in httpd is screwed           |
|40312|New|Nor|2006-08-24|ssl_engine_init.c, ssl_init_ctx_verify contains a |
|40373|New|Nor|2006-08-31|mod_dir adds trailing slash after internal redirec|
|40408|New|Blk|2006-09-04|Apache 2.2.3 is not starting                      |
|40416|New|Maj|2006-09-05|mod_proxy_ftp cannot connect under http load in fo|
|40441|New|Enh|2006-09-08|intelligently handling dynamic subdomains         |
|40453|New|Nor|2006-09-09|lexicographic compare in RewriteCond isn't lexicog|
|40463|New|Nor|2006-09-11|piped logging causes some weird kill()ing         |
|40513|Opn|Maj|2006-09-14|Seeding PRNG with 0 bytes of entropy              |
|40514|New|Nor|2006-09-14|would like GracefulShutdownTimeout to work for gra|
|40540|Inf|Nor|2006-09-19|Bad interaction between MultiViews and SetOutputFi|
|40541|New|Nor|2006-09-19|Action rewrites URI used by Location?             |
|40571|New|Nor|2006-09-21|mod_proxy_ajp don't works with mod_usertrack      |
|40586|New|Enh|2006-09-22|Add option to supress default '-' output          |
|40746|New|Enh|2006-10-12|Feature request: ProxyAllow directive             |
|40749|New|Min|2006-10-12|magic file with string and "%n" causes Apache chil|
|40781|New|Nor|2006-10-17|PATH_TRANSLATED: 'redirect:/~jablko/gallery2/main.|
|40808|New|Enh|2006-10-23|ProxyRemote with optional proxy authentication    |
|40859|New|Enh|2006-11-01|[PATCH] Support -F force option to 'ab' support to|
|40917|New|Nor|2006-11-07|configure does not detect OpenSSL shared lib on HP|
|40953|New|Min|2006-11-12|Should not send any data in 1xx/204/304 reply from|
|40984|Inf|Enh|2006-11-16|AddIcon, AddIconByType for OpenDocument format    |
|40987|Opn|Enh|2006-11-16|ProxyVia Block doesn't remove Via: header for reve|
|41000|New|Nor|2006-11-19|mod_authn_dbd have an error, in function 'authn_db|
|41025|New|Nor|2006-11-23|ROBOTS META-Tag directive needed in mod_autoindex |
|41088|New|Nor|2006-11-30|installation backcolor is wrong (white)           |
|41111|New|Enh|2006-12-05|New option for filters: run only if there are spar|
|41114|New|Blk|2006-12-06|ACL HTTP method is rejected by mod_proxy_ajp      |
|41130|New|Nor|2006-12-07|mod_mime and mod_negotiation type-map both clobber|
|41143|Opn|Nor|2006-12-10|Incorrect ap_getline assumption in mod_proxy_http |
|41195|New|Nor|2006-12-17|properly set the parent pid on shutdown           |
|41196|New|Nor|2006-12-17|worker mpm usage of apr's memory pools is not thre|
|41200|Inf|Maj|2006-12-18|SSI include, prevent client from receiving full ou|
|41240|Inf|Enh|2006-12-25|BRF files support                                 |
|41262|Inf|Nor|2006-12-29|Embedded pcre causes runtime segfault             |
|41362|Inf|Maj|2007-01-14|mod_disk_cache and mod_include conflict generating|
|41375|Inf|Min|2007-01-15|Using same SSL Certificate with different ServerNa|
|41391|New|Min|2007-01-17|too long period setting makes max-age overflow    |
|41412|New|Enh|2007-01-19|RewriteRule Skip should take negative arguments   |
|41435|New|Nor|2007-01-22|Authentication fails with 500 Server Error        |
|41450|Inf|Cri|2007-01-24|Empty page (200 OK) while max-age is empty        |
|41485|New|Nor|2007-01-28|LDAP client certificates not usable in 2.2.x/trunk|
|41529|New|Enh|2007-02-02|Accept BOM in .htaccess                           |
|41556|New|Enh|2007-02-07|Feature Request: format string for masking ip addr|
|41621|New|Maj|2007-02-15|Apache 2.2.4 backend problem with Apache 2.0.59 Re|
|41646|New|Nor|2007-02-16|wrong headers are sent for HEAD requests when Prox|
|41676|Opn|Enh|2007-02-22|Refactor mod_proxy_ftp                            |
|41685|New|Enh|2007-02-22|Implement optional HTTP Authentication in a standa|
|41712|Inf|Nor|2007-02-26|threads locked at logging state                   |
|41729|New|Maj|2007-02-28|error message: ap_get_scoreboard_lb(130) failed in|
|41744|Inf|Maj|2007-03-01|SSI resolves includes but removes original HTML   |
|41763|Opn|Nor|2007-03-05|mod_disk_cache ignores CacheDirLevels and CacheDir|
|41764|New|Nor|2007-03-05|error state and conf                              |
|41771|Inf|Nor|2007-03-06|Erro with mod_proxy_ajp or mod_prox_balancer      |
|41867|New|Nor|2007-03-16|<DirectoryMatch> Matches Files                    |
|41925|New|Nor|2007-03-21|trivial patch to add automatic crypting to 'dbmman|
|41929|New|Nor|2007-03-22|ISAPI ssl variables                               |
|41953|New|Nor|2007-03-26|pidfile remains when 2nd pass of post-config retur|
|41962|New|Min|2007-03-27|Need mod_auth_ldap to authenticate with Active Dir|
|42027|Inf|Nor|2007-04-02|FileETag directive appears to be ignored          |
|42054|New|Nor|2007-04-04|service name and parameter issues                 |
|42079|New|Nor|2007-04-10|SSLRequire: Additional access in sub-directoies   |
|42082|New|Nor|2007-04-10|filter_init is called multiple times after an INCL|
|42182|Inf|Nor|2007-04-22|Mime types for cached proxied content             |
|42216|New|Enh|2007-04-24|RFE -- external overload procedure                |
|42262|Inf|Nor|2007-04-26|mod_dav /  worker fails to allocate memory and seg|
|42287|Inf|Nor|2007-04-28|chunked encoded response to POST request to cgi sc|
|42368|Inf|Nor|2007-05-09|httpd is crashing if conf/extra/httpd-manual.conf |
|42373|Inf|Maj|2007-05-09|REPORT request fails over mod_proxy               |
|42404|New|Enh|2007-05-13|Filename/info for disk-cached proxied remote URLs |
|42425|Inf|Nor|2007-05-15|Additional freshness checks in mod_cache.c cause m|
|42471|Inf|Nor|2007-05-21|clients with IE7 take 3megs per page load. httpd.e|
|42492|Inf|Nor|2007-05-22|mod_proxy_ajp with SSL front end: data corruption |
|42499|Inf|Nor|2007-05-23|Backslash produces a 404 error instead of going to|
|42548|New|Nor|2007-05-30|INCLUDE negotiating language aborts with APR_POOL_|
|42561|New|Enh|2007-05-31|[PATCH] AuthLDAPRemoteUserAttribute only applies i|
|42633|New|Min|2007-06-11|mod_info gives wrong information about actual conf|
|42665|New|Nor|2007-06-14|spurious attempt to open ".../file.html/.htaccess"|
|42666|New|Nor|2007-06-14|code & docs corrections for FollowSymLinks and Sym|
|42667|New|Nor|2007-06-14|mod_proxy_balancer not reporting when workers are |
|42668|Inf|Nor|2007-06-14|balancer_manager shows Ok status for the workers t|
|42687|New|Nor|2007-06-18|Fully delegate certificate & key semantics to the |
|42688|New|Enh|2007-06-18|engine managed keys: per process openssl context  |
|42690|New|Nor|2007-06-18|realm is not set for each configured directory whe|
|42695|Inf|Cri|2007-06-18|mod_proxy balancer problem                        |
|42699|New|Enh|2007-06-20|share mod_logio data with other modules           |
|42711|New|Enh|2007-06-20|format string for whole log entries not just id   |
|42732|Opn|Maj|2007-06-25|Authentication against database issue.            |
|42763|New|Nor|2007-06-28|graceful-stop/restart loops go loop too far       |
|42923|Inf|Maj|2007-07-17|vhost certificate NOT overriding cert from the _de|
|42972|Inf|Nor|2007-07-25|Certificate list in mod_ssl module context are not|
|42977|New|Nor|2007-07-25|DAV locking is busted when apr-util is built with |
|42987|New|Nor|2007-07-27|Weak Etags in Apache are useless and violate RFC 2|
|43012|New|Nor|2007-08-02|AIX instdso.sh libphp5.so                         |
|43027|New|Enh|2007-08-03|Header in default language                        |
|43033|New|Nor|2007-08-04|apxs does not correctly detect module name (w/o -n|
|43177|New|Nor|2007-08-21|child pid xxxxx exit signal Segmentation fault    |
|43218|New|Nor|2007-08-27|Wrong cert used for vhost if ServerName is same   |
|43220|Opn|Cri|2007-08-27|mod_proxy truncating ajp output                   |
|43249|Inf|Maj|2007-08-30|ldap_simple_bind_s failed when using SUN LDAP Libs|
|43275|New|Enh|2007-08-31|Remove avoidable network transactions in mod_proxy|
|43289|New|Nor|2007-09-02|XBitHack full g+x returns zero sized response on I|
|43308|New|Nor|2007-09-04|Persistent backend connections not supported for R|
|43352|New|Nor|2007-09-11|Apache2: out of memory during heavy webdav files c|
|43441|New|Nor|2007-09-20|Incorrect HTTP status for pre-commit-blocked autov|
|43471|New|Min|2007-09-25|no need to create a global pool on open_scoreboard|
|43481|New|Cri|2007-09-26|AuthLDAPURL must contain a final path of branch?(l|
|43494|New|Nor|2007-09-26|mod_cgid does not kill never ending scripts       |
|43502|New|Enh|2007-09-28|httpd fails to start if log directory does not exi|
|43513|New|Nor|2007-09-29|Persistent backend connections for ProxyPassMatch |
|43532|Inf|Cri|2007-10-02|Error while compiling Apache 2.2.3 on HPUX        |
|43533|Opn|Nor|2007-10-02|Frequent crashes in mod_include's bndm()          |
|43561|New|Nor|2007-10-05|apxs -q anomaly                                   |
|43577|Inf|Blk|2007-10-09|mod_authnz_ldap not working under WLDAP32 (novell/|
|43607|New|Nor|2007-10-11|mod_proxy sends data on closed connections without|
|43649|Opn|Trv|2007-10-18|mod_autoindex is generating invalid XHTML markup  |
|43652|New|Enh|2007-10-18|Suggest small change for big fix with SuExec & Vir|
|43666|New|Nor|2007-10-20|CGI works, but client denied error messages in err|
|43679|New|Enh|2007-10-23|Contributed tests for checking that subrequests ta|
|43723|Inf|Cri|2007-10-29|Apache 2.2.6 segfault when using mod_dbd          |
|43724|New|Cri|2007-10-29|Apache 2.2.6 segfault on url wich not in cache    |
|43755|New|Enh|2007-10-31|Add a SSLOptions to don't fill SSL_CLIENT_VERIFY  |
|43762|New|Enh|2007-10-31|Misleading tips in an error message about internal|
|43777|New|Nor|2007-11-01|Wrong encoding of <href> element in response      |
|43778|New|Nor|2007-11-01|Wrong responses if httpd has not access to some el|
|43785|New|Enh|2007-11-02|Tracking the per-hit impact of mod_include        |
|43792|New|Enh|2007-11-04|Feature proposal - bind phase                     |
|43818|New|Nor|2007-11-08|PROPFIND on -w- collections returns 207 MULTI-STAT|
|43838|New|Enh|2007-11-11|If-Modified-Since request and htcacheclean conflic|
|43895|New|Nor|2007-11-18|mod_mbox improvements                             |
|43897|Inf|Cri|2007-11-18|Huge memory consumption httpd 2.2.6, mod_proxy - m|
|43931|New|Enh|2007-11-21|OpenSSL autoconfig support for mod_ssl            |
|43943|New|Nor|2007-11-22|SHMCB crash due to misalignment and GCC 4 optimiza|
|43958|Inf|Maj|2007-11-26|mod_proxy_balancer not balancing correct in combin|
|43997|Opn|Min|2007-11-29|Only issue "Init: SSL server IP/Port conflict" if |
|44025|Inf|Nor|2007-12-05|Apache 2.2.6 fails to configure on OpenBSD 4.1    |
|44027|Ass|Enh|2007-12-05|Internationalized Domain Name (IDN) support       |
|44031|Opn|Maj|2007-12-06|RemoveHandler inside subdir location              |
|44034|Ass|Enh|2007-12-06|mpm_winnt doesn't call monitor hook               |
|44105|New|Nor|2007-12-19|Core dumps when using Proxy Keepalive             |
|44155|New|Enh|2007-12-31|smarter retry for LDAP_UNAVAILABLE, LDAP_BUSY, etc|
|44181|Opn|Enh|2008-01-07|add UnAlias                                       |
|44188|Inf|Cri|2008-01-08|Empty response for certain requests (mod_proxy as |
|44218|New|Min|2008-01-13|mod_autoindex shows the default icon for files wit|
|44221|Opn|Cri|2008-01-14|CheckCaseOnly On does not stop Multiple Choices ba|
|44250|New|Nor|2008-01-16|OSX 10.5: __THE_PROCESS_HAS_FORKED_AND_YOU_CANNOT_|
|44279|New|Enh|2008-01-22|Add "iterate" flag to apply rule in a loop while p|
|44302|New|Nor|2008-01-27|AuthLDAPURL does not accept ldapi:// urls         |
|44305|New|Nor|2008-01-28|Inconsistent configuration for suexec path        |
|44316|New|Nor|2008-01-28|httpd 2.0 does not follow ScriptAliases when invok|
|44322|New|Enh|2008-01-29|mod_proxy ProxyPassReverseCookieDomain with no dom|
|44351|New|Nor|2008-02-04|File descriptor leak when using prg RewriteMap    |
|44363|Inf|Maj|2008-02-05|Slow file transfers                               |
|44384|Ass|Nor|2008-02-09|mod_ssl on MacOS X 10.5.1 does not work because of|
|44453|New|Nor|2008-02-19|list_hooks.pl doesn't parse declarations that span|
|44476|New|Maj|2008-02-23|Apache service fails to start due to missing depen|
|44503|Inf|Blk|2008-02-27|Errors during SSL handshake                       |
|44518|New|Enh|2008-03-02|Don't set expires header on HTTP redirect.        |
|44578|New|Enh|2008-03-11|mod_authn_dbd option to let database validate pass|
|44601|New|Trv|2008-03-13|Add a lowercase value to Vary header for consisten|
|44602|New|Enh|2008-03-13|Options for modfying Content-Location (relative OR|
|44622|Inf|Nor|2008-03-17|POST fails to SSL vhost with proxy to HTTP backend|
|44631|New|Nor|2008-03-18|with-included-apr fails to work when using a separ|
|44638|New|Nor|2008-03-19|sed error in httpd.spec.in                        |
|44656|New|Nor|2008-03-22|Tries to retrive error document 404 instead of 406|
|44657|New|Enh|2008-03-22|prefer-type, -encoding, and -charset cookie? (as p|
|44670|New|Min|2008-03-25|Apache httpd 2.2.8 : Cannot ./configure when curre|
|44696|Inf|Nor|2008-03-27|mod_cache sometimes serves old content despite hav|
|44730|New|Nor|2008-04-01|duplicate query string in remote server url when u|
|44752|New|Nor|2008-04-03|Suexec does not correctly check that scripts are i|
|44757|New|Enh|2008-04-04|adding stderr buckets to mod_cgi                  |
|44758|New|Enh|2008-04-04|LimitRequestBody undocumented behaviour with proxi|
|44779|New|Enh|2008-04-08|Using commas and semicolons for content negotiatio|
|44855|New|Nor|2008-04-22|irregular balancing with sticky-session after re-e|
|44865|Ass|Nor|2008-04-23|mod_dav's lock database becomes consistently corru|
|44870|Inf|Nor|2008-04-24|process spinning on 100% cpu                      |
|44923|Inf|Min|2008-05-02|consequences of multiple LDAPTrustedGlobalCert    |
|44924|New|Enh|2008-05-02|allow 'CACERTDIR' in mod_ldap                     |
|44940|New|Maj|2008-05-06|Httpd randomly breaks when verifying client certif|
|44981|New|Enh|2008-05-12|Digital Certificates (CN Based) for Authorization |
|45022|New|Nor|2008-05-16|Processing of escaped glob patterns in "Include" d|
|45023|Opn|Reg|2008-05-16|DEFLATE preventing 304 NOT MODIFIED response      |
|45049|Opn|Nor|2008-05-20|mod_mem_cache caches partial content when client c|
|45054|New|Nor|2008-05-21|SSLVerifyClient optional_no_ca is broken          |
|45058|New|Nor|2008-05-21|Mod_SSL does not set AUTH_TYPE with client certifi|
|45078|New|Nor|2008-05-27|mod_proxy stalls when uploading files             |
|45103|Ass|Min|2008-05-30|apachectl should do config test before reload/rest|
|45111|New|Enh|2008-06-01|make mod_usertrack use mod_unique_id if available |
|45116|New|Nor|2008-06-02|fail to check return value of apr_file_dup2() in /|
|45148|New|Enh|2008-06-06|The actual host of the request will be more helpfu|
|45184|New|Enh|2008-06-11|Regular Expression in directive ServerAlias       |
|45187|New|Maj|2008-06-11|Long File name requests gives FORBIDDEN response  |
|45225|New|Nor|2008-06-17|XBitHack breaks DirectoryIndex + MultiViews conten|
|45253|New|Nor|2008-06-23|Unable to build httpd 2.2.9 on Solaris/SPARC      |
|45257|New|Enh|2008-06-23|add (en)force option for UseCanonicalName         |
|45259|New|Enh|2008-06-23|Add /home/[a-z]/* scheme to UserDir conf          |
|45275|New|Maj|2008-06-25|Locked files during expired page renew in disk cac|
|45281|New|Enh|2008-06-25|SITE CHMOD/SEARCH                                 |
|45287|Inf|Min|2008-06-26|build failure because of difference between BSD an|
|45297|New|Min|2008-06-27|mod_dir does not manage correctly the user (r->use|
|45302|New|Enh|2008-06-28|ServerRoot directive                              |
|45355|New|Nor|2008-07-07|ab text and html output jumbo unification         |
|45356|New|Nor|2008-07-07|ab: optionally reduce resource usage (qsort and me|
|45371|New|Nor|2008-07-10|MSI installer requires uninstall of previous versi|
|45374|New|Blk|2008-07-10|Shared memory error on starting httpd with mod_lda|
|45379|Inf|Nor|2008-07-11|[Bug] svn merge, apache and trailing slashes      |
|45385|Inf|Nor|2008-07-11|unable to compile/make 2.2.9 with --enable-ldap   |
|45393|New|Nor|2008-07-14|Apache returns 500 Error when no LDAP credentials |
|45402|New|Nor|2008-07-15|mod_autoindex incorrectly fails to list files     |
|45405|New|Enh|2008-07-16|Allow binding port to be set for individual worker|
|45449|New|Nor|2008-07-21|[PATCH] Add support to WebDav to MOVE/COPY to remo|
|45456|New|Enh|2008-07-22|mod_dbd don't allow more then one database pool   |
|45487|New|Trv|2008-07-27|broken log messages on startup in win32 version   |
|45497|New|Nor|2008-07-29|Scoreboard slot leaked using MaxRequestsPerChild a|
|45512|Ass|Maj|2008-07-31|Bad Performance of mod_proxy with SSL on Solaris 1|
|45524|New|Enh|2008-08-01|Specifying multiple vhost aliases                 |
|45525|New|Enh|2008-08-01|Switch mod_autoindex to Tango icons               |
|45579|New|Nor|2008-08-06|unknown URI scheme in request-URI ignored         |
|45674|New|Enh|2008-08-22|Allow to change error code returned by "Require ld|
|45726|New|Enh|2008-09-02|Build in a maintenance functionallity             |
|45736|New|Nor|2008-09-03|mod_dav needs a directory for its locks and one sh|
|45754|New|Enh|2008-09-06|autoconf macros                                   |
|45763|New|Nor|2008-09-08|No openssl.cnf defined by default causes OpenSSL c|
|45773|New|Nor|2008-09-09|pcre build generates sources to srcdir rather than|
|45788|New|Nor|2008-09-11|mod_log_forensic output shouldn't be buffered when|
|45801|Opn|Nor|2008-09-13|SSLRequireSSL with strictrequire and satisfy any d|
|45838|New|Nor|2008-09-18|mod_authz_owner & directories                     |
|45868|New|Nor|2008-09-23|mod_mem_cache update of headers in cache object is|
|45900|New|Nor|2008-09-26|"make install" fails from read-only filesystem    |
|45905|New|Enh|2008-09-26|ErrorDocument and default URL                     |
|45922|New|Enh|2008-09-30|Expand the conditions under which "SSLVerifyClient|
|45923|New|Nor|2008-09-30|htpasswd tries to open(file, O_RDONLY | O_APPEND) |
|45926|Inf|Nor|2008-10-01|Unable to start apache 2.2.9                      |
|45986|New|Nor|2008-10-10|[info]...Invalid argument: core_output_filter: wri|
|46024|Opn|Nor|2008-10-16|--enable-static is not available in apache's confi|
|46037|Inf|Nor|2008-10-18|Configuration of trusted OCSP responder certificat|
|46040|New|Enh|2008-10-20|Check for existing version of Apache while install|
|46054|New|Nor|2008-10-21|Running httpd returns the error "bad user name nob|
|46070|New|Nor|2008-10-22|MSI installer does not validate custom installatio|
|46071|New|Enh|2008-10-22|Allowing space in between comma and last option in|
|46074|New|Enh|2008-10-23|Need of friendly and easy to use configuration gra|
|46139|New|Nor|2008-11-02|Apache Restart option is not working              |
|46140|New|Enh|2008-11-03|Change error state in balancer manager            |
|46188|Inf|Nor|2008-11-11|Core dumps in apache 2.0.59                       |
|46195|Opn|Nor|2008-11-12|ProxyPass fails with literal IPv6 address         |
|46215|New|Nor|2008-11-14|Race condition in bybusyness algorithm            |
|46231|New|Maj|2008-11-18|Connection Pooling with ajp depends on syntax ?   |
|46241|New|Enh|2008-11-19|mod_expires - ExpiresByPattern or ExpiresIf       |
|46267|New|Nor|2008-11-22|No shared modules build if use --with-apr and --wi|
|46270|New|Enh|2008-11-23|Add FIPS 140-2 mode for mod_ssl for FIPS 1.2 modul|
|46282|New|Nor|2008-11-24|apache2.2 reverse proxy causing full memory and sw|
|46316|New|Maj|2008-12-01|Proxied SSI ProxyTimeout render failure           |
|46317|Inf|Nor|2008-12-01|mod_authnz_ldap.c(373)  seg fault                 |
|46412|New|Nor|2008-12-17|make_child return value not checked               |
|46417|New|Cri|2008-12-19|[notice] Parent: child process exited with status |
|46428|Opn|Nor|2008-12-21|Spaces in URI doesn't encode in proxy-requests    |
|46442|New|Nor|2008-12-29|Semicolon in allow/deny all rules cause reverse lo|
|46449|New|Maj|2008-12-30|Output out of order from SSI include virtual      |
|46454|New|Min|2008-12-30|escaping wildcards in AddIcon filename matching   |
|46475|New|Nor|2009-01-04|build warnings.                                   |
|46499|New|Maj|2009-01-09|httpd accept() return EAGAIN error                |
|46521|New|Nor|2009-01-13|mod_dav doesn't show symlinks                     |
|46529|Ass|Nor|2009-01-14|Child httpd processes crash with Segmentation faul|
|46534|New|Nor|2009-01-14|mod_proxy_ajp scheme and port do not follow UseCan|
|46578|New|Nor|2009-01-21|Flawed header                                     |
|46582|Ver|Min|2009-01-22|RewriteMap internal functions are not well documen|
|46604|New|Nor|2009-01-26|Error thrown when trying to rpmbuild -tb httpd sou|
|46629|New|Maj|2009-01-29|Apache hanging on system calls for php and perl   |
|46634|Ass|Nor|2009-01-30|Requests sometimes take too long, wrong time taken|
|46644|New|Enh|2009-01-31|Clean way to pass custom environment variables to |
|46646|Ass|Nor|2009-02-01|check group membership is sometimes case sensitive|
|46650|Opn|Nor|2009-02-02|CustomLog enviroment condition SCRIPT_FILENAME    |
|46656|New|Enh|2009-02-03|ProxyErrorOverride inside location                |
|46669|New|Enh|2009-02-06|rotatelogs doesn't autocreate directories         |
|46671|Opn|Cri|2009-02-07|Apache periodicaly crashes .                      |
|46678|New|Nor|2009-02-09|Fixed Content-Length using mod_ext_filter with mod|
|46682|New|Nor|2009-02-09|mod_proxy EAI_AGAIN DNS failure                   |
|46685|Opn|Nor|2009-02-09|401 sent without WWW-Authenticate header when requ|
|46709|Opn|Reg|2009-02-12|Expect: 100-continue to an HTTP/1.0 server change |
|46724|Inf|Cri|2009-02-17|WinXP SP3 - Apache crashes on startup in libapr-1.|
|46743|New|Nor|2009-02-19|Inconsistent behavior of "RewriteOptions inherit" |
|46745|New|Maj|2009-02-20|ab.c error :  undefined reference to `BIO_set_call|
|46751|New|Nor|2009-02-21|Can passenv variables who's name contain '(' or ')|
|46762|New|Nor|2009-02-24|Error, SSL/TLS libraries were missing or unusable |
|46765|Opn|Nor|2009-02-25|doubled HTTP header leads to error (Redmine)      |
|46785|Inf|Nor|2009-03-02|Child process increases to 100% (CPU)             |
|46788|New|Nor|2009-03-02|Set resource limits to avoid denial of service att|
|46810|New|Nor|2009-03-05|apxs / apu-1-config outputting erroneous include p|
|46824|New|Nor|2009-03-09|RemoveOutputFilter will not work for Filters added|
|46845|Inf|Cri|2009-03-12|Apache crashes in Windows when using subversion(pr|
|46847|New|Nor|2009-03-13|WebDAV methods with encoding other than "identity"|
|46873|New|Nor|2009-03-18|feature request: connection count on balancer-mana|
|46884|New|Min|2009-03-20|Call to apu_dso_load Fails In apr_ldap_stub.c On O|
|46946|Inf|Nor|2009-03-31|mod_mbox shows email addresses in plain text      |
|46963|New|Nor|2009-04-03|KeepAliveTimout prevents child process from exitin|
|46969|New|Nor|2009-04-05|CustomLog format %m always GET on errors with loca|
|46970|New|Nor|2009-04-05|CustomLog %X does not record aborted connections w|
|47011|New|Reg|2009-04-09|mod_proxy/mod_proxy_balancer hot-standby BalancerM|
|47055|New|Blk|2009-04-20|SSLVerifyClient + Directory doesn't use cache sess|
|47063|New|Nor|2009-04-21|mod_proxy doesn't call post_request handler when t|
|47134|New|Nor|2009-05-01|Last resolve handling when sending client certific|
|47138|New|Nor|2009-05-01|Reverse Proxy & Balancer generate error fault when|
|47152|New|Maj|2009-05-04|Apache is only serving the first character in the |
|47159|New|Nor|2009-05-06|2.2.x logresolve doesn't support ipv6             |
|47167|New|Nor|2009-05-07|Authenticated sessions being switched by reverse p|
|47170|New|Enh|2009-05-08|rotatelogs ring buffer option                     |
|47180|New|Nor|2009-05-11|DBM ssl_scache setting can cause extreme performan|
|47220|Opn|Enh|2009-05-19|Access to environment variables                   |
|47256|New|Enh|2009-05-23|Enable SSL on a per-port basis                    |
|47289|New|Nor|2009-05-30|Can't build with dynamic libraries on Mac OS 10.4 |
|47295|New|Nor|2009-06-01|AuthDBDUserPWQueryFmt/AuthDBDUserRealmQueryFmt in |
|47329|New|Nor|2009-06-07|SSLCADNRequest* & SSLCACertificate* silently do no|
|47340|New|Nor|2009-06-09|uldap_cache_comparedn() called without a lock     |
|47344|New|Enh|2009-06-10|[FEATURE REQUEST] RedirectCanonicalName           |
|47345|New|Enh|2009-06-10|rotatelogs timeout patch                          |
|47346|New|Maj|2009-06-10|mod_cache doesn't re-cache expired content when La|
|47387|Inf|Nor|2009-06-18|SSL_CLIENT_I_DN and SSL_CLIENT_S_DN use Email inst|
|47392|Opn|Nor|2009-06-18|<FilesMatch> is using the wrong directory         |
|47435|New|Nor|2009-06-26|mod_authz_host does reading of /etc/hosts on each |
|47438|Inf|Enh|2009-06-27|how to create a non-html "listing generated by the|
|47447|New|Enh|2009-06-29|Add possibility to use client IP as a value in Req|
|47484|New|Nor|2009-07-06|Spurious RewriteLock warning when using external m|
|47485|New|Enh|2009-07-06|HTML5 Websocket implementation                    |
|47514|New|Enh|2009-07-12|Personal data and restrictions based on subject di|
|47528|New|Maj|2009-07-14|Worker process won't restart more than once using |
|47542|New|Nor|2009-07-16|Piped logging processes killed before other proces|
|47562|Inf|Nor|2009-07-23|Apache/2.2.3 (Win32) mod_perl/2.0.3-rc1           |
|47578|New|Nor|2009-07-24|compile ERROR with ssl                            |
|47580|Opn|Nor|2009-07-25|mod_cache sends 200 response instead of 304       |
|47586|New|Nor|2009-07-27|httpd -k start doesn't start service when rotatelo|
|47591|New|Min|2009-07-27|show current HTTP_HOST in mod_status scoreboard   |
|47601|New|Enh|2009-07-29|Support X-Forwarded-For in forward proxy requests |
|47625|New|Nor|2009-08-02|2.2.12 win32 msi installer missing                |
|47634|New|Maj|2009-08-04|mod_ldap connection pool session keepalive not imp|
|47643|New|Enh|2009-08-04|added meta tags to xhtml output for ease of search|
|47650|Opn|Trv|2009-08-05|httxt2dbm calculates value size incorrectly       |
|47657|New|Nor|2009-08-06|Make WebDAV MOVE atomic when replacing files on sa|
|47659|New|Nor|2009-08-07|makefile.win needs check for DBM_LIST, dies on bui|
|47664|New|Nor|2009-08-07|ap_proxy_canonenc: does not recode all high-byte c|
|47665|Inf|Blk|2009-08-09|Apache service well launched but blank Screen     |
|47691|New|Enh|2009-08-12|libtool invocations should use --tag              |
|47693|Opn|Nor|2009-08-13|GET request has race condition w.r.t. replacement |
|47706|Inf|Nor|2009-08-19|(20014)Internal error: proxy: error reading status|
|47716|New|Min|2009-08-20|LimitRequestFieldSize and friends not merged well |
|47719|Opn|Enh|2009-08-20|Broken symbolic link (symlink) causes wrong ErrorD|
|47723|New|Nor|2009-08-22|suEXEC and low RLimitMem gives "crit: invalid uid"|
|47743|Inf|Nor|2009-08-26|mod_so segfaults at server startup in ap_find_load|
|47753|New|Nor|2009-08-27|output and error channels not explicitly passed fo|
|47778|Opn|Enh|2009-09-03|wrong exit value on graceful restart              |
|47780|New|Nor|2009-09-03|Critical errors should be marked by time and level|
|47807|Inf|Nor|2009-09-09|Proxy dialog error with Apache 2.2.13             |
|47808|New|Maj|2009-09-09|Child process core dumps when enabling CRL        |
|47814|Inf|Maj|2009-09-10|openssl_pkcs7_sign error                          |
|47838|New|Enh|2009-09-14|Ability to Dynamically Inject Current Time Into a |
|47874|New|Nor|2009-09-18|mod_fcgid crashes if added during restart         |
|47895|New|Maj|2009-09-24|Incorrect 413 error handling                      |
|47908|New|Min|2009-09-27|'invalid result code' in error_log                |
|47981|New|Nor|2009-10-12|allow language specific html-versions (index.html.|
|47982|New|Nor|2009-10-12|correctly interprete non-standard HTTP_ACCEPT_LANG|
|47988|New|Nor|2009-10-12|Segmentation fault                                |
|47989|New|Nor|2009-10-13|Junk string appended to compressed dynamic content|
|47994|New|Enh|2009-10-14|ScriptInterpreterSource apparently broken in Windo|
|48020|New|Nor|2009-10-17|KCP+ Opera support for mod_auth_digest            |
|48037|Inf|Nor|2009-10-21|mod_proxy_http does not handle asynchronous keepal|
|48045|New|Nor|2009-10-23|Apache 2 initgroups alert, Max OS X, abnormal exit|
|48057|New|Nor|2009-10-26|mod_fcgid creates 1 more process then allowed     |
|48094|New|Nor|2009-11-01|Avoid a race condition in close_worker_sockets()  |
|48107|New|Maj|2009-11-02|Mutual Authentication: Order in ca-bundle influenc|
|48115|New|Enh|2009-11-03|Duration to receive the request, generate response|
|48130|New|Maj|2009-11-04|DAV operations on large filesets consume all the O|
|48154|New|Nor|2009-11-06|Requests through mod_isapi are not parsed by HTTP_|
|48164|New|Enh|2009-11-09|add new parameters to rotatelogs                  |
|48219|New|Nor|2009-11-17|Retrying the worker for seems to omit POST variabl|
|48228|New|Nor|2009-11-18|Renegocation requires multiple client authenticati|
|48246|New|Enh|2009-11-19|Check permissions on file/directory specified for |
|48254|New|Trv|2009-11-20|Bogus "DocumentRoot does not exist" warning when s|
|48283|New|Nor|2009-11-25|Proxy errors since httpd 2.2.12 with Tomcat 6.0.20|
|48291|New|Maj|2009-11-26|mod_substitute loops                              |
|48295|Opn|Nor|2009-11-27|ProxyPassReverseCookiePath: Not changing path corr|
|48301|New|Enh|2009-11-30|Feature request: improved connection status report|
|48309|New|Maj|2009-11-30|libapreq2-2.12: "make test" fails at request.t and|
|48312|Opn|Nor|2009-11-30|ProxyPassReverseCookiePath: Not changing path corr|
|48316|Inf|Nor|2009-12-01|ap_run_insert_filter doesn't work in cache_url_han|
|48354|New|Enh|2009-12-08|void ap_custom_response is not supporting the bina|
|48360|New|Enh|2009-12-09|provide sample configuration file for inclusion in|
|48361|New|Enh|2009-12-09|Add global server option for specifying desired DS|
|48364|Opn|Nor|2009-12-10|PHP-generated pages are not cached in spite of per|
|48369|New|Enh|2009-12-10|add option to automatically restart if a script is|
|48431|New|Nor|2009-12-22|Error logging doesn't work when configured to use |
|48440|Inf|Cri|2009-12-23|Segmentation Fault                                |
|48449|Inf|Nor|2009-12-28|make distclean removes core.c and core_filters.c  |
|48465|Opn|Enh|2009-12-30|Support TCP to connect to backends                |
|48499|New|Nor|2010-01-06|mod_rewrite can't redirect to files with ? in them|
|48500|New|Nor|2010-01-06|mod_mbox mishandles right-click to open msg in new|
|48508|New|Nor|2010-01-07|BalancerMember doesn't accept nocanon directive   |
|48549|New|Enh|2010-01-14|Add Cache-Control s-maxage support                |
|48576|New|Nor|2010-01-19|MOVE or COPY in WebDAV fails with 404 when file ex|
|48585|New|Enh|2010-01-20|mod_cache no longer caches expired content        |
|48602|New|Enh|2010-01-23|use asynch ldap_compare so LDAPTimeout applies    |
|48623|New|Maj|2010-01-26|AuthLDAPURL syntax is not RFC-compliant, prevents |
|48639|New|Enh|2010-01-29|Add htcacheclean as a core monitored process      |
|48652|New|Maj|2010-02-01|"AuthType form" fails if a password contains  '&' |
|48659|New|Maj|2010-02-02|Problem with accents in filename and byte serving |
|48687|New|Nor|2010-02-05|mod_rewrite ignores trailing dot in request URI on|
|48705|New|Enh|2010-02-08|flag to allow newlines in the error log as opposed|
|48712|New|Enh|2010-02-09|Add UID and GID to status page                    |
|48719|New|Nor|2010-02-09|[BUG] mod_proxy_ajp return wrong error message whe|
|48721|New|Nor|2010-02-10|[Patch] Add ProxyAllow to mod_proxy               |
|48731|New|Maj|2010-02-11|Prefork not creating processes after 10 servers ar|
|48732|New|Nor|2010-02-12|[BUG] environment variable SCRIPT_NAME output erro|
|48769|New|Nor|2010-02-18|[PATCH] Processes in the busy list should not be k|
|48777|New|Maj|2010-02-19|proxy balancer not detecting correctly when host (|
|48780|New|Enh|2010-02-19|Enable mod_authnz_ldap to accept valid client cert|
|48792|New|Enh|2010-02-22|httpd util apachectl returns wrong status informat|
|48805|New|Nor|2010-02-23|Corrupted response for HTTPS + KEEPALIVE=ON       |
|48808|New|Enh|2010-02-24|mod_authz_owner support for POSIX access control l|
|48819|Inf|Nor|2010-02-25|After users login on the web page, the page does n|
|48842|Inf|Nor|2010-03-02|mod_log_config logs the full size of the file inst|
|48880|Opn|Nor|2010-03-09|error on make                                     |
|48888|New|Nor|2010-03-10|DOCTYPE definitions nearly 11 years out-of-date   |
|48920|New|Enh|2010-03-15|Breadcrumbs on mod_autoindex path                 |
|48921|Inf|Nor|2010-03-16|mod_mem_cache crash, version 2.2.15.0             |
|48937|New|Enh|2010-03-18|Feature proposal - support sasl_bind              |
|48949|Inf|Cri|2010-03-20|fcgid processes never get killed after graceful re|
|48958|New|Nor|2010-03-22|mod_ldap, ldap credential cache & graceful restart|
|48987|New|Trv|2010-03-25|typo in polish translation of HTTP_UNAUTHORIZED.ht|
|49037|New|Enh|2010-04-02|SSLVerifyClient require_no_ca                     |
|49043|New|Maj|2010-04-04|Using ssi include directive overwrites QUERY_STRIN|
|49058|New|Nor|2010-04-06|Prefork MPM tries to accept on closed listener soc|
|49067|New|Nor|2010-04-08|FTPOptions ShowUnAuthorizedFiles does not work    |
|49068|New|Nor|2010-04-08|UTF-8 URL Encode error                            |
|49087|New|Maj|2010-04-11|MSI installation reports "interrupted installation|
|49114|New|Maj|2010-04-13|NTFS junction directories missing from directory l|
|49123|New|Nor|2010-04-14|mod_proxy_ajp does not send the client's SSL chain|
|49131|New|Nor|2010-04-15|Very long URLs cause 404 or 403 errors with SetAct|
|49133|New|Maj|2010-04-16|Windows service recovery options do not work for A|
|49157|New|Nor|2010-04-20|Issues with xml interface for balancer manager    |
|49187|New|Nor|2010-04-26|Crash mod_mem_cache and mod_svn                   |
|49199|New|Enh|2010-04-27|Implement LDAP scope-aware caching in mod_ldap    |
|49220|New|Nor|2010-04-29|feature request for being able to disable FcgidWra|
|49239|New|Blk|2010-05-01|Apache mod_ssl gives coredump with openssl 0.9.8  |
|49277|New|Nor|2010-05-12|Expose a variable to identify SSL Session renegoti|
|49283|New|Nor|2010-05-12|Language of dates on SSI                          |
|49285|New|Enh|2010-05-13|Relative (local to current directory) URLs do not |
|49348|New|Enh|2010-05-27|[mod_log_config] Output log file name format capab|
|49385|New|Maj|2010-06-03|mod_disk_cache server side included files are inte|
|49387|Inf|Cri|2010-06-03|Unable to modify default charset setting to UTF-8 |
|49391|New|Nor|2010-06-05|mod_disk_cache needs to register a cleanup to kill|
|49396|New|Enh|2010-06-06|PATH_INFO normalization, especially relating to vo|
|49427|New|Nor|2010-06-11|mod_cgid and mod_cgi do not return proper value wh|
|49433|New|Enh|2010-06-13|improving info in server status                   |
|49439|New|Nor|2010-06-14|Bug in mod_userdir which prevents suexec from runn|
|49504|New|Nor|2010-06-25|Solaris 10/x64 worker graceful restart problem    |
|49532|New|Nor|2010-06-30|mod_cache: Set-Cookie headers are appended to cach|
|49553|New|Min|2010-07-05|Set QoS bits via APR2 API instead                 |
|49568|New|Maj|2010-07-07|Apache mod_authnz_ldap built with the MS LDAPSDK d|
|49632|Inf|Nor|2010-07-21|mod_authnz_ldap denies users when search is perfor|
|49633|New|Enh|2010-07-21|Handle AD primary groups in mod_authnz_ldap       |
|49642|New|Nor|2010-07-23|mod_rewrite mistakes encoded question mark as path|
|49643|New|Nor|2010-07-23|WebDav plus mod Negotiation causes directory creat|
|49676|New|Nor|2010-07-30|directory with german umlauts are indented by one |
|49680|New|Maj|2010-07-30|Perl script are not running on Win32, Apache 2.2.1|
|49684|New|Enh|2010-08-01|enhancement for ipv6 implementation               |
|49699|New|Nor|2010-08-03|Inconsistent Keep-alive from proxy to the origin s|
|49715|New|Maj|2010-08-06|ProxyPassMatch Url Encoder Problem                |
|49717|New|Enh|2010-08-06|PATCH: Enable SSL Timeout                         |
|49737|Inf|Nor|2010-08-10|order allow,deny does not work on IPv6            |
|49743|New|Maj|2010-08-12|SSI 'echo encoding="(url/none)"' bug              |
|49746|Opn|Enh|2010-08-12|mod_rewrite urlencode option                      |
|49766|New|Maj|2010-08-17|POST request on CGI script generating empty body c|
|49771|New|Nor|2010-08-17|After graceful restart using mod_proxy_ajp, couldn|
|49772|New|Nor|2010-08-18|mod_deflate kicks itself out on Content-Range resp|
|49798|Opn|Nor|2010-08-22|[mod_log_config] Piped Log scripts process cause w|
|49807|New|Enh|2010-08-23|hard to force Content-Type header for non static f|
|49810|New|Nor|2010-08-23|Mod_autoindex output of header/body/footer scrambl|
|49815|New|Enh|2010-08-24|Enable caching for HTTP Range requests / 206 respo|
|49829|New|Trv|2010-08-26|CGI index command line arguments excessively escap|
|49832|New|Enh|2010-08-26|void ap_custom_response is not supporting the bina|
|49859|Opn|Nor|2010-09-01|url with additional filepath generates bad environ|
|49921|New|Nor|2010-09-13|Trailers in chunked http requests are not handled |
|49926|New|Enh|2010-09-14|New option for mod_log_forensics or mod_log_config|
|49980|New|Nor|2010-09-22|can't use a FIFO for SSL key file; mod_ssl checks |
|49981|New|Enh|2010-09-22|Requesting SSLCertificateKeyFile Dialog functional|
|49990|New|Nor|2010-09-23|Feature request: implement ExpiresActive reset    |
|49996|New|Nor|2010-09-24|Proxied ErrorDocument returns 200 OK response code|
|49997|New|Nor|2010-09-24|wrowe promised me...                              |
|50004|New|Nor|2010-09-26|per-dir rewrite without DocumentRoot or RewriteBas|
|50011|New|Cri|2010-09-27|error running apache, and installing apache as a s|
|50024|New|Min|2010-09-29|Mod_cache/mod_mem_cache and mod_security combinati|
|50038|New|Enh|2010-10-01|What Directives apply to a file/directory? Resulta|
|50041|New|Min|2010-10-04|(9)Bad file descriptor: apr_socket_accept: (client|
|50051|New|Nor|2010-10-07|Log PID in first entry logged for each request    |
|50061|New|Nor|2010-10-08|Semicolon character '%3B' seems to be decoded to '|
|50082|New|Nor|2010-10-12|apachectl status returns incorrect exit code      |
|50112|New|Nor|2010-10-18|buildconf broken in two places                    |
|50116|New|Nor|2010-10-19|Apache fragments packets unnecessarily            |
|50151|New|Nor|2010-10-25|Software caused connection abort and apache proces|
|50155|Inf|Nor|2010-10-25|httpd -s attempts to read SSL certificates        |
|50172|Inf|Nor|2010-10-28|Digest allows access bypassing secuity            |
|50227|New|Enh|2010-11-07|Option to fail SSL handshake for diverted SNI conn|
|50237|Inf|Nor|2010-11-08|webdav LOCK access with multiple threads to same f|
|50261|New|Nor|2010-11-12|graceful restart with multiple listeners using pre|
|50262|New|Nor|2010-11-12|mod_rewrite log ip address vs hostname            |
|50274|New|Nor|2010-11-15|always pass CONTENT_LENGTH to the application     |
|50278|New|Nor|2010-11-16|-DFOREGROUND and ap_unixd_killpg()/ap_os_killpg() |
|50290|Inf|Nor|2010-11-18|vanilla apache 2.2.17 installation crashes (lib-ap|
|50296|New|Nor|2010-11-18|LDAPVerifyServerCert and possibly LDAPTrustedMode |
|50317|New|Nor|2010-11-22|Possible error in mod_cache's "Avoiding the Thunde|
|50336|New|Min|2010-11-25|PUT failures do not emit Allow:                   |
|50344|New|Nor|2010-11-26|ProxyPass does not handle different protocols when|
|50357|New|Enh|2010-11-28|improve matching mechanisms for mime type and enco|
|50372|New|Enh|2010-11-29|any reason for allowing ModMimeUsePathInfo only in|
|50390|New|Nor|2010-11-30|WARNING: Unrecognized options : --disable-ipv6    |
|50402|New|Nor|2010-12-02|SetEnv proxy-sendchunks is ignored for small amoun|
|50412|New|Nor|2010-12-04|if IndexOptions +XHTML, the correct MIME type shou|
|50423|Inf|Nor|2010-12-06|Apache is terminated with signal 11, Segmentation |
|50427|New|Nor|2010-12-07|Windows>=Vista+mod_auth_digest+command line=proble|
|50432|New|Enh|2010-12-08|add PCRE-mode for file based matches              |
|50436|New|Enh|2010-12-08|VirtualHost could behave like people expect it to |
|50444|New|Enh|2010-12-09|Pre-close logging handles in cgid agent           |
|50456|Inf|Nor|2010-12-10|Invalid Error 413 crash Apache                    |
|50464|New|Blk|2010-12-13|undefined reference to `BIO_set_callback' `BIO_set|
|50466|Inf|Maj|2010-12-13|httpd process doesn't recycle                     |
|50473|New|Maj|2010-12-14|zlib.dll Problem                                  |
|50521|New|Nor|2010-12-25|Comment at top of sample main config file is wrong|
|50525|New|Nor|2010-12-28|Header directive won't edit Location header from P|
|50530|New|Enh|2010-12-29|Provide rate limiting for failed authentication at|
|50532|New|Enh|2010-12-30|Mail protection                                   |
|50551|New|Nor|2011-01-06|Some proxied connections ignore ttl setting       |
|50562|Opn|Cri|2011-01-09|wrong PATH_INFO CGI environment with non-ASCII UTF|
|50584|New|Enh|2011-01-14|Add error message when RequestReadTimeout triggere|
|50592|New|Maj|2011-01-15|httpd dumps core on an IPv6 only system           |
|50602|New|Nor|2011-01-17|non thread safe functions used in apache httpd pro|
|50619|New|Min|2011-01-19|After changing resolv.conf signaling httpd doesn't|
|50628|New|Blk|2011-01-21|Core dump happens with Apache 2.2.15 using openssl|
|50630|New|Nor|2011-01-21|Apache return 500 error with authentication by LDA|
|50644|New|Enh|2011-01-24|Add support for maximum number of requests per Kee|
|50654|New|Nor|2011-01-25|FileETag ContentMD5 & Filename, optimisation to Co|
|50693|New|Nor|2011-01-31|AllowOverride Options=(not Foo) should permit no-o|
|50704|Inf|Nor|2011-02-01|mod_cache doesn't cache MultiViews                |
|50712|New|Maj|2011-02-02|Restart button only stops the server ...and do not|
|50727|New|Nor|2011-02-07|ISAPI EXTENSION_CONTROL_BLOCK Missing PostData wit|
|50765|New|Enh|2011-02-11|Runtime Backend Pinning via balancer-manager      |
|50770|New|Nor|2011-02-14|a rotatelogs issue, if time changed               |
|50773|Inf|Nor|2011-02-14|Dav lock database corruption                      |
|50774|New|Enh|2011-02-14|Have a way to invalidate cache without other reque|
|50777|New|Nor|2011-02-14|Back port buildconf specifies AC_PREREQ(2.13) fix |
|50796|New|Enh|2011-02-16|record time between keepalives in access log      |
|50807|New|Maj|2011-02-18|mod_proxy fails to send FIN response when a FIN is|
|50814|New|Nor|2011-02-21|SSI exec not working on Windows (Apache 2.x)      |
|50848|New|Enh|2011-03-01|Content Negotiation type map file precedence could|
|50869|New|Enh|2011-03-04|Need directive to control use and timeout of sessi|
|50873|New|Nor|2011-03-04|httpd does not start properly when built from sour|
|50878|New|Nor|2011-03-05|redundant operation when calling apr_stat         |
|50891|New|Nor|2011-03-08|Apache rewrites WWW-Authenticate headers from CGI |
|50902|Inf|Maj|2011-03-09|on major load on the server, poll() hangs         |
|50916|New|Nor|2011-03-11|RewriteMap program: mod_rewrite sends request but |
|50926|New|Nor|2011-03-14|unexpected <Directory> file-matching behavior     |
|50942|New|Maj|2011-03-17|Apache 2.2.16 forward proxy is 5x times slower tha|
|50945|Opn|Nor|2011-03-18|AJP: Missing support for ErrorOverride            |
|50948|Opn|Nor|2011-03-19|Connection not closed when CGI dies waiting for PO|
|50954|New|Nor|2011-03-21|ProxyRemote doesnt use CONNECT method with https s|
|50959|New|Enh|2011-03-23|Add cache-manifest to the mime type list          |
|50976|New|Nor|2011-03-26|Apache losts client's ip (%a or %h) sometimes.    |
|50999|Opn|Nor|2011-03-30|it seems the configure wrong detect my apr-util ve|
|51001|New|Nor|2011-03-31|patch for hook ap_lua_run_lua_open                |
|51005|New|Enh|2011-04-01|Allow to use username in LDAP filter              |
|51006|New|Blk|2011-04-01|Apache consume all memory and swap when setup as r|
|51019|New|Enh|2011-04-04|[PATCH] Implementation of Asynchronous processing |
|51020|Opn|Nor|2011-04-04|[PATCH] Apache/mod_fcgid.so does not start in comp|
|51022|New|Nor|2011-04-05|Segmentation fault on PUT request                 |
|51030|New|Enh|2011-04-06|Way to terminate CGI immediatly after closing conn|
|51078|Inf|Nor|2011-04-18|[PATCH] mod_fcgid spawned CGI Processes gets orpha|
|51079|New|Enh|2011-04-18|[PATCH] mod_fcgid spawned CGI Process cannot imper|
|51080|New|Nor|2011-04-18|[PATCH] mod_isapi does not support Except:100-Cont|
|51103|Opn|Nor|2011-04-21|mod_reqtimeout does not drop connection and return|
|51104|Opn|Maj|2011-04-21|C++ support about httpd_config.h                  |
|51107|New|Min|2011-04-22|SetOutputFilter and SetInputFilter should allow "n|
|51118|New|Nor|2011-04-26|LDAP cache is cleared after graceful/restart and o|
|51127|New|Nor|2011-04-27|Make ProxyPassReverseCookiePath work as expected  |
|51168|New|Nor|2011-05-08|mod_status Total Traffic won't take account of int|
|51170|New|Nor|2011-05-09|I/O errors when using keep-alive + mod_ssl        |
|51174|New|Min|2011-05-09|SSLRequire predicates using OIDs unknown to openss|
|51186|New|Blk|2011-05-11|NEw Openssl 1.0.1 with new FIPS                   |
|51190|New|Min|2011-05-12|::/0 does not work with allow from and deny from  |
|51194|New|Nor|2011-05-13|FcgidWrapper does not support paths containing a s|
|51201|Inf|Nor|2011-05-15|Strange behavior REQUEST_METHOD & GET in mod_rewri|
|51223|New|Nor|2011-05-18|304 HTTP Not Modified strips out CORS headers     |
|51224|New|Nor|2011-05-18|mod_dav_fs should respect FileETag                |
|51239|New|Nor|2011-05-21|ap_get_client_block may block continuously sometim|
|51257|New|Nor|2011-05-24|Build failed when cross-compiling: ./gen_test_char|
|51258|Opn|Enh|2011-05-24|new features for mod_substitute                   |
|51296|New|Enh|2011-05-31|Dynamic engine support using SSLCryptoDevice suppo|
|51297|New|Nor|2011-05-31|Improve error handling during "UNLOCK"            |
|51303|New|Nor|2011-05-31|TraceEnable 500 error                             |
|51312|New|Nor|2011-06-01|mod_filter should support adding to the Vary heade|
|51322|New|Enh|2011-06-04|Prepend and append string to LDAP search parameter|
|51359|Inf|Enh|2011-06-11|Added shebang check for //! so that .js scripts wo|
|51365|New|Nor|2011-06-13|Mod_proxy mangles query string with mod_security  |
|51402|New|Nor|2011-06-21|"ForceLanguagePriority Fallback" not working as im|
|51406|New|Maj|2011-06-21|When listing files in subdirectories, the path is |
|51409|New|Nor|2011-06-21|Sorting options accepted by ls, but ignored       |
|51471|New|Nor|2011-07-04|<DirectoryMatch>ed IndexIgnore doesn't            |
|51479|New|Enh|2011-07-05|[PATCH] AB feature to optionally read in a reusabl|
|51491|New|Nor|2011-07-08|mod_dir breaks POSTs to URLs not ending in /      |
|51495|New|Nor|2011-07-11|mod_substitute cpu and memory limit               |
|51517|New|Maj|2011-07-16|mod_proxy_fcgi is not RFC 3875 compliant (SCRIPT_F|
|51522|Ver|Trv|2011-07-18|Wrong French translation in mpm.html ("Certains Mo|
|51542|New|Nor|2011-07-22|Apache HTTP Server vs PVS-Studio                  |
|51543|New|Nor|2011-07-22|Space in username not properly escaped in log file|
|51552|Inf|Cri|2011-07-25|Apache is not starting (2.2.15)                   |
|51573|New|Enh|2011-07-28|Easy way to erase log files                       |
|51576|Inf|Nor|2011-07-28|mod_rewrite rule stopped working                  |
|51600|New|Enh|2011-08-02|Loading the same certificate in multiple virtual h|
|51603|Inf|Maj|2011-08-02|Apache accepts completely bogus HTTP requests (pos|
|51607|Inf|Nor|2011-08-03|DBDPrepareSQL ( ap_dbd_prepare ) does not work cor|
|51629|New|Nor|2011-08-05|DocumentRoot check incorrect when running under ch|
|51674|New|Blk|2011-08-18|AJP Module Bad Request                            |
|51679|New|Min|2011-08-18|Code signature key expired                        |
|51689|New|Trv|2011-08-19|Cross compiling causes multiple Listen directives |
|51695|New|Trv|2011-08-20|Code clean up (ap_rputs merge)                    |
|51707|New|Nor|2011-08-22|ProxyPassReverse issues within <Location> (differe|
|51709|New|Nor|2011-08-23|ServerName/ServerAlias don't work if Host: header |
|51711|New|Nor|2011-08-23|mod_auth_digest have broken shared mem (nonce) cod|
|51718|New|Enh|2011-08-24|Feature Request: Add shorthand to redirect any Ser|
|51725|New|Nor|2011-08-26|Multiple Range: request accepted as "Range: n-m"  |
|51732|New|Nor|2011-08-29|Inconsistencies in log messages' verbosity levels |
|51747|New|Blk|2011-08-31|mod_fcgid loads entire request into memory while p|
|51757|Inf|Enh|2011-09-02|Add support for SASL auth in LDAP                 |
|51778|Inf|Cri|2011-09-07|while buliding(make) a unix source "httpd-2.2.20.t|
|51797|Inf|Maj|2011-09-10|Crash HTTPD(Windows)                              |
|51814|New|Enh|2011-09-14|mod_proxy in Apache HTTP 2.2 FIN_WAIT2 in server s|
|51858|Inf|Nor|2011-09-21|weird error for mod_rewrite with more then 3 param|
|51864|New|Nor|2011-09-22|mod_cache returns entire entity from origin server|
|51904|New|Nor|2011-09-28|output to stderr from cgi script causes script to |
|51951|New|Nor|2011-10-04|mod_mbox hang on some e-mails on press@a.o - was I|
|51964|Ver|Nor|2011-10-05|Documentation of RewriteRule flag skip unclear    |
|51965|New|Nor|2011-10-05|--with-z=DIR not being honored                    |
|51982|Opn|Nor|2011-10-06|ProxyPassReverse / balancer://cluster/ adds slash |
|51987|Inf|Nor|2011-10-07|RewriteRule doesn't work correctly with apache 2.3|
|51994|New|Enh|2011-10-07|Mod_authn_socache should have some way to flush th|
|52004|Ver|Trv|2011-10-10|Typo "indexe" in French translation of mpm.html   |
|52007|New|Nor|2011-10-10|Content-Length: 0 not set on proxy response       |
|52038|New|Nor|2011-10-16|NameWidth works incorrectly together with Charset=|
|52039|Inf|Nor|2011-10-16|Browser mode does not always work                 |
|52043|New|Nor|2011-10-17|Directories ".", "..", and "/" do not work correct|
|52081|New|Nor|2011-10-24|segfault if mbox files have unexpected names      |
|52090|New|Maj|2011-10-26|Apache thread hangs with error 500 when sending a |
|52120|Opn|Nor|2011-11-01|mod_cache edge case: uncacheable 304 sends cached |
|52123|New|Maj|2011-11-02|DoS: High memory usage in propfind                |
|52132|New|Nor|2011-11-03|[PATCH] process activity score calculated incorrec|
|52139|New|Nor|2011-11-05|Never Syntax Error on non-existent DocumentRoot   |
|52171|Ver|Nor|2011-11-13|confusing documentation of request phases         |
|52174|New|Enh|2011-11-13|Allow hard lower-limits on the number of fcgi serv|
|52178|New|Nor|2011-11-14|IPv6 IPs as ServerName not allowed                |
|52181|Ver|Nor|2011-11-14|mod_rewrite Technical Details Ruleset Processing d|
|52195|Inf|Nor|2011-11-16|Japanese texts are garbled on mailing list archive|
|52196|Inf|Nor|2011-11-16|winnt mpm, others mpm also have this bug. pool sha|
|52207|Inf|Maj|2011-11-18|Upgrade apache version from 2.0.59 to 2.2.12 or ab|
|52222|New|Nor|2011-11-21|IndexIgnore ignores parent directories in argument|
|52247|New|Nor|2011-11-26|mod_mbox gives up on unexpected message format    |
|52248|New|Nor|2011-11-26|Bugzilla version drop-down list does not offer "un|
|52252|New|Nor|2011-11-27|luajit support broken for (at least) luajit 2.0   |
|52253|Inf|Nor|2011-11-28|Timeout doesn't work. mod_proxy_balancer strongly |
|52264|New|Enh|2011-11-30|Update and complete balancer-manager XML output   |
|52269|Inf|Nor|2011-12-01|[mod_proxy] Apache reverse proxy status code trans|
|52275|New|Nor|2011-12-02|memory leak in proxy_ajp_handler                  |
|52298|Inf|Nor|2011-12-07|Can't enter website with client certificate on an |
|52301|New|Enh|2011-12-07|Error message "RSA server certificate ... CN ... d|
|52302|New|Enh|2011-12-07|Better documentation of how server name is determi|
|52304|New|Nor|2011-12-08|<Limit> Does Not Apply When URI Is Folder         |
|52313|New|Enh|2011-12-09|htdbm enhancement: options for colon-in-username, |
|52322|Inf|Enh|2011-12-13|Providing BBC developed httpd modules for inclusio|
|52342|New|Nor|2011-12-15|ap_internal_redirect dropping filters means incons|
|52370|New|Nor|2011-12-19|apreq_decode/url_decode length miscalculation     |
|52377|New|Enh|2011-12-20|Add Directives to assert user, group, and permissi|
|52383|New|Trv|2011-12-24|Instllation log typo                              |
|52391|New|Cri|2011-12-27|100% CPU usage while using Forward Proxy          |
|52395|New|Nor|2011-12-29|reload results in different end environment to res|
|52403|New|Nor|2011-12-31|FallbackResource doesn't work for non-existent PHP|
|52408|New|Nor|2012-01-01|Directoryindex matching automatically redirects   |
|52415|New|Nor|2012-01-03|LockFile placed inappropriately                   |
|52417|New|Nor|2012-01-03|HEADERS information in the file                   |
|52435|New|Nor|2012-01-06|Apache shutdown automatically                     |
|52439|New|Nor|2012-01-09|It should be possible to treat errors in .htaccess|
|52453|New|Enh|2012-01-11|Ability to configure --logfiledir                 |
|52465|New|Nor|2012-01-13|mod_dir is allowed to redirect proxy requests     |
|52481|New|Nor|2012-01-18|Rotatelog.exe crashes Apache after setting 256MB r|
|52485|New|Nor|2012-01-19|CPU load 100%                                     |
|52494|New|Enh|2012-01-22|allow the Action directive to point in the filesys|
|52495|New|Enh|2012-01-22|CACertificate, CADNCertificate, CARevocation, Cert|
|52501|New|Cri|2012-01-23|child pid 10824 exit signal Segmentation fault (11|
|52505|New|Nor|2012-01-23|Include with directory wildcards gives errors for |
|52509|New|Nor|2012-01-23|Resources protected by .htaccess file may not be a|
|52510|New|Cri|2012-01-23|Segmentation Fault 11                             |
|52520|New|Nor|2012-01-24|ProxyRemote & NoProxy directive can not take IPv6 |
|52532|New|Trv|2012-01-26|VirtualHost added TWICE to name-virtual-host list |
|52539|New|Nor|2012-01-26|Apache mod_dav 400 Bad Request for non-existent co|
|52546|New|Nor|2012-01-27|overwrite SERVER_PROTOCOL environment             |
|52573|New|Nor|2012-02-01|mod_speling case correction fails when URI has dou|
|52578|Opn|Enh|2012-02-02|Wrong "bytes sent" logged when connection is close|
|52594|New|Nor|2012-02-03|rpmbuild -ba errors out with "File not found by gl|
|52595|New|Nor|2012-02-03|requests with gzip+chunked encoded body don't prox|
|52605|Inf|Min|2012-02-05|Please allow request lines longer than 8k         |
|52612|New|Nor|2012-02-06|Default Service Account                           |
|52616|Opn|Enh|2012-02-07|SSLUserName uses SSL_CLIENT_S_DN insted of SSL_CLI|
|52617|New|Maj|2012-02-07|Visit the rewrite page from ServerAlias domain vho|
|52623|New|Nor|2012-02-08|does not build with pcre-8.30                     |
|52644|New|Nor|2012-02-12|document how SSL FakeBasicAuth works with strange |
|52668|New|Trv|2012-02-14|More future safe patch for old MSIE ssl-unclean-sh|
|52670|New|Trv|2012-02-15|please clarify the effect of SSLStrictSNIVHostChec|
|52683|New|Enh|2012-02-16|add a symlink option that rechecks the access perm|
|52700|Inf|Blk|2012-02-17|Not rendering html content instead displaying clie|
|52703|Inf|Maj|2012-02-18|SSL+SNI+client-auth "lost" after some time        |
|52710|New|Nor|2012-02-19|mod_fcgid should set PATH_INFO when configured in |
|52756|Inf|Trv|2012-02-24|proxy_html_module LoadModule line not created in h|
|52759|New|Cri|2012-02-24|Apache httpd child process consuming high CPU Util|
|52790|New|Nor|2012-02-28|ldap caching not sufficient                       |
|52795|Opn|Nor|2012-02-29|mod_fcgid fails to spawn process in C:\Program Fil|
|52806|New|Nor|2012-03-01|configure: --with-included-apr is not supported in|
|52807|New|Nor|2012-03-01|some random strings are accepted by "configure" as|
|52816|New|Nor|2012-03-03|Potential segfault in socache_shmcb_create        |
|52817|New|Nor|2012-03-03|Long directory path sucks (but it's really a valid|
|52822|New|Nor|2012-03-04|Quiet installation not fully quiet                |
|52824|Inf|Nor|2012-03-04|Conflicts between AllowOverride and AllowOverrideL|
|52828|New|Maj|2012-03-05|Child process is not replaced in Windows, after a |
|52832|New|Nor|2012-03-05|numerical configuration entry can be mistakenly in|
|52841|Opn|Nor|2012-03-06|[proxy_balancer:emerg] [pid 25593] AH01177: Failed|
|52851|New|Nor|2012-03-07|Core TimeOut directive doesn't work               |
|52860|New|Enh|2012-03-08|Support Transfer-Encoding: gzip                   |
|52865|New|Nor|2012-03-09|Crash by segmentation fault in mod_authn_core in A|
|52870|New|Cri|2012-03-09|100% CPU usage while using Forward Proxy          |
|52874|New|Enh|2012-03-09|Support Use TrustedFirst checking when verifying c|
|52884|New|Nor|2012-03-12|"localhost" leads to start failure                |
|52890|Inf|Nor|2012-03-12|--with-included-apr doesn't work when srclib/apr a|
|52891|New|Nor|2012-03-12|2.2 doesn't perform as well as 1.3                |
|52894|Inf|Nor|2012-03-13|Apache aborts abnormally when ChrootDir is set    |
|52927|Inf|Nor|2012-03-16|[Bug in httpd 2.2.4] [error] (70014)End of file fo|
|52933|New|Nor|2012-03-17|Child survives '-k stop', consuming lots of CPU   |
|52950|New|Nor|2012-03-20|Error when set AuthType to None with valid-user   |
|52963|New|Nor|2012-03-21|Typo in AuthLDAPURL RFC 2255 error message        |
|52975|New|Nor|2012-03-23|Receiving files is suboptimal                     |
|52976|New|Min|2012-03-23|Gratuitous string-duplication in module-configurat|
|52978|New|Enh|2012-03-23|Binding to an interface instead of an address     |
|52995|New|Nor|2012-03-28|httpd -V does not print the default Mutex         |
|53002|New|Nor|2012-03-29|<Location> and auth_form (trailing slash problem?)|
|53015|New|Nor|2012-03-31|missing apr_socket_close                          |
|53016|New|Nor|2012-03-31|missing apr_brigade_destroy                       |
|53023|New|Nor|2012-04-02|mod_rewrite RewriteCond parser error and documenta|
|53037|New|Enh|2012-04-05|clarify mod_ssl documentation on the UID/GID conte|
|53059|New|Nor|2012-04-10|Make httpd easier relocatable by using a variable |
|53098|New|Nor|2012-04-18|mod_proxy_ajp: patch to set worker secret passed t|
|53099|New|Enh|2012-04-18|feature request for mod_remoteip                  |
|53108|New|Enh|2012-04-19|clarification on url-path vs full filesystem path |
|53111|New|Nor|2012-04-20|1% of CMS sites expose database passwords         |
|53121|New|Nor|2012-04-22|Confusing documentation, gzip and deflate         |
|53149|New|Enh|2012-04-25|mod_ldap should/could use mod_socache             |
|53152|Opn|Nor|2012-04-26|RewriteRule documentation: Error about per-directo|
|53156|New|Enh|2012-04-27|CRL validation fails if CRL is missing            |
|53160|New|Cri|2012-04-29|Reverse Proxy mod_deflate doesn't zip back content|
|53183|New|Min|2012-05-03|mod_apreq2 entry point is apreq_module and not apr|
|53193|New|Nor|2012-05-04|SLVerifyClient optional_no_ca + SSLSessionCache = |
|53218|New|Blk|2012-05-11|ProxyPass worker name(http://localhost:3128/...|
|53233|New|Maj|2012-05-15|Internal error: proxy: error reading status line f|
|53239|New|Maj|2012-05-16|Httpd has problems delivering data on rate-limited|
|53253|New|Maj|2012-05-17|TCP_NOPUSH used with sendfile(2), cause transfers |
|53284|New|Nor|2012-05-24|crash                                             |
|53290|New|Maj|2012-05-24|memory usage                                      |
|53292|New|Min|2012-05-25|add support for HTTP status code 308              |
|53305|New|Nor|2012-05-28|404 errors when adding query string in a balancer |
|53313|New|Nor|2012-05-28|SSI #echo VAR fails (#include OK) if URI/URL has f|
|53319|New|Nor|2012-05-29|Multiple DirectoryIndex statements in the same con|
|53332|New|Nor|2012-05-30|Requests with chunked encoding have no body availa|
|53350|New|Nor|2012-06-01|mod_cache caching 403 responses Apahce 2.2.22     |
|53351|New|Nor|2012-06-02|make fails if layout begins on first line of confi|
|53388|Opn|Nor|2012-06-08|mod_proxy_balanser generates 503 when proxying to |
|53402|New|Trv|2012-06-12|Incorrect error message for mod_ldap params       |
|53461|Inf|Cri|2012-06-23|Compilation problems                              |
|53462|New|Nor|2012-06-25|mod_rewrite does not remove trailing slash when as|
|53479|New|Nor|2012-06-27|mod_rewrite [B] flag should percent-encode the spa|
|53483|New|Enh|2012-06-29|dangerous PCRE patterns in *Match directives      |
|53539|New|Maj|2012-07-12|content type and character set are changing when t|
|53554|New|Nor|2012-07-16|Wrong case for hexadecimal percent encoding [patch|
|53555|New|Maj|2012-07-17|Scoreboard full error with event/ssl              |
|53579|New|Cri|2012-07-20|httpd looping writing on a pipe and unresponsive (|
|53581|New|Blk|2012-07-21|FollowSymlinks doesn't work with DirectoryMatch an|
|53594|New|Enh|2012-07-24|ipad as webserver                                 |
|53595|New|Nor|2012-07-24|Media type qs parameters for MultiViews sent in Co|
|53612|Inf|Nor|2012-07-27|Reverse Proxy causing 500 error SSL proxy 1.0.1c O|
|53618|New|Nor|2012-07-29|proxy_worker_shared fields not maintained in threa|
|53634|New|Nor|2012-08-01|mod_cache returning HTTP 200 for nonexistent resou|
|53638|New|Nor|2012-08-02|Problem with shortcuts to bugzilla in http://httpd|
|53640|Inf|Maj|2012-08-02|make: Fatal error: Command failed for target `htpa|
|53643|New|Cri|2012-08-02|apache segfaults with mod_authn_dbd when dbd_min i|
|53646|New|Nor|2012-08-02|Invalid uniformly distributed balancing of request|
|53651|New|Nor|2012-08-03|Worker failure doesn't have same behaviour as work|
|53667|New|Enh|2012-08-07|Add an equivalent option to "JkOptions ForwardLoca|
|53669|New|Nor|2012-08-07|IndexOptions Incremental IndexOptions documentatio|
|53686|New|Enh|2012-08-09|Status "501 Not Implemented" sent very late       |
|53690|New|Nor|2012-08-09|Calls to semctl() trigger "uninitialized memory" w|
|53692|New|Nor|2012-08-10|mod_auth_form loses request body before login page|
|53693|Opn|Nor|2012-08-10|mod_fcgid performance suffers under increase in re|
|53704|New|Enh|2012-08-13|True online configuration is needed - via LDAP?   |
|53705|New|Nor|2012-08-13|Align server-status balancer display to balancer-m|
|53706|New|Enh|2012-08-13|Include a status display for mod_ldap when present|
|53722|New|Nor|2012-08-15|when -D NO_DETACH is used, no PID file should be c|
|53736|New|Nor|2012-08-17|/balancer-manager doesn't save runtime adjusted se|
|53757|New|Enh|2012-08-21|RewriteMap of type txt should allow specifying col|
|53767|New|Nor|2012-08-23|htcacheclean deletes stale "vary" header files eve|
|53772|New|Nor|2012-08-24|REDIRECT_URL not accessible in mod_proxy          |
|53787|New|Reg|2012-08-28|In forward proxy, doesn't cache disk anymore      |
|53823|New|Nor|2012-09-03|[patch] pure IPv6 only host fix (server/config.c) |
|53835|New|Cri|2012-09-06|mod_proxy_ajp truncate output when using deflate i|
|53870|New|Maj|2012-09-13|Deadlock in CRYPTO_add_lock with Apache 2.2.22 wor|
|53886|New|Nor|2012-09-18|can't start apache control in Redhat Linux 3 X64  |
|53899|New|Nor|2012-09-19|SSL_OP_ALL disables the mitigation code for CVE-20|
|53915|New|Nor|2012-09-21|Colon lost when :port is used in CacheKeyBaseURL  |
|53919|Inf|Enh|2012-09-21|DEFAULT_LOG_FORMAT is not RFC6302 compliant       |
|53923|New|Min|2012-09-23|Overriding CustomLog directive seems impossible   |
|53932|New|Nor|2012-09-25|PROPFIND doesn't support If, If-Match ETag predica|
|53947|New|Enh|2012-09-29|Feature Request, RewriteRule - ProxyPreserveHost f|
|53961|New|Nor|2012-10-04|Null sessions to the default vhost                |
|53970|New|Nor|2012-10-05|Network control directives affects internal subreq|
|53981|New|Nor|2012-10-08|move def of log_request_state from mod_log_config.|
|53988|New|Enh|2012-10-10|Missing FCGIWrapper script should not be a critica|
|53999|Opn|Nor|2012-10-13|Deadlock between procmgr_send_spawn_cmd()/proctabl|
|54030|New|Enh|2012-10-19|Support subjectAltName when (reverse-)proxying    |
|54033|New|Enh|2012-10-21|Parent languages are not ordered according to Acce|
|54072|New|Reg|2012-10-30|Syntax error front-end virtual-path too long      |
|54102|New|Enh|2012-11-05|new feature: automatic route detection            |
|54118|New|Nor|2012-11-08|Handle leak on parent httpd process when rotatelog|
|54126|New|Maj|2012-11-09|Mod_rewrite failing because of url in query string|
|54134|New|Enh|2012-11-11|new feature: ability to use multiple routes in sti|
|54136|New|Min|2012-11-11|balancer-handler shows xml not, when only xml para|
|54158|New|Nor|2012-11-16|Suggestion regarding 2.0 to 2.2 Upgrade Documentat|
|54183|Inf|Nor|2012-11-21|PROPFIND doesn't report getcontenttype property   |
|54215|New|Maj|2012-11-27|configure fails for httpd 2.2.3 with openssl 1.0.1|
|54221|Opn|Nor|2012-11-28|no ErrorLog prefix on CGI errors                  |
|54222|New|Min|2012-11-28|ServerTokens checking is not complete             |
|54223|New|Nor|2012-11-29|AH00554 error when runtime configuration Includes |
|54252|New|Nor|2012-12-05|acinclude.m4 requires -lz when linking with ssl st|
|54253|New|Nor|2012-12-05|mod_proxy_ftp doesn't handle/log partial or cancel|
|54255|New|Nor|2012-12-06|mod_deflate adjusts the headers "too late", should|
|54269|New|Maj|2012-12-09|mod_proxy_html documentation misses several things|
|54276|New|Nor|2012-12-10|rotatelogs not getting killed on graceful restart |
|54280|New|Nor|2012-12-11|mod_auth_form inline login not working with traili|
|54281|New|Nor|2012-12-11|Stick use Partial parameters from query string    |
|54289|New|Nor|2012-12-13|"ap_get_brigade" api is failing in "AP_MODE_SPECUL|
|54306|New|Enh|2012-12-15|add regexp versions of ProxyPassReverse, ProxyPass|
|54309|New|Trv|2012-12-15|clarification on the <Location> directive when use|
|54310|Opn|Nor|2012-12-15|mod_proxy_html drops meta elements with http-equiv|
|54319|New|Reg|2012-12-17|ProxyPass has no effect in <Location> if rewrite o|
|54339|New|Nor|2012-12-21|piped log entries > PIPE_BUF can be interleaved   |
|54342|New|Nor|2012-12-22|AuthnCacheSOCache can't pass args to socache provi|
|54343|New|Maj|2012-12-22|Add sanity checks for malloc() in mpm_winnt.c and |
|54358|New|Nor|2012-12-29|Status 500 when using ldap on Solaris because apr_|
|54363|New|Nor|2012-12-31|make time conversion caching functions thread-safe|
|54364|New|Nor|2012-12-31|Add ref to mod_fcgid docs                         |
|54365|New|Nor|2013-01-02|Connection closed by server during file transfer  |
|54366|New|Nor|2013-01-02|$sysconfdir/extra/httpd-dav.conf is not built base|
|54367|Opn|Maj|2013-01-02|Location header in response to PUT is not %-escape|
|54385|New|Enh|2013-01-08|SSL configuration independent from virtual hosts, |
|54401|New|Nor|2013-01-10|Suggest to make ProxyPassReverseCookieDomain accep|
|54415|New|Enh|2013-01-14|Please tell the root cause of mutex and scoreboard|
|54431|Inf|Blk|2013-01-16|Unable to start the Apache 2.4.3 windows service. |
|54498|New|Nor|2013-01-28|apache crash on any cgi request with certain http |
|54502|New|Nor|2013-01-29|Apache deadlock on epoll_ctl error (1000 process l|
|54512|Inf|Cri|2013-01-31|Apache hung                                       |
|54517|New|Nor|2013-02-01|proxy balancer: timeout or partial failure of back|
|54518|New|Nor|2013-02-01|mod_rewrite not adding Vary header                |
|54519|New|Nor|2013-02-02|httpd already running                             |
|54526|New|Nor|2013-02-05|mod_proxy_http ignores request abortion           |
|54543|New|Enh|2013-02-10|Compile regex only when need                      |
|54546|New|Nor|2013-02-11|httpd crashes on first HUP after change Listen dir|
|54549|New|Nor|2013-02-11|mod_mime AddEncoding and mod_negotiation fix_encod|
|54556|New|Enh|2013-02-13|New flag to add default rule in rule chain        |
|54560|New|Nor|2013-02-13|Potential segfault on return from ap_server_root_r|
|54563|New|Maj|2013-02-15|mod_webdav ignores quota                          |
|54578|New|Nor|2013-02-18|Bad docs or unchecked code for "LimitRequestFields|
|54605|New|Enh|2013-02-24|mod_negotiation should cache the info it generates|
|54608|New|Enh|2013-02-25|Support an option to allow page caching when using|
|54622|New|Nor|2013-02-28|shared memory cleanup                             |
|54626|New|Nor|2013-03-01|mod_authnz_ldap through util_ldap.c does not suppo|
|54633|New|Nor|2013-03-04|Invalid % encoding not rejected                   |
|54637|New|Nor|2013-03-05|Digest: secret not used                           |
|54640|New|Nor|2013-03-05|Slow transaction on a balance member is holding su|
|54649|New|Nor|2013-03-06|Incorrect PIDFILE prevent httpd restart           |
|54653|New|Min|2013-03-08|Suggestion to add https example for forward proxy |
|54656|New|Maj|2013-03-09|SNI and SSLProxyCheckPeerCN based on "connection" |
|54657|New|Nor|2013-03-09|DNS lookup failure for load balancer member does n|
|54683|New|Min|2013-03-13|Ignor directive ErrorDocument with null byte      |
|54699|Opn|Enh|2013-03-15|[feature request] cli webaccess tester            |
|54701|New|Cri|2013-03-15|Apache 2.4.3 Migration Issue Not loading the pages|
|54704|New|Nor|2013-03-15|Web Services stalling on it's own                 |
|54719|New|Nor|2013-03-18|httpd should check for and eventually create pid f|
|54752|New|Nor|2013-03-25|mod_ssl should not use uninitialized memory as ran|
|54782|New|Nor|2013-04-02|Memory Corruption errors - mpm_worker mod_perl    |
|54785|New|Nor|2013-04-02|Random crash when httpd server is stopped         |
|54793|New|Nor|2013-04-03|Socket timeout handler can delete uploaded files P|
|54794|New|Reg|2013-04-03|mod_wsgi|fcgid and subversion >= 1.7 issues       |
|54795|New|Nor|2013-04-03|'apxs -g -n' should be self-referring             |
|54796|Inf|Enh|2013-04-03|CustomLog should be able to use syslog as ErrorLog|
|54804|New|Nor|2013-04-05|mod_fcgid sends a Continue 100 response automatica|
|54813|New|Nor|2013-04-08|documnt the Require args used by authz_dbm includi|
|54816|Inf|Nor|2013-04-08|AH00566: request failed: invalid characters in URI|
|54817|New|Nor|2013-04-09|if prefix and sysconfdir are the same then http.co|
|54820|Inf|Cri|2013-04-09|REwriterule stops working                         |
|54824|New|Nor|2013-04-10|Spec file is missing libuuid-devel requirement    |
|54830|New|Enh|2013-04-11|Make SSLPProxyMachineCertificateFile configurable |
|54848|New|Nor|2013-04-15|Client field too short for IPv6 addresses         |
|54856|Inf|Enh|2013-04-17|NSCreateObjectFileImageFromFile                   |
|54858|New|Nor|2013-04-17|ld duplicate                                      |
|54861|New|Blk|2013-04-18|The number of connections with mysql is more      |
|54869|Inf|Nor|2013-04-19|Non-breaking space characters cause httpd to choke|
|54875|New|Nor|2013-04-23|Conditional request predicated on another URL's ET|
|54878|New|Nor|2013-04-23|Multiple Listen directives prevent server to start|
|54905|Inf|Cri|2013-04-29|Apache2 loops in child Segfaults                  |
|54910|New|Enh|2013-04-30|Format %{Foobar}o cannot be used to log Date and S|
|54911|New|Enh|2013-04-30|Allow logging of fields set by a backend server in|
|54914|New|Nor|2013-04-30|mod_dir DirectoryIndex breaks WebDAV PROPFIND / DE|
|54915|New|Nor|2013-04-30|GET on a WebDAV-enabled collection, with Directory|
|54918|New|Enh|2013-05-02|Implement RFC 6797 HTTP Strict Transport Security |
|54919|Inf|Nor|2013-05-02|*** glibc detected *** /usr/sbin/httpd: double fre|
|54930|New|Nor|2013-05-06|Allow empty message in ErrorDocument directive    |
|54934|Inf|Cri|2013-05-07|Apache is crashing intermittently with a message "|
|54936|New|Nor|2013-05-08|Some potential bugs reported by static analysis to|
|54949|New|Nor|2013-05-10|[PATCH] mod_cache: fix uninitialized tmppath varia|
|54952|Inf|Cri|2013-05-10|[Fri May 10 17:39:01 2013] [error] proxy: CLUSTER:|
|54953|New|Nor|2013-05-11|<VirtualHost 0.0.0.0:80> matches IPv6             |
|54958|New|Nor|2013-05-13|mod_deflate + mod_mime with SSI gives mixed compre|
|54962|New|Maj|2013-05-14|Apache will set incorrect Content-Length header an|
|54965|New|Enh|2013-05-14|Allow ProxyPassMatch in Directory context         |
|54976|New|Nor|2013-05-15|ProxyPass parameter "acquire" and "ttl" ignored in|
|54986|New|Maj|2013-05-16|httpd hanging on large form submit in ap_run_handl|
|54989|New|Nor|2013-05-17|Apache Segfaults on OS X at random - how can I dia|
|54993|New|Nor|2013-05-20|Critical error: File descriptor in bad state: apr_|
|54998|Ver|Nor|2013-05-21|Apache 2.4 terminates all SSL connections using an|
|55000|New|Nor|2013-05-21|Memory usage per process doubles when Apache is co|
|55021|New|Enh|2013-05-28|Support arbitrary sql to authentication username/p|
|55022|Inf|Cri|2013-05-28|child pid 3123 exit signal Bus error (10) - Apache|
|55034|Inf|Maj|2013-05-31|Apache 2.4.4 won't open more that 32k VH file hand|
|55039|New|Enh|2013-05-31|"RequestHeader edit" can't access environment vari|
|55045|New|Nor|2013-06-01|calls to gets() in test_find.c and test_parser.c  |
|55068|New|Enh|2013-06-06|root permissions when writing to per vhosts errorl|
|55069|New|Min|2013-06-06|notice message in error_log even when LogLevel err|
|55070|Opn|Enh|2013-06-06|mod_fcgid stderr always goes to main error log    |
|55072|New|Nor|2013-06-07|ErrorLog doesn't work well when apache shutdown   |
|55093|New|Nor|2013-06-12|[PATCH] mod_fcgid 2.3.7 truncates large posts on R|
|55096|New|Nor|2013-06-12|Make not running on httpd configure Solaris       |
|55098|New|Nor|2013-06-13|does not listen to IP4 when both IP4 address and I|
|55106|New|Enh|2013-06-17|ProxyErrorOverride considers response codes >= 400|
|55117|New|Nor|2013-06-18|GracefullTimeout for worker threads               |
|55148|Inf|Nor|2013-06-26|Error during SSL Handshake with remote server     |
|55152|New|Nor|2013-06-28|graceful restart adjusts to new balancer members, |
|55156|New|Nor|2013-06-28|mod_cache not respecting s-maxage cache-control he|
|55178|New|Nor|2013-07-01|[PATCH] mod_authnz_ldap SASL authentication suppor|
|55192|New|Trv|2013-07-03|htaccess error messages missing request context   |
|55193|New|Min|2013-07-03|ErrorLogFormat is ignored by some modules         |
|55226|New|Enh|2013-07-09|Request for "domain cluster" feature for mod_proxy|
|55234|New|Maj|2013-07-10|Working of attribute "protocol" attribute "protoco|
|55276|Inf|Enh|2013-07-17|Add REST API for load balancer for dynamic registr|
|55278|New|Nor|2013-07-18|mod_session's cookie may be empty, is repeated twi|
|55284|New|Nor|2013-07-20|repeatable segv                                   |
|55286|New|Nor|2013-07-21|Floating point exception (8) in mod_auth_digest   |
|55293|New|Nor|2013-07-22|Incorrect default MIME type for .woff fonts       |
|55306|New|Nor|2013-07-25|Error when copying svn repository, which contains |
|55323|New|Nor|2013-07-29|Double unescaped uri in sub request handler       |
|55327|New|Nor|2013-07-30|Segmentation fault when stopping Apache 2.4.6 norm|
|55340|New|Maj|2013-08-01|Listen for valid, unconfigured IP address passes c|
|55344|New|Nor|2013-08-02|missing ap_hook_monitor on windows                |
|55346|New|Nor|2013-08-02|When on filled quota filesystem, mod_fcgid init in|
|55348|New|Nor|2013-08-02|%h is not changed in logging, only %a             |
|55351|New|Enh|2013-08-04|allow ProxyPassReverseCookieDomain to automaticall|
|55362|New|Nor|2013-08-05|Apache httpd sends "400 Bad Request" to client due|
|55379|New|Min|2013-08-07|htdigest -c doesn't behave as described anymore   |
|55394|New|Nor|2013-08-09|apache 2.4 randomy crashes with signal 6          |
|55401|New|Enh|2013-08-11|document that force-proxy-request-1.0 implies prox|
|55415|New|Maj|2013-08-14|Proxy loop caused by ProxyErrorOverride and ErrorD|
|55431|New|Nor|2013-08-16|mod_negotation does not force the mime type listed|
|55433|New|Nor|2013-08-16|mod_proxy ignores final status code for aborted re|
|55443|Inf|Maj|2013-08-17|never gives 300 multiple choices                  |
|55445|New|Maj|2013-08-18|mod_socache_memcache ignores expiry, creating eter|
|55447|New|Enh|2013-08-18|make type-maps usable again, by making them access|
|55448|New|Nor|2013-08-19|segfault in set_max_workers at event.c:3194 on SIG|
|55449|New|Maj|2013-08-19|AH01185: worker slotmem_create failed --> slotmem |
|55452|New|Maj|2013-08-19|Redirect                                          |
|55458|New|Enh|2013-08-20|allow to configure what mod_ssl responds when one |
|55460|New|Enh|2013-08-21|allow service names to be used in the Listen direc|
|55467|New|Nor|2013-08-21|Support for OpenSSL custom TLS extensions and supp|
|55523|New|Trv|2013-09-04|auth_groupfile error log on access even though suc|
|55535|Inf|Nor|2013-09-08|incorrect check state parametr                    |
|55540|New|Cri|2013-09-09|mod_proxy gzip chunked issue (sample site provided|
|55549|New|Min|2013-09-11|AuthLDAPSubGroupAttribute doesn't do anything     |
|55550|New|Nor|2013-09-11|AuthLDAPSubGroupClass checking is very inefficient|
|55556|New|Nor|2013-09-13|apachebench (ab) doesn't use so_reuseaddr         |
|55557|New|Nor|2013-09-14|Some cppcheck reports                             |
|55573|New|Enh|2013-09-19|FileETag needs MTimeSeconds, MTime with granularit|
|55581|New|Enh|2013-09-22|Support concurrent connections to same FastCGI pro|
|55590|Inf|Maj|2013-09-24|second commit is failing if space is in file name |
|55596|New|Enh|2013-09-25|Add date format used by Expires header            |
|55607|New|Enh|2013-09-28|Re-set HOME environment variable to directory from|
|55615|New|Nor|2013-09-30|Connections are starved and not balanced when conc|
|55619|New|Nor|2013-10-02|Apache httpd reported 500 internal error when uplo|
|55627|New|Min|2013-10-04|Remove unnecessary APLOGNO() for trace logging per|
|55636|Inf|Cri|2013-10-07|long lost child came home - Apache is not respondi|
|55646|Inf|Nor|2013-10-10|non-2xx responses are not considered errors       |
|55654|New|Nor|2013-10-15|Extract variables from configuration without start|
|55670|New|Min|2013-10-18|Startup may fail silently at post_config          |
|55673|New|Nor|2013-10-18|httpd fails to start with SSLProxyMachineCertifica|
|55680|New|Enh|2013-10-20|online manual directory option doesn't exist      |
|55698|New|Maj|2013-10-24|Apache 2.2 + mod_fcgid 2.3.7 (CentOS 6.4) graceful|
|55700|New|Enh|2013-10-24|add something like RewriteOptions InheritDown     |
|55707|New|Nor|2013-10-25|SSLProtocol directive seem to be ignored over diff|
|55708|New|Nor|2013-10-25|Access violation in msvcrt.dll when calling getenv|
|55711|New|Min|2013-10-28|--enable-foo doesn't enable foo                   |
|55712|New|Nor|2013-10-28|Relative <!--#include virtual="../file.shtml"--> g|
|55720|New|Enh|2013-10-29|separate LDAP Bind timeout from LDAPTimeout       |
|55738|New|Nor|2013-11-03|PVS-Studio: few issues                            |
|55763|New|Nor|2013-11-09|raise roots soft RLIMIT_NPROC on linux for high ma|
|55774|New|Nor|2013-11-13|ab: optionally accept tls client certificate      |
|55781|New|Nor|2013-11-15|ajp_read_header: ajp_ilink_receive failed; 120006)|
|55786|New|Maj|2013-11-16|SSLVerifyClient and OptRenegotiate result in a 403|
|55787|New|Maj|2013-11-16|Chroot fails with "Cannot chroot when not started |
|55790|New|Maj|2013-11-17|mod_fcgid lockfile hardcoded to be in /tmp        |
|55793|New|Enh|2013-11-18|DTrace/SystemTap support                          |
|55808|New|Nor|2013-11-21|File integrity verification using MD5 and SHA1    |
|55819|Inf|Nor|2013-11-27|Closing connection behaviour                      |
|55828|New|Cri|2013-11-28|Httpd not start if use ProxyPass balancer://      |
|55834|New|Maj|2013-12-02|Apache does not honor the openssl library path giv|
|55838|New|Nor|2013-12-03|PHP files are being executed instead of downloaded|
|55841|New|Nor|2013-12-04|Misleading news items on bugfix releases ("This ve|
|55856|New|Nor|2013-12-08|YYEMPTY (-2) used as index into yytname (const arr|
|55866|New|Nor|2013-12-11|When ProxyPreserveHost is on, SSL expects the wron|
|55878|New|Nor|2013-12-12|mod_fcgid kills spawned processes too early       |
|55881|New|Nor|2013-12-13|segmentation fault at proxy_util.c:1546           |
|55883|New|Enh|2013-12-14|string callers of ap_expr should be able to transf|
|55887|New|Maj|2013-12-16|In Windows apache, when user access to /con, apach|
|55898|New|Enh|2013-12-17|[RFE] listen on unix socket?                      |
|55914|New|Reg|2013-12-20|child exit segmentation fault after apache gracefu|
|55919|New|Nor|2013-12-22|EPREFIX and dynamic modules                       |
|55942|New|Nor|2014-01-01|400 - Bad Request on POST (Windows Server 2012 Hyp|
|55952|New|Nor|2014-01-05|ab: SSL keep-alive fails with apr_pollset_poll: Th|
|55962|New|Enh|2014-01-06|mod_remoteip should not allow an external proxy to|
|55963|New|Nor|2014-01-07|Add application/ld+json to mime.types             |
|55981|Opn|Nor|2014-01-09|mod_mbox hang on some e-mails on user@openoffice.a|
|55985|Opn|Nor|2014-01-10|apache does not reopen logs when multiple graceful|
|55989|Opn|Enh|2014-01-11|write to error log upon RewriteRule [F]orbidden   |
|55991|New|Nor|2014-01-12|mod_charset_lite doesn't bail out on non-identity |
|56009|Inf|Cri|2014-01-14|Memory leak in httpd 2.4.3 over time with persista|
|56014|New|Nor|2014-01-15|MOd rewrite CO Cookie method the lifetime flag not|
|56028|New|Enh|2014-01-17|Add http/1.0, http/1.1 NPN advertisement to enable|
|56034|New|Nor|2014-01-20|CPU consumption due to circular linked list in ap_|
|56040|New|Enh|2014-01-21|should be able to remove Max-Age cookie parameter |
|56041|New|Enh|2014-01-21|should be able to disable session expiry increment|
|56052|New|Nor|2014-01-22|ap_session_load called multiple times for expired |
|56055|New|Nor|2014-01-23|Route is not extracted properly when a session coo|
|56064|New|Enh|2014-01-25|Optimize PNGs                                     |
|56067|New|Nor|2014-01-27|FallbackResource doesn't work if directory exists |
|56081|New|Maj|2014-01-28|Apache 2.2.26 SIGSEGVs when POST'ing data         |
|56091|Inf|Nor|2014-01-30|SSL handshake error when httpd compiled on Oracle |
|56098|New|Nor|2014-02-01|duplicate cookie                                  |
|56101|New|Cri|2014-02-03|Apache 2.4.6 ceases processing requests (scoreboar|
|56102|New|Nor|2014-02-03|SSL_CLIENT_S_DN_x509_0 is undefined in the environ|
|56109|New|Nor|2014-02-05|Cannot increase the read limit                    |
|56113|New|Nor|2014-02-06|dist commit messages missing from mail-archives di|
|56131|New|Nor|2014-02-12|ProxyPassReverse / zealously replaces Location hea|
|56135|New|Nor|2014-02-13|Add DC to list of x509 components                 |
|56152|New|Nor|2014-02-18|ProxyBlock does not accept network addresses      |
|56176|New|Nor|2014-02-21|mod_substitute truncates the response body if the |
|56188|New|Nor|2014-02-25|mod_proxy_fcgi does not send FCGI_ABORT_REQUEST on|
|56209|New|Nor|2014-03-03|Uninitialised variables in os/win32/ap_regkey.c   |
|56226|Ver|Nor|2014-03-06|per VirtualHost KeepAliveTimeout is not recognized|
|56229|New|Enh|2014-03-06|ocsp ProxyHost and ProxyPort support              |
|56230|New|Nor|2014-03-07|mod_access_compat can log a bogus client denied me|
|56235|New|Nor|2014-03-07|quotes should be optional around expr             |
|56247|New|Cri|2014-03-12|semaphore creation for proxypass                  |
|56250|New|Nor|2014-03-12|sbindir in config.layout for Apache has bin instea|
|56251|New|Nor|2014-03-12|Increase maximum length of FcgidInitialEnv string |
|56252|New|Enh|2014-03-12|make install as privileged user creates files not |
|56262|New|Nor|2014-03-14|ab does not work with extremely long cookies      |
|56264|New|Trv|2014-03-14|Confusing error with .htaccess rewrite to proxy wh|
|56270|New|Enh|2014-03-15|--with-ssl=/foo w/o pkgconfig needs help on AIX 64|
|56288|New|Enh|2014-03-19|rewrite URLs in style attributes                  |
|56289|New|Nor|2014-03-19|Buffer overflow in mod_proxy_html's string replace|
|56308|New|Nor|2014-03-24|1 second delay in handle request kills performance|
|56312|New|Nor|2014-03-25|Can't configure different balancing workers that c|
|56314|New|Nor|2014-03-25|exiting from MPM-worker child caused assert in apr|
|56326|New|Nor|2014-03-27|cache_quick_handler does not serve responses with |
|56331|New|Nor|2014-03-29|windows 'access denied' during revalidaton of reso|
|56333|New|Enh|2014-03-31|API to resume a SUSPENDED connection              |
|56362|New|Maj|2014-04-08|ldaps only works with port 636. Non-standard port |
|56379|New|Nor|2014-04-09|Number of columns in the results returned from pgs|
|56395|New|Enh|2014-04-11|Allow SERVER_ADDR environment variable to be optio|
|56404|New|Nor|2014-04-12|endless loop  when connect to a website(https)  wh|
|56413|New|Blk|2014-04-15|can not restart httpd on centos 5.10 64bit        |
|56422|New|Nor|2014-04-17|authnz_ldap with other forms of authn can fail req|
|56457|New|Nor|2014-04-25|mod_proxy_html.c: 2 * cut'n'paste errors          |
|56473|New|Nor|2014-04-30|ETags don't change when headers do                |
|56475|New|Enh|2014-04-30|Allow TLS record size to be configured            |
|56483|New|Enh|2014-05-02|add disableKeepAlivePercentage similar to tomcat h|
|56493|New|Min|2014-05-06|mod_expires should not set expires in future for s|
|56495|New|Nor|2014-05-06|Application behind mod_proxy does not get SessionH|
|56500|Opn|Enh|2014-05-07|vhosts priority order with wildcard               |
|56504|New|Nor|2014-05-08|cannot build static support binaries              |
|56508|New|Nor|2014-05-09|Requiring SNI - SSLStrictSNIVHostCheck semantics  |
|56517|New|Enh|2014-05-12|Virtualhosts cannot inherit parent CustomLog      |
|56528|New|Enh|2014-05-15|"bad flags delimiter" - improve helpfulness       |
|56541|New|Nor|2014-05-18|Proxy 502's on large file post requests           |
|56559|New|Nor|2014-05-25|multiple unix sockets in one virtualhost fails    |
|56569|New|Nor|2014-05-27|Null CRC in gzip footer with mod_cgid and ErrorDoc|
|56587|New|Nor|2014-06-03|Many VirtualHost's with SSLEngine On              |
|56590|New|Enh|2014-06-04|(REST-) API for configuring balancer manager remot|
|56594|Inf|Nor|2014-06-05|mod_authn_dbd, mod_dbd and mod_ssl                |
|56598|New|Nor|2014-06-06|Content-Length header should be always interpreted|
|56621|New|Nor|2014-06-13|Rotatelogs.exe first start                        |
|56622|New|Nor|2014-06-13|mod_reqtimeout incorrectly applies timeouts to CON|
|56626|New|Nor|2014-06-15|Add info about rotatelogs to log rotation document|
|56633|New|Nor|2014-06-16|mod_auth_basic breaks mod_autoindex               |
|56645|New|Maj|2014-06-19|socket callback with timeout callback causes infin|
|56664|New|Nor|2014-06-24|Proxy retry timeout does not cope with system time|
|56697|New|Maj|2014-07-04|status page still shown while blocked             |
|56718|New|Nor|2014-07-14|Cleanup request Host headers when absolute URI are|
|56719|New|Nor|2014-07-14|parallel requests get served with delays          |
|56738|New|Enh|2014-07-17|Ability to extract route from cookie with regexp  |
|56740|New|Nor|2014-07-18|suspended_count not maintained properly with wstun|
|56750|New|Enh|2014-07-20|SuexecUserGroup replacement                       |
|56751|New|Maj|2014-07-20|Fails to properly mitigate Slow Post DoS attack   |
|56753|New|Nor|2014-07-21|mod_lua.so: symbol luaL_openlib: referenced symbol|
|56778|New|Nor|2014-07-28|while running make command i got this error       |
|56794|New|Nor|2014-07-31|Added AuthDBDFullAuthQuery option                 |
|56795|Inf|Nor|2014-07-31|Apache 2.4.10 Program received signal SIGPIPE, Bro|
|56818|Inf|Nor|2014-08-05|SetEnvIf may set invalid string length on empty st|
|56843|New|Enh|2014-08-12|Support different OCSP stapling max ages          |
|56868|New|Nor|2014-08-18|relative LuaRoot broken                           |
|56879|New|Nor|2014-08-22|Information disclosure                            |
|56889|New|Nor|2014-08-26|Close state never dies                            |
|56918|Opn|Blk|2014-09-06|error: 'ap_copy_scoreboard_worker' undeclared here|
|56926|New|Nor|2014-09-08|Filename causes AH02599 slotmem issue             |
|56933|New|Min|2014-09-09|not sure it's an appache bug : some browser want t|
|56942|New|Reg|2014-09-10|Unable to implement TRANSFER-CHUNKED:ENCODING with|
|56943|New|Nor|2014-09-10|mod_proxy_connect - AH02447: err/hup on backconn  |
|56977|New|Maj|2014-09-12|segfaults when using mod_mem_cache + mod_disk_cach|
|56986|New|Blk|2014-09-17|chunked Transfer-Encoding forbidden: /test/test.dl|
|57014|New|Cri|2014-09-24|Incorrect test for CC_FOR_BUILD prevents build (on|
|57023|New|Nor|2014-09-26|Socache shmcb don't cache file bigger than 11k    |
|57028|New|Enh|2014-09-27|mod_spdy - support Apache 2.4                     |
|57044|New|Nor|2014-09-29|[PatchAvailable] Use base64url in mod_unique_id ('|
|57045|New|Nor|2014-09-30|dumpio output strings are missing                 |
|57046|New|Enh|2014-09-30|Add additional parameter to enable check URL befor|
|57056|New|Maj|2014-10-03|Rewrite port is taken into hostname               |
|57067|New|Nor|2014-10-08|A proxy worker both standalone and balancer member|
|57069|New|Nor|2014-10-08|apache ssl timeout during chunked request in rever|
|57073|New|Cri|2014-10-09|Intermittent Connection Issues using default httpd|
|57085|New|Enh|2014-10-14|Implement Proxy Protocol in httpd                 |
|57087|New|Nor|2014-10-14|mod_proxy_fcgi doesn't send cgi CONTENT_LENGTH var|
|57100|Ver|Nor|2014-10-16|"SSLProtocol ALL" is ignored for virtual hosts    |
|57101|New|Enh|2014-10-16|[PATCH] Better error reporting when child spawn fa|
|57109|New|Nor|2014-10-17|GPG verification examples are wrong               |
|57119|Opn|Enh|2014-10-20|Suppress address reuse / DNS cache in mod_proxy   |
|57121|New|Nor|2014-10-21|ocsp stapling should not pass temporary server out|
|57131|New|Nor|2014-10-22|OCSP Stapling scalability concern                 |
|57159|New|Min|2014-10-28|mod_ssl OCSP Stapling directives don't support per|
|57160|New|Nor|2014-10-29|httxt2dbm doesn't generate files on NAS           |
|57174|New|Nor|2014-10-31|Update windows visual studio build                |
|57210|New|Nor|2014-11-14|LuaHookMapToStorage not firing in per-directory co|
|57211|New|Enh|2014-11-14|Config-time options                               |
|57212|Opn|Nor|2014-11-14|Headers returned by scripts are limited to 8190 by|
|57218|New|Nor|2014-11-15|[Feature Request] Apache Bench (AB) to output a cs|
|57219|New|Nor|2014-11-15|ApacheBench quits unexpectedly with high concurren|
|57220|New|Nor|2014-11-15|[Feature Request] Add option to ApacheBench to giv|
|57228|New|Nor|2014-11-17|glibc detected *** httpd: double free or corruptio|
|57229|New|Maj|2014-11-17|mod_sed dies on long lines                        |
|57286|New|Nor|2014-11-29|Symbolic links are not honoured                   |
|57298|New|Min|2014-12-02|RewriteBase inside FilesMatch behaves oddly       |
|57299|New|Enh|2014-12-02|mod_session_dbd should not make a database call pe|
|57300|New|Enh|2014-12-02|mod_session_dbd should not save the session at eac|
|57301|New|Enh|2014-12-02|Add SessionMaxAgeAbsolute Directive               |
|57304|Inf|Nor|2014-12-03|MySQL DBD Authentication Incompatible with SSL    |
|57311|New|Nor|2014-12-04|BalancerMember enclosed by <If> gives syntax error|
|57313|New|Nor|2014-12-05|The DefaultType directive has been removed        |
|57327|New|Nor|2014-12-08|mod_ssl seg fault on exit                         |
|57334|Ver|Maj|2014-12-09|Segmentation fault in SSL_renegotiate at ssl_lib.c|
|57337|New|Nor|2014-12-10|Content negotiation fails with conditional Redirec|
|57339|New|Enh|2014-12-10|ErrorLogFormat doesn't allow logging in Internet d|
|57360|New|Nor|2014-12-17|Fail gracefully on certificate/key mismatch       |
|57372|New|Nor|2014-12-19|httpd will lookup every home directory while start|
|57374|Ver|Nor|2014-12-19|Event MPM: Wrong KeepAliveTimeout when system cloc|
|57379|New|Nor|2014-12-20|[patch] Makefile.in  with mpm-shared, cgi and cgid|
|57383|New|Cri|2014-12-21|Error retrieving Report: An Existing connection wa|
|57386|New|Blk|2014-12-22|html5 lost some comments                          |
|57398|New|Maj|2014-12-26|AH01075: Error dispatching request to : (passing b|
|57399|New|Nor|2014-12-28|Many unnecessary CPU wakeups per second           |
|57406|New|Nor|2014-12-31|cgi-bin script is not executing                   |
|57412|New|Maj|2015-01-04|rewrite rules causes duplicate requests           |
|57416|New|Nor|2015-01-06|htcacheclean thinks the cache is smaller than it a|
|57424|Opn|Nor|2015-01-07|mod_rewrite not using ap_context_document_root    |
|57436|New|Enh|2015-01-12|Option to strip extra data after websocket request|
|57439|New|Enh|2015-01-13|Allow to change body timeout per location         |
|57448|New|Nor|2015-01-16|SSI <!--#set --> cannot capture backreferences fro|
|57453|New|Maj|2015-01-17|403 error when virtualhost configured with non-exi|
|57471|New|Nor|2015-01-20|Apache 2.4.10 Compilation fails when compiling aga|
|57477|New|Nor|2015-01-21|mod_auth_digest AH00052: child pid $pid exit signa|
|57483|New|Nor|2015-01-22|Omit "Keep-Alive" header on 1.1 connections       |
|57492|New|Nor|2015-01-24|incomplete chunked-transfered request body is not |
|57506|New|Nor|2015-01-27|<If> directive doesn't work within a <Location> se|
|57510|New|Enh|2015-01-28|Engine keyform support for private keys           |
|57511|New|Maj|2015-01-28|Opening plain TCP Socket on SSL port causes denial|
|57515|New|Nor|2015-01-30|Define/Undefine don't work reasonably outside of g|
|57519|New|Nor|2015-02-01|change SSLv2 to SSLv3 or remove SSLv2 support allt|
|57526|Opn|Maj|2015-02-03|Apache 2.2.29_openssl-1.0.1k_x86_64 Error creating|
|57529|Opn|Nor|2015-02-03|htcacheclean doesn't show the cached URL with '-a'|
|57585|New|Nor|2015-02-13|httpd fails to start if there is an IncludeOptiona|
|57590|New|Nor|2015-02-18|loading mod_proxy_http makes rewriteRule's [proxy]|
|57591|New|Nor|2015-02-18|DirectoryIndex directive cannot be overwritten    |
|57616|New|Maj|2015-02-23|AB - DNS roundrobin support                       |
|57624|New|Enh|2015-02-23|Provide support for http/2.0                      |
|57631|New|Nor|2015-02-24|Useless test in acinclude.m4                      |
|57632|New|Nor|2015-02-24|mod_systemd passes invalid default to APACHE_MODUL|
|57635|New|Nor|2015-02-25|meta-refresh is not rewritten by mod_proxy_html   |
|57636|New|Nor|2015-02-25|URLs without protocol are not rewriten by mod_prox|
|57641|New|Maj|2015-02-27|mod_substitute: Invalid merge order               |
|57646|New|Enh|2015-02-27|SSLEngine inside If directive                     |
|57660|New|Trv|2015-03-04|AB - free memory allocated by xmalloc and xcalloc |
|57680|New|Nor|2015-03-09|SSLSessionCacheTimeout has no effect              |
|57685|New|Nor|2015-03-10|Requests are denied while the mod_cgid daemon star|
|57691|New|Nor|2015-03-12|mod_proxy/proxy_util confuses UDS scheme with HTTP|
|57695|New|Nor|2015-03-12|[core:warn] [pid 1120] (101)Network is unreachable|
|57710|New|Nor|2015-03-15|Wildcard matching for logging headers             |
|57725|New|Enh|2015-03-18|ApacheBench: include http status code in gnuplot o|
|57742|New|Nor|2015-03-23|"reliable piped logging" doesn't work for ErrorLog|
|57745|New|Nor|2015-03-23|httpd exits 1 with no stderr when proxy_balancer_m|
|57746|New|Nor|2015-03-23|Apache hangs on startup using MPM event           |
|57751|Inf|Maj|2015-03-24|Problems with proxy reverse to websockets         |
|57756|New|Enh|2015-03-25|Config options for handling of pipelined request  |
|57757|New|Cri|2015-03-25|extern apr_xlate_t *ap_locale_to_ascii variable gi|
|57771|New|Nor|2015-03-27|cleanup_script uses incorrect connection ID       |
|57774|Inf|Nor|2015-03-28|httpd.conf <IfModule proxy_html_module> content er|
|57777|New|Nor|2015-03-30|Security concerns with documentation of AddHandler|
|57781|New|Nor|2015-03-31|disable reconnection after connection error       |
|57784|New|Enh|2015-03-31|[RFE] Multiple ErrorLog directives                |
|57785|Opn|Nor|2015-04-01|REDIRECT_URL is not suitable for use in server-gen|
|57795|Opn|Maj|2015-04-07|mod_proxy_wstunnel sometimes does not connect and |
|57800|New|Nor|2015-04-09|High CPU usage in ap_core_output_filter           |
|57807|New|Enh|2015-04-13|Build-configurable environment variable length    |
|57810|New|Nor|2015-04-13|Should apache ignore difference in trailing dot be|
|57813|New|Nor|2015-04-14|Rewrite 'pre-compressed content' recipe using 2.4 |
|57814|New|Nor|2015-04-14|Teach mod_deflate how to serve pre-comressed conte|
|57819|New|Nor|2015-04-15|Need a conventions document                       |
|57832|New|Enh|2015-04-19|Reduction of response splitting attacks consequenc|
|57853|Inf|Nor|2015-04-24|mod_proxy_http sends request with header 'Expect: |
|57876|New|Reg|2015-04-30|logresolve.exe on any Windows immediately crashes |
|57878|New|Nor|2015-04-30|Using UTF-8 for all languages, and avoiding html-e|
|57895|New|Min|2015-05-05|missing m4a mimeType in mime.types                |
|57911|New|Min|2015-05-09|Rewrite documentation unclear or wrong about what |
|57927|New|Maj|2015-05-13|Segmentation Fault at proxy_util.c:994            |
|57933|New|Min|2015-05-18|apr_port_t returns constant                       |
|57941|New|Nor|2015-05-21|config.status: line 331: syntax error near unexpec|
|57949|New|Enh|2015-05-25|new mod_ssl environment variable SSL_{CLIENT|SERVE|
|57950|New|Nor|2015-05-26|[patch] buildconf change hint in build to newer ap|
|57960|New|Nor|2015-05-27|PUT truncates response body; status_line appears t|
|57976|New|Cri|2015-05-30|Server threads stale when sending 500 status with |
|57978|New|Nor|2015-06-01|unix:/ works with any number of / slashes  except |
|57979|New|Nor|2015-06-01|can not turn change log level for mod_filter      |
|57996|New|Nor|2015-06-03|Symlinks erroneously not followed when target inod|
|57997|New|Nor|2015-06-03|Threads started during child_init don't block sign|
|57999|New|Nor|2015-06-04|ap_getparents() may remove start slash of uri     |
|58001|New|Enh|2015-06-04|Implement Forwarded header (RFC 7239) to mod_proxy|
|58007|New|Nor|2015-06-06|400 Bad Request with fully qualified domain name o|
|58025|New|Enh|2015-06-11|mod_authz_dbd : new dbd-query and AuthzDBDQuery op|
|58026|New|Nor|2015-06-11|return 421 status code when SNI and Host: header d|
|58044|New|Cri|2015-06-16|Error sintax 'lua_dump'                           |
|58050|New|Nor|2015-06-17|ErrorDocument does not always work                |
|58073|New|Nor|2015-06-24|Extremely long time for graceful restart          |
|58089|New|Nor|2015-07-01|mod_authz_host uses proxy IP even when mod_remotei|
|58097|New|Enh|2015-07-03|[feat] Preserve original connecting IP            |
|58101|New|Nor|2015-07-05|DeflateCompressionLevel inside vhost resets logfor|
|58107|New|Blk|2015-07-06|Httpd crashes on startup every time, dump file att|
|58109|New|Nor|2015-07-06|Apache on windows cannot handle the hash symbol (#|
|58118|Inf|Min|2015-07-09|mod_proxy_fcgi logs 503 when user aborts connectio|
|58120|New|Nor|2015-07-10|ProxyPassInherit does not work as expect          |
|58121|New|Nor|2015-07-10|ProxyHTMLMeta seems to ignore all <meta http-equiv|
|58129|New|Nor|2015-07-12|man pages are not generated correctly             |
|58132|New|Nor|2015-07-12|non-standard, non-traditional man page layout make|
|58135|New|Nor|2015-07-14|mod_cache sends client "if-Modified-Since" to back|
|58141|New|Nor|2015-07-15|Apache Service doesn't start when rotatlogs.exe pa|
|58142|New|Nor|2015-07-15|authz_core ignores loglevel                       |
|58158|New|Nor|2015-07-21|Not honoring HTTP spec with regard to Accept-Encod|
|58168|New|Enh|2015-07-21|Would like full request evaluation support in Rewr|
|58171|New|Nor|2015-07-22|ap_session_save saves the wrong session after a de|
|58177|New|Enh|2015-07-24|Mod Proxy forward trailers in http chunked request|
|58180|New|Enh|2015-07-24|ErrorDocument original URL in subsequent <Location|
|58181|New|Enh|2015-07-25|mod_expire should allow "minus" keyword same like |
|58188|New|Nor|2015-07-28|http2 mod_lua: support build with lua 5.2+        |
|58197|New|Nor|2015-07-31|apr-util-1.5.4 build against openldap - "could not|
|58225|New|Reg|2015-08-08|intermitant segfault 11 in session_identity_encode|
|58226|New|Nor|2015-08-08|XSS in Error Page                                 |
|58231|New|Nor|2015-08-11|RewriteCond can add "Host" to the Vary-Header     |
|58235|New|Enh|2015-08-12|Ability to allow from domain but with using forwar|
|58243|New|Nor|2015-08-14|rotatelogs goes infinite at startup               |
|58248|New|Nor|2015-08-17|Error 404 in use some characters of utf8 in url   |
|58257|New|Nor|2015-08-18|require ldap-group does not work if account-fullna|
|58278|Inf|Blk|2015-08-24|apache - mod_security Issue : apache no releasing |
|58280|New|Nor|2015-08-24|Backend connection not closed until timeout if cli|
|58288|New|Blk|2015-08-27|Semaphore amount increase until crash when enablin|
|58292|New|Nor|2015-08-27|FallbackResource breaks chunked encoding sometimes|
|58304|New|Nor|2015-08-30|Unexpected Warnings from Macro Use in 2.4         |
|58305|New|Nor|2015-08-30|mod_cgi documentation not clear about what is pass|
|58306|New|Nor|2015-08-30|documentation needs to make it clear which directi|
|58307|New|Nor|2015-08-31|Segmentation fault in child in "read(__nbytes, __b|
|58317|New|Min|2015-09-02|Error message AH01630 is missing file name on deny|
|58334|New|Min|2015-09-06|WebDAV HTTP access does not include meta tag for c|
|58335|New|Nor|2015-09-07|mod_authnz_ldap mismatch                          |
|58343|New|Nor|2015-09-08|The pdf files come up as a blank page.            |
|58354|New|Maj|2015-09-10|(20014)Internal error (specific information not av|
|58356|New|Blk|2015-09-10|Session jumping due to incorrect route            |
|58364|New|Reg|2015-09-11|Apache Server is restarted time to time (Release 2|
|58417|New|Min|2015-09-16|ApacheBench (ab) won't display Server Software of |
|58419|New|Nor|2015-09-16|ApacheBench (ab) doesn't work with keep-alives aga|
|58423|New|Reg|2015-09-17|Apache >= 2.4.8 PCRE_DUPNAMES causes build failure|
|58467|New|Maj|2015-09-29|Environment Variables in ProxyHTMLURLMap produces |
|58475|New|Nor|2015-10-03|Support append/merge with semicolon-separated head|
|58488|New|Nor|2015-10-08|Stoped PHP-FPM pool in multi-pool system with comu|
|58491|New|Maj|2015-10-09|Core dumps appear when the load increases         |
|58492|Inf|Nor|2015-10-09|I think LDAPConnectionPoolTTL is not being honored|
|58498|New|Nor|2015-10-16|Apache 2.4.17: Regression with mod_autoindex (in c|
|58500|New|Nor|2015-10-16|dav_fs not enabled by default                     |
|58503|New|Cri|2015-10-16|segfault in apr_brigade_cleanup() under high load |
|58509|New|Trv|2015-10-20|2.4.17-dev introduces second core.c handler at sta|
|58513|New|Maj|2015-10-21|httpd code documentation is missing               |
|58524|New|Nor|2015-10-23|mod_http2 segfaults when under heavy load         |
|58528|New|Nor|2015-10-23|AllowOverrideList None gets misparsed and .htacces|
|58529|New|Maj|2015-10-23|Segmentation fault after modifying a proxy Balance|
|58550|New|Enh|2015-10-26|During load, Apache 2.2.x with prefork MPM didn|
|58574|New|Nor|2015-11-02|Apache error AH01630 (client denied) but working  |
|58593|New|Nor|2015-11-06|mod_proxy wrong decision between http and ws      |
|58598|New|Enh|2015-11-08|Internal Server Error (500) when requesting non-ex|
|58602|New|Nor|2015-11-11|Priority issue on DirectoryMatch directive        |
|58604|New|Reg|2015-11-12|Plaintext auth broken in any Explicit FTP/AUTH TLS|
|58612|New|Min|2015-11-16|mod_webdav when write_stream failed should break a|
|58669|New|Nor|2015-11-30|Order of DBDInitSQL and DBDPrepareSQL             |
|58688|New|Nor|2015-12-03|Missing mod_ssl connection-level upgrade headers f|
|58700|New|Nor|2015-12-07|Apache logs not working with mod_remoteip and X-fo|
|58720|New|Enh|2015-12-11|querying server status stalls when scoreboard is f|
|58727|New|Min|2015-12-13|Directories with a ProxyPass directive are not dis|
+-----+---+---+----------+--------------------------------------------------+
| Total 1558 bugs                                                           |
+---------------------------------------------------------------------------+

From dev-return-85065-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Mon Dec 14 09:05:09 2015
Return-Path: <dev-return-85065-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id DC984184D7
	for <apmail-httpd-dev-archive@www.apache.org>; Mon, 14 Dec 2015 09:05:08 +0000 (UTC)
Received: (qmail 62626 invoked by uid 500); 14 Dec 2015 09:05:03 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 62530 invoked by uid 500); 14 Dec 2015 09:05:03 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 62520 invoked by uid 99); 14 Dec 2015 09:05:03 -0000
Received: from Unknown (HELO spamd1-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 14 Dec 2015 09:05:03 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd1-us-west.apache.org (ASF Mail Server at spamd1-us-west.apache.org) with ESMTP id 07B00C0E6A
	for <dev@httpd.apache.org>; Mon, 14 Dec 2015 09:05:03 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd1-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.11
X-Spam-Level:
X-Spam-Status: No, score=-0.11 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	SPF_PASS=-0.001, T_RP_MATCHES_RCVD=-0.01, URIBL_BLOCKED=0.001]
	autolearn=disabled
Authentication-Results: spamd1-us-west.apache.org (amavisd-new);
	dkim=pass (1024-bit key) header.d=greenbytes.de
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd1-us-west.apache.org [10.40.0.7]) (amavisd-new, port 10024)
	with ESMTP id pfs8xzW-5wgm for <dev@httpd.apache.org>;
	Mon, 14 Dec 2015 09:04:56 +0000 (UTC)
Received: from mail.greenbytes.de (mail.greenbytes.de [217.91.35.233])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id 5390D429A6
	for <dev@httpd.apache.org>; Mon, 14 Dec 2015 09:04:56 +0000 (UTC)
Received: from [192.168.1.150] (unknown [217.91.35.233])
	(using TLSv1 with cipher ECDHE-RSA-AES256-SHA (256/256 bits))
	(Client did not present a certificate)
	by mail.greenbytes.de (Postfix) with ESMTPSA id 1251015A0095
	for <dev@httpd.apache.org>; Mon, 14 Dec 2015 10:04:49 +0100 (CET)
DKIM-Signature: v=1; a=rsa-sha256; c=simple/simple; d=greenbytes.de; s=mail;
	t=1450083889; bh=q5AL87yP59OdpwNzTx69HwtT9cwlE2Q/+UXJMw/pwS8=;
	h=Subject:From:In-Reply-To:Date:References:To:From;
	b=ILtxpinZSQ18O1ewSQXP0rjU29rQvKI8YRMxoiU1HE23eHBwjO42Dgf1BJUA63bIQ
	 6hyBTDoQes0/6B13l8dFukl+mxhkul9Nek29wsPdayPQ0SI/LYaeZAMXons+H+tRIT
	 6GHvf2LI+E7jZzmWMVYL0gaEtmeFlln71KtRkcZA=
Content-Type: text/plain; charset=us-ascii
Mime-Version: 1.0 (Mac OS X Mail 9.2 \(3112\))
Subject: Re: [RESULT] Was: [VOTE] Release Apache httpd 2.4.18 as GA
From: Stefan Eissing <stefan.eissing@greenbytes.de>
In-Reply-To: <244112C6-B101-4ED8-BD5B-D49580F35114@jaguNET.com>
Date: Mon, 14 Dec 2015 10:04:48 +0100
Content-Transfer-Encoding: 7bit
Message-Id: <B7C18AC2-7611-4B7B-8DDE-22E7F96F084D@greenbytes.de>
References: <AD9BFA0F-C508-4DFE-8B4F-FF79D46D9D91@jaguNET.com> <244112C6-B101-4ED8-BD5B-D49580F35114@jaguNET.com>
To: dev@httpd.apache.org
X-Mailer: Apple Mail (2.3112)

Thanks for RMing, Jim!

> Am 11.12.2015 um 23:23 schrieb Jim Jagielski <jim@jaguNET.com>:
> 
> With more than the required 3 +1 (binding) votes, I call
> the VOTE closed with the result that the VOTE PASSES.
> 
> I will start moving the artifacts so the mirrors can collect
> them over the weekend.
> 
>> On Dec 8, 2015, at 3:38 PM, Jim Jagielski <jim@jaguNET.com> wrote:
>> 
>> The pre-release test tarballs for Apache httpd 2.4.18 can be found
>> at the usual place:
>> 
>> 	http://httpd.apache.org/dev/dist/
>> 
>> I'm calling a VOTE on releasing these as Apache httpd 2.4.18 GA.
>> 
>> [ ] +1: Good to go
>> [ ] +0: meh
>> [ ] -1: Danger Will Robinson. And why.
>> 
>> Vote will last the normal 72 hrs.
>> 
>> NOTE: The *-deps are only there for convenience.
>> 
>> Thx!
> 


From dev-return-85066-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Mon Dec 14 13:13:11 2015
Return-Path: <dev-return-85066-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id AABCE18E7A
	for <apmail-httpd-dev-archive@www.apache.org>; Mon, 14 Dec 2015 13:13:11 +0000 (UTC)
Received: (qmail 12138 invoked by uid 500); 14 Dec 2015 13:13:11 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 12067 invoked by uid 500); 14 Dec 2015 13:13:11 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 12055 invoked by uid 99); 14 Dec 2015 13:13:11 -0000
Received: from Unknown (HELO spamd4-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 14 Dec 2015 13:13:11 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd4-us-west.apache.org (ASF Mail Server at spamd4-us-west.apache.org) with ESMTP id B01AEC0D03
	for <dev@httpd.apache.org>; Mon, 14 Dec 2015 13:13:10 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd4-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 0.7
X-Spam-Level:
X-Spam-Status: No, score=0.7 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	KAM_ASCII_DIVIDERS=0.8, SPF_PASS=-0.001, URIBL_BLOCKED=0.001]
	autolearn=disabled
Authentication-Results: spamd4-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd4-us-west.apache.org [10.40.0.11]) (amavisd-new, port 10024)
	with ESMTP id KS0WQphkGA8J for <dev@httpd.apache.org>;
	Mon, 14 Dec 2015 13:12:56 +0000 (UTC)
Received: from mail-wm0-f51.google.com (mail-wm0-f51.google.com [74.125.82.51])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id B40DE439BF
	for <dev@httpd.apache.org>; Mon, 14 Dec 2015 13:12:55 +0000 (UTC)
Received: by mail-wm0-f51.google.com with SMTP id n186so45021503wmn.0
        for <dev@httpd.apache.org>; Mon, 14 Dec 2015 05:12:55 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=to:cc:from:subject:message-id:date:user-agent:mime-version
         :content-type;
        bh=mKbGRGtfH0DS+epa9IB+bu5nICaAc3xDqBhnDEpt54c=;
        b=TlRcJJpYjk+NSz4lbi4mBqnFgsbWcuKntz1bFpBnKxxY/vY/na7+GVuQfdR4RieBma
         8htqul/uChGLJgw62OV3JhFfMtScy2kOY8IDRQKR9/V0kKVkOwxDoHwem3c9hvT78Y55
         A+BD4yEkBkusozaK4Rm1m9t+Ux4ggZ+1/dbDSRmfTgC6wq2Aq5a4Ob6bjLDzL2OjF5Li
         yQxhtSBCRNLs+RFMeyBqhHjAcDxZ83X95NXut6OvnKVr+0ClXhsvStjyQXTI/RaOK+fy
         JxwXjtt7gR/2tcqxG9KIp9A2d/gYwEDzFi6JfkhlNRLDhGLUgU3lG4UqmNG5oJYCfznv
         Fc+A==
X-Received: by 10.28.177.10 with SMTP id a10mr23468930wmf.4.1450098774772;
        Mon, 14 Dec 2015 05:12:54 -0800 (PST)
Received: from [10.33.144.3] (nat-pool-gva-t.redhat.com. [209.132.186.32])
        by smtp.gmail.com with ESMTPSA id h67sm16001961wmf.17.2015.12.14.05.12.53
        (version=TLS1_2 cipher=ECDHE-RSA-AES128-GCM-SHA256 bits=128/128);
        Mon, 14 Dec 2015 05:12:53 -0800 (PST)
To: "dev@httpd.apache.org" <dev@httpd.apache.org>
Cc: Joe Orton <jorton@redhat.co>, mikagott@hotmail.com
From: jean-frederic clere <jfclere@gmail.com>
Subject: Weird behaviour with mod_ssl and SSLCryptoDevice
X-Enigmail-Draft-Status: N1110
Message-ID: <566EC054.2040204@gmail.com>
Date: Mon, 14 Dec 2015 14:12:52 +0100
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:38.0) Gecko/20100101
 Thunderbird/38.4.0
MIME-Version: 1.0
Content-Type: multipart/mixed;
 boundary="------------020105070505090801070203"

This is a multi-part message in MIME format.
--------------020105070505090801070203
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 8bit

Hi,

I am sure I am doing something wrong, but when using a dummy crypto
device to recreate a customer issue I am getting a similar issue in
httpd-trunk but I am nearly sure someone would have complained here if
that would be the case.

Comments

Jean-Frederic

The stack:
+++
(gdb) bt
#0  0x00007fac11198a98 in raise () from /lib64/libc.so.6
#1  0x00007fac1119a69a in abort () from /lib64/libc.so.6
#2  0x00007fac01f27e33 in dummy_init (e=<optimized out>) at e_dummy.c:146
#3  0x00007fac05a69509 in test_rc4_init_key () from /lib64/libcrypto.so.10
#4  0x00007fac05b3374c in ?? () from /lib64/libcrypto.so.10
#5  0x00007fac00000001 in ?? ()
#6  0x0000000000e37138 in ?? ()
#7  0x0000000000e62348 in ?? ()
#8  0x00007fac11d9d68a in apr_pool_cleanup_register (p=0x7fac05a6a122
<dynamic_ctrl+210>, data=0xfe4678, plain_cleanup_fn=0x1,
child_cleanup_fn=0x7fac05dab5c0)
    at memory/unix/apr_pools.c:2218
#9  0x0000000000f094c0 in ?? ()
#10 0x00007fac0625bf60 in ?? () from /home/jfclere/APACHE/modules/mod_ssl.so
#11 0x0000000000e60938 in ?? ()
#12 0x0000000000e62348 in ?? ()
#13 0x00007fac05a6ac58 in BUF_memdup () from /lib64/libcrypto.so.10
#14 0x00007fac06039af2 in ssl_init_Engine (s=0xe60938,
s@entry=0x7fffb9ad2e90, p=p@entry=0xe37138) at ssl_engine_init.c:386
#15 0x00007fac0603bdaf in ssl_init_Module (p=0xe37138, plog=<optimized
out>, ptemp=0xf09780, base_server=0x7fffb9ad2e90) at ssl_engine_init.c:242
#16 0x0000000000455153 in ap_run_post_config
(pconf=pconf@entry=0xe37138, plog=0xea0778, ptemp=0xe62348, s=0xe60938)
at config.c:103
#17 0x000000000042c575 in main (argc=3, argv=0x7fffb9ad3158) at main.c:788
+++

--------------020105070505090801070203
Content-Type: text/x-csrc;
 name="e_dummy.c"
Content-Transfer-Encoding: quoted-printable
Content-Disposition: attachment;
 filename="e_dummy.c"

/* crypto/engine/e_chil.c -*- mode: C; c-file-style: "eay" -*- */
/* Written by Richard Levitte (richard@levitte.org), Geoff Thorpe
 * (geoff@geoffthorpe.net) and Dr Stephen N Henson (steve@openssl.org)
 * for the OpenSSL project 2000.
 */
/* =3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D
 * Copyright (c) 1999-2001 The OpenSSL Project.  All rights reserved.
 *
 * Redistribution and use in source and binary forms, with or without
 * modification, are permitted provided that the following conditions
 * are met:
 *
 * 1. Redistributions of source code must retain the above copyright
 *    notice, this list of conditions and the following disclaimer.=20
 *
 * 2. Redistributions in binary form must reproduce the above copyright
 *    notice, this list of conditions and the following disclaimer in
 *    the documentation and/or other materials provided with the
 *    distribution.
 *
 * 3. All advertising materials mentioning features or use of this
 *    software must display the following acknowledgment:
 *    "This product includes software developed by the OpenSSL Project
 *    for use in the OpenSSL Toolkit. (http://www.OpenSSL.org/)"
 *
 * 4. The names "OpenSSL Toolkit" and "OpenSSL Project" must not be used =
to
 *    endorse or promote products derived from this software without
 *    prior written permission. For written permission, please contact
 *    licensing@OpenSSL.org.
 *
 * 5. Products derived from this software may not be called "OpenSSL"
 *    nor may "OpenSSL" appear in their names without prior written
 *    permission of the OpenSSL Project.
 *
 * 6. Redistributions of any form whatsoever must retain the following
 *    acknowledgment:
 *    "This product includes software developed by the OpenSSL Project
 *    for use in the OpenSSL Toolkit (http://www.OpenSSL.org/)"
 *
 * THIS SOFTWARE IS PROVIDED BY THE OpenSSL PROJECT ``AS IS'' AND ANY
 * EXPRESSED OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
 * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
 * PURPOSE ARE DISCLAIMED.  IN NO EVENT SHALL THE OpenSSL PROJECT OR
 * ITS CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
 * SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT
 * NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
 * LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
 * HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT,
 * STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
 * ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED
 * OF THE POSSIBILITY OF SUCH DAMAGE.
 * =3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D
 *
 * This product includes cryptographic software written by Eric Young
 * (eay@cryptsoft.com).  This product includes software written by Tim
 * Hudson (tjh@cryptsoft.com).
 *
 */

#include <stdio.h>
#include <string.h>
#include <openssl/crypto.h>
#include <openssl/pem.h>
#include <openssl/dso.h>
#include <openssl/engine.h>
#include <openssl/ui.h>
#include <openssl/rand.h>
#ifndef OPENSSL_NO_RSA
#include <openssl/rsa.h>
#endif
#ifndef OPENSSL_NO_DH
#include <openssl/dh.h>
#endif
#include <openssl/bn.h>

static int dummy_init(ENGINE *e);
static int dummy_finish(ENGINE *e);

static RSA_METHOD dummy_rsa;
static DH_METHOD dummy_dh;

/* Constants used when creating the ENGINE */
static const char *engine_dummy_id =3D "dummy";
static const char *engine_dummy_name =3D "Dummy hardware engine support";=


/* Now, to our own code */

/* This internal function is used by ENGINE_dummy() and possibly by the
 * "dynamic" ENGINE support too */
static int bind_helper(ENGINE *e)
{
    const DH_METHOD *dh;
    const RSA_METHOD *rsa;

    rsa =3D RSA_get_default_method();
    memcpy(&dummy_rsa, rsa, sizeof dummy_rsa);
    dummy_rsa.name =3D "Dummy engine RSA method";
   =20
    dh =3D DH_OpenSSL();
    memcpy(&dummy_dh, dh, sizeof dummy_dh);
    dummy_dh.name =3D "Dummy engine DH method";
   =20
    if (!ENGINE_set_id(e, engine_dummy_id) ||
        !ENGINE_set_name(e, engine_dummy_name) ||
        !ENGINE_set_DH(e, &dummy_dh) ||
        !ENGINE_set_RSA(e, &dummy_rsa) ||
        !ENGINE_set_init_function(e, dummy_init) ||
        !ENGINE_set_finish_function(e, dummy_finish)) {
        return 0;
    }

    return 1;
}

#ifdef OPENSSL_NO_DYNAMIC_ENGINE
static ENGINE *engine_dummy(void)
	{
	ENGINE *ret =3D ENGINE_new();
	if(!ret)
		return NULL;
	if(!bind_helper(ret))
		{
		ENGINE_free(ret);
		return NULL;
		}
	return ret;
	}

void ENGINE_load_dummy(void)
	{
	/* Copied from eng_[openssl|dyn].c */
	ENGINE *toadd =3D engine_dummy();
	if(!toadd) return;
	ENGINE_add(toadd);
	ENGINE_free(toadd);
	ERR_clear_error();
	}
#endif

static int dummy_refcount;

/* (de)initialisation functions. */
static int dummy_init(ENGINE *e)
{
    if (dummy_refcount++ !=3D 0) {
        abort();
    }
    fprintf(stderr, "dummy_init: Refcount now %d\n", dummy_refcount);
    return 1;
}

static int dummy_finish(ENGINE *e)
{
    dummy_refcount--;
    fprintf(stderr, "dummy_finish: Refcount now %d\n", dummy_refcount);
    return 1;
}

/* This stuff is needed if this ENGINE is being compiled into a self-cont=
ained
 * shared-library. */	  =20
#ifndef OPENSSL_NO_DYNAMIC_ENGINE
static int bind_fn(ENGINE *e, const char *id)
{
    if(id && (strcmp(id, engine_dummy_id) !=3D 0))
        return 0;
    if(!bind_helper(e))
        return 0;
    return 1;
}      =20
IMPLEMENT_DYNAMIC_CHECK_FN()
IMPLEMENT_DYNAMIC_BIND_FN(bind_fn)
#endif /* OPENSSL_NO_DYNAMIC_ENGINE */


--------------020105070505090801070203--

From dev-return-85067-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Mon Dec 14 13:19:11 2015
Return-Path: <dev-return-85067-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 2F70B18EBD
	for <apmail-httpd-dev-archive@www.apache.org>; Mon, 14 Dec 2015 13:19:11 +0000 (UTC)
Received: (qmail 32222 invoked by uid 500); 14 Dec 2015 13:19:10 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 32145 invoked by uid 500); 14 Dec 2015 13:19:10 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 32135 invoked by uid 99); 14 Dec 2015 13:19:10 -0000
Received: from Unknown (HELO spamd4-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 14 Dec 2015 13:19:10 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd4-us-west.apache.org (ASF Mail Server at spamd4-us-west.apache.org) with ESMTP id 3547DC0178
	for <dev@httpd.apache.org>; Mon, 14 Dec 2015 13:19:10 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd4-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.655
X-Spam-Level:
X-Spam-Status: No, score=-0.655 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RP_MATCHES_RCVD=-0.554, SPF_PASS=-0.001] autolearn=disabled
Authentication-Results: spamd4-us-west.apache.org (amavisd-new);
	dkim=pass (1024-bit key) header.d=greenbytes.de
Received: from mx1-us-west.apache.org ([10.40.0.8])
	by localhost (spamd4-us-west.apache.org [10.40.0.11]) (amavisd-new, port 10024)
	with ESMTP id LiL5jCKJkEdh for <dev@httpd.apache.org>;
	Mon, 14 Dec 2015 13:19:09 +0000 (UTC)
Received: from mail.greenbytes.de (mail.greenbytes.de [217.91.35.233])
	by mx1-us-west.apache.org (ASF Mail Server at mx1-us-west.apache.org) with ESMTPS id 1C27726621
	for <dev@httpd.apache.org>; Mon, 14 Dec 2015 13:19:08 +0000 (UTC)
Received: from [192.168.1.150] (unknown [217.91.35.233])
	(using TLSv1 with cipher ECDHE-RSA-AES256-SHA (256/256 bits))
	(Client did not present a certificate)
	by mail.greenbytes.de (Postfix) with ESMTPSA id 3D15B15A0327;
	Mon, 14 Dec 2015 14:19:00 +0100 (CET)
DKIM-Signature: v=1; a=rsa-sha256; c=simple/simple; d=greenbytes.de; s=mail;
	t=1450099140; bh=thqJP7xyiflBfv3B/StNo7OIeDp92z4z9ZknFW786kI=;
	h=Subject:From:In-Reply-To:Date:Cc:References:To:From;
	b=Qd6u3wLxLacxW35SAmkp1PF5sx6ZqnmMc2K5LzBH7iFo4AHzjpWGx3M3zrVr+N4fC
	 +6izzMwcnjMw67wFk9vN8dT5uog2tf1Mvq06c4syTkPltr50srw9nnfQ43HRnTZYYc
	 2oMrvFWdQRjiEWqjVmc+MrWXXn/1eUEpbCpGgnr0=
Content-Type: text/plain; charset=us-ascii
Mime-Version: 1.0 (Mac OS X Mail 9.2 \(3112\))
Subject: Re: Weird behaviour with mod_ssl and SSLCryptoDevice
From: Stefan Eissing <stefan.eissing@greenbytes.de>
In-Reply-To: <566EC054.2040204@gmail.com>
Date: Mon, 14 Dec 2015 14:18:59 +0100
Cc: Joe Orton <jorton@redhat.co>,
 mikagott@hotmail.com
Content-Transfer-Encoding: 7bit
Message-Id: <FFEBF534-3FDB-4FEA-8E78-3379AA7BABD3@greenbytes.de>
References: <566EC054.2040204@gmail.com>
To: dev@httpd.apache.org
X-Mailer: Apple Mail (2.3112)

You're certain it's only loaded once?

> Am 14.12.2015 um 14:12 schrieb jean-frederic clere <jfclere@gmail.com>:
> 
> <e_dummy.c>


From dev-return-85068-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Mon Dec 14 13:41:05 2015
Return-Path: <dev-return-85068-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 6F00618F79
	for <apmail-httpd-dev-archive@www.apache.org>; Mon, 14 Dec 2015 13:41:05 +0000 (UTC)
Received: (qmail 72396 invoked by uid 500); 14 Dec 2015 13:41:05 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 72330 invoked by uid 500); 14 Dec 2015 13:41:05 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 72320 invoked by uid 99); 14 Dec 2015 13:41:05 -0000
Received: from Unknown (HELO spamd2-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 14 Dec 2015 13:41:04 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd2-us-west.apache.org (ASF Mail Server at spamd2-us-west.apache.org) with ESMTP id 705BE1A026C
	for <dev@httpd.apache.org>; Mon, 14 Dec 2015 13:41:04 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd2-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.1
X-Spam-Level:
X-Spam-Status: No, score=-0.1 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	SPF_PASS=-0.001, URIBL_BLOCKED=0.001] autolearn=disabled
Authentication-Results: spamd2-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd2-us-west.apache.org [10.40.0.9]) (amavisd-new, port 10024)
	with ESMTP id CKvkZ-7u2B1b for <dev@httpd.apache.org>;
	Mon, 14 Dec 2015 13:40:55 +0000 (UTC)
Received: from mail-wm0-f50.google.com (mail-wm0-f50.google.com [74.125.82.50])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id 9127C24CA1
	for <dev@httpd.apache.org>; Mon, 14 Dec 2015 13:40:54 +0000 (UTC)
Received: by mail-wm0-f50.google.com with SMTP id n186so46201707wmn.0
        for <dev@httpd.apache.org>; Mon, 14 Dec 2015 05:40:54 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=subject:to:references:cc:from:message-id:date:user-agent
         :mime-version:in-reply-to:content-type:content-transfer-encoding;
        bh=Dsaz+yUJyobkR0QppMkd5fsiV5dzYLKi7WY27VIzzlA=;
        b=eBM20onRUBcXkW/qrUj1UsDzhHG2t0n13WrH/A2jgRaM6lPae2YB5IkJJHoDMGtFOE
         BBSGOL4OCyEUr/GJX2hgJnR2Woltx3xSGnnb5ecMYOdW24gNsF8ZmiFgBOG3RPC0Xirv
         Rb3n1hdbPsmVOxMV8UsJ3BYyl+4D4V5j/ZsMohJ+oPvxuT2C5k8wV0mkz9OqpIozHszv
         PFwhKxdMwzDo3XeVrDcNRQXjjvrwUxQzV64qJPIzzJFfHyo201ndcCHRowuo2gALRoWK
         pYDr5P4GF/aenkz5BiX+HVQaKcZFahWnlv8yglt2Yiv8Xw2b6TuZYXNlU8VwTbhX8l+0
         ihWw==
X-Received: by 10.194.250.39 with SMTP id yz7mr41682360wjc.92.1450100454317;
        Mon, 14 Dec 2015 05:40:54 -0800 (PST)
Received: from [10.33.144.3] (nat-pool-gva-t.redhat.com. [209.132.186.32])
        by smtp.gmail.com with ESMTPSA id cw3sm29759518wjb.26.2015.12.14.05.40.53
        (version=TLS1_2 cipher=ECDHE-RSA-AES128-GCM-SHA256 bits=128/128);
        Mon, 14 Dec 2015 05:40:53 -0800 (PST)
Subject: Re: Weird behaviour with mod_ssl and SSLCryptoDevice
To: "dev@httpd.apache.org" <dev@httpd.apache.org>
References: <566EC054.2040204@gmail.com>
Cc: Joe Orton <jorton@redhat.com>, mikagott@hotmail.com
From: jean-frederic clere <jfclere@gmail.com>
Message-ID: <566EC6E3.700@gmail.com>
Date: Mon, 14 Dec 2015 14:40:51 +0100
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:38.0) Gecko/20100101
 Thunderbird/38.4.0
MIME-Version: 1.0
In-Reply-To: <566EC054.2040204@gmail.com>
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: 7bit

On 12/14/2015 02:12 PM, jean-frederic clere wrote:
> Hi,
> 
> I am sure I am doing something wrong, but when using a dummy crypto
> device to recreate a customer issue I am getting a similar issue in
> httpd-trunk but I am nearly sure someone would have complained here if
> that would be the case.

Note when I add a 1024 DH parameter to the certificate I don't get a
core but when using a 2048 I do get a core.

Cheers

Jean-Frederic

> 
> Comments
> 
> Jean-Frederic
> 
> The stack:
> +++
> (gdb) bt
> #0  0x00007fac11198a98 in raise () from /lib64/libc.so.6
> #1  0x00007fac1119a69a in abort () from /lib64/libc.so.6
> #2  0x00007fac01f27e33 in dummy_init (e=<optimized out>) at e_dummy.c:146
> #3  0x00007fac05a69509 in test_rc4_init_key () from /lib64/libcrypto.so.10
> #4  0x00007fac05b3374c in ?? () from /lib64/libcrypto.so.10
> #5  0x00007fac00000001 in ?? ()
> #6  0x0000000000e37138 in ?? ()
> #7  0x0000000000e62348 in ?? ()
> #8  0x00007fac11d9d68a in apr_pool_cleanup_register (p=0x7fac05a6a122
> <dynamic_ctrl+210>, data=0xfe4678, plain_cleanup_fn=0x1,
> child_cleanup_fn=0x7fac05dab5c0)
>     at memory/unix/apr_pools.c:2218
> #9  0x0000000000f094c0 in ?? ()
> #10 0x00007fac0625bf60 in ?? () from /home/jfclere/APACHE/modules/mod_ssl.so
> #11 0x0000000000e60938 in ?? ()
> #12 0x0000000000e62348 in ?? ()
> #13 0x00007fac05a6ac58 in BUF_memdup () from /lib64/libcrypto.so.10
> #14 0x00007fac06039af2 in ssl_init_Engine (s=0xe60938,
> s@entry=0x7fffb9ad2e90, p=p@entry=0xe37138) at ssl_engine_init.c:386
> #15 0x00007fac0603bdaf in ssl_init_Module (p=0xe37138, plog=<optimized
> out>, ptemp=0xf09780, base_server=0x7fffb9ad2e90) at ssl_engine_init.c:242
> #16 0x0000000000455153 in ap_run_post_config
> (pconf=pconf@entry=0xe37138, plog=0xea0778, ptemp=0xe62348, s=0xe60938)
> at config.c:103
> #17 0x000000000042c575 in main (argc=3, argv=0x7fffb9ad3158) at main.c:788
> +++
> 


From dev-return-85069-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Mon Dec 14 13:42:39 2015
Return-Path: <dev-return-85069-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id CDC4A18F89
	for <apmail-httpd-dev-archive@www.apache.org>; Mon, 14 Dec 2015 13:42:39 +0000 (UTC)
Received: (qmail 76386 invoked by uid 500); 14 Dec 2015 13:42:39 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 76318 invoked by uid 500); 14 Dec 2015 13:42:39 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 76308 invoked by uid 99); 14 Dec 2015 13:42:39 -0000
Received: from Unknown (HELO spamd3-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 14 Dec 2015 13:42:39 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd3-us-west.apache.org (ASF Mail Server at spamd3-us-west.apache.org) with ESMTP id BF75B180455
	for <dev@httpd.apache.org>; Mon, 14 Dec 2015 13:42:38 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd3-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.121
X-Spam-Level:
X-Spam-Status: No, score=-0.121 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RCVD_IN_MSPIKE_H3=-0.01, RCVD_IN_MSPIKE_WL=-0.01, SPF_PASS=-0.001]
	autolearn=disabled
Authentication-Results: spamd3-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-us-west.apache.org ([10.40.0.8])
	by localhost (spamd3-us-west.apache.org [10.40.0.10]) (amavisd-new, port 10024)
	with ESMTP id d3_WAjOU8OhX for <dev@httpd.apache.org>;
	Mon, 14 Dec 2015 13:42:38 +0000 (UTC)
Received: from mail-wm0-f50.google.com (mail-wm0-f50.google.com [74.125.82.50])
	by mx1-us-west.apache.org (ASF Mail Server at mx1-us-west.apache.org) with ESMTPS id D453E251C6
	for <dev@httpd.apache.org>; Mon, 14 Dec 2015 13:42:37 +0000 (UTC)
Received: by wmpp66 with SMTP id p66so61348613wmp.1
        for <dev@httpd.apache.org>; Mon, 14 Dec 2015 05:42:36 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=subject:to:references:cc:from:message-id:date:user-agent
         :mime-version:in-reply-to:content-type:content-transfer-encoding;
        bh=Md0PkASTs4G+lkud9Ac9J0NyaK6vFYetQSWaUBnxFOY=;
        b=pelPV9BC0FJDKC5cQw5lwww9JRnEBkBCPWA9jL8IrBNy0p++Jq6tn0XydoFnAPCt8J
         UrrmOpZmP9WTZmUW2Noe/7BXJJViRKVCgsztJ0tSqAit22AjythBUKs+3hwegZEyZbl4
         fSC/KVCiwkX08ocdkTobXXfdVsxIX+vFuUTYDmOFeHHPT2MiIfdKbfKULyGux0i6eJD+
         MqHQboRxYEyN6fo9Lp5deXXO+DzAYRMDSuHllOqevGdb1kFYHS3IC92CIkz2919iUep9
         PHzaZixN+BLEf7NAK0VAC8ykD2XI/75QIfJNN4pGqwe6Gl8BsVHYFEeDUbJGU0P6wydQ
         jdLQ==
X-Received: by 10.28.134.199 with SMTP id i190mr23925372wmd.33.1450100553513;
        Mon, 14 Dec 2015 05:42:33 -0800 (PST)
Received: from [10.33.144.3] (nat-pool-gva-t.redhat.com. [209.132.186.32])
        by smtp.gmail.com with ESMTPSA id cw3sm29766307wjb.26.2015.12.14.05.42.32
        (version=TLS1_2 cipher=ECDHE-RSA-AES128-GCM-SHA256 bits=128/128);
        Mon, 14 Dec 2015 05:42:32 -0800 (PST)
Subject: Re: Weird behaviour with mod_ssl and SSLCryptoDevice
To: dev@httpd.apache.org
References: <566EC054.2040204@gmail.com>
 <FFEBF534-3FDB-4FEA-8E78-3379AA7BABD3@greenbytes.de>
Cc: Joe Orton <jorton@redhat.com>, mikagott@hotmail.com
From: jean-frederic clere <jfclere@gmail.com>
Message-ID: <566EC748.5060009@gmail.com>
Date: Mon, 14 Dec 2015 14:42:32 +0100
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:38.0) Gecko/20100101
 Thunderbird/38.4.0
MIME-Version: 1.0
In-Reply-To: <FFEBF534-3FDB-4FEA-8E78-3379AA7BABD3@greenbytes.de>
Content-Type: text/plain; charset=windows-1252
Content-Transfer-Encoding: 7bit

On 12/14/2015 02:18 PM, Stefan Eissing wrote:
> You're certain it's only loaded once?

I think the issue is that it is loaded twice :-(

Cheers

Jean-Frederic

> 
>> Am 14.12.2015 um 14:12 schrieb jean-frederic clere <jfclere@gmail.com>:
>>
>> <e_dummy.c>
> 
> 


From dev-return-85070-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Mon Dec 14 17:03:24 2015
Return-Path: <dev-return-85070-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id CFC9E188FB
	for <apmail-httpd-dev-archive@www.apache.org>; Mon, 14 Dec 2015 17:03:24 +0000 (UTC)
Received: (qmail 93162 invoked by uid 500); 14 Dec 2015 17:03:23 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 93090 invoked by uid 500); 14 Dec 2015 17:03:23 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 93080 invoked by uid 99); 14 Dec 2015 17:03:23 -0000
Received: from Unknown (HELO spamd3-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 14 Dec 2015 17:03:23 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd3-us-west.apache.org (ASF Mail Server at spamd3-us-west.apache.org) with ESMTP id 5D345180441
	for <dev@httpd.apache.org>; Mon, 14 Dec 2015 17:03:23 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd3-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.101
X-Spam-Level:
X-Spam-Status: No, score=-0.101 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RCVD_IN_MSPIKE_H2=-0.001, SPF_PASS=-0.001, URIBL_BLOCKED=0.001]
	autolearn=disabled
Authentication-Results: spamd3-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-us-west.apache.org ([10.40.0.8])
	by localhost (spamd3-us-west.apache.org [10.40.0.10]) (amavisd-new, port 10024)
	with ESMTP id 3aD8ersdF-8u for <dev@httpd.apache.org>;
	Mon, 14 Dec 2015 17:03:16 +0000 (UTC)
Received: from mail-qg0-f42.google.com (mail-qg0-f42.google.com [209.85.192.42])
	by mx1-us-west.apache.org (ASF Mail Server at mx1-us-west.apache.org) with ESMTPS id 84B92265DB
	for <dev@httpd.apache.org>; Mon, 14 Dec 2015 17:03:16 +0000 (UTC)
Received: by qgx21 with SMTP id 21so9997487qgx.1
        for <dev@httpd.apache.org>; Mon, 14 Dec 2015 09:03:10 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :cc:content-type;
        bh=pERDWNSR2lXl2epeXLGGUBDwE92Pkn4QYOxrktoVwFo=;
        b=iFwnTDmYt6wazyx0DyZ3IuFqwMntOlPpgbuJkn+gVbi4F9m99xdZvJxniAu/VV9dSw
         WeNnOEsOZv0De8X0uSiZ0vt6u8b9eGyuPnLbNvaETDikENx2wja60fwIfzuvZcByelAI
         I+yKoP5UPZyIbR7LMranuHDEe1fm7KIUihwd2BpB/Nv+nyjhJGWhq/ex3A8guUrlgp+n
         0FRztWTZpHiE706IRFVDW8lGJQdY03j7FzLK3CWeb6KvBztuhwxLkLYUm6cxAXIbiQxI
         9GqFnIwK3VigZpnSo1tUWZ6U2qedGlhDFyx6u+ZXTj1wEkeXbSNiFFYUhRwXP1oPspka
         1+mA==
MIME-Version: 1.0
X-Received: by 10.140.248.70 with SMTP id t67mr36861694qhc.97.1450112590472;
 Mon, 14 Dec 2015 09:03:10 -0800 (PST)
Received: by 10.55.65.85 with HTTP; Mon, 14 Dec 2015 09:03:10 -0800 (PST)
In-Reply-To: <20151214163428.GC9993@laura.suse.cz>
References: <20151214163428.GC9993@laura.suse.cz>
Date: Mon, 14 Dec 2015 18:03:10 +0100
Message-ID: <CAKQ1sVMkqt0Xw1YBmyV6m5ow8cBxOfv9+LKsZzbQDwxnKWpC2g@mail.gmail.com>
Subject: Re: missing semicolon
From: Yann Ylavic <ylavic.dev@gmail.com>
To: Petr Gajdos <pgajdos@suse.cz>
Cc: httpd-dev <dev@httpd.apache.org>
Content-Type: text/plain; charset=UTF-8

On Mon, Dec 14, 2015 at 5:34 PM, Petr Gajdos <pgajdos@suse.cz> wrote:
> Hello Yann,
>
> http://svn.apache.org/viewvc/httpd/httpd/trunk/modules/ssl/ssl_engine_io.c
>
> is missing semicolon in
>
> need_flush = !SSL_is_init_finished(outctx->filter_ctx->pssl)
>
> line. Relevant commit:
>
> http://svn.apache.org/viewvc?view=revision&revision=1707230

Thanks Petr for noticing, looks like no one is testing with OpenSSL <
0.9.8m here...

A simple (obvious) patch would be:

Index: modules/ssl/ssl_engine_io.c
===================================================================
--- modules/ssl/ssl_engine_io.c    (revision 1718739)
+++ modules/ssl/ssl_engine_io.c    (working copy)
@@ -217,7 +217,7 @@ static int bio_filter_out_write(BIO *bio, const ch
      * so limit the performance impact to handshake time.
      */
 #if OPENSSL_VERSION_NUMBER < 0x0009080df
-     need_flush = !SSL_is_init_finished(outctx->filter_ctx->pssl)
+     need_flush = !SSL_is_init_finished(outctx->filter_ctx->pssl);
 #else
      need_flush = SSL_in_connect_init(outctx->filter_ctx->pssl);
 #endif
--


>
> Thanks for 2.4.18.

Unfortunately this won't be fixed for 2.4.18 (being released already),
so I'll propose the patch for 2.4.19.

Regards,
Yann.

From dev-return-85071-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Mon Dec 14 17:30:51 2015
Return-Path: <dev-return-85071-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 5FA9918A3D
	for <apmail-httpd-dev-archive@www.apache.org>; Mon, 14 Dec 2015 17:30:51 +0000 (UTC)
Received: (qmail 78228 invoked by uid 500); 14 Dec 2015 17:30:50 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 78156 invoked by uid 500); 14 Dec 2015 17:30:50 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 78146 invoked by uid 99); 14 Dec 2015 17:30:50 -0000
Received: from Unknown (HELO spamd2-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 14 Dec 2015 17:30:50 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd2-us-west.apache.org (ASF Mail Server at spamd2-us-west.apache.org) with ESMTP id 65D261A0364
	for <dev@httpd.apache.org>; Mon, 14 Dec 2015 17:30:50 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd2-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.099
X-Spam-Level:
X-Spam-Status: No, score=-0.099 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	URIBL_BLOCKED=0.001] autolearn=disabled
Authentication-Results: spamd2-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-us-west.apache.org ([10.40.0.8])
	by localhost (spamd2-us-west.apache.org [10.40.0.9]) (amavisd-new, port 10024)
	with ESMTP id MgBSjBQ_PeWI for <dev@httpd.apache.org>;
	Mon, 14 Dec 2015 17:30:40 +0000 (UTC)
Received: from mail-qg0-f44.google.com (mail-qg0-f44.google.com [209.85.192.44])
	by mx1-us-west.apache.org (ASF Mail Server at mx1-us-west.apache.org) with ESMTPS id F2BEC26AD1
	for <dev@httpd.apache.org>; Mon, 14 Dec 2015 17:30:39 +0000 (UTC)
Received: by qget30 with SMTP id t30so17677207qge.3
        for <dev@httpd.apache.org>; Mon, 14 Dec 2015 09:30:39 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :cc:content-type;
        bh=m6lQ19WtGp1Ud07FI5fW0rGZ3ZSt70P1dci0U/K4JpY=;
        b=Ekrjf+MGqIJ2W4l8EjxdPnf1JhiKx9sk80e0X3L0gQ/Fz4edusD0IcAfGjl8fQC2sN
         sqDP1eVIUx3JFHDufHjx9XeDRhakpNwI5MdOvI41TvfS/cDhZWd5Vk8PLFuG9oDZ9Xtq
         xN1vaUP/i2BBR/XuLmEzQo88bAlhREidL/AsBWtk+ZpIFFyWJ3+ni7bunJfWB3xo0sS4
         Tv4C21QGs7IFWc0AwdTgPus9aVJvwCIC1teIK/rwV5W0Mle7T4vxGILupEOBe8l/1bd1
         a4c3eGKwbZY3unHRg6M4qTwO6dn1DAe8M6fAYl+9lbqItsNJrOCZKCKWbu/DpqVyzJqQ
         92ig==
MIME-Version: 1.0
X-Received: by 10.140.88.51 with SMTP id s48mr20890287qgd.48.1450114239033;
 Mon, 14 Dec 2015 09:30:39 -0800 (PST)
Received: by 10.55.122.6 with HTTP; Mon, 14 Dec 2015 09:30:38 -0800 (PST)
In-Reply-To: <CAKQ1sVMkqt0Xw1YBmyV6m5ow8cBxOfv9+LKsZzbQDwxnKWpC2g@mail.gmail.com>
References: <20151214163428.GC9993@laura.suse.cz>
	<CAKQ1sVMkqt0Xw1YBmyV6m5ow8cBxOfv9+LKsZzbQDwxnKWpC2g@mail.gmail.com>
Date: Mon, 14 Dec 2015 18:30:38 +0100
Message-ID: <CAKQ1sVPNc5x1qUctG000QU8W+cj3PRe8yaXNXcR-=XuUjXtUfA@mail.gmail.com>
Subject: Re: missing semicolon
From: Yann Ylavic <ylavic.dev@gmail.com>
To: Petr Gajdos <pgajdos@suse.cz>
Cc: httpd-dev <dev@httpd.apache.org>
Content-Type: text/plain; charset=UTF-8

On Mon, Dec 14, 2015 at 6:03 PM, Yann Ylavic <ylavic.dev@gmail.com> wrote:
> On Mon, Dec 14, 2015 at 5:34 PM, Petr Gajdos <pgajdos@suse.cz> wrote:
>
> A simple (obvious) patch would be:

Commited in http://svn.apache.org/r1719967
Proposed for backport to 2.4.19.

Thanks again Petr.

From dev-return-85072-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Mon Dec 14 18:15:49 2015
Return-Path: <dev-return-85072-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id CC14F18CC4
	for <apmail-httpd-dev-archive@www.apache.org>; Mon, 14 Dec 2015 18:15:48 +0000 (UTC)
Received: (qmail 4455 invoked by uid 500); 14 Dec 2015 18:15:47 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 4385 invoked by uid 500); 14 Dec 2015 18:15:47 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 4372 invoked by uid 99); 14 Dec 2015 18:15:47 -0000
Received: from Unknown (HELO spamd1-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 14 Dec 2015 18:15:47 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd1-us-west.apache.org (ASF Mail Server at spamd1-us-west.apache.org) with ESMTP id E9594C1A7A
	for <dev@httpd.apache.org>; Mon, 14 Dec 2015 18:15:46 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd1-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 2.999
X-Spam-Level: **
X-Spam-Status: No, score=2.999 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, HTML_MESSAGE=3,
	RCVD_IN_MSPIKE_H2=-0.001, SPF_PASS=-0.001, URIBL_BLOCKED=0.001]
	autolearn=disabled
Authentication-Results: spamd1-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=rowe-clan-net.20150623.gappssmtp.com
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd1-us-west.apache.org [10.40.0.7]) (amavisd-new, port 10024)
	with ESMTP id RpNKMhhOVJ7x for <dev@httpd.apache.org>;
	Mon, 14 Dec 2015 18:15:40 +0000 (UTC)
Received: from mail-io0-f170.google.com (mail-io0-f170.google.com [209.85.223.170])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id 093C1439BF
	for <dev@httpd.apache.org>; Mon, 14 Dec 2015 18:15:39 +0000 (UTC)
Received: by iow186 with SMTP id 186so35223065iow.0
        for <dev@httpd.apache.org>; Mon, 14 Dec 2015 10:15:39 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=rowe-clan-net.20150623.gappssmtp.com; s=20150623;
        h=mime-version:date:message-id:subject:from:to:content-type;
        bh=i/fKYqizFQs2fmTIJywYnkBwg0de02H3xc22tQbCCJc=;
        b=YuKxpcPG51PDVS42LtREJq2TEI438jHIYKvDPJueHkyNBOOq5KlJMa+JfBewkP55eI
         R2EmBfEodfYXDLqyd/iVGQ2CGYsOWLxXGJIt3T+8wYz72llCWQKqYDtC0/kYnOZDE4nK
         dVfb1I/0zcNGaSsrKSVUpW4VnRY920bChPBps0aTNCkm6ityCQahWeVgox5+zjEHQVHG
         XqWuZU+RERQ2T7AhcrfD0Gj8zAihEPgvN+wrdiTOFFjlw8J+/MbQgD0XeXZ6v5t3neFN
         ZtEyMBsxFl/w4vXBAIWSaEM867ttUhqCUqCUVJ7sqsXAeyxWAxuvjLAr6RVp4rPbuin0
         24pg==
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=1e100.net; s=20130820;
        h=x-gm-message-state:mime-version:date:message-id:subject:from:to
         :content-type;
        bh=i/fKYqizFQs2fmTIJywYnkBwg0de02H3xc22tQbCCJc=;
        b=QIe5wRDjecBmfre/cbCVV2r3bb55WrA+0gkURw7TqzA6lTNIZ+c6k1nysTglJsc8AU
         mZU61NahhJxGoUcFBJRlc6CQt5xB72KyEpsiJ2slU6MHE6XpVxY2dh7BPikKpwzh0cCn
         OF6bT3236Q7zC5kUhOHjYFUmuSxTnjxjvSBN+cjDiXK3Wo8EoCPRAETQF8YtjrLk+n+V
         rExMA1KN5xyPgGZcla8xmtkiQsfWUixT0ozvHfmwUYX++50ih9201R0e+8A+CstsaEGr
         ObSauhuEusY2FaDN0SOnje4QeqHVnEyiPXVPxkeTEFuwA/jWa9/z/C5o8JFwgqHFlhbK
         LSjw==
X-Gm-Message-State: ALoCoQkrfX+uK4tWvfyFBFob7HZCEkScCHYzGirVbsgOJsSgSs3tXTpwf2uSnZauYdP9e+rzUR7VIKzW8sBT/gJCkckSxhq65yb98wO0NvscB/h8SjzpCH0=
MIME-Version: 1.0
X-Received: by 10.107.27.6 with SMTP id b6mr5636566iob.163.1450116939527; Mon,
 14 Dec 2015 10:15:39 -0800 (PST)
Received: by 10.107.62.136 with HTTP; Mon, 14 Dec 2015 10:15:39 -0800 (PST)
Date: Mon, 14 Dec 2015 12:15:39 -0600
Message-ID: <CACsi253tpu-76tEXCizdgjWPmt9sfjSycuVNXDiefnBmOOnDmA@mail.gmail.com>
Subject: OpenSSL 0.9.8/1.0.0 on Trunk
From: William A Rowe Jr <wrowe@rowe-clan.net>
To: httpd <dev@httpd.apache.org>
Content-Type: multipart/alternative; boundary=001a113fee4410556c0526dfa9c8

--001a113fee4410556c0526dfa9c8
Content-Type: text/plain; charset=UTF-8

W.r.t. http://svn.apache.org/r1719967 - I'm +1 for the backport.
I'd like to propose we remove all support from *trunk* for OpenSSL < 1.0.1
effective now...

https://mta.openssl.org/pipermail/openssl-announce/2014-December/000000.html

We don't deprecate support on maintenance branches (e.g. 2.2/2.4),
because we seek to minimize the pain of moving from one subversion
release to another.  If someone wanted to hack a non-fatal warning for
the ./configure phase, that could be a worthwhile patch.

--001a113fee4410556c0526dfa9c8
Content-Type: text/html; charset=UTF-8
Content-Transfer-Encoding: quoted-printable

<div dir=3D"ltr"><div>W.r.t.=C2=A0<a href=3D"http://svn.apache.org/r1719967=
" rel=3D"noreferrer" target=3D"_blank" style=3D"font-size:12.8px">http://sv=
n.apache.org/r1719967</a>=C2=A0- I&#39;m +1 for the backport.</div><div>I&#=
39;d like to propose we remove all support from *trunk* for OpenSSL &lt; 1.=
0.1</div><div>effective now...</div><div><br></div><div><a href=3D"https://=
mta.openssl.org/pipermail/openssl-announce/2014-December/000000.html">https=
://mta.openssl.org/pipermail/openssl-announce/2014-December/000000.html</a>=
<br></div><div><br></div><div>We don&#39;t deprecate support on maintenance=
 branches (e.g. 2.2/2.4),</div><div>because we seek to minimize the pain of=
 moving from one subversion</div><div>release to another.=C2=A0 If someone =
wanted to hack a non-fatal warning for=C2=A0</div><div>the ./configure phas=
e, that could be a worthwhile patch.</div><div><br></div><div><br></div></d=
iv>

--001a113fee4410556c0526dfa9c8--

From dev-return-85073-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Mon Dec 14 18:35:23 2015
Return-Path: <dev-return-85073-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id CD1E718DE9
	for <apmail-httpd-dev-archive@www.apache.org>; Mon, 14 Dec 2015 18:35:23 +0000 (UTC)
Received: (qmail 79039 invoked by uid 500); 14 Dec 2015 18:35:23 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 78951 invoked by uid 500); 14 Dec 2015 18:35:23 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 78942 invoked by uid 99); 14 Dec 2015 18:35:23 -0000
Received: from mail-relay.apache.org (HELO mail-relay.apache.org) (140.211.11.15)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 14 Dec 2015 18:35:23 +0000
Received: from gauss.localdomain (v4-86130565.pool.vitroconnect.de [134.19.5.101])
	by mail-relay.apache.org (ASF Mail Server at mail-relay.apache.org) with ESMTPSA id 092B11A00C5
	for <dev@httpd.apache.org>; Mon, 14 Dec 2015 18:35:22 +0000 (UTC)
Received: from [IPv6:::1] (localhost [IPv6:::1])
	by gauss.localdomain (Postfix) with ESMTP id 1E807179
	for <dev@httpd.apache.org>; Mon, 14 Dec 2015 19:35:22 +0100 (CET)
Subject: Re: OpenSSL 0.9.8/1.0.0 on Trunk
To: dev@httpd.apache.org
References: <CACsi253tpu-76tEXCizdgjWPmt9sfjSycuVNXDiefnBmOOnDmA@mail.gmail.com>
From: Ruediger Pluem <rpluem@apache.org>
Message-ID: <566F0BEA.1040002@apache.org>
Date: Mon, 14 Dec 2015 19:35:22 +0100
User-Agent: Mozilla/5.0 (X11; Linux i686 on x86_64; rv:42.0) Gecko/20100101
 Firefox/42.0 SeaMonkey/2.39
MIME-Version: 1.0
In-Reply-To: <CACsi253tpu-76tEXCizdgjWPmt9sfjSycuVNXDiefnBmOOnDmA@mail.gmail.com>
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 8bit



On 12/14/2015 07:15 PM, William A Rowe Jr wrote:
> W.r.t. http://svn.apache.org/r1719967 - I'm +1 for the backport.
> I'd like to propose we remove all support from *trunk* for OpenSSL < 1.0.1
> effective now...
> 
> https://mta.openssl.org/pipermail/openssl-announce/2014-December/000000.html
> 
> We don't deprecate support on maintenance branches (e.g. 2.2/2.4),
> because we seek to minimize the pain of moving from one subversion
> release to another.  If someone wanted to hack a non-fatal warning for 
> the ./configure phase, that could be a worthwhile patch.
> 
> 

+1

Regards

Rdiger

From dev-return-85074-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Mon Dec 14 20:11:38 2015
Return-Path: <dev-return-85074-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 465D118477
	for <apmail-httpd-dev-archive@www.apache.org>; Mon, 14 Dec 2015 20:11:38 +0000 (UTC)
Received: (qmail 8314 invoked by uid 500); 14 Dec 2015 20:11:37 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 8229 invoked by uid 500); 14 Dec 2015 20:11:37 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 8219 invoked by uid 99); 14 Dec 2015 20:11:37 -0000
Received: from Unknown (HELO spamd4-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 14 Dec 2015 20:11:37 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd4-us-west.apache.org (ASF Mail Server at spamd4-us-west.apache.org) with ESMTP id 3122FC0D00
	for <dev@httpd.apache.org>; Mon, 14 Dec 2015 20:11:37 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd4-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 0.652
X-Spam-Level:
X-Spam-Status: No, score=0.652 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, SPF_NEUTRAL=0.652]
	autolearn=disabled
Authentication-Results: spamd4-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=comcast.net
Received: from mx1-us-west.apache.org ([10.40.0.8])
	by localhost (spamd4-us-west.apache.org [10.40.0.11]) (amavisd-new, port 10024)
	with ESMTP id epcOzGsDveBG for <dev@httpd.apache.org>;
	Mon, 14 Dec 2015 20:11:30 +0000 (UTC)
Received: from resqmta-ch2-08v.sys.comcast.net (resqmta-ch2-08v.sys.comcast.net [69.252.207.40])
	by mx1-us-west.apache.org (ASF Mail Server at mx1-us-west.apache.org) with ESMTPS id 89F2426AD2
	for <dev@httpd.apache.org>; Mon, 14 Dec 2015 20:11:30 +0000 (UTC)
Received: from resomta-ch2-16v.sys.comcast.net ([69.252.207.112])
	by resqmta-ch2-08v.sys.comcast.net with comcast
	id tYAm1r00B2S2Q5R01YBQkA; Mon, 14 Dec 2015 20:11:24 +0000
Received: from [172.25.182.201] ([199.244.219.64])
	by resomta-ch2-16v.sys.comcast.net with comcast
	id tY8U1r00p1Pxlnr01Y9Hxc; Mon, 14 Dec 2015 20:09:22 +0000
From: Jim Jagielski <jim@jaguNET.com>
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
Subject: [ANNOUNCEMENT] Apache HTTP Server 2.4.18 Released
Message-Id: <8041A12E-76B4-406E-B2D2-C15F8BF82EDF@jaguNET.com>
Date: Mon, 14 Dec 2015 15:09:17 -0500
To: httpd <dev@httpd.apache.org>
Mime-Version: 1.0 (Mac OS X Mail 9.2 \(3112\))
X-Mailer: Apple Mail (2.3112)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=comcast.net;
	s=q20140121; t=1450123884;
	bh=taRUPnchg05qDwonsDfdQ7OT5w6H+Zx1LkLoevmVIvs=;
	h=Received:Received:From:Content-Type:Subject:Message-Id:Date:To:
	 Mime-Version;
	b=uodFHzZRFDMFj4uDopCGHYJ/PwT1SMMQHzHzoTc9vnkF3jyXq/AqRRCIdmx91sJIs
	 UMSX/2zz5TzEllHcgA3U+32ffOBZyaRaoZUj+W9XkYwUlEzJfAv1L+i2fQp13rr3kq
	 fcJKYTqG98347jCJwDWrRE1IWmN+QdFd7NCS7XKAlQ5GmToQIKPts4F5LGAnyReEQB
	 AGweVubGhiT67XpuI8C13HSXyTMjiHpiEbY32SqTxvHgmaVBa/JVvPSnKP+LjdlVTR
	 /rRQoYnSK9dslWIfk8ocmLmWR9IhbUvJ8bWdJB91GLoH3MYxYc2H4uv9s1s9Stv1jK
	 f0Kn31qkaP/OQ==

            Apache HTTP Server 2.4.18 Released

The Apache Software Foundation and the Apache HTTP Server Project
are pleased to announce the release of version 2.4.18 of the Apache
HTTP Server ("Apache").  This version of Apache is our latest GA
release of the new generation 2.4.x branch of Apache HTTPD and
represents fifteen years of innovation by the project, and is
recommended over all previous releases. This release of Apache is
principally a feature and bug fix release.

We consider this release to be the best version of Apache available, and
encourage users of all prior versions to upgrade.

Apache HTTP Server 2.4.18 is available for download from:

 http://httpd.apache.org/download.cgi

Apache 2.4 offers numerous enhancements, improvements, and performance
boosts over the 2.2 codebase.  For an overview of new features
introduced since 2.4 please see:

 http://httpd.apache.org/docs/trunk/new_features_2_4.html

Please see the CHANGES_2.4 file, linked from the download page, for a
full list of changes. A condensed list, CHANGES_2.4.18 includes only
those changes introduced since the prior 2.4 release.  A summary of all 
of the security vulnerabilities addressed in this and earlier releases 
is available:

 http://httpd.apache.org/security/vulnerabilities_24.html

This release requires the Apache Portable Runtime (APR) version 1.5.x
and APR-Util version 1.5.x. The APR libraries must be upgraded for all
features of httpd to operate correctly.

This release builds on and extends the Apache 2.2 API.  Modules written
for Apache 2.2 will need to be recompiled in order to run with Apache
2.4, and require minimal or no source code changes.

 http://svn.apache.org/repos/asf/httpd/httpd/trunk/VERSIONING

When upgrading or installing this version of Apache, please bear in mind
that if you intend to use Apache with one of the threaded MPMs (other
than the Prefork MPM), you must ensure that any modules you will be
using (and the libraries they depend on) are thread-safe.


From dev-return-85075-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Tue Dec 15 11:52:07 2015
Return-Path: <dev-return-85075-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 27A3B188D8
	for <apmail-httpd-dev-archive@www.apache.org>; Tue, 15 Dec 2015 11:52:07 +0000 (UTC)
Received: (qmail 14050 invoked by uid 500); 15 Dec 2015 11:52:06 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 13960 invoked by uid 500); 15 Dec 2015 11:52:06 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 13949 invoked by uid 99); 15 Dec 2015 11:52:06 -0000
Received: from Unknown (HELO spamd1-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 15 Dec 2015 11:52:06 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd1-us-west.apache.org (ASF Mail Server at spamd1-us-west.apache.org) with ESMTP id BD91DC3171
	for <dev@httpd.apache.org>; Tue, 15 Dec 2015 11:52:05 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd1-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.031
X-Spam-Level:
X-Spam-Status: No, score=-0.031 tagged_above=-999 required=6.31
	tests=[RCVD_IN_MSPIKE_H3=-0.01, RCVD_IN_MSPIKE_WL=-0.01,
	SPF_HELO_PASS=-0.001, SPF_PASS=-0.001, T_RP_MATCHES_RCVD=-0.01,
	URIBL_BLOCKED=0.001] autolearn=disabled
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd1-us-west.apache.org [10.40.0.7]) (amavisd-new, port 10024)
	with ESMTP id B5cmJWGwsVCb for <dev@httpd.apache.org>;
	Tue, 15 Dec 2015 11:51:58 +0000 (UTC)
Received: from mx1.redhat.com (mx1.redhat.com [209.132.183.28])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id 75A1F206E3
	for <dev@httpd.apache.org>; Tue, 15 Dec 2015 11:51:57 +0000 (UTC)
Received: from int-mx11.intmail.prod.int.phx2.redhat.com (int-mx11.intmail.prod.int.phx2.redhat.com [10.5.11.24])
	by mx1.redhat.com (Postfix) with ESMTPS id 84D2A8F266
	for <dev@httpd.apache.org>; Tue, 15 Dec 2015 11:51:55 +0000 (UTC)
Received: from dhcp-24-191.brq.redhat.com (ovpn-204-34.brq.redhat.com [10.40.204.34])
	by int-mx11.intmail.prod.int.phx2.redhat.com (8.14.4/8.14.4) with ESMTP id tBFBpr6X028536
	for <dev@httpd.apache.org>; Tue, 15 Dec 2015 06:51:54 -0500
Subject: Re: Weird behaviour with mod_ssl and SSLCryptoDevice
To: dev@httpd.apache.org
References: <566EC054.2040204@gmail.com>
From: =?UTF-8?Q?Jan_Kalu=c5=bea?= <jkaluza@redhat.com>
Message-ID: <566FFED9.1090102@redhat.com>
Date: Tue, 15 Dec 2015 12:51:53 +0100
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:38.0) Gecko/20100101
 Thunderbird/38.3.0
MIME-Version: 1.0
In-Reply-To: <566EC054.2040204@gmail.com>
Content-Type: text/plain; charset=utf-8; format=flowed
Content-Transfer-Encoding: 7bit
X-Scanned-By: MIMEDefang 2.68 on 10.5.11.24

On 12/14/2015 02:12 PM, jean-frederic clere wrote:
> Hi,
>
> I am sure I am doing something wrong, but when using a dummy crypto
> device to recreate a customer issue I am getting a similar issue in
> httpd-trunk but I am nearly sure someone would have complained here if
> that would be the case.

Hi,

I think I've just fixed that in <http://svn.apache.org/r1720129>. I will 
also propose that for 2.4.x and 2.2.x.

Regards,
Jan Kaluza

> Comments
>
> Jean-Frederic
>
> The stack:
> +++
> (gdb) bt
> #0  0x00007fac11198a98 in raise () from /lib64/libc.so.6
> #1  0x00007fac1119a69a in abort () from /lib64/libc.so.6
> #2  0x00007fac01f27e33 in dummy_init (e=<optimized out>) at e_dummy.c:146
> #3  0x00007fac05a69509 in test_rc4_init_key () from /lib64/libcrypto.so.10
> #4  0x00007fac05b3374c in ?? () from /lib64/libcrypto.so.10
> #5  0x00007fac00000001 in ?? ()
> #6  0x0000000000e37138 in ?? ()
> #7  0x0000000000e62348 in ?? ()
> #8  0x00007fac11d9d68a in apr_pool_cleanup_register (p=0x7fac05a6a122
> <dynamic_ctrl+210>, data=0xfe4678, plain_cleanup_fn=0x1,
> child_cleanup_fn=0x7fac05dab5c0)
>      at memory/unix/apr_pools.c:2218
> #9  0x0000000000f094c0 in ?? ()
> #10 0x00007fac0625bf60 in ?? () from /home/jfclere/APACHE/modules/mod_ssl.so
> #11 0x0000000000e60938 in ?? ()
> #12 0x0000000000e62348 in ?? ()
> #13 0x00007fac05a6ac58 in BUF_memdup () from /lib64/libcrypto.so.10
> #14 0x00007fac06039af2 in ssl_init_Engine (s=0xe60938,
> s@entry=0x7fffb9ad2e90, p=p@entry=0xe37138) at ssl_engine_init.c:386
> #15 0x00007fac0603bdaf in ssl_init_Module (p=0xe37138, plog=<optimized
> out>, ptemp=0xf09780, base_server=0x7fffb9ad2e90) at ssl_engine_init.c:242
> #16 0x0000000000455153 in ap_run_post_config
> (pconf=pconf@entry=0xe37138, plog=0xea0778, ptemp=0xe62348, s=0xe60938)
> at config.c:103
> #17 0x000000000042c575 in main (argc=3, argv=0x7fffb9ad3158) at main.c:788
> +++
>


From dev-return-85076-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Tue Dec 15 13:16:44 2015
Return-Path: <dev-return-85076-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id D3DFD18BC7
	for <apmail-httpd-dev-archive@www.apache.org>; Tue, 15 Dec 2015 13:16:44 +0000 (UTC)
Received: (qmail 60206 invoked by uid 500); 15 Dec 2015 13:16:44 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 60138 invoked by uid 500); 15 Dec 2015 13:16:44 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 60128 invoked by uid 99); 15 Dec 2015 13:16:44 -0000
Received: from Unknown (HELO spamd3-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 15 Dec 2015 13:16:44 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd3-us-west.apache.org (ASF Mail Server at spamd3-us-west.apache.org) with ESMTP id 50C2F180441
	for <dev@httpd.apache.org>; Tue, 15 Dec 2015 13:16:42 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd3-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.102
X-Spam-Level:
X-Spam-Status: No, score=-0.102 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RCVD_IN_MSPIKE_H2=-0.001, SPF_PASS=-0.001] autolearn=disabled
Authentication-Results: spamd3-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd3-us-west.apache.org [10.40.0.10]) (amavisd-new, port 10024)
	with ESMTP id 4gJw35xx28VA for <dev@httpd.apache.org>;
	Tue, 15 Dec 2015 13:16:41 +0000 (UTC)
Received: from mail-qg0-f46.google.com (mail-qg0-f46.google.com [209.85.192.46])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id 09700206E3
	for <dev@httpd.apache.org>; Tue, 15 Dec 2015 13:16:41 +0000 (UTC)
Received: by mail-qg0-f46.google.com with SMTP id 103so5959459qgi.3
        for <dev@httpd.apache.org>; Tue, 15 Dec 2015 05:16:40 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type:content-transfer-encoding;
        bh=I9v2J+ql8QW0zrZBRJU8qL8Nx5EFyWt7WbPUVzD+vd4=;
        b=ORRa9Ps0lmn/2j6D3G9CsA81no9Vr851xctKrAdGZkxjcn+5IsyMFB/j4/s78/Ub7w
         je8sUi4TMaNQziznNvECP+MaOe2PoRNJsNtF0KZn+Ka32dNbdDHcomedj2FIdmGrexhK
         IFZBySd+aFFsOxZLCbyQfaVlGA1ugLEvmS93reQfOiV3PMcipNW+GVXOmwx1qGNX74bo
         Dtjcz4afG7/9++YzpABkhDNwgmiwRfNyd0jk9qesxcI37Yw+uTlWqvqNGyxNNkTo5Mcp
         D2/IVP1YP6WxAva7mPK0dTJ8EUtZ5i3Pq9XZzkO8q9Oj0VLvpo0wuBYYbWaTm/MisCTB
         CLdg==
MIME-Version: 1.0
X-Received: by 10.140.92.35 with SMTP id a32mr17372476qge.92.1450185400102;
 Tue, 15 Dec 2015 05:16:40 -0800 (PST)
Received: by 10.55.65.85 with HTTP; Tue, 15 Dec 2015 05:16:40 -0800 (PST)
In-Reply-To: <566FFED9.1090102@redhat.com>
References: <566EC054.2040204@gmail.com>
	<566FFED9.1090102@redhat.com>
Date: Tue, 15 Dec 2015 14:16:40 +0100
Message-ID: <CAKQ1sVPOVLXs8UGvFzU2Bv4xX=7OFLi4zTu0wsan7W=TcjoLGw@mail.gmail.com>
Subject: Re: Weird behaviour with mod_ssl and SSLCryptoDevice
From: Yann Ylavic <ylavic.dev@gmail.com>
To: httpd-dev <dev@httpd.apache.org>
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: quoted-printable

Hi Jan,

On Tue, Dec 15, 2015 at 12:51 PM, Jan Kalu=C5=BEa <jkaluza@redhat.com> wrot=
e:
>
> I think I've just fixed that in <http://svn.apache.org/r1720129>. I will
> also propose that for 2.4.x and 2.2.x.

Shouldn't we do the same for ecparams below?

Regards,
Yann.

From dev-return-85077-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Tue Dec 15 14:16:33 2015
Return-Path: <dev-return-85077-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 05A1318DF8
	for <apmail-httpd-dev-archive@www.apache.org>; Tue, 15 Dec 2015 14:16:33 +0000 (UTC)
Received: (qmail 67365 invoked by uid 500); 15 Dec 2015 14:16:32 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 67274 invoked by uid 500); 15 Dec 2015 14:16:32 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 67262 invoked by uid 99); 15 Dec 2015 14:16:32 -0000
Received: from Unknown (HELO spamd3-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 15 Dec 2015 14:16:32 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd3-us-west.apache.org (ASF Mail Server at spamd3-us-west.apache.org) with ESMTP id AA5851804BE
	for <dev@httpd.apache.org>; Tue, 15 Dec 2015 14:16:31 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd3-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.576
X-Spam-Level:
X-Spam-Status: No, score=-0.576 tagged_above=-999 required=6.31
	tests=[RCVD_IN_MSPIKE_H3=-0.01, RCVD_IN_MSPIKE_WL=-0.01,
	RP_MATCHES_RCVD=-0.554, SPF_HELO_PASS=-0.001, SPF_PASS=-0.001]
	autolearn=disabled
Received: from mx1-us-west.apache.org ([10.40.0.8])
	by localhost (spamd3-us-west.apache.org [10.40.0.10]) (amavisd-new, port 10024)
	with ESMTP id WEZTeGkU9en0 for <dev@httpd.apache.org>;
	Tue, 15 Dec 2015 14:16:31 +0000 (UTC)
Received: from mx1.redhat.com (mx1.redhat.com [209.132.183.28])
	by mx1-us-west.apache.org (ASF Mail Server at mx1-us-west.apache.org) with ESMTPS id E53C22016B
	for <dev@httpd.apache.org>; Tue, 15 Dec 2015 14:16:30 +0000 (UTC)
Received: from int-mx11.intmail.prod.int.phx2.redhat.com (int-mx11.intmail.prod.int.phx2.redhat.com [10.5.11.24])
	by mx1.redhat.com (Postfix) with ESMTPS id 555B8263C
	for <dev@httpd.apache.org>; Tue, 15 Dec 2015 14:16:24 +0000 (UTC)
Received: from dhcp-24-191.brq.redhat.com (ovpn-204-34.brq.redhat.com [10.40.204.34])
	by int-mx11.intmail.prod.int.phx2.redhat.com (8.14.4/8.14.4) with ESMTP id tBFEGMna029837
	for <dev@httpd.apache.org>; Tue, 15 Dec 2015 09:16:23 -0500
Subject: Re: Weird behaviour with mod_ssl and SSLCryptoDevice
To: dev@httpd.apache.org
References: <566EC054.2040204@gmail.com> <566FFED9.1090102@redhat.com>
 <CAKQ1sVPOVLXs8UGvFzU2Bv4xX=7OFLi4zTu0wsan7W=TcjoLGw@mail.gmail.com>
From: =?UTF-8?Q?Jan_Kalu=c5=bea?= <jkaluza@redhat.com>
Message-ID: <567020B6.5010007@redhat.com>
Date: Tue, 15 Dec 2015 15:16:22 +0100
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:38.0) Gecko/20100101
 Thunderbird/38.3.0
MIME-Version: 1.0
In-Reply-To: <CAKQ1sVPOVLXs8UGvFzU2Bv4xX=7OFLi4zTu0wsan7W=TcjoLGw@mail.gmail.com>
Content-Type: text/plain; charset=utf-8; format=flowed
Content-Transfer-Encoding: 8bit
X-Scanned-By: MIMEDefang 2.68 on 10.5.11.24

On 12/15/2015 02:16 PM, Yann Ylavic wrote:
> Hi Jan,
>
> On Tue, Dec 15, 2015 at 12:51 PM, Jan Kalua <jkaluza@redhat.com> wrote:
>>
>> I think I've just fixed that in <http://svn.apache.org/r1720129>. I will
>> also propose that for 2.4.x and 2.2.x.
>
> Shouldn't we do the same for ecparams below?

Probably yes, I was just checking the arguments which get passed to 
"SSL_CTX_set_*" functions. I think you are right we should call 
EC_GROUP_free there.

Jan Kaluza

> Regards,
> Yann.
>


From dev-return-85078-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Tue Dec 15 15:07:42 2015
Return-Path: <dev-return-85078-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 980C118FC3
	for <apmail-httpd-dev-archive@www.apache.org>; Tue, 15 Dec 2015 15:07:42 +0000 (UTC)
Received: (qmail 78698 invoked by uid 500); 15 Dec 2015 15:07:42 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 78625 invoked by uid 500); 15 Dec 2015 15:07:41 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 78615 invoked by uid 99); 15 Dec 2015 15:07:41 -0000
Received: from Unknown (HELO spamd1-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 15 Dec 2015 15:07:41 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd1-us-west.apache.org (ASF Mail Server at spamd1-us-west.apache.org) with ESMTP id 70067C32EE
	for <dev@httpd.apache.org>; Tue, 15 Dec 2015 15:07:41 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd1-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 2.981
X-Spam-Level: **
X-Spam-Status: No, score=2.981 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, HTML_MESSAGE=3,
	RCVD_IN_MSPIKE_H3=-0.01, RCVD_IN_MSPIKE_WL=-0.01, URIBL_BLOCKED=0.001]
	autolearn=disabled
Authentication-Results: spamd1-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=rowe-clan-net.20150623.gappssmtp.com
Received: from mx1-us-west.apache.org ([10.40.0.8])
	by localhost (spamd1-us-west.apache.org [10.40.0.7]) (amavisd-new, port 10024)
	with ESMTP id F96CygRealAV for <dev@httpd.apache.org>;
	Tue, 15 Dec 2015 15:07:31 +0000 (UTC)
Received: from mail-ig0-f182.google.com (mail-ig0-f182.google.com [209.85.213.182])
	by mx1-us-west.apache.org (ASF Mail Server at mx1-us-west.apache.org) with ESMTPS id E00D926AD3
	for <dev@httpd.apache.org>; Tue, 15 Dec 2015 15:07:30 +0000 (UTC)
Received: by mail-ig0-f182.google.com with SMTP id ph11so110115678igc.1
        for <dev@httpd.apache.org>; Tue, 15 Dec 2015 07:07:30 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=rowe-clan-net.20150623.gappssmtp.com; s=20150623;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        bh=3Dwh4GvANzW2x69fOqG6/3wCqUNMYKljHgGvI2elgsI=;
        b=W1P+V+Cr5eWr4RuuRaOIO0Yhkll20eeGjk7/wMZh73mCzcMWKUgsEJurPVJabwGd0z
         p4dEeYDkCmskoQTn94oIreDbIKNVN8bnSWq7zpzxEBvt10lAQ9aCRUj8mw8tOvxD+ZK4
         Q+bHZ9MupxKBXfrq/raQNJ46cZLNJIuytNMyPGKDDbNyKzw5Y/lQvEgOCU6rQnB9JQHM
         2bvHNNxWmRO24u4HfX79k74TxNUG93FGWxTIpWuoXcEGc/Zm2i0suPluVRJJ7qSWSPc+
         yguWaabyv1/tCgUMfD1eMTmCZ3eKgzN3jELjLp5zndm10/Mw9NWUOKcSmNuxo6NkZje2
         +7Eg==
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=1e100.net; s=20130820;
        h=x-gm-message-state:mime-version:in-reply-to:references:date
         :message-id:subject:from:to:content-type;
        bh=3Dwh4GvANzW2x69fOqG6/3wCqUNMYKljHgGvI2elgsI=;
        b=QcfxwGg/QGJ5w0aKntqTZhMMoAJRI0pDt6BndS760XwSClatGlZO0DwwZmBdM+3fHj
         UF/fyhK5D+bjcB21xIxcLn/9wNE9An/fwxN5tTIX+DLHISxUB4FuFWdotl0981fwlepa
         IfL4R5AnPAyhXoHLoBeRsusMb4c5tthIugTvj0Q2QKpnNGn0ZDpozvS8YvovFwBcYdrt
         +l3vDQK+VT+mlYiNsBEYMV1BwgVlKZ9Q464OX9MjESI7AsBqb0QC+wOGydsQNCM7/1H5
         Z6AyWxQaxhIJig2ffaLwKG4mYqGpNPgMJY5IKdwypn1OkzNSX7IZgE+vjHPHSG+GjlXZ
         dB7g==
X-Gm-Message-State: ALoCoQmGEkVQb3E6pBxisK47op8znAGd9K3L/sM6ExFBdiGLm8P1cAG06mgeuYC3/CUowNmGs/4ypeqj17d04PK2NE0Fi6BclnDveCb0hzWu7FYKDs4K72U=
MIME-Version: 1.0
X-Received: by 10.50.20.163 with SMTP id o3mr4668783ige.35.1450192050062; Tue,
 15 Dec 2015 07:07:30 -0800 (PST)
Received: by 10.107.62.136 with HTTP; Tue, 15 Dec 2015 07:07:30 -0800 (PST)
Received: by 10.107.62.136 with HTTP; Tue, 15 Dec 2015 07:07:30 -0800 (PST)
In-Reply-To: <566F0BEA.1040002@apache.org>
References: <CACsi253tpu-76tEXCizdgjWPmt9sfjSycuVNXDiefnBmOOnDmA@mail.gmail.com>
	<566F0BEA.1040002@apache.org>
Date: Tue, 15 Dec 2015 09:07:30 -0600
Message-ID: <CACsi2503h1Bx+r8AZQykS04fQcxQCoV-40RRJhLLe7MSU6UTLA@mail.gmail.com>
Subject: Re: OpenSSL 0.9.8/1.0.0 on Trunk
From: William A Rowe Jr <wrowe@rowe-clan.net>
To: httpd <dev@httpd.apache.org>
Content-Type: multipart/alternative; boundary=047d7bd75dec0030280526f12660

--047d7bd75dec0030280526f12660
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: quoted-printable

As an alternative, we can flag removing pre openssl 1.0.1 support as a
showstopper in STATUS and leave it be for a while longer to make backports
a bit easier.  Thoughts?
On Dec 14, 2015 12:35, "Ruediger Pluem" <rpluem@apache.org> wrote:

>
>
> On 12/14/2015 07:15 PM, William A Rowe Jr wrote:
> > W.r.t. http://svn.apache.org/r1719967 - I'm +1 for the backport.
> > I'd like to propose we remove all support from *trunk* for OpenSSL <
> 1.0.1
> > effective now...
> >
> >
> https://mta.openssl.org/pipermail/openssl-announce/2014-December/000000.h=
tml
> >
> > We don't deprecate support on maintenance branches (e.g. 2.2/2.4),
> > because we seek to minimize the pain of moving from one subversion
> > release to another.  If someone wanted to hack a non-fatal warning for
> > the ./configure phase, that could be a worthwhile patch.
> >
> >
>
> +1
>
> Regards
>
> R=C3=BCdiger
>

--047d7bd75dec0030280526f12660
Content-Type: text/html; charset=UTF-8
Content-Transfer-Encoding: quoted-printable

<p dir=3D"ltr">As an alternative, we can flag removing pre openssl 1.0.1 su=
pport as a showstopper in STATUS and leave it be for a while longer to make=
 backports a bit easier.=C2=A0 Thoughts?<br>
</p>
<div class=3D"gmail_quote">On Dec 14, 2015 12:35, &quot;Ruediger Pluem&quot=
; &lt;<a href=3D"mailto:rpluem@apache.org">rpluem@apache.org</a>&gt; wrote:=
<br type=3D"attribution"><blockquote class=3D"gmail_quote" style=3D"margin:=
0 0 0 .8ex;border-left:1px #ccc solid;padding-left:1ex"><br>
<br>
On 12/14/2015 07:15 PM, William A Rowe Jr wrote:<br>
&gt; W.r.t. <a href=3D"http://svn.apache.org/r1719967" rel=3D"noreferrer" t=
arget=3D"_blank">http://svn.apache.org/r1719967</a> - I&#39;m +1 for the ba=
ckport.<br>
&gt; I&#39;d like to propose we remove all support from *trunk* for OpenSSL=
 &lt; 1.0.1<br>
&gt; effective now...<br>
&gt;<br>
&gt; <a href=3D"https://mta.openssl.org/pipermail/openssl-announce/2014-Dec=
ember/000000.html" rel=3D"noreferrer" target=3D"_blank">https://mta.openssl=
.org/pipermail/openssl-announce/2014-December/000000.html</a><br>
&gt;<br>
&gt; We don&#39;t deprecate support on maintenance branches (e.g. 2.2/2.4),=
<br>
&gt; because we seek to minimize the pain of moving from one subversion<br>
&gt; release to another.=C2=A0 If someone wanted to hack a non-fatal warnin=
g for<br>
&gt; the ./configure phase, that could be a worthwhile patch.<br>
&gt;<br>
&gt;<br>
<br>
+1<br>
<br>
Regards<br>
<br>
R=C3=BCdiger<br>
</blockquote></div>

--047d7bd75dec0030280526f12660--

From dev-return-85079-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Tue Dec 15 15:44:39 2015
Return-Path: <dev-return-85079-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 7663818156
	for <apmail-httpd-dev-archive@www.apache.org>; Tue, 15 Dec 2015 15:44:39 +0000 (UTC)
Received: (qmail 74608 invoked by uid 500); 15 Dec 2015 15:44:39 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 74528 invoked by uid 500); 15 Dec 2015 15:44:38 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 74518 invoked by uid 99); 15 Dec 2015 15:44:38 -0000
Received: from Unknown (HELO spamd4-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 15 Dec 2015 15:44:38 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd4-us-west.apache.org (ASF Mail Server at spamd4-us-west.apache.org) with ESMTP id 6D8A2C0D43
	for <dev@httpd.apache.org>; Tue, 15 Dec 2015 15:44:38 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd4-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.655
X-Spam-Level:
X-Spam-Status: No, score=-0.655 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RP_MATCHES_RCVD=-0.554, SPF_PASS=-0.001] autolearn=disabled
Authentication-Results: spamd4-us-west.apache.org (amavisd-new);
	dkim=pass (1024-bit key) header.d=greenbytes.de header.b=llclIyUs;
	dkim=pass (1024-bit key) header.d=greenbytes.de header.b=llclIyUs
Received: from mx1-us-west.apache.org ([10.40.0.8])
	by localhost (spamd4-us-west.apache.org [10.40.0.11]) (amavisd-new, port 10024)
	with ESMTP id VVEJDgCzYa3a for <dev@httpd.apache.org>;
	Tue, 15 Dec 2015 15:44:36 +0000 (UTC)
Received: from mail.greenbytes.de (mail.greenbytes.de [217.91.35.233])
	by mx1-us-west.apache.org (ASF Mail Server at mx1-us-west.apache.org) with ESMTPS id 4080F2673A
	for <dev@httpd.apache.org>; Tue, 15 Dec 2015 15:44:36 +0000 (UTC)
Received: by mail.greenbytes.de (Postfix, from userid 117)
	id 5C94915A08FC; Tue, 15 Dec 2015 16:44:28 +0100 (CET)
DKIM-Signature: v=1; a=rsa-sha256; c=simple/simple; d=greenbytes.de; s=mail;
	t=1450194268; bh=4u/Y5XhVDaNWnMWqiOMxCfyMEgKwiQgZt6PH7Cvl69c=;
	h=From:Subject:Date:To:From;
	b=llclIyUs81skLvkvQMqxhEUJXre/CrsyQzET4PonaEoOveLO8EW4IVGh2FXCgq3Me
	 hwBvv+rG55u9EeJXFf2mrY1qmfuFi1DxhorMM+EKQ5rWEJI8XAsFmWwcnZBMRXE75T
	 cVOSoeZ+Iie1mTfpEdst/H8YTCJ0QcfDuGqCFirQ=
Received: from [192.168.1.150] (unknown [217.91.35.233])
	(using TLSv1 with cipher ECDHE-RSA-AES256-SHA (256/256 bits))
	(Client did not present a certificate)
	by mail.greenbytes.de (Postfix) with ESMTPSA id 2E17015A01A8
	for <dev@httpd.apache.org>; Tue, 15 Dec 2015 16:44:28 +0100 (CET)
DKIM-Signature: v=1; a=rsa-sha256; c=simple/simple; d=greenbytes.de; s=mail;
	t=1450194268; bh=4u/Y5XhVDaNWnMWqiOMxCfyMEgKwiQgZt6PH7Cvl69c=;
	h=From:Subject:Date:To:From;
	b=llclIyUs81skLvkvQMqxhEUJXre/CrsyQzET4PonaEoOveLO8EW4IVGh2FXCgq3Me
	 hwBvv+rG55u9EeJXFf2mrY1qmfuFi1DxhorMM+EKQ5rWEJI8XAsFmWwcnZBMRXE75T
	 cVOSoeZ+Iie1mTfpEdst/H8YTCJ0QcfDuGqCFirQ=
From: Stefan Eissing <stefan.eissing@greenbytes.de>
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: quoted-printable
Subject: async mpms + http2
Message-Id: <703ED97E-4B43-4AC1-94B1-2BB55893DBAC@greenbytes.de>
Date: Tue, 15 Dec 2015 16:44:27 +0100
To: dev@httpd.apache.org
Mime-Version: 1.0 (Mac OS X Mail 9.2 \(3112\))
X-Mailer: Apple Mail (2.3112)

I just committed a change in mod_http2 that will return idle connections =
back to the mpm, expecting to be invoked again when new data arrives. I =
learned quite something about event (have not looked much at motorz yet) =
and am thinking about improvements. If knowledgeable people could give =
me a hand here, I'd highly appreciate it.

Observation 1: mapping conn_states
  As I understand it, the connection state model, as defined in =
conn_state_e, enables asynchronous processing in two states:
  a. CONN_STATE_CHECK_REQUEST_LINE_READABLE, check read, invoke =
ap_run_process_connection() on data
  b. CONN_STATE_WRITE_COMPLETION, check write, if data is still in out =
filters

  An invocation of ap_run_process_connection() is expected to return, =
usually in WRITE_COMPLETION state. Then any data is attempted to be =
written. When this succeeds, the next state depends on secondary flags =
such as c->aborted, c->keepalive and c->data_in_input_filters.

  HTTP/2 processing has one state where it fits into this model: when no =
more streams are open. This is what is currently implemented in trunk.=20=


  However, there is another state in HTTP/2 processing, where a =
BLOCK_READ is performed: flow control on streaming out responses. =
Basically, the client has a window of n bytes, the server sends n =
response bytes and then needs to wait for the client to increase the =
window again. This would be a good time to resume processing back to the =
mpm, and initially I did so. But that breaks under load.

  Under load, the event mpm feels free to close connections in certain =
states - I think CONN_STATE_CHECK_REQUEST_LINE_READABLE. That is fine =
for a HTTP/1 connection as it always is between requests here. But =
HTTP/2 would also like to use read events, but unloading a child by =
closing such connections is not the right thing to do.

  Is there a way mod_http2 can achieve this or do we need another flag =
in conn_rec/cs?

Observation 2: controlled close
  HTTP/2 would like to send out a last frame when closing a connection =
in a controlled/timeout way. Do we need another hook for that? Something =
like "pre_close_connection"?
=20
Observation 3: timeouts
  a. If admins would like to have another Timeout for HTTP/2 =
connections, they are currently stuck with configuring one Timeout which =
goes to server_rec->timeout, right? For idle connections, clients =
already try to keep it open longer. It would be nice to give admins a =
choice here for different values based on the selected protocol. How to =
best do this?

  b. Handling own timeouts: if I want, during processing the connection, =
a different socket timeout, I can just set it using =
apr_socket_timeout_set()? Shall I restore it back to server->timeout =
before returning?

  c. What would be the best way to wait for a file description *and* =
conditional event simultaneously? mod_http2 has now a sort of pool loop =
with double backup timer for situations where it needs to watch both =
client and backend processes.


Cheers,

  Stefan






From dev-return-85080-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Tue Dec 15 15:57:58 2015
Return-Path: <dev-return-85080-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 9737718213
	for <apmail-httpd-dev-archive@www.apache.org>; Tue, 15 Dec 2015 15:57:58 +0000 (UTC)
Received: (qmail 17551 invoked by uid 500); 15 Dec 2015 15:57:58 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 17478 invoked by uid 500); 15 Dec 2015 15:57:58 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 17468 invoked by uid 99); 15 Dec 2015 15:57:58 -0000
Received: from Unknown (HELO spamd1-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 15 Dec 2015 15:57:58 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd1-us-west.apache.org (ASF Mail Server at spamd1-us-west.apache.org) with ESMTP id A92CDC336B
	for <dev@httpd.apache.org>; Tue, 15 Dec 2015 15:57:57 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd1-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.011
X-Spam-Level:
X-Spam-Status: No, score=-0.011 tagged_above=-999 required=6.31
	tests=[RCVD_IN_MSPIKE_H2=-0.001, SPF_PASS=-0.001,
	T_RP_MATCHES_RCVD=-0.01, URIBL_BLOCKED=0.001] autolearn=disabled
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd1-us-west.apache.org [10.40.0.7]) (amavisd-new, port 10024)
	with ESMTP id xYwQrMMx5nLS for <dev@httpd.apache.org>;
	Tue, 15 Dec 2015 15:57:43 +0000 (UTC)
Received: from aserp1040.oracle.com (aserp1040.oracle.com [141.146.126.69])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id 59FDE439B8
	for <dev@httpd.apache.org>; Tue, 15 Dec 2015 15:57:43 +0000 (UTC)
Received: from userv0021.oracle.com (userv0021.oracle.com [156.151.31.71])
	by aserp1040.oracle.com (Sentrion-MTA-4.3.2/Sentrion-MTA-4.3.2) with ESMTP id tBFFvgw5007839
	(version=TLSv1 cipher=DHE-RSA-AES256-SHA bits=256 verify=OK)
	for <dev@httpd.apache.org>; Tue, 15 Dec 2015 15:57:42 GMT
Received: from userv0121.oracle.com (userv0121.oracle.com [156.151.31.72])
	by userv0021.oracle.com (8.13.8/8.13.8) with ESMTP id tBFFvfpG005443
	(version=TLSv1/SSLv3 cipher=DHE-RSA-AES256-SHA bits=256 verify=FAIL)
	for <dev@httpd.apache.org>; Tue, 15 Dec 2015 15:57:41 GMT
Received: from abhmp0009.oracle.com (abhmp0009.oracle.com [141.146.116.15])
	by userv0121.oracle.com (8.13.8/8.13.8) with ESMTP id tBFFvfQT010184
	for <dev@httpd.apache.org>; Tue, 15 Dec 2015 15:57:41 GMT
Received: from [10.132.185.154] (/10.132.185.154)
	by default (Oracle Beehive Gateway v4.0)
	with ESMTP ; Tue, 15 Dec 2015 07:57:41 -0800
Subject: Re: OpenSSL 0.9.8/1.0.0 on Trunk
To: dev@httpd.apache.org
References: <CACsi253tpu-76tEXCizdgjWPmt9sfjSycuVNXDiefnBmOOnDmA@mail.gmail.com>
From: Mike Rumph <mike.rumph@oracle.com>
Organization: Oracle Corporation
Message-ID: <5670386F.5090901@oracle.com>
Date: Tue, 15 Dec 2015 07:57:35 -0800
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:38.0) Gecko/20100101
 Thunderbird/38.4.0
MIME-Version: 1.0
In-Reply-To: <CACsi253tpu-76tEXCizdgjWPmt9sfjSycuVNXDiefnBmOOnDmA@mail.gmail.com>
Content-Type: text/plain; charset=utf-8; format=flowed
Content-Transfer-Encoding: 7bit
X-Source-IP: userv0021.oracle.com [156.151.31.71]

FYI.  Bug 58737 was just opened today for this error.

Thanks,

Mike

On 12/14/2015 10:15 AM, William A Rowe Jr wrote:
> W.r.t. http://svn.apache.org/r1719967 - I'm +1 for the backport.
> I'd like to propose we remove all support from *trunk* for OpenSSL < 1.0.1
> effective now...
>
> https://mta.openssl.org/pipermail/openssl-announce/2014-December/000000.html
>
> We don't deprecate support on maintenance branches (e.g. 2.2/2.4),
> because we seek to minimize the pain of moving from one subversion
> release to another.  If someone wanted to hack a non-fatal warning for
> the ./configure phase, that could be a worthwhile patch.
>
>


From dev-return-85081-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Tue Dec 15 16:58:54 2015
Return-Path: <dev-return-85081-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 907F71860E
	for <apmail-httpd-dev-archive@www.apache.org>; Tue, 15 Dec 2015 16:58:54 +0000 (UTC)
Received: (qmail 11578 invoked by uid 500); 15 Dec 2015 16:58:54 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 11505 invoked by uid 500); 15 Dec 2015 16:58:54 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 11493 invoked by uid 99); 15 Dec 2015 16:58:54 -0000
Received: from Unknown (HELO spamd2-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 15 Dec 2015 16:58:53 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd2-us-west.apache.org (ASF Mail Server at spamd2-us-west.apache.org) with ESMTP id 6DC1D1A05AE
	for <dev@httpd.apache.org>; Tue, 15 Dec 2015 16:58:53 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd2-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.554
X-Spam-Level:
X-Spam-Status: No, score=-0.554 tagged_above=-999 required=6.31
	tests=[RP_MATCHES_RCVD=-0.554, SPF_PASS=-0.001, URIBL_BLOCKED=0.001]
	autolearn=disabled
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd2-us-west.apache.org [10.40.0.9]) (amavisd-new, port 10024)
	with ESMTP id tVXZTvvFaXLg for <dev@httpd.apache.org>;
	Tue, 15 Dec 2015 16:58:44 +0000 (UTC)
Received: from monica.sharp.fm (monica.sharp.fm [80.168.143.5])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTP id C188C42A73
	for <dev@httpd.apache.org>; Tue, 15 Dec 2015 16:58:43 +0000 (UTC)
Received: from [10.105.35.222] (unknown [5.56.169.80])
	(using TLSv1 with cipher DHE-RSA-AES256-SHA (256/256 bits))
	(Client did not present a certificate)
	(Authenticated sender: minfrin@sharp.fm)
	by monica.sharp.fm (Postfix) with ESMTPSA id 8E5A4820CF
	for <dev@httpd.apache.org>; Tue, 15 Dec 2015 16:58:36 +0000 (GMT)
Content-Type: text/plain; charset=utf-8
Mime-Version: 1.0 (Mac OS X Mail 8.2 \(2104\))
Subject: Re: async mpms + http2
From: Graham Leggett <minfrin@sharp.fm>
In-Reply-To: <703ED97E-4B43-4AC1-94B1-2BB55893DBAC@greenbytes.de>
Date: Tue, 15 Dec 2015 18:58:35 +0200
Content-Transfer-Encoding: quoted-printable
Message-Id: <40A28B09-844B-4455-8819-B60EF45288BA@sharp.fm>
References: <703ED97E-4B43-4AC1-94B1-2BB55893DBAC@greenbytes.de>
To: dev@httpd.apache.org
X-Mailer: Apple Mail (2.2104)

On 15 Dec 2015, at 5:44 PM, Stefan Eissing =
<stefan.eissing@greenbytes.de> wrote:

>  However, there is another state in HTTP/2 processing, where a =
BLOCK_READ is performed: flow control on streaming out responses. =
Basically, the client has a window of n bytes, the server sends n =
response bytes and then needs to wait for the client to increase the =
window again. This would be a good time to resume processing back to the =
mpm, and initially I did so. But that breaks under load.
>=20
>  Under load, the event mpm feels free to close connections in certain =
states - I think CONN_STATE_CHECK_REQUEST_LINE_READABLE. That is fine =
for a HTTP/1 connection as it always is between requests here. But =
HTTP/2 would also like to use read events, but unloading a child by =
closing such connections is not the right thing to do.
>=20
>  Is there a way mod_http2 can achieve this or do we need another flag =
in conn_rec/cs?

Does the CONN_STATE_WRITE_COMPLETION state fit this case?

The WRITE in the above name is a bit of a misnomer, because when mod_ssl =
returns WANTS_READ we return to the CONN_STATE_WRITE_COMPLETION state =
with the sense set to READ. This tells the MPM to block waiting until =
we=E2=80=99re readable, as opposed to block waiting until we=E2=80=99re =
writable.

> Observation 2: controlled close
>  HTTP/2 would like to send out a last frame when closing a connection =
in a controlled/timeout way. Do we need another hook for that? Something =
like "pre_close_connection=E2=80=9D?

I=E2=80=99m assuming we would like a module to have control over the =
sending of that frame, if so, it makes sense yes.

> Observation 3: timeouts
>  a. If admins would like to have another Timeout for HTTP/2 =
connections, they are currently stuck with configuring one Timeout which =
goes to server_rec->timeout, right? For idle connections, clients =
already try to keep it open longer. It would be nice to give admins a =
choice here for different values based on the selected protocol. How to =
best do this?

Perhaps just as we can override the sense of the connection before =
returning, we might be able to modify the timeout before returning.

>  b. Handling own timeouts: if I want, during processing the =
connection, a different socket timeout, I can just set it using =
apr_socket_timeout_set()? Shall I restore it back to server->timeout =
before returning?

That feels wrong, ideally we want to be formally telling the MPM =E2=80=9C=
give us this timeout=E2=80=9D rather than doing something sneaky behind =
it=E2=80=99s back.

>  c. What would be the best way to wait for a file description *and* =
conditional event simultaneously? mod_http2 has now a sort of pool loop =
with double backup timer for situations where it needs to watch both =
client and backend processes.

I=E2=80=99m not sure how portable it is watching for file descriptors. I =
have used libev to do this in the past and it was quite involved. =
However - if we can support this it would be really useful.

Regards,
Graham
=E2=80=94


From dev-return-85082-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Tue Dec 15 20:02:02 2015
Return-Path: <dev-return-85082-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 4020618120
	for <apmail-httpd-dev-archive@www.apache.org>; Tue, 15 Dec 2015 20:02:02 +0000 (UTC)
Received: (qmail 23391 invoked by uid 500); 15 Dec 2015 20:02:01 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 23305 invoked by uid 500); 15 Dec 2015 20:02:01 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 23288 invoked by uid 99); 15 Dec 2015 20:02:01 -0000
Received: from mail-relay.apache.org (HELO mail-relay.apache.org) (140.211.11.15)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 15 Dec 2015 20:02:01 +0000
Received: from [17.198.11.252] (unknown [17.198.11.252])
	by mail-relay.apache.org (ASF Mail Server at mail-relay.apache.org) with ESMTPSA id 6AB4B1A0056;
	Tue, 15 Dec 2015 20:02:01 +0000 (UTC)
From: Leif Hedstrom <zwoop@apache.org>
Content-Type: text/plain; charset=utf-8
Content-Transfer-Encoding: quoted-printable
Subject: Branching for 6.1.x tomorrow
Message-Id: <6DD14081-1D4E-4E80-BDD0-8FA0C2328313@apache.org>
Date: Tue, 15 Dec 2015 12:02:00 -0800
To: dev@httpd.apache.org,
 users@trafficserver.apache.org
Mime-Version: 1.0 (Mac OS X Mail 9.2 \(3112\))
X-Mailer: Apple Mail (2.3112)

Hi all,

I=E2=80=99m planning on branching 6.1.x tomorrow afternoon, so please =
take a look at your Jira=E2=80=99s, and update / move them accordingly.

Cheers,

=E2=80=94 leif=

From dev-return-85083-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Tue Dec 15 23:49:21 2015
Return-Path: <dev-return-85083-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id D8D7418D67
	for <apmail-httpd-dev-archive@www.apache.org>; Tue, 15 Dec 2015 23:49:21 +0000 (UTC)
Received: (qmail 34221 invoked by uid 500); 15 Dec 2015 23:49:20 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 34152 invoked by uid 500); 15 Dec 2015 23:49:20 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 34143 invoked by uid 99); 15 Dec 2015 23:49:20 -0000
Received: from mail-relay.apache.org (HELO mail-relay.apache.org) (140.211.11.15)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 15 Dec 2015 23:49:20 +0000
Received: from [17.198.11.252] (unknown [17.198.11.252])
	by mail-relay.apache.org (ASF Mail Server at mail-relay.apache.org) with ESMTPSA id A53AA1A0056
	for <dev@httpd.apache.org>; Tue, 15 Dec 2015 23:49:20 +0000 (UTC)
Content-Type: text/plain; charset=utf-8
Mime-Version: 1.0 (Mac OS X Mail 9.2 \(3112\))
Subject: Re: Branching for 6.1.x tomorrow
From: Leif Hedstrom <zwoop@apache.org>
In-Reply-To: <6DD14081-1D4E-4E80-BDD0-8FA0C2328313@apache.org>
Date: Tue, 15 Dec 2015 15:49:19 -0800
Content-Transfer-Encoding: quoted-printable
Message-Id: <76CD6C0E-D164-4C2A-81AD-C63503B21034@apache.org>
References: <6DD14081-1D4E-4E80-BDD0-8FA0C2328313@apache.org>
To: dev@httpd.apache.org
X-Mailer: Apple Mail (2.3112)


> On Dec 15, 2015, at 12:02 PM, Leif Hedstrom <zwoop@apache.org> wrote:
>=20
> Hi all,
>=20
> I=E2=80=99m planning on branching 6.1.x tomorrow afternoon, so please =
take a look at your Jira=E2=80=99s, and update / move them accordingly.

sorry about the wrong dev@ list :-/.

=E2=80=94 leif


From dev-return-85084-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Wed Dec 16 11:40:51 2015
Return-Path: <dev-return-85084-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 2A4A3185D6
	for <apmail-httpd-dev-archive@www.apache.org>; Wed, 16 Dec 2015 11:40:51 +0000 (UTC)
Received: (qmail 4912 invoked by uid 500); 16 Dec 2015 11:40:45 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 4844 invoked by uid 500); 16 Dec 2015 11:40:45 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 4834 invoked by uid 99); 16 Dec 2015 11:40:45 -0000
Received: from Unknown (HELO spamd3-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 16 Dec 2015 11:40:45 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd3-us-west.apache.org (ASF Mail Server at spamd3-us-west.apache.org) with ESMTP id 3009A1804A5
	for <dev@httpd.apache.org>; Wed, 16 Dec 2015 11:40:45 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd3-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.654
X-Spam-Level:
X-Spam-Status: No, score=-0.654 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RP_MATCHES_RCVD=-0.554] autolearn=disabled
Authentication-Results: spamd3-us-west.apache.org (amavisd-new);
	dkim=pass (1024-bit key) header.d=greenbytes.de header.b=JfccgJMx;
	dkim=pass (1024-bit key) header.d=greenbytes.de header.b=XV7udZ7N
Received: from mx1-us-west.apache.org ([10.40.0.8])
	by localhost (spamd3-us-west.apache.org [10.40.0.10]) (amavisd-new, port 10024)
	with ESMTP id HGFrxFi-v6kt for <dev@httpd.apache.org>;
	Wed, 16 Dec 2015 11:40:29 +0000 (UTC)
Received: from mail.greenbytes.de (mail.greenbytes.de [217.91.35.233])
	by mx1-us-west.apache.org (ASF Mail Server at mx1-us-west.apache.org) with ESMTPS id 3A96D204B6
	for <dev@httpd.apache.org>; Wed, 16 Dec 2015 11:40:28 +0000 (UTC)
Received: by mail.greenbytes.de (Postfix, from userid 117)
	id 9AF8415A0C40; Wed, 16 Dec 2015 12:40:26 +0100 (CET)
DKIM-Signature: v=1; a=rsa-sha256; c=simple/simple; d=greenbytes.de; s=mail;
	t=1450266026; bh=4LhKbYYTMLIGLaOV1IJJGJXeSpsI5kw6CyW1w8efjs4=;
	h=From:Subject:Date:To:From;
	b=JfccgJMxdaYmEJIBKD0Uf2vtgQYo6bNo+ZC58JrzSEAY86Z4seBB10Uf7aMkmpvuT
	 e5eCmvp092XOZdB9kK5lzqaIrbu65vXBTAdkHaDCsHWeShLxidvA98IN0B8irCmvd9
	 sStEWcikxc3QAxcFXWET2ICmkj4kuepQTdUw308s=
Received: from [192.168.1.42] (unknown [217.91.35.233])
	(using TLSv1 with cipher ECDHE-RSA-AES256-SHA (256/256 bits))
	(Client did not present a certificate)
	by mail.greenbytes.de (Postfix) with ESMTPSA id B22B315A0638
	for <dev@httpd.apache.org>; Wed, 16 Dec 2015 12:40:25 +0100 (CET)
DKIM-Signature: v=1; a=rsa-sha256; c=simple/simple; d=greenbytes.de; s=mail;
	t=1450266025; bh=4LhKbYYTMLIGLaOV1IJJGJXeSpsI5kw6CyW1w8efjs4=;
	h=From:Subject:Date:To:From;
	b=XV7udZ7Npl5WKaXHEdqxGVxHupMZkQNauBnu8aPKeW15W7J4RzWMabtlsbRIrLJlA
	 iepLUE0NBHBAJ7S+kGf63/HIE05dHolt8kP+U2rwlJzI+8KF5WzmBciXZoczd1pCfn
	 QKzZjnSFLOUrK4y6JwRMPSZl7OprBTJ0waZFYEdY=
From: Stefan Eissing <stefan.eissing@greenbytes.de>
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: quoted-printable
Subject: variables
Message-Id: <1A4A9DE8-ACF3-4FEB-BE4E-756E850ACF39@greenbytes.de>
Date: Wed, 16 Dec 2015 12:40:25 +0100
To: dev@httpd.apache.org
Mime-Version: 1.0 (Mac OS X Mail 9.2 \(3112\))
X-Mailer: Apple Mail (2.3112)

I would like to expose some HTTP/2 properties, for example =
"HTTP2=3Don|off" similar to what mod_ssl does with HTTPS and other SSL =
variables. Current implementation does not look like something to =
repeat, at first glance, but maybe it's the only way...

The optional function ssl_is_https is used:
- from many modules
- server/util_expr_eval.c

The optional function ssl_var_lookup is used:
- from even more modules
- *not* in server

Subprocesses get their environment via r->subprocess_env, filled via the =
"fixups" hook. This is the usual way how we involve modules in request =
processing. But, as I read it, subprocess_env gets filled with all =
variables for every request, even though they maybe never read? Hmm, =
probably a little late to do anything about that without code breakage.

So, the least work and most 2.4.x compatible way for mod_http2 is to =
mimmic the mod_ssl way. http2_is_http2() and http2_var_lookup(), =
optional. Add fixups hook for subprocess_env, add $HTTP2 handling to =
server/util_expr_eval.c for checks in config/htaccess?

//Stefan

PS. For trunk, it might be a nice TODO to add a variable registry that =
allows lazy evaluation. Like with
  struct ap_var_handler_t {
    const char *name;
    const char *lookup(struct ap_var_handler_t *h, server_rec *s, =
conn_rec *c, request_rec *r);
    void *ctx;
    int server_specific :1;
    int conn_specific :1;
    int cacheable :1;
    int scope_config :1;
    int scope_subprocess :1;
  }






From dev-return-85085-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Wed Dec 16 14:00:37 2015
Return-Path: <dev-return-85085-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id A25C718C4B
	for <apmail-httpd-dev-archive@www.apache.org>; Wed, 16 Dec 2015 14:00:37 +0000 (UTC)
Received: (qmail 35200 invoked by uid 500); 16 Dec 2015 14:00:36 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 35128 invoked by uid 500); 16 Dec 2015 14:00:36 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 35118 invoked by uid 99); 16 Dec 2015 14:00:36 -0000
Received: from Unknown (HELO spamd2-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 16 Dec 2015 14:00:36 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd2-us-west.apache.org (ASF Mail Server at spamd2-us-west.apache.org) with ESMTP id 05A591A0B6F
	for <dev@httpd.apache.org>; Wed, 16 Dec 2015 14:00:36 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd2-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.653
X-Spam-Level:
X-Spam-Status: No, score=-0.653 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RP_MATCHES_RCVD=-0.554, URIBL_BLOCKED=0.001] autolearn=disabled
Authentication-Results: spamd2-us-west.apache.org (amavisd-new);
	dkim=pass (1024-bit key) header.d=greenbytes.de header.b=H+8CP7hK;
	dkim=pass (1024-bit key) header.d=greenbytes.de header.b=fdfymZ1d
Received: from mx1-us-west.apache.org ([10.40.0.8])
	by localhost (spamd2-us-west.apache.org [10.40.0.9]) (amavisd-new, port 10024)
	with ESMTP id BRNqYXf5N4Pv for <dev@httpd.apache.org>;
	Wed, 16 Dec 2015 14:00:26 +0000 (UTC)
Received: from mail.greenbytes.de (mail.greenbytes.de [217.91.35.233])
	by mx1-us-west.apache.org (ASF Mail Server at mx1-us-west.apache.org) with ESMTPS id 7223F20463
	for <dev@httpd.apache.org>; Wed, 16 Dec 2015 14:00:25 +0000 (UTC)
Received: by mail.greenbytes.de (Postfix, from userid 117)
	id 18C2715A0C40; Wed, 16 Dec 2015 15:00:23 +0100 (CET)
DKIM-Signature: v=1; a=rsa-sha256; c=simple/simple; d=greenbytes.de; s=mail;
	t=1450274423; bh=2NuWorfaraCSGM1voKD3w5r77N6zaSTOTDg4k9ybcvE=;
	h=Subject:From:In-Reply-To:Date:References:To:From;
	b=H+8CP7hKl8ymCG9DAc4lSh1NXn3NHla2npUdCVEDVMcodCZgdytVpfVjZdU1bdXf7
	 FfW/x9hV0XotSzEqDZwdlozJNknSpUHewmd7yHhsdu3gjNT5ecMcbudm7OMrmrf5LP
	 q/tUO+eyf7GGqcNVceuZhnYV99mcBvttA5LGuYEU=
Received: from [192.168.1.42] (unknown [217.91.35.233])
	(using TLSv1 with cipher ECDHE-RSA-AES256-SHA (256/256 bits))
	(Client did not present a certificate)
	by mail.greenbytes.de (Postfix) with ESMTPSA id 7380715A090F
	for <dev@httpd.apache.org>; Wed, 16 Dec 2015 15:00:20 +0100 (CET)
DKIM-Signature: v=1; a=rsa-sha256; c=simple/simple; d=greenbytes.de; s=mail;
	t=1450274420; bh=2NuWorfaraCSGM1voKD3w5r77N6zaSTOTDg4k9ybcvE=;
	h=Subject:From:In-Reply-To:Date:References:To:From;
	b=fdfymZ1dePycnMi5px0XsRbS0kGCQcpaGFQSufxEHYN5s2kob7PpN04tcNiIwEcjA
	 b1tQBDqjszxCorlYCyxhknQFS3JmzxxeprBxVqLMGMZLY1FWF30Q+8oq/yiwyMoiQB
	 4tyzUThNZ+DurLVpIojmbG+XlNqI868xzqxnNfbg=
Content-Type: text/plain; charset=utf-8
Mime-Version: 1.0 (Mac OS X Mail 9.2 \(3112\))
Subject: Re: async mpms + http2
From: Stefan Eissing <stefan.eissing@greenbytes.de>
In-Reply-To: <40A28B09-844B-4455-8819-B60EF45288BA@sharp.fm>
Date: Wed, 16 Dec 2015 15:00:20 +0100
Content-Transfer-Encoding: quoted-printable
Message-Id: <97CB352F-23FA-4328-B7F1-8716B88BF4C6@greenbytes.de>
References: <703ED97E-4B43-4AC1-94B1-2BB55893DBAC@greenbytes.de> <40A28B09-844B-4455-8819-B60EF45288BA@sharp.fm>
To: dev@httpd.apache.org
X-Mailer: Apple Mail (2.3112)


> Am 15.12.2015 um 17:58 schrieb Graham Leggett <minfrin@sharp.fm>:
>=20
> On 15 Dec 2015, at 5:44 PM, Stefan Eissing =
<stefan.eissing@greenbytes.de> wrote:
>=20
>> However, there is another state in HTTP/2 processing, where a =
BLOCK_READ is performed: flow control on streaming out responses. =
Basically, the client has a window of n bytes, the server sends n =
response bytes and then needs to wait for the client to increase the =
window again. This would be a good time to resume processing back to the =
mpm, and initially I did so. But that breaks under load.
>>=20
>> Under load, the event mpm feels free to close connections in certain =
states - I think CONN_STATE_CHECK_REQUEST_LINE_READABLE. That is fine =
for a HTTP/1 connection as it always is between requests here. But =
HTTP/2 would also like to use read events, but unloading a child by =
closing such connections is not the right thing to do.
>>=20
>> Is there a way mod_http2 can achieve this or do we need another flag =
in conn_rec/cs?
>=20
> Does the CONN_STATE_WRITE_COMPLETION state fit this case?

As far as I figured out, that will only work when http2 processing moves =
into an output filter. Then the filter would have to mimic pending data =
and sense =3D=3D READ. That would prevent event from closing the =
connection early and POLL_IN. Next attempt to write the output_filters =
could then read again.

Other attempts to keep the connection although output filters are empty =
fail under load. I'll give the http2 output filter a try, but it feels a =
bit like hacking the current design (the design is not wrong, it just =
could not predict h2 usage).=20

> The WRITE in the above name is a bit of a misnomer, because when =
mod_ssl returns WANTS_READ we return to the CONN_STATE_WRITE_COMPLETION =
state with the sense set to READ. This tells the MPM to block waiting =
until we=E2=80=99re readable, as opposed to block waiting until we=E2=80=99=
re writable.

I think this only happens, as long as data remains in the output filter.

>> Observation 2: controlled close
>> HTTP/2 would like to send out a last frame when closing a connection =
in a controlled/timeout way. Do we need another hook for that? Something =
like "pre_close_connection=E2=80=9D?
>=20
> I=E2=80=99m assuming we would like a module to have control over the =
sending of that frame, if so, it makes sense yes.

Ok.

>> Observation 3: timeouts
>> a. If admins would like to have another Timeout for HTTP/2 =
connections, they are currently stuck with configuring one Timeout which =
goes to server_rec->timeout, right? For idle connections, clients =
already try to keep it open longer. It would be nice to give admins a =
choice here for different values based on the selected protocol. How to =
best do this?
>=20
> Perhaps just as we can override the sense of the connection before =
returning, we might be able to modify the timeout before returning.

I'd like that.

>> b. Handling own timeouts: if I want, during processing the =
connection, a different socket timeout, I can just set it using =
apr_socket_timeout_set()? Shall I restore it back to server->timeout =
before returning?
>=20
> That feels wrong, ideally we want to be formally telling the MPM =
=E2=80=9Cgive us this timeout=E2=80=9D rather than doing something =
sneaky behind it=E2=80=99s back.

Yes. Do not like it either.

>> c. What would be the best way to wait for a file description *and* =
conditional event simultaneously? mod_http2 has now a sort of pool loop =
with double backup timer for situations where it needs to watch both =
client and backend processes.
>=20
> I=E2=80=99m not sure how portable it is watching for file descriptors. =
I have used libev to do this in the past and it was quite involved. =
However - if we can support this it would be really useful.
>=20
> Regards,
> Graham
> =E2=80=94

Cheers,
  Stefan


From dev-return-85086-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Wed Dec 16 14:31:54 2015
Return-Path: <dev-return-85086-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 9ABC018D54
	for <apmail-httpd-dev-archive@www.apache.org>; Wed, 16 Dec 2015 14:31:54 +0000 (UTC)
Received: (qmail 16139 invoked by uid 500); 16 Dec 2015 14:31:53 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 16068 invoked by uid 500); 16 Dec 2015 14:31:53 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 16058 invoked by uid 99); 16 Dec 2015 14:31:53 -0000
Received: from Unknown (HELO spamd4-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 16 Dec 2015 14:31:53 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd4-us-west.apache.org (ASF Mail Server at spamd4-us-west.apache.org) with ESMTP id 65F5AC0821
	for <dev@httpd.apache.org>; Wed, 16 Dec 2015 14:31:53 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd4-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.101
X-Spam-Level:
X-Spam-Status: No, score=-0.101 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RCVD_IN_MSPIKE_H2=-0.001, SPF_PASS=-0.001, URIBL_BLOCKED=0.001]
	autolearn=disabled
Authentication-Results: spamd4-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd4-us-west.apache.org [10.40.0.11]) (amavisd-new, port 10024)
	with ESMTP id MTi1hv_eH4MF for <dev@httpd.apache.org>;
	Wed, 16 Dec 2015 14:31:43 +0000 (UTC)
Received: from mail-ig0-f172.google.com (mail-ig0-f172.google.com [209.85.213.172])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id 0785620C61
	for <dev@httpd.apache.org>; Wed, 16 Dec 2015 14:31:43 +0000 (UTC)
Received: by mail-ig0-f172.google.com with SMTP id sf7so24494386igc.1
        for <dev@httpd.apache.org>; Wed, 16 Dec 2015 06:31:42 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type:content-transfer-encoding;
        bh=s7pnSbhGUIUL124e7lj8UAxtl6vReMgkdPZomuuYlKM=;
        b=ee9WH1DYUg9Lmu9Rq6qMF2HwCu+ObQoGoKdiFed6fGNa02fLXe5/Z82Usp24V8i2UG
         /CQmprhydalEa40k7PO+rzrrs+LeKdOw2i1ywW2TnvJB9VtJpph6iSiOOhu+IoupO7rP
         32kwKBZZwT3Rz95OHkjlbuuG2OPrYDy4O23AbiBab8fPrFHdo1ZfW0ehJ2jkw3a/RWD5
         uf5WqL4IzD4iVf4Qk2/hHw+m9qZ7EHZLMlHvWQf4qqsxro6pjA99IDkse4yD540l/wkZ
         41O71dL+Rp9y7N3HFUQbg/XMVH8GQrfrZlLjlUEgG3g/1nz2MZhIaF3LFRpkHfnl1npt
         EqZg==
MIME-Version: 1.0
X-Received: by 10.50.128.39 with SMTP id nl7mr9762840igb.56.1450276301883;
 Wed, 16 Dec 2015 06:31:41 -0800 (PST)
Received: by 10.64.114.199 with HTTP; Wed, 16 Dec 2015 06:31:41 -0800 (PST)
In-Reply-To: <1A4A9DE8-ACF3-4FEB-BE4E-756E850ACF39@greenbytes.de>
References: <1A4A9DE8-ACF3-4FEB-BE4E-756E850ACF39@greenbytes.de>
Date: Wed, 16 Dec 2015 09:31:41 -0500
Message-ID: <CALK=YjPjOGDntYuE_xn_Led_O8ptUH5VF6njED0UpAGbwHwc1A@mail.gmail.com>
Subject: Re: variables
From: Eric Covener <covener@gmail.com>
To: Apache HTTP Server Development List <dev@httpd.apache.org>
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: quoted-printable

On Wed, Dec 16, 2015 at 6:40 AM, Stefan Eissing
<stefan.eissing@greenbytes.de> wrote:
> So, the least work and most 2.4.x compatible way for mod_http2 is to mimm=
ic the mod_ssl way. http2_is_http2() and http2_var_lookup(), optional. Add =
fixups hook for subprocess_env, add $HTTP2 handling to server/util_expr_eva=
l.c for checks in config/htaccess?

I think you could (also) wrap them in server/util_expr_eval.c  to make
them more accessible.

--=20
Eric Covener
covener@gmail.com

From dev-return-85087-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Wed Dec 16 15:11:50 2015
Return-Path: <dev-return-85087-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 3332D18F6D
	for <apmail-httpd-dev-archive@www.apache.org>; Wed, 16 Dec 2015 15:11:50 +0000 (UTC)
Received: (qmail 40117 invoked by uid 500); 16 Dec 2015 15:11:48 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 40051 invoked by uid 500); 16 Dec 2015 15:11:48 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 40041 invoked by uid 99); 16 Dec 2015 15:11:48 -0000
Received: from Unknown (HELO spamd2-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 16 Dec 2015 15:11:48 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd2-us-west.apache.org (ASF Mail Server at spamd2-us-west.apache.org) with ESMTP id 60FB21A0A94
	for <dev@httpd.apache.org>; Wed, 16 Dec 2015 15:11:48 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd2-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.654
X-Spam-Level:
X-Spam-Status: No, score=-0.654 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RP_MATCHES_RCVD=-0.554, SPF_PASS=-0.001, URIBL_BLOCKED=0.001]
	autolearn=disabled
Authentication-Results: spamd2-us-west.apache.org (amavisd-new);
	dkim=pass (1024-bit key) header.d=greenbytes.de header.b=CcuU39f+;
	dkim=pass (1024-bit key) header.d=greenbytes.de header.b=VuIFl2qR
Received: from mx1-us-west.apache.org ([10.40.0.8])
	by localhost (spamd2-us-west.apache.org [10.40.0.9]) (amavisd-new, port 10024)
	with ESMTP id QXpCvIhq-3ox for <dev@httpd.apache.org>;
	Wed, 16 Dec 2015 15:11:38 +0000 (UTC)
Received: from mail.greenbytes.de (mail.greenbytes.de [217.91.35.233])
	by mx1-us-west.apache.org (ASF Mail Server at mx1-us-west.apache.org) with ESMTPS id 9CF1020424
	for <dev@httpd.apache.org>; Wed, 16 Dec 2015 15:11:38 +0000 (UTC)
Received: by mail.greenbytes.de (Postfix, from userid 117)
	id 6A2B015A0B5D; Wed, 16 Dec 2015 16:11:36 +0100 (CET)
DKIM-Signature: v=1; a=rsa-sha256; c=simple/simple; d=greenbytes.de; s=mail;
	t=1450278696; bh=uBMYvgtnxIeaKhbGKwxdTcwrMPMc6e2XZQf4FEKmWdk=;
	h=Subject:From:In-Reply-To:Date:References:To:From;
	b=CcuU39f+YmLL0GXT88UPySrHzRdClvJEB8unT35UaH2LGvQD2uOgScJLumvfeE1D+
	 HX6D/dGQvrKghaX66Xr2lz1xtW8jXAhHZpzH5R1eyktP7EjOOMpSn4E6xphl4xtwYc
	 sF9whqj3Has6OvFwMtNRbuhDA6gZSyry2Qymnw1E=
Received: from [192.168.1.42] (unknown [217.91.35.233])
	(using TLSv1 with cipher ECDHE-RSA-AES256-SHA (256/256 bits))
	(Client did not present a certificate)
	by mail.greenbytes.de (Postfix) with ESMTPSA id EFCB615A0626
	for <dev@httpd.apache.org>; Wed, 16 Dec 2015 16:11:35 +0100 (CET)
DKIM-Signature: v=1; a=rsa-sha256; c=simple/simple; d=greenbytes.de; s=mail;
	t=1450278695; bh=uBMYvgtnxIeaKhbGKwxdTcwrMPMc6e2XZQf4FEKmWdk=;
	h=Subject:From:In-Reply-To:Date:References:To:From;
	b=VuIFl2qRGU6WBs/aovdddpdKPkWqvLqa1lEIUuqusjZrTOUFRkjhyCbkg4CuhoGPv
	 2tP22z4IGyPfb8GL2Kbp1/sTs5CS7LYlwV1A+cNB9k4LjL+eCYN/iVN5VFZXu2GMwB
	 GaxfV2EBULRtbGoSIXGlfBIAAXkCNY7eZecxNYlE=
Content-Type: text/plain; charset=us-ascii
Mime-Version: 1.0 (Mac OS X Mail 9.2 \(3112\))
Subject: Re: variables
From: Stefan Eissing <stefan.eissing@greenbytes.de>
In-Reply-To: <CALK=YjPjOGDntYuE_xn_Led_O8ptUH5VF6njED0UpAGbwHwc1A@mail.gmail.com>
Date: Wed, 16 Dec 2015 16:11:35 +0100
Content-Transfer-Encoding: quoted-printable
Message-Id: <2A884364-AAAF-4013-B3F7-976E755C4720@greenbytes.de>
References: <1A4A9DE8-ACF3-4FEB-BE4E-756E850ACF39@greenbytes.de> <CALK=YjPjOGDntYuE_xn_Led_O8ptUH5VF6njED0UpAGbwHwc1A@mail.gmail.com>
To: dev@httpd.apache.org
X-Mailer: Apple Mail (2.3112)


> Am 16.12.2015 um 15:31 schrieb Eric Covener <covener@gmail.com>:
>=20
> On Wed, Dec 16, 2015 at 6:40 AM, Stefan Eissing
> <stefan.eissing@greenbytes.de> wrote:
>> So, the least work and most 2.4.x compatible way for mod_http2 is to =
mimmic the mod_ssl way. http2_is_http2() and http2_var_lookup(), =
optional. Add fixups hook for subprocess_env, add $HTTP2 handling to =
server/util_expr_eval.c for checks in config/htaccess?
>=20
> I think you could (also) wrap them in server/util_expr_eval.c  to make
> them more accessible.

Not sure I understand. Isn't that what I said?=

From dev-return-85088-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Wed Dec 16 15:21:54 2015
Return-Path: <dev-return-85088-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 6F6E218FBE
	for <apmail-httpd-dev-archive@www.apache.org>; Wed, 16 Dec 2015 15:21:54 +0000 (UTC)
Received: (qmail 71349 invoked by uid 500); 16 Dec 2015 15:21:54 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 71284 invoked by uid 500); 16 Dec 2015 15:21:53 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 71274 invoked by uid 99); 16 Dec 2015 15:21:53 -0000
Received: from Unknown (HELO spamd2-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 16 Dec 2015 15:21:53 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd2-us-west.apache.org (ASF Mail Server at spamd2-us-west.apache.org) with ESMTP id 84ECF1A0BB3
	for <dev@httpd.apache.org>; Wed, 16 Dec 2015 15:21:53 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd2-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.12
X-Spam-Level:
X-Spam-Status: No, score=-0.12 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RCVD_IN_MSPIKE_H3=-0.01, RCVD_IN_MSPIKE_WL=-0.01, SPF_PASS=-0.001,
	URIBL_BLOCKED=0.001] autolearn=disabled
Authentication-Results: spamd2-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd2-us-west.apache.org [10.40.0.9]) (amavisd-new, port 10024)
	with ESMTP id RhNYzMOHeCOd for <dev@httpd.apache.org>;
	Wed, 16 Dec 2015 15:21:48 +0000 (UTC)
Received: from mail-ig0-f178.google.com (mail-ig0-f178.google.com [209.85.213.178])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id 0607D439E6
	for <dev@httpd.apache.org>; Wed, 16 Dec 2015 15:21:48 +0000 (UTC)
Received: by mail-ig0-f178.google.com with SMTP id mv3so137923737igc.0
        for <dev@httpd.apache.org>; Wed, 16 Dec 2015 07:21:48 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        bh=YkdD5diw3I+KY8aeSRGahqOUoaw0g23HyPq4gXAwmSg=;
        b=Z/fe9I4HOQEn9PN4OpPxGxUdNsjc0q09bk8M9/L49saAJOP0ss85NRYUEUKHx+rTIO
         Zo7COp6BEi0Lky/cZHKliDAw50EXlJcZtyJHjVB9dqvqS6ANuzHoA0q/t5lVWwfz911B
         iY0SmDJLMydA9zstYvgfC6SJa45Ep1BZ0W2MT1i5IukyDXs1Jix+Chiz71tUaOVK0RY7
         tY0bHKHPNqpJ53c2XzamI/eFmNFgvw+JdTJ5j4oYnT2phEHVMR2rUhCFg1+VB5HXyddk
         z1mS+fjFyDBtflf4dq2slCB3Ph4L6jO0Xa4Fe58bOLcEYEhaKCusyV3pQjyINyec5Zj0
         c6ew==
MIME-Version: 1.0
X-Received: by 10.107.10.94 with SMTP id u91mr46905428ioi.169.1450279305715;
 Wed, 16 Dec 2015 07:21:45 -0800 (PST)
Received: by 10.64.114.199 with HTTP; Wed, 16 Dec 2015 07:21:45 -0800 (PST)
In-Reply-To: <2A884364-AAAF-4013-B3F7-976E755C4720@greenbytes.de>
References: <1A4A9DE8-ACF3-4FEB-BE4E-756E850ACF39@greenbytes.de>
	<CALK=YjPjOGDntYuE_xn_Led_O8ptUH5VF6njED0UpAGbwHwc1A@mail.gmail.com>
	<2A884364-AAAF-4013-B3F7-976E755C4720@greenbytes.de>
Date: Wed, 16 Dec 2015 10:21:45 -0500
Message-ID: <CALK=YjNgVaN4L6nONmSwK3Za_76GwscmSXd9VT=jU7n9cqPmQQ@mail.gmail.com>
Subject: Re: variables
From: Eric Covener <covener@gmail.com>
To: Apache HTTP Server Development List <dev@httpd.apache.org>
Content-Type: text/plain; charset=UTF-8

On Wed, Dec 16, 2015 at 10:11 AM, Stefan Eissing
<stefan.eissing@greenbytes.de> wrote:
> Not sure I understand. Isn't that what I said?


Sorry, missed it entirely. Read on phone and replied in browser.

From dev-return-85089-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Wed Dec 16 18:40:00 2015
Return-Path: <dev-return-85089-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 16DB618D61
	for <apmail-httpd-dev-archive@www.apache.org>; Wed, 16 Dec 2015 18:40:00 +0000 (UTC)
Received: (qmail 50232 invoked by uid 500); 16 Dec 2015 18:39:58 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 50091 invoked by uid 500); 16 Dec 2015 18:39:58 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 50021 invoked by uid 99); 16 Dec 2015 18:39:58 -0000
Received: from Unknown (HELO spamd4-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 16 Dec 2015 18:39:58 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd4-us-west.apache.org (ASF Mail Server at spamd4-us-west.apache.org) with ESMTP id 9B28DC0821
	for <dev@httpd.apache.org>; Wed, 16 Dec 2015 18:39:57 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd4-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 2.98
X-Spam-Level: **
X-Spam-Status: No, score=2.98 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, HTML_MESSAGE=3,
	RCVD_IN_MSPIKE_H3=-0.01, RCVD_IN_MSPIKE_WL=-0.01, SPF_PASS=-0.001,
	URIBL_BLOCKED=0.001] autolearn=disabled
Authentication-Results: spamd4-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=rowe-clan-net.20150623.gappssmtp.com
Received: from mx1-us-west.apache.org ([10.40.0.8])
	by localhost (spamd4-us-west.apache.org [10.40.0.11]) (amavisd-new, port 10024)
	with ESMTP id jnBn-kX-Tspt for <dev@httpd.apache.org>;
	Wed, 16 Dec 2015 18:39:53 +0000 (UTC)
Received: from mail-ig0-f181.google.com (mail-ig0-f181.google.com [209.85.213.181])
	by mx1-us-west.apache.org (ASF Mail Server at mx1-us-west.apache.org) with ESMTPS id 6A88520463
	for <dev@httpd.apache.org>; Wed, 16 Dec 2015 18:39:53 +0000 (UTC)
Received: by mail-ig0-f181.google.com with SMTP id ph11so155682443igc.1
        for <dev@httpd.apache.org>; Wed, 16 Dec 2015 10:39:53 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=rowe-clan-net.20150623.gappssmtp.com; s=20150623;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        bh=SXiex5pRSNjCiTzwh/UdRlvN8I86rv9gvZpZXM1YEXY=;
        b=0NTLYrFp7UCB7NA75eLv3slTXCvRtglghw+XI+qjKo2NOsprqyA30HHckENm+eGhnp
         3/pRsIUuOu3NCkPokP9d48qkL/P/O3oH081mNrv1ATR4h3sZ/pFgl7UOwvFf4z2cpMcZ
         uC95ReRHU0FrY3tZMEwQ6ExDol2jyivpEbw3901quWlfKkNUYsIO9w0LJ3TkhTAJ1nd4
         x22lWodPP3p0TupLguKQu6J680rYRkXnQEgMXaspqKaV1FDl5x7opFlwgHmHGqgyIK6q
         mR62Y6TLz2/PjeAU8bAyj6u3210XKf8c7+O1xFcOvP18zkTZkXNKC/FhOTwJqLF57X66
         k2RA==
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=1e100.net; s=20130820;
        h=x-gm-message-state:mime-version:in-reply-to:references:date
         :message-id:subject:from:to:content-type;
        bh=SXiex5pRSNjCiTzwh/UdRlvN8I86rv9gvZpZXM1YEXY=;
        b=cWPcs+sCn9DVxxBvIO8NK5Cpx/qKHsJDw3bU517zskEUXM8n6nMxHWmCAdAeSSMfj8
         fldwMndYdl9wIpDCD7I4Sid/cTx9vgOqU0w8MG7uEjxcXU5zPM2DXhuiQCBOpk/xGwj7
         tQ/u80ievPhp7k8WhZazDZO5AG6N1PyKxXewYx/niEYw2sto21ocw2Sma9KdW6salie+
         DBMOjZDC9SLH6nHn0XVQrztXzpXC4y5iztFqjT4hnkQYNl5yxz2E86Q/7zkbQeeV2jgc
         bJCBuo0PVruILuWJ/xqdJbdqs5XD8AJVLnttIYjlaT3KIx0ekqrk+3k1kgJ13L3eT6Ot
         JOAQ==
X-Gm-Message-State: ALoCoQlroCw2H8WPBmcsmyKKmyIPAItGhdjpBa+BVIaQIIQie/zLrttwiJGcoShYZwUNLmiVpMDVyjh4WjotAX4mNebpqZU6W4LRqi+o53WgMaLzQyr/9qk=
MIME-Version: 1.0
X-Received: by 10.107.34.199 with SMTP id i190mr44021883ioi.150.1450291192748;
 Wed, 16 Dec 2015 10:39:52 -0800 (PST)
Received: by 10.107.62.136 with HTTP; Wed, 16 Dec 2015 10:39:52 -0800 (PST)
In-Reply-To: <1A4A9DE8-ACF3-4FEB-BE4E-756E850ACF39@greenbytes.de>
References: <1A4A9DE8-ACF3-4FEB-BE4E-756E850ACF39@greenbytes.de>
Date: Wed, 16 Dec 2015 12:39:52 -0600
Message-ID: <CACsi252gHmgbY52XJf4myZ-9G2K7fKeEfMyqMk3UZjw-mrapBw@mail.gmail.com>
Subject: Re: variables
From: William A Rowe Jr <wrowe@rowe-clan.net>
To: httpd <dev@httpd.apache.org>
Content-Type: multipart/alternative; boundary=001a1140d9445da73a0527083bf5

--001a1140d9445da73a0527083bf5
Content-Type: text/plain; charset=UTF-8

On Wed, Dec 16, 2015 at 5:40 AM, Stefan Eissing <
stefan.eissing@greenbytes.de> wrote:

>
> Subprocesses get their environment via r->subprocess_env, filled via the
> "fixups" hook. This is the usual way how we involve modules in request
> processing. But, as I read it, subprocess_env gets filled with all
> variables for every request, even though they maybe never read? Hmm,
> probably a little late to do anything about that without code breakage.
>

Not 'all', that's what
https://httpd.apache.org/docs/current/mod/mod_ssl.html#ssloptions
overrides.  While the 'classic' http variables are a pretty short list,
mod_ssl is
capable of creating a very large list of variables, interesting to only a
few cases.

HTTPS=on|off is always there, and HTTP2=on|off would be similarly helpful
and
very low impact.

--001a1140d9445da73a0527083bf5
Content-Type: text/html; charset=UTF-8
Content-Transfer-Encoding: quoted-printable

<div dir=3D"ltr"><div class=3D"gmail_extra"><div class=3D"gmail_quote">On W=
ed, Dec 16, 2015 at 5:40 AM, Stefan Eissing <span dir=3D"ltr">&lt;<a href=
=3D"mailto:stefan.eissing@greenbytes.de" target=3D"_blank">stefan.eissing@g=
reenbytes.de</a>&gt;</span> wrote:<br><blockquote class=3D"gmail_quote" sty=
le=3D"margin:0px 0px 0px 0.8ex;border-left-width:1px;border-left-color:rgb(=
204,204,204);border-left-style:solid;padding-left:1ex"><br>
Subprocesses get their environment via r-&gt;subprocess_env, filled via the=
 &quot;fixups&quot; hook. This is the usual way how we involve modules in r=
equest processing. But, as I read it, subprocess_env gets filled with all v=
ariables for every request, even though they maybe never read? Hmm, probabl=
y a little late to do anything about that without code breakage.<br></block=
quote><div><br></div><div>Not &#39;all&#39;, that&#39;s what=C2=A0<a href=
=3D"https://httpd.apache.org/docs/current/mod/mod_ssl.html#ssloptions">http=
s://httpd.apache.org/docs/current/mod/mod_ssl.html#ssloptions</a></div><div=
>overrides.=C2=A0 While the &#39;classic&#39; http variables are a pretty s=
hort list, mod_ssl is</div><div>capable of creating a very large list of va=
riables, interesting to only a few cases.</div></div><br></div><div class=
=3D"gmail_extra">HTTPS=3Don|off is always there, and HTTP2=3Don|off would b=
e similarly helpful and</div><div class=3D"gmail_extra">very low impact.</d=
iv></div>

--001a1140d9445da73a0527083bf5--

From dev-return-85090-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Fri Dec 18 11:36:00 2015
Return-Path: <dev-return-85090-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id C962518DAA
	for <apmail-httpd-dev-archive@www.apache.org>; Fri, 18 Dec 2015 11:36:00 +0000 (UTC)
Received: (qmail 48148 invoked by uid 500); 18 Dec 2015 11:36:00 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 48057 invoked by uid 500); 18 Dec 2015 11:35:59 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 48047 invoked by uid 99); 18 Dec 2015 11:35:59 -0000
Received: from Unknown (HELO spamd3-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Fri, 18 Dec 2015 11:35:59 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd3-us-west.apache.org (ASF Mail Server at spamd3-us-west.apache.org) with ESMTP id 5D9BA1804B0
	for <dev@httpd.apache.org>; Fri, 18 Dec 2015 11:35:59 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd3-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 0.195
X-Spam-Level:
X-Spam-Status: No, score=0.195 tagged_above=-999 required=6.31
	tests=[KAM_INFOUSMEBIZ=0.75, RP_MATCHES_RCVD=-0.554, SPF_PASS=-0.001]
	autolearn=disabled
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd3-us-west.apache.org [10.40.0.10]) (amavisd-new, port 10024)
	with ESMTP id CRd9XrfOFtry for <dev@httpd.apache.org>;
	Fri, 18 Dec 2015 11:35:57 +0000 (UTC)
Received: from mx.lenk.info (mail.lenk.info [188.40.85.232])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id 218C821157
	for <dev@httpd.apache.org>; Fri, 18 Dec 2015 11:35:57 +0000 (UTC)
Received: from [192.168.77.232] (port=56390 helo=mailstore.lenk.local)
	by mx.lenk.info with esmtp (Exim 4.82_1-5b7a7c0-XX)
	(envelope-from <micha@lenk.info>)
	id 1a9tJz-00084A-3A
	for dev@httpd.apache.org; Fri, 18 Dec 2015 12:35:39 +0100
Received: from webmail.lenk.info (localhost [IPv6:::1])
	by mailstore.lenk.local (Postfix) with ESMTP id 1849A1A0E6
	for <dev@httpd.apache.org>; Fri, 18 Dec 2015 12:35:39 +0100 (CET)
Received: from M/x4GRJm6m5zenIsADdhKsS59ZL/Ktnm
 by mail.lenk.info
 with HTTP (HTTP/1.1 POST); Fri, 18 Dec 2015 12:35:39 +0100
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8;
 format=flowed
Content-Transfer-Encoding: 8bit
Date: Fri, 18 Dec 2015 12:35:39 +0100
From: Micha Lenk <micha@lenk.info>
To: dev@httpd.apache.org
Subject: Segfault on graceful reload with OCSP stapling
 =?UTF-8?Q?enabled=3F?=
Message-ID: <46101845eb5031d002e86140f2980c7e@mail.lenk.info>
X-Sender: micha@lenk.info
User-Agent: Roundcube Webmail/1.0.5

Hi all,

I am currently observing a httpd segfault that is triggered on my system 
by every second graceful reload (i.e. SIGUSR1).

Unfotunately I won't be able to trace this down before Monday, so this 
is merely a heads-up for those interested.
Is anybody able to reproduce this behavior?

This is my configuration:

     SSLStaplingCache shmcb:cache/ocsp_cache(128000)
     SSLUseStapling on
     SSLStaplingResponderTimeout 5
     SSLStaplingReturnResponderErrors off

Thanks in advance for any helpful comments...

Cheerds,
Micha

BTW: The backtrace looks like this (however, please note that this is a 
patched http 2.4.16, so line numbers might be off a bit):

(gdb) bt full
#0  0x7d50537b in ?? ()
No symbol table info available.
#1  0x0829af5c in find_entry (ht=0x88e7f68, key=0xffffcfc0, klen=20, 
val=0x0) at tables/apr_hash.c:294
         hep = <optimized out>
         he = <optimized out>
         hash = <optimized out>
#2  0x0829b04b in apr_hash_get (ht=0x88e7f68, key=0xffffcfc0, klen=20) 
at tables/apr_hash.c:367
         he = <optimized out>
#3  0x0818f059 in ssl_stapling_init_cert (s=0x8602c78, p=0x84cf0a8, 
ptemp=0x8520e98, mctx=0x89e87a8, x=0x8a29a58) at ssl_util_stapling.c:120
         idx = "\226i\327w\347\200[=\272\333\364f\263\232PKKJ"
         cinf = <optimized out>
         issuer = <optimized out>
         cid = <optimized out>
         aia = <optimized out>
#4  0x0818145d in ssl_init_server_ctx (pphrases=<optimized out>, 
sc=<optimized out>, ptemp=<optimized out>, p=<optimized out>, 
s=<optimized out>) at ssl_engine_init.c:1457
No locals.
#5  ssl_init_ConfigureServer (s=0x8602c78, p=0x84cf0a8, ptemp=0x8520e98, 
sc=0x89e8660, pphrases=0x865a0f0) at ssl_engine_init.c:1499
         rv = 0
#6  0x08181b3a in ssl_init_Module (p=0x84cf0a8, plog=0x850e2e0, 
ptemp=0x8520e98, base_server=0x8502fd0) at ssl_engine_init.c:314
         mc = <optimized out>
         sc = <optimized out>
         s = 0x8602c78
         rv = 0
         pphrases = 0x865a0f0
#7  0x080d32c0 in ap_run_post_config (pconf=0x84cf0a8, plog=0x850e2e0, 
ptemp=0x8520e98, s=0x8502fd0) at config.c:103
         n = 2
         rv = 2102416251
#8  0x080b6fa5 in main (argc=139251872, argv=0x864ef88) at main.c:777
         c = 68 'D'
         showcompile = 0
         showdirectives = 0
         confname = 0xffffd42e "/var/lib/usp/hsp/hts/conf/httpd.conf"
         def_server_root = 0xffffd416 "/var/lib/usp/hsp/hts"
         temp_error_log = 0x0
         error = <optimized out>
         process = 0x84cd130
         pconf = 0x84cf0a8
         plog = 0x850e2e0
         ptemp = 0x8520e98
         pcommands = 0x84f1130
         opt = 0x84f11d0
         rv = <optimized out>
         opt_arg = 0xffffd455 "SSL"

From dev-return-85091-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Sun Dec 20 07:15:17 2015
Return-Path: <dev-return-85091-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 3D40C186CB
	for <apmail-httpd-dev-archive@www.apache.org>; Sun, 20 Dec 2015 07:15:17 +0000 (UTC)
Received: (qmail 80902 invoked by uid 500); 20 Dec 2015 07:15:16 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 80842 invoked by uid 500); 20 Dec 2015 07:15:16 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 80833 invoked by uid 99); 20 Dec 2015 07:15:16 -0000
Received: from mail-relay.apache.org (HELO mail-relay.apache.org) (140.211.11.15)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 20 Dec 2015 07:15:16 +0000
Received: from asf-bz1-us-mid.priv.apache.org (nat1-us-mid.apache.org [23.253.172.122])
	by mail-relay.apache.org (ASF Mail Server at mail-relay.apache.org) with ESMTPS id EFB061A038E
	for <dev@httpd.apache.org>; Sun, 20 Dec 2015 07:15:15 +0000 (UTC)
Received: by asf-bz1-us-mid.priv.apache.org (ASF Mail Server at asf-bz1-us-mid.priv.apache.org, from userid 0)
	id 4643660044; Sun, 20 Dec 2015 07:15:15 +0000 (UTC)
From: bugzilla@apache.org
To: dev@httpd.apache.org
Subject: Bug report for Apache httpd-2 [2015/12/20]
Message-Id: <20151220071515.4643660044@asf-bz1-us-mid.priv.apache.org>
Date: Sun, 20 Dec 2015 07:15:05 +0000 (UTC)

+---------------------------------------------------------------------------+
| Bugzilla Bug ID                                                           |
|     +---------------------------------------------------------------------+
|     | Status: UNC=Unconfirmed NEW=New         ASS=Assigned                |
|     |         OPN=Reopened    VER=Verified    (Skipped Closed/Resolved)   |
|     |   +-----------------------------------------------------------------+
|     |   | Severity: BLK=Blocker CRI=Critical  REG=Regression  MAJ=Major   |
|     |   |           MIN=Minor   NOR=Normal    ENH=Enhancement TRV=Trivial |
|     |   |   +-------------------------------------------------------------+
|     |   |   | Date Posted                                                 |
|     |   |   |          +--------------------------------------------------+
|     |   |   |          | Description                                      |
|     |   |   |          |                                                  |
| 7483|Ass|Enh|2002-03-26|Add FileAction directive to assign a cgi interpret|
| 8713|Inf|Min|2002-05-01|No Errorlog on PROPFIND/Depth:Infinity            |
| 8867|Opn|Cri|2002-05-07|exports.c generation fails when using a symlink to|
|10747|New|Maj|2002-07-12|ftp SIZE command and 'smart' ftp servers results i|
|11294|New|Enh|2002-07-30|desired vhost_alias option                        |
|11580|Opn|Enh|2002-08-09|generate Content-Location headers                 |
|12033|Opn|Nor|2002-08-26|Graceful restart immediately result in [warn] long|
|12680|New|Enh|2002-09-16|Digest authentication with integrity protection   |
|13599|Inf|Nor|2002-10-14|autoindex formating broken for multibyte sequences|
|13661|Ass|Enh|2002-10-15|Apache cannot not handle dynamic IP reallocation  |
|14104|Opn|Enh|2002-10-30|not documented: must restart server to load new CR|
|14496|New|Enh|2002-11-13|Cannot upgrade any version on Windows. Must uninst|
|14922|Inf|Enh|2002-11-28|<target> is currently hardcoded to 'apache2'      |
|15719|Inf|Nor|2002-12-30|WebDAV MOVE to destination URI which is content-ne|
|16761|Inf|Nor|2003-02-04|CustomLog with pipe spawns process during config  |
|16802|New|Enh|2003-02-05|Additional AllowOverride directive "Restrict"     |
|16811|Ass|Maj|2003-02-05|mod_autoindex always return webpages in UTF-8.    |
|17107|New|Min|2003-02-16|Windows should not install printenv               |
|17114|New|Enh|2003-02-17|Please add strip and install-strip targets to Make|
|17244|Ass|Nor|2003-02-20|./configure --help gives false information regardi|
|17497|Opn|Nor|2003-02-27|mod_mime_magic generates incorrect response header|
|18325|New|Enh|2003-03-25|PAM support for suEXEC                            |
|18334|Inf|Cri|2003-03-25|Server crashes when authenticating users against L|
|18497|New|Min|2003-03-30|configure --help gives wrong default for sysconfdi|
|19043|New|Min|2003-04-15|Interesting interaction between cern_meta module a|
|19670|New|Enh|2003-05-05|content type header supplied upon PUT is thrown aw|
|20036|Ass|Nor|2003-05-19|Trailing Dots stripped from PATH_INFO environment |
|21253|New|Nor|2003-07-01|Mime magic doesn't continue if type is specifed fo|
|21260|New|Nor|2003-07-02|CacheMaxExpire directive not enforced !           |
|21533|Ass|Cri|2003-07-11|Multiple levels of htacces files can cause mod_aut|
|22138|Inf|Cri|2003-08-05|Webdav is not preccessing special chars right.    |
|22237|New|Enh|2003-08-08|option to disable ServerSignature on index pages  |
|22484|Opn|Maj|2003-08-16|semaphore problem takes httpd down                |
|22686|Opn|Nor|2003-08-25|ab: apr_poll: The timeout specified has expired (7|
|22898|Opn|Nor|2003-09-02|nph scripts with two HTTP header                  |
|23167|Inf|Cri|2003-09-14|--enable-layout never goes to apr apr-util        |
|23181|New|Nor|2003-09-15|Status 304 (Not modified) and chunking leads to an|
|23238|New|Cri|2003-09-18|non-async-signal-safe operations from signal handl|
|23330|New|Enh|2003-09-22|Enhance ApacheMonitor to view and control Tomcat s|
|23911|Opn|Cri|2003-10-18|CGI processes left defunct/zombie under 2.0.54    |
|24031|New|Enh|2003-10-23|Passphrase protected private key in SSLProxyMachin|
|24095|Opn|Cri|2003-10-24|ERROR "Parent: child process exited with status 32|
|24437|Opn|Nor|2003-11-05|mod_auth_ldap doubly-escapes backslash (\) charact|
|24890|Opn|Nor|2003-11-21|Apache config parser should not be local aware ( g|
|25014|New|Enh|2003-11-26|A flexible interface for mod_log_config           |
|25201|New|Enh|2003-12-04|Provide Cache Purge operation                     |
|25240|Inf|Enh|2003-12-05|SSL Library Error: 336105671 logged as information|
|25435|New|Enh|2003-12-11|sethandler and directoryindex not playing nice    |
|25469|Opn|Enh|2003-12-12|create AuthRoot for defining paths to auth files  |
|25484|Ass|Nor|2003-12-12|Non-service Apache cannot be stopped in WinXP     |
|25543|Inf|Nor|2003-12-15|mod_proxy_ajp overwrites existing response headers|
|25667|New|Nor|2003-12-19|Memory leak in function ssl_scache_dbm_retrieve().|
|25863|New|Enh|2004-01-02|new per-host initialization hooks                 |
|26005|New|Nor|2004-01-08|SERVER_NAME incorrect when using IPv6 address in U|
|26142|New|Maj|2004-01-14|EnableSendFile Off for Windows XP Home            |
|26153|Opn|Cri|2004-01-15|Apache cygwin directory traversal vulnerability   |
|26368|New|Min|2004-01-23|File extensions in AddDescription treated as part |
|26446|New|Nor|2004-01-26|flush buckets followed by eos bucket emit multiple|
|26478|New|Enh|2004-01-28|mod_dav does not expose a method for setting the D|
|26835|New|Enh|2004-02-10|[PATCH] Mod_status Readability & Browser Side Tabl|
|27257|Ass|Enh|2004-02-26|rotatelogs with getopt and setuid                 |
|27578|New|Enh|2004-03-10|made getlastmodified a writable property          |
|27715|Ass|Enh|2004-03-16|Client sending misformed Range "bytes = 0-100" ins|
|27791|Inf|Nor|2004-03-18|mod_cache doesn't re-cache expired content        |
|27835|New|Enh|2004-03-22|When proxying FTP, all errors turns into 404      |
|27869|New|Enh|2004-03-23|stopping and starting httpd again immediately caus|
|28854|Inf|Nor|2004-05-09|Build fails with missing library call on Solaris i|
|28903|New|Enh|2004-05-11|Hooks to add environment variables to CGI and othe|
|29090|Ass|Enh|2004-05-19|MultiviewsMatch NegotiatedOnly extensions not resp|
|29165|New|Nor|2004-05-24|Parent directory icon not correct                 |
|29446|New|Enh|2004-06-08|want directive for setting content negotiation qua|
|29449|New|Enh|2004-06-09|Limit length of specified fields in LogFormat     |
|29450|New|Enh|2004-06-09|Improved logging for mod_access                   |
|29510|Ass|Enh|2004-06-10|ab does not support multiple cookies              |
|29644|Ver|Nor|2004-06-17|mod_proxy keeps downloading even after the client |
|29755|Opn|Nor|2004-06-23|mod_usertrack should use err_headers_out          |
|29822|New|Enh|2004-06-26|implement FTP 'PUT' support in proxy_ftp.c        |
|29941|Ass|Enh|2004-07-06|log files are not tested for availability on confi|
|30259|Ass|Enh|2004-07-22|When proxy connects to backend, a DNS lookup is do|
|30505|Ass|Enh|2004-08-05|Apache uses 'Error', and not lower level event typ|
|30730|Inf|Nor|2004-08-18|[PatchAvailable] mod_actions and Server-Status    |
|30865|Inf|Maj|2004-08-26|mod_disk_cache leaves many temporary files slowing|
|31302|Opn|Cri|2004-09-19|suexec doesn't execute commands if they're not in |
|31311|New|Enh|2004-09-20|Remote user not logged in reverse proxy scenario  |
|31352|Ass|Enh|2004-09-21|RFE, Bind to LDAP server with browser supplier use|
|31418|Opn|Nor|2004-09-25|SSLUserName is not usable by other modules        |
|31484|New|Maj|2004-09-30|Custom environment variables not passed to content|
|31490|New|Nor|2004-09-30|mod_proxy_ftp renders filenames with spaces badly |
|31565|New|Enh|2004-10-06|Won't start correctly if parent closed stdin, stdo|
|31679|New|Enh|2004-10-12|If the argument of a CGI has two or more consecuti|
|31709|Inf|Nor|2004-10-13|Raises an error on SSL name based virtualhosts (wi|
|31712|New|Enh|2004-10-14|config_file is NULL at ap_walk_config etc         |
|31952|New|Enh|2004-10-29|mod_proxy and RealPlayer: audio content streaming |
|32051|Opn|Nor|2004-11-04|mod_example is not thread safe                    |
|32328|Opn|Enh|2004-11-19|Make mod_rewrite escaping optional / expose intern|
|32346|New|Enh|2004-11-22|mod_include/include virtual checks content-type is|
|32524|New|Enh|2004-12-03|ab: add an option to specify a source address     |
|32703|Inf|Enh|2004-12-14|Cannot determine that Apache is frozen if /var fil|
|32750|Ass|Maj|2004-12-17|mod_proxy + Win32DisableAcceptEx = memory leak    |
|32877|New|Enh|2004-12-29|wrong utf-8 encoding/escaping in a href for umlaut|
|33084|New|Enh|2005-01-13|Optional certificate validity period check on SSLV|
|33089|New|Nor|2005-01-13|mod_include: Options +Includes (or IncludesNoExec)|
|33207|New|Nor|2005-01-23|Results of my suexec.c code audit                 |
|33215|New|Nor|2005-01-24|Cygwin build/install.sh fix (OSTYPE => ext=.exe)  |
|33512|Inf|Maj|2005-02-11|mod_mem_cache and possibly mod_deflate            |
|33627|New|Nor|2005-02-18|Bite-sized changes making progress towards compila|
|33685|New|Maj|2005-02-22|Unable to install in the path containing non engli|
|34270|Inf|Nor|2005-04-01|Large POSTs over SSL from Internet Explorer do not|
|34375|New|Enh|2005-04-08|enhancements for mod_include                      |
|34377|New|Enh|2005-04-08|Allow the overriding of 401 Unauthorized returns f|
|34405|New|Enh|2005-04-11|adds DOCUMENT_NAME_WITHOUT_SUFFIX to mod_include  |
|34508|New|Nor|2005-04-19|Randomly slow graceful restart, not accepting new |
|34519|New|Enh|2005-04-19|Directory index should emit valid XHTML           |
|35049|New|Nor|2005-05-24|let AddDefaultCharset apply to text/css and applic|
|35077|New|Nor|2005-05-26|mod_dav passes incorrect paths with LocationMatch |
|35083|Inf|Enh|2005-05-26|Certificate validation problems trapping          |
|35098|Ver|Maj|2005-05-27|Install fails using --prefix                      |
|35154|New|Nor|2005-06-01|Support for NID_serialNumber, etc. in SSLUserName |
|35245|New|Nor|2005-06-06|cache ignores max-age cache-directive in requests |
|35250|New|Enh|2005-06-07|[PatchAvailable] add logging to mod_proxy_connect |
|35280|New|Nor|2005-06-09|FTP proxy breaks RFC 2428 when trying to fall back|
|35556|Inf|Nor|2005-06-30|CRL files not re-read by HUP                      |
|35652|Opn|Min|2005-07-07|Improve error message: "pcfg_openfile: unable to c|
|35702|New|Nor|2005-07-12|Using with https URL, ab freezes or gets SIGSEGV o|
|35781|New|Nor|2005-07-18|ap_sub_req_method_uri() bypasses Limit security co|
|35981|Inf|Maj|2005-08-02|mod_dav overrides dav_fs response on PUT failure  |
|36286|New|Enh|2005-08-20|configtest doesn't check SSL certificates         |
|36492|New|Nor|2005-09-04|split-logfile script dies when splitting log of ma|
|36495|Inf|Nor|2005-09-05|mod_proxy_ajp: ajp_check_msg_header() got bad sign|
|36564|New|Enh|2005-09-08|make mod_ldap really universal                    |
|36636|New|Maj|2005-09-13|database write lock taken for PROPFIND operations |
|36676|New|Nor|2005-09-15|time() bug in httpd/os/win32/util_win32.c:wait_for|
|36710|Opn|Blk|2005-09-19|CGI output not captured                           |
|36724|New|Nor|2005-09-20|Don't install Apache Monitor by default           |
|37110|New|Nor|2005-10-17|Build fails when source tree is read-only         |
|37196|Inf|Min|2005-10-21|Wrong "Parent directory" link                     |
|37201|New|Enh|2005-10-21|Add <IfInterface IP> syntax to apache configuratio|
|37290|Opn|Min|2005-10-28|DirectoryIndex don't work in scriptaliased directo|
|37307|New|Enh|2005-10-31|Can't suppress error messages                     |
|37355|New|Enh|2005-11-04|Allow to specify Proxy-Authorization in ProxyRemot|
|37360|New|Maj|2005-11-04|Install fails on Windows XP x64 when program files|
|37402|New|Nor|2005-11-08|mod_proxy has stopped allowing POST sub-requests  |
|37514|Inf|Nor|2005-11-15|mod_proxy buffers chunked data.                   |
|37564|New|Enh|2005-11-19|Suggestion: mod_suexec SuexecUserGroup directive i|
|37587|Inf|Min|2005-11-22|mod_status Total Traffic value goes up then down? |
|37770|Opn|Blk|2005-12-03|proxy: error reading status line from remote serve|
|37823|Inf|Nor|2005-12-07|The openssl library linked is different between ht|
|37920|New|Maj|2005-12-15|mod_proxy does not flush data on POST requests fro|
|38116|New|Enh|2006-01-04|Chroot-Patch for SuExec                           |
|38164|New|Nor|2006-01-06|wrong status code for failed COPY/MOVE            |
|38182|New|Nor|2006-01-08|COPY ignores authority in Destination header      |
|38218|New|Enh|2006-01-10|Multiline Comments for *.conf files               |
|38240|Inf|Nor|2006-01-12|apache restart segfault with mutliple Include dire|
|38325|Opn|Nor|2006-01-20|impossible to determine AUTH_TYPE of interpreted r|
|38355|Unc|Enh|2006-01-23|DSO support for mod_rewrite                       |
|38369|New|Enh|2006-01-24|mod_proxy keeps alive connections that should be b|
|38408|New|Nor|2006-01-27|SSI environment vars not set in spawned processes |
|38419|New|Nor|2006-01-27|Problems with large WebDAV properties             |
|38478|New|Maj|2006-02-01|A client starting a SSL renegotiation can crash th|
|38515|New|Enh|2006-02-05|Dynamic LDAP Group Support                        |
|38550|New|Enh|2006-02-07|Setting headers based on proxied data             |
|38571|New|Enh|2006-02-08|CustomLog directive checked by apachectl configtes|
|38756|Inf|Nor|2006-02-22|errors with running make                          |
|38786|New|Nor|2006-02-26|"IndexOption VersionSort" has problems with traili|
|38827|New|Reg|2006-03-02|mod_disk_cache trying to rename locked tempfile on|
|38864|Inf|Enh|2006-03-06|ProxyPassReverse fails in <Location>              |
|38903|New|Maj|2006-03-09|r->allowed does not affect Allow response header  |
|38923|New|Min|2006-03-10|mod_speling incorrectly escapes linked URLs       |
|38928|New|Min|2006-03-11|propose removing "VARIANTS" feature               |
|38995|New|Nor|2006-03-16|httpd tries to communicate with the CGI daemon eve|
|39111|New|Nor|2006-03-27|Potential bug brought by mmapfile (mod_file_cache)|
|39128|Inf|Maj|2006-03-28|Apache 2.2 will not compile mod_ssl library's corr|
|39185|Inf|Nor|2006-04-03|Approximately in 1-2 weeks of work the server hang|
|39216|New|Maj|2006-04-05|mod_disk_cache trying to rename locked file, decre|
|39238|New|Nor|2006-04-07|mod_auth_dbm requires mod_auth or "no groups file?|
|39275|Opn|Nor|2006-04-11|slow child_init causes MaxClients warning         |
|39287|New|Nor|2006-04-12|Incorrect If-Modified-Since validation (due to syn|
|39299|New|Nor|2006-04-13|Internal Server Error (500) on COPY               |
|39329|Inf|Nor|2006-04-17|mod_dbd reconnection and prepared statements      |
|39370|New|Nor|2006-04-20|SSL session will be removed if the client is sendi|
|39380|Inf|Nor|2006-04-21|mod_disk_cache eats memory, has no LFS support, et|
|39418|New|Nor|2006-04-26|CacheMaxExpire directive not enforced             |
|39448|New|Min|2006-04-29|old-style <directory proxy:*> doesn't give any war|
|39498|New|Nor|2006-05-06|accept_filter in apr assumes if found in sys/socke|
|39517|New|Nor|2006-05-08|Corrupt chunked transfer-encoding with Content Neg|
|39658|Opn|Nor|2006-05-25|mod_proxy_ajp SSL Key Size Bug                    |
|39673|New|Nor|2006-05-29|mod_proxy opens connections that disturb NTLM     |
|39692|New|Nor|2006-05-31|mod_proxy_balancer doesn't retry a failed request |
|39723|Inf|Enh|2006-06-05|Forward proxy does not work in tranparent mode    |
|39727|Ass|Nor|2006-06-05|Incorrect ETag on gzip:ed content                 |
|39730|New|Nor|2006-06-06|LanguagePriority and DefaultLanguage are Case Sens|
|39737|New|Nor|2006-06-06|LogFormat "%{tid}P" reports wrong thread id on Win|
|39748|New|Enh|2006-06-07|Header and POST support for mod_include           |
|39753|New|Nor|2006-06-07|incorrect source for LOCALE Decimal Symbol in Win2|
|39785|Inf|Nor|2006-06-12|Status code 408 (Request Timeout) is not logged   |
|39807|Opn|Enh|2006-06-13|large files / filesystem corruption can cause apac|
|39902|New|Nor|2006-06-27|HeaderName directive breaks mod_filter somehow    |
|39904|New|Nor|2006-06-27|graceful restart error and cpu load               |
|39913|Ass|Blk|2006-06-27|detection of static OpenSSL libraries requiring li|
|39916|New|Nor|2006-06-28|Core Filters & non-blocking Sendfile              |
|39923|New|Nor|2006-06-28|AddDescription doesn't work in server config with |
|39928|New|Nor|2006-06-28|port no detected when file name not in URL        |
|39935|New|Nor|2006-06-29|AddDescription does not do literal comparisons on |
|39973|Ass|Enh|2006-07-06|apache software folder should be movable          |
|40035|New|Cri|2006-07-13|Windows Server 2003 "("R2")" 64-Bit Edition no cgi|
|40060|New|Nor|2006-07-17|AuthGroupFile should accept /etc/group syntax     |
|40075|New|Enh|2006-07-19|unable to use ldap groups that contain DNs and use|
|40102|Opn|Nor|2006-07-24|SCRIPT_NAME set incorrectly with mod_rewrite      |
|40146|New|Nor|2006-07-31|mod_ssl info in server_info is blank              |
|40174|New|Min|2006-08-03|Unable to get IndexOptionis ScanHTMLTitles to work|
|40180|Inf|Maj|2006-08-03|Mod_dav and remove folder doesn't work with Micros|
|40190|New|Nor|2006-08-05|translate file                                    |
|40196|New|Nor|2006-08-06|EILSEQ handling, NoImplicitAdd should work, and so|
|40217|Opn|Nor|2006-08-08|mod_dav PROPFIND ignores access restrictions on it|
|40266|Inf|Blk|2006-08-16|berkeley db support in httpd is screwed           |
|40312|New|Nor|2006-08-24|ssl_engine_init.c, ssl_init_ctx_verify contains a |
|40373|New|Nor|2006-08-31|mod_dir adds trailing slash after internal redirec|
|40408|New|Blk|2006-09-04|Apache 2.2.3 is not starting                      |
|40416|New|Maj|2006-09-05|mod_proxy_ftp cannot connect under http load in fo|
|40441|New|Enh|2006-09-08|intelligently handling dynamic subdomains         |
|40453|New|Nor|2006-09-09|lexicographic compare in RewriteCond isn't lexicog|
|40463|New|Nor|2006-09-11|piped logging causes some weird kill()ing         |
|40513|Opn|Maj|2006-09-14|Seeding PRNG with 0 bytes of entropy              |
|40514|New|Nor|2006-09-14|would like GracefulShutdownTimeout to work for gra|
|40540|Inf|Nor|2006-09-19|Bad interaction between MultiViews and SetOutputFi|
|40541|New|Nor|2006-09-19|Action rewrites URI used by Location?             |
|40571|New|Nor|2006-09-21|mod_proxy_ajp don't works with mod_usertrack      |
|40586|New|Enh|2006-09-22|Add option to supress default '-' output          |
|40746|New|Enh|2006-10-12|Feature request: ProxyAllow directive             |
|40749|New|Min|2006-10-12|magic file with string and "%n" causes Apache chil|
|40781|New|Nor|2006-10-17|PATH_TRANSLATED: 'redirect:/~jablko/gallery2/main.|
|40808|New|Enh|2006-10-23|ProxyRemote with optional proxy authentication    |
|40859|New|Enh|2006-11-01|[PATCH] Support -F force option to 'ab' support to|
|40917|New|Nor|2006-11-07|configure does not detect OpenSSL shared lib on HP|
|40953|New|Min|2006-11-12|Should not send any data in 1xx/204/304 reply from|
|40984|Inf|Enh|2006-11-16|AddIcon, AddIconByType for OpenDocument format    |
|40987|Opn|Enh|2006-11-16|ProxyVia Block doesn't remove Via: header for reve|
|41000|New|Nor|2006-11-19|mod_authn_dbd have an error, in function 'authn_db|
|41025|New|Nor|2006-11-23|ROBOTS META-Tag directive needed in mod_autoindex |
|41088|New|Nor|2006-11-30|installation backcolor is wrong (white)           |
|41111|New|Enh|2006-12-05|New option for filters: run only if there are spar|
|41114|New|Blk|2006-12-06|ACL HTTP method is rejected by mod_proxy_ajp      |
|41130|New|Nor|2006-12-07|mod_mime and mod_negotiation type-map both clobber|
|41143|Opn|Nor|2006-12-10|Incorrect ap_getline assumption in mod_proxy_http |
|41195|New|Nor|2006-12-17|properly set the parent pid on shutdown           |
|41196|New|Nor|2006-12-17|worker mpm usage of apr's memory pools is not thre|
|41200|Inf|Maj|2006-12-18|SSI include, prevent client from receiving full ou|
|41240|Inf|Enh|2006-12-25|BRF files support                                 |
|41262|Inf|Nor|2006-12-29|Embedded pcre causes runtime segfault             |
|41362|Inf|Maj|2007-01-14|mod_disk_cache and mod_include conflict generating|
|41375|Inf|Min|2007-01-15|Using same SSL Certificate with different ServerNa|
|41391|New|Min|2007-01-17|too long period setting makes max-age overflow    |
|41412|New|Enh|2007-01-19|RewriteRule Skip should take negative arguments   |
|41435|New|Nor|2007-01-22|Authentication fails with 500 Server Error        |
|41450|Inf|Cri|2007-01-24|Empty page (200 OK) while max-age is empty        |
|41485|New|Nor|2007-01-28|LDAP client certificates not usable in 2.2.x/trunk|
|41529|New|Enh|2007-02-02|Accept BOM in .htaccess                           |
|41556|New|Enh|2007-02-07|Feature Request: format string for masking ip addr|
|41621|New|Maj|2007-02-15|Apache 2.2.4 backend problem with Apache 2.0.59 Re|
|41646|New|Nor|2007-02-16|wrong headers are sent for HEAD requests when Prox|
|41676|Opn|Enh|2007-02-22|Refactor mod_proxy_ftp                            |
|41685|New|Enh|2007-02-22|Implement optional HTTP Authentication in a standa|
|41712|Inf|Nor|2007-02-26|threads locked at logging state                   |
|41729|New|Maj|2007-02-28|error message: ap_get_scoreboard_lb(130) failed in|
|41744|Inf|Maj|2007-03-01|SSI resolves includes but removes original HTML   |
|41763|Opn|Nor|2007-03-05|mod_disk_cache ignores CacheDirLevels and CacheDir|
|41764|New|Nor|2007-03-05|error state and conf                              |
|41771|Inf|Nor|2007-03-06|Erro with mod_proxy_ajp or mod_prox_balancer      |
|41867|New|Nor|2007-03-16|<DirectoryMatch> Matches Files                    |
|41925|New|Nor|2007-03-21|trivial patch to add automatic crypting to 'dbmman|
|41929|New|Nor|2007-03-22|ISAPI ssl variables                               |
|41953|New|Nor|2007-03-26|pidfile remains when 2nd pass of post-config retur|
|41962|New|Min|2007-03-27|Need mod_auth_ldap to authenticate with Active Dir|
|42027|Inf|Nor|2007-04-02|FileETag directive appears to be ignored          |
|42054|New|Nor|2007-04-04|service name and parameter issues                 |
|42079|New|Nor|2007-04-10|SSLRequire: Additional access in sub-directoies   |
|42082|New|Nor|2007-04-10|filter_init is called multiple times after an INCL|
|42182|Inf|Nor|2007-04-22|Mime types for cached proxied content             |
|42216|New|Enh|2007-04-24|RFE -- external overload procedure                |
|42262|Inf|Nor|2007-04-26|mod_dav /  worker fails to allocate memory and seg|
|42287|Inf|Nor|2007-04-28|chunked encoded response to POST request to cgi sc|
|42368|Inf|Nor|2007-05-09|httpd is crashing if conf/extra/httpd-manual.conf |
|42373|Inf|Maj|2007-05-09|REPORT request fails over mod_proxy               |
|42404|New|Enh|2007-05-13|Filename/info for disk-cached proxied remote URLs |
|42425|Inf|Nor|2007-05-15|Additional freshness checks in mod_cache.c cause m|
|42471|Inf|Nor|2007-05-21|clients with IE7 take 3megs per page load. httpd.e|
|42492|Inf|Nor|2007-05-22|mod_proxy_ajp with SSL front end: data corruption |
|42499|Inf|Nor|2007-05-23|Backslash produces a 404 error instead of going to|
|42548|New|Nor|2007-05-30|INCLUDE negotiating language aborts with APR_POOL_|
|42561|New|Enh|2007-05-31|[PATCH] AuthLDAPRemoteUserAttribute only applies i|
|42633|New|Min|2007-06-11|mod_info gives wrong information about actual conf|
|42665|New|Nor|2007-06-14|spurious attempt to open ".../file.html/.htaccess"|
|42666|New|Nor|2007-06-14|code & docs corrections for FollowSymLinks and Sym|
|42667|New|Nor|2007-06-14|mod_proxy_balancer not reporting when workers are |
|42668|Inf|Nor|2007-06-14|balancer_manager shows Ok status for the workers t|
|42687|New|Nor|2007-06-18|Fully delegate certificate & key semantics to the |
|42688|New|Enh|2007-06-18|engine managed keys: per process openssl context  |
|42690|New|Nor|2007-06-18|realm is not set for each configured directory whe|
|42695|Inf|Cri|2007-06-18|mod_proxy balancer problem                        |
|42699|New|Enh|2007-06-20|share mod_logio data with other modules           |
|42711|New|Enh|2007-06-20|format string for whole log entries not just id   |
|42732|Opn|Maj|2007-06-25|Authentication against database issue.            |
|42763|New|Nor|2007-06-28|graceful-stop/restart loops go loop too far       |
|42923|Inf|Maj|2007-07-17|vhost certificate NOT overriding cert from the _de|
|42972|Inf|Nor|2007-07-25|Certificate list in mod_ssl module context are not|
|42977|New|Nor|2007-07-25|DAV locking is busted when apr-util is built with |
|42987|New|Nor|2007-07-27|Weak Etags in Apache are useless and violate RFC 2|
|43012|New|Nor|2007-08-02|AIX instdso.sh libphp5.so                         |
|43027|New|Enh|2007-08-03|Header in default language                        |
|43033|New|Nor|2007-08-04|apxs does not correctly detect module name (w/o -n|
|43177|New|Nor|2007-08-21|child pid xxxxx exit signal Segmentation fault    |
|43218|New|Nor|2007-08-27|Wrong cert used for vhost if ServerName is same   |
|43220|Opn|Cri|2007-08-27|mod_proxy truncating ajp output                   |
|43249|Inf|Maj|2007-08-30|ldap_simple_bind_s failed when using SUN LDAP Libs|
|43275|New|Enh|2007-08-31|Remove avoidable network transactions in mod_proxy|
|43289|New|Nor|2007-09-02|XBitHack full g+x returns zero sized response on I|
|43308|New|Nor|2007-09-04|Persistent backend connections not supported for R|
|43352|New|Nor|2007-09-11|Apache2: out of memory during heavy webdav files c|
|43441|New|Nor|2007-09-20|Incorrect HTTP status for pre-commit-blocked autov|
|43471|New|Min|2007-09-25|no need to create a global pool on open_scoreboard|
|43481|New|Cri|2007-09-26|AuthLDAPURL must contain a final path of branch?(l|
|43494|New|Nor|2007-09-26|mod_cgid does not kill never ending scripts       |
|43502|New|Enh|2007-09-28|httpd fails to start if log directory does not exi|
|43513|New|Nor|2007-09-29|Persistent backend connections for ProxyPassMatch |
|43532|Inf|Cri|2007-10-02|Error while compiling Apache 2.2.3 on HPUX        |
|43533|Opn|Nor|2007-10-02|Frequent crashes in mod_include's bndm()          |
|43561|New|Nor|2007-10-05|apxs -q anomaly                                   |
|43577|Inf|Blk|2007-10-09|mod_authnz_ldap not working under WLDAP32 (novell/|
|43607|New|Nor|2007-10-11|mod_proxy sends data on closed connections without|
|43649|Opn|Trv|2007-10-18|mod_autoindex is generating invalid XHTML markup  |
|43652|New|Enh|2007-10-18|Suggest small change for big fix with SuExec & Vir|
|43666|New|Nor|2007-10-20|CGI works, but client denied error messages in err|
|43679|New|Enh|2007-10-23|Contributed tests for checking that subrequests ta|
|43723|Inf|Cri|2007-10-29|Apache 2.2.6 segfault when using mod_dbd          |
|43724|New|Cri|2007-10-29|Apache 2.2.6 segfault on url wich not in cache    |
|43755|New|Enh|2007-10-31|Add a SSLOptions to don't fill SSL_CLIENT_VERIFY  |
|43762|New|Enh|2007-10-31|Misleading tips in an error message about internal|
|43777|New|Nor|2007-11-01|Wrong encoding of <href> element in response      |
|43778|New|Nor|2007-11-01|Wrong responses if httpd has not access to some el|
|43785|New|Enh|2007-11-02|Tracking the per-hit impact of mod_include        |
|43792|New|Enh|2007-11-04|Feature proposal - bind phase                     |
|43818|New|Nor|2007-11-08|PROPFIND on -w- collections returns 207 MULTI-STAT|
|43838|New|Enh|2007-11-11|If-Modified-Since request and htcacheclean conflic|
|43895|New|Nor|2007-11-18|mod_mbox improvements                             |
|43897|Inf|Cri|2007-11-18|Huge memory consumption httpd 2.2.6, mod_proxy - m|
|43931|New|Enh|2007-11-21|OpenSSL autoconfig support for mod_ssl            |
|43943|New|Nor|2007-11-22|SHMCB crash due to misalignment and GCC 4 optimiza|
|43958|Inf|Maj|2007-11-26|mod_proxy_balancer not balancing correct in combin|
|43997|Opn|Min|2007-11-29|Only issue "Init: SSL server IP/Port conflict" if |
|44025|Inf|Nor|2007-12-05|Apache 2.2.6 fails to configure on OpenBSD 4.1    |
|44027|Ass|Enh|2007-12-05|Internationalized Domain Name (IDN) support       |
|44031|Opn|Maj|2007-12-06|RemoveHandler inside subdir location              |
|44034|Ass|Enh|2007-12-06|mpm_winnt doesn't call monitor hook               |
|44105|New|Nor|2007-12-19|Core dumps when using Proxy Keepalive             |
|44155|New|Enh|2007-12-31|smarter retry for LDAP_UNAVAILABLE, LDAP_BUSY, etc|
|44181|Opn|Enh|2008-01-07|add UnAlias                                       |
|44188|Inf|Cri|2008-01-08|Empty response for certain requests (mod_proxy as |
|44218|New|Min|2008-01-13|mod_autoindex shows the default icon for files wit|
|44221|Opn|Cri|2008-01-14|CheckCaseOnly On does not stop Multiple Choices ba|
|44250|New|Nor|2008-01-16|OSX 10.5: __THE_PROCESS_HAS_FORKED_AND_YOU_CANNOT_|
|44279|New|Enh|2008-01-22|Add "iterate" flag to apply rule in a loop while p|
|44302|New|Nor|2008-01-27|AuthLDAPURL does not accept ldapi:// urls         |
|44305|New|Nor|2008-01-28|Inconsistent configuration for suexec path        |
|44316|New|Nor|2008-01-28|httpd 2.0 does not follow ScriptAliases when invok|
|44322|New|Enh|2008-01-29|mod_proxy ProxyPassReverseCookieDomain with no dom|
|44351|New|Nor|2008-02-04|File descriptor leak when using prg RewriteMap    |
|44363|Inf|Maj|2008-02-05|Slow file transfers                               |
|44384|Ass|Nor|2008-02-09|mod_ssl on MacOS X 10.5.1 does not work because of|
|44453|New|Nor|2008-02-19|list_hooks.pl doesn't parse declarations that span|
|44476|New|Maj|2008-02-23|Apache service fails to start due to missing depen|
|44503|Inf|Blk|2008-02-27|Errors during SSL handshake                       |
|44518|New|Enh|2008-03-02|Don't set expires header on HTTP redirect.        |
|44578|New|Enh|2008-03-11|mod_authn_dbd option to let database validate pass|
|44601|New|Trv|2008-03-13|Add a lowercase value to Vary header for consisten|
|44602|New|Enh|2008-03-13|Options for modfying Content-Location (relative OR|
|44622|Inf|Nor|2008-03-17|POST fails to SSL vhost with proxy to HTTP backend|
|44631|New|Nor|2008-03-18|with-included-apr fails to work when using a separ|
|44638|New|Nor|2008-03-19|sed error in httpd.spec.in                        |
|44656|New|Nor|2008-03-22|Tries to retrive error document 404 instead of 406|
|44657|New|Enh|2008-03-22|prefer-type, -encoding, and -charset cookie? (as p|
|44670|New|Min|2008-03-25|Apache httpd 2.2.8 : Cannot ./configure when curre|
|44696|Inf|Nor|2008-03-27|mod_cache sometimes serves old content despite hav|
|44730|New|Nor|2008-04-01|duplicate query string in remote server url when u|
|44752|New|Nor|2008-04-03|Suexec does not correctly check that scripts are i|
|44757|New|Enh|2008-04-04|adding stderr buckets to mod_cgi                  |
|44758|New|Enh|2008-04-04|LimitRequestBody undocumented behaviour with proxi|
|44779|New|Enh|2008-04-08|Using commas and semicolons for content negotiatio|
|44855|New|Nor|2008-04-22|irregular balancing with sticky-session after re-e|
|44865|Ass|Nor|2008-04-23|mod_dav's lock database becomes consistently corru|
|44870|Inf|Nor|2008-04-24|process spinning on 100% cpu                      |
|44923|Inf|Min|2008-05-02|consequences of multiple LDAPTrustedGlobalCert    |
|44924|New|Enh|2008-05-02|allow 'CACERTDIR' in mod_ldap                     |
|44940|New|Maj|2008-05-06|Httpd randomly breaks when verifying client certif|
|44981|New|Enh|2008-05-12|Digital Certificates (CN Based) for Authorization |
|45022|New|Nor|2008-05-16|Processing of escaped glob patterns in "Include" d|
|45023|Opn|Reg|2008-05-16|DEFLATE preventing 304 NOT MODIFIED response      |
|45049|Opn|Nor|2008-05-20|mod_mem_cache caches partial content when client c|
|45054|New|Nor|2008-05-21|SSLVerifyClient optional_no_ca is broken          |
|45058|New|Nor|2008-05-21|Mod_SSL does not set AUTH_TYPE with client certifi|
|45078|New|Nor|2008-05-27|mod_proxy stalls when uploading files             |
|45103|Ass|Min|2008-05-30|apachectl should do config test before reload/rest|
|45111|New|Enh|2008-06-01|make mod_usertrack use mod_unique_id if available |
|45116|New|Nor|2008-06-02|fail to check return value of apr_file_dup2() in /|
|45148|New|Enh|2008-06-06|The actual host of the request will be more helpfu|
|45184|New|Enh|2008-06-11|Regular Expression in directive ServerAlias       |
|45187|New|Maj|2008-06-11|Long File name requests gives FORBIDDEN response  |
|45225|New|Nor|2008-06-17|XBitHack breaks DirectoryIndex + MultiViews conten|
|45253|New|Nor|2008-06-23|Unable to build httpd 2.2.9 on Solaris/SPARC      |
|45257|New|Enh|2008-06-23|add (en)force option for UseCanonicalName         |
|45259|New|Enh|2008-06-23|Add /home/[a-z]/* scheme to UserDir conf          |
|45275|New|Maj|2008-06-25|Locked files during expired page renew in disk cac|
|45281|New|Enh|2008-06-25|SITE CHMOD/SEARCH                                 |
|45287|Inf|Min|2008-06-26|build failure because of difference between BSD an|
|45297|New|Min|2008-06-27|mod_dir does not manage correctly the user (r->use|
|45302|New|Enh|2008-06-28|ServerRoot directive                              |
|45355|New|Nor|2008-07-07|ab text and html output jumbo unification         |
|45356|New|Nor|2008-07-07|ab: optionally reduce resource usage (qsort and me|
|45371|New|Nor|2008-07-10|MSI installer requires uninstall of previous versi|
|45374|New|Blk|2008-07-10|Shared memory error on starting httpd with mod_lda|
|45379|Inf|Nor|2008-07-11|[Bug] svn merge, apache and trailing slashes      |
|45385|Inf|Nor|2008-07-11|unable to compile/make 2.2.9 with --enable-ldap   |
|45393|New|Nor|2008-07-14|Apache returns 500 Error when no LDAP credentials |
|45402|New|Nor|2008-07-15|mod_autoindex incorrectly fails to list files     |
|45405|New|Enh|2008-07-16|Allow binding port to be set for individual worker|
|45449|New|Nor|2008-07-21|[PATCH] Add support to WebDav to MOVE/COPY to remo|
|45456|New|Enh|2008-07-22|mod_dbd don't allow more then one database pool   |
|45487|New|Trv|2008-07-27|broken log messages on startup in win32 version   |
|45497|New|Nor|2008-07-29|Scoreboard slot leaked using MaxRequestsPerChild a|
|45512|Ass|Maj|2008-07-31|Bad Performance of mod_proxy with SSL on Solaris 1|
|45524|New|Enh|2008-08-01|Specifying multiple vhost aliases                 |
|45525|New|Enh|2008-08-01|Switch mod_autoindex to Tango icons               |
|45579|New|Nor|2008-08-06|unknown URI scheme in request-URI ignored         |
|45674|New|Enh|2008-08-22|Allow to change error code returned by "Require ld|
|45726|New|Enh|2008-09-02|Build in a maintenance functionallity             |
|45736|New|Nor|2008-09-03|mod_dav needs a directory for its locks and one sh|
|45754|New|Enh|2008-09-06|autoconf macros                                   |
|45763|New|Nor|2008-09-08|No openssl.cnf defined by default causes OpenSSL c|
|45773|New|Nor|2008-09-09|pcre build generates sources to srcdir rather than|
|45788|New|Nor|2008-09-11|mod_log_forensic output shouldn't be buffered when|
|45801|Opn|Nor|2008-09-13|SSLRequireSSL with strictrequire and satisfy any d|
|45838|New|Nor|2008-09-18|mod_authz_owner & directories                     |
|45868|New|Nor|2008-09-23|mod_mem_cache update of headers in cache object is|
|45900|New|Nor|2008-09-26|"make install" fails from read-only filesystem    |
|45905|New|Enh|2008-09-26|ErrorDocument and default URL                     |
|45922|New|Enh|2008-09-30|Expand the conditions under which "SSLVerifyClient|
|45923|New|Nor|2008-09-30|htpasswd tries to open(file, O_RDONLY | O_APPEND) |
|45926|Inf|Nor|2008-10-01|Unable to start apache 2.2.9                      |
|45986|New|Nor|2008-10-10|[info]...Invalid argument: core_output_filter: wri|
|46024|Opn|Nor|2008-10-16|--enable-static is not available in apache's confi|
|46037|Inf|Nor|2008-10-18|Configuration of trusted OCSP responder certificat|
|46040|New|Enh|2008-10-20|Check for existing version of Apache while install|
|46054|New|Nor|2008-10-21|Running httpd returns the error "bad user name nob|
|46070|New|Nor|2008-10-22|MSI installer does not validate custom installatio|
|46071|New|Enh|2008-10-22|Allowing space in between comma and last option in|
|46074|New|Enh|2008-10-23|Need of friendly and easy to use configuration gra|
|46139|New|Nor|2008-11-02|Apache Restart option is not working              |
|46140|New|Enh|2008-11-03|Change error state in balancer manager            |
|46188|Inf|Nor|2008-11-11|Core dumps in apache 2.0.59                       |
|46195|Opn|Nor|2008-11-12|ProxyPass fails with literal IPv6 address         |
|46215|New|Nor|2008-11-14|Race condition in bybusyness algorithm            |
|46231|New|Maj|2008-11-18|Connection Pooling with ajp depends on syntax ?   |
|46241|New|Enh|2008-11-19|mod_expires - ExpiresByPattern or ExpiresIf       |
|46267|New|Nor|2008-11-22|No shared modules build if use --with-apr and --wi|
|46270|New|Enh|2008-11-23|Add FIPS 140-2 mode for mod_ssl for FIPS 1.2 modul|
|46282|New|Nor|2008-11-24|apache2.2 reverse proxy causing full memory and sw|
|46316|New|Maj|2008-12-01|Proxied SSI ProxyTimeout render failure           |
|46317|Inf|Nor|2008-12-01|mod_authnz_ldap.c(373)  seg fault                 |
|46412|New|Nor|2008-12-17|make_child return value not checked               |
|46417|New|Cri|2008-12-19|[notice] Parent: child process exited with status |
|46428|Opn|Nor|2008-12-21|Spaces in URI doesn't encode in proxy-requests    |
|46442|New|Nor|2008-12-29|Semicolon in allow/deny all rules cause reverse lo|
|46449|New|Maj|2008-12-30|Output out of order from SSI include virtual      |
|46454|New|Min|2008-12-30|escaping wildcards in AddIcon filename matching   |
|46475|New|Nor|2009-01-04|build warnings.                                   |
|46499|New|Maj|2009-01-09|httpd accept() return EAGAIN error                |
|46521|New|Nor|2009-01-13|mod_dav doesn't show symlinks                     |
|46529|Ass|Nor|2009-01-14|Child httpd processes crash with Segmentation faul|
|46534|New|Nor|2009-01-14|mod_proxy_ajp scheme and port do not follow UseCan|
|46578|New|Nor|2009-01-21|Flawed header                                     |
|46582|Ver|Min|2009-01-22|RewriteMap internal functions are not well documen|
|46604|New|Nor|2009-01-26|Error thrown when trying to rpmbuild -tb httpd sou|
|46629|New|Maj|2009-01-29|Apache hanging on system calls for php and perl   |
|46634|Ass|Nor|2009-01-30|Requests sometimes take too long, wrong time taken|
|46644|New|Enh|2009-01-31|Clean way to pass custom environment variables to |
|46646|Ass|Nor|2009-02-01|check group membership is sometimes case sensitive|
|46650|Opn|Nor|2009-02-02|CustomLog enviroment condition SCRIPT_FILENAME    |
|46656|New|Enh|2009-02-03|ProxyErrorOverride inside location                |
|46669|New|Enh|2009-02-06|rotatelogs doesn't autocreate directories         |
|46671|Opn|Cri|2009-02-07|Apache periodicaly crashes .                      |
|46678|New|Nor|2009-02-09|Fixed Content-Length using mod_ext_filter with mod|
|46682|New|Nor|2009-02-09|mod_proxy EAI_AGAIN DNS failure                   |
|46685|Opn|Nor|2009-02-09|401 sent without WWW-Authenticate header when requ|
|46709|Opn|Reg|2009-02-12|Expect: 100-continue to an HTTP/1.0 server change |
|46724|Inf|Cri|2009-02-17|WinXP SP3 - Apache crashes on startup in libapr-1.|
|46743|New|Nor|2009-02-19|Inconsistent behavior of "RewriteOptions inherit" |
|46745|New|Maj|2009-02-20|ab.c error :  undefined reference to `BIO_set_call|
|46751|New|Nor|2009-02-21|Can passenv variables who's name contain '(' or ')|
|46762|New|Nor|2009-02-24|Error, SSL/TLS libraries were missing or unusable |
|46765|Opn|Nor|2009-02-25|doubled HTTP header leads to error (Redmine)      |
|46785|Inf|Nor|2009-03-02|Child process increases to 100% (CPU)             |
|46788|New|Nor|2009-03-02|Set resource limits to avoid denial of service att|
|46810|New|Nor|2009-03-05|apxs / apu-1-config outputting erroneous include p|
|46824|New|Nor|2009-03-09|RemoveOutputFilter will not work for Filters added|
|46845|Inf|Cri|2009-03-12|Apache crashes in Windows when using subversion(pr|
|46847|New|Nor|2009-03-13|WebDAV methods with encoding other than "identity"|
|46873|New|Nor|2009-03-18|feature request: connection count on balancer-mana|
|46884|New|Min|2009-03-20|Call to apu_dso_load Fails In apr_ldap_stub.c On O|
|46946|Inf|Nor|2009-03-31|mod_mbox shows email addresses in plain text      |
|46963|New|Nor|2009-04-03|KeepAliveTimout prevents child process from exitin|
|46969|New|Nor|2009-04-05|CustomLog format %m always GET on errors with loca|
|46970|New|Nor|2009-04-05|CustomLog %X does not record aborted connections w|
|47011|New|Reg|2009-04-09|mod_proxy/mod_proxy_balancer hot-standby BalancerM|
|47055|New|Blk|2009-04-20|SSLVerifyClient + Directory doesn't use cache sess|
|47063|New|Nor|2009-04-21|mod_proxy doesn't call post_request handler when t|
|47134|New|Nor|2009-05-01|Last resolve handling when sending client certific|
|47138|New|Nor|2009-05-01|Reverse Proxy & Balancer generate error fault when|
|47152|New|Maj|2009-05-04|Apache is only serving the first character in the |
|47159|New|Nor|2009-05-06|2.2.x logresolve doesn't support ipv6             |
|47167|New|Nor|2009-05-07|Authenticated sessions being switched by reverse p|
|47170|New|Enh|2009-05-08|rotatelogs ring buffer option                     |
|47180|New|Nor|2009-05-11|DBM ssl_scache setting can cause extreme performan|
|47220|Opn|Enh|2009-05-19|Access to environment variables                   |
|47256|New|Enh|2009-05-23|Enable SSL on a per-port basis                    |
|47289|New|Nor|2009-05-30|Can't build with dynamic libraries on Mac OS 10.4 |
|47295|New|Nor|2009-06-01|AuthDBDUserPWQueryFmt/AuthDBDUserRealmQueryFmt in |
|47329|New|Nor|2009-06-07|SSLCADNRequest* & SSLCACertificate* silently do no|
|47340|New|Nor|2009-06-09|uldap_cache_comparedn() called without a lock     |
|47344|New|Enh|2009-06-10|[FEATURE REQUEST] RedirectCanonicalName           |
|47345|New|Enh|2009-06-10|rotatelogs timeout patch                          |
|47346|New|Maj|2009-06-10|mod_cache doesn't re-cache expired content when La|
|47387|Inf|Nor|2009-06-18|SSL_CLIENT_I_DN and SSL_CLIENT_S_DN use Email inst|
|47392|Opn|Nor|2009-06-18|<FilesMatch> is using the wrong directory         |
|47435|New|Nor|2009-06-26|mod_authz_host does reading of /etc/hosts on each |
|47438|Inf|Enh|2009-06-27|how to create a non-html "listing generated by the|
|47447|New|Enh|2009-06-29|Add possibility to use client IP as a value in Req|
|47484|New|Nor|2009-07-06|Spurious RewriteLock warning when using external m|
|47485|New|Enh|2009-07-06|HTML5 Websocket implementation                    |
|47514|New|Enh|2009-07-12|Personal data and restrictions based on subject di|
|47528|New|Maj|2009-07-14|Worker process won't restart more than once using |
|47542|New|Nor|2009-07-16|Piped logging processes killed before other proces|
|47562|Inf|Nor|2009-07-23|Apache/2.2.3 (Win32) mod_perl/2.0.3-rc1           |
|47578|New|Nor|2009-07-24|compile ERROR with ssl                            |
|47580|Opn|Nor|2009-07-25|mod_cache sends 200 response instead of 304       |
|47586|New|Nor|2009-07-27|httpd -k start doesn't start service when rotatelo|
|47591|New|Min|2009-07-27|show current HTTP_HOST in mod_status scoreboard   |
|47601|New|Enh|2009-07-29|Support X-Forwarded-For in forward proxy requests |
|47625|New|Nor|2009-08-02|2.2.12 win32 msi installer missing                |
|47634|New|Maj|2009-08-04|mod_ldap connection pool session keepalive not imp|
|47643|New|Enh|2009-08-04|added meta tags to xhtml output for ease of search|
|47650|Opn|Trv|2009-08-05|httxt2dbm calculates value size incorrectly       |
|47657|New|Nor|2009-08-06|Make WebDAV MOVE atomic when replacing files on sa|
|47659|New|Nor|2009-08-07|makefile.win needs check for DBM_LIST, dies on bui|
|47664|New|Nor|2009-08-07|ap_proxy_canonenc: does not recode all high-byte c|
|47665|Inf|Blk|2009-08-09|Apache service well launched but blank Screen     |
|47691|New|Enh|2009-08-12|libtool invocations should use --tag              |
|47693|Opn|Nor|2009-08-13|GET request has race condition w.r.t. replacement |
|47706|Inf|Nor|2009-08-19|(20014)Internal error: proxy: error reading status|
|47716|New|Min|2009-08-20|LimitRequestFieldSize and friends not merged well |
|47719|Opn|Enh|2009-08-20|Broken symbolic link (symlink) causes wrong ErrorD|
|47723|New|Nor|2009-08-22|suEXEC and low RLimitMem gives "crit: invalid uid"|
|47743|Inf|Nor|2009-08-26|mod_so segfaults at server startup in ap_find_load|
|47753|New|Nor|2009-08-27|output and error channels not explicitly passed fo|
|47778|Opn|Enh|2009-09-03|wrong exit value on graceful restart              |
|47780|New|Nor|2009-09-03|Critical errors should be marked by time and level|
|47807|Inf|Nor|2009-09-09|Proxy dialog error with Apache 2.2.13             |
|47808|New|Maj|2009-09-09|Child process core dumps when enabling CRL        |
|47814|Inf|Maj|2009-09-10|openssl_pkcs7_sign error                          |
|47838|New|Enh|2009-09-14|Ability to Dynamically Inject Current Time Into a |
|47874|New|Nor|2009-09-18|mod_fcgid crashes if added during restart         |
|47895|New|Maj|2009-09-24|Incorrect 413 error handling                      |
|47908|New|Min|2009-09-27|'invalid result code' in error_log                |
|47981|New|Nor|2009-10-12|allow language specific html-versions (index.html.|
|47982|New|Nor|2009-10-12|correctly interprete non-standard HTTP_ACCEPT_LANG|
|47988|New|Nor|2009-10-12|Segmentation fault                                |
|47989|New|Nor|2009-10-13|Junk string appended to compressed dynamic content|
|47994|New|Enh|2009-10-14|ScriptInterpreterSource apparently broken in Windo|
|48020|New|Nor|2009-10-17|KCP+ Opera support for mod_auth_digest            |
|48037|Inf|Nor|2009-10-21|mod_proxy_http does not handle asynchronous keepal|
|48045|New|Nor|2009-10-23|Apache 2 initgroups alert, Max OS X, abnormal exit|
|48057|New|Nor|2009-10-26|mod_fcgid creates 1 more process then allowed     |
|48094|New|Nor|2009-11-01|Avoid a race condition in close_worker_sockets()  |
|48107|New|Maj|2009-11-02|Mutual Authentication: Order in ca-bundle influenc|
|48115|New|Enh|2009-11-03|Duration to receive the request, generate response|
|48130|New|Maj|2009-11-04|DAV operations on large filesets consume all the O|
|48154|New|Nor|2009-11-06|Requests through mod_isapi are not parsed by HTTP_|
|48164|New|Enh|2009-11-09|add new parameters to rotatelogs                  |
|48219|New|Nor|2009-11-17|Retrying the worker for seems to omit POST variabl|
|48228|New|Nor|2009-11-18|Renegocation requires multiple client authenticati|
|48246|New|Enh|2009-11-19|Check permissions on file/directory specified for |
|48254|New|Trv|2009-11-20|Bogus "DocumentRoot does not exist" warning when s|
|48283|New|Nor|2009-11-25|Proxy errors since httpd 2.2.12 with Tomcat 6.0.20|
|48291|New|Maj|2009-11-26|mod_substitute loops                              |
|48295|Opn|Nor|2009-11-27|ProxyPassReverseCookiePath: Not changing path corr|
|48301|New|Enh|2009-11-30|Feature request: improved connection status report|
|48309|New|Maj|2009-11-30|libapreq2-2.12: "make test" fails at request.t and|
|48312|Opn|Nor|2009-11-30|ProxyPassReverseCookiePath: Not changing path corr|
|48316|Inf|Nor|2009-12-01|ap_run_insert_filter doesn't work in cache_url_han|
|48354|New|Enh|2009-12-08|void ap_custom_response is not supporting the bina|
|48360|New|Enh|2009-12-09|provide sample configuration file for inclusion in|
|48361|New|Enh|2009-12-09|Add global server option for specifying desired DS|
|48364|Opn|Nor|2009-12-10|PHP-generated pages are not cached in spite of per|
|48369|New|Enh|2009-12-10|add option to automatically restart if a script is|
|48431|New|Nor|2009-12-22|Error logging doesn't work when configured to use |
|48440|Inf|Cri|2009-12-23|Segmentation Fault                                |
|48449|Inf|Nor|2009-12-28|make distclean removes core.c and core_filters.c  |
|48465|Opn|Enh|2009-12-30|Support TCP to connect to backends                |
|48499|New|Nor|2010-01-06|mod_rewrite can't redirect to files with ? in them|
|48500|New|Nor|2010-01-06|mod_mbox mishandles right-click to open msg in new|
|48508|New|Nor|2010-01-07|BalancerMember doesn't accept nocanon directive   |
|48549|New|Enh|2010-01-14|Add Cache-Control s-maxage support                |
|48576|New|Nor|2010-01-19|MOVE or COPY in WebDAV fails with 404 when file ex|
|48585|New|Enh|2010-01-20|mod_cache no longer caches expired content        |
|48602|New|Enh|2010-01-23|use asynch ldap_compare so LDAPTimeout applies    |
|48623|New|Maj|2010-01-26|AuthLDAPURL syntax is not RFC-compliant, prevents |
|48639|New|Enh|2010-01-29|Add htcacheclean as a core monitored process      |
|48652|New|Maj|2010-02-01|"AuthType form" fails if a password contains  '&' |
|48659|New|Maj|2010-02-02|Problem with accents in filename and byte serving |
|48687|New|Nor|2010-02-05|mod_rewrite ignores trailing dot in request URI on|
|48705|New|Enh|2010-02-08|flag to allow newlines in the error log as opposed|
|48712|New|Enh|2010-02-09|Add UID and GID to status page                    |
|48719|New|Nor|2010-02-09|[BUG] mod_proxy_ajp return wrong error message whe|
|48721|New|Nor|2010-02-10|[Patch] Add ProxyAllow to mod_proxy               |
|48731|New|Maj|2010-02-11|Prefork not creating processes after 10 servers ar|
|48732|New|Nor|2010-02-12|[BUG] environment variable SCRIPT_NAME output erro|
|48769|New|Nor|2010-02-18|[PATCH] Processes in the busy list should not be k|
|48777|New|Maj|2010-02-19|proxy balancer not detecting correctly when host (|
|48780|New|Enh|2010-02-19|Enable mod_authnz_ldap to accept valid client cert|
|48792|New|Enh|2010-02-22|httpd util apachectl returns wrong status informat|
|48805|New|Nor|2010-02-23|Corrupted response for HTTPS + KEEPALIVE=ON       |
|48808|New|Enh|2010-02-24|mod_authz_owner support for POSIX access control l|
|48819|Inf|Nor|2010-02-25|After users login on the web page, the page does n|
|48842|Inf|Nor|2010-03-02|mod_log_config logs the full size of the file inst|
|48880|Opn|Nor|2010-03-09|error on make                                     |
|48888|New|Nor|2010-03-10|DOCTYPE definitions nearly 11 years out-of-date   |
|48920|New|Enh|2010-03-15|Breadcrumbs on mod_autoindex path                 |
|48921|Inf|Nor|2010-03-16|mod_mem_cache crash, version 2.2.15.0             |
|48937|New|Enh|2010-03-18|Feature proposal - support sasl_bind              |
|48949|Inf|Cri|2010-03-20|fcgid processes never get killed after graceful re|
|48958|New|Nor|2010-03-22|mod_ldap, ldap credential cache & graceful restart|
|48987|New|Trv|2010-03-25|typo in polish translation of HTTP_UNAUTHORIZED.ht|
|49037|New|Enh|2010-04-02|SSLVerifyClient require_no_ca                     |
|49043|New|Maj|2010-04-04|Using ssi include directive overwrites QUERY_STRIN|
|49058|New|Nor|2010-04-06|Prefork MPM tries to accept on closed listener soc|
|49067|New|Nor|2010-04-08|FTPOptions ShowUnAuthorizedFiles does not work    |
|49068|New|Nor|2010-04-08|UTF-8 URL Encode error                            |
|49087|New|Maj|2010-04-11|MSI installation reports "interrupted installation|
|49114|New|Maj|2010-04-13|NTFS junction directories missing from directory l|
|49123|New|Nor|2010-04-14|mod_proxy_ajp does not send the client's SSL chain|
|49131|New|Nor|2010-04-15|Very long URLs cause 404 or 403 errors with SetAct|
|49133|New|Maj|2010-04-16|Windows service recovery options do not work for A|
|49157|New|Nor|2010-04-20|Issues with xml interface for balancer manager    |
|49187|New|Nor|2010-04-26|Crash mod_mem_cache and mod_svn                   |
|49199|New|Enh|2010-04-27|Implement LDAP scope-aware caching in mod_ldap    |
|49220|New|Nor|2010-04-29|feature request for being able to disable FcgidWra|
|49239|New|Blk|2010-05-01|Apache mod_ssl gives coredump with openssl 0.9.8  |
|49277|New|Nor|2010-05-12|Expose a variable to identify SSL Session renegoti|
|49283|New|Nor|2010-05-12|Language of dates on SSI                          |
|49285|New|Enh|2010-05-13|Relative (local to current directory) URLs do not |
|49348|New|Enh|2010-05-27|[mod_log_config] Output log file name format capab|
|49385|New|Maj|2010-06-03|mod_disk_cache server side included files are inte|
|49387|Inf|Cri|2010-06-03|Unable to modify default charset setting to UTF-8 |
|49391|New|Nor|2010-06-05|mod_disk_cache needs to register a cleanup to kill|
|49396|New|Enh|2010-06-06|PATH_INFO normalization, especially relating to vo|
|49427|New|Nor|2010-06-11|mod_cgid and mod_cgi do not return proper value wh|
|49433|New|Enh|2010-06-13|improving info in server status                   |
|49439|New|Nor|2010-06-14|Bug in mod_userdir which prevents suexec from runn|
|49504|New|Nor|2010-06-25|Solaris 10/x64 worker graceful restart problem    |
|49532|New|Nor|2010-06-30|mod_cache: Set-Cookie headers are appended to cach|
|49553|New|Min|2010-07-05|Set QoS bits via APR2 API instead                 |
|49568|New|Maj|2010-07-07|Apache mod_authnz_ldap built with the MS LDAPSDK d|
|49632|Inf|Nor|2010-07-21|mod_authnz_ldap denies users when search is perfor|
|49633|New|Enh|2010-07-21|Handle AD primary groups in mod_authnz_ldap       |
|49642|New|Nor|2010-07-23|mod_rewrite mistakes encoded question mark as path|
|49643|New|Nor|2010-07-23|WebDav plus mod Negotiation causes directory creat|
|49676|New|Nor|2010-07-30|directory with german umlauts are indented by one |
|49680|New|Maj|2010-07-30|Perl script are not running on Win32, Apache 2.2.1|
|49684|New|Enh|2010-08-01|enhancement for ipv6 implementation               |
|49699|New|Nor|2010-08-03|Inconsistent Keep-alive from proxy to the origin s|
|49715|New|Maj|2010-08-06|ProxyPassMatch Url Encoder Problem                |
|49717|New|Enh|2010-08-06|PATCH: Enable SSL Timeout                         |
|49737|Inf|Nor|2010-08-10|order allow,deny does not work on IPv6            |
|49743|New|Maj|2010-08-12|SSI 'echo encoding="(url/none)"' bug              |
|49746|Opn|Enh|2010-08-12|mod_rewrite urlencode option                      |
|49766|New|Maj|2010-08-17|POST request on CGI script generating empty body c|
|49771|New|Nor|2010-08-17|After graceful restart using mod_proxy_ajp, couldn|
|49772|New|Nor|2010-08-18|mod_deflate kicks itself out on Content-Range resp|
|49798|Opn|Nor|2010-08-22|[mod_log_config] Piped Log scripts process cause w|
|49807|New|Enh|2010-08-23|hard to force Content-Type header for non static f|
|49810|New|Nor|2010-08-23|Mod_autoindex output of header/body/footer scrambl|
|49815|New|Enh|2010-08-24|Enable caching for HTTP Range requests / 206 respo|
|49829|New|Trv|2010-08-26|CGI index command line arguments excessively escap|
|49832|New|Enh|2010-08-26|void ap_custom_response is not supporting the bina|
|49859|Opn|Nor|2010-09-01|url with additional filepath generates bad environ|
|49921|New|Nor|2010-09-13|Trailers in chunked http requests are not handled |
|49926|New|Enh|2010-09-14|New option for mod_log_forensics or mod_log_config|
|49980|New|Nor|2010-09-22|can't use a FIFO for SSL key file; mod_ssl checks |
|49981|New|Enh|2010-09-22|Requesting SSLCertificateKeyFile Dialog functional|
|49990|New|Nor|2010-09-23|Feature request: implement ExpiresActive reset    |
|49996|New|Nor|2010-09-24|Proxied ErrorDocument returns 200 OK response code|
|49997|New|Nor|2010-09-24|wrowe promised me...                              |
|50004|New|Nor|2010-09-26|per-dir rewrite without DocumentRoot or RewriteBas|
|50011|New|Cri|2010-09-27|error running apache, and installing apache as a s|
|50024|New|Min|2010-09-29|Mod_cache/mod_mem_cache and mod_security combinati|
|50038|New|Enh|2010-10-01|What Directives apply to a file/directory? Resulta|
|50041|New|Min|2010-10-04|(9)Bad file descriptor: apr_socket_accept: (client|
|50051|New|Nor|2010-10-07|Log PID in first entry logged for each request    |
|50061|New|Nor|2010-10-08|Semicolon character '%3B' seems to be decoded to '|
|50082|New|Nor|2010-10-12|apachectl status returns incorrect exit code      |
|50112|New|Nor|2010-10-18|buildconf broken in two places                    |
|50116|New|Nor|2010-10-19|Apache fragments packets unnecessarily            |
|50151|New|Nor|2010-10-25|Software caused connection abort and apache proces|
|50155|Inf|Nor|2010-10-25|httpd -s attempts to read SSL certificates        |
|50172|Inf|Nor|2010-10-28|Digest allows access bypassing secuity            |
|50227|New|Enh|2010-11-07|Option to fail SSL handshake for diverted SNI conn|
|50237|Inf|Nor|2010-11-08|webdav LOCK access with multiple threads to same f|
|50261|New|Nor|2010-11-12|graceful restart with multiple listeners using pre|
|50262|New|Nor|2010-11-12|mod_rewrite log ip address vs hostname            |
|50274|New|Nor|2010-11-15|always pass CONTENT_LENGTH to the application     |
|50278|New|Nor|2010-11-16|-DFOREGROUND and ap_unixd_killpg()/ap_os_killpg() |
|50290|Inf|Nor|2010-11-18|vanilla apache 2.2.17 installation crashes (lib-ap|
|50296|New|Nor|2010-11-18|LDAPVerifyServerCert and possibly LDAPTrustedMode |
|50317|New|Nor|2010-11-22|Possible error in mod_cache's "Avoiding the Thunde|
|50336|New|Min|2010-11-25|PUT failures do not emit Allow:                   |
|50344|New|Nor|2010-11-26|ProxyPass does not handle different protocols when|
|50357|New|Enh|2010-11-28|improve matching mechanisms for mime type and enco|
|50372|New|Enh|2010-11-29|any reason for allowing ModMimeUsePathInfo only in|
|50390|New|Nor|2010-11-30|WARNING: Unrecognized options : --disable-ipv6    |
|50402|New|Nor|2010-12-02|SetEnv proxy-sendchunks is ignored for small amoun|
|50412|New|Nor|2010-12-04|if IndexOptions +XHTML, the correct MIME type shou|
|50423|Inf|Nor|2010-12-06|Apache is terminated with signal 11, Segmentation |
|50427|New|Nor|2010-12-07|Windows>=Vista+mod_auth_digest+command line=proble|
|50432|New|Enh|2010-12-08|add PCRE-mode for file based matches              |
|50436|New|Enh|2010-12-08|VirtualHost could behave like people expect it to |
|50444|New|Enh|2010-12-09|Pre-close logging handles in cgid agent           |
|50456|Inf|Nor|2010-12-10|Invalid Error 413 crash Apache                    |
|50464|New|Blk|2010-12-13|undefined reference to `BIO_set_callback' `BIO_set|
|50466|Inf|Maj|2010-12-13|httpd process doesn't recycle                     |
|50473|New|Maj|2010-12-14|zlib.dll Problem                                  |
|50521|New|Nor|2010-12-25|Comment at top of sample main config file is wrong|
|50525|New|Nor|2010-12-28|Header directive won't edit Location header from P|
|50530|New|Enh|2010-12-29|Provide rate limiting for failed authentication at|
|50532|New|Enh|2010-12-30|Mail protection                                   |
|50551|New|Nor|2011-01-06|Some proxied connections ignore ttl setting       |
|50562|Opn|Cri|2011-01-09|wrong PATH_INFO CGI environment with non-ASCII UTF|
|50584|New|Enh|2011-01-14|Add error message when RequestReadTimeout triggere|
|50592|New|Maj|2011-01-15|httpd dumps core on an IPv6 only system           |
|50602|New|Nor|2011-01-17|non thread safe functions used in apache httpd pro|
|50619|New|Min|2011-01-19|After changing resolv.conf signaling httpd doesn't|
|50628|New|Blk|2011-01-21|Core dump happens with Apache 2.2.15 using openssl|
|50630|New|Nor|2011-01-21|Apache return 500 error with authentication by LDA|
|50644|New|Enh|2011-01-24|Add support for maximum number of requests per Kee|
|50654|New|Nor|2011-01-25|FileETag ContentMD5 & Filename, optimisation to Co|
|50693|New|Nor|2011-01-31|AllowOverride Options=(not Foo) should permit no-o|
|50704|Inf|Nor|2011-02-01|mod_cache doesn't cache MultiViews                |
|50712|New|Maj|2011-02-02|Restart button only stops the server ...and do not|
|50727|New|Nor|2011-02-07|ISAPI EXTENSION_CONTROL_BLOCK Missing PostData wit|
|50765|New|Enh|2011-02-11|Runtime Backend Pinning via balancer-manager      |
|50770|New|Nor|2011-02-14|a rotatelogs issue, if time changed               |
|50773|Inf|Nor|2011-02-14|Dav lock database corruption                      |
|50774|New|Enh|2011-02-14|Have a way to invalidate cache without other reque|
|50777|New|Nor|2011-02-14|Back port buildconf specifies AC_PREREQ(2.13) fix |
|50796|New|Enh|2011-02-16|record time between keepalives in access log      |
|50807|New|Maj|2011-02-18|mod_proxy fails to send FIN response when a FIN is|
|50814|New|Nor|2011-02-21|SSI exec not working on Windows (Apache 2.x)      |
|50848|New|Enh|2011-03-01|Content Negotiation type map file precedence could|
|50869|New|Enh|2011-03-04|Need directive to control use and timeout of sessi|
|50873|New|Nor|2011-03-04|httpd does not start properly when built from sour|
|50878|New|Nor|2011-03-05|redundant operation when calling apr_stat         |
|50891|New|Nor|2011-03-08|Apache rewrites WWW-Authenticate headers from CGI |
|50902|Inf|Maj|2011-03-09|on major load on the server, poll() hangs         |
|50916|New|Nor|2011-03-11|RewriteMap program: mod_rewrite sends request but |
|50926|New|Nor|2011-03-14|unexpected <Directory> file-matching behavior     |
|50942|New|Maj|2011-03-17|Apache 2.2.16 forward proxy is 5x times slower tha|
|50945|Opn|Nor|2011-03-18|AJP: Missing support for ErrorOverride            |
|50948|Opn|Nor|2011-03-19|Connection not closed when CGI dies waiting for PO|
|50954|New|Nor|2011-03-21|ProxyRemote doesnt use CONNECT method with https s|
|50959|New|Enh|2011-03-23|Add cache-manifest to the mime type list          |
|50976|New|Nor|2011-03-26|Apache losts client's ip (%a or %h) sometimes.    |
|50999|Opn|Nor|2011-03-30|it seems the configure wrong detect my apr-util ve|
|51001|New|Nor|2011-03-31|patch for hook ap_lua_run_lua_open                |
|51005|New|Enh|2011-04-01|Allow to use username in LDAP filter              |
|51006|New|Blk|2011-04-01|Apache consume all memory and swap when setup as r|
|51019|New|Enh|2011-04-04|[PATCH] Implementation of Asynchronous processing |
|51020|Opn|Nor|2011-04-04|[PATCH] Apache/mod_fcgid.so does not start in comp|
|51022|New|Nor|2011-04-05|Segmentation fault on PUT request                 |
|51030|New|Enh|2011-04-06|Way to terminate CGI immediatly after closing conn|
|51078|Inf|Nor|2011-04-18|[PATCH] mod_fcgid spawned CGI Processes gets orpha|
|51079|New|Enh|2011-04-18|[PATCH] mod_fcgid spawned CGI Process cannot imper|
|51080|New|Nor|2011-04-18|[PATCH] mod_isapi does not support Except:100-Cont|
|51103|Opn|Nor|2011-04-21|mod_reqtimeout does not drop connection and return|
|51104|Opn|Maj|2011-04-21|C++ support about httpd_config.h                  |
|51107|New|Min|2011-04-22|SetOutputFilter and SetInputFilter should allow "n|
|51118|New|Nor|2011-04-26|LDAP cache is cleared after graceful/restart and o|
|51127|New|Nor|2011-04-27|Make ProxyPassReverseCookiePath work as expected  |
|51168|New|Nor|2011-05-08|mod_status Total Traffic won't take account of int|
|51170|New|Nor|2011-05-09|I/O errors when using keep-alive + mod_ssl        |
|51174|New|Min|2011-05-09|SSLRequire predicates using OIDs unknown to openss|
|51186|New|Blk|2011-05-11|NEw Openssl 1.0.1 with new FIPS                   |
|51190|New|Min|2011-05-12|::/0 does not work with allow from and deny from  |
|51194|New|Nor|2011-05-13|FcgidWrapper does not support paths containing a s|
|51201|Inf|Nor|2011-05-15|Strange behavior REQUEST_METHOD & GET in mod_rewri|
|51223|New|Nor|2011-05-18|304 HTTP Not Modified strips out CORS headers     |
|51224|New|Nor|2011-05-18|mod_dav_fs should respect FileETag                |
|51239|New|Nor|2011-05-21|ap_get_client_block may block continuously sometim|
|51257|New|Nor|2011-05-24|Build failed when cross-compiling: ./gen_test_char|
|51258|Opn|Enh|2011-05-24|new features for mod_substitute                   |
|51296|New|Enh|2011-05-31|Dynamic engine support using SSLCryptoDevice suppo|
|51297|New|Nor|2011-05-31|Improve error handling during "UNLOCK"            |
|51303|New|Nor|2011-05-31|TraceEnable 500 error                             |
|51312|New|Nor|2011-06-01|mod_filter should support adding to the Vary heade|
|51322|New|Enh|2011-06-04|Prepend and append string to LDAP search parameter|
|51359|Inf|Enh|2011-06-11|Added shebang check for //! so that .js scripts wo|
|51365|New|Nor|2011-06-13|Mod_proxy mangles query string with mod_security  |
|51402|New|Nor|2011-06-21|"ForceLanguagePriority Fallback" not working as im|
|51406|New|Maj|2011-06-21|When listing files in subdirectories, the path is |
|51409|New|Nor|2011-06-21|Sorting options accepted by ls, but ignored       |
|51471|New|Nor|2011-07-04|<DirectoryMatch>ed IndexIgnore doesn't            |
|51479|New|Enh|2011-07-05|[PATCH] AB feature to optionally read in a reusabl|
|51491|New|Nor|2011-07-08|mod_dir breaks POSTs to URLs not ending in /      |
|51495|New|Nor|2011-07-11|mod_substitute cpu and memory limit               |
|51517|New|Maj|2011-07-16|mod_proxy_fcgi is not RFC 3875 compliant (SCRIPT_F|
|51522|Ver|Trv|2011-07-18|Wrong French translation in mpm.html ("Certains Mo|
|51542|New|Nor|2011-07-22|Apache HTTP Server vs PVS-Studio                  |
|51543|New|Nor|2011-07-22|Space in username not properly escaped in log file|
|51552|Inf|Cri|2011-07-25|Apache is not starting (2.2.15)                   |
|51573|New|Enh|2011-07-28|Easy way to erase log files                       |
|51576|Inf|Nor|2011-07-28|mod_rewrite rule stopped working                  |
|51600|New|Enh|2011-08-02|Loading the same certificate in multiple virtual h|
|51603|Inf|Maj|2011-08-02|Apache accepts completely bogus HTTP requests (pos|
|51607|Inf|Nor|2011-08-03|DBDPrepareSQL ( ap_dbd_prepare ) does not work cor|
|51629|New|Nor|2011-08-05|DocumentRoot check incorrect when running under ch|
|51674|New|Blk|2011-08-18|AJP Module Bad Request                            |
|51679|New|Min|2011-08-18|Code signature key expired                        |
|51689|New|Trv|2011-08-19|Cross compiling causes multiple Listen directives |
|51695|New|Trv|2011-08-20|Code clean up (ap_rputs merge)                    |
|51707|New|Nor|2011-08-22|ProxyPassReverse issues within <Location> (differe|
|51709|New|Nor|2011-08-23|ServerName/ServerAlias don't work if Host: header |
|51711|New|Nor|2011-08-23|mod_auth_digest have broken shared mem (nonce) cod|
|51718|New|Enh|2011-08-24|Feature Request: Add shorthand to redirect any Ser|
|51725|New|Nor|2011-08-26|Multiple Range: request accepted as "Range: n-m"  |
|51732|New|Nor|2011-08-29|Inconsistencies in log messages' verbosity levels |
|51747|New|Blk|2011-08-31|mod_fcgid loads entire request into memory while p|
|51757|Inf|Enh|2011-09-02|Add support for SASL auth in LDAP                 |
|51778|Inf|Cri|2011-09-07|while buliding(make) a unix source "httpd-2.2.20.t|
|51797|Inf|Maj|2011-09-10|Crash HTTPD(Windows)                              |
|51814|New|Enh|2011-09-14|mod_proxy in Apache HTTP 2.2 FIN_WAIT2 in server s|
|51858|Inf|Nor|2011-09-21|weird error for mod_rewrite with more then 3 param|
|51864|New|Nor|2011-09-22|mod_cache returns entire entity from origin server|
|51904|New|Nor|2011-09-28|output to stderr from cgi script causes script to |
|51951|New|Nor|2011-10-04|mod_mbox hang on some e-mails on press@a.o - was I|
|51964|Ver|Nor|2011-10-05|Documentation of RewriteRule flag skip unclear    |
|51965|New|Nor|2011-10-05|--with-z=DIR not being honored                    |
|51982|Opn|Nor|2011-10-06|ProxyPassReverse / balancer://cluster/ adds slash |
|51987|Inf|Nor|2011-10-07|RewriteRule doesn't work correctly with apache 2.3|
|51994|New|Enh|2011-10-07|Mod_authn_socache should have some way to flush th|
|52004|Ver|Trv|2011-10-10|Typo "indexe" in French translation of mpm.html   |
|52007|New|Nor|2011-10-10|Content-Length: 0 not set on proxy response       |
|52038|New|Nor|2011-10-16|NameWidth works incorrectly together with Charset=|
|52039|Inf|Nor|2011-10-16|Browser mode does not always work                 |
|52043|New|Nor|2011-10-17|Directories ".", "..", and "/" do not work correct|
|52081|New|Nor|2011-10-24|segfault if mbox files have unexpected names      |
|52090|New|Maj|2011-10-26|Apache thread hangs with error 500 when sending a |
|52120|Opn|Nor|2011-11-01|mod_cache edge case: uncacheable 304 sends cached |
|52123|New|Maj|2011-11-02|DoS: High memory usage in propfind                |
|52132|New|Nor|2011-11-03|[PATCH] process activity score calculated incorrec|
|52139|New|Nor|2011-11-05|Never Syntax Error on non-existent DocumentRoot   |
|52171|Ver|Nor|2011-11-13|confusing documentation of request phases         |
|52174|New|Enh|2011-11-13|Allow hard lower-limits on the number of fcgi serv|
|52178|New|Nor|2011-11-14|IPv6 IPs as ServerName not allowed                |
|52181|Ver|Nor|2011-11-14|mod_rewrite Technical Details Ruleset Processing d|
|52195|Inf|Nor|2011-11-16|Japanese texts are garbled on mailing list archive|
|52196|Inf|Nor|2011-11-16|winnt mpm, others mpm also have this bug. pool sha|
|52207|Inf|Maj|2011-11-18|Upgrade apache version from 2.0.59 to 2.2.12 or ab|
|52222|New|Nor|2011-11-21|IndexIgnore ignores parent directories in argument|
|52247|New|Nor|2011-11-26|mod_mbox gives up on unexpected message format    |
|52248|New|Nor|2011-11-26|Bugzilla version drop-down list does not offer "un|
|52252|New|Nor|2011-11-27|luajit support broken for (at least) luajit 2.0   |
|52253|Inf|Nor|2011-11-28|Timeout doesn't work. mod_proxy_balancer strongly |
|52264|New|Enh|2011-11-30|Update and complete balancer-manager XML output   |
|52269|Inf|Nor|2011-12-01|[mod_proxy] Apache reverse proxy status code trans|
|52275|New|Nor|2011-12-02|memory leak in proxy_ajp_handler                  |
|52298|Inf|Nor|2011-12-07|Can't enter website with client certificate on an |
|52301|New|Enh|2011-12-07|Error message "RSA server certificate ... CN ... d|
|52302|New|Enh|2011-12-07|Better documentation of how server name is determi|
|52304|New|Nor|2011-12-08|<Limit> Does Not Apply When URI Is Folder         |
|52313|New|Enh|2011-12-09|htdbm enhancement: options for colon-in-username, |
|52322|Inf|Enh|2011-12-13|Providing BBC developed httpd modules for inclusio|
|52342|New|Nor|2011-12-15|ap_internal_redirect dropping filters means incons|
|52370|New|Nor|2011-12-19|apreq_decode/url_decode length miscalculation     |
|52377|New|Enh|2011-12-20|Add Directives to assert user, group, and permissi|
|52383|New|Trv|2011-12-24|Instllation log typo                              |
|52391|New|Cri|2011-12-27|100% CPU usage while using Forward Proxy          |
|52395|New|Nor|2011-12-29|reload results in different end environment to res|
|52403|New|Nor|2011-12-31|FallbackResource doesn't work for non-existent PHP|
|52408|New|Nor|2012-01-01|Directoryindex matching automatically redirects   |
|52415|New|Nor|2012-01-03|LockFile placed inappropriately                   |
|52417|New|Nor|2012-01-03|HEADERS information in the file                   |
|52435|New|Nor|2012-01-06|Apache shutdown automatically                     |
|52439|New|Nor|2012-01-09|It should be possible to treat errors in .htaccess|
|52453|New|Enh|2012-01-11|Ability to configure --logfiledir                 |
|52465|New|Nor|2012-01-13|mod_dir is allowed to redirect proxy requests     |
|52481|New|Nor|2012-01-18|Rotatelog.exe crashes Apache after setting 256MB r|
|52485|New|Nor|2012-01-19|CPU load 100%                                     |
|52494|New|Enh|2012-01-22|allow the Action directive to point in the filesys|
|52495|New|Enh|2012-01-22|CACertificate, CADNCertificate, CARevocation, Cert|
|52501|New|Cri|2012-01-23|child pid 10824 exit signal Segmentation fault (11|
|52505|New|Nor|2012-01-23|Include with directory wildcards gives errors for |
|52509|New|Nor|2012-01-23|Resources protected by .htaccess file may not be a|
|52510|New|Cri|2012-01-23|Segmentation Fault 11                             |
|52520|New|Nor|2012-01-24|ProxyRemote & NoProxy directive can not take IPv6 |
|52532|New|Trv|2012-01-26|VirtualHost added TWICE to name-virtual-host list |
|52539|New|Nor|2012-01-26|Apache mod_dav 400 Bad Request for non-existent co|
|52546|New|Nor|2012-01-27|overwrite SERVER_PROTOCOL environment             |
|52573|New|Nor|2012-02-01|mod_speling case correction fails when URI has dou|
|52578|Opn|Enh|2012-02-02|Wrong "bytes sent" logged when connection is close|
|52594|New|Nor|2012-02-03|rpmbuild -ba errors out with "File not found by gl|
|52595|New|Nor|2012-02-03|requests with gzip+chunked encoded body don't prox|
|52605|Inf|Min|2012-02-05|Please allow request lines longer than 8k         |
|52612|New|Nor|2012-02-06|Default Service Account                           |
|52616|Opn|Enh|2012-02-07|SSLUserName uses SSL_CLIENT_S_DN insted of SSL_CLI|
|52617|New|Maj|2012-02-07|Visit the rewrite page from ServerAlias domain vho|
|52623|New|Nor|2012-02-08|does not build with pcre-8.30                     |
|52644|New|Nor|2012-02-12|document how SSL FakeBasicAuth works with strange |
|52668|New|Trv|2012-02-14|More future safe patch for old MSIE ssl-unclean-sh|
|52670|New|Trv|2012-02-15|please clarify the effect of SSLStrictSNIVHostChec|
|52683|New|Enh|2012-02-16|add a symlink option that rechecks the access perm|
|52700|Inf|Blk|2012-02-17|Not rendering html content instead displaying clie|
|52703|Inf|Maj|2012-02-18|SSL+SNI+client-auth "lost" after some time        |
|52710|New|Nor|2012-02-19|mod_fcgid should set PATH_INFO when configured in |
|52756|Inf|Trv|2012-02-24|proxy_html_module LoadModule line not created in h|
|52759|New|Cri|2012-02-24|Apache httpd child process consuming high CPU Util|
|52790|New|Nor|2012-02-28|ldap caching not sufficient                       |
|52795|Opn|Nor|2012-02-29|mod_fcgid fails to spawn process in C:\Program Fil|
|52806|New|Nor|2012-03-01|configure: --with-included-apr is not supported in|
|52807|New|Nor|2012-03-01|some random strings are accepted by "configure" as|
|52816|New|Nor|2012-03-03|Potential segfault in socache_shmcb_create        |
|52817|New|Nor|2012-03-03|Long directory path sucks (but it's really a valid|
|52822|New|Nor|2012-03-04|Quiet installation not fully quiet                |
|52824|Inf|Nor|2012-03-04|Conflicts between AllowOverride and AllowOverrideL|
|52828|New|Maj|2012-03-05|Child process is not replaced in Windows, after a |
|52832|New|Nor|2012-03-05|numerical configuration entry can be mistakenly in|
|52841|Opn|Nor|2012-03-06|[proxy_balancer:emerg] [pid 25593] AH01177: Failed|
|52851|New|Nor|2012-03-07|Core TimeOut directive doesn't work               |
|52860|New|Enh|2012-03-08|Support Transfer-Encoding: gzip                   |
|52865|New|Nor|2012-03-09|Crash by segmentation fault in mod_authn_core in A|
|52870|New|Cri|2012-03-09|100% CPU usage while using Forward Proxy          |
|52874|New|Enh|2012-03-09|Support Use TrustedFirst checking when verifying c|
|52884|New|Nor|2012-03-12|"localhost" leads to start failure                |
|52890|Inf|Nor|2012-03-12|--with-included-apr doesn't work when srclib/apr a|
|52891|New|Nor|2012-03-12|2.2 doesn't perform as well as 1.3                |
|52894|Inf|Nor|2012-03-13|Apache aborts abnormally when ChrootDir is set    |
|52927|Inf|Nor|2012-03-16|[Bug in httpd 2.2.4] [error] (70014)End of file fo|
|52933|New|Nor|2012-03-17|Child survives '-k stop', consuming lots of CPU   |
|52950|New|Nor|2012-03-20|Error when set AuthType to None with valid-user   |
|52963|New|Nor|2012-03-21|Typo in AuthLDAPURL RFC 2255 error message        |
|52975|New|Nor|2012-03-23|Receiving files is suboptimal                     |
|52976|New|Min|2012-03-23|Gratuitous string-duplication in module-configurat|
|52978|New|Enh|2012-03-23|Binding to an interface instead of an address     |
|52995|New|Nor|2012-03-28|httpd -V does not print the default Mutex         |
|53002|New|Nor|2012-03-29|<Location> and auth_form (trailing slash problem?)|
|53015|New|Nor|2012-03-31|missing apr_socket_close                          |
|53016|New|Nor|2012-03-31|missing apr_brigade_destroy                       |
|53023|New|Nor|2012-04-02|mod_rewrite RewriteCond parser error and documenta|
|53037|New|Enh|2012-04-05|clarify mod_ssl documentation on the UID/GID conte|
|53059|New|Nor|2012-04-10|Make httpd easier relocatable by using a variable |
|53098|New|Nor|2012-04-18|mod_proxy_ajp: patch to set worker secret passed t|
|53099|New|Enh|2012-04-18|feature request for mod_remoteip                  |
|53108|New|Enh|2012-04-19|clarification on url-path vs full filesystem path |
|53111|New|Nor|2012-04-20|1% of CMS sites expose database passwords         |
|53121|New|Nor|2012-04-22|Confusing documentation, gzip and deflate         |
|53149|New|Enh|2012-04-25|mod_ldap should/could use mod_socache             |
|53152|Opn|Nor|2012-04-26|RewriteRule documentation: Error about per-directo|
|53156|New|Enh|2012-04-27|CRL validation fails if CRL is missing            |
|53160|New|Cri|2012-04-29|Reverse Proxy mod_deflate doesn't zip back content|
|53183|New|Min|2012-05-03|mod_apreq2 entry point is apreq_module and not apr|
|53193|New|Nor|2012-05-04|SLVerifyClient optional_no_ca + SSLSessionCache = |
|53218|New|Blk|2012-05-11|ProxyPass worker name(http://localhost:3128/...|
|53233|New|Maj|2012-05-15|Internal error: proxy: error reading status line f|
|53239|New|Maj|2012-05-16|Httpd has problems delivering data on rate-limited|
|53253|New|Maj|2012-05-17|TCP_NOPUSH used with sendfile(2), cause transfers |
|53284|New|Nor|2012-05-24|crash                                             |
|53290|New|Maj|2012-05-24|memory usage                                      |
|53292|New|Min|2012-05-25|add support for HTTP status code 308              |
|53305|New|Nor|2012-05-28|404 errors when adding query string in a balancer |
|53313|New|Nor|2012-05-28|SSI #echo VAR fails (#include OK) if URI/URL has f|
|53319|New|Nor|2012-05-29|Multiple DirectoryIndex statements in the same con|
|53332|New|Nor|2012-05-30|Requests with chunked encoding have no body availa|
|53350|New|Nor|2012-06-01|mod_cache caching 403 responses Apahce 2.2.22     |
|53351|New|Nor|2012-06-02|make fails if layout begins on first line of confi|
|53388|Opn|Nor|2012-06-08|mod_proxy_balanser generates 503 when proxying to |
|53402|New|Trv|2012-06-12|Incorrect error message for mod_ldap params       |
|53461|Inf|Cri|2012-06-23|Compilation problems                              |
|53462|New|Nor|2012-06-25|mod_rewrite does not remove trailing slash when as|
|53479|New|Nor|2012-06-27|mod_rewrite [B] flag should percent-encode the spa|
|53483|New|Enh|2012-06-29|dangerous PCRE patterns in *Match directives      |
|53539|New|Maj|2012-07-12|content type and character set are changing when t|
|53554|New|Nor|2012-07-16|Wrong case for hexadecimal percent encoding [patch|
|53555|New|Maj|2012-07-17|Scoreboard full error with event/ssl              |
|53579|New|Cri|2012-07-20|httpd looping writing on a pipe and unresponsive (|
|53581|New|Blk|2012-07-21|FollowSymlinks doesn't work with DirectoryMatch an|
|53594|New|Enh|2012-07-24|ipad as webserver                                 |
|53595|New|Nor|2012-07-24|Media type qs parameters for MultiViews sent in Co|
|53612|Inf|Nor|2012-07-27|Reverse Proxy causing 500 error SSL proxy 1.0.1c O|
|53618|New|Nor|2012-07-29|proxy_worker_shared fields not maintained in threa|
|53634|New|Nor|2012-08-01|mod_cache returning HTTP 200 for nonexistent resou|
|53638|New|Nor|2012-08-02|Problem with shortcuts to bugzilla in http://httpd|
|53640|Inf|Maj|2012-08-02|make: Fatal error: Command failed for target `htpa|
|53643|New|Cri|2012-08-02|apache segfaults with mod_authn_dbd when dbd_min i|
|53646|New|Nor|2012-08-02|Invalid uniformly distributed balancing of request|
|53651|New|Nor|2012-08-03|Worker failure doesn't have same behaviour as work|
|53667|New|Enh|2012-08-07|Add an equivalent option to "JkOptions ForwardLoca|
|53669|New|Nor|2012-08-07|IndexOptions Incremental IndexOptions documentatio|
|53686|New|Enh|2012-08-09|Status "501 Not Implemented" sent very late       |
|53690|New|Nor|2012-08-09|Calls to semctl() trigger "uninitialized memory" w|
|53692|New|Nor|2012-08-10|mod_auth_form loses request body before login page|
|53693|Opn|Nor|2012-08-10|mod_fcgid performance suffers under increase in re|
|53704|New|Enh|2012-08-13|True online configuration is needed - via LDAP?   |
|53705|New|Nor|2012-08-13|Align server-status balancer display to balancer-m|
|53706|New|Enh|2012-08-13|Include a status display for mod_ldap when present|
|53722|New|Nor|2012-08-15|when -D NO_DETACH is used, no PID file should be c|
|53736|New|Nor|2012-08-17|/balancer-manager doesn't save runtime adjusted se|
|53757|New|Enh|2012-08-21|RewriteMap of type txt should allow specifying col|
|53767|New|Nor|2012-08-23|htcacheclean deletes stale "vary" header files eve|
|53772|New|Nor|2012-08-24|REDIRECT_URL not accessible in mod_proxy          |
|53787|New|Reg|2012-08-28|In forward proxy, doesn't cache disk anymore      |
|53823|New|Nor|2012-09-03|[patch] pure IPv6 only host fix (server/config.c) |
|53835|New|Cri|2012-09-06|mod_proxy_ajp truncate output when using deflate i|
|53870|New|Maj|2012-09-13|Deadlock in CRYPTO_add_lock with Apache 2.2.22 wor|
|53886|New|Nor|2012-09-18|can't start apache control in Redhat Linux 3 X64  |
|53899|New|Nor|2012-09-19|SSL_OP_ALL disables the mitigation code for CVE-20|
|53915|New|Nor|2012-09-21|Colon lost when :port is used in CacheKeyBaseURL  |
|53919|Inf|Enh|2012-09-21|DEFAULT_LOG_FORMAT is not RFC6302 compliant       |
|53923|New|Min|2012-09-23|Overriding CustomLog directive seems impossible   |
|53932|New|Nor|2012-09-25|PROPFIND doesn't support If, If-Match ETag predica|
|53947|New|Enh|2012-09-29|Feature Request, RewriteRule - ProxyPreserveHost f|
|53961|New|Nor|2012-10-04|Null sessions to the default vhost                |
|53970|New|Nor|2012-10-05|Network control directives affects internal subreq|
|53981|New|Nor|2012-10-08|move def of log_request_state from mod_log_config.|
|53988|New|Enh|2012-10-10|Missing FCGIWrapper script should not be a critica|
|53999|Opn|Nor|2012-10-13|Deadlock between procmgr_send_spawn_cmd()/proctabl|
|54030|New|Enh|2012-10-19|Support subjectAltName when (reverse-)proxying    |
|54033|New|Enh|2012-10-21|Parent languages are not ordered according to Acce|
|54072|New|Reg|2012-10-30|Syntax error front-end virtual-path too long      |
|54102|New|Enh|2012-11-05|new feature: automatic route detection            |
|54118|New|Nor|2012-11-08|Handle leak on parent httpd process when rotatelog|
|54126|New|Maj|2012-11-09|Mod_rewrite failing because of url in query string|
|54134|New|Enh|2012-11-11|new feature: ability to use multiple routes in sti|
|54136|New|Min|2012-11-11|balancer-handler shows xml not, when only xml para|
|54158|New|Nor|2012-11-16|Suggestion regarding 2.0 to 2.2 Upgrade Documentat|
|54183|Inf|Nor|2012-11-21|PROPFIND doesn't report getcontenttype property   |
|54215|New|Maj|2012-11-27|configure fails for httpd 2.2.3 with openssl 1.0.1|
|54221|Opn|Nor|2012-11-28|no ErrorLog prefix on CGI errors                  |
|54222|New|Min|2012-11-28|ServerTokens checking is not complete             |
|54223|New|Nor|2012-11-29|AH00554 error when runtime configuration Includes |
|54252|New|Nor|2012-12-05|acinclude.m4 requires -lz when linking with ssl st|
|54253|New|Nor|2012-12-05|mod_proxy_ftp doesn't handle/log partial or cancel|
|54255|New|Nor|2012-12-06|mod_deflate adjusts the headers "too late", should|
|54269|New|Maj|2012-12-09|mod_proxy_html documentation misses several things|
|54276|New|Nor|2012-12-10|rotatelogs not getting killed on graceful restart |
|54280|New|Nor|2012-12-11|mod_auth_form inline login not working with traili|
|54281|New|Nor|2012-12-11|Stick use Partial parameters from query string    |
|54289|New|Nor|2012-12-13|"ap_get_brigade" api is failing in "AP_MODE_SPECUL|
|54306|New|Enh|2012-12-15|add regexp versions of ProxyPassReverse, ProxyPass|
|54309|New|Trv|2012-12-15|clarification on the <Location> directive when use|
|54310|Opn|Nor|2012-12-15|mod_proxy_html drops meta elements with http-equiv|
|54319|New|Reg|2012-12-17|ProxyPass has no effect in <Location> if rewrite o|
|54339|New|Nor|2012-12-21|piped log entries > PIPE_BUF can be interleaved   |
|54342|New|Nor|2012-12-22|AuthnCacheSOCache can't pass args to socache provi|
|54343|New|Maj|2012-12-22|Add sanity checks for malloc() in mpm_winnt.c and |
|54358|New|Nor|2012-12-29|Status 500 when using ldap on Solaris because apr_|
|54363|New|Nor|2012-12-31|make time conversion caching functions thread-safe|
|54364|New|Nor|2012-12-31|Add ref to mod_fcgid docs                         |
|54365|New|Nor|2013-01-02|Connection closed by server during file transfer  |
|54366|New|Nor|2013-01-02|$sysconfdir/extra/httpd-dav.conf is not built base|
|54367|Opn|Maj|2013-01-02|Location header in response to PUT is not %-escape|
|54385|New|Enh|2013-01-08|SSL configuration independent from virtual hosts, |
|54401|New|Nor|2013-01-10|Suggest to make ProxyPassReverseCookieDomain accep|
|54415|New|Enh|2013-01-14|Please tell the root cause of mutex and scoreboard|
|54431|Inf|Blk|2013-01-16|Unable to start the Apache 2.4.3 windows service. |
|54498|New|Nor|2013-01-28|apache crash on any cgi request with certain http |
|54502|New|Nor|2013-01-29|Apache deadlock on epoll_ctl error (1000 process l|
|54512|Inf|Cri|2013-01-31|Apache hung                                       |
|54517|New|Nor|2013-02-01|proxy balancer: timeout or partial failure of back|
|54518|New|Nor|2013-02-01|mod_rewrite not adding Vary header                |
|54519|New|Nor|2013-02-02|httpd already running                             |
|54526|New|Nor|2013-02-05|mod_proxy_http ignores request abortion           |
|54543|New|Enh|2013-02-10|Compile regex only when need                      |
|54546|New|Nor|2013-02-11|httpd crashes on first HUP after change Listen dir|
|54549|New|Nor|2013-02-11|mod_mime AddEncoding and mod_negotiation fix_encod|
|54556|New|Enh|2013-02-13|New flag to add default rule in rule chain        |
|54560|New|Nor|2013-02-13|Potential segfault on return from ap_server_root_r|
|54563|New|Maj|2013-02-15|mod_webdav ignores quota                          |
|54578|New|Nor|2013-02-18|Bad docs or unchecked code for "LimitRequestFields|
|54605|New|Enh|2013-02-24|mod_negotiation should cache the info it generates|
|54608|New|Enh|2013-02-25|Support an option to allow page caching when using|
|54622|New|Nor|2013-02-28|shared memory cleanup                             |
|54626|New|Nor|2013-03-01|mod_authnz_ldap through util_ldap.c does not suppo|
|54633|New|Nor|2013-03-04|Invalid % encoding not rejected                   |
|54637|New|Nor|2013-03-05|Digest: secret not used                           |
|54640|New|Nor|2013-03-05|Slow transaction on a balance member is holding su|
|54649|New|Nor|2013-03-06|Incorrect PIDFILE prevent httpd restart           |
|54653|New|Min|2013-03-08|Suggestion to add https example for forward proxy |
|54656|New|Maj|2013-03-09|SNI and SSLProxyCheckPeerCN based on "connection" |
|54657|New|Nor|2013-03-09|DNS lookup failure for load balancer member does n|
|54683|New|Min|2013-03-13|Ignor directive ErrorDocument with null byte      |
|54699|Opn|Enh|2013-03-15|[feature request] cli webaccess tester            |
|54701|New|Cri|2013-03-15|Apache 2.4.3 Migration Issue Not loading the pages|
|54704|New|Nor|2013-03-15|Web Services stalling on it's own                 |
|54719|New|Nor|2013-03-18|httpd should check for and eventually create pid f|
|54752|New|Nor|2013-03-25|mod_ssl should not use uninitialized memory as ran|
|54782|New|Nor|2013-04-02|Memory Corruption errors - mpm_worker mod_perl    |
|54785|New|Nor|2013-04-02|Random crash when httpd server is stopped         |
|54793|New|Nor|2013-04-03|Socket timeout handler can delete uploaded files P|
|54794|New|Reg|2013-04-03|mod_wsgi|fcgid and subversion >= 1.7 issues       |
|54795|New|Nor|2013-04-03|'apxs -g -n' should be self-referring             |
|54796|Inf|Enh|2013-04-03|CustomLog should be able to use syslog as ErrorLog|
|54804|New|Nor|2013-04-05|mod_fcgid sends a Continue 100 response automatica|
|54813|New|Nor|2013-04-08|documnt the Require args used by authz_dbm includi|
|54816|Inf|Nor|2013-04-08|AH00566: request failed: invalid characters in URI|
|54817|New|Nor|2013-04-09|if prefix and sysconfdir are the same then http.co|
|54820|Inf|Cri|2013-04-09|REwriterule stops working                         |
|54824|New|Nor|2013-04-10|Spec file is missing libuuid-devel requirement    |
|54830|New|Enh|2013-04-11|Make SSLPProxyMachineCertificateFile configurable |
|54848|New|Nor|2013-04-15|Client field too short for IPv6 addresses         |
|54856|Inf|Enh|2013-04-17|NSCreateObjectFileImageFromFile                   |
|54858|New|Nor|2013-04-17|ld duplicate                                      |
|54861|New|Blk|2013-04-18|The number of connections with mysql is more      |
|54869|Inf|Nor|2013-04-19|Non-breaking space characters cause httpd to choke|
|54875|New|Nor|2013-04-23|Conditional request predicated on another URL's ET|
|54878|New|Nor|2013-04-23|Multiple Listen directives prevent server to start|
|54905|Inf|Cri|2013-04-29|Apache2 loops in child Segfaults                  |
|54910|New|Enh|2013-04-30|Format %{Foobar}o cannot be used to log Date and S|
|54911|New|Enh|2013-04-30|Allow logging of fields set by a backend server in|
|54914|New|Nor|2013-04-30|mod_dir DirectoryIndex breaks WebDAV PROPFIND / DE|
|54915|New|Nor|2013-04-30|GET on a WebDAV-enabled collection, with Directory|
|54918|New|Enh|2013-05-02|Implement RFC 6797 HTTP Strict Transport Security |
|54919|Inf|Nor|2013-05-02|*** glibc detected *** /usr/sbin/httpd: double fre|
|54930|New|Nor|2013-05-06|Allow empty message in ErrorDocument directive    |
|54934|Inf|Cri|2013-05-07|Apache is crashing intermittently with a message "|
|54936|New|Nor|2013-05-08|Some potential bugs reported by static analysis to|
|54949|New|Nor|2013-05-10|[PATCH] mod_cache: fix uninitialized tmppath varia|
|54952|Inf|Cri|2013-05-10|[Fri May 10 17:39:01 2013] [error] proxy: CLUSTER:|
|54953|New|Nor|2013-05-11|<VirtualHost 0.0.0.0:80> matches IPv6             |
|54958|New|Nor|2013-05-13|mod_deflate + mod_mime with SSI gives mixed compre|
|54962|New|Maj|2013-05-14|Apache will set incorrect Content-Length header an|
|54965|New|Enh|2013-05-14|Allow ProxyPassMatch in Directory context         |
|54976|New|Nor|2013-05-15|ProxyPass parameter "acquire" and "ttl" ignored in|
|54986|New|Maj|2013-05-16|httpd hanging on large form submit in ap_run_handl|
|54989|New|Nor|2013-05-17|Apache Segfaults on OS X at random - how can I dia|
|54993|New|Nor|2013-05-20|Critical error: File descriptor in bad state: apr_|
|54998|Ver|Nor|2013-05-21|Apache 2.4 terminates all SSL connections using an|
|55000|New|Nor|2013-05-21|Memory usage per process doubles when Apache is co|
|55021|New|Enh|2013-05-28|Support arbitrary sql to authentication username/p|
|55022|Inf|Cri|2013-05-28|child pid 3123 exit signal Bus error (10) - Apache|
|55034|Inf|Maj|2013-05-31|Apache 2.4.4 won't open more that 32k VH file hand|
|55039|New|Enh|2013-05-31|"RequestHeader edit" can't access environment vari|
|55045|New|Nor|2013-06-01|calls to gets() in test_find.c and test_parser.c  |
|55068|New|Enh|2013-06-06|root permissions when writing to per vhosts errorl|
|55069|New|Min|2013-06-06|notice message in error_log even when LogLevel err|
|55070|Opn|Enh|2013-06-06|mod_fcgid stderr always goes to main error log    |
|55072|New|Nor|2013-06-07|ErrorLog doesn't work well when apache shutdown   |
|55093|New|Nor|2013-06-12|[PATCH] mod_fcgid 2.3.7 truncates large posts on R|
|55096|New|Nor|2013-06-12|Make not running on httpd configure Solaris       |
|55098|New|Nor|2013-06-13|does not listen to IP4 when both IP4 address and I|
|55106|New|Enh|2013-06-17|ProxyErrorOverride considers response codes >= 400|
|55117|New|Nor|2013-06-18|GracefullTimeout for worker threads               |
|55148|Inf|Nor|2013-06-26|Error during SSL Handshake with remote server     |
|55152|New|Nor|2013-06-28|graceful restart adjusts to new balancer members, |
|55156|New|Nor|2013-06-28|mod_cache not respecting s-maxage cache-control he|
|55178|New|Nor|2013-07-01|[PATCH] mod_authnz_ldap SASL authentication suppor|
|55192|New|Trv|2013-07-03|htaccess error messages missing request context   |
|55193|New|Min|2013-07-03|ErrorLogFormat is ignored by some modules         |
|55226|New|Enh|2013-07-09|Request for "domain cluster" feature for mod_proxy|
|55234|New|Maj|2013-07-10|Working of attribute "protocol" attribute "protoco|
|55276|Inf|Enh|2013-07-17|Add REST API for load balancer for dynamic registr|
|55278|New|Nor|2013-07-18|mod_session's cookie may be empty, is repeated twi|
|55284|New|Nor|2013-07-20|repeatable segv                                   |
|55286|New|Nor|2013-07-21|Floating point exception (8) in mod_auth_digest   |
|55293|New|Nor|2013-07-22|Incorrect default MIME type for .woff fonts       |
|55306|New|Nor|2013-07-25|Error when copying svn repository, which contains |
|55323|New|Nor|2013-07-29|Double unescaped uri in sub request handler       |
|55327|New|Nor|2013-07-30|Segmentation fault when stopping Apache 2.4.6 norm|
|55340|New|Maj|2013-08-01|Listen for valid, unconfigured IP address passes c|
|55344|New|Nor|2013-08-02|missing ap_hook_monitor on windows                |
|55346|New|Nor|2013-08-02|When on filled quota filesystem, mod_fcgid init in|
|55348|New|Nor|2013-08-02|%h is not changed in logging, only %a             |
|55351|New|Enh|2013-08-04|allow ProxyPassReverseCookieDomain to automaticall|
|55362|New|Nor|2013-08-05|Apache httpd sends "400 Bad Request" to client due|
|55379|New|Min|2013-08-07|htdigest -c doesn't behave as described anymore   |
|55394|New|Nor|2013-08-09|apache 2.4 randomy crashes with signal 6          |
|55401|New|Enh|2013-08-11|document that force-proxy-request-1.0 implies prox|
|55415|New|Maj|2013-08-14|Proxy loop caused by ProxyErrorOverride and ErrorD|
|55431|New|Nor|2013-08-16|mod_negotation does not force the mime type listed|
|55433|New|Nor|2013-08-16|mod_proxy ignores final status code for aborted re|
|55443|Inf|Maj|2013-08-17|never gives 300 multiple choices                  |
|55445|New|Maj|2013-08-18|mod_socache_memcache ignores expiry, creating eter|
|55447|New|Enh|2013-08-18|make type-maps usable again, by making them access|
|55448|New|Nor|2013-08-19|segfault in set_max_workers at event.c:3194 on SIG|
|55449|New|Maj|2013-08-19|AH01185: worker slotmem_create failed --> slotmem |
|55452|New|Maj|2013-08-19|Redirect                                          |
|55458|New|Enh|2013-08-20|allow to configure what mod_ssl responds when one |
|55460|New|Enh|2013-08-21|allow service names to be used in the Listen direc|
|55467|New|Nor|2013-08-21|Support for OpenSSL custom TLS extensions and supp|
|55523|New|Trv|2013-09-04|auth_groupfile error log on access even though suc|
|55535|Inf|Nor|2013-09-08|incorrect check state parametr                    |
|55540|New|Cri|2013-09-09|mod_proxy gzip chunked issue (sample site provided|
|55549|New|Min|2013-09-11|AuthLDAPSubGroupAttribute doesn't do anything     |
|55550|New|Nor|2013-09-11|AuthLDAPSubGroupClass checking is very inefficient|
|55556|New|Nor|2013-09-13|apachebench (ab) doesn't use so_reuseaddr         |
|55557|New|Nor|2013-09-14|Some cppcheck reports                             |
|55573|New|Enh|2013-09-19|FileETag needs MTimeSeconds, MTime with granularit|
|55581|New|Enh|2013-09-22|Support concurrent connections to same FastCGI pro|
|55590|Inf|Maj|2013-09-24|second commit is failing if space is in file name |
|55596|New|Enh|2013-09-25|Add date format used by Expires header            |
|55607|New|Enh|2013-09-28|Re-set HOME environment variable to directory from|
|55615|New|Nor|2013-09-30|Connections are starved and not balanced when conc|
|55619|New|Nor|2013-10-02|Apache httpd reported 500 internal error when uplo|
|55627|New|Min|2013-10-04|Remove unnecessary APLOGNO() for trace logging per|
|55636|Inf|Cri|2013-10-07|long lost child came home - Apache is not respondi|
|55646|Inf|Nor|2013-10-10|non-2xx responses are not considered errors       |
|55654|New|Nor|2013-10-15|Extract variables from configuration without start|
|55670|New|Min|2013-10-18|Startup may fail silently at post_config          |
|55673|New|Nor|2013-10-18|httpd fails to start with SSLProxyMachineCertifica|
|55680|New|Enh|2013-10-20|online manual directory option doesn't exist      |
|55698|New|Maj|2013-10-24|Apache 2.2 + mod_fcgid 2.3.7 (CentOS 6.4) graceful|
|55700|New|Enh|2013-10-24|add something like RewriteOptions InheritDown     |
|55707|New|Nor|2013-10-25|SSLProtocol directive seem to be ignored over diff|
|55708|New|Nor|2013-10-25|Access violation in msvcrt.dll when calling getenv|
|55711|New|Min|2013-10-28|--enable-foo doesn't enable foo                   |
|55712|New|Nor|2013-10-28|Relative <!--#include virtual="../file.shtml"--> g|
|55720|New|Enh|2013-10-29|separate LDAP Bind timeout from LDAPTimeout       |
|55738|New|Nor|2013-11-03|PVS-Studio: few issues                            |
|55763|New|Nor|2013-11-09|raise roots soft RLIMIT_NPROC on linux for high ma|
|55774|New|Nor|2013-11-13|ab: optionally accept tls client certificate      |
|55781|New|Nor|2013-11-15|ajp_read_header: ajp_ilink_receive failed; 120006)|
|55786|New|Maj|2013-11-16|SSLVerifyClient and OptRenegotiate result in a 403|
|55787|New|Maj|2013-11-16|Chroot fails with "Cannot chroot when not started |
|55790|New|Maj|2013-11-17|mod_fcgid lockfile hardcoded to be in /tmp        |
|55793|New|Enh|2013-11-18|DTrace/SystemTap support                          |
|55808|New|Nor|2013-11-21|File integrity verification using MD5 and SHA1    |
|55819|Inf|Nor|2013-11-27|Closing connection behaviour                      |
|55828|New|Cri|2013-11-28|Httpd not start if use ProxyPass balancer://      |
|55834|New|Maj|2013-12-02|Apache does not honor the openssl library path giv|
|55838|New|Nor|2013-12-03|PHP files are being executed instead of downloaded|
|55841|New|Nor|2013-12-04|Misleading news items on bugfix releases ("This ve|
|55856|New|Nor|2013-12-08|YYEMPTY (-2) used as index into yytname (const arr|
|55866|New|Nor|2013-12-11|When ProxyPreserveHost is on, SSL expects the wron|
|55878|New|Nor|2013-12-12|mod_fcgid kills spawned processes too early       |
|55881|New|Nor|2013-12-13|segmentation fault at proxy_util.c:1546           |
|55883|New|Enh|2013-12-14|string callers of ap_expr should be able to transf|
|55887|New|Maj|2013-12-16|In Windows apache, when user access to /con, apach|
|55898|New|Enh|2013-12-17|[RFE] listen on unix socket?                      |
|55914|New|Reg|2013-12-20|child exit segmentation fault after apache gracefu|
|55919|New|Nor|2013-12-22|EPREFIX and dynamic modules                       |
|55942|New|Nor|2014-01-01|400 - Bad Request on POST (Windows Server 2012 Hyp|
|55952|New|Nor|2014-01-05|ab: SSL keep-alive fails with apr_pollset_poll: Th|
|55962|New|Enh|2014-01-06|mod_remoteip should not allow an external proxy to|
|55963|New|Nor|2014-01-07|Add application/ld+json to mime.types             |
|55981|Opn|Nor|2014-01-09|mod_mbox hang on some e-mails on user@openoffice.a|
|55985|Opn|Nor|2014-01-10|apache does not reopen logs when multiple graceful|
|55989|Opn|Enh|2014-01-11|write to error log upon RewriteRule [F]orbidden   |
|55991|New|Nor|2014-01-12|mod_charset_lite doesn't bail out on non-identity |
|56009|Inf|Cri|2014-01-14|Memory leak in httpd 2.4.3 over time with persista|
|56014|New|Nor|2014-01-15|MOd rewrite CO Cookie method the lifetime flag not|
|56028|New|Enh|2014-01-17|Add http/1.0, http/1.1 NPN advertisement to enable|
|56034|New|Nor|2014-01-20|CPU consumption due to circular linked list in ap_|
|56040|New|Enh|2014-01-21|should be able to remove Max-Age cookie parameter |
|56041|New|Enh|2014-01-21|should be able to disable session expiry increment|
|56052|New|Nor|2014-01-22|ap_session_load called multiple times for expired |
|56055|New|Nor|2014-01-23|Route is not extracted properly when a session coo|
|56064|New|Enh|2014-01-25|Optimize PNGs                                     |
|56067|New|Nor|2014-01-27|FallbackResource doesn't work if directory exists |
|56081|New|Maj|2014-01-28|Apache 2.2.26 SIGSEGVs when POST'ing data         |
|56091|Inf|Nor|2014-01-30|SSL handshake error when httpd compiled on Oracle |
|56098|New|Nor|2014-02-01|duplicate cookie                                  |
|56101|New|Cri|2014-02-03|Apache 2.4.6 ceases processing requests (scoreboar|
|56102|New|Nor|2014-02-03|SSL_CLIENT_S_DN_x509_0 is undefined in the environ|
|56109|New|Nor|2014-02-05|Cannot increase the read limit                    |
|56113|New|Nor|2014-02-06|dist commit messages missing from mail-archives di|
|56131|New|Nor|2014-02-12|ProxyPassReverse / zealously replaces Location hea|
|56135|New|Nor|2014-02-13|Add DC to list of x509 components                 |
|56152|New|Nor|2014-02-18|ProxyBlock does not accept network addresses      |
|56176|New|Nor|2014-02-21|mod_substitute truncates the response body if the |
|56188|New|Nor|2014-02-25|mod_proxy_fcgi does not send FCGI_ABORT_REQUEST on|
|56209|New|Nor|2014-03-03|Uninitialised variables in os/win32/ap_regkey.c   |
|56226|Ver|Nor|2014-03-06|per VirtualHost KeepAliveTimeout is not recognized|
|56229|New|Enh|2014-03-06|ocsp ProxyHost and ProxyPort support              |
|56230|New|Nor|2014-03-07|mod_access_compat can log a bogus client denied me|
|56235|New|Nor|2014-03-07|quotes should be optional around expr             |
|56247|New|Cri|2014-03-12|semaphore creation for proxypass                  |
|56250|New|Nor|2014-03-12|sbindir in config.layout for Apache has bin instea|
|56251|New|Nor|2014-03-12|Increase maximum length of FcgidInitialEnv string |
|56252|New|Enh|2014-03-12|make install as privileged user creates files not |
|56262|New|Nor|2014-03-14|ab does not work with extremely long cookies      |
|56264|New|Trv|2014-03-14|Confusing error with .htaccess rewrite to proxy wh|
|56270|New|Enh|2014-03-15|--with-ssl=/foo w/o pkgconfig needs help on AIX 64|
|56288|New|Enh|2014-03-19|rewrite URLs in style attributes                  |
|56289|New|Nor|2014-03-19|Buffer overflow in mod_proxy_html's string replace|
|56308|New|Nor|2014-03-24|1 second delay in handle request kills performance|
|56312|New|Nor|2014-03-25|Can't configure different balancing workers that c|
|56314|New|Nor|2014-03-25|exiting from MPM-worker child caused assert in apr|
|56326|New|Nor|2014-03-27|cache_quick_handler does not serve responses with |
|56331|New|Nor|2014-03-29|windows 'access denied' during revalidaton of reso|
|56333|New|Enh|2014-03-31|API to resume a SUSPENDED connection              |
|56362|New|Maj|2014-04-08|ldaps only works with port 636. Non-standard port |
|56379|New|Nor|2014-04-09|Number of columns in the results returned from pgs|
|56395|New|Enh|2014-04-11|Allow SERVER_ADDR environment variable to be optio|
|56404|New|Nor|2014-04-12|endless loop  when connect to a website(https)  wh|
|56413|New|Blk|2014-04-15|can not restart httpd on centos 5.10 64bit        |
|56422|New|Nor|2014-04-17|authnz_ldap with other forms of authn can fail req|
|56457|New|Nor|2014-04-25|mod_proxy_html.c: 2 * cut'n'paste errors          |
|56473|New|Nor|2014-04-30|ETags don't change when headers do                |
|56475|New|Enh|2014-04-30|Allow TLS record size to be configured            |
|56483|New|Enh|2014-05-02|add disableKeepAlivePercentage similar to tomcat h|
|56493|New|Min|2014-05-06|mod_expires should not set expires in future for s|
|56495|New|Nor|2014-05-06|Application behind mod_proxy does not get SessionH|
|56500|Opn|Enh|2014-05-07|vhosts priority order with wildcard               |
|56504|New|Nor|2014-05-08|cannot build static support binaries              |
|56508|New|Nor|2014-05-09|Requiring SNI - SSLStrictSNIVHostCheck semantics  |
|56517|New|Enh|2014-05-12|Virtualhosts cannot inherit parent CustomLog      |
|56528|New|Enh|2014-05-15|"bad flags delimiter" - improve helpfulness       |
|56541|New|Nor|2014-05-18|Proxy 502's on large file post requests           |
|56559|New|Nor|2014-05-25|multiple unix sockets in one virtualhost fails    |
|56569|New|Nor|2014-05-27|Null CRC in gzip footer with mod_cgid and ErrorDoc|
|56587|New|Nor|2014-06-03|Many VirtualHost's with SSLEngine On              |
|56590|New|Enh|2014-06-04|(REST-) API for configuring balancer manager remot|
|56594|Inf|Nor|2014-06-05|mod_authn_dbd, mod_dbd and mod_ssl                |
|56598|New|Nor|2014-06-06|Content-Length header should be always interpreted|
|56621|New|Nor|2014-06-13|Rotatelogs.exe first start                        |
|56622|New|Nor|2014-06-13|mod_reqtimeout incorrectly applies timeouts to CON|
|56626|New|Nor|2014-06-15|Add info about rotatelogs to log rotation document|
|56633|New|Nor|2014-06-16|mod_auth_basic breaks mod_autoindex               |
|56645|New|Maj|2014-06-19|socket callback with timeout callback causes infin|
|56664|New|Nor|2014-06-24|Proxy retry timeout does not cope with system time|
|56697|New|Maj|2014-07-04|status page still shown while blocked             |
|56718|New|Nor|2014-07-14|Cleanup request Host headers when absolute URI are|
|56719|New|Nor|2014-07-14|parallel requests get served with delays          |
|56738|New|Enh|2014-07-17|Ability to extract route from cookie with regexp  |
|56740|New|Nor|2014-07-18|suspended_count not maintained properly with wstun|
|56750|New|Enh|2014-07-20|SuexecUserGroup replacement                       |
|56751|New|Maj|2014-07-20|Fails to properly mitigate Slow Post DoS attack   |
|56753|New|Nor|2014-07-21|mod_lua.so: symbol luaL_openlib: referenced symbol|
|56778|New|Nor|2014-07-28|while running make command i got this error       |
|56794|New|Nor|2014-07-31|Added AuthDBDFullAuthQuery option                 |
|56795|Inf|Nor|2014-07-31|Apache 2.4.10 Program received signal SIGPIPE, Bro|
|56818|Inf|Nor|2014-08-05|SetEnvIf may set invalid string length on empty st|
|56843|New|Enh|2014-08-12|Support different OCSP stapling max ages          |
|56868|New|Nor|2014-08-18|relative LuaRoot broken                           |
|56879|New|Nor|2014-08-22|Information disclosure                            |
|56889|New|Nor|2014-08-26|Close state never dies                            |
|56918|Opn|Blk|2014-09-06|error: 'ap_copy_scoreboard_worker' undeclared here|
|56926|New|Nor|2014-09-08|Filename causes AH02599 slotmem issue             |
|56933|New|Min|2014-09-09|not sure it's an appache bug : some browser want t|
|56942|New|Reg|2014-09-10|Unable to implement TRANSFER-CHUNKED:ENCODING with|
|56943|New|Nor|2014-09-10|mod_proxy_connect - AH02447: err/hup on backconn  |
|56977|New|Maj|2014-09-12|segfaults when using mod_mem_cache + mod_disk_cach|
|56986|New|Blk|2014-09-17|chunked Transfer-Encoding forbidden: /test/test.dl|
|57014|New|Cri|2014-09-24|Incorrect test for CC_FOR_BUILD prevents build (on|
|57023|New|Nor|2014-09-26|Socache shmcb don't cache file bigger than 11k    |
|57028|New|Enh|2014-09-27|mod_spdy - support Apache 2.4                     |
|57044|New|Nor|2014-09-29|[PatchAvailable] Use base64url in mod_unique_id ('|
|57045|New|Nor|2014-09-30|dumpio output strings are missing                 |
|57046|New|Enh|2014-09-30|Add additional parameter to enable check URL befor|
|57056|New|Maj|2014-10-03|Rewrite port is taken into hostname               |
|57067|New|Nor|2014-10-08|A proxy worker both standalone and balancer member|
|57069|New|Nor|2014-10-08|apache ssl timeout during chunked request in rever|
|57073|New|Cri|2014-10-09|Intermittent Connection Issues using default httpd|
|57085|New|Enh|2014-10-14|Implement Proxy Protocol in httpd                 |
|57087|New|Nor|2014-10-14|mod_proxy_fcgi doesn't send cgi CONTENT_LENGTH var|
|57100|Ver|Nor|2014-10-16|"SSLProtocol ALL" is ignored for virtual hosts    |
|57101|New|Enh|2014-10-16|[PATCH] Better error reporting when child spawn fa|
|57109|New|Nor|2014-10-17|GPG verification examples are wrong               |
|57119|Opn|Enh|2014-10-20|Suppress address reuse / DNS cache in mod_proxy   |
|57121|New|Nor|2014-10-21|ocsp stapling should not pass temporary server out|
|57131|New|Nor|2014-10-22|OCSP Stapling scalability concern                 |
|57159|New|Min|2014-10-28|mod_ssl OCSP Stapling directives don't support per|
|57160|New|Nor|2014-10-29|httxt2dbm doesn't generate files on NAS           |
|57174|New|Nor|2014-10-31|Update windows visual studio build                |
|57210|New|Nor|2014-11-14|LuaHookMapToStorage not firing in per-directory co|
|57211|New|Enh|2014-11-14|Config-time options                               |
|57212|Opn|Nor|2014-11-14|Headers returned by scripts are limited to 8190 by|
|57218|New|Nor|2014-11-15|[Feature Request] Apache Bench (AB) to output a cs|
|57219|New|Nor|2014-11-15|ApacheBench quits unexpectedly with high concurren|
|57220|New|Nor|2014-11-15|[Feature Request] Add option to ApacheBench to giv|
|57228|New|Nor|2014-11-17|glibc detected *** httpd: double free or corruptio|
|57229|New|Maj|2014-11-17|mod_sed dies on long lines                        |
|57286|New|Nor|2014-11-29|Symbolic links are not honoured                   |
|57298|New|Min|2014-12-02|RewriteBase inside FilesMatch behaves oddly       |
|57299|New|Enh|2014-12-02|mod_session_dbd should not make a database call pe|
|57300|New|Enh|2014-12-02|mod_session_dbd should not save the session at eac|
|57301|New|Enh|2014-12-02|Add SessionMaxAgeAbsolute Directive               |
|57304|Inf|Nor|2014-12-03|MySQL DBD Authentication Incompatible with SSL    |
|57311|New|Nor|2014-12-04|BalancerMember enclosed by <If> gives syntax error|
|57313|New|Nor|2014-12-05|The DefaultType directive has been removed        |
|57327|New|Nor|2014-12-08|mod_ssl seg fault on exit                         |
|57334|Ver|Maj|2014-12-09|Segmentation fault in SSL_renegotiate at ssl_lib.c|
|57337|New|Nor|2014-12-10|Content negotiation fails with conditional Redirec|
|57339|New|Enh|2014-12-10|ErrorLogFormat doesn't allow logging in Internet d|
|57360|New|Nor|2014-12-17|Fail gracefully on certificate/key mismatch       |
|57372|New|Nor|2014-12-19|httpd will lookup every home directory while start|
|57374|Ver|Nor|2014-12-19|Event MPM: Wrong KeepAliveTimeout when system cloc|
|57379|New|Nor|2014-12-20|[patch] Makefile.in  with mpm-shared, cgi and cgid|
|57383|New|Cri|2014-12-21|Error retrieving Report: An Existing connection wa|
|57386|New|Blk|2014-12-22|html5 lost some comments                          |
|57398|New|Maj|2014-12-26|AH01075: Error dispatching request to : (passing b|
|57399|New|Nor|2014-12-28|Many unnecessary CPU wakeups per second           |
|57406|New|Nor|2014-12-31|cgi-bin script is not executing                   |
|57412|New|Maj|2015-01-04|rewrite rules causes duplicate requests           |
|57416|New|Nor|2015-01-06|htcacheclean thinks the cache is smaller than it a|
|57424|Opn|Nor|2015-01-07|mod_rewrite not using ap_context_document_root    |
|57436|New|Enh|2015-01-12|Option to strip extra data after websocket request|
|57439|New|Enh|2015-01-13|Allow to change body timeout per location         |
|57448|New|Nor|2015-01-16|SSI <!--#set --> cannot capture backreferences fro|
|57453|New|Maj|2015-01-17|403 error when virtualhost configured with non-exi|
|57471|New|Nor|2015-01-20|Apache 2.4.10 Compilation fails when compiling aga|
|57477|New|Nor|2015-01-21|mod_auth_digest AH00052: child pid $pid exit signa|
|57483|New|Nor|2015-01-22|Omit "Keep-Alive" header on 1.1 connections       |
|57492|New|Nor|2015-01-24|incomplete chunked-transfered request body is not |
|57506|New|Nor|2015-01-27|<If> directive doesn't work within a <Location> se|
|57510|New|Enh|2015-01-28|Engine keyform support for private keys           |
|57511|New|Maj|2015-01-28|Opening plain TCP Socket on SSL port causes denial|
|57515|New|Nor|2015-01-30|Define/Undefine don't work reasonably outside of g|
|57519|New|Nor|2015-02-01|change SSLv2 to SSLv3 or remove SSLv2 support allt|
|57526|Opn|Maj|2015-02-03|Apache 2.2.29_openssl-1.0.1k_x86_64 Error creating|
|57529|Opn|Nor|2015-02-03|htcacheclean doesn't show the cached URL with '-a'|
|57585|New|Nor|2015-02-13|httpd fails to start if there is an IncludeOptiona|
|57590|New|Nor|2015-02-18|loading mod_proxy_http makes rewriteRule's [proxy]|
|57591|New|Nor|2015-02-18|DirectoryIndex directive cannot be overwritten    |
|57616|New|Maj|2015-02-23|AB - DNS roundrobin support                       |
|57624|New|Enh|2015-02-23|Provide support for http/2.0                      |
|57631|New|Nor|2015-02-24|Useless test in acinclude.m4                      |
|57632|New|Nor|2015-02-24|mod_systemd passes invalid default to APACHE_MODUL|
|57635|New|Nor|2015-02-25|meta-refresh is not rewritten by mod_proxy_html   |
|57636|New|Nor|2015-02-25|URLs without protocol are not rewriten by mod_prox|
|57641|New|Maj|2015-02-27|mod_substitute: Invalid merge order               |
|57646|New|Enh|2015-02-27|SSLEngine inside If directive                     |
|57660|New|Trv|2015-03-04|AB - free memory allocated by xmalloc and xcalloc |
|57680|New|Nor|2015-03-09|SSLSessionCacheTimeout has no effect              |
|57685|New|Nor|2015-03-10|Requests are denied while the mod_cgid daemon star|
|57691|New|Nor|2015-03-12|mod_proxy/proxy_util confuses UDS scheme with HTTP|
|57695|New|Nor|2015-03-12|[core:warn] [pid 1120] (101)Network is unreachable|
|57710|New|Nor|2015-03-15|Wildcard matching for logging headers             |
|57725|New|Enh|2015-03-18|ApacheBench: include http status code in gnuplot o|
|57742|New|Nor|2015-03-23|"reliable piped logging" doesn't work for ErrorLog|
|57745|New|Nor|2015-03-23|httpd exits 1 with no stderr when proxy_balancer_m|
|57746|New|Nor|2015-03-23|Apache hangs on startup using MPM event           |
|57751|Inf|Maj|2015-03-24|Problems with proxy reverse to websockets         |
|57756|New|Enh|2015-03-25|Config options for handling of pipelined request  |
|57757|New|Cri|2015-03-25|extern apr_xlate_t *ap_locale_to_ascii variable gi|
|57771|New|Nor|2015-03-27|cleanup_script uses incorrect connection ID       |
|57774|Inf|Nor|2015-03-28|httpd.conf <IfModule proxy_html_module> content er|
|57777|New|Nor|2015-03-30|Security concerns with documentation of AddHandler|
|57781|New|Nor|2015-03-31|disable reconnection after connection error       |
|57784|New|Enh|2015-03-31|[RFE] Multiple ErrorLog directives                |
|57785|Opn|Nor|2015-04-01|REDIRECT_URL is not suitable for use in server-gen|
|57795|Opn|Maj|2015-04-07|mod_proxy_wstunnel sometimes does not connect and |
|57800|New|Nor|2015-04-09|High CPU usage in ap_core_output_filter           |
|57807|New|Enh|2015-04-13|Build-configurable environment variable length    |
|57810|New|Nor|2015-04-13|Should apache ignore difference in trailing dot be|
|57813|New|Nor|2015-04-14|Rewrite 'pre-compressed content' recipe using 2.4 |
|57814|New|Nor|2015-04-14|Teach mod_deflate how to serve pre-comressed conte|
|57819|New|Nor|2015-04-15|Need a conventions document                       |
|57832|New|Enh|2015-04-19|Reduction of response splitting attacks consequenc|
|57853|Inf|Nor|2015-04-24|mod_proxy_http sends request with header 'Expect: |
|57876|New|Reg|2015-04-30|logresolve.exe on any Windows immediately crashes |
|57878|New|Nor|2015-04-30|Using UTF-8 for all languages, and avoiding html-e|
|57895|New|Min|2015-05-05|missing m4a mimeType in mime.types                |
|57911|New|Min|2015-05-09|Rewrite documentation unclear or wrong about what |
|57927|New|Maj|2015-05-13|Segmentation Fault at proxy_util.c:994            |
|57933|New|Min|2015-05-18|apr_port_t returns constant                       |
|57941|New|Nor|2015-05-21|config.status: line 331: syntax error near unexpec|
|57949|New|Enh|2015-05-25|new mod_ssl environment variable SSL_{CLIENT|SERVE|
|57950|New|Nor|2015-05-26|[patch] buildconf change hint in build to newer ap|
|57960|New|Nor|2015-05-27|PUT truncates response body; status_line appears t|
|57976|New|Cri|2015-05-30|Server threads stale when sending 500 status with |
|57978|New|Nor|2015-06-01|unix:/ works with any number of / slashes  except |
|57979|New|Nor|2015-06-01|can not turn change log level for mod_filter      |
|57996|New|Nor|2015-06-03|Symlinks erroneously not followed when target inod|
|57997|New|Nor|2015-06-03|Threads started during child_init don't block sign|
|57999|New|Nor|2015-06-04|ap_getparents() may remove start slash of uri     |
|58001|New|Enh|2015-06-04|Implement Forwarded header (RFC 7239) to mod_proxy|
|58007|New|Nor|2015-06-06|400 Bad Request with fully qualified domain name o|
|58025|New|Enh|2015-06-11|mod_authz_dbd : new dbd-query and AuthzDBDQuery op|
|58026|New|Nor|2015-06-11|return 421 status code when SNI and Host: header d|
|58044|New|Cri|2015-06-16|Error sintax 'lua_dump'                           |
|58050|New|Nor|2015-06-17|ErrorDocument does not always work                |
|58073|New|Nor|2015-06-24|Extremely long time for graceful restart          |
|58089|New|Nor|2015-07-01|mod_authz_host uses proxy IP even when mod_remotei|
|58097|New|Enh|2015-07-03|[feat] Preserve original connecting IP            |
|58101|New|Nor|2015-07-05|DeflateCompressionLevel inside vhost resets logfor|
|58107|New|Blk|2015-07-06|Httpd crashes on startup every time, dump file att|
|58109|New|Nor|2015-07-06|Apache on windows cannot handle the hash symbol (#|
|58118|Inf|Min|2015-07-09|mod_proxy_fcgi logs 503 when user aborts connectio|
|58120|New|Nor|2015-07-10|ProxyPassInherit does not work as expect          |
|58121|New|Nor|2015-07-10|ProxyHTMLMeta seems to ignore all <meta http-equiv|
|58129|New|Nor|2015-07-12|man pages are not generated correctly             |
|58132|New|Nor|2015-07-12|non-standard, non-traditional man page layout make|
|58135|New|Nor|2015-07-14|mod_cache sends client "if-Modified-Since" to back|
|58141|New|Nor|2015-07-15|Apache Service doesn't start when rotatlogs.exe pa|
|58142|New|Nor|2015-07-15|authz_core ignores loglevel                       |
|58158|New|Nor|2015-07-21|Not honoring HTTP spec with regard to Accept-Encod|
|58168|New|Enh|2015-07-21|Would like full request evaluation support in Rewr|
|58171|New|Nor|2015-07-22|ap_session_save saves the wrong session after a de|
|58177|New|Enh|2015-07-24|Mod Proxy forward trailers in http chunked request|
|58180|New|Enh|2015-07-24|ErrorDocument original URL in subsequent <Location|
|58181|New|Enh|2015-07-25|mod_expire should allow "minus" keyword same like |
|58188|New|Nor|2015-07-28|http2 mod_lua: support build with lua 5.2+        |
|58197|New|Nor|2015-07-31|apr-util-1.5.4 build against openldap - "could not|
|58225|New|Reg|2015-08-08|intermitant segfault 11 in session_identity_encode|
|58226|New|Nor|2015-08-08|XSS in Error Page                                 |
|58231|New|Nor|2015-08-11|RewriteCond can add "Host" to the Vary-Header     |
|58235|New|Enh|2015-08-12|Ability to allow from domain but with using forwar|
|58243|New|Nor|2015-08-14|rotatelogs goes infinite at startup               |
|58248|New|Nor|2015-08-17|Error 404 in use some characters of utf8 in url   |
|58257|New|Nor|2015-08-18|require ldap-group does not work if account-fullna|
|58278|Inf|Blk|2015-08-24|apache - mod_security Issue : apache no releasing |
|58280|New|Nor|2015-08-24|Backend connection not closed until timeout if cli|
|58288|New|Blk|2015-08-27|Semaphore amount increase until crash when enablin|
|58292|New|Nor|2015-08-27|FallbackResource breaks chunked encoding sometimes|
|58304|New|Nor|2015-08-30|Unexpected Warnings from Macro Use in 2.4         |
|58305|New|Nor|2015-08-30|mod_cgi documentation not clear about what is pass|
|58306|New|Nor|2015-08-30|documentation needs to make it clear which directi|
|58307|New|Nor|2015-08-31|Segmentation fault in child in "read(__nbytes, __b|
|58317|New|Min|2015-09-02|Error message AH01630 is missing file name on deny|
|58334|New|Min|2015-09-06|WebDAV HTTP access does not include meta tag for c|
|58335|New|Nor|2015-09-07|mod_authnz_ldap mismatch                          |
|58343|New|Nor|2015-09-08|The pdf files come up as a blank page.            |
|58354|New|Maj|2015-09-10|(20014)Internal error (specific information not av|
|58356|New|Blk|2015-09-10|Session jumping due to incorrect route            |
|58364|New|Reg|2015-09-11|Apache Server is restarted time to time (Release 2|
|58417|New|Min|2015-09-16|ApacheBench (ab) won't display Server Software of |
|58419|New|Nor|2015-09-16|ApacheBench (ab) doesn't work with keep-alives aga|
|58423|New|Reg|2015-09-17|Apache >= 2.4.8 PCRE_DUPNAMES causes build failure|
|58467|New|Maj|2015-09-29|Environment Variables in ProxyHTMLURLMap produces |
|58475|New|Nor|2015-10-03|Support append/merge with semicolon-separated head|
|58488|New|Nor|2015-10-08|Stoped PHP-FPM pool in multi-pool system with comu|
|58491|New|Maj|2015-10-09|Core dumps appear when the load increases         |
|58492|Inf|Nor|2015-10-09|I think LDAPConnectionPoolTTL is not being honored|
|58498|New|Nor|2015-10-16|Apache 2.4.17: Regression with mod_autoindex (in c|
|58500|New|Nor|2015-10-16|dav_fs not enabled by default                     |
|58503|New|Cri|2015-10-16|segfault in apr_brigade_cleanup() under high load |
|58509|New|Trv|2015-10-20|2.4.17-dev introduces second core.c handler at sta|
|58513|New|Maj|2015-10-21|httpd code documentation is missing               |
|58524|New|Nor|2015-10-23|mod_http2 segfaults when under heavy load         |
|58528|New|Nor|2015-10-23|AllowOverrideList None gets misparsed and .htacces|
|58529|New|Maj|2015-10-23|Segmentation fault after modifying a proxy Balance|
|58550|New|Enh|2015-10-26|During load, Apache 2.2.x with prefork MPM didn|
|58574|New|Nor|2015-11-02|Apache error AH01630 (client denied) but working  |
|58593|New|Nor|2015-11-06|mod_proxy wrong decision between http and ws      |
|58598|New|Enh|2015-11-08|Internal Server Error (500) when requesting non-ex|
|58602|New|Nor|2015-11-11|Priority issue on DirectoryMatch directive        |
|58604|New|Reg|2015-11-12|Plaintext auth broken in any Explicit FTP/AUTH TLS|
|58612|New|Min|2015-11-16|mod_webdav when write_stream failed should break a|
|58669|New|Nor|2015-11-30|Order of DBDInitSQL and DBDPrepareSQL             |
|58688|New|Nor|2015-12-03|Missing mod_ssl connection-level upgrade headers f|
|58700|New|Nor|2015-12-07|Apache logs not working with mod_remoteip and X-fo|
|58720|New|Enh|2015-12-11|querying server status stalls when scoreboard is f|
|58727|New|Min|2015-12-13|Directories with a ProxyPass directive are not dis|
|58732|New|Nor|2015-12-14|Error Log isn't writing When Apache Shutdown with |
|58737|New|Blk|2015-12-15|Compilation failure of httpd-2.4.18 on SLES 11 SP3|
|58739|New|Cri|2015-12-15|Undocumented behavior of REDIRECT_URL and REDIRECT|
|58744|New|Nor|2015-12-17|pthread mutex warning is outdated                 |
+-----+---+---+----------+--------------------------------------------------+
| Total 1562 bugs                                                           |
+---------------------------------------------------------------------------+

From dev-return-85092-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Sun Dec 20 08:45:43 2015
Return-Path: <dev-return-85092-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 842FF187CE
	for <apmail-httpd-dev-archive@www.apache.org>; Sun, 20 Dec 2015 08:45:43 +0000 (UTC)
Received: (qmail 42946 invoked by uid 500); 20 Dec 2015 08:45:37 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 42879 invoked by uid 500); 20 Dec 2015 08:45:37 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 42870 invoked by uid 99); 20 Dec 2015 08:45:37 -0000
Received: from Unknown (HELO spamd1-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 20 Dec 2015 08:45:37 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd1-us-west.apache.org (ASF Mail Server at spamd1-us-west.apache.org) with ESMTP id 6C82AC9584
	for <dev@httpd.apache.org>; Sun, 20 Dec 2015 08:45:37 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd1-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 1
X-Spam-Level: *
X-Spam-Status: No, score=1 tagged_above=-999 required=6.31
	tests=[KAM_LAZY_DOMAIN_SECURITY=1] autolearn=disabled
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd1-us-west.apache.org [10.40.0.7]) (amavisd-new, port 10024)
	with ESMTP id gmqUVrXgr0uA for <dev@httpd.apache.org>;
	Sun, 20 Dec 2015 08:45:36 +0000 (UTC)
Received: from boipeva.ensmp.fr (boipeva.ensmp.fr [194.214.158.136])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTP id 631CF42A72
	for <dev@httpd.apache.org>; Sun, 20 Dec 2015 08:45:36 +0000 (UTC)
Received: from cri.ensmp.fr (AGrenoble-653-1-20-119.w90-52.abo.wanadoo.fr [90.52.202.119])
	(authenticated bits=0)
	by boipeva.ensmp.fr (8.15.2/8.15.1/JMMC-22/Oct/2013) with ESMTPSA id tBK8jSsi024280
	(version=TLSv1 cipher=ECDHE-RSA-AES256-SHA bits=256 verify=NO)
	for <dev@httpd.apache.org>; Sun, 20 Dec 2015 09:45:29 +0100
Date: Sun, 20 Dec 2015 09:44:55 +0100 (CET)
From: Fabien <fabien@apache.org>
X-X-Sender: fabien@sto
To: APACHE development mailing list <dev@httpd.apache.org>
Subject: access control for dynamic hosts
Message-ID: <alpine.DEB.2.10.1512200931040.29581@sto>
User-Agent: Alpine 2.10 (DEB 1266 2009-07-14)
MIME-Version: 1.0
Content-Type: TEXT/PLAIN; format=flowed; charset=US-ASCII
X-Miltered: at boipeva.ensmp.fr with ID 56766AA8.000 by Joe's j-chkmail (http : // j-chkmail dot ensmp dot fr)!
X-j-chkmail-Auth: USER-ID fabien.coelho
X-j-chkmail-Enveloppe: 56766AA8.000 from AGrenoble-653-1-20-119.w90-52.abo.wanadoo.fr/AGrenoble-653-1-20-119.w90-52.abo.wanadoo.fr/90.52.202.119/cri.ensmp.fr/<fabien@apache.org>


Hello folks,

I have a simple access control use case for which I have not found a 
clean solution.

I want to control access to a service based on the name of the client, 
however the client is a dynamic host, which implies that:

  (1) I do not have any control about the reverse DNS
      => this rules out "Require host"

  (2) the IP may change arbitrarily
      => this rules out "Require ip"

By browsing around it seems that I'm not alone having this issue, and I 
have not found any solution for that with apache configuration, nor a 
matching module in "modules.apache.org" listing.

The current workaround is to update the IP manually when it fails. 
Although I could automate (say query the ip periodically and update & 
reload the conf if there is a change), ISTM that it really belongs to 
apache configuration.

I would like something like "Require XXX foo.dynamic-dns.somewhere" (where 
XXX could be "name", "hostname", "dynamic", ...) which would query the NS 
when the HTTP request is received and check that the corresponding ip is 
the client IP.

I'm planing to develop a small module for that, and as it is somehow quite 
a basic service it could be a candidate for being added to 
"modules/aaa/mod_authz_host.c".

Another approach could be to extend apache expressions with a function
to query the DNS, but that seems a little overkill.

Any thoughts?

-- 
Fabien.

From dev-return-85093-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Mon Dec 21 12:22:40 2015
Return-Path: <dev-return-85093-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 9DDA8109F9
	for <apmail-httpd-dev-archive@www.apache.org>; Mon, 21 Dec 2015 12:22:40 +0000 (UTC)
Received: (qmail 12999 invoked by uid 500); 21 Dec 2015 12:22:39 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 12903 invoked by uid 500); 21 Dec 2015 12:22:39 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 12894 invoked by uid 99); 21 Dec 2015 12:22:39 -0000
Received: from Unknown (HELO spamd2-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 21 Dec 2015 12:22:39 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd2-us-west.apache.org (ASF Mail Server at spamd2-us-west.apache.org) with ESMTP id 596FC1A0119
	for <dev@httpd.apache.org>; Mon, 21 Dec 2015 12:22:39 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd2-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 1
X-Spam-Level: *
X-Spam-Status: No, score=1 tagged_above=-999 required=6.31
	tests=[KAM_LAZY_DOMAIN_SECURITY=1] autolearn=disabled
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd2-us-west.apache.org [10.40.0.9]) (amavisd-new, port 10024)
	with ESMTP id GpwgHJVR7ZNb for <dev@httpd.apache.org>;
	Mon, 21 Dec 2015 12:22:38 +0000 (UTC)
Received: from jiboia.ensmp.fr (jiboia.ensmp.fr [194.214.158.137])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTP id A11E942ADC
	for <dev@httpd.apache.org>; Mon, 21 Dec 2015 12:22:37 +0000 (UTC)
Received: from cri.ensmp.fr (AGrenoble-653-1-20-119.w90-52.abo.wanadoo.fr [90.52.202.119])
	(authenticated bits=0)
	by jiboia.ensmp.fr (8.15.2/8.15.1/JMMC-22/Oct/2013) with ESMTPSA id tBLCMUVo013620
	(version=TLSv1 cipher=ECDHE-RSA-AES256-SHA bits=256 verify=NO)
	for <dev@httpd.apache.org>; Mon, 21 Dec 2015 13:22:31 +0100
Date: Mon, 21 Dec 2015 13:21:55 +0100 (CET)
From: Fabien <fabien@apache.org>
X-X-Sender: fabien@sto
To: APACHE development mailing list <dev@httpd.apache.org>
Subject: Re: access control for dynamic hosts
In-Reply-To: <alpine.DEB.2.10.1512200931040.29581@sto>
Message-ID: <alpine.DEB.2.10.1512211310330.8529@sto>
References: <alpine.DEB.2.10.1512200931040.29581@sto>
User-Agent: Alpine 2.10 (DEB 1266 2009-07-14)
MIME-Version: 1.0
Content-Type: MULTIPART/MIXED; BOUNDARY="8323329-85221493-1450700517=:8529"
X-Miltered: at jiboia.ensmp.fr with ID 5677EF06.000 by Joe's j-chkmail (http : // j-chkmail dot ensmp dot fr)!
X-j-chkmail-Auth: USER-ID fabien.coelho
X-j-chkmail-Enveloppe: 5677EF06.000 from AGrenoble-653-1-20-119.w90-52.abo.wanadoo.fr/AGrenoble-653-1-20-119.w90-52.abo.wanadoo.fr/90.52.202.119/cri.ensmp.fr/<fabien@apache.org>

  This message is in MIME format.  The first part should be readable text,
  while the remaining parts are likely unreadable without MIME-aware tools.

--8323329-85221493-1450700517=:8529
Content-Type: TEXT/PLAIN; charset=US-ASCII; format=flowed


Hello folks,

> I would like something like "Require XXX foo.dynamic-dns.somewhere" 
> (where XXX could be "name", "hostname", "dynamic", ...) which would 
> query the NS when the HTTP request is received and check that the 
> corresponding ip is the client IP.
>
> I'm planing to develop a small module for that, and as it is somehow 
> quite a basic service it could be a candidate for being added to 
> "modules/aaa/mod_authz_host.c".

Attached is a working version with the syntax "Requite name 
foo.somewhere".

Note sure whether "name" is the best... name for the authorization 
provider, though.

I could append this to mod_authz_host.c & update the documentation if I'm 
given a go.

-- 
Fabien
--8323329-85221493-1450700517=:8529
Content-Type: TEXT/x-csrc; name=mod_authz_name.c
Content-Transfer-Encoding: BASE64
Content-ID: <alpine.DEB.2.10.1512211321550.8529@sto>
Content-Description: 
Content-Disposition: attachment; filename=mod_authz_name.c

LyogTGljZW5zZWQgdG8gdGhlIEFwYWNoZSBTb2Z0d2FyZSBGb3VuZGF0aW9u
IChBU0YpIHVuZGVyIG9uZSBvciBtb3JlDQogKiBjb250cmlidXRvciBsaWNl
bnNlIGFncmVlbWVudHMuICBTZWUgdGhlIE5PVElDRSBmaWxlIGRpc3RyaWJ1
dGVkIHdpdGgNCiAqIHRoaXMgd29yayBmb3IgYWRkaXRpb25hbCBpbmZvcm1h
dGlvbiByZWdhcmRpbmcgY29weXJpZ2h0IG93bmVyc2hpcC4NCiAqIFRoZSBB
U0YgbGljZW5zZXMgdGhpcyBmaWxlIHRvIFlvdSB1bmRlciB0aGUgQXBhY2hl
IExpY2Vuc2UsIFZlcnNpb24gMi4wDQogKiAodGhlICJMaWNlbnNlIik7IHlv
dSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ug
d2l0aA0KICogdGhlIExpY2Vuc2UuICBZb3UgbWF5IG9idGFpbiBhIGNvcHkg
b2YgdGhlIExpY2Vuc2UgYXQNCiAqDQogKiAgICAgaHR0cDovL3d3dy5hcGFj
aGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wDQogKg0KICogVW5sZXNzIHJl
cXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0
aW5nLCBzb2Z0d2FyZQ0KICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vu
c2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBCQVNJUywNCiAqIFdJ
VEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBl
aXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLg0KICogU2VlIHRoZSBMaWNlbnNl
IGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Np
b25zIGFuZA0KICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuDQog
Ki8NCg0KLyoNCiAqIFNlY3VyaXR5IG9wdGlvbnMgZXRjLg0KICoNCiAqIE1v
ZHVsZSBkZXJpdmVkIGZyb20gY29kZSBvcmlnaW5hbGx5IHdyaXR0ZW4gYnkg
Um9iIE1jQ29vbA0KICoNCiAqLw0KDQojaW5jbHVkZSAiYXByX3N0cmluZ3Mu
aCINCiNpbmNsdWRlICJhcHJfbmV0d29ya19pby5oIg0KI2luY2x1ZGUgImFw
cl9tZDUuaCINCiNpbmNsdWRlICJhcHJfaGFzaC5oIg0KDQojZGVmaW5lIEFQ
Ul9XQU5UX1NUUkZVTkMNCiNkZWZpbmUgQVBSX1dBTlRfQllURUZVTkMNCiNp
bmNsdWRlICJhcHJfd2FudC5oIg0KDQojaW5jbHVkZSAiYXBfY29uZmlnLmgi
DQojaW5jbHVkZSAiYXBfcHJvdmlkZXIuaCINCiNpbmNsdWRlICJodHRwZC5o
Ig0KI2luY2x1ZGUgImh0dHBfY29yZS5oIg0KI2luY2x1ZGUgImh0dHBfY29u
ZmlnLmgiDQojaW5jbHVkZSAiaHR0cF9sb2cuaCINCiNpbmNsdWRlICJodHRw
X3Byb3RvY29sLmgiDQojaW5jbHVkZSAiaHR0cF9yZXF1ZXN0LmgiDQoNCiNp
bmNsdWRlICJtb2RfYXV0aC5oIg0KDQojaWYgQVBSX0hBVkVfTkVUSU5FVF9J
Tl9IDQojaW5jbHVkZSA8bmV0aW5ldC9pbi5oPg0KI2VuZGlmDQoNCnN0YXRp
YyBhdXRoel9zdGF0dXMgbmFtZV9jaGVja19hdXRob3JpemF0aW9uKHJlcXVl
c3RfcmVjICpyLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgY29uc3QgY2hhciAqcmVxdWlyZV9saW5lLA0KICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qg
dm9pZCAqcGFyc2VkX3JlcXVpcmVfbGluZSkNCnsNCiAgICBjb25zdCBjaGFy
ICplcnIgPSBOVUxMOw0KICAgIGNvbnN0IGFwX2V4cHJfaW5mb190ICpleHBy
ID0gcGFyc2VkX3JlcXVpcmVfbGluZTsNCiAgICBjb25zdCBjaGFyICpyZXF1
aXJlLCAqdDsNCiAgICBjaGFyICp3Ow0KDQogICAgLyogdGhlIHJlcXVpcmUg
bGluZSBpcyBhbiBleHByZXNzaW9uLCB3aGljaCBpcyBldmFsdWF0ZWQgbm93
LiAqLw0KICAgIHJlcXVpcmUgPSBhcF9leHByX3N0cl9leGVjKHIsIGV4cHIs
ICZlcnIpOw0KICAgIGlmIChlcnIpIHsNCiAgICAgIGFwX2xvZ19yZXJyb3Io
QVBMT0dfTUFSSywgQVBMT0dfRVJSLCAwLCByLCAvLyBBUExPR05PKEZJWE1F
KQ0KICAgICAgICAgICAgICAgICAgICAibmFtZV9jaGVja19hdXRob3JpemF0
aW9uOiAiDQogICAgICAgICAgICAgICAgICAgICJDYW4ndCBldmFsdWF0ZSBy
ZXF1aXJlIGV4cHJlc3Npb246ICVzIiwgZXJyKTsNCiAgICAgIHJldHVybiBB
VVRIWl9ERU5JRUQ7DQogICAgfQ0KDQogICAgLyogdG9rZW5pemUgZXhwZWN0
ZWQgbGlzdCBvZiBuYW1lcyAqLw0KICAgIHQgPSByZXF1aXJlOw0KICAgIHdo
aWxlICgodyA9IGFwX2dldHdvcmRfY29uZihyLT5wb29sLCAmdCkpICYmIHdb
MF0pIHsNCg0KICAgICAgICBhcHJfc29ja2FkZHJfdCAqc2E7DQogICAgICAg
IGFwcl9zdGF0dXNfdCBydjsNCiAgICAgICAgY2hhciAqaGFzaF9wdHI7DQoN
CiAgICAgICAgLyogc3RvcCBvbiBhcGFjaGUgY29uZmlndXJhdGlvbiBmaWxl
IGNvbW1lbnRzICovDQogICAgICAgIGlmICgoaGFzaF9wdHIgPSBhcF9zdHJj
aHIodywgJyMnKSkpIHsNCiAgICAgICAgICAgIGlmIChoYXNoX3B0ciA9PSB3
KSB7DQogICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICB9DQog
ICAgICAgICAgICAqaGFzaF9wdHIgPSAnXDAnOw0KICAgICAgICB9DQoNCiAg
ICAgICAgLyogZG9lcyB0aGUgY2xpZW50IGlwIG1hdGNoIG9uZSBvZiB0aGUg
bmFtZT8gKi8NCiAgICAgICAgcnYgPSBhcHJfc29ja2FkZHJfaW5mb19nZXQo
JnNhLCB3LCBBUFJfVU5TUEVDLCAwLCAwLCByLT5wb29sKTsNCiAgICAgICAg
aWYgKHJ2ID09IEFQUl9TVUNDRVNTKSB7DQoNCiAgICAgICAgICAgIHdoaWxl
IChzYSkgew0KICAgICAgICAgICAgICAgIGludCBtYXRjaCA9IGFwcl9zb2Nr
YWRkcl9lcXVhbChzYSwgci0+dXNlcmFnZW50X2FkZHIpOw0KDQogICAgICAg
ICAgICAgICAgYXBfbG9nX3JlcnJvcihBUExPR19NQVJLLCBBUExPR19ERUJV
RywgMCwgciwgLy8gQVBMT0dOTyhGSVhNRSkNCiAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICJuYW1lX2NoZWNrX2F1dGhvcml6YXRpb246ICVzIGZv
ciAlczogJXMiLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdywg
ci0+dXNlcmFnZW50X2lwLCBtYXRjaD8gInllcyI6ICJubyIpOw0KICAgICAg
ICAgICAgICAgIGlmIChtYXRjaCkgew0KICAgICAgICAgICAgICAgICAgICBy
ZXR1cm4gQVVUSFpfR1JBTlRFRDsNCiAgICAgICAgICAgICAgICB9DQoNCiAg
ICAgICAgICAgICAgICBzYSA9IHNhLT5uZXh0Ow0KICAgICAgICAgICAgfQ0K
ICAgICAgICB9DQogICAgICAgIGVsc2Ugew0KICAgICAgICAgICAgYXBfbG9n
X3JlcnJvcihBUExPR19NQVJLLCBBUExPR19XQVJOSU5HLCAwLCByLCAvLyBB
UExPR05PKEZJWE1FKQ0KICAgICAgICAgICAgICAgICJuYW1lX2NoZWNrX2F1
dGhvcml6YXRpb246IG5vIHNvY2thZGRyIGluZm8gZm9yIFwiJXNcIiIsIHcp
Ow0KICAgICAgICB9DQoNCiAgICAgICAgLyogc3RvcCBwcm9jZXNzaW5nLCB3
ZSBhcmUgaW4gYSBjb21tZW50ICovDQogICAgICAgIGlmIChoYXNoX3B0cikg
ew0KICAgICAgICAgICAgYnJlYWs7DQogICAgICAgIH0NCiAgICB9DQoNCiAg
ICByZXR1cm4gQVVUSFpfREVOSUVEOw0KfQ0KDQovKiBjb3B5IG9mIGhvc3Rf
cGFyc2VfY29uZmlnICovDQpzdGF0aWMgY29uc3QgY2hhciAqbmFtZV9wYXJz
ZV9jb25maWcoY21kX3Bhcm1zICpjbWQsIGNvbnN0IGNoYXIgKnJlcXVpcmVf
bGluZSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBj
b25zdCB2b2lkICoqcGFyc2VkX3JlcXVpcmVfbGluZSkNCnsNCiAgICBjb25z
dCBjaGFyICpleHByX2VyciA9IE5VTEw7DQogICAgYXBfZXhwcl9pbmZvX3Qg
KmV4cHI7DQoNCiAgICBleHByID0gYXBfZXhwcl9wYXJzZV9jbWQoY21kLCBy
ZXF1aXJlX2xpbmUsIEFQX0VYUFJfRkxBR19TVFJJTkdfUkVTVUxULA0KICAg
ICAgICAgICAgJmV4cHJfZXJyLCBOVUxMKTsNCg0KICAgIGlmIChleHByX2Vy
cikNCiAgICAgICAgcmV0dXJuIGFwcl9wc3RyY2F0KGNtZC0+dGVtcF9wb29s
LA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIkNhbm5vdCBwYXJzZSBl
eHByZXNzaW9uIGluIHJlcXVpcmUgbGluZTogIiwNCiAgICAgICAgICAgICAg
ICAgICAgICAgICAgIGV4cHJfZXJyLCBOVUxMKTsNCg0KICAgICpwYXJzZWRf
cmVxdWlyZV9saW5lID0gZXhwcjsNCg0KICAgIHJldHVybiBOVUxMOw0KfQ0K
DQpzdGF0aWMgY29uc3QgYXV0aHpfcHJvdmlkZXIgYXV0aHpfbmFtZV9wcm92
aWRlciA9DQp7DQogICAgJm5hbWVfY2hlY2tfYXV0aG9yaXphdGlvbiwNCiAg
ICAmbmFtZV9wYXJzZV9jb25maWcsDQp9Ow0KDQpzdGF0aWMgdm9pZCByZWdp
c3Rlcl9ob29rcyhhcHJfcG9vbF90ICpwKQ0Kew0KICAgIGFwX3JlZ2lzdGVy
X2F1dGhfcHJvdmlkZXIocCwgQVVUSFpfUFJPVklERVJfR1JPVVAsICJuYW1l
IiwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEFVVEhaX1BST1ZJ
REVSX1ZFUlNJT04sDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAm
YXV0aHpfbmFtZV9wcm92aWRlciwNCiAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIEFQX0FVVEhfSU5URVJOQUxfUEVSX0NPTkYpOw0KfQ0KDQpBUF9E
RUNMQVJFX01PRFVMRShhdXRoel9uYW1lKSA9DQp7DQogICAgU1RBTkRBUkQy
MF9NT0RVTEVfU1RVRkYsDQogICAgTlVMTCwgICAgICAgICAgICAgICAgICAg
ICAgICAgICAvKiBkaXIgY29uZmlnIGNyZWF0ZXIgKi8NCiAgICBOVUxMLCAg
ICAgICAgICAgICAgICAgICAgICAgICAgIC8qIGRpciBtZXJnZXIgLS0tIGRl
ZmF1bHQgaXMgdG8gb3ZlcnJpZGUgKi8NCiAgICBOVUxMLCAgICAgICAgICAg
ICAgICAgICAgICAgICAgIC8qIHNlcnZlciBjb25maWcgKi8NCiAgICBOVUxM
LCAgICAgICAgICAgICAgICAgICAgICAgICAgIC8qIG1lcmdlIHNlcnZlciBj
b25maWcgKi8NCiAgICBOVUxMLA0KICAgIHJlZ2lzdGVyX2hvb2tzICAgICAg
ICAgICAgICAgICAgLyogcmVnaXN0ZXIgaG9va3MgKi8NCn07DQo=

--8323329-85221493-1450700517=:8529--

From dev-return-85094-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Mon Dec 21 13:09:49 2015
Return-Path: <dev-return-85094-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 2050F10D7C
	for <apmail-httpd-dev-archive@www.apache.org>; Mon, 21 Dec 2015 13:09:49 +0000 (UTC)
Received: (qmail 10222 invoked by uid 500); 21 Dec 2015 13:09:48 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 10152 invoked by uid 500); 21 Dec 2015 13:09:48 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 10142 invoked by uid 99); 21 Dec 2015 13:09:48 -0000
Received: from Unknown (HELO spamd4-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 21 Dec 2015 13:09:48 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd4-us-west.apache.org (ASF Mail Server at spamd4-us-west.apache.org) with ESMTP id 36739C0B54
	for <dev@httpd.apache.org>; Mon, 21 Dec 2015 13:09:48 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd4-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 0.196
X-Spam-Level:
X-Spam-Status: No, score=0.196 tagged_above=-999 required=6.31
	tests=[KAM_INFOUSMEBIZ=0.75, RP_MATCHES_RCVD=-0.554, SPF_PASS=-0.001,
	UNPARSEABLE_RELAY=0.001] autolearn=disabled
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd4-us-west.apache.org [10.40.0.11]) (amavisd-new, port 10024)
	with ESMTP id fMuYhhEuOovT for <dev@httpd.apache.org>;
	Mon, 21 Dec 2015 13:09:47 +0000 (UTC)
Received: from mx.lenk.info (mail.lenk.info [188.40.85.232])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id E9A9C439F5
	for <dev@httpd.apache.org>; Mon, 21 Dec 2015 13:09:46 +0000 (UTC)
Received: from [192.168.77.232] (port=57612 helo=mailstore.lenk.local)
	by mx.lenk.info with esmtp (Exim 4.82_1-5b7a7c0-XX)
	(envelope-from <micha@lenk.info>)
	id 1aB0DX-0004HJ-0b
	for dev@httpd.apache.org; Mon, 21 Dec 2015 14:09:35 +0100
Received: from webmail.lenk.info (localhost [IPv6:::1])
	by mailstore.lenk.local (Postfix) with ESMTP id 4C0701A0E6
	for <dev@httpd.apache.org>; Mon, 21 Dec 2015 14:09:34 +0100 (CET)
Received: from fpLgtKcwcp97vkvWJEb4M1luTyVvz8lug/6GLOQiog8WSUzUJV9+uA==
 (aDWxsl7AK2L2piNdEu0KUHUght/NozjX)
 by mail.lenk.info
 with HTTP (HTTP/1.1 POST); Mon, 21 Dec 2015 14:09:34 +0100
MIME-Version: 1.0
Content-Type: text/plain; charset=US-ASCII;
 format=flowed
Content-Transfer-Encoding: 7bit
Date: Mon, 21 Dec 2015 14:09:34 +0100
From: Micha Lenk <micha@lenk.info>
To: dev@httpd.apache.org
Subject: Re: Segfault on graceful reload with OCSP stapling
 =?UTF-8?Q?enabled=3F?=
In-Reply-To: <46101845eb5031d002e86140f2980c7e@mail.lenk.info>
References: <46101845eb5031d002e86140f2980c7e@mail.lenk.info>
Message-ID: <bcda54332d8ef5789adb7e8399c54299@mail.lenk.info>
X-Sender: micha@lenk.info
User-Agent: Roundcube Webmail/1.0.5

Hi all,

Am 18.12.2015 12:35, schrieb Micha Lenk:
> I am currently observing a httpd segfault that is triggered on my
> system by every second graceful reload (i.e. SIGUSR1).
> 
> Unfotunately I won't be able to trace this down before Monday, so this
> is merely a heads-up for those interested.
> Is anybody able to reproduce this behavior?

Just for the records, the segfault seems to be caused by a bad patch.
So sorry for the noise...

Best regards,
Micha

From dev-return-85095-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Mon Dec 21 13:17:44 2015
Return-Path: <dev-return-85095-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 7390D10DC4
	for <apmail-httpd-dev-archive@www.apache.org>; Mon, 21 Dec 2015 13:17:44 +0000 (UTC)
Received: (qmail 38481 invoked by uid 500); 21 Dec 2015 13:17:38 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 38400 invoked by uid 500); 21 Dec 2015 13:17:38 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 38388 invoked by uid 99); 21 Dec 2015 13:17:38 -0000
Received: from Unknown (HELO spamd3-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 21 Dec 2015 13:17:38 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd3-us-west.apache.org (ASF Mail Server at spamd3-us-west.apache.org) with ESMTP id 55D64180441
	for <dev@httpd.apache.org>; Mon, 21 Dec 2015 13:17:38 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd3-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 2.9
X-Spam-Level: **
X-Spam-Status: No, score=2.9 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	HTML_MESSAGE=3, SPF_PASS=-0.001, URIBL_BLOCKED=0.001]
	autolearn=disabled
Authentication-Results: spamd3-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd3-us-west.apache.org [10.40.0.10]) (amavisd-new, port 10024)
	with ESMTP id RPV7l9HqDZni for <dev@httpd.apache.org>;
	Mon, 21 Dec 2015 13:17:29 +0000 (UTC)
Received: from mail-io0-f173.google.com (mail-io0-f173.google.com [209.85.223.173])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id 9D97442ADC
	for <dev@httpd.apache.org>; Mon, 21 Dec 2015 13:17:29 +0000 (UTC)
Received: by mail-io0-f173.google.com with SMTP id e126so153819661ioa.1
        for <dev@httpd.apache.org>; Mon, 21 Dec 2015 05:17:29 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        bh=MyDTd4718LkQTXhC0oL2nMR9KXpXG1OugQa/HjF9CYM=;
        b=RM75tyrUo6F0bC9bd+f/8pBl1D1IfA2seAmzmCxDLdHlzHJInbpiswlxOATrK99ECz
         arEaKdw91ISgTlVxZj8qiPy2tnNy9NM9NlijmpTt60E7RJtNJmlkOO4DWvabBBzk0Cmz
         SgzzxCNJ+QgtB24IuofnAZ/+OKC5DjQ4V4e54/09IqQZw+WAj+0cqE+sBrJXESrtNCh8
         ELtued77WraelPsUkWPwAiPj6dNBSt8sK+0B9badasPAER9Ueo7xTy4+CMEdeY1mlREI
         AtwRhB4RxQr/uIXuv0tTPzJlL8msPrdLni3R+pxf0fiPut6in+BySFnnlTcFVCiBN4Xb
         B7bQ==
MIME-Version: 1.0
X-Received: by 10.107.14.137 with SMTP id 131mr17951826ioo.69.1450703849161;
 Mon, 21 Dec 2015 05:17:29 -0800 (PST)
Received: by 10.36.1.83 with HTTP; Mon, 21 Dec 2015 05:17:29 -0800 (PST)
In-Reply-To: <bcda54332d8ef5789adb7e8399c54299@mail.lenk.info>
References: <46101845eb5031d002e86140f2980c7e@mail.lenk.info>
	<bcda54332d8ef5789adb7e8399c54299@mail.lenk.info>
Date: Mon, 21 Dec 2015 08:17:29 -0500
Message-ID: <CAKUrXK6buNGyOCJwRLi4PqTizi90L-aHv8QiD4bTCwa5y0o+aw@mail.gmail.com>
Subject: Re: Segfault on graceful reload with OCSP stapling enabled?
From: Jeff Trawick <trawick@gmail.com>
To: Apache HTTP Server Development List <dev@httpd.apache.org>
Content-Type: multipart/alternative; boundary=001a113fdfd29a87780527684f8c

--001a113fdfd29a87780527684f8c
Content-Type: text/plain; charset=UTF-8

On Mon, Dec 21, 2015 at 8:09 AM, Micha Lenk <micha@lenk.info> wrote:

> Hi all,
>
> Am 18.12.2015 12:35, schrieb Micha Lenk:
>
>> I am currently observing a httpd segfault that is triggered on my
>> system by every second graceful reload (i.e. SIGUSR1).
>>
>> Unfotunately I won't be able to trace this down before Monday, so this
>> is merely a heads-up for those interested.
>> Is anybody able to reproduce this behavior?
>>
>
> Just for the records, the segfault seems to be caused by a bad patch.
> So sorry for the noise...
>

Thanks for reporting back/glad it is resolved!


>
> Best regards,
> Micha
>



-- 
Born in Roswell... married an alien...
http://emptyhammock.com/

--001a113fdfd29a87780527684f8c
Content-Type: text/html; charset=UTF-8
Content-Transfer-Encoding: quoted-printable

<div dir=3D"ltr"><div class=3D"gmail_extra"><div class=3D"gmail_quote">On M=
on, Dec 21, 2015 at 8:09 AM, Micha Lenk <span dir=3D"ltr">&lt;<a href=3D"ma=
ilto:micha@lenk.info" target=3D"_blank">micha@lenk.info</a>&gt;</span> wrot=
e:<br><blockquote class=3D"gmail_quote" style=3D"margin:0 0 0 .8ex;border-l=
eft:1px #ccc solid;padding-left:1ex">Hi all,<span class=3D""><br>
<br>
Am 18.12.2015 12:35, schrieb Micha Lenk:<br>
<blockquote class=3D"gmail_quote" style=3D"margin:0 0 0 .8ex;border-left:1p=
x #ccc solid;padding-left:1ex">
I am currently observing a httpd segfault that is triggered on my<br>
system by every second graceful reload (i.e. SIGUSR1).<br>
<br>
Unfotunately I won&#39;t be able to trace this down before Monday, so this<=
br>
is merely a heads-up for those interested.<br>
Is anybody able to reproduce this behavior?<br>
</blockquote>
<br></span>
Just for the records, the segfault seems to be caused by a bad patch.<br>
So sorry for the noise...<br></blockquote><div><br></div><div>Thanks for re=
porting back/glad it is resolved!</div><div>=C2=A0</div><blockquote class=
=3D"gmail_quote" style=3D"margin:0 0 0 .8ex;border-left:1px #ccc solid;padd=
ing-left:1ex">
<br>
Best regards,<br>
Micha<br>
</blockquote></div><br><br clear=3D"all"><div><br></div>-- <br><div class=
=3D"gmail_signature"><div dir=3D"ltr">Born in Roswell... married an alien..=
.<br><a href=3D"http://emptyhammock.com/" target=3D"_blank">http://emptyham=
mock.com/</a><div><br></div></div></div>
</div></div>

--001a113fdfd29a87780527684f8c--

From dev-return-85096-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Mon Dec 21 18:07:32 2015
Return-Path: <dev-return-85096-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id E761B1810F
	for <apmail-httpd-dev-archive@www.apache.org>; Mon, 21 Dec 2015 18:07:31 +0000 (UTC)
Received: (qmail 51122 invoked by uid 500); 21 Dec 2015 18:07:31 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 50962 invoked by uid 500); 21 Dec 2015 18:07:31 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 50952 invoked by uid 99); 21 Dec 2015 18:07:31 -0000
Received: from Unknown (HELO spamd4-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 21 Dec 2015 18:07:31 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd4-us-west.apache.org (ASF Mail Server at spamd4-us-west.apache.org) with ESMTP id 0890DC0AB3
	for <dev@httpd.apache.org>; Mon, 21 Dec 2015 18:07:31 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd4-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 0.999
X-Spam-Level:
X-Spam-Status: No, score=0.999 tagged_above=-999 required=6.31
	tests=[KAM_LAZY_DOMAIN_SECURITY=1, RCVD_IN_MSPIKE_H2=-0.001]
	autolearn=disabled
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd4-us-west.apache.org [10.40.0.11]) (amavisd-new, port 10024)
	with ESMTP id wya6CD7d3n27 for <dev@httpd.apache.org>;
	Mon, 21 Dec 2015 18:07:30 +0000 (UTC)
Received: from smtp.smtpout.orange.fr (smtp03.smtpout.orange.fr [80.12.242.125])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id 99C3520CB7
	for <dev@httpd.apache.org>; Mon, 21 Dec 2015 18:07:29 +0000 (UTC)
Received: from [127.0.0.1] ([92.140.236.87])
	by mwinf5d50 with ME
	id wJ7N1r00L1tpFd003J7NEj; Mon, 21 Dec 2015 19:07:23 +0100
X-ME-Helo: [127.0.0.1]
X-ME-Date: Mon, 21 Dec 2015 19:07:23 +0100
X-ME-IP: 92.140.236.87
Subject: Re: svn commit: r1721121 - in /httpd/httpd/trunk/modules/http2:
 h2_h2.c h2_io.c h2_io.h h2_mplx.h h2_push.c h2_request.c h2_request.h
 h2_session.c h2_session.h h2_stream.c h2_stream.h h2_task.c h2_task.h
 h2_task_output.h h2_worker.h h2_workers.h
To: dev@httpd.apache.org, cvs@httpd.apache.org
References: <20151221105439.52F9E3A0051@svn01-us-west.apache.org>
 <567839AC.3090204@oracle.com>
From: Christophe JAILLET <christophe.jaillet@wanadoo.fr>
Message-ID: <56783FDB.4030105@wanadoo.fr>
Date: Mon, 21 Dec 2015 19:07:23 +0100
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:38.0) Gecko/20100101
 Thunderbird/38.4.0
MIME-Version: 1.0
In-Reply-To: <567839AC.3090204@oracle.com>
Content-Type: text/plain; charset=utf-8; format=flowed
Content-Transfer-Encoding: 8bit
X-Antivirus: avast! (VPS 151221-0, 21/12/2015), Outbound message
X-Antivirus-Status: Clean

Le 21/12/2015 18:41, Mike Rumph a crit :
> Comment below:
>
> Thanks,
>
> Mike
>
> On 12/21/2015 2:54 AM, icing@apache.org wrote:
>> Author: icing
>> Date: Mon Dec 21 10:54:38 2015
>> New Revision: 1721121
>>
>> URL: http://svn.apache.org/viewvc?rev=1721121&view=rev
>> Log:
>> byte savings by using bit fields, new env vars HTTP2 and H2PUSH, set 
>> to on when enabled on request
>>
>> ============================================================================== 
>>
>> --- httpd/httpd/trunk/modules/http2/h2_io.h (original)
>> +++ httpd/httpd/trunk/modules/http2/h2_io.h Mon Dec 21 10:54:38 2015
>> @@ -38,29 +38,30 @@ typedef struct h2_io h2_io;
>>   struct h2_io {
> * * *
>> +
>> +    int orphaned       : 1;      /* h2_stream is gone for this io */
>> +    int task_done      : 1;      /* h2_task has finished for this io */
>> +    int request_body   : 1;      /* iff request has body */
>> +    int eos_in         : 1;      /* input eos has been seen */
>> +    int eos_in_written : 1;      /* input eos has been forwarded */
>> +    int eos_out        : 1;      /* output eos has been seen */
>> +
>>
> There have been past dev discussions on problems related to using 
> signed bitfields.
> Using unsigned int avoids these problems.
>
Fixed in r1721137 and r1721138 (and r1721139 which is not related to 
mod_http2)

CJ


From dev-return-85097-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Mon Dec 21 18:48:53 2015
Return-Path: <dev-return-85097-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id B29E21832B
	for <apmail-httpd-dev-archive@www.apache.org>; Mon, 21 Dec 2015 18:48:53 +0000 (UTC)
Received: (qmail 86088 invoked by uid 500); 21 Dec 2015 18:48:53 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 86016 invoked by uid 500); 21 Dec 2015 18:48:52 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 86006 invoked by uid 99); 21 Dec 2015 18:48:52 -0000
Received: from Unknown (HELO spamd1-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 21 Dec 2015 18:48:52 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd1-us-west.apache.org (ASF Mail Server at spamd1-us-west.apache.org) with ESMTP id 5FACFC07B2
	for <dev@httpd.apache.org>; Mon, 21 Dec 2015 18:48:52 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd1-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 2.999
X-Spam-Level: **
X-Spam-Status: No, score=2.999 tagged_above=-999 required=6.31
	tests=[HTML_MESSAGE=3, RP_MATCHES_RCVD=-0.001, SPF_PASS=-0.001,
	URIBL_BLOCKED=0.001] autolearn=disabled
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd1-us-west.apache.org [10.40.0.7]) (amavisd-new, port 10024)
	with ESMTP id KbV0F6Hd7dDt for <dev@httpd.apache.org>;
	Mon, 21 Dec 2015 18:48:41 +0000 (UTC)
Received: from mx1.cpanel.net (mx1.cpanel.net [208.74.121.68])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id 58007203B7
	for <dev@httpd.apache.org>; Mon, 21 Dec 2015 18:48:40 +0000 (UTC)
Received: from [208.74.121.106] (port=61226 helo=[10.1.4.91])
	by mx1.cpanel.net with esmtpsa (TLSv1:ECDHE-RSA-AES256-SHA:256)
	(Exim 4.86)
	(envelope-from <jacob.perkins@cpanel.net>)
	id 1aB5VZ-000Avy-80
	for dev@httpd.apache.org; Mon, 21 Dec 2015 12:48:33 -0600
Content-Type: multipart/signed; boundary="Apple-Mail=_3F931B85-7679-4BFC-8AE9-FE3960EC4B3C"; protocol="application/pgp-signature"; micalg=pgp-sha512
Mime-Version: 1.0 (Mac OS X Mail 9.2 \(3112\))
Subject: Re: OpenSSL 0.9.8/1.0.0 on Trunk
X-Pgp-Agent: GPGMail 2.6b2
From: Jacob Perkins <jacob.perkins@cpanel.net>
In-Reply-To: <5670386F.5090901@oracle.com>
Date: Mon, 21 Dec 2015 12:48:35 -0600
Message-Id: <1CF499FD-1163-46CA-9941-5C83CD214FC1@cpanel.net>
References: <CACsi253tpu-76tEXCizdgjWPmt9sfjSycuVNXDiefnBmOOnDmA@mail.gmail.com> <5670386F.5090901@oracle.com>
To: dev@httpd.apache.org
X-Mailer: Apple Mail (2.3112)
X-AntiAbuse: This header was added to track abuse, please include it with any abuse report
X-AntiAbuse: Primary Hostname - mx1.cpanel.net
X-AntiAbuse: Original Domain - httpd.apache.org
X-AntiAbuse: Originator/Caller UID/GID - [47 12] / [47 12]
X-AntiAbuse: Sender Address Domain - cpanel.net
X-Get-Message-Sender-Via: mx1.cpanel.net: authenticated_id: jacob.perkins@cpanel.net
X-Authenticated-Sender: mx1.cpanel.net: jacob.perkins@cpanel.net


--Apple-Mail=_3F931B85-7679-4BFC-8AE9-FE3960EC4B3C
Content-Type: multipart/alternative;
	boundary="Apple-Mail=_926238B5-019F-4586-BC7E-8DCB82B782EC"


--Apple-Mail=_926238B5-019F-4586-BC7E-8DCB82B782EC
Content-Transfer-Encoding: quoted-printable
Content-Type: text/plain;
	charset=utf-8

This is kind of a show stopper here. I=E2=80=99m surprised something as =
major as code not compiling was not caught before it was sent out.

=E2=80=94
Jacob Perkins
Product Owner
cPanel Inc.

jacob.perkins@cpanel.net <mailto:jacob.perkins@cpanel.net>
Office:  713-529-0800 x 4046
Cell:  713-560-8655

> On Dec 15, 2015, at 9:57 AM, Mike Rumph <mike.rumph@oracle.com> wrote:
>=20
> FYI.  Bug 58737 was just opened today for this error.
>=20
> Thanks,
>=20
> Mike
>=20
> On 12/14/2015 10:15 AM, William A Rowe Jr wrote:
>> W.r.t. http://svn.apache.org/r1719967 - I'm +1 for the backport.
>> I'd like to propose we remove all support from *trunk* for OpenSSL < =
1.0.1
>> effective now...
>>=20
>> =
https://mta.openssl.org/pipermail/openssl-announce/2014-December/000000.ht=
ml
>>=20
>> We don't deprecate support on maintenance branches (e.g. 2.2/2.4),
>> because we seek to minimize the pain of moving from one subversion
>> release to another.  If someone wanted to hack a non-fatal warning =
for
>> the ./configure phase, that could be a worthwhile patch.
>>=20
>>=20
>=20


--Apple-Mail=_926238B5-019F-4586-BC7E-8DCB82B782EC
Content-Transfer-Encoding: quoted-printable
Content-Type: text/html;
	charset=utf-8

<html><head><meta http-equiv=3D"Content-Type" content=3D"text/html =
charset=3Dutf-8"></head><body style=3D"word-wrap: break-word; =
-webkit-nbsp-mode: space; -webkit-line-break: after-white-space;" =
class=3D"">This is kind of a show stopper here. I=E2=80=99m surprised =
something as major as code not compiling was not caught before it was =
sent out.&nbsp;<br class=3D""><div class=3D"">
<div style=3D"color: rgb(0, 0, 0); font-family: Helvetica; font-size: =
12px; font-style: normal; font-variant: normal; font-weight: normal; =
letter-spacing: normal; line-height: normal; text-align: -webkit-auto; =
text-indent: 0px; text-transform: none; white-space: normal; =
word-spacing: 0px; -webkit-text-stroke-width: 0px; orphans: 2; widows: =
2; word-wrap: break-word; -webkit-nbsp-mode: space; -webkit-line-break: =
after-white-space;" class=3D""><br =
class=3D"Apple-interchange-newline">=E2=80=94</div><div style=3D"color: =
rgb(0, 0, 0); font-family: Helvetica; font-size: 12px; font-style: =
normal; font-variant: normal; font-weight: normal; letter-spacing: =
normal; line-height: normal; text-align: -webkit-auto; text-indent: 0px; =
text-transform: none; white-space: normal; word-spacing: 0px; =
-webkit-text-stroke-width: 0px; orphans: 2; widows: 2; word-wrap: =
break-word; -webkit-nbsp-mode: space; -webkit-line-break: =
after-white-space;" class=3D"">Jacob Perkins<br class=3D""></div><div =
style=3D"color: rgb(0, 0, 0); font-family: Helvetica; font-size: 12px; =
font-style: normal; font-variant: normal; font-weight: normal; =
letter-spacing: normal; line-height: normal; text-align: -webkit-auto; =
text-indent: 0px; text-transform: none; white-space: normal; =
word-spacing: 0px; -webkit-text-stroke-width: 0px; orphans: 2; widows: =
2; word-wrap: break-word; -webkit-nbsp-mode: space; -webkit-line-break: =
after-white-space;" class=3D"">Product Owner</div><div style=3D"color: =
rgb(0, 0, 0); font-family: Helvetica; font-size: 12px; font-style: =
normal; font-variant: normal; font-weight: normal; letter-spacing: =
normal; line-height: normal; text-align: -webkit-auto; text-indent: 0px; =
text-transform: none; white-space: normal; word-spacing: 0px; =
-webkit-text-stroke-width: 0px; orphans: 2; widows: 2; word-wrap: =
break-word; -webkit-nbsp-mode: space; -webkit-line-break: =
after-white-space;" class=3D""><b class=3D""><font color=3D"#ff7c00" =
class=3D"">cPanel Inc.</font></b></div><div style=3D"color: rgb(0, 0, =
0); font-family: Helvetica; font-size: 12px; font-style: normal; =
font-variant: normal; font-weight: normal; letter-spacing: normal; =
line-height: normal; text-align: -webkit-auto; text-indent: 0px; =
text-transform: none; white-space: normal; word-spacing: 0px; =
-webkit-text-stroke-width: 0px; orphans: 2; widows: 2; word-wrap: =
break-word; -webkit-nbsp-mode: space; -webkit-line-break: =
after-white-space;" class=3D""><br class=3D""></div><div style=3D"color: =
rgb(0, 0, 0); font-family: Helvetica; font-size: 12px; font-style: =
normal; font-variant: normal; font-weight: normal; letter-spacing: =
normal; line-height: normal; text-align: -webkit-auto; text-indent: 0px; =
text-transform: none; white-space: normal; word-spacing: 0px; =
-webkit-text-stroke-width: 0px; orphans: 2; widows: 2; word-wrap: =
break-word; -webkit-nbsp-mode: space; -webkit-line-break: =
after-white-space;" class=3D""><a href=3D"mailto:jacob.perkins@cpanel.net"=
 class=3D"">jacob.perkins@cpanel.net</a></div><div style=3D"color: =
rgb(0, 0, 0); font-family: Helvetica; font-size: 12px; font-style: =
normal; font-variant: normal; font-weight: normal; letter-spacing: =
normal; line-height: normal; text-align: -webkit-auto; text-indent: 0px; =
text-transform: none; white-space: normal; word-spacing: 0px; =
-webkit-text-stroke-width: 0px; orphans: 2; widows: 2; word-wrap: =
break-word; -webkit-nbsp-mode: space; -webkit-line-break: =
after-white-space;" class=3D"">Office: &nbsp;713-529-0800 =
x&nbsp;4046</div><div style=3D"color: rgb(0, 0, 0); font-family: =
Helvetica; font-size: 12px; font-style: normal; font-variant: normal; =
font-weight: normal; letter-spacing: normal; line-height: normal; =
text-align: -webkit-auto; text-indent: 0px; text-transform: none; =
white-space: normal; word-spacing: 0px; -webkit-text-stroke-width: 0px; =
orphans: 2; widows: 2; word-wrap: break-word; -webkit-nbsp-mode: space; =
-webkit-line-break: after-white-space;" class=3D"">Cell: =
&nbsp;713-560-8655</div>
</div>
<br class=3D""><div><blockquote type=3D"cite" class=3D""><div =
class=3D"">On Dec 15, 2015, at 9:57 AM, Mike Rumph &lt;<a =
href=3D"mailto:mike.rumph@oracle.com" =
class=3D"">mike.rumph@oracle.com</a>&gt; wrote:</div><br =
class=3D"Apple-interchange-newline"><div class=3D""><div class=3D"">FYI. =
&nbsp;Bug 58737 was just opened today for this error.<br class=3D""><br =
class=3D"">Thanks,<br class=3D""><br class=3D"">Mike<br class=3D""><br =
class=3D"">On 12/14/2015 10:15 AM, William A Rowe Jr wrote:<br =
class=3D""><blockquote type=3D"cite" class=3D"">W.r.t. <a =
href=3D"http://svn.apache.org/r1719967" =
class=3D"">http://svn.apache.org/r1719967</a> - I'm +1 for the =
backport.<br class=3D"">I'd like to propose we remove all support from =
*trunk* for OpenSSL &lt; 1.0.1<br class=3D"">effective now...<br =
class=3D""><br class=3D""><a =
href=3D"https://mta.openssl.org/pipermail/openssl-announce/2014-December/0=
00000.html" =
class=3D"">https://mta.openssl.org/pipermail/openssl-announce/2014-Decembe=
r/000000.html</a><br class=3D""><br class=3D"">We don't deprecate =
support on maintenance branches (e.g. 2.2/2.4),<br class=3D"">because we =
seek to minimize the pain of moving from one subversion<br =
class=3D"">release to another. &nbsp;If someone wanted to hack a =
non-fatal warning for<br class=3D"">the ./configure phase, that could be =
a worthwhile patch.<br class=3D""><br class=3D""><br =
class=3D""></blockquote><br class=3D""></div></div></blockquote></div><br =
class=3D""></body></html>=

--Apple-Mail=_926238B5-019F-4586-BC7E-8DCB82B782EC--

--Apple-Mail=_3F931B85-7679-4BFC-8AE9-FE3960EC4B3C
Content-Transfer-Encoding: 7bit
Content-Disposition: attachment;
	filename=signature.asc
Content-Type: application/pgp-signature;
	name=signature.asc
Content-Description: Message signed with OpenPGP using GPGMail

-----BEGIN PGP SIGNATURE-----
Comment: GPGTools - https://gpgtools.org

iQEcBAEBCgAGBQJWeEmEAAoJEIo8JcFLoqwqCQQH/jrWTLnatvBrTO0Hr5sFKRgx
rnDCIo0hnOewlwS5FTaOXEcU0GSX+++yD4DateMGtISxiFMOJu5cO0lvAbw5e/BW
HnnVjqcTDF88je7Im3XuxBQu4a87nHORv67l3qcBvchKpbFpFrnnAIVMKo321NaI
LhYZzuu5w5ymaWykS/ceiElLss+nSJ8s8ryHhexrD/UaWwY6bi20qF/DvM/JtSHf
z4c7wYA+a/BgVw8f/VeJ9W8XH7MiAdUEGfjqoSXmIbFPEulqoDJd0G5F6SIXLPz8
+3F9DZSp7tnAZlG1NtZg4hTo2ry1tA76+adkgheRFTatsa4NGx+Yw0+5xcd6XE4=
=/cUy
-----END PGP SIGNATURE-----

--Apple-Mail=_3F931B85-7679-4BFC-8AE9-FE3960EC4B3C--

From dev-return-85098-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Mon Dec 21 19:06:44 2015
Return-Path: <dev-return-85098-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 0637118400
	for <apmail-httpd-dev-archive@www.apache.org>; Mon, 21 Dec 2015 19:06:44 +0000 (UTC)
Received: (qmail 25982 invoked by uid 500); 21 Dec 2015 19:06:43 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 25897 invoked by uid 500); 21 Dec 2015 19:06:43 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 25887 invoked by uid 99); 21 Dec 2015 19:06:43 -0000
Received: from Unknown (HELO spamd1-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 21 Dec 2015 19:06:43 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd1-us-west.apache.org (ASF Mail Server at spamd1-us-west.apache.org) with ESMTP id B6F92C0746
	for <dev@httpd.apache.org>; Mon, 21 Dec 2015 19:06:42 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd1-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.101
X-Spam-Level:
X-Spam-Status: No, score=-0.101 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RCVD_IN_MSPIKE_H2=-0.001, SPF_PASS=-0.001, URIBL_BLOCKED=0.001]
	autolearn=disabled
Authentication-Results: spamd1-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd1-us-west.apache.org [10.40.0.7]) (amavisd-new, port 10024)
	with ESMTP id XeLLDdNRjnj0 for <dev@httpd.apache.org>;
	Mon, 21 Dec 2015 19:06:36 +0000 (UTC)
Received: from mail-io0-f173.google.com (mail-io0-f173.google.com [209.85.223.173])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id 50E75439AA
	for <dev@httpd.apache.org>; Mon, 21 Dec 2015 19:06:36 +0000 (UTC)
Received: by mail-io0-f173.google.com with SMTP id e126so164041350ioa.1
        for <dev@httpd.apache.org>; Mon, 21 Dec 2015 11:06:36 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type:content-transfer-encoding;
        bh=CFuFiImBD8dA6hncSNfL0Qc2LeAc12WR2jAtQC7QLo4=;
        b=zvxyR8SNTA7usjMM8YMGqHOXJhwYxtY6uY15et2+4GWm0Ol+6/T0rjHieS40j8sSZ4
         yuap7tSg38/q+B1UUm6PCvEy725rl5OKzTUcxcMoN/q8DVdidU9pQJ0sHTzu7nlPhE84
         opr4ABQwYVGLzfeHvCdzhXrfaobOU0YLuOg8QyHRtZiPDi2UmUZkmrMi/j44ky4S16Eg
         wlzDaDwsKFQWOVTqQhSCkN6lgL4ssXKl0UfGkTwGuGnwdYu09bT7ysPSkukkTxPn7fen
         V1UNqLNf8wXS7ZkGvojCGFBG3TrrARjkGjs5BYqLg4+Gq1hqaSitIYoxAcN4uIoJv1Oi
         1+7g==
MIME-Version: 1.0
X-Received: by 10.107.157.213 with SMTP id g204mr23477059ioe.169.1450724796000;
 Mon, 21 Dec 2015 11:06:36 -0800 (PST)
Received: by 10.64.114.199 with HTTP; Mon, 21 Dec 2015 11:06:35 -0800 (PST)
In-Reply-To: <1CF499FD-1163-46CA-9941-5C83CD214FC1@cpanel.net>
References: <CACsi253tpu-76tEXCizdgjWPmt9sfjSycuVNXDiefnBmOOnDmA@mail.gmail.com>
	<5670386F.5090901@oracle.com>
	<1CF499FD-1163-46CA-9941-5C83CD214FC1@cpanel.net>
Date: Mon, 21 Dec 2015 14:06:35 -0500
Message-ID: <CALK=YjP7kJDWMKLwy0ke4Hh6EHevebN3UgYSbLyK01hrFvxsZA@mail.gmail.com>
Subject: Re: OpenSSL 0.9.8/1.0.0 on Trunk
From: Eric Covener <covener@gmail.com>
To: Apache HTTP Server Development List <dev@httpd.apache.org>
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: quoted-printable

On Mon, Dec 21, 2015 at 1:48 PM, Jacob Perkins <jacob.perkins@cpanel.net> w=
rote:
> This is kind of a show stopper here. I=E2=80=99m surprised something as m=
ajor as
> code not compiling was not caught before it was sent out.

This particular failure only occurs when compiling httpd against older
levels of openssl 0.9.8.
It's no surprise to me that none of the handful of people who test new
release candidates test
with contemporary levels of openssl that are actually fit for some use.

From dev-return-85099-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Mon Dec 21 19:38:48 2015
Return-Path: <dev-return-85099-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 7D09618696
	for <apmail-httpd-dev-archive@www.apache.org>; Mon, 21 Dec 2015 19:38:48 +0000 (UTC)
Received: (qmail 12316 invoked by uid 500); 21 Dec 2015 19:38:47 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 12237 invoked by uid 500); 21 Dec 2015 19:38:47 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 12226 invoked by uid 99); 21 Dec 2015 19:38:47 -0000
Received: from Unknown (HELO spamd2-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 21 Dec 2015 19:38:47 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd2-us-west.apache.org (ASF Mail Server at spamd2-us-west.apache.org) with ESMTP id 61BB31A0161
	for <dev@httpd.apache.org>; Mon, 21 Dec 2015 19:38:47 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd2-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 2.445
X-Spam-Level: **
X-Spam-Status: No, score=2.445 tagged_above=-999 required=6.31
	tests=[HTML_MESSAGE=3, RP_MATCHES_RCVD=-0.554, SPF_HELO_PASS=-0.001,
	SPF_PASS=-0.001, URIBL_BLOCKED=0.001] autolearn=disabled
Received: from mx1-us-west.apache.org ([10.40.0.8])
	by localhost (spamd2-us-west.apache.org [10.40.0.9]) (amavisd-new, port 10024)
	with ESMTP id AhaNJ2M-gyAQ for <dev@httpd.apache.org>;
	Mon, 21 Dec 2015 19:38:40 +0000 (UTC)
Received: from mx1.cpanel.net (mx1.cpanel.net [208.74.121.68])
	by mx1-us-west.apache.org (ASF Mail Server at mx1-us-west.apache.org) with ESMTPS id 035B920FD3
	for <dev@httpd.apache.org>; Mon, 21 Dec 2015 19:38:39 +0000 (UTC)
Received: from [208.74.121.106] (port=19234 helo=[10.1.4.91])
	by mx1.cpanel.net with esmtpsa (TLSv1:ECDHE-RSA-AES256-SHA:256)
	(Exim 4.86)
	(envelope-from <jacob.perkins@cpanel.net>)
	id 1aB6Hx-0003V4-Ni
	for dev@httpd.apache.org; Mon, 21 Dec 2015 13:38:33 -0600
Content-Type: multipart/signed; boundary="Apple-Mail=_2AF59F07-5B52-46C5-8E7D-3FA384820C6D"; protocol="application/pgp-signature"; micalg=pgp-sha512
Mime-Version: 1.0 (Mac OS X Mail 9.2 \(3112\))
Subject: Re: OpenSSL 0.9.8/1.0.0 on Trunk
X-Pgp-Agent: GPGMail 2.6b2
From: Jacob Perkins <jacob.perkins@cpanel.net>
In-Reply-To: <CALK=YjP7kJDWMKLwy0ke4Hh6EHevebN3UgYSbLyK01hrFvxsZA@mail.gmail.com>
Date: Mon, 21 Dec 2015 13:38:36 -0600
Message-Id: <E05B0375-6FC0-4D48-B35E-956A3D95EA8B@cpanel.net>
References: <CACsi253tpu-76tEXCizdgjWPmt9sfjSycuVNXDiefnBmOOnDmA@mail.gmail.com> <5670386F.5090901@oracle.com> <1CF499FD-1163-46CA-9941-5C83CD214FC1@cpanel.net> <CALK=YjP7kJDWMKLwy0ke4Hh6EHevebN3UgYSbLyK01hrFvxsZA@mail.gmail.com>
To: dev@httpd.apache.org
X-Mailer: Apple Mail (2.3112)
X-AntiAbuse: This header was added to track abuse, please include it with any abuse report
X-AntiAbuse: Primary Hostname - mx1.cpanel.net
X-AntiAbuse: Original Domain - httpd.apache.org
X-AntiAbuse: Originator/Caller UID/GID - [47 12] / [47 12]
X-AntiAbuse: Sender Address Domain - cpanel.net
X-Get-Message-Sender-Via: mx1.cpanel.net: authenticated_id: jacob.perkins@cpanel.net
X-Authenticated-Sender: mx1.cpanel.net: jacob.perkins@cpanel.net


--Apple-Mail=_2AF59F07-5B52-46C5-8E7D-3FA384820C6D
Content-Type: multipart/alternative;
	boundary="Apple-Mail=_174638E1-E9B6-4616-8502-15A8FBA8D72B"


--Apple-Mail=_174638E1-E9B6-4616-8502-15A8FBA8D72B
Content-Transfer-Encoding: quoted-printable
Content-Type: text/plain;
	charset=utf-8

CentOS 5 still ships with OpenSSL 0.9.8, and is still supported for =
another year or so. Considering there=E2=80=99s a lot of servers still =
running CentOS 5 (and possibly older), it feels as if this would have =
been caught. Especially something as small as a missing semicolon.

Would a linter / compile check to proactively check those things help?
=E2=80=94
Jacob Perkins
Product Owner
cPanel Inc.

jacob.perkins@cpanel.net <mailto:jacob.perkins@cpanel.net>
Office:  713-529-0800 x 4046
Cell:  713-560-8655

> On Dec 21, 2015, at 1:06 PM, Eric Covener <covener@gmail.com> wrote:
>=20
> On Mon, Dec 21, 2015 at 1:48 PM, Jacob Perkins =
<jacob.perkins@cpanel.net> wrote:
>> This is kind of a show stopper here. I=E2=80=99m surprised something =
as major as
>> code not compiling was not caught before it was sent out.
>=20
> This particular failure only occurs when compiling httpd against older
> levels of openssl 0.9.8.
> It's no surprise to me that none of the handful of people who test new
> release candidates test
> with contemporary levels of openssl that are actually fit for some =
use.


--Apple-Mail=_174638E1-E9B6-4616-8502-15A8FBA8D72B
Content-Transfer-Encoding: quoted-printable
Content-Type: text/html;
	charset=utf-8

<html><head><meta http-equiv=3D"Content-Type" content=3D"text/html =
charset=3Dutf-8"></head><body style=3D"word-wrap: break-word; =
-webkit-nbsp-mode: space; -webkit-line-break: after-white-space;" =
class=3D"">CentOS 5 still ships with OpenSSL 0.9.8, and is still =
supported for another year or so. Considering there=E2=80=99s a lot of =
servers still running CentOS 5 (and possibly older), it feels as if this =
would have been caught. Especially something as small as a missing =
semicolon.&nbsp;<div class=3D""><br class=3D""></div><div class=3D"">Would=
 a linter / compile check to proactively check those things help?<div =
class=3D""><div class=3D""><div style=3D"color: rgb(0, 0, 0); =
font-family: Helvetica; font-size: 12px; font-style: normal; =
font-variant: normal; font-weight: normal; letter-spacing: normal; =
line-height: normal; text-align: -webkit-auto; text-indent: 0px; =
text-transform: none; white-space: normal; word-spacing: 0px; =
-webkit-text-stroke-width: 0px; orphans: 2; widows: 2; word-wrap: =
break-word; -webkit-nbsp-mode: space; -webkit-line-break: =
after-white-space;" class=3D"">=E2=80=94</div><div style=3D"color: =
rgb(0, 0, 0); font-family: Helvetica; font-size: 12px; font-style: =
normal; font-variant: normal; font-weight: normal; letter-spacing: =
normal; line-height: normal; text-align: -webkit-auto; text-indent: 0px; =
text-transform: none; white-space: normal; word-spacing: 0px; =
-webkit-text-stroke-width: 0px; orphans: 2; widows: 2; word-wrap: =
break-word; -webkit-nbsp-mode: space; -webkit-line-break: =
after-white-space;" class=3D"">Jacob Perkins<br class=3D""></div><div =
style=3D"color: rgb(0, 0, 0); font-family: Helvetica; font-size: 12px; =
font-style: normal; font-variant: normal; font-weight: normal; =
letter-spacing: normal; line-height: normal; text-align: -webkit-auto; =
text-indent: 0px; text-transform: none; white-space: normal; =
word-spacing: 0px; -webkit-text-stroke-width: 0px; orphans: 2; widows: =
2; word-wrap: break-word; -webkit-nbsp-mode: space; -webkit-line-break: =
after-white-space;" class=3D"">Product Owner</div><div style=3D"color: =
rgb(0, 0, 0); font-family: Helvetica; font-size: 12px; font-style: =
normal; font-variant: normal; font-weight: normal; letter-spacing: =
normal; line-height: normal; text-align: -webkit-auto; text-indent: 0px; =
text-transform: none; white-space: normal; word-spacing: 0px; =
-webkit-text-stroke-width: 0px; orphans: 2; widows: 2; word-wrap: =
break-word; -webkit-nbsp-mode: space; -webkit-line-break: =
after-white-space;" class=3D""><b class=3D""><font color=3D"#ff7c00" =
class=3D"">cPanel Inc.</font></b></div><div style=3D"color: rgb(0, 0, =
0); font-family: Helvetica; font-size: 12px; font-style: normal; =
font-variant: normal; font-weight: normal; letter-spacing: normal; =
line-height: normal; text-align: -webkit-auto; text-indent: 0px; =
text-transform: none; white-space: normal; word-spacing: 0px; =
-webkit-text-stroke-width: 0px; orphans: 2; widows: 2; word-wrap: =
break-word; -webkit-nbsp-mode: space; -webkit-line-break: =
after-white-space;" class=3D""><br class=3D""></div><div style=3D"color: =
rgb(0, 0, 0); font-family: Helvetica; font-size: 12px; font-style: =
normal; font-variant: normal; font-weight: normal; letter-spacing: =
normal; line-height: normal; text-align: -webkit-auto; text-indent: 0px; =
text-transform: none; white-space: normal; word-spacing: 0px; =
-webkit-text-stroke-width: 0px; orphans: 2; widows: 2; word-wrap: =
break-word; -webkit-nbsp-mode: space; -webkit-line-break: =
after-white-space;" class=3D""><a href=3D"mailto:jacob.perkins@cpanel.net"=
 class=3D"">jacob.perkins@cpanel.net</a></div><div style=3D"color: =
rgb(0, 0, 0); font-family: Helvetica; font-size: 12px; font-style: =
normal; font-variant: normal; font-weight: normal; letter-spacing: =
normal; line-height: normal; text-align: -webkit-auto; text-indent: 0px; =
text-transform: none; white-space: normal; word-spacing: 0px; =
-webkit-text-stroke-width: 0px; orphans: 2; widows: 2; word-wrap: =
break-word; -webkit-nbsp-mode: space; -webkit-line-break: =
after-white-space;" class=3D"">Office: &nbsp;713-529-0800 =
x&nbsp;4046</div><div style=3D"color: rgb(0, 0, 0); font-family: =
Helvetica; font-size: 12px; font-style: normal; font-variant: normal; =
font-weight: normal; letter-spacing: normal; line-height: normal; =
text-align: -webkit-auto; text-indent: 0px; text-transform: none; =
white-space: normal; word-spacing: 0px; -webkit-text-stroke-width: 0px; =
orphans: 2; widows: 2; word-wrap: break-word; -webkit-nbsp-mode: space; =
-webkit-line-break: after-white-space;" class=3D"">Cell: =
&nbsp;713-560-8655</div>
</div>
<br class=3D""><div><blockquote type=3D"cite" class=3D""><div =
class=3D"">On Dec 21, 2015, at 1:06 PM, Eric Covener &lt;<a =
href=3D"mailto:covener@gmail.com" class=3D"">covener@gmail.com</a>&gt; =
wrote:</div><br class=3D"Apple-interchange-newline"><div class=3D""><div =
class=3D"">On Mon, Dec 21, 2015 at 1:48 PM, Jacob Perkins &lt;<a =
href=3D"mailto:jacob.perkins@cpanel.net" =
class=3D"">jacob.perkins@cpanel.net</a>&gt; wrote:<br =
class=3D""><blockquote type=3D"cite" class=3D"">This is kind of a show =
stopper here. I=E2=80=99m surprised something as major as<br =
class=3D"">code not compiling was not caught before it was sent out.<br =
class=3D""></blockquote><br class=3D"">This particular failure only =
occurs when compiling httpd against older<br class=3D"">levels of =
openssl 0.9.8.<br class=3D"">It's no surprise to me that none of the =
handful of people who test new<br class=3D"">release candidates test<br =
class=3D"">with contemporary levels of openssl that are actually fit for =
some use.<br class=3D""></div></div></blockquote></div><br =
class=3D""></div></div></body></html>=

--Apple-Mail=_174638E1-E9B6-4616-8502-15A8FBA8D72B--

--Apple-Mail=_2AF59F07-5B52-46C5-8E7D-3FA384820C6D
Content-Transfer-Encoding: 7bit
Content-Disposition: attachment;
	filename=signature.asc
Content-Type: application/pgp-signature;
	name=signature.asc
Content-Description: Message signed with OpenPGP using GPGMail

-----BEGIN PGP SIGNATURE-----
Comment: GPGTools - https://gpgtools.org

iQEcBAEBCgAGBQJWeFU8AAoJEIo8JcFLoqwqNzAH/2CUDdy/sruTZt2hKBAl4FcL
YHgzMf9YH2f8Emv0H+5W90FHX80N3OQUwRWjNdyeq07OXJejBAhGgW42T1qNwlva
yc5GFspFms+x//e/L0FJL59NHdVM1/glgE1aHugMMZAPJCf1NLnHqd/b2+FTEuVU
+A/puYQQdgbA7lYGMZ1hxNr8lIL6Y43AQYVMABWpwuN/kV6p+D0il9ucYLPdc6zQ
RgumyyuzqwClhTOB9zqmS1KFlKocoFwz544JxjZUTkDbSpIEA6VgvfMI9sEcX1Wj
xDiJ2WjRPJgRm1LZtxGu3tPuRbfNhFPamplLBagQ1MUL3lXfYIFyFlsABqfWbOk=
=YQd6
-----END PGP SIGNATURE-----

--Apple-Mail=_2AF59F07-5B52-46C5-8E7D-3FA384820C6D--

From dev-return-85100-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Mon Dec 21 23:21:01 2015
Return-Path: <dev-return-85100-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 504DF180B9
	for <apmail-httpd-dev-archive@www.apache.org>; Mon, 21 Dec 2015 23:21:01 +0000 (UTC)
Received: (qmail 87649 invoked by uid 500); 21 Dec 2015 23:21:00 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 87564 invoked by uid 500); 21 Dec 2015 23:21:00 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 87553 invoked by uid 99); 21 Dec 2015 23:21:00 -0000
Received: from Unknown (HELO spamd3-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 21 Dec 2015 23:21:00 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd3-us-west.apache.org (ASF Mail Server at spamd3-us-west.apache.org) with ESMTP id 44AE718022F
	for <dev@httpd.apache.org>; Mon, 21 Dec 2015 23:21:00 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd3-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.1
X-Spam-Level:
X-Spam-Status: No, score=-0.1 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RCVD_IN_MSPIKE_H2=-0.001, URIBL_BLOCKED=0.001] autolearn=disabled
Authentication-Results: spamd3-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd3-us-west.apache.org [10.40.0.10]) (amavisd-new, port 10024)
	with ESMTP id zf3AAn0QxfGq for <dev@httpd.apache.org>;
	Mon, 21 Dec 2015 23:20:49 +0000 (UTC)
Received: from mail-io0-f181.google.com (mail-io0-f181.google.com [209.85.223.181])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id C692C43A14
	for <dev@httpd.apache.org>; Mon, 21 Dec 2015 23:20:41 +0000 (UTC)
Received: by mail-io0-f181.google.com with SMTP id 186so172384859iow.0
        for <dev@httpd.apache.org>; Mon, 21 Dec 2015 15:20:41 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type:content-transfer-encoding;
        bh=7vx4bKnkZbFaj0exi54dk+aJgW12uRf37YBUP/yDIyg=;
        b=iJhszx3qIQsx0/2fekxnYV2sxoPqb4xSTA3TM6LBnaOEfKBaml7JNMnhi2dfg29gPc
         8I88wun5zna7uoU3EkNz9M2bUkx+OP7pAgLgcRm5YbRq85uoFG+6Tp08dnyIhRjWVGR+
         7RxdzaADcWb0Di3pIXjh5oNETGOGbcY54AbgZaGi38kSjwxUHnUFkE/tKRChvL/zrwSd
         upywNd/c8DSDudJsalePoKXhJ5varulU+kgcxaWHNS+v8xlf+U9J6Xn7XldpQ92CsxNw
         Zy/PALZ8K2+6CjlUGOLt4hDnV7Zbjc0hjvKqb+b6gaA5bj/vGIN4mmQabZaNOGMrJkFM
         b8OQ==
MIME-Version: 1.0
X-Received: by 10.107.157.213 with SMTP id g204mr24763852ioe.169.1450740041453;
 Mon, 21 Dec 2015 15:20:41 -0800 (PST)
Received: by 10.64.114.199 with HTTP; Mon, 21 Dec 2015 15:20:41 -0800 (PST)
In-Reply-To: <E05B0375-6FC0-4D48-B35E-956A3D95EA8B@cpanel.net>
References: <CACsi253tpu-76tEXCizdgjWPmt9sfjSycuVNXDiefnBmOOnDmA@mail.gmail.com>
	<5670386F.5090901@oracle.com>
	<1CF499FD-1163-46CA-9941-5C83CD214FC1@cpanel.net>
	<CALK=YjP7kJDWMKLwy0ke4Hh6EHevebN3UgYSbLyK01hrFvxsZA@mail.gmail.com>
	<E05B0375-6FC0-4D48-B35E-956A3D95EA8B@cpanel.net>
Date: Mon, 21 Dec 2015 18:20:41 -0500
Message-ID: <CALK=YjMq_VZ+u1agz0oWBuFoP9QTpT2q85OxKTohLjFpzht5YQ@mail.gmail.com>
Subject: Re: OpenSSL 0.9.8/1.0.0 on Trunk
From: Eric Covener <covener@gmail.com>
To: Apache HTTP Server Development List <dev@httpd.apache.org>
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: quoted-printable

On Mon, Dec 21, 2015 at 2:38 PM, Jacob Perkins <jacob.perkins@cpanel.net> w=
rote:
> CentOS 5 still ships with OpenSSL 0.9.8, and is still supported for anoth=
er
> year or so. Considering there=E2=80=99s a lot of servers still running Ce=
ntOS 5 (and
> possibly older), it feels as if this would have been caught.

Do you mean could or should have been caught?

It wasn't caught until someone compiled it against openssl < 0.9.8m
(which is not the latest 0.9.8).  I can't see many scenarios where someone
will compile a new 2.4.x release and not have a contemporary openssl --
beyond trying to catch exactly these kinds of problems during a release.

> Especially something as small as a missing semicolon.

Well, usually small problems are the ones that fly under the radar.    Anyt=
hing
catastrophic to the build will not go unnoticed, but someone has to build o=
n the
affected platform/compiler/prereqs/???.

> Would a linter / compile check to proactively check those things help?

Dunno, possible.

From dev-return-85101-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Tue Dec 22 00:11:59 2015
Return-Path: <dev-return-85101-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 75441182BA
	for <apmail-httpd-dev-archive@www.apache.org>; Tue, 22 Dec 2015 00:11:59 +0000 (UTC)
Received: (qmail 77061 invoked by uid 500); 22 Dec 2015 00:11:58 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 76980 invoked by uid 500); 22 Dec 2015 00:11:57 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 76971 invoked by uid 99); 22 Dec 2015 00:11:57 -0000
Received: from mail-relay.apache.org (HELO mail-relay.apache.org) (140.211.11.15)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 22 Dec 2015 00:11:57 +0000
Received: from [192.168.1.240] (e183083236.adsl.alicedsl.de [85.183.83.236])
	by mail-relay.apache.org (ASF Mail Server at mail-relay.apache.org) with ESMTPSA id 59F511A0250
	for <dev@httpd.apache.org>; Tue, 22 Dec 2015 00:11:57 +0000 (UTC)
Message-ID: <5678958E.20608@apache.org>
Date: Tue, 22 Dec 2015 01:13:02 +0100
From: Stefan Fuhrmann <stefan2@apache.org>
Organization: Apache Software Foundation
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:24.0) Gecko/20100101 Thunderbird/24.6.0
MIME-Version: 1.0
To: dev@httpd.apache.org
Subject: [PATCH] Reduce memory footprint in mod_dav's property code
Content-Type: text/plain; charset=ISO-8859-1; format=flowed
Content-Transfer-Encoding: 7bit

Hi,

I stumbled over this while investigation an OOM report from a
Subversion user [1].  Due to unfortunate circumstances [2], I've
seen directory listings with a few 10000 entries eat 10s of GB
of RAM.  Those circumstances are being addressed but the root
cause is in mod_dav and the patch below fixes it.

The problem is that dav_open_propdb creates a pool that
dav_close_propdb can't destroy.  So, for every property, at least
8 KB of memory will be allocated.  If we simply use the parent
pool as is, only a few 100 bytes will be used.

Moreover, if the APR allocator should return a larger block once
in a while, that block will get used up nicely before more memory
is allocated.  So with this patch, the worst case will still use
only about to 1/10th of the current best case for large collections.

-- Stefan^2.

[1] 
http://mail-archives.apache.org/mod_mbox/subversion-users/201512.mbox/%3C1CEE115D02633942A40D49D447DCF46E432F3A32%40SD01CFMM0202.OMEGA.DCE-EIR.NET%3E
[2] 
http://mail-archives.apache.org/mod_mbox/subversion-dev/201512.mbox/%3C5676A54F.9040609%40apache.org%3E


[[[
Fix a pool handling asymmetry in mod_dav that caused inefficient
memory usage with collection properties.

If we can't clear nor destroy the local pool in dav_propdb, there
is no point in creating it as a sub-pool of its parent.

* modules/dav/main/props.c
   (DAV_PROPDB_LOCAL_POOL): New compile-time switch replacing the
                            plain "#if 0" in dav_close_propdb.  It
                            ensures consistent behaviour between
                            open and close in the future.
   (dav_open_propdb): If we can't clear the pool, we may as well use
                      its parent directly.
   (dav_close_propdb): Use the new define.
]]]

[[[
Index: modules/dav/main/props.c
===================================================================
--- modules/dav/main/props.c	(revision 1721073)
+++ modules/dav/main/props.c	(working copy)
@@ -167,6 +167,16 @@

  #define DAV_EMPTY_VALUE                "\0"    /* TWO null terms */

+/*
+** Currently, mod_dav's pool usage doesn't allow clearing the pool
+** at dav_propdb.p . Therefore, we won't create a sub-pool for it
+** and use the request's pool directly instead.
+**
+** Once the pool usage issue has been fixed, set this to 1 for optimal
+** memory usage.
+*/
+#define DAV_PROPDB_LOCAL_POOL          0
+
  struct dav_propdb {
      apr_pool_t *p;                /* the pool we should use */
      request_rec *r;               /* the request record */
@@ -537,7 +547,11 @@
  #endif

      propdb->r = r;
+#if DAV_PROPDB_LOCAL_POOL
      apr_pool_create(&propdb->p, r->pool);
+#else
+    propdb->p = r->pool;
+#endif
      propdb->resource = resource;
      propdb->ns_xlate = ns_xlate;

@@ -562,8 +576,7 @@
          (*propdb->db_hooks->close)(propdb->db);
      }

-    /* Currently, mod_dav's pool usage doesn't allow clearing this pool. */
-#if 0
+#if DAV_PROPDB_LOCAL_POOL
      apr_pool_destroy(propdb->p);
  #endif
  }
]]]

From dev-return-85102-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Tue Dec 22 05:30:44 2015
Return-Path: <dev-return-85102-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id ABA5718AE3
	for <apmail-httpd-dev-archive@www.apache.org>; Tue, 22 Dec 2015 05:30:44 +0000 (UTC)
Received: (qmail 36788 invoked by uid 500); 22 Dec 2015 05:30:44 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 36709 invoked by uid 500); 22 Dec 2015 05:30:43 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 36698 invoked by uid 99); 22 Dec 2015 05:30:43 -0000
Received: from Unknown (HELO spamd2-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 22 Dec 2015 05:30:43 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd2-us-west.apache.org (ASF Mail Server at spamd2-us-west.apache.org) with ESMTP id 750EA1A0248
	for <dev@httpd.apache.org>; Tue, 22 Dec 2015 05:30:43 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd2-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 2.445
X-Spam-Level: **
X-Spam-Status: No, score=2.445 tagged_above=-999 required=6.31
	tests=[HTML_MESSAGE=3, RP_MATCHES_RCVD=-0.554, SPF_HELO_PASS=-0.001,
	SPF_PASS=-0.001, URIBL_BLOCKED=0.001] autolearn=disabled
Received: from mx1-us-west.apache.org ([10.40.0.8])
	by localhost (spamd2-us-west.apache.org [10.40.0.9]) (amavisd-new, port 10024)
	with ESMTP id TUdD63NhWqNA for <dev@httpd.apache.org>;
	Tue, 22 Dec 2015 05:30:36 +0000 (UTC)
Received: from mx1.cpanel.net (mx1.cpanel.net [208.74.121.68])
	by mx1-us-west.apache.org (ASF Mail Server at mx1-us-west.apache.org) with ESMTPS id 0428320FD2
	for <dev@httpd.apache.org>; Tue, 22 Dec 2015 05:30:35 +0000 (UTC)
Received: from [208.74.121.106] (port=16471 helo=[10.1.4.91])
	by mx1.cpanel.net with esmtpsa (TLSv1:ECDHE-RSA-AES256-SHA:256)
	(Exim 4.86)
	(envelope-from <jacob.perkins@cpanel.net>)
	id 1aBFWs-0007fF-Rj
	for dev@httpd.apache.org; Mon, 21 Dec 2015 23:30:34 -0600
Content-Type: multipart/signed; boundary="Apple-Mail=_DD3CC5C7-5BC5-41C8-A8A4-F25E5F6471B4"; protocol="application/pgp-signature"; micalg=pgp-sha512
Mime-Version: 1.0 (Mac OS X Mail 9.2 \(3112\))
Subject: Re: OpenSSL 0.9.8/1.0.0 on Trunk
X-Pgp-Agent: GPGMail 2.6b2
From: Jacob Perkins <jacob.perkins@cpanel.net>
In-Reply-To: <CALK=YjMq_VZ+u1agz0oWBuFoP9QTpT2q85OxKTohLjFpzht5YQ@mail.gmail.com>
Date: Mon, 21 Dec 2015 23:30:37 -0600
Message-Id: <1E393CD7-FC49-4170-ADBA-710A9AA8AFA6@cpanel.net>
References: <CACsi253tpu-76tEXCizdgjWPmt9sfjSycuVNXDiefnBmOOnDmA@mail.gmail.com> <5670386F.5090901@oracle.com> <1CF499FD-1163-46CA-9941-5C83CD214FC1@cpanel.net> <CALK=YjP7kJDWMKLwy0ke4Hh6EHevebN3UgYSbLyK01hrFvxsZA@mail.gmail.com> <E05B0375-6FC0-4D48-B35E-956A3D95EA8B@cpanel.net> <CALK=YjMq_VZ+u1agz0oWBuFoP9QTpT2q85OxKTohLjFpzht5YQ@mail.gmail.com>
To: dev@httpd.apache.org
X-Mailer: Apple Mail (2.3112)
X-AntiAbuse: This header was added to track abuse, please include it with any abuse report
X-AntiAbuse: Primary Hostname - mx1.cpanel.net
X-AntiAbuse: Original Domain - httpd.apache.org
X-AntiAbuse: Originator/Caller UID/GID - [47 12] / [47 12]
X-AntiAbuse: Sender Address Domain - cpanel.net
X-Get-Message-Sender-Via: mx1.cpanel.net: authenticated_id: jacob.perkins@cpanel.net
X-Authenticated-Sender: mx1.cpanel.net: jacob.perkins@cpanel.net


--Apple-Mail=_DD3CC5C7-5BC5-41C8-A8A4-F25E5F6471B4
Content-Type: multipart/alternative;
	boundary="Apple-Mail=_69B66EE0-8EED-43E2-9571-F94CB4205494"


--Apple-Mail=_69B66EE0-8EED-43E2-9571-F94CB4205494
Content-Transfer-Encoding: quoted-printable
Content-Type: text/plain;
	charset=utf-8

Hi Eric,

I=E2=80=99m going to work on setting up a test system for all of our =
supported environments so that we can test our platform quicker and =
provide feedback during the T&R period.

I=E2=80=99d love to try and give back to the project honestly. cPanel =
has used Apache in the core of our webstack for at least 10 years so it =
would be great if we could provide some extra eyes for testing releases, =
if not more.

Sorry if I came across a little=E2=80=A6 crass. It=E2=80=99s been a long =
day.
=E2=80=94
Jacob Perkins
Product Owner
cPanel Inc.

jacob.perkins@cpanel.net <mailto:jacob.perkins@cpanel.net>
Office:  713-529-0800 x 4046
Cell:  713-560-8655

> On Dec 21, 2015, at 5:20 PM, Eric Covener <covener@gmail.com> wrote:
>=20
> On Mon, Dec 21, 2015 at 2:38 PM, Jacob Perkins =
<jacob.perkins@cpanel.net> wrote:
>> CentOS 5 still ships with OpenSSL 0.9.8, and is still supported for =
another
>> year or so. Considering there=E2=80=99s a lot of servers still =
running CentOS 5 (and
>> possibly older), it feels as if this would have been caught.
>=20
> Do you mean could or should have been caught?
>=20
> It wasn't caught until someone compiled it against openssl < 0.9.8m
> (which is not the latest 0.9.8).  I can't see many scenarios where =
someone
> will compile a new 2.4.x release and not have a contemporary openssl =
--
> beyond trying to catch exactly these kinds of problems during a =
release.
>=20
>> Especially something as small as a missing semicolon.
>=20
> Well, usually small problems are the ones that fly under the radar.    =
Anything
> catastrophic to the build will not go unnoticed, but someone has to =
build on the
> affected platform/compiler/prereqs/???.
>=20
>> Would a linter / compile check to proactively check those things =
help?
>=20
> Dunno, possible.


--Apple-Mail=_69B66EE0-8EED-43E2-9571-F94CB4205494
Content-Transfer-Encoding: quoted-printable
Content-Type: text/html;
	charset=utf-8

<html><head><meta http-equiv=3D"Content-Type" content=3D"text/html =
charset=3Dutf-8"></head><body style=3D"word-wrap: break-word; =
-webkit-nbsp-mode: space; -webkit-line-break: after-white-space;" =
class=3D"">Hi Eric,<div class=3D""><br class=3D""></div><div =
class=3D"">I=E2=80=99m going to work on setting up a test system for all =
of our supported environments so that we can test our platform quicker =
and provide feedback during the T&amp;R period.&nbsp;</div><div =
class=3D""><div class=3D""><div class=3D""><br =
class=3D"webkit-block-placeholder"></div><div class=3D"">I=E2=80=99d =
love to try and give back to the project honestly. cPanel has used =
Apache in the core of our webstack for at least 10 years so it would be =
great if we could provide some extra eyes for testing releases, if not =
more.</div><div class=3D""><br =
class=3D"webkit-block-placeholder"></div><div class=3D"">
<div style=3D"color: rgb(0, 0, 0); font-family: Helvetica; font-size: =
12px; font-style: normal; font-variant: normal; font-weight: normal; =
letter-spacing: normal; line-height: normal; text-align: -webkit-auto; =
text-indent: 0px; text-transform: none; white-space: normal; =
word-spacing: 0px; -webkit-text-stroke-width: 0px; orphans: 2; widows: =
2; word-wrap: break-word; -webkit-nbsp-mode: space; -webkit-line-break: =
after-white-space;" class=3D"">Sorry if I came across a little=E2=80=A6 =
crass. It=E2=80=99s been a long day.<br =
class=3D"Apple-interchange-newline">=E2=80=94</div><div style=3D"color: =
rgb(0, 0, 0); font-family: Helvetica; font-size: 12px; font-style: =
normal; font-variant: normal; font-weight: normal; letter-spacing: =
normal; line-height: normal; text-align: -webkit-auto; text-indent: 0px; =
text-transform: none; white-space: normal; word-spacing: 0px; =
-webkit-text-stroke-width: 0px; orphans: 2; widows: 2; word-wrap: =
break-word; -webkit-nbsp-mode: space; -webkit-line-break: =
after-white-space;" class=3D"">Jacob Perkins<br class=3D""></div><div =
style=3D"color: rgb(0, 0, 0); font-family: Helvetica; font-size: 12px; =
font-style: normal; font-variant: normal; font-weight: normal; =
letter-spacing: normal; line-height: normal; text-align: -webkit-auto; =
text-indent: 0px; text-transform: none; white-space: normal; =
word-spacing: 0px; -webkit-text-stroke-width: 0px; orphans: 2; widows: =
2; word-wrap: break-word; -webkit-nbsp-mode: space; -webkit-line-break: =
after-white-space;" class=3D"">Product Owner</div><div style=3D"color: =
rgb(0, 0, 0); font-family: Helvetica; font-size: 12px; font-style: =
normal; font-variant: normal; font-weight: normal; letter-spacing: =
normal; line-height: normal; text-align: -webkit-auto; text-indent: 0px; =
text-transform: none; white-space: normal; word-spacing: 0px; =
-webkit-text-stroke-width: 0px; orphans: 2; widows: 2; word-wrap: =
break-word; -webkit-nbsp-mode: space; -webkit-line-break: =
after-white-space;" class=3D""><b class=3D""><font color=3D"#ff7c00" =
class=3D"">cPanel Inc.</font></b></div><div style=3D"color: rgb(0, 0, =
0); font-family: Helvetica; font-size: 12px; font-style: normal; =
font-variant: normal; font-weight: normal; letter-spacing: normal; =
line-height: normal; text-align: -webkit-auto; text-indent: 0px; =
text-transform: none; white-space: normal; word-spacing: 0px; =
-webkit-text-stroke-width: 0px; orphans: 2; widows: 2; word-wrap: =
break-word; -webkit-nbsp-mode: space; -webkit-line-break: =
after-white-space;" class=3D""><br class=3D""></div><div style=3D"color: =
rgb(0, 0, 0); font-family: Helvetica; font-size: 12px; font-style: =
normal; font-variant: normal; font-weight: normal; letter-spacing: =
normal; line-height: normal; text-align: -webkit-auto; text-indent: 0px; =
text-transform: none; white-space: normal; word-spacing: 0px; =
-webkit-text-stroke-width: 0px; orphans: 2; widows: 2; word-wrap: =
break-word; -webkit-nbsp-mode: space; -webkit-line-break: =
after-white-space;" class=3D""><a href=3D"mailto:jacob.perkins@cpanel.net"=
 class=3D"">jacob.perkins@cpanel.net</a></div><div style=3D"color: =
rgb(0, 0, 0); font-family: Helvetica; font-size: 12px; font-style: =
normal; font-variant: normal; font-weight: normal; letter-spacing: =
normal; line-height: normal; text-align: -webkit-auto; text-indent: 0px; =
text-transform: none; white-space: normal; word-spacing: 0px; =
-webkit-text-stroke-width: 0px; orphans: 2; widows: 2; word-wrap: =
break-word; -webkit-nbsp-mode: space; -webkit-line-break: =
after-white-space;" class=3D"">Office: &nbsp;713-529-0800 =
x&nbsp;4046</div><div style=3D"color: rgb(0, 0, 0); font-family: =
Helvetica; font-size: 12px; font-style: normal; font-variant: normal; =
font-weight: normal; letter-spacing: normal; line-height: normal; =
text-align: -webkit-auto; text-indent: 0px; text-transform: none; =
white-space: normal; word-spacing: 0px; -webkit-text-stroke-width: 0px; =
orphans: 2; widows: 2; word-wrap: break-word; -webkit-nbsp-mode: space; =
-webkit-line-break: after-white-space;" class=3D"">Cell: =
&nbsp;713-560-8655</div>
</div>
<br class=3D""><div><blockquote type=3D"cite" class=3D""><div =
class=3D"">On Dec 21, 2015, at 5:20 PM, Eric Covener &lt;<a =
href=3D"mailto:covener@gmail.com" class=3D"">covener@gmail.com</a>&gt; =
wrote:</div><br class=3D"Apple-interchange-newline"><div class=3D""><div =
class=3D"">On Mon, Dec 21, 2015 at 2:38 PM, Jacob Perkins &lt;<a =
href=3D"mailto:jacob.perkins@cpanel.net" =
class=3D"">jacob.perkins@cpanel.net</a>&gt; wrote:<br =
class=3D""><blockquote type=3D"cite" class=3D"">CentOS 5 still ships =
with OpenSSL 0.9.8, and is still supported for another<br class=3D"">year =
or so. Considering there=E2=80=99s a lot of servers still running CentOS =
5 (and<br class=3D"">possibly older), it feels as if this would have =
been caught.<br class=3D""></blockquote><br class=3D"">Do you mean could =
or should have been caught?<br class=3D""><br class=3D"">It wasn't =
caught until someone compiled it against openssl &lt; 0.9.8m<br =
class=3D"">(which is not the latest 0.9.8). &nbsp;I can't see many =
scenarios where someone<br class=3D"">will compile a new 2.4.x release =
and not have a contemporary openssl --<br class=3D"">beyond trying to =
catch exactly these kinds of problems during a release.<br class=3D""><br =
class=3D""><blockquote type=3D"cite" class=3D"">Especially something as =
small as a missing semicolon.<br class=3D""></blockquote><br =
class=3D"">Well, usually small problems are the ones that fly under the =
radar. &nbsp;&nbsp;&nbsp;Anything<br class=3D"">catastrophic to the =
build will not go unnoticed, but someone has to build on the<br =
class=3D"">affected platform/compiler/prereqs/???.<br class=3D""><br =
class=3D""><blockquote type=3D"cite" class=3D"">Would a linter / compile =
check to proactively check those things help?<br =
class=3D""></blockquote><br class=3D"">Dunno, possible.<br =
class=3D""></div></div></blockquote></div><br =
class=3D""></div></div></body></html>=

--Apple-Mail=_69B66EE0-8EED-43E2-9571-F94CB4205494--

--Apple-Mail=_DD3CC5C7-5BC5-41C8-A8A4-F25E5F6471B4
Content-Transfer-Encoding: 7bit
Content-Disposition: attachment;
	filename=signature.asc
Content-Type: application/pgp-signature;
	name=signature.asc
Content-Description: Message signed with OpenPGP using GPGMail

-----BEGIN PGP SIGNATURE-----
Comment: GPGTools - https://gpgtools.org

iQEcBAEBCgAGBQJWeN/+AAoJEIo8JcFLoqwq77IH/2ISPC7Khveq1QaRU5n2mH/x
OthYiAjTXXvHyjTSJUOrlkFno5kNWm//U8n5rs5IcgIUOvV/X3XJga34weyzMWWk
rzbna6cNGkJlTEV/DQqRcf7Ko04S7w9GB2O2vxkzshc8q5dDbb3XWELMSyEw65T3
/NPMCUfFPpM2PgfIUcistFPEzts+EcjSsh+B+zMptmk+LCxbiMZCAJn4i9/0melY
lHqVSlLyDq81Vty9IOtxpWQ4+PhUjIlfJ2k4vDoXluvWYCeI7eGbXXlXApoJcmf0
Sv4TTeiFxafDmM/HAappLH+wt2eF1Jte5yYWIR5AtOhY2548B1m1fpaNy3jbx/4=
=iTvZ
-----END PGP SIGNATURE-----

--Apple-Mail=_DD3CC5C7-5BC5-41C8-A8A4-F25E5F6471B4--

From dev-return-85103-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Tue Dec 22 07:10:11 2015
Return-Path: <dev-return-85103-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 3FD8718EFB
	for <apmail-httpd-dev-archive@www.apache.org>; Tue, 22 Dec 2015 07:10:11 +0000 (UTC)
Received: (qmail 85757 invoked by uid 500); 22 Dec 2015 07:10:07 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 85684 invoked by uid 500); 22 Dec 2015 07:10:07 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 85674 invoked by uid 99); 22 Dec 2015 07:10:07 -0000
Received: from Unknown (HELO spamd2-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 22 Dec 2015 07:10:07 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd2-us-west.apache.org (ASF Mail Server at spamd2-us-west.apache.org) with ESMTP id F017F1A0261
	for <dev@httpd.apache.org>; Tue, 22 Dec 2015 07:10:06 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd2-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 0.999
X-Spam-Level:
X-Spam-Status: No, score=0.999 tagged_above=-999 required=6.31
	tests=[KAM_LAZY_DOMAIN_SECURITY=1, RCVD_IN_MSPIKE_H2=-0.001]
	autolearn=disabled
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd2-us-west.apache.org [10.40.0.9]) (amavisd-new, port 10024)
	with ESMTP id Va0c54Kt-7c2 for <dev@httpd.apache.org>;
	Tue, 22 Dec 2015 07:10:05 +0000 (UTC)
Received: from smtp.smtpout.orange.fr (smtp02.smtpout.orange.fr [80.12.242.124])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id 01E3320F5E
	for <dev@httpd.apache.org>; Tue, 22 Dec 2015 07:10:04 +0000 (UTC)
Received: from [127.0.0.1] ([92.140.236.87])
	by mwinf5d25 with ME
	id wXA31r00T1tpFd003XA4sQ; Tue, 22 Dec 2015 08:10:04 +0100
X-ME-Helo: [127.0.0.1]
X-ME-Date: Tue, 22 Dec 2015 08:10:04 +0100
X-ME-IP: 92.140.236.87
Subject: Re: [PATCH] Reduce memory footprint in mod_dav's property code
To: dev@httpd.apache.org
References: <5678958E.20608@apache.org>
From: Marion & Christophe JAILLET <christophe.jaillet@wanadoo.fr>
Message-ID: <5678F74B.9030901@wanadoo.fr>
Date: Tue, 22 Dec 2015 08:10:03 +0100
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:38.0) Gecko/20100101
 Thunderbird/38.4.0
MIME-Version: 1.0
In-Reply-To: <5678958E.20608@apache.org>
Content-Type: text/plain; charset=windows-1252; format=flowed
Content-Transfer-Encoding: 8bit
X-Antivirus: avast! (VPS 151221-2, 21/12/2015), Outbound message
X-Antivirus-Status: Clean

You can also have a look at 
https://bz.apache.org/bugzilla/show_bug.cgi?id=48130

Le 22/12/2015 01:13, Stefan Fuhrmann a crit :
> Hi,
>
> I stumbled over this while investigation an OOM report from a
> Subversion user [1].  Due to unfortunate circumstances [2], I've
> seen directory listings with a few 10000 entries eat 10s of GB
> of RAM.  Those circumstances are being addressed but the root
> cause is in mod_dav and the patch below fixes it.
>
> The problem is that dav_open_propdb creates a pool that
> dav_close_propdb can't destroy.  So, for every property, at least
> 8 KB of memory will be allocated.  If we simply use the parent
> pool as is, only a few 100 bytes will be used.
>
> Moreover, if the APR allocator should return a larger block once
> in a while, that block will get used up nicely before more memory
> is allocated.  So with this patch, the worst case will still use
> only about to 1/10th of the current best case for large collections.
>
> -- Stefan^2.
>
> [1] 
> http://mail-archives.apache.org/mod_mbox/subversion-users/201512.mbox/%3C1CEE115D02633942A40D49D447DCF46E432F3A32%40SD01CFMM0202.OMEGA.DCE-EIR.NET%3E
> [2] 
> http://mail-archives.apache.org/mod_mbox/subversion-dev/201512.mbox/%3C5676A54F.9040609%40apache.org%3E
>
>
> [[[
> Fix a pool handling asymmetry in mod_dav that caused inefficient
> memory usage with collection properties.
>
> If we can't clear nor destroy the local pool in dav_propdb, there
> is no point in creating it as a sub-pool of its parent.
>
> * modules/dav/main/props.c
>   (DAV_PROPDB_LOCAL_POOL): New compile-time switch replacing the
>                            plain "#if 0" in dav_close_propdb.  It
>                            ensures consistent behaviour between
>                            open and close in the future.
>   (dav_open_propdb): If we can't clear the pool, we may as well use
>                      its parent directly.
>   (dav_close_propdb): Use the new define.
> ]]]
>
> [[[
> Index: modules/dav/main/props.c
> ===================================================================
> --- modules/dav/main/props.c    (revision 1721073)
> +++ modules/dav/main/props.c    (working copy)
> @@ -167,6 +167,16 @@
>
>  #define DAV_EMPTY_VALUE                "\0"    /* TWO null terms */
>
> +/*
> +** Currently, mod_dav's pool usage doesn't allow clearing the pool
> +** at dav_propdb.p . Therefore, we won't create a sub-pool for it
> +** and use the request's pool directly instead.
> +**
> +** Once the pool usage issue has been fixed, set this to 1 for optimal
> +** memory usage.
> +*/
> +#define DAV_PROPDB_LOCAL_POOL          0
> +
>  struct dav_propdb {
>      apr_pool_t *p;                /* the pool we should use */
>      request_rec *r;               /* the request record */
> @@ -537,7 +547,11 @@
>  #endif
>
>      propdb->r = r;
> +#if DAV_PROPDB_LOCAL_POOL
>      apr_pool_create(&propdb->p, r->pool);
> +#else
> +    propdb->p = r->pool;
> +#endif
>      propdb->resource = resource;
>      propdb->ns_xlate = ns_xlate;
>
> @@ -562,8 +576,7 @@
>          (*propdb->db_hooks->close)(propdb->db);
>      }
>
> -    /* Currently, mod_dav's pool usage doesn't allow clearing this 
> pool. */
> -#if 0
> +#if DAV_PROPDB_LOCAL_POOL
>      apr_pool_destroy(propdb->p);
>  #endif
>  }
> ]]]
>


From dev-return-85104-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Tue Dec 22 11:06:30 2015
Return-Path: <dev-return-85104-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 810BD18BC2
	for <apmail-httpd-dev-archive@www.apache.org>; Tue, 22 Dec 2015 11:06:30 +0000 (UTC)
Received: (qmail 48606 invoked by uid 500); 22 Dec 2015 11:06:30 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 48543 invoked by uid 500); 22 Dec 2015 11:06:30 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 48524 invoked by uid 99); 22 Dec 2015 11:06:30 -0000
Received: from Unknown (HELO spamd1-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 22 Dec 2015 11:06:30 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd1-us-west.apache.org (ASF Mail Server at spamd1-us-west.apache.org) with ESMTP id 97F18C0ECC
	for <dev@httpd.apache.org>; Tue, 22 Dec 2015 11:06:29 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd1-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 2.979
X-Spam-Level: **
X-Spam-Status: No, score=2.979 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, HTML_MESSAGE=3,
	RCVD_IN_MSPIKE_H3=-0.01, RCVD_IN_MSPIKE_WL=-0.01, SPF_PASS=-0.001]
	autolearn=disabled
Authentication-Results: spamd1-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=egnyte-com.20150623.gappssmtp.com
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd1-us-west.apache.org [10.40.0.7]) (amavisd-new, port 10024)
	with ESMTP id XSpPDKUZR62b for <dev@httpd.apache.org>;
	Tue, 22 Dec 2015 11:06:29 +0000 (UTC)
Received: from mail-ig0-f179.google.com (mail-ig0-f179.google.com [209.85.213.179])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id 80D812050F
	for <dev@httpd.apache.org>; Tue, 22 Dec 2015 11:06:28 +0000 (UTC)
Received: by mail-ig0-f179.google.com with SMTP id jw2so55665057igc.1
        for <dev@httpd.apache.org>; Tue, 22 Dec 2015 03:06:28 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=egnyte-com.20150623.gappssmtp.com; s=20150623;
        h=mime-version:date:message-id:subject:from:to:content-type;
        bh=uJSh9fnpOVQ+kiAxQEcVcJorGqFOa08iMEsUrDu62jI=;
        b=nTnT7pgbxek4xSgLOIvw1r/eaPs/YYLV5gcnYADjgPZb9e8eTpRpM6X8VnXZq8qaak
         8ANNaNW31q1Fp01SwNb9aQfcZ8PYhRiXa46ZYl8WD9A/U7T4M2X9/Dmney+v4iurGlTt
         /j+vEwKXQ0LZ/y4g7+6iynn5vdaAUReIgQU+PGFbYDmFGJ8Jh10Q8q7dnQ3dcBZ8W0rX
         LGKmqjTYeqz2lwlp7j6JWy3dbXJlY5X9YQTZwteS/59+vqknBAVGoKvDUAcoG/+8ZHqx
         3QsFU9G1qWrXlRQ6juU4Ctn5C6Ut5mDaQOdZO+buw25NT4OMKeQZtNAOr/aNXLm0Ha1z
         a3BA==
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=1e100.net; s=20130820;
        h=x-gm-message-state:mime-version:date:message-id:subject:from:to
         :content-type;
        bh=uJSh9fnpOVQ+kiAxQEcVcJorGqFOa08iMEsUrDu62jI=;
        b=U4sOEV9zsVKLX4rwdR+7iBxXIJX1hf3SMDxa7tPoXwRoNB2gx3dKs2NY5HyqI2eYST
         K2ukwUm9UtJG7vyX8c6ArcTj39+dmNei2CaE0iyaJsm75F/CrjCy1YdAV2GCgc8+ppBN
         OKexZ7LALsRWIJx9ZkqbleDnaTYlc7LaEW8wiuUUq1teRN7pQP/j4ThtC2HjqH37/nHV
         81EU3dOV2vvQBJQDHlcT9g+jVbXVlXgW+zkd8rn7ZWbXeR6abiLCw1unm42FAJ2N77DM
         YMmc2V1hZAnSeE/ZdrwpfMw1Y9QjKLUzkXXh6JjKvLLiahPITYHM2wRDABQc9aySY0ZN
         5o9w==
X-Gm-Message-State: ALoCoQkc3g96UkxWJ/okwLXweTJZtUDH1bCu9ZadBswYa6vUg/r767sDkBONoo/MtPv/XVy+JQT6DU2u2IgchoSHHzQMPxmgddGj5SNjbm5LcHreDudq+yk=
MIME-Version: 1.0
X-Received: by 10.50.65.39 with SMTP id u7mr23971660igs.85.1450782387117; Tue,
 22 Dec 2015 03:06:27 -0800 (PST)
Received: by 10.36.194.193 with HTTP; Tue, 22 Dec 2015 03:06:27 -0800 (PST)
Date: Tue, 22 Dec 2015 12:06:27 +0100
Message-ID: <CAECPfcxqzH7vbFcO_+ak9vudpVuxAq49fRrNGZuNUZ1X2-1GiA@mail.gmail.com>
Subject: Bugzilla has no version 2.4.18
From: Daniil Iaitskov <diaitskov@egnyte.com>
To: dev@httpd.apache.org
Content-Type: multipart/alternative; boundary=047d7b2e1455d4c97605277a98f2

--047d7b2e1455d4c97605277a98f2
Content-Type: text/plain; charset=UTF-8

Hi,


-- 


Daneel Yaitskov

--047d7b2e1455d4c97605277a98f2
Content-Type: text/html; charset=UTF-8
Content-Transfer-Encoding: quoted-printable

<div dir=3D"ltr">Hi,<div><br clear=3D"all"><div><br></div>-- <br><div class=
=3D"gmail_signature"><div dir=3D"ltr"><div><div dir=3D"ltr"><br><div><br></=
div><div>Daneel Yaitskov</div><div>=C2=A0</div></div></div></div></div>
</div></div>

--047d7b2e1455d4c97605277a98f2--

From dev-return-85105-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Tue Dec 22 11:42:10 2015
Return-Path: <dev-return-85105-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 1868F18CCD
	for <apmail-httpd-dev-archive@www.apache.org>; Tue, 22 Dec 2015 11:42:10 +0000 (UTC)
Received: (qmail 12589 invoked by uid 500); 22 Dec 2015 11:42:00 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 12512 invoked by uid 500); 22 Dec 2015 11:42:00 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 12502 invoked by uid 99); 22 Dec 2015 11:42:00 -0000
Received: from Unknown (HELO spamd4-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 22 Dec 2015 11:42:00 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd4-us-west.apache.org (ASF Mail Server at spamd4-us-west.apache.org) with ESMTP id 03108C083B
	for <dev@httpd.apache.org>; Tue, 22 Dec 2015 11:42:00 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd4-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.555
X-Spam-Level:
X-Spam-Status: No, score=-0.555 tagged_above=-999 required=6.31
	tests=[RP_MATCHES_RCVD=-0.554, SPF_PASS=-0.001] autolearn=disabled
Received: from mx1-us-west.apache.org ([10.40.0.8])
	by localhost (spamd4-us-west.apache.org [10.40.0.11]) (amavisd-new, port 10024)
	with ESMTP id Bo630ULU-4Cf for <dev@httpd.apache.org>;
	Tue, 22 Dec 2015 11:41:58 +0000 (UTC)
Received: from mailserver.kippdata.de (capsella.kippdata.de [195.227.30.149])
	by mx1-us-west.apache.org (ASF Mail Server at mx1-us-west.apache.org) with ESMTP id 6B4EA20270
	for <dev@httpd.apache.org>; Tue, 22 Dec 2015 11:41:58 +0000 (UTC)
Received: from [10.0.110.6] ([192.168.2.104])
	by mailserver.kippdata.de (8.13.5/8.13.5) with ESMTP id tBMBfoCt012615
	for <dev@httpd.apache.org>; Tue, 22 Dec 2015 12:41:50 +0100 (CET)
Subject: Re: Bugzilla has no version 2.4.18
To: dev@httpd.apache.org
References: <CAECPfcxqzH7vbFcO_+ak9vudpVuxAq49fRrNGZuNUZ1X2-1GiA@mail.gmail.com>
From: Rainer Jung <rainer.jung@kippdata.de>
Message-ID: <567936FC.5060208@kippdata.de>
Date: Tue, 22 Dec 2015 12:41:48 +0100
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:38.0) Gecko/20100101
 Thunderbird/38.4.0
MIME-Version: 1.0
In-Reply-To: <CAECPfcxqzH7vbFcO_+ak9vudpVuxAq49fRrNGZuNUZ1X2-1GiA@mail.gmail.com>
Content-Type: text/plain; charset=utf-8; format=flowed
Content-Transfer-Encoding: 7bit

Done, thanks for the reminder.

Rainer

From dev-return-85106-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Tue Dec 22 16:32:37 2015
Return-Path: <dev-return-85106-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id B5516187BA
	for <apmail-httpd-dev-archive@www.apache.org>; Tue, 22 Dec 2015 16:32:37 +0000 (UTC)
Received: (qmail 35874 invoked by uid 500); 22 Dec 2015 16:32:36 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 35803 invoked by uid 500); 22 Dec 2015 16:32:36 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 35793 invoked by uid 99); 22 Dec 2015 16:32:36 -0000
Received: from Unknown (HELO spamd2-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 22 Dec 2015 16:32:36 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd2-us-west.apache.org (ASF Mail Server at spamd2-us-west.apache.org) with ESMTP id 13CCF1A016B
	for <dev@httpd.apache.org>; Tue, 22 Dec 2015 16:32:36 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd2-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.555
X-Spam-Level:
X-Spam-Status: No, score=-0.555 tagged_above=-999 required=6.31
	tests=[RP_MATCHES_RCVD=-0.554, SPF_PASS=-0.001] autolearn=disabled
Received: from mx1-us-west.apache.org ([10.40.0.8])
	by localhost (spamd2-us-west.apache.org [10.40.0.9]) (amavisd-new, port 10024)
	with ESMTP id ke41J0C1EDyz for <dev@httpd.apache.org>;
	Tue, 22 Dec 2015 16:32:34 +0000 (UTC)
Received: from mailserver.kippdata.de (capsella.kippdata.de [195.227.30.149])
	by mx1-us-west.apache.org (ASF Mail Server at mx1-us-west.apache.org) with ESMTP id ED75320F86
	for <dev@httpd.apache.org>; Tue, 22 Dec 2015 16:32:33 +0000 (UTC)
Received: from [10.0.110.6] ([192.168.2.104])
	by mailserver.kippdata.de (8.13.5/8.13.5) with ESMTP id tBMGWWQ6014244
	for <dev@httpd.apache.org>; Tue, 22 Dec 2015 17:32:32 +0100 (CET)
Subject: Re: [ANNOUNCEMENT] Apache HTTP Server 2.4.18 Released
To: dev@httpd.apache.org
References: <8041A12E-76B4-406E-B2D2-C15F8BF82EDF@jaguNET.com>
From: Rainer Jung <rainer.jung@kippdata.de>
Message-ID: <56797B1E.9020706@kippdata.de>
Date: Tue, 22 Dec 2015 17:32:30 +0100
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:38.0) Gecko/20100101
 Thunderbird/38.4.0
MIME-Version: 1.0
In-Reply-To: <8041A12E-76B4-406E-B2D2-C15F8BF82EDF@jaguNET.com>
Content-Type: text/plain; charset=utf-8; format=flowed
Content-Transfer-Encoding: 7bit

It looks like the announcement never made it to the ASF accouncement 
list? The same was true for 2.4.17 but 2.4.16 was announced on that list 
too.

Does it make sense to send the announcement there. Of course it has a 
unusual delay now but some people might rely on that channel for the info.

Regards,

Rainer

Am 14.12.2015 um 21:09 schrieb Jim Jagielski:
>              Apache HTTP Server 2.4.18 Released
>
> The Apache Software Foundation and the Apache HTTP Server Project
> are pleased to announce the release of version 2.4.18 of the Apache
> HTTP Server ("Apache").  This version of Apache is our latest GA
> release of the new generation 2.4.x branch of Apache HTTPD and
> represents fifteen years of innovation by the project, and is
> recommended over all previous releases. This release of Apache is
> principally a feature and bug fix release.
>
> We consider this release to be the best version of Apache available, and
> encourage users of all prior versions to upgrade.
>
> Apache HTTP Server 2.4.18 is available for download from:
>
>   http://httpd.apache.org/download.cgi
>
> Apache 2.4 offers numerous enhancements, improvements, and performance
> boosts over the 2.2 codebase.  For an overview of new features
> introduced since 2.4 please see:
>
>   http://httpd.apache.org/docs/trunk/new_features_2_4.html
>
> Please see the CHANGES_2.4 file, linked from the download page, for a
> full list of changes. A condensed list, CHANGES_2.4.18 includes only
> those changes introduced since the prior 2.4 release.  A summary of all
> of the security vulnerabilities addressed in this and earlier releases
> is available:
>
>   http://httpd.apache.org/security/vulnerabilities_24.html
>
> This release requires the Apache Portable Runtime (APR) version 1.5.x
> and APR-Util version 1.5.x. The APR libraries must be upgraded for all
> features of httpd to operate correctly.
>
> This release builds on and extends the Apache 2.2 API.  Modules written
> for Apache 2.2 will need to be recompiled in order to run with Apache
> 2.4, and require minimal or no source code changes.
>
>   http://svn.apache.org/repos/asf/httpd/httpd/trunk/VERSIONING
>
> When upgrading or installing this version of Apache, please bear in mind
> that if you intend to use Apache with one of the threaded MPMs (other
> than the Prefork MPM), you must ensure that any modules you will be
> using (and the libraries they depend on) are thread-safe.

From dev-return-85107-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Tue Dec 22 21:03:03 2015
Return-Path: <dev-return-85107-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id E2D60185B7
	for <apmail-httpd-dev-archive@www.apache.org>; Tue, 22 Dec 2015 21:03:03 +0000 (UTC)
Received: (qmail 92637 invoked by uid 500); 22 Dec 2015 21:03:03 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 92575 invoked by uid 500); 22 Dec 2015 21:03:03 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 92565 invoked by uid 99); 22 Dec 2015 21:03:03 -0000
Received: from Unknown (HELO spamd3-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 22 Dec 2015 21:03:03 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd3-us-west.apache.org (ASF Mail Server at spamd3-us-west.apache.org) with ESMTP id D75D4180583
	for <dev@httpd.apache.org>; Tue, 22 Dec 2015 21:03:02 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd3-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 0.653
X-Spam-Level:
X-Spam-Status: No, score=0.653 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, SPF_NEUTRAL=0.652,
	URIBL_BLOCKED=0.001] autolearn=disabled
Authentication-Results: spamd3-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=comcast.net
Received: from mx1-us-west.apache.org ([10.40.0.8])
	by localhost (spamd3-us-west.apache.org [10.40.0.10]) (amavisd-new, port 10024)
	with ESMTP id XUvY1NcNfJnv for <dev@httpd.apache.org>;
	Tue, 22 Dec 2015 21:02:54 +0000 (UTC)
Received: from resqmta-ch2-02v.sys.comcast.net (resqmta-ch2-02v.sys.comcast.net [69.252.207.34])
	by mx1-us-west.apache.org (ASF Mail Server at mx1-us-west.apache.org) with ESMTPS id E022A23032
	for <dev@httpd.apache.org>; Tue, 22 Dec 2015 21:02:53 +0000 (UTC)
Received: from resomta-ch2-13v.sys.comcast.net ([69.252.207.109])
	by resqmta-ch2-02v.sys.comcast.net with comcast
	id wl2K1r0012N9P4d01l2nJY; Tue, 22 Dec 2015 21:02:47 +0000
Received: from [192.168.199.10] ([69.251.84.114])
	by resomta-ch2-13v.sys.comcast.net with comcast
	id wl2m1r00T2U0RYt01l2mqu; Tue, 22 Dec 2015 21:02:47 +0000
Content-Type: text/plain; charset=us-ascii
Mime-Version: 1.0 (Mac OS X Mail 9.2 \(3112\))
Subject: Re: [ANNOUNCEMENT] Apache HTTP Server 2.4.18 Released
From: Jim Jagielski <jim@jaguNET.com>
In-Reply-To: <56797B1E.9020706@kippdata.de>
Date: Tue, 22 Dec 2015 16:02:46 -0500
Content-Transfer-Encoding: quoted-printable
Message-Id: <E41265AC-D8CC-4B59-B0AB-7AB7C195862E@jaguNET.com>
References: <8041A12E-76B4-406E-B2D2-C15F8BF82EDF@jaguNET.com> <56797B1E.9020706@kippdata.de>
To: dev@httpd.apache.org
X-Mailer: Apple Mail (2.3112)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=comcast.net;
	s=q20140121; t=1450818167;
	bh=McN9vdoDbrKiTnSiFGg9wY4nWyW7YRHOS5dSkpFG2oc=;
	h=Received:Received:Content-Type:Mime-Version:Subject:From:Date:
	 Message-Id:To;
	b=TULcENu/3RrX9FdiEf7n4p7s6FK1e+DEPgrengyz5Thds4z/IWXjEib1Pil6ZKh4l
	 +CVHMH+qSccAZri/qtlzhmrPGubb6Ygye24wcKfdCh6WGSiRcgY01V3cc+/gFPOZF8
	 OilN5grT6sqLJZbw1DNH8O0FeRsJ6zE+pn08nNT3SCg7n8uJ7pHoM9mzGqo4jZMa03
	 xFnlMhI1Au0gtxr4UzXt4Kxybcf5Bt1Dc6W/imkzuBQvkEb4IbpiUCNme51crz4pr2
	 8AbVenQnn3j60iZ9CyYwBLFSsJWWzcD5qNDG+66o/Y/dWgMq6Ymcj36X6xYkQHSsne
	 SCYuWX/RMhsZQ==

It was sent to both announce@a.o as well as announce@h.a.o

And sent w/ my jim@a.o address, as required.
> On Dec 22, 2015, at 11:32 AM, Rainer Jung <rainer.jung@kippdata.de> =
wrote:
>=20
> It looks like the announcement never made it to the ASF accouncement =
list? The same was true for 2.4.17 but 2.4.16 was announced on that list =
too.
>=20
> Does it make sense to send the announcement there. Of course it has a =
unusual delay now but some people might rely on that channel for the =
info.
>=20
> Regards,
>=20
> Rainer
>=20
> Am 14.12.2015 um 21:09 schrieb Jim Jagielski:
>>             Apache HTTP Server 2.4.18 Released
>>=20
>> The Apache Software Foundation and the Apache HTTP Server Project
>> are pleased to announce the release of version 2.4.18 of the Apache
>> HTTP Server ("Apache").  This version of Apache is our latest GA
>> release of the new generation 2.4.x branch of Apache HTTPD and
>> represents fifteen years of innovation by the project, and is
>> recommended over all previous releases. This release of Apache is
>> principally a feature and bug fix release.
>>=20
>> We consider this release to be the best version of Apache available, =
and
>> encourage users of all prior versions to upgrade.
>>=20
>> Apache HTTP Server 2.4.18 is available for download from:
>>=20
>>  http://httpd.apache.org/download.cgi
>>=20
>> Apache 2.4 offers numerous enhancements, improvements, and =
performance
>> boosts over the 2.2 codebase.  For an overview of new features
>> introduced since 2.4 please see:
>>=20
>>  http://httpd.apache.org/docs/trunk/new_features_2_4.html
>>=20
>> Please see the CHANGES_2.4 file, linked from the download page, for a
>> full list of changes. A condensed list, CHANGES_2.4.18 includes only
>> those changes introduced since the prior 2.4 release.  A summary of =
all
>> of the security vulnerabilities addressed in this and earlier =
releases
>> is available:
>>=20
>>  http://httpd.apache.org/security/vulnerabilities_24.html
>>=20
>> This release requires the Apache Portable Runtime (APR) version 1.5.x
>> and APR-Util version 1.5.x. The APR libraries must be upgraded for =
all
>> features of httpd to operate correctly.
>>=20
>> This release builds on and extends the Apache 2.2 API.  Modules =
written
>> for Apache 2.2 will need to be recompiled in order to run with Apache
>> 2.4, and require minimal or no source code changes.
>>=20
>>  http://svn.apache.org/repos/asf/httpd/httpd/trunk/VERSIONING
>>=20
>> When upgrading or installing this version of Apache, please bear in =
mind
>> that if you intend to use Apache with one of the threaded MPMs (other
>> than the Prefork MPM), you must ensure that any modules you will be
>> using (and the libraries they depend on) are thread-safe.


From dev-return-85108-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Tue Dec 22 21:23:23 2015
Return-Path: <dev-return-85108-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 36102186A4
	for <apmail-httpd-dev-archive@www.apache.org>; Tue, 22 Dec 2015 21:23:23 +0000 (UTC)
Received: (qmail 71903 invoked by uid 500); 22 Dec 2015 21:23:22 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 71826 invoked by uid 500); 22 Dec 2015 21:23:22 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 71816 invoked by uid 99); 22 Dec 2015 21:23:22 -0000
Received: from Unknown (HELO spamd4-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 22 Dec 2015 21:23:22 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd4-us-west.apache.org (ASF Mail Server at spamd4-us-west.apache.org) with ESMTP id 49F05C0185
	for <dev@httpd.apache.org>; Tue, 22 Dec 2015 21:23:22 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd4-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 3
X-Spam-Level: ***
X-Spam-Status: No, score=3 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, HTML_MESSAGE=3,
	SPF_PASS=-0.001, URIBL_BLOCKED=0.001] autolearn=disabled
Authentication-Results: spamd4-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=rowe-clan-net.20150623.gappssmtp.com
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd4-us-west.apache.org [10.40.0.11]) (amavisd-new, port 10024)
	with ESMTP id YSIjOm2G7for for <dev@httpd.apache.org>;
	Tue, 22 Dec 2015 21:23:12 +0000 (UTC)
Received: from mail-io0-f172.google.com (mail-io0-f172.google.com [209.85.223.172])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id 33EA5203BC
	for <dev@httpd.apache.org>; Tue, 22 Dec 2015 21:23:12 +0000 (UTC)
Received: by mail-io0-f172.google.com with SMTP id q126so198872867iof.2
        for <dev@httpd.apache.org>; Tue, 22 Dec 2015 13:23:12 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=rowe-clan-net.20150623.gappssmtp.com; s=20150623;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        bh=JcpqsZJRoSBkB3o/99GTqi/zb0QBQR56NmA7kuId1dQ=;
        b=bT4SyUUwIIhCtiE37DfsP38plBd4+4DvjuFE9q6PjdCoYtzluAnux1TV/kOns3T+wr
         mAaHVSqwMi/FEyzb/p/tBhj5H+G0BXnqsLY2BWKV8WSpm7dWmka7SNdAJ7wOG18eF4vU
         oOQywaIvjK64p5Tl/3Kfw7MzqHn4Del7fr+mdsv1uO25gYnwFOmuUQrdJ3ilGV5UhcwE
         eKqaqKzcobX2dIvRLNvIPs0C/9peC2p2mqU51f04fmjFYnoKhlSkgDPQ+MLLxZYKsIPX
         iyC39GHlVdZd4jT5yuA23cyxtc9J42dapCOMcsIj65ZC6hwezo5lUgV7HOdv+w87Pdsh
         LT1A==
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=1e100.net; s=20130820;
        h=x-gm-message-state:mime-version:in-reply-to:references:date
         :message-id:subject:from:to:content-type;
        bh=JcpqsZJRoSBkB3o/99GTqi/zb0QBQR56NmA7kuId1dQ=;
        b=iL2peWkGzBtbS1XHpO5A83Yout/znlQELkY20EVYDzD+jLXiOJLxRgyWLc27645GUe
         QxA++Hf/HidujfeAkYmRWKnYnsfZEtxybmaOdnfNy8ZC3ALssbhxoFEbuqA+P5sCFsD3
         2d6A0Zl/IIRb/CI81YtG3LwieD2Dnq2LCrBHrTl0fwwY13KSAq++i1QiJVxYlvmQRWqC
         8R2++RFRBodw7jHKPLkO9rLTbFvEK9wd4B1TYeTtfRchlKSsda43ttUInq3o97NAdXFX
         l9x8PILZKfbPtYanwsGuXgJtr1QpE/aVgjXXC2jJz050J1d0eQhP+ipL8QkeJBT0xOF2
         nAkQ==
X-Gm-Message-State: ALoCoQltk7Am6jpTH5neQYHJSCBOpvtq/vPPK7TQtGgf4SQ7k09rs6fSmdpAVBC4kZtn5xXXWr9py7bm8nDk1Ivz3IADAF3JaGqFrIf2lStfiTCmsCBdJcE=
MIME-Version: 1.0
X-Received: by 10.107.34.133 with SMTP id i127mr17074430ioi.150.1450819385122;
 Tue, 22 Dec 2015 13:23:05 -0800 (PST)
Received: by 10.107.62.69 with HTTP; Tue, 22 Dec 2015 13:23:05 -0800 (PST)
In-Reply-To: <E41265AC-D8CC-4B59-B0AB-7AB7C195862E@jaguNET.com>
References: <8041A12E-76B4-406E-B2D2-C15F8BF82EDF@jaguNET.com>
	<56797B1E.9020706@kippdata.de>
	<E41265AC-D8CC-4B59-B0AB-7AB7C195862E@jaguNET.com>
Date: Tue, 22 Dec 2015 15:23:05 -0600
Message-ID: <CACsi251JAN6hqrxd6LhzVN2wP_aZAENBADXBtUWVewLs9wDCxQ@mail.gmail.com>
Subject: Re: [ANNOUNCEMENT] Apache HTTP Server 2.4.18 Released
From: William A Rowe Jr <wrowe@rowe-clan.net>
To: httpd <dev@httpd.apache.org>
Content-Type: multipart/alternative; boundary=001a1140ef84157eab0527833687

--001a1140ef84157eab0527833687
Content-Type: text/plain; charset=UTF-8

All a@a.o must be moderated (from non-@apache addresses it hits
the bit bucket).  Enjoying some time with kids and dealing with only
critical work email so this one escaped my attention, but if another
ASF member wanted to moderate, volunteers are always welcome.
Usually I catch these within the hour, but not always.



On Tue, Dec 22, 2015 at 3:02 PM, Jim Jagielski <jim@jagunet.com> wrote:

> It was sent to both announce@a.o as well as announce@h.a.o
>
> And sent w/ my jim@a.o address, as required.
> > On Dec 22, 2015, at 11:32 AM, Rainer Jung <rainer.jung@kippdata.de>
> wrote:
> >
> > It looks like the announcement never made it to the ASF accouncement
> list? The same was true for 2.4.17 but 2.4.16 was announced on that list
> too.
> >
> > Does it make sense to send the announcement there. Of course it has a
> unusual delay now but some people might rely on that channel for the info.
> >
> > Regards,
> >
> > Rainer
> >
> > Am 14.12.2015 um 21:09 schrieb Jim Jagielski:
> >>             Apache HTTP Server 2.4.18 Released
> >>
> >> The Apache Software Foundation and the Apache HTTP Server Project
> >> are pleased to announce the release of version 2.4.18 of the Apache
> >> HTTP Server ("Apache").  This version of Apache is our latest GA
> >> release of the new generation 2.4.x branch of Apache HTTPD and
> >> represents fifteen years of innovation by the project, and is
> >> recommended over all previous releases. This release of Apache is
> >> principally a feature and bug fix release.
> >>
> >> We consider this release to be the best version of Apache available, and
> >> encourage users of all prior versions to upgrade.
> >>
> >> Apache HTTP Server 2.4.18 is available for download from:
> >>
> >>  http://httpd.apache.org/download.cgi
> >>
> >> Apache 2.4 offers numerous enhancements, improvements, and performance
> >> boosts over the 2.2 codebase.  For an overview of new features
> >> introduced since 2.4 please see:
> >>
> >>  http://httpd.apache.org/docs/trunk/new_features_2_4.html
> >>
> >> Please see the CHANGES_2.4 file, linked from the download page, for a
> >> full list of changes. A condensed list, CHANGES_2.4.18 includes only
> >> those changes introduced since the prior 2.4 release.  A summary of all
> >> of the security vulnerabilities addressed in this and earlier releases
> >> is available:
> >>
> >>  http://httpd.apache.org/security/vulnerabilities_24.html
> >>
> >> This release requires the Apache Portable Runtime (APR) version 1.5.x
> >> and APR-Util version 1.5.x. The APR libraries must be upgraded for all
> >> features of httpd to operate correctly.
> >>
> >> This release builds on and extends the Apache 2.2 API.  Modules written
> >> for Apache 2.2 will need to be recompiled in order to run with Apache
> >> 2.4, and require minimal or no source code changes.
> >>
> >>  http://svn.apache.org/repos/asf/httpd/httpd/trunk/VERSIONING
> >>
> >> When upgrading or installing this version of Apache, please bear in mind
> >> that if you intend to use Apache with one of the threaded MPMs (other
> >> than the Prefork MPM), you must ensure that any modules you will be
> >> using (and the libraries they depend on) are thread-safe.
>
>

--001a1140ef84157eab0527833687
Content-Type: text/html; charset=UTF-8
Content-Transfer-Encoding: quoted-printable

<div dir=3D"ltr">All a@a.o must be moderated (from non-@apache addresses it=
 hits<div>the bit bucket).=C2=A0 Enjoying some time with kids and dealing w=
ith only</div><div>critical work email so this one escaped my attention, bu=
t if another</div><div>ASF member wanted to moderate, volunteers are always=
 welcome.</div><div>Usually I catch these within the hour, but not always.<=
/div><div><br></div><div><br></div></div><div class=3D"gmail_extra"><br><di=
v class=3D"gmail_quote">On Tue, Dec 22, 2015 at 3:02 PM, Jim Jagielski <spa=
n dir=3D"ltr">&lt;<a href=3D"mailto:jim@jagunet.com" target=3D"_blank">jim@=
jagunet.com</a>&gt;</span> wrote:<br><blockquote class=3D"gmail_quote" styl=
e=3D"margin:0 0 0 .8ex;border-left:1px #ccc solid;padding-left:1ex">It was =
sent to both announce@a.o as well as announce@h.a.o<br>
<br>
And sent w/ my jim@a.o address, as required.<br>
<div class=3D"HOEnZb"><div class=3D"h5">&gt; On Dec 22, 2015, at 11:32 AM, =
Rainer Jung &lt;<a href=3D"mailto:rainer.jung@kippdata.de">rainer.jung@kipp=
data.de</a>&gt; wrote:<br>
&gt;<br>
&gt; It looks like the announcement never made it to the ASF accouncement l=
ist? The same was true for 2.4.17 but 2.4.16 was announced on that list too=
.<br>
&gt;<br>
&gt; Does it make sense to send the announcement there. Of course it has a =
unusual delay now but some people might rely on that channel for the info.<=
br>
&gt;<br>
&gt; Regards,<br>
&gt;<br>
&gt; Rainer<br>
&gt;<br>
&gt; Am 14.12.2015 um 21:09 schrieb Jim Jagielski:<br>
&gt;&gt;=C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0 =C2=A0Apache HTTP Server =
2.4.18 Released<br>
&gt;&gt;<br>
&gt;&gt; The Apache Software Foundation and the Apache HTTP Server Project<=
br>
&gt;&gt; are pleased to announce the release of version 2.4.18 of the Apach=
e<br>
&gt;&gt; HTTP Server (&quot;Apache&quot;).=C2=A0 This version of Apache is =
our latest GA<br>
&gt;&gt; release of the new generation 2.4.x branch of Apache HTTPD and<br>
&gt;&gt; represents fifteen years of innovation by the project, and is<br>
&gt;&gt; recommended over all previous releases. This release of Apache is<=
br>
&gt;&gt; principally a feature and bug fix release.<br>
&gt;&gt;<br>
&gt;&gt; We consider this release to be the best version of Apache availabl=
e, and<br>
&gt;&gt; encourage users of all prior versions to upgrade.<br>
&gt;&gt;<br>
&gt;&gt; Apache HTTP Server 2.4.18 is available for download from:<br>
&gt;&gt;<br>
&gt;&gt;=C2=A0 <a href=3D"http://httpd.apache.org/download.cgi" rel=3D"nore=
ferrer" target=3D"_blank">http://httpd.apache.org/download.cgi</a><br>
&gt;&gt;<br>
&gt;&gt; Apache 2.4 offers numerous enhancements, improvements, and perform=
ance<br>
&gt;&gt; boosts over the 2.2 codebase.=C2=A0 For an overview of new feature=
s<br>
&gt;&gt; introduced since 2.4 please see:<br>
&gt;&gt;<br>
&gt;&gt;=C2=A0 <a href=3D"http://httpd.apache.org/docs/trunk/new_features_2=
_4.html" rel=3D"noreferrer" target=3D"_blank">http://httpd.apache.org/docs/=
trunk/new_features_2_4.html</a><br>
&gt;&gt;<br>
&gt;&gt; Please see the CHANGES_2.4 file, linked from the download page, fo=
r a<br>
&gt;&gt; full list of changes. A condensed list, CHANGES_2.4.18 includes on=
ly<br>
&gt;&gt; those changes introduced since the prior 2.4 release.=C2=A0 A summ=
ary of all<br>
&gt;&gt; of the security vulnerabilities addressed in this and earlier rele=
ases<br>
&gt;&gt; is available:<br>
&gt;&gt;<br>
&gt;&gt;=C2=A0 <a href=3D"http://httpd.apache.org/security/vulnerabilities_=
24.html" rel=3D"noreferrer" target=3D"_blank">http://httpd.apache.org/secur=
ity/vulnerabilities_24.html</a><br>
&gt;&gt;<br>
&gt;&gt; This release requires the Apache Portable Runtime (APR) version 1.=
5.x<br>
&gt;&gt; and APR-Util version 1.5.x. The APR libraries must be upgraded for=
 all<br>
&gt;&gt; features of httpd to operate correctly.<br>
&gt;&gt;<br>
&gt;&gt; This release builds on and extends the Apache 2.2 API.=C2=A0 Modul=
es written<br>
&gt;&gt; for Apache 2.2 will need to be recompiled in order to run with Apa=
che<br>
&gt;&gt; 2.4, and require minimal or no source code changes.<br>
&gt;&gt;<br>
&gt;&gt;=C2=A0 <a href=3D"http://svn.apache.org/repos/asf/httpd/httpd/trunk=
/VERSIONING" rel=3D"noreferrer" target=3D"_blank">http://svn.apache.org/rep=
os/asf/httpd/httpd/trunk/VERSIONING</a><br>
&gt;&gt;<br>
&gt;&gt; When upgrading or installing this version of Apache, please bear i=
n mind<br>
&gt;&gt; that if you intend to use Apache with one of the threaded MPMs (ot=
her<br>
&gt;&gt; than the Prefork MPM), you must ensure that any modules you will b=
e<br>
&gt;&gt; using (and the libraries they depend on) are thread-safe.<br>
<br>
</div></div></blockquote></div><br></div>

--001a1140ef84157eab0527833687--

From dev-return-85109-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Tue Dec 22 21:25:42 2015
Return-Path: <dev-return-85109-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id C3E7B186C8
	for <apmail-httpd-dev-archive@www.apache.org>; Tue, 22 Dec 2015 21:25:42 +0000 (UTC)
Received: (qmail 75675 invoked by uid 500); 22 Dec 2015 21:25:42 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 75611 invoked by uid 500); 22 Dec 2015 21:25:42 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 75601 invoked by uid 99); 22 Dec 2015 21:25:42 -0000
Received: from Unknown (HELO spamd3-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 22 Dec 2015 21:25:42 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd3-us-west.apache.org (ASF Mail Server at spamd3-us-west.apache.org) with ESMTP id D12C0180583
	for <dev@httpd.apache.org>; Tue, 22 Dec 2015 21:25:41 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd3-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 2.998
X-Spam-Level: **
X-Spam-Status: No, score=2.998 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, HTML_MESSAGE=3,
	RCVD_IN_MSPIKE_H2=-0.001, SPF_PASS=-0.001] autolearn=disabled
Authentication-Results: spamd3-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=rowe-clan-net.20150623.gappssmtp.com
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd3-us-west.apache.org [10.40.0.10]) (amavisd-new, port 10024)
	with ESMTP id DFaKXf6ClM_r for <dev@httpd.apache.org>;
	Tue, 22 Dec 2015 21:25:41 +0000 (UTC)
Received: from mail-io0-f172.google.com (mail-io0-f172.google.com [209.85.223.172])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id ACAF7439D3
	for <dev@httpd.apache.org>; Tue, 22 Dec 2015 21:25:40 +0000 (UTC)
Received: by mail-io0-f172.google.com with SMTP id o67so198940839iof.3
        for <dev@httpd.apache.org>; Tue, 22 Dec 2015 13:25:40 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=rowe-clan-net.20150623.gappssmtp.com; s=20150623;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :cc:content-type;
        bh=uRRhzPc/hJAm6HArxTxcbuqcMUzBH9cFK+XyLEmwpOk=;
        b=u20hkFzEhEBRoIWlJa28cyEXZDLA/Rs7gsv41Ou5bPUBuoexfdO6s0x2J1SzuKVk98
         019IGxmcu9iHEdRBQJUoR5gG0kJ+bPXJc2m6VI/qPXlMWQOkIQ6zR9ejOwzJFDe3dOd2
         NQeeR32mN5hPT4yz+yNjOWKy7f39S8emH9xzBpOHC23ebP5GaR0RuRwQMCUjQIjTsKao
         lkvChOBsO56F/a4NTBa5GEZorzajgciy6VAnZDfTgakFDiB4dRH1kGskbp417B5LDXPr
         DHtMbnpc0r/E0/XKZuO+cBouUSMhU2czuneGbBitNXMFwFIL2AzotSnGXTG6xY+vtaNv
         02mg==
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=1e100.net; s=20130820;
        h=x-gm-message-state:mime-version:in-reply-to:references:date
         :message-id:subject:from:to:cc:content-type;
        bh=uRRhzPc/hJAm6HArxTxcbuqcMUzBH9cFK+XyLEmwpOk=;
        b=QGEab0TrVSVbOwHNLTwToDrPIt0dbNK002wUUxAlh9C0+YroyKUkSTfb3JX61luw1V
         gvcwixhi0a6+MDTnBYxuNBkN1NNL45C1XNPIfFdfTL3/hUs4I/Lfnr2aWYGRQhg3GvQg
         2lG82XqQBEhxq1t17MVyJ5WGrz7nHmnJT+lc4RWgb1j7/0O3+XUM/piODZdfxdxY4vW+
         JMV7LVMnRYZv4Ml2utXGvygVUk2VgfSPOJRges4wUZtOTOiGnguT5Ho5qGN1nHdNsEd8
         YyAiKuKLv+YaONso7S9QCD128V3Oi3wKk0l5e0snDTnhuAWldCGXr4tZV5L5WkBGDOYx
         4f2Q==
X-Gm-Message-State: ALoCoQnFv3aNGYW7baYEA3OenbuFdansAL/V0wdXLUrZRxPl18FbRJQw4og9X+EUe5MlzTClZiTCYsxty94Mrg9choVvUSksnunZCwhRSuElvHSm75tymX4=
MIME-Version: 1.0
X-Received: by 10.107.34.133 with SMTP id i127mr17085770ioi.150.1450819540321;
 Tue, 22 Dec 2015 13:25:40 -0800 (PST)
Received: by 10.107.62.69 with HTTP; Tue, 22 Dec 2015 13:25:40 -0800 (PST)
In-Reply-To: <567839AC.3090204@oracle.com>
References: <20151221105439.52F9E3A0051@svn01-us-west.apache.org>
	<567839AC.3090204@oracle.com>
Date: Tue, 22 Dec 2015 15:25:40 -0600
Message-ID: <CACsi252y8=rGBoc=+NNRQ7Mm_qWZc77EKGzuUshbvMxv_VQ52w@mail.gmail.com>
Subject: Re: svn commit: r1721121 - in /httpd/httpd/trunk/modules/http2:
 h2_h2.c h2_io.c h2_io.h h2_mplx.h h2_push.c h2_request.c h2_request.h
 h2_session.c h2_session.h h2_stream.c h2_stream.h h2_task.c h2_task.h
 h2_task_output.h h2_worker.h h2_workers.h
From: William A Rowe Jr <wrowe@rowe-clan.net>
To: httpd <dev@httpd.apache.org>
Cc: cvs@httpd.apache.org
Content-Type: multipart/alternative; boundary=001a1140ef8455c68c0527833f72

--001a1140ef8455c68c0527833f72
Content-Type: text/plain; charset=UTF-8

>
> On 12/21/2015 2:54 AM, icing@apache.org wrote:
>
>> Author: icing
>> Date: Mon Dec 21 10:54:38 2015
>> New Revision: 1721121
>>
>> URL: http://svn.apache.org/viewvc?rev=1721121&view=rev
>> Log:
>> byte savings by using bit fields, new env vars HTTP2 and H2PUSH, set to
>> on when enabled on request
>>
>
FWIW, HTTPS envvar isn't optional, and I don't think these two
simple variables should be toggled either.

More complex/verbose H2-specific envvars could be toggled,
of course.

--001a1140ef8455c68c0527833f72
Content-Type: text/html; charset=UTF-8
Content-Transfer-Encoding: quoted-printable

<div dir=3D"ltr"><div class=3D"gmail_extra"><div class=3D"gmail_quote"><blo=
ckquote class=3D"gmail_quote" style=3D"margin:0 0 0 .8ex;border-left:1px #c=
cc solid;padding-left:1ex"><span class=3D"">On 12/21/2015 2:54 AM, <a href=
=3D"mailto:icing@apache.org" target=3D"_blank">icing@apache.org</a> wrote:<=
br>
</span><blockquote class=3D"gmail_quote" style=3D"margin:0 0 0 .8ex;border-=
left:1px #ccc solid;padding-left:1ex"><span class=3D"">
Author: icing<br>
Date: Mon Dec 21 10:54:38 2015<br>
New Revision: 1721121<br>
<br>
URL: <a href=3D"http://svn.apache.org/viewvc?rev=3D1721121&amp;view=3Drev" =
rel=3D"noreferrer" target=3D"_blank">http://svn.apache.org/viewvc?rev=3D172=
1121&amp;view=3Drev</a><br>
Log:<br>
byte savings by using bit fields, new env vars HTTP2 and H2PUSH, set to on =
when enabled on request<br></span></blockquote></blockquote><div><br></div>=
<div>FWIW, HTTPS envvar isn&#39;t optional, and I don&#39;t think these two=
</div><div>simple variables should be toggled either.</div><div><br></div><=
div>More complex/verbose H2-specific envvars could be toggled,</div><div>of=
 course.=C2=A0</div></div><br></div></div>

--001a1140ef8455c68c0527833f72--

From dev-return-85110-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Wed Dec 23 09:23:16 2015
Return-Path: <dev-return-85110-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 9F91318AB5
	for <apmail-httpd-dev-archive@www.apache.org>; Wed, 23 Dec 2015 09:23:16 +0000 (UTC)
Received: (qmail 38684 invoked by uid 500); 23 Dec 2015 09:23:13 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 38618 invoked by uid 500); 23 Dec 2015 09:23:13 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 38608 invoked by uid 99); 23 Dec 2015 09:23:13 -0000
Received: from Unknown (HELO spamd1-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 23 Dec 2015 09:23:13 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd1-us-west.apache.org (ASF Mail Server at spamd1-us-west.apache.org) with ESMTP id 93A4BC1FAA
	for <dev@httpd.apache.org>; Wed, 23 Dec 2015 09:23:12 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd1-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.101
X-Spam-Level:
X-Spam-Status: No, score=-0.101 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RP_MATCHES_RCVD=-0.001, SPF_PASS=-0.001, URIBL_BLOCKED=0.001]
	autolearn=disabled
Authentication-Results: spamd1-us-west.apache.org (amavisd-new);
	dkim=pass (1024-bit key) header.d=greenbytes.de header.b=JeBiBCuJ;
	dkim=pass (1024-bit key) header.d=greenbytes.de header.b=JeBiBCuJ
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd1-us-west.apache.org [10.40.0.7]) (amavisd-new, port 10024)
	with ESMTP id SZ__agAH2zMt for <dev@httpd.apache.org>;
	Wed, 23 Dec 2015 09:23:02 +0000 (UTC)
Received: from mail.greenbytes.de (mail.greenbytes.de [217.91.35.233])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id 7F79C42989
	for <dev@httpd.apache.org>; Wed, 23 Dec 2015 09:23:02 +0000 (UTC)
Received: by mail.greenbytes.de (Postfix, from userid 117)
	id 92F1815A172B; Wed, 23 Dec 2015 10:22:54 +0100 (CET)
DKIM-Signature: v=1; a=rsa-sha256; c=simple/simple; d=greenbytes.de; s=mail;
	t=1450862574; bh=/g5bTNqCzWCY3G9EOHRcNLbNDVYCIVs9BiZ6MBbyqVk=;
	h=Subject:From:In-Reply-To:Date:References:To:From;
	b=JeBiBCuJQOR/9LVB8HS9Duvh9O/nGLnmLH3f4pOCE/AmKegjo1rQL+jshtWSN1Z6o
	 iMipLcn8NzcrvgXDH5SzrdGrse9vb8OOtdY2IazCkj9INEgInDAwtWPfY6xbyf1CZy
	 pM7kBdsIJ0LzoPuu6c37xf6aJ6j0wcr7PQyFSt3E=
Received: from [192.168.1.42] (unknown [217.91.35.233])
	(using TLSv1 with cipher ECDHE-RSA-AES256-SHA (256/256 bits))
	(Client did not present a certificate)
	by mail.greenbytes.de (Postfix) with ESMTPSA id 0A86715A02F0
	for <dev@httpd.apache.org>; Wed, 23 Dec 2015 10:22:54 +0100 (CET)
DKIM-Signature: v=1; a=rsa-sha256; c=simple/simple; d=greenbytes.de; s=mail;
	t=1450862574; bh=/g5bTNqCzWCY3G9EOHRcNLbNDVYCIVs9BiZ6MBbyqVk=;
	h=Subject:From:In-Reply-To:Date:References:To:From;
	b=JeBiBCuJQOR/9LVB8HS9Duvh9O/nGLnmLH3f4pOCE/AmKegjo1rQL+jshtWSN1Z6o
	 iMipLcn8NzcrvgXDH5SzrdGrse9vb8OOtdY2IazCkj9INEgInDAwtWPfY6xbyf1CZy
	 pM7kBdsIJ0LzoPuu6c37xf6aJ6j0wcr7PQyFSt3E=
Content-Type: text/plain; charset=us-ascii
Mime-Version: 1.0 (Mac OS X Mail 9.2 \(3112\))
Subject: Re: variables
From: Stefan Eissing <stefan.eissing@greenbytes.de>
In-Reply-To: <CACsi252gHmgbY52XJf4myZ-9G2K7fKeEfMyqMk3UZjw-mrapBw@mail.gmail.com>
Date: Wed, 23 Dec 2015 10:22:53 +0100
Content-Transfer-Encoding: quoted-printable
Message-Id: <939EC1AB-FD33-4347-967D-5612E347427C@greenbytes.de>
References: <1A4A9DE8-ACF3-4FEB-BE4E-756E850ACF39@greenbytes.de> <CACsi252gHmgbY52XJf4myZ-9G2K7fKeEfMyqMk3UZjw-mrapBw@mail.gmail.com>
To: dev@httpd.apache.org
X-Mailer: Apple Mail (2.3112)

I would like these vars to behave like the HTTPS var does. There are two =
places
where these are made available:
1. ssl_engine_kernel: set in r->subprocess_env to "on" for https =
connections, otherwise left out
2. in util_expr_eval: as evaluation during config/htaccess expressions

HTTP2 has been implemented as in 1, I think. Part 2 is still missing. I =
put exported functions into mod_http2.h and added it to the include path =
just like mod_ssl does. If someone wants to add the util_expr_eval part, =
feel free. Currently busy with bugs... :(

Stefan

> Am 16.12.2015 um 19:39 schrieb William A Rowe Jr =
<wrowe@rowe-clan.net>:
>=20
> On Wed, Dec 16, 2015 at 5:40 AM, Stefan Eissing =
<stefan.eissing@greenbytes.de> wrote:
>=20
> Subprocesses get their environment via r->subprocess_env, filled via =
the "fixups" hook. This is the usual way how we involve modules in =
request processing. But, as I read it, subprocess_env gets filled with =
all variables for every request, even though they maybe never read? Hmm, =
probably a little late to do anything about that without code breakage.
>=20
> Not 'all', that's what =
https://httpd.apache.org/docs/current/mod/mod_ssl.html#ssloptions
> overrides.  While the 'classic' http variables are a pretty short =
list, mod_ssl is
> capable of creating a very large list of variables, interesting to =
only a few cases.
>=20
> HTTPS=3Don|off is always there, and HTTP2=3Don|off would be similarly =
helpful and
> very low impact.


From dev-return-85111-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Wed Dec 23 10:33:35 2015
Return-Path: <dev-return-85111-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 308DC18C46
	for <apmail-httpd-dev-archive@www.apache.org>; Wed, 23 Dec 2015 10:33:35 +0000 (UTC)
Received: (qmail 22629 invoked by uid 500); 23 Dec 2015 10:33:34 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 22561 invoked by uid 500); 23 Dec 2015 10:33:34 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 22551 invoked by uid 99); 23 Dec 2015 10:33:34 -0000
Received: from Unknown (HELO spamd2-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 23 Dec 2015 10:33:34 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd2-us-west.apache.org (ASF Mail Server at spamd2-us-west.apache.org) with ESMTP id 239A51A0454
	for <dev@httpd.apache.org>; Wed, 23 Dec 2015 10:33:34 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd2-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 2.88
X-Spam-Level: **
X-Spam-Status: No, score=2.88 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	HTML_MESSAGE=3, RCVD_IN_MSPIKE_H3=-0.01, RCVD_IN_MSPIKE_WL=-0.01,
	SPF_PASS=-0.001, URIBL_BLOCKED=0.001] autolearn=disabled
Authentication-Results: spamd2-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-us-west.apache.org ([10.40.0.8])
	by localhost (spamd2-us-west.apache.org [10.40.0.9]) (amavisd-new, port 10024)
	with ESMTP id A2NiAdcgoVt5 for <dev@httpd.apache.org>;
	Wed, 23 Dec 2015 10:33:28 +0000 (UTC)
Received: from mail-lb0-f169.google.com (mail-lb0-f169.google.com [209.85.217.169])
	by mx1-us-west.apache.org (ASF Mail Server at mx1-us-west.apache.org) with ESMTPS id 713EB201EB
	for <dev@httpd.apache.org>; Wed, 23 Dec 2015 10:33:27 +0000 (UTC)
Received: by mail-lb0-f169.google.com with SMTP id oh2so44338366lbb.3
        for <dev@httpd.apache.org>; Wed, 23 Dec 2015 02:33:27 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        bh=fGEP0oa273Qd4gHHIE4pr4Hmj1qd5x8ura5qWKfIoUA=;
        b=k3BidgF4DRATNycPfEgtdVFghGKKkyYi/Sv2RgAMnc8dpHhM7W5GBPwiViXQVyDW1Q
         TOEBh9M6yiHf5MJyo09uXc6Y3+z1gXKP0fVLOdX55gzV6+P7Gf50P8jmdUmydLMcGYPN
         5+XXKS7BlAS3k6bskQOS5dKlhdncZcTHKUWH2HmncAwMHvP2aNKRzWvPPBjgfJdx/JkV
         PM1HyYLqeuUoJqxj9lDDDPlP4sKScUs0VMhgNNAEJGV5qQH+RuIDl9Etyq5ZUKbJyOFk
         LccoRsWT5M0+v5vrbhrAikxrACG9XsO6Yj8YHQsZkgX60tPtEQBw4PKAcrhQv/v6Bctr
         0B9Q==
MIME-Version: 1.0
X-Received: by 10.112.160.33 with SMTP id xh1mr10290592lbb.67.1450866800145;
 Wed, 23 Dec 2015 02:33:20 -0800 (PST)
Received: by 10.25.210.146 with HTTP; Wed, 23 Dec 2015 02:33:20 -0800 (PST)
In-Reply-To: <1E393CD7-FC49-4170-ADBA-710A9AA8AFA6@cpanel.net>
References: <CACsi253tpu-76tEXCizdgjWPmt9sfjSycuVNXDiefnBmOOnDmA@mail.gmail.com>
	<5670386F.5090901@oracle.com>
	<1CF499FD-1163-46CA-9941-5C83CD214FC1@cpanel.net>
	<CALK=YjP7kJDWMKLwy0ke4Hh6EHevebN3UgYSbLyK01hrFvxsZA@mail.gmail.com>
	<E05B0375-6FC0-4D48-B35E-956A3D95EA8B@cpanel.net>
	<CALK=YjMq_VZ+u1agz0oWBuFoP9QTpT2q85OxKTohLjFpzht5YQ@mail.gmail.com>
	<1E393CD7-FC49-4170-ADBA-710A9AA8AFA6@cpanel.net>
Date: Wed, 23 Dec 2015 11:33:20 +0100
Message-ID: <CAFedD41UrBC4hRHytRAPAV+gtUjVa1_s9cwf8ySLmGiS7WUqCQ@mail.gmail.com>
Subject: Re: OpenSSL 0.9.8/1.0.0 on Trunk
From: Luca Toscano <toscano.luca@gmail.com>
To: dev@httpd.apache.org
Content-Type: multipart/alternative; boundary=001a11c33eac3d3aab05278e404d

--001a11c33eac3d3aab05278e404d
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: quoted-printable

Hi all,

I am a bit new so sorry if this question is trivial. I noticed that the
httpd's doxygen documentation is regularly built in
https://ci.apache.org/builders, so I am wondering if we could build
everything in trunk (or all the supported branches) regularly after each
commit (getting a daily report of failures/warnings for example in this
ML). CentOS is missing among the list of supported testing environments but
it might be possible to add it asking to the buildbot owners.

I am probably missing some bits and pieces so if I am completely mistaken
please let me know! I'll try to update the related docs (like
https://httpd.apache.org/dev/ and /developer) for the newcomers like me :)

Thanks!

Luca


2015-12-22 6:30 GMT+01:00 Jacob Perkins <jacob.perkins@cpanel.net>:

> Hi Eric,
>
> I=E2=80=99m going to work on setting up a test system for all of our supp=
orted
> environments so that we can test our platform quicker and provide feedbac=
k
> during the T&R period.
>
> I=E2=80=99d love to try and give back to the project honestly. cPanel has=
 used
> Apache in the core of our webstack for at least 10 years so it would be
> great if we could provide some extra eyes for testing releases, if not mo=
re.
>
> Sorry if I came across a little=E2=80=A6 crass. It=E2=80=99s been a long =
day.
> =E2=80=94
> Jacob Perkins
> Product Owner
> *cPanel Inc.*
>
> jacob.perkins@cpanel.net
> Office:  713-529-0800 x 4046
> Cell:  713-560-8655
>
> On Dec 21, 2015, at 5:20 PM, Eric Covener <covener@gmail.com> wrote:
>
> On Mon, Dec 21, 2015 at 2:38 PM, Jacob Perkins <jacob.perkins@cpanel.net>
> wrote:
>
> CentOS 5 still ships with OpenSSL 0.9.8, and is still supported for anoth=
er
> year or so. Considering there=E2=80=99s a lot of servers still running Ce=
ntOS 5
> (and
> possibly older), it feels as if this would have been caught.
>
>
> Do you mean could or should have been caught?
>
> It wasn't caught until someone compiled it against openssl < 0.9.8m
> (which is not the latest 0.9.8).  I can't see many scenarios where someon=
e
> will compile a new 2.4.x release and not have a contemporary openssl --
> beyond trying to catch exactly these kinds of problems during a release.
>
> Especially something as small as a missing semicolon.
>
>
> Well, usually small problems are the ones that fly under the radar.
>    Anything
> catastrophic to the build will not go unnoticed, but someone has to build
> on the
> affected platform/compiler/prereqs/???.
>
> Would a linter / compile check to proactively check those things help?
>
>
> Dunno, possible.
>
>
>

--001a11c33eac3d3aab05278e404d
Content-Type: text/html; charset=UTF-8
Content-Transfer-Encoding: quoted-printable

<div dir=3D"ltr">Hi all,<div><br></div><div>I am a bit new so sorry if this=
 question is trivial. I noticed that the httpd&#39;s doxygen documentation =
is regularly built in=C2=A0<a href=3D"https://ci.apache.org/builders">https=
://ci.apache.org/builders</a>, so I am wondering if we could build everythi=
ng in trunk (or all the supported branches) regularly after each commit (ge=
tting a daily report of failures/warnings for example in this ML). CentOS i=
s missing among the list of supported testing environments but it might be =
possible to add it asking to the buildbot owners.</div><div><br></div><div>=
I am probably missing some bits and pieces so if I am completely mistaken p=
lease let me know! I&#39;ll try to update the related docs (like=C2=A0<a hr=
ef=3D"https://httpd.apache.org/dev/">https://httpd.apache.org/dev/</a> and =
/developer) for the newcomers like me :)</div><div><br></div><div>Thanks!</=
div><div><br></div><div>Luca</div><div><br></div><div class=3D"gmail_extra"=
><br><div class=3D"gmail_quote">2015-12-22 6:30 GMT+01:00 Jacob Perkins <sp=
an dir=3D"ltr">&lt;<a href=3D"mailto:jacob.perkins@cpanel.net" target=3D"_b=
lank">jacob.perkins@cpanel.net</a>&gt;</span>:<br><blockquote class=3D"gmai=
l_quote" style=3D"margin:0px 0px 0px 0.8ex;border-left-width:1px;border-lef=
t-color:rgb(204,204,204);border-left-style:solid;padding-left:1ex"><div sty=
le=3D"word-wrap:break-word">Hi Eric,<div><br></div><div>I=E2=80=99m going t=
o work on setting up a test system for all of our supported environments so=
 that we can test our platform quicker and provide feedback during the T&am=
p;R period.=C2=A0</div><div><div><div><br></div><div>I=E2=80=99d love to tr=
y and give back to the project honestly. cPanel has used Apache in the core=
 of our webstack for at least 10 years so it would be great if we could pro=
vide some extra eyes for testing releases, if not more.</div><div><br></div=
><div>
<div style=3D"color:rgb(0,0,0);font-family:Helvetica;font-size:12px;font-st=
yle:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;lin=
e-height:normal;text-align:-webkit-auto;text-indent:0px;text-transform:none=
;white-space:normal;word-spacing:0px;word-wrap:break-word">Sorry if I came =
across a little=E2=80=A6 crass. It=E2=80=99s been a long day.<br>=E2=80=94<=
/div><span class=3D""><div style=3D"color:rgb(0,0,0);font-family:Helvetica;=
font-size:12px;font-style:normal;font-variant:normal;font-weight:normal;let=
ter-spacing:normal;line-height:normal;text-align:-webkit-auto;text-indent:0=
px;text-transform:none;white-space:normal;word-spacing:0px;word-wrap:break-=
word">Jacob Perkins<br></div><div style=3D"color:rgb(0,0,0);font-family:Hel=
vetica;font-size:12px;font-style:normal;font-variant:normal;font-weight:nor=
mal;letter-spacing:normal;line-height:normal;text-align:-webkit-auto;text-i=
ndent:0px;text-transform:none;white-space:normal;word-spacing:0px;word-wrap=
:break-word">Product Owner</div><div style=3D"color:rgb(0,0,0);font-family:=
Helvetica;font-size:12px;font-style:normal;font-variant:normal;font-weight:=
normal;letter-spacing:normal;line-height:normal;text-align:-webkit-auto;tex=
t-indent:0px;text-transform:none;white-space:normal;word-spacing:0px;word-w=
rap:break-word"><b><font color=3D"#ff7c00">cPanel Inc.</font></b></div><div=
 style=3D"color:rgb(0,0,0);font-family:Helvetica;font-size:12px;font-style:=
normal;font-variant:normal;font-weight:normal;letter-spacing:normal;line-he=
ight:normal;text-align:-webkit-auto;text-indent:0px;text-transform:none;whi=
te-space:normal;word-spacing:0px;word-wrap:break-word"><br></div><div style=
=3D"color:rgb(0,0,0);font-family:Helvetica;font-size:12px;font-style:normal=
;font-variant:normal;font-weight:normal;letter-spacing:normal;line-height:n=
ormal;text-align:-webkit-auto;text-indent:0px;text-transform:none;white-spa=
ce:normal;word-spacing:0px;word-wrap:break-word"><a href=3D"mailto:jacob.pe=
rkins@cpanel.net" target=3D"_blank">jacob.perkins@cpanel.net</a></div><div =
style=3D"color:rgb(0,0,0);font-family:Helvetica;font-size:12px;font-style:n=
ormal;font-variant:normal;font-weight:normal;letter-spacing:normal;line-hei=
ght:normal;text-align:-webkit-auto;text-indent:0px;text-transform:none;whit=
e-space:normal;word-spacing:0px;word-wrap:break-word">Office: =C2=A0713-529=
-0800 x=C2=A04046</div><div style=3D"color:rgb(0,0,0);font-family:Helvetica=
;font-size:12px;font-style:normal;font-variant:normal;font-weight:normal;le=
tter-spacing:normal;line-height:normal;text-align:-webkit-auto;text-indent:=
0px;text-transform:none;white-space:normal;word-spacing:0px;word-wrap:break=
-word">Cell: =C2=A0713-560-8655</div>
</span></div><div><div class=3D"h5">
<br><div><blockquote type=3D"cite"><div>On Dec 21, 2015, at 5:20 PM, Eric C=
ovener &lt;<a href=3D"mailto:covener@gmail.com" target=3D"_blank">covener@g=
mail.com</a>&gt; wrote:</div><br><div><div>On Mon, Dec 21, 2015 at 2:38 PM,=
 Jacob Perkins &lt;<a href=3D"mailto:jacob.perkins@cpanel.net" target=3D"_b=
lank">jacob.perkins@cpanel.net</a>&gt; wrote:<br><blockquote type=3D"cite">=
CentOS 5 still ships with OpenSSL 0.9.8, and is still supported for another=
<br>year or so. Considering there=E2=80=99s a lot of servers still running =
CentOS 5 (and<br>possibly older), it feels as if this would have been caugh=
t.<br></blockquote><br>Do you mean could or should have been caught?<br><br=
>It wasn&#39;t caught until someone compiled it against openssl &lt; 0.9.8m=
<br>(which is not the latest 0.9.8).=C2=A0 I can&#39;t see many scenarios w=
here someone<br>will compile a new 2.4.x release and not have a contemporar=
y openssl --<br>beyond trying to catch exactly these kinds of problems duri=
ng a release.<br><br><blockquote type=3D"cite">Especially something as smal=
l as a missing semicolon.<br></blockquote><br>Well, usually small problems =
are the ones that fly under the radar. =C2=A0=C2=A0=C2=A0Anything<br>catast=
rophic to the build will not go unnoticed, but someone has to build on the<=
br>affected platform/compiler/prereqs/???.<br><br><blockquote type=3D"cite"=
>Would a linter / compile check to proactively check those things help?<br>=
</blockquote><br>Dunno, possible.<br></div></div></blockquote></div><br></d=
iv></div></div></div></div></blockquote></div><br></div></div>

--001a11c33eac3d3aab05278e404d--

From dev-return-85112-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Sun Dec 27 07:15:18 2015
Return-Path: <dev-return-85112-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 0B3FA18EFF
	for <apmail-httpd-dev-archive@www.apache.org>; Sun, 27 Dec 2015 07:15:18 +0000 (UTC)
Received: (qmail 42040 invoked by uid 500); 27 Dec 2015 07:15:16 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 41975 invoked by uid 500); 27 Dec 2015 07:15:16 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 41966 invoked by uid 99); 27 Dec 2015 07:15:16 -0000
Received: from mail-relay.apache.org (HELO mail-relay.apache.org) (140.211.11.15)
    by apache.org (qpsmtpd/0.29) with ESMTP; Sun, 27 Dec 2015 07:15:16 +0000
Received: from asf-bz1-us-mid.priv.apache.org (nat1-us-mid.apache.org [23.253.172.122])
	by mail-relay.apache.org (ASF Mail Server at mail-relay.apache.org) with ESMTPS id 76BB11A0019
	for <dev@httpd.apache.org>; Sun, 27 Dec 2015 07:15:16 +0000 (UTC)
Received: by asf-bz1-us-mid.priv.apache.org (ASF Mail Server at asf-bz1-us-mid.priv.apache.org, from userid 0)
	id F3E5C603A0; Sun, 27 Dec 2015 07:15:15 +0000 (UTC)
From: bugzilla@apache.org
To: dev@httpd.apache.org
Subject: Bug report for Apache httpd-2 [2015/12/27]
Message-Id: <20151227071515.F3E5C603A0@asf-bz1-us-mid.priv.apache.org>
Date: Sun, 27 Dec 2015 07:15:06 +0000 (UTC)

+---------------------------------------------------------------------------+
| Bugzilla Bug ID                                                           |
|     +---------------------------------------------------------------------+
|     | Status: UNC=Unconfirmed NEW=New         ASS=Assigned                |
|     |         OPN=Reopened    VER=Verified    (Skipped Closed/Resolved)   |
|     |   +-----------------------------------------------------------------+
|     |   | Severity: BLK=Blocker CRI=Critical  REG=Regression  MAJ=Major   |
|     |   |           MIN=Minor   NOR=Normal    ENH=Enhancement TRV=Trivial |
|     |   |   +-------------------------------------------------------------+
|     |   |   | Date Posted                                                 |
|     |   |   |          +--------------------------------------------------+
|     |   |   |          | Description                                      |
|     |   |   |          |                                                  |
| 7483|Ass|Enh|2002-03-26|Add FileAction directive to assign a cgi interpret|
| 8713|Inf|Min|2002-05-01|No Errorlog on PROPFIND/Depth:Infinity            |
| 8867|Opn|Cri|2002-05-07|exports.c generation fails when using a symlink to|
|10747|New|Maj|2002-07-12|ftp SIZE command and 'smart' ftp servers results i|
|11294|New|Enh|2002-07-30|desired vhost_alias option                        |
|11580|Opn|Enh|2002-08-09|generate Content-Location headers                 |
|12033|Opn|Nor|2002-08-26|Graceful restart immediately result in [warn] long|
|12680|New|Enh|2002-09-16|Digest authentication with integrity protection   |
|13599|Inf|Nor|2002-10-14|autoindex formating broken for multibyte sequences|
|13661|Ass|Enh|2002-10-15|Apache cannot not handle dynamic IP reallocation  |
|14104|Opn|Enh|2002-10-30|not documented: must restart server to load new CR|
|14496|New|Enh|2002-11-13|Cannot upgrade any version on Windows. Must uninst|
|14922|Inf|Enh|2002-11-28|<target> is currently hardcoded to 'apache2'      |
|15719|Inf|Nor|2002-12-30|WebDAV MOVE to destination URI which is content-ne|
|16761|Inf|Nor|2003-02-04|CustomLog with pipe spawns process during config  |
|16802|New|Enh|2003-02-05|Additional AllowOverride directive "Restrict"     |
|16811|Ass|Maj|2003-02-05|mod_autoindex always return webpages in UTF-8.    |
|17107|New|Min|2003-02-16|Windows should not install printenv               |
|17114|New|Enh|2003-02-17|Please add strip and install-strip targets to Make|
|17244|Ass|Nor|2003-02-20|./configure --help gives false information regardi|
|17497|Opn|Nor|2003-02-27|mod_mime_magic generates incorrect response header|
|18325|New|Enh|2003-03-25|PAM support for suEXEC                            |
|18334|Inf|Cri|2003-03-25|Server crashes when authenticating users against L|
|18497|New|Min|2003-03-30|configure --help gives wrong default for sysconfdi|
|19043|New|Min|2003-04-15|Interesting interaction between cern_meta module a|
|19670|New|Enh|2003-05-05|content type header supplied upon PUT is thrown aw|
|20036|Ass|Nor|2003-05-19|Trailing Dots stripped from PATH_INFO environment |
|21253|New|Nor|2003-07-01|Mime magic doesn't continue if type is specifed fo|
|21260|New|Nor|2003-07-02|CacheMaxExpire directive not enforced !           |
|21533|Ass|Cri|2003-07-11|Multiple levels of htacces files can cause mod_aut|
|22138|Inf|Cri|2003-08-05|Webdav is not preccessing special chars right.    |
|22237|New|Enh|2003-08-08|option to disable ServerSignature on index pages  |
|22484|Opn|Maj|2003-08-16|semaphore problem takes httpd down                |
|22686|Opn|Nor|2003-08-25|ab: apr_poll: The timeout specified has expired (7|
|22898|Opn|Nor|2003-09-02|nph scripts with two HTTP header                  |
|23167|Inf|Cri|2003-09-14|--enable-layout never goes to apr apr-util        |
|23181|New|Nor|2003-09-15|Status 304 (Not modified) and chunking leads to an|
|23238|New|Cri|2003-09-18|non-async-signal-safe operations from signal handl|
|23330|New|Enh|2003-09-22|Enhance ApacheMonitor to view and control Tomcat s|
|23911|Opn|Cri|2003-10-18|CGI processes left defunct/zombie under 2.0.54    |
|24031|New|Enh|2003-10-23|Passphrase protected private key in SSLProxyMachin|
|24095|Opn|Cri|2003-10-24|ERROR "Parent: child process exited with status 32|
|24437|Opn|Nor|2003-11-05|mod_auth_ldap doubly-escapes backslash (\) charact|
|24890|Opn|Nor|2003-11-21|Apache config parser should not be local aware ( g|
|25014|New|Enh|2003-11-26|A flexible interface for mod_log_config           |
|25201|New|Enh|2003-12-04|Provide Cache Purge operation                     |
|25240|Inf|Enh|2003-12-05|SSL Library Error: 336105671 logged as information|
|25435|New|Enh|2003-12-11|sethandler and directoryindex not playing nice    |
|25469|Opn|Enh|2003-12-12|create AuthRoot for defining paths to auth files  |
|25484|Ass|Nor|2003-12-12|Non-service Apache cannot be stopped in WinXP     |
|25543|Inf|Nor|2003-12-15|mod_proxy_ajp overwrites existing response headers|
|25667|New|Nor|2003-12-19|Memory leak in function ssl_scache_dbm_retrieve().|
|25863|New|Enh|2004-01-02|new per-host initialization hooks                 |
|26005|New|Nor|2004-01-08|SERVER_NAME incorrect when using IPv6 address in U|
|26142|New|Maj|2004-01-14|EnableSendFile Off for Windows XP Home            |
|26153|Opn|Cri|2004-01-15|Apache cygwin directory traversal vulnerability   |
|26368|New|Min|2004-01-23|File extensions in AddDescription treated as part |
|26446|New|Nor|2004-01-26|flush buckets followed by eos bucket emit multiple|
|26478|New|Enh|2004-01-28|mod_dav does not expose a method for setting the D|
|26835|New|Enh|2004-02-10|[PATCH] Mod_status Readability & Browser Side Tabl|
|27257|Ass|Enh|2004-02-26|rotatelogs with getopt and setuid                 |
|27578|New|Enh|2004-03-10|made getlastmodified a writable property          |
|27715|Ass|Enh|2004-03-16|Client sending misformed Range "bytes = 0-100" ins|
|27791|Inf|Nor|2004-03-18|mod_cache doesn't re-cache expired content        |
|27835|New|Enh|2004-03-22|When proxying FTP, all errors turns into 404      |
|27869|New|Enh|2004-03-23|stopping and starting httpd again immediately caus|
|28854|Inf|Nor|2004-05-09|Build fails with missing library call on Solaris i|
|28903|New|Enh|2004-05-11|Hooks to add environment variables to CGI and othe|
|29090|Ass|Enh|2004-05-19|MultiviewsMatch NegotiatedOnly extensions not resp|
|29165|New|Nor|2004-05-24|Parent directory icon not correct                 |
|29446|New|Enh|2004-06-08|want directive for setting content negotiation qua|
|29449|New|Enh|2004-06-09|Limit length of specified fields in LogFormat     |
|29450|New|Enh|2004-06-09|Improved logging for mod_access                   |
|29510|Ass|Enh|2004-06-10|ab does not support multiple cookies              |
|29644|Ver|Nor|2004-06-17|mod_proxy keeps downloading even after the client |
|29755|Opn|Nor|2004-06-23|mod_usertrack should use err_headers_out          |
|29822|New|Enh|2004-06-26|implement FTP 'PUT' support in proxy_ftp.c        |
|29941|Ass|Enh|2004-07-06|log files are not tested for availability on confi|
|30259|Ass|Enh|2004-07-22|When proxy connects to backend, a DNS lookup is do|
|30505|Ass|Enh|2004-08-05|Apache uses 'Error', and not lower level event typ|
|30730|Inf|Nor|2004-08-18|[PatchAvailable] mod_actions and Server-Status    |
|30865|Inf|Maj|2004-08-26|mod_disk_cache leaves many temporary files slowing|
|31302|Opn|Cri|2004-09-19|suexec doesn't execute commands if they're not in |
|31311|New|Enh|2004-09-20|Remote user not logged in reverse proxy scenario  |
|31352|Ass|Enh|2004-09-21|RFE, Bind to LDAP server with browser supplier use|
|31418|Opn|Nor|2004-09-25|SSLUserName is not usable by other modules        |
|31484|New|Maj|2004-09-30|Custom environment variables not passed to content|
|31490|New|Nor|2004-09-30|mod_proxy_ftp renders filenames with spaces badly |
|31565|New|Enh|2004-10-06|Won't start correctly if parent closed stdin, stdo|
|31679|New|Enh|2004-10-12|If the argument of a CGI has two or more consecuti|
|31709|Inf|Nor|2004-10-13|Raises an error on SSL name based virtualhosts (wi|
|31712|New|Enh|2004-10-14|config_file is NULL at ap_walk_config etc         |
|31952|New|Enh|2004-10-29|mod_proxy and RealPlayer: audio content streaming |
|32051|Opn|Nor|2004-11-04|mod_example is not thread safe                    |
|32328|Opn|Enh|2004-11-19|Make mod_rewrite escaping optional / expose intern|
|32346|New|Enh|2004-11-22|mod_include/include virtual checks content-type is|
|32524|New|Enh|2004-12-03|ab: add an option to specify a source address     |
|32703|Inf|Enh|2004-12-14|Cannot determine that Apache is frozen if /var fil|
|32750|Ass|Maj|2004-12-17|mod_proxy + Win32DisableAcceptEx = memory leak    |
|32877|New|Enh|2004-12-29|wrong utf-8 encoding/escaping in a href for umlaut|
|33084|New|Enh|2005-01-13|Optional certificate validity period check on SSLV|
|33089|New|Nor|2005-01-13|mod_include: Options +Includes (or IncludesNoExec)|
|33207|New|Nor|2005-01-23|Results of my suexec.c code audit                 |
|33215|New|Nor|2005-01-24|Cygwin build/install.sh fix (OSTYPE => ext=.exe)  |
|33512|Inf|Maj|2005-02-11|mod_mem_cache and possibly mod_deflate            |
|33627|New|Nor|2005-02-18|Bite-sized changes making progress towards compila|
|33685|New|Maj|2005-02-22|Unable to install in the path containing non engli|
|34270|Inf|Nor|2005-04-01|Large POSTs over SSL from Internet Explorer do not|
|34375|New|Enh|2005-04-08|enhancements for mod_include                      |
|34377|New|Enh|2005-04-08|Allow the overriding of 401 Unauthorized returns f|
|34405|New|Enh|2005-04-11|adds DOCUMENT_NAME_WITHOUT_SUFFIX to mod_include  |
|34508|New|Nor|2005-04-19|Randomly slow graceful restart, not accepting new |
|34519|New|Enh|2005-04-19|Directory index should emit valid XHTML           |
|35049|New|Nor|2005-05-24|let AddDefaultCharset apply to text/css and applic|
|35077|New|Nor|2005-05-26|mod_dav passes incorrect paths with LocationMatch |
|35083|Inf|Enh|2005-05-26|Certificate validation problems trapping          |
|35098|Ver|Maj|2005-05-27|Install fails using --prefix                      |
|35154|New|Nor|2005-06-01|Support for NID_serialNumber, etc. in SSLUserName |
|35245|New|Nor|2005-06-06|cache ignores max-age cache-directive in requests |
|35250|New|Enh|2005-06-07|[PatchAvailable] add logging to mod_proxy_connect |
|35280|New|Nor|2005-06-09|FTP proxy breaks RFC 2428 when trying to fall back|
|35556|Inf|Nor|2005-06-30|CRL files not re-read by HUP                      |
|35652|Opn|Min|2005-07-07|Improve error message: "pcfg_openfile: unable to c|
|35702|New|Nor|2005-07-12|Using with https URL, ab freezes or gets SIGSEGV o|
|35781|New|Nor|2005-07-18|ap_sub_req_method_uri() bypasses Limit security co|
|35981|Inf|Maj|2005-08-02|mod_dav overrides dav_fs response on PUT failure  |
|36286|New|Enh|2005-08-20|configtest doesn't check SSL certificates         |
|36492|New|Nor|2005-09-04|split-logfile script dies when splitting log of ma|
|36495|Inf|Nor|2005-09-05|mod_proxy_ajp: ajp_check_msg_header() got bad sign|
|36564|New|Enh|2005-09-08|make mod_ldap really universal                    |
|36636|New|Maj|2005-09-13|database write lock taken for PROPFIND operations |
|36676|New|Nor|2005-09-15|time() bug in httpd/os/win32/util_win32.c:wait_for|
|36710|Opn|Blk|2005-09-19|CGI output not captured                           |
|36724|New|Nor|2005-09-20|Don't install Apache Monitor by default           |
|37110|New|Nor|2005-10-17|Build fails when source tree is read-only         |
|37196|Inf|Min|2005-10-21|Wrong "Parent directory" link                     |
|37201|New|Enh|2005-10-21|Add <IfInterface IP> syntax to apache configuratio|
|37290|Opn|Min|2005-10-28|DirectoryIndex don't work in scriptaliased directo|
|37307|New|Enh|2005-10-31|Can't suppress error messages                     |
|37355|New|Enh|2005-11-04|Allow to specify Proxy-Authorization in ProxyRemot|
|37360|New|Maj|2005-11-04|Install fails on Windows XP x64 when program files|
|37402|New|Nor|2005-11-08|mod_proxy has stopped allowing POST sub-requests  |
|37514|Inf|Nor|2005-11-15|mod_proxy buffers chunked data.                   |
|37564|New|Enh|2005-11-19|Suggestion: mod_suexec SuexecUserGroup directive i|
|37587|Inf|Min|2005-11-22|mod_status Total Traffic value goes up then down? |
|37770|Opn|Blk|2005-12-03|proxy: error reading status line from remote serve|
|37823|Inf|Nor|2005-12-07|The openssl library linked is different between ht|
|37920|New|Maj|2005-12-15|mod_proxy does not flush data on POST requests fro|
|38116|New|Enh|2006-01-04|Chroot-Patch for SuExec                           |
|38164|New|Nor|2006-01-06|wrong status code for failed COPY/MOVE            |
|38182|New|Nor|2006-01-08|COPY ignores authority in Destination header      |
|38218|New|Enh|2006-01-10|Multiline Comments for *.conf files               |
|38240|Inf|Nor|2006-01-12|apache restart segfault with mutliple Include dire|
|38325|Opn|Nor|2006-01-20|impossible to determine AUTH_TYPE of interpreted r|
|38355|Unc|Enh|2006-01-23|DSO support for mod_rewrite                       |
|38369|New|Enh|2006-01-24|mod_proxy keeps alive connections that should be b|
|38408|New|Nor|2006-01-27|SSI environment vars not set in spawned processes |
|38419|New|Nor|2006-01-27|Problems with large WebDAV properties             |
|38478|New|Maj|2006-02-01|A client starting a SSL renegotiation can crash th|
|38515|New|Enh|2006-02-05|Dynamic LDAP Group Support                        |
|38550|New|Enh|2006-02-07|Setting headers based on proxied data             |
|38571|New|Enh|2006-02-08|CustomLog directive checked by apachectl configtes|
|38756|Inf|Nor|2006-02-22|errors with running make                          |
|38786|New|Nor|2006-02-26|"IndexOption VersionSort" has problems with traili|
|38827|New|Reg|2006-03-02|mod_disk_cache trying to rename locked tempfile on|
|38864|Inf|Enh|2006-03-06|ProxyPassReverse fails in <Location>              |
|38903|New|Maj|2006-03-09|r->allowed does not affect Allow response header  |
|38923|New|Min|2006-03-10|mod_speling incorrectly escapes linked URLs       |
|38928|New|Min|2006-03-11|propose removing "VARIANTS" feature               |
|38995|New|Nor|2006-03-16|httpd tries to communicate with the CGI daemon eve|
|39111|New|Nor|2006-03-27|Potential bug brought by mmapfile (mod_file_cache)|
|39128|Inf|Maj|2006-03-28|Apache 2.2 will not compile mod_ssl library's corr|
|39185|Inf|Nor|2006-04-03|Approximately in 1-2 weeks of work the server hang|
|39216|New|Maj|2006-04-05|mod_disk_cache trying to rename locked file, decre|
|39238|New|Nor|2006-04-07|mod_auth_dbm requires mod_auth or "no groups file?|
|39275|Opn|Nor|2006-04-11|slow child_init causes MaxClients warning         |
|39287|New|Nor|2006-04-12|Incorrect If-Modified-Since validation (due to syn|
|39299|New|Nor|2006-04-13|Internal Server Error (500) on COPY               |
|39329|Inf|Nor|2006-04-17|mod_dbd reconnection and prepared statements      |
|39370|New|Nor|2006-04-20|SSL session will be removed if the client is sendi|
|39380|Inf|Nor|2006-04-21|mod_disk_cache eats memory, has no LFS support, et|
|39418|New|Nor|2006-04-26|CacheMaxExpire directive not enforced             |
|39448|New|Min|2006-04-29|old-style <directory proxy:*> doesn't give any war|
|39498|New|Nor|2006-05-06|accept_filter in apr assumes if found in sys/socke|
|39517|New|Nor|2006-05-08|Corrupt chunked transfer-encoding with Content Neg|
|39658|Opn|Nor|2006-05-25|mod_proxy_ajp SSL Key Size Bug                    |
|39673|New|Nor|2006-05-29|mod_proxy opens connections that disturb NTLM     |
|39692|New|Nor|2006-05-31|mod_proxy_balancer doesn't retry a failed request |
|39723|Inf|Enh|2006-06-05|Forward proxy does not work in tranparent mode    |
|39727|Ass|Nor|2006-06-05|Incorrect ETag on gzip:ed content                 |
|39730|New|Nor|2006-06-06|LanguagePriority and DefaultLanguage are Case Sens|
|39737|New|Nor|2006-06-06|LogFormat "%{tid}P" reports wrong thread id on Win|
|39748|New|Enh|2006-06-07|Header and POST support for mod_include           |
|39753|New|Nor|2006-06-07|incorrect source for LOCALE Decimal Symbol in Win2|
|39785|Inf|Nor|2006-06-12|Status code 408 (Request Timeout) is not logged   |
|39807|Opn|Enh|2006-06-13|large files / filesystem corruption can cause apac|
|39902|New|Nor|2006-06-27|HeaderName directive breaks mod_filter somehow    |
|39904|New|Nor|2006-06-27|graceful restart error and cpu load               |
|39913|Ass|Blk|2006-06-27|detection of static OpenSSL libraries requiring li|
|39916|New|Nor|2006-06-28|Core Filters & non-blocking Sendfile              |
|39923|New|Nor|2006-06-28|AddDescription doesn't work in server config with |
|39928|New|Nor|2006-06-28|port no detected when file name not in URL        |
|39935|New|Nor|2006-06-29|AddDescription does not do literal comparisons on |
|39973|Ass|Enh|2006-07-06|apache software folder should be movable          |
|40035|New|Cri|2006-07-13|Windows Server 2003 "("R2")" 64-Bit Edition no cgi|
|40060|New|Nor|2006-07-17|AuthGroupFile should accept /etc/group syntax     |
|40075|New|Enh|2006-07-19|unable to use ldap groups that contain DNs and use|
|40102|Opn|Nor|2006-07-24|SCRIPT_NAME set incorrectly with mod_rewrite      |
|40146|New|Nor|2006-07-31|mod_ssl info in server_info is blank              |
|40174|New|Min|2006-08-03|Unable to get IndexOptionis ScanHTMLTitles to work|
|40180|Inf|Maj|2006-08-03|Mod_dav and remove folder doesn't work with Micros|
|40190|New|Nor|2006-08-05|translate file                                    |
|40196|New|Nor|2006-08-06|EILSEQ handling, NoImplicitAdd should work, and so|
|40217|Opn|Nor|2006-08-08|mod_dav PROPFIND ignores access restrictions on it|
|40266|Inf|Blk|2006-08-16|berkeley db support in httpd is screwed           |
|40312|New|Nor|2006-08-24|ssl_engine_init.c, ssl_init_ctx_verify contains a |
|40373|New|Nor|2006-08-31|mod_dir adds trailing slash after internal redirec|
|40408|New|Blk|2006-09-04|Apache 2.2.3 is not starting                      |
|40416|New|Maj|2006-09-05|mod_proxy_ftp cannot connect under http load in fo|
|40441|New|Enh|2006-09-08|intelligently handling dynamic subdomains         |
|40453|New|Nor|2006-09-09|lexicographic compare in RewriteCond isn't lexicog|
|40463|New|Nor|2006-09-11|piped logging causes some weird kill()ing         |
|40513|Opn|Maj|2006-09-14|Seeding PRNG with 0 bytes of entropy              |
|40514|New|Nor|2006-09-14|would like GracefulShutdownTimeout to work for gra|
|40540|Inf|Nor|2006-09-19|Bad interaction between MultiViews and SetOutputFi|
|40541|New|Nor|2006-09-19|Action rewrites URI used by Location?             |
|40571|New|Nor|2006-09-21|mod_proxy_ajp don't works with mod_usertrack      |
|40586|New|Enh|2006-09-22|Add option to supress default '-' output          |
|40746|New|Enh|2006-10-12|Feature request: ProxyAllow directive             |
|40749|New|Min|2006-10-12|magic file with string and "%n" causes Apache chil|
|40781|New|Nor|2006-10-17|PATH_TRANSLATED: 'redirect:/~jablko/gallery2/main.|
|40808|New|Enh|2006-10-23|ProxyRemote with optional proxy authentication    |
|40859|New|Enh|2006-11-01|[PATCH] Support -F force option to 'ab' support to|
|40917|New|Nor|2006-11-07|configure does not detect OpenSSL shared lib on HP|
|40953|New|Min|2006-11-12|Should not send any data in 1xx/204/304 reply from|
|40984|Inf|Enh|2006-11-16|AddIcon, AddIconByType for OpenDocument format    |
|40987|Opn|Enh|2006-11-16|ProxyVia Block doesn't remove Via: header for reve|
|41000|New|Nor|2006-11-19|mod_authn_dbd have an error, in function 'authn_db|
|41025|New|Nor|2006-11-23|ROBOTS META-Tag directive needed in mod_autoindex |
|41088|New|Nor|2006-11-30|installation backcolor is wrong (white)           |
|41111|New|Enh|2006-12-05|New option for filters: run only if there are spar|
|41114|New|Blk|2006-12-06|ACL HTTP method is rejected by mod_proxy_ajp      |
|41130|New|Nor|2006-12-07|mod_mime and mod_negotiation type-map both clobber|
|41143|Opn|Nor|2006-12-10|Incorrect ap_getline assumption in mod_proxy_http |
|41195|New|Nor|2006-12-17|properly set the parent pid on shutdown           |
|41196|New|Nor|2006-12-17|worker mpm usage of apr's memory pools is not thre|
|41200|Inf|Maj|2006-12-18|SSI include, prevent client from receiving full ou|
|41240|Inf|Enh|2006-12-25|BRF files support                                 |
|41262|Inf|Nor|2006-12-29|Embedded pcre causes runtime segfault             |
|41362|Inf|Maj|2007-01-14|mod_disk_cache and mod_include conflict generating|
|41375|Inf|Min|2007-01-15|Using same SSL Certificate with different ServerNa|
|41391|New|Min|2007-01-17|too long period setting makes max-age overflow    |
|41412|New|Enh|2007-01-19|RewriteRule Skip should take negative arguments   |
|41435|New|Nor|2007-01-22|Authentication fails with 500 Server Error        |
|41450|Inf|Cri|2007-01-24|Empty page (200 OK) while max-age is empty        |
|41485|New|Nor|2007-01-28|LDAP client certificates not usable in 2.2.x/trunk|
|41529|New|Enh|2007-02-02|Accept BOM in .htaccess                           |
|41556|New|Enh|2007-02-07|Feature Request: format string for masking ip addr|
|41621|New|Maj|2007-02-15|Apache 2.2.4 backend problem with Apache 2.0.59 Re|
|41646|New|Nor|2007-02-16|wrong headers are sent for HEAD requests when Prox|
|41676|Opn|Enh|2007-02-22|Refactor mod_proxy_ftp                            |
|41685|New|Enh|2007-02-22|Implement optional HTTP Authentication in a standa|
|41712|Inf|Nor|2007-02-26|threads locked at logging state                   |
|41729|New|Maj|2007-02-28|error message: ap_get_scoreboard_lb(130) failed in|
|41744|Inf|Maj|2007-03-01|SSI resolves includes but removes original HTML   |
|41763|Opn|Nor|2007-03-05|mod_disk_cache ignores CacheDirLevels and CacheDir|
|41764|New|Nor|2007-03-05|error state and conf                              |
|41771|Inf|Nor|2007-03-06|Erro with mod_proxy_ajp or mod_prox_balancer      |
|41867|New|Nor|2007-03-16|<DirectoryMatch> Matches Files                    |
|41925|New|Nor|2007-03-21|trivial patch to add automatic crypting to 'dbmman|
|41929|New|Nor|2007-03-22|ISAPI ssl variables                               |
|41953|New|Nor|2007-03-26|pidfile remains when 2nd pass of post-config retur|
|41962|New|Min|2007-03-27|Need mod_auth_ldap to authenticate with Active Dir|
|42027|Inf|Nor|2007-04-02|FileETag directive appears to be ignored          |
|42054|New|Nor|2007-04-04|service name and parameter issues                 |
|42079|New|Nor|2007-04-10|SSLRequire: Additional access in sub-directoies   |
|42082|New|Nor|2007-04-10|filter_init is called multiple times after an INCL|
|42182|Inf|Nor|2007-04-22|Mime types for cached proxied content             |
|42216|New|Enh|2007-04-24|RFE -- external overload procedure                |
|42262|Inf|Nor|2007-04-26|mod_dav /  worker fails to allocate memory and seg|
|42287|Inf|Nor|2007-04-28|chunked encoded response to POST request to cgi sc|
|42368|Inf|Nor|2007-05-09|httpd is crashing if conf/extra/httpd-manual.conf |
|42373|Inf|Maj|2007-05-09|REPORT request fails over mod_proxy               |
|42404|New|Enh|2007-05-13|Filename/info for disk-cached proxied remote URLs |
|42425|Inf|Nor|2007-05-15|Additional freshness checks in mod_cache.c cause m|
|42471|Inf|Nor|2007-05-21|clients with IE7 take 3megs per page load. httpd.e|
|42492|Inf|Nor|2007-05-22|mod_proxy_ajp with SSL front end: data corruption |
|42499|Inf|Nor|2007-05-23|Backslash produces a 404 error instead of going to|
|42548|New|Nor|2007-05-30|INCLUDE negotiating language aborts with APR_POOL_|
|42561|New|Enh|2007-05-31|[PATCH] AuthLDAPRemoteUserAttribute only applies i|
|42633|New|Min|2007-06-11|mod_info gives wrong information about actual conf|
|42665|New|Nor|2007-06-14|spurious attempt to open ".../file.html/.htaccess"|
|42666|New|Nor|2007-06-14|code & docs corrections for FollowSymLinks and Sym|
|42667|New|Nor|2007-06-14|mod_proxy_balancer not reporting when workers are |
|42668|Inf|Nor|2007-06-14|balancer_manager shows Ok status for the workers t|
|42687|New|Nor|2007-06-18|Fully delegate certificate & key semantics to the |
|42688|New|Enh|2007-06-18|engine managed keys: per process openssl context  |
|42690|New|Nor|2007-06-18|realm is not set for each configured directory whe|
|42695|Inf|Cri|2007-06-18|mod_proxy balancer problem                        |
|42699|New|Enh|2007-06-20|share mod_logio data with other modules           |
|42711|New|Enh|2007-06-20|format string for whole log entries not just id   |
|42732|Opn|Maj|2007-06-25|Authentication against database issue.            |
|42763|New|Nor|2007-06-28|graceful-stop/restart loops go loop too far       |
|42923|Inf|Maj|2007-07-17|vhost certificate NOT overriding cert from the _de|
|42972|Inf|Nor|2007-07-25|Certificate list in mod_ssl module context are not|
|42977|New|Nor|2007-07-25|DAV locking is busted when apr-util is built with |
|42987|New|Nor|2007-07-27|Weak Etags in Apache are useless and violate RFC 2|
|43012|New|Nor|2007-08-02|AIX instdso.sh libphp5.so                         |
|43027|New|Enh|2007-08-03|Header in default language                        |
|43033|New|Nor|2007-08-04|apxs does not correctly detect module name (w/o -n|
|43177|New|Nor|2007-08-21|child pid xxxxx exit signal Segmentation fault    |
|43218|New|Nor|2007-08-27|Wrong cert used for vhost if ServerName is same   |
|43220|Opn|Cri|2007-08-27|mod_proxy truncating ajp output                   |
|43249|Inf|Maj|2007-08-30|ldap_simple_bind_s failed when using SUN LDAP Libs|
|43275|New|Enh|2007-08-31|Remove avoidable network transactions in mod_proxy|
|43289|New|Nor|2007-09-02|XBitHack full g+x returns zero sized response on I|
|43308|New|Nor|2007-09-04|Persistent backend connections not supported for R|
|43352|New|Nor|2007-09-11|Apache2: out of memory during heavy webdav files c|
|43441|New|Nor|2007-09-20|Incorrect HTTP status for pre-commit-blocked autov|
|43471|New|Min|2007-09-25|no need to create a global pool on open_scoreboard|
|43481|New|Cri|2007-09-26|AuthLDAPURL must contain a final path of branch?(l|
|43494|New|Nor|2007-09-26|mod_cgid does not kill never ending scripts       |
|43502|New|Enh|2007-09-28|httpd fails to start if log directory does not exi|
|43513|New|Nor|2007-09-29|Persistent backend connections for ProxyPassMatch |
|43532|Inf|Cri|2007-10-02|Error while compiling Apache 2.2.3 on HPUX        |
|43533|Opn|Nor|2007-10-02|Frequent crashes in mod_include's bndm()          |
|43561|New|Nor|2007-10-05|apxs -q anomaly                                   |
|43577|Inf|Blk|2007-10-09|mod_authnz_ldap not working under WLDAP32 (novell/|
|43607|New|Nor|2007-10-11|mod_proxy sends data on closed connections without|
|43649|Opn|Trv|2007-10-18|mod_autoindex is generating invalid XHTML markup  |
|43652|New|Enh|2007-10-18|Suggest small change for big fix with SuExec & Vir|
|43666|New|Nor|2007-10-20|CGI works, but client denied error messages in err|
|43679|New|Enh|2007-10-23|Contributed tests for checking that subrequests ta|
|43723|Inf|Cri|2007-10-29|Apache 2.2.6 segfault when using mod_dbd          |
|43724|New|Cri|2007-10-29|Apache 2.2.6 segfault on url wich not in cache    |
|43755|New|Enh|2007-10-31|Add a SSLOptions to don't fill SSL_CLIENT_VERIFY  |
|43762|New|Enh|2007-10-31|Misleading tips in an error message about internal|
|43777|New|Nor|2007-11-01|Wrong encoding of <href> element in response      |
|43778|New|Nor|2007-11-01|Wrong responses if httpd has not access to some el|
|43785|New|Enh|2007-11-02|Tracking the per-hit impact of mod_include        |
|43792|New|Enh|2007-11-04|Feature proposal - bind phase                     |
|43818|New|Nor|2007-11-08|PROPFIND on -w- collections returns 207 MULTI-STAT|
|43838|New|Enh|2007-11-11|If-Modified-Since request and htcacheclean conflic|
|43895|New|Nor|2007-11-18|mod_mbox improvements                             |
|43897|Inf|Cri|2007-11-18|Huge memory consumption httpd 2.2.6, mod_proxy - m|
|43931|New|Enh|2007-11-21|OpenSSL autoconfig support for mod_ssl            |
|43943|New|Nor|2007-11-22|SHMCB crash due to misalignment and GCC 4 optimiza|
|43958|Inf|Maj|2007-11-26|mod_proxy_balancer not balancing correct in combin|
|43997|Opn|Min|2007-11-29|Only issue "Init: SSL server IP/Port conflict" if |
|44025|Inf|Nor|2007-12-05|Apache 2.2.6 fails to configure on OpenBSD 4.1    |
|44027|Ass|Enh|2007-12-05|Internationalized Domain Name (IDN) support       |
|44031|Opn|Maj|2007-12-06|RemoveHandler inside subdir location              |
|44034|Ass|Enh|2007-12-06|mpm_winnt doesn't call monitor hook               |
|44105|New|Nor|2007-12-19|Core dumps when using Proxy Keepalive             |
|44155|New|Enh|2007-12-31|smarter retry for LDAP_UNAVAILABLE, LDAP_BUSY, etc|
|44181|Opn|Enh|2008-01-07|add UnAlias                                       |
|44188|Inf|Cri|2008-01-08|Empty response for certain requests (mod_proxy as |
|44218|New|Min|2008-01-13|mod_autoindex shows the default icon for files wit|
|44221|Opn|Cri|2008-01-14|CheckCaseOnly On does not stop Multiple Choices ba|
|44250|New|Nor|2008-01-16|OSX 10.5: __THE_PROCESS_HAS_FORKED_AND_YOU_CANNOT_|
|44279|New|Enh|2008-01-22|Add "iterate" flag to apply rule in a loop while p|
|44302|New|Nor|2008-01-27|AuthLDAPURL does not accept ldapi:// urls         |
|44305|New|Nor|2008-01-28|Inconsistent configuration for suexec path        |
|44316|New|Nor|2008-01-28|httpd 2.0 does not follow ScriptAliases when invok|
|44322|New|Enh|2008-01-29|mod_proxy ProxyPassReverseCookieDomain with no dom|
|44351|New|Nor|2008-02-04|File descriptor leak when using prg RewriteMap    |
|44363|Inf|Maj|2008-02-05|Slow file transfers                               |
|44384|Ass|Nor|2008-02-09|mod_ssl on MacOS X 10.5.1 does not work because of|
|44453|New|Nor|2008-02-19|list_hooks.pl doesn't parse declarations that span|
|44476|New|Maj|2008-02-23|Apache service fails to start due to missing depen|
|44503|Inf|Blk|2008-02-27|Errors during SSL handshake                       |
|44518|New|Enh|2008-03-02|Don't set expires header on HTTP redirect.        |
|44578|New|Enh|2008-03-11|mod_authn_dbd option to let database validate pass|
|44601|New|Trv|2008-03-13|Add a lowercase value to Vary header for consisten|
|44602|New|Enh|2008-03-13|Options for modfying Content-Location (relative OR|
|44622|Inf|Nor|2008-03-17|POST fails to SSL vhost with proxy to HTTP backend|
|44631|New|Nor|2008-03-18|with-included-apr fails to work when using a separ|
|44638|New|Nor|2008-03-19|sed error in httpd.spec.in                        |
|44656|New|Nor|2008-03-22|Tries to retrive error document 404 instead of 406|
|44657|New|Enh|2008-03-22|prefer-type, -encoding, and -charset cookie? (as p|
|44670|New|Min|2008-03-25|Apache httpd 2.2.8 : Cannot ./configure when curre|
|44696|Inf|Nor|2008-03-27|mod_cache sometimes serves old content despite hav|
|44730|New|Nor|2008-04-01|duplicate query string in remote server url when u|
|44752|New|Nor|2008-04-03|Suexec does not correctly check that scripts are i|
|44757|New|Enh|2008-04-04|adding stderr buckets to mod_cgi                  |
|44758|New|Enh|2008-04-04|LimitRequestBody undocumented behaviour with proxi|
|44779|New|Enh|2008-04-08|Using commas and semicolons for content negotiatio|
|44855|New|Nor|2008-04-22|irregular balancing with sticky-session after re-e|
|44865|Ass|Nor|2008-04-23|mod_dav's lock database becomes consistently corru|
|44870|Inf|Nor|2008-04-24|process spinning on 100% cpu                      |
|44923|Inf|Min|2008-05-02|consequences of multiple LDAPTrustedGlobalCert    |
|44924|New|Enh|2008-05-02|allow 'CACERTDIR' in mod_ldap                     |
|44940|New|Maj|2008-05-06|Httpd randomly breaks when verifying client certif|
|44981|New|Enh|2008-05-12|Digital Certificates (CN Based) for Authorization |
|45022|New|Nor|2008-05-16|Processing of escaped glob patterns in "Include" d|
|45023|Opn|Reg|2008-05-16|DEFLATE preventing 304 NOT MODIFIED response      |
|45049|Opn|Nor|2008-05-20|mod_mem_cache caches partial content when client c|
|45054|New|Nor|2008-05-21|SSLVerifyClient optional_no_ca is broken          |
|45058|New|Nor|2008-05-21|Mod_SSL does not set AUTH_TYPE with client certifi|
|45078|New|Nor|2008-05-27|mod_proxy stalls when uploading files             |
|45103|Ass|Min|2008-05-30|apachectl should do config test before reload/rest|
|45111|New|Enh|2008-06-01|make mod_usertrack use mod_unique_id if available |
|45116|New|Nor|2008-06-02|fail to check return value of apr_file_dup2() in /|
|45148|New|Enh|2008-06-06|The actual host of the request will be more helpfu|
|45184|New|Enh|2008-06-11|Regular Expression in directive ServerAlias       |
|45187|New|Maj|2008-06-11|Long File name requests gives FORBIDDEN response  |
|45225|New|Nor|2008-06-17|XBitHack breaks DirectoryIndex + MultiViews conten|
|45253|New|Nor|2008-06-23|Unable to build httpd 2.2.9 on Solaris/SPARC      |
|45257|New|Enh|2008-06-23|add (en)force option for UseCanonicalName         |
|45259|New|Enh|2008-06-23|Add /home/[a-z]/* scheme to UserDir conf          |
|45275|New|Maj|2008-06-25|Locked files during expired page renew in disk cac|
|45281|New|Enh|2008-06-25|SITE CHMOD/SEARCH                                 |
|45287|Inf|Min|2008-06-26|build failure because of difference between BSD an|
|45297|New|Min|2008-06-27|mod_dir does not manage correctly the user (r->use|
|45302|New|Enh|2008-06-28|ServerRoot directive                              |
|45355|New|Nor|2008-07-07|ab text and html output jumbo unification         |
|45356|New|Nor|2008-07-07|ab: optionally reduce resource usage (qsort and me|
|45371|New|Nor|2008-07-10|MSI installer requires uninstall of previous versi|
|45374|New|Blk|2008-07-10|Shared memory error on starting httpd with mod_lda|
|45379|Inf|Nor|2008-07-11|[Bug] svn merge, apache and trailing slashes      |
|45385|Inf|Nor|2008-07-11|unable to compile/make 2.2.9 with --enable-ldap   |
|45393|New|Nor|2008-07-14|Apache returns 500 Error when no LDAP credentials |
|45402|New|Nor|2008-07-15|mod_autoindex incorrectly fails to list files     |
|45405|New|Enh|2008-07-16|Allow binding port to be set for individual worker|
|45449|New|Nor|2008-07-21|[PATCH] Add support to WebDav to MOVE/COPY to remo|
|45456|New|Enh|2008-07-22|mod_dbd don't allow more then one database pool   |
|45487|New|Trv|2008-07-27|broken log messages on startup in win32 version   |
|45497|New|Nor|2008-07-29|Scoreboard slot leaked using MaxRequestsPerChild a|
|45512|Ass|Maj|2008-07-31|Bad Performance of mod_proxy with SSL on Solaris 1|
|45524|New|Enh|2008-08-01|Specifying multiple vhost aliases                 |
|45525|New|Enh|2008-08-01|Switch mod_autoindex to Tango icons               |
|45579|New|Nor|2008-08-06|unknown URI scheme in request-URI ignored         |
|45674|New|Enh|2008-08-22|Allow to change error code returned by "Require ld|
|45726|New|Enh|2008-09-02|Build in a maintenance functionallity             |
|45736|New|Nor|2008-09-03|mod_dav needs a directory for its locks and one sh|
|45754|New|Enh|2008-09-06|autoconf macros                                   |
|45763|New|Nor|2008-09-08|No openssl.cnf defined by default causes OpenSSL c|
|45773|New|Nor|2008-09-09|pcre build generates sources to srcdir rather than|
|45788|New|Nor|2008-09-11|mod_log_forensic output shouldn't be buffered when|
|45801|Opn|Nor|2008-09-13|SSLRequireSSL with strictrequire and satisfy any d|
|45838|New|Nor|2008-09-18|mod_authz_owner & directories                     |
|45868|New|Nor|2008-09-23|mod_mem_cache update of headers in cache object is|
|45900|New|Nor|2008-09-26|"make install" fails from read-only filesystem    |
|45905|New|Enh|2008-09-26|ErrorDocument and default URL                     |
|45922|New|Enh|2008-09-30|Expand the conditions under which "SSLVerifyClient|
|45923|New|Nor|2008-09-30|htpasswd tries to open(file, O_RDONLY | O_APPEND) |
|45926|Inf|Nor|2008-10-01|Unable to start apache 2.2.9                      |
|45986|New|Nor|2008-10-10|[info]...Invalid argument: core_output_filter: wri|
|46024|Opn|Nor|2008-10-16|--enable-static is not available in apache's confi|
|46037|Inf|Nor|2008-10-18|Configuration of trusted OCSP responder certificat|
|46040|New|Enh|2008-10-20|Check for existing version of Apache while install|
|46054|New|Nor|2008-10-21|Running httpd returns the error "bad user name nob|
|46070|New|Nor|2008-10-22|MSI installer does not validate custom installatio|
|46071|New|Enh|2008-10-22|Allowing space in between comma and last option in|
|46074|New|Enh|2008-10-23|Need of friendly and easy to use configuration gra|
|46139|New|Nor|2008-11-02|Apache Restart option is not working              |
|46140|New|Enh|2008-11-03|Change error state in balancer manager            |
|46188|Inf|Nor|2008-11-11|Core dumps in apache 2.0.59                       |
|46195|Opn|Nor|2008-11-12|ProxyPass fails with literal IPv6 address         |
|46215|New|Nor|2008-11-14|Race condition in bybusyness algorithm            |
|46231|New|Maj|2008-11-18|Connection Pooling with ajp depends on syntax ?   |
|46241|New|Enh|2008-11-19|mod_expires - ExpiresByPattern or ExpiresIf       |
|46267|New|Nor|2008-11-22|No shared modules build if use --with-apr and --wi|
|46270|New|Enh|2008-11-23|Add FIPS 140-2 mode for mod_ssl for FIPS 1.2 modul|
|46282|New|Nor|2008-11-24|apache2.2 reverse proxy causing full memory and sw|
|46316|New|Maj|2008-12-01|Proxied SSI ProxyTimeout render failure           |
|46317|Inf|Nor|2008-12-01|mod_authnz_ldap.c(373)  seg fault                 |
|46412|New|Nor|2008-12-17|make_child return value not checked               |
|46417|New|Cri|2008-12-19|[notice] Parent: child process exited with status |
|46428|Opn|Nor|2008-12-21|Spaces in URI doesn't encode in proxy-requests    |
|46442|New|Nor|2008-12-29|Semicolon in allow/deny all rules cause reverse lo|
|46449|New|Maj|2008-12-30|Output out of order from SSI include virtual      |
|46454|New|Min|2008-12-30|escaping wildcards in AddIcon filename matching   |
|46475|New|Nor|2009-01-04|build warnings.                                   |
|46499|New|Maj|2009-01-09|httpd accept() return EAGAIN error                |
|46521|New|Maj|2009-01-13|mod_dav doesn't show symlinks                     |
|46529|Ass|Nor|2009-01-14|Child httpd processes crash with Segmentation faul|
|46534|New|Nor|2009-01-14|mod_proxy_ajp scheme and port do not follow UseCan|
|46578|New|Nor|2009-01-21|Flawed header                                     |
|46582|Ver|Min|2009-01-22|RewriteMap internal functions are not well documen|
|46604|New|Nor|2009-01-26|Error thrown when trying to rpmbuild -tb httpd sou|
|46629|New|Maj|2009-01-29|Apache hanging on system calls for php and perl   |
|46634|Ass|Nor|2009-01-30|Requests sometimes take too long, wrong time taken|
|46644|New|Enh|2009-01-31|Clean way to pass custom environment variables to |
|46646|Ass|Nor|2009-02-01|check group membership is sometimes case sensitive|
|46650|Opn|Nor|2009-02-02|CustomLog enviroment condition SCRIPT_FILENAME    |
|46656|New|Enh|2009-02-03|ProxyErrorOverride inside location                |
|46669|New|Enh|2009-02-06|rotatelogs doesn't autocreate directories         |
|46671|Opn|Cri|2009-02-07|Apache periodicaly crashes .                      |
|46678|New|Nor|2009-02-09|Fixed Content-Length using mod_ext_filter with mod|
|46682|New|Nor|2009-02-09|mod_proxy EAI_AGAIN DNS failure                   |
|46685|Opn|Nor|2009-02-09|401 sent without WWW-Authenticate header when requ|
|46709|Opn|Reg|2009-02-12|Expect: 100-continue to an HTTP/1.0 server change |
|46724|Inf|Cri|2009-02-17|WinXP SP3 - Apache crashes on startup in libapr-1.|
|46743|New|Nor|2009-02-19|Inconsistent behavior of "RewriteOptions inherit" |
|46745|New|Maj|2009-02-20|ab.c error :  undefined reference to `BIO_set_call|
|46751|New|Nor|2009-02-21|Can passenv variables who's name contain '(' or ')|
|46762|New|Nor|2009-02-24|Error, SSL/TLS libraries were missing or unusable |
|46765|Opn|Nor|2009-02-25|doubled HTTP header leads to error (Redmine)      |
|46785|Inf|Nor|2009-03-02|Child process increases to 100% (CPU)             |
|46788|New|Nor|2009-03-02|Set resource limits to avoid denial of service att|
|46810|New|Nor|2009-03-05|apxs / apu-1-config outputting erroneous include p|
|46824|New|Nor|2009-03-09|RemoveOutputFilter will not work for Filters added|
|46845|Inf|Cri|2009-03-12|Apache crashes in Windows when using subversion(pr|
|46847|New|Nor|2009-03-13|WebDAV methods with encoding other than "identity"|
|46873|New|Nor|2009-03-18|feature request: connection count on balancer-mana|
|46884|New|Min|2009-03-20|Call to apu_dso_load Fails In apr_ldap_stub.c On O|
|46946|Inf|Nor|2009-03-31|mod_mbox shows email addresses in plain text      |
|46963|New|Nor|2009-04-03|KeepAliveTimout prevents child process from exitin|
|46969|New|Nor|2009-04-05|CustomLog format %m always GET on errors with loca|
|46970|New|Nor|2009-04-05|CustomLog %X does not record aborted connections w|
|47011|New|Reg|2009-04-09|mod_proxy/mod_proxy_balancer hot-standby BalancerM|
|47055|New|Blk|2009-04-20|SSLVerifyClient + Directory doesn't use cache sess|
|47063|New|Nor|2009-04-21|mod_proxy doesn't call post_request handler when t|
|47134|New|Nor|2009-05-01|Last resolve handling when sending client certific|
|47138|New|Nor|2009-05-01|Reverse Proxy & Balancer generate error fault when|
|47152|New|Maj|2009-05-04|Apache is only serving the first character in the |
|47159|New|Nor|2009-05-06|2.2.x logresolve doesn't support ipv6             |
|47167|New|Nor|2009-05-07|Authenticated sessions being switched by reverse p|
|47170|New|Enh|2009-05-08|rotatelogs ring buffer option                     |
|47180|New|Nor|2009-05-11|DBM ssl_scache setting can cause extreme performan|
|47220|Opn|Enh|2009-05-19|Access to environment variables                   |
|47256|New|Enh|2009-05-23|Enable SSL on a per-port basis                    |
|47289|New|Nor|2009-05-30|Can't build with dynamic libraries on Mac OS 10.4 |
|47295|New|Nor|2009-06-01|AuthDBDUserPWQueryFmt/AuthDBDUserRealmQueryFmt in |
|47329|New|Nor|2009-06-07|SSLCADNRequest* & SSLCACertificate* silently do no|
|47340|New|Nor|2009-06-09|uldap_cache_comparedn() called without a lock     |
|47344|New|Enh|2009-06-10|[FEATURE REQUEST] RedirectCanonicalName           |
|47345|New|Enh|2009-06-10|rotatelogs timeout patch                          |
|47346|New|Maj|2009-06-10|mod_cache doesn't re-cache expired content when La|
|47387|Inf|Nor|2009-06-18|SSL_CLIENT_I_DN and SSL_CLIENT_S_DN use Email inst|
|47392|Opn|Nor|2009-06-18|<FilesMatch> is using the wrong directory         |
|47435|New|Nor|2009-06-26|mod_authz_host does reading of /etc/hosts on each |
|47438|Inf|Enh|2009-06-27|how to create a non-html "listing generated by the|
|47447|New|Enh|2009-06-29|Add possibility to use client IP as a value in Req|
|47484|New|Nor|2009-07-06|Spurious RewriteLock warning when using external m|
|47485|New|Enh|2009-07-06|HTML5 Websocket implementation                    |
|47514|New|Enh|2009-07-12|Personal data and restrictions based on subject di|
|47528|New|Maj|2009-07-14|Worker process won't restart more than once using |
|47542|New|Nor|2009-07-16|Piped logging processes killed before other proces|
|47562|Inf|Nor|2009-07-23|Apache/2.2.3 (Win32) mod_perl/2.0.3-rc1           |
|47578|New|Nor|2009-07-24|compile ERROR with ssl                            |
|47580|Opn|Nor|2009-07-25|mod_cache sends 200 response instead of 304       |
|47586|New|Nor|2009-07-27|httpd -k start doesn't start service when rotatelo|
|47591|New|Min|2009-07-27|show current HTTP_HOST in mod_status scoreboard   |
|47601|New|Enh|2009-07-29|Support X-Forwarded-For in forward proxy requests |
|47625|New|Nor|2009-08-02|2.2.12 win32 msi installer missing                |
|47634|New|Maj|2009-08-04|mod_ldap connection pool session keepalive not imp|
|47643|New|Enh|2009-08-04|added meta tags to xhtml output for ease of search|
|47650|Opn|Trv|2009-08-05|httxt2dbm calculates value size incorrectly       |
|47657|New|Nor|2009-08-06|Make WebDAV MOVE atomic when replacing files on sa|
|47659|New|Nor|2009-08-07|makefile.win needs check for DBM_LIST, dies on bui|
|47664|New|Nor|2009-08-07|ap_proxy_canonenc: does not recode all high-byte c|
|47665|Inf|Blk|2009-08-09|Apache service well launched but blank Screen     |
|47691|New|Enh|2009-08-12|libtool invocations should use --tag              |
|47693|Opn|Nor|2009-08-13|GET request has race condition w.r.t. replacement |
|47706|Inf|Nor|2009-08-19|(20014)Internal error: proxy: error reading status|
|47716|New|Min|2009-08-20|LimitRequestFieldSize and friends not merged well |
|47719|Opn|Enh|2009-08-20|Broken symbolic link (symlink) causes wrong ErrorD|
|47723|New|Nor|2009-08-22|suEXEC and low RLimitMem gives "crit: invalid uid"|
|47743|Inf|Nor|2009-08-26|mod_so segfaults at server startup in ap_find_load|
|47753|New|Nor|2009-08-27|output and error channels not explicitly passed fo|
|47778|Opn|Enh|2009-09-03|wrong exit value on graceful restart              |
|47780|New|Nor|2009-09-03|Critical errors should be marked by time and level|
|47807|Inf|Nor|2009-09-09|Proxy dialog error with Apache 2.2.13             |
|47808|New|Maj|2009-09-09|Child process core dumps when enabling CRL        |
|47814|Inf|Maj|2009-09-10|openssl_pkcs7_sign error                          |
|47838|New|Enh|2009-09-14|Ability to Dynamically Inject Current Time Into a |
|47874|New|Nor|2009-09-18|mod_fcgid crashes if added during restart         |
|47895|New|Maj|2009-09-24|Incorrect 413 error handling                      |
|47908|New|Min|2009-09-27|'invalid result code' in error_log                |
|47981|New|Nor|2009-10-12|allow language specific html-versions (index.html.|
|47982|New|Nor|2009-10-12|correctly interprete non-standard HTTP_ACCEPT_LANG|
|47988|New|Nor|2009-10-12|Segmentation fault                                |
|47989|New|Nor|2009-10-13|Junk string appended to compressed dynamic content|
|47994|New|Enh|2009-10-14|ScriptInterpreterSource apparently broken in Windo|
|48020|New|Nor|2009-10-17|KCP+ Opera support for mod_auth_digest            |
|48037|Inf|Nor|2009-10-21|mod_proxy_http does not handle asynchronous keepal|
|48045|New|Nor|2009-10-23|Apache 2 initgroups alert, Max OS X, abnormal exit|
|48057|New|Nor|2009-10-26|mod_fcgid creates 1 more process then allowed     |
|48094|New|Nor|2009-11-01|Avoid a race condition in close_worker_sockets()  |
|48107|New|Maj|2009-11-02|Mutual Authentication: Order in ca-bundle influenc|
|48115|New|Enh|2009-11-03|Duration to receive the request, generate response|
|48130|New|Maj|2009-11-04|DAV operations on large filesets consume all the O|
|48154|New|Nor|2009-11-06|Requests through mod_isapi are not parsed by HTTP_|
|48164|New|Enh|2009-11-09|add new parameters to rotatelogs                  |
|48219|New|Nor|2009-11-17|Retrying the worker for seems to omit POST variabl|
|48228|New|Nor|2009-11-18|Renegocation requires multiple client authenticati|
|48246|New|Enh|2009-11-19|Check permissions on file/directory specified for |
|48254|New|Trv|2009-11-20|Bogus "DocumentRoot does not exist" warning when s|
|48283|New|Nor|2009-11-25|Proxy errors since httpd 2.2.12 with Tomcat 6.0.20|
|48291|New|Maj|2009-11-26|mod_substitute loops                              |
|48295|Opn|Nor|2009-11-27|ProxyPassReverseCookiePath: Not changing path corr|
|48301|New|Enh|2009-11-30|Feature request: improved connection status report|
|48309|New|Maj|2009-11-30|libapreq2-2.12: "make test" fails at request.t and|
|48312|Opn|Nor|2009-11-30|ProxyPassReverseCookiePath: Not changing path corr|
|48316|Inf|Nor|2009-12-01|ap_run_insert_filter doesn't work in cache_url_han|
|48354|New|Enh|2009-12-08|void ap_custom_response is not supporting the bina|
|48360|New|Enh|2009-12-09|provide sample configuration file for inclusion in|
|48361|New|Enh|2009-12-09|Add global server option for specifying desired DS|
|48364|Opn|Nor|2009-12-10|PHP-generated pages are not cached in spite of per|
|48369|New|Enh|2009-12-10|add option to automatically restart if a script is|
|48431|New|Nor|2009-12-22|Error logging doesn't work when configured to use |
|48440|Inf|Cri|2009-12-23|Segmentation Fault                                |
|48449|Inf|Nor|2009-12-28|make distclean removes core.c and core_filters.c  |
|48465|Opn|Enh|2009-12-30|Support TCP to connect to backends                |
|48499|New|Nor|2010-01-06|mod_rewrite can't redirect to files with ? in them|
|48500|New|Nor|2010-01-06|mod_mbox mishandles right-click to open msg in new|
|48508|New|Nor|2010-01-07|BalancerMember doesn't accept nocanon directive   |
|48549|New|Enh|2010-01-14|Add Cache-Control s-maxage support                |
|48576|New|Nor|2010-01-19|MOVE or COPY in WebDAV fails with 404 when file ex|
|48585|New|Enh|2010-01-20|mod_cache no longer caches expired content        |
|48602|New|Enh|2010-01-23|use asynch ldap_compare so LDAPTimeout applies    |
|48623|New|Maj|2010-01-26|AuthLDAPURL syntax is not RFC-compliant, prevents |
|48639|New|Enh|2010-01-29|Add htcacheclean as a core monitored process      |
|48652|New|Maj|2010-02-01|"AuthType form" fails if a password contains  '&' |
|48659|New|Maj|2010-02-02|Problem with accents in filename and byte serving |
|48687|New|Nor|2010-02-05|mod_rewrite ignores trailing dot in request URI on|
|48705|New|Enh|2010-02-08|flag to allow newlines in the error log as opposed|
|48712|New|Enh|2010-02-09|Add UID and GID to status page                    |
|48719|New|Nor|2010-02-09|[BUG] mod_proxy_ajp return wrong error message whe|
|48721|New|Nor|2010-02-10|[Patch] Add ProxyAllow to mod_proxy               |
|48731|New|Maj|2010-02-11|Prefork not creating processes after 10 servers ar|
|48732|New|Nor|2010-02-12|[BUG] environment variable SCRIPT_NAME output erro|
|48769|New|Nor|2010-02-18|[PATCH] Processes in the busy list should not be k|
|48777|New|Maj|2010-02-19|proxy balancer not detecting correctly when host (|
|48780|New|Enh|2010-02-19|Enable mod_authnz_ldap to accept valid client cert|
|48792|New|Enh|2010-02-22|httpd util apachectl returns wrong status informat|
|48805|New|Nor|2010-02-23|Corrupted response for HTTPS + KEEPALIVE=ON       |
|48808|New|Enh|2010-02-24|mod_authz_owner support for POSIX access control l|
|48819|Inf|Nor|2010-02-25|After users login on the web page, the page does n|
|48842|Inf|Nor|2010-03-02|mod_log_config logs the full size of the file inst|
|48880|Opn|Nor|2010-03-09|error on make                                     |
|48888|New|Nor|2010-03-10|DOCTYPE definitions nearly 11 years out-of-date   |
|48920|New|Enh|2010-03-15|Breadcrumbs on mod_autoindex path                 |
|48921|Inf|Nor|2010-03-16|mod_mem_cache crash, version 2.2.15.0             |
|48937|New|Enh|2010-03-18|Feature proposal - support sasl_bind              |
|48949|Inf|Cri|2010-03-20|fcgid processes never get killed after graceful re|
|48958|New|Nor|2010-03-22|mod_ldap, ldap credential cache & graceful restart|
|48987|New|Trv|2010-03-25|typo in polish translation of HTTP_UNAUTHORIZED.ht|
|49037|New|Enh|2010-04-02|SSLVerifyClient require_no_ca                     |
|49043|New|Maj|2010-04-04|Using ssi include directive overwrites QUERY_STRIN|
|49058|New|Nor|2010-04-06|Prefork MPM tries to accept on closed listener soc|
|49067|New|Nor|2010-04-08|FTPOptions ShowUnAuthorizedFiles does not work    |
|49068|New|Nor|2010-04-08|UTF-8 URL Encode error                            |
|49087|New|Maj|2010-04-11|MSI installation reports "interrupted installation|
|49114|New|Maj|2010-04-13|NTFS junction directories missing from directory l|
|49123|New|Nor|2010-04-14|mod_proxy_ajp does not send the client's SSL chain|
|49131|New|Nor|2010-04-15|Very long URLs cause 404 or 403 errors with SetAct|
|49133|New|Maj|2010-04-16|Windows service recovery options do not work for A|
|49157|New|Nor|2010-04-20|Issues with xml interface for balancer manager    |
|49187|New|Nor|2010-04-26|Crash mod_mem_cache and mod_svn                   |
|49199|New|Enh|2010-04-27|Implement LDAP scope-aware caching in mod_ldap    |
|49220|New|Nor|2010-04-29|feature request for being able to disable FcgidWra|
|49239|New|Blk|2010-05-01|Apache mod_ssl gives coredump with openssl 0.9.8  |
|49277|New|Nor|2010-05-12|Expose a variable to identify SSL Session renegoti|
|49283|New|Nor|2010-05-12|Language of dates on SSI                          |
|49285|New|Enh|2010-05-13|Relative (local to current directory) URLs do not |
|49348|New|Enh|2010-05-27|[mod_log_config] Output log file name format capab|
|49385|New|Maj|2010-06-03|mod_disk_cache server side included files are inte|
|49387|Inf|Cri|2010-06-03|Unable to modify default charset setting to UTF-8 |
|49391|New|Nor|2010-06-05|mod_disk_cache needs to register a cleanup to kill|
|49396|New|Enh|2010-06-06|PATH_INFO normalization, especially relating to vo|
|49427|New|Nor|2010-06-11|mod_cgid and mod_cgi do not return proper value wh|
|49433|New|Enh|2010-06-13|improving info in server status                   |
|49439|New|Nor|2010-06-14|Bug in mod_userdir which prevents suexec from runn|
|49504|New|Nor|2010-06-25|Solaris 10/x64 worker graceful restart problem    |
|49532|New|Nor|2010-06-30|mod_cache: Set-Cookie headers are appended to cach|
|49553|New|Min|2010-07-05|Set QoS bits via APR2 API instead                 |
|49568|New|Maj|2010-07-07|Apache mod_authnz_ldap built with the MS LDAPSDK d|
|49632|Inf|Nor|2010-07-21|mod_authnz_ldap denies users when search is perfor|
|49633|New|Enh|2010-07-21|Handle AD primary groups in mod_authnz_ldap       |
|49642|New|Nor|2010-07-23|mod_rewrite mistakes encoded question mark as path|
|49643|New|Nor|2010-07-23|WebDav plus mod Negotiation causes directory creat|
|49676|New|Nor|2010-07-30|directory with german umlauts are indented by one |
|49680|New|Maj|2010-07-30|Perl script are not running on Win32, Apache 2.2.1|
|49684|New|Enh|2010-08-01|enhancement for ipv6 implementation               |
|49699|New|Nor|2010-08-03|Inconsistent Keep-alive from proxy to the origin s|
|49715|New|Maj|2010-08-06|ProxyPassMatch Url Encoder Problem                |
|49717|New|Enh|2010-08-06|PATCH: Enable SSL Timeout                         |
|49737|Inf|Nor|2010-08-10|order allow,deny does not work on IPv6            |
|49743|New|Maj|2010-08-12|SSI 'echo encoding="(url/none)"' bug              |
|49746|Opn|Enh|2010-08-12|mod_rewrite urlencode option                      |
|49766|New|Maj|2010-08-17|POST request on CGI script generating empty body c|
|49771|New|Nor|2010-08-17|After graceful restart using mod_proxy_ajp, couldn|
|49772|New|Nor|2010-08-18|mod_deflate kicks itself out on Content-Range resp|
|49798|Opn|Nor|2010-08-22|[mod_log_config] Piped Log scripts process cause w|
|49807|New|Enh|2010-08-23|hard to force Content-Type header for non static f|
|49810|New|Nor|2010-08-23|Mod_autoindex output of header/body/footer scrambl|
|49815|New|Enh|2010-08-24|Enable caching for HTTP Range requests / 206 respo|
|49829|New|Trv|2010-08-26|CGI index command line arguments excessively escap|
|49832|New|Enh|2010-08-26|void ap_custom_response is not supporting the bina|
|49859|Opn|Nor|2010-09-01|url with additional filepath generates bad environ|
|49921|New|Nor|2010-09-13|Trailers in chunked http requests are not handled |
|49926|New|Enh|2010-09-14|New option for mod_log_forensics or mod_log_config|
|49980|New|Nor|2010-09-22|can't use a FIFO for SSL key file; mod_ssl checks |
|49981|New|Enh|2010-09-22|Requesting SSLCertificateKeyFile Dialog functional|
|49990|New|Nor|2010-09-23|Feature request: implement ExpiresActive reset    |
|49996|New|Nor|2010-09-24|Proxied ErrorDocument returns 200 OK response code|
|49997|New|Nor|2010-09-24|wrowe promised me...                              |
|50004|New|Nor|2010-09-26|per-dir rewrite without DocumentRoot or RewriteBas|
|50011|New|Cri|2010-09-27|error running apache, and installing apache as a s|
|50024|New|Min|2010-09-29|Mod_cache/mod_mem_cache and mod_security combinati|
|50038|New|Enh|2010-10-01|What Directives apply to a file/directory? Resulta|
|50041|New|Min|2010-10-04|(9)Bad file descriptor: apr_socket_accept: (client|
|50051|New|Nor|2010-10-07|Log PID in first entry logged for each request    |
|50061|New|Nor|2010-10-08|Semicolon character '%3B' seems to be decoded to '|
|50082|New|Nor|2010-10-12|apachectl status returns incorrect exit code      |
|50112|New|Nor|2010-10-18|buildconf broken in two places                    |
|50116|New|Nor|2010-10-19|Apache fragments packets unnecessarily            |
|50151|New|Nor|2010-10-25|Software caused connection abort and apache proces|
|50155|Inf|Nor|2010-10-25|httpd -s attempts to read SSL certificates        |
|50172|Inf|Nor|2010-10-28|Digest allows access bypassing secuity            |
|50227|New|Enh|2010-11-07|Option to fail SSL handshake for diverted SNI conn|
|50237|Inf|Nor|2010-11-08|webdav LOCK access with multiple threads to same f|
|50261|New|Nor|2010-11-12|graceful restart with multiple listeners using pre|
|50262|New|Nor|2010-11-12|mod_rewrite log ip address vs hostname            |
|50274|New|Nor|2010-11-15|always pass CONTENT_LENGTH to the application     |
|50278|New|Nor|2010-11-16|-DFOREGROUND and ap_unixd_killpg()/ap_os_killpg() |
|50290|Inf|Nor|2010-11-18|vanilla apache 2.2.17 installation crashes (lib-ap|
|50296|New|Nor|2010-11-18|LDAPVerifyServerCert and possibly LDAPTrustedMode |
|50317|New|Nor|2010-11-22|Possible error in mod_cache's "Avoiding the Thunde|
|50336|New|Min|2010-11-25|PUT failures do not emit Allow:                   |
|50344|New|Nor|2010-11-26|ProxyPass does not handle different protocols when|
|50357|New|Enh|2010-11-28|improve matching mechanisms for mime type and enco|
|50372|New|Enh|2010-11-29|any reason for allowing ModMimeUsePathInfo only in|
|50390|New|Nor|2010-11-30|WARNING: Unrecognized options : --disable-ipv6    |
|50402|New|Nor|2010-12-02|SetEnv proxy-sendchunks is ignored for small amoun|
|50412|New|Nor|2010-12-04|if IndexOptions +XHTML, the correct MIME type shou|
|50423|Inf|Nor|2010-12-06|Apache is terminated with signal 11, Segmentation |
|50427|New|Nor|2010-12-07|Windows>=Vista+mod_auth_digest+command line=proble|
|50432|New|Enh|2010-12-08|add PCRE-mode for file based matches              |
|50436|New|Enh|2010-12-08|VirtualHost could behave like people expect it to |
|50444|New|Enh|2010-12-09|Pre-close logging handles in cgid agent           |
|50456|Inf|Nor|2010-12-10|Invalid Error 413 crash Apache                    |
|50464|New|Blk|2010-12-13|undefined reference to `BIO_set_callback' `BIO_set|
|50466|Inf|Maj|2010-12-13|httpd process doesn't recycle                     |
|50473|New|Maj|2010-12-14|zlib.dll Problem                                  |
|50521|New|Nor|2010-12-25|Comment at top of sample main config file is wrong|
|50525|New|Nor|2010-12-28|Header directive won't edit Location header from P|
|50530|New|Enh|2010-12-29|Provide rate limiting for failed authentication at|
|50532|New|Enh|2010-12-30|Mail protection                                   |
|50551|New|Nor|2011-01-06|Some proxied connections ignore ttl setting       |
|50562|Opn|Cri|2011-01-09|wrong PATH_INFO CGI environment with non-ASCII UTF|
|50584|New|Enh|2011-01-14|Add error message when RequestReadTimeout triggere|
|50592|New|Maj|2011-01-15|httpd dumps core on an IPv6 only system           |
|50602|New|Nor|2011-01-17|non thread safe functions used in apache httpd pro|
|50619|New|Min|2011-01-19|After changing resolv.conf signaling httpd doesn't|
|50628|New|Blk|2011-01-21|Core dump happens with Apache 2.2.15 using openssl|
|50630|New|Nor|2011-01-21|Apache return 500 error with authentication by LDA|
|50644|New|Enh|2011-01-24|Add support for maximum number of requests per Kee|
|50654|New|Nor|2011-01-25|FileETag ContentMD5 & Filename, optimisation to Co|
|50693|New|Nor|2011-01-31|AllowOverride Options=(not Foo) should permit no-o|
|50704|Inf|Nor|2011-02-01|mod_cache doesn't cache MultiViews                |
|50712|New|Maj|2011-02-02|Restart button only stops the server ...and do not|
|50727|New|Nor|2011-02-07|ISAPI EXTENSION_CONTROL_BLOCK Missing PostData wit|
|50765|New|Enh|2011-02-11|Runtime Backend Pinning via balancer-manager      |
|50770|New|Nor|2011-02-14|a rotatelogs issue, if time changed               |
|50773|Inf|Nor|2011-02-14|Dav lock database corruption                      |
|50774|New|Enh|2011-02-14|Have a way to invalidate cache without other reque|
|50777|New|Nor|2011-02-14|Back port buildconf specifies AC_PREREQ(2.13) fix |
|50796|New|Enh|2011-02-16|record time between keepalives in access log      |
|50807|New|Maj|2011-02-18|mod_proxy fails to send FIN response when a FIN is|
|50814|New|Nor|2011-02-21|SSI exec not working on Windows (Apache 2.x)      |
|50848|New|Enh|2011-03-01|Content Negotiation type map file precedence could|
|50869|New|Enh|2011-03-04|Need directive to control use and timeout of sessi|
|50873|New|Nor|2011-03-04|httpd does not start properly when built from sour|
|50878|New|Nor|2011-03-05|redundant operation when calling apr_stat         |
|50891|New|Nor|2011-03-08|Apache rewrites WWW-Authenticate headers from CGI |
|50902|Inf|Maj|2011-03-09|on major load on the server, poll() hangs         |
|50916|New|Nor|2011-03-11|RewriteMap program: mod_rewrite sends request but |
|50926|New|Nor|2011-03-14|unexpected <Directory> file-matching behavior     |
|50942|New|Maj|2011-03-17|Apache 2.2.16 forward proxy is 5x times slower tha|
|50945|Opn|Nor|2011-03-18|AJP: Missing support for ErrorOverride            |
|50948|Opn|Nor|2011-03-19|Connection not closed when CGI dies waiting for PO|
|50954|New|Nor|2011-03-21|ProxyRemote doesnt use CONNECT method with https s|
|50959|New|Enh|2011-03-23|Add cache-manifest to the mime type list          |
|50976|New|Nor|2011-03-26|Apache losts client's ip (%a or %h) sometimes.    |
|50999|Opn|Nor|2011-03-30|it seems the configure wrong detect my apr-util ve|
|51001|New|Nor|2011-03-31|patch for hook ap_lua_run_lua_open                |
|51005|New|Enh|2011-04-01|Allow to use username in LDAP filter              |
|51006|New|Blk|2011-04-01|Apache consume all memory and swap when setup as r|
|51019|New|Enh|2011-04-04|[PATCH] Implementation of Asynchronous processing |
|51020|Opn|Nor|2011-04-04|[PATCH] Apache/mod_fcgid.so does not start in comp|
|51022|New|Nor|2011-04-05|Segmentation fault on PUT request                 |
|51030|New|Enh|2011-04-06|Way to terminate CGI immediatly after closing conn|
|51078|Inf|Nor|2011-04-18|[PATCH] mod_fcgid spawned CGI Processes gets orpha|
|51079|New|Enh|2011-04-18|[PATCH] mod_fcgid spawned CGI Process cannot imper|
|51080|New|Nor|2011-04-18|[PATCH] mod_isapi does not support Except:100-Cont|
|51103|Opn|Nor|2011-04-21|mod_reqtimeout does not drop connection and return|
|51104|Opn|Maj|2011-04-21|C++ support about httpd_config.h                  |
|51107|New|Min|2011-04-22|SetOutputFilter and SetInputFilter should allow "n|
|51118|New|Nor|2011-04-26|LDAP cache is cleared after graceful/restart and o|
|51127|New|Nor|2011-04-27|Make ProxyPassReverseCookiePath work as expected  |
|51168|New|Nor|2011-05-08|mod_status Total Traffic won't take account of int|
|51170|New|Nor|2011-05-09|I/O errors when using keep-alive + mod_ssl        |
|51174|New|Min|2011-05-09|SSLRequire predicates using OIDs unknown to openss|
|51186|New|Blk|2011-05-11|NEw Openssl 1.0.1 with new FIPS                   |
|51190|New|Min|2011-05-12|::/0 does not work with allow from and deny from  |
|51194|New|Nor|2011-05-13|FcgidWrapper does not support paths containing a s|
|51201|Inf|Nor|2011-05-15|Strange behavior REQUEST_METHOD & GET in mod_rewri|
|51223|New|Nor|2011-05-18|304 HTTP Not Modified strips out CORS headers     |
|51224|New|Nor|2011-05-18|mod_dav_fs should respect FileETag                |
|51239|New|Nor|2011-05-21|ap_get_client_block may block continuously sometim|
|51257|New|Nor|2011-05-24|Build failed when cross-compiling: ./gen_test_char|
|51258|Opn|Enh|2011-05-24|new features for mod_substitute                   |
|51296|New|Enh|2011-05-31|Dynamic engine support using SSLCryptoDevice suppo|
|51297|New|Nor|2011-05-31|Improve error handling during "UNLOCK"            |
|51303|New|Nor|2011-05-31|TraceEnable 500 error                             |
|51312|New|Nor|2011-06-01|mod_filter should support adding to the Vary heade|
|51322|New|Enh|2011-06-04|Prepend and append string to LDAP search parameter|
|51359|Inf|Enh|2011-06-11|Added shebang check for //! so that .js scripts wo|
|51365|New|Nor|2011-06-13|Mod_proxy mangles query string with mod_security  |
|51402|New|Nor|2011-06-21|"ForceLanguagePriority Fallback" not working as im|
|51406|New|Maj|2011-06-21|When listing files in subdirectories, the path is |
|51409|New|Nor|2011-06-21|Sorting options accepted by ls, but ignored       |
|51471|New|Nor|2011-07-04|<DirectoryMatch>ed IndexIgnore doesn't            |
|51479|New|Enh|2011-07-05|[PATCH] AB feature to optionally read in a reusabl|
|51491|New|Nor|2011-07-08|mod_dir breaks POSTs to URLs not ending in /      |
|51495|New|Nor|2011-07-11|mod_substitute cpu and memory limit               |
|51517|New|Maj|2011-07-16|mod_proxy_fcgi is not RFC 3875 compliant (SCRIPT_F|
|51522|Ver|Trv|2011-07-18|Wrong French translation in mpm.html ("Certains Mo|
|51542|New|Nor|2011-07-22|Apache HTTP Server vs PVS-Studio                  |
|51543|New|Nor|2011-07-22|Space in username not properly escaped in log file|
|51552|Inf|Cri|2011-07-25|Apache is not starting (2.2.15)                   |
|51573|New|Enh|2011-07-28|Easy way to erase log files                       |
|51576|Inf|Nor|2011-07-28|mod_rewrite rule stopped working                  |
|51600|New|Enh|2011-08-02|Loading the same certificate in multiple virtual h|
|51603|Inf|Maj|2011-08-02|Apache accepts completely bogus HTTP requests (pos|
|51607|Inf|Nor|2011-08-03|DBDPrepareSQL ( ap_dbd_prepare ) does not work cor|
|51629|New|Nor|2011-08-05|DocumentRoot check incorrect when running under ch|
|51674|New|Blk|2011-08-18|AJP Module Bad Request                            |
|51679|New|Min|2011-08-18|Code signature key expired                        |
|51689|New|Trv|2011-08-19|Cross compiling causes multiple Listen directives |
|51695|New|Trv|2011-08-20|Code clean up (ap_rputs merge)                    |
|51707|New|Nor|2011-08-22|ProxyPassReverse issues within <Location> (differe|
|51709|New|Nor|2011-08-23|ServerName/ServerAlias don't work if Host: header |
|51711|New|Nor|2011-08-23|mod_auth_digest have broken shared mem (nonce) cod|
|51718|New|Enh|2011-08-24|Feature Request: Add shorthand to redirect any Ser|
|51725|New|Nor|2011-08-26|Multiple Range: request accepted as "Range: n-m"  |
|51732|New|Nor|2011-08-29|Inconsistencies in log messages' verbosity levels |
|51747|New|Blk|2011-08-31|mod_fcgid loads entire request into memory while p|
|51757|Inf|Enh|2011-09-02|Add support for SASL auth in LDAP                 |
|51778|Inf|Cri|2011-09-07|while buliding(make) a unix source "httpd-2.2.20.t|
|51797|Inf|Maj|2011-09-10|Crash HTTPD(Windows)                              |
|51814|New|Enh|2011-09-14|mod_proxy in Apache HTTP 2.2 FIN_WAIT2 in server s|
|51858|Inf|Nor|2011-09-21|weird error for mod_rewrite with more then 3 param|
|51864|New|Nor|2011-09-22|mod_cache returns entire entity from origin server|
|51904|New|Nor|2011-09-28|output to stderr from cgi script causes script to |
|51951|New|Nor|2011-10-04|mod_mbox hang on some e-mails on press@a.o - was I|
|51964|Ver|Nor|2011-10-05|Documentation of RewriteRule flag skip unclear    |
|51965|New|Nor|2011-10-05|--with-z=DIR not being honored                    |
|51982|Opn|Nor|2011-10-06|ProxyPassReverse / balancer://cluster/ adds slash |
|51987|Inf|Nor|2011-10-07|RewriteRule doesn't work correctly with apache 2.3|
|51994|New|Enh|2011-10-07|Mod_authn_socache should have some way to flush th|
|52004|Ver|Trv|2011-10-10|Typo "indexe" in French translation of mpm.html   |
|52007|New|Nor|2011-10-10|Content-Length: 0 not set on proxy response       |
|52038|New|Nor|2011-10-16|NameWidth works incorrectly together with Charset=|
|52039|Inf|Nor|2011-10-16|Browser mode does not always work                 |
|52043|New|Nor|2011-10-17|Directories ".", "..", and "/" do not work correct|
|52081|New|Nor|2011-10-24|segfault if mbox files have unexpected names      |
|52090|New|Maj|2011-10-26|Apache thread hangs with error 500 when sending a |
|52120|Opn|Nor|2011-11-01|mod_cache edge case: uncacheable 304 sends cached |
|52123|New|Maj|2011-11-02|DoS: High memory usage in propfind                |
|52132|New|Nor|2011-11-03|[PATCH] process activity score calculated incorrec|
|52139|New|Nor|2011-11-05|Never Syntax Error on non-existent DocumentRoot   |
|52171|Ver|Nor|2011-11-13|confusing documentation of request phases         |
|52174|New|Enh|2011-11-13|Allow hard lower-limits on the number of fcgi serv|
|52178|New|Nor|2011-11-14|IPv6 IPs as ServerName not allowed                |
|52181|Ver|Nor|2011-11-14|mod_rewrite Technical Details Ruleset Processing d|
|52195|Inf|Nor|2011-11-16|Japanese texts are garbled on mailing list archive|
|52196|Inf|Nor|2011-11-16|winnt mpm, others mpm also have this bug. pool sha|
|52207|Inf|Maj|2011-11-18|Upgrade apache version from 2.0.59 to 2.2.12 or ab|
|52222|New|Nor|2011-11-21|IndexIgnore ignores parent directories in argument|
|52247|New|Nor|2011-11-26|mod_mbox gives up on unexpected message format    |
|52248|New|Nor|2011-11-26|Bugzilla version drop-down list does not offer "un|
|52252|New|Nor|2011-11-27|luajit support broken for (at least) luajit 2.0   |
|52253|Inf|Nor|2011-11-28|Timeout doesn't work. mod_proxy_balancer strongly |
|52264|New|Enh|2011-11-30|Update and complete balancer-manager XML output   |
|52269|Inf|Nor|2011-12-01|[mod_proxy] Apache reverse proxy status code trans|
|52275|New|Nor|2011-12-02|memory leak in proxy_ajp_handler                  |
|52298|Inf|Nor|2011-12-07|Can't enter website with client certificate on an |
|52301|New|Enh|2011-12-07|Error message "RSA server certificate ... CN ... d|
|52302|New|Enh|2011-12-07|Better documentation of how server name is determi|
|52304|New|Nor|2011-12-08|<Limit> Does Not Apply When URI Is Folder         |
|52313|New|Enh|2011-12-09|htdbm enhancement: options for colon-in-username, |
|52322|Inf|Enh|2011-12-13|Providing BBC developed httpd modules for inclusio|
|52342|New|Nor|2011-12-15|ap_internal_redirect dropping filters means incons|
|52370|New|Nor|2011-12-19|apreq_decode/url_decode length miscalculation     |
|52377|New|Enh|2011-12-20|Add Directives to assert user, group, and permissi|
|52383|New|Trv|2011-12-24|Instllation log typo                              |
|52391|New|Cri|2011-12-27|100% CPU usage while using Forward Proxy          |
|52395|New|Nor|2011-12-29|reload results in different end environment to res|
|52403|New|Nor|2011-12-31|FallbackResource doesn't work for non-existent PHP|
|52408|New|Nor|2012-01-01|Directoryindex matching automatically redirects   |
|52415|New|Nor|2012-01-03|LockFile placed inappropriately                   |
|52417|New|Nor|2012-01-03|HEADERS information in the file                   |
|52435|New|Nor|2012-01-06|Apache shutdown automatically                     |
|52439|New|Nor|2012-01-09|It should be possible to treat errors in .htaccess|
|52453|New|Enh|2012-01-11|Ability to configure --logfiledir                 |
|52465|New|Nor|2012-01-13|mod_dir is allowed to redirect proxy requests     |
|52481|New|Nor|2012-01-18|Rotatelog.exe crashes Apache after setting 256MB r|
|52485|New|Nor|2012-01-19|CPU load 100%                                     |
|52494|New|Enh|2012-01-22|allow the Action directive to point in the filesys|
|52495|New|Enh|2012-01-22|CACertificate, CADNCertificate, CARevocation, Cert|
|52501|New|Cri|2012-01-23|child pid 10824 exit signal Segmentation fault (11|
|52505|New|Nor|2012-01-23|Include with directory wildcards gives errors for |
|52509|New|Nor|2012-01-23|Resources protected by .htaccess file may not be a|
|52510|New|Cri|2012-01-23|Segmentation Fault 11                             |
|52520|New|Nor|2012-01-24|ProxyRemote & NoProxy directive can not take IPv6 |
|52532|New|Trv|2012-01-26|VirtualHost added TWICE to name-virtual-host list |
|52539|New|Nor|2012-01-26|Apache mod_dav 400 Bad Request for non-existent co|
|52546|New|Nor|2012-01-27|overwrite SERVER_PROTOCOL environment             |
|52573|New|Nor|2012-02-01|mod_speling case correction fails when URI has dou|
|52578|Opn|Enh|2012-02-02|Wrong "bytes sent" logged when connection is close|
|52594|New|Nor|2012-02-03|rpmbuild -ba errors out with "File not found by gl|
|52595|New|Nor|2012-02-03|requests with gzip+chunked encoded body don't prox|
|52605|Inf|Min|2012-02-05|Please allow request lines longer than 8k         |
|52612|New|Nor|2012-02-06|Default Service Account                           |
|52616|Opn|Enh|2012-02-07|SSLUserName uses SSL_CLIENT_S_DN insted of SSL_CLI|
|52617|New|Maj|2012-02-07|Visit the rewrite page from ServerAlias domain vho|
|52623|New|Nor|2012-02-08|does not build with pcre-8.30                     |
|52644|New|Nor|2012-02-12|document how SSL FakeBasicAuth works with strange |
|52668|New|Trv|2012-02-14|More future safe patch for old MSIE ssl-unclean-sh|
|52670|New|Trv|2012-02-15|please clarify the effect of SSLStrictSNIVHostChec|
|52683|New|Enh|2012-02-16|add a symlink option that rechecks the access perm|
|52700|Inf|Blk|2012-02-17|Not rendering html content instead displaying clie|
|52703|Inf|Maj|2012-02-18|SSL+SNI+client-auth "lost" after some time        |
|52710|New|Nor|2012-02-19|mod_fcgid should set PATH_INFO when configured in |
|52756|Inf|Trv|2012-02-24|proxy_html_module LoadModule line not created in h|
|52759|New|Cri|2012-02-24|Apache httpd child process consuming high CPU Util|
|52790|New|Nor|2012-02-28|ldap caching not sufficient                       |
|52795|Opn|Nor|2012-02-29|mod_fcgid fails to spawn process in C:\Program Fil|
|52806|New|Nor|2012-03-01|configure: --with-included-apr is not supported in|
|52807|New|Nor|2012-03-01|some random strings are accepted by "configure" as|
|52816|New|Nor|2012-03-03|Potential segfault in socache_shmcb_create        |
|52817|New|Nor|2012-03-03|Long directory path sucks (but it's really a valid|
|52822|New|Nor|2012-03-04|Quiet installation not fully quiet                |
|52824|Inf|Nor|2012-03-04|Conflicts between AllowOverride and AllowOverrideL|
|52828|New|Maj|2012-03-05|Child process is not replaced in Windows, after a |
|52832|New|Nor|2012-03-05|numerical configuration entry can be mistakenly in|
|52841|Opn|Nor|2012-03-06|[proxy_balancer:emerg] [pid 25593] AH01177: Failed|
|52851|New|Nor|2012-03-07|Core TimeOut directive doesn't work               |
|52860|New|Enh|2012-03-08|Support Transfer-Encoding: gzip                   |
|52865|New|Nor|2012-03-09|Crash by segmentation fault in mod_authn_core in A|
|52870|New|Cri|2012-03-09|100% CPU usage while using Forward Proxy          |
|52874|New|Enh|2012-03-09|Support Use TrustedFirst checking when verifying c|
|52884|New|Nor|2012-03-12|"localhost" leads to start failure                |
|52890|Inf|Nor|2012-03-12|--with-included-apr doesn't work when srclib/apr a|
|52891|New|Nor|2012-03-12|2.2 doesn't perform as well as 1.3                |
|52894|Inf|Nor|2012-03-13|Apache aborts abnormally when ChrootDir is set    |
|52927|Inf|Nor|2012-03-16|[Bug in httpd 2.2.4] [error] (70014)End of file fo|
|52933|New|Nor|2012-03-17|Child survives '-k stop', consuming lots of CPU   |
|52950|New|Nor|2012-03-20|Error when set AuthType to None with valid-user   |
|52963|New|Nor|2012-03-21|Typo in AuthLDAPURL RFC 2255 error message        |
|52975|New|Nor|2012-03-23|Receiving files is suboptimal                     |
|52976|New|Min|2012-03-23|Gratuitous string-duplication in module-configurat|
|52978|New|Enh|2012-03-23|Binding to an interface instead of an address     |
|52995|New|Nor|2012-03-28|httpd -V does not print the default Mutex         |
|53002|New|Nor|2012-03-29|<Location> and auth_form (trailing slash problem?)|
|53015|New|Nor|2012-03-31|missing apr_socket_close                          |
|53016|New|Nor|2012-03-31|missing apr_brigade_destroy                       |
|53023|New|Nor|2012-04-02|mod_rewrite RewriteCond parser error and documenta|
|53037|New|Enh|2012-04-05|clarify mod_ssl documentation on the UID/GID conte|
|53059|New|Nor|2012-04-10|Make httpd easier relocatable by using a variable |
|53098|New|Nor|2012-04-18|mod_proxy_ajp: patch to set worker secret passed t|
|53099|New|Enh|2012-04-18|feature request for mod_remoteip                  |
|53108|New|Enh|2012-04-19|clarification on url-path vs full filesystem path |
|53111|New|Nor|2012-04-20|1% of CMS sites expose database passwords         |
|53121|New|Nor|2012-04-22|Confusing documentation, gzip and deflate         |
|53149|New|Enh|2012-04-25|mod_ldap should/could use mod_socache             |
|53152|Opn|Nor|2012-04-26|RewriteRule documentation: Error about per-directo|
|53156|New|Enh|2012-04-27|CRL validation fails if CRL is missing            |
|53160|New|Cri|2012-04-29|Reverse Proxy mod_deflate doesn't zip back content|
|53183|New|Min|2012-05-03|mod_apreq2 entry point is apreq_module and not apr|
|53193|New|Nor|2012-05-04|SLVerifyClient optional_no_ca + SSLSessionCache = |
|53218|New|Blk|2012-05-11|ProxyPass worker name(http://localhost:3128/...|
|53233|New|Maj|2012-05-15|Internal error: proxy: error reading status line f|
|53239|New|Maj|2012-05-16|Httpd has problems delivering data on rate-limited|
|53253|New|Maj|2012-05-17|TCP_NOPUSH used with sendfile(2), cause transfers |
|53284|New|Nor|2012-05-24|crash                                             |
|53290|New|Maj|2012-05-24|memory usage                                      |
|53292|New|Min|2012-05-25|add support for HTTP status code 308              |
|53305|New|Nor|2012-05-28|404 errors when adding query string in a balancer |
|53313|New|Nor|2012-05-28|SSI #echo VAR fails (#include OK) if URI/URL has f|
|53319|New|Nor|2012-05-29|Multiple DirectoryIndex statements in the same con|
|53332|New|Nor|2012-05-30|Requests with chunked encoding have no body availa|
|53350|New|Nor|2012-06-01|mod_cache caching 403 responses Apahce 2.2.22     |
|53351|New|Nor|2012-06-02|make fails if layout begins on first line of confi|
|53388|Opn|Nor|2012-06-08|mod_proxy_balanser generates 503 when proxying to |
|53402|New|Trv|2012-06-12|Incorrect error message for mod_ldap params       |
|53461|Inf|Cri|2012-06-23|Compilation problems                              |
|53462|New|Nor|2012-06-25|mod_rewrite does not remove trailing slash when as|
|53479|New|Nor|2012-06-27|mod_rewrite [B] flag should percent-encode the spa|
|53483|New|Enh|2012-06-29|dangerous PCRE patterns in *Match directives      |
|53539|New|Maj|2012-07-12|content type and character set are changing when t|
|53554|New|Nor|2012-07-16|Wrong case for hexadecimal percent encoding [patch|
|53555|New|Maj|2012-07-17|Scoreboard full error with event/ssl              |
|53579|New|Cri|2012-07-20|httpd looping writing on a pipe and unresponsive (|
|53581|New|Blk|2012-07-21|FollowSymlinks doesn't work with DirectoryMatch an|
|53594|New|Enh|2012-07-24|ipad as webserver                                 |
|53595|New|Nor|2012-07-24|Media type qs parameters for MultiViews sent in Co|
|53612|Inf|Nor|2012-07-27|Reverse Proxy causing 500 error SSL proxy 1.0.1c O|
|53618|New|Nor|2012-07-29|proxy_worker_shared fields not maintained in threa|
|53634|New|Nor|2012-08-01|mod_cache returning HTTP 200 for nonexistent resou|
|53638|New|Nor|2012-08-02|Problem with shortcuts to bugzilla in http://httpd|
|53640|Inf|Maj|2012-08-02|make: Fatal error: Command failed for target `htpa|
|53643|New|Cri|2012-08-02|apache segfaults with mod_authn_dbd when dbd_min i|
|53646|New|Nor|2012-08-02|Invalid uniformly distributed balancing of request|
|53651|New|Nor|2012-08-03|Worker failure doesn't have same behaviour as work|
|53667|New|Enh|2012-08-07|Add an equivalent option to "JkOptions ForwardLoca|
|53669|New|Nor|2012-08-07|IndexOptions Incremental IndexOptions documentatio|
|53686|New|Enh|2012-08-09|Status "501 Not Implemented" sent very late       |
|53690|New|Nor|2012-08-09|Calls to semctl() trigger "uninitialized memory" w|
|53692|New|Nor|2012-08-10|mod_auth_form loses request body before login page|
|53693|Opn|Nor|2012-08-10|mod_fcgid performance suffers under increase in re|
|53704|New|Enh|2012-08-13|True online configuration is needed - via LDAP?   |
|53705|New|Nor|2012-08-13|Align server-status balancer display to balancer-m|
|53706|New|Enh|2012-08-13|Include a status display for mod_ldap when present|
|53722|New|Nor|2012-08-15|when -D NO_DETACH is used, no PID file should be c|
|53736|New|Nor|2012-08-17|/balancer-manager doesn't save runtime adjusted se|
|53757|New|Enh|2012-08-21|RewriteMap of type txt should allow specifying col|
|53767|New|Nor|2012-08-23|htcacheclean deletes stale "vary" header files eve|
|53772|New|Nor|2012-08-24|REDIRECT_URL not accessible in mod_proxy          |
|53787|New|Reg|2012-08-28|In forward proxy, doesn't cache disk anymore      |
|53823|New|Nor|2012-09-03|[patch] pure IPv6 only host fix (server/config.c) |
|53835|New|Cri|2012-09-06|mod_proxy_ajp truncate output when using deflate i|
|53870|New|Maj|2012-09-13|Deadlock in CRYPTO_add_lock with Apache 2.2.22 wor|
|53886|New|Nor|2012-09-18|can't start apache control in Redhat Linux 3 X64  |
|53899|New|Nor|2012-09-19|SSL_OP_ALL disables the mitigation code for CVE-20|
|53915|New|Nor|2012-09-21|Colon lost when :port is used in CacheKeyBaseURL  |
|53919|Inf|Enh|2012-09-21|DEFAULT_LOG_FORMAT is not RFC6302 compliant       |
|53923|New|Min|2012-09-23|Overriding CustomLog directive seems impossible   |
|53932|New|Nor|2012-09-25|PROPFIND doesn't support If, If-Match ETag predica|
|53947|New|Enh|2012-09-29|Feature Request, RewriteRule - ProxyPreserveHost f|
|53961|New|Nor|2012-10-04|Null sessions to the default vhost                |
|53970|New|Nor|2012-10-05|Network control directives affects internal subreq|
|53981|New|Nor|2012-10-08|move def of log_request_state from mod_log_config.|
|53988|New|Enh|2012-10-10|Missing FCGIWrapper script should not be a critica|
|53999|Opn|Nor|2012-10-13|Deadlock between procmgr_send_spawn_cmd()/proctabl|
|54030|New|Enh|2012-10-19|Support subjectAltName when (reverse-)proxying    |
|54033|New|Enh|2012-10-21|Parent languages are not ordered according to Acce|
|54072|New|Reg|2012-10-30|Syntax error front-end virtual-path too long      |
|54102|New|Enh|2012-11-05|new feature: automatic route detection            |
|54118|New|Nor|2012-11-08|Handle leak on parent httpd process when rotatelog|
|54126|New|Maj|2012-11-09|Mod_rewrite failing because of url in query string|
|54134|New|Enh|2012-11-11|new feature: ability to use multiple routes in sti|
|54136|New|Min|2012-11-11|balancer-handler shows xml not, when only xml para|
|54158|New|Nor|2012-11-16|Suggestion regarding 2.0 to 2.2 Upgrade Documentat|
|54183|Inf|Nor|2012-11-21|PROPFIND doesn't report getcontenttype property   |
|54215|New|Maj|2012-11-27|configure fails for httpd 2.2.3 with openssl 1.0.1|
|54221|Opn|Nor|2012-11-28|no ErrorLog prefix on CGI errors                  |
|54222|New|Min|2012-11-28|ServerTokens checking is not complete             |
|54223|New|Nor|2012-11-29|AH00554 error when runtime configuration Includes |
|54252|New|Nor|2012-12-05|acinclude.m4 requires -lz when linking with ssl st|
|54253|New|Nor|2012-12-05|mod_proxy_ftp doesn't handle/log partial or cancel|
|54255|New|Nor|2012-12-06|mod_deflate adjusts the headers "too late", should|
|54269|New|Maj|2012-12-09|mod_proxy_html documentation misses several things|
|54276|New|Nor|2012-12-10|rotatelogs not getting killed on graceful restart |
|54280|New|Nor|2012-12-11|mod_auth_form inline login not working with traili|
|54281|New|Nor|2012-12-11|Stick use Partial parameters from query string    |
|54289|New|Nor|2012-12-13|"ap_get_brigade" api is failing in "AP_MODE_SPECUL|
|54306|New|Enh|2012-12-15|add regexp versions of ProxyPassReverse, ProxyPass|
|54309|New|Trv|2012-12-15|clarification on the <Location> directive when use|
|54310|Opn|Nor|2012-12-15|mod_proxy_html drops meta elements with http-equiv|
|54319|New|Reg|2012-12-17|ProxyPass has no effect in <Location> if rewrite o|
|54339|New|Nor|2012-12-21|piped log entries > PIPE_BUF can be interleaved   |
|54342|New|Nor|2012-12-22|AuthnCacheSOCache can't pass args to socache provi|
|54343|New|Maj|2012-12-22|Add sanity checks for malloc() in mpm_winnt.c and |
|54358|New|Nor|2012-12-29|Status 500 when using ldap on Solaris because apr_|
|54363|New|Nor|2012-12-31|make time conversion caching functions thread-safe|
|54364|New|Nor|2012-12-31|Add ref to mod_fcgid docs                         |
|54365|New|Nor|2013-01-02|Connection closed by server during file transfer  |
|54366|New|Nor|2013-01-02|$sysconfdir/extra/httpd-dav.conf is not built base|
|54367|Opn|Maj|2013-01-02|Location header in response to PUT is not %-escape|
|54385|New|Enh|2013-01-08|SSL configuration independent from virtual hosts, |
|54401|New|Nor|2013-01-10|Suggest to make ProxyPassReverseCookieDomain accep|
|54415|New|Enh|2013-01-14|Please tell the root cause of mutex and scoreboard|
|54431|Inf|Blk|2013-01-16|Unable to start the Apache 2.4.3 windows service. |
|54498|New|Nor|2013-01-28|apache crash on any cgi request with certain http |
|54502|New|Nor|2013-01-29|Apache deadlock on epoll_ctl error (1000 process l|
|54512|Inf|Cri|2013-01-31|Apache hung                                       |
|54517|New|Nor|2013-02-01|proxy balancer: timeout or partial failure of back|
|54518|New|Nor|2013-02-01|mod_rewrite not adding Vary header                |
|54519|New|Nor|2013-02-02|httpd already running                             |
|54526|New|Nor|2013-02-05|mod_proxy_http ignores request abortion           |
|54543|New|Enh|2013-02-10|Compile regex only when need                      |
|54546|New|Nor|2013-02-11|httpd crashes on first HUP after change Listen dir|
|54549|New|Nor|2013-02-11|mod_mime AddEncoding and mod_negotiation fix_encod|
|54556|New|Enh|2013-02-13|New flag to add default rule in rule chain        |
|54560|New|Nor|2013-02-13|Potential segfault on return from ap_server_root_r|
|54563|New|Maj|2013-02-15|mod_webdav ignores quota                          |
|54578|New|Nor|2013-02-18|Bad docs or unchecked code for "LimitRequestFields|
|54605|New|Enh|2013-02-24|mod_negotiation should cache the info it generates|
|54608|New|Enh|2013-02-25|Support an option to allow page caching when using|
|54622|New|Nor|2013-02-28|shared memory cleanup                             |
|54626|New|Nor|2013-03-01|mod_authnz_ldap through util_ldap.c does not suppo|
|54633|New|Nor|2013-03-04|Invalid % encoding not rejected                   |
|54637|New|Nor|2013-03-05|Digest: secret not used                           |
|54640|New|Nor|2013-03-05|Slow transaction on a balance member is holding su|
|54649|New|Nor|2013-03-06|Incorrect PIDFILE prevent httpd restart           |
|54653|New|Min|2013-03-08|Suggestion to add https example for forward proxy |
|54656|New|Maj|2013-03-09|SNI and SSLProxyCheckPeerCN based on "connection" |
|54657|New|Nor|2013-03-09|DNS lookup failure for load balancer member does n|
|54683|New|Min|2013-03-13|Ignor directive ErrorDocument with null byte      |
|54699|Opn|Enh|2013-03-15|[feature request] cli webaccess tester            |
|54701|New|Cri|2013-03-15|Apache 2.4.3 Migration Issue Not loading the pages|
|54704|New|Nor|2013-03-15|Web Services stalling on it's own                 |
|54719|New|Nor|2013-03-18|httpd should check for and eventually create pid f|
|54752|New|Nor|2013-03-25|mod_ssl should not use uninitialized memory as ran|
|54782|New|Nor|2013-04-02|Memory Corruption errors - mpm_worker mod_perl    |
|54785|New|Nor|2013-04-02|Random crash when httpd server is stopped         |
|54793|New|Nor|2013-04-03|Socket timeout handler can delete uploaded files P|
|54794|New|Reg|2013-04-03|mod_wsgi|fcgid and subversion >= 1.7 issues       |
|54795|New|Nor|2013-04-03|'apxs -g -n' should be self-referring             |
|54796|Inf|Enh|2013-04-03|CustomLog should be able to use syslog as ErrorLog|
|54804|New|Nor|2013-04-05|mod_fcgid sends a Continue 100 response automatica|
|54813|New|Nor|2013-04-08|documnt the Require args used by authz_dbm includi|
|54816|Inf|Nor|2013-04-08|AH00566: request failed: invalid characters in URI|
|54817|New|Nor|2013-04-09|if prefix and sysconfdir are the same then http.co|
|54820|Inf|Cri|2013-04-09|REwriterule stops working                         |
|54824|New|Nor|2013-04-10|Spec file is missing libuuid-devel requirement    |
|54830|New|Enh|2013-04-11|Make SSLPProxyMachineCertificateFile configurable |
|54848|New|Nor|2013-04-15|Client field too short for IPv6 addresses         |
|54856|Inf|Enh|2013-04-17|NSCreateObjectFileImageFromFile                   |
|54858|New|Nor|2013-04-17|ld duplicate                                      |
|54861|New|Blk|2013-04-18|The number of connections with mysql is more      |
|54869|Inf|Nor|2013-04-19|Non-breaking space characters cause httpd to choke|
|54875|New|Nor|2013-04-23|Conditional request predicated on another URL's ET|
|54878|New|Nor|2013-04-23|Multiple Listen directives prevent server to start|
|54905|Inf|Cri|2013-04-29|Apache2 loops in child Segfaults                  |
|54910|New|Enh|2013-04-30|Format %{Foobar}o cannot be used to log Date and S|
|54911|New|Enh|2013-04-30|Allow logging of fields set by a backend server in|
|54914|New|Nor|2013-04-30|mod_dir DirectoryIndex breaks WebDAV PROPFIND / DE|
|54915|New|Nor|2013-04-30|GET on a WebDAV-enabled collection, with Directory|
|54918|New|Enh|2013-05-02|Implement RFC 6797 HTTP Strict Transport Security |
|54919|Inf|Nor|2013-05-02|*** glibc detected *** /usr/sbin/httpd: double fre|
|54930|New|Nor|2013-05-06|Allow empty message in ErrorDocument directive    |
|54934|Inf|Cri|2013-05-07|Apache is crashing intermittently with a message "|
|54936|New|Nor|2013-05-08|Some potential bugs reported by static analysis to|
|54949|New|Nor|2013-05-10|[PATCH] mod_cache: fix uninitialized tmppath varia|
|54952|Inf|Cri|2013-05-10|[Fri May 10 17:39:01 2013] [error] proxy: CLUSTER:|
|54953|New|Nor|2013-05-11|<VirtualHost 0.0.0.0:80> matches IPv6             |
|54958|New|Nor|2013-05-13|mod_deflate + mod_mime with SSI gives mixed compre|
|54962|New|Maj|2013-05-14|Apache will set incorrect Content-Length header an|
|54965|New|Enh|2013-05-14|Allow ProxyPassMatch in Directory context         |
|54976|New|Nor|2013-05-15|ProxyPass parameter "acquire" and "ttl" ignored in|
|54986|New|Maj|2013-05-16|httpd hanging on large form submit in ap_run_handl|
|54989|New|Nor|2013-05-17|Apache Segfaults on OS X at random - how can I dia|
|54993|New|Nor|2013-05-20|Critical error: File descriptor in bad state: apr_|
|54998|Ver|Nor|2013-05-21|Apache 2.4 terminates all SSL connections using an|
|55000|New|Nor|2013-05-21|Memory usage per process doubles when Apache is co|
|55021|New|Enh|2013-05-28|Support arbitrary sql to authentication username/p|
|55022|Inf|Cri|2013-05-28|child pid 3123 exit signal Bus error (10) - Apache|
|55034|Inf|Maj|2013-05-31|Apache 2.4.4 won't open more that 32k VH file hand|
|55039|New|Enh|2013-05-31|"RequestHeader edit" can't access environment vari|
|55045|New|Nor|2013-06-01|calls to gets() in test_find.c and test_parser.c  |
|55068|New|Enh|2013-06-06|root permissions when writing to per vhosts errorl|
|55069|New|Min|2013-06-06|notice message in error_log even when LogLevel err|
|55070|Opn|Enh|2013-06-06|mod_fcgid stderr always goes to main error log    |
|55072|New|Nor|2013-06-07|ErrorLog doesn't work well when apache shutdown   |
|55093|New|Nor|2013-06-12|[PATCH] mod_fcgid 2.3.7 truncates large posts on R|
|55096|New|Nor|2013-06-12|Make not running on httpd configure Solaris       |
|55098|New|Nor|2013-06-13|does not listen to IP4 when both IP4 address and I|
|55106|New|Enh|2013-06-17|ProxyErrorOverride considers response codes >= 400|
|55117|New|Nor|2013-06-18|GracefullTimeout for worker threads               |
|55148|Inf|Nor|2013-06-26|Error during SSL Handshake with remote server     |
|55152|New|Nor|2013-06-28|graceful restart adjusts to new balancer members, |
|55156|New|Nor|2013-06-28|mod_cache not respecting s-maxage cache-control he|
|55178|New|Nor|2013-07-01|[PATCH] mod_authnz_ldap SASL authentication suppor|
|55192|New|Trv|2013-07-03|htaccess error messages missing request context   |
|55193|New|Min|2013-07-03|ErrorLogFormat is ignored by some modules         |
|55226|New|Enh|2013-07-09|Request for "domain cluster" feature for mod_proxy|
|55234|New|Maj|2013-07-10|Working of attribute "protocol" attribute "protoco|
|55276|Inf|Enh|2013-07-17|Add REST API for load balancer for dynamic registr|
|55278|New|Nor|2013-07-18|mod_session's cookie may be empty, is repeated twi|
|55284|New|Nor|2013-07-20|repeatable segv                                   |
|55286|New|Nor|2013-07-21|Floating point exception (8) in mod_auth_digest   |
|55293|New|Nor|2013-07-22|Incorrect default MIME type for .woff fonts       |
|55306|New|Nor|2013-07-25|Error when copying svn repository, which contains |
|55323|New|Nor|2013-07-29|Double unescaped uri in sub request handler       |
|55327|New|Nor|2013-07-30|Segmentation fault when stopping Apache 2.4.6 norm|
|55340|New|Maj|2013-08-01|Listen for valid, unconfigured IP address passes c|
|55344|New|Nor|2013-08-02|missing ap_hook_monitor on windows                |
|55346|New|Nor|2013-08-02|When on filled quota filesystem, mod_fcgid init in|
|55348|New|Nor|2013-08-02|%h is not changed in logging, only %a             |
|55351|New|Enh|2013-08-04|allow ProxyPassReverseCookieDomain to automaticall|
|55362|New|Nor|2013-08-05|Apache httpd sends "400 Bad Request" to client due|
|55379|New|Min|2013-08-07|htdigest -c doesn't behave as described anymore   |
|55394|New|Nor|2013-08-09|apache 2.4 randomy crashes with signal 6          |
|55401|New|Enh|2013-08-11|document that force-proxy-request-1.0 implies prox|
|55415|New|Maj|2013-08-14|Proxy loop caused by ProxyErrorOverride and ErrorD|
|55431|New|Nor|2013-08-16|mod_negotation does not force the mime type listed|
|55433|New|Nor|2013-08-16|mod_proxy ignores final status code for aborted re|
|55443|Inf|Maj|2013-08-17|never gives 300 multiple choices                  |
|55445|New|Maj|2013-08-18|mod_socache_memcache ignores expiry, creating eter|
|55447|New|Enh|2013-08-18|make type-maps usable again, by making them access|
|55448|New|Nor|2013-08-19|segfault in set_max_workers at event.c:3194 on SIG|
|55449|New|Maj|2013-08-19|AH01185: worker slotmem_create failed --> slotmem |
|55452|New|Maj|2013-08-19|Redirect                                          |
|55458|New|Enh|2013-08-20|allow to configure what mod_ssl responds when one |
|55460|New|Enh|2013-08-21|allow service names to be used in the Listen direc|
|55467|New|Nor|2013-08-21|Support for OpenSSL custom TLS extensions and supp|
|55523|New|Trv|2013-09-04|auth_groupfile error log on access even though suc|
|55535|Inf|Nor|2013-09-08|incorrect check state parametr                    |
|55540|New|Cri|2013-09-09|mod_proxy gzip chunked issue (sample site provided|
|55549|New|Min|2013-09-11|AuthLDAPSubGroupAttribute doesn't do anything     |
|55550|New|Nor|2013-09-11|AuthLDAPSubGroupClass checking is very inefficient|
|55556|New|Nor|2013-09-13|apachebench (ab) doesn't use so_reuseaddr         |
|55557|New|Nor|2013-09-14|Some cppcheck reports                             |
|55573|New|Enh|2013-09-19|FileETag needs MTimeSeconds, MTime with granularit|
|55581|New|Enh|2013-09-22|Support concurrent connections to same FastCGI pro|
|55590|Inf|Maj|2013-09-24|second commit is failing if space is in file name |
|55596|New|Enh|2013-09-25|Add date format used by Expires header            |
|55607|New|Enh|2013-09-28|Re-set HOME environment variable to directory from|
|55615|New|Nor|2013-09-30|Connections are starved and not balanced when conc|
|55619|New|Nor|2013-10-02|Apache httpd reported 500 internal error when uplo|
|55627|New|Min|2013-10-04|Remove unnecessary APLOGNO() for trace logging per|
|55636|Inf|Cri|2013-10-07|long lost child came home - Apache is not respondi|
|55646|Inf|Nor|2013-10-10|non-2xx responses are not considered errors       |
|55654|New|Nor|2013-10-15|Extract variables from configuration without start|
|55670|New|Min|2013-10-18|Startup may fail silently at post_config          |
|55673|New|Nor|2013-10-18|httpd fails to start with SSLProxyMachineCertifica|
|55680|New|Enh|2013-10-20|online manual directory option doesn't exist      |
|55698|New|Maj|2013-10-24|Apache 2.2 + mod_fcgid 2.3.7 (CentOS 6.4) graceful|
|55700|New|Enh|2013-10-24|add something like RewriteOptions InheritDown     |
|55707|New|Nor|2013-10-25|SSLProtocol directive seem to be ignored over diff|
|55708|New|Nor|2013-10-25|Access violation in msvcrt.dll when calling getenv|
|55711|New|Min|2013-10-28|--enable-foo doesn't enable foo                   |
|55712|New|Nor|2013-10-28|Relative <!--#include virtual="../file.shtml"--> g|
|55720|New|Enh|2013-10-29|separate LDAP Bind timeout from LDAPTimeout       |
|55738|New|Nor|2013-11-03|PVS-Studio: few issues                            |
|55763|New|Nor|2013-11-09|raise roots soft RLIMIT_NPROC on linux for high ma|
|55774|New|Nor|2013-11-13|ab: optionally accept tls client certificate      |
|55781|New|Nor|2013-11-15|ajp_read_header: ajp_ilink_receive failed; 120006)|
|55786|New|Maj|2013-11-16|SSLVerifyClient and OptRenegotiate result in a 403|
|55787|New|Maj|2013-11-16|Chroot fails with "Cannot chroot when not started |
|55790|New|Maj|2013-11-17|mod_fcgid lockfile hardcoded to be in /tmp        |
|55793|New|Enh|2013-11-18|DTrace/SystemTap support                          |
|55808|New|Nor|2013-11-21|File integrity verification using MD5 and SHA1    |
|55819|Inf|Nor|2013-11-27|Closing connection behaviour                      |
|55828|New|Cri|2013-11-28|Httpd not start if use ProxyPass balancer://      |
|55834|New|Maj|2013-12-02|Apache does not honor the openssl library path giv|
|55838|New|Nor|2013-12-03|PHP files are being executed instead of downloaded|
|55841|New|Nor|2013-12-04|Misleading news items on bugfix releases ("This ve|
|55856|New|Nor|2013-12-08|YYEMPTY (-2) used as index into yytname (const arr|
|55866|New|Nor|2013-12-11|When ProxyPreserveHost is on, SSL expects the wron|
|55878|New|Nor|2013-12-12|mod_fcgid kills spawned processes too early       |
|55881|New|Nor|2013-12-13|segmentation fault at proxy_util.c:1546           |
|55883|New|Enh|2013-12-14|string callers of ap_expr should be able to transf|
|55887|New|Maj|2013-12-16|In Windows apache, when user access to /con, apach|
|55898|New|Enh|2013-12-17|[RFE] listen on unix socket?                      |
|55914|New|Reg|2013-12-20|child exit segmentation fault after apache gracefu|
|55919|New|Nor|2013-12-22|EPREFIX and dynamic modules                       |
|55942|New|Nor|2014-01-01|400 - Bad Request on POST (Windows Server 2012 Hyp|
|55952|New|Nor|2014-01-05|ab: SSL keep-alive fails with apr_pollset_poll: Th|
|55962|New|Enh|2014-01-06|mod_remoteip should not allow an external proxy to|
|55963|New|Nor|2014-01-07|Add application/ld+json to mime.types             |
|55981|Opn|Nor|2014-01-09|mod_mbox hang on some e-mails on user@openoffice.a|
|55985|Opn|Nor|2014-01-10|apache does not reopen logs when multiple graceful|
|55989|Opn|Enh|2014-01-11|write to error log upon RewriteRule [F]orbidden   |
|55991|New|Nor|2014-01-12|mod_charset_lite doesn't bail out on non-identity |
|56009|Inf|Cri|2014-01-14|Memory leak in httpd 2.4.3 over time with persista|
|56014|New|Nor|2014-01-15|MOd rewrite CO Cookie method the lifetime flag not|
|56028|New|Enh|2014-01-17|Add http/1.0, http/1.1 NPN advertisement to enable|
|56034|New|Nor|2014-01-20|CPU consumption due to circular linked list in ap_|
|56040|New|Enh|2014-01-21|should be able to remove Max-Age cookie parameter |
|56041|New|Enh|2014-01-21|should be able to disable session expiry increment|
|56052|New|Nor|2014-01-22|ap_session_load called multiple times for expired |
|56055|New|Nor|2014-01-23|Route is not extracted properly when a session coo|
|56064|New|Enh|2014-01-25|Optimize PNGs                                     |
|56067|New|Nor|2014-01-27|FallbackResource doesn't work if directory exists |
|56081|New|Maj|2014-01-28|Apache 2.2.26 SIGSEGVs when POST'ing data         |
|56091|Inf|Nor|2014-01-30|SSL handshake error when httpd compiled on Oracle |
|56098|New|Nor|2014-02-01|duplicate cookie                                  |
|56101|New|Cri|2014-02-03|Apache 2.4.6 ceases processing requests (scoreboar|
|56102|New|Nor|2014-02-03|SSL_CLIENT_S_DN_x509_0 is undefined in the environ|
|56109|New|Nor|2014-02-05|Cannot increase the read limit                    |
|56113|New|Nor|2014-02-06|dist commit messages missing from mail-archives di|
|56131|New|Nor|2014-02-12|ProxyPassReverse / zealously replaces Location hea|
|56135|New|Nor|2014-02-13|Add DC to list of x509 components                 |
|56152|New|Nor|2014-02-18|ProxyBlock does not accept network addresses      |
|56176|New|Nor|2014-02-21|mod_substitute truncates the response body if the |
|56188|New|Nor|2014-02-25|mod_proxy_fcgi does not send FCGI_ABORT_REQUEST on|
|56209|New|Nor|2014-03-03|Uninitialised variables in os/win32/ap_regkey.c   |
|56226|Ver|Nor|2014-03-06|per VirtualHost KeepAliveTimeout is not recognized|
|56229|New|Enh|2014-03-06|ocsp ProxyHost and ProxyPort support              |
|56230|New|Nor|2014-03-07|mod_access_compat can log a bogus client denied me|
|56235|New|Nor|2014-03-07|quotes should be optional around expr             |
|56247|New|Cri|2014-03-12|semaphore creation for proxypass                  |
|56250|New|Nor|2014-03-12|sbindir in config.layout for Apache has bin instea|
|56251|New|Nor|2014-03-12|Increase maximum length of FcgidInitialEnv string |
|56252|New|Enh|2014-03-12|make install as privileged user creates files not |
|56262|New|Nor|2014-03-14|ab does not work with extremely long cookies      |
|56264|New|Trv|2014-03-14|Confusing error with .htaccess rewrite to proxy wh|
|56270|New|Enh|2014-03-15|--with-ssl=/foo w/o pkgconfig needs help on AIX 64|
|56288|New|Enh|2014-03-19|rewrite URLs in style attributes                  |
|56289|New|Nor|2014-03-19|Buffer overflow in mod_proxy_html's string replace|
|56308|New|Nor|2014-03-24|1 second delay in handle request kills performance|
|56312|New|Nor|2014-03-25|Can't configure different balancing workers that c|
|56314|New|Nor|2014-03-25|exiting from MPM-worker child caused assert in apr|
|56326|New|Nor|2014-03-27|cache_quick_handler does not serve responses with |
|56331|New|Nor|2014-03-29|windows 'access denied' during revalidaton of reso|
|56333|New|Enh|2014-03-31|API to resume a SUSPENDED connection              |
|56362|New|Maj|2014-04-08|ldaps only works with port 636. Non-standard port |
|56379|New|Nor|2014-04-09|Number of columns in the results returned from pgs|
|56395|New|Enh|2014-04-11|Allow SERVER_ADDR environment variable to be optio|
|56404|New|Nor|2014-04-12|endless loop  when connect to a website(https)  wh|
|56413|New|Blk|2014-04-15|can not restart httpd on centos 5.10 64bit        |
|56422|New|Nor|2014-04-17|authnz_ldap with other forms of authn can fail req|
|56457|New|Nor|2014-04-25|mod_proxy_html.c: 2 * cut'n'paste errors          |
|56473|New|Nor|2014-04-30|ETags don't change when headers do                |
|56475|New|Enh|2014-04-30|Allow TLS record size to be configured            |
|56483|New|Enh|2014-05-02|add disableKeepAlivePercentage similar to tomcat h|
|56493|New|Min|2014-05-06|mod_expires should not set expires in future for s|
|56495|New|Nor|2014-05-06|Application behind mod_proxy does not get SessionH|
|56500|Opn|Enh|2014-05-07|vhosts priority order with wildcard               |
|56504|New|Nor|2014-05-08|cannot build static support binaries              |
|56508|New|Nor|2014-05-09|Requiring SNI - SSLStrictSNIVHostCheck semantics  |
|56517|New|Enh|2014-05-12|Virtualhosts cannot inherit parent CustomLog      |
|56528|New|Enh|2014-05-15|"bad flags delimiter" - improve helpfulness       |
|56541|New|Nor|2014-05-18|Proxy 502's on large file post requests           |
|56559|New|Nor|2014-05-25|multiple unix sockets in one virtualhost fails    |
|56569|New|Nor|2014-05-27|Null CRC in gzip footer with mod_cgid and ErrorDoc|
|56587|New|Nor|2014-06-03|Many VirtualHost's with SSLEngine On              |
|56590|New|Enh|2014-06-04|(REST-) API for configuring balancer manager remot|
|56594|Inf|Nor|2014-06-05|mod_authn_dbd, mod_dbd and mod_ssl                |
|56598|New|Nor|2014-06-06|Content-Length header should be always interpreted|
|56621|New|Nor|2014-06-13|Rotatelogs.exe first start                        |
|56622|New|Nor|2014-06-13|mod_reqtimeout incorrectly applies timeouts to CON|
|56626|New|Nor|2014-06-15|Add info about rotatelogs to log rotation document|
|56633|New|Nor|2014-06-16|mod_auth_basic breaks mod_autoindex               |
|56645|New|Maj|2014-06-19|socket callback with timeout callback causes infin|
|56664|New|Nor|2014-06-24|Proxy retry timeout does not cope with system time|
|56697|New|Maj|2014-07-04|status page still shown while blocked             |
|56718|New|Nor|2014-07-14|Cleanup request Host headers when absolute URI are|
|56719|New|Nor|2014-07-14|parallel requests get served with delays          |
|56738|New|Enh|2014-07-17|Ability to extract route from cookie with regexp  |
|56740|New|Nor|2014-07-18|suspended_count not maintained properly with wstun|
|56750|New|Enh|2014-07-20|SuexecUserGroup replacement                       |
|56751|New|Maj|2014-07-20|Fails to properly mitigate Slow Post DoS attack   |
|56753|New|Nor|2014-07-21|mod_lua.so: symbol luaL_openlib: referenced symbol|
|56778|New|Nor|2014-07-28|while running make command i got this error       |
|56794|New|Nor|2014-07-31|Added AuthDBDFullAuthQuery option                 |
|56795|Inf|Nor|2014-07-31|Apache 2.4.10 Program received signal SIGPIPE, Bro|
|56818|Inf|Nor|2014-08-05|SetEnvIf may set invalid string length on empty st|
|56843|New|Enh|2014-08-12|Support different OCSP stapling max ages          |
|56868|New|Nor|2014-08-18|relative LuaRoot broken                           |
|56879|New|Nor|2014-08-22|Information disclosure                            |
|56889|New|Nor|2014-08-26|Close state never dies                            |
|56918|Opn|Blk|2014-09-06|error: 'ap_copy_scoreboard_worker' undeclared here|
|56926|New|Nor|2014-09-08|Filename causes AH02599 slotmem issue             |
|56933|New|Min|2014-09-09|not sure it's an appache bug : some browser want t|
|56942|New|Reg|2014-09-10|Unable to implement TRANSFER-CHUNKED:ENCODING with|
|56943|New|Nor|2014-09-10|mod_proxy_connect - AH02447: err/hup on backconn  |
|56977|New|Maj|2014-09-12|segfaults when using mod_mem_cache + mod_disk_cach|
|56986|New|Blk|2014-09-17|chunked Transfer-Encoding forbidden: /test/test.dl|
|57014|New|Cri|2014-09-24|Incorrect test for CC_FOR_BUILD prevents build (on|
|57023|New|Nor|2014-09-26|Socache shmcb don't cache file bigger than 11k    |
|57028|New|Enh|2014-09-27|mod_spdy - support Apache 2.4                     |
|57044|New|Nor|2014-09-29|[PatchAvailable] Use base64url in mod_unique_id ('|
|57045|New|Nor|2014-09-30|dumpio output strings are missing                 |
|57046|New|Enh|2014-09-30|Add additional parameter to enable check URL befor|
|57056|New|Maj|2014-10-03|Rewrite port is taken into hostname               |
|57067|New|Nor|2014-10-08|A proxy worker both standalone and balancer member|
|57069|New|Nor|2014-10-08|apache ssl timeout during chunked request in rever|
|57073|New|Cri|2014-10-09|Intermittent Connection Issues using default httpd|
|57085|New|Enh|2014-10-14|Implement Proxy Protocol in httpd                 |
|57087|New|Nor|2014-10-14|mod_proxy_fcgi doesn't send cgi CONTENT_LENGTH var|
|57100|Ver|Nor|2014-10-16|"SSLProtocol ALL" is ignored for virtual hosts    |
|57101|New|Enh|2014-10-16|[PATCH] Better error reporting when child spawn fa|
|57109|New|Nor|2014-10-17|GPG verification examples are wrong               |
|57119|Opn|Enh|2014-10-20|Suppress address reuse / DNS cache in mod_proxy   |
|57121|New|Nor|2014-10-21|ocsp stapling should not pass temporary server out|
|57131|New|Nor|2014-10-22|OCSP Stapling scalability concern                 |
|57159|New|Min|2014-10-28|mod_ssl OCSP Stapling directives don't support per|
|57160|New|Nor|2014-10-29|httxt2dbm doesn't generate files on NAS           |
|57174|New|Nor|2014-10-31|Update windows visual studio build                |
|57210|New|Nor|2014-11-14|LuaHookMapToStorage not firing in per-directory co|
|57211|New|Enh|2014-11-14|Config-time options                               |
|57212|Opn|Nor|2014-11-14|Headers returned by scripts are limited to 8190 by|
|57218|New|Nor|2014-11-15|[Feature Request] Apache Bench (AB) to output a cs|
|57219|New|Nor|2014-11-15|ApacheBench quits unexpectedly with high concurren|
|57220|New|Nor|2014-11-15|[Feature Request] Add option to ApacheBench to giv|
|57228|New|Nor|2014-11-17|glibc detected *** httpd: double free or corruptio|
|57229|New|Maj|2014-11-17|mod_sed dies on long lines                        |
|57286|New|Nor|2014-11-29|Symbolic links are not honoured                   |
|57298|New|Min|2014-12-02|RewriteBase inside FilesMatch behaves oddly       |
|57299|New|Enh|2014-12-02|mod_session_dbd should not make a database call pe|
|57300|New|Enh|2014-12-02|mod_session_dbd should not save the session at eac|
|57301|New|Enh|2014-12-02|Add SessionMaxAgeAbsolute Directive               |
|57304|Inf|Nor|2014-12-03|MySQL DBD Authentication Incompatible with SSL    |
|57311|New|Nor|2014-12-04|BalancerMember enclosed by <If> gives syntax error|
|57313|New|Nor|2014-12-05|The DefaultType directive has been removed        |
|57327|New|Nor|2014-12-08|mod_ssl seg fault on exit                         |
|57334|Ver|Maj|2014-12-09|Segmentation fault in SSL_renegotiate at ssl_lib.c|
|57337|New|Nor|2014-12-10|Content negotiation fails with conditional Redirec|
|57339|New|Enh|2014-12-10|ErrorLogFormat doesn't allow logging in Internet d|
|57360|New|Nor|2014-12-17|Fail gracefully on certificate/key mismatch       |
|57372|New|Nor|2014-12-19|httpd will lookup every home directory while start|
|57374|Ver|Nor|2014-12-19|Event MPM: Wrong KeepAliveTimeout when system cloc|
|57379|New|Nor|2014-12-20|[patch] Makefile.in  with mpm-shared, cgi and cgid|
|57383|New|Cri|2014-12-21|Error retrieving Report: An Existing connection wa|
|57386|New|Blk|2014-12-22|html5 lost some comments                          |
|57398|New|Maj|2014-12-26|AH01075: Error dispatching request to : (passing b|
|57399|New|Nor|2014-12-28|Many unnecessary CPU wakeups per second           |
|57406|New|Nor|2014-12-31|cgi-bin script is not executing                   |
|57412|New|Maj|2015-01-04|rewrite rules causes duplicate requests           |
|57416|New|Nor|2015-01-06|htcacheclean thinks the cache is smaller than it a|
|57424|Opn|Nor|2015-01-07|mod_rewrite not using ap_context_document_root    |
|57436|New|Enh|2015-01-12|Option to strip extra data after websocket request|
|57439|New|Enh|2015-01-13|Allow to change body timeout per location         |
|57448|New|Nor|2015-01-16|SSI <!--#set --> cannot capture backreferences fro|
|57453|New|Maj|2015-01-17|403 error when virtualhost configured with non-exi|
|57471|New|Nor|2015-01-20|Apache 2.4.10 Compilation fails when compiling aga|
|57477|New|Nor|2015-01-21|mod_auth_digest AH00052: child pid $pid exit signa|
|57483|New|Nor|2015-01-22|Omit "Keep-Alive" header on 1.1 connections       |
|57492|New|Nor|2015-01-24|incomplete chunked-transfered request body is not |
|57506|New|Nor|2015-01-27|<If> directive doesn't work within a <Location> se|
|57510|New|Enh|2015-01-28|Engine keyform support for private keys           |
|57511|New|Maj|2015-01-28|Opening plain TCP Socket on SSL port causes denial|
|57515|New|Nor|2015-01-30|Define/Undefine don't work reasonably outside of g|
|57519|New|Nor|2015-02-01|change SSLv2 to SSLv3 or remove SSLv2 support allt|
|57526|Opn|Maj|2015-02-03|Apache 2.2.29_openssl-1.0.1k_x86_64 Error creating|
|57529|Opn|Nor|2015-02-03|htcacheclean doesn't show the cached URL with '-a'|
|57585|New|Nor|2015-02-13|httpd fails to start if there is an IncludeOptiona|
|57590|New|Nor|2015-02-18|loading mod_proxy_http makes rewriteRule's [proxy]|
|57591|New|Nor|2015-02-18|DirectoryIndex directive cannot be overwritten    |
|57616|New|Maj|2015-02-23|AB - DNS roundrobin support                       |
|57624|New|Enh|2015-02-23|Provide support for http/2.0                      |
|57631|New|Nor|2015-02-24|Useless test in acinclude.m4                      |
|57632|New|Nor|2015-02-24|mod_systemd passes invalid default to APACHE_MODUL|
|57635|New|Nor|2015-02-25|meta-refresh is not rewritten by mod_proxy_html   |
|57636|New|Nor|2015-02-25|URLs without protocol are not rewriten by mod_prox|
|57641|New|Maj|2015-02-27|mod_substitute: Invalid merge order               |
|57646|New|Enh|2015-02-27|SSLEngine inside If directive                     |
|57660|New|Trv|2015-03-04|AB - free memory allocated by xmalloc and xcalloc |
|57680|New|Nor|2015-03-09|SSLSessionCacheTimeout has no effect              |
|57685|New|Nor|2015-03-10|Requests are denied while the mod_cgid daemon star|
|57691|New|Nor|2015-03-12|mod_proxy/proxy_util confuses UDS scheme with HTTP|
|57695|New|Nor|2015-03-12|[core:warn] [pid 1120] (101)Network is unreachable|
|57710|New|Nor|2015-03-15|Wildcard matching for logging headers             |
|57725|New|Enh|2015-03-18|ApacheBench: include http status code in gnuplot o|
|57742|New|Nor|2015-03-23|"reliable piped logging" doesn't work for ErrorLog|
|57745|New|Nor|2015-03-23|httpd exits 1 with no stderr when proxy_balancer_m|
|57746|New|Nor|2015-03-23|Apache hangs on startup using MPM event           |
|57751|Inf|Maj|2015-03-24|Problems with proxy reverse to websockets         |
|57756|New|Enh|2015-03-25|Config options for handling of pipelined request  |
|57757|New|Cri|2015-03-25|extern apr_xlate_t *ap_locale_to_ascii variable gi|
|57771|New|Nor|2015-03-27|cleanup_script uses incorrect connection ID       |
|57774|Inf|Nor|2015-03-28|httpd.conf <IfModule proxy_html_module> content er|
|57777|New|Nor|2015-03-30|Security concerns with documentation of AddHandler|
|57781|New|Nor|2015-03-31|disable reconnection after connection error       |
|57784|New|Enh|2015-03-31|[RFE] Multiple ErrorLog directives                |
|57785|Opn|Nor|2015-04-01|REDIRECT_URL is not suitable for use in server-gen|
|57795|Opn|Maj|2015-04-07|mod_proxy_wstunnel sometimes does not connect and |
|57800|New|Nor|2015-04-09|High CPU usage in ap_core_output_filter           |
|57807|New|Enh|2015-04-13|Build-configurable environment variable length    |
|57810|New|Nor|2015-04-13|Should apache ignore difference in trailing dot be|
|57813|New|Nor|2015-04-14|Rewrite 'pre-compressed content' recipe using 2.4 |
|57814|New|Nor|2015-04-14|Teach mod_deflate how to serve pre-comressed conte|
|57819|New|Nor|2015-04-15|Need a conventions document                       |
|57832|New|Enh|2015-04-19|Reduction of response splitting attacks consequenc|
|57853|Inf|Nor|2015-04-24|mod_proxy_http sends request with header 'Expect: |
|57876|New|Reg|2015-04-30|logresolve.exe on any Windows immediately crashes |
|57878|New|Nor|2015-04-30|Using UTF-8 for all languages, and avoiding html-e|
|57895|New|Min|2015-05-05|missing m4a mimeType in mime.types                |
|57911|New|Min|2015-05-09|Rewrite documentation unclear or wrong about what |
|57927|New|Maj|2015-05-13|Segmentation Fault at proxy_util.c:994            |
|57933|New|Min|2015-05-18|apr_port_t returns constant                       |
|57941|New|Nor|2015-05-21|config.status: line 331: syntax error near unexpec|
|57949|New|Enh|2015-05-25|new mod_ssl environment variable SSL_{CLIENT|SERVE|
|57950|New|Nor|2015-05-26|[patch] buildconf change hint in build to newer ap|
|57960|New|Nor|2015-05-27|PUT truncates response body; status_line appears t|
|57976|New|Cri|2015-05-30|Server threads stale when sending 500 status with |
|57978|New|Nor|2015-06-01|unix:/ works with any number of / slashes  except |
|57979|New|Nor|2015-06-01|can not turn change log level for mod_filter      |
|57996|New|Nor|2015-06-03|Symlinks erroneously not followed when target inod|
|57997|New|Nor|2015-06-03|Threads started during child_init don't block sign|
|57999|New|Nor|2015-06-04|ap_getparents() may remove start slash of uri     |
|58001|New|Enh|2015-06-04|Implement Forwarded header (RFC 7239) to mod_proxy|
|58007|New|Nor|2015-06-06|400 Bad Request with fully qualified domain name o|
|58025|New|Enh|2015-06-11|mod_authz_dbd : new dbd-query and AuthzDBDQuery op|
|58026|New|Nor|2015-06-11|return 421 status code when SNI and Host: header d|
|58044|New|Cri|2015-06-16|Error sintax 'lua_dump'                           |
|58050|New|Nor|2015-06-17|ErrorDocument does not always work                |
|58073|New|Nor|2015-06-24|Extremely long time for graceful restart          |
|58089|New|Nor|2015-07-01|mod_authz_host uses proxy IP even when mod_remotei|
|58097|New|Enh|2015-07-03|[feat] Preserve original connecting IP            |
|58101|New|Nor|2015-07-05|DeflateCompressionLevel inside vhost resets logfor|
|58107|New|Blk|2015-07-06|Httpd crashes on startup every time, dump file att|
|58109|New|Nor|2015-07-06|Apache on windows cannot handle the hash symbol (#|
|58118|Inf|Min|2015-07-09|mod_proxy_fcgi logs 503 when user aborts connectio|
|58120|New|Nor|2015-07-10|ProxyPassInherit does not work as expect          |
|58121|New|Nor|2015-07-10|ProxyHTMLMeta seems to ignore all <meta http-equiv|
|58129|New|Nor|2015-07-12|man pages are not generated correctly             |
|58132|New|Nor|2015-07-12|non-standard, non-traditional man page layout make|
|58135|New|Nor|2015-07-14|mod_cache sends client "if-Modified-Since" to back|
|58141|New|Nor|2015-07-15|Apache Service doesn't start when rotatlogs.exe pa|
|58142|New|Nor|2015-07-15|authz_core ignores loglevel                       |
|58158|New|Nor|2015-07-21|Not honoring HTTP spec with regard to Accept-Encod|
|58168|New|Enh|2015-07-21|Would like full request evaluation support in Rewr|
|58171|New|Nor|2015-07-22|ap_session_save saves the wrong session after a de|
|58177|New|Enh|2015-07-24|Mod Proxy forward trailers in http chunked request|
|58180|New|Enh|2015-07-24|ErrorDocument original URL in subsequent <Location|
|58181|New|Enh|2015-07-25|mod_expire should allow "minus" keyword same like |
|58188|New|Nor|2015-07-28|http2 mod_lua: support build with lua 5.2+        |
|58197|New|Nor|2015-07-31|apr-util-1.5.4 build against openldap - "could not|
|58225|New|Reg|2015-08-08|intermitant segfault 11 in session_identity_encode|
|58226|New|Nor|2015-08-08|XSS in Error Page                                 |
|58231|New|Nor|2015-08-11|RewriteCond can add "Host" to the Vary-Header     |
|58235|New|Enh|2015-08-12|Ability to allow from domain but with using forwar|
|58243|New|Nor|2015-08-14|rotatelogs goes infinite at startup               |
|58248|New|Nor|2015-08-17|Error 404 in use some characters of utf8 in url   |
|58257|New|Nor|2015-08-18|require ldap-group does not work if account-fullna|
|58278|Inf|Blk|2015-08-24|apache - mod_security Issue : apache no releasing |
|58280|New|Nor|2015-08-24|Backend connection not closed until timeout if cli|
|58288|New|Blk|2015-08-27|Semaphore amount increase until crash when enablin|
|58292|New|Nor|2015-08-27|FallbackResource breaks chunked encoding sometimes|
|58304|New|Nor|2015-08-30|Unexpected Warnings from Macro Use in 2.4         |
|58305|New|Nor|2015-08-30|mod_cgi documentation not clear about what is pass|
|58306|New|Nor|2015-08-30|documentation needs to make it clear which directi|
|58307|New|Nor|2015-08-31|Segmentation fault in child in "read(__nbytes, __b|
|58317|New|Min|2015-09-02|Error message AH01630 is missing file name on deny|
|58334|New|Min|2015-09-06|WebDAV HTTP access does not include meta tag for c|
|58335|New|Nor|2015-09-07|mod_authnz_ldap mismatch                          |
|58343|New|Nor|2015-09-08|The pdf files come up as a blank page.            |
|58354|New|Maj|2015-09-10|(20014)Internal error (specific information not av|
|58356|New|Blk|2015-09-10|Session jumping due to incorrect route            |
|58364|New|Reg|2015-09-11|Apache Server is restarted time to time (Release 2|
|58417|New|Min|2015-09-16|ApacheBench (ab) won't display Server Software of |
|58419|New|Nor|2015-09-16|ApacheBench (ab) doesn't work with keep-alives aga|
|58423|New|Reg|2015-09-17|Apache >= 2.4.8 PCRE_DUPNAMES causes build failure|
|58467|New|Maj|2015-09-29|Environment Variables in ProxyHTMLURLMap produces |
|58475|New|Nor|2015-10-03|Support append/merge with semicolon-separated head|
|58488|New|Nor|2015-10-08|Stoped PHP-FPM pool in multi-pool system with comu|
|58491|New|Maj|2015-10-09|Core dumps appear when the load increases         |
|58492|Inf|Nor|2015-10-09|I think LDAPConnectionPoolTTL is not being honored|
|58498|New|Nor|2015-10-16|Apache 2.4.17: Regression with mod_autoindex (in c|
|58500|New|Nor|2015-10-16|dav_fs not enabled by default                     |
|58503|New|Cri|2015-10-16|segfault in apr_brigade_cleanup() under high load |
|58509|New|Trv|2015-10-20|2.4.17-dev introduces second core.c handler at sta|
|58513|New|Maj|2015-10-21|httpd code documentation is missing               |
|58524|New|Nor|2015-10-23|mod_http2 segfaults when under heavy load         |
|58528|New|Nor|2015-10-23|AllowOverrideList None gets misparsed and .htacces|
|58529|New|Maj|2015-10-23|Segmentation fault after modifying a proxy Balance|
|58550|New|Enh|2015-10-26|During load, Apache 2.2.x with prefork MPM didn|
|58574|New|Nor|2015-11-02|Apache error AH01630 (client denied) but working  |
|58593|New|Nor|2015-11-06|mod_proxy wrong decision between http and ws      |
|58598|New|Enh|2015-11-08|Internal Server Error (500) when requesting non-ex|
|58602|New|Nor|2015-11-11|Priority issue on DirectoryMatch directive        |
|58604|New|Reg|2015-11-12|Plaintext auth broken in any Explicit FTP/AUTH TLS|
|58612|New|Min|2015-11-16|mod_webdav when write_stream failed should break a|
|58669|New|Nor|2015-11-30|Order of DBDInitSQL and DBDPrepareSQL             |
|58688|New|Nor|2015-12-03|Missing mod_ssl connection-level upgrade headers f|
|58700|New|Nor|2015-12-07|Apache logs not working with mod_remoteip and X-fo|
|58720|New|Enh|2015-12-11|querying server status stalls when scoreboard is f|
|58727|New|Min|2015-12-13|Directories with a ProxyPass directive are not dis|
|58732|New|Nor|2015-12-14|Error Log isn't writing When Apache Shutdown with |
|58737|New|Blk|2015-12-15|Compilation failure of httpd-2.4.18 on SLES 11 SP3|
|58739|New|Cri|2015-12-15|Undocumented behavior of REDIRECT_URL and REDIRECT|
|58744|New|Nor|2015-12-17|pthread mutex warning is outdated                 |
|58761|New|Nor|2015-12-22|Improved developers docs                          |
|58764|New|Nor|2015-12-23|Add python example for SHA1 in Password Encryption|
|58769|New|Enh|2015-12-25|CustomLog in vhost overrides CustomLog in main con|
+-----+---+---+----------+--------------------------------------------------+
| Total 1565 bugs                                                           |
+---------------------------------------------------------------------------+

From dev-return-85113-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Mon Dec 28 16:46:39 2015
Return-Path: <dev-return-85113-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id DC475184EF
	for <apmail-httpd-dev-archive@www.apache.org>; Mon, 28 Dec 2015 16:46:39 +0000 (UTC)
Received: (qmail 54430 invoked by uid 500); 28 Dec 2015 16:46:39 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 54351 invoked by uid 500); 28 Dec 2015 16:46:39 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 54339 invoked by uid 99); 28 Dec 2015 16:46:39 -0000
Received: from Unknown (HELO spamd2-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 28 Dec 2015 16:46:39 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd2-us-west.apache.org (ASF Mail Server at spamd2-us-west.apache.org) with ESMTP id D72011A1395
	for <dev@httpd.apache.org>; Mon, 28 Dec 2015 16:46:38 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd2-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 2.445
X-Spam-Level: **
X-Spam-Status: No, score=2.445 tagged_above=-999 required=6.31
	tests=[HTML_MESSAGE=3, RP_MATCHES_RCVD=-0.554, SPF_HELO_PASS=-0.001,
	SPF_PASS=-0.001, URIBL_BLOCKED=0.001] autolearn=disabled
Received: from mx1-us-west.apache.org ([10.40.0.8])
	by localhost (spamd2-us-west.apache.org [10.40.0.9]) (amavisd-new, port 10024)
	with ESMTP id wKO0z5h1Wu1v for <dev@httpd.apache.org>;
	Mon, 28 Dec 2015 16:46:29 +0000 (UTC)
Received: from mx1.cpanel.net (mx1.cpanel.net [208.74.121.68])
	by mx1-us-west.apache.org (ASF Mail Server at mx1-us-west.apache.org) with ESMTPS id A2CE92050D
	for <dev@httpd.apache.org>; Mon, 28 Dec 2015 16:46:29 +0000 (UTC)
Received: from [208.74.121.106] (port=35618 helo=[10.1.4.91])
	by mx1.cpanel.net with esmtpsa (TLSv1:ECDHE-RSA-AES256-SHA:256)
	(Exim 4.86)
	(envelope-from <jacob.perkins@cpanel.net>)
	id 1aDawB-0000Le-Ai
	for dev@httpd.apache.org; Mon, 28 Dec 2015 10:46:23 -0600
From: Jacob Perkins <jacob.perkins@cpanel.net>
X-Pgp-Agent: GPGMail 2.6b2
Content-Type: multipart/signed; boundary="Apple-Mail=_B1C14E54-EB79-4011-A64D-C3C92353899C"; protocol="application/pgp-signature"; micalg=pgp-sha512
Subject: .gitignore found in modules/http2
Date: Mon, 28 Dec 2015 10:46:21 -0600
Message-Id: <974A0566-FE37-4115-A5A7-6C9D364EA133@cpanel.net>
To: dev@httpd.apache.org
Mime-Version: 1.0 (Mac OS X Mail 9.2 \(3112\))
X-Mailer: Apple Mail (2.3112)
X-AntiAbuse: This header was added to track abuse, please include it with any abuse report
X-AntiAbuse: Primary Hostname - mx1.cpanel.net
X-AntiAbuse: Original Domain - httpd.apache.org
X-AntiAbuse: Originator/Caller UID/GID - [47 12] / [47 12]
X-AntiAbuse: Sender Address Domain - cpanel.net
X-Get-Message-Sender-Via: mx1.cpanel.net: authenticated_id: jacob.perkins@cpanel.net
X-Authenticated-Sender: mx1.cpanel.net: jacob.perkins@cpanel.net


--Apple-Mail=_B1C14E54-EB79-4011-A64D-C3C92353899C
Content-Type: multipart/alternative;
	boundary="Apple-Mail=_CB0AE45C-3DD6-4B91-ADDF-4D6B7B32FDAE"


--Apple-Mail=_CB0AE45C-3DD6-4B91-ADDF-4D6B7B32FDAE
Content-Transfer-Encoding: quoted-printable
Content-Type: text/plain;
	charset=utf-8

We found a .gitignore file ./modules/http2 that is removing the MakeFile =
from the sources. Was this supposed to be merged in? It=E2=80=99s odd, =
because http uses SVN, so we though this might have been =E2=80=98leftover=
=E2=80=99 from a dev branch or something else.

=E2=80=A2 [~/git/httpd] (2.4.x)# git log --stat -- =
./modules/http2/.gitignore
commit 4e7af65fd0a892726e80e834191d4f4573624dda
Author: Stefan Eissing <icing@apache.org>
Date:   Mon Sep 7 17:37:19 2015 +0000

    merge of protocols + http2 relevant changes

    git-svn-id: =
https://svn.apache.org/repos/asf/httpd/httpd/branches/2.4.17-protocols-htt=
p2@1701655 13f79535-47bb-0310-9956-ffa450edef68

 modules/http2/.gitignore | 35 +++++++++++++++++++++++++++++++++++
 1 file changed, 35 insertions(+)

=E2=80=94
Jacob Perkins
Product Owner
cPanel Inc.

jacob.perkins@cpanel.net <mailto:jacob.perkins@cpanel.net>
Office:  713-529-0800 x 4046
Cell:  713-560-8655


--Apple-Mail=_CB0AE45C-3DD6-4B91-ADDF-4D6B7B32FDAE
Content-Transfer-Encoding: quoted-printable
Content-Type: text/html;
	charset=utf-8

<html><head><meta http-equiv=3D"Content-Type" content=3D"text/html =
charset=3Dutf-8"></head><body style=3D"word-wrap: break-word; =
-webkit-nbsp-mode: space; -webkit-line-break: after-white-space;" =
class=3D"">We found a .gitignore file ./modules/http2 that is removing =
the MakeFile from the sources. Was this supposed to be merged in? It=E2=80=
=99s odd, because http uses SVN, so we though this might have been =
=E2=80=98leftover=E2=80=99 from a dev branch or something else.<div =
class=3D""><br class=3D""></div><div class=3D""><div style=3D"margin: =
0px; font-size: 13px; line-height: normal; font-family: Inconsolata; =
color: rgb(131, 148, 150); background-color: rgb(0, 40, 52);" =
class=3D""><span style=3D"color: #859901" class=3D"">=E2=80=A2</span> =
[~/git/httpd] <span style=3D"color: #657b83" class=3D"">(2.4.x)</span># =
git log --stat -- ./modules/http2/.gitignore</div><div style=3D"margin: =
0px; font-size: 13px; line-height: normal; font-family: Inconsolata; =
color: rgb(181, 137, 1); background-color: rgb(0, 40, 52);" =
class=3D"">commit 4e7af65fd0a892726e80e834191d4f4573624dda</div><div =
style=3D"margin: 0px; font-size: 13px; line-height: normal; font-family: =
Inconsolata; color: rgb(131, 148, 150); background-color: rgb(0, 40, =
52);" class=3D"">Author: Stefan Eissing &lt;<a =
href=3D"mailto:icing@apache.org" =
class=3D"">icing@apache.org</a>&gt;</div><div style=3D"margin: 0px; =
font-size: 13px; line-height: normal; font-family: Inconsolata; color: =
rgb(131, 148, 150); background-color: rgb(0, 40, 52);" class=3D"">Date: =
&nbsp; Mon Sep 7 17:37:19 2015 +0000</div><div style=3D"margin: 0px; =
font-size: 13px; line-height: normal; font-family: Inconsolata; color: =
rgb(131, 148, 150); background-color: rgb(0, 40, 52); min-height: 14px;" =
class=3D""><br class=3D""></div><div style=3D"margin: 0px; font-size: =
13px; line-height: normal; font-family: Inconsolata; color: rgb(131, =
148, 150); background-color: rgb(0, 40, 52);" class=3D"">&nbsp; &nbsp; =
merge of protocols + http2 relevant changes</div><div style=3D"margin: =
0px; font-size: 13px; line-height: normal; font-family: Inconsolata; =
color: rgb(131, 148, 150); background-color: rgb(0, 40, 52); min-height: =
14px;" class=3D""><br class=3D""></div><div style=3D"margin: 0px; =
font-size: 13px; line-height: normal; font-family: Inconsolata; color: =
rgb(131, 148, 150); background-color: rgb(0, 40, 52);" class=3D"">&nbsp; =
&nbsp; git-svn-id: <a =
href=3D"https://svn.apache.org/repos/asf/httpd/httpd/branches/2.4.17-proto=
cols-http2@1701655" =
class=3D"">https://svn.apache.org/repos/asf/httpd/httpd/branches/2.4.17-pr=
otocols-http2@1701655</a> 13f79535-47bb-0310-9956-ffa450edef68</div><div =
style=3D"margin: 0px; font-size: 13px; line-height: normal; font-family: =
Inconsolata; color: rgb(131, 148, 150); background-color: rgb(0, 40, =
52); min-height: 14px;" class=3D""><br class=3D""></div><div =
style=3D"margin: 0px; font-size: 13px; line-height: normal; font-family: =
Inconsolata; color: rgb(133, 153, 1); background-color: rgb(0, 40, 52);" =
class=3D""><span style=3D"color: #839496" =
class=3D"">&nbsp;modules/http2/.gitignore | 35 =
</span>+++++++++++++++++++++++++++++++++++</div><div style=3D"margin: =
0px; font-size: 13px; line-height: normal; font-family: Inconsolata; =
color: rgb(131, 148, 150); background-color: rgb(0, 40, 52);" =
class=3D"">&nbsp;1 file changed, 35 insertions(+)</div><div class=3D"">
<div style=3D"color: rgb(0, 0, 0); font-family: Helvetica; font-size: =
12px; font-style: normal; font-variant: normal; font-weight: normal; =
letter-spacing: normal; line-height: normal; text-align: -webkit-auto; =
text-indent: 0px; text-transform: none; white-space: normal; =
word-spacing: 0px; -webkit-text-stroke-width: 0px; orphans: 2; widows: =
2; word-wrap: break-word; -webkit-nbsp-mode: space; -webkit-line-break: =
after-white-space;" class=3D""><br =
class=3D"Apple-interchange-newline">=E2=80=94</div><div style=3D"color: =
rgb(0, 0, 0); font-family: Helvetica; font-size: 12px; font-style: =
normal; font-variant: normal; font-weight: normal; letter-spacing: =
normal; line-height: normal; text-align: -webkit-auto; text-indent: 0px; =
text-transform: none; white-space: normal; word-spacing: 0px; =
-webkit-text-stroke-width: 0px; orphans: 2; widows: 2; word-wrap: =
break-word; -webkit-nbsp-mode: space; -webkit-line-break: =
after-white-space;" class=3D"">Jacob Perkins<br class=3D""></div><div =
style=3D"color: rgb(0, 0, 0); font-family: Helvetica; font-size: 12px; =
font-style: normal; font-variant: normal; font-weight: normal; =
letter-spacing: normal; line-height: normal; text-align: -webkit-auto; =
text-indent: 0px; text-transform: none; white-space: normal; =
word-spacing: 0px; -webkit-text-stroke-width: 0px; orphans: 2; widows: =
2; word-wrap: break-word; -webkit-nbsp-mode: space; -webkit-line-break: =
after-white-space;" class=3D"">Product Owner</div><div style=3D"color: =
rgb(0, 0, 0); font-family: Helvetica; font-size: 12px; font-style: =
normal; font-variant: normal; font-weight: normal; letter-spacing: =
normal; line-height: normal; text-align: -webkit-auto; text-indent: 0px; =
text-transform: none; white-space: normal; word-spacing: 0px; =
-webkit-text-stroke-width: 0px; orphans: 2; widows: 2; word-wrap: =
break-word; -webkit-nbsp-mode: space; -webkit-line-break: =
after-white-space;" class=3D""><b class=3D""><font color=3D"#ff7c00" =
class=3D"">cPanel Inc.</font></b></div><div style=3D"color: rgb(0, 0, =
0); font-family: Helvetica; font-size: 12px; font-style: normal; =
font-variant: normal; font-weight: normal; letter-spacing: normal; =
line-height: normal; text-align: -webkit-auto; text-indent: 0px; =
text-transform: none; white-space: normal; word-spacing: 0px; =
-webkit-text-stroke-width: 0px; orphans: 2; widows: 2; word-wrap: =
break-word; -webkit-nbsp-mode: space; -webkit-line-break: =
after-white-space;" class=3D""><br class=3D""></div><div style=3D"color: =
rgb(0, 0, 0); font-family: Helvetica; font-size: 12px; font-style: =
normal; font-variant: normal; font-weight: normal; letter-spacing: =
normal; line-height: normal; text-align: -webkit-auto; text-indent: 0px; =
text-transform: none; white-space: normal; word-spacing: 0px; =
-webkit-text-stroke-width: 0px; orphans: 2; widows: 2; word-wrap: =
break-word; -webkit-nbsp-mode: space; -webkit-line-break: =
after-white-space;" class=3D""><a href=3D"mailto:jacob.perkins@cpanel.net"=
 class=3D"">jacob.perkins@cpanel.net</a></div><div style=3D"color: =
rgb(0, 0, 0); font-family: Helvetica; font-size: 12px; font-style: =
normal; font-variant: normal; font-weight: normal; letter-spacing: =
normal; line-height: normal; text-align: -webkit-auto; text-indent: 0px; =
text-transform: none; white-space: normal; word-spacing: 0px; =
-webkit-text-stroke-width: 0px; orphans: 2; widows: 2; word-wrap: =
break-word; -webkit-nbsp-mode: space; -webkit-line-break: =
after-white-space;" class=3D"">Office: &nbsp;713-529-0800 =
x&nbsp;4046</div><div style=3D"color: rgb(0, 0, 0); font-family: =
Helvetica; font-size: 12px; font-style: normal; font-variant: normal; =
font-weight: normal; letter-spacing: normal; line-height: normal; =
text-align: -webkit-auto; text-indent: 0px; text-transform: none; =
white-space: normal; word-spacing: 0px; -webkit-text-stroke-width: 0px; =
orphans: 2; widows: 2; word-wrap: break-word; -webkit-nbsp-mode: space; =
-webkit-line-break: after-white-space;" class=3D"">Cell: =
&nbsp;713-560-8655</div>
</div>
<br class=3D""></div></body></html>=

--Apple-Mail=_CB0AE45C-3DD6-4B91-ADDF-4D6B7B32FDAE--

--Apple-Mail=_B1C14E54-EB79-4011-A64D-C3C92353899C
Content-Transfer-Encoding: 7bit
Content-Disposition: attachment;
	filename=signature.asc
Content-Type: application/pgp-signature;
	name=signature.asc
Content-Description: Message signed with OpenPGP using GPGMail

-----BEGIN PGP SIGNATURE-----
Comment: GPGTools - https://gpgtools.org

iQEcBAEBCgAGBQJWgWddAAoJEIo8JcFLoqwqI2UIAIcD8t/CTHAumAdg6UcTAKKr
4fFdxPznumx+NxWVUNueq8eiJuChZz3GPjBFT2QySo1xJI7G2llQmYTloMfUBJ6k
2JO+orkJm4WC5ktpV33cjIx62u3rmlteQBvXRe3Z1i20O+mJTKCG1pFUdlpz/F3D
ei7LpxJA1+Spz2Db5h39i16l9w8uu8A9Oeok8ZKMEwU17stiurs2HM0ZlzIGa4uH
8K0PIdt1bePt9HGpgi8gbiswKQ2Y44KLN31Dka05/wHCLPsOJGRAePyuHT1oC3me
RRVlIld6s/viiUV/jVZrMl8EQPVfSq10hhZgQZ0CG1O15DswLDulSggStROS5PY=
=85cU
-----END PGP SIGNATURE-----

--Apple-Mail=_B1C14E54-EB79-4011-A64D-C3C92353899C--

From dev-return-85114-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Mon Dec 28 17:01:44 2015
Return-Path: <dev-return-85114-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 453E91858B
	for <apmail-httpd-dev-archive@www.apache.org>; Mon, 28 Dec 2015 17:01:44 +0000 (UTC)
Received: (qmail 71901 invoked by uid 500); 28 Dec 2015 17:01:43 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 71822 invoked by uid 500); 28 Dec 2015 17:01:43 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 71812 invoked by uid 99); 28 Dec 2015 17:01:43 -0000
Received: from Unknown (HELO spamd4-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Mon, 28 Dec 2015 17:01:43 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd4-us-west.apache.org (ASF Mail Server at spamd4-us-west.apache.org) with ESMTP id 31A6CC023A
	for <dev@httpd.apache.org>; Mon, 28 Dec 2015 17:01:43 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd4-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.101
X-Spam-Level:
X-Spam-Status: No, score=-0.101 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RCVD_IN_MSPIKE_H2=-0.001, SPF_PASS=-0.001, URIBL_BLOCKED=0.001]
	autolearn=disabled
Authentication-Results: spamd4-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd4-us-west.apache.org [10.40.0.11]) (amavisd-new, port 10024)
	with ESMTP id 3sF939tXs07z for <dev@httpd.apache.org>;
	Mon, 28 Dec 2015 17:01:37 +0000 (UTC)
Received: from mail-io0-f179.google.com (mail-io0-f179.google.com [209.85.223.179])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id 2C39220CB8
	for <dev@httpd.apache.org>; Mon, 28 Dec 2015 17:01:36 +0000 (UTC)
Received: by mail-io0-f179.google.com with SMTP id q126so308719359iof.2
        for <dev@httpd.apache.org>; Mon, 28 Dec 2015 09:01:36 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type:content-transfer-encoding;
        bh=eu0Ta2X+gvb+JZZqWczd0aBPI7vhj0Dj9Rwltcd9LEI=;
        b=EhM5yDYzUPx70Q4XzTqChHvrYlALLP8g9ZgWzBf7GC/ySZQKhBPiKNAEtzKUS51ylv
         N3XtjP0B9BpZq/MkAWrhP9MEa95PPP3B6jfgF9MxJj559TprLbxe0qXYCWPzCydsGJOe
         Xt63kRMMcPtLy/Frxt5ANRBdZAIzpoLMWy0aTDslv+HRX5wYzw+KeV63Eat5chSjB/lc
         yxhNjUKSKc5EnP5UK849P6rw8mwHVvGXUE+JielB+UrEhW/LPV+ToWFuJyVlAFGUbLzl
         aftgnoLdzTYnCr5xYUNbz/+RwmNQ5Kj6AvtU4qKmp1cIQZOhR2u0iNp7aQbQRsAkDrQf
         jdiQ==
MIME-Version: 1.0
X-Received: by 10.107.6.42 with SMTP id 42mr53918712iog.90.1451322095158; Mon,
 28 Dec 2015 09:01:35 -0800 (PST)
Received: by 10.64.114.199 with HTTP; Mon, 28 Dec 2015 09:01:35 -0800 (PST)
In-Reply-To: <974A0566-FE37-4115-A5A7-6C9D364EA133@cpanel.net>
References: <974A0566-FE37-4115-A5A7-6C9D364EA133@cpanel.net>
Date: Mon, 28 Dec 2015 12:01:35 -0500
Message-ID: <CALK=YjOv3hg5VXd4SNd1xFbCd6p6pXGsPCwPDNrXBMtX8dEx9g@mail.gmail.com>
Subject: Re: .gitignore found in modules/http2
From: Eric Covener <covener@gmail.com>
To: Apache HTTP Server Development List <dev@httpd.apache.org>
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: quoted-printable

On Mon, Dec 28, 2015 at 11:46 AM, Jacob Perkins
<jacob.perkins@cpanel.net> wrote:
> We found a .gitignore file ./modules/http2 that is removing the MakeFile
> from the sources. Was this supposed to be merged in? It=E2=80=99s odd, be=
cause http
> uses SVN, so we though this might have been =E2=80=98leftover=E2=80=99 fr=
om a dev branch or
> something else

It was probably inadvertent, or supports Stefan's workflow -- but
all of the Makefile's are not checked in / generated and svn:ignore'd too
so no harm.

--=20
Eric Covener
covener@gmail.com

From dev-return-85115-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Tue Dec 29 09:08:12 2015
Return-Path: <dev-return-85115-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 9D45518295
	for <apmail-httpd-dev-archive@www.apache.org>; Tue, 29 Dec 2015 09:08:12 +0000 (UTC)
Received: (qmail 752 invoked by uid 500); 29 Dec 2015 09:08:12 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 651 invoked by uid 500); 29 Dec 2015 09:08:11 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 641 invoked by uid 99); 29 Dec 2015 09:08:11 -0000
Received: from Unknown (HELO spamd3-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 29 Dec 2015 09:08:11 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd3-us-west.apache.org (ASF Mail Server at spamd3-us-west.apache.org) with ESMTP id 5E47A1804CC
	for <dev@httpd.apache.org>; Tue, 29 Dec 2015 09:08:11 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd3-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.654
X-Spam-Level:
X-Spam-Status: No, score=-0.654 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RP_MATCHES_RCVD=-0.554, SPF_PASS=-0.001, URIBL_BLOCKED=0.001]
	autolearn=disabled
Authentication-Results: spamd3-us-west.apache.org (amavisd-new);
	dkim=pass (1024-bit key) header.d=greenbytes.de header.b=Pu7kzqI+;
	dkim=pass (1024-bit key) header.d=greenbytes.de header.b=A5sY/qjn
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd3-us-west.apache.org [10.40.0.10]) (amavisd-new, port 10024)
	with ESMTP id t5-Le6PvI_Sb for <dev@httpd.apache.org>;
	Tue, 29 Dec 2015 09:08:03 +0000 (UTC)
Received: from mail.greenbytes.de (mail.greenbytes.de [217.91.35.233])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id 7A89324C11
	for <dev@httpd.apache.org>; Tue, 29 Dec 2015 09:08:03 +0000 (UTC)
Received: by mail.greenbytes.de (Postfix, from userid 117)
	id 0A4C115A0653; Tue, 29 Dec 2015 10:07:57 +0100 (CET)
DKIM-Signature: v=1; a=rsa-sha256; c=simple/simple; d=greenbytes.de; s=mail;
	t=1451380077; bh=w1BLrloIHLn4U6ZhsDw9kxDZDOsw5pghcs3exDuvi5U=;
	h=Subject:From:In-Reply-To:Date:References:To:From;
	b=Pu7kzqI+Ek+oiDiX33zUHp6jxvf4g6lLFNuOvAK6/v9dZQPg4xtSqaNtlHB3jW5N4
	 +D04i06BGCYKm4hQDljXZD4xQBfIeS6GubX//E7TVH6pNeuHvwp/STP9my+qcP68Hr
	 K1pZPMe8GG6ID8zQF1UtjVOKBI5U71wHs3VRAUf4=
Received: from [192.168.1.42] (unknown [217.91.35.233])
	(using TLSv1 with cipher ECDHE-RSA-AES256-SHA (256/256 bits))
	(Client did not present a certificate)
	by mail.greenbytes.de (Postfix) with ESMTPSA id 5C25C15A0309
	for <dev@httpd.apache.org>; Tue, 29 Dec 2015 10:07:56 +0100 (CET)
DKIM-Signature: v=1; a=rsa-sha256; c=simple/simple; d=greenbytes.de; s=mail;
	t=1451380076; bh=w1BLrloIHLn4U6ZhsDw9kxDZDOsw5pghcs3exDuvi5U=;
	h=Subject:From:In-Reply-To:Date:References:To:From;
	b=A5sY/qjny7D/w2wZk5Qx9tlwH/GFCMWXSSDW+NSmPxCfflqTqxAIvXV1n/sQgSsDI
	 oyfNna4V/vVsleHBsN9gHkTXE9d/THMBS9QShFLamgaC6r2gwEcLhEDQPOy5+IlCaM
	 qxaS2HqUUR0wP18G1jHrXJt2/rySbr5ZNeKqiEcs=
Content-Type: text/plain; charset=utf-8
Mime-Version: 1.0 (Mac OS X Mail 9.2 \(3112\))
Subject: Re: .gitignore found in modules/http2
From: Stefan Eissing <stefan.eissing@greenbytes.de>
In-Reply-To: <CALK=YjOv3hg5VXd4SNd1xFbCd6p6pXGsPCwPDNrXBMtX8dEx9g@mail.gmail.com>
Date: Tue, 29 Dec 2015 10:07:56 +0100
Content-Transfer-Encoding: quoted-printable
Message-Id: <3579DA4E-17AD-40A0-AA24-A087B5BEF950@greenbytes.de>
References: <974A0566-FE37-4115-A5A7-6C9D364EA133@cpanel.net> <CALK=YjOv3hg5VXd4SNd1xFbCd6p6pXGsPCwPDNrXBMtX8dEx9g@mail.gmail.com>
To: dev@httpd.apache.org
X-Mailer: Apple Mail (2.3112)

Gone in r1722074. Was added by the original import.

> Am 28.12.2015 um 18:01 schrieb Eric Covener <covener@gmail.com>:
>=20
> On Mon, Dec 28, 2015 at 11:46 AM, Jacob Perkins
> <jacob.perkins@cpanel.net> wrote:
>> We found a .gitignore file ./modules/http2 that is removing the =
MakeFile
>> from the sources. Was this supposed to be merged in? It=E2=80=99s =
odd, because http
>> uses SVN, so we though this might have been =E2=80=98leftover=E2=80=99 =
from a dev branch or
>> something else
>=20
> It was probably inadvertent, or supports Stefan's workflow -- but
> all of the Makefile's are not checked in / generated and svn:ignore'd =
too
> so no harm.
>=20
> --=20
> Eric Covener
> covener@gmail.com


From dev-return-85116-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Tue Dec 29 14:24:56 2015
Return-Path: <dev-return-85116-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id C56ED18D69
	for <apmail-httpd-dev-archive@www.apache.org>; Tue, 29 Dec 2015 14:24:56 +0000 (UTC)
Received: (qmail 55836 invoked by uid 500); 29 Dec 2015 14:24:56 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 55757 invoked by uid 500); 29 Dec 2015 14:24:56 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 55745 invoked by uid 99); 29 Dec 2015 14:24:56 -0000
Received: from Unknown (HELO spamd2-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 29 Dec 2015 14:24:56 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd2-us-west.apache.org (ASF Mail Server at spamd2-us-west.apache.org) with ESMTP id 457111A00E7
	for <dev@httpd.apache.org>; Tue, 29 Dec 2015 14:24:55 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd2-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 0.653
X-Spam-Level:
X-Spam-Status: No, score=0.653 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, SPF_NEUTRAL=0.652,
	URIBL_BLOCKED=0.001] autolearn=disabled
Authentication-Results: spamd2-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=comcast.net
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd2-us-west.apache.org [10.40.0.9]) (amavisd-new, port 10024)
	with ESMTP id 61vi4LFjGogj for <dev@httpd.apache.org>;
	Tue, 29 Dec 2015 14:24:46 +0000 (UTC)
Received: from resqmta-po-12v.sys.comcast.net (resqmta-po-12v.sys.comcast.net [96.114.154.171])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id 1B6F4439C4
	for <dev@httpd.apache.org>; Tue, 29 Dec 2015 14:24:47 +0000 (UTC)
Received: from resomta-po-14v.sys.comcast.net ([96.114.154.238])
	by resqmta-po-12v.sys.comcast.net with comcast
	id zSQT1r00658ss0Y01SQgwF; Tue, 29 Dec 2015 14:24:40 +0000
Received: from [192.168.199.10] ([69.251.84.114])
	by resomta-po-14v.sys.comcast.net with comcast
	id zSQf1r0032U0RYt01SQfAt; Tue, 29 Dec 2015 14:24:40 +0000
Content-Type: text/plain; charset=us-ascii
Mime-Version: 1.0 (Mac OS X Mail 9.2 \(3112\))
Subject: Re: Better ap_casecmpstr[n]?
From: Jim Jagielski <jim@jaguNET.com>
In-Reply-To: <C60EE890-B1C6-4259-9D11-1FD54637FAF1@jaguNET.com>
Date: Tue, 29 Dec 2015 09:24:39 -0500
Content-Transfer-Encoding: 7bit
Message-Id: <ECDB0049-A874-44E0-A692-34BC10B7D408@jaguNET.com>
References: <CAKQ1sVOgsKky7tLp2nH_t1tMuJX+sgg4hULztMPRtcSx9NEW9Q@mail.gmail.com> <5654AEFB.1020704@aldan.algebra.com> <CAKQ1sVMJ1LBDHcoQy1YGa-_OMR2J6To557BwYwCQqDM+SBV8gw@mail.gmail.com> <CACsi253_f527B2M8dM1i2KGO8agy_RRrWEd89vAbk1PzcUcFWg@mail.gmail.com> <CAKQ1sVNS_XFo+4JK85fyF-mPtMdQ+02M=QbSMd34i+FAEh_r9A@mail.gmail.com> <CACsi250qDh-xcEG3Zsk7bKWLPs7n0Kh_Pzms_h-UwFTmKN5Odg@mail.gmail.com> <C60EE890-B1C6-4259-9D11-1FD54637FAF1@jaguNET.com>
To: dev@httpd.apache.org
X-Mailer: Apple Mail (2.3112)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=comcast.net;
	s=q20140121; t=1451399080;
	bh=OIr+TzH6GakkxYY3AxisjqeqBuwWna3KtfRjvT9AxGg=;
	h=Received:Received:Content-Type:Mime-Version:Subject:From:Date:
	 Message-Id:To;
	b=etLeS5B75GwtFe2g+l4rO1v/WHGzhPIfhykAH+4y+rc9E0DzWbsjPMYWfUOU5y3b8
	 fT3oRPlLKphEgm5w/wI4ImyyXJqm4yGTprbbiFqvi3GMRGr5cVFM9aFn7pQnEMFX5C
	 n28Rhir0Ur+K99ivYTOs1hZcmfu7e9bTniVhYbeZwmoH8pqiDkOHQ/3ociItg3dX4d
	 rf0LF3T820gEhn8JN1RHHiGermW/MeGJBMYkt8WcNaleOuAX4i/seCfl5Wb9JZcHsX
	 kw7CGP/CZnqM1QNhqxCz2nSFhgPILfT18dcmJVAunQAw5EKMxswl29Hx3rzT3u2+ru
	 E2juKh67VJSzw==

ping.

Just a reminder that right now, trunk uses ap_casecmpstr[n](),
which can make some backport requests "problematic" due to
possible merge conflicts.

Can we *please* decide what we are doing?

trunk is starting to accumulate a bunch of kruft, which
will make it difficult when we decide to start 2.6 in earnest.
All you have to do is look at the 2.4 backports which are
based on some of that trunk "kruft" which is not in a
state which we feel comfortable backporting. Now certainly
some stuff can't be backported easily, but it's also not
good having stuff in trunk which is wonky enough that we
don't feel like it's ready for prime-time in 2.4 no matter
what we do (or is simply being ignored).


> On Nov 25, 2015, at 11:17 AM, Jim Jagielski <jim@jaguNET.com> wrote:
> 
> What is the current status? Is this on hold?


From dev-return-85117-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Tue Dec 29 15:56:41 2015
Return-Path: <dev-return-85117-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id E78A918FF7
	for <apmail-httpd-dev-archive@www.apache.org>; Tue, 29 Dec 2015 15:56:41 +0000 (UTC)
Received: (qmail 85763 invoked by uid 500); 29 Dec 2015 15:56:41 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 85692 invoked by uid 500); 29 Dec 2015 15:56:41 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 85682 invoked by uid 99); 29 Dec 2015 15:56:41 -0000
Received: from Unknown (HELO spamd4-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 29 Dec 2015 15:56:41 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd4-us-west.apache.org (ASF Mail Server at spamd4-us-west.apache.org) with ESMTP id C3F2DC0CFB
	for <dev@httpd.apache.org>; Tue, 29 Dec 2015 15:56:40 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd4-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 0.68
X-Spam-Level:
X-Spam-Status: No, score=0.68 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	KAM_ASCII_DIVIDERS=0.8, RCVD_IN_MSPIKE_H3=-0.01,
	RCVD_IN_MSPIKE_WL=-0.01, SPF_PASS=-0.001, URIBL_BLOCKED=0.001]
	autolearn=disabled
Authentication-Results: spamd4-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-us-west.apache.org ([10.40.0.8])
	by localhost (spamd4-us-west.apache.org [10.40.0.11]) (amavisd-new, port 10024)
	with ESMTP id tZoQaT7JgIWl for <dev@httpd.apache.org>;
	Tue, 29 Dec 2015 15:56:26 +0000 (UTC)
Received: from mail-qk0-f177.google.com (mail-qk0-f177.google.com [209.85.220.177])
	by mx1-us-west.apache.org (ASF Mail Server at mx1-us-west.apache.org) with ESMTPS id 1B2EB201C0
	for <dev@httpd.apache.org>; Tue, 29 Dec 2015 15:56:26 +0000 (UTC)
Received: by mail-qk0-f177.google.com with SMTP id p187so205021380qkd.1
        for <dev@httpd.apache.org>; Tue, 29 Dec 2015 07:56:26 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        bh=7He5flo7cCfZ0LrPmmAAE1m8YkS9q127sS781GSkreQ=;
        b=bUoXiyTDxZSr2DwhvAf8EC+PgJcv0A5KCe3HAl1lQPKXiRTcq5SuNwsWVK9NcKG16Y
         5gehz0gdVfAVwmRQdiEb/BplcWlIMc66LmL51GbnhhqEf/AfCXJ4B/WPcK3OeAyWTJOh
         6w4dnc4zFM3LjdrcR76ypGRP0Z/rAH0+fAFVSaxhgzkA7XSIC7UWo/IuU5jFOY7L7+NN
         I2ZotN6eMsop3QHsLQga76moPUjcLd9QEy2H/6EqUDAzWkPmxlZmOVW66FhUwCNBYW9i
         HfwMzR2MBTYw8jgLFlS97U9VSB+CEHbLdSTTt0q0V9MOD2DyVOp3qUW+cWzPxSpJu48T
         Cfmg==
MIME-Version: 1.0
X-Received: by 10.55.80.194 with SMTP id e185mr77420001qkb.68.1451404578898;
 Tue, 29 Dec 2015 07:56:18 -0800 (PST)
Received: by 10.55.65.85 with HTTP; Tue, 29 Dec 2015 07:56:18 -0800 (PST)
In-Reply-To: <ECDB0049-A874-44E0-A692-34BC10B7D408@jaguNET.com>
References: <CAKQ1sVOgsKky7tLp2nH_t1tMuJX+sgg4hULztMPRtcSx9NEW9Q@mail.gmail.com>
	<5654AEFB.1020704@aldan.algebra.com>
	<CAKQ1sVMJ1LBDHcoQy1YGa-_OMR2J6To557BwYwCQqDM+SBV8gw@mail.gmail.com>
	<CACsi253_f527B2M8dM1i2KGO8agy_RRrWEd89vAbk1PzcUcFWg@mail.gmail.com>
	<CAKQ1sVNS_XFo+4JK85fyF-mPtMdQ+02M=QbSMd34i+FAEh_r9A@mail.gmail.com>
	<CACsi250qDh-xcEG3Zsk7bKWLPs7n0Kh_Pzms_h-UwFTmKN5Odg@mail.gmail.com>
	<C60EE890-B1C6-4259-9D11-1FD54637FAF1@jaguNET.com>
	<ECDB0049-A874-44E0-A692-34BC10B7D408@jaguNET.com>
Date: Tue, 29 Dec 2015 16:56:18 +0100
Message-ID: <CAKQ1sVO3Js8Sw9oLUNQ7ZPntsYxsmtXUE2vPOfngPTun0bq0kw@mail.gmail.com>
Subject: Re: Better ap_casecmpstr[n]?
From: Yann Ylavic <ylavic.dev@gmail.com>
To: httpd-dev <dev@httpd.apache.org>
Content-Type: multipart/mixed; boundary=001a114a696c59efc805280b76df

--001a114a696c59efc805280b76df
Content-Type: text/plain; charset=UTF-8

On Tue, Dec 29, 2015 at 3:24 PM, Jim Jagielski <jim@jagunet.com> wrote:
> ping.
>
> Just a reminder that right now, trunk uses ap_casecmpstr[n](),
> which can make some backport requests "problematic" due to
> possible merge conflicts.

I've just committed (in r1722150) more reverts of abusive
ap_casecmpstr[n]() usage I introduced in r1715880.
This now leave us the attached 2.4.x backport patch should we decide
to apply these changes to 2.4.x.

>
> Can we *please* decide what we are doing?

I'd vote for the backport...

--001a114a696c59efc805280b76df
Content-Type: text/diff; charset=US-ASCII; name="httpd-2.4.x-ap_casecmpstr.patch"
Content-Disposition: attachment; filename="httpd-2.4.x-ap_casecmpstr.patch"
Content-Transfer-Encoding: base64
X-Attachment-Id: f_iirkrio40

SW5kZXg6IGluY2x1ZGUvYXBfbW1uLmgKPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQotLS0gaW5jbHVkZS9hcF9tbW4uaAko
cmV2aXNpb24gMTcyMjE0MykKKysrIGluY2x1ZGUvYXBfbW1uLmgJKHdvcmtpbmcgY29weSkKQEAg
LTQ1Nyw2ICs0NTcsNyBAQAogICogICAgICAgICAgICAgICAgICAgICAgICAgIGFwX2dldF9wcm90
b2NvbCgpLiBBZGQgSFRUUF9NSVNESVJFQ1RFRF9SRVFVRVNULgogICogICAgICAgICAgICAgICAg
ICAgICAgICAgIEFkZGVkIGFwX3BhcnNlX3Rva2VuX2xpc3Rfc3RyaWN0KCkgdG8gaHR0cGQuaAog
ICogMjAxMjAyMTEuNTIgKDIuNC4xNy1kZXYpIEFkZCBtYXN0ZXIgY29ubl9yZWMqIG1lbWJlciBp
biBjb25uX3JlYy4KKyAqIDIwMTIwMjExLjUzICgyLjQuMTktZGV2KSBBZGQgYXBfY2FzZWNtcHN0
cltuXSgpOwogICovCiAKICNkZWZpbmUgTU9EVUxFX01BR0lDX0NPT0tJRSAweDQxNTAzMjM0VUwg
LyogIkFQMjQiICovCkBAIC00NjQsNyArNDY1LDcgQEAKICNpZm5kZWYgTU9EVUxFX01BR0lDX05V
TUJFUl9NQUpPUgogI2RlZmluZSBNT0RVTEVfTUFHSUNfTlVNQkVSX01BSk9SIDIwMTIwMjExCiAj
ZW5kaWYKLSNkZWZpbmUgTU9EVUxFX01BR0lDX05VTUJFUl9NSU5PUiA1MiAgICAgICAgICAgICAg
ICAgICAvKiAwLi4ubiAqLworI2RlZmluZSBNT0RVTEVfTUFHSUNfTlVNQkVSX01JTk9SIDUzICAg
ICAgICAgICAgICAgICAgIC8qIDAuLi5uICovCiAKIC8qKgogICogRGV0ZXJtaW5lIGlmIHRoZSBz
ZXJ2ZXIncyBjdXJyZW50IE1PRFVMRV9NQUdJQ19OVU1CRVIgaXMgYXQgbGVhc3QgYQpJbmRleDog
aW5jbHVkZS9odHRwZC5oCj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT0KLS0tIGluY2x1ZGUvaHR0cGQuaAkocmV2aXNpb24g
MTcyMjE0MykKKysrIGluY2x1ZGUvaHR0cGQuaAkod29ya2luZyBjb3B5KQpAQCAtMjMxMiw2ICsy
MzEyLDI3IEBAIEFQX0RFQ0xBUkUoaW50KSBhcF9hcnJheV9zdHJfaW5kZXgoY29uc3QgYXByX2Fy
cmF5CiBBUF9ERUNMQVJFKGludCkgYXBfYXJyYXlfc3RyX2NvbnRhaW5zKGNvbnN0IGFwcl9hcnJh
eV9oZWFkZXJfdCAqYXJyYXksIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICBjb25zdCBjaGFyICpzKTsKIAorLyoqCisgKiBLbm93bi1mYXN0IHZlcnNpb24gb2Ygc3RyY2Fz
ZWNtcCgpOiBBU0NJSSBjYXNlLWZvbGRpbmcsIFBPU0lYIGNvbXBsaWFudAorICogQHBhcmFtIHMx
IFRoZSAxc3Qgc3RyaW5nIHRvIGNvbXBhcmUKKyAqIEBwYXJhbSBzMiBUaGUgMm5kIHN0cmluZyB0
byBjb21wYXJlCisgKiBAcmV0dXJuIGludGVnZXIgZ3JlYXRlciB0aGFuLCBlcXVhbCB0bywgb3Ig
bGVzcyB0aGFuIDAsIGRlcGVuZGluZyBvbgorICogICAgICAgICBpZiBzMSBpcyBsZXhpY29ncmFw
aGljYWxseSBncmVhdGVyIHRoYW4sIGVxdWFsIHRvLCBvciBsZXNzCisgKiAgICAgICAgIHRoYW4g
czIgaWdub3JpbmcgY2FzZS4KKyAqLworQVBfREVDTEFSRShpbnQpIGFwX2Nhc2VjbXBzdHIoY29u
c3QgY2hhciAqczEsIGNvbnN0IGNoYXIgKnMyKTsKKworLyoqCisgKiBLbm93bi1mYXN0IHZlcnNp
b24gb2Ygc3RybmNhc2VjbXAoKTogQVNDSUkgY2FzZS1mb2xkaW5nLCBQT1NJWCBjb21wbGlhbnQK
KyAqIEBwYXJhbSBzMSBUaGUgMXN0IHN0cmluZyB0byBjb21wYXJlCisgKiBAcGFyYW0gczIgVGhl
IDJuZCBzdHJpbmcgdG8gY29tcGFyZQorICogQHBhcmFtIG4gIE1heGltdW0gbnVtYmVyIG9mIGNo
YXJhY3RlcnMgaW4gdGhlIHN0cmluZ3MgdG8gY29tcGFyZQorICogQHJldHVybiBpbnRlZ2VyIGdy
ZWF0ZXIgdGhhbiwgZXF1YWwgdG8sIG9yIGxlc3MgdGhhbiAwLCBkZXBlbmRpbmcgb24KKyAqICAg
ICAgICAgaWYgczEgaXMgbGV4aWNvZ3JhcGhpY2FsbHkgZ3JlYXRlciB0aGFuLCBlcXVhbCB0bywg
b3IgbGVzcworICogICAgICAgICB0aGFuIHMyIGlnbm9yaW5nIGNhc2UuCisgKi8KK0FQX0RFQ0xB
UkUoaW50KSBhcF9jYXNlY21wc3Rybihjb25zdCBjaGFyICpzMSwgY29uc3QgY2hhciAqczIsIGFw
cl9zaXplX3Qgbik7CisKICNpZmRlZiBfX2NwbHVzcGx1cwogfQogI2VuZGlmCkluZGV4OiBtb2R1
bGVzL2FhYS9tb2RfYXV0aF9iYXNpYy5jCj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KLS0tIG1vZHVsZXMvYWFhL21vZF9h
dXRoX2Jhc2ljLmMJKHJldmlzaW9uIDE3MjIxNDMpCisrKyBtb2R1bGVzL2FhYS9tb2RfYXV0aF9i
YXNpYy5jCSh3b3JraW5nIGNvcHkpCkBAIC0yNDIsNyArMjQyLDcgQEAgc3RhdGljIHZvaWQgbm90
ZV9iYXNpY19hdXRoX2ZhaWx1cmUocmVxdWVzdF9yZWMgKnIKIAogc3RhdGljIGludCBob29rX25v
dGVfYmFzaWNfYXV0aF9mYWlsdXJlKHJlcXVlc3RfcmVjICpyLCBjb25zdCBjaGFyICphdXRoX3R5
cGUpCiB7Ci0gICAgaWYgKHN0cmNhc2VjbXAoYXV0aF90eXBlLCAiQmFzaWMiKSkKKyAgICBpZiAo
YXBfY2FzZWNtcHN0cihhdXRoX3R5cGUsICJCYXNpYyIpKQogICAgICAgICByZXR1cm4gREVDTElO
RUQ7CiAKICAgICBub3RlX2Jhc2ljX2F1dGhfZmFpbHVyZShyKTsKQEAgLTI2NSw3ICsyNjUsNyBA
QCBzdGF0aWMgaW50IGdldF9iYXNpY19hdXRoKHJlcXVlc3RfcmVjICpyLCBjb25zdCBjaAogICAg
ICAgICByZXR1cm4gSFRUUF9VTkFVVEhPUklaRUQ7CiAgICAgfQogCi0gICAgaWYgKHN0cmNhc2Vj
bXAoYXBfZ2V0d29yZChyLT5wb29sLCAmYXV0aF9saW5lLCAnICcpLCAiQmFzaWMiKSkgeworICAg
IGlmIChhcF9jYXNlY21wc3RyKGFwX2dldHdvcmQoci0+cG9vbCwgJmF1dGhfbGluZSwgJyAnKSwg
IkJhc2ljIikpIHsKICAgICAgICAgLyogQ2xpZW50IHRyaWVkIHRvIGF1dGhlbnRpY2F0ZSB1c2lu
ZyB3cm9uZyBhdXRoIHNjaGVtZSAqLwogICAgICAgICBhcF9sb2dfcmVycm9yKEFQTE9HX01BUkss
IEFQTE9HX0VSUiwgMCwgciwgQVBMT0dOTygwMTYxNCkKICAgICAgICAgICAgICAgICAgICAgICAi
Y2xpZW50IHVzZWQgd3JvbmcgYXV0aGVudGljYXRpb24gc2NoZW1lOiAlcyIsIHItPnVyaSk7CkBA
IC0zMDUsNyArMzA1LDcgQEAgc3RhdGljIGludCBhdXRoZW50aWNhdGVfYmFzaWNfdXNlcihyZXF1
ZXN0X3JlYyAqcikKIAogICAgIC8qIEFyZSB3ZSBjb25maWd1cmVkIHRvIGJlIEJhc2ljIGF1dGg/
ICovCiAgICAgY3VycmVudF9hdXRoID0gYXBfYXV0aF90eXBlKHIpOwotICAgIGlmICghY3VycmVu
dF9hdXRoIHx8IHN0cmNhc2VjbXAoY3VycmVudF9hdXRoLCAiQmFzaWMiKSkgeworICAgIGlmICgh
Y3VycmVudF9hdXRoIHx8IGFwX2Nhc2VjbXBzdHIoY3VycmVudF9hdXRoLCAiQmFzaWMiKSkgewog
ICAgICAgICByZXR1cm4gREVDTElORUQ7CiAgICAgfQogCkluZGV4OiBtb2R1bGVzL2FhYS9tb2Rf
YXV0aF9kaWdlc3QuYwo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09Ci0tLSBtb2R1bGVzL2FhYS9tb2RfYXV0aF9kaWdlc3Qu
YwkocmV2aXNpb24gMTcyMjE0MykKKysrIG1vZHVsZXMvYWFhL21vZF9hdXRoX2RpZ2VzdC5jCSh3
b3JraW5nIGNvcHkpCkBAIC01NDEsNyArNTQxLDcgQEAgc3RhdGljIGNvbnN0IGNoYXIgKnNldF9x
b3AoY21kX3Bhcm1zICpjbWQsIHZvaWQgKmMKICAgICBpZiAoIXN0cmNhc2VjbXAob3AsICJhdXRo
LWludCIpKSB7CiAgICAgICAgIHJldHVybiAiQXV0aERpZ2VzdFFvcCBhdXRoLWludCBpcyBub3Qg
aW1wbGVtZW50ZWQiOwogICAgIH0KLSAgICBlbHNlIGlmIChzdHJjYXNlY21wKG9wLCAiYXV0aCIp
KSB7CisgICAgZWxzZSBpZiAoYXBfY2FzZWNtcHN0cihvcCwgImF1dGgiKSkgewogICAgICAgICBy
ZXR1cm4gYXByX3BzdHJjYXQoY21kLT5wb29sLCAiVW5yZWNvZ25pemVkIHFvcDogIiwgb3AsIE5V
TEwpOwogICAgIH0KIApAQCAtNTk0LDcgKzU5NCw3IEBAIHN0YXRpYyBjb25zdCBjaGFyICpzZXRf
YWxnb3JpdGhtKGNtZF9wYXJtcyAqY21kLCB2CiAgICAgICAgIHJldHVybiAiQXV0aERpZ2VzdEFs
Z29yaXRobTogRVJST1I6IGFsZ29yaXRobSBgTUQ1LXNlc3MnICIKICAgICAgICAgICAgICAgICAi
aXMgbm90IGZ1bGx5IGltcGxlbWVudGVkIjsKICAgICB9Ci0gICAgZWxzZSBpZiAoc3RyY2FzZWNt
cChhbGcsICJNRDUiKSkgeworICAgIGVsc2UgaWYgKGFwX2Nhc2VjbXBzdHIoYWxnLCAiTUQ1Iikp
IHsKICAgICAgICAgcmV0dXJuIGFwcl9wc3RyY2F0KGNtZC0+cG9vbCwgIkludmFsaWQgYWxnb3Jp
dGhtIGluIEF1dGhEaWdlc3RBbGdvcml0aG06ICIsIGFsZywgTlVMTCk7CiAgICAgfQogCkBAIC04
OTMsNyArODkzLDcgQEAgc3RhdGljIGludCBnZXRfZGlnZXN0X3JlYyhyZXF1ZXN0X3JlYyAqciwg
ZGlnZXN0X2gKICAgICB9CiAKICAgICByZXNwLT5zY2hlbWUgPSBhcF9nZXR3b3JkX3doaXRlKHIt
PnBvb2wsICZhdXRoX2xpbmUpOwotICAgIGlmIChzdHJjYXNlY21wKHJlc3AtPnNjaGVtZSwgIkRp
Z2VzdCIpKSB7CisgICAgaWYgKGFwX2Nhc2VjbXBzdHIocmVzcC0+c2NoZW1lLCAiRGlnZXN0Iikp
IHsKICAgICAgICAgcmVzcC0+YXV0aF9oZHJfc3RzID0gTk9UX0RJR0VTVDsKICAgICAgICAgcmV0
dXJuICFPSzsKICAgICB9CkBAIC05NTcsMjUgKzk1NywyNSBAQCBzdGF0aWMgaW50IGdldF9kaWdl
c3RfcmVjKHJlcXVlc3RfcmVjICpyLCBkaWdlc3RfaAogICAgICAgICAgICAgYXV0aF9saW5lKys7
CiAgICAgICAgIH0KIAotICAgICAgICBpZiAoIXN0cmNhc2VjbXAoa2V5LCAidXNlcm5hbWUiKSkK
KyAgICAgICAgaWYgKCFhcF9jYXNlY21wc3RyKGtleSwgInVzZXJuYW1lIikpCiAgICAgICAgICAg
ICByZXNwLT51c2VybmFtZSA9IGFwcl9wc3RyZHVwKHItPnBvb2wsIHZhbHVlKTsKLSAgICAgICAg
ZWxzZSBpZiAoIXN0cmNhc2VjbXAoa2V5LCAicmVhbG0iKSkKKyAgICAgICAgZWxzZSBpZiAoIWFw
X2Nhc2VjbXBzdHIoa2V5LCAicmVhbG0iKSkKICAgICAgICAgICAgIHJlc3AtPnJlYWxtID0gYXBy
X3BzdHJkdXAoci0+cG9vbCwgdmFsdWUpOwotICAgICAgICBlbHNlIGlmICghc3RyY2FzZWNtcChr
ZXksICJub25jZSIpKQorICAgICAgICBlbHNlIGlmICghYXBfY2FzZWNtcHN0cihrZXksICJub25j
ZSIpKQogICAgICAgICAgICAgcmVzcC0+bm9uY2UgPSBhcHJfcHN0cmR1cChyLT5wb29sLCB2YWx1
ZSk7Ci0gICAgICAgIGVsc2UgaWYgKCFzdHJjYXNlY21wKGtleSwgInVyaSIpKQorICAgICAgICBl
bHNlIGlmICghYXBfY2FzZWNtcHN0cihrZXksICJ1cmkiKSkKICAgICAgICAgICAgIHJlc3AtPnVy
aSA9IGFwcl9wc3RyZHVwKHItPnBvb2wsIHZhbHVlKTsKLSAgICAgICAgZWxzZSBpZiAoIXN0cmNh
c2VjbXAoa2V5LCAicmVzcG9uc2UiKSkKKyAgICAgICAgZWxzZSBpZiAoIWFwX2Nhc2VjbXBzdHIo
a2V5LCAicmVzcG9uc2UiKSkKICAgICAgICAgICAgIHJlc3AtPmRpZ2VzdCA9IGFwcl9wc3RyZHVw
KHItPnBvb2wsIHZhbHVlKTsKLSAgICAgICAgZWxzZSBpZiAoIXN0cmNhc2VjbXAoa2V5LCAiYWxn
b3JpdGhtIikpCisgICAgICAgIGVsc2UgaWYgKCFhcF9jYXNlY21wc3RyKGtleSwgImFsZ29yaXRo
bSIpKQogICAgICAgICAgICAgcmVzcC0+YWxnb3JpdGhtID0gYXByX3BzdHJkdXAoci0+cG9vbCwg
dmFsdWUpOwotICAgICAgICBlbHNlIGlmICghc3RyY2FzZWNtcChrZXksICJjbm9uY2UiKSkKKyAg
ICAgICAgZWxzZSBpZiAoIWFwX2Nhc2VjbXBzdHIoa2V5LCAiY25vbmNlIikpCiAgICAgICAgICAg
ICByZXNwLT5jbm9uY2UgPSBhcHJfcHN0cmR1cChyLT5wb29sLCB2YWx1ZSk7Ci0gICAgICAgIGVs
c2UgaWYgKCFzdHJjYXNlY21wKGtleSwgIm9wYXF1ZSIpKQorICAgICAgICBlbHNlIGlmICghYXBf
Y2FzZWNtcHN0cihrZXksICJvcGFxdWUiKSkKICAgICAgICAgICAgIHJlc3AtPm9wYXF1ZSA9IGFw
cl9wc3RyZHVwKHItPnBvb2wsIHZhbHVlKTsKLSAgICAgICAgZWxzZSBpZiAoIXN0cmNhc2VjbXAo
a2V5LCAicW9wIikpCisgICAgICAgIGVsc2UgaWYgKCFhcF9jYXNlY21wc3RyKGtleSwgInFvcCIp
KQogICAgICAgICAgICAgcmVzcC0+bWVzc2FnZV9xb3AgPSBhcHJfcHN0cmR1cChyLT5wb29sLCB2
YWx1ZSk7Ci0gICAgICAgIGVsc2UgaWYgKCFzdHJjYXNlY21wKGtleSwgIm5jIikpCisgICAgICAg
IGVsc2UgaWYgKCFhcF9jYXNlY21wc3RyKGtleSwgIm5jIikpCiAgICAgICAgICAgICByZXNwLT5u
b25jZV9jb3VudCA9IGFwcl9wc3RyZHVwKHItPnBvb2wsIHZhbHVlKTsKICAgICB9CiAKQEAgLTEy
MzQsNyArMTIzNCw3IEBAIHN0YXRpYyB2b2lkIG5vdGVfZGlnZXN0X2F1dGhfZmFpbHVyZShyZXF1
ZXN0X3JlYyAqCiAgICAgaWYgKGFwcl9pc19lbXB0eV9hcnJheShjb25mLT5xb3BfbGlzdCkpIHsK
ICAgICAgICAgcW9wID0gIiwgcW9wPVwiYXV0aFwiIjsKICAgICB9Ci0gICAgZWxzZSBpZiAoIXN0
cmNhc2VjbXAoKihjb25zdCBjaGFyICoqKShjb25mLT5xb3BfbGlzdC0+ZWx0cyksICJub25lIikp
IHsKKyAgICBlbHNlIGlmICghYXBfY2FzZWNtcHN0cigqKGNvbnN0IGNoYXIgKiopKGNvbmYtPnFv
cF9saXN0LT5lbHRzKSwgIm5vbmUiKSkgewogICAgICAgICBxb3AgPSAiIjsKICAgICB9CiAgICAg
ZWxzZSB7CkBAIC0xMzMzLDcgKzEzMzMsNyBAQCBzdGF0aWMgaW50IGhvb2tfbm90ZV9kaWdlc3Rf
YXV0aF9mYWlsdXJlKHJlcXVlc3RfcgogICAgIGRpZ2VzdF9oZWFkZXJfcmVjICpyZXNwOwogICAg
IGRpZ2VzdF9jb25maWdfcmVjICpjb25mOwogCi0gICAgaWYgKHN0cmNhc2VjbXAoYXV0aF90eXBl
LCAiRGlnZXN0IikpCisgICAgaWYgKGFwX2Nhc2VjbXBzdHIoYXV0aF90eXBlLCAiRGlnZXN0Iikp
CiAgICAgICAgIHJldHVybiBERUNMSU5FRDsKIAogICAgIC8qIGdldCB0aGUgY2xpZW50IHJlc3Bv
bnNlIGFuZCBtYXJrICovCkBAIC0xNDQzLDcgKzE0NDMsNyBAQCBzdGF0aWMgaW50IGNoZWNrX25j
KGNvbnN0IHJlcXVlc3RfcmVjICpyLCBjb25zdCBkaQogICAgIH0KIAogICAgIGlmICghYXByX2lz
X2VtcHR5X2FycmF5KGNvbmYtPnFvcF9saXN0KSAmJgotICAgICAgICAhc3RyY2FzZWNtcCgqKGNv
bnN0IGNoYXIgKiopKGNvbmYtPnFvcF9saXN0LT5lbHRzKSwgIm5vbmUiKSkgeworICAgICAgICAh
YXBfY2FzZWNtcHN0cigqKGNvbnN0IGNoYXIgKiopKGNvbmYtPnFvcF9saXN0LT5lbHRzKSwgIm5v
bmUiKSkgewogICAgICAgICAvKiBxb3AgaXMgbm9uZSwgY2xpZW50IG11c3Qgbm90IHNlbmQgYSBu
b25jZSBjb3VudCAqLwogICAgICAgICBpZiAoc25jICE9IE5VTEwpIHsKICAgICAgICAgICAgIGFw
X2xvZ19yZXJyb3IoQVBMT0dfTUFSSywgQVBMT0dfRVJSLCAwLCByLCBBUExPR05PKDAxNzcyKQpA
QCAtMTY2MCw3ICsxNjYwLDcgQEAgc3RhdGljIGludCBhdXRoZW50aWNhdGVfZGlnZXN0X3VzZXIo
cmVxdWVzdF9yZWMgKnIKIAogICAgIC8qIGRvIHdlIHJlcXVpcmUgRGlnZXN0IGF1dGggZm9yIHRo
aXMgVVJJPyAqLwogCi0gICAgaWYgKCEodCA9IGFwX2F1dGhfdHlwZShyKSkgfHwgc3RyY2FzZWNt
cCh0LCAiRGlnZXN0IikpIHsKKyAgICBpZiAoISh0ID0gYXBfYXV0aF90eXBlKHIpKSB8fCBhcF9j
YXNlY21wc3RyKHQsICJEaWdlc3QiKSkgewogICAgICAgICByZXR1cm4gREVDTElORUQ7CiAgICAg
fQogCkBAIC0xODI4LDggKzE4MjgsOCBAQCBzdGF0aWMgaW50IGF1dGhlbnRpY2F0ZV9kaWdlc3Rf
dXNlcihyZXF1ZXN0X3JlYyAqcgogICAgIH0KIAogICAgIGlmIChyZXNwLT5hbGdvcml0aG0gIT0g
TlVMTAotICAgICAgICAmJiBzdHJjYXNlY21wKHJlc3AtPmFsZ29yaXRobSwgIk1ENSIpCi0gICAg
ICAgICYmIHN0cmNhc2VjbXAocmVzcC0+YWxnb3JpdGhtLCAiTUQ1LXNlc3MiKSkgeworICAgICAg
ICAmJiBhcF9jYXNlY21wc3RyKHJlc3AtPmFsZ29yaXRobSwgIk1ENSIpCisgICAgICAgICYmIGFw
X2Nhc2VjbXBzdHIocmVzcC0+YWxnb3JpdGhtLCAiTUQ1LXNlc3MiKSkgewogICAgICAgICBhcF9s
b2dfcmVycm9yKEFQTE9HX01BUkssIEFQTE9HX0VSUiwgMCwgciwgQVBMT0dOTygwMTc4OSkKICAg
ICAgICAgICAgICAgICAgICAgICAidW5rbm93biBhbGdvcml0aG0gYCVzJyByZWNlaXZlZDogJXMi
LAogICAgICAgICAgICAgICAgICAgICAgIHJlc3AtPmFsZ29yaXRobSwgci0+dXJpKTsKQEAgLTE4
ODAsNyArMTg4MCw3IEBAIHN0YXRpYyBpbnQgYXV0aGVudGljYXRlX2RpZ2VzdF91c2VyKHJlcXVl
c3RfcmVjICpyCiAgICAgICAgIGludCBtYXRjaCA9IDAsIGlkeDsKICAgICAgICAgY29uc3QgY2hh
ciAqKnRtcCA9IChjb25zdCBjaGFyICoqKShjb25mLT5xb3BfbGlzdC0+ZWx0cyk7CiAgICAgICAg
IGZvciAoaWR4ID0gMDsgaWR4IDwgY29uZi0+cW9wX2xpc3QtPm5lbHRzOyBpZHgrKykgewotICAg
ICAgICAgICAgaWYgKCFzdHJjYXNlY21wKCp0bXAsIHJlc3AtPm1lc3NhZ2VfcW9wKSkgeworICAg
ICAgICAgICAgaWYgKCFhcF9jYXNlY21wc3RyKCp0bXAsIHJlc3AtPm1lc3NhZ2VfcW9wKSkgewog
ICAgICAgICAgICAgICAgIG1hdGNoID0gMTsKICAgICAgICAgICAgICAgICBicmVhazsKICAgICAg
ICAgICAgIH0KQEAgLTE4ODksNyArMTg4OSw3IEBAIHN0YXRpYyBpbnQgYXV0aGVudGljYXRlX2Rp
Z2VzdF91c2VyKHJlcXVlc3RfcmVjICpyCiAKICAgICAgICAgaWYgKCFtYXRjaAogICAgICAgICAg
ICAgJiYgIShhcHJfaXNfZW1wdHlfYXJyYXkoY29uZi0+cW9wX2xpc3QpCi0gICAgICAgICAgICAg
ICAgICYmICFzdHJjYXNlY21wKHJlc3AtPm1lc3NhZ2VfcW9wLCAiYXV0aCIpKSkgeworICAgICAg
ICAgICAgICAgICAmJiAhYXBfY2FzZWNtcHN0cihyZXNwLT5tZXNzYWdlX3FvcCwgImF1dGgiKSkp
IHsKICAgICAgICAgICAgIGFwX2xvZ19yZXJyb3IoQVBMT0dfTUFSSywgQVBMT0dfRVJSLCAwLCBy
LCBBUExPR05PKDAxNzkzKQogICAgICAgICAgICAgICAgICAgICAgICAgICAiaW52YWxpZCBxb3Ag
YCVzJyByZWNlaXZlZDogJXMiLAogICAgICAgICAgICAgICAgICAgICAgICAgICByZXNwLT5tZXNz
YWdlX3FvcCwgci0+dXJpKTsKQEAgLTE5NzEsNyArMTk3MSw3IEBAIHN0YXRpYyBpbnQgYWRkX2F1
dGhfaW5mbyhyZXF1ZXN0X3JlYyAqcikKICAgICAvKiBkbyByZmMtMjA2OSBkaWdlc3QKICAgICAg
Ki8KICAgICBpZiAoIWFwcl9pc19lbXB0eV9hcnJheShjb25mLT5xb3BfbGlzdCkgJiYKLSAgICAg
ICAgIXN0cmNhc2VjbXAoKihjb25zdCBjaGFyICoqKShjb25mLT5xb3BfbGlzdC0+ZWx0cyksICJu
b25lIikKKyAgICAgICAgIWFwX2Nhc2VjbXBzdHIoKihjb25zdCBjaGFyICoqKShjb25mLT5xb3Bf
bGlzdC0+ZWx0cyksICJub25lIikKICAgICAgICAgJiYgcmVzcC0+bWVzc2FnZV9xb3AgPT0gTlVM
TCkgewogICAgICAgICAvKiB1c2Ugb25seSBSRkMtMjA2OSBmb3JtYXQgKi8KICAgICAgICAgYWkg
PSBuZXh0bm9uY2U7CkluZGV4OiBtb2R1bGVzL2FhYS9tb2RfYXV0aF9mb3JtLmMKPT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PQotLS0gbW9kdWxlcy9hYWEvbW9kX2F1dGhfZm9ybS5jCShyZXZpc2lvbiAxNzIyMTQzKQorKysg
bW9kdWxlcy9hYWEvbW9kX2F1dGhfZm9ybS5jCSh3b3JraW5nIGNvcHkpCkBAIC00MjAsNyArNDIw
LDcgQEAgc3RhdGljIHZvaWQgbm90ZV9jb29raWVfYXV0aF9mYWlsdXJlKHJlcXVlc3RfcmVjICoK
IHN0YXRpYyBpbnQgaG9va19ub3RlX2Nvb2tpZV9hdXRoX2ZhaWx1cmUocmVxdWVzdF9yZWMgKiBy
LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBjaGFyICph
dXRoX3R5cGUpCiB7Ci0gICAgaWYgKHN0cmNhc2VjbXAoYXV0aF90eXBlLCAiZm9ybSIpKQorICAg
IGlmIChhcF9jYXNlY21wc3RyKGF1dGhfdHlwZSwgImZvcm0iKSkKICAgICAgICAgcmV0dXJuIERF
Q0xJTkVEOwogCiAgICAgbm90ZV9jb29raWVfYXV0aF9mYWlsdXJlKHIpOwpAQCAtODkyLDcgKzg5
Miw3IEBAIHN0YXRpYyBpbnQgYXV0aGVudGljYXRlX2Zvcm1fYXV0aG4ocmVxdWVzdF9yZWMgKiBy
CiAKICAgICAvKiBBcmUgd2UgY29uZmlndXJlZCB0byBiZSBGb3JtIGF1dGg/ICovCiAgICAgY3Vy
cmVudF9hdXRoID0gYXBfYXV0aF90eXBlKHIpOwotICAgIGlmICghY3VycmVudF9hdXRoIHx8IHN0
cmNhc2VjbXAoY3VycmVudF9hdXRoLCAiZm9ybSIpKSB7CisgICAgaWYgKCFjdXJyZW50X2F1dGgg
fHwgYXBfY2FzZWNtcHN0cihjdXJyZW50X2F1dGgsICJmb3JtIikpIHsKICAgICAgICAgcmV0dXJu
IERFQ0xJTkVEOwogICAgIH0KIApJbmRleDogbW9kdWxlcy9hYWEvbW9kX2F1dGhuel9mY2dpLmMK
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PQotLS0gbW9kdWxlcy9hYWEvbW9kX2F1dGhuel9mY2dpLmMJKHJldmlzaW9uIDE3
MjIxNDMpCisrKyBtb2R1bGVzL2FhYS9tb2RfYXV0aG56X2ZjZ2kuYwkod29ya2luZyBjb3B5KQpA
QCAtNjgxLDcgKzY4MSw3IEBAIHN0YXRpYyBpbnQgbW9kX2ZjZ2lkX21vZGlmeV9hdXRoX2hlYWRl
cih2b2lkICp2YXJzCiAgICAgLyogV2hlbiB0aGUgYXBwbGljYXRpb24gZ2l2ZXMgYSAyMDAgcmVz
cG9uc2UsIHRoZSBzZXJ2ZXIgaWdub3JlcyByZXNwb25zZQogICAgICAgIGhlYWRlcnMgd2hvc2Ug
bmFtZXMgYXJlbid0IHByZWZpeGVkIHdpdGggVmFyaWFibGUtIHByZWZpeCwgYW5kIGlnbm9yZXMK
ICAgICAgICBhbnkgcmVzcG9uc2UgY29udGVudCAqLwotICAgIGlmIChzdHJuY2FzZWNtcChrZXks
ICJWYXJpYWJsZS0iLCA5KSA9PSAwKQorICAgIGlmIChhcF9jYXNlY21wc3RybihrZXksICJWYXJp
YWJsZS0iLCA5KSA9PSAwKQogICAgICAgICBhcHJfdGFibGVfc2V0bih2YXJzLCBrZXksIHZhbCk7
CiAgICAgcmV0dXJuIDE7CiB9CkBAIC04MDksNyArODA5LDcgQEAgc3RhdGljIGludCBmY2dpX2No
ZWNrX2F1dGhuKHJlcXVlc3RfcmVjICpyKQogCiAgICAgcHJvdiA9IGRjb25mICYmIGRjb25mLT5u
YW1lID8gZGNvbmYtPm5hbWUgOiBOVUxMOwogCi0gICAgaWYgKCFwcm92IHx8ICFzdHJjYXNlY21w
KHByb3YsICJOb25lIikpIHsKKyAgICBpZiAoIXByb3YgfHwgIWFwX2Nhc2VjbXBzdHIocHJvdiwg
Ik5vbmUiKSkgewogICAgICAgICByZXR1cm4gREVDTElORUQ7CiAgICAgfQogCkBAIC04MjQsNyAr
ODI0LDcgQEAgc3RhdGljIGludCBmY2dpX2NoZWNrX2F1dGhuKHJlcXVlc3RfcmVjICpyKQogICAg
ICAgICAgICAgICAgICAgZGNvbmYtPnVzZXJfZXhwciA/ICJ5ZXMiIDogIm5vIiwKICAgICAgICAg
ICAgICAgICAgIGF1dGhfdHlwZSk7CiAKLSAgICBpZiAoYXV0aF90eXBlICYmICFzdHJjYXNlY21w
KGF1dGhfdHlwZSwgIkJhc2ljIikpIHsKKyAgICBpZiAoYXV0aF90eXBlICYmICFhcF9jYXNlY21w
c3RyKGF1dGhfdHlwZSwgIkJhc2ljIikpIHsKICAgICAgICAgaWYgKChyZXMgPSBhcF9nZXRfYmFz
aWNfYXV0aF9wdyhyLCAmcGFzc3dvcmQpKSkgewogICAgICAgICAgICAgYXBfbG9nX3JlcnJvcihB
UExPR19NQVJLLCBBUExPR19ERUJVRywgMCwgciwKICAgICAgICAgICAgICAgICAgICAgICAgICAg
QVBMT0dOTygwMjUxNykgIiVzOiBjb3VsZG4ndCByZXRyaWV2ZSBiYXNpYyBhdXRoICIKSW5kZXg6
IG1vZHVsZXMvY2FjaGUvY2FjaGVfc3RvcmFnZS5jCj09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KLS0tIG1vZHVsZXMvY2Fj
aGUvY2FjaGVfc3RvcmFnZS5jCShyZXZpc2lvbiAxNzIyMTQzKQorKysgbW9kdWxlcy9jYWNoZS9j
YWNoZV9zdG9yYWdlLmMJKHdvcmtpbmcgY29weSkKQEAgLTExNSw3ICsxMTUsNyBAQCBpbnQgY2Fj
aGVfY3JlYXRlX2VudGl0eShjYWNoZV9yZXF1ZXN0X3JlYyAqY2FjaGUsCiAKIHN0YXRpYyBpbnQg
ZmlsdGVyX2hlYWRlcl9kbyh2b2lkICp2LCBjb25zdCBjaGFyICprZXksIGNvbnN0IGNoYXIgKnZh
bCkKIHsKLSAgICBpZiAoKCprZXkgPT0gJ1cnIHx8ICprZXkgPT0gJ3cnKSAmJiAhc3RyY2FzZWNt
cChrZXksICJXYXJuaW5nIikKKyAgICBpZiAoKCprZXkgPT0gJ1cnIHx8ICprZXkgPT0gJ3cnKSAm
JiAhYXBfY2FzZWNtcHN0cihrZXksICJXYXJuaW5nIikKICAgICAgICAgICAgICYmICp2YWwgPT0g
JzEnKSB7CiAgICAgICAgIC8qIGFueSBzdG9yZWQgV2FybmluZyBoZWFkZXJzIHdpdGggd2Fybi1j
b2RlIDF4eCAoc2VlIHNlY3Rpb24KICAgICAgICAgICogMTQuNDYpIE1VU1QgYmUgZGVsZXRlZCBm
cm9tIHRoZSBjYWNoZSBlbnRyeSBhbmQgdGhlIGZvcndhcmRlZApAQCAtMTI5LDcgKzEyOSw3IEBA
IHN0YXRpYyBpbnQgZmlsdGVyX2hlYWRlcl9kbyh2b2lkICp2LCBjb25zdCBjaGFyICprCiB9CiBz
dGF0aWMgaW50IHJlbW92ZV9oZWFkZXJfZG8odm9pZCAqdiwgY29uc3QgY2hhciAqa2V5LCBjb25z
dCBjaGFyICp2YWwpCiB7Ci0gICAgaWYgKCgqa2V5ID09ICdXJyB8fCAqa2V5ID09ICd3JykgJiYg
IXN0cmNhc2VjbXAoa2V5LCAiV2FybmluZyIpKSB7CisgICAgaWYgKCgqa2V5ID09ICdXJyB8fCAq
a2V5ID09ICd3JykgJiYgIWFwX2Nhc2VjbXBzdHIoa2V5LCAiV2FybmluZyIpKSB7CiAgICAgICAg
IC8qIGFueSBzdG9yZWQgV2FybmluZyBoZWFkZXJzIHdpdGggd2Fybi1jb2RlIDJ4eCBNVVNUIGJl
IHJldGFpbmVkCiAgICAgICAgICAqIGluIHRoZSBjYWNoZSBlbnRyeSBhbmQgdGhlIGZvcndhcmRl
ZCByZXNwb25zZS4KICAgICAgICAgICovCkluZGV4OiBtb2R1bGVzL2NhY2hlL2NhY2hlX3V0aWwu
Ywo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09Ci0tLSBtb2R1bGVzL2NhY2hlL2NhY2hlX3V0aWwuYwkocmV2aXNpb24gMTcy
MjE0MykKKysrIG1vZHVsZXMvY2FjaGUvY2FjaGVfdXRpbC5jCSh3b3JraW5nIGNvcHkpCkBAIC01
NSw3ICs1NSw3IEBAIHN0YXRpYyBpbnQgdXJpX21lZXRzX2NvbmRpdGlvbnMoY29uc3QgYXByX3Vy
aV90ICpmCiAgICAgfQogICAgIGVsc2UgewogICAgICAgICAvKiBUaGUgVVJJIHNjaGVtZSBtdXN0
IGJlIHByZXNlbnQgYW5kIGlkZW50aWNhbCBleGNlcHQgZm9yIGNhc2UuICovCi0gICAgICAgIGlm
ICghdXJsLT5zY2hlbWUgfHwgc3RyY2FzZWNtcChmaWx0ZXItPnNjaGVtZSwgdXJsLT5zY2hlbWUp
KSB7CisgICAgICAgIGlmICghdXJsLT5zY2hlbWUgfHwgYXBfY2FzZWNtcHN0cihmaWx0ZXItPnNj
aGVtZSwgdXJsLT5zY2hlbWUpKSB7CiAgICAgICAgICAgICByZXR1cm4gMDsKICAgICAgICAgfQog
CkBAIC05NzYsMTQgKzk3Niw5IEBAIGludCBhcF9jYWNoZV9jb250cm9sKHJlcXVlc3RfcmVjICpy
LCBjYWNoZV9jb250cm9sCiAgICAgICAgIGNoYXIgKmhlYWRlciA9IGFwcl9wc3RyZHVwKHItPnBv
b2wsIHByYWdtYV9oZWFkZXIpOwogICAgICAgICBjb25zdCBjaGFyICp0b2tlbiA9IGNhY2hlX3N0
cnF0b2soaGVhZGVyLCBDQUNIRV9TRVBBUkFUT1IsICZsYXN0KTsKICAgICAgICAgd2hpbGUgKHRv
a2VuKSB7Ci0gICAgICAgICAgICAvKiBoYW5kbGUgbW9zdCBjb21tb24gcXVpY2tlc3QgY2FzZS4u
LiAqLwotICAgICAgICAgICAgaWYgKCFzdHJjbXAodG9rZW4sICJuby1jYWNoZSIpKSB7CisgICAg
ICAgICAgICBpZiAoIWFwX2Nhc2VjbXBzdHIodG9rZW4sICJuby1jYWNoZSIpKSB7CiAgICAgICAg
ICAgICAgICAgY2MtPm5vX2NhY2hlID0gMTsKICAgICAgICAgICAgIH0KLSAgICAgICAgICAgIC8q
IC4uLnRoZW4gdHJ5IHNsb3dlc3QgY2FzZSAqLwotICAgICAgICAgICAgZWxzZSBpZiAoIXN0cmNh
c2VjbXAodG9rZW4sICJuby1jYWNoZSIpKSB7Ci0gICAgICAgICAgICAgICAgY2MtPm5vX2NhY2hl
ID0gMTsKLSAgICAgICAgICAgIH0KICAgICAgICAgICAgIHRva2VuID0gY2FjaGVfc3RycXRvayhO
VUxMLCBDQUNIRV9TRVBBUkFUT1IsICZsYXN0KTsKICAgICAgICAgfQogICAgICAgICBjYy0+cHJh
Z21hID0gMTsKQEAgLTk5NiwxNSArOTkxLDcgQEAgaW50IGFwX2NhY2hlX2NvbnRyb2wocmVxdWVz
dF9yZWMgKnIsIGNhY2hlX2NvbnRyb2wKICAgICAgICAgICAgIHN3aXRjaCAodG9rZW5bMF0pIHsK
ICAgICAgICAgICAgIGNhc2UgJ24nOgogICAgICAgICAgICAgY2FzZSAnTic6IHsKLSAgICAgICAg
ICAgICAgICAvKiBoYW5kbGUgbW9zdCBjb21tb24gcXVpY2tlc3QgY2FzZXMuLi4gKi8KLSAgICAg
ICAgICAgICAgICBpZiAoIXN0cmNtcCh0b2tlbiwgIm5vLWNhY2hlIikpIHsKLSAgICAgICAgICAg
ICAgICAgICAgY2MtPm5vX2NhY2hlID0gMTsKLSAgICAgICAgICAgICAgICB9Ci0gICAgICAgICAg
ICAgICAgZWxzZSBpZiAoIXN0cmNtcCh0b2tlbiwgIm5vLXN0b3JlIikpIHsKLSAgICAgICAgICAg
ICAgICAgICAgY2MtPm5vX3N0b3JlID0gMTsKLSAgICAgICAgICAgICAgICB9Ci0gICAgICAgICAg
ICAgICAgLyogLi4udGhlbiB0cnkgc2xvd2VzdCBjYXNlcyAqLwotICAgICAgICAgICAgICAgIGVs
c2UgaWYgKCFzdHJuY2FzZWNtcCh0b2tlbiwgIm5vLWNhY2hlIiwgOCkpIHsKKyAgICAgICAgICAg
ICAgICBpZiAoIWFwX2Nhc2VjbXBzdHJuKHRva2VuLCAibm8tY2FjaGUiLCA4KSkgewogICAgICAg
ICAgICAgICAgICAgICBpZiAodG9rZW5bOF0gPT0gJz0nKSB7CiAgICAgICAgICAgICAgICAgICAg
ICAgICBjYy0+bm9fY2FjaGVfaGVhZGVyID0gMTsKICAgICAgICAgICAgICAgICAgICAgfQpAQCAt
MTAxMSwxMiArOTk4LDExIEBAIGludCBhcF9jYWNoZV9jb250cm9sKHJlcXVlc3RfcmVjICpyLCBj
YWNoZV9jb250cm9sCiAgICAgICAgICAgICAgICAgICAgIGVsc2UgaWYgKCF0b2tlbls4XSkgewog
ICAgICAgICAgICAgICAgICAgICAgICAgY2MtPm5vX2NhY2hlID0gMTsKICAgICAgICAgICAgICAg
ICAgICAgfQotICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICB9Ci0g
ICAgICAgICAgICAgICAgZWxzZSBpZiAoIXN0cmNhc2VjbXAodG9rZW4sICJuby1zdG9yZSIpKSB7
CisgICAgICAgICAgICAgICAgZWxzZSBpZiAoIWFwX2Nhc2VjbXBzdHIodG9rZW4sICJuby1zdG9y
ZSIpKSB7CiAgICAgICAgICAgICAgICAgICAgIGNjLT5ub19zdG9yZSA9IDE7CiAgICAgICAgICAg
ICAgICAgfQotICAgICAgICAgICAgICAgIGVsc2UgaWYgKCFzdHJjYXNlY21wKHRva2VuLCAibm8t
dHJhbnNmb3JtIikpIHsKKyAgICAgICAgICAgICAgICBlbHNlIGlmICghYXBfY2FzZWNtcHN0cih0
b2tlbiwgIm5vLXRyYW5zZm9ybSIpKSB7CiAgICAgICAgICAgICAgICAgICAgIGNjLT5ub190cmFu
c2Zvcm0gPSAxOwogICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICBicmVhazsKQEAg
LTEwMjMsMjMgKzEwMDksMTYgQEAgaW50IGFwX2NhY2hlX2NvbnRyb2wocmVxdWVzdF9yZWMgKnIs
IGNhY2hlX2NvbnRyb2wKICAgICAgICAgICAgIH0KICAgICAgICAgICAgIGNhc2UgJ20nOgogICAg
ICAgICAgICAgY2FzZSAnTSc6IHsKLSAgICAgICAgICAgICAgICAvKiBoYW5kbGUgbW9zdCBjb21t
b24gcXVpY2tlc3QgY2FzZXMuLi4gKi8KLSAgICAgICAgICAgICAgICBpZiAoIXN0cmNtcCh0b2tl
biwgIm1heC1hZ2U9MCIpKSB7Ci0gICAgICAgICAgICAgICAgICAgIGNjLT5tYXhfYWdlID0gMTsK
LSAgICAgICAgICAgICAgICAgICAgY2MtPm1heF9hZ2VfdmFsdWUgPSAwOwotICAgICAgICAgICAg
ICAgIH0KLSAgICAgICAgICAgICAgICBlbHNlIGlmICghc3RyY21wKHRva2VuLCAibXVzdC1yZXZh
bGlkYXRlIikpIHsKLSAgICAgICAgICAgICAgICAgICAgY2MtPm11c3RfcmV2YWxpZGF0ZSA9IDE7
Ci0gICAgICAgICAgICAgICAgfQotICAgICAgICAgICAgICAgIC8qIC4uLnRoZW4gdHJ5IHNsb3dl
c3QgY2FzZXMgKi8KLSAgICAgICAgICAgICAgICBlbHNlIGlmICghc3RybmNhc2VjbXAodG9rZW4s
ICJtYXgtYWdlIiwgNykpIHsKKyAgICAgICAgICAgICAgICBpZiAoIWFwX2Nhc2VjbXBzdHJuKHRv
a2VuLCAibWF4LWFnZSIsIDcpKSB7CiAgICAgICAgICAgICAgICAgICAgIGlmICh0b2tlbls3XSA9
PSAnPScpIHsKICAgICAgICAgICAgICAgICAgICAgICAgIGNjLT5tYXhfYWdlID0gMTsKICAgICAg
ICAgICAgICAgICAgICAgICAgIGNjLT5tYXhfYWdlX3ZhbHVlID0gYXByX2F0b2k2NCh0b2tlbiAr
IDgpOwogICAgICAgICAgICAgICAgICAgICB9Ci0gICAgICAgICAgICAgICAgICAgIGJyZWFrOwog
ICAgICAgICAgICAgICAgIH0KLSAgICAgICAgICAgICAgICBlbHNlIGlmICghc3RybmNhc2VjbXAo
dG9rZW4sICJtYXgtc3RhbGUiLCA5KSkgeworICAgICAgICAgICAgICAgIGVsc2UgaWYgKCFhcF9j
YXNlY21wc3RyKHRva2VuLCAibXVzdC1yZXZhbGlkYXRlIikpIHsKKyAgICAgICAgICAgICAgICAg
ICAgY2MtPm11c3RfcmV2YWxpZGF0ZSA9IDE7CisgICAgICAgICAgICAgICAgfQorICAgICAgICAg
ICAgICAgIGVsc2UgaWYgKCFhcF9jYXNlY21wc3Rybih0b2tlbiwgIm1heC1zdGFsZSIsIDkpKSB7
CiAgICAgICAgICAgICAgICAgICAgIGlmICh0b2tlbls5XSA9PSAnPScpIHsKICAgICAgICAgICAg
ICAgICAgICAgICAgIGNjLT5tYXhfc3RhbGUgPSAxOwogICAgICAgICAgICAgICAgICAgICAgICAg
Y2MtPm1heF9zdGFsZV92YWx1ZSA9IGFwcl9hdG9pNjQodG9rZW4gKyAxMCk7CkBAIC0xMDQ4LDIz
ICsxMDI3LDE4IEBAIGludCBhcF9jYWNoZV9jb250cm9sKHJlcXVlc3RfcmVjICpyLCBjYWNoZV9j
b250cm9sCiAgICAgICAgICAgICAgICAgICAgICAgICBjYy0+bWF4X3N0YWxlID0gMTsKICAgICAg
ICAgICAgICAgICAgICAgICAgIGNjLT5tYXhfc3RhbGVfdmFsdWUgPSAtMTsKICAgICAgICAgICAg
ICAgICAgICAgfQotICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICB9
Ci0gICAgICAgICAgICAgICAgZWxzZSBpZiAoIXN0cm5jYXNlY21wKHRva2VuLCAibWluLWZyZXNo
IiwgOSkpIHsKKyAgICAgICAgICAgICAgICBlbHNlIGlmICghYXBfY2FzZWNtcHN0cm4odG9rZW4s
ICJtaW4tZnJlc2giLCA5KSkgewogICAgICAgICAgICAgICAgICAgICBpZiAodG9rZW5bOV0gPT0g
Jz0nKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICBjYy0+bWluX2ZyZXNoID0gMTsKICAgICAg
ICAgICAgICAgICAgICAgICAgIGNjLT5taW5fZnJlc2hfdmFsdWUgPSBhcHJfYXRvaTY0KHRva2Vu
ICsgMTApOwogICAgICAgICAgICAgICAgICAgICB9Ci0gICAgICAgICAgICAgICAgICAgIGJyZWFr
OwogICAgICAgICAgICAgICAgIH0KLSAgICAgICAgICAgICAgICBlbHNlIGlmICghc3RyY2FzZWNt
cCh0b2tlbiwgIm11c3QtcmV2YWxpZGF0ZSIpKSB7Ci0gICAgICAgICAgICAgICAgICAgIGNjLT5t
dXN0X3JldmFsaWRhdGUgPSAxOwotICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICBi
cmVhazsKICAgICAgICAgICAgIH0KICAgICAgICAgICAgIGNhc2UgJ28nOgogICAgICAgICAgICAg
Y2FzZSAnTyc6IHsKLSAgICAgICAgICAgICAgICBpZiAoIXN0cmNhc2VjbXAodG9rZW4sICJvbmx5
LWlmLWNhY2hlZCIpKSB7CisgICAgICAgICAgICAgICAgaWYgKCFhcF9jYXNlY21wc3RyKHRva2Vu
LCAib25seS1pZi1jYWNoZWQiKSkgewogICAgICAgICAgICAgICAgICAgICBjYy0+b25seV9pZl9j
YWNoZWQgPSAxOwogICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICBicmVhazsKQEAg
LTEwNzEsMTUgKzEwNDUsMTAgQEAgaW50IGFwX2NhY2hlX2NvbnRyb2wocmVxdWVzdF9yZWMgKnIs
IGNhY2hlX2NvbnRyb2wKICAgICAgICAgICAgIH0KICAgICAgICAgICAgIGNhc2UgJ3AnOgogICAg
ICAgICAgICAgY2FzZSAnUCc6IHsKLSAgICAgICAgICAgICAgICAvKiBoYW5kbGUgbW9zdCBjb21t
b24gcXVpY2tlc3QgY2FzZXMuLi4gKi8KLSAgICAgICAgICAgICAgICBpZiAoIXN0cmNtcCh0b2tl
biwgInByaXZhdGUiKSkgewotICAgICAgICAgICAgICAgICAgICBjYy0+cHJpdmF0ZSA9IDE7Ci0g
ICAgICAgICAgICAgICAgfQotICAgICAgICAgICAgICAgIC8qIC4uLnRoZW4gdHJ5IHNsb3dlc3Qg
Y2FzZXMgKi8KLSAgICAgICAgICAgICAgICBlbHNlIGlmICghc3RyY2FzZWNtcCh0b2tlbiwgInB1
YmxpYyIpKSB7CisgICAgICAgICAgICAgICAgaWYgKCFhcF9jYXNlY21wc3RyKHRva2VuLCAicHVi
bGljIikpIHsKICAgICAgICAgICAgICAgICAgICAgY2MtPnB1YmxpYyA9IDE7CiAgICAgICAgICAg
ICAgICAgfQotICAgICAgICAgICAgICAgIGVsc2UgaWYgKCFzdHJuY2FzZWNtcCh0b2tlbiwgInBy
aXZhdGUiLCA3KSkgeworICAgICAgICAgICAgICAgIGVsc2UgaWYgKCFhcF9jYXNlY21wc3Rybih0
b2tlbiwgInByaXZhdGUiLCA3KSkgewogICAgICAgICAgICAgICAgICAgICBpZiAodG9rZW5bN10g
PT0gJz0nKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICBjYy0+cHJpdmF0ZV9oZWFkZXIgPSAx
OwogICAgICAgICAgICAgICAgICAgICB9CkBAIC0xMDg2LDkgKzEwNTUsOCBAQCBpbnQgYXBfY2Fj
aGVfY29udHJvbChyZXF1ZXN0X3JlYyAqciwgY2FjaGVfY29udHJvbAogICAgICAgICAgICAgICAg
ICAgICBlbHNlIGlmICghdG9rZW5bN10pIHsKICAgICAgICAgICAgICAgICAgICAgICAgIGNjLT5w
cml2YXRlID0gMTsKICAgICAgICAgICAgICAgICAgICAgfQotICAgICAgICAgICAgICAgICAgICBi
cmVhazsKICAgICAgICAgICAgICAgICB9Ci0gICAgICAgICAgICAgICAgZWxzZSBpZiAoIXN0cmNh
c2VjbXAodG9rZW4sICJwcm94eS1yZXZhbGlkYXRlIikpIHsKKyAgICAgICAgICAgICAgICBlbHNl
IGlmICghYXBfY2FzZWNtcHN0cih0b2tlbiwgInByb3h5LXJldmFsaWRhdGUiKSkgewogICAgICAg
ICAgICAgICAgICAgICBjYy0+cHJveHlfcmV2YWxpZGF0ZSA9IDE7CiAgICAgICAgICAgICAgICAg
fQogICAgICAgICAgICAgICAgIGJyZWFrOwpAQCAtMTA5NSwxMiArMTA2MywxMSBAQCBpbnQgYXBf
Y2FjaGVfY29udHJvbChyZXF1ZXN0X3JlYyAqciwgY2FjaGVfY29udHJvbAogICAgICAgICAgICAg
fQogICAgICAgICAgICAgY2FzZSAncyc6CiAgICAgICAgICAgICBjYXNlICdTJzogewotICAgICAg
ICAgICAgICAgIGlmICghc3RybmNhc2VjbXAodG9rZW4sICJzLW1heGFnZSIsIDgpKSB7CisgICAg
ICAgICAgICAgICAgaWYgKCFhcF9jYXNlY21wc3Rybih0b2tlbiwgInMtbWF4YWdlIiwgOCkpIHsK
ICAgICAgICAgICAgICAgICAgICAgaWYgKHRva2VuWzhdID09ICc9JykgewogICAgICAgICAgICAg
ICAgICAgICAgICAgY2MtPnNfbWF4YWdlID0gMTsKICAgICAgICAgICAgICAgICAgICAgICAgIGNj
LT5zX21heGFnZV92YWx1ZSA9IGFwcl9hdG9pNjQodG9rZW4gKyA5KTsKICAgICAgICAgICAgICAg
ICAgICAgfQotICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICB9CiAg
ICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICB9CkBAIC0xMTMwLDggKzEwOTcsNyBA
QCBzdGF0aWMgaW50IGNhY2hlX2NvbnRyb2xfcmVtb3ZlKHJlcXVlc3RfcmVjICpyLCBjbwogICAg
ICAgICAgICAgc3dpdGNoICh0b2tlblswXSkgewogICAgICAgICAgICAgY2FzZSAnbic6CiAgICAg
ICAgICAgICBjYXNlICdOJzogewotICAgICAgICAgICAgICAgIGlmICghc3RybmNtcCh0b2tlbiwg
Im5vLWNhY2hlIiwgOCkKLSAgICAgICAgICAgICAgICAgICAgICAgIHx8ICFzdHJuY2FzZWNtcCh0
b2tlbiwgIm5vLWNhY2hlIiwgOCkpIHsKKyAgICAgICAgICAgICAgICBpZiAoIWFwX2Nhc2VjbXBz
dHJuKHRva2VuLCAibm8tY2FjaGUiLCA4KSkgewogICAgICAgICAgICAgICAgICAgICBpZiAodG9r
ZW5bOF0gPT0gJz0nKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBjaGFyICpoZWFk
ZXIgPSBjYWNoZV9zdHJxdG9rKHRva2VuICsgOSwKICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgQ0FDSEVfU0VQQVJBVE9SICJcIiIsICZzbGFzdCk7CkBAIC0xMTQ4LDggKzExMTQsNyBA
QCBzdGF0aWMgaW50IGNhY2hlX2NvbnRyb2xfcmVtb3ZlKHJlcXVlc3RfcmVjICpyLCBjbwogICAg
ICAgICAgICAgfQogICAgICAgICAgICAgY2FzZSAncCc6CiAgICAgICAgICAgICBjYXNlICdQJzog
ewotICAgICAgICAgICAgICAgIGlmICghc3RybmNtcCh0b2tlbiwgInByaXZhdGUiLCA3KQotICAg
ICAgICAgICAgICAgICAgICAgICAgfHwgIXN0cm5jYXNlY21wKHRva2VuLCAicHJpdmF0ZSIsIDcp
KSB7CisgICAgICAgICAgICAgICAgaWYgKCFhcF9jYXNlY21wc3Rybih0b2tlbiwgInByaXZhdGUi
LCA3KSkgewogICAgICAgICAgICAgICAgICAgICBpZiAodG9rZW5bN10gPT0gJz0nKSB7CiAgICAg
ICAgICAgICAgICAgICAgICAgICBjb25zdCBjaGFyICpoZWFkZXIgPSBjYWNoZV9zdHJxdG9rKHRv
a2VuICsgOCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgQ0FDSEVfU0VQQVJBVE9S
ICJcIiIsICZzbGFzdCk7CkluZGV4OiBtb2R1bGVzL2Rhdi9tYWluL21vZF9kYXYuYwo9PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09Ci0tLSBtb2R1bGVzL2Rhdi9tYWluL21vZF9kYXYuYwkocmV2aXNpb24gMTcyMjE0MykKKysr
IG1vZHVsZXMvZGF2L21haW4vbW9kX2Rhdi5jCSh3b3JraW5nIGNvcHkpCkBAIC02NTEsNyArNjUx
LDcgQEAgREFWX0RFQ0xBUkUoaW50KSBkYXZfZ2V0X2RlcHRoKHJlcXVlc3RfcmVjICpyLCBpbnQK
ICAgICAgICAgcmV0dXJuIGRlZl9kZXB0aDsKICAgICB9CiAKLSAgICBpZiAoc3RyY2FzZWNtcChk
ZXB0aCwgImluZmluaXR5IikgPT0gMCkgeworICAgIGlmIChhcF9jYXNlY21wc3RyKGRlcHRoLCAi
aW5maW5pdHkiKSA9PSAwKSB7CiAgICAgICAgIHJldHVybiBEQVZfSU5GSU5JVFk7CiAgICAgfQog
ICAgIGVsc2UgaWYgKHN0cmNtcChkZXB0aCwgIjAiKSA9PSAwKSB7CkBAIC03ODEsNyArNzgxLDcg
QEAgc3RhdGljIGludCBkYXZfcGFyc2VfcmFuZ2UocmVxdWVzdF9yZWMgKnIsCiAgICAgICAgIHJl
dHVybiAwOwogCiAgICAgcmFuZ2UgPSBhcHJfcHN0cmR1cChyLT5wb29sLCByYW5nZV9jKTsKLSAg
ICBpZiAoc3RybmNhc2VjbXAocmFuZ2UsICJieXRlcyAiLCA2KSAhPSAwCisgICAgaWYgKGFwX2Nh
c2VjbXBzdHJuKHJhbmdlLCAiYnl0ZXMgIiwgNikgIT0gMAogICAgICAgICB8fCAoZGFzaCA9IGFw
X3N0cmNocihyYW5nZSwgJy0nKSkgPT0gTlVMTAogICAgICAgICB8fCAoc2xhc2ggPSBhcF9zdHJj
aHIocmFuZ2UsICcvJykpID09IE5VTEwpIHsKICAgICAgICAgLyogbWFsZm9ybWVkIGhlYWRlciAq
LwpAQCAtMjQ1MSw3ICsyNDUxLDcgQEAgc3RhdGljIGludCBwcm9jZXNzX21rY29sX2JvZHkocmVx
dWVzdF9yZWMgKnIpCiAgICAgci0+cmVtYWluaW5nID0gMDsKIAogICAgIGlmICh0ZW5jKSB7Ci0g
ICAgICAgIGlmIChzdHJjYXNlY21wKHRlbmMsICJjaHVua2VkIikpIHsKKyAgICAgICAgaWYgKGFw
X2Nhc2VjbXBzdHIodGVuYywgImNodW5rZWQiKSkgewogICAgICAgICAgICAgLyogVXNlIHRoaXMg
aW5zdGVhZCBvZiBBcGFjaGUncyBkZWZhdWx0IGVycm9yIHN0cmluZyAqLwogICAgICAgICAgICAg
YXBfbG9nX3JlcnJvcihBUExPR19NQVJLLCBBUExPR19FUlIsIDAsIHIsIEFQTE9HTk8oMDA1ODkp
CiAgICAgICAgICAgICAgICAgICAgICAgICAgICJVbmtub3duIFRyYW5zZmVyLUVuY29kaW5nICVz
IiwgdGVuYyk7CkluZGV4OiBtb2R1bGVzL2Rhdi9tYWluL3V0aWwuYwo9PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09Ci0tLSBt
b2R1bGVzL2Rhdi9tYWluL3V0aWwuYwkocmV2aXNpb24gMTcyMjE0MykKKysrIG1vZHVsZXMvZGF2
L21haW4vdXRpbC5jCSh3b3JraW5nIGNvcHkpCkBAIC0yNDAsNyArMjQwLDcgQEAgREFWX0RFQ0xB
UkUoZGF2X2xvb2t1cF9yZXN1bHQpIGRhdl9sb29rdXBfdXJpKGNvbnMKICAgICAgICAgICAgcmVx
dWVzdC4gdGhlIHBvcnQgbXVzdCBtYXRjaCBvdXIgcG9ydC4KICAgICAgICAgKi8KICAgICAgICAg
cG9ydCA9IHItPmNvbm5lY3Rpb24tPmxvY2FsX2FkZHItPnBvcnQ7Ci0gICAgICAgIGlmIChzdHJj
YXNlY21wKGNvbXAuc2NoZW1lLCBzY2hlbWUpICE9IDAKKyAgICAgICAgaWYgKGFwX2Nhc2VjbXBz
dHIoY29tcC5zY2hlbWUsIHNjaGVtZSkgIT0gMAogI2lmZGVmIEFQQUNIRV9QT1JUX0hBTkRMSU5H
X0lTX0JVU1RFRAogICAgICAgICAgICAgfHwgY29tcC5wb3J0ICE9IHBvcnQKICNlbmRpZgpJbmRl
eDogbW9kdWxlcy9maWx0ZXJzL21vZF9jaGFyc2V0X2xpdGUuYwo9PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09Ci0tLSBtb2R1
bGVzL2ZpbHRlcnMvbW9kX2NoYXJzZXRfbGl0ZS5jCShyZXZpc2lvbiAxNzIyMTQzKQorKysgbW9k
dWxlcy9maWx0ZXJzL21vZF9jaGFyc2V0X2xpdGUuYwkod29ya2luZyBjb3B5KQpAQCAtNzkwLDcg
Kzc5MCw3IEBAIHN0YXRpYyBhcHJfc3RhdHVzX3QgeGxhdGVfb3V0X2ZpbHRlcihhcF9maWx0ZXJf
dCAqCiAgICAgaWYgKCFjdHgtPm5vb3AgJiYgY3R4LT54bGF0ZSA9PSBOVUxMKSB7CiAgICAgICAg
IGNvbnN0IGNoYXIgKm1pbWVfdHlwZSA9IGYtPnItPmNvbnRlbnRfdHlwZTsKIAotICAgICAgICBp
ZiAobWltZV90eXBlICYmIChzdHJuY2FzZWNtcChtaW1lX3R5cGUsICJ0ZXh0LyIsIDUpID09IDAg
fHwKKyAgICAgICAgaWYgKG1pbWVfdHlwZSAmJiAoYXBfY2FzZWNtcHN0cm4obWltZV90eXBlLCAi
dGV4dC8iLCA1KSA9PSAwIHx8CiAjaWYgQVBSX0NIQVJTRVRfRUJDRElDCiAgICAgICAgIC8qIE9u
IGFuIEVCQ0RJQyBtYWNoaW5lLCBiZSB3aWxsaW5nIHRvIHRyYW5zbGF0ZSBtb2RfYXV0b2luZGV4
LQogICAgICAgICAgKiBnZW5lcmF0ZWQgb3V0cHV0LiAgT3RoZXJ3aXNlLCBpdCBkb2Vzbid0IGxv
b2sgdG9vIGNvb2wuCkBAIC04MDYsNyArODA2LDcgQEAgc3RhdGljIGFwcl9zdGF0dXNfdCB4bGF0
ZV9vdXRfZmlsdGVyKGFwX2ZpbHRlcl90ICoKICAgICAgICAgICovCiAgICAgICAgICAgICBzdHJj
bXAobWltZV90eXBlLCBESVJfTUFHSUNfVFlQRSkgPT0gMCB8fAogI2VuZGlmCi0gICAgICAgICAg
ICBzdHJuY2FzZWNtcChtaW1lX3R5cGUsICJtZXNzYWdlLyIsIDgpID09IDAgfHwKKyAgICAgICAg
ICAgIGFwX2Nhc2VjbXBzdHJuKG1pbWVfdHlwZSwgIm1lc3NhZ2UvIiwgOCkgPT0gMCB8fAogICAg
ICAgICAgICAgZGMtPmZvcmNlX3hsYXRlID09IEZYX0ZPUkNFKSkgewogCiAgICAgICAgICAgICBy
diA9IGFwcl94bGF0ZV9vcGVuKCZjdHgtPnhsYXRlLApJbmRleDogbW9kdWxlcy9maWx0ZXJzL21v
ZF9kZWZsYXRlLmMKPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PQotLS0gbW9kdWxlcy9maWx0ZXJzL21vZF9kZWZsYXRlLmMJ
KHJldmlzaW9uIDE3MjIxNDMpCisrKyBtb2R1bGVzL2ZpbHRlcnMvbW9kX2RlZmxhdGUuYwkod29y
a2luZyBjb3B5KQpAQCAtMTE4LDggKzExOCw4IEBAIHN0YXRpYyBpbnQgY2hlY2tfZ3ppcChyZXF1
ZXN0X3JlYyAqciwgYXByX3RhYmxlX3QKICAgICBpZiAoZW5jb2RpbmcgJiYgKmVuY29kaW5nKSB7
CiAKICAgICAgICAgLyogY2hlY2sgdGhlIHVzdWFsL3NpbXBsZSBjYXNlIGZpcnN0ICovCi0gICAg
ICAgIGlmICghc3RyY2FzZWNtcChlbmNvZGluZywgImd6aXAiKQotICAgICAgICAgICAgfHwgIXN0
cmNhc2VjbXAoZW5jb2RpbmcsICJ4LWd6aXAiKSkgeworICAgICAgICBpZiAoIWFwX2Nhc2VjbXBz
dHIoZW5jb2RpbmcsICJnemlwIikKKyAgICAgICAgICAgIHx8ICFhcF9jYXNlY21wc3RyKGVuY29k
aW5nLCAieC1nemlwIikpIHsKICAgICAgICAgICAgIGZvdW5kID0gMTsKICAgICAgICAgICAgIGlm
IChoZHJzKSB7CiAgICAgICAgICAgICAgICAgYXByX3RhYmxlX3Vuc2V0KGhkcnMsICJDb250ZW50
LUVuY29kaW5nIik7CkBAIC0xMzcsOCArMTM3LDggQEAgc3RhdGljIGludCBjaGVja19nemlwKHJl
cXVlc3RfcmVjICpyLCBhcHJfdGFibGVfdAogICAgICAgICAgICAgZm9yKDs7KSB7CiAgICAgICAg
ICAgICAgICAgY2hhciAqdG9rZW4gPSBhcF9zdHJyY2hyKG5ld19lbmNvZGluZywgJywnKTsKICAg
ICAgICAgICAgICAgICBpZiAoIXRva2VuKSB7ICAgICAgICAvKiBnemlwOmlkZW50aXR5IG9yIG90
aGVyOmlkZW50aXR5ICovCi0gICAgICAgICAgICAgICAgICAgIGlmICghc3RyY2FzZWNtcChuZXdf
ZW5jb2RpbmcsICJnemlwIikKLSAgICAgICAgICAgICAgICAgICAgICAgIHx8ICFzdHJjYXNlY21w
KG5ld19lbmNvZGluZywgIngtZ3ppcCIpKSB7CisgICAgICAgICAgICAgICAgICAgIGlmICghYXBf
Y2FzZWNtcHN0cihuZXdfZW5jb2RpbmcsICJnemlwIikKKyAgICAgICAgICAgICAgICAgICAgICAg
IHx8ICFhcF9jYXNlY21wc3RyKG5ld19lbmNvZGluZywgIngtZ3ppcCIpKSB7CiAgICAgICAgICAg
ICAgICAgICAgICAgICBmb3VuZCA9IDE7CiAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoaGRy
cykgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFwcl90YWJsZV91bnNldChoZHJzLCAi
Q29udGVudC1FbmNvZGluZyIpOwpAQCAtMTUwLDggKzE1MCw4IEBAIHN0YXRpYyBpbnQgY2hlY2tf
Z3ppcChyZXF1ZXN0X3JlYyAqciwgYXByX3RhYmxlX3QKICAgICAgICAgICAgICAgICAgICAgYnJl
YWs7IC8qIHNlZW4gYWxsIHRva2VucyAqLwogICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAg
ICAgICBmb3IgKHB0cj10b2tlbisxOyBhcHJfaXNzcGFjZSgqcHRyKTsgKytwdHIpOwotICAgICAg
ICAgICAgICAgIGlmICghc3RyY2FzZWNtcChwdHIsICJnemlwIikKLSAgICAgICAgICAgICAgICAg
ICAgfHwgIXN0cmNhc2VjbXAocHRyLCAieC1nemlwIikpIHsKKyAgICAgICAgICAgICAgICBpZiAo
IWFwX2Nhc2VjbXBzdHIocHRyLCAiZ3ppcCIpCisgICAgICAgICAgICAgICAgICAgIHx8ICFhcF9j
YXNlY21wc3RyKHB0ciwgIngtZ3ppcCIpKSB7CiAgICAgICAgICAgICAgICAgICAgICp0b2tlbiA9
ICdcMCc7CiAgICAgICAgICAgICAgICAgICAgIGlmIChoZHJzKSB7CiAgICAgICAgICAgICAgICAg
ICAgICAgICBhcHJfdGFibGVfc2V0bihoZHJzLCAiQ29udGVudC1FbmNvZGluZyIsIG5ld19lbmNv
ZGluZyk7CkBAIC0xNjEsNyArMTYxLDcgQEAgc3RhdGljIGludCBjaGVja19nemlwKHJlcXVlc3Rf
cmVjICpyLCBhcHJfdGFibGVfdAogICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAg
ICAgICAgIGZvdW5kID0gMTsKICAgICAgICAgICAgICAgICB9Ci0gICAgICAgICAgICAgICAgZWxz
ZSBpZiAoIXB0clswXSB8fCAhc3RyY2FzZWNtcChwdHIsICJpZGVudGl0eSIpKSB7CisgICAgICAg
ICAgICAgICAgZWxzZSBpZiAoIXB0clswXSB8fCAhYXBfY2FzZWNtcHN0cihwdHIsICJpZGVudGl0
eSIpKSB7CiAgICAgICAgICAgICAgICAgICAgICp0b2tlbiA9ICdcMCc7CiAgICAgICAgICAgICAg
ICAgICAgIGNvbnRpbnVlOyAvKiBzdHJpcCB0aGUgdG9rZW4gYW5kIGZpbmQgdGhlIG5leHQgb25l
ICovCiAgICAgICAgICAgICAgICAgfQpAQCAtNzA0LDcgKzcwNCw3IEBAIHN0YXRpYyBhcHJfc3Rh
dHVzX3QgZGVmbGF0ZV9vdXRfZmlsdGVyKGFwX2ZpbHRlcl90CiAgICAgICAgICAgICB9CiAKICAg
ICAgICAgICAgIHRva2VuID0gYXBfZ2V0X3Rva2VuKHItPnBvb2wsICZhY2NlcHRzLCAwKTsKLSAg
ICAgICAgICAgIHdoaWxlICh0b2tlbiAmJiB0b2tlblswXSAmJiBzdHJjYXNlY21wKHRva2VuLCAi
Z3ppcCIpKSB7CisgICAgICAgICAgICB3aGlsZSAodG9rZW4gJiYgdG9rZW5bMF0gJiYgYXBfY2Fz
ZWNtcHN0cih0b2tlbiwgImd6aXAiKSkgewogICAgICAgICAgICAgICAgIC8qIHNraXAgcGFyYW1l
dGVycywgWFhYOiA7cT1mb28gZXZhbHVhdGlvbj8gKi8KICAgICAgICAgICAgICAgICB3aGlsZSAo
KmFjY2VwdHMgPT0gJzsnKSB7CiAgICAgICAgICAgICAgICAgICAgICsrYWNjZXB0czsKQEAgLTc3
OCw3ICs3NzgsNyBAQCBzdGF0aWMgYXByX3N0YXR1c190IGRlZmxhdGVfb3V0X2ZpbHRlcihhcF9m
aWx0ZXJfdAogICAgICAgICAgKi8KIAogICAgICAgICAvKiBJZiB0aGUgZW50aXJlIENvbnRlbnQt
RW5jb2RpbmcgaXMgImlkZW50aXR5Iiwgd2UgY2FuIHJlcGxhY2UgaXQuICovCi0gICAgICAgIGlm
ICghZW5jb2RpbmcgfHwgIXN0cmNhc2VjbXAoZW5jb2RpbmcsICJpZGVudGl0eSIpKSB7CisgICAg
ICAgIGlmICghZW5jb2RpbmcgfHwgIWFwX2Nhc2VjbXBzdHIoZW5jb2RpbmcsICJpZGVudGl0eSIp
KSB7CiAgICAgICAgICAgICBhcHJfdGFibGVfc2V0bihyLT5oZWFkZXJzX291dCwgIkNvbnRlbnQt
RW5jb2RpbmciLCAiZ3ppcCIpOwogICAgICAgICB9CiAgICAgICAgIGVsc2UgewpJbmRleDogbW9k
dWxlcy9maWx0ZXJzL21vZF9pbmNsdWRlLmMKPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQotLS0gbW9kdWxlcy9maWx0ZXJz
L21vZF9pbmNsdWRlLmMJKHJldmlzaW9uIDE3MjIxNDMpCisrKyBtb2R1bGVzL2ZpbHRlcnMvbW9k
X2luY2x1ZGUuYwkod29ya2luZyBjb3B5KQpAQCAtMTk1MCwyNSArMTk1MCwyNSBAQCBzdGF0aWMg
YXByX3N0YXR1c190IGhhbmRsZV9lY2hvKGluY2x1ZGVfY3R4X3QgKmN0eAogICAgICAgICAgICAg
ICAgIHRva2VuID0gYXByX3N0cnRvayhkLCAiLCBcdCIsICZsYXN0KTsKIAogICAgICAgICAgICAg
ICAgIHdoaWxlICh0b2tlbikgewotICAgICAgICAgICAgICAgICAgICBpZiAoIXN0cmNhc2VjbXAo
dG9rZW4sICJub25lIikpIHsKKyAgICAgICAgICAgICAgICAgICAgaWYgKCFhcF9jYXNlY21wc3Ry
KHRva2VuLCAibm9uZSIpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAvKiBkbyBub3RoaW5n
ICovCiAgICAgICAgICAgICAgICAgICAgIH0KLSAgICAgICAgICAgICAgICAgICAgZWxzZSBpZiAo
IXN0cmNhc2VjbXAodG9rZW4sICJ1cmwiKSkgeworICAgICAgICAgICAgICAgICAgICBlbHNlIGlm
ICghYXBfY2FzZWNtcHN0cih0b2tlbiwgInVybCIpKSB7CiAgICAgICAgICAgICAgICAgICAgICAg
ICBjaGFyICpidWYgPSBhcHJfcHN0cmR1cChjdHgtPnBvb2wsIGVjaG9fdGV4dCk7CiAgICAgICAg
ICAgICAgICAgICAgICAgICBhcF91bmVzY2FwZV91cmwoYnVmKTsKICAgICAgICAgICAgICAgICAg
ICAgICAgIGVjaG9fdGV4dCA9IGJ1ZjsKICAgICAgICAgICAgICAgICAgICAgfQotICAgICAgICAg
ICAgICAgICAgICBlbHNlIGlmICghc3RyY2FzZWNtcCh0b2tlbiwgInVybGVuY29kZWQiKSkgewor
ICAgICAgICAgICAgICAgICAgICBlbHNlIGlmICghYXBfY2FzZWNtcHN0cih0b2tlbiwgInVybGVu
Y29kZWQiKSkgewogICAgICAgICAgICAgICAgICAgICAgICAgY2hhciAqYnVmID0gYXByX3BzdHJk
dXAoY3R4LT5wb29sLCBlY2hvX3RleHQpOwogICAgICAgICAgICAgICAgICAgICAgICAgYXBfdW5l
c2NhcGVfdXJsZW5jb2RlZChidWYpOwogICAgICAgICAgICAgICAgICAgICAgICAgZWNob190ZXh0
ID0gYnVmOwogICAgICAgICAgICAgICAgICAgICB9Ci0gICAgICAgICAgICAgICAgICAgIGVsc2Ug
aWYgKCFzdHJjYXNlY21wKHRva2VuLCAiZW50aXR5IikpIHsKKyAgICAgICAgICAgICAgICAgICAg
ZWxzZSBpZiAoIWFwX2Nhc2VjbXBzdHIodG9rZW4sICJlbnRpdHkiKSkgewogICAgICAgICAgICAg
ICAgICAgICAgICAgY2hhciAqYnVmID0gYXByX3BzdHJkdXAoY3R4LT5wb29sLCBlY2hvX3RleHQp
OwogICAgICAgICAgICAgICAgICAgICAgICAgZGVjb2RlaHRtbChidWYpOwogICAgICAgICAgICAg
ICAgICAgICAgICAgZWNob190ZXh0ID0gYnVmOwogICAgICAgICAgICAgICAgICAgICB9Ci0gICAg
ICAgICAgICAgICAgICAgIGVsc2UgaWYgKCFzdHJjYXNlY21wKHRva2VuLCAiYmFzZTY0IikpIHsK
KyAgICAgICAgICAgICAgICAgICAgZWxzZSBpZiAoIWFwX2Nhc2VjbXBzdHIodG9rZW4sICJiYXNl
NjQiKSkgewogICAgICAgICAgICAgICAgICAgICAgICAgZWNob190ZXh0ID0gYXBfcGJhc2U2NGRl
Y29kZShjdHgtPmRwb29sLCBlY2hvX3RleHQpOwogICAgICAgICAgICAgICAgICAgICB9CiAgICAg
ICAgICAgICAgICAgICAgIGVsc2UgewpAQCAtMTk4NiwxOSArMTk4NiwxOSBAQCBzdGF0aWMgYXBy
X3N0YXR1c190IGhhbmRsZV9lY2hvKGluY2x1ZGVfY3R4X3QgKmN0eAogICAgICAgICAgICAgICAg
IHRva2VuID0gYXByX3N0cnRvayhlLCAiLCBcdCIsICZsYXN0KTsKIAogICAgICAgICAgICAgICAg
IHdoaWxlICh0b2tlbikgewotICAgICAgICAgICAgICAgICAgICBpZiAoIXN0cmNhc2VjbXAodG9r
ZW4sICJub25lIikpIHsKKyAgICAgICAgICAgICAgICAgICAgaWYgKCFhcF9jYXNlY21wc3RyKHRv
a2VuLCAibm9uZSIpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAvKiBkbyBub3RoaW5nICov
CiAgICAgICAgICAgICAgICAgICAgIH0KLSAgICAgICAgICAgICAgICAgICAgZWxzZSBpZiAoIXN0
cmNhc2VjbXAodG9rZW4sICJ1cmwiKSkgeworICAgICAgICAgICAgICAgICAgICBlbHNlIGlmICgh
YXBfY2FzZWNtcHN0cih0b2tlbiwgInVybCIpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICBl
Y2hvX3RleHQgPSBhcF9lc2NhcGVfdXJpKGN0eC0+ZHBvb2wsIGVjaG9fdGV4dCk7CiAgICAgICAg
ICAgICAgICAgICAgIH0KLSAgICAgICAgICAgICAgICAgICAgZWxzZSBpZiAoIXN0cmNhc2VjbXAo
dG9rZW4sICJ1cmxlbmNvZGVkIikpIHsKKyAgICAgICAgICAgICAgICAgICAgZWxzZSBpZiAoIWFw
X2Nhc2VjbXBzdHIodG9rZW4sICJ1cmxlbmNvZGVkIikpIHsKICAgICAgICAgICAgICAgICAgICAg
ICAgIGVjaG9fdGV4dCA9IGFwX2VzY2FwZV91cmxlbmNvZGVkKGN0eC0+ZHBvb2wsIGVjaG9fdGV4
dCk7CiAgICAgICAgICAgICAgICAgICAgIH0KLSAgICAgICAgICAgICAgICAgICAgZWxzZSBpZiAo
IXN0cmNhc2VjbXAodG9rZW4sICJlbnRpdHkiKSkgeworICAgICAgICAgICAgICAgICAgICBlbHNl
IGlmICghYXBfY2FzZWNtcHN0cih0b2tlbiwgImVudGl0eSIpKSB7CiAgICAgICAgICAgICAgICAg
ICAgICAgICBlY2hvX3RleHQgPSBhcF9lc2NhcGVfaHRtbDIoY3R4LT5kcG9vbCwgZWNob190ZXh0
LCAwKTsKICAgICAgICAgICAgICAgICAgICAgfQotICAgICAgICAgICAgICAgICAgICBlbHNlIGlm
ICghc3RyY2FzZWNtcCh0b2tlbiwgImJhc2U2NCIpKSB7CisgICAgICAgICAgICAgICAgICAgIGVs
c2UgaWYgKCFhcF9jYXNlY21wc3RyKHRva2VuLCAiYmFzZTY0IikpIHsKICAgICAgICAgICAgICAg
ICAgICAgICAgIGNoYXIgKmJ1ZjsKICAgICAgICAgICAgICAgICAgICAgICAgIGJ1ZiA9IGFwX3Bi
YXNlNjRlbmNvZGUoY3R4LT5kcG9vbCwgKGNoYXIgKillY2hvX3RleHQpOwogICAgICAgICAgICAg
ICAgICAgICAgICAgZWNob190ZXh0ID0gYnVmOwpAQCAtMjU4OCwyNSArMjU4OCwyNSBAQCBzdGF0
aWMgYXByX3N0YXR1c190IGhhbmRsZV9zZXQoaW5jbHVkZV9jdHhfdCAqY3R4LAogICAgICAgICAg
ICAgICAgIHRva2VuID0gYXByX3N0cnRvayhkLCAiLCBcdCIsICZsYXN0KTsKIAogICAgICAgICAg
ICAgICAgIHdoaWxlICh0b2tlbikgewotICAgICAgICAgICAgICAgICAgICBpZiAoIXN0cmNhc2Vj
bXAodG9rZW4sICJub25lIikpIHsKKyAgICAgICAgICAgICAgICAgICAgaWYgKCFhcF9jYXNlY21w
c3RyKHRva2VuLCAibm9uZSIpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAvKiBkbyBub3Ro
aW5nICovCiAgICAgICAgICAgICAgICAgICAgIH0KLSAgICAgICAgICAgICAgICAgICAgZWxzZSBp
ZiAoIXN0cmNhc2VjbXAodG9rZW4sICJ1cmwiKSkgeworICAgICAgICAgICAgICAgICAgICBlbHNl
IGlmICghYXBfY2FzZWNtcHN0cih0b2tlbiwgInVybCIpKSB7CiAgICAgICAgICAgICAgICAgICAg
ICAgICBjaGFyICpidWYgPSBhcHJfcHN0cmR1cChjdHgtPnBvb2wsIHBhcnNlZF9zdHJpbmcpOwog
ICAgICAgICAgICAgICAgICAgICAgICAgYXBfdW5lc2NhcGVfdXJsKGJ1Zik7CiAgICAgICAgICAg
ICAgICAgICAgICAgICBwYXJzZWRfc3RyaW5nID0gYnVmOwogICAgICAgICAgICAgICAgICAgICB9
Ci0gICAgICAgICAgICAgICAgICAgIGVsc2UgaWYgKCFzdHJjYXNlY21wKHRva2VuLCAidXJsZW5j
b2RlZCIpKSB7CisgICAgICAgICAgICAgICAgICAgIGVsc2UgaWYgKCFhcF9jYXNlY21wc3RyKHRv
a2VuLCAidXJsZW5jb2RlZCIpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICBjaGFyICpidWYg
PSBhcHJfcHN0cmR1cChjdHgtPnBvb2wsIHBhcnNlZF9zdHJpbmcpOwogICAgICAgICAgICAgICAg
ICAgICAgICAgYXBfdW5lc2NhcGVfdXJsZW5jb2RlZChidWYpOwogICAgICAgICAgICAgICAgICAg
ICAgICAgcGFyc2VkX3N0cmluZyA9IGJ1ZjsKICAgICAgICAgICAgICAgICAgICAgfQotICAgICAg
ICAgICAgICAgICAgICBlbHNlIGlmICghc3RyY2FzZWNtcCh0b2tlbiwgImVudGl0eSIpKSB7Cisg
ICAgICAgICAgICAgICAgICAgIGVsc2UgaWYgKCFhcF9jYXNlY21wc3RyKHRva2VuLCAiZW50aXR5
IikpIHsKICAgICAgICAgICAgICAgICAgICAgICAgIGNoYXIgKmJ1ZiA9IGFwcl9wc3RyZHVwKGN0
eC0+cG9vbCwgcGFyc2VkX3N0cmluZyk7CiAgICAgICAgICAgICAgICAgICAgICAgICBkZWNvZGVo
dG1sKGJ1Zik7CiAgICAgICAgICAgICAgICAgICAgICAgICBwYXJzZWRfc3RyaW5nID0gYnVmOwog
ICAgICAgICAgICAgICAgICAgICB9Ci0gICAgICAgICAgICAgICAgICAgIGVsc2UgaWYgKCFzdHJj
YXNlY21wKHRva2VuLCAiYmFzZTY0IikpIHsKKyAgICAgICAgICAgICAgICAgICAgZWxzZSBpZiAo
IWFwX2Nhc2VjbXBzdHIodG9rZW4sICJiYXNlNjQiKSkgewogICAgICAgICAgICAgICAgICAgICAg
ICAgcGFyc2VkX3N0cmluZyA9IGFwX3BiYXNlNjRkZWNvZGUoY3R4LT5kcG9vbCwgcGFyc2VkX3N0
cmluZyk7CiAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgZWxzZSB7
CkBAIC0yNjI0LDE5ICsyNjI0LDE5IEBAIHN0YXRpYyBhcHJfc3RhdHVzX3QgaGFuZGxlX3NldChp
bmNsdWRlX2N0eF90ICpjdHgsCiAgICAgICAgICAgICAgICAgdG9rZW4gPSBhcHJfc3RydG9rKGUs
ICIsIFx0IiwgJmxhc3QpOwogCiAgICAgICAgICAgICAgICAgd2hpbGUgKHRva2VuKSB7Ci0gICAg
ICAgICAgICAgICAgICAgIGlmICghc3RyY2FzZWNtcCh0b2tlbiwgIm5vbmUiKSkgeworICAgICAg
ICAgICAgICAgICAgICBpZiAoIWFwX2Nhc2VjbXBzdHIodG9rZW4sICJub25lIikpIHsKICAgICAg
ICAgICAgICAgICAgICAgICAgIC8qIGRvIG5vdGhpbmcgKi8KICAgICAgICAgICAgICAgICAgICAg
fQotICAgICAgICAgICAgICAgICAgICBlbHNlIGlmICghc3RyY2FzZWNtcCh0b2tlbiwgInVybCIp
KSB7CisgICAgICAgICAgICAgICAgICAgIGVsc2UgaWYgKCFhcF9jYXNlY21wc3RyKHRva2VuLCAi
dXJsIikpIHsKICAgICAgICAgICAgICAgICAgICAgICAgIHBhcnNlZF9zdHJpbmcgPSBhcF9lc2Nh
cGVfdXJpKGN0eC0+ZHBvb2wsIHBhcnNlZF9zdHJpbmcpOwogICAgICAgICAgICAgICAgICAgICB9
Ci0gICAgICAgICAgICAgICAgICAgIGVsc2UgaWYgKCFzdHJjYXNlY21wKHRva2VuLCAidXJsZW5j
b2RlZCIpKSB7CisgICAgICAgICAgICAgICAgICAgIGVsc2UgaWYgKCFhcF9jYXNlY21wc3RyKHRv
a2VuLCAidXJsZW5jb2RlZCIpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICBwYXJzZWRfc3Ry
aW5nID0gYXBfZXNjYXBlX3VybGVuY29kZWQoY3R4LT5kcG9vbCwgcGFyc2VkX3N0cmluZyk7CiAg
ICAgICAgICAgICAgICAgICAgIH0KLSAgICAgICAgICAgICAgICAgICAgZWxzZSBpZiAoIXN0cmNh
c2VjbXAodG9rZW4sICJlbnRpdHkiKSkgeworICAgICAgICAgICAgICAgICAgICBlbHNlIGlmICgh
YXBfY2FzZWNtcHN0cih0b2tlbiwgImVudGl0eSIpKSB7CiAgICAgICAgICAgICAgICAgICAgICAg
ICBwYXJzZWRfc3RyaW5nID0gYXBfZXNjYXBlX2h0bWwyKGN0eC0+ZHBvb2wsIHBhcnNlZF9zdHJp
bmcsIDApOwogICAgICAgICAgICAgICAgICAgICB9Ci0gICAgICAgICAgICAgICAgICAgIGVsc2Ug
aWYgKCFzdHJjYXNlY21wKHRva2VuLCAiYmFzZTY0IikpIHsKKyAgICAgICAgICAgICAgICAgICAg
ZWxzZSBpZiAoIWFwX2Nhc2VjbXBzdHIodG9rZW4sICJiYXNlNjQiKSkgewogICAgICAgICAgICAg
ICAgICAgICAgICAgY2hhciAqYnVmOwogICAgICAgICAgICAgICAgICAgICAgICAgYnVmID0gYXBf
cGJhc2U2NGVuY29kZShjdHgtPmRwb29sLCAoY2hhciAqKXBhcnNlZF9zdHJpbmcpOwogICAgICAg
ICAgICAgICAgICAgICAgICAgcGFyc2VkX3N0cmluZyA9IGJ1ZjsKSW5kZXg6IG1vZHVsZXMvZmls
dGVycy9tb2RfcHJveHlfaHRtbC5jCj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KLS0tIG1vZHVsZXMvZmlsdGVycy9tb2Rf
cHJveHlfaHRtbC5jCShyZXZpc2lvbiAxNzIyMTQzKQorKysgbW9kdWxlcy9maWx0ZXJzL21vZF9w
cm94eV9odG1sLmMJKHdvcmtpbmcgY29weSkKQEAgLTY2MCw3ICs2NjAsNyBAQCBzdGF0aWMgbWV0
YSAqbWV0YWZpeChyZXF1ZXN0X3JlYyAqciwgY29uc3QgY2hhciAqYgogICAgICAgICB3aGlsZSAo
IWFwcl9pc2FscGhhKCorK3ApKTsKICAgICAgICAgZm9yIChxID0gcDsgYXByX2lzYWxudW0oKnEp
IHx8ICgqcSA9PSAnLScpOyArK3EpOwogICAgICAgICBoZWFkZXIgPSBhcHJfcHN0cm5kdXAoci0+
cG9vbCwgcCwgcS1wKTsKLSAgICAgICAgaWYgKHN0cm5jYXNlY21wKGhlYWRlciwgIkNvbnRlbnQt
IiwgOCkpIHsKKyAgICAgICAgaWYgKGFwX2Nhc2VjbXBzdHJuKGhlYWRlciwgIkNvbnRlbnQtIiwg
OCkpIHsKICAgICAgICAgICAgIC8qIGZpbmQgY29udGVudD0uLi4gc3RyaW5nICovCiAgICAgICAg
ICAgICBwID0gYXByX3N0cm1hdGNoKHNlZWtfY29udGVudCwgYnVmK29mZnMrcG1hdGNoWzBdLnJt
X3NvLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcG1hdGNoWzBdLnJtX2VvIC0gcG1h
dGNoWzBdLnJtX3NvKTsKQEAgLTY4OCw3ICs2ODgsNyBAQCBzdGF0aWMgbWV0YSAqbWV0YWZpeChy
ZXF1ZXN0X3JlYyAqciwgY29uc3QgY2hhciAqYgogICAgICAgICAgICAgICAgIH0KICAgICAgICAg
ICAgIH0KICAgICAgICAgfQotICAgICAgICBlbHNlIGlmICghc3RybmNhc2VjbXAoaGVhZGVyLCAi
Q29udGVudC1UeXBlIiwgMTIpKSB7CisgICAgICAgIGVsc2UgaWYgKCFhcF9jYXNlY21wc3Rybiho
ZWFkZXIsICJDb250ZW50LVR5cGUiLCAxMikpIHsKICAgICAgICAgICAgIHJldCA9IGFwcl9wYWxs
b2Moci0+cG9vbCwgc2l6ZW9mKG1ldGEpKTsKICAgICAgICAgICAgIHJldC0+c3RhcnQgPSBvZmZz
K3BtYXRjaFswXS5ybV9zbzsKICAgICAgICAgICAgIHJldC0+ZW5kID0gb2ZmcytwbWF0Y2hbMF0u
cm1fZW87CkBAIC04MTIsOCArODEyLDggQEAgc3RhdGljIHNheGN0eHQgKmNoZWNrX2ZpbHRlcl9p
bml0IChhcF9maWx0ZXJfdCAqZikKICAgICAgICAgICAgIGVsc2UgaWYgKCFmLT5yLT5jb250ZW50
X3R5cGUpIHsKICAgICAgICAgICAgICAgICBlcnJtc2cgPSAiTm8gY29udGVudC10eXBlOyBiYWls
aW5nIG91dCBvZiBwcm94eS1odG1sIGZpbHRlciI7CiAgICAgICAgICAgICB9Ci0gICAgICAgICAg
ICBlbHNlIGlmIChzdHJuY2FzZWNtcChmLT5yLT5jb250ZW50X3R5cGUsICJ0ZXh0L2h0bWwiLCA5
KSAmJgotICAgICAgICAgICAgICAgICAgICAgc3RybmNhc2VjbXAoZi0+ci0+Y29udGVudF90eXBl
LAorICAgICAgICAgICAgZWxzZSBpZiAoYXBfY2FzZWNtcHN0cm4oZi0+ci0+Y29udGVudF90eXBl
LCAidGV4dC9odG1sIiwgOSkgJiYKKyAgICAgICAgICAgICAgICAgICAgIGFwX2Nhc2VjbXBzdHJu
KGYtPnItPmNvbnRlbnRfdHlwZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJh
cHBsaWNhdGlvbi94aHRtbCt4bWwiLCAyMSkpIHsKICAgICAgICAgICAgICAgICBlcnJtc2cgPSAi
Tm9uLUhUTUwgY29udGVudDsgbm90IGluc2VydGluZyBwcm94eS1odG1sIGZpbHRlciI7CiAgICAg
ICAgICAgICB9CkluZGV4OiBtb2R1bGVzL2dlbmVyYXRvcnMvbW9kX2F1dG9pbmRleC5jCj09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT0KLS0tIG1vZHVsZXMvZ2VuZXJhdG9ycy9tb2RfYXV0b2luZGV4LmMJKHJldmlzaW9uIDE3
MjIxNDMpCisrKyBtb2R1bGVzL2dlbmVyYXRvcnMvbW9kX2F1dG9pbmRleC5jCSh3b3JraW5nIGNv
cHkpCkBAIC0xMDY4LDcgKzEwNjgsNyBAQCBzdGF0aWMgdm9pZCBlbWl0X2hlYWQocmVxdWVzdF9y
ZWMgKnIsIGNoYXIgKmhlYWRlcgogICAgICAgICAgICAgICAgICAgICBlbWl0X0gxID0gMTsKICAg
ICAgICAgICAgICAgICB9CiAgICAgICAgICAgICB9Ci0gICAgICAgICAgICBlbHNlIGlmICghc3Ry
bmNhc2VjbXAoInRleHQvIiwgcnItPmNvbnRlbnRfdHlwZSwgNSkpIHsKKyAgICAgICAgICAgIGVs
c2UgaWYgKCFhcF9jYXNlY21wc3RybigidGV4dC8iLCByci0+Y29udGVudF90eXBlLCA1KSkgewog
ICAgICAgICAgICAgICAgIC8qCiAgICAgICAgICAgICAgICAgICogSWYgd2UgY2FuIG9wZW4gdGhl
IGZpbGUsIHByZWZpeCBpdCB3aXRoIHRoZSBwcmVhbWJsZQogICAgICAgICAgICAgICAgICAqIHJl
Z2FyZGxlc3M7IHNpbmNlIHdlJ2xsIGJlIHNlbmRpbmcgYSA8cHJlPiBibG9jayBhcm91bmQKQEAg
LTExNjMsNyArMTE2Myw3IEBAIHN0YXRpYyB2b2lkIGVtaXRfdGFpbChyZXF1ZXN0X3JlYyAqciwg
Y2hhciAqcmVhZG1lCiAgICAgICAgICAgICAgICAgICAgIHN1cHByZXNzX3Bvc3QgPSBzdXBwcmVz
c19hbWJsZTsKICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICB9Ci0gICAgICAgICAgICBl
bHNlIGlmICghc3RybmNhc2VjbXAoInRleHQvIiwgcnItPmNvbnRlbnRfdHlwZSwgNSkpIHsKKyAg
ICAgICAgICAgIGVsc2UgaWYgKCFhcF9jYXNlY21wc3RybigidGV4dC8iLCByci0+Y29udGVudF90
eXBlLCA1KSkgewogICAgICAgICAgICAgICAgIC8qCiAgICAgICAgICAgICAgICAgICogSWYgd2Ug
Y2FuIG9wZW4gdGhlIGZpbGUsIHN1cHByZXNzIHRoZSBzaWduYXR1cmUuCiAgICAgICAgICAgICAg
ICAgICovCkluZGV4OiBtb2R1bGVzL2dlbmVyYXRvcnMvbW9kX2luZm8uYwo9PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09Ci0t
LSBtb2R1bGVzL2dlbmVyYXRvcnMvbW9kX2luZm8uYwkocmV2aXNpb24gMTcyMjE0MykKKysrIG1v
ZHVsZXMvZ2VuZXJhdG9ycy9tb2RfaW5mby5jCSh3b3JraW5nIGNvcHkpCkBAIC03ODUsNyArNzg1
LDcgQEAgc3RhdGljIGludCBkaXNwbGF5X2luZm8ocmVxdWVzdF9yZWMgKiByKQogICAgICAgICAg
ICAgICIgIDx0aXRsZT5TZXJ2ZXIgSW5mb3JtYXRpb248L3RpdGxlPlxuIiAiPC9oZWFkPlxuIiwg
cik7CiAgICAgYXBfcnB1dHMoIjxib2R5PjxoMSBzdHlsZT1cInRleHQtYWxpZ246IGNlbnRlclwi
PiIKICAgICAgICAgICAgICAiQXBhY2hlIFNlcnZlciBJbmZvcm1hdGlvbjwvaDE+XG4iLCByKTsK
LSAgICBpZiAoIXItPmFyZ3MgfHwgc3RyY2FzZWNtcChyLT5hcmdzLCAibGlzdCIpKSB7CisgICAg
aWYgKCFyLT5hcmdzIHx8IGFwX2Nhc2VjbXBzdHIoci0+YXJncywgImxpc3QiKSkgewogICAgICAg
ICBpZiAoIXItPmFyZ3MpIHsKICAgICAgICAgICAgIGFwX3JwdXRzKCI8ZGw+PGR0Pjx0dD5TdWJw
YWdlczo8YnIgLz4iLCByKTsKICAgICAgICAgICAgIGFwX3JwdXRzKCI8YSBocmVmPVwiP2NvbmZp
Z1wiPkNvbmZpZ3VyYXRpb24gRmlsZXM8L2E+LCAiCkBAIC04MTksMTkgKzgxOSwxOSBAQCBzdGF0
aWMgaW50IGRpc3BsYXlfaW5mbyhyZXF1ZXN0X3JlYyAqIHIpCiAgICAgICAgICAgICBhcF9ycHV0
cygiPC90dD48L2R0PjwvZGw+PGhyIC8+Iiwgcik7CiAgICAgICAgIH0KIAotICAgICAgICBpZiAo
IXItPmFyZ3MgfHwgIXN0cmNhc2VjbXAoci0+YXJncywgInNlcnZlciIpKSB7CisgICAgICAgIGlm
ICghci0+YXJncyB8fCAhYXBfY2FzZWNtcHN0cihyLT5hcmdzLCAic2VydmVyIikpIHsKICAgICAg
ICAgICAgIHNob3dfc2VydmVyX3NldHRpbmdzKHIpOwogICAgICAgICB9CiAKLSAgICAgICAgaWYg
KCFyLT5hcmdzIHx8ICFzdHJjYXNlY21wKHItPmFyZ3MsICJob29rcyIpKSB7CisgICAgICAgIGlm
ICghci0+YXJncyB8fCAhYXBfY2FzZWNtcHN0cihyLT5hcmdzLCAiaG9va3MiKSkgewogICAgICAg
ICAgICAgc2hvd19hY3RpdmVfaG9va3Mocik7CiAgICAgICAgIH0KIAotICAgICAgICBpZiAoIXIt
PmFyZ3MgfHwgIXN0cmNhc2VjbXAoci0+YXJncywgInByb3ZpZGVycyIpKSB7CisgICAgICAgIGlm
ICghci0+YXJncyB8fCAhYXBfY2FzZWNtcHN0cihyLT5hcmdzLCAicHJvdmlkZXJzIikpIHsKICAg
ICAgICAgICAgIHNob3dfcHJvdmlkZXJzKHIpOwogICAgICAgICB9CiAKLSAgICAgICAgaWYgKHIt
PmFyZ3MgJiYgMCA9PSBzdHJjYXNlY21wKHItPmFyZ3MsICJjb25maWciKSkgeworICAgICAgICBp
ZiAoci0+YXJncyAmJiAwID09IGFwX2Nhc2VjbXBzdHIoci0+YXJncywgImNvbmZpZyIpKSB7CiAg
ICAgICAgICAgICBhcF9ycHV0cygiPGRsPjxkdD48c3Ryb25nPkNvbmZpZ3VyYXRpb246PC9zdHJv
bmc+XG4iLCByKTsKICAgICAgICAgICAgIG1vZF9pbmZvX21vZHVsZV9jbWRzKHIsIE5VTEwsIGFw
X2NvbmZ0cmVlLCAwLCAwKTsKICAgICAgICAgICAgIGFwX3JwdXRzKCI8L2RsPjxociAvPiIsIHIp
OwpAQCAtODQyLDcgKzg0Miw3IEBAIHN0YXRpYyBpbnQgZGlzcGxheV9pbmZvKHJlcXVlc3RfcmVj
ICogcikKICAgICAgICAgICAgICAgICAgbW9kdWxlcyA9IGdldF9zb3J0ZWRfbW9kdWxlcyhyLT5w
b29sKTsKICAgICAgICAgICAgIGZvciAoaSA9IDA7IGkgPCBtb2R1bGVzLT5uZWx0czsgaSsrKSB7
CiAgICAgICAgICAgICAgICAgbW9kcCA9IEFQUl9BUlJBWV9JRFgobW9kdWxlcywgaSwgbW9kdWxl
ICopOwotICAgICAgICAgICAgICAgIGlmICghci0+YXJncyB8fCAhc3RyY2FzZWNtcChtb2RwLT5u
YW1lLCByLT5hcmdzKSkgeworICAgICAgICAgICAgICAgIGlmICghci0+YXJncyB8fCAhYXBfY2Fz
ZWNtcHN0cihtb2RwLT5uYW1lLCByLT5hcmdzKSkgewogICAgICAgICAgICAgICAgICAgICBhcF9y
cHJpbnRmKHIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIjxkbD48ZHQ+PGEgbmFt
ZT1cIiVzXCI+PHN0cm9uZz5Nb2R1bGUgTmFtZTo8L3N0cm9uZz48L2E+ICIKICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAiPGZvbnQgc2l6ZT1cIisxXCI+PHR0PjxhIGhyZWY9XCI/JXNc
Ij4lczwvYT48L3R0PjwvZm9udD48L2R0PlxuIiwKQEAgLTk0MCw3ICs5NDAsNyBAQCBzdGF0aWMg
aW50IGRpc3BsYXlfaW5mbyhyZXF1ZXN0X3JlYyAqIHIpCiAgICAgICAgICAgICAgICAgICAgIH0K
ICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICB9Ci0gICAgICAgICAgICBpZiAoIW1vZHAg
JiYgci0+YXJncyAmJiBzdHJjYXNlY21wKHItPmFyZ3MsICJzZXJ2ZXIiKSkgeworICAgICAgICAg
ICAgaWYgKCFtb2RwICYmIHItPmFyZ3MgJiYgYXBfY2FzZWNtcHN0cihyLT5hcmdzLCAic2VydmVy
IikpIHsKICAgICAgICAgICAgICAgICBhcF9ycHV0cygiPHA+PGI+Tm8gc3VjaCBtb2R1bGU8L2I+
PC9wPlxuIiwgcik7CiAgICAgICAgICAgICB9CiAgICAgICAgIH0KSW5kZXg6IG1vZHVsZXMvaHR0
cC9ieXRlcmFuZ2VfZmlsdGVyLmMKPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQotLS0gbW9kdWxlcy9odHRwL2J5dGVyYW5n
ZV9maWx0ZXIuYwkocmV2aXNpb24gMTcyMjE0MykKKysrIG1vZHVsZXMvaHR0cC9ieXRlcmFuZ2Vf
ZmlsdGVyLmMJKHdvcmtpbmcgY29weSkKQEAgLTExNSw3ICsxMTUsNyBAQCBzdGF0aWMgaW50IGFw
X3NldF9ieXRlcmFuZ2UocmVxdWVzdF9yZWMgKnIsIGFwcl9vZgogICAgICAgICByYW5nZSA9IGFw
cl90YWJsZV9nZXQoci0+aGVhZGVyc19pbiwgIlJlcXVlc3QtUmFuZ2UiKTsKICAgICB9CiAKLSAg
ICBpZiAoIXJhbmdlIHx8IHN0cm5jYXNlY21wKHJhbmdlLCAiYnl0ZXM9IiwgNikgfHwgci0+c3Rh
dHVzICE9IEhUVFBfT0spIHsKKyAgICBpZiAoIXJhbmdlIHx8IGFwX2Nhc2VjbXBzdHJuKHJhbmdl
LCAiYnl0ZXM9IiwgNikgfHwgci0+c3RhdHVzICE9IEhUVFBfT0spIHsKICAgICAgICAgcmV0dXJu
IDA7CiAgICAgfQogCkBAIC0xMjYsOCArMTI2LDggQEAgc3RhdGljIGludCBhcF9zZXRfYnl0ZXJh
bmdlKHJlcXVlc3RfcmVjICpyLCBhcHJfb2YKIAogICAgIC8qIGlzIGNvbnRlbnQgYWxyZWFkeSBh
IG11bHRpcGxlIHJhbmdlPyAqLwogICAgIGlmICgoY3QgPSBhcHJfdGFibGVfZ2V0KHItPmhlYWRl
cnNfb3V0LCAiQ29udGVudC1UeXBlIikpCi0gICAgICAgICYmICghc3RybmNhc2VjbXAoY3QsICJt
dWx0aXBhcnQvYnl0ZXJhbmdlcyIsIDIwKQotICAgICAgICAgICAgfHwgIXN0cm5jYXNlY21wKGN0
LCAibXVsdGlwYXJ0L3gtYnl0ZXJhbmdlcyIsIDIyKSkpIHsKKyAgICAgICAgJiYgKCFhcF9jYXNl
Y21wc3RybihjdCwgIm11bHRpcGFydC9ieXRlcmFuZ2VzIiwgMjApCisgICAgICAgICAgICB8fCAh
YXBfY2FzZWNtcHN0cm4oY3QsICJtdWx0aXBhcnQveC1ieXRlcmFuZ2VzIiwgMjIpKSkgewogICAg
ICAgICAgICAgcmV0dXJuIDA7CiAgICAgICAgIH0KIApJbmRleDogbW9kdWxlcy9odHRwL2h0dHBf
ZmlsdGVycy5jCj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT0KLS0tIG1vZHVsZXMvaHR0cC9odHRwX2ZpbHRlcnMuYwkocmV2
aXNpb24gMTcyMjE0MykKKysrIG1vZHVsZXMvaHR0cC9odHRwX2ZpbHRlcnMuYwkod29ya2luZyBj
b3B5KQpAQCAtMzYzLDcgKzM2Myw3IEBAIGFwcl9zdGF0dXNfdCBhcF9odHRwX2ZpbHRlcihhcF9m
aWx0ZXJfdCAqZiwgYXByX2J1CiAgICAgICAgIGxlbnAgPSBhcHJfdGFibGVfZ2V0KGYtPnItPmhl
YWRlcnNfaW4sICJDb250ZW50LUxlbmd0aCIpOwogCiAgICAgICAgIGlmICh0ZW5jKSB7Ci0gICAg
ICAgICAgICBpZiAoc3RyY2FzZWNtcCh0ZW5jLCAiY2h1bmtlZCIpID09IDAgLyogZmFzdCBwYXRo
ICovCisgICAgICAgICAgICBpZiAoYXBfY2FzZWNtcHN0cih0ZW5jLCAiY2h1bmtlZCIpID09IDAg
LyogZmFzdCBwYXRoICovCiAgICAgICAgICAgICAgICAgICAgIHx8IGFwX2ZpbmRfbGFzdF90b2tl
bihmLT5yLT5wb29sLCB0ZW5jLCAiY2h1bmtlZCIpKSB7CiAgICAgICAgICAgICAgICAgY3R4LT5z
dGF0ZSA9IEJPRFlfQ0hVTks7CiAgICAgICAgICAgICB9CkBAIC03NDksNyArNzQ5LDcgQEAgc3Rh
dGljIGludCB1bmlxX2ZpZWxkX3ZhbHVlcyh2b2lkICpkLCBjb25zdCBjaGFyICoKICAgICAgICAg
ICovCiAgICAgICAgIGZvciAoaSA9IDAsIHN0cnBwID0gKGNoYXIgKiopIHZhbHVlcy0+ZWx0czsg
aSA8IHZhbHVlcy0+bmVsdHM7CiAgICAgICAgICAgICAgKytpLCArK3N0cnBwKSB7Ci0gICAgICAg
ICAgICBpZiAoKnN0cnBwICYmIHN0cmNhc2VjbXAoKnN0cnBwLCBzdGFydCkgPT0gMCkgeworICAg
ICAgICAgICAgaWYgKCpzdHJwcCAmJiBhcF9jYXNlY21wc3RyKCpzdHJwcCwgc3RhcnQpID09IDAp
IHsKICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgIH0KICAgICAgICAgfQpAQCAt
MTI4Miw3ICsxMjgyLDcgQEAgQVBfQ09SRV9ERUNMQVJFX05PTlNURChhcHJfc3RhdHVzX3QpIGFw
X2h0dHBfaGVhZGUKIAogICAgICAgICB3aGlsZSAoZmllbGQgJiYgKHRva2VuID0gYXBfZ2V0X2xp
c3RfaXRlbShyLT5wb29sLCAmZmllbGQpKSAhPSBOVUxMKSB7CiAgICAgICAgICAgICBmb3IgKGkg
PSAwOyBpIDwgci0+Y29udGVudF9sYW5ndWFnZXMtPm5lbHRzOyArK2kpIHsKLSAgICAgICAgICAg
ICAgICBpZiAoIXN0cmNhc2VjbXAodG9rZW4sIGxhbmd1YWdlc1tpXSkpCisgICAgICAgICAgICAg
ICAgaWYgKCFhcF9jYXNlY21wc3RyKHRva2VuLCBsYW5ndWFnZXNbaV0pKQogICAgICAgICAgICAg
ICAgICAgICBicmVhazsKICAgICAgICAgICAgIH0KICAgICAgICAgICAgIGlmIChpID09IHItPmNv
bnRlbnRfbGFuZ3VhZ2VzLT5uZWx0cykgewpAQCAtMTUzNCw3ICsxNTM0LDcgQEAgQVBfREVDTEFS
RShpbnQpIGFwX3NldHVwX2NsaWVudF9ibG9jayhyZXF1ZXN0X3JlYwogICAgIHItPnJlbWFpbmlu
ZyA9IDA7CiAKICAgICBpZiAodGVuYykgewotICAgICAgICBpZiAoc3RyY2FzZWNtcCh0ZW5jLCAi
Y2h1bmtlZCIpKSB7CisgICAgICAgIGlmIChhcF9jYXNlY21wc3RyKHRlbmMsICJjaHVua2VkIikp
IHsKICAgICAgICAgICAgIGFwX2xvZ19yZXJyb3IoQVBMT0dfTUFSSywgQVBMT0dfSU5GTywgMCwg
ciwgQVBMT0dOTygwMTU5MikKICAgICAgICAgICAgICAgICAgICAgICAgICAgIlVua25vd24gVHJh
bnNmZXItRW5jb2RpbmcgJXMiLCB0ZW5jKTsKICAgICAgICAgICAgIHJldHVybiBIVFRQX05PVF9J
TVBMRU1FTlRFRDsKSW5kZXg6IG1vZHVsZXMvaHR0cDIvaDJfZnJvbV9oMS5jCj09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0K
LS0tIG1vZHVsZXMvaHR0cDIvaDJfZnJvbV9oMS5jCShyZXZpc2lvbiAxNzIyMTQzKQorKysgbW9k
dWxlcy9odHRwMi9oMl9mcm9tX2gxLmMJKHdvcmtpbmcgY29weSkKQEAgLTI1OCw3ICsyNTgsNyBA
QCBzdGF0aWMgaW50IHVuaXFfZmllbGRfdmFsdWVzKHZvaWQgKmQsIGNvbnN0IGNoYXIgKgogICAg
ICAgICAgKi8KICAgICAgICAgZm9yIChpID0gMCwgc3RycHAgPSAoY2hhciAqKikgdmFsdWVzLT5l
bHRzOyBpIDwgdmFsdWVzLT5uZWx0czsKICAgICAgICAgICAgICArK2ksICsrc3RycHApIHsKLSAg
ICAgICAgICAgIGlmICgqc3RycHAgJiYgc3RyY2FzZWNtcCgqc3RycHAsIHN0YXJ0KSA9PSAwKSB7
CisgICAgICAgICAgICBpZiAoKnN0cnBwICYmIGFwX2Nhc2VjbXBzdHIoKnN0cnBwLCBzdGFydCkg
PT0gMCkgewogICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgfQogICAgICAgICB9
CkBAIC00MDgsNyArNDA4LDcgQEAgc3RhdGljIGgyX3Jlc3BvbnNlICpjcmVhdGVfcmVzcG9uc2Uo
aDJfZnJvbV9oMSAqZnIKICAgICAgICAgCiAgICAgICAgIHdoaWxlIChmaWVsZCAmJiAodG9rZW4g
PSBhcF9nZXRfbGlzdF9pdGVtKHItPnBvb2wsICZmaWVsZCkpICE9IE5VTEwpIHsKICAgICAgICAg
ICAgIGZvciAoaSA9IDA7IGkgPCByLT5jb250ZW50X2xhbmd1YWdlcy0+bmVsdHM7ICsraSkgewot
ICAgICAgICAgICAgICAgIGlmICghc3RyY2FzZWNtcCh0b2tlbiwgbGFuZ3VhZ2VzW2ldKSkKKyAg
ICAgICAgICAgICAgICBpZiAoIWFwX2Nhc2VjbXBzdHIodG9rZW4sIGxhbmd1YWdlc1tpXSkpCiAg
ICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgfQogICAgICAgICAgICAgaWYg
KGkgPT0gci0+Y29udGVudF9sYW5ndWFnZXMtPm5lbHRzKSB7CkluZGV4OiBtb2R1bGVzL2xvZ2dl
cnMvbW9kX2xvZ19jb25maWcuYwo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09Ci0tLSBtb2R1bGVzL2xvZ2dlcnMvbW9kX2xv
Z19jb25maWcuYwkocmV2aXNpb24gMTcyMjE0MykKKysrIG1vZHVsZXMvbG9nZ2Vycy9tb2RfbG9n
X2NvbmZpZy5jCSh3b3JraW5nIGNvcHkpCkBAIC00NjYsNyArNDY2LDcgQEAgc3RhdGljIEFQUl9J
TkxJTkUgY2hhciAqZmluZF9tdWx0aXBsZV9oZWFkZXJzKGFwcl8KICAgICByZXN1bHRfbGlzdCA9
IHJwID0gTlVMTDsKIAogICAgIGRvIHsKLSAgICAgICAgaWYgKCFzdHJjYXNlY21wKHRfZWx0LT5r
ZXksIGtleSkpIHsKKyAgICAgICAgaWYgKCFhcF9jYXNlY21wc3RyKHRfZWx0LT5rZXksIGtleSkp
IHsKICAgICAgICAgICAgIGlmICghcmVzdWx0X2xpc3QpIHsKICAgICAgICAgICAgICAgICByZXN1
bHRfbGlzdCA9IHJwID0gYXByX3BhbGxvYyhwb29sLCBzaXplb2YoKnJwKSk7CiAgICAgICAgICAg
ICB9CkBAIC01MTAsMTAgKzUxMCwxMCBAQCBzdGF0aWMgY29uc3QgY2hhciAqbG9nX2hlYWRlcl9v
dXQocmVxdWVzdF9yZWMgKnIsCiB7CiAgICAgY29uc3QgY2hhciAqY3AgPSBOVUxMOwogCi0gICAg
aWYgKCFzdHJjYXNlY21wKGEsICJDb250ZW50LXR5cGUiKSAmJiByLT5jb250ZW50X3R5cGUpIHsK
KyAgICBpZiAoIWFwX2Nhc2VjbXBzdHIoYSwgIkNvbnRlbnQtdHlwZSIpICYmIHItPmNvbnRlbnRf
dHlwZSkgewogICAgICAgICBjcCA9IGFwX2ZpZWxkX25vcGFyYW0oci0+cG9vbCwgci0+Y29udGVu
dF90eXBlKTsKICAgICB9Ci0gICAgZWxzZSBpZiAoIXN0cmNhc2VjbXAoYSwgIlNldC1Db29raWUi
KSkgeworICAgIGVsc2UgaWYgKCFhcF9jYXNlY21wc3RyKGEsICJTZXQtQ29va2llIikpIHsKICAg
ICAgICAgY3AgPSBmaW5kX211bHRpcGxlX2hlYWRlcnMoci0+cG9vbCwgci0+aGVhZGVyc19vdXQs
IGEpOwogICAgIH0KICAgICBlbHNlIHsKQEAgLTU2OSw3ICs1NjksNyBAQCBzdGF0aWMgY29uc3Qg
Y2hhciAqbG9nX2Nvb2tpZShyZXF1ZXN0X3JlYyAqciwgY2hhcgogICAgICAgICAgICAgICAgICAg
ICAtLWxhc3Q7CiAgICAgICAgICAgICAgICAgfQogCi0gICAgICAgICAgICAgICAgaWYgKCFzdHJj
YXNlY21wKG5hbWUsIGEpKSB7CisgICAgICAgICAgICAgICAgaWYgKCFhcF9jYXNlY21wc3RyKG5h
bWUsIGEpKSB7CiAgICAgICAgICAgICAgICAgICAgIC8qIGxhc3QxIHBvaW50cyB0byB0aGUgbmV4
dCBjaGFyIGZvbGxvd2luZyB0aGUgJzsnIGRlbGltLAogICAgICAgICAgICAgICAgICAgICAgICBv
ciB0aGUgdHJhaWxpbmcgTlVMIGNoYXIgb2YgdGhlIHN0cmluZyAqLwogICAgICAgICAgICAgICAg
ICAgICBsYXN0ID0gbGFzdDEgLSAoKmxhc3QxID8gMiA6IDEpOwpJbmRleDogbW9kdWxlcy9tYXBw
ZXJzL21vZF9uZWdvdGlhdGlvbi5jCj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KLS0tIG1vZHVsZXMvbWFwcGVycy9tb2Rf
bmVnb3RpYXRpb24uYwkocmV2aXNpb24gMTcyMjE0MykKKysrIG1vZHVsZXMvbWFwcGVycy9tb2Rf
bmVnb3RpYXRpb24uYwkod29ya2luZyBjb3B5KQpAQCAtNzc0LDcgKzc3NCw3IEBAIHN0YXRpYyBl
bnVtIGhlYWRlcl9zdGF0ZSBnZXRfaGVhZGVyX2xpbmUoY2hhciAqYnVmCiAgICAgLyogV2UgbmVl
ZCB0byBzaG9ydGN1dCB0aGUgcmVzdCBvZiB0aGlzIGJsb2NrIGZvbGxvd2luZyB0aGUgQm9keToK
ICAgICAgKiB0YWcgLSB3ZSB3aWxsIG5vdCBsb29rIGZvciBjb250aW51dGF0aW9uIGFmdGVyIHRo
aXMgbGluZS4KICAgICAgKi8KLSAgICBpZiAoIXN0cm5jYXNlY21wKGJ1ZmZlciwgIkJvZHk6Iiwg
NSkpCisgICAgaWYgKCFhcF9jYXNlY21wc3RybihidWZmZXIsICJCb2R5OiIsIDUpKQogICAgICAg
ICByZXR1cm4gaGVhZGVyX3NlZW47CiAKICAgICB3aGlsZSAoYXByX2ZpbGVfZ2V0YygmYywgbWFw
KSAhPSBBUFJfRU9GKSB7CkluZGV4OiBtb2R1bGVzL21hcHBlcnMvbW9kX3Jld3JpdGUuYwo9PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09Ci0tLSBtb2R1bGVzL21hcHBlcnMvbW9kX3Jld3JpdGUuYwkocmV2aXNpb24gMTcyMjE0
MykKKysrIG1vZHVsZXMvbWFwcGVycy9tb2RfcmV3cml0ZS5jCSh3b3JraW5nIGNvcHkpCkBAIC01
MTcsNyArNTE3LDcgQEAgc3RhdGljIHVuc2lnbmVkIGlzX2Fic29sdXRlX3VyaShjaGFyICp1cmks
IGludCAqc3UKICAgICBzd2l0Y2ggKCp1cmkrKykgewogICAgIGNhc2UgJ2EnOgogICAgIGNhc2Ug
J0EnOgotICAgICAgICBpZiAoIXN0cm5jYXNlY21wKHVyaSwgImpwOi8vIiwgNSkpIHsgICAgICAg
IC8qIGFqcDovLyAgICAqLworICAgICAgICBpZiAoIWFwX2Nhc2VjbXBzdHJuKHVyaSwgImpwOi8v
IiwgNSkpIHsgICAgICAgIC8qIGFqcDovLyAgICAqLwogICAgICAgICAgICpzcXMgPSAxOwogICAg
ICAgICAgIHJldHVybiA2OwogICAgICAgICB9CkBAIC01MjUsNyArNTI1LDcgQEAgc3RhdGljIHVu
c2lnbmVkIGlzX2Fic29sdXRlX3VyaShjaGFyICp1cmksIGludCAqc3UKIAogICAgIGNhc2UgJ2In
OgogICAgIGNhc2UgJ0InOgotICAgICAgICBpZiAoIXN0cm5jYXNlY21wKHVyaSwgImFsYW5jZXI6
Ly8iLCAxMCkpIHsgICAvKiBiYWxhbmNlcjovLyAqLworICAgICAgICBpZiAoIWFwX2Nhc2VjbXBz
dHJuKHVyaSwgImFsYW5jZXI6Ly8iLCAxMCkpIHsgICAvKiBiYWxhbmNlcjovLyAqLwogICAgICAg
ICAgICpzcXMgPSAxOwogICAgICAgICAgIHJldHVybiAxMTsKICAgICAgICAgfQpAQCAtNTMzLDEw
ICs1MzMsMTAgQEAgc3RhdGljIHVuc2lnbmVkIGlzX2Fic29sdXRlX3VyaShjaGFyICp1cmksIGlu
dCAqc3UKIAogICAgIGNhc2UgJ2YnOgogICAgIGNhc2UgJ0YnOgotICAgICAgICBpZiAoIXN0cm5j
YXNlY21wKHVyaSwgInRwOi8vIiwgNSkpIHsgICAgICAgIC8qIGZ0cDovLyAgICAqLworICAgICAg
ICBpZiAoIWFwX2Nhc2VjbXBzdHJuKHVyaSwgInRwOi8vIiwgNSkpIHsgICAgICAgIC8qIGZ0cDov
LyAgICAqLwogICAgICAgICAgICAgcmV0dXJuIDY7CiAgICAgICAgIH0KLSAgICAgICAgaWYgKCFz
dHJuY2FzZWNtcCh1cmksICJjZ2k6Ly8iLCA2KSkgeyAgICAgICAvKiBmY2dpOi8vICAgKi8KKyAg
ICAgICAgaWYgKCFhcF9jYXNlY21wc3Rybih1cmksICJjZ2k6Ly8iLCA2KSkgeyAgICAgICAvKiBm
Y2dpOi8vICAgKi8KICAgICAgICAgICAgICpzcXMgPSAxOwogICAgICAgICAgICAgcmV0dXJuIDc7
CiAgICAgICAgIH0KQEAgLTU0NCw3ICs1NDQsNyBAQCBzdGF0aWMgdW5zaWduZWQgaXNfYWJzb2x1
dGVfdXJpKGNoYXIgKnVyaSwgaW50ICpzdQogCiAgICAgY2FzZSAnZyc6CiAgICAgY2FzZSAnRyc6
Ci0gICAgICAgIGlmICghc3RybmNhc2VjbXAodXJpLCAib3BoZXI6Ly8iLCA4KSkgeyAgICAgLyog
Z29waGVyOi8vICovCisgICAgICAgIGlmICghYXBfY2FzZWNtcHN0cm4odXJpLCAib3BoZXI6Ly8i
LCA4KSkgeyAgICAgLyogZ29waGVyOi8vICovCiAgICAgICAgICAgICByZXR1cm4gOTsKICAgICAg
ICAgfQogICAgICAgICBicmVhazsKQEAgLTU1MSwxMSArNTUxLDExIEBAIHN0YXRpYyB1bnNpZ25l
ZCBpc19hYnNvbHV0ZV91cmkoY2hhciAqdXJpLCBpbnQgKnN1CiAKICAgICBjYXNlICdoJzoKICAg
ICBjYXNlICdIJzoKLSAgICAgICAgaWYgKCFzdHJuY2FzZWNtcCh1cmksICJ0dHA6Ly8iLCA2KSkg
eyAgICAgICAvKiBodHRwOi8vICAgKi8KKyAgICAgICAgaWYgKCFhcF9jYXNlY21wc3Rybih1cmks
ICJ0dHA6Ly8iLCA2KSkgeyAgICAgICAvKiBodHRwOi8vICAgKi8KICAgICAgICAgICAgICpzcXMg
PSAxOwogICAgICAgICAgICAgcmV0dXJuIDc7CiAgICAgICAgIH0KLSAgICAgICAgZWxzZSBpZiAo
IXN0cm5jYXNlY21wKHVyaSwgInR0cHM6Ly8iLCA3KSkgeyAvKiBodHRwczovLyAgKi8KKyAgICAg
ICAgZWxzZSBpZiAoIWFwX2Nhc2VjbXBzdHJuKHVyaSwgInR0cHM6Ly8iLCA3KSkgeyAvKiBodHRw
czovLyAgKi8KICAgICAgICAgICAgICpzcXMgPSAxOwogICAgICAgICAgICAgcmV0dXJuIDg7CiAg
ICAgICAgIH0KQEAgLTU2Myw3ICs1NjMsNyBAQCBzdGF0aWMgdW5zaWduZWQgaXNfYWJzb2x1dGVf
dXJpKGNoYXIgKnVyaSwgaW50ICpzdQogCiAgICAgY2FzZSAnbCc6CiAgICAgY2FzZSAnTCc6Ci0g
ICAgICAgIGlmICghc3RybmNhc2VjbXAodXJpLCAiZGFwOi8vIiwgNikpIHsgICAgICAgLyogbGRh
cDovLyAgICovCisgICAgICAgIGlmICghYXBfY2FzZWNtcHN0cm4odXJpLCAiZGFwOi8vIiwgNikp
IHsgICAgICAgLyogbGRhcDovLyAgICovCiAgICAgICAgICAgICByZXR1cm4gNzsKICAgICAgICAg
fQogICAgICAgICBicmVhazsKQEAgLTU3MCw3ICs1NzAsNyBAQCBzdGF0aWMgdW5zaWduZWQgaXNf
YWJzb2x1dGVfdXJpKGNoYXIgKnVyaSwgaW50ICpzdQogCiAgICAgY2FzZSAnbSc6CiAgICAgY2Fz
ZSAnTSc6Ci0gICAgICAgIGlmICghc3RybmNhc2VjbXAodXJpLCAiYWlsdG86IiwgNikpIHsgICAg
ICAgLyogbWFpbHRvOiAgICovCisgICAgICAgIGlmICghYXBfY2FzZWNtcHN0cm4odXJpLCAiYWls
dG86IiwgNikpIHsgICAgICAgLyogbWFpbHRvOiAgICovCiAgICAgICAgICAgICAqc3FzID0gMTsK
ICAgICAgICAgICAgIHJldHVybiA3OwogICAgICAgICB9CkBAIC01NzgsMTAgKzU3OCwxMCBAQCBz
dGF0aWMgdW5zaWduZWQgaXNfYWJzb2x1dGVfdXJpKGNoYXIgKnVyaSwgaW50ICpzdQogCiAgICAg
Y2FzZSAnbic6CiAgICAgY2FzZSAnTic6Ci0gICAgICAgIGlmICghc3RybmNhc2VjbXAodXJpLCAi
ZXdzOiIsIDQpKSB7ICAgICAgICAgLyogbmV3czogICAgICovCisgICAgICAgIGlmICghYXBfY2Fz
ZWNtcHN0cm4odXJpLCAiZXdzOiIsIDQpKSB7ICAgICAgICAgLyogbmV3czogICAgICovCiAgICAg
ICAgICAgICByZXR1cm4gNTsKICAgICAgICAgfQotICAgICAgICBlbHNlIGlmICghc3RybmNhc2Vj
bXAodXJpLCAibnRwOi8vIiwgNikpIHsgIC8qIG5udHA6Ly8gICAqLworICAgICAgICBlbHNlIGlm
ICghYXBfY2FzZWNtcHN0cm4odXJpLCAibnRwOi8vIiwgNikpIHsgIC8qIG5udHA6Ly8gICAqLwog
ICAgICAgICAgICAgcmV0dXJuIDc7CiAgICAgICAgIH0KICAgICAgICAgYnJlYWs7CkBAIC01ODgs
NyArNTg4LDcgQEAgc3RhdGljIHVuc2lnbmVkIGlzX2Fic29sdXRlX3VyaShjaGFyICp1cmksIGlu
dCAqc3UKIAogICAgIGNhc2UgJ3MnOgogICAgIGNhc2UgJ1MnOgotICAgICAgICBpZiAoIXN0cm5j
YXNlY21wKHVyaSwgImNnaTovLyIsIDYpKSB7ICAgICAgIC8qIHNjZ2k6Ly8gICAqLworICAgICAg
ICBpZiAoIWFwX2Nhc2VjbXBzdHJuKHVyaSwgImNnaTovLyIsIDYpKSB7ICAgICAgIC8qIHNjZ2k6
Ly8gICAqLwogICAgICAgICAgICAgKnNxcyA9IDE7CiAgICAgICAgICAgICByZXR1cm4gNzsKICAg
ICAgICAgfQpAQCAtNTk2LDExICs1OTYsMTEgQEAgc3RhdGljIHVuc2lnbmVkIGlzX2Fic29sdXRl
X3VyaShjaGFyICp1cmksIGludCAqc3UKIAogICAgIGNhc2UgJ3cnOgogICAgIGNhc2UgJ1cnOgot
ICAgICAgICBpZiAoIXN0cm5jYXNlY21wKHVyaSwgInM6Ly8iLCA0KSkgeyAgICAgICAgLyogd3M6
Ly8gICAgICovCisgICAgICAgIGlmICghYXBfY2FzZWNtcHN0cm4odXJpLCAiczovLyIsIDQpKSB7
ICAgICAgICAvKiB3czovLyAgICAgKi8KICAgICAgICAgICAgICpzcXMgPSAxOwogICAgICAgICAg
ICAgcmV0dXJuIDU7CiAgICAgICAgIH0KLSAgICAgICAgZWxzZSBpZiAoIXN0cm5jYXNlY21wKHVy
aSwgInNzOi8vIiwgNSkpIHsgIC8qIHdzczovLyAgICAqLworICAgICAgICBlbHNlIGlmICghYXBf
Y2FzZWNtcHN0cm4odXJpLCAic3M6Ly8iLCA1KSkgeyAgLyogd3NzOi8vICAgICovCiAgICAgICAg
ICAgICAqc3FzID0gMTsKICAgICAgICAgICAgIHJldHVybiA2OwogICAgICAgICB9CkBAIC02ODgs
NyArNjg4LDcgQEAgc3RhdGljIGNoYXIgKmVzY2FwZV9hYnNvbHV0ZV91cmkoYXByX3Bvb2xfdCAq
cCwgY2gKICAgICAgICAgICogICAgICAgICAgICAgICBbZG4gWyI/IiBbYXR0cmlidXRlc10gWyI/
IiBbc2NvcGVdCiAgICAgICAgICAqICAgICAgICAgICAgICAgWyI/IiBbZmlsdGVyXSBbIj8iIGV4
dGVuc2lvbnNdXV1dXV0KICAgICAgICAgICovCi0gICAgICAgIGlmICghc3RybmNhc2VjbXAodXJp
LCAibGRhcCIsIDQpKSB7CisgICAgICAgIGlmICghYXBfY2FzZWNtcHN0cm4odXJpLCAibGRhcCIs
IDQpKSB7CiAgICAgICAgICAgICBjaGFyICp0b2tlbls1XTsKICAgICAgICAgICAgIGludCBjID0g
MDsKIApAQCAtNzgzLDcgKzc4Myw3IEBAIHN0YXRpYyB2b2lkIHJlZHVjZV91cmkocmVxdWVzdF9y
ZWMgKnIpCiAgICAgY3AgPSAoY2hhciAqKWFwX2h0dHBfc2NoZW1lKHIpOwogICAgIGwgID0gc3Ry
bGVuKGNwKTsKICAgICBpZiAoICAgc3RybGVuKHItPmZpbGVuYW1lKSA+IGwrMwotICAgICAgICAm
JiBzdHJuY2FzZWNtcChyLT5maWxlbmFtZSwgY3AsIGwpID09IDAKKyAgICAgICAgJiYgYXBfY2Fz
ZWNtcHN0cm4oci0+ZmlsZW5hbWUsIGNwLCBsKSA9PSAwCiAgICAgICAgICYmIHItPmZpbGVuYW1l
W2xdICAgPT0gJzonCiAgICAgICAgICYmIHItPmZpbGVuYW1lW2wrMV0gPT0gJy8nCiAgICAgICAg
ICYmIHItPmZpbGVuYW1lW2wrMl0gPT0gJy8nICkgewpAQCAtMjU0MywxNCArMjU0MywxNCBAQCBz
dGF0aWMgdm9pZCBhZGRfY29va2llKHJlcXVlc3RfcmVjICpyLCBjaGFyICpzKQogICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgOiBOVUxMLAogICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgZXhwaXJlcyA/IChleHBfdGltZSA/IGV4cF90aW1lIDogIiIpCiAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICA6IE5VTEwsCi0gICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAoc2VjdXJlICYmICghc3RyY2FzZWNtcChzZWN1cmUsICJ0cnVlIikKKyAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIChzZWN1cmUgJiYgKCFhcF9jYXNlY21wc3RyKHNlY3Vy
ZSwgInRydWUiKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
fHwgIXN0cmNtcChzZWN1cmUsICIxIikKLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIHx8ICFzdHJjYXNlY21wKHNlY3VyZSwKKyAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIHx8ICFhcF9jYXNlY21wc3RyKHNlY3VyZSwKICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJz
ZWN1cmUiKSkpID8KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiOyBzZWN1cmUi
IDogTlVMTCwKLSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIChodHRwb25seSAmJiAo
IXN0cmNhc2VjbXAoaHR0cG9ubHksICJ0cnVlIikKKyAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgIChodHRwb25seSAmJiAoIWFwX2Nhc2VjbXBzdHIoaHR0cG9ubHksICJ0cnVlIikKICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfHwgIXN0cmNtcCho
dHRwb25seSwgIjEiKQotICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICB8fCAhc3RyY2FzZWNtcChodHRwb25seSwKKyAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgfHwgIWFwX2Nhc2VjbXBzdHIoaHR0cG9ubHksCiAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJI
dHRwT25seSIpKSkgPwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICI7IEh0dHBP
bmx5IiA6IE5VTEwsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBOVUxMKTsKSW5k
ZXg6IG1vZHVsZXMvbWFwcGVycy9tb2Rfdmhvc3RfYWxpYXMuYwo9PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09Ci0tLSBtb2R1
bGVzL21hcHBlcnMvbW9kX3Zob3N0X2FsaWFzLmMJKHJldmlzaW9uIDE3MjIxNDMpCisrKyBtb2R1
bGVzL21hcHBlcnMvbW9kX3Zob3N0X2FsaWFzLmMJKHdvcmtpbmcgY29weSkKQEAgLTE1Miw3ICsx
NTIsNyBAQCBzdGF0aWMgY29uc3QgY2hhciAqdmhvc3RfYWxpYXNfc2V0KGNtZF9wYXJtcyAqY21k
LAogICAgIH0KIAogICAgIGlmICghYXBfb3NfaXNfcGF0aF9hYnNvbHV0ZShjbWQtPnBvb2wsIG1h
cCkpIHsKLSAgICAgICAgaWYgKHN0cmNhc2VjbXAobWFwLCAibm9uZSIpKSB7CisgICAgICAgIGlm
IChhcF9jYXNlY21wc3RyKG1hcCwgIm5vbmUiKSkgewogICAgICAgICAgICAgcmV0dXJuICJmb3Jt
YXQgc3RyaW5nIG11c3QgYmUgYW4gYWJzb2x1dGUgcGF0aCwgb3IgJ25vbmUnIjsKICAgICAgICAg
fQogICAgICAgICAqcG1hcCA9IE5VTEw7CkluZGV4OiBtb2R1bGVzL21ldGFkYXRhL21vZF9jZXJu
X21ldGEuYwo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09Ci0tLSBtb2R1bGVzL21ldGFkYXRhL21vZF9jZXJuX21ldGEuYwko
cmV2aXNpb24gMTcyMjE0MykKKysrIG1vZHVsZXMvbWV0YWRhdGEvbW9kX2Nlcm5fbWV0YS5jCSh3
b3JraW5nIGNvcHkpCkBAIC0yNDAsNyArMjQwLDcgQEAgc3RhdGljIGludCBzY2FuX21ldGFfZmls
ZShyZXF1ZXN0X3JlYyAqciwgYXByX2ZpbGUKICAgICAgICAgd2hpbGUgKGFwcl9pc3NwYWNlKCps
KSkKICAgICAgICAgICAgICsrbDsKIAotICAgICAgICBpZiAoIXN0cmNhc2VjbXAodywgIkNvbnRl
bnQtdHlwZSIpKSB7CisgICAgICAgIGlmICghYXBfY2FzZWNtcHN0cih3LCAiQ29udGVudC10eXBl
IikpIHsKICAgICAgICAgICAgIGNoYXIgKnRtcDsKICAgICAgICAgICAgIC8qIE51a2UgdHJhaWxp
bmcgd2hpdGVzcGFjZSAqLwogCkBAIC0yNTIsNyArMjUyLDcgQEAgc3RhdGljIGludCBzY2FuX21l
dGFfZmlsZShyZXF1ZXN0X3JlYyAqciwgYXByX2ZpbGUKICAgICAgICAgICAgIGFwX2NvbnRlbnRf
dHlwZV90b2xvd2VyKHRtcCk7CiAgICAgICAgICAgICBhcF9zZXRfY29udGVudF90eXBlKHIsIHRt
cCk7CiAgICAgICAgIH0KLSAgICAgICAgZWxzZSBpZiAoIXN0cmNhc2VjbXAodywgIlN0YXR1cyIp
KSB7CisgICAgICAgIGVsc2UgaWYgKCFhcF9jYXNlY21wc3RyKHcsICJTdGF0dXMiKSkgewogICAg
ICAgICAgICAgc3NjYW5mKGwsICIlZCIsICZyLT5zdGF0dXMpOwogICAgICAgICAgICAgci0+c3Rh
dHVzX2xpbmUgPSBhcHJfcHN0cmR1cChyLT5wb29sLCBsKTsKICAgICAgICAgfQpJbmRleDogbW9k
dWxlcy9tZXRhZGF0YS9tb2RfaGVhZGVycy5jCj09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KLS0tIG1vZHVsZXMvbWV0YWRh
dGEvbW9kX2hlYWRlcnMuYwkocmV2aXNpb24gMTcyMjE0MykKKysrIG1vZHVsZXMvbWV0YWRhdGEv
bW9kX2hlYWRlcnMuYwkod29ya2luZyBjb3B5KQpAQCAtNzg5LDcgKzc4OSw3IEBAIHN0YXRpYyBp
bnQgZG9faGVhZGVyc19maXh1cChyZXF1ZXN0X3JlYyAqciwgYXByX3RhCiAgICAgICAgICAgICB9
CiAgICAgICAgICAgICBicmVhazsKICAgICAgICAgY2FzZSBoZHJfc2V0OgotICAgICAgICAgICAg
aWYgKCFzdHJjYXNlY21wKGhkci0+aGVhZGVyLCAiQ29udGVudC1UeXBlIikpIHsKKyAgICAgICAg
ICAgIGlmICghYXBfY2FzZWNtcHN0cihoZHItPmhlYWRlciwgIkNvbnRlbnQtVHlwZSIpKSB7CiAg
ICAgICAgICAgICAgICAgIGFwX3NldF9jb250ZW50X3R5cGUociwgcHJvY2Vzc190YWdzKGhkciwg
cikpOwogICAgICAgICAgICAgfQogICAgICAgICAgICAgYXByX3RhYmxlX3NldG4oaGVhZGVycywg
aGRyLT5oZWFkZXIsIHByb2Nlc3NfdGFncyhoZHIsIHIpKTsKQEAgLTc5Niw3ICs3OTYsNyBAQCBz
dGF0aWMgaW50IGRvX2hlYWRlcnNfZml4dXAocmVxdWVzdF9yZWMgKnIsIGFwcl90YQogICAgICAg
ICAgICAgYnJlYWs7CiAgICAgICAgIGNhc2UgaGRyX3NldGlmZW1wdHk6CiAgICAgICAgICAgICBp
ZiAoTlVMTCA9PSBhcHJfdGFibGVfZ2V0KGhlYWRlcnMsIGhkci0+aGVhZGVyKSkgewotICAgICAg
ICAgICAgICAgIGlmICghc3RyY2FzZWNtcChoZHItPmhlYWRlciwgIkNvbnRlbnQtVHlwZSIpKSB7
CisgICAgICAgICAgICAgICAgaWYgKCFhcF9jYXNlY21wc3RyKGhkci0+aGVhZGVyLCAiQ29udGVu
dC1UeXBlIikpIHsKICAgICAgICAgICAgICAgICAgICAgYXBfc2V0X2NvbnRlbnRfdHlwZShyLCBw
cm9jZXNzX3RhZ3MoaGRyLCByKSk7CiAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAg
IGFwcl90YWJsZV9zZXRuKGhlYWRlcnMsIGhkci0+aGVhZGVyLCBwcm9jZXNzX3RhZ3MoaGRyLCBy
KSk7CkBAIC04MTMsNyArODEzLDcgQEAgc3RhdGljIGludCBkb19oZWFkZXJzX2ZpeHVwKHJlcXVl
c3RfcmVjICpyLCBhcHJfdGEKICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICBjYXNlIGhkcl9l
ZGl0OgogICAgICAgICBjYXNlIGhkcl9lZGl0X3I6Ci0gICAgICAgICAgICBpZiAoIXN0cmNhc2Vj
bXAoaGRyLT5oZWFkZXIsICJDb250ZW50LVR5cGUiKSAmJiByLT5jb250ZW50X3R5cGUpIHsKKyAg
ICAgICAgICAgIGlmICghYXBfY2FzZWNtcHN0cihoZHItPmhlYWRlciwgIkNvbnRlbnQtVHlwZSIp
ICYmIHItPmNvbnRlbnRfdHlwZSkgewogICAgICAgICAgICAgICAgIGNvbnN0IGNoYXIgKnJlcGwg
PSBwcm9jZXNzX3JlZ2V4cChoZHIsIHItPmNvbnRlbnRfdHlwZSwgcik7CiAgICAgICAgICAgICAg
ICAgaWYgKHJlcGwgPT0gTlVMTCkKICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIDA7CkluZGV4
OiBtb2R1bGVzL3Byb3h5L2FqcF9oZWFkZXIuYwo9PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09Ci0tLSBtb2R1bGVzL3Byb3h5
L2FqcF9oZWFkZXIuYwkocmV2aXNpb24gMTcyMjE0MykKKysrIG1vZHVsZXMvcHJveHkvYWpwX2hl
YWRlci5jCSh3b3JraW5nIGNvcHkpCkBAIC02MzMsMTUgKzYzMywxNSBAQCBzdGF0aWMgYXByX3N0
YXR1c190IGFqcF91bm1hcnNoYWxfcmVzcG9uc2UoYWpwX21zZwogICAgICAgICB9CiAKICAgICAg
ICAgLyogU2V0LUNvb2tpZSBuZWVkIGFkZGl0aW9uYWwgcHJvY2Vzc2luZyAqLwotICAgICAgICBp
ZiAoIXN0cmNhc2VjbXAoc3RyaW5nbmFtZSwgIlNldC1Db29raWUiKSkgeworICAgICAgICBpZiAo
IWFwX2Nhc2VjbXBzdHIoc3RyaW5nbmFtZSwgIlNldC1Db29raWUiKSkgewogICAgICAgICAgICAg
dmFsdWUgPSBhcF9wcm94eV9jb29raWVfcmV2ZXJzZV9tYXAociwgZGNvbmYsIHZhbHVlKTsKICAg
ICAgICAgfQogICAgICAgICAvKiBMb2NhdGlvbiwgQ29udGVudC1Mb2NhdGlvbiwgVVJJIGFuZCBE
ZXN0aW5hdGlvbiBuZWVkIGFkZGl0aW9uYWwKICAgICAgICAgICogcHJvY2Vzc2luZyAqLwotICAg
ICAgICBlbHNlIGlmICghc3RyY2FzZWNtcChzdHJpbmduYW1lLCAiTG9jYXRpb24iKQotICAgICAg
ICAgICAgICAgICB8fCAhc3RyY2FzZWNtcChzdHJpbmduYW1lLCAiQ29udGVudC1Mb2NhdGlvbiIp
Ci0gICAgICAgICAgICAgICAgIHx8ICFzdHJjYXNlY21wKHN0cmluZ25hbWUsICJVUkkiKQotICAg
ICAgICAgICAgICAgICB8fCAhc3RyY2FzZWNtcChzdHJpbmduYW1lLCAiRGVzdGluYXRpb24iKSkK
KyAgICAgICAgZWxzZSBpZiAoIWFwX2Nhc2VjbXBzdHIoc3RyaW5nbmFtZSwgIkxvY2F0aW9uIikK
KyAgICAgICAgICAgICAgICAgfHwgIWFwX2Nhc2VjbXBzdHIoc3RyaW5nbmFtZSwgIkNvbnRlbnQt
TG9jYXRpb24iKQorICAgICAgICAgICAgICAgICB8fCAhYXBfY2FzZWNtcHN0cihzdHJpbmduYW1l
LCAiVVJJIikKKyAgICAgICAgICAgICAgICAgfHwgIWFwX2Nhc2VjbXBzdHIoc3RyaW5nbmFtZSwg
IkRlc3RpbmF0aW9uIikpCiAgICAgICAgIHsKICAgICAgICAgICB2YWx1ZSA9IGFwX3Byb3h5X2xv
Y2F0aW9uX3JldmVyc2VfbWFwKHIsIGRjb25mLCB2YWx1ZSk7CiAgICAgICAgIH0KQEAgLTY1NCw3
ICs2NTQsNyBAQCBzdGF0aWMgYXByX3N0YXR1c190IGFqcF91bm1hcnNoYWxfcmVzcG9uc2UoYWpw
X21zZwogICAgICAgICBhcHJfdGFibGVfYWRkKHItPmhlYWRlcnNfb3V0LCBzdHJpbmduYW1lLCB2
YWx1ZSk7CiAKICAgICAgICAgLyogQ29udGVudC10eXBlIG5lZWRzIGFuIGFkZGl0aW9uYWwgaGFu
ZGxpbmcgKi8KLSAgICAgICAgaWYgKHN0cmNhc2VjbXAoc3RyaW5nbmFtZSwgIkNvbnRlbnQtVHlw
ZSIpID09IDApIHsKKyAgICAgICAgaWYgKGFwX2Nhc2VjbXBzdHIoc3RyaW5nbmFtZSwgIkNvbnRl
bnQtVHlwZSIpID09IDApIHsKICAgICAgICAgICAgICAvKiBhZGQgY29ycmVzcG9uZGluZyBmaWx0
ZXIgKi8KICAgICAgICAgICAgIGFwX3NldF9jb250ZW50X3R5cGUociwgYXByX3BzdHJkdXAoci0+
cG9vbCwgdmFsdWUpKTsKICAgICAgICAgICAgIGFwX2xvZ19yZXJyb3IoQVBMT0dfTUFSSywgQVBM
T0dfVFJBQ0U1LCAwLCByLApJbmRleDogbW9kdWxlcy9wcm94eS9tb2RfcHJveHkuYwo9PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09Ci0tLSBtb2R1bGVzL3Byb3h5L21vZF9wcm94eS5jCShyZXZpc2lvbiAxNzIyMTQzKQorKysg
bW9kdWxlcy9wcm94eS9tb2RfcHJveHkuYwkod29ya2luZyBjb3B5KQpAQCAtNTEyLDcgKzUxMiw3
IEBAIHN0YXRpYyBpbnQgcHJveHlfZGV0ZWN0KHJlcXVlc3RfcmVjICpyKQogICAgIGlmIChjb25m
LT5yZXEgJiYgci0+cGFyc2VkX3VyaS5zY2hlbWUpIHsKICAgICAgICAgLyogYnV0IGl0IG1pZ2h0
IGJlIHNvbWV0aGluZyB2aG9zdGVkICovCiAgICAgICAgIGlmICghKHItPnBhcnNlZF91cmkuaG9z
dG5hbWUKLSAgICAgICAgICAgICAgJiYgIXN0cmNhc2VjbXAoci0+cGFyc2VkX3VyaS5zY2hlbWUs
IGFwX2h0dHBfc2NoZW1lKHIpKQorICAgICAgICAgICAgICAmJiAhYXBfY2FzZWNtcHN0cihyLT5w
YXJzZWRfdXJpLnNjaGVtZSwgYXBfaHR0cF9zY2hlbWUocikpCiAgICAgICAgICAgICAgICYmIGFw
X21hdGNoZXNfcmVxdWVzdF92aG9zdChyLCByLT5wYXJzZWRfdXJpLmhvc3RuYW1lLAogICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKGFwcl9wb3J0X3QpKHItPnBhcnNl
ZF91cmkucG9ydF9zdHIgPyByLT5wYXJzZWRfdXJpLnBvcnQKICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA6IGFwX2RlZmF1bHRfcG9ydChyKSkp
KSkgewpAQCAtODkxLDcgKzg5MSw3IEBAIHN0YXRpYyBpbnQgcHJveHlfbmVlZHNkb21haW4ocmVx
dWVzdF9yZWMgKnIsIGNvbnN0CiAgICAgLyogSWYgaG9zdCBkb2VzIGNvbnRhaW4gYSBkb3QgYWxy
ZWFkeSwgb3IgaXQgaXMgImxvY2FsaG9zdCIsIGRlY2xpbmUgKi8KICAgICBpZiAoc3RyY2hyKHIt
PnBhcnNlZF91cmkuaG9zdG5hbWUsICcuJykgIT0gTlVMTCAvKiBoYXMgZG9tYWluLCBvciBJUHY0
IGxpdGVyYWwgKi8KICAgICAgfHwgc3RyY2hyKHItPnBhcnNlZF91cmkuaG9zdG5hbWUsICc6Jykg
IT0gTlVMTCAvKiBJUHY2IGxpdGVyYWwgKi8KLSAgICAgfHwgc3RyY2FzZWNtcChyLT5wYXJzZWRf
dXJpLmhvc3RuYW1lLCAibG9jYWxob3N0IikgPT0gMCkKKyAgICAgfHwgYXBfY2FzZWNtcHN0cihy
LT5wYXJzZWRfdXJpLmhvc3RuYW1lLCAibG9jYWxob3N0IikgPT0gMCkKICAgICAgICAgcmV0dXJu
IERFQ0xJTkVEOyAgICAvKiBob3N0IG5hbWUgaGFzIGEgZG90IGFscmVhZHkgKi8KIAogICAgIHJl
ZiA9IGFwcl90YWJsZV9nZXQoci0+aGVhZGVyc19pbiwgIlJlZmVyZXIiKTsKQEAgLTEwOTcsOSAr
MTA5Nyw5IEBAIHN0YXRpYyBpbnQgcHJveHlfaGFuZGxlcihyZXF1ZXN0X3JlYyAqcikKICAgICAg
ICAgICAgICAgICBpZiAoc3RyY21wKGVudHNbaV0uc2NoZW1lLCAiKiIpID09IDAgfHwKICAgICAg
ICAgICAgICAgICAgICAgKGVudHNbaV0udXNlX3JlZ2V4ICYmCiAgICAgICAgICAgICAgICAgICAg
ICBhcF9yZWdleGVjKGVudHNbaV0ucmVnZXhwLCB1cmwsIDAsIE5VTEwsIDApID09IDApIHx8Ci0g
ICAgICAgICAgICAgICAgICAgIChwMiA9PSBOVUxMICYmIHN0cmNhc2VjbXAoc2NoZW1lLCBlbnRz
W2ldLnNjaGVtZSkgPT0gMCkgfHwKKyAgICAgICAgICAgICAgICAgICAgKHAyID09IE5VTEwgJiYg
YXBfY2FzZWNtcHN0cihzY2hlbWUsIGVudHNbaV0uc2NoZW1lKSA9PSAwKSB8fAogICAgICAgICAg
ICAgICAgICAgICAocDIgIT0gTlVMTCAmJgotICAgICAgICAgICAgICAgICAgICBzdHJuY2FzZWNt
cCh1cmwsIGVudHNbaV0uc2NoZW1lLAorICAgICAgICAgICAgICAgICAgICBhcF9jYXNlY21wc3Ry
bih1cmwsIGVudHNbaV0uc2NoZW1lLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBz
dHJsZW4oZW50c1tpXS5zY2hlbWUpKSA9PSAwKSkgewogCiAgICAgICAgICAgICAgICAgICAgIC8q
IGhhbmRsZSB0aGUgc2NoZW1lICovCkBAIC0xNDkwLDcgKzE0OTAsNyBAQCBQUk9YWV9ERUNMQVJF
KGNvbnN0IGNoYXIgKikgYXBfcHJveHlfZGVfc29ja2V0ZnkoYQogICAgICAqIFdlIGNvdWxkIGJl
IHBhc3NlZCBhIFVSTCBkdXJpbmcgdGhlIGNvbmZpZyBzdGFnZSB0aGF0IGNvbnRhaW5zCiAgICAg
ICogdGhlIFVEUyBwYXRoLi4uIGlnbm9yZSBpdAogICAgICAqLwotICAgIGlmICghc3RybmNhc2Vj
bXAodXJsLCAidW5peDoiLCA1KSAmJgorICAgIGlmICghYXBfY2FzZWNtcHN0cm4odXJsLCAidW5p
eDoiLCA1KSAmJgogICAgICAgICAoKHB0ciA9IGFwX3N0cmNocl9jKHVybCwgJ3wnKSkgIT0gTlVM
TCkpIHsKICAgICAgICAgLyogbW92ZSBwYXN0IHRoZSAndW5peDouLi58JyBVRFMgcGF0aCBpbmZv
ICovCiAgICAgICAgIGNvbnN0IGNoYXIgKnJldCwgKmM7CkluZGV4OiBtb2R1bGVzL3Byb3h5L21v
ZF9wcm94eV9hanAuYwo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09Ci0tLSBtb2R1bGVzL3Byb3h5L21vZF9wcm94eV9hanAu
YwkocmV2aXNpb24gMTcyMjE0MykKKysrIG1vZHVsZXMvcHJveHkvbW9kX3Byb3h5X2FqcC5jCSh3
b3JraW5nIGNvcHkpCkBAIC0zNSw3ICszNSw3IEBAIHN0YXRpYyBpbnQgcHJveHlfYWpwX2Nhbm9u
KHJlcXVlc3RfcmVjICpyLCBjaGFyICp1CiAgICAgYXByX3BvcnRfdCBwb3J0LCBkZWZfcG9ydDsK
IAogICAgIC8qIGFwX3BvcnRfb2Zfc2NoZW1lKCkgKi8KLSAgICBpZiAoc3RybmNhc2VjbXAodXJs
LCAiYWpwOiIsIDQpID09IDApIHsKKyAgICBpZiAoYXBfY2FzZWNtcHN0cm4odXJsLCAiYWpwOiIs
IDQpID09IDApIHsKICAgICAgICAgdXJsICs9IDQ7CiAgICAgfQogICAgIGVsc2UgewpAQCAtMjQ1
LDcgKzI0NSw3IEBAIHN0YXRpYyBpbnQgYXBfcHJveHlfYWpwX3JlcXVlc3QoYXByX3Bvb2xfdCAq
cCwgcmVxCiAgICAgLyogcmVhZCB0aGUgZmlyc3QgYmxvYyBvZiBkYXRhICovCiAgICAgaW5wdXRf
YnJpZ2FkZSA9IGFwcl9icmlnYWRlX2NyZWF0ZShwLCByLT5jb25uZWN0aW9uLT5idWNrZXRfYWxs
b2MpOwogICAgIHRlbmMgPSBhcHJfdGFibGVfZ2V0KHItPmhlYWRlcnNfaW4sICJUcmFuc2Zlci1F
bmNvZGluZyIpOwotICAgIGlmICh0ZW5jICYmIChzdHJjYXNlY21wKHRlbmMsICJjaHVua2VkIikg
PT0gMCkpIHsKKyAgICBpZiAodGVuYyAmJiAoYXBfY2FzZWNtcHN0cih0ZW5jLCAiY2h1bmtlZCIp
ID09IDApKSB7CiAgICAgICAgIC8qIFRoZSBBSlAgcHJvdG9jb2wgZG9lcyBub3Qgd2FudCBib2R5
IGRhdGEgeWV0ICovCiAgICAgICAgIGFwX2xvZ19yZXJyb3IoQVBMT0dfTUFSSywgQVBMT0dfREVC
VUcsIDAsIHIsIEFQTE9HTk8oMDA4NzApICJyZXF1ZXN0IGlzIGNodW5rZWQiKTsKICAgICB9IGVs
c2UgewpAQCAtNzM0LDcgKzczNCw3IEBAIHN0YXRpYyBpbnQgcHJveHlfYWpwX2hhbmRsZXIocmVx
dWVzdF9yZWMgKnIsIHByb3h5CiAgICAgYXByX3Bvb2xfdCAqcCA9IHItPnBvb2w7CiAgICAgYXBy
X3VyaV90ICp1cmk7CiAKLSAgICBpZiAoc3RybmNhc2VjbXAodXJsLCAiYWpwOiIsIDQpICE9IDAp
IHsKKyAgICBpZiAoYXBfY2FzZWNtcHN0cm4odXJsLCAiYWpwOiIsIDQpICE9IDApIHsKICAgICAg
ICAgYXBfbG9nX3JlcnJvcihBUExPR19NQVJLLCBBUExPR19ERUJVRywgMCwgciwgQVBMT0dOTygw
MDg5NCkgImRlY2xpbmluZyBVUkwgJXMiLCB1cmwpOwogICAgICAgICByZXR1cm4gREVDTElORUQ7
CiAgICAgfQpJbmRleDogbW9kdWxlcy9wcm94eS9tb2RfcHJveHlfYmFsYW5jZXIuYwo9PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09Ci0tLSBtb2R1bGVzL3Byb3h5L21vZF9wcm94eV9iYWxhbmNlci5jCShyZXZpc2lvbiAxNzIy
MTQzKQorKysgbW9kdWxlcy9wcm94eS9tb2RfcHJveHlfYmFsYW5jZXIuYwkod29ya2luZyBjb3B5
KQpAQCAtNjMsNyArNjMsNyBAQCBzdGF0aWMgaW50IHByb3h5X2JhbGFuY2VyX2Nhbm9uKHJlcXVl
c3RfcmVjICpyLCBjaAogICAgIGFwcl9wb3J0X3QgcG9ydCA9IDA7CiAKICAgICAvKiBUT0RPOiBv
ZmZzZXQgb2YgQkFMQU5DRVJfUFJFRklYID8/ICovCi0gICAgaWYgKHN0cm5jYXNlY21wKHVybCwg
ImJhbGFuY2VyOiIsIDkpID09IDApIHsKKyAgICBpZiAoYXBfY2FzZWNtcHN0cm4odXJsLCAiYmFs
YW5jZXI6IiwgOSkgPT0gMCkgewogICAgICAgICB1cmwgKz0gOTsKICAgICB9CiAgICAgZWxzZSB7
CkBAIC0xMzc4LDcgKzEzNzgsNyBAQCBzdGF0aWMgaW50IGJhbGFuY2VyX2hhbmRsZXIocmVxdWVz
dF9yZWMgKnIpCiAgICAgICAgICAgICAgICAgYXBfcnByaW50ZihyLCAiICAgICAgICAgIDxodHRw
ZDpsYnNldD4lZDwvaHR0cGQ6bGJzZXQ+XG4iLAogICAgICAgICAgICAgICAgICAgICAgICAgICAg
d29ya2VyLT5zLT5sYnNldCk7CiAgICAgICAgICAgICAgICAgLyogRW5kIHByb3h5X3dvcmtlcl9z
dGF0ICovCi0gICAgICAgICAgICAgICAgaWYgKCFzdHJjYXNlY21wKHdvcmtlci0+cy0+c2NoZW1l
LCAiYWpwIikpIHsKKyAgICAgICAgICAgICAgICBpZiAoIWFwX2Nhc2VjbXBzdHIod29ya2VyLT5z
LT5zY2hlbWUsICJhanAiKSkgewogICAgICAgICAgICAgICAgICAgICBhcF9ycHV0cygiICAgICAg
ICAgIDxodHRwZDpmbHVzaHBhY2tldHM+Iiwgcik7CiAgICAgICAgICAgICAgICAgICAgIHN3aXRj
aCAod29ya2VyLT5zLT5mbHVzaF9wYWNrZXRzKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICBj
YXNlIGZsdXNoX29mZjoKSW5kZXg6IG1vZHVsZXMvcHJveHkvbW9kX3Byb3h5X2ZjZ2kuYwo9PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09Ci0tLSBtb2R1bGVzL3Byb3h5L21vZF9wcm94eV9mY2dpLmMJKHJldmlzaW9uIDE3MjIx
NDMpCisrKyBtb2R1bGVzL3Byb3h5L21vZF9wcm94eV9mY2dpLmMJKHdvcmtpbmcgY29weSkKQEAg
LTM5LDcgKzM5LDcgQEAgc3RhdGljIGludCBwcm94eV9mY2dpX2Nhbm9uKHJlcXVlc3RfcmVjICpy
LCBjaGFyICoKICAgICBmY2dpX3JlcV9jb25maWdfdCAqcmNvbmYgPSBOVUxMOwogICAgIGNvbnN0
IGNoYXIgKnBhdGhpbmZvX3R5cGUgPSBOVUxMOwogCi0gICAgaWYgKHN0cm5jYXNlY21wKHVybCwg
ImZjZ2k6IiwgNSkgPT0gMCkgeworICAgIGlmIChhcF9jYXNlY21wc3Rybih1cmwsICJmY2dpOiIs
IDUpID09IDApIHsKICAgICAgICAgdXJsICs9IDU7CiAgICAgfQogICAgIGVsc2UgewpAQCAtODc4
LDcgKzg3OCw3IEBAIHN0YXRpYyBpbnQgcHJveHlfZmNnaV9oYW5kbGVyKHJlcXVlc3RfcmVjICpy
LCBwcm94CiAgICAgICAgICAgICAgICAgICAidXJsOiAlcyBwcm94eW5hbWU6ICVzIHByb3h5cG9y
dDogJWQiLAogICAgICAgICAgICAgICAgICB1cmwsIHByb3h5bmFtZSwgcHJveHlwb3J0KTsKIAot
ICAgIGlmIChzdHJuY2FzZWNtcCh1cmwsICJmY2dpOiIsIDUpICE9IDApIHsKKyAgICBpZiAoYXBf
Y2FzZWNtcHN0cm4odXJsLCAiZmNnaToiLCA1KSAhPSAwKSB7CiAgICAgICAgIGFwX2xvZ19yZXJy
b3IoQVBMT0dfTUFSSywgQVBMT0dfREVCVUcsIDAsIHIsIEFQTE9HTk8oMDEwNzcpICJkZWNsaW5p
bmcgVVJMICVzIiwgdXJsKTsKICAgICAgICAgcmV0dXJuIERFQ0xJTkVEOwogICAgIH0KSW5kZXg6
IG1vZHVsZXMvcHJveHkvbW9kX3Byb3h5X2ZkcGFzcy5jCj09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KLS0tIG1vZHVsZXMv
cHJveHkvbW9kX3Byb3h5X2ZkcGFzcy5jCShyZXZpc2lvbiAxNzIyMTQzKQorKysgbW9kdWxlcy9w
cm94eS9tb2RfcHJveHlfZmRwYXNzLmMJKHdvcmtpbmcgY29weSkKQEAgLTMyLDcgKzMyLDcgQEAg
c3RhdGljIGludCBwcm94eV9mZHBhc3NfY2Fub24ocmVxdWVzdF9yZWMgKnIsIGNoYXIKIHsKICAg
ICBjb25zdCBjaGFyICpwYXRoOwogCi0gICAgaWYgKHN0cm5jYXNlY21wKHVybCwgImZkOi8vIiwg
NSkgPT0gMCkgeworICAgIGlmIChhcF9jYXNlY21wc3Rybih1cmwsICJmZDovLyIsIDUpID09IDAp
IHsKICAgICAgICAgdXJsICs9IDU7CiAgICAgfQogICAgIGVsc2UgewpAQCAtMTI5LDcgKzEyOSw3
IEBAIHN0YXRpYyBpbnQgcHJveHlfZmRwYXNzX2hhbmRsZXIocmVxdWVzdF9yZWMgKnIsIHByCiAg
ICAgYXByX3NvY2tldF90ICpzb2NrOwogICAgIGFwcl9zb2NrZXRfdCAqY2xpZW50c29jazsKIAot
ICAgIGlmIChzdHJuY2FzZWNtcCh1cmwsICJmZDovLyIsIDUpID09IDApIHsKKyAgICBpZiAoYXBf
Y2FzZWNtcHN0cm4odXJsLCAiZmQ6Ly8iLCA1KSA9PSAwKSB7CiAgICAgICAgIHVybCArPSA1Owog
ICAgIH0KICAgICBlbHNlIHsKSW5kZXg6IG1vZHVsZXMvcHJveHkvbW9kX3Byb3h5X2Z0cC5jCj09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT0KLS0tIG1vZHVsZXMvcHJveHkvbW9kX3Byb3h5X2Z0cC5jCShyZXZpc2lvbiAxNzIy
MTQzKQorKysgbW9kdWxlcy9wcm94eS9tb2RfcHJveHlfZnRwLmMJKHdvcmtpbmcgY29weSkKQEAg
LTI5NCw3ICsyOTQsNyBAQCBzdGF0aWMgaW50IHByb3h5X2Z0cF9jYW5vbihyZXF1ZXN0X3JlYyAq
ciwgY2hhciAqdQogICAgIGFwcl9wb3J0X3QgcG9ydCwgZGVmX3BvcnQ7CiAKICAgICAvKiAqLwot
ICAgIGlmIChzdHJuY2FzZWNtcCh1cmwsICJmdHA6IiwgNCkgPT0gMCkgeworICAgIGlmIChhcF9j
YXNlY21wc3Rybih1cmwsICJmdHA6IiwgNCkgPT0gMCkgewogICAgICAgICB1cmwgKz0gNDsKICAg
ICB9CiAgICAgZWxzZSB7CkBAIC00OTQsNyArNDk0LDcgQEAgc3RhdGljIGFwcl9zdGF0dXNfdCBw
cm94eV9zZW5kX2Rpcl9maWx0ZXIoYXBfZmlsdGUKICAgICAgICAgcGF0aCA9IGFwcl91cmlfdW5w
YXJzZShwLCAmZi0+ci0+cGFyc2VkX3VyaSwgQVBSX1VSSV9VTlBfT01JVFNJVEVQQVJUIHwgQVBS
X1VSSV9VTlBfT01JVFFVRVJZKTsKIAogICAgICAgICAvKiBJZiBwYXRoIGJlZ2FuIHdpdGggLyUy
ZiwgY2hhbmdlIHRoZSBiYXNlZGlyICovCi0gICAgICAgIGlmIChzdHJuY2FzZWNtcChwYXRoLCAi
LyUyZiIsIDQpID09IDApIHsKKyAgICAgICAgaWYgKGFwX2Nhc2VjbXBzdHJuKHBhdGgsICIvJTJm
IiwgNCkgPT0gMCkgewogICAgICAgICAgICAgYmFzZWRpciA9ICIvJTJmIjsKICAgICAgICAgfQog
CkBAIC0xMDAzLDcgKzEwMDMsNyBAQCBzdGF0aWMgaW50IHByb3h5X2Z0cF9oYW5kbGVyKHJlcXVl
c3RfcmVjICpyLCBwcm94eQogICAgICAgICAgICAgICAgICAgICAgIHByb3h5aG9zdCk7CiAgICAg
ICAgIHJldHVybiBERUNMSU5FRDsgICAgICAgIC8qIHByb3h5IGNvbm5lY3Rpb25zIGFyZSB2aWEg
SFRUUCAqLwogICAgIH0KLSAgICBpZiAoc3RybmNhc2VjbXAodXJsLCAiZnRwOiIsIDQpKSB7Cisg
ICAgaWYgKGFwX2Nhc2VjbXBzdHJuKHVybCwgImZ0cDoiLCA0KSkgewogICAgICAgICBhcF9sb2df
cmVycm9yKEFQTE9HX01BUkssIEFQTE9HX1RSQUNFMywgMCwgciwKICAgICAgICAgICAgICAgICAg
ICAgICAiZGVjbGluaW5nIFVSTCAlcyAtIG5vdCBmdHA6IiwgdXJsKTsKICAgICAgICAgcmV0dXJu
IERFQ0xJTkVEOyAgICAgICAgLyogb25seSBpbnRlcmVzdGVkIGluIEZUUCAqLwpAQCAtMTA3NCw3
ICsxMDc0LDcgQEAgc3RhdGljIGludCBwcm94eV9mdHBfaGFuZGxlcihyZXF1ZXN0X3JlYyAqciwg
cHJveHkKICAgICAgKiBzdGlsbCBzbWFsbGVyIHRoYXQgdGhlIFVSTCBpcyBsb2dnZWQgcmVndWxh
cmx5LgogICAgICAqLwogICAgIGlmICgocGFzc3dvcmQgPSBhcHJfdGFibGVfZ2V0KHItPmhlYWRl
cnNfaW4sICJBdXRob3JpemF0aW9uIikpICE9IE5VTEwKLSAgICAgICAgJiYgc3RyY2FzZWNtcChh
cF9nZXR3b3JkKHItPnBvb2wsICZwYXNzd29yZCwgJyAnKSwgIkJhc2ljIikgPT0gMAorICAgICAg
ICAmJiBhcF9jYXNlY21wc3RyKGFwX2dldHdvcmQoci0+cG9vbCwgJnBhc3N3b3JkLCAnICcpLCAi
QmFzaWMiKSA9PSAwCiAgICAgICAgICYmIChwYXNzd29yZCA9IGFwX3BiYXNlNjRkZWNvZGUoci0+
cG9vbCwgcGFzc3dvcmQpKVswXSAhPSAnOicpIHsKICAgICAgICAgLyogQ2hlY2sgdGhlIGRlY29k
ZWQgc3RyaW5nIGZvciBzcGVjaWFsIGNoYXJhY3RlcnMuICovCiAgICAgICAgIGlmICghZnRwX2No
ZWNrX3N0cmluZyhwYXNzd29yZCkpIHsKQEAgLTEzMDYsNyArMTMwNiw3IEBAIHN0YXRpYyBpbnQg
cHJveHlfZnRwX2hhbmRsZXIocmVxdWVzdF9yZWMgKnIsIHByb3h5CiAgICAgLyogU3BlY2lhbCBo
YW5kbGluZyBmb3IgbGVhZGluZyAiJTJmIjogdGhpcyBlbmZvcmNlcyBhICJjd2QgLyIKICAgICAg
KiBvdXQgb2YgdGhlICRIT01FIGRpcmVjdG9yeSB3aGljaCB3YXMgdGhlIHN0YXJ0aW5nIHBvaW50
IGFmdGVyIGxvZ2luCiAgICAgICovCi0gICAgaWYgKHN0cm5jYXNlY21wKHBhdGgsICIlMmYiLCAz
KSA9PSAwKSB7CisgICAgaWYgKGFwX2Nhc2VjbXBzdHJuKHBhdGgsICIlMmYiLCAzKSA9PSAwKSB7
CiAgICAgICAgIHBhdGggKz0gMzsKICAgICAgICAgd2hpbGUgKCpwYXRoID09ICcvJykgLyogc2tp
cCBsZWFkaW5nICcvJyAoYWZ0ZXIgcm9vdCAlMmYpICovCiAgICAgICAgICAgICArK3BhdGg7Cklu
ZGV4OiBtb2R1bGVzL3Byb3h5L21vZF9wcm94eV9odHRwLmMKPT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQotLS0gbW9kdWxl
cy9wcm94eS9tb2RfcHJveHlfaHR0cC5jCShyZXZpc2lvbiAxNzIyMTQzKQorKysgbW9kdWxlcy9w
cm94eS9tb2RfcHJveHlfaHR0cC5jCSh3b3JraW5nIGNvcHkpCkBAIC00MywxMSArNDMsMTEgQEAg
c3RhdGljIGludCBwcm94eV9odHRwX2Nhbm9uKHJlcXVlc3RfcmVjICpyLCBjaGFyICoKICAgICBh
cHJfcG9ydF90IHBvcnQsIGRlZl9wb3J0OwogCiAgICAgLyogYXBfcG9ydF9vZl9zY2hlbWUoKSAq
LwotICAgIGlmIChzdHJuY2FzZWNtcCh1cmwsICJodHRwOiIsIDUpID09IDApIHsKKyAgICBpZiAo
YXBfY2FzZWNtcHN0cm4odXJsLCAiaHR0cDoiLCA1KSA9PSAwKSB7CiAgICAgICAgIHVybCArPSA1
OwogICAgICAgICBzY2hlbWUgPSAiaHR0cCI7CiAgICAgfQotICAgIGVsc2UgaWYgKHN0cm5jYXNl
Y21wKHVybCwgImh0dHBzOiIsIDYpID09IDApIHsKKyAgICBlbHNlIGlmIChhcF9jYXNlY21wc3Ry
bih1cmwsICJodHRwczoiLCA2KSA9PSAwKSB7CiAgICAgICAgIHVybCArPSA2OwogICAgICAgICBz
Y2hlbWUgPSAiaHR0cHMiOwogICAgIH0KQEAgLTc2NSw3ICs3NjUsNyBAQCBpbnQgYXBfcHJveHlf
aHR0cF9yZXF1ZXN0KGFwcl9wb29sX3QgKnAsIHJlcXVlc3RfcgogICAgICAqIGVuY29kaW5nIGhh
cyBiZWVuIGRvbmUgYnkgdGhlIGV4dGVuc2lvbnMnIGhhbmRsZXIsIGFuZAogICAgICAqIGRvIG5v
dCBtb2RpZnkgYWRkX3RlX2NodW5rZWQncyBsb2dpYwogICAgICAqLwotICAgIGlmIChvbGRfdGVf
dmFsICYmIHN0cmNhc2VjbXAob2xkX3RlX3ZhbCwgImNodW5rZWQiKSAhPSAwKSB7CisgICAgaWYg
KG9sZF90ZV92YWwgJiYgYXBfY2FzZWNtcHN0cihvbGRfdGVfdmFsLCAiY2h1bmtlZCIpICE9IDAp
IHsKICAgICAgICAgYXBfbG9nX3JlcnJvcihBUExPR19NQVJLLCBBUExPR19FUlIsIDAsIHIsIEFQ
TE9HTk8oMDEwOTMpCiAgICAgICAgICAgICAgICAgICAgICAgIiVzIFRyYW5zZmVyLUVuY29kaW5n
IGlzIG5vdCBzdXBwb3J0ZWQiLCBvbGRfdGVfdmFsKTsKICAgICAgICAgcmV0dXJuIEhUVFBfSU5U
RVJOQUxfU0VSVkVSX0VSUk9SOwpAQCAtMTA0Nyw3ICsxMDQ3LDcgQEAgc3RhdGljIHZvaWQgcHJv
Y2Vzc19wcm94eV9oZWFkZXIocmVxdWVzdF9yZWMgKnIsIHAKICAgICB9OwogICAgIGludCBpOwog
ICAgIGZvciAoaSA9IDA7IGRhdGVfaGRyc1tpXTsgKytpKSB7Ci0gICAgICAgIGlmICghc3RyY2Fz
ZWNtcChkYXRlX2hkcnNbaV0sIGtleSkpIHsKKyAgICAgICAgaWYgKCFhcF9jYXNlY21wc3RyKGRh
dGVfaGRyc1tpXSwga2V5KSkgewogICAgICAgICAgICAgYXByX3RhYmxlX2FkZChyLT5oZWFkZXJz
X291dCwga2V5LAogICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRlX2Nhbm9uKHItPnBvb2ws
IHZhbHVlKSk7CiAgICAgICAgICAgICByZXR1cm47CkBAIC0xMDU0LDcgKzEwNTQsNyBAQCBzdGF0
aWMgdm9pZCBwcm9jZXNzX3Byb3h5X2hlYWRlcihyZXF1ZXN0X3JlYyAqciwgcAogICAgICAgICB9
CiAgICAgfQogICAgIGZvciAoaSA9IDA7IHRyYW5zZm9ybV9oZHJzW2ldLm5hbWU7ICsraSkgewot
ICAgICAgICBpZiAoIXN0cmNhc2VjbXAodHJhbnNmb3JtX2hkcnNbaV0ubmFtZSwga2V5KSkgewor
ICAgICAgICBpZiAoIWFwX2Nhc2VjbXBzdHIodHJhbnNmb3JtX2hkcnNbaV0ubmFtZSwga2V5KSkg
ewogICAgICAgICAgICAgYXByX3RhYmxlX2FkZChyLT5oZWFkZXJzX291dCwga2V5LAogICAgICAg
ICAgICAgICAgICAgICAgICAgICAoKnRyYW5zZm9ybV9oZHJzW2ldLmZ1bmMpKHIsIGMsIHZhbHVl
KSk7CiAgICAgICAgICAgICByZXR1cm47CkluZGV4OiBtb2R1bGVzL3Byb3h5L21vZF9wcm94eV9z
Y2dpLmMKPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PQotLS0gbW9kdWxlcy9wcm94eS9tb2RfcHJveHlfc2NnaS5jCShyZXZp
c2lvbiAxNzIyMTQzKQorKysgbW9kdWxlcy9wcm94eS9tb2RfcHJveHlfc2NnaS5jCSh3b3JraW5n
IGNvcHkpCkBAIC0xODAsNyArMTgwLDcgQEAgc3RhdGljIGludCBzY2dpX2Nhbm9uKHJlcXVlc3Rf
cmVjICpyLCBjaGFyICp1cmwpCiAgICAgY29uc3QgY2hhciAqZXJyLCAqcGF0aDsKICAgICBhcHJf
cG9ydF90IHBvcnQsIGRlZl9wb3J0OwogCi0gICAgaWYgKHN0cm5jYXNlY21wKHVybCwgU0NIRU1F
ICI6Ly8iLCBzaXplb2YoU0NIRU1FKSArIDIpKSB7CisgICAgaWYgKGFwX2Nhc2VjbXBzdHJuKHVy
bCwgU0NIRU1FICI6Ly8iLCBzaXplb2YoU0NIRU1FKSArIDIpKSB7CiAgICAgICAgIHJldHVybiBE
RUNMSU5FRDsKICAgICB9CiAgICAgdXJsICs9IHNpemVvZihTQ0hFTUUpOyAvKiBLZWVwIHNsYXNo
ZXMgKi8KQEAgLTQzNCw3ICs0MzQsNyBAQCBzdGF0aWMgaW50IHBhc3NfcmVzcG9uc2UocmVxdWVz
dF9yZWMgKnIsIHByb3h5X2NvbgogICAgICAgICBpZiAobG9jYXRpb24gJiYgKmxvY2F0aW9uID09
ICcvJykgewogICAgICAgICAgICAgc2NnaV9yZXF1ZXN0X2NvbmZpZyAqcmVxX2NvbmYgPSBhcHJf
cGFsbG9jKHItPnBvb2wsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgc2l6ZW9mKCpyZXFfY29uZikpOwotICAgICAgICAgICAgaWYgKHN0cmNh
c2VjbXAobG9jYXRpb25faGVhZGVyLCAiTG9jYXRpb24iKSkgeworICAgICAgICAgICAgaWYgKGFw
X2Nhc2VjbXBzdHIobG9jYXRpb25faGVhZGVyLCAiTG9jYXRpb24iKSkgewogICAgICAgICAgICAg
ICAgIGlmIChlcnIpIHsKICAgICAgICAgICAgICAgICAgICAgYXByX3RhYmxlX3Vuc2V0KHItPmVy
cl9oZWFkZXJzX291dCwgbG9jYXRpb25faGVhZGVyKTsKICAgICAgICAgICAgICAgICB9CkBAIC01
MzMsNyArNTMzLDcgQEAgc3RhdGljIGludCBzY2dpX2hhbmRsZXIocmVxdWVzdF9yZWMgKnIsIHBy
b3h5X3dvcmsKICAgICBhcHJfdXJpX3QgKnVyaSA9IGFwcl9wYWxsb2Moci0+cG9vbCwgc2l6ZW9m
KCp1cmkpKTsKICAgICBjaGFyIGR1bW15OwogCi0gICAgaWYgKHN0cm5jYXNlY21wKHVybCwgU0NI
RU1FICI6Ly8iLCBzaXplb2YoU0NIRU1FKSArIDIpKSB7CisgICAgaWYgKGFwX2Nhc2VjbXBzdHJu
KHVybCwgU0NIRU1FICI6Ly8iLCBzaXplb2YoU0NIRU1FKSArIDIpKSB7CiAgICAgICAgIGFwX2xv
Z19yZXJyb3IoQVBMT0dfTUFSSywgQVBMT0dfREVCVUcsIDAsIHIsIEFQTE9HTk8oMDA4NjUpCiAg
ICAgICAgICAgICAgICAgICAgICAgImRlY2xpbmluZyBVUkwgJXMiLCB1cmwpOwogICAgICAgICBy
ZXR1cm4gREVDTElORUQ7CkluZGV4OiBtb2R1bGVzL3Byb3h5L21vZF9wcm94eV93c3R1bm5lbC5j
Cj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT0KLS0tIG1vZHVsZXMvcHJveHkvbW9kX3Byb3h5X3dzdHVubmVsLmMJKHJldmlz
aW9uIDE3MjIxNDMpCisrKyBtb2R1bGVzL3Byb3h5L21vZF9wcm94eV93c3R1bm5lbC5jCSh3b3Jr
aW5nIGNvcHkpCkBAIC0zMywxMiArMzMsMTIgQEAgc3RhdGljIGludCBwcm94eV93c3R1bm5lbF9j
YW5vbihyZXF1ZXN0X3JlYyAqciwgY2gKICAgICBhcHJfcG9ydF90IHBvcnQsIGRlZl9wb3J0Owog
CiAgICAgLyogYXBfcG9ydF9vZl9zY2hlbWUoKSAqLwotICAgIGlmIChzdHJuY2FzZWNtcCh1cmws
ICJ3czoiLCAzKSA9PSAwKSB7CisgICAgaWYgKGFwX2Nhc2VjbXBzdHJuKHVybCwgIndzOiIsIDMp
ID09IDApIHsKICAgICAgICAgdXJsICs9IDM7CiAgICAgICAgIHNjaGVtZSA9ICJ3czoiOwogICAg
ICAgICBkZWZfcG9ydCA9IGFwcl91cmlfcG9ydF9vZl9zY2hlbWUoImh0dHAiKTsKICAgICB9Ci0g
ICAgZWxzZSBpZiAoc3RybmNhc2VjbXAodXJsLCAid3NzOiIsIDQpID09IDApIHsKKyAgICBlbHNl
IGlmIChhcF9jYXNlY21wc3Rybih1cmwsICJ3c3M6IiwgNCkgPT0gMCkgewogICAgICAgICB1cmwg
Kz0gNDsKICAgICAgICAgc2NoZW1lID0gIndzczoiOwogICAgICAgICBkZWZfcG9ydCA9IGFwcl91
cmlfcG9ydF9vZl9zY2hlbWUoImh0dHBzIik7CkBAIC0zMjMsMTEgKzMyMywxMSBAQCBzdGF0aWMg
aW50IHByb3h5X3dzdHVubmVsX2hhbmRsZXIocmVxdWVzdF9yZWMgKnIsCiAgICAgYXByX3VyaV90
ICp1cmk7CiAgICAgaW50IGlzX3NzbCA9IDA7CiAKLSAgICBpZiAoc3RybmNhc2VjbXAodXJsLCAi
d3NzOiIsIDQpID09IDApIHsKKyAgICBpZiAoYXBfY2FzZWNtcHN0cm4odXJsLCAid3NzOiIsIDQp
ID09IDApIHsKICAgICAgICAgc2NoZW1lID0gIldTUyI7CiAgICAgICAgIGlzX3NzbCA9IDE7CiAg
ICAgfQotICAgIGVsc2UgaWYgKHN0cm5jYXNlY21wKHVybCwgIndzOiIsIDMpID09IDApIHsKKyAg
ICBlbHNlIGlmIChhcF9jYXNlY21wc3Rybih1cmwsICJ3czoiLCAzKSA9PSAwKSB7CiAgICAgICAg
IHNjaGVtZSA9ICJXUyI7CiAgICAgfQogICAgIGVsc2UgewpAQCAtMzM2LDcgKzMzNiw3IEBAIHN0
YXRpYyBpbnQgcHJveHlfd3N0dW5uZWxfaGFuZGxlcihyZXF1ZXN0X3JlYyAqciwKICAgICB9CiAK
ICAgICB1cGdyYWRlID0gYXByX3RhYmxlX2dldChyLT5oZWFkZXJzX2luLCAiVXBncmFkZSIpOwot
ICAgIGlmICghdXBncmFkZSB8fCBzdHJjYXNlY21wKHVwZ3JhZGUsICJXZWJTb2NrZXQiKSAhPSAw
KSB7CisgICAgaWYgKCF1cGdyYWRlIHx8IGFwX2Nhc2VjbXBzdHIodXBncmFkZSwgIldlYlNvY2tl
dCIpICE9IDApIHsKICAgICAgICAgYXBfbG9nX3JlcnJvcihBUExPR19NQVJLLCBBUExPR19ERUJV
RywgMCwgciwgQVBMT0dOTygwMjkwMCkKICAgICAgICAgICAgICAgICAgICAgICAiZGVjbGluaW5n
IFVSTCAlcyAgKG5vdCBXZWJTb2NrZXQpIiwgdXJsKTsKICAgICAgICAgcmV0dXJuIERFQ0xJTkVE
OwpJbmRleDogbW9kdWxlcy9wcm94eS9wcm94eV91dGlsLmMKPT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQotLS0gbW9kdWxl
cy9wcm94eS9wcm94eV91dGlsLmMJKHJldmlzaW9uIDE3MjIxNDMpCisrKyBtb2R1bGVzL3Byb3h5
L3Byb3h5X3V0aWwuYwkod29ya2luZyBjb3B5KQpAQCAtMTA4MSw3ICsxMDgxLDcgQEAgUFJPWFlf
REVDTEFSRShpbnQpIGFwX3Byb3h5X3ZhbGlkX2JhbGFuY2VyX25hbWUoY2gKIHsKICAgICBpZiAo
IWkpCiAgICAgICAgIGkgPSBzaXplb2YoQkFMQU5DRVJfUFJFRklYKS0xOwotICAgIHJldHVybiAo
IXN0cm5jYXNlY21wKG5hbWUsIEJBTEFOQ0VSX1BSRUZJWCwgaSkpOworICAgIHJldHVybiAoIWFw
X2Nhc2VjbXBzdHJuKG5hbWUsIEJBTEFOQ0VSX1BSRUZJWCwgaSkpOwogfQogCiAKQEAgLTE2MzQs
NyArMTYzNCw3IEBAIFBST1hZX0RFQ0xBUkUoY2hhciAqKSBhcF9wcm94eV9kZWZpbmVfd29ya2Vy
KGFwcl9wCiAgICAgaWYgKHB0cikgewogICAgICAgICAqcHRyID0gJ1wwJzsKICAgICAgICAgcnYg
PSBhcHJfdXJpX3BhcnNlKHAsIHVybCwgJnVyaXNvY2spOwotICAgICAgICBpZiAocnYgPT0gQVBS
X1NVQ0NFU1MgJiYgIXN0cmNhc2VjbXAodXJpc29jay5zY2hlbWUsICJ1bml4IikpIHsKKyAgICAg
ICAgaWYgKHJ2ID09IEFQUl9TVUNDRVNTICYmICFhcF9jYXNlY21wc3RyKHVyaXNvY2suc2NoZW1l
LCAidW5peCIpKSB7CiAgICAgICAgICAgICBzb2NrcGF0aCA9IGFwX3J1bnRpbWVfZGlyX3JlbGF0
aXZlKHAsIHVyaXNvY2sucGF0aCk7OwogICAgICAgICAgICAgdXJsID0gcHRyKzE7ICAgIC8qIHNv
IHdlIGdldCB0aGUgc2NoZW1lIGZvciB0aGUgdWRzICovCiAgICAgICAgIH0KQEAgLTMyMzMsNyAr
MzIzMyw3IEBAIHN0YXRpYyBpbnQgZmluZF9jb25uX2hlYWRlcnModm9pZCAqZGF0YSwgY29uc3Qg
Y2hhCiAgICAgICAgICAgICB2YWwrKzsKICAgICAgICAgfQogICAgICAgICBuYW1lID0gYXBfZ2V0
X3Rva2VuKHgtPnBvb2wsICZ2YWwsIDApOwotICAgICAgICBpZiAoIXN0cmNhc2VjbXAobmFtZSwg
ImNsb3NlIikpIHsKKyAgICAgICAgaWYgKCFhcF9jYXNlY21wc3RyKG5hbWUsICJjbG9zZSIpKSB7
CiAgICAgICAgICAgICB4LT5jbG9zZWQgPSAxOwogICAgICAgICB9CiAgICAgICAgIGlmICgheC0+
Zmlyc3QpIHsKQEAgLTM0MzEsNyArMzQzMSw3IEBAIFBST1hZX0RFQ0xBUkUoaW50KSBhcF9wcm94
eV9jcmVhdGVfaGRyYnJnZChhcHJfcG9vCiAKICAgICAgICAgLyogQWRkIHRoZSBFeHBlY3QgaGVh
ZGVyIGlmIG5vdCBhbHJlYWR5IHRoZXJlLiAqLwogICAgICAgICBpZiAoKCh2YWwgPSBhcHJfdGFi
bGVfZ2V0KHItPmhlYWRlcnNfaW4sICJFeHBlY3QiKSkgPT0gTlVMTCkKLSAgICAgICAgICAgICAg
ICB8fCAoc3RyY2FzZWNtcCh2YWwsICIxMDAtQ29udGludWUiKSAhPSAwIC8qIGZhc3QgcGF0aCAq
LworICAgICAgICAgICAgICAgIHx8IChhcF9jYXNlY21wc3RyKHZhbCwgIjEwMC1Db250aW51ZSIp
ICE9IDAgLyogZmFzdCBwYXRoICovCiAgICAgICAgICAgICAgICAgICAgICYmICFhcF9maW5kX3Rv
a2VuKHItPnBvb2wsIHZhbCwgIjEwMC1Db250aW51ZSIpKSkgewogICAgICAgICAgICAgYXByX3Rh
YmxlX21lcmdlbihyLT5oZWFkZXJzX2luLCAiRXhwZWN0IiwgIjEwMC1Db250aW51ZSIpOwogICAg
ICAgICB9CkBAIC0zNDk0LDE1ICszNDk0LDE1IEBAIFBST1hZX0RFQ0xBUkUoaW50KSBhcF9wcm94
eV9jcmVhdGVfaGRyYnJnZChhcHJfcG9vCiAgICAgICAgICAgICB8fCBoZWFkZXJzX2luW2NvdW50
ZXJdLnZhbCA9PSBOVUxMCiAKICAgICAgICAgICAgIC8qIEFscmVhZHkgc2VudCAqLwotICAgICAg
ICAgICAgfHwgIXN0cmNhc2VjbXAoaGVhZGVyc19pbltjb3VudGVyXS5rZXksICJIb3N0IikKKyAg
ICAgICAgICAgIHx8ICFhcF9jYXNlY21wc3RyKGhlYWRlcnNfaW5bY291bnRlcl0ua2V5LCAiSG9z
dCIpCiAKICAgICAgICAgICAgIC8qIENsZWFyIG91dCBob3AtYnktaG9wIHJlcXVlc3QgaGVhZGVy
cyBub3QgdG8gc2VuZAogICAgICAgICAgICAgICogUkZDMjYxNiAxMy41LjEgc2F5cyB3ZSBzaG91
bGQgc3RyaXAgdGhlc2UgaGVhZGVycwogICAgICAgICAgICAgICovCi0gICAgICAgICAgICB8fCAh
c3RyY2FzZWNtcChoZWFkZXJzX2luW2NvdW50ZXJdLmtleSwgIktlZXAtQWxpdmUiKQotICAgICAg
ICAgICAgfHwgIXN0cmNhc2VjbXAoaGVhZGVyc19pbltjb3VudGVyXS5rZXksICJURSIpCi0gICAg
ICAgICAgICB8fCAhc3RyY2FzZWNtcChoZWFkZXJzX2luW2NvdW50ZXJdLmtleSwgIlRyYWlsZXIi
KQotICAgICAgICAgICAgfHwgIXN0cmNhc2VjbXAoaGVhZGVyc19pbltjb3VudGVyXS5rZXksICJV
cGdyYWRlIikKKyAgICAgICAgICAgIHx8ICFhcF9jYXNlY21wc3RyKGhlYWRlcnNfaW5bY291bnRl
cl0ua2V5LCAiS2VlcC1BbGl2ZSIpCisgICAgICAgICAgICB8fCAhYXBfY2FzZWNtcHN0cihoZWFk
ZXJzX2luW2NvdW50ZXJdLmtleSwgIlRFIikKKyAgICAgICAgICAgIHx8ICFhcF9jYXNlY21wc3Ry
KGhlYWRlcnNfaW5bY291bnRlcl0ua2V5LCAiVHJhaWxlciIpCisgICAgICAgICAgICB8fCAhYXBf
Y2FzZWNtcHN0cihoZWFkZXJzX2luW2NvdW50ZXJdLmtleSwgIlVwZ3JhZGUiKQogCiAgICAgICAg
ICAgICApIHsKICAgICAgICAgICAgIGNvbnRpbnVlOwpAQCAtMzUxMiw3ICszNTEyLDcgQEAgUFJP
WFlfREVDTEFSRShpbnQpIGFwX3Byb3h5X2NyZWF0ZV9oZHJicmdkKGFwcl9wb28KICAgICAgICAg
ICogSWYgd2UgaGF2ZSB1c2VkIGl0IHRoZW4gTUFZQkU6IFJGQzI2MTYgc2F5cyB3ZSBNQVkgcHJv
cGFnYXRlIGl0LgogICAgICAgICAgKiBTbyBsZXQncyBtYWtlIGl0IGNvbmZpZ3VyYWJsZSBieSBl
bnYuCiAgICAgICAgICAqLwotICAgICAgICBpZiAoIXN0cmNhc2VjbXAoaGVhZGVyc19pbltjb3Vu
dGVyXS5rZXksIlByb3h5LUF1dGhvcml6YXRpb24iKSkgeworICAgICAgICBpZiAoIWFwX2Nhc2Vj
bXBzdHIoaGVhZGVyc19pbltjb3VudGVyXS5rZXksIlByb3h5LUF1dGhvcml6YXRpb24iKSkgewog
ICAgICAgICAgICAgaWYgKHItPnVzZXIgIT0gTlVMTCkgeyAvKiB3ZSd2ZSBhdXRoZW50aWNhdGVk
ICovCiAgICAgICAgICAgICAgICAgaWYgKCFhcHJfdGFibGVfZ2V0KHItPnN1YnByb2Nlc3NfZW52
LCAiUHJveHktQ2hhaW4tQXV0aCIpKSB7CiAgICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlOwpA
QCAtMzUyMiwxMSArMzUyMiwxMSBAQCBQUk9YWV9ERUNMQVJFKGludCkgYXBfcHJveHlfY3JlYXRl
X2hkcmJyZ2QoYXByX3BvbwogCiAgICAgICAgIC8qIFNraXAgVHJhbnNmZXItRW5jb2RpbmcgYW5k
IENvbnRlbnQtTGVuZ3RoIGZvciBub3cuCiAgICAgICAgICAqLwotICAgICAgICBpZiAoIXN0cmNh
c2VjbXAoaGVhZGVyc19pbltjb3VudGVyXS5rZXksICJUcmFuc2Zlci1FbmNvZGluZyIpKSB7Cisg
ICAgICAgIGlmICghYXBfY2FzZWNtcHN0cihoZWFkZXJzX2luW2NvdW50ZXJdLmtleSwgIlRyYW5z
ZmVyLUVuY29kaW5nIikpIHsKICAgICAgICAgICAgICpvbGRfdGVfdmFsID0gaGVhZGVyc19pbltj
b3VudGVyXS52YWw7CiAgICAgICAgICAgICBjb250aW51ZTsKICAgICAgICAgfQotICAgICAgICBp
ZiAoIXN0cmNhc2VjbXAoaGVhZGVyc19pbltjb3VudGVyXS5rZXksICJDb250ZW50LUxlbmd0aCIp
KSB7CisgICAgICAgIGlmICghYXBfY2FzZWNtcHN0cihoZWFkZXJzX2luW2NvdW50ZXJdLmtleSwg
IkNvbnRlbnQtTGVuZ3RoIikpIHsKICAgICAgICAgICAgICpvbGRfY2xfdmFsID0gaGVhZGVyc19p
bltjb3VudGVyXS52YWw7CiAgICAgICAgICAgICBjb250aW51ZTsKICAgICAgICAgfQpAQCAtMzUz
MywxMSArMzUzMywxMSBAQCBQUk9YWV9ERUNMQVJFKGludCkgYXBfcHJveHlfY3JlYXRlX2hkcmJy
Z2QoYXByX3BvbwogCiAgICAgICAgIC8qIGZvciBzdWItcmVxdWVzdHMsIGlnbm9yZSBmcmVzaG5l
c3MvZXhwaXJ5IGhlYWRlcnMgKi8KICAgICAgICAgaWYgKHItPm1haW4pIHsKLSAgICAgICAgICAg
IGlmICggICAhc3RyY2FzZWNtcChoZWFkZXJzX2luW2NvdW50ZXJdLmtleSwgIklmLU1hdGNoIikK
LSAgICAgICAgICAgICAgICB8fCAhc3RyY2FzZWNtcChoZWFkZXJzX2luW2NvdW50ZXJdLmtleSwg
IklmLU1vZGlmaWVkLVNpbmNlIikKLSAgICAgICAgICAgICAgICB8fCAhc3RyY2FzZWNtcChoZWFk
ZXJzX2luW2NvdW50ZXJdLmtleSwgIklmLVJhbmdlIikKLSAgICAgICAgICAgICAgICB8fCAhc3Ry
Y2FzZWNtcChoZWFkZXJzX2luW2NvdW50ZXJdLmtleSwgIklmLVVubW9kaWZpZWQtU2luY2UiKQot
ICAgICAgICAgICAgICAgIHx8ICFzdHJjYXNlY21wKGhlYWRlcnNfaW5bY291bnRlcl0ua2V5LCAi
SWYtTm9uZS1NYXRjaCIpKSB7CisgICAgICAgICAgICBpZiAoICAgIWFwX2Nhc2VjbXBzdHIoaGVh
ZGVyc19pbltjb3VudGVyXS5rZXksICJJZi1NYXRjaCIpCisgICAgICAgICAgICAgICAgfHwgIWFw
X2Nhc2VjbXBzdHIoaGVhZGVyc19pbltjb3VudGVyXS5rZXksICJJZi1Nb2RpZmllZC1TaW5jZSIp
CisgICAgICAgICAgICAgICAgfHwgIWFwX2Nhc2VjbXBzdHIoaGVhZGVyc19pbltjb3VudGVyXS5r
ZXksICJJZi1SYW5nZSIpCisgICAgICAgICAgICAgICAgfHwgIWFwX2Nhc2VjbXBzdHIoaGVhZGVy
c19pbltjb3VudGVyXS5rZXksICJJZi1Vbm1vZGlmaWVkLVNpbmNlIikKKyAgICAgICAgICAgICAg
ICB8fCAhYXBfY2FzZWNtcHN0cihoZWFkZXJzX2luW2NvdW50ZXJdLmtleSwgIklmLU5vbmUtTWF0
Y2giKSkgewogICAgICAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgICAgICAgfQogICAgICAg
ICB9CkBAIC0zNjIyLDcgKzM2MjIsNyBAQCBQUk9YWV9ERUNMQVJFKGFwcl9wb3J0X3QpIGFwX3By
b3h5X3BvcnRfb2Zfc2NoZW1lKAogICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgcHJveHlf
c2NoZW1lc190ICpwc2NoZW1lOwogICAgICAgICAgICAgZm9yIChwc2NoZW1lID0gcHNjaGVtZXM7
IHBzY2hlbWUtPm5hbWUgIT0gTlVMTDsgKytwc2NoZW1lKSB7Ci0gICAgICAgICAgICAgICAgaWYg
KHN0cmNhc2VjbXAoc2NoZW1lLCBwc2NoZW1lLT5uYW1lKSA9PSAwKSB7CisgICAgICAgICAgICAg
ICAgaWYgKGFwX2Nhc2VjbXBzdHIoc2NoZW1lLCBwc2NoZW1lLT5uYW1lKSA9PSAwKSB7CiAgICAg
ICAgICAgICAgICAgICAgIHJldHVybiBwc2NoZW1lLT5kZWZhdWx0X3BvcnQ7CiAgICAgICAgICAg
ICAgICAgfQogICAgICAgICAgICAgfQpJbmRleDogbW9kdWxlcy9zc2wvc3NsX2VuZ2luZV9vY3Nw
LmMKPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PQotLS0gbW9kdWxlcy9zc2wvc3NsX2VuZ2luZV9vY3NwLmMJKHJldmlzaW9u
IDE3MjIxNDMpCisrKyBtb2R1bGVzL3NzbC9zc2xfZW5naW5lX29jc3AuYwkod29ya2luZyBjb3B5
KQpAQCAtODYsNyArODYsNyBAQCBzdGF0aWMgYXByX3VyaV90ICpkZXRlcm1pbmVfcmVzcG9uZGVy
X3VyaShTU0xTcnZDbwogICAgICAgICByZXR1cm4gTlVMTDsKICAgICB9CiAKLSAgICBpZiAoc3Ry
Y2FzZWNtcCh1LT5zY2hlbWUsICJodHRwIikgIT0gMCkgeworICAgIGlmIChhcF9jYXNlY21wc3Ry
KHUtPnNjaGVtZSwgImh0dHAiKSAhPSAwKSB7CiAgICAgICAgIGFwX2xvZ19jZXJyb3IoQVBMT0df
TUFSSywgQVBMT0dfREVCVUcsIHJ2LCBjLCBBUExPR05PKDAxOTIwKQogICAgICAgICAgICAgICAg
ICAgICAgICJjYW5ub3QgaGFuZGxlIE9DU1AgcmVzcG9uZGVyIFVSSSAnJXMnIiwgcyk7CiAgICAg
ICAgIHJldHVybiBOVUxMOwpJbmRleDogc2VydmVyL2xvZy5jCj09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KLS0tIHNlcnZl
ci9sb2cuYwkocmV2aXNpb24gMTcyMjE0MykKKysrIHNlcnZlci9sb2cuYwkod29ya2luZyBjb3B5
KQpAQCAtNjU4LDcgKzY1OCw3IEBAIHN0YXRpYyBpbnQgbG9nX2xvZ19pZChjb25zdCBhcF9lcnJv
cmxvZ19pbmZvICppbmZvCiAgICAgICogYzogbG9nIGNvbm4gbG9nIGlkIGlmIGF2YWlsYWJsZSBh
bmQgbm90IGEgb25jZS1wZXItcmVxdWVzdCBsb2cgbGluZQogICAgICAqIGVsc2U6IGxvZyByZXF1
ZXN0IGxvZyBpZCBpZiBhdmFpbGFibGUKICAgICAgKi8KLSAgICBpZiAoYXJnICYmICFzdHJjYXNl
Y21wKGFyZywgImMiKSkgeworICAgIGlmIChhcmcgJiYgKCphcmcgPT0gJ2MnIHx8ICphcmcgPT0g
J0MnKSkgewogICAgICAgICBpZiAoaW5mby0+YyAmJiAoKmFyZyAhPSAnQycgfHwgIWluZm8tPnIp
KSB7CiAgICAgICAgICAgICByZXR1cm4gY3B5c3RybihidWYsIGluZm8tPmMtPmxvZ19pZCwgYnVm
bGVuKTsKICAgICAgICAgfQpJbmRleDogc2VydmVyL21wbV91bml4LmMKPT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQotLS0g
c2VydmVyL21wbV91bml4LmMJKHJldmlzaW9uIDE3MjIxNDMpCisrKyBzZXJ2ZXIvbXBtX3VuaXgu
Ywkod29ya2luZyBjb3B5KQpAQCAtNjI3LDcgKzYyNyw3IEBAIHN0YXRpYyBhcHJfc3RhdHVzX3Qg
ZHVtbXlfY29ubmVjdGlvbihhcF9wb2RfdCAqcG9kCiAgICAgICogZXhwZW5zaXZlIHRvIGRvIGNv
cnJlY3RseSAocGVyZm9ybWluZyBhIGNvbXBsZXRlIFNTTCBoYW5kc2hha2UpCiAgICAgICogb3Ig
Y2F1c2UgbG9nIHNwYW0gYnkgZG9pbmcgaW5jb3JyZWN0bHkgKHNpbXBseSBzZW5kaW5nIEVPRiku
ICovCiAgICAgbHAgPSBhcF9saXN0ZW5lcnM7Ci0gICAgd2hpbGUgKGxwICYmIGxwLT5wcm90b2Nv
bCAmJiBzdHJjYXNlY21wKGxwLT5wcm90b2NvbCwgImh0dHAiKSAhPSAwKSB7CisgICAgd2hpbGUg
KGxwICYmIGxwLT5wcm90b2NvbCAmJiBhcF9jYXNlY21wc3RyKGxwLT5wcm90b2NvbCwgImh0dHAi
KSAhPSAwKSB7CiAgICAgICAgIGxwID0gbHAtPm5leHQ7CiAgICAgfQogICAgIGlmICghbHApIHsK
QEAgLTY3NSw3ICs2NzUsNyBAQCBzdGF0aWMgYXByX3N0YXR1c190IGR1bW15X2Nvbm5lY3Rpb24o
YXBfcG9kX3QgKnBvZAogICAgICAgICByZXR1cm4gcnY7CiAgICAgfQogCi0gICAgaWYgKGxwLT5w
cm90b2NvbCAmJiBzdHJjYXNlY21wKGxwLT5wcm90b2NvbCwgImh0dHBzIikgPT0gMCkgeworICAg
IGlmIChscC0+cHJvdG9jb2wgJiYgYXBfY2FzZWNtcHN0cihscC0+cHJvdG9jb2wsICJodHRwcyIp
ID09IDApIHsKICAgICAgICAgLyogU2VuZCBhIFRMUyAxLjAgY2xvc2Vfbm90aWZ5IGFsZXJ0LiAg
VGhpcyBpcyBwZXJoYXBzIHRoZQogICAgICAgICAgKiAibGVhc3Qgd3JvbmciIHdheSB0byBvcGVu
IGFuZCBjbGVhbmx5IHRlcm1pbmF0ZSBhbiBTU0wKICAgICAgICAgICogY29ubmVjdGlvbi4gIEl0
IHNob3VsZCAid29yayIgd2l0aG91dCBub2lzeSBlcnJvciBsb2dzIGlmCkluZGV4OiBzZXJ2ZXIv
cHJvdG9jb2wuYwo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09Ci0tLSBzZXJ2ZXIvcHJvdG9jb2wuYwkocmV2aXNpb24gMTcy
MjE0MykKKysrIHNlcnZlci9wcm90b2NvbC5jCSh3b3JraW5nIGNvcHkpCkBAIC01MjAsNyArNTIw
LDcgQEAgQVBfQ09SRV9ERUNMQVJFKHZvaWQpIGFwX3BhcnNlX3VyaShyZXF1ZXN0X3JlYyAqciwK
ICAgICBpZiAoc3RhdHVzID09IEFQUl9TVUNDRVNTKSB7CiAgICAgICAgIC8qIGlmIGl0IGhhcyBh
IHNjaGVtZSB3ZSBtYXkgbmVlZCB0byBkbyBhYnNvbHV0ZVVSSSB2aG9zdCBzdHVmZiAqLwogICAg
ICAgICBpZiAoci0+cGFyc2VkX3VyaS5zY2hlbWUKLSAgICAgICAgICAgICYmICFzdHJjYXNlY21w
KHItPnBhcnNlZF91cmkuc2NoZW1lLCBhcF9odHRwX3NjaGVtZShyKSkpIHsKKyAgICAgICAgICAg
ICYmICFhcF9jYXNlY21wc3RyKHItPnBhcnNlZF91cmkuc2NoZW1lLCBhcF9odHRwX3NjaGVtZShy
KSkpIHsKICAgICAgICAgICAgIHItPmhvc3RuYW1lID0gci0+cGFyc2VkX3VyaS5ob3N0bmFtZTsK
ICAgICAgICAgfQogICAgICAgICBlbHNlIGlmIChyLT5tZXRob2RfbnVtYmVyID09IE1fQ09OTkVD
VCkgewpAQCAtNjYwLDcgKzY2MCw3IEBAIHN0YXRpYyBpbnQgcmVhZF9yZXF1ZXN0X2xpbmUocmVx
dWVzdF9yZWMgKnIsIGFwcl9iCiAgICAgICAgIHItPnByb3RvX251bSA9IEhUVFBfVkVSU0lPTihw
cm9bNV0gLSAnMCcsIHByb1s3XSAtICcwJyk7CiAgICAgfQogICAgIGVsc2UgaWYgKDMgPT0gc3Nj
YW5mKHItPnByb3RvY29sLCAiJTRzLyV1LiV1IiwgaHR0cCwgJm1ham9yLCAmbWlub3IpCi0gICAg
ICAgICAgICAgJiYgKHN0cmNhc2VjbXAoImh0dHAiLCBodHRwKSA9PSAwKQorICAgICAgICAgICAg
ICYmIChhcF9jYXNlY21wc3RyKCJodHRwIiwgaHR0cCkgPT0gMCkKICAgICAgICAgICAgICAmJiAo
bWlub3IgPCBIVFRQX1ZFUlNJT04oMSwgMCkpICkgLyogZG9uJ3QgYWxsb3cgSFRUUC8wLjEwMDAg
Ki8KICAgICAgICAgci0+cHJvdG9fbnVtID0gSFRUUF9WRVJTSU9OKG1ham9yLCBtaW5vcik7CiAg
ICAgZWxzZQpAQCAtMTAzNiw3ICsxMDM2LDcgQEAgcmVxdWVzdF9yZWMgKmFwX3JlYWRfcmVxdWVz
dChjb25uX3JlYyAqY29ubikKICAgICAgICAgICAgICAqIHRoZSBmaW5hbCBlbmNvZGluZyAuLi47
IHRoZSBzZXJ2ZXIgTVVTVCByZXNwb25kIHdpdGggdGhlIDQwMAogICAgICAgICAgICAgICogKEJh
ZCBSZXF1ZXN0KSBzdGF0dXMgY29kZSBhbmQgdGhlbiBjbG9zZSB0aGUgY29ubmVjdGlvbiIuCiAg
ICAgICAgICAgICAgKi8KLSAgICAgICAgICAgIGlmICghKHN0cmNhc2VjbXAodGVuYywgImNodW5r
ZWQiKSA9PSAwIC8qIGZhc3QgcGF0aCAqLworICAgICAgICAgICAgaWYgKCEoYXBfY2FzZWNtcHN0
cih0ZW5jLCAiY2h1bmtlZCIpID09IDAgLyogZmFzdCBwYXRoICovCiAgICAgICAgICAgICAgICAg
ICAgIHx8IGFwX2ZpbmRfbGFzdF90b2tlbihyLT5wb29sLCB0ZW5jLCAiY2h1bmtlZCIpKSkgewog
ICAgICAgICAgICAgICAgIGFwX2xvZ19yZXJyb3IoQVBMT0dfTUFSSywgQVBMT0dfSU5GTywgMCwg
ciwgQVBMT0dOTygwMjUzOSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJjbGllbnQg
c2VudCB1bmtub3duIFRyYW5zZmVyLUVuY29kaW5nICIKQEAgLTExNDAsNyArMTE0MCw3IEBAIHJl
cXVlc3RfcmVjICphcF9yZWFkX3JlcXVlc3QoY29ubl9yZWMgKmNvbm4pCiAgICAgICAgICAqIHVu
Zm9ydHVuYXRlbHksIHRvIHNpZ25hbCBhIHBvb3IgbWFuJ3MgbWFuZGF0b3J5IGV4dGVuc2lvbiB0
aGF0CiAgICAgICAgICAqIHRoZSBzZXJ2ZXIgbXVzdCB1bmRlcnN0YW5kIG9yIHJldHVybiA0MTcg
RXhwZWN0YXRpb24gRmFpbGVkLgogICAgICAgICAgKi8KLSAgICAgICAgaWYgKHN0cmNhc2VjbXAo
ZXhwZWN0LCAiMTAwLWNvbnRpbnVlIikgPT0gMCkgeworICAgICAgICBpZiAoYXBfY2FzZWNtcHN0
cihleHBlY3QsICIxMDAtY29udGludWUiKSA9PSAwKSB7CiAgICAgICAgICAgICByLT5leHBlY3Rp
bmdfMTAwID0gMTsKICAgICAgICAgfQogICAgICAgICBlbHNlIHsKQEAgLTEyOTMsNyArMTI5Myw3
IEBAIEFQX0RFQ0xBUkUoaW50KSBhcF9nZXRfYmFzaWNfYXV0aF9wdyhyZXF1ZXN0X3JlYyAqCiAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgOiAiQXV0aG9yaXph
dGlvbiIpOwogICAgIGNvbnN0IGNoYXIgKnQ7CiAKLSAgICBpZiAoISh0ID0gYXBfYXV0aF90eXBl
KHIpKSB8fCBzdHJjYXNlY21wKHQsICJCYXNpYyIpKQorICAgIGlmICghKHQgPSBhcF9hdXRoX3R5
cGUocikpIHx8IGFwX2Nhc2VjbXBzdHIodCwgIkJhc2ljIikpCiAgICAgICAgIHJldHVybiBERUNM
SU5FRDsKIAogICAgIGlmICghYXBfYXV0aF9uYW1lKHIpKSB7CkBAIC0xMzA3LDcgKzEzMDcsNyBA
QCBBUF9ERUNMQVJFKGludCkgYXBfZ2V0X2Jhc2ljX2F1dGhfcHcocmVxdWVzdF9yZWMgKgogICAg
ICAgICByZXR1cm4gSFRUUF9VTkFVVEhPUklaRUQ7CiAgICAgfQogCi0gICAgaWYgKHN0cmNhc2Vj
bXAoYXBfZ2V0d29yZChyLT5wb29sLCAmYXV0aF9saW5lLCAnICcpLCAiQmFzaWMiKSkgeworICAg
IGlmIChhcF9jYXNlY21wc3RyKGFwX2dldHdvcmQoci0+cG9vbCwgJmF1dGhfbGluZSwgJyAnKSwg
IkJhc2ljIikpIHsKICAgICAgICAgLyogQ2xpZW50IHRyaWVkIHRvIGF1dGhlbnRpY2F0ZSB1c2lu
ZyB3cm9uZyBhdXRoIHNjaGVtZSAqLwogICAgICAgICBhcF9sb2dfcmVycm9yKEFQTE9HX01BUkss
IEFQTE9HX0lORk8sIDAsIHIsIEFQTE9HTk8oMDA1NzMpCiAgICAgICAgICAgICAgICAgICAgICAg
ImNsaWVudCB1c2VkIHdyb25nIGF1dGhlbnRpY2F0aW9uIHNjaGVtZTogJXMiLCByLT51cmkpOwpJ
bmRleDogc2VydmVyL3V0aWwuYwo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09Ci0tLSBzZXJ2ZXIvdXRpbC5jCShyZXZpc2lv
biAxNzIyMTQzKQorKysgc2VydmVyL3V0aWwuYwkod29ya2luZyBjb3B5KQpAQCAtOTYsNyArOTYs
NiBAQAogI3VuZGVmIEFQTE9HX01PRFVMRV9JTkRFWAogI2RlZmluZSBBUExPR19NT0RVTEVfSU5E
RVggQVBfQ09SRV9NT0RVTEVfSU5ERVgKIAotCiAvKgogICogRXhhbWluZSBhIGZpZWxkIHZhbHVl
IChzdWNoIGFzIGEgbWVkaWEtL2NvbnRlbnQtdHlwZSkgc3RyaW5nIGFuZCByZXR1cm4KICAqIGl0
IHNhbnMgYW55IHBhcmFtZXRlcnM7IGUuZy4sIHN0cmlwIG9mZiBhbnkgJztjaGFyc2V0PWZvbycg
YW5kIHRoZSBsaWtlLgpAQCAtODgxLDcgKzg4MCw3IEBAIEFQX0RFQ0xBUkUoYXByX3N0YXR1c190
KSBhcF9wY2ZnX29wZW5maWxlKGFwX2NvbmZpCiAKICAgICBpZiAoZmluZm8uZmlsZXR5cGUgIT0g
QVBSX1JFRyAmJgogI2lmIGRlZmluZWQoV0lOMzIpIHx8IGRlZmluZWQoT1MyKSB8fCBkZWZpbmVk
KE5FVFdBUkUpCi0gICAgICAgIHN0cmNhc2VjbXAoYXByX2ZpbGVwYXRoX25hbWVfZ2V0KG5hbWUp
LCAibnVsIikgIT0gMCkgeworICAgICAgICBhcF9jYXNlY21wc3RyKGFwcl9maWxlcGF0aF9uYW1l
X2dldChuYW1lKSwgIm51bCIpICE9IDApIHsKICNlbHNlCiAgICAgICAgIHN0cmNtcChuYW1lLCAi
L2Rldi9udWxsIikgIT0gMCkgewogI2VuZGlmIC8qIFdJTjMyIHx8IE9TMiAqLwpAQCAtMTYwOSw3
ICsxNjA4LDcgQEAgQVBfREVDTEFSRShpbnQpIGFwX2ZpbmRfdG9rZW4oYXByX3Bvb2xfdCAqcCwg
Y29uc3QKICAgICAgICAgd2hpbGUgKCpzICYmICFURVNUX0NIQVIoKnMsIFRfSFRUUF9UT0tFTl9T
VE9QKSkgewogICAgICAgICAgICAgKytzOwogICAgICAgICB9Ci0gICAgICAgIGlmICghc3RybmNh
c2VjbXAoKGNvbnN0IGNoYXIgKilzdGFydF90b2tlbiwgKGNvbnN0IGNoYXIgKil0b2ssCisgICAg
ICAgIGlmICghYXBfY2FzZWNtcHN0cm4oKGNvbnN0IGNoYXIgKilzdGFydF90b2tlbiwgKGNvbnN0
IGNoYXIgKil0b2ssCiAgICAgICAgICAgICAgICAgICAgICAgICAgcyAtIHN0YXJ0X3Rva2VuKSkg
ewogICAgICAgICAgICAgcmV0dXJuIDE7CiAgICAgICAgIH0KQEAgLTE2MzYsNyArMTYzNSw3IEBA
IEFQX0RFQ0xBUkUoaW50KSBhcF9maW5kX2xhc3RfdG9rZW4oYXByX3Bvb2xfdCAqcCwKICAgICAg
ICAgKGxpZHggPiAwICYmICEoYXByX2lzc3BhY2UobGluZVtsaWR4IC0gMV0pIHx8IGxpbmVbbGlk
eCAtIDFdID09ICcsJykpKQogICAgICAgICByZXR1cm4gMDsKIAotICAgIHJldHVybiAoc3RybmNh
c2VjbXAoJmxpbmVbbGlkeF0sIHRvaywgdGxlbikgPT0gMCk7CisgICAgcmV0dXJuIChhcF9jYXNl
Y21wc3RybigmbGluZVtsaWR4XSwgdG9rLCB0bGVuKSA9PSAwKTsKIH0KIAogQVBfREVDTEFSRShj
aGFyICopIGFwX2VzY2FwZV9zaGVsbF9jbWQoYXByX3Bvb2xfdCAqcCwgY29uc3QgY2hhciAqc3Ry
KQpAQCAtMjU4OSw3ICsyNTg4LDcgQEAgQVBfREVDTEFSRShpbnQpIGFwX3BhcnNlX2Zvcm1fZGF0
YShyZXF1ZXN0X3JlYyAqciwKIAogICAgIC8qIHNhbml0eSBjaGVjayAtIHdlIG9ubHkgc3VwcG9y
dCBmb3JtcyBmb3Igbm93ICovCiAgICAgY3QgPSBhcHJfdGFibGVfZ2V0KHItPmhlYWRlcnNfaW4s
ICJDb250ZW50LVR5cGUiKTsKLSAgICBpZiAoIWN0IHx8IHN0cm5jYXNlY21wKCJhcHBsaWNhdGlv
bi94LXd3dy1mb3JtLXVybGVuY29kZWQiLCBjdCwgMzMpKSB7CisgICAgaWYgKCFjdCB8fCBhcF9j
YXNlY21wc3RybigiYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkIiwgY3QsIDMzKSkg
ewogICAgICAgICByZXR1cm4gYXBfZGlzY2FyZF9yZXF1ZXN0X2JvZHkocik7CiAgICAgfQogCkBA
IC0zMTE5LDMgKzMxMTgsMTE5IEBAIEFQX0RFQ0xBUkUoaW50KSBhcF9hcnJheV9zdHJfY29udGFp
bnMoY29uc3QgYXByX2FyCiAgICAgcmV0dXJuIChhcF9hcnJheV9zdHJfaW5kZXgoYXJyYXksIHMs
IDApID49IDApOwogfQogCisvKgorICogUHJvdmlkZSBvdXIgb3duIGtub3duLWZhc3QgaW1wbGVt
ZW50YXRpb24gb2Ygc3RyW25dY2FzZWNtcCgpCisgKiBOT1RFOiBPbmx5IEFTQ0lJIGFscGhhIGNo
YXJhY3RlcnMgNDEtNUEgYXJlIGZvbGRlZCB0byA2MS03QSwKKyAqIG90aGVyIDgtYml0IGxhdGlu
IGFscGhhYmV0aWNzIGFyZSBuZXZlciBjYXNlLWZvbGRlZCEKKyAqLworc3RhdGljIGNvbnN0IHVu
c2lnbmVkIGNoYXIgdWNoYXJtYXBbXSA9IHsKKyAgICAweDAsICAweDEsICAweDIsICAweDMsICAw
eDQsICAweDUsICAweDYsICAweDcsCisgICAgMHg4LCAgMHg5LCAgMHhhLCAgMHhiLCAgMHhjLCAg
MHhkLCAgMHhlLCAgMHhmLAorICAgIDB4MTAsIDB4MTEsIDB4MTIsIDB4MTMsIDB4MTQsIDB4MTUs
IDB4MTYsIDB4MTcsCisgICAgMHgxOCwgMHgxOSwgMHgxYSwgMHgxYiwgMHgxYywgMHgxZCwgMHgx
ZSwgMHgxZiwKKyAgICAweDIwLCAweDIxLCAweDIyLCAweDIzLCAweDI0LCAweDI1LCAweDI2LCAw
eDI3LAorICAgIDB4MjgsIDB4MjksIDB4MmEsIDB4MmIsIDB4MmMsIDB4MmQsIDB4MmUsIDB4MmYs
CisgICAgMHgzMCwgMHgzMSwgMHgzMiwgMHgzMywgMHgzNCwgMHgzNSwgMHgzNiwgMHgzNywKKyAg
ICAweDM4LCAweDM5LCAweDNhLCAweDNiLCAweDNjLCAweDNkLCAweDNlLCAweDNmLAorICAgIDB4
NDAsICAnYScsICAnYicsICAnYycsICAnZCcsICAnZScsICAnZicsICAnZycsCisgICAgICdoJywg
ICdpJywgICdqJywgICdrJywgICdsJywgICdtJywgICduJywgICdvJywKKyAgICAgJ3AnLCAgJ3En
LCAgJ3InLCAgJ3MnLCAgJ3QnLCAgJ3UnLCAgJ3YnLCAgJ3cnLAorICAgICAneCcsICAneScsICAn
eicsIDB4NWIsIDB4NWMsIDB4NWQsIDB4NWUsIDB4NWYsCisgICAgMHg2MCwgICdhJywgICdiJywg
ICdjJywgICdkJywgICdlJywgICdmJywgICdnJywKKyAgICAgJ2gnLCAgJ2knLCAgJ2onLCAgJ2sn
LCAgJ2wnLCAgJ20nLCAgJ24nLCAgJ28nLAorICAgICAncCcsICAncScsICAncicsICAncycsICAn
dCcsICAndScsICAndicsICAndycsCisgICAgICd4JywgICd5JywgICd6JywgMHg3YiwgMHg3Yywg
MHg3ZCwgMHg3ZSwgMHg3ZiwKKyAgICAweDgwLCAweDgxLCAweDgyLCAweDgzLCAweDg0LCAweDg1
LCAweDg2LCAweDg3LAorICAgIDB4ODgsIDB4ODksIDB4OGEsIDB4OGIsIDB4OGMsIDB4OGQsIDB4
OGUsIDB4OGYsCisgICAgMHg5MCwgMHg5MSwgMHg5MiwgMHg5MywgMHg5NCwgMHg5NSwgMHg5Niwg
MHg5NywKKyAgICAweDk4LCAweDk5LCAweDlhLCAweDliLCAweDljLCAweDlkLCAweDllLCAweDlm
LAorICAgIDB4YTAsIDB4YTEsIDB4YTIsIDB4YTMsIDB4YTQsIDB4YTUsIDB4YTYsIDB4YTcsCisg
ICAgMHhhOCwgMHhhOSwgMHhhYSwgMHhhYiwgMHhhYywgMHhhZCwgMHhhZSwgMHhhZiwKKyAgICAw
eGIwLCAweGIxLCAweGIyLCAweGIzLCAweGI0LCAweGI1LCAweGI2LCAweGI3LAorICAgIDB4Yjgs
IDB4YjksIDB4YmEsIDB4YmIsIDB4YmMsIDB4YmQsIDB4YmUsIDB4YmYsCisgICAgMHhjMCwgMHhj
MSwgMHhjMiwgMHhjMywgMHhjNCwgMHhjNSwgMHhjNiwgMHhjNywKKyAgICAweGM4LCAweGM5LCAw
eGNhLCAweGNiLCAweGNjLCAweGNkLCAweGNlLCAweGNmLAorICAgIDB4ZDAsIDB4ZDEsIDB4ZDIs
IDB4ZDMsIDB4ZDQsIDB4ZDUsIDB4ZDYsIDB4ZDcsCisgICAgMHhkOCwgMHhkOSwgMHhkYSwgMHhk
YiwgMHhkYywgMHhkZCwgMHhkZSwgMHhkZiwKKyAgICAweGUwLCAweGUxLCAweGUyLCAweGUzLCAw
eGU0LCAweGU1LCAweGU2LCAweGU3LAorICAgIDB4ZTgsIDB4ZTksIDB4ZWEsIDB4ZWIsIDB4ZWMs
IDB4ZWQsIDB4ZWUsIDB4ZWYsCisgICAgMHhmMCwgMHhmMSwgMHhmMiwgMHhmMywgMHhmNCwgMHhm
NSwgMHhmNiwgMHhmNywKKyAgICAweGY4LCAweGY5LCAweGZhLCAweGZiLCAweGZjLCAweGZkLCAw
eGZlLCAweGZmCit9OworCisjZWxzZSAvKiBBUFJfQ0hBUlNFVF9FQkNESUMgKi8KKy8qIERlcml2
ZWQgZnJvbSBhcHItaWNvbnYvY2NzL2NwMDM3LmMgZm9yIEVCQ0RJQyBjYXNlIGNvbXBhcmlzb24s
CisgICBwcm92aWRlcyB1bmlxdWUgaWRlbnRpdHkgb2YgZXZlcnkgY2hhciB2YWx1ZSAoc3RyaWN0
IElTTy02NDYKKyAgIGNvbmZvcm1hbmNlLCBhcmJpdHJhcnkgZWxlY3Rpb24gb2YgYW4gSVNPLTg4
NTktMSBvcmRlcmluZywgYW5kCisgICB2ZXJ5IGFyYml0cmFyeSBjb250cm9sIGNvZGUgYXNzaWdu
bWVudHMgaW50byBDMSB0byBhY2hpZXZlCisgICBpZGVudGl0eSBhbmQgYSByZXZlcnNpYmxlIG1h
cHBpbmcgb2YgY29kZSBwb2ludHMpLAorICAgdGhlbiBmb2xkaW5nIHRoZSBlcXVpdmFsZW5jZXMg
b2YgQVNDSUkgNDEtNUEgaW50byA2MS03QSwgCisgICBwcmVzZW50aW5nIGNvbXBhcmlzb24gcmVz
dWx0cyBpbiBhIHNvbWV3aGF0IElTTy9JRUMgMTA2NDYKKyAgIChBU0NJSS1saWtlKSBvcmRlciwg
ZGVwZW5kaW5nIG9uIHRoZSBFQkNESUMgY29kZSBwYWdlIGluIHVzZS4KKyAqLworc3RhdGljIGNv
bnN0IHVuc2lnbmVkIGNoYXIgdWNoYXJtYXBbXSA9IHsKKwkweDAwLCAweDAxLCAweDAyLCAweDAz
LCAweDlDLCAweDA5LCAweDg2LCAweDdGLAorCTB4OTcsIDB4OEQsIDB4OEUsIDB4MEIsIDB4MEMs
IDB4MEQsIDB4MEUsIDB4MEYsCisJMHgxMCwgMHgxMSwgMHgxMiwgMHgxMywgMHg5RCwgMHg4NSwg
MHgwOCwgMHg4NywKKwkweDE4LCAweDE5LCAweDkyLCAweDhGLCAweDFDLCAweDFELCAweDFFLCAw
eDFGLAorCTB4ODAsIDB4ODEsIDB4ODIsIDB4ODMsIDB4ODQsIDB4MEEsIDB4MTcsIDB4MUIsCisJ
MHg4OCwgMHg4OSwgMHg4QSwgMHg4QiwgMHg4QywgMHgwNSwgMHgwNiwgMHgwNywKKwkweDkwLCAw
eDkxLCAweDE2LCAweDkzLCAweDk0LCAweDk1LCAweDk2LCAweDA0LAorCTB4OTgsIDB4OTksIDB4
OUEsIDB4OUIsIDB4MTQsIDB4MTUsIDB4OUUsIDB4MUEsCisJMHgyMCwgMHhBMCwgMHhFMiwgMHhF
NCwgMHhFMCwgMHhFMSwgMHhFMywgMHhFNSwKKwkweEU3LCAweEYxLCAweEEyLCAweDJFLCAweDND
LCAweDI4LCAweDJCLCAweDdDLAorCTB4MjYsIDB4RTksIDB4RUEsIDB4RUIsIDB4RTgsIDB4RUQs
IDB4RUUsIDB4RUYsCisJMHhFQywgMHhERiwgMHgyMSwgMHgyNCwgMHgyQSwgMHgyOSwgMHgzQiwg
MHhBQywKKwkweDJELCAweDJGLCAweEMyLCAweEM0LCAweEMwLCAweEMxLCAweEMzLCAweEM1LAor
CTB4QzcsIDB4RDEsIDB4QTYsIDB4MkMsIDB4MjUsIDB4NUYsIDB4M0UsIDB4M0YsCisJMHhGOCwg
MHhDOSwgMHhDQSwgMHhDQiwgMHhDOCwgMHhDRCwgMHhDRSwgMHhDRiwKKwkweENDLCAweDYwLCAw
eDNBLCAweDIzLCAweDQwLCAweDI3LCAweDNELCAweDIyLAorCTB4RDgsIDB4NjEsIDB4NjIsIDB4
NjMsIDB4NjQsIDB4NjUsIDB4NjYsIDB4NjcsCisJMHg2OCwgMHg2OSwgMHhBQiwgMHhCQiwgMHhG
MCwgMHhGRCwgMHhGRSwgMHhCMSwKKwkweEIwLCAweDZBLCAweDZCLCAweDZDLCAweDZELCAweDZF
LCAweDZGLCAweDcwLAorCTB4NzEsIDB4NzIsIDB4QUEsIDB4QkEsIDB4RTYsIDB4QjgsIDB4QzYs
IDB4QTQsCisJMHhCNSwgMHg3RSwgMHg3MywgMHg3NCwgMHg3NSwgMHg3NiwgMHg3NywgMHg3OCwK
KwkweDc5LCAweDdBLCAweEExLCAweEJGLCAweEQwLCAweERELCAweERFLCAweEFFLAorCTB4NUUs
IDB4QTMsIDB4QTUsIDB4QjcsIDB4QTksIDB4QTcsIDB4QjYsIDB4QkMsCisJMHhCRCwgMHhCRSwg
MHg1QiwgMHg1RCwgMHhBRiwgMHhBOCwgMHhCNCwgMHhENywKKwkweDdCLCAweDYxLCAweDYyLCAw
eDYzLCAweDY0LCAweDY1LCAweDY2LCAweDY3LAorCTB4NjgsIDB4NjksIDB4QUQsIDB4RjQsIDB4
RjYsIDB4RjIsIDB4RjMsIDB4RjUsCisJMHg3RCwgMHg2QSwgMHg2QiwgMHg2QywgMHg2RCwgMHg2
RSwgMHg2RiwgMHg3MCwKKwkweDcxLCAweDcyLCAweEI5LCAweEZCLCAweEZDLCAweEY5LCAweEZB
LCAweEZGLAorCTB4NUMsIDB4RjcsIDB4NzMsIDB4NzQsIDB4NzUsIDB4NzYsIDB4NzcsIDB4Nzgs
CisJMHg3OSwgMHg3QSwgMHhCMiwgMHhENCwgMHhENiwgMHhEMiwgMHhEMywgMHhENSwKKwkweDMw
LCAweDMxLCAweDMyLCAweDMzLCAweDM0LCAweDM1LCAweDM2LCAweDM3LAorCTB4MzgsIDB4Mzks
IDB4QjMsIDB4REIsIDB4REMsIDB4RDksIDB4REEsIDB4OUYKK307CisjZW5kaWYKKworQVBfREVD
TEFSRShpbnQpIGFwX2Nhc2VjbXBzdHIoY29uc3QgY2hhciAqczEsIGNvbnN0IGNoYXIgKnMyKQor
eworICAgIGNvbnN0IHVuc2lnbmVkIGNoYXIgKnBzMSA9IChjb25zdCB1bnNpZ25lZCBjaGFyICop
IHMxOworICAgIGNvbnN0IHVuc2lnbmVkIGNoYXIgKnBzMiA9IChjb25zdCB1bnNpZ25lZCBjaGFy
ICopIHMyOworCisgICAgd2hpbGUgKHVjaGFybWFwWypwczFdID09IHVjaGFybWFwWypwczIrK10p
IHsKKyAgICAgICAgaWYgKCpwczErKyA9PSAnXDAnKSB7CisgICAgICAgICAgICByZXR1cm4gKDAp
OworICAgICAgICB9CisgICAgfQorICAgIHJldHVybiAodWNoYXJtYXBbKnBzMV0gLSB1Y2hhcm1h
cFsqLS1wczJdKTsKK30KKworQVBfREVDTEFSRShpbnQpIGFwX2Nhc2VjbXBzdHJuKGNvbnN0IGNo
YXIgKnMxLCBjb25zdCBjaGFyICpzMiwgYXByX3NpemVfdCBuKQoreworICAgIGNvbnN0IHVuc2ln
bmVkIGNoYXIgKnBzMSA9IChjb25zdCB1bnNpZ25lZCBjaGFyICopIHMxOworICAgIGNvbnN0IHVu
c2lnbmVkIGNoYXIgKnBzMiA9IChjb25zdCB1bnNpZ25lZCBjaGFyICopIHMyOworICAgIGlmIChu
KSB7CisgICAgICAgIGRvIHsKKyAgICAgICAgICAgIGlmICh1Y2hhcm1hcFsqcHMxXSAhPSB1Y2hh
cm1hcFsqcHMyKytdKSB7CisgICAgICAgICAgICAgICAgcmV0dXJuICh1Y2hhcm1hcFsqcHMxXSAt
IHVjaGFybWFwWyotLXBzMl0pOworICAgICAgICAgICAgfQorICAgICAgICAgICAgaWYgKCpwczEr
KyA9PSAnXDAnKSB7CisgICAgICAgICAgICAgICAgLyogd2Uga25vdyBib3RoIGVuZCBoZXJlICov
CisgICAgICAgICAgICAgICAgcmV0dXJuICgwKTsKKyAgICAgICAgICAgIH0KKyAgICAgICAgfSB3
aGlsZSAoIS0tbik7CisgICAgfQorICAgIHJldHVybiAoMCk7Cit9CkluZGV4OiBzZXJ2ZXIvdXRp
bF9leHByX2V2YWwuYwo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09Ci0tLSBzZXJ2ZXIvdXRpbF9leHByX2V2YWwuYwkocmV2
aXNpb24gMTcyMjE0MykKKysrIHNlcnZlci91dGlsX2V4cHJfZXZhbC5jCSh3b3JraW5nIGNvcHkp
CkBAIC0xNjgyLDcgKzE2ODIsNyBAQCBzdGF0aWMgaW50IGNvcmVfZXhwcl9sb29rdXAoYXBfZXhw
cl9sb29rdXBfcGFybXMgKgogICAgICAgICAgICAgd2hpbGUgKHByb3YtPmZ1bmMpIHsKICAgICAg
ICAgICAgICAgICBjb25zdCBjaGFyICoqbmFtZSA9IHByb3YtPm5hbWVzOwogICAgICAgICAgICAg
ICAgIHdoaWxlICgqbmFtZSkgewotICAgICAgICAgICAgICAgICAgICBpZiAoc3RyY2FzZWNtcCgq
bmFtZSwgcGFybXMtPm5hbWUpID09IDApIHsKKyAgICAgICAgICAgICAgICAgICAgaWYgKGFwX2Nh
c2VjbXBzdHIoKm5hbWUsIHBhcm1zLT5uYW1lKSA9PSAwKSB7CiAgICAgICAgICAgICAgICAgICAg
ICAgICAqcGFybXMtPmZ1bmMgPSBwcm92LT5mdW5jOwogICAgICAgICAgICAgICAgICAgICAgICAg
KnBhcm1zLT5kYXRhID0gbmFtZTsKICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBPSzsK
QEAgLTE3MTUsNyArMTcxNSw3IEBAIHN0YXRpYyBpbnQgY29yZV9leHByX2xvb2t1cChhcF9leHBy
X2xvb2t1cF9wYXJtcyAqCiAgICAgICAgICAgICAgICAgaWYgKHBhcm1zLT50eXBlID09IEFQX0VY
UFJfRlVOQ19PUF9VTkFSWSkKICAgICAgICAgICAgICAgICAgICAgbWF0Y2ggPSAhc3RyY21wKHBy
b3YtPm5hbWUsIHBhcm1zLT5uYW1lKTsKICAgICAgICAgICAgICAgICBlbHNlCi0gICAgICAgICAg
ICAgICAgICAgIG1hdGNoID0gIXN0cmNhc2VjbXAocHJvdi0+bmFtZSwgcGFybXMtPm5hbWUpOwor
ICAgICAgICAgICAgICAgICAgICBtYXRjaCA9ICFhcF9jYXNlY21wc3RyKHByb3YtPm5hbWUsIHBh
cm1zLT5uYW1lKTsKICAgICAgICAgICAgICAgICBpZiAobWF0Y2gpIHsKICAgICAgICAgICAgICAg
ICAgICAgaWYgKChwYXJtcy0+ZmxhZ3MgJiBBUF9FWFBSX0ZMQUdfUkVTVFJJQ1RFRCkKICAgICAg
ICAgICAgICAgICAgICAgICAgICYmIHByb3YtPnJlc3RyaWN0ZWQpIHsKSW5kZXg6IHNlcnZlci91
dGlsX3NjcmlwdC5jCj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT0KLS0tIHNlcnZlci91dGlsX3NjcmlwdC5jCShyZXZpc2lv
biAxNzIyMTQzKQorKysgc2VydmVyL3V0aWxfc2NyaXB0LmMJKHdvcmtpbmcgY29weSkKQEAgLTE3
NiwxMCArMTc2LDEwIEBAIEFQX0RFQ0xBUkUodm9pZCkgYXBfYWRkX2NvbW1vbl92YXJzKHJlcXVl
c3RfcmVjICpyCiAgICAgICAgICAqIGZvciBubyBwYXJ0aWN1bGFyIHJlYXNvbi4KICAgICAgICAg
ICovCiAKLSAgICAgICAgaWYgKCFzdHJjYXNlY21wKGhkcnNbaV0ua2V5LCAiQ29udGVudC10eXBl
IikpIHsKKyAgICAgICAgaWYgKCFhcF9jYXNlY21wc3RyKGhkcnNbaV0ua2V5LCAiQ29udGVudC10
eXBlIikpIHsKICAgICAgICAgICAgIGFwcl90YWJsZV9hZGRuKGUsICJDT05URU5UX1RZUEUiLCBo
ZHJzW2ldLnZhbCk7CiAgICAgICAgIH0KLSAgICAgICAgZWxzZSBpZiAoIXN0cmNhc2VjbXAoaGRy
c1tpXS5rZXksICJDb250ZW50LWxlbmd0aCIpKSB7CisgICAgICAgIGVsc2UgaWYgKCFhcF9jYXNl
Y21wc3RyKGhkcnNbaV0ua2V5LCAiQ29udGVudC1sZW5ndGgiKSkgewogICAgICAgICAgICAgYXBy
X3RhYmxlX2FkZG4oZSwgIkNPTlRFTlRfTEVOR1RIIiwgaGRyc1tpXS52YWwpOwogICAgICAgICB9
CiAgICAgICAgIC8qCkBAIC0xODgsOCArMTg4LDggQEAgQVBfREVDTEFSRSh2b2lkKSBhcF9hZGRf
Y29tbW9uX3ZhcnMocmVxdWVzdF9yZWMgKnIKICAgICAgICAgICogaW4gdGhlIGVudmlyb25tZW50
IHdpdGggInBzIC1lIi4gIEJ1dCwgaWYgeW91IG11c3QuLi4KICAgICAgICAgICovCiAjaWZuZGVm
IFNFQ1VSSVRZX0hPTEVfUEFTU19BVVRIT1JJWkFUSU9OCi0gICAgICAgIGVsc2UgaWYgKCFzdHJj
YXNlY21wKGhkcnNbaV0ua2V5LCAiQXV0aG9yaXphdGlvbiIpCi0gICAgICAgICAgICAgICAgIHx8
ICFzdHJjYXNlY21wKGhkcnNbaV0ua2V5LCAiUHJveHktQXV0aG9yaXphdGlvbiIpKSB7CisgICAg
ICAgIGVsc2UgaWYgKCFhcF9jYXNlY21wc3RyKGhkcnNbaV0ua2V5LCAiQXV0aG9yaXphdGlvbiIp
CisgICAgICAgICAgICAgICAgIHx8ICFhcF9jYXNlY21wc3RyKGhkcnNbaV0ua2V5LCAiUHJveHkt
QXV0aG9yaXphdGlvbiIpKSB7CiAgICAgICAgICAgICBpZiAoY29uZi0+Y2dpX3Bhc3NfYXV0aCA9
PSBBUF9DR0lfUEFTU19BVVRIX09OKSB7CiAgICAgICAgICAgICAgICAgYWRkX3VubGVzc19udWxs
KGUsIGh0dHAyZW52KHIsIGhkcnNbaV0ua2V5KSwgaGRyc1tpXS52YWwpOwogICAgICAgICAgICAg
fQpAQCAtNTkzLDcgKzU5Myw3IEBAIEFQX0RFQ0xBUkUoaW50KSBhcF9zY2FuX3NjcmlwdF9oZWFk
ZXJfZXJyX2NvcmVfZXgoCiAgICAgICAgICAgICArK2w7CiAgICAgICAgIH0KIAotICAgICAgICBp
ZiAoIXN0cmNhc2VjbXAodywgIkNvbnRlbnQtdHlwZSIpKSB7CisgICAgICAgIGlmICghYXBfY2Fz
ZWNtcHN0cih3LCAiQ29udGVudC10eXBlIikpIHsKICAgICAgICAgICAgIGNoYXIgKnRtcDsKIAog
ICAgICAgICAgICAgLyogTnVrZSB0cmFpbGluZyB3aGl0ZXNwYWNlICovCkBAIC02MTEsNyArNjEx
LDcgQEAgQVBfREVDTEFSRShpbnQpIGFwX3NjYW5fc2NyaXB0X2hlYWRlcl9lcnJfY29yZV9leCgK
ICAgICAgICAgICogSWYgdGhlIHNjcmlwdCByZXR1cm5lZCBhIHNwZWNpZmljIHN0YXR1cywgdGhh
dCdzIHdoYXQKICAgICAgICAgICogd2UnbGwgdXNlIC0gb3RoZXJ3aXNlIHdlIGFzc3VtZSAyMDAg
T0suCiAgICAgICAgICAqLwotICAgICAgICBlbHNlIGlmICghc3RyY2FzZWNtcCh3LCAiU3RhdHVz
IikpIHsKKyAgICAgICAgZWxzZSBpZiAoIWFwX2Nhc2VjbXBzdHIodywgIlN0YXR1cyIpKSB7CiAg
ICAgICAgICAgICByLT5zdGF0dXMgPSBjZ2lfc3RhdHVzID0gYXRvaShsKTsKICAgICAgICAgICAg
IGlmICghYXBfaXNfSFRUUF9WQUxJRF9SRVNQT05TRShjZ2lfc3RhdHVzKSkKICAgICAgICAgICAg
ICAgICBhcF9sb2dfcmVycm9yKFNDUklQVF9MT0dfTUFSSywgQVBMT0dfRVJSfEFQTE9HX1RPQ0xJ
RU5ULCAwLCByLApAQCAtNjI0LDE5ICs2MjQsMTkgQEAgQVBfREVDTEFSRShpbnQpIGFwX3NjYW5f
c2NyaXB0X2hlYWRlcl9lcnJfY29yZV9leCgKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIGFwcl9maWxlcGF0aF9uYW1lX2dldChyLT5maWxlbmFtZSksIGwpOwogICAgICAgICAgICAg
ci0+c3RhdHVzX2xpbmUgPSBhcHJfcHN0cmR1cChyLT5wb29sLCBsKTsKICAgICAgICAgfQotICAg
ICAgICBlbHNlIGlmICghc3RyY2FzZWNtcCh3LCAiTG9jYXRpb24iKSkgeworICAgICAgICBlbHNl
IGlmICghYXBfY2FzZWNtcHN0cih3LCAiTG9jYXRpb24iKSkgewogICAgICAgICAgICAgYXByX3Rh
YmxlX3NldChyLT5oZWFkZXJzX291dCwgdywgbCk7CiAgICAgICAgIH0KLSAgICAgICAgZWxzZSBp
ZiAoIXN0cmNhc2VjbXAodywgIkNvbnRlbnQtTGVuZ3RoIikpIHsKKyAgICAgICAgZWxzZSBpZiAo
IWFwX2Nhc2VjbXBzdHIodywgIkNvbnRlbnQtTGVuZ3RoIikpIHsKICAgICAgICAgICAgIGFwcl90
YWJsZV9zZXQoci0+aGVhZGVyc19vdXQsIHcsIGwpOwogICAgICAgICB9Ci0gICAgICAgIGVsc2Ug
aWYgKCFzdHJjYXNlY21wKHcsICJDb250ZW50LVJhbmdlIikpIHsKKyAgICAgICAgZWxzZSBpZiAo
IWFwX2Nhc2VjbXBzdHIodywgIkNvbnRlbnQtUmFuZ2UiKSkgewogICAgICAgICAgICAgYXByX3Rh
YmxlX3NldChyLT5oZWFkZXJzX291dCwgdywgbCk7CiAgICAgICAgIH0KLSAgICAgICAgZWxzZSBp
ZiAoIXN0cmNhc2VjbXAodywgIlRyYW5zZmVyLUVuY29kaW5nIikpIHsKKyAgICAgICAgZWxzZSBp
ZiAoIWFwX2Nhc2VjbXBzdHIodywgIlRyYW5zZmVyLUVuY29kaW5nIikpIHsKICAgICAgICAgICAg
IGFwcl90YWJsZV9zZXQoci0+aGVhZGVyc19vdXQsIHcsIGwpOwogICAgICAgICB9Ci0gICAgICAg
IGVsc2UgaWYgKCFzdHJjYXNlY21wKHcsICJFVGFnIikpIHsKKyAgICAgICAgZWxzZSBpZiAoIWFw
X2Nhc2VjbXBzdHIodywgIkVUYWciKSkgewogICAgICAgICAgICAgYXByX3RhYmxlX3NldChyLT5o
ZWFkZXJzX291dCwgdywgbCk7CiAgICAgICAgIH0KICAgICAgICAgLyoKQEAgLTY0MywxMSArNjQz
LDExIEBAIEFQX0RFQ0xBUkUoaW50KSBhcF9zY2FuX3NjcmlwdF9oZWFkZXJfZXJyX2NvcmVfZXgo
CiAgICAgICAgICAqIElmIHRoZSBzY3JpcHQgZ2F2ZSB1cyBhIExhc3QtTW9kaWZpZWQgaGVhZGVy
LCB3ZSBjYW4ndCBqdXN0CiAgICAgICAgICAqIHBhc3MgaXQgb24gYmxpbmRseSBiZWNhdXNlIG9m
IHJlc3RyaWN0aW9ucyBvbiBmdXR1cmUgdmFsdWVzLgogICAgICAgICAgKi8KLSAgICAgICAgZWxz
ZSBpZiAoIXN0cmNhc2VjbXAodywgIkxhc3QtTW9kaWZpZWQiKSkgeworICAgICAgICBlbHNlIGlm
ICghYXBfY2FzZWNtcHN0cih3LCAiTGFzdC1Nb2RpZmllZCIpKSB7CiAgICAgICAgICAgICBhcF91
cGRhdGVfbXRpbWUociwgYXByX2RhdGVfcGFyc2VfaHR0cChsKSk7CiAgICAgICAgICAgICBhcF9z
ZXRfbGFzdF9tb2RpZmllZChyKTsKICAgICAgICAgfQotICAgICAgICBlbHNlIGlmICghc3RyY2Fz
ZWNtcCh3LCAiU2V0LUNvb2tpZSIpKSB7CisgICAgICAgIGVsc2UgaWYgKCFhcF9jYXNlY21wc3Ry
KHcsICJTZXQtQ29va2llIikpIHsKICAgICAgICAgICAgIGFwcl90YWJsZV9hZGQoY29va2llX3Rh
YmxlLCB3LCBsKTsKICAgICAgICAgfQogICAgICAgICBlbHNlIHsKSW5kZXg6IC4KPT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PQotLS0gLgkocmV2aXNpb24gMTcyMjE0MykKKysrIC4JKHdvcmtpbmcgY29weSkKClByb3BlcnR5
IGNoYW5nZXMgb246IC4KX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fXwpNb2RpZmllZDogc3ZuOm1lcmdlaW5mbwogICBNZXJn
ZWQgL2h0dHBkL2h0dHBkL3RydW5rOnIxNzE1NDAxLDE3MTU0MDQsMTcxNTUyNywxNzE1NTQ2LDE3
MTU1NTQsMTcxNTU4NywxNzE1NjMyLDE3MTU3MzYsMTcxNTg1MiwxNzE1ODc2LDE3MTU4ODAsMTcx
NTkzOCwxNzE2MTUxLDE3MjIxNTAK
--001a114a696c59efc805280b76df--

From dev-return-85118-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Tue Dec 29 16:16:56 2015
Return-Path: <dev-return-85118-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id DF887180FD
	for <apmail-httpd-dev-archive@www.apache.org>; Tue, 29 Dec 2015 16:16:56 +0000 (UTC)
Received: (qmail 21082 invoked by uid 500); 29 Dec 2015 16:16:56 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 21002 invoked by uid 500); 29 Dec 2015 16:16:56 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 20992 invoked by uid 99); 29 Dec 2015 16:16:56 -0000
Received: from Unknown (HELO spamd1-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 29 Dec 2015 16:16:56 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd1-us-west.apache.org (ASF Mail Server at spamd1-us-west.apache.org) with ESMTP id F1289C05CB
	for <dev@httpd.apache.org>; Tue, 29 Dec 2015 16:16:55 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd1-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 0.653
X-Spam-Level:
X-Spam-Status: No, score=0.653 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, SPF_NEUTRAL=0.652,
	URIBL_BLOCKED=0.001] autolearn=disabled
Authentication-Results: spamd1-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=comcast.net
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd1-us-west.apache.org [10.40.0.7]) (amavisd-new, port 10024)
	with ESMTP id q6EATnuTON_m for <dev@httpd.apache.org>;
	Tue, 29 Dec 2015 16:16:47 +0000 (UTC)
Received: from resqmta-po-08v.sys.comcast.net (resqmta-po-08v.sys.comcast.net [96.114.154.167])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id 17C01439C9
	for <dev@httpd.apache.org>; Tue, 29 Dec 2015 16:16:47 +0000 (UTC)
Received: from resomta-po-20v.sys.comcast.net ([96.114.154.244])
	by resqmta-po-08v.sys.comcast.net with comcast
	id zUGN1r0095Geu2801UGfPV; Tue, 29 Dec 2015 16:16:39 +0000
Received: from [192.168.199.10] ([69.251.84.114])
	by resomta-po-20v.sys.comcast.net with comcast
	id zUGe1r00G2U0RYt01UGes3; Tue, 29 Dec 2015 16:16:39 +0000
Content-Type: text/plain; charset=us-ascii
Mime-Version: 1.0 (Mac OS X Mail 9.2 \(3112\))
Subject: Re: Better ap_casecmpstr[n]?
From: Jim Jagielski <jim@jaguNET.com>
In-Reply-To: <CAKQ1sVO3Js8Sw9oLUNQ7ZPntsYxsmtXUE2vPOfngPTun0bq0kw@mail.gmail.com>
Date: Tue, 29 Dec 2015 11:16:38 -0500
Content-Transfer-Encoding: 7bit
Message-Id: <33CB958A-1F4E-4105-8BEE-26F6656A64FB@jaguNET.com>
References: <CAKQ1sVOgsKky7tLp2nH_t1tMuJX+sgg4hULztMPRtcSx9NEW9Q@mail.gmail.com> <5654AEFB.1020704@aldan.algebra.com> <CAKQ1sVMJ1LBDHcoQy1YGa-_OMR2J6To557BwYwCQqDM+SBV8gw@mail.gmail.com> <CACsi253_f527B2M8dM1i2KGO8agy_RRrWEd89vAbk1PzcUcFWg@mail.gmail.com> <CAKQ1sVNS_XFo+4JK85fyF-mPtMdQ+02M=QbSMd34i+FAEh_r9A@mail.gmail.com> <CACsi250qDh-xcEG3Zsk7bKWLPs7n0Kh_Pzms_h-UwFTmKN5Odg@mail.gmail.com> <C60EE890-B1C6-4259-9D11-1FD54637FAF1@jaguNET.com> <ECDB0049-A874-44E0-A692-34BC10B7D408@jaguNET.com> <CAKQ1sVO3Js8Sw9oLUNQ7ZPntsYxsmtXUE2vPOfngPTun0bq0kw@mail.gmail.com>
To: dev@httpd.apache.org
X-Mailer: Apple Mail (2.3112)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=comcast.net;
	s=q20140121; t=1451405799;
	bh=2S7D1DTk8AAB7YrkYoY++5mazeLofe8A9JQ65tIHkaw=;
	h=Received:Received:Content-Type:Mime-Version:Subject:From:Date:
	 Message-Id:To;
	b=WcUNX54pmwF4BOhyS4dqv3GMz4slrd0DAkroNEtlmdCZ9pBdIEC8xH/W0xRU6gjy9
	 1d3q4B7L922RQHHr6SnI1Y1gAkxSSvXOFLUcRFz98jp0goXO6VPULErj4K4oN+QAIy
	 AV3V+gU2N+jnOrtVW5R4/ckmMbzM3OapdQwKaitDJ/SgjwUzETu/yfIkc94ORGtrhx
	 zF7hB78Jug4IfwtKcGkJk+x1hwz2hlRPRBTfO1V08T5rqj4xX1Oi/MYNHBxZJc/eQy
	 /y3DEY2u1qHFpRSXHMBADV2YU1IDA0YYqR58mUI2f2gCLxnw9a6YCR7I16e8lz/cR7
	 9kaOED2jUeKMQ==

In a sep thread on dev@apr, OtherBill appears to be trying to
determine the "right" name for the APR impl... maube we should
wait to see what it's decided on there and we can follow
suit.

PS: What determines "abusive" usage?

> On Dec 29, 2015, at 10:56 AM, Yann Ylavic <ylavic.dev@gmail.com> wrote:
> 
> On Tue, Dec 29, 2015 at 3:24 PM, Jim Jagielski <jim@jagunet.com> wrote:
>> ping.
>> 
>> Just a reminder that right now, trunk uses ap_casecmpstr[n](),
>> which can make some backport requests "problematic" due to
>> possible merge conflicts.
> 
> I've just committed (in r1722150) more reverts of abusive
> ap_casecmpstr[n]() usage I introduced in r1715880.
> This now leave us the attached 2.4.x backport patch should we decide
> to apply these changes to 2.4.x.
> 
>> 
>> Can we *please* decide what we are doing?
> 
> I'd vote for the backport...
> <httpd-2.4.x-ap_casecmpstr.patch>


From dev-return-85119-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Tue Dec 29 16:28:58 2015
Return-Path: <dev-return-85119-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 8BE5D181C7
	for <apmail-httpd-dev-archive@www.apache.org>; Tue, 29 Dec 2015 16:28:58 +0000 (UTC)
Received: (qmail 41094 invoked by uid 500); 29 Dec 2015 16:28:58 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 41027 invoked by uid 500); 29 Dec 2015 16:28:58 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 41017 invoked by uid 99); 29 Dec 2015 16:28:58 -0000
Received: from Unknown (HELO spamd3-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 29 Dec 2015 16:28:58 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd3-us-west.apache.org (ASF Mail Server at spamd3-us-west.apache.org) with ESMTP id 948641804A1
	for <dev@httpd.apache.org>; Tue, 29 Dec 2015 16:28:57 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd3-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.12
X-Spam-Level:
X-Spam-Status: No, score=-0.12 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RCVD_IN_MSPIKE_H3=-0.01, RCVD_IN_MSPIKE_WL=-0.01, SPF_PASS=-0.001,
	URIBL_BLOCKED=0.001] autolearn=disabled
Authentication-Results: spamd3-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd3-us-west.apache.org [10.40.0.10]) (amavisd-new, port 10024)
	with ESMTP id nNCO30gg_j9M for <dev@httpd.apache.org>;
	Tue, 29 Dec 2015 16:28:52 +0000 (UTC)
Received: from mail-qk0-f170.google.com (mail-qk0-f170.google.com [209.85.220.170])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id 8B5B924C11
	for <dev@httpd.apache.org>; Tue, 29 Dec 2015 16:28:51 +0000 (UTC)
Received: by mail-qk0-f170.google.com with SMTP id p187so205323655qkd.1
        for <dev@httpd.apache.org>; Tue, 29 Dec 2015 08:28:51 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        bh=SJv1cR3gF4qQLLHGz/FiMnVkn8hHyYSOXj6Gksjux5A=;
        b=nZjLuZvrxsFhQXQR0TxsaikSYgzuhCnevFkY8noenySKFVoTMeHiWo0OkkmXPB6JuM
         /nZYVU4t1TWd0FpXTPFip8Y19b7w5E423dkHgD+nI9r/MofrtPnRAzlEbMVb29wqdIgL
         BUjIyrfCsGV7+stZMiJcapBQB7USrSCHFaNC1a5CkAtz29yvLbWm1s/HOiSByjvUoorT
         RxkQ4gCYZK9OsgkP1fmbeKAXX5ciPPZvLiFhhfOFdsql4onXNB39GaFd10PW8pSCt2uF
         YVJCUCX0Iv5MMa86PXVSRehj6HCfMj3TrcX8yTD6ODp+UrOFkW2lya2+PUW82I6s3Egb
         Jm5A==
MIME-Version: 1.0
X-Received: by 10.55.80.194 with SMTP id e185mr77664290qkb.68.1451406530564;
 Tue, 29 Dec 2015 08:28:50 -0800 (PST)
Received: by 10.55.65.85 with HTTP; Tue, 29 Dec 2015 08:28:50 -0800 (PST)
In-Reply-To: <33CB958A-1F4E-4105-8BEE-26F6656A64FB@jaguNET.com>
References: <CAKQ1sVOgsKky7tLp2nH_t1tMuJX+sgg4hULztMPRtcSx9NEW9Q@mail.gmail.com>
	<5654AEFB.1020704@aldan.algebra.com>
	<CAKQ1sVMJ1LBDHcoQy1YGa-_OMR2J6To557BwYwCQqDM+SBV8gw@mail.gmail.com>
	<CACsi253_f527B2M8dM1i2KGO8agy_RRrWEd89vAbk1PzcUcFWg@mail.gmail.com>
	<CAKQ1sVNS_XFo+4JK85fyF-mPtMdQ+02M=QbSMd34i+FAEh_r9A@mail.gmail.com>
	<CACsi250qDh-xcEG3Zsk7bKWLPs7n0Kh_Pzms_h-UwFTmKN5Odg@mail.gmail.com>
	<C60EE890-B1C6-4259-9D11-1FD54637FAF1@jaguNET.com>
	<ECDB0049-A874-44E0-A692-34BC10B7D408@jaguNET.com>
	<CAKQ1sVO3Js8Sw9oLUNQ7ZPntsYxsmtXUE2vPOfngPTun0bq0kw@mail.gmail.com>
	<33CB958A-1F4E-4105-8BEE-26F6656A64FB@jaguNET.com>
Date: Tue, 29 Dec 2015 17:28:50 +0100
Message-ID: <CAKQ1sVOiTe6O8PD29SAT15iYFJaeF7MyGv07vd1_QLB268istg@mail.gmail.com>
Subject: Re: Better ap_casecmpstr[n]?
From: Yann Ylavic <ylavic.dev@gmail.com>
To: httpd-dev <dev@httpd.apache.org>
Content-Type: text/plain; charset=UTF-8

On Tue, Dec 29, 2015 at 5:16 PM, Jim Jagielski <jim@jagunet.com> wrote:
> In a sep thread on dev@apr, OtherBill appears to be trying to
> determine the "right" name for the APR impl... maube we should
> wait to see what it's decided on there and we can follow
> suit.

OK, although we won't be able to use APR's functions until we require
(at least) APR-1.6.x.
Maybe a follow up patch/backport could later "#define ap_casecmpstr[n]
apr_whatever" when available?

>
> PS: What determines "abusive" usage?

When used to compare something which is not a HTTP token or a scheme
(eg. config parameters).
As I see it, the valid usage is against remote/untrusted data known to
be defined in POSIX/C locale only...

From dev-return-85120-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Tue Dec 29 16:35:48 2015
Return-Path: <dev-return-85120-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id DCFF818232
	for <apmail-httpd-dev-archive@www.apache.org>; Tue, 29 Dec 2015 16:35:48 +0000 (UTC)
Received: (qmail 58614 invoked by uid 500); 29 Dec 2015 16:35:48 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 58534 invoked by uid 500); 29 Dec 2015 16:35:48 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 58523 invoked by uid 99); 29 Dec 2015 16:35:48 -0000
Received: from Unknown (HELO spamd2-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 29 Dec 2015 16:35:48 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd2-us-west.apache.org (ASF Mail Server at spamd2-us-west.apache.org) with ESMTP id CF8631A00D4
	for <dev@httpd.apache.org>; Tue, 29 Dec 2015 16:35:47 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd2-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 0.653
X-Spam-Level:
X-Spam-Status: No, score=0.653 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, SPF_NEUTRAL=0.652,
	URIBL_BLOCKED=0.001] autolearn=disabled
Authentication-Results: spamd2-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=comcast.net
Received: from mx1-us-west.apache.org ([10.40.0.8])
	by localhost (spamd2-us-west.apache.org [10.40.0.9]) (amavisd-new, port 10024)
	with ESMTP id FfOx6KG3g12R for <dev@httpd.apache.org>;
	Tue, 29 Dec 2015 16:35:39 +0000 (UTC)
Received: from resqmta-ch2-01v.sys.comcast.net (resqmta-ch2-01v.sys.comcast.net [69.252.207.33])
	by mx1-us-west.apache.org (ASF Mail Server at mx1-us-west.apache.org) with ESMTPS id EBCEC204B6
	for <dev@httpd.apache.org>; Tue, 29 Dec 2015 16:35:38 +0000 (UTC)
Received: from resomta-ch2-19v.sys.comcast.net ([69.252.207.115])
	by resqmta-ch2-01v.sys.comcast.net with comcast
	id zUb81r0012VvR6D01UbYy5; Tue, 29 Dec 2015 16:35:32 +0000
Received: from [192.168.199.10] ([69.251.84.114])
	by resomta-ch2-19v.sys.comcast.net with comcast
	id zUbX1r00Q2U0RYt01UbYcg; Tue, 29 Dec 2015 16:35:32 +0000
Content-Type: text/plain; charset=us-ascii
Mime-Version: 1.0 (Mac OS X Mail 9.2 \(3112\))
Subject: Re: Better ap_casecmpstr[n]?
From: Jim Jagielski <jim@jaguNET.com>
In-Reply-To: <CAKQ1sVOiTe6O8PD29SAT15iYFJaeF7MyGv07vd1_QLB268istg@mail.gmail.com>
Date: Tue, 29 Dec 2015 11:35:31 -0500
Content-Transfer-Encoding: 7bit
Message-Id: <8275610C-C28F-49C7-A44A-3C770990ED4C@jaguNET.com>
References: <CAKQ1sVOgsKky7tLp2nH_t1tMuJX+sgg4hULztMPRtcSx9NEW9Q@mail.gmail.com> <5654AEFB.1020704@aldan.algebra.com> <CAKQ1sVMJ1LBDHcoQy1YGa-_OMR2J6To557BwYwCQqDM+SBV8gw@mail.gmail.com> <CACsi253_f527B2M8dM1i2KGO8agy_RRrWEd89vAbk1PzcUcFWg@mail.gmail.com> <CAKQ1sVNS_XFo+4JK85fyF-mPtMdQ+02M=QbSMd34i+FAEh_r9A@mail.gmail.com> <CACsi250qDh-xcEG3Zsk7bKWLPs7n0Kh_Pzms_h-UwFTmKN5Odg@mail.gmail.com> <C60EE890-B1C6-4259-9D11-1FD54637FAF1@jaguNET.com> <ECDB0049-A874-44E0-A692-34BC10B7D408@jaguNET.com> <CAKQ1sVO3Js8Sw9oLUNQ7ZPntsYxsmtXUE2vPOfngPTun0bq0kw@mail.gmail.com> <33CB958A-1F4E-4105-8BEE-26F6656A64FB@jaguNET.com> <CAKQ1sVOiTe6O8PD29SAT15iYFJaeF7MyGv07vd1_QLB268istg@mail.gmail.com>
To: dev@httpd.apache.org
X-Mailer: Apple Mail (2.3112)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=comcast.net;
	s=q20140121; t=1451406932;
	bh=lwuJE6jFg5hLlsqaKRvWwHyOatPwPI8L011UzYCZNkQ=;
	h=Received:Received:Content-Type:Mime-Version:Subject:From:Date:
	 Message-Id:To;
	b=UJiZ0KeyL4TI2OdfT4LDcVEX58bWx3Z1wXacWsWyjiDq3AKawZf2yzlwu3tFIQIFZ
	 91Pr5xN61X/hU9GtoSLx8DvjhklTAoJVuEZOsGappZ21tAbC3b/5aUE/O1jNOd9SYE
	 ec3n/E9HUTvAeoK2hMoqW11E6YPpgt1rgBJ6NhR+KWHDRa99wlejfw+V95xOGahSD7
	 9hN1OugBdLyCShk9IdfSqgzmzzDE42wc6wX4hxFI5DMMUsGdHpvcGrUzFWbhQJJTIv
	 6zZlk32jNyykrIZstB2pNpZl7BhEymNccJcW+gv260+68V/VJPoTGa69C/zcfOUq4z
	 k4h22NIKPMXYw==


> On Dec 29, 2015, at 11:28 AM, Yann Ylavic <ylavic.dev@gmail.com> wrote:
> 
> On Tue, Dec 29, 2015 at 5:16 PM, Jim Jagielski <jim@jagunet.com> wrote:
>> In a sep thread on dev@apr, OtherBill appears to be trying to
>> determine the "right" name for the APR impl... maube we should
>> wait to see what it's decided on there and we can follow
>> suit.
> 
> OK, although we won't be able to use APR's functions until we require
> (at least) APR-1.6.x.
> Maybe a follow up patch/backport could later "#define ap_casecmpstr[n]
> apr_whatever" when available?
> 

Right. I was just thinking we'd use whatever APR uses but substitute
'ap_' for the 'apr_', as norm.

>> 
>> PS: What determines "abusive" usage?
> 
> When used to compare something which is not a HTTP token or a scheme
> (eg. config parameters).
> As I see it, the valid usage is against remote/untrusted data known to
> be defined in POSIX/C locale only...

IMO, anything we check regarding config directives (like all the
proxy params) are also candidates for using "our" function. We
*know* our config directives are ASCII.

From dev-return-85121-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Tue Dec 29 16:49:05 2015
Return-Path: <dev-return-85121-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 417A3182C1
	for <apmail-httpd-dev-archive@www.apache.org>; Tue, 29 Dec 2015 16:49:05 +0000 (UTC)
Received: (qmail 73860 invoked by uid 500); 29 Dec 2015 16:49:04 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 73790 invoked by uid 500); 29 Dec 2015 16:49:04 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 73780 invoked by uid 99); 29 Dec 2015 16:49:04 -0000
Received: from Unknown (HELO spamd2-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 29 Dec 2015 16:49:04 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd2-us-west.apache.org (ASF Mail Server at spamd2-us-west.apache.org) with ESMTP id 421411A0082
	for <dev@httpd.apache.org>; Tue, 29 Dec 2015 16:49:04 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd2-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.101
X-Spam-Level:
X-Spam-Status: No, score=-0.101 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RCVD_IN_MSPIKE_H2=-0.001, SPF_PASS=-0.001, URIBL_BLOCKED=0.001]
	autolearn=disabled
Authentication-Results: spamd2-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-eu-west.apache.org ([10.40.0.8])
	by localhost (spamd2-us-west.apache.org [10.40.0.9]) (amavisd-new, port 10024)
	with ESMTP id j5KuGgAJivMa for <dev@httpd.apache.org>;
	Tue, 29 Dec 2015 16:49:03 +0000 (UTC)
Received: from mail-qg0-f46.google.com (mail-qg0-f46.google.com [209.85.192.46])
	by mx1-eu-west.apache.org (ASF Mail Server at mx1-eu-west.apache.org) with ESMTPS id B13CC203A3
	for <dev@httpd.apache.org>; Tue, 29 Dec 2015 16:49:02 +0000 (UTC)
Received: by mail-qg0-f46.google.com with SMTP id 6so90217572qgy.1
        for <dev@httpd.apache.org>; Tue, 29 Dec 2015 08:49:02 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        bh=wTULdOmEsoHzNcYM17Af9xkyQ636pdxjt85Es5E67fU=;
        b=ZWlDxoJBjU9365GzP9QARebpPuBND5wiFONVS83TjlabEU9FflD9HKGy+E9h9CY7+K
         L3ilNrNsT/C7Mh3q8yc38hudgt5ATu5mCqHMJzEOPuk7BR+hErbfHz1eq7GK81VNbbJy
         v2VshU/xrekmXcfX450fTrcn3cBwSJztQB7aQWwI26TROIjOKOkGduMg21ARU9KqLHsC
         Uly5ALtkYh+FPZFPdJ04+QxyJkP4NyJfFwg69SR104jXgWfNyL9Y0mwZx2s/4feYd435
         QlMuHAPcBrq662T9oqDnrdWDyfSza6RU5j99Lhxqm74hb/gKRetBvHqdnZfdLGDCpMvX
         wEHw==
MIME-Version: 1.0
X-Received: by 10.140.179.68 with SMTP id z65mr85632300qhz.70.1451407736258;
 Tue, 29 Dec 2015 08:48:56 -0800 (PST)
Received: by 10.55.65.85 with HTTP; Tue, 29 Dec 2015 08:48:56 -0800 (PST)
In-Reply-To: <8275610C-C28F-49C7-A44A-3C770990ED4C@jaguNET.com>
References: <CAKQ1sVOgsKky7tLp2nH_t1tMuJX+sgg4hULztMPRtcSx9NEW9Q@mail.gmail.com>
	<5654AEFB.1020704@aldan.algebra.com>
	<CAKQ1sVMJ1LBDHcoQy1YGa-_OMR2J6To557BwYwCQqDM+SBV8gw@mail.gmail.com>
	<CACsi253_f527B2M8dM1i2KGO8agy_RRrWEd89vAbk1PzcUcFWg@mail.gmail.com>
	<CAKQ1sVNS_XFo+4JK85fyF-mPtMdQ+02M=QbSMd34i+FAEh_r9A@mail.gmail.com>
	<CACsi250qDh-xcEG3Zsk7bKWLPs7n0Kh_Pzms_h-UwFTmKN5Odg@mail.gmail.com>
	<C60EE890-B1C6-4259-9D11-1FD54637FAF1@jaguNET.com>
	<ECDB0049-A874-44E0-A692-34BC10B7D408@jaguNET.com>
	<CAKQ1sVO3Js8Sw9oLUNQ7ZPntsYxsmtXUE2vPOfngPTun0bq0kw@mail.gmail.com>
	<33CB958A-1F4E-4105-8BEE-26F6656A64FB@jaguNET.com>
	<CAKQ1sVOiTe6O8PD29SAT15iYFJaeF7MyGv07vd1_QLB268istg@mail.gmail.com>
	<8275610C-C28F-49C7-A44A-3C770990ED4C@jaguNET.com>
Date: Tue, 29 Dec 2015 17:48:56 +0100
Message-ID: <CAKQ1sVMvkMmp3ULWugmuy7hNE=Q13=10fEA394tdjaSP1DuV-g@mail.gmail.com>
Subject: Re: Better ap_casecmpstr[n]?
From: Yann Ylavic <ylavic.dev@gmail.com>
To: httpd-dev <dev@httpd.apache.org>
Content-Type: text/plain; charset=UTF-8

On Tue, Dec 29, 2015 at 5:35 PM, Jim Jagielski <jim@jagunet.com> wrote:
>
>> On Dec 29, 2015, at 11:28 AM, Yann Ylavic <ylavic.dev@gmail.com> wrote:
>>
>> On Tue, Dec 29, 2015 at 5:16 PM, Jim Jagielski <jim@jagunet.com> wrote:
>>>
>>> PS: What determines "abusive" usage?
>>
>> When used to compare something which is not a HTTP token or a scheme
>> (eg. config parameters).
>> As I see it, the valid usage is against remote/untrusted data known to
>> be defined in POSIX/C locale only...
>
> IMO, anything we check regarding config directives (like all the
> proxy params) are also candidates for using "our" function. We
> *know* our config directives are ASCII.

Makes sense, maybe we can enforce that in future patches and backport
them easily, the first "use case" already requires enough changes IMHO
:)

From dev-return-85122-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Tue Dec 29 20:21:50 2015
Return-Path: <dev-return-85122-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 8696218A37
	for <apmail-httpd-dev-archive@www.apache.org>; Tue, 29 Dec 2015 20:21:50 +0000 (UTC)
Received: (qmail 88394 invoked by uid 500); 29 Dec 2015 20:21:50 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 88309 invoked by uid 500); 29 Dec 2015 20:21:50 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 88299 invoked by uid 99); 29 Dec 2015 20:21:50 -0000
Received: from Unknown (HELO spamd2-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 29 Dec 2015 20:21:50 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd2-us-west.apache.org (ASF Mail Server at spamd2-us-west.apache.org) with ESMTP id 9B9E11A00E9
	for <dev@httpd.apache.org>; Tue, 29 Dec 2015 20:21:49 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd2-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 0.652
X-Spam-Level:
X-Spam-Status: No, score=0.652 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, SPF_NEUTRAL=0.652]
	autolearn=disabled
Authentication-Results: spamd2-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=comcast.net
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd2-us-west.apache.org [10.40.0.9]) (amavisd-new, port 10024)
	with ESMTP id f27VsgUb0Awo for <dev@httpd.apache.org>;
	Tue, 29 Dec 2015 20:21:43 +0000 (UTC)
Received: from resqmta-po-09v.sys.comcast.net (resqmta-po-09v.sys.comcast.net [96.114.154.168])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id C2498439B4
	for <dev@httpd.apache.org>; Tue, 29 Dec 2015 20:21:42 +0000 (UTC)
Received: from resomta-po-01v.sys.comcast.net ([96.114.154.225])
	by resqmta-po-09v.sys.comcast.net with comcast
	id zYMT1r0034s37d401YMcNU; Tue, 29 Dec 2015 20:21:36 +0000
Received: from [192.168.199.10] ([69.251.84.114])
	by resomta-po-01v.sys.comcast.net with comcast
	id zYMa1r00H2U0RYt01YMbdt; Tue, 29 Dec 2015 20:21:36 +0000
From: Jim Jagielski <jim@jaguNET.com>
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit
Subject: Work in progress: mod_proxy Health Check module
Message-Id: <F3D7A615-23EF-4809-9BC3-9E1CA44212A5@jaguNET.com>
Date: Tue, 29 Dec 2015 15:21:34 -0500
To: httpd <dev@httpd.apache.org>
Mime-Version: 1.0 (Mac OS X Mail 9.2 \(3112\))
X-Mailer: Apple Mail (2.3112)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=comcast.net;
	s=q20140121; t=1451420496;
	bh=lfJUJw1Ev7H9FasJ66M4VUvjLuuXni9fGLGX0/P5n4Y=;
	h=Received:Received:From:Content-Type:Subject:Message-Id:Date:To:
	 Mime-Version;
	b=gMNs20R9vRgqPJQQkT+HfqaVV+13lGzFNsFGTFm3Pbi0uu4cdmP7sHEIpiIPg/7kD
	 i1RiUyGItf0IbCto1mQCItxiEY15iaBjQoSagI49D1RHOX0477dawjqbzwIyxOH0ca
	 TN2EQ3my/lKzwrPdUI28KbKcpaymSZ8sw7kSX22aQpxtWCarHCBhSp3xFICo6kMd5m
	 lROK/S3MwZpPCgQJmUNsz35Rc6z+X0BaHqV2u8LtQ5EeBCUO4YIybGWZST2P1dIuZe
	 dLm241XEarSMwmuBXjpHlsTwtJULdgnOBGc2BY4ptOl/CahiKuGVQ76YmaNn40RYJO
	 24TnHBOGLQKbw==

Just a note that I've started committing my mod_proxy health
check module work... it is still a work-in-progress but the
goal is to always ensure that trunk is buildable and usable.
Right now, the module needs to be explicitly enabled during
configuration and all specific health-checks are basically
noops.

My design thoughts are that for each scheme/protocol allowed,
the (sub)module that handles that (eg: mod_proxy_http, mod_proxy_ajp,
etc...) implements an optional function that does the actual
server call. What constitutes a "success" is also up for
discussion. I've been mulling over having the check return
the response headers which can then be checked/verified using
our Expression routines ala <If>. eg:

	Condition all_good "%{REQUEST_STATUS} in { '200', '304' }"

And there is a 'check' mini-directive:

	BalancerMember http://www.example.com/ method=get check=all_good

which uses the stored condition for the pass/fail test.

From dev-return-85123-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Tue Dec 29 21:28:58 2015
Return-Path: <dev-return-85123-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id EA8E318D19
	for <apmail-httpd-dev-archive@www.apache.org>; Tue, 29 Dec 2015 21:28:57 +0000 (UTC)
Received: (qmail 19654 invoked by uid 500); 29 Dec 2015 21:28:57 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 19587 invoked by uid 500); 29 Dec 2015 21:28:57 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 19577 invoked by uid 99); 29 Dec 2015 21:28:57 -0000
Received: from Unknown (HELO spamd1-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 29 Dec 2015 21:28:57 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd1-us-west.apache.org (ASF Mail Server at spamd1-us-west.apache.org) with ESMTP id 9FA70C07B6
	for <dev@httpd.apache.org>; Tue, 29 Dec 2015 21:28:56 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd1-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 0.653
X-Spam-Level:
X-Spam-Status: No, score=0.653 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, SPF_NEUTRAL=0.652,
	URIBL_BLOCKED=0.001] autolearn=disabled
Authentication-Results: spamd1-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=comcast.net
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd1-us-west.apache.org [10.40.0.7]) (amavisd-new, port 10024)
	with ESMTP id 44mwKXv4I_sn for <dev@httpd.apache.org>;
	Tue, 29 Dec 2015 21:28:48 +0000 (UTC)
Received: from resqmta-po-10v.sys.comcast.net (resqmta-po-10v.sys.comcast.net [96.114.154.169])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id BF1C442B35
	for <dev@httpd.apache.org>; Tue, 29 Dec 2015 21:28:47 +0000 (UTC)
Received: from resomta-po-19v.sys.comcast.net ([96.114.154.243])
	by resqmta-po-10v.sys.comcast.net with comcast
	id zZTi1r0065FMDhs01ZUgQF; Tue, 29 Dec 2015 21:28:40 +0000
Received: from [192.168.199.10] ([69.251.84.114])
	by resomta-po-19v.sys.comcast.net with comcast
	id zZUf1r00F2U0RYt01ZUfbS; Tue, 29 Dec 2015 21:28:40 +0000
Content-Type: text/plain; charset=us-ascii
Mime-Version: 1.0 (Mac OS X Mail 9.2 \(3112\))
Subject: Re: Work in progress: mod_proxy Health Check module
From: Jim Jagielski <jim@jaguNET.com>
In-Reply-To: <F3D7A615-23EF-4809-9BC3-9E1CA44212A5@jaguNET.com>
Date: Tue, 29 Dec 2015 16:28:39 -0500
Content-Transfer-Encoding: quoted-printable
Message-Id: <7CC5D5E9-4433-428F-9F64-97C693945C63@jaguNET.com>
References: <F3D7A615-23EF-4809-9BC3-9E1CA44212A5@jaguNET.com>
To: dev@httpd.apache.org
X-Mailer: Apple Mail (2.3112)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=comcast.net;
	s=q20140121; t=1451424520;
	bh=eHHkGkK9rtnsAyMjgaJ6dHwkNVxT7Z//s6+rwyT0JPc=;
	h=Received:Received:Content-Type:Mime-Version:Subject:From:Date:
	 Message-Id:To;
	b=XBq1mvNk4+Luup3s205nYUU9vsZ1Uk08SCNqt8bgkN3pfQwzTmHI81WH1eM3UW3/E
	 YY+y4EVjWzEkeTAxVPYTRtI/SGdMA9nGL5ThDMc1cwVzHE+Vde/THh6K+WtJPSDc+O
	 miFrW62NZneI1Q/5Uw52qgv7OX9efhzIwsSsuULDYSOhPbnIicUsZt2WoTLrV4w/vD
	 dJRqSJBoZh9MbxtoHftNv4M5cypF3YAF0luYgtBvoPZ6entAQUowRec3PqLVkLA+87
	 /Fu2e1oI5xcUszVxMNxFutkfX5HN50dhKlNllCMHI90OLUNrWuzLajyeeTLR7p+CAZ
	 zBkNwMwi/MRog==

There is a somewhat easy way to do this via leveraging the
functionality of SetEnvIfExpr. For example, what I am testing
is the idea of:

	SetEnvIfCond "-R '10.0.0.0/8' || -R '172.16.0.0/12' || -R =
'192.168.0.0/16'" rfc1918

Which creates and stores *but does not evaluate* the above expression,
which is called 'rfc1918' (ie: the name of the envvar also serves as the
name/label of the condition).

We can then call:

	EvalEnvfIfCond rfc1918

which will then evaluate the expression at *that* time, and
set/unset the 'rfc1918' envvar as required.

> On Dec 29, 2015, at 3:21 PM, Jim Jagielski <jim@jaguNET.com> wrote:
>=20
> I've been mulling over having the check return
> the response headers which can then be checked/verified using
> our Expression routines ala <If>. eg:
>=20
> 	Condition all_good "%{REQUEST_STATUS} in { '200', '304' }"
>=20
> And there is a 'check' mini-directive:
>=20
> 	BalancerMember http://www.example.com/ method=3Dget =
check=3Dall_good
>=20
> which uses the stored condition for the pass/fail test.


From dev-return-85124-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Tue Dec 29 22:14:47 2015
Return-Path: <dev-return-85124-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id E807318E8B
	for <apmail-httpd-dev-archive@www.apache.org>; Tue, 29 Dec 2015 22:14:47 +0000 (UTC)
Received: (qmail 76235 invoked by uid 500); 29 Dec 2015 22:14:47 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 76153 invoked by uid 500); 29 Dec 2015 22:14:47 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 76136 invoked by uid 99); 29 Dec 2015 22:14:47 -0000
Received: from Unknown (HELO spamd4-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 29 Dec 2015 22:14:47 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd4-us-west.apache.org (ASF Mail Server at spamd4-us-west.apache.org) with ESMTP id 0865FC0D20
	for <dev@httpd.apache.org>; Tue, 29 Dec 2015 22:14:47 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd4-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 2.98
X-Spam-Level: **
X-Spam-Status: No, score=2.98 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, HTML_MESSAGE=3,
	RCVD_IN_MSPIKE_H3=-0.01, RCVD_IN_MSPIKE_WL=-0.01, SPF_PASS=-0.001,
	URIBL_BLOCKED=0.001] autolearn=disabled
Authentication-Results: spamd4-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=rowe-clan-net.20150623.gappssmtp.com
Received: from mx1-us-west.apache.org ([10.40.0.8])
	by localhost (spamd4-us-west.apache.org [10.40.0.11]) (amavisd-new, port 10024)
	with ESMTP id QWez7qfh5FAs for <dev@httpd.apache.org>;
	Tue, 29 Dec 2015 22:14:40 +0000 (UTC)
Received: from mail-ig0-f180.google.com (mail-ig0-f180.google.com [209.85.213.180])
	by mx1-us-west.apache.org (ASF Mail Server at mx1-us-west.apache.org) with ESMTPS id D81A3201C0
	for <dev@httpd.apache.org>; Tue, 29 Dec 2015 22:14:39 +0000 (UTC)
Received: by mail-ig0-f180.google.com with SMTP id to4so169758690igc.0
        for <dev@httpd.apache.org>; Tue, 29 Dec 2015 14:14:39 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=rowe-clan-net.20150623.gappssmtp.com; s=20150623;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        bh=XX9h69Inppv1WILFX/e1METmjWdcCvb1kmxz2kZKz7A=;
        b=DG4LqiYRfF/mc6VpWv7DSIPABv25LWlf4WO39DJh9DNdADaMFvfz/pAZLWvoZ49pNN
         ugZZg+qRXskpn0/JoGMAqw+BuvvrxnkU3TYktbPf6EtyOhIzGkd3Luw2NNDLdMUCl/cE
         lT5jW3YYdHWlmJCMnBS5EjqE+Dzbc+qBYqsc1FxDQRrLLZFHkOnWAzgoUzFIY6iHGE7d
         db7uq8C85anF4Cw0bffAu+mt3qivbMsbVvkUBGLShBrzgb/Au4n7bmH0nNfyZ1X7Fy2M
         aifNHpZVxGhWUbSsSZLOeN0w5wCVpmaplWyB9/BMG5w9oSGl3ZJ0RRxSmJXykF7eWx23
         vm7A==
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=1e100.net; s=20130820;
        h=x-gm-message-state:mime-version:in-reply-to:references:date
         :message-id:subject:from:to:content-type;
        bh=XX9h69Inppv1WILFX/e1METmjWdcCvb1kmxz2kZKz7A=;
        b=DnoStCLDzj7qrkjC8xUsUuJPSCOyyKWPvVvbjcUYcB0NKv/smCo1SK1MWf6hrkPK0h
         vDWyn8NgbgLWyBX3sDNVxVBHpKzXFIMoTcUAbRVaFHu8sCsqar3rpLidOwTS1wUYO2FY
         QapvMeTisLQ98eWKhU7lsB66H8/NuVh8lnSF9dAnVAAhR8eCleCWQpaTpr1XKK34K+RR
         iPAmFdd5pDF85HCLHMxPHhfiZPYcBzpgUB5a8W5ix5hmI7OfUnR5i2Vx7Bd+g6Bva0ZG
         mVgpGuLhTDIu/jyP328BxOq7vesEtB40o4N+tH2dUlZ/rglRpLVbk6QDZOtcxe68hJZG
         vwAQ==
X-Gm-Message-State: ALoCoQmSvKMWoBK1hFVneeu4wUTLDySiw5HaqLhK6xHA9OLOUu4Py2w9oRpxiLvjr3uuHM+xaTD4K1KyT4yItiroDuSBG1ZKl7U6ZRJ4bRnrzkGNRnBwNSw=
MIME-Version: 1.0
X-Received: by 10.50.143.10 with SMTP id sa10mr39813016igb.77.1451427273084;
 Tue, 29 Dec 2015 14:14:33 -0800 (PST)
Received: by 10.107.62.69 with HTTP; Tue, 29 Dec 2015 14:14:32 -0800 (PST)
In-Reply-To: <8275610C-C28F-49C7-A44A-3C770990ED4C@jaguNET.com>
References: <CAKQ1sVOgsKky7tLp2nH_t1tMuJX+sgg4hULztMPRtcSx9NEW9Q@mail.gmail.com>
	<5654AEFB.1020704@aldan.algebra.com>
	<CAKQ1sVMJ1LBDHcoQy1YGa-_OMR2J6To557BwYwCQqDM+SBV8gw@mail.gmail.com>
	<CACsi253_f527B2M8dM1i2KGO8agy_RRrWEd89vAbk1PzcUcFWg@mail.gmail.com>
	<CAKQ1sVNS_XFo+4JK85fyF-mPtMdQ+02M=QbSMd34i+FAEh_r9A@mail.gmail.com>
	<CACsi250qDh-xcEG3Zsk7bKWLPs7n0Kh_Pzms_h-UwFTmKN5Odg@mail.gmail.com>
	<C60EE890-B1C6-4259-9D11-1FD54637FAF1@jaguNET.com>
	<ECDB0049-A874-44E0-A692-34BC10B7D408@jaguNET.com>
	<CAKQ1sVO3Js8Sw9oLUNQ7ZPntsYxsmtXUE2vPOfngPTun0bq0kw@mail.gmail.com>
	<33CB958A-1F4E-4105-8BEE-26F6656A64FB@jaguNET.com>
	<CAKQ1sVOiTe6O8PD29SAT15iYFJaeF7MyGv07vd1_QLB268istg@mail.gmail.com>
	<8275610C-C28F-49C7-A44A-3C770990ED4C@jaguNET.com>
Date: Tue, 29 Dec 2015 16:14:32 -0600
Message-ID: <CACsi2518zqEcPPgRDU9cPqK6pZMxAOvu-PKBehKFf06dthCOdg@mail.gmail.com>
Subject: Re: Better ap_casecmpstr[n]?
From: William A Rowe Jr <wrowe@rowe-clan.net>
To: httpd <dev@httpd.apache.org>
Content-Type: multipart/alternative; boundary=001a1135fe9a07aae9052810bf2c

--001a1135fe9a07aae9052810bf2c
Content-Type: text/plain; charset=UTF-8

On Tue, Dec 29, 2015 at 10:35 AM, Jim Jagielski <jim@jagunet.com> wrote:

>
> > On Dec 29, 2015, at 11:28 AM, Yann Ylavic <ylavic.dev@gmail.com> wrote:
> >
> > On Tue, Dec 29, 2015 at 5:16 PM, Jim Jagielski <jim@jagunet.com> wrote:
> >> In a sep thread on dev@apr, OtherBill appears to be trying to
> >> determine the "right" name for the APR impl... maube we should
> >> wait to see what it's decided on there and we can follow
> >> suit.
> >
> > OK, although we won't be able to use APR's functions until we require
> > (at least) APR-1.6.x.
> > Maybe a follow up patch/backport could later "#define ap_casecmpstr[n]
> > apr_whatever" when available?
> >
>
> Right. I was just thinking we'd use whatever APR uses but substitute
> 'ap_' for the 'apr_', as norm.
>

+1 - minimal delta.  Easily becomes an ap_compat.h macro moving forwards to
make things easier for porters moving modules from 2.4.x to [23].next.


> >> PS: What determines "abusive" usage?
> >
> > When used to compare something which is not a HTTP token or a scheme
> > (eg. config parameters).
> > As I see it, the valid usage is against remote/untrusted data known to
> > be defined in POSIX/C locale only...
>
> IMO, anything we check regarding config directives (like all the
> proxy params) are also candidates for using "our" function. We
> *know* our config directives are ASCII.
>

Directive names, yes.  Directive arguments - not as much. Some are (boolean
flag tests, keywords) but others such as path and url args shouldn't touch
that
function, IMHO.

One thing to consider, is it a startup-path test (e.g. on initial config
read only)
or going to be accessed frequently (.htaccess parsing)?

--001a1135fe9a07aae9052810bf2c
Content-Type: text/html; charset=UTF-8
Content-Transfer-Encoding: quoted-printable

<div dir=3D"ltr"><div class=3D"gmail_extra"><div class=3D"gmail_quote">On T=
ue, Dec 29, 2015 at 10:35 AM, Jim Jagielski <span dir=3D"ltr">&lt;<a href=
=3D"mailto:jim@jagunet.com" target=3D"_blank">jim@jagunet.com</a>&gt;</span=
> wrote:<br><blockquote class=3D"gmail_quote" style=3D"margin:0 0 0 .8ex;bo=
rder-left:1px #ccc solid;padding-left:1ex"><span class=3D""><br>
&gt; On Dec 29, 2015, at 11:28 AM, Yann Ylavic &lt;<a href=3D"mailto:ylavic=
.dev@gmail.com">ylavic.dev@gmail.com</a>&gt; wrote:<br>
&gt;<br>
&gt; On Tue, Dec 29, 2015 at 5:16 PM, Jim Jagielski &lt;<a href=3D"mailto:j=
im@jagunet.com">jim@jagunet.com</a>&gt; wrote:<br>
&gt;&gt; In a sep thread on dev@apr, OtherBill appears to be trying to<br>
&gt;&gt; determine the &quot;right&quot; name for the APR impl... maube we =
should<br>
&gt;&gt; wait to see what it&#39;s decided on there and we can follow<br>
&gt;&gt; suit.<br>
&gt;<br>
&gt; OK, although we won&#39;t be able to use APR&#39;s functions until we =
require<br>
&gt; (at least) APR-1.6.x.<br>
&gt; Maybe a follow up patch/backport could later &quot;#define ap_casecmps=
tr[n]<br>
&gt; apr_whatever&quot; when available?<br>
&gt;<br>
<br>
</span>Right. I was just thinking we&#39;d use whatever APR uses but substi=
tute<br>
&#39;ap_&#39; for the &#39;apr_&#39;, as norm.<br>
<span class=3D""></span></blockquote><div><br></div><div>+1 - minimal delta=
.=C2=A0 Easily becomes an ap_compat.h macro moving forwards to</div><div>ma=
ke things easier for porters moving modules from 2.4.x to [23].next.</div><=
div>=C2=A0</div><blockquote class=3D"gmail_quote" style=3D"margin:0 0 0 .8e=
x;border-left:1px #ccc solid;padding-left:1ex"><span class=3D"">
&gt;&gt; PS: What determines &quot;abusive&quot; usage?<br>
&gt;<br>
&gt; When used to compare something which is not a HTTP token or a scheme<b=
r>
&gt; (eg. config parameters).<br>
&gt; As I see it, the valid usage is against remote/untrusted data known to=
<br>
&gt; be defined in POSIX/C locale only...<br>
<br>
</span>IMO, anything we check regarding config directives (like all the<br>
proxy params) are also candidates for using &quot;our&quot; function. We<br=
>
*know* our config directives are ASCII.<br></blockquote><div><br></div><div=
>Directive names, yes.=C2=A0 Directive arguments - not as much. Some are (b=
oolean</div><div>flag tests, keywords) but others such as path and url args=
 shouldn&#39;t touch that</div><div>function, IMHO.</div><div><br></div><di=
v>One thing to consider, is it a startup-path test (e.g. on initial config =
read only)</div><div>or going to be accessed frequently (.htaccess parsing)=
?</div><div><br></div><div><br></div></div><br></div></div>

--001a1135fe9a07aae9052810bf2c--

From dev-return-85125-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Tue Dec 29 22:43:40 2015
Return-Path: <dev-return-85125-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 2A8A318025
	for <apmail-httpd-dev-archive@www.apache.org>; Tue, 29 Dec 2015 22:43:40 +0000 (UTC)
Received: (qmail 18285 invoked by uid 500); 29 Dec 2015 22:43:39 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 18212 invoked by uid 500); 29 Dec 2015 22:43:39 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 18202 invoked by uid 99); 29 Dec 2015 22:43:39 -0000
Received: from Unknown (HELO spamd4-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Tue, 29 Dec 2015 22:43:39 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd4-us-west.apache.org (ASF Mail Server at spamd4-us-west.apache.org) with ESMTP id 3E365C0DBA
	for <dev@httpd.apache.org>; Tue, 29 Dec 2015 22:43:39 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd4-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: 0.653
X-Spam-Level:
X-Spam-Status: No, score=0.653 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, SPF_NEUTRAL=0.652,
	URIBL_BLOCKED=0.001] autolearn=disabled
Authentication-Results: spamd4-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=comcast.net
Received: from mx1-us-west.apache.org ([10.40.0.8])
	by localhost (spamd4-us-west.apache.org [10.40.0.11]) (amavisd-new, port 10024)
	with ESMTP id eNA3YX7PKktV for <dev@httpd.apache.org>;
	Tue, 29 Dec 2015 22:43:30 +0000 (UTC)
Received: from resqmta-po-09v.sys.comcast.net (resqmta-po-09v.sys.comcast.net [96.114.154.168])
	by mx1-us-west.apache.org (ASF Mail Server at mx1-us-west.apache.org) with ESMTPS id 0199920246
	for <dev@httpd.apache.org>; Tue, 29 Dec 2015 22:43:29 +0000 (UTC)
Received: from resomta-po-20v.sys.comcast.net ([96.114.154.244])
	by resqmta-po-09v.sys.comcast.net with comcast
	id zajH1r0065Geu2801ajPY0; Tue, 29 Dec 2015 22:43:23 +0000
Received: from [192.168.199.10] ([69.251.84.114])
	by resomta-po-20v.sys.comcast.net with comcast
	id zajN1r00Q2U0RYt01ajPts; Tue, 29 Dec 2015 22:43:23 +0000
Content-Type: text/plain; charset=us-ascii
Mime-Version: 1.0 (Mac OS X Mail 9.2 \(3112\))
Subject: Re: Better ap_casecmpstr[n]?
From: Jim Jagielski <jim@jaguNET.com>
In-Reply-To: <CACsi2518zqEcPPgRDU9cPqK6pZMxAOvu-PKBehKFf06dthCOdg@mail.gmail.com>
Date: Tue, 29 Dec 2015 17:43:22 -0500
Content-Transfer-Encoding: 7bit
Message-Id: <64705075-6D91-42D8-948F-A9391C0C137B@jaguNET.com>
References: <CAKQ1sVOgsKky7tLp2nH_t1tMuJX+sgg4hULztMPRtcSx9NEW9Q@mail.gmail.com> <5654AEFB.1020704@aldan.algebra.com> <CAKQ1sVMJ1LBDHcoQy1YGa-_OMR2J6To557BwYwCQqDM+SBV8gw@mail.gmail.com> <CACsi253_f527B2M8dM1i2KGO8agy_RRrWEd89vAbk1PzcUcFWg@mail.gmail.com> <CAKQ1sVNS_XFo+4JK85fyF-mPtMdQ+02M=QbSMd34i+FAEh_r9A@mail.gmail.com> <CACsi250qDh-xcEG3Zsk7bKWLPs7n0Kh_Pzms_h-UwFTmKN5Odg@mail.gmail.com> <C60EE890-B1C6-4259-9D11-1FD54637FAF1@jaguNET.com> <ECDB0049-A874-44E0-A692-34BC10B7D408@jaguNET.com> <CAKQ1sVO3Js8Sw9oLUNQ7ZPntsYxsmtXUE2vPOfngPTun0bq0kw@mail.gmail.com> <33CB958A-1F4E-4105-8BEE-26F6656A64FB@jaguNET.com> <CAKQ1sVOiTe6O8PD29SAT15iYFJaeF7MyGv07vd1_QLB268istg@mail.gmail.com> <8275610C-C28F-49C7-A44A-3C770990ED4C@jaguNET.com> <CACsi2518zqEcPPgRDU9cPqK6pZMxAOvu-PKBehKFf06dthCOdg@mail.gmail.com>
To: dev@httpd.apache.org
X-Mailer: Apple Mail (2.3112)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=comcast.net;
	s=q20140121; t=1451429003;
	bh=VaOaVu1hosWkJ6DveclneY5NVODb3YBw3mUA+tMo5yQ=;
	h=Received:Received:Content-Type:Mime-Version:Subject:From:Date:
	 Message-Id:To;
	b=F62M5sHKl0cYeON3IV76JeMDTrtNcaVBzlyIGhI2Q45sSt2HwOMHP7vs4BxySlGIH
	 4UY1fXOSk/R6k6M+qss/7MArInU6etCoYWpkD9CuISg5/IL5GJHiSE9DpydUqYF9Z2
	 SLfcNdEXLUxdl0cFGTZk8q3Ge+5Fcjut7wnyV2AQuIbp6EC2q3cOmWchyKIvsUapJG
	 QVtG8XXJd3ixVIgSbnxp3k/oD/99eKwXqnXAhsMTpKBbp4u1htip9TJwScbV4gsNxS
	 RtmYU7UAMp/5Mfe3gC1/N1q/iG9e1gOfxMN1kGN0gEXNBu0NhgfGWj4bxxSuQlYTFR
	 dHVYZ02vjkCJg==


> On Dec 29, 2015, at 5:14 PM, William A Rowe Jr <wrowe@rowe-clan.net> wrote:
> 
> 
> Directive names, yes.  Directive arguments - not as much.

Yeah... that's what I said. We know our names :)


From dev-return-85126-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Wed Dec 30 18:43:00 2015
Return-Path: <dev-return-85126-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 4060D182DB
	for <apmail-httpd-dev-archive@www.apache.org>; Wed, 30 Dec 2015 18:43:00 +0000 (UTC)
Received: (qmail 82501 invoked by uid 500); 30 Dec 2015 18:42:59 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 82422 invoked by uid 500); 30 Dec 2015 18:42:59 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 82412 invoked by uid 99); 30 Dec 2015 18:42:59 -0000
Received: from Unknown (HELO spamd2-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 30 Dec 2015 18:42:59 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd2-us-west.apache.org (ASF Mail Server at spamd2-us-west.apache.org) with ESMTP id 47DD81A02EA
	for <dev@httpd.apache.org>; Wed, 30 Dec 2015 18:42:59 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd2-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.102
X-Spam-Level:
X-Spam-Status: No, score=-0.102 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	RCVD_IN_MSPIKE_H2=-0.001, SPF_PASS=-0.001] autolearn=disabled
Authentication-Results: spamd2-us-west.apache.org (amavisd-new);
	dkim=pass (2048-bit key) header.d=gmail.com
Received: from mx1-us-west.apache.org ([10.40.0.8])
	by localhost (spamd2-us-west.apache.org [10.40.0.9]) (amavisd-new, port 10024)
	with ESMTP id LpaYfC3YNVFW for <dev@httpd.apache.org>;
	Wed, 30 Dec 2015 18:42:58 +0000 (UTC)
Received: from mail-qk0-f171.google.com (mail-qk0-f171.google.com [209.85.220.171])
	by mx1-us-west.apache.org (ASF Mail Server at mx1-us-west.apache.org) with ESMTPS id B5C5520D01
	for <dev@httpd.apache.org>; Wed, 30 Dec 2015 18:42:57 +0000 (UTC)
Received: by mail-qk0-f171.google.com with SMTP id p187so215775774qkd.1
        for <dev@httpd.apache.org>; Wed, 30 Dec 2015 10:42:57 -0800 (PST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
        d=gmail.com; s=20120113;
        h=mime-version:in-reply-to:references:date:message-id:subject:from:to
         :content-type;
        bh=XzkFpa4Jhoasaf58eFRl0UCShy54Vm47LncdzAwIy78=;
        b=hiOblPIT5rNQDlyh2R/3dBdqAQuQZ6VXsXeIcRRe3ZVI7+db3pFA9WWxQIk5ebhDRF
         pI0oWNSZ5yujIdgv/ICair+BJS3JbJkRftWaLuazC5RAC0SwTpKmelLVm+79R/YuVV8s
         k/pdM5ko6Z1in/caK4vn/EfvaXtEQpcDR3nalnYgio54DV4jnFDoWKFWsl8kTs7l3HZf
         h3r+PfwSlTYldy0pfrMbKlOsTrE3ZqXtR7x1rxdivTZtpBfFs3IcTm9WXFloD221DU6h
         ehF3aTKW6PnEd6XbjBrPVzyTdR5HJaDIlOxqiT9NGkfBN0Q5Y9kT3YF1N8ngw1UnveOE
         1g4A==
MIME-Version: 1.0
X-Received: by 10.55.71.82 with SMTP id u79mr88005164qka.55.1451500971444;
 Wed, 30 Dec 2015 10:42:51 -0800 (PST)
Received: by 10.55.65.85 with HTTP; Wed, 30 Dec 2015 10:42:51 -0800 (PST)
In-Reply-To: <20151230161236.C42AE3A019A@svn01-us-west.apache.org>
References: <20151230161236.C42AE3A019A@svn01-us-west.apache.org>
Date: Wed, 30 Dec 2015 19:42:51 +0100
Message-ID: <CAKQ1sVMGxjHy=wg4=+geCWPn0s=oQ2dhhPtNjDNKWutrTotQYQ@mail.gmail.com>
Subject: Re: svn commit: r1722369 - in /httpd/httpd/trunk: ./ docs/manual/mod/ modules/http2/
From: Yann Ylavic <ylavic.dev@gmail.com>
To: httpd-dev <dev@httpd.apache.org>
Content-Type: text/plain; charset=UTF-8

On Wed, Dec 30, 2015 at 5:12 PM,  <icing@apache.org> wrote:
> Author: icing
> Date: Wed Dec 30 16:12:35 2015
> New Revision: 1722369
>
> URL: http://svn.apache.org/viewvc?rev=1722369&view=rev
> Log:
> fixes after fuzzing tests, changed H2KeepAliveTimeout default
>
[]
>
> Modified: httpd/httpd/trunk/modules/http2/h2_workers.c
> URL: http://svn.apache.org/viewvc/httpd/httpd/trunk/modules/http2/h2_workers.c?rev=1722369&r1=1722368&r2=1722369&view=diff
> ==============================================================================
> --- httpd/httpd/trunk/modules/http2/h2_workers.c (original)
> +++ httpd/httpd/trunk/modules/http2/h2_workers.c Wed Dec 30 16:12:35 2015
> @@ -272,7 +272,7 @@ h2_workers *h2_workers_create(server_rec
>          apr_atomic_set32(&workers->max_idle_secs, 10);
>
>          apr_threadattr_create(&workers->thread_attr, workers->pool);
> -        apr_threadattr_detach_set(workers->thread_attr, 0);
> +        apr_threadattr_detach_set(workers->thread_attr, 1);

Hmm, aren't worker threads joined?
How does it work with eg. graceful restarts where (active) workers
need to be waited before the child exits?

Regards,
Yann.

From dev-return-85127-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org  Wed Dec 30 20:17:57 2015
Return-Path: <dev-return-85127-apmail-httpd-dev-archive=httpd.apache.org@httpd.apache.org>
X-Original-To: apmail-httpd-dev-archive@www.apache.org
Delivered-To: apmail-httpd-dev-archive@www.apache.org
Received: from mail.apache.org (hermes.apache.org [140.211.11.3])
	by minotaur.apache.org (Postfix) with SMTP id 4FF2F186BD
	for <apmail-httpd-dev-archive@www.apache.org>; Wed, 30 Dec 2015 20:17:57 +0000 (UTC)
Received: (qmail 72024 invoked by uid 500); 30 Dec 2015 20:17:56 -0000
Delivered-To: apmail-httpd-dev-archive@httpd.apache.org
Received: (qmail 71936 invoked by uid 500); 30 Dec 2015 20:17:56 -0000
Mailing-List: contact dev-help@httpd.apache.org; run by ezmlm
Precedence: bulk
Reply-To: dev@httpd.apache.org
list-help: <mailto:dev-help@httpd.apache.org>
list-unsubscribe: <mailto:dev-unsubscribe@httpd.apache.org>
List-Post: <mailto:dev@httpd.apache.org>
List-Id: <dev.httpd.apache.org>
Delivered-To: mailing list dev@httpd.apache.org
Received: (qmail 71926 invoked by uid 99); 30 Dec 2015 20:17:56 -0000
Received: from Unknown (HELO spamd2-us-west.apache.org) (209.188.14.142)
    by apache.org (qpsmtpd/0.29) with ESMTP; Wed, 30 Dec 2015 20:17:56 +0000
Received: from localhost (localhost [127.0.0.1])
	by spamd2-us-west.apache.org (ASF Mail Server at spamd2-us-west.apache.org) with ESMTP id 2DF9B1A031D
	for <dev@httpd.apache.org>; Wed, 30 Dec 2015 20:17:56 +0000 (UTC)
X-Virus-Scanned: Debian amavisd-new at spamd2-us-west.apache.org
X-Spam-Flag: NO
X-Spam-Score: -0.654
X-Spam-Level:
X-Spam-Status: No, score=-0.654 tagged_above=-999 required=6.31
	tests=[DKIM_SIGNED=0.1, DKIM_VALID=-0.1, DKIM_VALID_AU=-0.1,
	MIME_QP_LONG_LINE=0.001, RP_MATCHES_RCVD=-0.554, SPF_PASS=-0.001]
	autolearn=disabled
Authentication-Results: spamd2-us-west.apache.org (amavisd-new);
	dkim=pass (1024-bit key) header.d=greenbytes.de header.b=c2+97ORq;
	dkim=pass (1024-bit key) header.d=greenbytes.de header.b=cbni0GH3
Received: from mx1-us-east.apache.org ([10.40.0.8])
	by localhost (spamd2-us-west.apache.org [10.40.0.9]) (amavisd-new, port 10024)
	with ESMTP id rs0SJaFp5Fve for <dev@httpd.apache.org>;
	Wed, 30 Dec 2015 20:17:54 +0000 (UTC)
Received: from mail.greenbytes.de (mail.greenbytes.de [217.91.35.233])
	by mx1-us-east.apache.org (ASF Mail Server at mx1-us-east.apache.org) with ESMTPS id 6608742A20
	for <dev@httpd.apache.org>; Wed, 30 Dec 2015 20:17:54 +0000 (UTC)
Received: by mail.greenbytes.de (Postfix, from userid 117)
	id 2D83F15A0895; Wed, 30 Dec 2015 21:17:47 +0100 (CET)
DKIM-Signature: v=1; a=rsa-sha256; c=simple/simple; d=greenbytes.de; s=mail;
	t=1451506667; bh=Gjzah9+iDs0tMPBEg1dbEmchWY0TUNkvOAgPHxbFWHU=;
	h=From:Subject:Date:References:In-Reply-To:To:From;
	b=c2+97ORqw5DWBixfy1E3LvtIuvH9vZmdRHSKte9iLe7ZMCI4oPb9YdQe8AnvI+PeC
	 2W3jidq1q3Te410FVHt+EPiNO+XrFPcB6NdvOmGvqG+3kFR2+gEgK11sKyes09zYuP
	 7sdye2JktzifaLf4kfVC3bvxkwpzFiuBAoJD9YiY=
Received: from [192.168.178.67] (unknown [84.189.84.243])
	(using TLSv1 with cipher ECDHE-RSA-AES256-SHA (256/256 bits))
	(Client did not present a certificate)
	by mail.greenbytes.de (Postfix) with ESMTPSA id 2E99C15A047D
	for <dev@httpd.apache.org>; Wed, 30 Dec 2015 21:17:45 +0100 (CET)
DKIM-Signature: v=1; a=rsa-sha256; c=simple/simple; d=greenbytes.de; s=mail;
	t=1451506665; bh=Gjzah9+iDs0tMPBEg1dbEmchWY0TUNkvOAgPHxbFWHU=;
	h=From:Subject:Date:References:In-Reply-To:To:From;
	b=cbni0GH3C7n77wslrXs3Kpc5V4pVENdH3ne1CpZKpDtAWjsO3cBkvcC6Ts2U7SJNe
	 CMD9JvXDvaBqduiw7mBmWLY5znQnQyvrRJjsPt/j5MOizuCCNF0zqyOLrSM+/HBWVb
	 WpWweoR0pfAEL1xw6YZ670X7TUXAiN0cLhzBr4gM=
From: Stefan Eissing <stefan.eissing@greenbytes.de>
Content-Type: text/plain;
	charset=us-ascii
Content-Transfer-Encoding: quoted-printable
Mime-Version: 1.0 (1.0)
Subject: Re: svn commit: r1722369 - in /httpd/httpd/trunk: ./ docs/manual/mod/ modules/http2/
Message-Id: <BB902FAF-901B-4C8A-BAB3-5CC9C7AE9D64@greenbytes.de>
Date: Wed, 30 Dec 2015 21:17:44 +0100
References: <20151230161236.C42AE3A019A@svn01-us-west.apache.org> <CAKQ1sVMGxjHy=wg4=+geCWPn0s=oQ2dhhPtNjDNKWutrTotQYQ@mail.gmail.com>
In-Reply-To: <CAKQ1sVMGxjHy=wg4=+geCWPn0s=oQ2dhhPtNjDNKWutrTotQYQ@mail.gmail.com>
To: dev@httpd.apache.org
X-Mailer: iPhone Mail (13C75)

That feeds into the Grand Solution to make h2 workers part of the MPM. Not s=
ure how to approach that.=20

The common way today is that master connections do not return from run_conne=
ction if they are busy handling requests. If that takes longer than H2Timeou=
t to produce results, it may happen nevertheless, but that should then drag d=
own the conn anyway, I suppose.

> Am 30.12.2015 um 19:42 schrieb Yann Ylavic <ylavic.dev@gmail.com>:
>=20
>> On Wed, Dec 30, 2015 at 5:12 PM,  <icing@apache.org> wrote:
>> Author: icing
>> Date: Wed Dec 30 16:12:35 2015
>> New Revision: 1722369
>>=20
>> URL: http://svn.apache.org/viewvc?rev=3D1722369&view=3Drev
>> Log:
>> fixes after fuzzing tests, changed H2KeepAliveTimeout default
> []
>>=20
>> Modified: httpd/httpd/trunk/modules/http2/h2_workers.c
>> URL: http://svn.apache.org/viewvc/httpd/httpd/trunk/modules/http2/h2_work=
ers.c?rev=3D1722369&r1=3D1722368&r2=3D1722369&view=3Ddiff
>> =3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
=3D
>> --- httpd/httpd/trunk/modules/http2/h2_workers.c (original)
>> +++ httpd/httpd/trunk/modules/http2/h2_workers.c Wed Dec 30 16:12:35 2015=

>> @@ -272,7 +272,7 @@ h2_workers *h2_workers_create(server_rec
>>         apr_atomic_set32(&workers->max_idle_secs, 10);
>>=20
>>         apr_threadattr_create(&workers->thread_attr, workers->pool);
>> -        apr_threadattr_detach_set(workers->thread_attr, 0);
>> +        apr_threadattr_detach_set(workers->thread_attr, 1);
>=20
> Hmm, aren't worker threads joined?
> How does it work with eg. graceful restarts where (active) workers
> need to be waited before the child exits?
>=20
> Regards,
> Yann.

